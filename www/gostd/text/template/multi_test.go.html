<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8448070">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8448125">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8448179">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8448230">package</span>&nbsp;<span class="ident" id="8448238">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8448248">//&nbsp;Tests&nbsp;for&nbsp;mulitple-template&nbsp;parsing&nbsp;and&nbsp;execution.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8448303">import</span>&nbsp;<span class="op" id="8448310">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8448313">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8448322">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8448329">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8448340">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8448351">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="8448373">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8448376">const</span>&nbsp;<span class="op" id="8448382">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448385">noError</span>&nbsp;&nbsp;<span class="op" id="8448394">=</span>&nbsp;<span class="builtintype" id="8448396">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448402">hasError</span>&nbsp;<span class="op" id="8448411">=</span>&nbsp;<span class="builtintype" id="8448413">false</span><br>
<span class="lineno">20</span><span class="op" id="8448419">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8448422">type</span>&nbsp;<span class="ident" id="8448427">multiParseTest</span>&nbsp;<span class="keyword" id="8448442">struct</span>&nbsp;<span class="op" id="8448449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448452">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8448460">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448468">input</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8448476">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448484">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8448492">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448498">names</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8448506">[</span><span class="op" id="8448507">]</span><span class="builtintype" id="8448508">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448516">results</span>&nbsp;<span class="op" id="8448524">[</span><span class="op" id="8448525">]</span><span class="builtintype" id="8448526">string</span><br>
<span class="lineno"></span><span class="op" id="8448533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="8448536">var</span>&nbsp;<span class="ident" id="8448540">multiParseTests</span>&nbsp;<span class="op" id="8448556">=</span>&nbsp;<span class="op" id="8448558">[</span><span class="op" id="8448559">]</span><span class="ident" id="8448560">multiParseTest</span><span class="op" id="8448574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448577">{</span><span class="string" id="8448578">&#34;empty&#34;</span><span class="op" id="8448585">,</span>&nbsp;<span class="string" id="8448587">&#34;&#34;</span><span class="op" id="8448589">,</span>&nbsp;<span class="ident" id="8448591">noError</span><span class="op" id="8448598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448602">nil</span><span class="op" id="8448605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448609">nil</span><span class="op" id="8448612">}</span><span class="op" id="8448613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448616">{</span><span class="string" id="8448617">&#34;one&#34;</span><span class="op" id="8448622">,</span>&nbsp;<span class="string" id="8448624">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}`</span><span class="op" id="8448654">,</span>&nbsp;<span class="ident" id="8448656">noError</span><span class="op" id="8448663">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448667">[</span><span class="op" id="8448668">]</span><span class="builtintype" id="8448669">string</span><span class="op" id="8448675">{</span><span class="string" id="8448676">&#34;foo&#34;</span><span class="op" id="8448681">}</span><span class="op" id="8448682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448686">[</span><span class="op" id="8448687">]</span><span class="builtintype" id="8448688">string</span><span class="op" id="8448694">{</span><span class="string" id="8448695">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="8448702">}</span><span class="op" id="8448703">}</span><span class="op" id="8448704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448707">{</span><span class="string" id="8448708">&#34;two&#34;</span><span class="op" id="8448713">,</span>&nbsp;<span class="string" id="8448715">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}{{define&nbsp;&#34;bar&#34;}}&nbsp;BAR&nbsp;{{end}}`</span><span class="op" id="8448773">,</span>&nbsp;<span class="ident" id="8448775">noError</span><span class="op" id="8448782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448786">[</span><span class="op" id="8448787">]</span><span class="builtintype" id="8448788">string</span><span class="op" id="8448794">{</span><span class="string" id="8448795">&#34;foo&#34;</span><span class="op" id="8448800">,</span>&nbsp;<span class="string" id="8448802">&#34;bar&#34;</span><span class="op" id="8448807">}</span><span class="op" id="8448808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448812">[</span><span class="op" id="8448813">]</span><span class="builtintype" id="8448814">string</span><span class="op" id="8448820">{</span><span class="string" id="8448821">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="8448828">,</span>&nbsp;<span class="string" id="8448830">&#34;&nbsp;BAR&nbsp;&#34;</span><span class="op" id="8448837">}</span><span class="op" id="8448838">}</span><span class="op" id="8448839">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8448842">//&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448853">{</span><span class="string" id="8448854">&#34;missing&nbsp;end&#34;</span><span class="op" id="8448867">,</span>&nbsp;<span class="string" id="8448869">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;`</span><span class="op" id="8448892">,</span>&nbsp;<span class="ident" id="8448894">hasError</span><span class="op" id="8448902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448906">nil</span><span class="op" id="8448909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448913">nil</span><span class="op" id="8448916">}</span><span class="op" id="8448917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448920">{</span><span class="string" id="8448921">&#34;malformed&nbsp;name&#34;</span><span class="op" id="8448937">,</span>&nbsp;<span class="string" id="8448939">`{{define&nbsp;&#34;foo}}&nbsp;FOO&nbsp;`</span><span class="op" id="8448961">,</span>&nbsp;<span class="ident" id="8448963">hasError</span><span class="op" id="8448971">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448975">nil</span><span class="op" id="8448978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448982">nil</span><span class="op" id="8448985">}</span><span class="op" id="8448986">,</span><br>
<span class="lineno"></span><span class="op" id="8448988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8448991">func</span>&nbsp;<span class="ident" id="8448996">TestMultiParse</span><span class="op" id="8449010">(</span><span class="ident" id="8449011">t</span>&nbsp;<span class="op" id="8449013">*</span><span class="ident" id="8449014">testing</span><span class="op" id="8449021">.</span><span class="ident" id="8449022">T</span><span class="op" id="8449023">)</span>&nbsp;<span class="op" id="8449025">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449028">for</span>&nbsp;<span class="ident" id="8449032">_</span><span class="op" id="8449033">,</span>&nbsp;<span class="ident" id="8449035">test</span>&nbsp;<span class="op" id="8449040">:=</span>&nbsp;<span class="keyword" id="8449043">range</span>&nbsp;<span class="ident" id="8449049">multiParseTests</span>&nbsp;<span class="op" id="8449065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449069">template</span><span class="op" id="8449077">,</span>&nbsp;<span class="ident" id="8449079">err</span>&nbsp;<span class="op" id="8449083">:=</span>&nbsp;<span class="ident" id="8449086">New</span><span class="op" id="8449089">(</span><span class="string" id="8449090">&#34;root&#34;</span><span class="op" id="8449096">)</span><span class="op" id="8449097">.</span><span class="ident" id="8449098">Parse</span><span class="op" id="8449103">(</span><span class="ident" id="8449104">test</span><span class="op" id="8449108">.</span><span class="ident" id="8449109">input</span><span class="op" id="8449114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449118">switch</span>&nbsp;<span class="op" id="8449125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449129">case</span>&nbsp;<span class="ident" id="8449134">err</span>&nbsp;<span class="op" id="8449138">==</span>&nbsp;<span class="ident" id="8449141">nil</span>&nbsp;<span class="op" id="8449145">&amp;&amp;</span>&nbsp;<span class="op" id="8449148">!</span><span class="ident" id="8449149">test</span><span class="op" id="8449153">.</span><span class="ident" id="8449154">ok</span><span class="op" id="8449156">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449161">t</span><span class="op" id="8449162">.</span><span class="ident" id="8449163">Errorf</span><span class="op" id="8449169">(</span><span class="string" id="8449170">&#34;%q:&nbsp;expected&nbsp;error;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8449200">,</span>&nbsp;<span class="ident" id="8449202">test</span><span class="op" id="8449206">.</span><span class="ident" id="8449207">name</span><span class="op" id="8449211">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449216">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449227">case</span>&nbsp;<span class="ident" id="8449232">err</span>&nbsp;<span class="op" id="8449236">!=</span>&nbsp;<span class="ident" id="8449239">nil</span>&nbsp;<span class="op" id="8449243">&amp;&amp;</span>&nbsp;<span class="ident" id="8449246">test</span><span class="op" id="8449250">.</span><span class="ident" id="8449251">ok</span><span class="op" id="8449253">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449258">t</span><span class="op" id="8449259">.</span><span class="ident" id="8449260">Errorf</span><span class="op" id="8449266">(</span><span class="string" id="8449267">&#34;%q:&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8449293">,</span>&nbsp;<span class="ident" id="8449295">test</span><span class="op" id="8449299">.</span><span class="ident" id="8449300">name</span><span class="op" id="8449304">,</span>&nbsp;<span class="ident" id="8449306">err</span><span class="op" id="8449309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449314">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449325">case</span>&nbsp;<span class="ident" id="8449330">err</span>&nbsp;<span class="op" id="8449334">!=</span>&nbsp;<span class="ident" id="8449337">nil</span>&nbsp;<span class="op" id="8449341">&amp;&amp;</span>&nbsp;<span class="op" id="8449344">!</span><span class="ident" id="8449345">test</span><span class="op" id="8449349">.</span><span class="ident" id="8449350">ok</span><span class="op" id="8449352">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8449357">//&nbsp;expected&nbsp;error,&nbsp;got&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449387">if</span>&nbsp;<span class="op" id="8449390">*</span><span class="ident" id="8449391">debug</span>&nbsp;<span class="op" id="8449397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449403">fmt</span><span class="op" id="8449406">.</span><span class="ident" id="8449407">Printf</span><span class="op" id="8449413">(</span><span class="string" id="8449414">&#34;%s:&nbsp;%s\n\t%s\n&#34;</span><span class="op" id="8449430">,</span>&nbsp;<span class="ident" id="8449432">test</span><span class="op" id="8449436">.</span><span class="ident" id="8449437">name</span><span class="op" id="8449441">,</span>&nbsp;<span class="ident" id="8449443">test</span><span class="op" id="8449447">.</span><span class="ident" id="8449448">input</span><span class="op" id="8449453">,</span>&nbsp;<span class="ident" id="8449455">err</span><span class="op" id="8449458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449468">continue</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449483">if</span>&nbsp;<span class="ident" id="8449486">template</span>&nbsp;<span class="op" id="8449495">==</span>&nbsp;<span class="ident" id="8449498">nil</span>&nbsp;<span class="op" id="8449502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449507">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449522">if</span>&nbsp;<span class="builtinfunc" id="8449525">len</span><span class="op" id="8449528">(</span><span class="ident" id="8449529">template</span><span class="op" id="8449537">.</span><span class="ident" id="8449538">tmpl</span><span class="op" id="8449542">)</span>&nbsp;<span class="op" id="8449544">!=</span>&nbsp;<span class="builtinfunc" id="8449547">len</span><span class="op" id="8449550">(</span><span class="ident" id="8449551">test</span><span class="op" id="8449555">.</span><span class="ident" id="8449556">names</span><span class="op" id="8449561">)</span><span class="op" id="8449562">+</span><span class="num" id="8449563">1</span>&nbsp;<span class="op" id="8449565">{</span>&nbsp;<span class="comment" id="8449567">//&nbsp;+1&nbsp;for&nbsp;root</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449585">t</span><span class="op" id="8449586">.</span><span class="ident" id="8449587">Errorf</span><span class="op" id="8449593">(</span><span class="string" id="8449594">&#34;%s:&nbsp;wrong&nbsp;number&nbsp;of&nbsp;templates;&nbsp;wanted&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8449643">,</span>&nbsp;<span class="ident" id="8449645">test</span><span class="op" id="8449649">.</span><span class="ident" id="8449650">name</span><span class="op" id="8449654">,</span>&nbsp;<span class="builtinfunc" id="8449656">len</span><span class="op" id="8449659">(</span><span class="ident" id="8449660">test</span><span class="op" id="8449664">.</span><span class="ident" id="8449665">names</span><span class="op" id="8449670">)</span><span class="op" id="8449671">,</span>&nbsp;<span class="builtinfunc" id="8449673">len</span><span class="op" id="8449676">(</span><span class="ident" id="8449677">template</span><span class="op" id="8449685">.</span><span class="ident" id="8449686">tmpl</span><span class="op" id="8449690">)</span><span class="op" id="8449691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449696">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449711">for</span>&nbsp;<span class="ident" id="8449715">i</span><span class="op" id="8449716">,</span>&nbsp;<span class="ident" id="8449718">name</span>&nbsp;<span class="op" id="8449723">:=</span>&nbsp;<span class="keyword" id="8449726">range</span>&nbsp;<span class="ident" id="8449732">test</span><span class="op" id="8449736">.</span><span class="ident" id="8449737">names</span>&nbsp;<span class="op" id="8449743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449748">tmpl</span><span class="op" id="8449752">,</span>&nbsp;<span class="ident" id="8449754">ok</span>&nbsp;<span class="op" id="8449757">:=</span>&nbsp;<span class="ident" id="8449760">template</span><span class="op" id="8449768">.</span><span class="ident" id="8449769">tmpl</span><span class="op" id="8449773">[</span><span class="ident" id="8449774">name</span><span class="op" id="8449778">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449783">if</span>&nbsp;<span class="op" id="8449786">!</span><span class="ident" id="8449787">ok</span>&nbsp;<span class="op" id="8449790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449796">t</span><span class="op" id="8449797">.</span><span class="ident" id="8449798">Errorf</span><span class="op" id="8449804">(</span><span class="string" id="8449805">&#34;%s:&nbsp;can&#39;t&nbsp;find&nbsp;template&nbsp;%q&#34;</span><span class="op" id="8449833">,</span>&nbsp;<span class="ident" id="8449835">test</span><span class="op" id="8449839">.</span><span class="ident" id="8449840">name</span><span class="op" id="8449844">,</span>&nbsp;<span class="ident" id="8449846">name</span><span class="op" id="8449850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449856">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449873">result</span>&nbsp;<span class="op" id="8449880">:=</span>&nbsp;<span class="ident" id="8449883">tmpl</span><span class="op" id="8449887">.</span><span class="ident" id="8449888">Root</span><span class="op" id="8449892">.</span><span class="ident" id="8449893">String</span><span class="op" id="8449899">(</span><span class="op" id="8449900">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449905">if</span>&nbsp;<span class="ident" id="8449908">result</span>&nbsp;<span class="op" id="8449915">!=</span>&nbsp;<span class="ident" id="8449918">test</span><span class="op" id="8449922">.</span><span class="ident" id="8449923">results</span><span class="op" id="8449930">[</span><span class="ident" id="8449931">i</span><span class="op" id="8449932">]</span>&nbsp;<span class="op" id="8449934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449940">t</span><span class="op" id="8449941">.</span><span class="ident" id="8449942">Errorf</span><span class="op" id="8449948">(</span><span class="string" id="8449949">&#34;%s=(%q):&nbsp;got\n\t%v\nexpected\n\t%v&#34;</span><span class="op" id="8449985">,</span>&nbsp;<span class="ident" id="8449987">test</span><span class="op" id="8449991">.</span><span class="ident" id="8449992">name</span><span class="op" id="8449996">,</span>&nbsp;<span class="ident" id="8449998">test</span><span class="op" id="8450002">.</span><span class="ident" id="8450003">input</span><span class="op" id="8450008">,</span>&nbsp;<span class="ident" id="8450010">result</span><span class="op" id="8450016">,</span>&nbsp;<span class="ident" id="8450018">test</span><span class="op" id="8450022">.</span><span class="ident" id="8450023">results</span><span class="op" id="8450030">[</span><span class="ident" id="8450031">i</span><span class="op" id="8450032">]</span><span class="op" id="8450033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450045">}</span><br>
<span class="lineno">85</span><span class="op" id="8450047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8450050">var</span>&nbsp;<span class="ident" id="8450054">multiExecTests</span>&nbsp;<span class="op" id="8450069">=</span>&nbsp;<span class="op" id="8450071">[</span><span class="op" id="8450072">]</span><span class="ident" id="8450073">execTest</span><span class="op" id="8450081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450084">{</span><span class="string" id="8450085">&#34;empty&#34;</span><span class="op" id="8450092">,</span>&nbsp;<span class="string" id="8450094">&#34;&#34;</span><span class="op" id="8450096">,</span>&nbsp;<span class="string" id="8450098">&#34;&#34;</span><span class="op" id="8450100">,</span>&nbsp;<span class="ident" id="8450102">nil</span><span class="op" id="8450105">,</span>&nbsp;<span class="builtintype" id="8450107">true</span><span class="op" id="8450111">}</span><span class="op" id="8450112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450115">{</span><span class="string" id="8450116">&#34;text&#34;</span><span class="op" id="8450122">,</span>&nbsp;<span class="string" id="8450124">&#34;some&nbsp;text&#34;</span><span class="op" id="8450135">,</span>&nbsp;<span class="string" id="8450137">&#34;some&nbsp;text&#34;</span><span class="op" id="8450148">,</span>&nbsp;<span class="ident" id="8450150">nil</span><span class="op" id="8450153">,</span>&nbsp;<span class="builtintype" id="8450155">true</span><span class="op" id="8450159">}</span><span class="op" id="8450160">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450163">{</span><span class="string" id="8450164">&#34;invoke&nbsp;x&#34;</span><span class="op" id="8450174">,</span>&nbsp;<span class="string" id="8450176">`{{template&nbsp;&#34;x&#34;&nbsp;.SI}}`</span><span class="op" id="8450198">,</span>&nbsp;<span class="string" id="8450200">&#34;TEXT&#34;</span><span class="op" id="8450206">,</span>&nbsp;<span class="ident" id="8450208">tVal</span><span class="op" id="8450212">,</span>&nbsp;<span class="builtintype" id="8450214">true</span><span class="op" id="8450218">}</span><span class="op" id="8450219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450222">{</span><span class="string" id="8450223">&#34;invoke&nbsp;x&nbsp;no&nbsp;args&#34;</span><span class="op" id="8450241">,</span>&nbsp;<span class="string" id="8450243">`{{template&nbsp;&#34;x&#34;}}`</span><span class="op" id="8450261">,</span>&nbsp;<span class="string" id="8450263">&#34;TEXT&#34;</span><span class="op" id="8450269">,</span>&nbsp;<span class="ident" id="8450271">tVal</span><span class="op" id="8450275">,</span>&nbsp;<span class="builtintype" id="8450277">true</span><span class="op" id="8450281">}</span><span class="op" id="8450282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450285">{</span><span class="string" id="8450286">&#34;invoke&nbsp;dot&nbsp;int&#34;</span><span class="op" id="8450302">,</span>&nbsp;<span class="string" id="8450304">`{{template&nbsp;&#34;dot&#34;&nbsp;.I}}`</span><span class="op" id="8450327">,</span>&nbsp;<span class="string" id="8450329">&#34;17&#34;</span><span class="op" id="8450333">,</span>&nbsp;<span class="ident" id="8450335">tVal</span><span class="op" id="8450339">,</span>&nbsp;<span class="builtintype" id="8450341">true</span><span class="op" id="8450345">}</span><span class="op" id="8450346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450349">{</span><span class="string" id="8450350">&#34;invoke&nbsp;dot&nbsp;[]int&#34;</span><span class="op" id="8450368">,</span>&nbsp;<span class="string" id="8450370">`{{template&nbsp;&#34;dot&#34;&nbsp;.SI}}`</span><span class="op" id="8450394">,</span>&nbsp;<span class="string" id="8450396">&#34;[3&nbsp;4&nbsp;5]&#34;</span><span class="op" id="8450405">,</span>&nbsp;<span class="ident" id="8450407">tVal</span><span class="op" id="8450411">,</span>&nbsp;<span class="builtintype" id="8450413">true</span><span class="op" id="8450417">}</span><span class="op" id="8450418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450421">{</span><span class="string" id="8450422">&#34;invoke&nbsp;dotV&#34;</span><span class="op" id="8450435">,</span>&nbsp;<span class="string" id="8450437">`{{template&nbsp;&#34;dotV&#34;&nbsp;.U}}`</span><span class="op" id="8450461">,</span>&nbsp;<span class="string" id="8450463">&#34;v&#34;</span><span class="op" id="8450466">,</span>&nbsp;<span class="ident" id="8450468">tVal</span><span class="op" id="8450472">,</span>&nbsp;<span class="builtintype" id="8450474">true</span><span class="op" id="8450478">}</span><span class="op" id="8450479">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450482">{</span><span class="string" id="8450483">&#34;invoke&nbsp;nested&nbsp;int&#34;</span><span class="op" id="8450502">,</span>&nbsp;<span class="string" id="8450504">`{{template&nbsp;&#34;nested&#34;&nbsp;.I}}`</span><span class="op" id="8450530">,</span>&nbsp;<span class="string" id="8450532">&#34;17&#34;</span><span class="op" id="8450536">,</span>&nbsp;<span class="ident" id="8450538">tVal</span><span class="op" id="8450542">,</span>&nbsp;<span class="builtintype" id="8450544">true</span><span class="op" id="8450548">}</span><span class="op" id="8450549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450552">{</span><span class="string" id="8450553">&#34;variable&nbsp;declared&nbsp;by&nbsp;template&#34;</span><span class="op" id="8450584">,</span>&nbsp;<span class="string" id="8450586">`{{template&nbsp;&#34;nested&#34;&nbsp;$x:=.SI}},{{index&nbsp;$x&nbsp;1}}`</span><span class="op" id="8450632">,</span>&nbsp;<span class="string" id="8450634">&#34;[3&nbsp;4&nbsp;5],4&#34;</span><span class="op" id="8450645">,</span>&nbsp;<span class="ident" id="8450647">tVal</span><span class="op" id="8450651">,</span>&nbsp;<span class="builtintype" id="8450653">true</span><span class="op" id="8450657">}</span><span class="op" id="8450658">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8450662">//&nbsp;User-defined&nbsp;function:&nbsp;test&nbsp;argument&nbsp;evaluator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450714">{</span><span class="string" id="8450715">&#34;testFunc&nbsp;literal&#34;</span><span class="op" id="8450733">,</span>&nbsp;<span class="string" id="8450735">`{{oneArg&nbsp;&#34;joe&#34;}}`</span><span class="op" id="8450753">,</span>&nbsp;<span class="string" id="8450755">&#34;oneArg=joe&#34;</span><span class="op" id="8450767">,</span>&nbsp;<span class="ident" id="8450769">tVal</span><span class="op" id="8450773">,</span>&nbsp;<span class="builtintype" id="8450775">true</span><span class="op" id="8450779">}</span><span class="op" id="8450780">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450783">{</span><span class="string" id="8450784">&#34;testFunc&nbsp;.&#34;</span><span class="op" id="8450796">,</span>&nbsp;<span class="string" id="8450798">`{{oneArg&nbsp;.}}`</span><span class="op" id="8450812">,</span>&nbsp;<span class="string" id="8450814">&#34;oneArg=joe&#34;</span><span class="op" id="8450826">,</span>&nbsp;<span class="string" id="8450828">&#34;joe&#34;</span><span class="op" id="8450833">,</span>&nbsp;<span class="builtintype" id="8450835">true</span><span class="op" id="8450839">}</span><span class="op" id="8450840">,</span><br>
<span class="lineno"></span><span class="op" id="8450842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8450845">//&nbsp;These&nbsp;strings&nbsp;are&nbsp;also&nbsp;in&nbsp;testdata/*.</span><br>
<span class="lineno"></span><span class="keyword" id="8450886">const</span>&nbsp;<span class="ident" id="8450892">multiText1</span>&nbsp;<span class="op" id="8450903">=</span>&nbsp;<span class="string" id="8450905">`<br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;x&#34;}}TEXT{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dotV&#34;}}{{.V}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8450969">const</span>&nbsp;<span class="ident" id="8450975">multiText2</span>&nbsp;<span class="op" id="8450986">=</span>&nbsp;<span class="string" id="8450988">`<br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dot&#34;}}{{.}}{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;nested&#34;}}{{template&nbsp;&#34;dot&#34;&nbsp;.}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8451071">func</span>&nbsp;<span class="ident" id="8451076">TestMultiExecute</span><span class="op" id="8451092">(</span><span class="ident" id="8451093">t</span>&nbsp;<span class="op" id="8451095">*</span><span class="ident" id="8451096">testing</span><span class="op" id="8451103">.</span><span class="ident" id="8451104">T</span><span class="op" id="8451105">)</span>&nbsp;<span class="op" id="8451107">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8451110">//&nbsp;Declare&nbsp;a&nbsp;couple&nbsp;of&nbsp;templates&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451151">template</span><span class="op" id="8451159">,</span>&nbsp;<span class="ident" id="8451161">err</span>&nbsp;<span class="op" id="8451165">:=</span>&nbsp;<span class="ident" id="8451168">New</span><span class="op" id="8451171">(</span><span class="string" id="8451172">&#34;root&#34;</span><span class="op" id="8451178">)</span><span class="op" id="8451179">.</span><span class="ident" id="8451180">Parse</span><span class="op" id="8451185">(</span><span class="ident" id="8451186">multiText1</span><span class="op" id="8451196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451199">if</span>&nbsp;<span class="ident" id="8451202">err</span>&nbsp;<span class="op" id="8451206">!=</span>&nbsp;<span class="ident" id="8451209">nil</span>&nbsp;<span class="op" id="8451213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451217">t</span><span class="op" id="8451218">.</span><span class="ident" id="8451219">Fatalf</span><span class="op" id="8451225">(</span><span class="string" id="8451226">&#34;parse&nbsp;error&nbsp;for&nbsp;1:&nbsp;%s&#34;</span><span class="op" id="8451249">,</span>&nbsp;<span class="ident" id="8451251">err</span><span class="op" id="8451254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8451257">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451260">_</span><span class="op" id="8451261">,</span>&nbsp;<span class="ident" id="8451263">err</span>&nbsp;<span class="op" id="8451267">=</span>&nbsp;<span class="ident" id="8451269">template</span><span class="op" id="8451277">.</span><span class="ident" id="8451278">Parse</span><span class="op" id="8451283">(</span><span class="ident" id="8451284">multiText2</span><span class="op" id="8451294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451297">if</span>&nbsp;<span class="ident" id="8451300">err</span>&nbsp;<span class="op" id="8451304">!=</span>&nbsp;<span class="ident" id="8451307">nil</span>&nbsp;<span class="op" id="8451311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451315">t</span><span class="op" id="8451316">.</span><span class="ident" id="8451317">Fatalf</span><span class="op" id="8451323">(</span><span class="string" id="8451324">&#34;parse&nbsp;error&nbsp;for&nbsp;2:&nbsp;%s&#34;</span><span class="op" id="8451347">,</span>&nbsp;<span class="ident" id="8451349">err</span><span class="op" id="8451352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8451355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451358">testExecute</span><span class="op" id="8451369">(</span><span class="ident" id="8451370">multiExecTests</span><span class="op" id="8451384">,</span>&nbsp;<span class="ident" id="8451386">template</span><span class="op" id="8451394">,</span>&nbsp;<span class="ident" id="8451396">t</span><span class="op" id="8451397">)</span><br>
<span class="lineno">125</span><span class="op" id="8451399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8451402">func</span>&nbsp;<span class="ident" id="8451407">TestParseFiles</span><span class="op" id="8451421">(</span><span class="ident" id="8451422">t</span>&nbsp;<span class="op" id="8451424">*</span><span class="ident" id="8451425">testing</span><span class="op" id="8451432">.</span><span class="ident" id="8451433">T</span><span class="op" id="8451434">)</span>&nbsp;<span class="op" id="8451436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451439">_</span><span class="op" id="8451440">,</span>&nbsp;<span class="ident" id="8451442">err</span>&nbsp;<span class="op" id="8451446">:=</span>&nbsp;<span class="ident" id="8451449">ParseFiles</span><span class="op" id="8451459">(</span><span class="string" id="8451460">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="8451476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451479">if</span>&nbsp;<span class="ident" id="8451482">err</span>&nbsp;<span class="op" id="8451486">==</span>&nbsp;<span class="ident" id="8451489">nil</span>&nbsp;<span class="op" id="8451493">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451497">t</span><span class="op" id="8451498">.</span><span class="ident" id="8451499">Error</span><span class="op" id="8451504">(</span><span class="string" id="8451505">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8451553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8451556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451559">template</span>&nbsp;<span class="op" id="8451568">:=</span>&nbsp;<span class="ident" id="8451571">New</span><span class="op" id="8451574">(</span><span class="string" id="8451575">&#34;root&#34;</span><span class="op" id="8451581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451584">_</span><span class="op" id="8451585">,</span>&nbsp;<span class="ident" id="8451587">err</span>&nbsp;<span class="op" id="8451591">=</span>&nbsp;<span class="ident" id="8451593">template</span><span class="op" id="8451601">.</span><span class="ident" id="8451602">ParseFiles</span><span class="op" id="8451612">(</span><span class="string" id="8451613">&#34;testdata/file1.tmpl&#34;</span><span class="op" id="8451634">,</span>&nbsp;<span class="string" id="8451636">&#34;testdata/file2.tmpl&#34;</span><span class="op" id="8451657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451660">if</span>&nbsp;<span class="ident" id="8451663">err</span>&nbsp;<span class="op" id="8451667">!=</span>&nbsp;<span class="ident" id="8451670">nil</span>&nbsp;<span class="op" id="8451674">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451678">t</span><span class="op" id="8451679">.</span><span class="ident" id="8451680">Fatalf</span><span class="op" id="8451686">(</span><span class="string" id="8451687">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="8451712">,</span>&nbsp;<span class="ident" id="8451714">err</span><span class="op" id="8451717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8451720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451723">testExecute</span><span class="op" id="8451734">(</span><span class="ident" id="8451735">multiExecTests</span><span class="op" id="8451749">,</span>&nbsp;<span class="ident" id="8451751">template</span><span class="op" id="8451759">,</span>&nbsp;<span class="ident" id="8451761">t</span><span class="op" id="8451762">)</span><br>
<span class="lineno"></span><span class="op" id="8451764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="8451767">func</span>&nbsp;<span class="ident" id="8451772">TestParseGlob</span><span class="op" id="8451785">(</span><span class="ident" id="8451786">t</span>&nbsp;<span class="op" id="8451788">*</span><span class="ident" id="8451789">testing</span><span class="op" id="8451796">.</span><span class="ident" id="8451797">T</span><span class="op" id="8451798">)</span>&nbsp;<span class="op" id="8451800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451803">_</span><span class="op" id="8451804">,</span>&nbsp;<span class="ident" id="8451806">err</span>&nbsp;<span class="op" id="8451810">:=</span>&nbsp;<span class="ident" id="8451813">ParseGlob</span><span class="op" id="8451822">(</span><span class="string" id="8451823">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="8451839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451842">if</span>&nbsp;<span class="ident" id="8451845">err</span>&nbsp;<span class="op" id="8451849">==</span>&nbsp;<span class="ident" id="8451852">nil</span>&nbsp;<span class="op" id="8451856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451860">t</span><span class="op" id="8451861">.</span><span class="ident" id="8451862">Error</span><span class="op" id="8451867">(</span><span class="string" id="8451868">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8451916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8451919">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451922">_</span><span class="op" id="8451923">,</span>&nbsp;<span class="ident" id="8451925">err</span>&nbsp;<span class="op" id="8451929">=</span>&nbsp;<span class="ident" id="8451931">New</span><span class="op" id="8451934">(</span><span class="string" id="8451935">&#34;error&#34;</span><span class="op" id="8451942">)</span><span class="op" id="8451943">.</span><span class="ident" id="8451944">ParseGlob</span><span class="op" id="8451953">(</span><span class="string" id="8451954">&#34;[x&#34;</span><span class="op" id="8451958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8451961">if</span>&nbsp;<span class="ident" id="8451964">err</span>&nbsp;<span class="op" id="8451968">==</span>&nbsp;<span class="ident" id="8451971">nil</span>&nbsp;<span class="op" id="8451975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8451979">t</span><span class="op" id="8451980">.</span><span class="ident" id="8451981">Error</span><span class="op" id="8451986">(</span><span class="string" id="8451987">&#34;expected&nbsp;error&nbsp;for&nbsp;bad&nbsp;pattern;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8452029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8452032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452035">template</span>&nbsp;<span class="op" id="8452044">:=</span>&nbsp;<span class="ident" id="8452047">New</span><span class="op" id="8452050">(</span><span class="string" id="8452051">&#34;root&#34;</span><span class="op" id="8452057">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452060">_</span><span class="op" id="8452061">,</span>&nbsp;<span class="ident" id="8452063">err</span>&nbsp;<span class="op" id="8452067">=</span>&nbsp;<span class="ident" id="8452069">template</span><span class="op" id="8452077">.</span><span class="ident" id="8452078">ParseGlob</span><span class="op" id="8452087">(</span><span class="string" id="8452088">&#34;testdata/file*.tmpl&#34;</span><span class="op" id="8452109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8452112">if</span>&nbsp;<span class="ident" id="8452115">err</span>&nbsp;<span class="op" id="8452119">!=</span>&nbsp;<span class="ident" id="8452122">nil</span>&nbsp;<span class="op" id="8452126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452130">t</span><span class="op" id="8452131">.</span><span class="ident" id="8452132">Fatalf</span><span class="op" id="8452138">(</span><span class="string" id="8452139">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="8452164">,</span>&nbsp;<span class="ident" id="8452166">err</span><span class="op" id="8452169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8452172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452175">testExecute</span><span class="op" id="8452186">(</span><span class="ident" id="8452187">multiExecTests</span><span class="op" id="8452201">,</span>&nbsp;<span class="ident" id="8452203">template</span><span class="op" id="8452211">,</span>&nbsp;<span class="ident" id="8452213">t</span><span class="op" id="8452214">)</span><br>
<span class="lineno">155</span><span class="op" id="8452216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8452219">//&nbsp;In&nbsp;these&nbsp;tests,&nbsp;actual&nbsp;content&nbsp;(not&nbsp;just&nbsp;template&nbsp;definitions)&nbsp;comes&nbsp;from&nbsp;the&nbsp;parsed&nbsp;files.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8452315">var</span>&nbsp;<span class="ident" id="8452319">templateFileExecTests</span>&nbsp;<span class="op" id="8452341">=</span>&nbsp;<span class="op" id="8452343">[</span><span class="op" id="8452344">]</span><span class="ident" id="8452345">execTest</span><span class="op" id="8452353">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8452356">{</span><span class="string" id="8452357">&#34;test&#34;</span><span class="op" id="8452363">,</span>&nbsp;<span class="string" id="8452365">`{{template&nbsp;&#34;tmpl1.tmpl&#34;}}{{template&nbsp;&#34;tmpl2.tmpl&#34;}}`</span><span class="op" id="8452417">,</span>&nbsp;<span class="string" id="8452419">&#34;template1\n\ny\ntemplate2\n\nx\n&#34;</span><span class="op" id="8452453">,</span>&nbsp;<span class="num" id="8452455">0</span><span class="op" id="8452456">,</span>&nbsp;<span class="builtintype" id="8452458">true</span><span class="op" id="8452462">}</span><span class="op" id="8452463">,</span><br>
<span class="lineno"></span><span class="op" id="8452465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8452468">func</span>&nbsp;<span class="ident" id="8452473">TestParseFilesWithData</span><span class="op" id="8452495">(</span><span class="ident" id="8452496">t</span>&nbsp;<span class="op" id="8452498">*</span><span class="ident" id="8452499">testing</span><span class="op" id="8452506">.</span><span class="ident" id="8452507">T</span><span class="op" id="8452508">)</span>&nbsp;<span class="op" id="8452510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452513">template</span><span class="op" id="8452521">,</span>&nbsp;<span class="ident" id="8452523">err</span>&nbsp;<span class="op" id="8452527">:=</span>&nbsp;<span class="ident" id="8452530">New</span><span class="op" id="8452533">(</span><span class="string" id="8452534">&#34;root&#34;</span><span class="op" id="8452540">)</span><span class="op" id="8452541">.</span><span class="ident" id="8452542">ParseFiles</span><span class="op" id="8452552">(</span><span class="string" id="8452553">&#34;testdata/tmpl1.tmpl&#34;</span><span class="op" id="8452574">,</span>&nbsp;<span class="string" id="8452576">&#34;testdata/tmpl2.tmpl&#34;</span><span class="op" id="8452597">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8452600">if</span>&nbsp;<span class="ident" id="8452603">err</span>&nbsp;<span class="op" id="8452607">!=</span>&nbsp;<span class="ident" id="8452610">nil</span>&nbsp;<span class="op" id="8452614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452618">t</span><span class="op" id="8452619">.</span><span class="ident" id="8452620">Fatalf</span><span class="op" id="8452626">(</span><span class="string" id="8452627">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="8452652">,</span>&nbsp;<span class="ident" id="8452654">err</span><span class="op" id="8452657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8452660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452663">testExecute</span><span class="op" id="8452674">(</span><span class="ident" id="8452675">templateFileExecTests</span><span class="op" id="8452696">,</span>&nbsp;<span class="ident" id="8452698">template</span><span class="op" id="8452706">,</span>&nbsp;<span class="ident" id="8452708">t</span><span class="op" id="8452709">)</span><br>
<span class="lineno"></span><span class="op" id="8452711">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8452714">func</span>&nbsp;<span class="ident" id="8452719">TestParseGlobWithData</span><span class="op" id="8452740">(</span><span class="ident" id="8452741">t</span>&nbsp;<span class="op" id="8452743">*</span><span class="ident" id="8452744">testing</span><span class="op" id="8452751">.</span><span class="ident" id="8452752">T</span><span class="op" id="8452753">)</span>&nbsp;<span class="op" id="8452755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452758">template</span><span class="op" id="8452766">,</span>&nbsp;<span class="ident" id="8452768">err</span>&nbsp;<span class="op" id="8452772">:=</span>&nbsp;<span class="ident" id="8452775">New</span><span class="op" id="8452778">(</span><span class="string" id="8452779">&#34;root&#34;</span><span class="op" id="8452785">)</span><span class="op" id="8452786">.</span><span class="ident" id="8452787">ParseGlob</span><span class="op" id="8452796">(</span><span class="string" id="8452797">&#34;testdata/tmpl*.tmpl&#34;</span><span class="op" id="8452818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8452821">if</span>&nbsp;<span class="ident" id="8452824">err</span>&nbsp;<span class="op" id="8452828">!=</span>&nbsp;<span class="ident" id="8452831">nil</span>&nbsp;<span class="op" id="8452835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452839">t</span><span class="op" id="8452840">.</span><span class="ident" id="8452841">Fatalf</span><span class="op" id="8452847">(</span><span class="string" id="8452848">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="8452873">,</span>&nbsp;<span class="ident" id="8452875">err</span><span class="op" id="8452878">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8452881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452884">testExecute</span><span class="op" id="8452895">(</span><span class="ident" id="8452896">templateFileExecTests</span><span class="op" id="8452917">,</span>&nbsp;<span class="ident" id="8452919">template</span><span class="op" id="8452927">,</span>&nbsp;<span class="ident" id="8452929">t</span><span class="op" id="8452930">)</span><br>
<span class="lineno"></span><span class="op" id="8452932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8452935">const</span>&nbsp;<span class="op" id="8452941">(</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8452944">cloneText1</span>&nbsp;<span class="op" id="8452955">=</span>&nbsp;<span class="string" id="8452957">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;b&#34;}}{{template&nbsp;&#34;c&#34;}}{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453014">cloneText2</span>&nbsp;<span class="op" id="8453025">=</span>&nbsp;<span class="string" id="8453027">`{{define&nbsp;&#34;b&#34;}}b{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453053">cloneText3</span>&nbsp;<span class="op" id="8453064">=</span>&nbsp;<span class="string" id="8453066">`{{define&nbsp;&#34;c&#34;}}root{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453095">cloneText4</span>&nbsp;<span class="op" id="8453106">=</span>&nbsp;<span class="string" id="8453108">`{{define&nbsp;&#34;c&#34;}}clone{{end}}`</span><br>
<span class="lineno"></span><span class="op" id="8453137">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="8453140">func</span>&nbsp;<span class="ident" id="8453145">TestClone</span><span class="op" id="8453154">(</span><span class="ident" id="8453155">t</span>&nbsp;<span class="op" id="8453157">*</span><span class="ident" id="8453158">testing</span><span class="op" id="8453165">.</span><span class="ident" id="8453166">T</span><span class="op" id="8453167">)</span>&nbsp;<span class="op" id="8453169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8453172">//&nbsp;Create&nbsp;some&nbsp;templates&nbsp;and&nbsp;clone&nbsp;the&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453218">root</span><span class="op" id="8453222">,</span>&nbsp;<span class="ident" id="8453224">err</span>&nbsp;<span class="op" id="8453228">:=</span>&nbsp;<span class="ident" id="8453231">New</span><span class="op" id="8453234">(</span><span class="string" id="8453235">&#34;root&#34;</span><span class="op" id="8453241">)</span><span class="op" id="8453242">.</span><span class="ident" id="8453243">Parse</span><span class="op" id="8453248">(</span><span class="ident" id="8453249">cloneText1</span><span class="op" id="8453259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453262">if</span>&nbsp;<span class="ident" id="8453265">err</span>&nbsp;<span class="op" id="8453269">!=</span>&nbsp;<span class="ident" id="8453272">nil</span>&nbsp;<span class="op" id="8453276">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453280">t</span><span class="op" id="8453281">.</span><span class="ident" id="8453282">Fatal</span><span class="op" id="8453287">(</span><span class="ident" id="8453288">err</span><span class="op" id="8453291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453297">_</span><span class="op" id="8453298">,</span>&nbsp;<span class="ident" id="8453300">err</span>&nbsp;<span class="op" id="8453304">=</span>&nbsp;<span class="ident" id="8453306">root</span><span class="op" id="8453310">.</span><span class="ident" id="8453311">Parse</span><span class="op" id="8453316">(</span><span class="ident" id="8453317">cloneText2</span><span class="op" id="8453327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453330">if</span>&nbsp;<span class="ident" id="8453333">err</span>&nbsp;<span class="op" id="8453337">!=</span>&nbsp;<span class="ident" id="8453340">nil</span>&nbsp;<span class="op" id="8453344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453348">t</span><span class="op" id="8453349">.</span><span class="ident" id="8453350">Fatal</span><span class="op" id="8453355">(</span><span class="ident" id="8453356">err</span><span class="op" id="8453359">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453365">clone</span>&nbsp;<span class="op" id="8453371">:=</span>&nbsp;<span class="ident" id="8453374">Must</span><span class="op" id="8453378">(</span><span class="ident" id="8453379">root</span><span class="op" id="8453383">.</span><span class="ident" id="8453384">Clone</span><span class="op" id="8453389">(</span><span class="op" id="8453390">)</span><span class="op" id="8453391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8453394">//&nbsp;Add&nbsp;variants&nbsp;to&nbsp;both.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453420">_</span><span class="op" id="8453421">,</span>&nbsp;<span class="ident" id="8453423">err</span>&nbsp;<span class="op" id="8453427">=</span>&nbsp;<span class="ident" id="8453429">root</span><span class="op" id="8453433">.</span><span class="ident" id="8453434">Parse</span><span class="op" id="8453439">(</span><span class="ident" id="8453440">cloneText3</span><span class="op" id="8453450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453453">if</span>&nbsp;<span class="ident" id="8453456">err</span>&nbsp;<span class="op" id="8453460">!=</span>&nbsp;<span class="ident" id="8453463">nil</span>&nbsp;<span class="op" id="8453467">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453471">t</span><span class="op" id="8453472">.</span><span class="ident" id="8453473">Fatal</span><span class="op" id="8453478">(</span><span class="ident" id="8453479">err</span><span class="op" id="8453482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453488">_</span><span class="op" id="8453489">,</span>&nbsp;<span class="ident" id="8453491">err</span>&nbsp;<span class="op" id="8453495">=</span>&nbsp;<span class="ident" id="8453497">clone</span><span class="op" id="8453502">.</span><span class="ident" id="8453503">Parse</span><span class="op" id="8453508">(</span><span class="ident" id="8453509">cloneText4</span><span class="op" id="8453519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453522">if</span>&nbsp;<span class="ident" id="8453525">err</span>&nbsp;<span class="op" id="8453529">!=</span>&nbsp;<span class="ident" id="8453532">nil</span>&nbsp;<span class="op" id="8453536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453540">t</span><span class="op" id="8453541">.</span><span class="ident" id="8453542">Fatal</span><span class="op" id="8453547">(</span><span class="ident" id="8453548">err</span><span class="op" id="8453551">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8453557">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;clone&nbsp;is&nbsp;self-consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453603">for</span>&nbsp;<span class="ident" id="8453607">k</span><span class="op" id="8453608">,</span>&nbsp;<span class="ident" id="8453610">v</span>&nbsp;<span class="op" id="8453612">:=</span>&nbsp;<span class="keyword" id="8453615">range</span>&nbsp;<span class="ident" id="8453621">clone</span><span class="op" id="8453626">.</span><span class="ident" id="8453627">tmpl</span>&nbsp;<span class="op" id="8453632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453636">if</span>&nbsp;<span class="ident" id="8453639">k</span>&nbsp;<span class="op" id="8453641">==</span>&nbsp;<span class="ident" id="8453644">clone</span><span class="op" id="8453649">.</span><span class="ident" id="8453650">name</span>&nbsp;<span class="op" id="8453655">&amp;&amp;</span>&nbsp;<span class="ident" id="8453658">v</span><span class="op" id="8453659">.</span><span class="ident" id="8453660">tmpl</span><span class="op" id="8453664">[</span><span class="ident" id="8453665">k</span><span class="op" id="8453666">]</span>&nbsp;<span class="op" id="8453668">!=</span>&nbsp;<span class="ident" id="8453671">clone</span>&nbsp;<span class="op" id="8453677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453682">t</span><span class="op" id="8453683">.</span><span class="ident" id="8453684">Error</span><span class="op" id="8453689">(</span><span class="string" id="8453690">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;root&#34;</span><span class="op" id="8453719">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453727">if</span>&nbsp;<span class="ident" id="8453730">v</span>&nbsp;<span class="op" id="8453732">!=</span>&nbsp;<span class="ident" id="8453735">v</span><span class="op" id="8453736">.</span><span class="ident" id="8453737">tmpl</span><span class="op" id="8453741">[</span><span class="ident" id="8453742">v</span><span class="op" id="8453743">.</span><span class="ident" id="8453744">name</span><span class="op" id="8453748">]</span>&nbsp;<span class="op" id="8453750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453755">t</span><span class="op" id="8453756">.</span><span class="ident" id="8453757">Errorf</span><span class="op" id="8453763">(</span><span class="string" id="8453764">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;self&nbsp;for&nbsp;%q&#34;</span><span class="op" id="8453800">,</span>&nbsp;<span class="ident" id="8453802">k</span><span class="op" id="8453803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453810">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8453813">//&nbsp;Execute&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453831">var</span>&nbsp;<span class="ident" id="8453835">b</span>&nbsp;<span class="ident" id="8453837">bytes</span><span class="op" id="8453842">.</span><span class="ident" id="8453843">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453851">err</span>&nbsp;<span class="op" id="8453855">=</span>&nbsp;<span class="ident" id="8453857">root</span><span class="op" id="8453861">.</span><span class="ident" id="8453862">ExecuteTemplate</span><span class="op" id="8453877">(</span><span class="op" id="8453878">&amp;</span><span class="ident" id="8453879">b</span><span class="op" id="8453880">,</span>&nbsp;<span class="string" id="8453882">&#34;a&#34;</span><span class="op" id="8453885">,</span>&nbsp;<span class="num" id="8453887">0</span><span class="op" id="8453888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453891">if</span>&nbsp;<span class="ident" id="8453894">err</span>&nbsp;<span class="op" id="8453898">!=</span>&nbsp;<span class="ident" id="8453901">nil</span>&nbsp;<span class="op" id="8453905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453909">t</span><span class="op" id="8453910">.</span><span class="ident" id="8453911">Fatal</span><span class="op" id="8453916">(</span><span class="ident" id="8453917">err</span><span class="op" id="8453920">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453926">if</span>&nbsp;<span class="ident" id="8453929">b</span><span class="op" id="8453930">.</span><span class="ident" id="8453931">String</span><span class="op" id="8453937">(</span><span class="op" id="8453938">)</span>&nbsp;<span class="op" id="8453940">!=</span>&nbsp;<span class="string" id="8453943">&#34;broot&#34;</span>&nbsp;<span class="op" id="8453951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453955">t</span><span class="op" id="8453956">.</span><span class="ident" id="8453957">Errorf</span><span class="op" id="8453963">(</span><span class="string" id="8453964">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8453984">,</span>&nbsp;<span class="string" id="8453986">&#34;broot&#34;</span><span class="op" id="8453993">,</span>&nbsp;<span class="ident" id="8453995">b</span><span class="op" id="8453996">.</span><span class="ident" id="8453997">String</span><span class="op" id="8454003">(</span><span class="op" id="8454004">)</span><span class="op" id="8454005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8454011">//&nbsp;Execute&nbsp;copy.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454029">b</span><span class="op" id="8454030">.</span><span class="ident" id="8454031">Reset</span><span class="op" id="8454036">(</span><span class="op" id="8454037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454040">err</span>&nbsp;<span class="op" id="8454044">=</span>&nbsp;<span class="ident" id="8454046">clone</span><span class="op" id="8454051">.</span><span class="ident" id="8454052">ExecuteTemplate</span><span class="op" id="8454067">(</span><span class="op" id="8454068">&amp;</span><span class="ident" id="8454069">b</span><span class="op" id="8454070">,</span>&nbsp;<span class="string" id="8454072">&#34;a&#34;</span><span class="op" id="8454075">,</span>&nbsp;<span class="num" id="8454077">0</span><span class="op" id="8454078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454081">if</span>&nbsp;<span class="ident" id="8454084">err</span>&nbsp;<span class="op" id="8454088">!=</span>&nbsp;<span class="ident" id="8454091">nil</span>&nbsp;<span class="op" id="8454095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454099">t</span><span class="op" id="8454100">.</span><span class="ident" id="8454101">Fatal</span><span class="op" id="8454106">(</span><span class="ident" id="8454107">err</span><span class="op" id="8454110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454113">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454116">if</span>&nbsp;<span class="ident" id="8454119">b</span><span class="op" id="8454120">.</span><span class="ident" id="8454121">String</span><span class="op" id="8454127">(</span><span class="op" id="8454128">)</span>&nbsp;<span class="op" id="8454130">!=</span>&nbsp;<span class="string" id="8454133">&#34;bclone&#34;</span>&nbsp;<span class="op" id="8454142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454146">t</span><span class="op" id="8454147">.</span><span class="ident" id="8454148">Errorf</span><span class="op" id="8454154">(</span><span class="string" id="8454155">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8454175">,</span>&nbsp;<span class="string" id="8454177">&#34;bclone&#34;</span><span class="op" id="8454185">,</span>&nbsp;<span class="ident" id="8454187">b</span><span class="op" id="8454188">.</span><span class="ident" id="8454189">String</span><span class="op" id="8454195">(</span><span class="op" id="8454196">)</span><span class="op" id="8454197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454200">}</span><br>
<span class="lineno"></span><span class="op" id="8454202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="8454205">func</span>&nbsp;<span class="ident" id="8454210">TestAddParseTree</span><span class="op" id="8454226">(</span><span class="ident" id="8454227">t</span>&nbsp;<span class="op" id="8454229">*</span><span class="ident" id="8454230">testing</span><span class="op" id="8454237">.</span><span class="ident" id="8454238">T</span><span class="op" id="8454239">)</span>&nbsp;<span class="op" id="8454241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8454244">//&nbsp;Create&nbsp;some&nbsp;templates.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454271">root</span><span class="op" id="8454275">,</span>&nbsp;<span class="ident" id="8454277">err</span>&nbsp;<span class="op" id="8454281">:=</span>&nbsp;<span class="ident" id="8454284">New</span><span class="op" id="8454287">(</span><span class="string" id="8454288">&#34;root&#34;</span><span class="op" id="8454294">)</span><span class="op" id="8454295">.</span><span class="ident" id="8454296">Parse</span><span class="op" id="8454301">(</span><span class="ident" id="8454302">cloneText1</span><span class="op" id="8454312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454315">if</span>&nbsp;<span class="ident" id="8454318">err</span>&nbsp;<span class="op" id="8454322">!=</span>&nbsp;<span class="ident" id="8454325">nil</span>&nbsp;<span class="op" id="8454329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454333">t</span><span class="op" id="8454334">.</span><span class="ident" id="8454335">Fatal</span><span class="op" id="8454340">(</span><span class="ident" id="8454341">err</span><span class="op" id="8454344">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454350">_</span><span class="op" id="8454351">,</span>&nbsp;<span class="ident" id="8454353">err</span>&nbsp;<span class="op" id="8454357">=</span>&nbsp;<span class="ident" id="8454359">root</span><span class="op" id="8454363">.</span><span class="ident" id="8454364">Parse</span><span class="op" id="8454369">(</span><span class="ident" id="8454370">cloneText2</span><span class="op" id="8454380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454383">if</span>&nbsp;<span class="ident" id="8454386">err</span>&nbsp;<span class="op" id="8454390">!=</span>&nbsp;<span class="ident" id="8454393">nil</span>&nbsp;<span class="op" id="8454397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454401">t</span><span class="op" id="8454402">.</span><span class="ident" id="8454403">Fatal</span><span class="op" id="8454408">(</span><span class="ident" id="8454409">err</span><span class="op" id="8454412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454415">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8454418">//&nbsp;Add&nbsp;a&nbsp;new&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454444">tree</span><span class="op" id="8454448">,</span>&nbsp;<span class="ident" id="8454450">err</span>&nbsp;<span class="op" id="8454454">:=</span>&nbsp;<span class="ident" id="8454457">parse</span><span class="op" id="8454462">.</span><span class="ident" id="8454463">Parse</span><span class="op" id="8454468">(</span><span class="string" id="8454469">&#34;cloneText3&#34;</span><span class="op" id="8454481">,</span>&nbsp;<span class="ident" id="8454483">cloneText3</span><span class="op" id="8454493">,</span>&nbsp;<span class="string" id="8454495">&#34;&#34;</span><span class="op" id="8454497">,</span>&nbsp;<span class="string" id="8454499">&#34;&#34;</span><span class="op" id="8454501">,</span>&nbsp;<span class="ident" id="8454503">nil</span><span class="op" id="8454506">,</span>&nbsp;<span class="ident" id="8454508">builtins</span><span class="op" id="8454516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454519">if</span>&nbsp;<span class="ident" id="8454522">err</span>&nbsp;<span class="op" id="8454526">!=</span>&nbsp;<span class="ident" id="8454529">nil</span>&nbsp;<span class="op" id="8454533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454537">t</span><span class="op" id="8454538">.</span><span class="ident" id="8454539">Fatal</span><span class="op" id="8454544">(</span><span class="ident" id="8454545">err</span><span class="op" id="8454548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454551">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454554">added</span><span class="op" id="8454559">,</span>&nbsp;<span class="ident" id="8454561">err</span>&nbsp;<span class="op" id="8454565">:=</span>&nbsp;<span class="ident" id="8454568">root</span><span class="op" id="8454572">.</span><span class="ident" id="8454573">AddParseTree</span><span class="op" id="8454585">(</span><span class="string" id="8454586">&#34;c&#34;</span><span class="op" id="8454589">,</span>&nbsp;<span class="ident" id="8454591">tree</span><span class="op" id="8454595">[</span><span class="string" id="8454596">&#34;c&#34;</span><span class="op" id="8454599">]</span><span class="op" id="8454600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8454603">//&nbsp;Execute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454616">var</span>&nbsp;<span class="ident" id="8454620">b</span>&nbsp;<span class="ident" id="8454622">bytes</span><span class="op" id="8454627">.</span><span class="ident" id="8454628">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454636">err</span>&nbsp;<span class="op" id="8454640">=</span>&nbsp;<span class="ident" id="8454642">added</span><span class="op" id="8454647">.</span><span class="ident" id="8454648">ExecuteTemplate</span><span class="op" id="8454663">(</span><span class="op" id="8454664">&amp;</span><span class="ident" id="8454665">b</span><span class="op" id="8454666">,</span>&nbsp;<span class="string" id="8454668">&#34;a&#34;</span><span class="op" id="8454671">,</span>&nbsp;<span class="num" id="8454673">0</span><span class="op" id="8454674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454677">if</span>&nbsp;<span class="ident" id="8454680">err</span>&nbsp;<span class="op" id="8454684">!=</span>&nbsp;<span class="ident" id="8454687">nil</span>&nbsp;<span class="op" id="8454691">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454695">t</span><span class="op" id="8454696">.</span><span class="ident" id="8454697">Fatal</span><span class="op" id="8454702">(</span><span class="ident" id="8454703">err</span><span class="op" id="8454706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454712">if</span>&nbsp;<span class="ident" id="8454715">b</span><span class="op" id="8454716">.</span><span class="ident" id="8454717">String</span><span class="op" id="8454723">(</span><span class="op" id="8454724">)</span>&nbsp;<span class="op" id="8454726">!=</span>&nbsp;<span class="string" id="8454729">&#34;broot&#34;</span>&nbsp;<span class="op" id="8454737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454741">t</span><span class="op" id="8454742">.</span><span class="ident" id="8454743">Errorf</span><span class="op" id="8454749">(</span><span class="string" id="8454750">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8454770">,</span>&nbsp;<span class="string" id="8454772">&#34;broot&#34;</span><span class="op" id="8454779">,</span>&nbsp;<span class="ident" id="8454781">b</span><span class="op" id="8454782">.</span><span class="ident" id="8454783">String</span><span class="op" id="8454789">(</span><span class="op" id="8454790">)</span><span class="op" id="8454791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454794">}</span><br>
<span class="lineno">260</span><span class="op" id="8454796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8454799">//&nbsp;Issue&nbsp;7032</span><br>
<span class="lineno"></span><span class="keyword" id="8454813">func</span>&nbsp;<span class="ident" id="8454818">TestAddParseTreeToUnparsedTemplate</span><span class="op" id="8454852">(</span><span class="ident" id="8454853">t</span>&nbsp;<span class="op" id="8454855">*</span><span class="ident" id="8454856">testing</span><span class="op" id="8454863">.</span><span class="ident" id="8454864">T</span><span class="op" id="8454865">)</span>&nbsp;<span class="op" id="8454867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454870">master</span>&nbsp;<span class="op" id="8454877">:=</span>&nbsp;<span class="string" id="8454880">&#34;{{define&nbsp;\&#34;master\&#34;}}{{end}}&#34;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454912">tmpl</span>&nbsp;<span class="op" id="8454917">:=</span>&nbsp;<span class="ident" id="8454920">New</span><span class="op" id="8454923">(</span><span class="string" id="8454924">&#34;master&#34;</span><span class="op" id="8454932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454935">tree</span><span class="op" id="8454939">,</span>&nbsp;<span class="ident" id="8454941">err</span>&nbsp;<span class="op" id="8454945">:=</span>&nbsp;<span class="ident" id="8454948">parse</span><span class="op" id="8454953">.</span><span class="ident" id="8454954">Parse</span><span class="op" id="8454959">(</span><span class="string" id="8454960">&#34;master&#34;</span><span class="op" id="8454968">,</span>&nbsp;<span class="ident" id="8454970">master</span><span class="op" id="8454976">,</span>&nbsp;<span class="string" id="8454978">&#34;&#34;</span><span class="op" id="8454980">,</span>&nbsp;<span class="string" id="8454982">&#34;&#34;</span><span class="op" id="8454984">,</span>&nbsp;<span class="ident" id="8454986">nil</span><span class="op" id="8454989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454992">if</span>&nbsp;<span class="ident" id="8454995">err</span>&nbsp;<span class="op" id="8454999">!=</span>&nbsp;<span class="ident" id="8455002">nil</span>&nbsp;<span class="op" id="8455006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8455010">t</span><span class="op" id="8455011">.</span><span class="ident" id="8455012">Fatalf</span><span class="op" id="8455018">(</span><span class="string" id="8455019">&#34;unexpected&nbsp;parse&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="8455045">,</span>&nbsp;<span class="ident" id="8455047">err</span><span class="op" id="8455050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8455053">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8455056">masterTree</span>&nbsp;<span class="op" id="8455067">:=</span>&nbsp;<span class="ident" id="8455070">tree</span><span class="op" id="8455074">[</span><span class="string" id="8455075">&#34;master&#34;</span><span class="op" id="8455083">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8455086">tmpl</span><span class="op" id="8455090">.</span><span class="ident" id="8455091">AddParseTree</span><span class="op" id="8455103">(</span><span class="string" id="8455104">&#34;master&#34;</span><span class="op" id="8455112">,</span>&nbsp;<span class="ident" id="8455114">masterTree</span><span class="op" id="8455124">)</span>&nbsp;<span class="comment" id="8455126">//&nbsp;used&nbsp;to&nbsp;panic</span><br>
<span class="lineno"></span><span class="op" id="8455143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8455146">func</span>&nbsp;<span class="ident" id="8455151">TestRedefinition</span><span class="op" id="8455167">(</span><span class="ident" id="8455168">t</span>&nbsp;<span class="op" id="8455170">*</span><span class="ident" id="8455171">testing</span><span class="op" id="8455178">.</span><span class="ident" id="8455179">T</span><span class="op" id="8455180">)</span>&nbsp;<span class="op" id="8455182">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8455185">var</span>&nbsp;<span class="ident" id="8455189">tmpl</span>&nbsp;<span class="op" id="8455194">*</span><span class="ident" id="8455195">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8455205">var</span>&nbsp;<span class="ident" id="8455209">err</span>&nbsp;<span class="builtintype" id="8455213">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8455220">if</span>&nbsp;<span class="ident" id="8455223">tmpl</span><span class="op" id="8455227">,</span>&nbsp;<span class="ident" id="8455229">err</span>&nbsp;<span class="op" id="8455233">=</span>&nbsp;<span class="ident" id="8455235">New</span><span class="op" id="8455238">(</span><span class="string" id="8455239">&#34;tmpl1&#34;</span><span class="op" id="8455246">)</span><span class="op" id="8455247">.</span><span class="ident" id="8455248">Parse</span><span class="op" id="8455253">(</span><span class="string" id="8455254">`{{define&nbsp;&#34;test&#34;}}foo{{end}}`</span><span class="op" id="8455283">)</span><span class="op" id="8455284">;</span>&nbsp;<span class="ident" id="8455286">err</span>&nbsp;<span class="op" id="8455290">!=</span>&nbsp;<span class="ident" id="8455293">nil</span>&nbsp;<span class="op" id="8455297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8455301">t</span><span class="op" id="8455302">.</span><span class="ident" id="8455303">Fatalf</span><span class="op" id="8455309">(</span><span class="string" id="8455310">&#34;parse&nbsp;1:&nbsp;%v&#34;</span><span class="op" id="8455323">,</span>&nbsp;<span class="ident" id="8455325">err</span><span class="op" id="8455328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8455331">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8455334">if</span>&nbsp;<span class="ident" id="8455337">_</span><span class="op" id="8455338">,</span>&nbsp;<span class="ident" id="8455340">err</span>&nbsp;<span class="op" id="8455344">=</span>&nbsp;<span class="ident" id="8455346">tmpl</span><span class="op" id="8455350">.</span><span class="ident" id="8455351">Parse</span><span class="op" id="8455356">(</span><span class="string" id="8455357">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="8455386">)</span><span class="op" id="8455387">;</span>&nbsp;<span class="ident" id="8455389">err</span>&nbsp;<span class="op" id="8455393">==</span>&nbsp;<span class="ident" id="8455396">nil</span>&nbsp;<span class="op" id="8455400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8455404">t</span><span class="op" id="8455405">.</span><span class="ident" id="8455406">Fatal</span><span class="op" id="8455411">(</span><span class="string" id="8455412">&#34;expected&nbsp;error&#34;</span><span class="op" id="8455428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8455431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8455434">if</span>&nbsp;<span class="op" id="8455437">!</span><span class="ident" id="8455438">strings</span><span class="op" id="8455445">.</span><span class="ident" id="8455446">Contains</span><span class="op" id="8455454">(</span><span class="ident" id="8455455">err</span><span class="op" id="8455458">.</span><span class="ident" id="8455459">Error</span><span class="op" id="8455464">(</span><span class="op" id="8455465">)</span><span class="op" id="8455466">,</span>&nbsp;<span class="string" id="8455468">&#34;redefinition&#34;</span><span class="op" id="8455482">)</span>&nbsp;<span class="op" id="8455484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8455488">t</span><span class="op" id="8455489">.</span><span class="ident" id="8455490">Fatalf</span><span class="op" id="8455496">(</span><span class="string" id="8455497">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="8455534">,</span>&nbsp;<span class="ident" id="8455536">err</span><span class="op" id="8455539">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8455542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8455545">if</span>&nbsp;<span class="ident" id="8455548">_</span><span class="op" id="8455549">,</span>&nbsp;<span class="ident" id="8455551">err</span>&nbsp;<span class="op" id="8455555">=</span>&nbsp;<span class="ident" id="8455557">tmpl</span><span class="op" id="8455561">.</span><span class="ident" id="8455562">New</span><span class="op" id="8455565">(</span><span class="string" id="8455566">&#34;tmpl2&#34;</span><span class="op" id="8455573">)</span><span class="op" id="8455574">.</span><span class="ident" id="8455575">Parse</span><span class="op" id="8455580">(</span><span class="string" id="8455581">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="8455610">)</span><span class="op" id="8455611">;</span>&nbsp;<span class="ident" id="8455613">err</span>&nbsp;<span class="op" id="8455617">==</span>&nbsp;<span class="ident" id="8455620">nil</span>&nbsp;<span class="op" id="8455624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8455628">t</span><span class="op" id="8455629">.</span><span class="ident" id="8455630">Fatal</span><span class="op" id="8455635">(</span><span class="string" id="8455636">&#34;expected&nbsp;error&#34;</span><span class="op" id="8455652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8455655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8455658">if</span>&nbsp;<span class="op" id="8455661">!</span><span class="ident" id="8455662">strings</span><span class="op" id="8455669">.</span><span class="ident" id="8455670">Contains</span><span class="op" id="8455678">(</span><span class="ident" id="8455679">err</span><span class="op" id="8455682">.</span><span class="ident" id="8455683">Error</span><span class="op" id="8455688">(</span><span class="op" id="8455689">)</span><span class="op" id="8455690">,</span>&nbsp;<span class="string" id="8455692">&#34;redefinition&#34;</span><span class="op" id="8455706">)</span>&nbsp;<span class="op" id="8455708">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8455712">t</span><span class="op" id="8455713">.</span><span class="ident" id="8455714">Fatalf</span><span class="op" id="8455720">(</span><span class="string" id="8455721">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="8455758">,</span>&nbsp;<span class="ident" id="8455760">err</span><span class="op" id="8455763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8455766">}</span><br>
<span class="lineno"></span><span class="op" id="8455768">}</span>
</div>
</body>
</html>
