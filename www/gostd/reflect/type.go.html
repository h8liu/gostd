<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>reflect</h2>
<ul>
<li><a href="/gostd/reflect/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/reflect/deepequal.go.html">deepequal.go</a></li>
<li><a href="/gostd/reflect/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/reflect/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/reflect/makefunc.go.html">makefunc.go</a></li>
<li><a href="/gostd/reflect/set_test.go.html">set_test.go</a></li>
<li><a href="/gostd/reflect/tostring_test.go.html">tostring_test.go</a></li>
<li><a href="/gostd/reflect/type.go.html" class="current">type.go</a></li>
<li><a href="/gostd/reflect/value.go.html">value.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2815642">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2815697">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2815751">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2815802">//&nbsp;Package&nbsp;reflect&nbsp;implements&nbsp;run-time&nbsp;reflection,&nbsp;allowing&nbsp;a&nbsp;program&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2815875">//&nbsp;manipulate&nbsp;objects&nbsp;with&nbsp;arbitrary&nbsp;types.&nbsp;&nbsp;The&nbsp;typical&nbsp;use&nbsp;is&nbsp;to&nbsp;take&nbsp;a&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2815955">//&nbsp;with&nbsp;static&nbsp;type&nbsp;interface{}&nbsp;and&nbsp;extract&nbsp;its&nbsp;dynamic&nbsp;type&nbsp;information&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2816031">//&nbsp;calling&nbsp;TypeOf,&nbsp;which&nbsp;returns&nbsp;a&nbsp;Type.</span><br>
<span class="lineno"></span><span class="comment" id="2816072">//</span><br>
<span class="lineno">10</span><span class="comment" id="2816075">//&nbsp;A&nbsp;call&nbsp;to&nbsp;ValueOf&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;the&nbsp;run-time&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="2816144">//&nbsp;Zero&nbsp;takes&nbsp;a&nbsp;Type&nbsp;and&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;a&nbsp;zero&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2816211">//&nbsp;for&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2816229">//</span><br>
<span class="lineno"></span><span class="comment" id="2816232">//&nbsp;See&nbsp;&#34;The&nbsp;Laws&nbsp;of&nbsp;Reflection&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;reflection&nbsp;in&nbsp;Go:</span><br>
<span class="lineno">15</span><span class="comment" id="2816305">//&nbsp;http://golang.org/doc/articles/laws_of_reflection.html</span><br>
<span class="lineno"></span><span class="keyword" id="2816363">package</span>&nbsp;<span class="ident" id="2816371">reflect</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2816380">import</span>&nbsp;<span class="op" id="2816387">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2816390">&#34;runtime&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2816401">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2816412">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2816420">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2816429">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2816432">//&nbsp;Type&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2816476">//</span><br>
<span class="lineno"></span><span class="comment" id="2816479">//&nbsp;Not&nbsp;all&nbsp;methods&nbsp;apply&nbsp;to&nbsp;all&nbsp;kinds&nbsp;of&nbsp;types.&nbsp;&nbsp;Restrictions,</span><br>
<span class="lineno"></span><span class="comment" id="2816542">//&nbsp;if&nbsp;any,&nbsp;are&nbsp;noted&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;each&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2816601">//&nbsp;Use&nbsp;the&nbsp;Kind&nbsp;method&nbsp;to&nbsp;find&nbsp;out&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;before</span><br>
<span class="lineno">30</span><span class="comment" id="2816660">//&nbsp;calling&nbsp;kind-specific&nbsp;methods.&nbsp;&nbsp;Calling&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span><span class="comment" id="2816712">//&nbsp;inappropriate&nbsp;to&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;causes&nbsp;a&nbsp;run-time&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="2816774">type</span>&nbsp;<span class="ident" id="2816779">Type</span>&nbsp;<span class="keyword" id="2816784">interface</span>&nbsp;<span class="op" id="2816794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2816797">//&nbsp;Methods&nbsp;applicable&nbsp;to&nbsp;all&nbsp;types.</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2816835">//&nbsp;Align&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2816890">//&nbsp;this&nbsp;type&nbsp;when&nbsp;allocated&nbsp;in&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2816930">Align</span><span class="op" id="2816935">(</span><span class="op" id="2816936">)</span>&nbsp;<span class="builtintype" id="2816938">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2816944">//&nbsp;FieldAlign&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817004">//&nbsp;this&nbsp;type&nbsp;when&nbsp;used&nbsp;as&nbsp;a&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817052">FieldAlign</span><span class="op" id="2817062">(</span><span class="op" id="2817063">)</span>&nbsp;<span class="builtintype" id="2817065">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817071">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817132">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumMethod()).</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817189">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817193">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817267">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817336">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817340">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817410">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817479">Method</span><span class="op" id="2817485">(</span><span class="builtintype" id="2817486">int</span><span class="op" id="2817489">)</span>&nbsp;<span class="ident" id="2817491">Method</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817500">//&nbsp;MethodByName&nbsp;returns&nbsp;the&nbsp;method&nbsp;with&nbsp;that&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817565">//&nbsp;method&nbsp;set&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;method&nbsp;was&nbsp;found.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817630">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817634">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817708">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817777">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817781">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817851">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817920">MethodByName</span><span class="op" id="2817932">(</span><span class="builtintype" id="2817933">string</span><span class="op" id="2817939">)</span>&nbsp;<span class="op" id="2817941">(</span><span class="ident" id="2817942">Method</span><span class="op" id="2817948">,</span>&nbsp;<span class="builtintype" id="2817950">bool</span><span class="op" id="2817954">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817958">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818028">NumMethod</span><span class="op" id="2818037">(</span><span class="op" id="2818038">)</span>&nbsp;<span class="builtintype" id="2818040">int</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818046">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;type&#39;s&nbsp;name&nbsp;within&nbsp;its&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818099">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;empty&nbsp;string&nbsp;for&nbsp;unnamed&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818149">Name</span><span class="op" id="2818153">(</span><span class="op" id="2818154">)</span>&nbsp;<span class="builtintype" id="2818156">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818165">//&nbsp;PkgPath&nbsp;returns&nbsp;a&nbsp;named&nbsp;type&#39;s&nbsp;package&nbsp;path,&nbsp;that&nbsp;is,&nbsp;the&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818239">//&nbsp;that&nbsp;uniquely&nbsp;identifies&nbsp;the&nbsp;package,&nbsp;such&nbsp;as&nbsp;&#34;encoding/base64&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818308">//&nbsp;If&nbsp;the&nbsp;type&nbsp;was&nbsp;predeclared&nbsp;(string,&nbsp;error)&nbsp;or&nbsp;unnamed&nbsp;(*T,&nbsp;struct{},&nbsp;[]int),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818390">//&nbsp;the&nbsp;package&nbsp;path&nbsp;will&nbsp;be&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818437">PkgPath</span><span class="op" id="2818444">(</span><span class="op" id="2818445">)</span>&nbsp;<span class="builtintype" id="2818447">string</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818456">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;needed&nbsp;to&nbsp;store</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818509">//&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;given&nbsp;type;&nbsp;it&nbsp;is&nbsp;analogous&nbsp;to&nbsp;unsafe.Sizeof.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818574">Size</span><span class="op" id="2818578">(</span><span class="op" id="2818579">)</span>&nbsp;<span class="builtintype" id="2818581">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818591">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818647">//&nbsp;The&nbsp;string&nbsp;representation&nbsp;may&nbsp;use&nbsp;shortened&nbsp;package&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818709">//&nbsp;(e.g.,&nbsp;base64&nbsp;instead&nbsp;of&nbsp;&#34;encoding/base64&#34;)&nbsp;and&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818768">//&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique&nbsp;among&nbsp;types.&nbsp;&nbsp;To&nbsp;test&nbsp;for&nbsp;equality,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818832">//&nbsp;compare&nbsp;the&nbsp;Types&nbsp;directly.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818864">String</span><span class="op" id="2818870">(</span><span class="op" id="2818871">)</span>&nbsp;<span class="builtintype" id="2818873">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818882">//&nbsp;Kind&nbsp;returns&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818931">Kind</span><span class="op" id="2818935">(</span><span class="op" id="2818936">)</span>&nbsp;<span class="ident" id="2818938">Kind</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818945">//&nbsp;Implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2819018">Implements</span><span class="op" id="2819028">(</span><span class="ident" id="2819029">u</span>&nbsp;<span class="ident" id="2819031">Type</span><span class="op" id="2819035">)</span>&nbsp;<span class="builtintype" id="2819037">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819044">//&nbsp;AssignableTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;assignable&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2819122">AssignableTo</span><span class="op" id="2819134">(</span><span class="ident" id="2819135">u</span>&nbsp;<span class="ident" id="2819137">Type</span><span class="op" id="2819141">)</span>&nbsp;<span class="builtintype" id="2819143">bool</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819150">//&nbsp;ConvertibleTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;convertible&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2819230">ConvertibleTo</span><span class="op" id="2819243">(</span><span class="ident" id="2819244">u</span>&nbsp;<span class="ident" id="2819246">Type</span><span class="op" id="2819250">)</span>&nbsp;<span class="builtintype" id="2819252">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819259">//&nbsp;Comparable&nbsp;returns&nbsp;true&nbsp;if&nbsp;values&nbsp;of&nbsp;this&nbsp;type&nbsp;are&nbsp;comparable.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2819326">Comparable</span><span class="op" id="2819336">(</span><span class="op" id="2819337">)</span>&nbsp;<span class="builtintype" id="2819339">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819346">//&nbsp;Methods&nbsp;applicable&nbsp;only&nbsp;to&nbsp;some&nbsp;types,&nbsp;depending&nbsp;on&nbsp;Kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819408">//&nbsp;The&nbsp;methods&nbsp;allowed&nbsp;for&nbsp;each&nbsp;kind&nbsp;are:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819451">//</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819455">//&nbsp;&nbsp;&nbsp;&nbsp;Int*,&nbsp;Uint*,&nbsp;Float*,&nbsp;Complex*:&nbsp;Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819495">//&nbsp;&nbsp;&nbsp;&nbsp;Array:&nbsp;Elem,&nbsp;Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819516">//&nbsp;&nbsp;&nbsp;&nbsp;Chan:&nbsp;ChanDir,&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819540">//&nbsp;&nbsp;&nbsp;&nbsp;Func:&nbsp;In,&nbsp;NumIn,&nbsp;Out,&nbsp;NumOut,&nbsp;IsVariadic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819586">//&nbsp;&nbsp;&nbsp;&nbsp;Map:&nbsp;Key,&nbsp;Elem</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819605">//&nbsp;&nbsp;&nbsp;&nbsp;Ptr:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819619">//&nbsp;&nbsp;&nbsp;&nbsp;Slice:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819635">//&nbsp;&nbsp;&nbsp;&nbsp;Struct:&nbsp;Field,&nbsp;FieldByIndex,&nbsp;FieldByName,&nbsp;FieldByNameFunc,&nbsp;NumField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819708">//&nbsp;Bits&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;type&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819755">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819806">//&nbsp;sized&nbsp;or&nbsp;unsized&nbsp;Int,&nbsp;Uint,&nbsp;Float,&nbsp;or&nbsp;Complex&nbsp;kinds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2819863">Bits</span><span class="op" id="2819867">(</span><span class="op" id="2819868">)</span>&nbsp;<span class="builtintype" id="2819870">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819876">//&nbsp;ChanDir&nbsp;returns&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819924">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2819970">ChanDir</span><span class="op" id="2819977">(</span><span class="op" id="2819978">)</span>&nbsp;<span class="ident" id="2819980">ChanDir</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819990">//&nbsp;IsVariadic&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;final&nbsp;input&nbsp;parameter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820061">//&nbsp;is&nbsp;a&nbsp;&#34;...&#34;&nbsp;parameter.&nbsp;&nbsp;If&nbsp;so,&nbsp;t.In(t.NumIn()&nbsp;-&nbsp;1)&nbsp;returns&nbsp;the&nbsp;parameter&#39;s</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820139">//&nbsp;implicit&nbsp;actual&nbsp;type&nbsp;[]T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820169">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820173">//&nbsp;For&nbsp;concreteness,&nbsp;if&nbsp;t&nbsp;represents&nbsp;func(x&nbsp;int,&nbsp;y&nbsp;...&nbsp;float64),&nbsp;then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820244">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820248">//&nbsp;&nbsp;&nbsp;&nbsp;t.NumIn()&nbsp;==&nbsp;2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820267">//&nbsp;&nbsp;&nbsp;&nbsp;t.In(0)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;int&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820309">//&nbsp;&nbsp;&nbsp;&nbsp;t.In(1)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;[]float64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820357">//&nbsp;&nbsp;&nbsp;&nbsp;t.IsVariadic()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820384">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820388">//&nbsp;IsVariadic&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820442">IsVariadic</span><span class="op" id="2820452">(</span><span class="op" id="2820453">)</span>&nbsp;<span class="builtintype" id="2820455">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820462">//&nbsp;Elem&nbsp;returns&nbsp;a&nbsp;type&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820502">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array,&nbsp;Chan,&nbsp;Map,&nbsp;Ptr,&nbsp;or&nbsp;Slice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820575">Elem</span><span class="op" id="2820579">(</span><span class="op" id="2820580">)</span>&nbsp;<span class="ident" id="2820582">Type</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820589">//&nbsp;Field&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820635">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820683">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumField()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820739">Field</span><span class="op" id="2820744">(</span><span class="ident" id="2820745">i</span>&nbsp;<span class="builtintype" id="2820747">int</span><span class="op" id="2820750">)</span>&nbsp;<span class="ident" id="2820752">StructField</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820766">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820822">//&nbsp;to&nbsp;the&nbsp;index&nbsp;sequence.&nbsp;&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820884">//&nbsp;successively&nbsp;for&nbsp;each&nbsp;index&nbsp;i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820919">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820967">FieldByIndex</span><span class="op" id="2820979">(</span><span class="ident" id="2820980">index</span>&nbsp;<span class="op" id="2820986">[</span><span class="op" id="2820987">]</span><span class="builtintype" id="2820988">int</span><span class="op" id="2820991">)</span>&nbsp;<span class="ident" id="2820993">StructField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821007">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821068">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821121">FieldByName</span><span class="op" id="2821132">(</span><span class="ident" id="2821133">name</span>&nbsp;<span class="builtintype" id="2821138">string</span><span class="op" id="2821144">)</span>&nbsp;<span class="op" id="2821146">(</span><span class="ident" id="2821147">StructField</span><span class="op" id="2821158">,</span>&nbsp;<span class="builtintype" id="2821160">bool</span><span class="op" id="2821164">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821168">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;first&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821231">//&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821297">//&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821322">FieldByNameFunc</span><span class="op" id="2821337">(</span><span class="ident" id="2821338">match</span>&nbsp;<span class="keyword" id="2821344">func</span><span class="op" id="2821348">(</span><span class="builtintype" id="2821349">string</span><span class="op" id="2821355">)</span>&nbsp;<span class="builtintype" id="2821357">bool</span><span class="op" id="2821361">)</span>&nbsp;<span class="op" id="2821363">(</span><span class="ident" id="2821364">StructField</span><span class="op" id="2821375">,</span>&nbsp;<span class="builtintype" id="2821377">bool</span><span class="op" id="2821381">)</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821385">//&nbsp;In&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;input&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821452">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821498">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumIn()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821551">In</span><span class="op" id="2821553">(</span><span class="ident" id="2821554">i</span>&nbsp;<span class="builtintype" id="2821556">int</span><span class="op" id="2821559">)</span>&nbsp;<span class="ident" id="2821561">Type</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821568">//&nbsp;Key&nbsp;returns&nbsp;a&nbsp;map&nbsp;type&#39;s&nbsp;key&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821607">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821652">Key</span><span class="op" id="2821655">(</span><span class="op" id="2821656">)</span>&nbsp;<span class="ident" id="2821658">Type</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821665">//&nbsp;Len&nbsp;returns&nbsp;an&nbsp;array&nbsp;type&#39;s&nbsp;length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821705">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821752">Len</span><span class="op" id="2821755">(</span><span class="op" id="2821756">)</span>&nbsp;<span class="builtintype" id="2821758">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821764">//&nbsp;NumField&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;field&nbsp;count.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821814">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821862">NumField</span><span class="op" id="2821870">(</span><span class="op" id="2821871">)</span>&nbsp;<span class="builtintype" id="2821873">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821879">//&nbsp;NumIn&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;input&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821938">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821984">NumIn</span><span class="op" id="2821989">(</span><span class="op" id="2821990">)</span>&nbsp;<span class="builtintype" id="2821992">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821998">//&nbsp;NumOut&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;output&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2822059">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822105">NumOut</span><span class="op" id="2822111">(</span><span class="op" id="2822112">)</span>&nbsp;<span class="builtintype" id="2822114">int</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2822120">//&nbsp;Out&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;output&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2822189">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2822235">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumOut()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822289">Out</span><span class="op" id="2822292">(</span><span class="ident" id="2822293">i</span>&nbsp;<span class="builtintype" id="2822295">int</span><span class="op" id="2822298">)</span>&nbsp;<span class="ident" id="2822300">Type</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822307">common</span><span class="op" id="2822313">(</span><span class="op" id="2822314">)</span>&nbsp;<span class="op" id="2822316">*</span><span class="ident" id="2822317">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822324">uncommon</span><span class="op" id="2822332">(</span><span class="op" id="2822333">)</span>&nbsp;<span class="op" id="2822335">*</span><span class="ident" id="2822336">uncommonType</span><br>
<span class="lineno"></span><span class="op" id="2822349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="2822352">//&nbsp;BUG(rsc):&nbsp;FieldByName&nbsp;and&nbsp;related&nbsp;functions&nbsp;consider&nbsp;struct&nbsp;field&nbsp;names&nbsp;to&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span><span class="comment" id="2822439">//&nbsp;if&nbsp;the&nbsp;names&nbsp;are&nbsp;equal,&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;unexported&nbsp;names&nbsp;originating</span><br>
<span class="lineno"></span><span class="comment" id="2822512">//&nbsp;in&nbsp;different&nbsp;packages.&nbsp;The&nbsp;practical&nbsp;effect&nbsp;of&nbsp;this&nbsp;is&nbsp;that&nbsp;the&nbsp;result&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2822589">//&nbsp;t.FieldByName(&#34;x&#34;)&nbsp;is&nbsp;not&nbsp;well&nbsp;defined&nbsp;if&nbsp;the&nbsp;struct&nbsp;type&nbsp;t&nbsp;contains</span><br>
<span class="lineno"></span><span class="comment" id="2822661">//&nbsp;multiple&nbsp;fields&nbsp;named&nbsp;x&nbsp;(embedded&nbsp;from&nbsp;different&nbsp;packages).</span><br>
<span class="lineno">200</span><span class="comment" id="2822724">//&nbsp;FieldByName&nbsp;may&nbsp;return&nbsp;one&nbsp;of&nbsp;the&nbsp;fields&nbsp;named&nbsp;x&nbsp;or&nbsp;may&nbsp;report&nbsp;that&nbsp;there&nbsp;are&nbsp;none.</span><br>
<span class="lineno"></span><span class="comment" id="2822811">//&nbsp;See&nbsp;golang.org/issue/4876&nbsp;for&nbsp;more&nbsp;details.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2822859">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;These&nbsp;data&nbsp;structures&nbsp;are&nbsp;known&nbsp;to&nbsp;the&nbsp;compiler&nbsp;(../../cmd/gc/reflect.c).<br>
<span class="lineno">205</span>&nbsp;*&nbsp;A&nbsp;few&nbsp;are&nbsp;known&nbsp;to&nbsp;../runtime/type.go&nbsp;to&nbsp;convey&nbsp;to&nbsp;debuggers.<br>
<span class="lineno"></span>&nbsp;*&nbsp;They&nbsp;are&nbsp;also&nbsp;known&nbsp;to&nbsp;../runtime/type.h.<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2823054">//&nbsp;A&nbsp;Kind&nbsp;represents&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;type&nbsp;that&nbsp;a&nbsp;Type&nbsp;represents.</span><br>
<span class="lineno">210</span><span class="comment" id="2823125">//&nbsp;The&nbsp;zero&nbsp;Kind&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;kind.</span><br>
<span class="lineno"></span><span class="keyword" id="2823163">type</span>&nbsp;<span class="ident" id="2823168">Kind</span>&nbsp;<span class="builtintype" id="2823173">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2823179">const</span>&nbsp;<span class="op" id="2823185">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823188">Invalid</span>&nbsp;<span class="ident" id="2823196">Kind</span>&nbsp;<span class="op" id="2823201">=</span>&nbsp;<span class="ident" id="2823203">iota</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823209">Bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823215">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823220">Int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823226">Int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823233">Int32</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823240">Int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823247">Uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823253">Uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823260">Uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823268">Uint32</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823276">Uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823284">Uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823293">Float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823302">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823311">Complex64</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823322">Complex128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823334">Array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823341">Chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823347">Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823353">Interface</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823364">Map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823369">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823374">Slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823381">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823389">Struct</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823397">UnsafePointer</span><br>
<span class="lineno"></span><span class="op" id="2823411">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2823414">//&nbsp;rtype&nbsp;is&nbsp;the&nbsp;common&nbsp;implementation&nbsp;of&nbsp;most&nbsp;values.</span><br>
<span class="lineno"></span><span class="comment" id="2823468">//&nbsp;It&nbsp;is&nbsp;embedded&nbsp;in&nbsp;other,&nbsp;public&nbsp;struct&nbsp;types,&nbsp;but&nbsp;always</span><br>
<span class="lineno">245</span><span class="comment" id="2823528">//&nbsp;with&nbsp;a&nbsp;unique&nbsp;tag&nbsp;like&nbsp;`reflect:&#34;array&#34;`&nbsp;or&nbsp;`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="2823591">//&nbsp;so&nbsp;that&nbsp;code&nbsp;cannot&nbsp;convert&nbsp;from,&nbsp;say,&nbsp;*arrayType&nbsp;to&nbsp;*ptrType.</span><br>
<span class="lineno"></span><span class="keyword" id="2823657">type</span>&nbsp;<span class="ident" id="2823662">rtype</span>&nbsp;<span class="keyword" id="2823668">struct</span>&nbsp;<span class="op" id="2823675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823678">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2823692">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823701">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2823715">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2823733">//&nbsp;hash&nbsp;of&nbsp;type;&nbsp;avoids&nbsp;computation&nbsp;in&nbsp;hash&nbsp;tables</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823785">_</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2823799">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2823817">//&nbsp;unused/padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823836">align</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2823850">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2823868">//&nbsp;alignment&nbsp;of&nbsp;variable&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823909">fieldAlign</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2823923">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2823941">//&nbsp;alignment&nbsp;of&nbsp;struct&nbsp;field&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823986">kind</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2824000">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2824018">//&nbsp;enumeration&nbsp;for&nbsp;C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2824040">alg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2824054">*</span><span class="ident" id="2824055">typeAlg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2824072">//&nbsp;algorithm&nbsp;table&nbsp;(../runtime/runtime.h:/Alg)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2824120">gc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2824134">[</span><span class="num" id="2824135">2</span><span class="op" id="2824136">]</span><span class="ident" id="2824137">unsafe</span><span class="op" id="2824143">.</span><span class="ident" id="2824144">Pointer</span>&nbsp;<span class="comment" id="2824152">//&nbsp;garbage&nbsp;collection&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2824180">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2824194">*</span><span class="builtintype" id="2824195">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2824212">//&nbsp;string&nbsp;form;&nbsp;unnecessary&nbsp;but&nbsp;undeniably&nbsp;useful</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2824263">*</span><span class="ident" id="2824264">uncommonType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2824295">//&nbsp;(relatively)&nbsp;uncommon&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2824328">ptrToThis</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2824342">*</span><span class="ident" id="2824343">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2824360">//&nbsp;type&nbsp;for&nbsp;pointer&nbsp;to&nbsp;this&nbsp;type,&nbsp;if&nbsp;used&nbsp;in&nbsp;binary&nbsp;or&nbsp;has&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2824428">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2824442">unsafe</span><span class="op" id="2824448">.</span><span class="ident" id="2824449">Pointer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2824460">//&nbsp;pointer&nbsp;to&nbsp;zero&nbsp;value</span><br>
<span class="lineno">260</span><span class="op" id="2824485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2824488">type</span>&nbsp;<span class="ident" id="2824493">typeAlg</span>&nbsp;<span class="keyword" id="2824501">struct</span>&nbsp;<span class="op" id="2824508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2824511">//&nbsp;function&nbsp;for&nbsp;hashing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2824557">//&nbsp;(ptr&nbsp;to&nbsp;object,&nbsp;size,&nbsp;seed)&nbsp;-&gt;&nbsp;hash</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2824597">hash</span>&nbsp;<span class="keyword" id="2824602">func</span><span class="op" id="2824606">(</span><span class="ident" id="2824607">unsafe</span><span class="op" id="2824613">.</span><span class="ident" id="2824614">Pointer</span><span class="op" id="2824621">,</span>&nbsp;<span class="builtintype" id="2824623">uintptr</span><span class="op" id="2824630">,</span>&nbsp;<span class="builtintype" id="2824632">uintptr</span><span class="op" id="2824639">)</span>&nbsp;<span class="builtintype" id="2824641">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2824650">//&nbsp;function&nbsp;for&nbsp;comparing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2824698">//&nbsp;(ptr&nbsp;to&nbsp;object&nbsp;A,&nbsp;ptr&nbsp;to&nbsp;object&nbsp;B,&nbsp;size)&nbsp;-&gt;&nbsp;==?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2824750">equal</span>&nbsp;<span class="keyword" id="2824756">func</span><span class="op" id="2824760">(</span><span class="ident" id="2824761">unsafe</span><span class="op" id="2824767">.</span><span class="ident" id="2824768">Pointer</span><span class="op" id="2824775">,</span>&nbsp;<span class="ident" id="2824777">unsafe</span><span class="op" id="2824783">.</span><span class="ident" id="2824784">Pointer</span><span class="op" id="2824791">,</span>&nbsp;<span class="builtintype" id="2824793">uintptr</span><span class="op" id="2824800">)</span>&nbsp;<span class="builtintype" id="2824802">bool</span><br>
<span class="lineno"></span><span class="op" id="2824807">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="2824810">//&nbsp;Method&nbsp;on&nbsp;non-interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2824842">type</span>&nbsp;<span class="ident" id="2824847">method</span>&nbsp;<span class="keyword" id="2824854">struct</span>&nbsp;<span class="op" id="2824861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2824864">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2824872">*</span><span class="builtintype" id="2824873">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2824887">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2824906">pkgPath</span>&nbsp;<span class="op" id="2824914">*</span><span class="builtintype" id="2824915">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2824929">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2824979">mtyp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2824987">*</span><span class="ident" id="2824988">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2825002">//&nbsp;method&nbsp;type&nbsp;(without&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2825037">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2825045">*</span><span class="ident" id="2825046">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2825060">//&nbsp;.(*FuncType)&nbsp;underneath&nbsp;(with&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2825104">ifn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2825112">unsafe</span><span class="op" id="2825118">.</span><span class="ident" id="2825119">Pointer</span>&nbsp;<span class="comment" id="2825127">//&nbsp;fn&nbsp;used&nbsp;in&nbsp;interface&nbsp;call&nbsp;(one-word&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2825177">tfn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2825185">unsafe</span><span class="op" id="2825191">.</span><span class="ident" id="2825192">Pointer</span>&nbsp;<span class="comment" id="2825200">//&nbsp;fn&nbsp;used&nbsp;for&nbsp;normal&nbsp;method&nbsp;call</span><br>
<span class="lineno"></span><span class="op" id="2825234">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="comment" id="2825237">//&nbsp;uncommonType&nbsp;is&nbsp;present&nbsp;only&nbsp;for&nbsp;types&nbsp;with&nbsp;names&nbsp;or&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="2825301">//&nbsp;(if&nbsp;T&nbsp;is&nbsp;a&nbsp;named&nbsp;type,&nbsp;the&nbsp;uncommonTypes&nbsp;for&nbsp;T&nbsp;and&nbsp;*T&nbsp;have&nbsp;methods).</span><br>
<span class="lineno"></span><span class="comment" id="2825373">//&nbsp;Using&nbsp;a&nbsp;pointer&nbsp;to&nbsp;this&nbsp;struct&nbsp;reduces&nbsp;the&nbsp;overall&nbsp;size&nbsp;required</span><br>
<span class="lineno"></span><span class="comment" id="2825441">//&nbsp;to&nbsp;describe&nbsp;an&nbsp;unnamed&nbsp;type&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno">285</span><span class="keyword" id="2825489">type</span>&nbsp;<span class="ident" id="2825494">uncommonType</span>&nbsp;<span class="keyword" id="2825507">struct</span>&nbsp;<span class="op" id="2825514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2825517">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2825525">*</span><span class="builtintype" id="2825526">string</span>&nbsp;&nbsp;<span class="comment" id="2825534">//&nbsp;name&nbsp;of&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2825551">pkgPath</span>&nbsp;<span class="op" id="2825559">*</span><span class="builtintype" id="2825560">string</span>&nbsp;&nbsp;<span class="comment" id="2825568">//&nbsp;import&nbsp;path;&nbsp;nil&nbsp;for&nbsp;built-in&nbsp;types&nbsp;like&nbsp;int,&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2825625">methods</span>&nbsp;<span class="op" id="2825633">[</span><span class="op" id="2825634">]</span><span class="ident" id="2825635">method</span>&nbsp;<span class="comment" id="2825642">//&nbsp;methods&nbsp;associated&nbsp;with&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2825674">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="2825677">//&nbsp;ChanDir&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno"></span><span class="keyword" id="2825727">type</span>&nbsp;<span class="ident" id="2825732">ChanDir</span>&nbsp;<span class="builtintype" id="2825740">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2825745">const</span>&nbsp;<span class="op" id="2825751">(</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2825754">RecvDir</span>&nbsp;<span class="ident" id="2825762">ChanDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2825782">=</span>&nbsp;<span class="num" id="2825784">1</span>&nbsp;<span class="op" id="2825786">&lt;&lt;</span>&nbsp;<span class="ident" id="2825789">iota</span>&nbsp;<span class="comment" id="2825794">//&nbsp;&lt;-chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2825805">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2825845">//&nbsp;chan&lt;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2825856">BothDir</span>&nbsp;<span class="op" id="2825864">=</span>&nbsp;<span class="ident" id="2825866">RecvDir</span>&nbsp;<span class="op" id="2825874">|</span>&nbsp;<span class="ident" id="2825876">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2825896">//&nbsp;chan</span><br>
<span class="lineno"></span><span class="op" id="2825904">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="2825907">//&nbsp;arrayType&nbsp;represents&nbsp;a&nbsp;fixed&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2825951">type</span>&nbsp;<span class="ident" id="2825956">arrayType</span>&nbsp;<span class="keyword" id="2825966">struct</span>&nbsp;<span class="op" id="2825973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2825976">rtype</span>&nbsp;<span class="string" id="2825982">`reflect:&#34;array&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826001">elem</span>&nbsp;&nbsp;<span class="op" id="2826007">*</span><span class="ident" id="2826008">rtype</span>&nbsp;<span class="comment" id="2826014">//&nbsp;array&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826037">slice</span>&nbsp;<span class="op" id="2826043">*</span><span class="ident" id="2826044">rtype</span>&nbsp;<span class="comment" id="2826050">//&nbsp;slice&nbsp;type</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2826065">len</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2826071">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2826079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2826082">//&nbsp;chanType&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2826121">type</span>&nbsp;<span class="ident" id="2826126">chanType</span>&nbsp;<span class="keyword" id="2826135">struct</span>&nbsp;<span class="op" id="2826142">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826145">rtype</span>&nbsp;<span class="string" id="2826151">`reflect:&#34;chan&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826169">elem</span>&nbsp;&nbsp;<span class="op" id="2826175">*</span><span class="ident" id="2826176">rtype</span>&nbsp;&nbsp;<span class="comment" id="2826183">//&nbsp;channel&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826208">dir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2826214">uintptr</span>&nbsp;<span class="comment" id="2826222">//&nbsp;channel&nbsp;direction&nbsp;(ChanDir)</span><br>
<span class="lineno"></span><span class="op" id="2826253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2826256">//&nbsp;funcType&nbsp;represents&nbsp;a&nbsp;function&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2826296">type</span>&nbsp;<span class="ident" id="2826301">funcType</span>&nbsp;<span class="keyword" id="2826310">struct</span>&nbsp;<span class="op" id="2826317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826320">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2826330">`reflect:&#34;func&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826348">dotdotdot</span>&nbsp;<span class="builtintype" id="2826358">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2826367">//&nbsp;last&nbsp;input&nbsp;parameter&nbsp;is&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826399">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2826409">[</span><span class="op" id="2826410">]</span><span class="op" id="2826411">*</span><span class="ident" id="2826412">rtype</span>&nbsp;<span class="comment" id="2826418">//&nbsp;input&nbsp;parameter&nbsp;types</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826444">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2826454">[</span><span class="op" id="2826455">]</span><span class="op" id="2826456">*</span><span class="ident" id="2826457">rtype</span>&nbsp;<span class="comment" id="2826463">//&nbsp;output&nbsp;parameter&nbsp;types</span><br>
<span class="lineno"></span><span class="op" id="2826489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2826492">//&nbsp;imethod&nbsp;represents&nbsp;a&nbsp;method&nbsp;on&nbsp;an&nbsp;interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2826544">type</span>&nbsp;<span class="ident" id="2826549">imethod</span>&nbsp;<span class="keyword" id="2826557">struct</span>&nbsp;<span class="op" id="2826564">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826567">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2826575">*</span><span class="builtintype" id="2826576">string</span>&nbsp;<span class="comment" id="2826583">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826602">pkgPath</span>&nbsp;<span class="op" id="2826610">*</span><span class="builtintype" id="2826611">string</span>&nbsp;<span class="comment" id="2826618">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826668">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2826676">*</span><span class="ident" id="2826677">rtype</span>&nbsp;&nbsp;<span class="comment" id="2826684">//&nbsp;.(*FuncType)&nbsp;underneath</span><br>
<span class="lineno"></span><span class="op" id="2826711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="comment" id="2826714">//&nbsp;interfaceType&nbsp;represents&nbsp;an&nbsp;interface&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2826761">type</span>&nbsp;<span class="ident" id="2826766">interfaceType</span>&nbsp;<span class="keyword" id="2826780">struct</span>&nbsp;<span class="op" id="2826787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826790">rtype</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2826798">`reflect:&#34;interface&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826821">methods</span>&nbsp;<span class="op" id="2826829">[</span><span class="op" id="2826830">]</span><span class="ident" id="2826831">imethod</span>&nbsp;<span class="comment" id="2826839">//&nbsp;sorted&nbsp;by&nbsp;hash</span><br>
<span class="lineno"></span><span class="op" id="2826857">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="comment" id="2826860">//&nbsp;mapType&nbsp;represents&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2826894">type</span>&nbsp;<span class="ident" id="2826899">mapType</span>&nbsp;<span class="keyword" id="2826907">struct</span>&nbsp;<span class="op" id="2826914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826917">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2826931">`reflect:&#34;map&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826948">key</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2826962">*</span><span class="ident" id="2826963">rtype</span>&nbsp;<span class="comment" id="2826969">//&nbsp;map&nbsp;key&nbsp;type</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2826986">elem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2827000">*</span><span class="ident" id="2827001">rtype</span>&nbsp;<span class="comment" id="2827007">//&nbsp;map&nbsp;element&nbsp;(value)&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827036">bucket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2827050">*</span><span class="ident" id="2827051">rtype</span>&nbsp;<span class="comment" id="2827057">//&nbsp;internal&nbsp;bucket&nbsp;structure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827087">hmap</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2827101">*</span><span class="ident" id="2827102">rtype</span>&nbsp;<span class="comment" id="2827108">//&nbsp;internal&nbsp;map&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827132">keysize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2827146">uint8</span>&nbsp;&nbsp;<span class="comment" id="2827153">//&nbsp;size&nbsp;of&nbsp;key&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827174">indirectkey</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2827188">uint8</span>&nbsp;&nbsp;<span class="comment" id="2827195">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;key&nbsp;instead&nbsp;of&nbsp;key&nbsp;itself</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827238">valuesize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2827252">uint8</span>&nbsp;&nbsp;<span class="comment" id="2827259">//&nbsp;size&nbsp;of&nbsp;value&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827282">indirectvalue</span>&nbsp;<span class="builtintype" id="2827296">uint8</span>&nbsp;&nbsp;<span class="comment" id="2827303">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;value&nbsp;instead&nbsp;of&nbsp;value&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827350">bucketsize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2827364">uint16</span>&nbsp;<span class="comment" id="2827371">//&nbsp;size&nbsp;of&nbsp;bucket</span><br>
<span class="lineno"></span><span class="op" id="2827389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="2827392">//&nbsp;ptrType&nbsp;represents&nbsp;a&nbsp;pointer&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2827430">type</span>&nbsp;<span class="ident" id="2827435">ptrType</span>&nbsp;<span class="keyword" id="2827443">struct</span>&nbsp;<span class="op" id="2827450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827453">rtype</span>&nbsp;<span class="string" id="2827459">`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827476">elem</span>&nbsp;&nbsp;<span class="op" id="2827482">*</span><span class="ident" id="2827483">rtype</span>&nbsp;<span class="comment" id="2827489">//&nbsp;pointer&nbsp;element&nbsp;(pointed&nbsp;at)&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2827526">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2827529">//&nbsp;sliceType&nbsp;represents&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2827567">type</span>&nbsp;<span class="ident" id="2827572">sliceType</span>&nbsp;<span class="keyword" id="2827582">struct</span>&nbsp;<span class="op" id="2827589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827592">rtype</span>&nbsp;<span class="string" id="2827598">`reflect:&#34;slice&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827617">elem</span>&nbsp;&nbsp;<span class="op" id="2827623">*</span><span class="ident" id="2827624">rtype</span>&nbsp;<span class="comment" id="2827630">//&nbsp;slice&nbsp;element&nbsp;type</span><br>
<span class="lineno">360</span><span class="op" id="2827652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2827655">//&nbsp;Struct&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="2827671">type</span>&nbsp;<span class="ident" id="2827676">structField</span>&nbsp;<span class="keyword" id="2827688">struct</span>&nbsp;<span class="op" id="2827695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827698">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2827706">*</span><span class="builtintype" id="2827707">string</span>&nbsp;<span class="comment" id="2827714">//&nbsp;nil&nbsp;for&nbsp;embedded&nbsp;fields</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827742">pkgPath</span>&nbsp;<span class="op" id="2827750">*</span><span class="builtintype" id="2827751">string</span>&nbsp;<span class="comment" id="2827758">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827808">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2827816">*</span><span class="ident" id="2827817">rtype</span>&nbsp;&nbsp;<span class="comment" id="2827824">//&nbsp;type&nbsp;of&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827842">tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2827850">*</span><span class="builtintype" id="2827851">string</span>&nbsp;<span class="comment" id="2827858">//&nbsp;nil&nbsp;if&nbsp;no&nbsp;tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827876">offset</span>&nbsp;&nbsp;<span class="builtintype" id="2827884">uintptr</span>&nbsp;<span class="comment" id="2827892">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;field&nbsp;within&nbsp;struct</span><br>
<span class="lineno"></span><span class="op" id="2827930">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="2827933">//&nbsp;structType&nbsp;represents&nbsp;a&nbsp;struct&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2827973">type</span>&nbsp;<span class="ident" id="2827978">structType</span>&nbsp;<span class="keyword" id="2827989">struct</span>&nbsp;<span class="op" id="2827996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2827999">rtype</span>&nbsp;&nbsp;<span class="string" id="2828006">`reflect:&#34;struct&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2828026">fields</span>&nbsp;<span class="op" id="2828033">[</span><span class="op" id="2828034">]</span><span class="ident" id="2828035">structField</span>&nbsp;<span class="comment" id="2828047">//&nbsp;sorted&nbsp;by&nbsp;offset</span><br>
<span class="lineno">375</span><span class="op" id="2828067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2828070">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;knows&nbsp;the&nbsp;exact&nbsp;layout&nbsp;of&nbsp;all&nbsp;the&nbsp;data&nbsp;structures&nbsp;above.<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;does&nbsp;not&nbsp;know&nbsp;about&nbsp;the&nbsp;data&nbsp;structures&nbsp;and&nbsp;methods&nbsp;below.<br>
<span class="lineno">380</span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2828226">//&nbsp;Method&nbsp;represents&nbsp;a&nbsp;single&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2828264">type</span>&nbsp;<span class="ident" id="2828269">Method</span>&nbsp;<span class="keyword" id="2828276">struct</span>&nbsp;<span class="op" id="2828283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2828286">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;method&nbsp;name.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2828315">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2828388">//&nbsp;method&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;method&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2828458">//&nbsp;The&nbsp;combination&nbsp;of&nbsp;PkgPath&nbsp;and&nbsp;Name&nbsp;uniquely&nbsp;identifies&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2828527">//&nbsp;in&nbsp;a&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2828548">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2828609">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2828617">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2828625">PkgPath</span>&nbsp;<span class="builtintype" id="2828633">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2828642">Type</span>&nbsp;&nbsp;<span class="ident" id="2828648">Type</span>&nbsp;&nbsp;<span class="comment" id="2828654">//&nbsp;method&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2828670">Func</span>&nbsp;&nbsp;<span class="ident" id="2828676">Value</span>&nbsp;<span class="comment" id="2828682">//&nbsp;func&nbsp;with&nbsp;receiver&nbsp;as&nbsp;first&nbsp;argument</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2828723">Index</span>&nbsp;<span class="builtintype" id="2828729">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2828735">//&nbsp;index&nbsp;for&nbsp;Type.Method</span><br>
<span class="lineno"></span><span class="op" id="2828760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2828763">const</span>&nbsp;<span class="op" id="2828769">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2828772">kindDirectIface</span>&nbsp;<span class="op" id="2828788">=</span>&nbsp;<span class="num" id="2828790">1</span>&nbsp;<span class="op" id="2828792">&lt;&lt;</span>&nbsp;<span class="num" id="2828795">5</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2828798">kindGCProg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2828814">=</span>&nbsp;<span class="num" id="2828816">1</span>&nbsp;<span class="op" id="2828818">&lt;&lt;</span>&nbsp;<span class="num" id="2828821">6</span>&nbsp;<span class="comment" id="2828823">//&nbsp;Type.gc&nbsp;points&nbsp;to&nbsp;GC&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2828856">kindNoPointers</span>&nbsp;&nbsp;<span class="op" id="2828872">=</span>&nbsp;<span class="num" id="2828874">1</span>&nbsp;<span class="op" id="2828876">&lt;&lt;</span>&nbsp;<span class="num" id="2828879">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2828882">kindMask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2828898">=</span>&nbsp;<span class="op" id="2828900">(</span><span class="num" id="2828901">1</span>&nbsp;<span class="op" id="2828903">&lt;&lt;</span>&nbsp;<span class="num" id="2828906">5</span><span class="op" id="2828907">)</span>&nbsp;<span class="op" id="2828909">-</span>&nbsp;<span class="num" id="2828911">1</span><br>
<span class="lineno"></span><span class="op" id="2828913">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="keyword" id="2828916">func</span>&nbsp;<span class="op" id="2828921">(</span><span class="ident" id="2828922">k</span>&nbsp;<span class="ident" id="2828924">Kind</span><span class="op" id="2828928">)</span>&nbsp;<span class="ident" id="2828930">String</span><span class="op" id="2828936">(</span><span class="op" id="2828937">)</span>&nbsp;<span class="builtintype" id="2828939">string</span>&nbsp;<span class="op" id="2828946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2828949">if</span>&nbsp;<span class="builtintype" id="2828952">int</span><span class="op" id="2828955">(</span><span class="ident" id="2828956">k</span><span class="op" id="2828957">)</span>&nbsp;<span class="op" id="2828959">&lt;</span>&nbsp;<span class="builtinfunc" id="2828961">len</span><span class="op" id="2828964">(</span><span class="ident" id="2828965">kindNames</span><span class="op" id="2828974">)</span>&nbsp;<span class="op" id="2828976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2828980">return</span>&nbsp;<span class="ident" id="2828987">kindNames</span><span class="op" id="2828996">[</span><span class="ident" id="2828997">k</span><span class="op" id="2828998">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2829001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2829004">return</span>&nbsp;<span class="string" id="2829011">&#34;kind&#34;</span>&nbsp;<span class="op" id="2829018">+</span>&nbsp;<span class="ident" id="2829020">strconv</span><span class="op" id="2829027">.</span><span class="ident" id="2829028">Itoa</span><span class="op" id="2829032">(</span><span class="builtintype" id="2829033">int</span><span class="op" id="2829036">(</span><span class="ident" id="2829037">k</span><span class="op" id="2829038">)</span><span class="op" id="2829039">)</span><br>
<span class="lineno">410</span><span class="op" id="2829041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2829044">var</span>&nbsp;<span class="ident" id="2829048">kindNames</span>&nbsp;<span class="op" id="2829058">=</span>&nbsp;<span class="op" id="2829060">[</span><span class="op" id="2829061">]</span><span class="builtintype" id="2829062">string</span><span class="op" id="2829068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829071">Invalid</span><span class="op" id="2829078">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829086">&#34;invalid&#34;</span><span class="op" id="2829095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829098">Bool</span><span class="op" id="2829102">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829113">&#34;bool&#34;</span><span class="op" id="2829119">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829122">Int</span><span class="op" id="2829125">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829137">&#34;int&#34;</span><span class="op" id="2829142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829145">Int8</span><span class="op" id="2829149">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829160">&#34;int8&#34;</span><span class="op" id="2829166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829169">Int16</span><span class="op" id="2829174">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829184">&#34;int16&#34;</span><span class="op" id="2829191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829194">Int32</span><span class="op" id="2829199">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829209">&#34;int32&#34;</span><span class="op" id="2829216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829219">Int64</span><span class="op" id="2829224">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829234">&#34;int64&#34;</span><span class="op" id="2829241">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829244">Uint</span><span class="op" id="2829248">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829259">&#34;uint&#34;</span><span class="op" id="2829265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829268">Uint8</span><span class="op" id="2829273">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829283">&#34;uint8&#34;</span><span class="op" id="2829290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829293">Uint16</span><span class="op" id="2829299">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829308">&#34;uint16&#34;</span><span class="op" id="2829316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829319">Uint32</span><span class="op" id="2829325">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829334">&#34;uint32&#34;</span><span class="op" id="2829342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829345">Uint64</span><span class="op" id="2829351">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829360">&#34;uint64&#34;</span><span class="op" id="2829368">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829371">Uintptr</span><span class="op" id="2829378">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829386">&#34;uintptr&#34;</span><span class="op" id="2829395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829398">Float32</span><span class="op" id="2829405">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829413">&#34;float32&#34;</span><span class="op" id="2829422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829425">Float64</span><span class="op" id="2829432">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829440">&#34;float64&#34;</span><span class="op" id="2829449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829452">Complex64</span><span class="op" id="2829461">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829467">&#34;complex64&#34;</span><span class="op" id="2829478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829481">Complex128</span><span class="op" id="2829491">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829496">&#34;complex128&#34;</span><span class="op" id="2829508">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829511">Array</span><span class="op" id="2829516">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829526">&#34;array&#34;</span><span class="op" id="2829533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829536">Chan</span><span class="op" id="2829540">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829551">&#34;chan&#34;</span><span class="op" id="2829557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829560">Func</span><span class="op" id="2829564">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829575">&#34;func&#34;</span><span class="op" id="2829581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829584">Interface</span><span class="op" id="2829593">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829599">&#34;interface&#34;</span><span class="op" id="2829610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829613">Map</span><span class="op" id="2829616">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829628">&#34;map&#34;</span><span class="op" id="2829633">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829636">Ptr</span><span class="op" id="2829639">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829651">&#34;ptr&#34;</span><span class="op" id="2829656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829659">Slice</span><span class="op" id="2829664">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829674">&#34;slice&#34;</span><span class="op" id="2829681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829684">String</span><span class="op" id="2829690">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829699">&#34;string&#34;</span><span class="op" id="2829707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829710">Struct</span><span class="op" id="2829716">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2829725">&#34;struct&#34;</span><span class="op" id="2829733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2829736">UnsafePointer</span><span class="op" id="2829749">:</span>&nbsp;<span class="string" id="2829751">&#34;unsafe.Pointer&#34;</span><span class="op" id="2829767">,</span><br>
<span class="lineno">440</span><span class="op" id="2829769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2829772">func</span>&nbsp;<span class="op" id="2829777">(</span><span class="ident" id="2829778">t</span>&nbsp;<span class="op" id="2829780">*</span><span class="ident" id="2829781">uncommonType</span><span class="op" id="2829793">)</span>&nbsp;<span class="ident" id="2829795">uncommon</span><span class="op" id="2829803">(</span><span class="op" id="2829804">)</span>&nbsp;<span class="op" id="2829806">*</span><span class="ident" id="2829807">uncommonType</span>&nbsp;<span class="op" id="2829820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2829823">return</span>&nbsp;<span class="ident" id="2829830">t</span><br>
<span class="lineno"></span><span class="op" id="2829832">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="2829835">func</span>&nbsp;<span class="op" id="2829840">(</span><span class="ident" id="2829841">t</span>&nbsp;<span class="op" id="2829843">*</span><span class="ident" id="2829844">uncommonType</span><span class="op" id="2829856">)</span>&nbsp;<span class="ident" id="2829858">PkgPath</span><span class="op" id="2829865">(</span><span class="op" id="2829866">)</span>&nbsp;<span class="builtintype" id="2829868">string</span>&nbsp;<span class="op" id="2829875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2829878">if</span>&nbsp;<span class="ident" id="2829881">t</span>&nbsp;<span class="op" id="2829883">==</span>&nbsp;<span class="builtintype" id="2829886">nil</span>&nbsp;<span class="op" id="2829890">||</span>&nbsp;<span class="ident" id="2829893">t</span><span class="op" id="2829894">.</span><span class="ident" id="2829895">pkgPath</span>&nbsp;<span class="op" id="2829903">==</span>&nbsp;<span class="builtintype" id="2829906">nil</span>&nbsp;<span class="op" id="2829910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2829914">return</span>&nbsp;<span class="string" id="2829921">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2829925">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2829928">return</span>&nbsp;<span class="op" id="2829935">*</span><span class="ident" id="2829936">t</span><span class="op" id="2829937">.</span><span class="ident" id="2829938">pkgPath</span><br>
<span class="lineno"></span><span class="op" id="2829946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2829949">func</span>&nbsp;<span class="op" id="2829954">(</span><span class="ident" id="2829955">t</span>&nbsp;<span class="op" id="2829957">*</span><span class="ident" id="2829958">uncommonType</span><span class="op" id="2829970">)</span>&nbsp;<span class="ident" id="2829972">Name</span><span class="op" id="2829976">(</span><span class="op" id="2829977">)</span>&nbsp;<span class="builtintype" id="2829979">string</span>&nbsp;<span class="op" id="2829986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2829989">if</span>&nbsp;<span class="ident" id="2829992">t</span>&nbsp;<span class="op" id="2829994">==</span>&nbsp;<span class="builtintype" id="2829997">nil</span>&nbsp;<span class="op" id="2830001">||</span>&nbsp;<span class="ident" id="2830004">t</span><span class="op" id="2830005">.</span><span class="ident" id="2830006">name</span>&nbsp;<span class="op" id="2830011">==</span>&nbsp;<span class="builtintype" id="2830014">nil</span>&nbsp;<span class="op" id="2830018">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2830022">return</span>&nbsp;<span class="string" id="2830029">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2830033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2830036">return</span>&nbsp;<span class="op" id="2830043">*</span><span class="ident" id="2830044">t</span><span class="op" id="2830045">.</span><span class="ident" id="2830046">name</span><br>
<span class="lineno"></span><span class="op" id="2830051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="2830054">func</span>&nbsp;<span class="op" id="2830059">(</span><span class="ident" id="2830060">t</span>&nbsp;<span class="op" id="2830062">*</span><span class="ident" id="2830063">rtype</span><span class="op" id="2830068">)</span>&nbsp;<span class="ident" id="2830070">String</span><span class="op" id="2830076">(</span><span class="op" id="2830077">)</span>&nbsp;<span class="builtintype" id="2830079">string</span>&nbsp;<span class="op" id="2830086">{</span>&nbsp;<span class="keyword" id="2830088">return</span>&nbsp;<span class="op" id="2830095">*</span><span class="ident" id="2830096">t</span><span class="op" id="2830097">.</span><span class="builtintype" id="2830098">string</span>&nbsp;<span class="op" id="2830105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2830108">func</span>&nbsp;<span class="op" id="2830113">(</span><span class="ident" id="2830114">t</span>&nbsp;<span class="op" id="2830116">*</span><span class="ident" id="2830117">rtype</span><span class="op" id="2830122">)</span>&nbsp;<span class="ident" id="2830124">Size</span><span class="op" id="2830128">(</span><span class="op" id="2830129">)</span>&nbsp;<span class="builtintype" id="2830131">uintptr</span>&nbsp;<span class="op" id="2830139">{</span>&nbsp;<span class="keyword" id="2830141">return</span>&nbsp;<span class="ident" id="2830148">t</span><span class="op" id="2830149">.</span><span class="ident" id="2830150">size</span>&nbsp;<span class="op" id="2830155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2830158">func</span>&nbsp;<span class="op" id="2830163">(</span><span class="ident" id="2830164">t</span>&nbsp;<span class="op" id="2830166">*</span><span class="ident" id="2830167">rtype</span><span class="op" id="2830172">)</span>&nbsp;<span class="ident" id="2830174">Bits</span><span class="op" id="2830178">(</span><span class="op" id="2830179">)</span>&nbsp;<span class="builtintype" id="2830181">int</span>&nbsp;<span class="op" id="2830185">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2830188">if</span>&nbsp;<span class="ident" id="2830191">t</span>&nbsp;<span class="op" id="2830193">==</span>&nbsp;<span class="builtintype" id="2830196">nil</span>&nbsp;<span class="op" id="2830200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2830204">panic</span><span class="op" id="2830209">(</span><span class="string" id="2830210">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;nil&nbsp;Type&#34;</span><span class="op" id="2830237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2830240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2830243">k</span>&nbsp;<span class="op" id="2830245">:=</span>&nbsp;<span class="ident" id="2830248">t</span><span class="op" id="2830249">.</span><span class="ident" id="2830250">Kind</span><span class="op" id="2830254">(</span><span class="op" id="2830255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2830258">if</span>&nbsp;<span class="ident" id="2830261">k</span>&nbsp;<span class="op" id="2830263">&lt;</span>&nbsp;<span class="ident" id="2830265">Int</span>&nbsp;<span class="op" id="2830269">||</span>&nbsp;<span class="ident" id="2830272">k</span>&nbsp;<span class="op" id="2830274">&gt;</span>&nbsp;<span class="ident" id="2830276">Complex128</span>&nbsp;<span class="op" id="2830287">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2830291">panic</span><span class="op" id="2830296">(</span><span class="string" id="2830297">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;non-arithmetic&nbsp;Type&nbsp;&#34;</span>&nbsp;<span class="op" id="2830337">+</span>&nbsp;<span class="ident" id="2830339">t</span><span class="op" id="2830340">.</span><span class="ident" id="2830341">String</span><span class="op" id="2830347">(</span><span class="op" id="2830348">)</span><span class="op" id="2830349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2830352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2830355">return</span>&nbsp;<span class="builtintype" id="2830362">int</span><span class="op" id="2830365">(</span><span class="ident" id="2830366">t</span><span class="op" id="2830367">.</span><span class="ident" id="2830368">size</span><span class="op" id="2830372">)</span>&nbsp;<span class="op" id="2830374">*</span>&nbsp;<span class="num" id="2830376">8</span><br>
<span class="lineno"></span><span class="op" id="2830378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span><span class="keyword" id="2830381">func</span>&nbsp;<span class="op" id="2830386">(</span><span class="ident" id="2830387">t</span>&nbsp;<span class="op" id="2830389">*</span><span class="ident" id="2830390">rtype</span><span class="op" id="2830395">)</span>&nbsp;<span class="ident" id="2830397">Align</span><span class="op" id="2830402">(</span><span class="op" id="2830403">)</span>&nbsp;<span class="builtintype" id="2830405">int</span>&nbsp;<span class="op" id="2830409">{</span>&nbsp;<span class="keyword" id="2830411">return</span>&nbsp;<span class="builtintype" id="2830418">int</span><span class="op" id="2830421">(</span><span class="ident" id="2830422">t</span><span class="op" id="2830423">.</span><span class="ident" id="2830424">align</span><span class="op" id="2830429">)</span>&nbsp;<span class="op" id="2830431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2830434">func</span>&nbsp;<span class="op" id="2830439">(</span><span class="ident" id="2830440">t</span>&nbsp;<span class="op" id="2830442">*</span><span class="ident" id="2830443">rtype</span><span class="op" id="2830448">)</span>&nbsp;<span class="ident" id="2830450">FieldAlign</span><span class="op" id="2830460">(</span><span class="op" id="2830461">)</span>&nbsp;<span class="builtintype" id="2830463">int</span>&nbsp;<span class="op" id="2830467">{</span>&nbsp;<span class="keyword" id="2830469">return</span>&nbsp;<span class="builtintype" id="2830476">int</span><span class="op" id="2830479">(</span><span class="ident" id="2830480">t</span><span class="op" id="2830481">.</span><span class="ident" id="2830482">fieldAlign</span><span class="op" id="2830492">)</span>&nbsp;<span class="op" id="2830494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2830497">func</span>&nbsp;<span class="op" id="2830502">(</span><span class="ident" id="2830503">t</span>&nbsp;<span class="op" id="2830505">*</span><span class="ident" id="2830506">rtype</span><span class="op" id="2830511">)</span>&nbsp;<span class="ident" id="2830513">Kind</span><span class="op" id="2830517">(</span><span class="op" id="2830518">)</span>&nbsp;<span class="ident" id="2830520">Kind</span>&nbsp;<span class="op" id="2830525">{</span>&nbsp;<span class="keyword" id="2830527">return</span>&nbsp;<span class="ident" id="2830534">Kind</span><span class="op" id="2830538">(</span><span class="ident" id="2830539">t</span><span class="op" id="2830540">.</span><span class="ident" id="2830541">kind</span>&nbsp;<span class="op" id="2830546">&amp;</span>&nbsp;<span class="ident" id="2830548">kindMask</span><span class="op" id="2830556">)</span>&nbsp;<span class="op" id="2830558">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="keyword" id="2830561">func</span>&nbsp;<span class="op" id="2830566">(</span><span class="ident" id="2830567">t</span>&nbsp;<span class="op" id="2830569">*</span><span class="ident" id="2830570">rtype</span><span class="op" id="2830575">)</span>&nbsp;<span class="ident" id="2830577">pointers</span><span class="op" id="2830585">(</span><span class="op" id="2830586">)</span>&nbsp;<span class="builtintype" id="2830588">bool</span>&nbsp;<span class="op" id="2830593">{</span>&nbsp;<span class="keyword" id="2830595">return</span>&nbsp;<span class="ident" id="2830602">t</span><span class="op" id="2830603">.</span><span class="ident" id="2830604">kind</span><span class="op" id="2830608">&amp;</span><span class="ident" id="2830609">kindNoPointers</span>&nbsp;<span class="op" id="2830624">==</span>&nbsp;<span class="num" id="2830627">0</span>&nbsp;<span class="op" id="2830629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2830632">func</span>&nbsp;<span class="op" id="2830637">(</span><span class="ident" id="2830638">t</span>&nbsp;<span class="op" id="2830640">*</span><span class="ident" id="2830641">rtype</span><span class="op" id="2830646">)</span>&nbsp;<span class="ident" id="2830648">common</span><span class="op" id="2830654">(</span><span class="op" id="2830655">)</span>&nbsp;<span class="op" id="2830657">*</span><span class="ident" id="2830658">rtype</span>&nbsp;<span class="op" id="2830664">{</span>&nbsp;<span class="keyword" id="2830666">return</span>&nbsp;<span class="ident" id="2830673">t</span>&nbsp;<span class="op" id="2830675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2830678">func</span>&nbsp;<span class="op" id="2830683">(</span><span class="ident" id="2830684">t</span>&nbsp;<span class="op" id="2830686">*</span><span class="ident" id="2830687">uncommonType</span><span class="op" id="2830699">)</span>&nbsp;<span class="ident" id="2830701">Method</span><span class="op" id="2830707">(</span><span class="ident" id="2830708">i</span>&nbsp;<span class="builtintype" id="2830710">int</span><span class="op" id="2830713">)</span>&nbsp;<span class="op" id="2830715">(</span><span class="ident" id="2830716">m</span>&nbsp;<span class="ident" id="2830718">Method</span><span class="op" id="2830724">)</span>&nbsp;<span class="op" id="2830726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2830729">if</span>&nbsp;<span class="ident" id="2830732">t</span>&nbsp;<span class="op" id="2830734">==</span>&nbsp;<span class="builtintype" id="2830737">nil</span>&nbsp;<span class="op" id="2830741">||</span>&nbsp;<span class="ident" id="2830744">i</span>&nbsp;<span class="op" id="2830746">&lt;</span>&nbsp;<span class="num" id="2830748">0</span>&nbsp;<span class="op" id="2830750">||</span>&nbsp;<span class="ident" id="2830753">i</span>&nbsp;<span class="op" id="2830755">&gt;=</span>&nbsp;<span class="builtinfunc" id="2830758">len</span><span class="op" id="2830761">(</span><span class="ident" id="2830762">t</span><span class="op" id="2830763">.</span><span class="ident" id="2830764">methods</span><span class="op" id="2830771">)</span>&nbsp;<span class="op" id="2830773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2830777">panic</span><span class="op" id="2830782">(</span><span class="string" id="2830783">&#34;reflect:&nbsp;Method&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="2830819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2830822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2830825">p</span>&nbsp;<span class="op" id="2830827">:=</span>&nbsp;<span class="op" id="2830830">&amp;</span><span class="ident" id="2830831">t</span><span class="op" id="2830832">.</span><span class="ident" id="2830833">methods</span><span class="op" id="2830840">[</span><span class="ident" id="2830841">i</span><span class="op" id="2830842">]</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2830845">if</span>&nbsp;<span class="ident" id="2830848">p</span><span class="op" id="2830849">.</span><span class="ident" id="2830850">name</span>&nbsp;<span class="op" id="2830855">!=</span>&nbsp;<span class="builtintype" id="2830858">nil</span>&nbsp;<span class="op" id="2830862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2830866">m</span><span class="op" id="2830867">.</span><span class="ident" id="2830868">Name</span>&nbsp;<span class="op" id="2830873">=</span>&nbsp;<span class="op" id="2830875">*</span><span class="ident" id="2830876">p</span><span class="op" id="2830877">.</span><span class="ident" id="2830878">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2830884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2830887">fl</span>&nbsp;<span class="op" id="2830890">:=</span>&nbsp;<span class="ident" id="2830893">flag</span><span class="op" id="2830897">(</span><span class="ident" id="2830898">Func</span><span class="op" id="2830902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2830905">if</span>&nbsp;<span class="ident" id="2830908">p</span><span class="op" id="2830909">.</span><span class="ident" id="2830910">pkgPath</span>&nbsp;<span class="op" id="2830918">!=</span>&nbsp;<span class="builtintype" id="2830921">nil</span>&nbsp;<span class="op" id="2830925">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2830929">m</span><span class="op" id="2830930">.</span><span class="ident" id="2830931">PkgPath</span>&nbsp;<span class="op" id="2830939">=</span>&nbsp;<span class="op" id="2830941">*</span><span class="ident" id="2830942">p</span><span class="op" id="2830943">.</span><span class="ident" id="2830944">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2830954">fl</span>&nbsp;<span class="op" id="2830957">|=</span>&nbsp;<span class="ident" id="2830960">flagRO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2830968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2830971">mt</span>&nbsp;<span class="op" id="2830974">:=</span>&nbsp;<span class="ident" id="2830977">p</span><span class="op" id="2830978">.</span><span class="ident" id="2830979">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2830984">m</span><span class="op" id="2830985">.</span><span class="ident" id="2830986">Type</span>&nbsp;<span class="op" id="2830991">=</span>&nbsp;<span class="ident" id="2830993">mt</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2830997">fn</span>&nbsp;<span class="op" id="2831000">:=</span>&nbsp;<span class="ident" id="2831003">unsafe</span><span class="op" id="2831009">.</span><span class="ident" id="2831010">Pointer</span><span class="op" id="2831017">(</span><span class="op" id="2831018">&amp;</span><span class="ident" id="2831019">p</span><span class="op" id="2831020">.</span><span class="ident" id="2831021">tfn</span><span class="op" id="2831024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2831027">m</span><span class="op" id="2831028">.</span><span class="ident" id="2831029">Func</span>&nbsp;<span class="op" id="2831034">=</span>&nbsp;<span class="ident" id="2831036">Value</span><span class="op" id="2831041">{</span><span class="ident" id="2831042">mt</span><span class="op" id="2831044">,</span>&nbsp;<span class="ident" id="2831046">fn</span><span class="op" id="2831048">,</span>&nbsp;<span class="ident" id="2831050">fl</span><span class="op" id="2831052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2831055">m</span><span class="op" id="2831056">.</span><span class="ident" id="2831057">Index</span>&nbsp;<span class="op" id="2831063">=</span>&nbsp;<span class="ident" id="2831065">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831068">return</span><br>
<span class="lineno"></span><span class="op" id="2831075">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="keyword" id="2831078">func</span>&nbsp;<span class="op" id="2831083">(</span><span class="ident" id="2831084">t</span>&nbsp;<span class="op" id="2831086">*</span><span class="ident" id="2831087">uncommonType</span><span class="op" id="2831099">)</span>&nbsp;<span class="ident" id="2831101">NumMethod</span><span class="op" id="2831110">(</span><span class="op" id="2831111">)</span>&nbsp;<span class="builtintype" id="2831113">int</span>&nbsp;<span class="op" id="2831117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831120">if</span>&nbsp;<span class="ident" id="2831123">t</span>&nbsp;<span class="op" id="2831125">==</span>&nbsp;<span class="builtintype" id="2831128">nil</span>&nbsp;<span class="op" id="2831132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831136">return</span>&nbsp;<span class="num" id="2831143">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2831146">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831149">return</span>&nbsp;<span class="builtinfunc" id="2831156">len</span><span class="op" id="2831159">(</span><span class="ident" id="2831160">t</span><span class="op" id="2831161">.</span><span class="ident" id="2831162">methods</span><span class="op" id="2831169">)</span><br>
<span class="lineno"></span><span class="op" id="2831171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2831174">func</span>&nbsp;<span class="op" id="2831179">(</span><span class="ident" id="2831180">t</span>&nbsp;<span class="op" id="2831182">*</span><span class="ident" id="2831183">uncommonType</span><span class="op" id="2831195">)</span>&nbsp;<span class="ident" id="2831197">MethodByName</span><span class="op" id="2831209">(</span><span class="ident" id="2831210">name</span>&nbsp;<span class="builtintype" id="2831215">string</span><span class="op" id="2831221">)</span>&nbsp;<span class="op" id="2831223">(</span><span class="ident" id="2831224">m</span>&nbsp;<span class="ident" id="2831226">Method</span><span class="op" id="2831232">,</span>&nbsp;<span class="ident" id="2831234">ok</span>&nbsp;<span class="builtintype" id="2831237">bool</span><span class="op" id="2831241">)</span>&nbsp;<span class="op" id="2831243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831246">if</span>&nbsp;<span class="ident" id="2831249">t</span>&nbsp;<span class="op" id="2831251">==</span>&nbsp;<span class="builtintype" id="2831254">nil</span>&nbsp;<span class="op" id="2831258">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831262">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2831270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831273">var</span>&nbsp;<span class="ident" id="2831277">p</span>&nbsp;<span class="op" id="2831279">*</span><span class="ident" id="2831280">method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831288">for</span>&nbsp;<span class="ident" id="2831292">i</span>&nbsp;<span class="op" id="2831294">:=</span>&nbsp;<span class="keyword" id="2831297">range</span>&nbsp;<span class="ident" id="2831303">t</span><span class="op" id="2831304">.</span><span class="ident" id="2831305">methods</span>&nbsp;<span class="op" id="2831313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2831317">p</span>&nbsp;<span class="op" id="2831319">=</span>&nbsp;<span class="op" id="2831321">&amp;</span><span class="ident" id="2831322">t</span><span class="op" id="2831323">.</span><span class="ident" id="2831324">methods</span><span class="op" id="2831331">[</span><span class="ident" id="2831332">i</span><span class="op" id="2831333">]</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831337">if</span>&nbsp;<span class="ident" id="2831340">p</span><span class="op" id="2831341">.</span><span class="ident" id="2831342">name</span>&nbsp;<span class="op" id="2831347">!=</span>&nbsp;<span class="builtintype" id="2831350">nil</span>&nbsp;<span class="op" id="2831354">&amp;&amp;</span>&nbsp;<span class="op" id="2831357">*</span><span class="ident" id="2831358">p</span><span class="op" id="2831359">.</span><span class="ident" id="2831360">name</span>&nbsp;<span class="op" id="2831365">==</span>&nbsp;<span class="ident" id="2831368">name</span>&nbsp;<span class="op" id="2831373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831378">return</span>&nbsp;<span class="ident" id="2831385">t</span><span class="op" id="2831386">.</span><span class="ident" id="2831387">Method</span><span class="op" id="2831393">(</span><span class="ident" id="2831394">i</span><span class="op" id="2831395">)</span><span class="op" id="2831396">,</span>&nbsp;<span class="builtintype" id="2831398">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2831405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2831408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831411">return</span><br>
<span class="lineno">525</span><span class="op" id="2831418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2831421">//&nbsp;TODO(rsc):&nbsp;6g&nbsp;supplies&nbsp;these,&nbsp;but&nbsp;they&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2831471">//&nbsp;as&nbsp;efficient&nbsp;as&nbsp;they&nbsp;could&nbsp;be:&nbsp;they&nbsp;have&nbsp;commonType</span><br>
<span class="lineno"></span><span class="comment" id="2831526">//&nbsp;as&nbsp;the&nbsp;receiver&nbsp;instead&nbsp;of&nbsp;*rtype.</span><br>
<span class="lineno">530</span><span class="keyword" id="2831564">func</span>&nbsp;<span class="op" id="2831569">(</span><span class="ident" id="2831570">t</span>&nbsp;<span class="op" id="2831572">*</span><span class="ident" id="2831573">rtype</span><span class="op" id="2831578">)</span>&nbsp;<span class="ident" id="2831580">NumMethod</span><span class="op" id="2831589">(</span><span class="op" id="2831590">)</span>&nbsp;<span class="builtintype" id="2831592">int</span>&nbsp;<span class="op" id="2831596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831599">if</span>&nbsp;<span class="ident" id="2831602">t</span><span class="op" id="2831603">.</span><span class="ident" id="2831604">Kind</span><span class="op" id="2831608">(</span><span class="op" id="2831609">)</span>&nbsp;<span class="op" id="2831611">==</span>&nbsp;<span class="ident" id="2831614">Interface</span>&nbsp;<span class="op" id="2831624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2831628">tt</span>&nbsp;<span class="op" id="2831631">:=</span>&nbsp;<span class="op" id="2831634">(</span><span class="op" id="2831635">*</span><span class="ident" id="2831636">interfaceType</span><span class="op" id="2831649">)</span><span class="op" id="2831650">(</span><span class="ident" id="2831651">unsafe</span><span class="op" id="2831657">.</span><span class="ident" id="2831658">Pointer</span><span class="op" id="2831665">(</span><span class="ident" id="2831666">t</span><span class="op" id="2831667">)</span><span class="op" id="2831668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831672">return</span>&nbsp;<span class="ident" id="2831679">tt</span><span class="op" id="2831681">.</span><span class="ident" id="2831682">NumMethod</span><span class="op" id="2831691">(</span><span class="op" id="2831692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2831695">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831698">return</span>&nbsp;<span class="ident" id="2831705">t</span><span class="op" id="2831706">.</span><span class="ident" id="2831707">uncommonType</span><span class="op" id="2831719">.</span><span class="ident" id="2831720">NumMethod</span><span class="op" id="2831729">(</span><span class="op" id="2831730">)</span><br>
<span class="lineno"></span><span class="op" id="2831732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2831735">func</span>&nbsp;<span class="op" id="2831740">(</span><span class="ident" id="2831741">t</span>&nbsp;<span class="op" id="2831743">*</span><span class="ident" id="2831744">rtype</span><span class="op" id="2831749">)</span>&nbsp;<span class="ident" id="2831751">Method</span><span class="op" id="2831757">(</span><span class="ident" id="2831758">i</span>&nbsp;<span class="builtintype" id="2831760">int</span><span class="op" id="2831763">)</span>&nbsp;<span class="op" id="2831765">(</span><span class="ident" id="2831766">m</span>&nbsp;<span class="ident" id="2831768">Method</span><span class="op" id="2831774">)</span>&nbsp;<span class="op" id="2831776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831779">if</span>&nbsp;<span class="ident" id="2831782">t</span><span class="op" id="2831783">.</span><span class="ident" id="2831784">Kind</span><span class="op" id="2831788">(</span><span class="op" id="2831789">)</span>&nbsp;<span class="op" id="2831791">==</span>&nbsp;<span class="ident" id="2831794">Interface</span>&nbsp;<span class="op" id="2831804">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2831808">tt</span>&nbsp;<span class="op" id="2831811">:=</span>&nbsp;<span class="op" id="2831814">(</span><span class="op" id="2831815">*</span><span class="ident" id="2831816">interfaceType</span><span class="op" id="2831829">)</span><span class="op" id="2831830">(</span><span class="ident" id="2831831">unsafe</span><span class="op" id="2831837">.</span><span class="ident" id="2831838">Pointer</span><span class="op" id="2831845">(</span><span class="ident" id="2831846">t</span><span class="op" id="2831847">)</span><span class="op" id="2831848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831852">return</span>&nbsp;<span class="ident" id="2831859">tt</span><span class="op" id="2831861">.</span><span class="ident" id="2831862">Method</span><span class="op" id="2831868">(</span><span class="ident" id="2831869">i</span><span class="op" id="2831870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2831873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831876">return</span>&nbsp;<span class="ident" id="2831883">t</span><span class="op" id="2831884">.</span><span class="ident" id="2831885">uncommonType</span><span class="op" id="2831897">.</span><span class="ident" id="2831898">Method</span><span class="op" id="2831904">(</span><span class="ident" id="2831905">i</span><span class="op" id="2831906">)</span><br>
<span class="lineno"></span><span class="op" id="2831908">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="keyword" id="2831911">func</span>&nbsp;<span class="op" id="2831916">(</span><span class="ident" id="2831917">t</span>&nbsp;<span class="op" id="2831919">*</span><span class="ident" id="2831920">rtype</span><span class="op" id="2831925">)</span>&nbsp;<span class="ident" id="2831927">MethodByName</span><span class="op" id="2831939">(</span><span class="ident" id="2831940">name</span>&nbsp;<span class="builtintype" id="2831945">string</span><span class="op" id="2831951">)</span>&nbsp;<span class="op" id="2831953">(</span><span class="ident" id="2831954">m</span>&nbsp;<span class="ident" id="2831956">Method</span><span class="op" id="2831962">,</span>&nbsp;<span class="ident" id="2831964">ok</span>&nbsp;<span class="builtintype" id="2831967">bool</span><span class="op" id="2831971">)</span>&nbsp;<span class="op" id="2831973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2831976">if</span>&nbsp;<span class="ident" id="2831979">t</span><span class="op" id="2831980">.</span><span class="ident" id="2831981">Kind</span><span class="op" id="2831985">(</span><span class="op" id="2831986">)</span>&nbsp;<span class="op" id="2831988">==</span>&nbsp;<span class="ident" id="2831991">Interface</span>&nbsp;<span class="op" id="2832001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2832005">tt</span>&nbsp;<span class="op" id="2832008">:=</span>&nbsp;<span class="op" id="2832011">(</span><span class="op" id="2832012">*</span><span class="ident" id="2832013">interfaceType</span><span class="op" id="2832026">)</span><span class="op" id="2832027">(</span><span class="ident" id="2832028">unsafe</span><span class="op" id="2832034">.</span><span class="ident" id="2832035">Pointer</span><span class="op" id="2832042">(</span><span class="ident" id="2832043">t</span><span class="op" id="2832044">)</span><span class="op" id="2832045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832049">return</span>&nbsp;<span class="ident" id="2832056">tt</span><span class="op" id="2832058">.</span><span class="ident" id="2832059">MethodByName</span><span class="op" id="2832071">(</span><span class="ident" id="2832072">name</span><span class="op" id="2832076">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2832079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832082">return</span>&nbsp;<span class="ident" id="2832089">t</span><span class="op" id="2832090">.</span><span class="ident" id="2832091">uncommonType</span><span class="op" id="2832103">.</span><span class="ident" id="2832104">MethodByName</span><span class="op" id="2832116">(</span><span class="ident" id="2832117">name</span><span class="op" id="2832121">)</span><br>
<span class="lineno"></span><span class="op" id="2832123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2832126">func</span>&nbsp;<span class="op" id="2832131">(</span><span class="ident" id="2832132">t</span>&nbsp;<span class="op" id="2832134">*</span><span class="ident" id="2832135">rtype</span><span class="op" id="2832140">)</span>&nbsp;<span class="ident" id="2832142">PkgPath</span><span class="op" id="2832149">(</span><span class="op" id="2832150">)</span>&nbsp;<span class="builtintype" id="2832152">string</span>&nbsp;<span class="op" id="2832159">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832162">return</span>&nbsp;<span class="ident" id="2832169">t</span><span class="op" id="2832170">.</span><span class="ident" id="2832171">uncommonType</span><span class="op" id="2832183">.</span><span class="ident" id="2832184">PkgPath</span><span class="op" id="2832191">(</span><span class="op" id="2832192">)</span><br>
<span class="lineno"></span><span class="op" id="2832194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2832197">func</span>&nbsp;<span class="op" id="2832202">(</span><span class="ident" id="2832203">t</span>&nbsp;<span class="op" id="2832205">*</span><span class="ident" id="2832206">rtype</span><span class="op" id="2832211">)</span>&nbsp;<span class="ident" id="2832213">Name</span><span class="op" id="2832217">(</span><span class="op" id="2832218">)</span>&nbsp;<span class="builtintype" id="2832220">string</span>&nbsp;<span class="op" id="2832227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832230">return</span>&nbsp;<span class="ident" id="2832237">t</span><span class="op" id="2832238">.</span><span class="ident" id="2832239">uncommonType</span><span class="op" id="2832251">.</span><span class="ident" id="2832252">Name</span><span class="op" id="2832256">(</span><span class="op" id="2832257">)</span><br>
<span class="lineno">560</span><span class="op" id="2832259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2832262">func</span>&nbsp;<span class="op" id="2832267">(</span><span class="ident" id="2832268">t</span>&nbsp;<span class="op" id="2832270">*</span><span class="ident" id="2832271">rtype</span><span class="op" id="2832276">)</span>&nbsp;<span class="ident" id="2832278">ChanDir</span><span class="op" id="2832285">(</span><span class="op" id="2832286">)</span>&nbsp;<span class="ident" id="2832288">ChanDir</span>&nbsp;<span class="op" id="2832296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832299">if</span>&nbsp;<span class="ident" id="2832302">t</span><span class="op" id="2832303">.</span><span class="ident" id="2832304">Kind</span><span class="op" id="2832308">(</span><span class="op" id="2832309">)</span>&nbsp;<span class="op" id="2832311">!=</span>&nbsp;<span class="ident" id="2832314">Chan</span>&nbsp;<span class="op" id="2832319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2832323">panic</span><span class="op" id="2832328">(</span><span class="string" id="2832329">&#34;reflect:&nbsp;ChanDir&nbsp;of&nbsp;non-chan&nbsp;type&#34;</span><span class="op" id="2832364">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2832367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2832370">tt</span>&nbsp;<span class="op" id="2832373">:=</span>&nbsp;<span class="op" id="2832376">(</span><span class="op" id="2832377">*</span><span class="ident" id="2832378">chanType</span><span class="op" id="2832386">)</span><span class="op" id="2832387">(</span><span class="ident" id="2832388">unsafe</span><span class="op" id="2832394">.</span><span class="ident" id="2832395">Pointer</span><span class="op" id="2832402">(</span><span class="ident" id="2832403">t</span><span class="op" id="2832404">)</span><span class="op" id="2832405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832408">return</span>&nbsp;<span class="ident" id="2832415">ChanDir</span><span class="op" id="2832422">(</span><span class="ident" id="2832423">tt</span><span class="op" id="2832425">.</span><span class="ident" id="2832426">dir</span><span class="op" id="2832429">)</span><br>
<span class="lineno"></span><span class="op" id="2832431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="keyword" id="2832434">func</span>&nbsp;<span class="op" id="2832439">(</span><span class="ident" id="2832440">t</span>&nbsp;<span class="op" id="2832442">*</span><span class="ident" id="2832443">rtype</span><span class="op" id="2832448">)</span>&nbsp;<span class="ident" id="2832450">IsVariadic</span><span class="op" id="2832460">(</span><span class="op" id="2832461">)</span>&nbsp;<span class="builtintype" id="2832463">bool</span>&nbsp;<span class="op" id="2832468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832471">if</span>&nbsp;<span class="ident" id="2832474">t</span><span class="op" id="2832475">.</span><span class="ident" id="2832476">Kind</span><span class="op" id="2832480">(</span><span class="op" id="2832481">)</span>&nbsp;<span class="op" id="2832483">!=</span>&nbsp;<span class="ident" id="2832486">Func</span>&nbsp;<span class="op" id="2832491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2832495">panic</span><span class="op" id="2832500">(</span><span class="string" id="2832501">&#34;reflect:&nbsp;IsVariadic&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2832539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2832542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2832545">tt</span>&nbsp;<span class="op" id="2832548">:=</span>&nbsp;<span class="op" id="2832551">(</span><span class="op" id="2832552">*</span><span class="ident" id="2832553">funcType</span><span class="op" id="2832561">)</span><span class="op" id="2832562">(</span><span class="ident" id="2832563">unsafe</span><span class="op" id="2832569">.</span><span class="ident" id="2832570">Pointer</span><span class="op" id="2832577">(</span><span class="ident" id="2832578">t</span><span class="op" id="2832579">)</span><span class="op" id="2832580">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832583">return</span>&nbsp;<span class="ident" id="2832590">tt</span><span class="op" id="2832592">.</span><span class="ident" id="2832593">dotdotdot</span><br>
<span class="lineno"></span><span class="op" id="2832603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2832606">func</span>&nbsp;<span class="op" id="2832611">(</span><span class="ident" id="2832612">t</span>&nbsp;<span class="op" id="2832614">*</span><span class="ident" id="2832615">rtype</span><span class="op" id="2832620">)</span>&nbsp;<span class="ident" id="2832622">Elem</span><span class="op" id="2832626">(</span><span class="op" id="2832627">)</span>&nbsp;<span class="ident" id="2832629">Type</span>&nbsp;<span class="op" id="2832634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832637">switch</span>&nbsp;<span class="ident" id="2832644">t</span><span class="op" id="2832645">.</span><span class="ident" id="2832646">Kind</span><span class="op" id="2832650">(</span><span class="op" id="2832651">)</span>&nbsp;<span class="op" id="2832653">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832656">case</span>&nbsp;<span class="ident" id="2832661">Array</span><span class="op" id="2832666">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2832670">tt</span>&nbsp;<span class="op" id="2832673">:=</span>&nbsp;<span class="op" id="2832676">(</span><span class="op" id="2832677">*</span><span class="ident" id="2832678">arrayType</span><span class="op" id="2832687">)</span><span class="op" id="2832688">(</span><span class="ident" id="2832689">unsafe</span><span class="op" id="2832695">.</span><span class="ident" id="2832696">Pointer</span><span class="op" id="2832703">(</span><span class="ident" id="2832704">t</span><span class="op" id="2832705">)</span><span class="op" id="2832706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832710">return</span>&nbsp;<span class="ident" id="2832717">toType</span><span class="op" id="2832723">(</span><span class="ident" id="2832724">tt</span><span class="op" id="2832726">.</span><span class="ident" id="2832727">elem</span><span class="op" id="2832731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832734">case</span>&nbsp;<span class="ident" id="2832739">Chan</span><span class="op" id="2832743">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2832747">tt</span>&nbsp;<span class="op" id="2832750">:=</span>&nbsp;<span class="op" id="2832753">(</span><span class="op" id="2832754">*</span><span class="ident" id="2832755">chanType</span><span class="op" id="2832763">)</span><span class="op" id="2832764">(</span><span class="ident" id="2832765">unsafe</span><span class="op" id="2832771">.</span><span class="ident" id="2832772">Pointer</span><span class="op" id="2832779">(</span><span class="ident" id="2832780">t</span><span class="op" id="2832781">)</span><span class="op" id="2832782">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832786">return</span>&nbsp;<span class="ident" id="2832793">toType</span><span class="op" id="2832799">(</span><span class="ident" id="2832800">tt</span><span class="op" id="2832802">.</span><span class="ident" id="2832803">elem</span><span class="op" id="2832807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832810">case</span>&nbsp;<span class="ident" id="2832815">Map</span><span class="op" id="2832818">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2832822">tt</span>&nbsp;<span class="op" id="2832825">:=</span>&nbsp;<span class="op" id="2832828">(</span><span class="op" id="2832829">*</span><span class="ident" id="2832830">mapType</span><span class="op" id="2832837">)</span><span class="op" id="2832838">(</span><span class="ident" id="2832839">unsafe</span><span class="op" id="2832845">.</span><span class="ident" id="2832846">Pointer</span><span class="op" id="2832853">(</span><span class="ident" id="2832854">t</span><span class="op" id="2832855">)</span><span class="op" id="2832856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832860">return</span>&nbsp;<span class="ident" id="2832867">toType</span><span class="op" id="2832873">(</span><span class="ident" id="2832874">tt</span><span class="op" id="2832876">.</span><span class="ident" id="2832877">elem</span><span class="op" id="2832881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832884">case</span>&nbsp;<span class="ident" id="2832889">Ptr</span><span class="op" id="2832892">:</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2832896">tt</span>&nbsp;<span class="op" id="2832899">:=</span>&nbsp;<span class="op" id="2832902">(</span><span class="op" id="2832903">*</span><span class="ident" id="2832904">ptrType</span><span class="op" id="2832911">)</span><span class="op" id="2832912">(</span><span class="ident" id="2832913">unsafe</span><span class="op" id="2832919">.</span><span class="ident" id="2832920">Pointer</span><span class="op" id="2832927">(</span><span class="ident" id="2832928">t</span><span class="op" id="2832929">)</span><span class="op" id="2832930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832934">return</span>&nbsp;<span class="ident" id="2832941">toType</span><span class="op" id="2832947">(</span><span class="ident" id="2832948">tt</span><span class="op" id="2832950">.</span><span class="ident" id="2832951">elem</span><span class="op" id="2832955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2832958">case</span>&nbsp;<span class="ident" id="2832963">Slice</span><span class="op" id="2832968">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2832972">tt</span>&nbsp;<span class="op" id="2832975">:=</span>&nbsp;<span class="op" id="2832978">(</span><span class="op" id="2832979">*</span><span class="ident" id="2832980">sliceType</span><span class="op" id="2832989">)</span><span class="op" id="2832990">(</span><span class="ident" id="2832991">unsafe</span><span class="op" id="2832997">.</span><span class="ident" id="2832998">Pointer</span><span class="op" id="2833005">(</span><span class="ident" id="2833006">t</span><span class="op" id="2833007">)</span><span class="op" id="2833008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2833012">return</span>&nbsp;<span class="ident" id="2833019">toType</span><span class="op" id="2833025">(</span><span class="ident" id="2833026">tt</span><span class="op" id="2833028">.</span><span class="ident" id="2833029">elem</span><span class="op" id="2833033">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2833036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2833039">panic</span><span class="op" id="2833044">(</span><span class="string" id="2833045">&#34;reflect:&nbsp;Elem&nbsp;of&nbsp;invalid&nbsp;type&#34;</span><span class="op" id="2833076">)</span><br>
<span class="lineno"></span><span class="op" id="2833078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2833081">func</span>&nbsp;<span class="op" id="2833086">(</span><span class="ident" id="2833087">t</span>&nbsp;<span class="op" id="2833089">*</span><span class="ident" id="2833090">rtype</span><span class="op" id="2833095">)</span>&nbsp;<span class="ident" id="2833097">Field</span><span class="op" id="2833102">(</span><span class="ident" id="2833103">i</span>&nbsp;<span class="builtintype" id="2833105">int</span><span class="op" id="2833108">)</span>&nbsp;<span class="ident" id="2833110">StructField</span>&nbsp;<span class="op" id="2833122">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2833125">if</span>&nbsp;<span class="ident" id="2833128">t</span><span class="op" id="2833129">.</span><span class="ident" id="2833130">Kind</span><span class="op" id="2833134">(</span><span class="op" id="2833135">)</span>&nbsp;<span class="op" id="2833137">!=</span>&nbsp;<span class="ident" id="2833140">Struct</span>&nbsp;<span class="op" id="2833147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2833151">panic</span><span class="op" id="2833156">(</span><span class="string" id="2833157">&#34;reflect:&nbsp;Field&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2833192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2833195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2833198">tt</span>&nbsp;<span class="op" id="2833201">:=</span>&nbsp;<span class="op" id="2833204">(</span><span class="op" id="2833205">*</span><span class="ident" id="2833206">structType</span><span class="op" id="2833216">)</span><span class="op" id="2833217">(</span><span class="ident" id="2833218">unsafe</span><span class="op" id="2833224">.</span><span class="ident" id="2833225">Pointer</span><span class="op" id="2833232">(</span><span class="ident" id="2833233">t</span><span class="op" id="2833234">)</span><span class="op" id="2833235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2833238">return</span>&nbsp;<span class="ident" id="2833245">tt</span><span class="op" id="2833247">.</span><span class="ident" id="2833248">Field</span><span class="op" id="2833253">(</span><span class="ident" id="2833254">i</span><span class="op" id="2833255">)</span><br>
<span class="lineno">605</span><span class="op" id="2833257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2833260">func</span>&nbsp;<span class="op" id="2833265">(</span><span class="ident" id="2833266">t</span>&nbsp;<span class="op" id="2833268">*</span><span class="ident" id="2833269">rtype</span><span class="op" id="2833274">)</span>&nbsp;<span class="ident" id="2833276">FieldByIndex</span><span class="op" id="2833288">(</span><span class="ident" id="2833289">index</span>&nbsp;<span class="op" id="2833295">[</span><span class="op" id="2833296">]</span><span class="builtintype" id="2833297">int</span><span class="op" id="2833300">)</span>&nbsp;<span class="ident" id="2833302">StructField</span>&nbsp;<span class="op" id="2833314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2833317">if</span>&nbsp;<span class="ident" id="2833320">t</span><span class="op" id="2833321">.</span><span class="ident" id="2833322">Kind</span><span class="op" id="2833326">(</span><span class="op" id="2833327">)</span>&nbsp;<span class="op" id="2833329">!=</span>&nbsp;<span class="ident" id="2833332">Struct</span>&nbsp;<span class="op" id="2833339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2833343">panic</span><span class="op" id="2833348">(</span><span class="string" id="2833349">&#34;reflect:&nbsp;FieldByIndex&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2833391">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2833394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2833397">tt</span>&nbsp;<span class="op" id="2833400">:=</span>&nbsp;<span class="op" id="2833403">(</span><span class="op" id="2833404">*</span><span class="ident" id="2833405">structType</span><span class="op" id="2833415">)</span><span class="op" id="2833416">(</span><span class="ident" id="2833417">unsafe</span><span class="op" id="2833423">.</span><span class="ident" id="2833424">Pointer</span><span class="op" id="2833431">(</span><span class="ident" id="2833432">t</span><span class="op" id="2833433">)</span><span class="op" id="2833434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2833437">return</span>&nbsp;<span class="ident" id="2833444">tt</span><span class="op" id="2833446">.</span><span class="ident" id="2833447">FieldByIndex</span><span class="op" id="2833459">(</span><span class="ident" id="2833460">index</span><span class="op" id="2833465">)</span><br>
<span class="lineno"></span><span class="op" id="2833467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="2833470">func</span>&nbsp;<span class="op" id="2833475">(</span><span class="ident" id="2833476">t</span>&nbsp;<span class="op" id="2833478">*</span><span class="ident" id="2833479">rtype</span><span class="op" id="2833484">)</span>&nbsp;<span class="ident" id="2833486">FieldByName</span><span class="op" id="2833497">(</span><span class="ident" id="2833498">name</span>&nbsp;<span class="builtintype" id="2833503">string</span><span class="op" id="2833509">)</span>&nbsp;<span class="op" id="2833511">(</span><span class="ident" id="2833512">StructField</span><span class="op" id="2833523">,</span>&nbsp;<span class="builtintype" id="2833525">bool</span><span class="op" id="2833529">)</span>&nbsp;<span class="op" id="2833531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2833534">if</span>&nbsp;<span class="ident" id="2833537">t</span><span class="op" id="2833538">.</span><span class="ident" id="2833539">Kind</span><span class="op" id="2833543">(</span><span class="op" id="2833544">)</span>&nbsp;<span class="op" id="2833546">!=</span>&nbsp;<span class="ident" id="2833549">Struct</span>&nbsp;<span class="op" id="2833556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2833560">panic</span><span class="op" id="2833565">(</span><span class="string" id="2833566">&#34;reflect:&nbsp;FieldByName&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2833607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2833610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2833613">tt</span>&nbsp;<span class="op" id="2833616">:=</span>&nbsp;<span class="op" id="2833619">(</span><span class="op" id="2833620">*</span><span class="ident" id="2833621">structType</span><span class="op" id="2833631">)</span><span class="op" id="2833632">(</span><span class="ident" id="2833633">unsafe</span><span class="op" id="2833639">.</span><span class="ident" id="2833640">Pointer</span><span class="op" id="2833647">(</span><span class="ident" id="2833648">t</span><span class="op" id="2833649">)</span><span class="op" id="2833650">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2833653">return</span>&nbsp;<span class="ident" id="2833660">tt</span><span class="op" id="2833662">.</span><span class="ident" id="2833663">FieldByName</span><span class="op" id="2833674">(</span><span class="ident" id="2833675">name</span><span class="op" id="2833679">)</span><br>
<span class="lineno"></span><span class="op" id="2833681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2833684">func</span>&nbsp;<span class="op" id="2833689">(</span><span class="ident" id="2833690">t</span>&nbsp;<span class="op" id="2833692">*</span><span class="ident" id="2833693">rtype</span><span class="op" id="2833698">)</span>&nbsp;<span class="ident" id="2833700">FieldByNameFunc</span><span class="op" id="2833715">(</span><span class="ident" id="2833716">match</span>&nbsp;<span class="keyword" id="2833722">func</span><span class="op" id="2833726">(</span><span class="builtintype" id="2833727">string</span><span class="op" id="2833733">)</span>&nbsp;<span class="builtintype" id="2833735">bool</span><span class="op" id="2833739">)</span>&nbsp;<span class="op" id="2833741">(</span><span class="ident" id="2833742">StructField</span><span class="op" id="2833753">,</span>&nbsp;<span class="builtintype" id="2833755">bool</span><span class="op" id="2833759">)</span>&nbsp;<span class="op" id="2833761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2833764">if</span>&nbsp;<span class="ident" id="2833767">t</span><span class="op" id="2833768">.</span><span class="ident" id="2833769">Kind</span><span class="op" id="2833773">(</span><span class="op" id="2833774">)</span>&nbsp;<span class="op" id="2833776">!=</span>&nbsp;<span class="ident" id="2833779">Struct</span>&nbsp;<span class="op" id="2833786">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2833790">panic</span><span class="op" id="2833795">(</span><span class="string" id="2833796">&#34;reflect:&nbsp;FieldByNameFunc&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2833841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2833844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2833847">tt</span>&nbsp;<span class="op" id="2833850">:=</span>&nbsp;<span class="op" id="2833853">(</span><span class="op" id="2833854">*</span><span class="ident" id="2833855">structType</span><span class="op" id="2833865">)</span><span class="op" id="2833866">(</span><span class="ident" id="2833867">unsafe</span><span class="op" id="2833873">.</span><span class="ident" id="2833874">Pointer</span><span class="op" id="2833881">(</span><span class="ident" id="2833882">t</span><span class="op" id="2833883">)</span><span class="op" id="2833884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2833887">return</span>&nbsp;<span class="ident" id="2833894">tt</span><span class="op" id="2833896">.</span><span class="ident" id="2833897">FieldByNameFunc</span><span class="op" id="2833912">(</span><span class="ident" id="2833913">match</span><span class="op" id="2833918">)</span><br>
<span class="lineno"></span><span class="op" id="2833920">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="2833923">func</span>&nbsp;<span class="op" id="2833928">(</span><span class="ident" id="2833929">t</span>&nbsp;<span class="op" id="2833931">*</span><span class="ident" id="2833932">rtype</span><span class="op" id="2833937">)</span>&nbsp;<span class="ident" id="2833939">In</span><span class="op" id="2833941">(</span><span class="ident" id="2833942">i</span>&nbsp;<span class="builtintype" id="2833944">int</span><span class="op" id="2833947">)</span>&nbsp;<span class="ident" id="2833949">Type</span>&nbsp;<span class="op" id="2833954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2833957">if</span>&nbsp;<span class="ident" id="2833960">t</span><span class="op" id="2833961">.</span><span class="ident" id="2833962">Kind</span><span class="op" id="2833966">(</span><span class="op" id="2833967">)</span>&nbsp;<span class="op" id="2833969">!=</span>&nbsp;<span class="ident" id="2833972">Func</span>&nbsp;<span class="op" id="2833977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2833981">panic</span><span class="op" id="2833986">(</span><span class="string" id="2833987">&#34;reflect:&nbsp;In&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2834017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2834020">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2834023">tt</span>&nbsp;<span class="op" id="2834026">:=</span>&nbsp;<span class="op" id="2834029">(</span><span class="op" id="2834030">*</span><span class="ident" id="2834031">funcType</span><span class="op" id="2834039">)</span><span class="op" id="2834040">(</span><span class="ident" id="2834041">unsafe</span><span class="op" id="2834047">.</span><span class="ident" id="2834048">Pointer</span><span class="op" id="2834055">(</span><span class="ident" id="2834056">t</span><span class="op" id="2834057">)</span><span class="op" id="2834058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2834061">return</span>&nbsp;<span class="ident" id="2834068">toType</span><span class="op" id="2834074">(</span><span class="ident" id="2834075">tt</span><span class="op" id="2834077">.</span><span class="ident" id="2834078">in</span><span class="op" id="2834080">[</span><span class="ident" id="2834081">i</span><span class="op" id="2834082">]</span><span class="op" id="2834083">)</span><br>
<span class="lineno"></span><span class="op" id="2834085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2834088">func</span>&nbsp;<span class="op" id="2834093">(</span><span class="ident" id="2834094">t</span>&nbsp;<span class="op" id="2834096">*</span><span class="ident" id="2834097">rtype</span><span class="op" id="2834102">)</span>&nbsp;<span class="ident" id="2834104">Key</span><span class="op" id="2834107">(</span><span class="op" id="2834108">)</span>&nbsp;<span class="ident" id="2834110">Type</span>&nbsp;<span class="op" id="2834115">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2834118">if</span>&nbsp;<span class="ident" id="2834121">t</span><span class="op" id="2834122">.</span><span class="ident" id="2834123">Kind</span><span class="op" id="2834127">(</span><span class="op" id="2834128">)</span>&nbsp;<span class="op" id="2834130">!=</span>&nbsp;<span class="ident" id="2834133">Map</span>&nbsp;<span class="op" id="2834137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2834141">panic</span><span class="op" id="2834146">(</span><span class="string" id="2834147">&#34;reflect:&nbsp;Key&nbsp;of&nbsp;non-map&nbsp;type&#34;</span><span class="op" id="2834177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2834180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2834183">tt</span>&nbsp;<span class="op" id="2834186">:=</span>&nbsp;<span class="op" id="2834189">(</span><span class="op" id="2834190">*</span><span class="ident" id="2834191">mapType</span><span class="op" id="2834198">)</span><span class="op" id="2834199">(</span><span class="ident" id="2834200">unsafe</span><span class="op" id="2834206">.</span><span class="ident" id="2834207">Pointer</span><span class="op" id="2834214">(</span><span class="ident" id="2834215">t</span><span class="op" id="2834216">)</span><span class="op" id="2834217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2834220">return</span>&nbsp;<span class="ident" id="2834227">toType</span><span class="op" id="2834233">(</span><span class="ident" id="2834234">tt</span><span class="op" id="2834236">.</span><span class="ident" id="2834237">key</span><span class="op" id="2834240">)</span><br>
<span class="lineno">645</span><span class="op" id="2834242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2834245">func</span>&nbsp;<span class="op" id="2834250">(</span><span class="ident" id="2834251">t</span>&nbsp;<span class="op" id="2834253">*</span><span class="ident" id="2834254">rtype</span><span class="op" id="2834259">)</span>&nbsp;<span class="ident" id="2834261">Len</span><span class="op" id="2834264">(</span><span class="op" id="2834265">)</span>&nbsp;<span class="builtintype" id="2834267">int</span>&nbsp;<span class="op" id="2834271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2834274">if</span>&nbsp;<span class="ident" id="2834277">t</span><span class="op" id="2834278">.</span><span class="ident" id="2834279">Kind</span><span class="op" id="2834283">(</span><span class="op" id="2834284">)</span>&nbsp;<span class="op" id="2834286">!=</span>&nbsp;<span class="ident" id="2834289">Array</span>&nbsp;<span class="op" id="2834295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2834299">panic</span><span class="op" id="2834304">(</span><span class="string" id="2834305">&#34;reflect:&nbsp;Len&nbsp;of&nbsp;non-array&nbsp;type&#34;</span><span class="op" id="2834337">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2834340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2834343">tt</span>&nbsp;<span class="op" id="2834346">:=</span>&nbsp;<span class="op" id="2834349">(</span><span class="op" id="2834350">*</span><span class="ident" id="2834351">arrayType</span><span class="op" id="2834360">)</span><span class="op" id="2834361">(</span><span class="ident" id="2834362">unsafe</span><span class="op" id="2834368">.</span><span class="ident" id="2834369">Pointer</span><span class="op" id="2834376">(</span><span class="ident" id="2834377">t</span><span class="op" id="2834378">)</span><span class="op" id="2834379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2834382">return</span>&nbsp;<span class="builtintype" id="2834389">int</span><span class="op" id="2834392">(</span><span class="ident" id="2834393">tt</span><span class="op" id="2834395">.</span><span class="builtinfunc" id="2834396">len</span><span class="op" id="2834399">)</span><br>
<span class="lineno"></span><span class="op" id="2834401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="2834404">func</span>&nbsp;<span class="op" id="2834409">(</span><span class="ident" id="2834410">t</span>&nbsp;<span class="op" id="2834412">*</span><span class="ident" id="2834413">rtype</span><span class="op" id="2834418">)</span>&nbsp;<span class="ident" id="2834420">NumField</span><span class="op" id="2834428">(</span><span class="op" id="2834429">)</span>&nbsp;<span class="builtintype" id="2834431">int</span>&nbsp;<span class="op" id="2834435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2834438">if</span>&nbsp;<span class="ident" id="2834441">t</span><span class="op" id="2834442">.</span><span class="ident" id="2834443">Kind</span><span class="op" id="2834447">(</span><span class="op" id="2834448">)</span>&nbsp;<span class="op" id="2834450">!=</span>&nbsp;<span class="ident" id="2834453">Struct</span>&nbsp;<span class="op" id="2834460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2834464">panic</span><span class="op" id="2834469">(</span><span class="string" id="2834470">&#34;reflect:&nbsp;NumField&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2834508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2834511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2834514">tt</span>&nbsp;<span class="op" id="2834517">:=</span>&nbsp;<span class="op" id="2834520">(</span><span class="op" id="2834521">*</span><span class="ident" id="2834522">structType</span><span class="op" id="2834532">)</span><span class="op" id="2834533">(</span><span class="ident" id="2834534">unsafe</span><span class="op" id="2834540">.</span><span class="ident" id="2834541">Pointer</span><span class="op" id="2834548">(</span><span class="ident" id="2834549">t</span><span class="op" id="2834550">)</span><span class="op" id="2834551">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2834554">return</span>&nbsp;<span class="builtinfunc" id="2834561">len</span><span class="op" id="2834564">(</span><span class="ident" id="2834565">tt</span><span class="op" id="2834567">.</span><span class="ident" id="2834568">fields</span><span class="op" id="2834574">)</span><br>
<span class="lineno"></span><span class="op" id="2834576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2834579">func</span>&nbsp;<span class="op" id="2834584">(</span><span class="ident" id="2834585">t</span>&nbsp;<span class="op" id="2834587">*</span><span class="ident" id="2834588">rtype</span><span class="op" id="2834593">)</span>&nbsp;<span class="ident" id="2834595">NumIn</span><span class="op" id="2834600">(</span><span class="op" id="2834601">)</span>&nbsp;<span class="builtintype" id="2834603">int</span>&nbsp;<span class="op" id="2834607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2834610">if</span>&nbsp;<span class="ident" id="2834613">t</span><span class="op" id="2834614">.</span><span class="ident" id="2834615">Kind</span><span class="op" id="2834619">(</span><span class="op" id="2834620">)</span>&nbsp;<span class="op" id="2834622">!=</span>&nbsp;<span class="ident" id="2834625">Func</span>&nbsp;<span class="op" id="2834630">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2834634">panic</span><span class="op" id="2834639">(</span><span class="string" id="2834640">&#34;reflect:&nbsp;NumIn&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2834673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2834676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2834679">tt</span>&nbsp;<span class="op" id="2834682">:=</span>&nbsp;<span class="op" id="2834685">(</span><span class="op" id="2834686">*</span><span class="ident" id="2834687">funcType</span><span class="op" id="2834695">)</span><span class="op" id="2834696">(</span><span class="ident" id="2834697">unsafe</span><span class="op" id="2834703">.</span><span class="ident" id="2834704">Pointer</span><span class="op" id="2834711">(</span><span class="ident" id="2834712">t</span><span class="op" id="2834713">)</span><span class="op" id="2834714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2834717">return</span>&nbsp;<span class="builtinfunc" id="2834724">len</span><span class="op" id="2834727">(</span><span class="ident" id="2834728">tt</span><span class="op" id="2834730">.</span><span class="ident" id="2834731">in</span><span class="op" id="2834733">)</span><br>
<span class="lineno"></span><span class="op" id="2834735">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="2834738">func</span>&nbsp;<span class="op" id="2834743">(</span><span class="ident" id="2834744">t</span>&nbsp;<span class="op" id="2834746">*</span><span class="ident" id="2834747">rtype</span><span class="op" id="2834752">)</span>&nbsp;<span class="ident" id="2834754">NumOut</span><span class="op" id="2834760">(</span><span class="op" id="2834761">)</span>&nbsp;<span class="builtintype" id="2834763">int</span>&nbsp;<span class="op" id="2834767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2834770">if</span>&nbsp;<span class="ident" id="2834773">t</span><span class="op" id="2834774">.</span><span class="ident" id="2834775">Kind</span><span class="op" id="2834779">(</span><span class="op" id="2834780">)</span>&nbsp;<span class="op" id="2834782">!=</span>&nbsp;<span class="ident" id="2834785">Func</span>&nbsp;<span class="op" id="2834790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2834794">panic</span><span class="op" id="2834799">(</span><span class="string" id="2834800">&#34;reflect:&nbsp;NumOut&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2834834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2834837">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2834840">tt</span>&nbsp;<span class="op" id="2834843">:=</span>&nbsp;<span class="op" id="2834846">(</span><span class="op" id="2834847">*</span><span class="ident" id="2834848">funcType</span><span class="op" id="2834856">)</span><span class="op" id="2834857">(</span><span class="ident" id="2834858">unsafe</span><span class="op" id="2834864">.</span><span class="ident" id="2834865">Pointer</span><span class="op" id="2834872">(</span><span class="ident" id="2834873">t</span><span class="op" id="2834874">)</span><span class="op" id="2834875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2834878">return</span>&nbsp;<span class="builtinfunc" id="2834885">len</span><span class="op" id="2834888">(</span><span class="ident" id="2834889">tt</span><span class="op" id="2834891">.</span><span class="ident" id="2834892">out</span><span class="op" id="2834895">)</span><br>
<span class="lineno"></span><span class="op" id="2834897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2834900">func</span>&nbsp;<span class="op" id="2834905">(</span><span class="ident" id="2834906">t</span>&nbsp;<span class="op" id="2834908">*</span><span class="ident" id="2834909">rtype</span><span class="op" id="2834914">)</span>&nbsp;<span class="ident" id="2834916">Out</span><span class="op" id="2834919">(</span><span class="ident" id="2834920">i</span>&nbsp;<span class="builtintype" id="2834922">int</span><span class="op" id="2834925">)</span>&nbsp;<span class="ident" id="2834927">Type</span>&nbsp;<span class="op" id="2834932">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2834935">if</span>&nbsp;<span class="ident" id="2834938">t</span><span class="op" id="2834939">.</span><span class="ident" id="2834940">Kind</span><span class="op" id="2834944">(</span><span class="op" id="2834945">)</span>&nbsp;<span class="op" id="2834947">!=</span>&nbsp;<span class="ident" id="2834950">Func</span>&nbsp;<span class="op" id="2834955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2834959">panic</span><span class="op" id="2834964">(</span><span class="string" id="2834965">&#34;reflect:&nbsp;Out&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2834996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2834999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2835002">tt</span>&nbsp;<span class="op" id="2835005">:=</span>&nbsp;<span class="op" id="2835008">(</span><span class="op" id="2835009">*</span><span class="ident" id="2835010">funcType</span><span class="op" id="2835018">)</span><span class="op" id="2835019">(</span><span class="ident" id="2835020">unsafe</span><span class="op" id="2835026">.</span><span class="ident" id="2835027">Pointer</span><span class="op" id="2835034">(</span><span class="ident" id="2835035">t</span><span class="op" id="2835036">)</span><span class="op" id="2835037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835040">return</span>&nbsp;<span class="ident" id="2835047">toType</span><span class="op" id="2835053">(</span><span class="ident" id="2835054">tt</span><span class="op" id="2835056">.</span><span class="ident" id="2835057">out</span><span class="op" id="2835060">[</span><span class="ident" id="2835061">i</span><span class="op" id="2835062">]</span><span class="op" id="2835063">)</span><br>
<span class="lineno">685</span><span class="op" id="2835065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2835068">func</span>&nbsp;<span class="op" id="2835073">(</span><span class="ident" id="2835074">d</span>&nbsp;<span class="ident" id="2835076">ChanDir</span><span class="op" id="2835083">)</span>&nbsp;<span class="ident" id="2835085">String</span><span class="op" id="2835091">(</span><span class="op" id="2835092">)</span>&nbsp;<span class="builtintype" id="2835094">string</span>&nbsp;<span class="op" id="2835101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835104">switch</span>&nbsp;<span class="ident" id="2835111">d</span>&nbsp;<span class="op" id="2835113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835116">case</span>&nbsp;<span class="ident" id="2835121">SendDir</span><span class="op" id="2835128">:</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835132">return</span>&nbsp;<span class="string" id="2835139">&#34;chan&lt;-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835149">case</span>&nbsp;<span class="ident" id="2835154">RecvDir</span><span class="op" id="2835161">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835165">return</span>&nbsp;<span class="string" id="2835172">&#34;&lt;-chan&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835182">case</span>&nbsp;<span class="ident" id="2835187">BothDir</span><span class="op" id="2835194">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835198">return</span>&nbsp;<span class="string" id="2835205">&#34;chan&#34;</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2835213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835216">return</span>&nbsp;<span class="string" id="2835223">&#34;ChanDir&#34;</span>&nbsp;<span class="op" id="2835233">+</span>&nbsp;<span class="ident" id="2835235">strconv</span><span class="op" id="2835242">.</span><span class="ident" id="2835243">Itoa</span><span class="op" id="2835247">(</span><span class="builtintype" id="2835248">int</span><span class="op" id="2835251">(</span><span class="ident" id="2835252">d</span><span class="op" id="2835253">)</span><span class="op" id="2835254">)</span><br>
<span class="lineno"></span><span class="op" id="2835256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2835259">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">700</span><span class="keyword" id="2835319">func</span>&nbsp;<span class="op" id="2835324">(</span><span class="ident" id="2835325">t</span>&nbsp;<span class="op" id="2835327">*</span><span class="ident" id="2835328">interfaceType</span><span class="op" id="2835341">)</span>&nbsp;<span class="ident" id="2835343">Method</span><span class="op" id="2835349">(</span><span class="ident" id="2835350">i</span>&nbsp;<span class="builtintype" id="2835352">int</span><span class="op" id="2835355">)</span>&nbsp;<span class="op" id="2835357">(</span><span class="ident" id="2835358">m</span>&nbsp;<span class="ident" id="2835360">Method</span><span class="op" id="2835366">)</span>&nbsp;<span class="op" id="2835368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835371">if</span>&nbsp;<span class="ident" id="2835374">i</span>&nbsp;<span class="op" id="2835376">&lt;</span>&nbsp;<span class="num" id="2835378">0</span>&nbsp;<span class="op" id="2835380">||</span>&nbsp;<span class="ident" id="2835383">i</span>&nbsp;<span class="op" id="2835385">&gt;=</span>&nbsp;<span class="builtinfunc" id="2835388">len</span><span class="op" id="2835391">(</span><span class="ident" id="2835392">t</span><span class="op" id="2835393">.</span><span class="ident" id="2835394">methods</span><span class="op" id="2835401">)</span>&nbsp;<span class="op" id="2835403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835407">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2835415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2835418">p</span>&nbsp;<span class="op" id="2835420">:=</span>&nbsp;<span class="op" id="2835423">&amp;</span><span class="ident" id="2835424">t</span><span class="op" id="2835425">.</span><span class="ident" id="2835426">methods</span><span class="op" id="2835433">[</span><span class="ident" id="2835434">i</span><span class="op" id="2835435">]</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2835438">m</span><span class="op" id="2835439">.</span><span class="ident" id="2835440">Name</span>&nbsp;<span class="op" id="2835445">=</span>&nbsp;<span class="op" id="2835447">*</span><span class="ident" id="2835448">p</span><span class="op" id="2835449">.</span><span class="ident" id="2835450">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835456">if</span>&nbsp;<span class="ident" id="2835459">p</span><span class="op" id="2835460">.</span><span class="ident" id="2835461">pkgPath</span>&nbsp;<span class="op" id="2835469">!=</span>&nbsp;<span class="builtintype" id="2835472">nil</span>&nbsp;<span class="op" id="2835476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2835480">m</span><span class="op" id="2835481">.</span><span class="ident" id="2835482">PkgPath</span>&nbsp;<span class="op" id="2835490">=</span>&nbsp;<span class="op" id="2835492">*</span><span class="ident" id="2835493">p</span><span class="op" id="2835494">.</span><span class="ident" id="2835495">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2835504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2835507">m</span><span class="op" id="2835508">.</span><span class="ident" id="2835509">Type</span>&nbsp;<span class="op" id="2835514">=</span>&nbsp;<span class="ident" id="2835516">toType</span><span class="op" id="2835522">(</span><span class="ident" id="2835523">p</span><span class="op" id="2835524">.</span><span class="ident" id="2835525">typ</span><span class="op" id="2835528">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2835531">m</span><span class="op" id="2835532">.</span><span class="ident" id="2835533">Index</span>&nbsp;<span class="op" id="2835539">=</span>&nbsp;<span class="ident" id="2835541">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835544">return</span><br>
<span class="lineno"></span><span class="op" id="2835551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2835554">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;interface&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">715</span><span class="keyword" id="2835633">func</span>&nbsp;<span class="op" id="2835638">(</span><span class="ident" id="2835639">t</span>&nbsp;<span class="op" id="2835641">*</span><span class="ident" id="2835642">interfaceType</span><span class="op" id="2835655">)</span>&nbsp;<span class="ident" id="2835657">NumMethod</span><span class="op" id="2835666">(</span><span class="op" id="2835667">)</span>&nbsp;<span class="builtintype" id="2835669">int</span>&nbsp;<span class="op" id="2835673">{</span>&nbsp;<span class="keyword" id="2835675">return</span>&nbsp;<span class="builtinfunc" id="2835682">len</span><span class="op" id="2835685">(</span><span class="ident" id="2835686">t</span><span class="op" id="2835687">.</span><span class="ident" id="2835688">methods</span><span class="op" id="2835695">)</span>&nbsp;<span class="op" id="2835697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2835700">//&nbsp;MethodByName&nbsp;method&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="2835769">func</span>&nbsp;<span class="op" id="2835774">(</span><span class="ident" id="2835775">t</span>&nbsp;<span class="op" id="2835777">*</span><span class="ident" id="2835778">interfaceType</span><span class="op" id="2835791">)</span>&nbsp;<span class="ident" id="2835793">MethodByName</span><span class="op" id="2835805">(</span><span class="ident" id="2835806">name</span>&nbsp;<span class="builtintype" id="2835811">string</span><span class="op" id="2835817">)</span>&nbsp;<span class="op" id="2835819">(</span><span class="ident" id="2835820">m</span>&nbsp;<span class="ident" id="2835822">Method</span><span class="op" id="2835828">,</span>&nbsp;<span class="ident" id="2835830">ok</span>&nbsp;<span class="builtintype" id="2835833">bool</span><span class="op" id="2835837">)</span>&nbsp;<span class="op" id="2835839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835842">if</span>&nbsp;<span class="ident" id="2835845">t</span>&nbsp;<span class="op" id="2835847">==</span>&nbsp;<span class="builtintype" id="2835850">nil</span>&nbsp;<span class="op" id="2835854">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835858">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2835866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835869">var</span>&nbsp;<span class="ident" id="2835873">p</span>&nbsp;<span class="op" id="2835875">*</span><span class="ident" id="2835876">imethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835885">for</span>&nbsp;<span class="ident" id="2835889">i</span>&nbsp;<span class="op" id="2835891">:=</span>&nbsp;<span class="keyword" id="2835894">range</span>&nbsp;<span class="ident" id="2835900">t</span><span class="op" id="2835901">.</span><span class="ident" id="2835902">methods</span>&nbsp;<span class="op" id="2835910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2835914">p</span>&nbsp;<span class="op" id="2835916">=</span>&nbsp;<span class="op" id="2835918">&amp;</span><span class="ident" id="2835919">t</span><span class="op" id="2835920">.</span><span class="ident" id="2835921">methods</span><span class="op" id="2835928">[</span><span class="ident" id="2835929">i</span><span class="op" id="2835930">]</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835934">if</span>&nbsp;<span class="op" id="2835937">*</span><span class="ident" id="2835938">p</span><span class="op" id="2835939">.</span><span class="ident" id="2835940">name</span>&nbsp;<span class="op" id="2835945">==</span>&nbsp;<span class="ident" id="2835948">name</span>&nbsp;<span class="op" id="2835953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835958">return</span>&nbsp;<span class="ident" id="2835965">t</span><span class="op" id="2835966">.</span><span class="ident" id="2835967">Method</span><span class="op" id="2835973">(</span><span class="ident" id="2835974">i</span><span class="op" id="2835975">)</span><span class="op" id="2835976">,</span>&nbsp;<span class="builtintype" id="2835978">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2835985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2835988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2835991">return</span><br>
<span class="lineno">730</span><span class="op" id="2835998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2836001">//&nbsp;A&nbsp;StructField&nbsp;describes&nbsp;a&nbsp;single&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword" id="2836056">type</span>&nbsp;<span class="ident" id="2836061">StructField</span>&nbsp;<span class="keyword" id="2836073">struct</span>&nbsp;<span class="op" id="2836080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2836083">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2836111">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2836184">//&nbsp;field&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2836252">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2836313">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2836321">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2836329">PkgPath</span>&nbsp;<span class="builtintype" id="2836337">string</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2836346">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2836356">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2836366">//&nbsp;field&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2836381">Tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2836391">StructTag</span>&nbsp;<span class="comment" id="2836401">//&nbsp;field&nbsp;tag&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2836422">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2836432">uintptr</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2836442">//&nbsp;offset&nbsp;within&nbsp;struct,&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2836477">Index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2836487">[</span><span class="op" id="2836488">]</span><span class="builtintype" id="2836489">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2836497">//&nbsp;index&nbsp;sequence&nbsp;for&nbsp;Type.FieldByIndex</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2836538">Anonymous</span>&nbsp;<span class="builtintype" id="2836548">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2836558">//&nbsp;is&nbsp;an&nbsp;embedded&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="2836582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2836585">//&nbsp;A&nbsp;StructTag&nbsp;is&nbsp;the&nbsp;tag&nbsp;string&nbsp;in&nbsp;a&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="2836637">//</span><br>
<span class="lineno">750</span><span class="comment" id="2836640">//&nbsp;By&nbsp;convention,&nbsp;tag&nbsp;strings&nbsp;are&nbsp;a&nbsp;concatenation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2836693">//&nbsp;optionally&nbsp;space-separated&nbsp;key:&#34;value&#34;&nbsp;pairs.</span><br>
<span class="lineno"></span><span class="comment" id="2836742">//&nbsp;Each&nbsp;key&nbsp;is&nbsp;a&nbsp;non-empty&nbsp;string&nbsp;consisting&nbsp;of&nbsp;non-control</span><br>
<span class="lineno"></span><span class="comment" id="2836802">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;space&nbsp;(U+0020&nbsp;&#39;&nbsp;&#39;),&nbsp;quote&nbsp;(U+0022&nbsp;&#39;&#34;&#39;),</span><br>
<span class="lineno"></span><span class="comment" id="2836867">//&nbsp;and&nbsp;colon&nbsp;(U+003A&nbsp;&#39;:&#39;).&nbsp;&nbsp;Each&nbsp;value&nbsp;is&nbsp;quoted&nbsp;using&nbsp;U+0022&nbsp;&#39;&#34;&#39;</span><br>
<span class="lineno">755</span><span class="comment" id="2836933">//&nbsp;characters&nbsp;and&nbsp;Go&nbsp;string&nbsp;literal&nbsp;syntax.</span><br>
<span class="lineno"></span><span class="keyword" id="2836977">type</span>&nbsp;<span class="ident" id="2836982">StructTag</span>&nbsp;<span class="builtintype" id="2836992">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2837000">//&nbsp;Get&nbsp;returns&nbsp;the&nbsp;value&nbsp;associated&nbsp;with&nbsp;key&nbsp;in&nbsp;the&nbsp;tag&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2837064">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;key&nbsp;in&nbsp;the&nbsp;tag,&nbsp;Get&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno">760</span><span class="comment" id="2837133">//&nbsp;If&nbsp;the&nbsp;tag&nbsp;does&nbsp;not&nbsp;have&nbsp;the&nbsp;conventional&nbsp;format,&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2837196">//&nbsp;returned&nbsp;by&nbsp;Get&nbsp;is&nbsp;unspecified.</span><br>
<span class="lineno"></span><span class="keyword" id="2837231">func</span>&nbsp;<span class="op" id="2837236">(</span><span class="ident" id="2837237">tag</span>&nbsp;<span class="ident" id="2837241">StructTag</span><span class="op" id="2837250">)</span>&nbsp;<span class="ident" id="2837252">Get</span><span class="op" id="2837255">(</span><span class="ident" id="2837256">key</span>&nbsp;<span class="builtintype" id="2837260">string</span><span class="op" id="2837266">)</span>&nbsp;<span class="builtintype" id="2837268">string</span>&nbsp;<span class="op" id="2837275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2837278">for</span>&nbsp;<span class="ident" id="2837282">tag</span>&nbsp;<span class="op" id="2837286">!=</span>&nbsp;<span class="string" id="2837289">&#34;&#34;</span>&nbsp;<span class="op" id="2837292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2837296">//&nbsp;skip&nbsp;leading&nbsp;space</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2837320">i</span>&nbsp;<span class="op" id="2837322">:=</span>&nbsp;<span class="num" id="2837325">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2837329">for</span>&nbsp;<span class="ident" id="2837333">i</span>&nbsp;<span class="op" id="2837335">&lt;</span>&nbsp;<span class="builtinfunc" id="2837337">len</span><span class="op" id="2837340">(</span><span class="ident" id="2837341">tag</span><span class="op" id="2837344">)</span>&nbsp;<span class="op" id="2837346">&amp;&amp;</span>&nbsp;<span class="ident" id="2837349">tag</span><span class="op" id="2837352">[</span><span class="ident" id="2837353">i</span><span class="op" id="2837354">]</span>&nbsp;<span class="op" id="2837356">==</span>&nbsp;<span class="string" id="2837359">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2837363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2837368">i</span><span class="op" id="2837369">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2837374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2837378">tag</span>&nbsp;<span class="op" id="2837382">=</span>&nbsp;<span class="ident" id="2837384">tag</span><span class="op" id="2837387">[</span><span class="ident" id="2837388">i</span><span class="op" id="2837389">:</span><span class="op" id="2837390">]</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2837394">if</span>&nbsp;<span class="ident" id="2837397">tag</span>&nbsp;<span class="op" id="2837401">==</span>&nbsp;<span class="string" id="2837404">&#34;&#34;</span>&nbsp;<span class="op" id="2837407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2837412">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2837420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2837425">//&nbsp;scan&nbsp;to&nbsp;colon.</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2837445">//&nbsp;a&nbsp;space&nbsp;or&nbsp;a&nbsp;quote&nbsp;is&nbsp;a&nbsp;syntax&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2837487">i</span>&nbsp;<span class="op" id="2837489">=</span>&nbsp;<span class="num" id="2837491">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2837495">for</span>&nbsp;<span class="ident" id="2837499">i</span>&nbsp;<span class="op" id="2837501">&lt;</span>&nbsp;<span class="builtinfunc" id="2837503">len</span><span class="op" id="2837506">(</span><span class="ident" id="2837507">tag</span><span class="op" id="2837510">)</span>&nbsp;<span class="op" id="2837512">&amp;&amp;</span>&nbsp;<span class="ident" id="2837515">tag</span><span class="op" id="2837518">[</span><span class="ident" id="2837519">i</span><span class="op" id="2837520">]</span>&nbsp;<span class="op" id="2837522">!=</span>&nbsp;<span class="string" id="2837525">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2837529">&amp;&amp;</span>&nbsp;<span class="ident" id="2837532">tag</span><span class="op" id="2837535">[</span><span class="ident" id="2837536">i</span><span class="op" id="2837537">]</span>&nbsp;<span class="op" id="2837539">!=</span>&nbsp;<span class="string" id="2837542">&#39;:&#39;</span>&nbsp;<span class="op" id="2837546">&amp;&amp;</span>&nbsp;<span class="ident" id="2837549">tag</span><span class="op" id="2837552">[</span><span class="ident" id="2837553">i</span><span class="op" id="2837554">]</span>&nbsp;<span class="op" id="2837556">!=</span>&nbsp;<span class="string" id="2837559">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2837563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2837568">i</span><span class="op" id="2837569">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2837574">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2837578">if</span>&nbsp;<span class="ident" id="2837581">i</span><span class="op" id="2837582">+</span><span class="num" id="2837583">1</span>&nbsp;<span class="op" id="2837585">&gt;=</span>&nbsp;<span class="builtinfunc" id="2837588">len</span><span class="op" id="2837591">(</span><span class="ident" id="2837592">tag</span><span class="op" id="2837595">)</span>&nbsp;<span class="op" id="2837597">||</span>&nbsp;<span class="ident" id="2837600">tag</span><span class="op" id="2837603">[</span><span class="ident" id="2837604">i</span><span class="op" id="2837605">]</span>&nbsp;<span class="op" id="2837607">!=</span>&nbsp;<span class="string" id="2837610">&#39;:&#39;</span>&nbsp;<span class="op" id="2837614">||</span>&nbsp;<span class="ident" id="2837617">tag</span><span class="op" id="2837620">[</span><span class="ident" id="2837621">i</span><span class="op" id="2837622">+</span><span class="num" id="2837623">1</span><span class="op" id="2837624">]</span>&nbsp;<span class="op" id="2837626">!=</span>&nbsp;<span class="string" id="2837629">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2837633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2837638">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2837646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2837650">name</span>&nbsp;<span class="op" id="2837655">:=</span>&nbsp;<span class="builtintype" id="2837658">string</span><span class="op" id="2837664">(</span><span class="ident" id="2837665">tag</span><span class="op" id="2837668">[</span><span class="op" id="2837669">:</span><span class="ident" id="2837670">i</span><span class="op" id="2837671">]</span><span class="op" id="2837672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2837676">tag</span>&nbsp;<span class="op" id="2837680">=</span>&nbsp;<span class="ident" id="2837682">tag</span><span class="op" id="2837685">[</span><span class="ident" id="2837686">i</span><span class="op" id="2837687">+</span><span class="num" id="2837688">1</span><span class="op" id="2837689">:</span><span class="op" id="2837690">]</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2837695">//&nbsp;scan&nbsp;quoted&nbsp;string&nbsp;to&nbsp;find&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2837733">i</span>&nbsp;<span class="op" id="2837735">=</span>&nbsp;<span class="num" id="2837737">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2837741">for</span>&nbsp;<span class="ident" id="2837745">i</span>&nbsp;<span class="op" id="2837747">&lt;</span>&nbsp;<span class="builtinfunc" id="2837749">len</span><span class="op" id="2837752">(</span><span class="ident" id="2837753">tag</span><span class="op" id="2837756">)</span>&nbsp;<span class="op" id="2837758">&amp;&amp;</span>&nbsp;<span class="ident" id="2837761">tag</span><span class="op" id="2837764">[</span><span class="ident" id="2837765">i</span><span class="op" id="2837766">]</span>&nbsp;<span class="op" id="2837768">!=</span>&nbsp;<span class="string" id="2837771">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2837775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2837780">if</span>&nbsp;<span class="ident" id="2837783">tag</span><span class="op" id="2837786">[</span><span class="ident" id="2837787">i</span><span class="op" id="2837788">]</span>&nbsp;<span class="op" id="2837790">==</span>&nbsp;<span class="string" id="2837793">&#39;\\&#39;</span>&nbsp;<span class="op" id="2837798">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2837804">i</span><span class="op" id="2837805">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2837811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2837816">i</span><span class="op" id="2837817">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2837822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2837826">if</span>&nbsp;<span class="ident" id="2837829">i</span>&nbsp;<span class="op" id="2837831">&gt;=</span>&nbsp;<span class="builtinfunc" id="2837834">len</span><span class="op" id="2837837">(</span><span class="ident" id="2837838">tag</span><span class="op" id="2837841">)</span>&nbsp;<span class="op" id="2837843">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2837848">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2837856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2837860">qvalue</span>&nbsp;<span class="op" id="2837867">:=</span>&nbsp;<span class="builtintype" id="2837870">string</span><span class="op" id="2837876">(</span><span class="ident" id="2837877">tag</span><span class="op" id="2837880">[</span><span class="op" id="2837881">:</span><span class="ident" id="2837882">i</span><span class="op" id="2837883">+</span><span class="num" id="2837884">1</span><span class="op" id="2837885">]</span><span class="op" id="2837886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2837890">tag</span>&nbsp;<span class="op" id="2837894">=</span>&nbsp;<span class="ident" id="2837896">tag</span><span class="op" id="2837899">[</span><span class="ident" id="2837900">i</span><span class="op" id="2837901">+</span><span class="num" id="2837902">1</span><span class="op" id="2837903">:</span><span class="op" id="2837904">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2837909">if</span>&nbsp;<span class="ident" id="2837912">key</span>&nbsp;<span class="op" id="2837916">==</span>&nbsp;<span class="ident" id="2837919">name</span>&nbsp;<span class="op" id="2837924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2837929">value</span><span class="op" id="2837934">,</span>&nbsp;<span class="ident" id="2837936">_</span>&nbsp;<span class="op" id="2837938">:=</span>&nbsp;<span class="ident" id="2837941">strconv</span><span class="op" id="2837948">.</span><span class="ident" id="2837949">Unquote</span><span class="op" id="2837956">(</span><span class="ident" id="2837957">qvalue</span><span class="op" id="2837963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2837968">return</span>&nbsp;<span class="ident" id="2837975">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2837983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2837986">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2837989">return</span>&nbsp;<span class="string" id="2837996">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2837999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2838002">//&nbsp;Field&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="2838042">func</span>&nbsp;<span class="op" id="2838047">(</span><span class="ident" id="2838048">t</span>&nbsp;<span class="op" id="2838050">*</span><span class="ident" id="2838051">structType</span><span class="op" id="2838061">)</span>&nbsp;<span class="ident" id="2838063">Field</span><span class="op" id="2838068">(</span><span class="ident" id="2838069">i</span>&nbsp;<span class="builtintype" id="2838071">int</span><span class="op" id="2838074">)</span>&nbsp;<span class="op" id="2838076">(</span><span class="ident" id="2838077">f</span>&nbsp;<span class="ident" id="2838079">StructField</span><span class="op" id="2838090">)</span>&nbsp;<span class="op" id="2838092">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2838095">if</span>&nbsp;<span class="ident" id="2838098">i</span>&nbsp;<span class="op" id="2838100">&lt;</span>&nbsp;<span class="num" id="2838102">0</span>&nbsp;<span class="op" id="2838104">||</span>&nbsp;<span class="ident" id="2838107">i</span>&nbsp;<span class="op" id="2838109">&gt;=</span>&nbsp;<span class="builtinfunc" id="2838112">len</span><span class="op" id="2838115">(</span><span class="ident" id="2838116">t</span><span class="op" id="2838117">.</span><span class="ident" id="2838118">fields</span><span class="op" id="2838124">)</span>&nbsp;<span class="op" id="2838126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2838130">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2838138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2838141">p</span>&nbsp;<span class="op" id="2838143">:=</span>&nbsp;<span class="op" id="2838146">&amp;</span><span class="ident" id="2838147">t</span><span class="op" id="2838148">.</span><span class="ident" id="2838149">fields</span><span class="op" id="2838155">[</span><span class="ident" id="2838156">i</span><span class="op" id="2838157">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2838160">f</span><span class="op" id="2838161">.</span><span class="ident" id="2838162">Type</span>&nbsp;<span class="op" id="2838167">=</span>&nbsp;<span class="ident" id="2838169">toType</span><span class="op" id="2838175">(</span><span class="ident" id="2838176">p</span><span class="op" id="2838177">.</span><span class="ident" id="2838178">typ</span><span class="op" id="2838181">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2838184">if</span>&nbsp;<span class="ident" id="2838187">p</span><span class="op" id="2838188">.</span><span class="ident" id="2838189">name</span>&nbsp;<span class="op" id="2838194">!=</span>&nbsp;<span class="builtintype" id="2838197">nil</span>&nbsp;<span class="op" id="2838201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2838205">f</span><span class="op" id="2838206">.</span><span class="ident" id="2838207">Name</span>&nbsp;<span class="op" id="2838212">=</span>&nbsp;<span class="op" id="2838214">*</span><span class="ident" id="2838215">p</span><span class="op" id="2838216">.</span><span class="ident" id="2838217">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2838223">}</span>&nbsp;<span class="keyword" id="2838225">else</span>&nbsp;<span class="op" id="2838230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2838234">t</span>&nbsp;<span class="op" id="2838236">:=</span>&nbsp;<span class="ident" id="2838239">f</span><span class="op" id="2838240">.</span><span class="ident" id="2838241">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2838248">if</span>&nbsp;<span class="ident" id="2838251">t</span><span class="op" id="2838252">.</span><span class="ident" id="2838253">Kind</span><span class="op" id="2838257">(</span><span class="op" id="2838258">)</span>&nbsp;<span class="op" id="2838260">==</span>&nbsp;<span class="ident" id="2838263">Ptr</span>&nbsp;<span class="op" id="2838267">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2838272">t</span>&nbsp;<span class="op" id="2838274">=</span>&nbsp;<span class="ident" id="2838276">t</span><span class="op" id="2838277">.</span><span class="ident" id="2838278">Elem</span><span class="op" id="2838282">(</span><span class="op" id="2838283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2838287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2838291">f</span><span class="op" id="2838292">.</span><span class="ident" id="2838293">Name</span>&nbsp;<span class="op" id="2838298">=</span>&nbsp;<span class="ident" id="2838300">t</span><span class="op" id="2838301">.</span><span class="ident" id="2838302">Name</span><span class="op" id="2838306">(</span><span class="op" id="2838307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2838311">f</span><span class="op" id="2838312">.</span><span class="ident" id="2838313">Anonymous</span>&nbsp;<span class="op" id="2838323">=</span>&nbsp;<span class="builtintype" id="2838325">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2838331">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2838334">if</span>&nbsp;<span class="ident" id="2838337">p</span><span class="op" id="2838338">.</span><span class="ident" id="2838339">pkgPath</span>&nbsp;<span class="op" id="2838347">!=</span>&nbsp;<span class="builtintype" id="2838350">nil</span>&nbsp;<span class="op" id="2838354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2838358">f</span><span class="op" id="2838359">.</span><span class="ident" id="2838360">PkgPath</span>&nbsp;<span class="op" id="2838368">=</span>&nbsp;<span class="op" id="2838370">*</span><span class="ident" id="2838371">p</span><span class="op" id="2838372">.</span><span class="ident" id="2838373">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2838382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2838385">if</span>&nbsp;<span class="ident" id="2838388">p</span><span class="op" id="2838389">.</span><span class="ident" id="2838390">tag</span>&nbsp;<span class="op" id="2838394">!=</span>&nbsp;<span class="builtintype" id="2838397">nil</span>&nbsp;<span class="op" id="2838401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2838405">f</span><span class="op" id="2838406">.</span><span class="ident" id="2838407">Tag</span>&nbsp;<span class="op" id="2838411">=</span>&nbsp;<span class="ident" id="2838413">StructTag</span><span class="op" id="2838422">(</span><span class="op" id="2838423">*</span><span class="ident" id="2838424">p</span><span class="op" id="2838425">.</span><span class="ident" id="2838426">tag</span><span class="op" id="2838429">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2838432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2838435">f</span><span class="op" id="2838436">.</span><span class="ident" id="2838437">Offset</span>&nbsp;<span class="op" id="2838444">=</span>&nbsp;<span class="ident" id="2838446">p</span><span class="op" id="2838447">.</span><span class="ident" id="2838448">offset</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2838457">//&nbsp;NOTE(rsc):&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;allocation&nbsp;in&nbsp;the&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2838517">//&nbsp;presented&nbsp;by&nbsp;a&nbsp;reflect.Type.&nbsp;&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;avoid,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2838578">//&nbsp;at&nbsp;least&nbsp;in&nbsp;the&nbsp;common&nbsp;cases,&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2838637">//&nbsp;that&nbsp;misbehaving&nbsp;clients&nbsp;of&nbsp;reflect&nbsp;cannot&nbsp;affect&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2838697">//&nbsp;uses&nbsp;of&nbsp;reflect.&nbsp;&nbsp;One&nbsp;possibility&nbsp;is&nbsp;CL&nbsp;5371098,&nbsp;but&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2838757">//&nbsp;postponed&nbsp;that&nbsp;ugliness&nbsp;until&nbsp;there&nbsp;is&nbsp;a&nbsp;demonstrated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2838815">//&nbsp;need&nbsp;for&nbsp;the&nbsp;performance.&nbsp;&nbsp;This&nbsp;is&nbsp;issue&nbsp;2320.</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2838866">f</span><span class="op" id="2838867">.</span><span class="ident" id="2838868">Index</span>&nbsp;<span class="op" id="2838874">=</span>&nbsp;<span class="op" id="2838876">[</span><span class="op" id="2838877">]</span><span class="builtintype" id="2838878">int</span><span class="op" id="2838881">{</span><span class="ident" id="2838882">i</span><span class="op" id="2838883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2838886">return</span><br>
<span class="lineno"></span><span class="op" id="2838893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2838896">//&nbsp;TODO(gri):&nbsp;Should&nbsp;there&nbsp;be&nbsp;an&nbsp;error/bool&nbsp;indicator&nbsp;if&nbsp;the&nbsp;index</span><br>
<span class="lineno">845</span><span class="comment" id="2838963">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;wrong&nbsp;for&nbsp;FieldByIndex?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2839005">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;index.</span><br>
<span class="lineno"></span><span class="keyword" id="2839070">func</span>&nbsp;<span class="op" id="2839075">(</span><span class="ident" id="2839076">t</span>&nbsp;<span class="op" id="2839078">*</span><span class="ident" id="2839079">structType</span><span class="op" id="2839089">)</span>&nbsp;<span class="ident" id="2839091">FieldByIndex</span><span class="op" id="2839103">(</span><span class="ident" id="2839104">index</span>&nbsp;<span class="op" id="2839110">[</span><span class="op" id="2839111">]</span><span class="builtintype" id="2839112">int</span><span class="op" id="2839115">)</span>&nbsp;<span class="op" id="2839117">(</span><span class="ident" id="2839118">f</span>&nbsp;<span class="ident" id="2839120">StructField</span><span class="op" id="2839131">)</span>&nbsp;<span class="op" id="2839133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2839136">f</span><span class="op" id="2839137">.</span><span class="ident" id="2839138">Type</span>&nbsp;<span class="op" id="2839143">=</span>&nbsp;<span class="ident" id="2839145">toType</span><span class="op" id="2839151">(</span><span class="op" id="2839152">&amp;</span><span class="ident" id="2839153">t</span><span class="op" id="2839154">.</span><span class="ident" id="2839155">rtype</span><span class="op" id="2839160">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2839163">for</span>&nbsp;<span class="ident" id="2839167">i</span><span class="op" id="2839168">,</span>&nbsp;<span class="ident" id="2839170">x</span>&nbsp;<span class="op" id="2839172">:=</span>&nbsp;<span class="keyword" id="2839175">range</span>&nbsp;<span class="ident" id="2839181">index</span>&nbsp;<span class="op" id="2839187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2839191">if</span>&nbsp;<span class="ident" id="2839194">i</span>&nbsp;<span class="op" id="2839196">&gt;</span>&nbsp;<span class="num" id="2839198">0</span>&nbsp;<span class="op" id="2839200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2839205">ft</span>&nbsp;<span class="op" id="2839208">:=</span>&nbsp;<span class="ident" id="2839211">f</span><span class="op" id="2839212">.</span><span class="ident" id="2839213">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2839221">if</span>&nbsp;<span class="ident" id="2839224">ft</span><span class="op" id="2839226">.</span><span class="ident" id="2839227">Kind</span><span class="op" id="2839231">(</span><span class="op" id="2839232">)</span>&nbsp;<span class="op" id="2839234">==</span>&nbsp;<span class="ident" id="2839237">Ptr</span>&nbsp;<span class="op" id="2839241">&amp;&amp;</span>&nbsp;<span class="ident" id="2839244">ft</span><span class="op" id="2839246">.</span><span class="ident" id="2839247">Elem</span><span class="op" id="2839251">(</span><span class="op" id="2839252">)</span><span class="op" id="2839253">.</span><span class="ident" id="2839254">Kind</span><span class="op" id="2839258">(</span><span class="op" id="2839259">)</span>&nbsp;<span class="op" id="2839261">==</span>&nbsp;<span class="ident" id="2839264">Struct</span>&nbsp;<span class="op" id="2839271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2839277">ft</span>&nbsp;<span class="op" id="2839280">=</span>&nbsp;<span class="ident" id="2839282">ft</span><span class="op" id="2839284">.</span><span class="ident" id="2839285">Elem</span><span class="op" id="2839289">(</span><span class="op" id="2839290">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2839295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2839300">f</span><span class="op" id="2839301">.</span><span class="ident" id="2839302">Type</span>&nbsp;<span class="op" id="2839307">=</span>&nbsp;<span class="ident" id="2839309">ft</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2839314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2839318">f</span>&nbsp;<span class="op" id="2839320">=</span>&nbsp;<span class="ident" id="2839322">f</span><span class="op" id="2839323">.</span><span class="ident" id="2839324">Type</span><span class="op" id="2839328">.</span><span class="ident" id="2839329">Field</span><span class="op" id="2839334">(</span><span class="ident" id="2839335">x</span><span class="op" id="2839336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2839339">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2839342">return</span><br>
<span class="lineno"></span><span class="op" id="2839349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2839352">//&nbsp;A&nbsp;fieldScan&nbsp;represents&nbsp;an&nbsp;item&nbsp;on&nbsp;the&nbsp;fieldByNameFunc&nbsp;scan&nbsp;work&nbsp;list.</span><br>
<span class="lineno"></span><span class="keyword" id="2839425">type</span>&nbsp;<span class="ident" id="2839430">fieldScan</span>&nbsp;<span class="keyword" id="2839440">struct</span>&nbsp;<span class="op" id="2839447">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2839450">typ</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2839456">*</span><span class="ident" id="2839457">structType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2839469">index</span>&nbsp;<span class="op" id="2839475">[</span><span class="op" id="2839476">]</span><span class="builtintype" id="2839477">int</span><br>
<span class="lineno"></span><span class="op" id="2839481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2839484">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name&nbsp;that&nbsp;satisfies&nbsp;the</span><br>
<span class="lineno">870</span><span class="comment" id="2839559">//&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2839627">func</span>&nbsp;<span class="op" id="2839632">(</span><span class="ident" id="2839633">t</span>&nbsp;<span class="op" id="2839635">*</span><span class="ident" id="2839636">structType</span><span class="op" id="2839646">)</span>&nbsp;<span class="ident" id="2839648">FieldByNameFunc</span><span class="op" id="2839663">(</span><span class="ident" id="2839664">match</span>&nbsp;<span class="keyword" id="2839670">func</span><span class="op" id="2839674">(</span><span class="builtintype" id="2839675">string</span><span class="op" id="2839681">)</span>&nbsp;<span class="builtintype" id="2839683">bool</span><span class="op" id="2839687">)</span>&nbsp;<span class="op" id="2839689">(</span><span class="ident" id="2839690">result</span>&nbsp;<span class="ident" id="2839697">StructField</span><span class="op" id="2839708">,</span>&nbsp;<span class="ident" id="2839710">ok</span>&nbsp;<span class="builtintype" id="2839713">bool</span><span class="op" id="2839717">)</span>&nbsp;<span class="op" id="2839719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2839722">//&nbsp;This&nbsp;uses&nbsp;the&nbsp;same&nbsp;condition&nbsp;that&nbsp;the&nbsp;Go&nbsp;language&nbsp;does:&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;unique&nbsp;instance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2839814">//&nbsp;of&nbsp;the&nbsp;match&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level.&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;instances&nbsp;of&nbsp;a&nbsp;match&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2839905">//&nbsp;same&nbsp;depth,&nbsp;they&nbsp;annihilate&nbsp;each&nbsp;other&nbsp;and&nbsp;inhibit&nbsp;any&nbsp;possible&nbsp;match&nbsp;at&nbsp;a&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2839997">//&nbsp;The&nbsp;algorithm&nbsp;is&nbsp;breadth&nbsp;first&nbsp;search,&nbsp;one&nbsp;depth&nbsp;level&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2840068">//&nbsp;The&nbsp;current&nbsp;and&nbsp;next&nbsp;slices&nbsp;are&nbsp;work&nbsp;queues:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2840117">//&nbsp;current&nbsp;lists&nbsp;the&nbsp;fields&nbsp;to&nbsp;visit&nbsp;on&nbsp;this&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2840176">//&nbsp;and&nbsp;next&nbsp;lists&nbsp;the&nbsp;fields&nbsp;on&nbsp;the&nbsp;next&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2840231">current</span>&nbsp;<span class="op" id="2840239">:=</span>&nbsp;<span class="op" id="2840242">[</span><span class="op" id="2840243">]</span><span class="ident" id="2840244">fieldScan</span><span class="op" id="2840253">{</span><span class="op" id="2840254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2840257">next</span>&nbsp;<span class="op" id="2840262">:=</span>&nbsp;<span class="op" id="2840265">[</span><span class="op" id="2840266">]</span><span class="ident" id="2840267">fieldScan</span><span class="op" id="2840276">{</span><span class="op" id="2840277">{</span><span class="ident" id="2840278">typ</span><span class="op" id="2840281">:</span>&nbsp;<span class="ident" id="2840283">t</span><span class="op" id="2840284">}</span><span class="op" id="2840285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2840289">//&nbsp;nextCount&nbsp;records&nbsp;the&nbsp;number&nbsp;of&nbsp;times&nbsp;an&nbsp;embedded&nbsp;type&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2840357">//&nbsp;encountered&nbsp;and&nbsp;considered&nbsp;for&nbsp;queueing&nbsp;in&nbsp;the&nbsp;&#39;next&#39;&nbsp;slice.</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2840422">//&nbsp;We&nbsp;only&nbsp;queue&nbsp;the&nbsp;first&nbsp;one,&nbsp;but&nbsp;we&nbsp;increment&nbsp;the&nbsp;count&nbsp;on&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2840491">//&nbsp;If&nbsp;a&nbsp;struct&nbsp;type&nbsp;T&nbsp;can&nbsp;be&nbsp;reached&nbsp;more&nbsp;than&nbsp;once&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2840568">//&nbsp;then&nbsp;it&nbsp;annihilates&nbsp;itself&nbsp;and&nbsp;need&nbsp;not&nbsp;be&nbsp;considered&nbsp;at&nbsp;all&nbsp;when&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2840641">//&nbsp;process&nbsp;that&nbsp;next&nbsp;depth&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2840676">var</span>&nbsp;<span class="ident" id="2840680">nextCount</span>&nbsp;<span class="keyword" id="2840690">map</span><span class="op" id="2840693">[</span><span class="op" id="2840694">*</span><span class="ident" id="2840695">structType</span><span class="op" id="2840705">]</span><span class="builtintype" id="2840706">int</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2840712">//&nbsp;visited&nbsp;records&nbsp;the&nbsp;structs&nbsp;that&nbsp;have&nbsp;been&nbsp;considered&nbsp;already.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2840779">//&nbsp;Embedded&nbsp;pointer&nbsp;fields&nbsp;can&nbsp;create&nbsp;cycles&nbsp;in&nbsp;the&nbsp;graph&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2840841">//&nbsp;reachable&nbsp;embedded&nbsp;types;&nbsp;visited&nbsp;avoids&nbsp;following&nbsp;those&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2840910">//&nbsp;It&nbsp;also&nbsp;avoids&nbsp;duplicated&nbsp;effort:&nbsp;if&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;the&nbsp;field&nbsp;in&nbsp;an</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2840982">//&nbsp;embedded&nbsp;type&nbsp;T&nbsp;at&nbsp;level&nbsp;2,&nbsp;we&nbsp;won&#39;t&nbsp;find&nbsp;it&nbsp;in&nbsp;one&nbsp;at&nbsp;level&nbsp;4&nbsp;either.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2841057">visited</span>&nbsp;<span class="op" id="2841065">:=</span>&nbsp;<span class="keyword" id="2841068">map</span><span class="op" id="2841071">[</span><span class="op" id="2841072">*</span><span class="ident" id="2841073">structType</span><span class="op" id="2841083">]</span><span class="builtintype" id="2841084">bool</span><span class="op" id="2841088">{</span><span class="op" id="2841089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2841093">for</span>&nbsp;<span class="builtinfunc" id="2841097">len</span><span class="op" id="2841100">(</span><span class="ident" id="2841101">next</span><span class="op" id="2841105">)</span>&nbsp;<span class="op" id="2841107">&gt;</span>&nbsp;<span class="num" id="2841109">0</span>&nbsp;<span class="op" id="2841111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2841115">current</span><span class="op" id="2841122">,</span>&nbsp;<span class="ident" id="2841124">next</span>&nbsp;<span class="op" id="2841129">=</span>&nbsp;<span class="ident" id="2841131">next</span><span class="op" id="2841135">,</span>&nbsp;<span class="ident" id="2841137">current</span><span class="op" id="2841144">[</span><span class="op" id="2841145">:</span><span class="num" id="2841146">0</span><span class="op" id="2841147">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2841151">count</span>&nbsp;<span class="op" id="2841157">:=</span>&nbsp;<span class="ident" id="2841160">nextCount</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2841172">nextCount</span>&nbsp;<span class="op" id="2841182">=</span>&nbsp;<span class="builtintype" id="2841184">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2841191">//&nbsp;Process&nbsp;all&nbsp;the&nbsp;fields&nbsp;at&nbsp;this&nbsp;depth,&nbsp;now&nbsp;listed&nbsp;in&nbsp;&#39;current&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2841259">//&nbsp;The&nbsp;loop&nbsp;queues&nbsp;embedded&nbsp;fields&nbsp;found&nbsp;in&nbsp;&#39;next&#39;,&nbsp;for&nbsp;processing&nbsp;during&nbsp;the&nbsp;next</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2841344">//&nbsp;iteration.&nbsp;The&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;current&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2841419">//&nbsp;in&nbsp;&#39;count&#39;;&nbsp;the&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;next&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded&nbsp;in&nbsp;&#39;nextCount&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2841508">for</span>&nbsp;<span class="ident" id="2841512">_</span><span class="op" id="2841513">,</span>&nbsp;<span class="ident" id="2841515">scan</span>&nbsp;<span class="op" id="2841520">:=</span>&nbsp;<span class="keyword" id="2841523">range</span>&nbsp;<span class="ident" id="2841529">current</span>&nbsp;<span class="op" id="2841537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2841542">t</span>&nbsp;<span class="op" id="2841544">:=</span>&nbsp;<span class="ident" id="2841547">scan</span><span class="op" id="2841551">.</span><span class="ident" id="2841552">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2841559">if</span>&nbsp;<span class="ident" id="2841562">visited</span><span class="op" id="2841569">[</span><span class="ident" id="2841570">t</span><span class="op" id="2841571">]</span>&nbsp;<span class="op" id="2841573">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2841579">//&nbsp;We&#39;ve&nbsp;looked&nbsp;through&nbsp;this&nbsp;type&nbsp;before,&nbsp;at&nbsp;a&nbsp;higher&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2841644">//&nbsp;That&nbsp;higher&nbsp;level&nbsp;would&nbsp;shadow&nbsp;the&nbsp;lower&nbsp;level&nbsp;we&#39;re&nbsp;now&nbsp;at,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2841712">//&nbsp;so&nbsp;this&nbsp;one&nbsp;can&#39;t&nbsp;be&nbsp;useful&nbsp;to&nbsp;us.&nbsp;Ignore&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2841765">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2841777">}</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2841782">visited</span><span class="op" id="2841789">[</span><span class="ident" id="2841790">t</span><span class="op" id="2841791">]</span>&nbsp;<span class="op" id="2841793">=</span>&nbsp;<span class="builtintype" id="2841795">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2841803">for</span>&nbsp;<span class="ident" id="2841807">i</span>&nbsp;<span class="op" id="2841809">:=</span>&nbsp;<span class="keyword" id="2841812">range</span>&nbsp;<span class="ident" id="2841818">t</span><span class="op" id="2841819">.</span><span class="ident" id="2841820">fields</span>&nbsp;<span class="op" id="2841827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2841833">f</span>&nbsp;<span class="op" id="2841835">:=</span>&nbsp;<span class="op" id="2841838">&amp;</span><span class="ident" id="2841839">t</span><span class="op" id="2841840">.</span><span class="ident" id="2841841">fields</span><span class="op" id="2841847">[</span><span class="ident" id="2841848">i</span><span class="op" id="2841849">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2841855">//&nbsp;Find&nbsp;name&nbsp;and&nbsp;type&nbsp;for&nbsp;field&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2841894">var</span>&nbsp;<span class="ident" id="2841898">fname</span>&nbsp;<span class="builtintype" id="2841904">string</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2841915">var</span>&nbsp;<span class="ident" id="2841919">ntyp</span>&nbsp;<span class="op" id="2841924">*</span><span class="ident" id="2841925">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2841935">if</span>&nbsp;<span class="ident" id="2841938">f</span><span class="op" id="2841939">.</span><span class="ident" id="2841940">name</span>&nbsp;<span class="op" id="2841945">!=</span>&nbsp;<span class="builtintype" id="2841948">nil</span>&nbsp;<span class="op" id="2841952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2841959">fname</span>&nbsp;<span class="op" id="2841965">=</span>&nbsp;<span class="op" id="2841967">*</span><span class="ident" id="2841968">f</span><span class="op" id="2841969">.</span><span class="ident" id="2841970">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2841979">}</span>&nbsp;<span class="keyword" id="2841981">else</span>&nbsp;<span class="op" id="2841986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2841993">//&nbsp;Anonymous&nbsp;field&nbsp;of&nbsp;type&nbsp;T&nbsp;or&nbsp;*T.</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2842034">//&nbsp;Name&nbsp;taken&nbsp;from&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2842064">ntyp</span>&nbsp;<span class="op" id="2842069">=</span>&nbsp;<span class="ident" id="2842071">f</span><span class="op" id="2842072">.</span><span class="ident" id="2842073">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2842082">if</span>&nbsp;<span class="ident" id="2842085">ntyp</span><span class="op" id="2842089">.</span><span class="ident" id="2842090">Kind</span><span class="op" id="2842094">(</span><span class="op" id="2842095">)</span>&nbsp;<span class="op" id="2842097">==</span>&nbsp;<span class="ident" id="2842100">Ptr</span>&nbsp;<span class="op" id="2842104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2842112">ntyp</span>&nbsp;<span class="op" id="2842117">=</span>&nbsp;<span class="ident" id="2842119">ntyp</span><span class="op" id="2842123">.</span><span class="ident" id="2842124">Elem</span><span class="op" id="2842128">(</span><span class="op" id="2842129">)</span><span class="op" id="2842130">.</span><span class="ident" id="2842131">common</span><span class="op" id="2842137">(</span><span class="op" id="2842138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2842145">}</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2842152">fname</span>&nbsp;<span class="op" id="2842158">=</span>&nbsp;<span class="ident" id="2842160">ntyp</span><span class="op" id="2842164">.</span><span class="ident" id="2842165">Name</span><span class="op" id="2842169">(</span><span class="op" id="2842170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2842176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2842183">//&nbsp;Does&nbsp;it&nbsp;match?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2842205">if</span>&nbsp;<span class="ident" id="2842208">match</span><span class="op" id="2842213">(</span><span class="ident" id="2842214">fname</span><span class="op" id="2842219">)</span>&nbsp;<span class="op" id="2842221">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2842228">//&nbsp;Potential&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2842252">if</span>&nbsp;<span class="ident" id="2842255">count</span><span class="op" id="2842260">[</span><span class="ident" id="2842261">t</span><span class="op" id="2842262">]</span>&nbsp;<span class="op" id="2842264">&gt;</span>&nbsp;<span class="num" id="2842266">1</span>&nbsp;<span class="op" id="2842268">||</span>&nbsp;<span class="ident" id="2842271">ok</span>&nbsp;<span class="op" id="2842274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2842282">//&nbsp;Name&nbsp;appeared&nbsp;multiple&nbsp;times&nbsp;at&nbsp;this&nbsp;level:&nbsp;annihilate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2842347">return</span>&nbsp;<span class="ident" id="2842354">StructField</span><span class="op" id="2842365">{</span><span class="op" id="2842366">}</span><span class="op" id="2842367">,</span>&nbsp;<span class="builtintype" id="2842369">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2842380">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2842387">result</span>&nbsp;<span class="op" id="2842394">=</span>&nbsp;<span class="ident" id="2842396">t</span><span class="op" id="2842397">.</span><span class="ident" id="2842398">Field</span><span class="op" id="2842403">(</span><span class="ident" id="2842404">i</span><span class="op" id="2842405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2842412">result</span><span class="op" id="2842418">.</span><span class="ident" id="2842419">Index</span>&nbsp;<span class="op" id="2842425">=</span>&nbsp;<span class="builtintype" id="2842427">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2842436">result</span><span class="op" id="2842442">.</span><span class="ident" id="2842443">Index</span>&nbsp;<span class="op" id="2842449">=</span>&nbsp;<span class="builtinfunc" id="2842451">append</span><span class="op" id="2842457">(</span><span class="ident" id="2842458">result</span><span class="op" id="2842464">.</span><span class="ident" id="2842465">Index</span><span class="op" id="2842470">,</span>&nbsp;<span class="ident" id="2842472">scan</span><span class="op" id="2842476">.</span><span class="ident" id="2842477">index</span><span class="op" id="2842482">...</span><span class="op" id="2842485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2842492">result</span><span class="op" id="2842498">.</span><span class="ident" id="2842499">Index</span>&nbsp;<span class="op" id="2842505">=</span>&nbsp;<span class="builtinfunc" id="2842507">append</span><span class="op" id="2842513">(</span><span class="ident" id="2842514">result</span><span class="op" id="2842520">.</span><span class="ident" id="2842521">Index</span><span class="op" id="2842526">,</span>&nbsp;<span class="ident" id="2842528">i</span><span class="op" id="2842529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2842536">ok</span>&nbsp;<span class="op" id="2842539">=</span>&nbsp;<span class="builtintype" id="2842541">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2842551">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2842564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2842571">//&nbsp;Queue&nbsp;embedded&nbsp;struct&nbsp;fields&nbsp;for&nbsp;processing&nbsp;with&nbsp;next&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2842639">//&nbsp;but&nbsp;only&nbsp;if&nbsp;we&nbsp;haven&#39;t&nbsp;seen&nbsp;a&nbsp;match&nbsp;yet&nbsp;at&nbsp;this&nbsp;level&nbsp;and&nbsp;only</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2842709">//&nbsp;if&nbsp;the&nbsp;embedded&nbsp;types&nbsp;haven&#39;t&nbsp;already&nbsp;been&nbsp;queued.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2842767">if</span>&nbsp;<span class="ident" id="2842770">ok</span>&nbsp;<span class="op" id="2842773">||</span>&nbsp;<span class="ident" id="2842776">ntyp</span>&nbsp;<span class="op" id="2842781">==</span>&nbsp;<span class="builtintype" id="2842784">nil</span>&nbsp;<span class="op" id="2842788">||</span>&nbsp;<span class="ident" id="2842791">ntyp</span><span class="op" id="2842795">.</span><span class="ident" id="2842796">Kind</span><span class="op" id="2842800">(</span><span class="op" id="2842801">)</span>&nbsp;<span class="op" id="2842803">!=</span>&nbsp;<span class="ident" id="2842806">Struct</span>&nbsp;<span class="op" id="2842813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2842820">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2842833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2842839">styp</span>&nbsp;<span class="op" id="2842844">:=</span>&nbsp;<span class="op" id="2842847">(</span><span class="op" id="2842848">*</span><span class="ident" id="2842849">structType</span><span class="op" id="2842859">)</span><span class="op" id="2842860">(</span><span class="ident" id="2842861">unsafe</span><span class="op" id="2842867">.</span><span class="ident" id="2842868">Pointer</span><span class="op" id="2842875">(</span><span class="ident" id="2842876">ntyp</span><span class="op" id="2842880">)</span><span class="op" id="2842881">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2842887">if</span>&nbsp;<span class="ident" id="2842890">nextCount</span><span class="op" id="2842899">[</span><span class="ident" id="2842900">styp</span><span class="op" id="2842904">]</span>&nbsp;<span class="op" id="2842906">&gt;</span>&nbsp;<span class="num" id="2842908">0</span>&nbsp;<span class="op" id="2842910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2842917">nextCount</span><span class="op" id="2842926">[</span><span class="ident" id="2842927">styp</span><span class="op" id="2842931">]</span>&nbsp;<span class="op" id="2842933">=</span>&nbsp;<span class="num" id="2842935">2</span>&nbsp;<span class="comment" id="2842937">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2842975">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2842988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2842994">if</span>&nbsp;<span class="ident" id="2842997">nextCount</span>&nbsp;<span class="op" id="2843007">==</span>&nbsp;<span class="builtintype" id="2843010">nil</span>&nbsp;<span class="op" id="2843014">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2843021">nextCount</span>&nbsp;<span class="op" id="2843031">=</span>&nbsp;<span class="keyword" id="2843033">map</span><span class="op" id="2843036">[</span><span class="op" id="2843037">*</span><span class="ident" id="2843038">structType</span><span class="op" id="2843048">]</span><span class="builtintype" id="2843049">int</span><span class="op" id="2843052">{</span><span class="op" id="2843053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2843059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2843065">nextCount</span><span class="op" id="2843074">[</span><span class="ident" id="2843075">styp</span><span class="op" id="2843079">]</span>&nbsp;<span class="op" id="2843081">=</span>&nbsp;<span class="num" id="2843083">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2843089">if</span>&nbsp;<span class="ident" id="2843092">count</span><span class="op" id="2843097">[</span><span class="ident" id="2843098">t</span><span class="op" id="2843099">]</span>&nbsp;<span class="op" id="2843101">&gt;</span>&nbsp;<span class="num" id="2843103">1</span>&nbsp;<span class="op" id="2843105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2843112">nextCount</span><span class="op" id="2843121">[</span><span class="ident" id="2843122">styp</span><span class="op" id="2843126">]</span>&nbsp;<span class="op" id="2843128">=</span>&nbsp;<span class="num" id="2843130">2</span>&nbsp;<span class="comment" id="2843132">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2843169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2843175">var</span>&nbsp;<span class="ident" id="2843179">index</span>&nbsp;<span class="op" id="2843185">[</span><span class="op" id="2843186">]</span><span class="builtintype" id="2843187">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2843195">index</span>&nbsp;<span class="op" id="2843201">=</span>&nbsp;<span class="builtinfunc" id="2843203">append</span><span class="op" id="2843209">(</span><span class="ident" id="2843210">index</span><span class="op" id="2843215">,</span>&nbsp;<span class="ident" id="2843217">scan</span><span class="op" id="2843221">.</span><span class="ident" id="2843222">index</span><span class="op" id="2843227">...</span><span class="op" id="2843230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2843236">index</span>&nbsp;<span class="op" id="2843242">=</span>&nbsp;<span class="builtinfunc" id="2843244">append</span><span class="op" id="2843250">(</span><span class="ident" id="2843251">index</span><span class="op" id="2843256">,</span>&nbsp;<span class="ident" id="2843258">i</span><span class="op" id="2843259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2843265">next</span>&nbsp;<span class="op" id="2843270">=</span>&nbsp;<span class="builtinfunc" id="2843272">append</span><span class="op" id="2843278">(</span><span class="ident" id="2843279">next</span><span class="op" id="2843283">,</span>&nbsp;<span class="ident" id="2843285">fieldScan</span><span class="op" id="2843294">{</span><span class="ident" id="2843295">styp</span><span class="op" id="2843299">,</span>&nbsp;<span class="ident" id="2843301">index</span><span class="op" id="2843306">}</span><span class="op" id="2843307">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2843312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2843316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2843320">if</span>&nbsp;<span class="ident" id="2843323">ok</span>&nbsp;<span class="op" id="2843326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2843331">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2843339">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2843342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2843345">return</span><br>
<span class="lineno"></span><span class="op" id="2843352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2843355">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">980</span><span class="comment" id="2843415">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2843468">func</span>&nbsp;<span class="op" id="2843473">(</span><span class="ident" id="2843474">t</span>&nbsp;<span class="op" id="2843476">*</span><span class="ident" id="2843477">structType</span><span class="op" id="2843487">)</span>&nbsp;<span class="ident" id="2843489">FieldByName</span><span class="op" id="2843500">(</span><span class="ident" id="2843501">name</span>&nbsp;<span class="builtintype" id="2843506">string</span><span class="op" id="2843512">)</span>&nbsp;<span class="op" id="2843514">(</span><span class="ident" id="2843515">f</span>&nbsp;<span class="ident" id="2843517">StructField</span><span class="op" id="2843528">,</span>&nbsp;<span class="ident" id="2843530">present</span>&nbsp;<span class="builtintype" id="2843538">bool</span><span class="op" id="2843542">)</span>&nbsp;<span class="op" id="2843544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2843547">//&nbsp;Quick&nbsp;check&nbsp;for&nbsp;top-level&nbsp;name,&nbsp;or&nbsp;struct&nbsp;without&nbsp;anonymous&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2843619">hasAnon</span>&nbsp;<span class="op" id="2843627">:=</span>&nbsp;<span class="builtintype" id="2843630">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2843637">if</span>&nbsp;<span class="ident" id="2843640">name</span>&nbsp;<span class="op" id="2843645">!=</span>&nbsp;<span class="string" id="2843648">&#34;&#34;</span>&nbsp;<span class="op" id="2843651">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2843655">for</span>&nbsp;<span class="ident" id="2843659">i</span>&nbsp;<span class="op" id="2843661">:=</span>&nbsp;<span class="keyword" id="2843664">range</span>&nbsp;<span class="ident" id="2843670">t</span><span class="op" id="2843671">.</span><span class="ident" id="2843672">fields</span>&nbsp;<span class="op" id="2843679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2843684">tf</span>&nbsp;<span class="op" id="2843687">:=</span>&nbsp;<span class="op" id="2843690">&amp;</span><span class="ident" id="2843691">t</span><span class="op" id="2843692">.</span><span class="ident" id="2843693">fields</span><span class="op" id="2843699">[</span><span class="ident" id="2843700">i</span><span class="op" id="2843701">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2843706">if</span>&nbsp;<span class="ident" id="2843709">tf</span><span class="op" id="2843711">.</span><span class="ident" id="2843712">name</span>&nbsp;<span class="op" id="2843717">==</span>&nbsp;<span class="builtintype" id="2843720">nil</span>&nbsp;<span class="op" id="2843724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2843730">hasAnon</span>&nbsp;<span class="op" id="2843738">=</span>&nbsp;<span class="builtintype" id="2843740">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2843749">continue</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2843761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2843766">if</span>&nbsp;<span class="op" id="2843769">*</span><span class="ident" id="2843770">tf</span><span class="op" id="2843772">.</span><span class="ident" id="2843773">name</span>&nbsp;<span class="op" id="2843778">==</span>&nbsp;<span class="ident" id="2843781">name</span>&nbsp;<span class="op" id="2843786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2843792">return</span>&nbsp;<span class="ident" id="2843799">t</span><span class="op" id="2843800">.</span><span class="ident" id="2843801">Field</span><span class="op" id="2843806">(</span><span class="ident" id="2843807">i</span><span class="op" id="2843808">)</span><span class="op" id="2843809">,</span>&nbsp;<span class="builtintype" id="2843811">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2843819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2843823">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2843826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2843829">if</span>&nbsp;<span class="op" id="2843832">!</span><span class="ident" id="2843833">hasAnon</span>&nbsp;<span class="op" id="2843841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2843845">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2843853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2843856">return</span>&nbsp;<span class="ident" id="2843863">t</span><span class="op" id="2843864">.</span><span class="ident" id="2843865">FieldByNameFunc</span><span class="op" id="2843880">(</span><span class="keyword" id="2843881">func</span><span class="op" id="2843885">(</span><span class="ident" id="2843886">s</span>&nbsp;<span class="builtintype" id="2843888">string</span><span class="op" id="2843894">)</span>&nbsp;<span class="builtintype" id="2843896">bool</span>&nbsp;<span class="op" id="2843901">{</span>&nbsp;<span class="keyword" id="2843903">return</span>&nbsp;<span class="ident" id="2843910">s</span>&nbsp;<span class="op" id="2843912">==</span>&nbsp;<span class="ident" id="2843915">name</span>&nbsp;<span class="op" id="2843920">}</span><span class="op" id="2843921">)</span><br>
<span class="lineno">1000</span><span class="op" id="2843923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2843926">//&nbsp;TypeOf&nbsp;returns&nbsp;the&nbsp;reflection&nbsp;Type&nbsp;of&nbsp;the&nbsp;value&nbsp;in&nbsp;the&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="2843997">//&nbsp;TypeOf(nil)&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2844025">func</span>&nbsp;<span class="ident" id="2844030">TypeOf</span><span class="op" id="2844036">(</span><span class="ident" id="2844037">i</span>&nbsp;<span class="keyword" id="2844039">interface</span><span class="op" id="2844048">{</span><span class="op" id="2844049">}</span><span class="op" id="2844050">)</span>&nbsp;<span class="ident" id="2844052">Type</span>&nbsp;<span class="op" id="2844057">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2844060">eface</span>&nbsp;<span class="op" id="2844066">:=</span>&nbsp;<span class="op" id="2844069">*</span><span class="op" id="2844070">(</span><span class="op" id="2844071">*</span><span class="ident" id="2844072">emptyInterface</span><span class="op" id="2844086">)</span><span class="op" id="2844087">(</span><span class="ident" id="2844088">unsafe</span><span class="op" id="2844094">.</span><span class="ident" id="2844095">Pointer</span><span class="op" id="2844102">(</span><span class="op" id="2844103">&amp;</span><span class="ident" id="2844104">i</span><span class="op" id="2844105">)</span><span class="op" id="2844106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2844109">return</span>&nbsp;<span class="ident" id="2844116">toType</span><span class="op" id="2844122">(</span><span class="ident" id="2844123">eface</span><span class="op" id="2844128">.</span><span class="ident" id="2844129">typ</span><span class="op" id="2844132">)</span><br>
<span class="lineno"></span><span class="op" id="2844134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2844137">//&nbsp;ptrMap&nbsp;is&nbsp;the&nbsp;cache&nbsp;for&nbsp;PtrTo.</span><br>
<span class="lineno">1010</span><span class="keyword" id="2844171">var</span>&nbsp;<span class="ident" id="2844175">ptrMap</span>&nbsp;<span class="keyword" id="2844182">struct</span>&nbsp;<span class="op" id="2844189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2844192">sync</span><span class="op" id="2844196">.</span><span class="ident" id="2844197">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2844206">m</span>&nbsp;<span class="keyword" id="2844208">map</span><span class="op" id="2844211">[</span><span class="op" id="2844212">*</span><span class="ident" id="2844213">rtype</span><span class="op" id="2844218">]</span><span class="op" id="2844219">*</span><span class="ident" id="2844220">ptrType</span><br>
<span class="lineno"></span><span class="op" id="2844228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1015</span><span class="comment" id="2844231">//&nbsp;PtrTo&nbsp;returns&nbsp;the&nbsp;pointer&nbsp;type&nbsp;with&nbsp;element&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2844281">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;type&nbsp;Foo,&nbsp;PtrTo(t)&nbsp;represents&nbsp;*Foo.</span><br>
<span class="lineno"></span><span class="keyword" id="2844349">func</span>&nbsp;<span class="ident" id="2844354">PtrTo</span><span class="op" id="2844359">(</span><span class="ident" id="2844360">t</span>&nbsp;<span class="ident" id="2844362">Type</span><span class="op" id="2844366">)</span>&nbsp;<span class="ident" id="2844368">Type</span>&nbsp;<span class="op" id="2844373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2844376">return</span>&nbsp;<span class="ident" id="2844383">t</span><span class="op" id="2844384">.</span><span class="op" id="2844385">(</span><span class="op" id="2844386">*</span><span class="ident" id="2844387">rtype</span><span class="op" id="2844392">)</span><span class="op" id="2844393">.</span><span class="ident" id="2844394">ptrTo</span><span class="op" id="2844399">(</span><span class="op" id="2844400">)</span><br>
<span class="lineno"></span><span class="op" id="2844402">}</span><br>
<span class="lineno">1020</span><br>
<span class="lineno"></span><span class="keyword" id="2844405">func</span>&nbsp;<span class="op" id="2844410">(</span><span class="ident" id="2844411">t</span>&nbsp;<span class="op" id="2844413">*</span><span class="ident" id="2844414">rtype</span><span class="op" id="2844419">)</span>&nbsp;<span class="ident" id="2844421">ptrTo</span><span class="op" id="2844426">(</span><span class="op" id="2844427">)</span>&nbsp;<span class="op" id="2844429">*</span><span class="ident" id="2844430">rtype</span>&nbsp;<span class="op" id="2844436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2844439">if</span>&nbsp;<span class="ident" id="2844442">p</span>&nbsp;<span class="op" id="2844444">:=</span>&nbsp;<span class="ident" id="2844447">t</span><span class="op" id="2844448">.</span><span class="ident" id="2844449">ptrToThis</span><span class="op" id="2844458">;</span>&nbsp;<span class="ident" id="2844460">p</span>&nbsp;<span class="op" id="2844462">!=</span>&nbsp;<span class="builtintype" id="2844465">nil</span>&nbsp;<span class="op" id="2844469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2844473">return</span>&nbsp;<span class="ident" id="2844480">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2844483">}</span><br>
<span class="lineno">1025</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2844487">//&nbsp;Otherwise,&nbsp;synthesize&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2844518">//&nbsp;This&nbsp;only&nbsp;happens&nbsp;for&nbsp;pointers&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2844570">//&nbsp;We&nbsp;keep&nbsp;the&nbsp;mapping&nbsp;in&nbsp;a&nbsp;map&nbsp;on&nbsp;the&nbsp;side,&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2844624">//&nbsp;this&nbsp;operation&nbsp;is&nbsp;rare&nbsp;and&nbsp;a&nbsp;separate&nbsp;map&nbsp;lets&nbsp;us&nbsp;keep</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2844683">//&nbsp;the&nbsp;type&nbsp;structures&nbsp;in&nbsp;read-only&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2844728">ptrMap</span><span class="op" id="2844734">.</span><span class="ident" id="2844735">RLock</span><span class="op" id="2844740">(</span><span class="op" id="2844741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2844744">if</span>&nbsp;<span class="ident" id="2844747">m</span>&nbsp;<span class="op" id="2844749">:=</span>&nbsp;<span class="ident" id="2844752">ptrMap</span><span class="op" id="2844758">.</span><span class="ident" id="2844759">m</span><span class="op" id="2844760">;</span>&nbsp;<span class="ident" id="2844762">m</span>&nbsp;<span class="op" id="2844764">!=</span>&nbsp;<span class="builtintype" id="2844767">nil</span>&nbsp;<span class="op" id="2844771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2844775">if</span>&nbsp;<span class="ident" id="2844778">p</span>&nbsp;<span class="op" id="2844780">:=</span>&nbsp;<span class="ident" id="2844783">m</span><span class="op" id="2844784">[</span><span class="ident" id="2844785">t</span><span class="op" id="2844786">]</span><span class="op" id="2844787">;</span>&nbsp;<span class="ident" id="2844789">p</span>&nbsp;<span class="op" id="2844791">!=</span>&nbsp;<span class="builtintype" id="2844794">nil</span>&nbsp;<span class="op" id="2844798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2844803">ptrMap</span><span class="op" id="2844809">.</span><span class="ident" id="2844810">RUnlock</span><span class="op" id="2844817">(</span><span class="op" id="2844818">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2844823">return</span>&nbsp;<span class="op" id="2844830">&amp;</span><span class="ident" id="2844831">p</span><span class="op" id="2844832">.</span><span class="ident" id="2844833">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2844841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2844844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2844847">ptrMap</span><span class="op" id="2844853">.</span><span class="ident" id="2844854">RUnlock</span><span class="op" id="2844861">(</span><span class="op" id="2844862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2844865">ptrMap</span><span class="op" id="2844871">.</span><span class="ident" id="2844872">Lock</span><span class="op" id="2844876">(</span><span class="op" id="2844877">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2844880">if</span>&nbsp;<span class="ident" id="2844883">ptrMap</span><span class="op" id="2844889">.</span><span class="ident" id="2844890">m</span>&nbsp;<span class="op" id="2844892">==</span>&nbsp;<span class="builtintype" id="2844895">nil</span>&nbsp;<span class="op" id="2844899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2844903">ptrMap</span><span class="op" id="2844909">.</span><span class="ident" id="2844910">m</span>&nbsp;<span class="op" id="2844912">=</span>&nbsp;<span class="builtinfunc" id="2844914">make</span><span class="op" id="2844918">(</span><span class="keyword" id="2844919">map</span><span class="op" id="2844922">[</span><span class="op" id="2844923">*</span><span class="ident" id="2844924">rtype</span><span class="op" id="2844929">]</span><span class="op" id="2844930">*</span><span class="ident" id="2844931">ptrType</span><span class="op" id="2844938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2844941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2844944">p</span>&nbsp;<span class="op" id="2844946">:=</span>&nbsp;<span class="ident" id="2844949">ptrMap</span><span class="op" id="2844955">.</span><span class="ident" id="2844956">m</span><span class="op" id="2844957">[</span><span class="ident" id="2844958">t</span><span class="op" id="2844959">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2844962">if</span>&nbsp;<span class="ident" id="2844965">p</span>&nbsp;<span class="op" id="2844967">!=</span>&nbsp;<span class="builtintype" id="2844970">nil</span>&nbsp;<span class="op" id="2844974">{</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2844978">//&nbsp;some&nbsp;other&nbsp;goroutine&nbsp;won&nbsp;the&nbsp;race&nbsp;and&nbsp;created&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2845032">ptrMap</span><span class="op" id="2845038">.</span><span class="ident" id="2845039">Unlock</span><span class="op" id="2845045">(</span><span class="op" id="2845046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2845050">return</span>&nbsp;<span class="op" id="2845057">&amp;</span><span class="ident" id="2845058">p</span><span class="op" id="2845059">.</span><span class="ident" id="2845060">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2845067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2845071">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;ptrType&nbsp;starting&nbsp;with&nbsp;the&nbsp;description</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2845126">//&nbsp;of&nbsp;an&nbsp;*unsafe.Pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2845153">p</span>&nbsp;<span class="op" id="2845155">=</span>&nbsp;<span class="builtinfunc" id="2845157">new</span><span class="op" id="2845160">(</span><span class="ident" id="2845161">ptrType</span><span class="op" id="2845168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2845171">var</span>&nbsp;<span class="ident" id="2845175">iptr</span>&nbsp;<span class="keyword" id="2845180">interface</span><span class="op" id="2845189">{</span><span class="op" id="2845190">}</span>&nbsp;<span class="op" id="2845192">=</span>&nbsp;<span class="op" id="2845194">(</span><span class="op" id="2845195">*</span><span class="ident" id="2845196">unsafe</span><span class="op" id="2845202">.</span><span class="ident" id="2845203">Pointer</span><span class="op" id="2845210">)</span><span class="op" id="2845211">(</span><span class="builtintype" id="2845212">nil</span><span class="op" id="2845215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2845218">prototype</span>&nbsp;<span class="op" id="2845228">:=</span>&nbsp;<span class="op" id="2845231">*</span><span class="op" id="2845232">(</span><span class="op" id="2845233">*</span><span class="op" id="2845234">*</span><span class="ident" id="2845235">ptrType</span><span class="op" id="2845242">)</span><span class="op" id="2845243">(</span><span class="ident" id="2845244">unsafe</span><span class="op" id="2845250">.</span><span class="ident" id="2845251">Pointer</span><span class="op" id="2845258">(</span><span class="op" id="2845259">&amp;</span><span class="ident" id="2845260">iptr</span><span class="op" id="2845264">)</span><span class="op" id="2845265">)</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2845268">*</span><span class="ident" id="2845269">p</span>&nbsp;<span class="op" id="2845271">=</span>&nbsp;<span class="op" id="2845273">*</span><span class="ident" id="2845274">prototype</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2845286">s</span>&nbsp;<span class="op" id="2845288">:=</span>&nbsp;<span class="string" id="2845291">&#34;*&#34;</span>&nbsp;<span class="op" id="2845295">+</span>&nbsp;<span class="op" id="2845297">*</span><span class="ident" id="2845298">t</span><span class="op" id="2845299">.</span><span class="builtintype" id="2845300">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2845308">p</span><span class="op" id="2845309">.</span><span class="builtintype" id="2845310">string</span>&nbsp;<span class="op" id="2845317">=</span>&nbsp;<span class="op" id="2845319">&amp;</span><span class="ident" id="2845320">s</span><br>
<span class="lineno"></span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2845324">//&nbsp;For&nbsp;the&nbsp;type&nbsp;structures&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary,&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2845380">//&nbsp;compiler&nbsp;provides&nbsp;a&nbsp;good&nbsp;hash&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2845429">//&nbsp;Create&nbsp;a&nbsp;good&nbsp;hash&nbsp;for&nbsp;the&nbsp;new&nbsp;string&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2845480">//&nbsp;the&nbsp;FNV-1&nbsp;hash&#39;s&nbsp;mixing&nbsp;function&nbsp;to&nbsp;combine&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2845532">//&nbsp;old&nbsp;hash&nbsp;and&nbsp;the&nbsp;new&nbsp;&#34;*&#34;.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2845562">p</span><span class="op" id="2845563">.</span><span class="ident" id="2845564">hash</span>&nbsp;<span class="op" id="2845569">=</span>&nbsp;<span class="ident" id="2845571">fnv1</span><span class="op" id="2845575">(</span><span class="ident" id="2845576">t</span><span class="op" id="2845577">.</span><span class="ident" id="2845578">hash</span><span class="op" id="2845582">,</span>&nbsp;<span class="string" id="2845584">&#39;*&#39;</span><span class="op" id="2845587">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2845591">p</span><span class="op" id="2845592">.</span><span class="ident" id="2845593">uncommonType</span>&nbsp;<span class="op" id="2845606">=</span>&nbsp;<span class="builtintype" id="2845608">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2845613">p</span><span class="op" id="2845614">.</span><span class="ident" id="2845615">ptrToThis</span>&nbsp;<span class="op" id="2845625">=</span>&nbsp;<span class="builtintype" id="2845627">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2845632">p</span><span class="op" id="2845633">.</span><span class="ident" id="2845634">zero</span>&nbsp;<span class="op" id="2845639">=</span>&nbsp;<span class="ident" id="2845641">unsafe</span><span class="op" id="2845647">.</span><span class="ident" id="2845648">Pointer</span><span class="op" id="2845655">(</span><span class="op" id="2845656">&amp;</span><span class="builtinfunc" id="2845657">make</span><span class="op" id="2845661">(</span><span class="op" id="2845662">[</span><span class="op" id="2845663">]</span><span class="builtintype" id="2845664">byte</span><span class="op" id="2845668">,</span>&nbsp;<span class="ident" id="2845670">p</span><span class="op" id="2845671">.</span><span class="ident" id="2845672">size</span><span class="op" id="2845676">)</span><span class="op" id="2845677">[</span><span class="num" id="2845678">0</span><span class="op" id="2845679">]</span><span class="op" id="2845680">)</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2845683">p</span><span class="op" id="2845684">.</span><span class="ident" id="2845685">elem</span>&nbsp;<span class="op" id="2845690">=</span>&nbsp;<span class="ident" id="2845692">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2845696">ptrMap</span><span class="op" id="2845702">.</span><span class="ident" id="2845703">m</span><span class="op" id="2845704">[</span><span class="ident" id="2845705">t</span><span class="op" id="2845706">]</span>&nbsp;<span class="op" id="2845708">=</span>&nbsp;<span class="ident" id="2845710">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2845713">ptrMap</span><span class="op" id="2845719">.</span><span class="ident" id="2845720">Unlock</span><span class="op" id="2845726">(</span><span class="op" id="2845727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2845730">return</span>&nbsp;<span class="op" id="2845737">&amp;</span><span class="ident" id="2845738">p</span><span class="op" id="2845739">.</span><span class="ident" id="2845740">rtype</span><br>
<span class="lineno">1075</span><span class="op" id="2845746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2845749">//&nbsp;fnv1&nbsp;incorporates&nbsp;the&nbsp;list&nbsp;of&nbsp;bytes&nbsp;into&nbsp;the&nbsp;hash&nbsp;x&nbsp;using&nbsp;the&nbsp;FNV-1&nbsp;hash&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="2845835">func</span>&nbsp;<span class="ident" id="2845840">fnv1</span><span class="op" id="2845844">(</span><span class="ident" id="2845845">x</span>&nbsp;<span class="builtintype" id="2845847">uint32</span><span class="op" id="2845853">,</span>&nbsp;<span class="ident" id="2845855">list</span>&nbsp;<span class="op" id="2845860">...</span><span class="builtintype" id="2845863">byte</span><span class="op" id="2845867">)</span>&nbsp;<span class="builtintype" id="2845869">uint32</span>&nbsp;<span class="op" id="2845876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2845879">for</span>&nbsp;<span class="ident" id="2845883">_</span><span class="op" id="2845884">,</span>&nbsp;<span class="ident" id="2845886">b</span>&nbsp;<span class="op" id="2845888">:=</span>&nbsp;<span class="keyword" id="2845891">range</span>&nbsp;<span class="ident" id="2845897">list</span>&nbsp;<span class="op" id="2845902">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2845906">x</span>&nbsp;<span class="op" id="2845908">=</span>&nbsp;<span class="ident" id="2845910">x</span><span class="op" id="2845911">*</span><span class="num" id="2845912">16777619</span>&nbsp;<span class="op" id="2845921">^</span>&nbsp;<span class="builtintype" id="2845923">uint32</span><span class="op" id="2845929">(</span><span class="ident" id="2845930">b</span><span class="op" id="2845931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2845934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2845937">return</span>&nbsp;<span class="ident" id="2845944">x</span><br>
<span class="lineno"></span><span class="op" id="2845946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1085</span><span class="keyword" id="2845949">func</span>&nbsp;<span class="op" id="2845954">(</span><span class="ident" id="2845955">t</span>&nbsp;<span class="op" id="2845957">*</span><span class="ident" id="2845958">rtype</span><span class="op" id="2845963">)</span>&nbsp;<span class="ident" id="2845965">Implements</span><span class="op" id="2845975">(</span><span class="ident" id="2845976">u</span>&nbsp;<span class="ident" id="2845978">Type</span><span class="op" id="2845982">)</span>&nbsp;<span class="builtintype" id="2845984">bool</span>&nbsp;<span class="op" id="2845989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2845992">if</span>&nbsp;<span class="ident" id="2845995">u</span>&nbsp;<span class="op" id="2845997">==</span>&nbsp;<span class="builtintype" id="2846000">nil</span>&nbsp;<span class="op" id="2846004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2846008">panic</span><span class="op" id="2846013">(</span><span class="string" id="2846014">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2846059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2846062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2846065">if</span>&nbsp;<span class="ident" id="2846068">u</span><span class="op" id="2846069">.</span><span class="ident" id="2846070">Kind</span><span class="op" id="2846074">(</span><span class="op" id="2846075">)</span>&nbsp;<span class="op" id="2846077">!=</span>&nbsp;<span class="ident" id="2846080">Interface</span>&nbsp;<span class="op" id="2846090">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2846094">panic</span><span class="op" id="2846099">(</span><span class="string" id="2846100">&#34;reflect:&nbsp;non-interface&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2846155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2846158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2846161">return</span>&nbsp;<span class="ident" id="2846168">implements</span><span class="op" id="2846178">(</span><span class="ident" id="2846179">u</span><span class="op" id="2846180">.</span><span class="op" id="2846181">(</span><span class="op" id="2846182">*</span><span class="ident" id="2846183">rtype</span><span class="op" id="2846188">)</span><span class="op" id="2846189">,</span>&nbsp;<span class="ident" id="2846191">t</span><span class="op" id="2846192">)</span><br>
<span class="lineno"></span><span class="op" id="2846194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span><span class="keyword" id="2846197">func</span>&nbsp;<span class="op" id="2846202">(</span><span class="ident" id="2846203">t</span>&nbsp;<span class="op" id="2846205">*</span><span class="ident" id="2846206">rtype</span><span class="op" id="2846211">)</span>&nbsp;<span class="ident" id="2846213">AssignableTo</span><span class="op" id="2846225">(</span><span class="ident" id="2846226">u</span>&nbsp;<span class="ident" id="2846228">Type</span><span class="op" id="2846232">)</span>&nbsp;<span class="builtintype" id="2846234">bool</span>&nbsp;<span class="op" id="2846239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2846242">if</span>&nbsp;<span class="ident" id="2846245">u</span>&nbsp;<span class="op" id="2846247">==</span>&nbsp;<span class="builtintype" id="2846250">nil</span>&nbsp;<span class="op" id="2846254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2846258">panic</span><span class="op" id="2846263">(</span><span class="string" id="2846264">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.AssignableTo&#34;</span><span class="op" id="2846311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2846314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2846317">uu</span>&nbsp;<span class="op" id="2846320">:=</span>&nbsp;<span class="ident" id="2846323">u</span><span class="op" id="2846324">.</span><span class="op" id="2846325">(</span><span class="op" id="2846326">*</span><span class="ident" id="2846327">rtype</span><span class="op" id="2846332">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2846335">return</span>&nbsp;<span class="ident" id="2846342">directlyAssignable</span><span class="op" id="2846360">(</span><span class="ident" id="2846361">uu</span><span class="op" id="2846363">,</span>&nbsp;<span class="ident" id="2846365">t</span><span class="op" id="2846366">)</span>&nbsp;<span class="op" id="2846368">||</span>&nbsp;<span class="ident" id="2846371">implements</span><span class="op" id="2846381">(</span><span class="ident" id="2846382">uu</span><span class="op" id="2846384">,</span>&nbsp;<span class="ident" id="2846386">t</span><span class="op" id="2846387">)</span><br>
<span class="lineno"></span><span class="op" id="2846389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2846392">func</span>&nbsp;<span class="op" id="2846397">(</span><span class="ident" id="2846398">t</span>&nbsp;<span class="op" id="2846400">*</span><span class="ident" id="2846401">rtype</span><span class="op" id="2846406">)</span>&nbsp;<span class="ident" id="2846408">ConvertibleTo</span><span class="op" id="2846421">(</span><span class="ident" id="2846422">u</span>&nbsp;<span class="ident" id="2846424">Type</span><span class="op" id="2846428">)</span>&nbsp;<span class="builtintype" id="2846430">bool</span>&nbsp;<span class="op" id="2846435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2846438">if</span>&nbsp;<span class="ident" id="2846441">u</span>&nbsp;<span class="op" id="2846443">==</span>&nbsp;<span class="builtintype" id="2846446">nil</span>&nbsp;<span class="op" id="2846450">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2846454">panic</span><span class="op" id="2846459">(</span><span class="string" id="2846460">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.ConvertibleTo&#34;</span><span class="op" id="2846508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2846511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2846514">uu</span>&nbsp;<span class="op" id="2846517">:=</span>&nbsp;<span class="ident" id="2846520">u</span><span class="op" id="2846521">.</span><span class="op" id="2846522">(</span><span class="op" id="2846523">*</span><span class="ident" id="2846524">rtype</span><span class="op" id="2846529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2846532">return</span>&nbsp;<span class="ident" id="2846539">convertOp</span><span class="op" id="2846548">(</span><span class="ident" id="2846549">uu</span><span class="op" id="2846551">,</span>&nbsp;<span class="ident" id="2846553">t</span><span class="op" id="2846554">)</span>&nbsp;<span class="op" id="2846556">!=</span>&nbsp;<span class="builtintype" id="2846559">nil</span><br>
<span class="lineno"></span><span class="op" id="2846563">}</span><br>
<span class="lineno">1110</span><br>
<span class="lineno"></span><span class="keyword" id="2846566">func</span>&nbsp;<span class="op" id="2846571">(</span><span class="ident" id="2846572">t</span>&nbsp;<span class="op" id="2846574">*</span><span class="ident" id="2846575">rtype</span><span class="op" id="2846580">)</span>&nbsp;<span class="ident" id="2846582">Comparable</span><span class="op" id="2846592">(</span><span class="op" id="2846593">)</span>&nbsp;<span class="builtintype" id="2846595">bool</span>&nbsp;<span class="op" id="2846600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2846603">return</span>&nbsp;<span class="ident" id="2846610">t</span><span class="op" id="2846611">.</span><span class="ident" id="2846612">alg</span>&nbsp;<span class="op" id="2846616">!=</span>&nbsp;<span class="builtintype" id="2846619">nil</span>&nbsp;<span class="op" id="2846623">&amp;&amp;</span>&nbsp;<span class="ident" id="2846626">t</span><span class="op" id="2846627">.</span><span class="ident" id="2846628">alg</span><span class="op" id="2846631">.</span><span class="ident" id="2846632">equal</span>&nbsp;<span class="op" id="2846638">!=</span>&nbsp;<span class="builtintype" id="2846641">nil</span><br>
<span class="lineno"></span><span class="op" id="2846645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2846648">//&nbsp;implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;V&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="keyword" id="2846722">func</span>&nbsp;<span class="ident" id="2846727">implements</span><span class="op" id="2846737">(</span><span class="ident" id="2846738">T</span><span class="op" id="2846739">,</span>&nbsp;<span class="ident" id="2846741">V</span>&nbsp;<span class="op" id="2846743">*</span><span class="ident" id="2846744">rtype</span><span class="op" id="2846749">)</span>&nbsp;<span class="builtintype" id="2846751">bool</span>&nbsp;<span class="op" id="2846756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2846759">if</span>&nbsp;<span class="ident" id="2846762">T</span><span class="op" id="2846763">.</span><span class="ident" id="2846764">Kind</span><span class="op" id="2846768">(</span><span class="op" id="2846769">)</span>&nbsp;<span class="op" id="2846771">!=</span>&nbsp;<span class="ident" id="2846774">Interface</span>&nbsp;<span class="op" id="2846784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2846788">return</span>&nbsp;<span class="builtintype" id="2846795">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2846802">}</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2846805">t</span>&nbsp;<span class="op" id="2846807">:=</span>&nbsp;<span class="op" id="2846810">(</span><span class="op" id="2846811">*</span><span class="ident" id="2846812">interfaceType</span><span class="op" id="2846825">)</span><span class="op" id="2846826">(</span><span class="ident" id="2846827">unsafe</span><span class="op" id="2846833">.</span><span class="ident" id="2846834">Pointer</span><span class="op" id="2846841">(</span><span class="ident" id="2846842">T</span><span class="op" id="2846843">)</span><span class="op" id="2846844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2846847">if</span>&nbsp;<span class="builtinfunc" id="2846850">len</span><span class="op" id="2846853">(</span><span class="ident" id="2846854">t</span><span class="op" id="2846855">.</span><span class="ident" id="2846856">methods</span><span class="op" id="2846863">)</span>&nbsp;<span class="op" id="2846865">==</span>&nbsp;<span class="num" id="2846868">0</span>&nbsp;<span class="op" id="2846870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2846874">return</span>&nbsp;<span class="builtintype" id="2846881">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2846887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2846891">//&nbsp;The&nbsp;same&nbsp;algorithm&nbsp;applies&nbsp;in&nbsp;both&nbsp;cases,&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2846945">//&nbsp;method&nbsp;tables&nbsp;for&nbsp;an&nbsp;interface&nbsp;type&nbsp;and&nbsp;a&nbsp;concrete&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2847005">//&nbsp;are&nbsp;different,&nbsp;so&nbsp;the&nbsp;code&nbsp;is&nbsp;duplicated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2847051">//&nbsp;In&nbsp;both&nbsp;cases&nbsp;the&nbsp;algorithm&nbsp;is&nbsp;a&nbsp;linear&nbsp;scan&nbsp;over&nbsp;the&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2847113">//&nbsp;lists&nbsp;-&nbsp;T&#39;s&nbsp;methods&nbsp;and&nbsp;V&#39;s&nbsp;methods&nbsp;-&nbsp;simultaneously.</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2847171">//&nbsp;Since&nbsp;method&nbsp;tables&nbsp;are&nbsp;stored&nbsp;in&nbsp;a&nbsp;unique&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2847231">//&nbsp;(alphabetical,&nbsp;with&nbsp;no&nbsp;duplicate&nbsp;method&nbsp;names),&nbsp;the&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2847292">//&nbsp;through&nbsp;V&#39;s&nbsp;methods&nbsp;must&nbsp;hit&nbsp;a&nbsp;match&nbsp;for&nbsp;each&nbsp;of&nbsp;T&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2847349">//&nbsp;methods&nbsp;along&nbsp;the&nbsp;way,&nbsp;or&nbsp;else&nbsp;V&nbsp;does&nbsp;not&nbsp;implement&nbsp;T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2847408">//&nbsp;This&nbsp;lets&nbsp;us&nbsp;run&nbsp;the&nbsp;scan&nbsp;in&nbsp;overall&nbsp;linear&nbsp;time&nbsp;instead&nbsp;of</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2847472">//&nbsp;the&nbsp;quadratic&nbsp;time&nbsp;&nbsp;a&nbsp;naive&nbsp;search&nbsp;would&nbsp;require.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2847526">//&nbsp;See&nbsp;also&nbsp;../runtime/iface.c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2847559">if</span>&nbsp;<span class="ident" id="2847562">V</span><span class="op" id="2847563">.</span><span class="ident" id="2847564">Kind</span><span class="op" id="2847568">(</span><span class="op" id="2847569">)</span>&nbsp;<span class="op" id="2847571">==</span>&nbsp;<span class="ident" id="2847574">Interface</span>&nbsp;<span class="op" id="2847584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2847588">v</span>&nbsp;<span class="op" id="2847590">:=</span>&nbsp;<span class="op" id="2847593">(</span><span class="op" id="2847594">*</span><span class="ident" id="2847595">interfaceType</span><span class="op" id="2847608">)</span><span class="op" id="2847609">(</span><span class="ident" id="2847610">unsafe</span><span class="op" id="2847616">.</span><span class="ident" id="2847617">Pointer</span><span class="op" id="2847624">(</span><span class="ident" id="2847625">V</span><span class="op" id="2847626">)</span><span class="op" id="2847627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2847631">i</span>&nbsp;<span class="op" id="2847633">:=</span>&nbsp;<span class="num" id="2847636">0</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2847640">for</span>&nbsp;<span class="ident" id="2847644">j</span>&nbsp;<span class="op" id="2847646">:=</span>&nbsp;<span class="num" id="2847649">0</span><span class="op" id="2847650">;</span>&nbsp;<span class="ident" id="2847652">j</span>&nbsp;<span class="op" id="2847654">&lt;</span>&nbsp;<span class="builtinfunc" id="2847656">len</span><span class="op" id="2847659">(</span><span class="ident" id="2847660">v</span><span class="op" id="2847661">.</span><span class="ident" id="2847662">methods</span><span class="op" id="2847669">)</span><span class="op" id="2847670">;</span>&nbsp;<span class="ident" id="2847672">j</span><span class="op" id="2847673">++</span>&nbsp;<span class="op" id="2847676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2847681">tm</span>&nbsp;<span class="op" id="2847684">:=</span>&nbsp;<span class="op" id="2847687">&amp;</span><span class="ident" id="2847688">t</span><span class="op" id="2847689">.</span><span class="ident" id="2847690">methods</span><span class="op" id="2847697">[</span><span class="ident" id="2847698">i</span><span class="op" id="2847699">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2847704">vm</span>&nbsp;<span class="op" id="2847707">:=</span>&nbsp;<span class="op" id="2847710">&amp;</span><span class="ident" id="2847711">v</span><span class="op" id="2847712">.</span><span class="ident" id="2847713">methods</span><span class="op" id="2847720">[</span><span class="ident" id="2847721">j</span><span class="op" id="2847722">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2847727">if</span>&nbsp;<span class="ident" id="2847730">vm</span><span class="op" id="2847732">.</span><span class="ident" id="2847733">name</span>&nbsp;<span class="op" id="2847738">==</span>&nbsp;<span class="ident" id="2847741">tm</span><span class="op" id="2847743">.</span><span class="ident" id="2847744">name</span>&nbsp;<span class="op" id="2847749">&amp;&amp;</span>&nbsp;<span class="ident" id="2847752">vm</span><span class="op" id="2847754">.</span><span class="ident" id="2847755">pkgPath</span>&nbsp;<span class="op" id="2847763">==</span>&nbsp;<span class="ident" id="2847766">tm</span><span class="op" id="2847768">.</span><span class="ident" id="2847769">pkgPath</span>&nbsp;<span class="op" id="2847777">&amp;&amp;</span>&nbsp;<span class="ident" id="2847780">vm</span><span class="op" id="2847782">.</span><span class="ident" id="2847783">typ</span>&nbsp;<span class="op" id="2847787">==</span>&nbsp;<span class="ident" id="2847790">tm</span><span class="op" id="2847792">.</span><span class="ident" id="2847793">typ</span>&nbsp;<span class="op" id="2847797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2847803">if</span>&nbsp;<span class="ident" id="2847806">i</span><span class="op" id="2847807">++</span><span class="op" id="2847809">;</span>&nbsp;<span class="ident" id="2847811">i</span>&nbsp;<span class="op" id="2847813">&gt;=</span>&nbsp;<span class="builtinfunc" id="2847816">len</span><span class="op" id="2847819">(</span><span class="ident" id="2847820">t</span><span class="op" id="2847821">.</span><span class="ident" id="2847822">methods</span><span class="op" id="2847829">)</span>&nbsp;<span class="op" id="2847831">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2847838">return</span>&nbsp;<span class="builtintype" id="2847845">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2847854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2847859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2847863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2847867">return</span>&nbsp;<span class="builtintype" id="2847874">false</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2847881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2847885">v</span>&nbsp;<span class="op" id="2847887">:=</span>&nbsp;<span class="ident" id="2847890">V</span><span class="op" id="2847891">.</span><span class="ident" id="2847892">uncommon</span><span class="op" id="2847900">(</span><span class="op" id="2847901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2847904">if</span>&nbsp;<span class="ident" id="2847907">v</span>&nbsp;<span class="op" id="2847909">==</span>&nbsp;<span class="builtintype" id="2847912">nil</span>&nbsp;<span class="op" id="2847916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2847920">return</span>&nbsp;<span class="builtintype" id="2847927">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2847934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2847937">i</span>&nbsp;<span class="op" id="2847939">:=</span>&nbsp;<span class="num" id="2847942">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2847945">for</span>&nbsp;<span class="ident" id="2847949">j</span>&nbsp;<span class="op" id="2847951">:=</span>&nbsp;<span class="num" id="2847954">0</span><span class="op" id="2847955">;</span>&nbsp;<span class="ident" id="2847957">j</span>&nbsp;<span class="op" id="2847959">&lt;</span>&nbsp;<span class="builtinfunc" id="2847961">len</span><span class="op" id="2847964">(</span><span class="ident" id="2847965">v</span><span class="op" id="2847966">.</span><span class="ident" id="2847967">methods</span><span class="op" id="2847974">)</span><span class="op" id="2847975">;</span>&nbsp;<span class="ident" id="2847977">j</span><span class="op" id="2847978">++</span>&nbsp;<span class="op" id="2847981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2847985">tm</span>&nbsp;<span class="op" id="2847988">:=</span>&nbsp;<span class="op" id="2847991">&amp;</span><span class="ident" id="2847992">t</span><span class="op" id="2847993">.</span><span class="ident" id="2847994">methods</span><span class="op" id="2848001">[</span><span class="ident" id="2848002">i</span><span class="op" id="2848003">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2848007">vm</span>&nbsp;<span class="op" id="2848010">:=</span>&nbsp;<span class="op" id="2848013">&amp;</span><span class="ident" id="2848014">v</span><span class="op" id="2848015">.</span><span class="ident" id="2848016">methods</span><span class="op" id="2848023">[</span><span class="ident" id="2848024">j</span><span class="op" id="2848025">]</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2848029">if</span>&nbsp;<span class="ident" id="2848032">vm</span><span class="op" id="2848034">.</span><span class="ident" id="2848035">name</span>&nbsp;<span class="op" id="2848040">==</span>&nbsp;<span class="ident" id="2848043">tm</span><span class="op" id="2848045">.</span><span class="ident" id="2848046">name</span>&nbsp;<span class="op" id="2848051">&amp;&amp;</span>&nbsp;<span class="ident" id="2848054">vm</span><span class="op" id="2848056">.</span><span class="ident" id="2848057">pkgPath</span>&nbsp;<span class="op" id="2848065">==</span>&nbsp;<span class="ident" id="2848068">tm</span><span class="op" id="2848070">.</span><span class="ident" id="2848071">pkgPath</span>&nbsp;<span class="op" id="2848079">&amp;&amp;</span>&nbsp;<span class="ident" id="2848082">vm</span><span class="op" id="2848084">.</span><span class="ident" id="2848085">mtyp</span>&nbsp;<span class="op" id="2848090">==</span>&nbsp;<span class="ident" id="2848093">tm</span><span class="op" id="2848095">.</span><span class="ident" id="2848096">typ</span>&nbsp;<span class="op" id="2848100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2848105">if</span>&nbsp;<span class="ident" id="2848108">i</span><span class="op" id="2848109">++</span><span class="op" id="2848111">;</span>&nbsp;<span class="ident" id="2848113">i</span>&nbsp;<span class="op" id="2848115">&gt;=</span>&nbsp;<span class="builtinfunc" id="2848118">len</span><span class="op" id="2848121">(</span><span class="ident" id="2848122">t</span><span class="op" id="2848123">.</span><span class="ident" id="2848124">methods</span><span class="op" id="2848131">)</span>&nbsp;<span class="op" id="2848133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2848139">return</span>&nbsp;<span class="builtintype" id="2848146">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2848154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2848158">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2848161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2848164">return</span>&nbsp;<span class="builtintype" id="2848171">false</span><br>
<span class="lineno"></span><span class="op" id="2848177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2848180">//&nbsp;directlyAssignable&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;x&nbsp;of&nbsp;type&nbsp;V&nbsp;can&nbsp;be&nbsp;directly</span><br>
<span class="lineno">1170</span><span class="comment" id="2848254">//&nbsp;assigned&nbsp;(using&nbsp;memmove)&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="comment" id="2848304">//&nbsp;http://golang.org/doc/go_spec.html#Assignability</span><br>
<span class="lineno"></span><span class="comment" id="2848356">//&nbsp;Ignoring&nbsp;the&nbsp;interface&nbsp;rules&nbsp;(implemented&nbsp;elsewhere)</span><br>
<span class="lineno"></span><span class="comment" id="2848412">//&nbsp;and&nbsp;the&nbsp;ideal&nbsp;constant&nbsp;rules&nbsp;(no&nbsp;ideal&nbsp;constants&nbsp;at&nbsp;run&nbsp;time).</span><br>
<span class="lineno"></span><span class="keyword" id="2848478">func</span>&nbsp;<span class="ident" id="2848483">directlyAssignable</span><span class="op" id="2848501">(</span><span class="ident" id="2848502">T</span><span class="op" id="2848503">,</span>&nbsp;<span class="ident" id="2848505">V</span>&nbsp;<span class="op" id="2848507">*</span><span class="ident" id="2848508">rtype</span><span class="op" id="2848513">)</span>&nbsp;<span class="builtintype" id="2848515">bool</span>&nbsp;<span class="op" id="2848520">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2848523">//&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;is&nbsp;identical&nbsp;to&nbsp;T?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2848557">if</span>&nbsp;<span class="ident" id="2848560">T</span>&nbsp;<span class="op" id="2848562">==</span>&nbsp;<span class="ident" id="2848565">V</span>&nbsp;<span class="op" id="2848567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2848571">return</span>&nbsp;<span class="builtintype" id="2848578">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2848584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2848588">//&nbsp;Otherwise&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;be&nbsp;unnamed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2848642">//&nbsp;and&nbsp;they&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2848680">if</span>&nbsp;<span class="ident" id="2848683">T</span><span class="op" id="2848684">.</span><span class="ident" id="2848685">Name</span><span class="op" id="2848689">(</span><span class="op" id="2848690">)</span>&nbsp;<span class="op" id="2848692">!=</span>&nbsp;<span class="string" id="2848695">&#34;&#34;</span>&nbsp;<span class="op" id="2848698">&amp;&amp;</span>&nbsp;<span class="ident" id="2848701">V</span><span class="op" id="2848702">.</span><span class="ident" id="2848703">Name</span><span class="op" id="2848707">(</span><span class="op" id="2848708">)</span>&nbsp;<span class="op" id="2848710">!=</span>&nbsp;<span class="string" id="2848713">&#34;&#34;</span>&nbsp;<span class="op" id="2848716">||</span>&nbsp;<span class="ident" id="2848719">T</span><span class="op" id="2848720">.</span><span class="ident" id="2848721">Kind</span><span class="op" id="2848725">(</span><span class="op" id="2848726">)</span>&nbsp;<span class="op" id="2848728">!=</span>&nbsp;<span class="ident" id="2848731">V</span><span class="op" id="2848732">.</span><span class="ident" id="2848733">Kind</span><span class="op" id="2848737">(</span><span class="op" id="2848738">)</span>&nbsp;<span class="op" id="2848740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2848744">return</span>&nbsp;<span class="builtintype" id="2848751">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2848758">}</span><br>
<span class="lineno">1185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2848762">//&nbsp;x&#39;s&nbsp;type&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;&nbsp;have&nbsp;identical&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2848822">return</span>&nbsp;<span class="ident" id="2848829">haveIdenticalUnderlyingType</span><span class="op" id="2848856">(</span><span class="ident" id="2848857">T</span><span class="op" id="2848858">,</span>&nbsp;<span class="ident" id="2848860">V</span><span class="op" id="2848861">)</span><br>
<span class="lineno"></span><span class="op" id="2848863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1190</span><span class="keyword" id="2848866">func</span>&nbsp;<span class="ident" id="2848871">haveIdenticalUnderlyingType</span><span class="op" id="2848898">(</span><span class="ident" id="2848899">T</span><span class="op" id="2848900">,</span>&nbsp;<span class="ident" id="2848902">V</span>&nbsp;<span class="op" id="2848904">*</span><span class="ident" id="2848905">rtype</span><span class="op" id="2848910">)</span>&nbsp;<span class="builtintype" id="2848912">bool</span>&nbsp;<span class="op" id="2848917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2848920">if</span>&nbsp;<span class="ident" id="2848923">T</span>&nbsp;<span class="op" id="2848925">==</span>&nbsp;<span class="ident" id="2848928">V</span>&nbsp;<span class="op" id="2848930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2848934">return</span>&nbsp;<span class="builtintype" id="2848941">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2848947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2848951">kind</span>&nbsp;<span class="op" id="2848956">:=</span>&nbsp;<span class="ident" id="2848959">T</span><span class="op" id="2848960">.</span><span class="ident" id="2848961">Kind</span><span class="op" id="2848965">(</span><span class="op" id="2848966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2848969">if</span>&nbsp;<span class="ident" id="2848972">kind</span>&nbsp;<span class="op" id="2848977">!=</span>&nbsp;<span class="ident" id="2848980">V</span><span class="op" id="2848981">.</span><span class="ident" id="2848982">Kind</span><span class="op" id="2848986">(</span><span class="op" id="2848987">)</span>&nbsp;<span class="op" id="2848989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2848993">return</span>&nbsp;<span class="builtintype" id="2849000">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2849007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2849011">//&nbsp;Non-composite&nbsp;types&nbsp;of&nbsp;equal&nbsp;kind&nbsp;have&nbsp;same&nbsp;underlying&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2849075">//&nbsp;(the&nbsp;predefined&nbsp;instance&nbsp;of&nbsp;the&nbsp;type).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849118">if</span>&nbsp;<span class="ident" id="2849121">Bool</span>&nbsp;<span class="op" id="2849126">&lt;=</span>&nbsp;<span class="ident" id="2849129">kind</span>&nbsp;<span class="op" id="2849134">&amp;&amp;</span>&nbsp;<span class="ident" id="2849137">kind</span>&nbsp;<span class="op" id="2849142">&lt;=</span>&nbsp;<span class="ident" id="2849145">Complex128</span>&nbsp;<span class="op" id="2849156">||</span>&nbsp;<span class="ident" id="2849159">kind</span>&nbsp;<span class="op" id="2849164">==</span>&nbsp;<span class="ident" id="2849167">String</span>&nbsp;<span class="op" id="2849174">||</span>&nbsp;<span class="ident" id="2849177">kind</span>&nbsp;<span class="op" id="2849182">==</span>&nbsp;<span class="ident" id="2849185">UnsafePointer</span>&nbsp;<span class="op" id="2849199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849203">return</span>&nbsp;<span class="builtintype" id="2849210">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2849216">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2849220">//&nbsp;Composite&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849241">switch</span>&nbsp;<span class="ident" id="2849248">kind</span>&nbsp;<span class="op" id="2849253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849256">case</span>&nbsp;<span class="ident" id="2849261">Array</span><span class="op" id="2849266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849270">return</span>&nbsp;<span class="ident" id="2849277">T</span><span class="op" id="2849278">.</span><span class="ident" id="2849279">Elem</span><span class="op" id="2849283">(</span><span class="op" id="2849284">)</span>&nbsp;<span class="op" id="2849286">==</span>&nbsp;<span class="ident" id="2849289">V</span><span class="op" id="2849290">.</span><span class="ident" id="2849291">Elem</span><span class="op" id="2849295">(</span><span class="op" id="2849296">)</span>&nbsp;<span class="op" id="2849298">&amp;&amp;</span>&nbsp;<span class="ident" id="2849301">T</span><span class="op" id="2849302">.</span><span class="ident" id="2849303">Len</span><span class="op" id="2849306">(</span><span class="op" id="2849307">)</span>&nbsp;<span class="op" id="2849309">==</span>&nbsp;<span class="ident" id="2849312">V</span><span class="op" id="2849313">.</span><span class="ident" id="2849314">Len</span><span class="op" id="2849317">(</span><span class="op" id="2849318">)</span><br>
<span class="lineno">1210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849322">case</span>&nbsp;<span class="ident" id="2849327">Chan</span><span class="op" id="2849331">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2849335">//&nbsp;Special&nbsp;case:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2849354">//&nbsp;x&nbsp;is&nbsp;a&nbsp;bidirectional&nbsp;channel&nbsp;value,&nbsp;T&nbsp;is&nbsp;a&nbsp;channel&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2849416">//&nbsp;and&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;and&nbsp;T&nbsp;have&nbsp;identical&nbsp;element&nbsp;types.</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849472">if</span>&nbsp;<span class="ident" id="2849475">V</span><span class="op" id="2849476">.</span><span class="ident" id="2849477">ChanDir</span><span class="op" id="2849484">(</span><span class="op" id="2849485">)</span>&nbsp;<span class="op" id="2849487">==</span>&nbsp;<span class="ident" id="2849490">BothDir</span>&nbsp;<span class="op" id="2849498">&amp;&amp;</span>&nbsp;<span class="ident" id="2849501">T</span><span class="op" id="2849502">.</span><span class="ident" id="2849503">Elem</span><span class="op" id="2849507">(</span><span class="op" id="2849508">)</span>&nbsp;<span class="op" id="2849510">==</span>&nbsp;<span class="ident" id="2849513">V</span><span class="op" id="2849514">.</span><span class="ident" id="2849515">Elem</span><span class="op" id="2849519">(</span><span class="op" id="2849520">)</span>&nbsp;<span class="op" id="2849522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849527">return</span>&nbsp;<span class="builtintype" id="2849534">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2849541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2849546">//&nbsp;Otherwise&nbsp;continue&nbsp;test&nbsp;for&nbsp;identical&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849606">return</span>&nbsp;<span class="ident" id="2849613">V</span><span class="op" id="2849614">.</span><span class="ident" id="2849615">ChanDir</span><span class="op" id="2849622">(</span><span class="op" id="2849623">)</span>&nbsp;<span class="op" id="2849625">==</span>&nbsp;<span class="ident" id="2849628">T</span><span class="op" id="2849629">.</span><span class="ident" id="2849630">ChanDir</span><span class="op" id="2849637">(</span><span class="op" id="2849638">)</span>&nbsp;<span class="op" id="2849640">&amp;&amp;</span>&nbsp;<span class="ident" id="2849643">T</span><span class="op" id="2849644">.</span><span class="ident" id="2849645">Elem</span><span class="op" id="2849649">(</span><span class="op" id="2849650">)</span>&nbsp;<span class="op" id="2849652">==</span>&nbsp;<span class="ident" id="2849655">V</span><span class="op" id="2849656">.</span><span class="ident" id="2849657">Elem</span><span class="op" id="2849661">(</span><span class="op" id="2849662">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849666">case</span>&nbsp;<span class="ident" id="2849671">Func</span><span class="op" id="2849675">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2849679">t</span>&nbsp;<span class="op" id="2849681">:=</span>&nbsp;<span class="op" id="2849684">(</span><span class="op" id="2849685">*</span><span class="ident" id="2849686">funcType</span><span class="op" id="2849694">)</span><span class="op" id="2849695">(</span><span class="ident" id="2849696">unsafe</span><span class="op" id="2849702">.</span><span class="ident" id="2849703">Pointer</span><span class="op" id="2849710">(</span><span class="ident" id="2849711">T</span><span class="op" id="2849712">)</span><span class="op" id="2849713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2849717">v</span>&nbsp;<span class="op" id="2849719">:=</span>&nbsp;<span class="op" id="2849722">(</span><span class="op" id="2849723">*</span><span class="ident" id="2849724">funcType</span><span class="op" id="2849732">)</span><span class="op" id="2849733">(</span><span class="ident" id="2849734">unsafe</span><span class="op" id="2849740">.</span><span class="ident" id="2849741">Pointer</span><span class="op" id="2849748">(</span><span class="ident" id="2849749">V</span><span class="op" id="2849750">)</span><span class="op" id="2849751">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849755">if</span>&nbsp;<span class="ident" id="2849758">t</span><span class="op" id="2849759">.</span><span class="ident" id="2849760">dotdotdot</span>&nbsp;<span class="op" id="2849770">!=</span>&nbsp;<span class="ident" id="2849773">v</span><span class="op" id="2849774">.</span><span class="ident" id="2849775">dotdotdot</span>&nbsp;<span class="op" id="2849785">||</span>&nbsp;<span class="builtinfunc" id="2849788">len</span><span class="op" id="2849791">(</span><span class="ident" id="2849792">t</span><span class="op" id="2849793">.</span><span class="ident" id="2849794">in</span><span class="op" id="2849796">)</span>&nbsp;<span class="op" id="2849798">!=</span>&nbsp;<span class="builtinfunc" id="2849801">len</span><span class="op" id="2849804">(</span><span class="ident" id="2849805">v</span><span class="op" id="2849806">.</span><span class="ident" id="2849807">in</span><span class="op" id="2849809">)</span>&nbsp;<span class="op" id="2849811">||</span>&nbsp;<span class="builtinfunc" id="2849814">len</span><span class="op" id="2849817">(</span><span class="ident" id="2849818">t</span><span class="op" id="2849819">.</span><span class="ident" id="2849820">out</span><span class="op" id="2849823">)</span>&nbsp;<span class="op" id="2849825">!=</span>&nbsp;<span class="builtinfunc" id="2849828">len</span><span class="op" id="2849831">(</span><span class="ident" id="2849832">v</span><span class="op" id="2849833">.</span><span class="ident" id="2849834">out</span><span class="op" id="2849837">)</span>&nbsp;<span class="op" id="2849839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849844">return</span>&nbsp;<span class="builtintype" id="2849851">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2849859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849863">for</span>&nbsp;<span class="ident" id="2849867">i</span><span class="op" id="2849868">,</span>&nbsp;<span class="ident" id="2849870">typ</span>&nbsp;<span class="op" id="2849874">:=</span>&nbsp;<span class="keyword" id="2849877">range</span>&nbsp;<span class="ident" id="2849883">t</span><span class="op" id="2849884">.</span><span class="ident" id="2849885">in</span>&nbsp;<span class="op" id="2849888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849893">if</span>&nbsp;<span class="ident" id="2849896">typ</span>&nbsp;<span class="op" id="2849900">!=</span>&nbsp;<span class="ident" id="2849903">v</span><span class="op" id="2849904">.</span><span class="ident" id="2849905">in</span><span class="op" id="2849907">[</span><span class="ident" id="2849908">i</span><span class="op" id="2849909">]</span>&nbsp;<span class="op" id="2849911">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849917">return</span>&nbsp;<span class="builtintype" id="2849924">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2849933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2849937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849941">for</span>&nbsp;<span class="ident" id="2849945">i</span><span class="op" id="2849946">,</span>&nbsp;<span class="ident" id="2849948">typ</span>&nbsp;<span class="op" id="2849952">:=</span>&nbsp;<span class="keyword" id="2849955">range</span>&nbsp;<span class="ident" id="2849961">t</span><span class="op" id="2849962">.</span><span class="ident" id="2849963">out</span>&nbsp;<span class="op" id="2849967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849972">if</span>&nbsp;<span class="ident" id="2849975">typ</span>&nbsp;<span class="op" id="2849979">!=</span>&nbsp;<span class="ident" id="2849982">v</span><span class="op" id="2849983">.</span><span class="ident" id="2849984">out</span><span class="op" id="2849987">[</span><span class="ident" id="2849988">i</span><span class="op" id="2849989">]</span>&nbsp;<span class="op" id="2849991">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2849997">return</span>&nbsp;<span class="builtintype" id="2850004">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2850013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2850017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850021">return</span>&nbsp;<span class="builtintype" id="2850028">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850035">case</span>&nbsp;<span class="ident" id="2850040">Interface</span><span class="op" id="2850049">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2850053">t</span>&nbsp;<span class="op" id="2850055">:=</span>&nbsp;<span class="op" id="2850058">(</span><span class="op" id="2850059">*</span><span class="ident" id="2850060">interfaceType</span><span class="op" id="2850073">)</span><span class="op" id="2850074">(</span><span class="ident" id="2850075">unsafe</span><span class="op" id="2850081">.</span><span class="ident" id="2850082">Pointer</span><span class="op" id="2850089">(</span><span class="ident" id="2850090">T</span><span class="op" id="2850091">)</span><span class="op" id="2850092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2850096">v</span>&nbsp;<span class="op" id="2850098">:=</span>&nbsp;<span class="op" id="2850101">(</span><span class="op" id="2850102">*</span><span class="ident" id="2850103">interfaceType</span><span class="op" id="2850116">)</span><span class="op" id="2850117">(</span><span class="ident" id="2850118">unsafe</span><span class="op" id="2850124">.</span><span class="ident" id="2850125">Pointer</span><span class="op" id="2850132">(</span><span class="ident" id="2850133">V</span><span class="op" id="2850134">)</span><span class="op" id="2850135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850139">if</span>&nbsp;<span class="builtinfunc" id="2850142">len</span><span class="op" id="2850145">(</span><span class="ident" id="2850146">t</span><span class="op" id="2850147">.</span><span class="ident" id="2850148">methods</span><span class="op" id="2850155">)</span>&nbsp;<span class="op" id="2850157">==</span>&nbsp;<span class="num" id="2850160">0</span>&nbsp;<span class="op" id="2850162">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2850165">len</span><span class="op" id="2850168">(</span><span class="ident" id="2850169">v</span><span class="op" id="2850170">.</span><span class="ident" id="2850171">methods</span><span class="op" id="2850178">)</span>&nbsp;<span class="op" id="2850180">==</span>&nbsp;<span class="num" id="2850183">0</span>&nbsp;<span class="op" id="2850185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850190">return</span>&nbsp;<span class="builtintype" id="2850197">true</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2850204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2850208">//&nbsp;Might&nbsp;have&nbsp;the&nbsp;same&nbsp;methods&nbsp;but&nbsp;still</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2850251">//&nbsp;need&nbsp;a&nbsp;run&nbsp;time&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850284">return</span>&nbsp;<span class="builtintype" id="2850291">false</span><br>
<span class="lineno"></span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850299">case</span>&nbsp;<span class="ident" id="2850304">Map</span><span class="op" id="2850307">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850311">return</span>&nbsp;<span class="ident" id="2850318">T</span><span class="op" id="2850319">.</span><span class="ident" id="2850320">Key</span><span class="op" id="2850323">(</span><span class="op" id="2850324">)</span>&nbsp;<span class="op" id="2850326">==</span>&nbsp;<span class="ident" id="2850329">V</span><span class="op" id="2850330">.</span><span class="ident" id="2850331">Key</span><span class="op" id="2850334">(</span><span class="op" id="2850335">)</span>&nbsp;<span class="op" id="2850337">&amp;&amp;</span>&nbsp;<span class="ident" id="2850340">T</span><span class="op" id="2850341">.</span><span class="ident" id="2850342">Elem</span><span class="op" id="2850346">(</span><span class="op" id="2850347">)</span>&nbsp;<span class="op" id="2850349">==</span>&nbsp;<span class="ident" id="2850352">V</span><span class="op" id="2850353">.</span><span class="ident" id="2850354">Elem</span><span class="op" id="2850358">(</span><span class="op" id="2850359">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850363">case</span>&nbsp;<span class="ident" id="2850368">Ptr</span><span class="op" id="2850371">,</span>&nbsp;<span class="ident" id="2850373">Slice</span><span class="op" id="2850378">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850382">return</span>&nbsp;<span class="ident" id="2850389">T</span><span class="op" id="2850390">.</span><span class="ident" id="2850391">Elem</span><span class="op" id="2850395">(</span><span class="op" id="2850396">)</span>&nbsp;<span class="op" id="2850398">==</span>&nbsp;<span class="ident" id="2850401">V</span><span class="op" id="2850402">.</span><span class="ident" id="2850403">Elem</span><span class="op" id="2850407">(</span><span class="op" id="2850408">)</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850412">case</span>&nbsp;<span class="ident" id="2850417">Struct</span><span class="op" id="2850423">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2850427">t</span>&nbsp;<span class="op" id="2850429">:=</span>&nbsp;<span class="op" id="2850432">(</span><span class="op" id="2850433">*</span><span class="ident" id="2850434">structType</span><span class="op" id="2850444">)</span><span class="op" id="2850445">(</span><span class="ident" id="2850446">unsafe</span><span class="op" id="2850452">.</span><span class="ident" id="2850453">Pointer</span><span class="op" id="2850460">(</span><span class="ident" id="2850461">T</span><span class="op" id="2850462">)</span><span class="op" id="2850463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2850467">v</span>&nbsp;<span class="op" id="2850469">:=</span>&nbsp;<span class="op" id="2850472">(</span><span class="op" id="2850473">*</span><span class="ident" id="2850474">structType</span><span class="op" id="2850484">)</span><span class="op" id="2850485">(</span><span class="ident" id="2850486">unsafe</span><span class="op" id="2850492">.</span><span class="ident" id="2850493">Pointer</span><span class="op" id="2850500">(</span><span class="ident" id="2850501">V</span><span class="op" id="2850502">)</span><span class="op" id="2850503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850507">if</span>&nbsp;<span class="builtinfunc" id="2850510">len</span><span class="op" id="2850513">(</span><span class="ident" id="2850514">t</span><span class="op" id="2850515">.</span><span class="ident" id="2850516">fields</span><span class="op" id="2850522">)</span>&nbsp;<span class="op" id="2850524">!=</span>&nbsp;<span class="builtinfunc" id="2850527">len</span><span class="op" id="2850530">(</span><span class="ident" id="2850531">v</span><span class="op" id="2850532">.</span><span class="ident" id="2850533">fields</span><span class="op" id="2850539">)</span>&nbsp;<span class="op" id="2850541">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850546">return</span>&nbsp;<span class="builtintype" id="2850553">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2850561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850565">for</span>&nbsp;<span class="ident" id="2850569">i</span>&nbsp;<span class="op" id="2850571">:=</span>&nbsp;<span class="keyword" id="2850574">range</span>&nbsp;<span class="ident" id="2850580">t</span><span class="op" id="2850581">.</span><span class="ident" id="2850582">fields</span>&nbsp;<span class="op" id="2850589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2850594">tf</span>&nbsp;<span class="op" id="2850597">:=</span>&nbsp;<span class="op" id="2850600">&amp;</span><span class="ident" id="2850601">t</span><span class="op" id="2850602">.</span><span class="ident" id="2850603">fields</span><span class="op" id="2850609">[</span><span class="ident" id="2850610">i</span><span class="op" id="2850611">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2850616">vf</span>&nbsp;<span class="op" id="2850619">:=</span>&nbsp;<span class="op" id="2850622">&amp;</span><span class="ident" id="2850623">v</span><span class="op" id="2850624">.</span><span class="ident" id="2850625">fields</span><span class="op" id="2850631">[</span><span class="ident" id="2850632">i</span><span class="op" id="2850633">]</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850638">if</span>&nbsp;<span class="ident" id="2850641">tf</span><span class="op" id="2850643">.</span><span class="ident" id="2850644">name</span>&nbsp;<span class="op" id="2850649">!=</span>&nbsp;<span class="ident" id="2850652">vf</span><span class="op" id="2850654">.</span><span class="ident" id="2850655">name</span>&nbsp;<span class="op" id="2850660">&amp;&amp;</span>&nbsp;<span class="op" id="2850663">(</span><span class="ident" id="2850664">tf</span><span class="op" id="2850666">.</span><span class="ident" id="2850667">name</span>&nbsp;<span class="op" id="2850672">==</span>&nbsp;<span class="builtintype" id="2850675">nil</span>&nbsp;<span class="op" id="2850679">||</span>&nbsp;<span class="ident" id="2850682">vf</span><span class="op" id="2850684">.</span><span class="ident" id="2850685">name</span>&nbsp;<span class="op" id="2850690">==</span>&nbsp;<span class="builtintype" id="2850693">nil</span>&nbsp;<span class="op" id="2850697">||</span>&nbsp;<span class="op" id="2850700">*</span><span class="ident" id="2850701">tf</span><span class="op" id="2850703">.</span><span class="ident" id="2850704">name</span>&nbsp;<span class="op" id="2850709">!=</span>&nbsp;<span class="op" id="2850712">*</span><span class="ident" id="2850713">vf</span><span class="op" id="2850715">.</span><span class="ident" id="2850716">name</span><span class="op" id="2850720">)</span>&nbsp;<span class="op" id="2850722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850728">return</span>&nbsp;<span class="builtintype" id="2850735">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2850744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850749">if</span>&nbsp;<span class="ident" id="2850752">tf</span><span class="op" id="2850754">.</span><span class="ident" id="2850755">pkgPath</span>&nbsp;<span class="op" id="2850763">!=</span>&nbsp;<span class="ident" id="2850766">vf</span><span class="op" id="2850768">.</span><span class="ident" id="2850769">pkgPath</span>&nbsp;<span class="op" id="2850777">&amp;&amp;</span>&nbsp;<span class="op" id="2850780">(</span><span class="ident" id="2850781">tf</span><span class="op" id="2850783">.</span><span class="ident" id="2850784">pkgPath</span>&nbsp;<span class="op" id="2850792">==</span>&nbsp;<span class="builtintype" id="2850795">nil</span>&nbsp;<span class="op" id="2850799">||</span>&nbsp;<span class="ident" id="2850802">vf</span><span class="op" id="2850804">.</span><span class="ident" id="2850805">pkgPath</span>&nbsp;<span class="op" id="2850813">==</span>&nbsp;<span class="builtintype" id="2850816">nil</span>&nbsp;<span class="op" id="2850820">||</span>&nbsp;<span class="op" id="2850823">*</span><span class="ident" id="2850824">tf</span><span class="op" id="2850826">.</span><span class="ident" id="2850827">pkgPath</span>&nbsp;<span class="op" id="2850835">!=</span>&nbsp;<span class="op" id="2850838">*</span><span class="ident" id="2850839">vf</span><span class="op" id="2850841">.</span><span class="ident" id="2850842">pkgPath</span><span class="op" id="2850849">)</span>&nbsp;<span class="op" id="2850851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850857">return</span>&nbsp;<span class="builtintype" id="2850864">false</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2850873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850878">if</span>&nbsp;<span class="ident" id="2850881">tf</span><span class="op" id="2850883">.</span><span class="ident" id="2850884">typ</span>&nbsp;<span class="op" id="2850888">!=</span>&nbsp;<span class="ident" id="2850891">vf</span><span class="op" id="2850893">.</span><span class="ident" id="2850894">typ</span>&nbsp;<span class="op" id="2850898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850904">return</span>&nbsp;<span class="builtintype" id="2850911">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2850920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2850925">if</span>&nbsp;<span class="ident" id="2850928">tf</span><span class="op" id="2850930">.</span><span class="ident" id="2850931">tag</span>&nbsp;<span class="op" id="2850935">!=</span>&nbsp;<span class="ident" id="2850938">vf</span><span class="op" id="2850940">.</span><span class="ident" id="2850941">tag</span>&nbsp;<span class="op" id="2850945">&amp;&amp;</span>&nbsp;<span class="op" id="2850948">(</span><span class="ident" id="2850949">tf</span><span class="op" id="2850951">.</span><span class="ident" id="2850952">tag</span>&nbsp;<span class="op" id="2850956">==</span>&nbsp;<span class="builtintype" id="2850959">nil</span>&nbsp;<span class="op" id="2850963">||</span>&nbsp;<span class="ident" id="2850966">vf</span><span class="op" id="2850968">.</span><span class="ident" id="2850969">tag</span>&nbsp;<span class="op" id="2850973">==</span>&nbsp;<span class="builtintype" id="2850976">nil</span>&nbsp;<span class="op" id="2850980">||</span>&nbsp;<span class="op" id="2850983">*</span><span class="ident" id="2850984">tf</span><span class="op" id="2850986">.</span><span class="ident" id="2850987">tag</span>&nbsp;<span class="op" id="2850991">!=</span>&nbsp;<span class="op" id="2850994">*</span><span class="ident" id="2850995">vf</span><span class="op" id="2850997">.</span><span class="ident" id="2850998">tag</span><span class="op" id="2851001">)</span>&nbsp;<span class="op" id="2851003">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2851009">return</span>&nbsp;<span class="builtintype" id="2851016">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2851025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2851030">if</span>&nbsp;<span class="ident" id="2851033">tf</span><span class="op" id="2851035">.</span><span class="ident" id="2851036">offset</span>&nbsp;<span class="op" id="2851043">!=</span>&nbsp;<span class="ident" id="2851046">vf</span><span class="op" id="2851048">.</span><span class="ident" id="2851049">offset</span>&nbsp;<span class="op" id="2851056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2851062">return</span>&nbsp;<span class="builtintype" id="2851069">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2851078">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2851082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2851086">return</span>&nbsp;<span class="builtintype" id="2851093">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2851099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2851103">return</span>&nbsp;<span class="builtintype" id="2851110">false</span><br>
<span class="lineno">1285</span><span class="op" id="2851116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2851119">//&nbsp;typelinks&nbsp;is&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="comment" id="2851167">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;the&nbsp;&#39;typelink&#39;&nbsp;information&nbsp;in&nbsp;the&nbsp;binary,</span><br>
<span class="lineno"></span><span class="comment" id="2851238">//&nbsp;which&nbsp;is&nbsp;to&nbsp;say&nbsp;a&nbsp;slice&nbsp;of&nbsp;known&nbsp;types,&nbsp;sorted&nbsp;by&nbsp;string.</span><br>
<span class="lineno">1290</span><span class="comment" id="2851299">//&nbsp;Note&nbsp;that&nbsp;strings&nbsp;are&nbsp;not&nbsp;unique&nbsp;identifiers&nbsp;for&nbsp;types:</span><br>
<span class="lineno"></span><span class="comment" id="2851358">//&nbsp;there&nbsp;can&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;with&nbsp;a&nbsp;given&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2851409">//&nbsp;Only&nbsp;types&nbsp;we&nbsp;might&nbsp;want&nbsp;to&nbsp;look&nbsp;up&nbsp;are&nbsp;included:</span><br>
<span class="lineno"></span><span class="comment" id="2851462">//&nbsp;channels,&nbsp;maps,&nbsp;slices,&nbsp;and&nbsp;arrays.</span><br>
<span class="lineno"></span><span class="keyword" id="2851501">func</span>&nbsp;<span class="ident" id="2851506">typelinks</span><span class="op" id="2851515">(</span><span class="op" id="2851516">)</span>&nbsp;<span class="op" id="2851518">[</span><span class="op" id="2851519">]</span><span class="op" id="2851520">*</span><span class="ident" id="2851521">rtype</span><br>
<span class="lineno">1295</span><br>
<span class="lineno"></span><span class="comment" id="2851528">//&nbsp;typesByString&nbsp;returns&nbsp;the&nbsp;subslice&nbsp;of&nbsp;typelinks()&nbsp;whose&nbsp;elements&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2851601">//&nbsp;the&nbsp;given&nbsp;string&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="2851637">//&nbsp;It&nbsp;may&nbsp;be&nbsp;empty&nbsp;(no&nbsp;known&nbsp;types&nbsp;with&nbsp;that&nbsp;string)&nbsp;or&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2851702">//&nbsp;multiple&nbsp;elements&nbsp;(multiple&nbsp;types&nbsp;with&nbsp;that&nbsp;string).</span><br>
<span class="lineno">1300</span><span class="keyword" id="2851758">func</span>&nbsp;<span class="ident" id="2851763">typesByString</span><span class="op" id="2851776">(</span><span class="ident" id="2851777">s</span>&nbsp;<span class="builtintype" id="2851779">string</span><span class="op" id="2851785">)</span>&nbsp;<span class="op" id="2851787">[</span><span class="op" id="2851788">]</span><span class="op" id="2851789">*</span><span class="ident" id="2851790">rtype</span>&nbsp;<span class="op" id="2851796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2851799">typ</span>&nbsp;<span class="op" id="2851803">:=</span>&nbsp;<span class="ident" id="2851806">typelinks</span><span class="op" id="2851815">(</span><span class="op" id="2851816">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2851820">//&nbsp;We&nbsp;are&nbsp;looking&nbsp;for&nbsp;the&nbsp;first&nbsp;index&nbsp;i&nbsp;where&nbsp;the&nbsp;string&nbsp;becomes&nbsp;&gt;=&nbsp;s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2851892">//&nbsp;This&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;sort.Search,&nbsp;with&nbsp;f(h)&nbsp;replaced&nbsp;by&nbsp;(*typ[h].string&nbsp;&gt;=&nbsp;s).</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2851972">i</span><span class="op" id="2851973">,</span>&nbsp;<span class="ident" id="2851975">j</span>&nbsp;<span class="op" id="2851977">:=</span>&nbsp;<span class="num" id="2851980">0</span><span class="op" id="2851981">,</span>&nbsp;<span class="builtinfunc" id="2851983">len</span><span class="op" id="2851986">(</span><span class="ident" id="2851987">typ</span><span class="op" id="2851990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2851993">for</span>&nbsp;<span class="ident" id="2851997">i</span>&nbsp;<span class="op" id="2851999">&lt;</span>&nbsp;<span class="ident" id="2852001">j</span>&nbsp;<span class="op" id="2852003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2852007">h</span>&nbsp;<span class="op" id="2852009">:=</span>&nbsp;<span class="ident" id="2852012">i</span>&nbsp;<span class="op" id="2852014">+</span>&nbsp;<span class="op" id="2852016">(</span><span class="ident" id="2852017">j</span><span class="op" id="2852018">-</span><span class="ident" id="2852019">i</span><span class="op" id="2852020">)</span><span class="op" id="2852021">/</span><span class="num" id="2852022">2</span>&nbsp;<span class="comment" id="2852024">//&nbsp;avoid&nbsp;overflow&nbsp;when&nbsp;computing&nbsp;h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2852061">//&nbsp;i&nbsp;≤&nbsp;h&nbsp;&lt;&nbsp;j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2852078">if</span>&nbsp;<span class="op" id="2852081">!</span><span class="op" id="2852082">(</span><span class="op" id="2852083">*</span><span class="ident" id="2852084">typ</span><span class="op" id="2852087">[</span><span class="ident" id="2852088">h</span><span class="op" id="2852089">]</span><span class="op" id="2852090">.</span><span class="builtintype" id="2852091">string</span>&nbsp;<span class="op" id="2852098">&gt;=</span>&nbsp;<span class="ident" id="2852101">s</span><span class="op" id="2852102">)</span>&nbsp;<span class="op" id="2852104">{</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2852109">i</span>&nbsp;<span class="op" id="2852111">=</span>&nbsp;<span class="ident" id="2852113">h</span>&nbsp;<span class="op" id="2852115">+</span>&nbsp;<span class="num" id="2852117">1</span>&nbsp;<span class="comment" id="2852119">//&nbsp;preserves&nbsp;f(i-1)&nbsp;==&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2852150">}</span>&nbsp;<span class="keyword" id="2852152">else</span>&nbsp;<span class="op" id="2852157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2852162">j</span>&nbsp;<span class="op" id="2852164">=</span>&nbsp;<span class="ident" id="2852166">h</span>&nbsp;<span class="comment" id="2852168">//&nbsp;preserves&nbsp;f(j)&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2852196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2852199">}</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2852202">//&nbsp;i&nbsp;==&nbsp;j,&nbsp;f(i-1)&nbsp;==&nbsp;false,&nbsp;and&nbsp;f(j)&nbsp;(=&nbsp;f(i))&nbsp;==&nbsp;true&nbsp;&nbsp;=&gt;&nbsp;&nbsp;answer&nbsp;is&nbsp;i.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2852276">//&nbsp;Having&nbsp;found&nbsp;the&nbsp;first,&nbsp;linear&nbsp;scan&nbsp;forward&nbsp;to&nbsp;find&nbsp;the&nbsp;last.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2852342">//&nbsp;We&nbsp;could&nbsp;do&nbsp;a&nbsp;second&nbsp;binary&nbsp;search,&nbsp;but&nbsp;the&nbsp;caller&nbsp;is&nbsp;going</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2852406">//&nbsp;to&nbsp;do&nbsp;a&nbsp;linear&nbsp;scan&nbsp;anyway.</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2852438">j</span>&nbsp;<span class="op" id="2852440">=</span>&nbsp;<span class="ident" id="2852442">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2852445">for</span>&nbsp;<span class="ident" id="2852449">j</span>&nbsp;<span class="op" id="2852451">&lt;</span>&nbsp;<span class="builtinfunc" id="2852453">len</span><span class="op" id="2852456">(</span><span class="ident" id="2852457">typ</span><span class="op" id="2852460">)</span>&nbsp;<span class="op" id="2852462">&amp;&amp;</span>&nbsp;<span class="op" id="2852465">*</span><span class="ident" id="2852466">typ</span><span class="op" id="2852469">[</span><span class="ident" id="2852470">j</span><span class="op" id="2852471">]</span><span class="op" id="2852472">.</span><span class="builtintype" id="2852473">string</span>&nbsp;<span class="op" id="2852480">==</span>&nbsp;<span class="ident" id="2852483">s</span>&nbsp;<span class="op" id="2852485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2852489">j</span><span class="op" id="2852490">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2852494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2852498">//&nbsp;This&nbsp;slice&nbsp;will&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;string&nbsp;is&nbsp;not&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2852555">return</span>&nbsp;<span class="ident" id="2852562">typ</span><span class="op" id="2852565">[</span><span class="ident" id="2852566">i</span><span class="op" id="2852567">:</span><span class="ident" id="2852568">j</span><span class="op" id="2852569">]</span><br>
<span class="lineno"></span><span class="op" id="2852571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2852574">//&nbsp;The&nbsp;lookupCache&nbsp;caches&nbsp;ChanOf,&nbsp;MapOf,&nbsp;and&nbsp;SliceOf&nbsp;lookups.</span><br>
<span class="lineno">1330</span><span class="keyword" id="2852636">var</span>&nbsp;<span class="ident" id="2852640">lookupCache</span>&nbsp;<span class="keyword" id="2852652">struct</span>&nbsp;<span class="op" id="2852659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2852662">sync</span><span class="op" id="2852666">.</span><span class="ident" id="2852667">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2852676">m</span>&nbsp;<span class="keyword" id="2852678">map</span><span class="op" id="2852681">[</span><span class="ident" id="2852682">cacheKey</span><span class="op" id="2852690">]</span><span class="op" id="2852691">*</span><span class="ident" id="2852692">rtype</span><br>
<span class="lineno"></span><span class="op" id="2852698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="comment" id="2852701">//&nbsp;A&nbsp;cacheKey&nbsp;is&nbsp;the&nbsp;key&nbsp;for&nbsp;use&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2852754">//&nbsp;Four&nbsp;values&nbsp;describe&nbsp;any&nbsp;of&nbsp;the&nbsp;types&nbsp;we&nbsp;are&nbsp;looking&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="2852815">//&nbsp;type&nbsp;kind,&nbsp;one&nbsp;or&nbsp;two&nbsp;subtypes,&nbsp;and&nbsp;an&nbsp;extra&nbsp;integer.</span><br>
<span class="lineno"></span><span class="keyword" id="2852872">type</span>&nbsp;<span class="ident" id="2852877">cacheKey</span>&nbsp;<span class="keyword" id="2852886">struct</span>&nbsp;<span class="op" id="2852893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2852896">kind</span>&nbsp;&nbsp;<span class="ident" id="2852902">Kind</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2852908">t1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2852914">*</span><span class="ident" id="2852915">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2852922">t2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2852928">*</span><span class="ident" id="2852929">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2852936">extra</span>&nbsp;<span class="builtintype" id="2852942">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2852950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1345</span><span class="comment" id="2852953">//&nbsp;cacheGet&nbsp;looks&nbsp;for&nbsp;a&nbsp;type&nbsp;under&nbsp;the&nbsp;key&nbsp;k&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2853018">//&nbsp;If&nbsp;it&nbsp;finds&nbsp;one,&nbsp;it&nbsp;returns&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2853060">//&nbsp;If&nbsp;not,&nbsp;it&nbsp;returns&nbsp;nil&nbsp;with&nbsp;the&nbsp;cache&nbsp;locked.</span><br>
<span class="lineno"></span><span class="comment" id="2853109">//&nbsp;The&nbsp;caller&nbsp;is&nbsp;expected&nbsp;to&nbsp;use&nbsp;cachePut&nbsp;to&nbsp;unlock&nbsp;the&nbsp;cache.</span><br>
<span class="lineno"></span><span class="keyword" id="2853172">func</span>&nbsp;<span class="ident" id="2853177">cacheGet</span><span class="op" id="2853185">(</span><span class="ident" id="2853186">k</span>&nbsp;<span class="ident" id="2853188">cacheKey</span><span class="op" id="2853196">)</span>&nbsp;<span class="ident" id="2853198">Type</span>&nbsp;<span class="op" id="2853203">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2853206">lookupCache</span><span class="op" id="2853217">.</span><span class="ident" id="2853218">RLock</span><span class="op" id="2853223">(</span><span class="op" id="2853224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2853227">t</span>&nbsp;<span class="op" id="2853229">:=</span>&nbsp;<span class="ident" id="2853232">lookupCache</span><span class="op" id="2853243">.</span><span class="ident" id="2853244">m</span><span class="op" id="2853245">[</span><span class="ident" id="2853246">k</span><span class="op" id="2853247">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2853250">lookupCache</span><span class="op" id="2853261">.</span><span class="ident" id="2853262">RUnlock</span><span class="op" id="2853269">(</span><span class="op" id="2853270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2853273">if</span>&nbsp;<span class="ident" id="2853276">t</span>&nbsp;<span class="op" id="2853278">!=</span>&nbsp;<span class="builtintype" id="2853281">nil</span>&nbsp;<span class="op" id="2853285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2853289">return</span>&nbsp;<span class="ident" id="2853296">t</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2853299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2853303">lookupCache</span><span class="op" id="2853314">.</span><span class="ident" id="2853315">Lock</span><span class="op" id="2853319">(</span><span class="op" id="2853320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2853323">t</span>&nbsp;<span class="op" id="2853325">=</span>&nbsp;<span class="ident" id="2853327">lookupCache</span><span class="op" id="2853338">.</span><span class="ident" id="2853339">m</span><span class="op" id="2853340">[</span><span class="ident" id="2853341">k</span><span class="op" id="2853342">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2853345">if</span>&nbsp;<span class="ident" id="2853348">t</span>&nbsp;<span class="op" id="2853350">!=</span>&nbsp;<span class="builtintype" id="2853353">nil</span>&nbsp;<span class="op" id="2853357">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2853361">lookupCache</span><span class="op" id="2853372">.</span><span class="ident" id="2853373">Unlock</span><span class="op" id="2853379">(</span><span class="op" id="2853380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2853384">return</span>&nbsp;<span class="ident" id="2853391">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2853394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2853398">if</span>&nbsp;<span class="ident" id="2853401">lookupCache</span><span class="op" id="2853412">.</span><span class="ident" id="2853413">m</span>&nbsp;<span class="op" id="2853415">==</span>&nbsp;<span class="builtintype" id="2853418">nil</span>&nbsp;<span class="op" id="2853422">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2853426">lookupCache</span><span class="op" id="2853437">.</span><span class="ident" id="2853438">m</span>&nbsp;<span class="op" id="2853440">=</span>&nbsp;<span class="builtinfunc" id="2853442">make</span><span class="op" id="2853446">(</span><span class="keyword" id="2853447">map</span><span class="op" id="2853450">[</span><span class="ident" id="2853451">cacheKey</span><span class="op" id="2853459">]</span><span class="op" id="2853460">*</span><span class="ident" id="2853461">rtype</span><span class="op" id="2853466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2853469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2853473">return</span>&nbsp;<span class="builtintype" id="2853480">nil</span><br>
<span class="lineno"></span><span class="op" id="2853484">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="2853487">//&nbsp;cachePut&nbsp;stores&nbsp;the&nbsp;given&nbsp;type&nbsp;in&nbsp;the&nbsp;cache,&nbsp;unlocks&nbsp;the&nbsp;cache,</span><br>
<span class="lineno"></span><span class="comment" id="2853554">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;type.&nbsp;It&nbsp;is&nbsp;expected&nbsp;that&nbsp;the&nbsp;cache&nbsp;is&nbsp;locked</span><br>
<span class="lineno"></span><span class="comment" id="2853619">//&nbsp;because&nbsp;cacheGet&nbsp;returned&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2853653">func</span>&nbsp;<span class="ident" id="2853658">cachePut</span><span class="op" id="2853666">(</span><span class="ident" id="2853667">k</span>&nbsp;<span class="ident" id="2853669">cacheKey</span><span class="op" id="2853677">,</span>&nbsp;<span class="ident" id="2853679">t</span>&nbsp;<span class="op" id="2853681">*</span><span class="ident" id="2853682">rtype</span><span class="op" id="2853687">)</span>&nbsp;<span class="ident" id="2853689">Type</span>&nbsp;<span class="op" id="2853694">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2853697">lookupCache</span><span class="op" id="2853708">.</span><span class="ident" id="2853709">m</span><span class="op" id="2853710">[</span><span class="ident" id="2853711">k</span><span class="op" id="2853712">]</span>&nbsp;<span class="op" id="2853714">=</span>&nbsp;<span class="ident" id="2853716">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2853719">lookupCache</span><span class="op" id="2853730">.</span><span class="ident" id="2853731">Unlock</span><span class="op" id="2853737">(</span><span class="op" id="2853738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2853741">return</span>&nbsp;<span class="ident" id="2853748">t</span><br>
<span class="lineno"></span><span class="op" id="2853750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span><span class="comment" id="2853753">//&nbsp;ChanOf&nbsp;returns&nbsp;the&nbsp;channel&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;direction&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2853831">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ChanOf(RecvDir,&nbsp;t)&nbsp;represents&nbsp;&lt;-chan&nbsp;int.</span><br>
<span class="lineno"></span><span class="comment" id="2853910">//</span><br>
<span class="lineno"></span><span class="comment" id="2853913">//&nbsp;The&nbsp;gc&nbsp;runtime&nbsp;imposes&nbsp;a&nbsp;limit&nbsp;of&nbsp;64&nbsp;kB&nbsp;on&nbsp;channel&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2853982">//&nbsp;If&nbsp;t&#39;s&nbsp;size&nbsp;is&nbsp;equal&nbsp;to&nbsp;or&nbsp;exceeds&nbsp;this&nbsp;limit,&nbsp;ChanOf&nbsp;panics.</span><br>
<span class="lineno">1385</span><span class="keyword" id="2854047">func</span>&nbsp;<span class="ident" id="2854052">ChanOf</span><span class="op" id="2854058">(</span><span class="ident" id="2854059">dir</span>&nbsp;<span class="ident" id="2854063">ChanDir</span><span class="op" id="2854070">,</span>&nbsp;<span class="ident" id="2854072">t</span>&nbsp;<span class="ident" id="2854074">Type</span><span class="op" id="2854078">)</span>&nbsp;<span class="ident" id="2854080">Type</span>&nbsp;<span class="op" id="2854085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2854088">typ</span>&nbsp;<span class="op" id="2854092">:=</span>&nbsp;<span class="ident" id="2854095">t</span><span class="op" id="2854096">.</span><span class="op" id="2854097">(</span><span class="op" id="2854098">*</span><span class="ident" id="2854099">rtype</span><span class="op" id="2854104">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2854108">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2854127">ckey</span>&nbsp;<span class="op" id="2854132">:=</span>&nbsp;<span class="ident" id="2854135">cacheKey</span><span class="op" id="2854143">{</span><span class="ident" id="2854144">Chan</span><span class="op" id="2854148">,</span>&nbsp;<span class="ident" id="2854150">typ</span><span class="op" id="2854153">,</span>&nbsp;<span class="builtintype" id="2854155">nil</span><span class="op" id="2854158">,</span>&nbsp;<span class="builtintype" id="2854160">uintptr</span><span class="op" id="2854167">(</span><span class="ident" id="2854168">dir</span><span class="op" id="2854171">)</span><span class="op" id="2854172">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2854175">if</span>&nbsp;<span class="ident" id="2854178">ch</span>&nbsp;<span class="op" id="2854181">:=</span>&nbsp;<span class="ident" id="2854184">cacheGet</span><span class="op" id="2854192">(</span><span class="ident" id="2854193">ckey</span><span class="op" id="2854197">)</span><span class="op" id="2854198">;</span>&nbsp;<span class="ident" id="2854200">ch</span>&nbsp;<span class="op" id="2854203">!=</span>&nbsp;<span class="builtintype" id="2854206">nil</span>&nbsp;<span class="op" id="2854210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2854214">return</span>&nbsp;<span class="ident" id="2854221">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2854225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2854229">//&nbsp;This&nbsp;restriction&nbsp;is&nbsp;imposed&nbsp;by&nbsp;the&nbsp;gc&nbsp;compiler&nbsp;and&nbsp;the&nbsp;runtime.</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2854297">if</span>&nbsp;<span class="ident" id="2854300">typ</span><span class="op" id="2854303">.</span><span class="ident" id="2854304">size</span>&nbsp;<span class="op" id="2854309">&gt;=</span>&nbsp;<span class="num" id="2854312">1</span><span class="op" id="2854313">&lt;&lt;</span><span class="num" id="2854315">16</span>&nbsp;<span class="op" id="2854318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2854322">lookupCache</span><span class="op" id="2854333">.</span><span class="ident" id="2854334">Unlock</span><span class="op" id="2854340">(</span><span class="op" id="2854341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2854345">panic</span><span class="op" id="2854350">(</span><span class="string" id="2854351">&#34;reflect.ChanOf:&nbsp;element&nbsp;size&nbsp;too&nbsp;large&#34;</span><span class="op" id="2854391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2854394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2854398">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2854423">//&nbsp;TODO:&nbsp;Precedence&nbsp;when&nbsp;constructing&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2854470">var</span>&nbsp;<span class="ident" id="2854474">s</span>&nbsp;<span class="builtintype" id="2854476">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2854484">switch</span>&nbsp;<span class="ident" id="2854491">dir</span>&nbsp;<span class="op" id="2854495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2854498">default</span><span class="op" id="2854505">:</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2854509">lookupCache</span><span class="op" id="2854520">.</span><span class="ident" id="2854521">Unlock</span><span class="op" id="2854527">(</span><span class="op" id="2854528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2854532">panic</span><span class="op" id="2854537">(</span><span class="string" id="2854538">&#34;reflect.ChanOf:&nbsp;invalid&nbsp;dir&#34;</span><span class="op" id="2854567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2854570">case</span>&nbsp;<span class="ident" id="2854575">SendDir</span><span class="op" id="2854582">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2854586">s</span>&nbsp;<span class="op" id="2854588">=</span>&nbsp;<span class="string" id="2854590">&#34;chan&lt;-&nbsp;&#34;</span>&nbsp;<span class="op" id="2854600">+</span>&nbsp;<span class="op" id="2854602">*</span><span class="ident" id="2854603">typ</span><span class="op" id="2854606">.</span><span class="builtintype" id="2854607">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2854615">case</span>&nbsp;<span class="ident" id="2854620">RecvDir</span><span class="op" id="2854627">:</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2854631">s</span>&nbsp;<span class="op" id="2854633">=</span>&nbsp;<span class="string" id="2854635">&#34;&lt;-chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2854645">+</span>&nbsp;<span class="op" id="2854647">*</span><span class="ident" id="2854648">typ</span><span class="op" id="2854651">.</span><span class="builtintype" id="2854652">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2854660">case</span>&nbsp;<span class="ident" id="2854665">BothDir</span><span class="op" id="2854672">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2854676">s</span>&nbsp;<span class="op" id="2854678">=</span>&nbsp;<span class="string" id="2854680">&#34;chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2854688">+</span>&nbsp;<span class="op" id="2854690">*</span><span class="ident" id="2854691">typ</span><span class="op" id="2854694">.</span><span class="builtintype" id="2854695">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2854703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2854706">for</span>&nbsp;<span class="ident" id="2854710">_</span><span class="op" id="2854711">,</span>&nbsp;<span class="ident" id="2854713">tt</span>&nbsp;<span class="op" id="2854716">:=</span>&nbsp;<span class="keyword" id="2854719">range</span>&nbsp;<span class="ident" id="2854725">typesByString</span><span class="op" id="2854738">(</span><span class="ident" id="2854739">s</span><span class="op" id="2854740">)</span>&nbsp;<span class="op" id="2854742">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2854746">ch</span>&nbsp;<span class="op" id="2854749">:=</span>&nbsp;<span class="op" id="2854752">(</span><span class="op" id="2854753">*</span><span class="ident" id="2854754">chanType</span><span class="op" id="2854762">)</span><span class="op" id="2854763">(</span><span class="ident" id="2854764">unsafe</span><span class="op" id="2854770">.</span><span class="ident" id="2854771">Pointer</span><span class="op" id="2854778">(</span><span class="ident" id="2854779">tt</span><span class="op" id="2854781">)</span><span class="op" id="2854782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2854786">if</span>&nbsp;<span class="ident" id="2854789">ch</span><span class="op" id="2854791">.</span><span class="ident" id="2854792">elem</span>&nbsp;<span class="op" id="2854797">==</span>&nbsp;<span class="ident" id="2854800">typ</span>&nbsp;<span class="op" id="2854804">&amp;&amp;</span>&nbsp;<span class="ident" id="2854807">ch</span><span class="op" id="2854809">.</span><span class="ident" id="2854810">dir</span>&nbsp;<span class="op" id="2854814">==</span>&nbsp;<span class="builtintype" id="2854817">uintptr</span><span class="op" id="2854824">(</span><span class="ident" id="2854825">dir</span><span class="op" id="2854828">)</span>&nbsp;<span class="op" id="2854830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2854835">return</span>&nbsp;<span class="ident" id="2854842">cachePut</span><span class="op" id="2854850">(</span><span class="ident" id="2854851">ckey</span><span class="op" id="2854855">,</span>&nbsp;<span class="ident" id="2854857">tt</span><span class="op" id="2854859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2854863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2854866">}</span><br>
<span class="lineno">1420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2854870">//&nbsp;Make&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2854895">var</span>&nbsp;<span class="ident" id="2854899">ichan</span>&nbsp;<span class="keyword" id="2854905">interface</span><span class="op" id="2854914">{</span><span class="op" id="2854915">}</span>&nbsp;<span class="op" id="2854917">=</span>&nbsp;<span class="op" id="2854919">(</span><span class="keyword" id="2854920">chan</span>&nbsp;<span class="ident" id="2854925">unsafe</span><span class="op" id="2854931">.</span><span class="ident" id="2854932">Pointer</span><span class="op" id="2854939">)</span><span class="op" id="2854940">(</span><span class="builtintype" id="2854941">nil</span><span class="op" id="2854944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2854947">prototype</span>&nbsp;<span class="op" id="2854957">:=</span>&nbsp;<span class="op" id="2854960">*</span><span class="op" id="2854961">(</span><span class="op" id="2854962">*</span><span class="op" id="2854963">*</span><span class="ident" id="2854964">chanType</span><span class="op" id="2854972">)</span><span class="op" id="2854973">(</span><span class="ident" id="2854974">unsafe</span><span class="op" id="2854980">.</span><span class="ident" id="2854981">Pointer</span><span class="op" id="2854988">(</span><span class="op" id="2854989">&amp;</span><span class="ident" id="2854990">ichan</span><span class="op" id="2854995">)</span><span class="op" id="2854996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2854999">ch</span>&nbsp;<span class="op" id="2855002">:=</span>&nbsp;<span class="builtinfunc" id="2855005">new</span><span class="op" id="2855008">(</span><span class="ident" id="2855009">chanType</span><span class="op" id="2855017">)</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2855020">*</span><span class="ident" id="2855021">ch</span>&nbsp;<span class="op" id="2855024">=</span>&nbsp;<span class="op" id="2855026">*</span><span class="ident" id="2855027">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2855038">ch</span><span class="op" id="2855040">.</span><span class="builtintype" id="2855041">string</span>&nbsp;<span class="op" id="2855048">=</span>&nbsp;<span class="op" id="2855050">&amp;</span><span class="ident" id="2855051">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2855054">ch</span><span class="op" id="2855056">.</span><span class="ident" id="2855057">hash</span>&nbsp;<span class="op" id="2855062">=</span>&nbsp;<span class="ident" id="2855064">fnv1</span><span class="op" id="2855068">(</span><span class="ident" id="2855069">typ</span><span class="op" id="2855072">.</span><span class="ident" id="2855073">hash</span><span class="op" id="2855077">,</span>&nbsp;<span class="string" id="2855079">&#39;c&#39;</span><span class="op" id="2855082">,</span>&nbsp;<span class="builtintype" id="2855084">byte</span><span class="op" id="2855088">(</span><span class="ident" id="2855089">dir</span><span class="op" id="2855092">)</span><span class="op" id="2855093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2855096">ch</span><span class="op" id="2855098">.</span><span class="ident" id="2855099">elem</span>&nbsp;<span class="op" id="2855104">=</span>&nbsp;<span class="ident" id="2855106">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2855111">ch</span><span class="op" id="2855113">.</span><span class="ident" id="2855114">uncommonType</span>&nbsp;<span class="op" id="2855127">=</span>&nbsp;<span class="builtintype" id="2855129">nil</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2855134">ch</span><span class="op" id="2855136">.</span><span class="ident" id="2855137">ptrToThis</span>&nbsp;<span class="op" id="2855147">=</span>&nbsp;<span class="builtintype" id="2855149">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2855154">ch</span><span class="op" id="2855156">.</span><span class="ident" id="2855157">zero</span>&nbsp;<span class="op" id="2855162">=</span>&nbsp;<span class="ident" id="2855164">unsafe</span><span class="op" id="2855170">.</span><span class="ident" id="2855171">Pointer</span><span class="op" id="2855178">(</span><span class="op" id="2855179">&amp;</span><span class="builtinfunc" id="2855180">make</span><span class="op" id="2855184">(</span><span class="op" id="2855185">[</span><span class="op" id="2855186">]</span><span class="builtintype" id="2855187">byte</span><span class="op" id="2855191">,</span>&nbsp;<span class="ident" id="2855193">ch</span><span class="op" id="2855195">.</span><span class="ident" id="2855196">size</span><span class="op" id="2855200">)</span><span class="op" id="2855201">[</span><span class="num" id="2855202">0</span><span class="op" id="2855203">]</span><span class="op" id="2855204">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2855208">return</span>&nbsp;<span class="ident" id="2855215">cachePut</span><span class="op" id="2855223">(</span><span class="ident" id="2855224">ckey</span><span class="op" id="2855228">,</span>&nbsp;<span class="op" id="2855230">&amp;</span><span class="ident" id="2855231">ch</span><span class="op" id="2855233">.</span><span class="ident" id="2855234">rtype</span><span class="op" id="2855239">)</span><br>
<span class="lineno"></span><span class="op" id="2855241">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="keyword" id="2855244">func</span>&nbsp;<span class="ident" id="2855249">ismapkey</span><span class="op" id="2855257">(</span><span class="op" id="2855258">*</span><span class="ident" id="2855259">rtype</span><span class="op" id="2855264">)</span>&nbsp;<span class="builtintype" id="2855266">bool</span>&nbsp;<span class="comment" id="2855271">//&nbsp;implemented&nbsp;in&nbsp;runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2855298">//&nbsp;MapOf&nbsp;returns&nbsp;the&nbsp;map&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;key&nbsp;and&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2855366">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;k&nbsp;represents&nbsp;int&nbsp;and&nbsp;e&nbsp;represents&nbsp;string,</span><br>
<span class="lineno">1440</span><span class="comment" id="2855427">//&nbsp;MapOf(k,&nbsp;e)&nbsp;represents&nbsp;map[int]string.</span><br>
<span class="lineno"></span><span class="comment" id="2855469">//</span><br>
<span class="lineno"></span><span class="comment" id="2855472">//&nbsp;If&nbsp;the&nbsp;key&nbsp;type&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;map&nbsp;key&nbsp;type&nbsp;(that&nbsp;is,&nbsp;if&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2855540">//&nbsp;not&nbsp;implement&nbsp;Go&#39;s&nbsp;==&nbsp;operator),&nbsp;MapOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="keyword" id="2855590">func</span>&nbsp;<span class="ident" id="2855595">MapOf</span><span class="op" id="2855600">(</span><span class="ident" id="2855601">key</span><span class="op" id="2855604">,</span>&nbsp;<span class="ident" id="2855606">elem</span>&nbsp;<span class="ident" id="2855611">Type</span><span class="op" id="2855615">)</span>&nbsp;<span class="ident" id="2855617">Type</span>&nbsp;<span class="op" id="2855622">{</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2855625">ktyp</span>&nbsp;<span class="op" id="2855630">:=</span>&nbsp;<span class="ident" id="2855633">key</span><span class="op" id="2855636">.</span><span class="op" id="2855637">(</span><span class="op" id="2855638">*</span><span class="ident" id="2855639">rtype</span><span class="op" id="2855644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2855647">etyp</span>&nbsp;<span class="op" id="2855652">:=</span>&nbsp;<span class="ident" id="2855655">elem</span><span class="op" id="2855659">.</span><span class="op" id="2855660">(</span><span class="op" id="2855661">*</span><span class="ident" id="2855662">rtype</span><span class="op" id="2855667">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2855671">if</span>&nbsp;<span class="op" id="2855674">!</span><span class="ident" id="2855675">ismapkey</span><span class="op" id="2855683">(</span><span class="ident" id="2855684">ktyp</span><span class="op" id="2855688">)</span>&nbsp;<span class="op" id="2855690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2855694">panic</span><span class="op" id="2855699">(</span><span class="string" id="2855700">&#34;reflect.MapOf:&nbsp;invalid&nbsp;key&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="2855735">+</span>&nbsp;<span class="ident" id="2855737">ktyp</span><span class="op" id="2855741">.</span><span class="ident" id="2855742">String</span><span class="op" id="2855748">(</span><span class="op" id="2855749">)</span><span class="op" id="2855750">)</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2855753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2855757">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2855776">ckey</span>&nbsp;<span class="op" id="2855781">:=</span>&nbsp;<span class="ident" id="2855784">cacheKey</span><span class="op" id="2855792">{</span><span class="ident" id="2855793">Map</span><span class="op" id="2855796">,</span>&nbsp;<span class="ident" id="2855798">ktyp</span><span class="op" id="2855802">,</span>&nbsp;<span class="ident" id="2855804">etyp</span><span class="op" id="2855808">,</span>&nbsp;<span class="num" id="2855810">0</span><span class="op" id="2855811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2855814">if</span>&nbsp;<span class="ident" id="2855817">mt</span>&nbsp;<span class="op" id="2855820">:=</span>&nbsp;<span class="ident" id="2855823">cacheGet</span><span class="op" id="2855831">(</span><span class="ident" id="2855832">ckey</span><span class="op" id="2855836">)</span><span class="op" id="2855837">;</span>&nbsp;<span class="ident" id="2855839">mt</span>&nbsp;<span class="op" id="2855842">!=</span>&nbsp;<span class="builtintype" id="2855845">nil</span>&nbsp;<span class="op" id="2855849">{</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2855853">return</span>&nbsp;<span class="ident" id="2855860">mt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2855864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2855868">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2855893">s</span>&nbsp;<span class="op" id="2855895">:=</span>&nbsp;<span class="string" id="2855898">&#34;map[&#34;</span>&nbsp;<span class="op" id="2855905">+</span>&nbsp;<span class="op" id="2855907">*</span><span class="ident" id="2855908">ktyp</span><span class="op" id="2855912">.</span><span class="builtintype" id="2855913">string</span>&nbsp;<span class="op" id="2855920">+</span>&nbsp;<span class="string" id="2855922">&#34;]&#34;</span>&nbsp;<span class="op" id="2855926">+</span>&nbsp;<span class="op" id="2855928">*</span><span class="ident" id="2855929">etyp</span><span class="op" id="2855933">.</span><span class="builtintype" id="2855934">string</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2855942">for</span>&nbsp;<span class="ident" id="2855946">_</span><span class="op" id="2855947">,</span>&nbsp;<span class="ident" id="2855949">tt</span>&nbsp;<span class="op" id="2855952">:=</span>&nbsp;<span class="keyword" id="2855955">range</span>&nbsp;<span class="ident" id="2855961">typesByString</span><span class="op" id="2855974">(</span><span class="ident" id="2855975">s</span><span class="op" id="2855976">)</span>&nbsp;<span class="op" id="2855978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2855982">mt</span>&nbsp;<span class="op" id="2855985">:=</span>&nbsp;<span class="op" id="2855988">(</span><span class="op" id="2855989">*</span><span class="ident" id="2855990">mapType</span><span class="op" id="2855997">)</span><span class="op" id="2855998">(</span><span class="ident" id="2855999">unsafe</span><span class="op" id="2856005">.</span><span class="ident" id="2856006">Pointer</span><span class="op" id="2856013">(</span><span class="ident" id="2856014">tt</span><span class="op" id="2856016">)</span><span class="op" id="2856017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2856021">if</span>&nbsp;<span class="ident" id="2856024">mt</span><span class="op" id="2856026">.</span><span class="ident" id="2856027">key</span>&nbsp;<span class="op" id="2856031">==</span>&nbsp;<span class="ident" id="2856034">ktyp</span>&nbsp;<span class="op" id="2856039">&amp;&amp;</span>&nbsp;<span class="ident" id="2856042">mt</span><span class="op" id="2856044">.</span><span class="ident" id="2856045">elem</span>&nbsp;<span class="op" id="2856050">==</span>&nbsp;<span class="ident" id="2856053">etyp</span>&nbsp;<span class="op" id="2856058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2856063">return</span>&nbsp;<span class="ident" id="2856070">cachePut</span><span class="op" id="2856078">(</span><span class="ident" id="2856079">ckey</span><span class="op" id="2856083">,</span>&nbsp;<span class="ident" id="2856085">tt</span><span class="op" id="2856087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2856091">}</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2856094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2856098">//&nbsp;Make&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2856119">var</span>&nbsp;<span class="ident" id="2856123">imap</span>&nbsp;<span class="keyword" id="2856128">interface</span><span class="op" id="2856137">{</span><span class="op" id="2856138">}</span>&nbsp;<span class="op" id="2856140">=</span>&nbsp;<span class="op" id="2856142">(</span><span class="keyword" id="2856143">map</span><span class="op" id="2856146">[</span><span class="ident" id="2856147">unsafe</span><span class="op" id="2856153">.</span><span class="ident" id="2856154">Pointer</span><span class="op" id="2856161">]</span><span class="ident" id="2856162">unsafe</span><span class="op" id="2856168">.</span><span class="ident" id="2856169">Pointer</span><span class="op" id="2856176">)</span><span class="op" id="2856177">(</span><span class="builtintype" id="2856178">nil</span><span class="op" id="2856181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856184">prototype</span>&nbsp;<span class="op" id="2856194">:=</span>&nbsp;<span class="op" id="2856197">*</span><span class="op" id="2856198">(</span><span class="op" id="2856199">*</span><span class="op" id="2856200">*</span><span class="ident" id="2856201">mapType</span><span class="op" id="2856208">)</span><span class="op" id="2856209">(</span><span class="ident" id="2856210">unsafe</span><span class="op" id="2856216">.</span><span class="ident" id="2856217">Pointer</span><span class="op" id="2856224">(</span><span class="op" id="2856225">&amp;</span><span class="ident" id="2856226">imap</span><span class="op" id="2856230">)</span><span class="op" id="2856231">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856234">mt</span>&nbsp;<span class="op" id="2856237">:=</span>&nbsp;<span class="builtinfunc" id="2856240">new</span><span class="op" id="2856243">(</span><span class="ident" id="2856244">mapType</span><span class="op" id="2856251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2856254">*</span><span class="ident" id="2856255">mt</span>&nbsp;<span class="op" id="2856258">=</span>&nbsp;<span class="op" id="2856260">*</span><span class="ident" id="2856261">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856272">mt</span><span class="op" id="2856274">.</span><span class="builtintype" id="2856275">string</span>&nbsp;<span class="op" id="2856282">=</span>&nbsp;<span class="op" id="2856284">&amp;</span><span class="ident" id="2856285">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856288">mt</span><span class="op" id="2856290">.</span><span class="ident" id="2856291">hash</span>&nbsp;<span class="op" id="2856296">=</span>&nbsp;<span class="ident" id="2856298">fnv1</span><span class="op" id="2856302">(</span><span class="ident" id="2856303">etyp</span><span class="op" id="2856307">.</span><span class="ident" id="2856308">hash</span><span class="op" id="2856312">,</span>&nbsp;<span class="string" id="2856314">&#39;m&#39;</span><span class="op" id="2856317">,</span>&nbsp;<span class="builtintype" id="2856319">byte</span><span class="op" id="2856323">(</span><span class="ident" id="2856324">ktyp</span><span class="op" id="2856328">.</span><span class="ident" id="2856329">hash</span><span class="op" id="2856333">&gt;&gt;</span><span class="num" id="2856335">24</span><span class="op" id="2856337">)</span><span class="op" id="2856338">,</span>&nbsp;<span class="builtintype" id="2856340">byte</span><span class="op" id="2856344">(</span><span class="ident" id="2856345">ktyp</span><span class="op" id="2856349">.</span><span class="ident" id="2856350">hash</span><span class="op" id="2856354">&gt;&gt;</span><span class="num" id="2856356">16</span><span class="op" id="2856358">)</span><span class="op" id="2856359">,</span>&nbsp;<span class="builtintype" id="2856361">byte</span><span class="op" id="2856365">(</span><span class="ident" id="2856366">ktyp</span><span class="op" id="2856370">.</span><span class="ident" id="2856371">hash</span><span class="op" id="2856375">&gt;&gt;</span><span class="num" id="2856377">8</span><span class="op" id="2856378">)</span><span class="op" id="2856379">,</span>&nbsp;<span class="builtintype" id="2856381">byte</span><span class="op" id="2856385">(</span><span class="ident" id="2856386">ktyp</span><span class="op" id="2856390">.</span><span class="ident" id="2856391">hash</span><span class="op" id="2856395">)</span><span class="op" id="2856396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856399">mt</span><span class="op" id="2856401">.</span><span class="ident" id="2856402">key</span>&nbsp;<span class="op" id="2856406">=</span>&nbsp;<span class="ident" id="2856408">ktyp</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856414">mt</span><span class="op" id="2856416">.</span><span class="ident" id="2856417">elem</span>&nbsp;<span class="op" id="2856422">=</span>&nbsp;<span class="ident" id="2856424">etyp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856430">mt</span><span class="op" id="2856432">.</span><span class="ident" id="2856433">bucket</span>&nbsp;<span class="op" id="2856440">=</span>&nbsp;<span class="ident" id="2856442">bucketOf</span><span class="op" id="2856450">(</span><span class="ident" id="2856451">ktyp</span><span class="op" id="2856455">,</span>&nbsp;<span class="ident" id="2856457">etyp</span><span class="op" id="2856461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2856464">if</span>&nbsp;<span class="ident" id="2856467">ktyp</span><span class="op" id="2856471">.</span><span class="ident" id="2856472">size</span>&nbsp;<span class="op" id="2856477">&gt;</span>&nbsp;<span class="ident" id="2856479">maxKeySize</span>&nbsp;<span class="op" id="2856490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856494">mt</span><span class="op" id="2856496">.</span><span class="ident" id="2856497">keysize</span>&nbsp;<span class="op" id="2856505">=</span>&nbsp;<span class="builtintype" id="2856507">uint8</span><span class="op" id="2856512">(</span><span class="ident" id="2856513">ptrSize</span><span class="op" id="2856520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856524">mt</span><span class="op" id="2856526">.</span><span class="ident" id="2856527">indirectkey</span>&nbsp;<span class="op" id="2856539">=</span>&nbsp;<span class="num" id="2856541">1</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2856544">}</span>&nbsp;<span class="keyword" id="2856546">else</span>&nbsp;<span class="op" id="2856551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856555">mt</span><span class="op" id="2856557">.</span><span class="ident" id="2856558">keysize</span>&nbsp;<span class="op" id="2856566">=</span>&nbsp;<span class="builtintype" id="2856568">uint8</span><span class="op" id="2856573">(</span><span class="ident" id="2856574">ktyp</span><span class="op" id="2856578">.</span><span class="ident" id="2856579">size</span><span class="op" id="2856583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856587">mt</span><span class="op" id="2856589">.</span><span class="ident" id="2856590">indirectkey</span>&nbsp;<span class="op" id="2856602">=</span>&nbsp;<span class="num" id="2856604">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2856607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2856610">if</span>&nbsp;<span class="ident" id="2856613">etyp</span><span class="op" id="2856617">.</span><span class="ident" id="2856618">size</span>&nbsp;<span class="op" id="2856623">&gt;</span>&nbsp;<span class="ident" id="2856625">maxValSize</span>&nbsp;<span class="op" id="2856636">{</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856640">mt</span><span class="op" id="2856642">.</span><span class="ident" id="2856643">valuesize</span>&nbsp;<span class="op" id="2856653">=</span>&nbsp;<span class="builtintype" id="2856655">uint8</span><span class="op" id="2856660">(</span><span class="ident" id="2856661">ptrSize</span><span class="op" id="2856668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856672">mt</span><span class="op" id="2856674">.</span><span class="ident" id="2856675">indirectvalue</span>&nbsp;<span class="op" id="2856689">=</span>&nbsp;<span class="num" id="2856691">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2856694">}</span>&nbsp;<span class="keyword" id="2856696">else</span>&nbsp;<span class="op" id="2856701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856705">mt</span><span class="op" id="2856707">.</span><span class="ident" id="2856708">valuesize</span>&nbsp;<span class="op" id="2856718">=</span>&nbsp;<span class="builtintype" id="2856720">uint8</span><span class="op" id="2856725">(</span><span class="ident" id="2856726">etyp</span><span class="op" id="2856730">.</span><span class="ident" id="2856731">size</span><span class="op" id="2856735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856739">mt</span><span class="op" id="2856741">.</span><span class="ident" id="2856742">indirectvalue</span>&nbsp;<span class="op" id="2856756">=</span>&nbsp;<span class="num" id="2856758">0</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2856761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856764">mt</span><span class="op" id="2856766">.</span><span class="ident" id="2856767">bucketsize</span>&nbsp;<span class="op" id="2856778">=</span>&nbsp;<span class="builtintype" id="2856780">uint16</span><span class="op" id="2856786">(</span><span class="ident" id="2856787">mt</span><span class="op" id="2856789">.</span><span class="ident" id="2856790">bucket</span><span class="op" id="2856796">.</span><span class="ident" id="2856797">size</span><span class="op" id="2856801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856804">mt</span><span class="op" id="2856806">.</span><span class="ident" id="2856807">uncommonType</span>&nbsp;<span class="op" id="2856820">=</span>&nbsp;<span class="builtintype" id="2856822">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856827">mt</span><span class="op" id="2856829">.</span><span class="ident" id="2856830">ptrToThis</span>&nbsp;<span class="op" id="2856840">=</span>&nbsp;<span class="builtintype" id="2856842">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2856847">mt</span><span class="op" id="2856849">.</span><span class="ident" id="2856850">zero</span>&nbsp;<span class="op" id="2856855">=</span>&nbsp;<span class="ident" id="2856857">unsafe</span><span class="op" id="2856863">.</span><span class="ident" id="2856864">Pointer</span><span class="op" id="2856871">(</span><span class="op" id="2856872">&amp;</span><span class="builtinfunc" id="2856873">make</span><span class="op" id="2856877">(</span><span class="op" id="2856878">[</span><span class="op" id="2856879">]</span><span class="builtintype" id="2856880">byte</span><span class="op" id="2856884">,</span>&nbsp;<span class="ident" id="2856886">mt</span><span class="op" id="2856888">.</span><span class="ident" id="2856889">size</span><span class="op" id="2856893">)</span><span class="op" id="2856894">[</span><span class="num" id="2856895">0</span><span class="op" id="2856896">]</span><span class="op" id="2856897">)</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2856901">return</span>&nbsp;<span class="ident" id="2856908">cachePut</span><span class="op" id="2856916">(</span><span class="ident" id="2856917">ckey</span><span class="op" id="2856921">,</span>&nbsp;<span class="op" id="2856923">&amp;</span><span class="ident" id="2856924">mt</span><span class="op" id="2856926">.</span><span class="ident" id="2856927">rtype</span><span class="op" id="2856932">)</span><br>
<span class="lineno"></span><span class="op" id="2856934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2856937">//&nbsp;gcProg&nbsp;is&nbsp;a&nbsp;helper&nbsp;type&nbsp;for&nbsp;generatation&nbsp;of&nbsp;GC&nbsp;pointer&nbsp;info.</span><br>
<span class="lineno">1500</span><span class="keyword" id="2857001">type</span>&nbsp;<span class="ident" id="2857006">gcProg</span>&nbsp;<span class="keyword" id="2857013">struct</span>&nbsp;<span class="op" id="2857020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857023">gc</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2857028">[</span><span class="op" id="2857029">]</span><span class="builtintype" id="2857030">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857036">size</span>&nbsp;<span class="builtintype" id="2857041">uintptr</span>&nbsp;<span class="comment" id="2857049">//&nbsp;size&nbsp;of&nbsp;type&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><span class="op" id="2857074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1505</span><span class="keyword" id="2857077">func</span>&nbsp;<span class="op" id="2857082">(</span><span class="ident" id="2857083">gc</span>&nbsp;<span class="op" id="2857086">*</span><span class="ident" id="2857087">gcProg</span><span class="op" id="2857093">)</span>&nbsp;<span class="builtinfunc" id="2857095">append</span><span class="op" id="2857101">(</span><span class="ident" id="2857102">v</span>&nbsp;<span class="builtintype" id="2857104">byte</span><span class="op" id="2857108">)</span>&nbsp;<span class="op" id="2857110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857113">gc</span><span class="op" id="2857115">.</span><span class="ident" id="2857116">align</span><span class="op" id="2857121">(</span><span class="ident" id="2857122">unsafe</span><span class="op" id="2857128">.</span><span class="ident" id="2857129">Sizeof</span><span class="op" id="2857135">(</span><span class="builtintype" id="2857136">uintptr</span><span class="op" id="2857143">(</span><span class="num" id="2857144">0</span><span class="op" id="2857145">)</span><span class="op" id="2857146">)</span><span class="op" id="2857147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857150">gc</span><span class="op" id="2857152">.</span><span class="ident" id="2857153">appendWord</span><span class="op" id="2857163">(</span><span class="ident" id="2857164">v</span><span class="op" id="2857165">)</span><br>
<span class="lineno"></span><span class="op" id="2857167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1510</span><span class="comment" id="2857170">//&nbsp;Appends&nbsp;t&#39;s&nbsp;type&nbsp;info&nbsp;to&nbsp;the&nbsp;current&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="2857219">func</span>&nbsp;<span class="op" id="2857224">(</span><span class="ident" id="2857225">gc</span>&nbsp;<span class="op" id="2857228">*</span><span class="ident" id="2857229">gcProg</span><span class="op" id="2857235">)</span>&nbsp;<span class="ident" id="2857237">appendProg</span><span class="op" id="2857247">(</span><span class="ident" id="2857248">t</span>&nbsp;<span class="op" id="2857250">*</span><span class="ident" id="2857251">rtype</span><span class="op" id="2857256">)</span>&nbsp;<span class="op" id="2857258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857261">gc</span><span class="op" id="2857263">.</span><span class="ident" id="2857264">align</span><span class="op" id="2857269">(</span><span class="builtintype" id="2857270">uintptr</span><span class="op" id="2857277">(</span><span class="ident" id="2857278">t</span><span class="op" id="2857279">.</span><span class="ident" id="2857280">align</span><span class="op" id="2857285">)</span><span class="op" id="2857286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2857289">if</span>&nbsp;<span class="op" id="2857292">!</span><span class="ident" id="2857293">t</span><span class="op" id="2857294">.</span><span class="ident" id="2857295">pointers</span><span class="op" id="2857303">(</span><span class="op" id="2857304">)</span>&nbsp;<span class="op" id="2857306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857310">gc</span><span class="op" id="2857312">.</span><span class="ident" id="2857313">size</span>&nbsp;<span class="op" id="2857318">+=</span>&nbsp;<span class="ident" id="2857321">t</span><span class="op" id="2857322">.</span><span class="ident" id="2857323">size</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2857330">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2857338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2857341">switch</span>&nbsp;<span class="ident" id="2857348">t</span><span class="op" id="2857349">.</span><span class="ident" id="2857350">Kind</span><span class="op" id="2857354">(</span><span class="op" id="2857355">)</span>&nbsp;<span class="op" id="2857357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2857360">default</span><span class="op" id="2857367">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2857371">panic</span><span class="op" id="2857376">(</span><span class="string" id="2857377">&#34;reflect:&nbsp;non-pointer&nbsp;type&nbsp;marked&nbsp;as&nbsp;having&nbsp;pointers&#34;</span><span class="op" id="2857430">)</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2857433">case</span>&nbsp;<span class="ident" id="2857438">Ptr</span><span class="op" id="2857441">,</span>&nbsp;<span class="ident" id="2857443">UnsafePointer</span><span class="op" id="2857456">,</span>&nbsp;<span class="ident" id="2857458">Chan</span><span class="op" id="2857462">,</span>&nbsp;<span class="ident" id="2857464">Func</span><span class="op" id="2857468">,</span>&nbsp;<span class="ident" id="2857470">Map</span><span class="op" id="2857473">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857477">gc</span><span class="op" id="2857479">.</span><span class="ident" id="2857480">appendWord</span><span class="op" id="2857490">(</span><span class="ident" id="2857491">bitsPointer</span><span class="op" id="2857502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2857505">case</span>&nbsp;<span class="ident" id="2857510">Slice</span><span class="op" id="2857515">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857519">gc</span><span class="op" id="2857521">.</span><span class="ident" id="2857522">appendWord</span><span class="op" id="2857532">(</span><span class="ident" id="2857533">bitsPointer</span><span class="op" id="2857544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857548">gc</span><span class="op" id="2857550">.</span><span class="ident" id="2857551">appendWord</span><span class="op" id="2857561">(</span><span class="ident" id="2857562">bitsScalar</span><span class="op" id="2857572">)</span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857576">gc</span><span class="op" id="2857578">.</span><span class="ident" id="2857579">appendWord</span><span class="op" id="2857589">(</span><span class="ident" id="2857590">bitsScalar</span><span class="op" id="2857600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2857603">case</span>&nbsp;<span class="ident" id="2857608">String</span><span class="op" id="2857614">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857618">gc</span><span class="op" id="2857620">.</span><span class="ident" id="2857621">appendWord</span><span class="op" id="2857631">(</span><span class="ident" id="2857632">bitsPointer</span><span class="op" id="2857643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857647">gc</span><span class="op" id="2857649">.</span><span class="ident" id="2857650">appendWord</span><span class="op" id="2857660">(</span><span class="ident" id="2857661">bitsScalar</span><span class="op" id="2857671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2857674">case</span>&nbsp;<span class="ident" id="2857679">Array</span><span class="op" id="2857684">:</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857688">c</span>&nbsp;<span class="op" id="2857690">:=</span>&nbsp;<span class="ident" id="2857693">t</span><span class="op" id="2857694">.</span><span class="ident" id="2857695">Len</span><span class="op" id="2857698">(</span><span class="op" id="2857699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857703">e</span>&nbsp;<span class="op" id="2857705">:=</span>&nbsp;<span class="ident" id="2857708">t</span><span class="op" id="2857709">.</span><span class="ident" id="2857710">Elem</span><span class="op" id="2857714">(</span><span class="op" id="2857715">)</span><span class="op" id="2857716">.</span><span class="ident" id="2857717">common</span><span class="op" id="2857723">(</span><span class="op" id="2857724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2857728">for</span>&nbsp;<span class="ident" id="2857732">i</span>&nbsp;<span class="op" id="2857734">:=</span>&nbsp;<span class="num" id="2857737">0</span><span class="op" id="2857738">;</span>&nbsp;<span class="ident" id="2857740">i</span>&nbsp;<span class="op" id="2857742">&lt;</span>&nbsp;<span class="ident" id="2857744">c</span><span class="op" id="2857745">;</span>&nbsp;<span class="ident" id="2857747">i</span><span class="op" id="2857748">++</span>&nbsp;<span class="op" id="2857751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857756">gc</span><span class="op" id="2857758">.</span><span class="ident" id="2857759">appendProg</span><span class="op" id="2857769">(</span><span class="ident" id="2857770">e</span><span class="op" id="2857771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2857775">}</span><br>
<span class="lineno">1535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2857778">case</span>&nbsp;<span class="ident" id="2857783">Interface</span><span class="op" id="2857792">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857796">gc</span><span class="op" id="2857798">.</span><span class="ident" id="2857799">appendWord</span><span class="op" id="2857809">(</span><span class="ident" id="2857810">bitsMultiWord</span><span class="op" id="2857823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2857827">if</span>&nbsp;<span class="ident" id="2857830">t</span><span class="op" id="2857831">.</span><span class="ident" id="2857832">NumMethod</span><span class="op" id="2857841">(</span><span class="op" id="2857842">)</span>&nbsp;<span class="op" id="2857844">==</span>&nbsp;<span class="num" id="2857847">0</span>&nbsp;<span class="op" id="2857849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857854">gc</span><span class="op" id="2857856">.</span><span class="ident" id="2857857">appendWord</span><span class="op" id="2857867">(</span><span class="ident" id="2857868">bitsEface</span><span class="op" id="2857877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2857881">}</span>&nbsp;<span class="keyword" id="2857883">else</span>&nbsp;<span class="op" id="2857888">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857893">gc</span><span class="op" id="2857895">.</span><span class="ident" id="2857896">appendWord</span><span class="op" id="2857906">(</span><span class="ident" id="2857907">bitsIface</span><span class="op" id="2857916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2857920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2857923">case</span>&nbsp;<span class="ident" id="2857928">Struct</span><span class="op" id="2857934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857938">c</span>&nbsp;<span class="op" id="2857940">:=</span>&nbsp;<span class="ident" id="2857943">t</span><span class="op" id="2857944">.</span><span class="ident" id="2857945">NumField</span><span class="op" id="2857953">(</span><span class="op" id="2857954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2857958">for</span>&nbsp;<span class="ident" id="2857962">i</span>&nbsp;<span class="op" id="2857964">:=</span>&nbsp;<span class="num" id="2857967">0</span><span class="op" id="2857968">;</span>&nbsp;<span class="ident" id="2857970">i</span>&nbsp;<span class="op" id="2857972">&lt;</span>&nbsp;<span class="ident" id="2857974">c</span><span class="op" id="2857975">;</span>&nbsp;<span class="ident" id="2857977">i</span><span class="op" id="2857978">++</span>&nbsp;<span class="op" id="2857981">{</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2857986">gc</span><span class="op" id="2857988">.</span><span class="ident" id="2857989">appendProg</span><span class="op" id="2857999">(</span><span class="ident" id="2858000">t</span><span class="op" id="2858001">.</span><span class="ident" id="2858002">Field</span><span class="op" id="2858007">(</span><span class="ident" id="2858008">i</span><span class="op" id="2858009">)</span><span class="op" id="2858010">.</span><span class="ident" id="2858011">Type</span><span class="op" id="2858015">.</span><span class="ident" id="2858016">common</span><span class="op" id="2858022">(</span><span class="op" id="2858023">)</span><span class="op" id="2858024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2858028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2858032">gc</span><span class="op" id="2858034">.</span><span class="ident" id="2858035">align</span><span class="op" id="2858040">(</span><span class="builtintype" id="2858041">uintptr</span><span class="op" id="2858048">(</span><span class="ident" id="2858049">t</span><span class="op" id="2858050">.</span><span class="ident" id="2858051">align</span><span class="op" id="2858056">)</span><span class="op" id="2858057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2858060">}</span><br>
<span class="lineno"></span><span class="op" id="2858062">}</span><br>
<span class="lineno">1550</span><br>
<span class="lineno"></span><span class="keyword" id="2858065">func</span>&nbsp;<span class="op" id="2858070">(</span><span class="ident" id="2858071">gc</span>&nbsp;<span class="op" id="2858074">*</span><span class="ident" id="2858075">gcProg</span><span class="op" id="2858081">)</span>&nbsp;<span class="ident" id="2858083">appendWord</span><span class="op" id="2858093">(</span><span class="ident" id="2858094">v</span>&nbsp;<span class="builtintype" id="2858096">byte</span><span class="op" id="2858100">)</span>&nbsp;<span class="op" id="2858102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2858105">ptrsize</span>&nbsp;<span class="op" id="2858113">:=</span>&nbsp;<span class="ident" id="2858116">unsafe</span><span class="op" id="2858122">.</span><span class="ident" id="2858123">Sizeof</span><span class="op" id="2858129">(</span><span class="builtintype" id="2858130">uintptr</span><span class="op" id="2858137">(</span><span class="num" id="2858138">0</span><span class="op" id="2858139">)</span><span class="op" id="2858140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2858143">if</span>&nbsp;<span class="ident" id="2858146">gc</span><span class="op" id="2858148">.</span><span class="ident" id="2858149">size</span><span class="op" id="2858153">%</span><span class="ident" id="2858154">ptrsize</span>&nbsp;<span class="op" id="2858162">!=</span>&nbsp;<span class="num" id="2858165">0</span>&nbsp;<span class="op" id="2858167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2858171">panic</span><span class="op" id="2858176">(</span><span class="string" id="2858177">&#34;reflect:&nbsp;unaligned&nbsp;GC&nbsp;program&#34;</span><span class="op" id="2858208">)</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2858211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2858214">nptr</span>&nbsp;<span class="op" id="2858219">:=</span>&nbsp;<span class="ident" id="2858222">gc</span><span class="op" id="2858224">.</span><span class="ident" id="2858225">size</span>&nbsp;<span class="op" id="2858230">/</span>&nbsp;<span class="ident" id="2858232">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2858241">for</span>&nbsp;<span class="builtintype" id="2858245">uintptr</span><span class="op" id="2858252">(</span><span class="builtinfunc" id="2858253">len</span><span class="op" id="2858256">(</span><span class="ident" id="2858257">gc</span><span class="op" id="2858259">.</span><span class="ident" id="2858260">gc</span><span class="op" id="2858262">)</span><span class="op" id="2858263">)</span>&nbsp;<span class="op" id="2858265">&lt;</span>&nbsp;<span class="ident" id="2858267">nptr</span><span class="op" id="2858271">/</span><span class="num" id="2858272">2</span><span class="op" id="2858273">+</span><span class="num" id="2858274">1</span>&nbsp;<span class="op" id="2858276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2858280">gc</span><span class="op" id="2858282">.</span><span class="ident" id="2858283">gc</span>&nbsp;<span class="op" id="2858286">=</span>&nbsp;<span class="builtinfunc" id="2858288">append</span><span class="op" id="2858294">(</span><span class="ident" id="2858295">gc</span><span class="op" id="2858297">.</span><span class="ident" id="2858298">gc</span><span class="op" id="2858300">,</span>&nbsp;<span class="num" id="2858302">0x44</span><span class="op" id="2858306">)</span>&nbsp;<span class="comment" id="2858308">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2858323">}</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2858326">gc</span><span class="op" id="2858328">.</span><span class="ident" id="2858329">gc</span><span class="op" id="2858331">[</span><span class="ident" id="2858332">nptr</span><span class="op" id="2858336">/</span><span class="num" id="2858337">2</span><span class="op" id="2858338">]</span>&nbsp;<span class="op" id="2858340">&amp;=</span>&nbsp;<span class="op" id="2858343">^</span><span class="op" id="2858344">(</span><span class="num" id="2858345">3</span>&nbsp;<span class="op" id="2858347">&lt;&lt;</span>&nbsp;<span class="op" id="2858350">(</span><span class="op" id="2858351">(</span><span class="ident" id="2858352">nptr</span><span class="op" id="2858356">%</span><span class="num" id="2858357">2</span><span class="op" id="2858358">)</span><span class="op" id="2858359">*</span><span class="num" id="2858360">4</span>&nbsp;<span class="op" id="2858362">+</span>&nbsp;<span class="num" id="2858364">2</span><span class="op" id="2858365">)</span><span class="op" id="2858366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2858369">gc</span><span class="op" id="2858371">.</span><span class="ident" id="2858372">gc</span><span class="op" id="2858374">[</span><span class="ident" id="2858375">nptr</span><span class="op" id="2858379">/</span><span class="num" id="2858380">2</span><span class="op" id="2858381">]</span>&nbsp;<span class="op" id="2858383">|=</span>&nbsp;<span class="ident" id="2858386">v</span>&nbsp;<span class="op" id="2858388">&lt;&lt;</span>&nbsp;<span class="op" id="2858391">(</span><span class="op" id="2858392">(</span><span class="ident" id="2858393">nptr</span><span class="op" id="2858397">%</span><span class="num" id="2858398">2</span><span class="op" id="2858399">)</span><span class="op" id="2858400">*</span><span class="num" id="2858401">4</span>&nbsp;<span class="op" id="2858403">+</span>&nbsp;<span class="num" id="2858405">2</span><span class="op" id="2858406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2858409">gc</span><span class="op" id="2858411">.</span><span class="ident" id="2858412">size</span>&nbsp;<span class="op" id="2858417">+=</span>&nbsp;<span class="ident" id="2858420">ptrsize</span><br>
<span class="lineno"></span><span class="op" id="2858428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="keyword" id="2858431">func</span>&nbsp;<span class="op" id="2858436">(</span><span class="ident" id="2858437">gc</span>&nbsp;<span class="op" id="2858440">*</span><span class="ident" id="2858441">gcProg</span><span class="op" id="2858447">)</span>&nbsp;<span class="ident" id="2858449">finalize</span><span class="op" id="2858457">(</span><span class="op" id="2858458">)</span>&nbsp;<span class="ident" id="2858460">unsafe</span><span class="op" id="2858466">.</span><span class="ident" id="2858467">Pointer</span>&nbsp;<span class="op" id="2858475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2858478">if</span>&nbsp;<span class="ident" id="2858481">gc</span><span class="op" id="2858483">.</span><span class="ident" id="2858484">size</span>&nbsp;<span class="op" id="2858489">==</span>&nbsp;<span class="num" id="2858492">0</span>&nbsp;<span class="op" id="2858494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2858498">return</span>&nbsp;<span class="builtintype" id="2858505">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2858510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2858513">ptrsize</span>&nbsp;<span class="op" id="2858521">:=</span>&nbsp;<span class="ident" id="2858524">unsafe</span><span class="op" id="2858530">.</span><span class="ident" id="2858531">Sizeof</span><span class="op" id="2858537">(</span><span class="builtintype" id="2858538">uintptr</span><span class="op" id="2858545">(</span><span class="num" id="2858546">0</span><span class="op" id="2858547">)</span><span class="op" id="2858548">)</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2858551">gc</span><span class="op" id="2858553">.</span><span class="ident" id="2858554">align</span><span class="op" id="2858559">(</span><span class="ident" id="2858560">ptrsize</span><span class="op" id="2858567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2858570">nptr</span>&nbsp;<span class="op" id="2858575">:=</span>&nbsp;<span class="ident" id="2858578">gc</span><span class="op" id="2858580">.</span><span class="ident" id="2858581">size</span>&nbsp;<span class="op" id="2858586">/</span>&nbsp;<span class="ident" id="2858588">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2858597">for</span>&nbsp;<span class="builtintype" id="2858601">uintptr</span><span class="op" id="2858608">(</span><span class="builtinfunc" id="2858609">len</span><span class="op" id="2858612">(</span><span class="ident" id="2858613">gc</span><span class="op" id="2858615">.</span><span class="ident" id="2858616">gc</span><span class="op" id="2858618">)</span><span class="op" id="2858619">)</span>&nbsp;<span class="op" id="2858621">&lt;</span>&nbsp;<span class="ident" id="2858623">nptr</span><span class="op" id="2858627">/</span><span class="num" id="2858628">2</span><span class="op" id="2858629">+</span><span class="num" id="2858630">1</span>&nbsp;<span class="op" id="2858632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2858636">gc</span><span class="op" id="2858638">.</span><span class="ident" id="2858639">gc</span>&nbsp;<span class="op" id="2858642">=</span>&nbsp;<span class="builtinfunc" id="2858644">append</span><span class="op" id="2858650">(</span><span class="ident" id="2858651">gc</span><span class="op" id="2858653">.</span><span class="ident" id="2858654">gc</span><span class="op" id="2858656">,</span>&nbsp;<span class="num" id="2858658">0x44</span><span class="op" id="2858662">)</span>&nbsp;<span class="comment" id="2858664">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2858679">}</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2858682">//&nbsp;If&nbsp;number&nbsp;of&nbsp;words&nbsp;is&nbsp;odd,&nbsp;repeat&nbsp;the&nbsp;mask&nbsp;twice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2858736">//&nbsp;Compiler&nbsp;does&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2858764">if</span>&nbsp;<span class="ident" id="2858767">nptr</span><span class="op" id="2858771">%</span><span class="num" id="2858772">2</span>&nbsp;<span class="op" id="2858774">!=</span>&nbsp;<span class="num" id="2858777">0</span>&nbsp;<span class="op" id="2858779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2858783">for</span>&nbsp;<span class="ident" id="2858787">i</span>&nbsp;<span class="op" id="2858789">:=</span>&nbsp;<span class="builtintype" id="2858792">uintptr</span><span class="op" id="2858799">(</span><span class="num" id="2858800">0</span><span class="op" id="2858801">)</span><span class="op" id="2858802">;</span>&nbsp;<span class="ident" id="2858804">i</span>&nbsp;<span class="op" id="2858806">&lt;</span>&nbsp;<span class="ident" id="2858808">nptr</span><span class="op" id="2858812">;</span>&nbsp;<span class="ident" id="2858814">i</span><span class="op" id="2858815">++</span>&nbsp;<span class="op" id="2858818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2858823">gc</span><span class="op" id="2858825">.</span><span class="ident" id="2858826">appendWord</span><span class="op" id="2858836">(</span><span class="ident" id="2858837">extractGCWord</span><span class="op" id="2858850">(</span><span class="ident" id="2858851">gc</span><span class="op" id="2858853">.</span><span class="ident" id="2858854">gc</span><span class="op" id="2858856">,</span>&nbsp;<span class="ident" id="2858858">i</span><span class="op" id="2858859">)</span><span class="op" id="2858860">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2858864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2858867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2858870">return</span>&nbsp;<span class="ident" id="2858877">unsafe</span><span class="op" id="2858883">.</span><span class="ident" id="2858884">Pointer</span><span class="op" id="2858891">(</span><span class="op" id="2858892">&amp;</span><span class="ident" id="2858893">gc</span><span class="op" id="2858895">.</span><span class="ident" id="2858896">gc</span><span class="op" id="2858898">[</span><span class="num" id="2858899">0</span><span class="op" id="2858900">]</span><span class="op" id="2858901">)</span><br>
<span class="lineno"></span><span class="op" id="2858903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span><span class="keyword" id="2858906">func</span>&nbsp;<span class="ident" id="2858911">extractGCWord</span><span class="op" id="2858924">(</span><span class="ident" id="2858925">gc</span>&nbsp;<span class="op" id="2858928">[</span><span class="op" id="2858929">]</span><span class="builtintype" id="2858930">byte</span><span class="op" id="2858934">,</span>&nbsp;<span class="ident" id="2858936">i</span>&nbsp;<span class="builtintype" id="2858938">uintptr</span><span class="op" id="2858945">)</span>&nbsp;<span class="builtintype" id="2858947">byte</span>&nbsp;<span class="op" id="2858952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2858955">return</span>&nbsp;<span class="op" id="2858962">(</span><span class="ident" id="2858963">gc</span><span class="op" id="2858965">[</span><span class="ident" id="2858966">i</span><span class="op" id="2858967">/</span><span class="num" id="2858968">2</span><span class="op" id="2858969">]</span>&nbsp;<span class="op" id="2858971">&gt;&gt;</span>&nbsp;<span class="op" id="2858974">(</span><span class="op" id="2858975">(</span><span class="ident" id="2858976">i</span><span class="op" id="2858977">%</span><span class="num" id="2858978">2</span><span class="op" id="2858979">)</span><span class="op" id="2858980">*</span><span class="num" id="2858981">4</span>&nbsp;<span class="op" id="2858983">+</span>&nbsp;<span class="num" id="2858985">2</span><span class="op" id="2858986">)</span><span class="op" id="2858987">)</span>&nbsp;<span class="op" id="2858989">&amp;</span>&nbsp;<span class="num" id="2858991">3</span><br>
<span class="lineno"></span><span class="op" id="2858993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2858996">func</span>&nbsp;<span class="op" id="2859001">(</span><span class="ident" id="2859002">gc</span>&nbsp;<span class="op" id="2859005">*</span><span class="ident" id="2859006">gcProg</span><span class="op" id="2859012">)</span>&nbsp;<span class="ident" id="2859014">align</span><span class="op" id="2859019">(</span><span class="ident" id="2859020">a</span>&nbsp;<span class="builtintype" id="2859022">uintptr</span><span class="op" id="2859029">)</span>&nbsp;<span class="op" id="2859031">{</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2859034">gc</span><span class="op" id="2859036">.</span><span class="ident" id="2859037">size</span>&nbsp;<span class="op" id="2859042">=</span>&nbsp;<span class="ident" id="2859044">align</span><span class="op" id="2859049">(</span><span class="ident" id="2859050">gc</span><span class="op" id="2859052">.</span><span class="ident" id="2859053">size</span><span class="op" id="2859057">,</span>&nbsp;<span class="ident" id="2859059">a</span><span class="op" id="2859060">)</span><br>
<span class="lineno"></span><span class="op" id="2859062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2859065">//&nbsp;These&nbsp;constants&nbsp;must&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/mgc0.h.</span><br>
<span class="lineno"></span><span class="keyword" id="2859126">const</span>&nbsp;<span class="op" id="2859132">(</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2859135">bitsScalar</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2859149">=</span>&nbsp;<span class="num" id="2859151">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2859154">bitsPointer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2859168">=</span>&nbsp;<span class="num" id="2859170">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2859173">bitsMultiWord</span>&nbsp;<span class="op" id="2859187">=</span>&nbsp;<span class="num" id="2859189">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2859193">bitsIface</span>&nbsp;<span class="op" id="2859203">=</span>&nbsp;<span class="num" id="2859205">2</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2859208">bitsEface</span>&nbsp;<span class="op" id="2859218">=</span>&nbsp;<span class="num" id="2859220">3</span><br>
<span class="lineno"></span><span class="op" id="2859222">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2859225">//&nbsp;Make&nbsp;sure&nbsp;these&nbsp;routines&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../../runtime/hashmap.go!</span><br>
<span class="lineno"></span><span class="comment" id="2859297">//&nbsp;These&nbsp;types&nbsp;exist&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno">1605</span><span class="comment" id="2859369">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2859444">//&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2859475">const</span>&nbsp;<span class="op" id="2859481">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2859484">bucketSize</span>&nbsp;<span class="op" id="2859495">=</span>&nbsp;<span class="num" id="2859497">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2859500">maxKeySize</span>&nbsp;<span class="op" id="2859511">=</span>&nbsp;<span class="num" id="2859513">128</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2859518">maxValSize</span>&nbsp;<span class="op" id="2859529">=</span>&nbsp;<span class="num" id="2859531">128</span><br>
<span class="lineno"></span><span class="op" id="2859535">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2859538">func</span>&nbsp;<span class="ident" id="2859543">bucketOf</span><span class="op" id="2859551">(</span><span class="ident" id="2859552">ktyp</span><span class="op" id="2859556">,</span>&nbsp;<span class="ident" id="2859558">etyp</span>&nbsp;<span class="op" id="2859563">*</span><span class="ident" id="2859564">rtype</span><span class="op" id="2859569">)</span>&nbsp;<span class="op" id="2859571">*</span><span class="ident" id="2859572">rtype</span>&nbsp;<span class="op" id="2859578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2859581">if</span>&nbsp;<span class="ident" id="2859584">ktyp</span><span class="op" id="2859588">.</span><span class="ident" id="2859589">size</span>&nbsp;<span class="op" id="2859594">&gt;</span>&nbsp;<span class="ident" id="2859596">maxKeySize</span>&nbsp;<span class="op" id="2859607">{</span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2859611">ktyp</span>&nbsp;<span class="op" id="2859616">=</span>&nbsp;<span class="ident" id="2859618">PtrTo</span><span class="op" id="2859623">(</span><span class="ident" id="2859624">ktyp</span><span class="op" id="2859628">)</span><span class="op" id="2859629">.</span><span class="op" id="2859630">(</span><span class="op" id="2859631">*</span><span class="ident" id="2859632">rtype</span><span class="op" id="2859637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2859640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2859643">if</span>&nbsp;<span class="ident" id="2859646">etyp</span><span class="op" id="2859650">.</span><span class="ident" id="2859651">size</span>&nbsp;<span class="op" id="2859656">&gt;</span>&nbsp;<span class="ident" id="2859658">maxValSize</span>&nbsp;<span class="op" id="2859669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2859673">etyp</span>&nbsp;<span class="op" id="2859678">=</span>&nbsp;<span class="ident" id="2859680">PtrTo</span><span class="op" id="2859685">(</span><span class="ident" id="2859686">etyp</span><span class="op" id="2859690">)</span><span class="op" id="2859691">.</span><span class="op" id="2859692">(</span><span class="op" id="2859693">*</span><span class="ident" id="2859694">rtype</span><span class="op" id="2859699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2859702">}</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2859705">ptrsize</span>&nbsp;<span class="op" id="2859713">:=</span>&nbsp;<span class="ident" id="2859716">unsafe</span><span class="op" id="2859722">.</span><span class="ident" id="2859723">Sizeof</span><span class="op" id="2859729">(</span><span class="builtintype" id="2859730">uintptr</span><span class="op" id="2859737">(</span><span class="num" id="2859738">0</span><span class="op" id="2859739">)</span><span class="op" id="2859740">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2859744">var</span>&nbsp;<span class="ident" id="2859748">gc</span>&nbsp;<span class="ident" id="2859751">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2859759">//&nbsp;topbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2859771">for</span>&nbsp;<span class="ident" id="2859775">i</span>&nbsp;<span class="op" id="2859777">:=</span>&nbsp;<span class="num" id="2859780">0</span><span class="op" id="2859781">;</span>&nbsp;<span class="ident" id="2859783">i</span>&nbsp;<span class="op" id="2859785">&lt;</span>&nbsp;<span class="builtintype" id="2859787">int</span><span class="op" id="2859790">(</span><span class="ident" id="2859791">bucketSize</span><span class="op" id="2859801">*</span><span class="ident" id="2859802">unsafe</span><span class="op" id="2859808">.</span><span class="ident" id="2859809">Sizeof</span><span class="op" id="2859815">(</span><span class="builtintype" id="2859816">uint8</span><span class="op" id="2859821">(</span><span class="num" id="2859822">0</span><span class="op" id="2859823">)</span><span class="op" id="2859824">)</span><span class="op" id="2859825">/</span><span class="ident" id="2859826">ptrsize</span><span class="op" id="2859833">)</span><span class="op" id="2859834">;</span>&nbsp;<span class="ident" id="2859836">i</span><span class="op" id="2859837">++</span>&nbsp;<span class="op" id="2859840">{</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2859844">gc</span><span class="op" id="2859846">.</span><span class="builtinfunc" id="2859847">append</span><span class="op" id="2859853">(</span><span class="ident" id="2859854">bitsScalar</span><span class="op" id="2859864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2859867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2859870">gc</span><span class="op" id="2859872">.</span><span class="builtinfunc" id="2859873">append</span><span class="op" id="2859879">(</span><span class="ident" id="2859880">bitsPointer</span><span class="op" id="2859891">)</span>&nbsp;<span class="comment" id="2859893">//&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2859906">if</span>&nbsp;<span class="ident" id="2859909">runtime</span><span class="op" id="2859916">.</span><span class="ident" id="2859917">GOARCH</span>&nbsp;<span class="op" id="2859924">==</span>&nbsp;<span class="string" id="2859927">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2859938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2859942">gc</span><span class="op" id="2859944">.</span><span class="builtinfunc" id="2859945">append</span><span class="op" id="2859951">(</span><span class="ident" id="2859952">bitsScalar</span><span class="op" id="2859962">)</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2859965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2859968">//&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2859977">for</span>&nbsp;<span class="ident" id="2859981">i</span>&nbsp;<span class="op" id="2859983">:=</span>&nbsp;<span class="num" id="2859986">0</span><span class="op" id="2859987">;</span>&nbsp;<span class="ident" id="2859989">i</span>&nbsp;<span class="op" id="2859991">&lt;</span>&nbsp;<span class="ident" id="2859993">bucketSize</span><span class="op" id="2860003">;</span>&nbsp;<span class="ident" id="2860005">i</span><span class="op" id="2860006">++</span>&nbsp;<span class="op" id="2860009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860013">gc</span><span class="op" id="2860015">.</span><span class="ident" id="2860016">appendProg</span><span class="op" id="2860026">(</span><span class="ident" id="2860027">ktyp</span><span class="op" id="2860031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2860034">}</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2860037">//&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2860048">for</span>&nbsp;<span class="ident" id="2860052">i</span>&nbsp;<span class="op" id="2860054">:=</span>&nbsp;<span class="num" id="2860057">0</span><span class="op" id="2860058">;</span>&nbsp;<span class="ident" id="2860060">i</span>&nbsp;<span class="op" id="2860062">&lt;</span>&nbsp;<span class="ident" id="2860064">bucketSize</span><span class="op" id="2860074">;</span>&nbsp;<span class="ident" id="2860076">i</span><span class="op" id="2860077">++</span>&nbsp;<span class="op" id="2860080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860084">gc</span><span class="op" id="2860086">.</span><span class="ident" id="2860087">appendProg</span><span class="op" id="2860097">(</span><span class="ident" id="2860098">etyp</span><span class="op" id="2860102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2860105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860109">b</span>&nbsp;<span class="op" id="2860111">:=</span>&nbsp;<span class="builtinfunc" id="2860114">new</span><span class="op" id="2860117">(</span><span class="ident" id="2860118">rtype</span><span class="op" id="2860123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860126">b</span><span class="op" id="2860127">.</span><span class="ident" id="2860128">size</span>&nbsp;<span class="op" id="2860133">=</span>&nbsp;<span class="ident" id="2860135">gc</span><span class="op" id="2860137">.</span><span class="ident" id="2860138">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860144">b</span><span class="op" id="2860145">.</span><span class="ident" id="2860146">gc</span><span class="op" id="2860148">[</span><span class="num" id="2860149">0</span><span class="op" id="2860150">]</span>&nbsp;<span class="op" id="2860152">=</span>&nbsp;<span class="ident" id="2860154">gc</span><span class="op" id="2860156">.</span><span class="ident" id="2860157">finalize</span><span class="op" id="2860165">(</span><span class="op" id="2860166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860169">s</span>&nbsp;<span class="op" id="2860171">:=</span>&nbsp;<span class="string" id="2860174">&#34;bucket(&#34;</span>&nbsp;<span class="op" id="2860184">+</span>&nbsp;<span class="op" id="2860186">*</span><span class="ident" id="2860187">ktyp</span><span class="op" id="2860191">.</span><span class="builtintype" id="2860192">string</span>&nbsp;<span class="op" id="2860199">+</span>&nbsp;<span class="string" id="2860201">&#34;,&#34;</span>&nbsp;<span class="op" id="2860205">+</span>&nbsp;<span class="op" id="2860207">*</span><span class="ident" id="2860208">etyp</span><span class="op" id="2860212">.</span><span class="builtintype" id="2860213">string</span>&nbsp;<span class="op" id="2860220">+</span>&nbsp;<span class="string" id="2860222">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860227">b</span><span class="op" id="2860228">.</span><span class="builtintype" id="2860229">string</span>&nbsp;<span class="op" id="2860236">=</span>&nbsp;<span class="op" id="2860238">&amp;</span><span class="ident" id="2860239">s</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2860242">return</span>&nbsp;<span class="ident" id="2860249">b</span><br>
<span class="lineno"></span><span class="op" id="2860251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2860254">//&nbsp;SliceOf&nbsp;returns&nbsp;the&nbsp;slice&nbsp;type&nbsp;with&nbsp;element&nbsp;type&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2860309">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;SliceOf(t)&nbsp;represents&nbsp;[]int.</span><br>
<span class="lineno">1650</span><span class="keyword" id="2860375">func</span>&nbsp;<span class="ident" id="2860380">SliceOf</span><span class="op" id="2860387">(</span><span class="ident" id="2860388">t</span>&nbsp;<span class="ident" id="2860390">Type</span><span class="op" id="2860394">)</span>&nbsp;<span class="ident" id="2860396">Type</span>&nbsp;<span class="op" id="2860401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860404">typ</span>&nbsp;<span class="op" id="2860408">:=</span>&nbsp;<span class="ident" id="2860411">t</span><span class="op" id="2860412">.</span><span class="op" id="2860413">(</span><span class="op" id="2860414">*</span><span class="ident" id="2860415">rtype</span><span class="op" id="2860420">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2860424">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860443">ckey</span>&nbsp;<span class="op" id="2860448">:=</span>&nbsp;<span class="ident" id="2860451">cacheKey</span><span class="op" id="2860459">{</span><span class="ident" id="2860460">Slice</span><span class="op" id="2860465">,</span>&nbsp;<span class="ident" id="2860467">typ</span><span class="op" id="2860470">,</span>&nbsp;<span class="builtintype" id="2860472">nil</span><span class="op" id="2860475">,</span>&nbsp;<span class="num" id="2860477">0</span><span class="op" id="2860478">}</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2860481">if</span>&nbsp;<span class="ident" id="2860484">slice</span>&nbsp;<span class="op" id="2860490">:=</span>&nbsp;<span class="ident" id="2860493">cacheGet</span><span class="op" id="2860501">(</span><span class="ident" id="2860502">ckey</span><span class="op" id="2860506">)</span><span class="op" id="2860507">;</span>&nbsp;<span class="ident" id="2860509">slice</span>&nbsp;<span class="op" id="2860515">!=</span>&nbsp;<span class="builtintype" id="2860518">nil</span>&nbsp;<span class="op" id="2860522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2860526">return</span>&nbsp;<span class="ident" id="2860533">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2860540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2860544">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno">1660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860569">s</span>&nbsp;<span class="op" id="2860571">:=</span>&nbsp;<span class="string" id="2860574">&#34;[]&#34;</span>&nbsp;<span class="op" id="2860579">+</span>&nbsp;<span class="op" id="2860581">*</span><span class="ident" id="2860582">typ</span><span class="op" id="2860585">.</span><span class="builtintype" id="2860586">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2860594">for</span>&nbsp;<span class="ident" id="2860598">_</span><span class="op" id="2860599">,</span>&nbsp;<span class="ident" id="2860601">tt</span>&nbsp;<span class="op" id="2860604">:=</span>&nbsp;<span class="keyword" id="2860607">range</span>&nbsp;<span class="ident" id="2860613">typesByString</span><span class="op" id="2860626">(</span><span class="ident" id="2860627">s</span><span class="op" id="2860628">)</span>&nbsp;<span class="op" id="2860630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860634">slice</span>&nbsp;<span class="op" id="2860640">:=</span>&nbsp;<span class="op" id="2860643">(</span><span class="op" id="2860644">*</span><span class="ident" id="2860645">sliceType</span><span class="op" id="2860654">)</span><span class="op" id="2860655">(</span><span class="ident" id="2860656">unsafe</span><span class="op" id="2860662">.</span><span class="ident" id="2860663">Pointer</span><span class="op" id="2860670">(</span><span class="ident" id="2860671">tt</span><span class="op" id="2860673">)</span><span class="op" id="2860674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2860678">if</span>&nbsp;<span class="ident" id="2860681">slice</span><span class="op" id="2860686">.</span><span class="ident" id="2860687">elem</span>&nbsp;<span class="op" id="2860692">==</span>&nbsp;<span class="ident" id="2860695">typ</span>&nbsp;<span class="op" id="2860699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2860704">return</span>&nbsp;<span class="ident" id="2860711">cachePut</span><span class="op" id="2860719">(</span><span class="ident" id="2860720">ckey</span><span class="op" id="2860724">,</span>&nbsp;<span class="ident" id="2860726">tt</span><span class="op" id="2860728">)</span><br>
<span class="lineno">1665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2860732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2860735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2860739">//&nbsp;Make&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2860762">var</span>&nbsp;<span class="ident" id="2860766">islice</span>&nbsp;<span class="keyword" id="2860773">interface</span><span class="op" id="2860782">{</span><span class="op" id="2860783">}</span>&nbsp;<span class="op" id="2860785">=</span>&nbsp;<span class="op" id="2860787">(</span><span class="op" id="2860788">[</span><span class="op" id="2860789">]</span><span class="ident" id="2860790">unsafe</span><span class="op" id="2860796">.</span><span class="ident" id="2860797">Pointer</span><span class="op" id="2860804">)</span><span class="op" id="2860805">(</span><span class="builtintype" id="2860806">nil</span><span class="op" id="2860809">)</span><br>
<span class="lineno">1670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860812">prototype</span>&nbsp;<span class="op" id="2860822">:=</span>&nbsp;<span class="op" id="2860825">*</span><span class="op" id="2860826">(</span><span class="op" id="2860827">*</span><span class="op" id="2860828">*</span><span class="ident" id="2860829">sliceType</span><span class="op" id="2860838">)</span><span class="op" id="2860839">(</span><span class="ident" id="2860840">unsafe</span><span class="op" id="2860846">.</span><span class="ident" id="2860847">Pointer</span><span class="op" id="2860854">(</span><span class="op" id="2860855">&amp;</span><span class="ident" id="2860856">islice</span><span class="op" id="2860862">)</span><span class="op" id="2860863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860866">slice</span>&nbsp;<span class="op" id="2860872">:=</span>&nbsp;<span class="builtinfunc" id="2860875">new</span><span class="op" id="2860878">(</span><span class="ident" id="2860879">sliceType</span><span class="op" id="2860888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2860891">*</span><span class="ident" id="2860892">slice</span>&nbsp;<span class="op" id="2860898">=</span>&nbsp;<span class="op" id="2860900">*</span><span class="ident" id="2860901">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860912">slice</span><span class="op" id="2860917">.</span><span class="builtintype" id="2860918">string</span>&nbsp;<span class="op" id="2860925">=</span>&nbsp;<span class="op" id="2860927">&amp;</span><span class="ident" id="2860928">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860931">slice</span><span class="op" id="2860936">.</span><span class="ident" id="2860937">hash</span>&nbsp;<span class="op" id="2860942">=</span>&nbsp;<span class="ident" id="2860944">fnv1</span><span class="op" id="2860948">(</span><span class="ident" id="2860949">typ</span><span class="op" id="2860952">.</span><span class="ident" id="2860953">hash</span><span class="op" id="2860957">,</span>&nbsp;<span class="string" id="2860959">&#39;[&#39;</span><span class="op" id="2860962">)</span><br>
<span class="lineno">1675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860965">slice</span><span class="op" id="2860970">.</span><span class="ident" id="2860971">elem</span>&nbsp;<span class="op" id="2860976">=</span>&nbsp;<span class="ident" id="2860978">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2860983">slice</span><span class="op" id="2860988">.</span><span class="ident" id="2860989">uncommonType</span>&nbsp;<span class="op" id="2861002">=</span>&nbsp;<span class="builtintype" id="2861004">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2861009">slice</span><span class="op" id="2861014">.</span><span class="ident" id="2861015">ptrToThis</span>&nbsp;<span class="op" id="2861025">=</span>&nbsp;<span class="builtintype" id="2861027">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2861032">slice</span><span class="op" id="2861037">.</span><span class="ident" id="2861038">zero</span>&nbsp;<span class="op" id="2861043">=</span>&nbsp;<span class="ident" id="2861045">unsafe</span><span class="op" id="2861051">.</span><span class="ident" id="2861052">Pointer</span><span class="op" id="2861059">(</span><span class="op" id="2861060">&amp;</span><span class="builtinfunc" id="2861061">make</span><span class="op" id="2861065">(</span><span class="op" id="2861066">[</span><span class="op" id="2861067">]</span><span class="builtintype" id="2861068">byte</span><span class="op" id="2861072">,</span>&nbsp;<span class="ident" id="2861074">slice</span><span class="op" id="2861079">.</span><span class="ident" id="2861080">size</span><span class="op" id="2861084">)</span><span class="op" id="2861085">[</span><span class="num" id="2861086">0</span><span class="op" id="2861087">]</span><span class="op" id="2861088">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2861092">return</span>&nbsp;<span class="ident" id="2861099">cachePut</span><span class="op" id="2861107">(</span><span class="ident" id="2861108">ckey</span><span class="op" id="2861112">,</span>&nbsp;<span class="op" id="2861114">&amp;</span><span class="ident" id="2861115">slice</span><span class="op" id="2861120">.</span><span class="ident" id="2861121">rtype</span><span class="op" id="2861126">)</span><br>
<span class="lineno"></span><span class="op" id="2861128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2861131">//&nbsp;ArrayOf&nbsp;returns&nbsp;the&nbsp;array&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;count&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2861204">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ArrayOf(5,&nbsp;t)&nbsp;represents&nbsp;[5]int.</span><br>
<span class="lineno">1685</span><span class="comment" id="2861274">//</span><br>
<span class="lineno"></span><span class="comment" id="2861277">//&nbsp;If&nbsp;the&nbsp;resulting&nbsp;type&nbsp;would&nbsp;be&nbsp;larger&nbsp;than&nbsp;the&nbsp;available&nbsp;address&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="2861352">//&nbsp;ArrayOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2861371">//</span><br>
<span class="lineno"></span><span class="comment" id="2861374">//&nbsp;TODO(rsc):&nbsp;Unexported&nbsp;for&nbsp;now.&nbsp;Export&nbsp;once&nbsp;the&nbsp;alg&nbsp;field&nbsp;is&nbsp;set&nbsp;correctly</span><br>
<span class="lineno">1690</span><span class="comment" id="2861451">//&nbsp;for&nbsp;the&nbsp;type.&nbsp;This&nbsp;may&nbsp;require&nbsp;significant&nbsp;work.</span><br>
<span class="lineno"></span><span class="comment" id="2861503">//</span><br>
<span class="lineno"></span><span class="comment" id="2861506">//&nbsp;TODO(rsc):&nbsp;TestArrayOf&nbsp;is&nbsp;also&nbsp;disabled.&nbsp;Re-enable.</span><br>
<span class="lineno"></span><span class="keyword" id="2861561">func</span>&nbsp;<span class="ident" id="2861566">arrayOf</span><span class="op" id="2861573">(</span><span class="ident" id="2861574">count</span>&nbsp;<span class="builtintype" id="2861580">int</span><span class="op" id="2861583">,</span>&nbsp;<span class="ident" id="2861585">elem</span>&nbsp;<span class="ident" id="2861590">Type</span><span class="op" id="2861594">)</span>&nbsp;<span class="ident" id="2861596">Type</span>&nbsp;<span class="op" id="2861601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2861604">typ</span>&nbsp;<span class="op" id="2861608">:=</span>&nbsp;<span class="ident" id="2861611">elem</span><span class="op" id="2861615">.</span><span class="op" id="2861616">(</span><span class="op" id="2861617">*</span><span class="ident" id="2861618">rtype</span><span class="op" id="2861623">)</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2861626">slice</span>&nbsp;<span class="op" id="2861632">:=</span>&nbsp;<span class="ident" id="2861635">SliceOf</span><span class="op" id="2861642">(</span><span class="ident" id="2861643">elem</span><span class="op" id="2861647">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2861651">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2861670">ckey</span>&nbsp;<span class="op" id="2861675">:=</span>&nbsp;<span class="ident" id="2861678">cacheKey</span><span class="op" id="2861686">{</span><span class="ident" id="2861687">Array</span><span class="op" id="2861692">,</span>&nbsp;<span class="ident" id="2861694">typ</span><span class="op" id="2861697">,</span>&nbsp;<span class="builtintype" id="2861699">nil</span><span class="op" id="2861702">,</span>&nbsp;<span class="builtintype" id="2861704">uintptr</span><span class="op" id="2861711">(</span><span class="ident" id="2861712">count</span><span class="op" id="2861717">)</span><span class="op" id="2861718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2861721">if</span>&nbsp;<span class="ident" id="2861724">slice</span>&nbsp;<span class="op" id="2861730">:=</span>&nbsp;<span class="ident" id="2861733">cacheGet</span><span class="op" id="2861741">(</span><span class="ident" id="2861742">ckey</span><span class="op" id="2861746">)</span><span class="op" id="2861747">;</span>&nbsp;<span class="ident" id="2861749">slice</span>&nbsp;<span class="op" id="2861755">!=</span>&nbsp;<span class="builtintype" id="2861758">nil</span>&nbsp;<span class="op" id="2861762">{</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2861766">return</span>&nbsp;<span class="ident" id="2861773">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2861780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2861784">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2861809">s</span>&nbsp;<span class="op" id="2861811">:=</span>&nbsp;<span class="string" id="2861814">&#34;[&#34;</span>&nbsp;<span class="op" id="2861818">+</span>&nbsp;<span class="ident" id="2861820">strconv</span><span class="op" id="2861827">.</span><span class="ident" id="2861828">Itoa</span><span class="op" id="2861832">(</span><span class="ident" id="2861833">count</span><span class="op" id="2861838">)</span>&nbsp;<span class="op" id="2861840">+</span>&nbsp;<span class="string" id="2861842">&#34;]&#34;</span>&nbsp;<span class="op" id="2861846">+</span>&nbsp;<span class="op" id="2861848">*</span><span class="ident" id="2861849">typ</span><span class="op" id="2861852">.</span><span class="builtintype" id="2861853">string</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2861861">for</span>&nbsp;<span class="ident" id="2861865">_</span><span class="op" id="2861866">,</span>&nbsp;<span class="ident" id="2861868">tt</span>&nbsp;<span class="op" id="2861871">:=</span>&nbsp;<span class="keyword" id="2861874">range</span>&nbsp;<span class="ident" id="2861880">typesByString</span><span class="op" id="2861893">(</span><span class="ident" id="2861894">s</span><span class="op" id="2861895">)</span>&nbsp;<span class="op" id="2861897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2861901">slice</span>&nbsp;<span class="op" id="2861907">:=</span>&nbsp;<span class="op" id="2861910">(</span><span class="op" id="2861911">*</span><span class="ident" id="2861912">sliceType</span><span class="op" id="2861921">)</span><span class="op" id="2861922">(</span><span class="ident" id="2861923">unsafe</span><span class="op" id="2861929">.</span><span class="ident" id="2861930">Pointer</span><span class="op" id="2861937">(</span><span class="ident" id="2861938">tt</span><span class="op" id="2861940">)</span><span class="op" id="2861941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2861945">if</span>&nbsp;<span class="ident" id="2861948">slice</span><span class="op" id="2861953">.</span><span class="ident" id="2861954">elem</span>&nbsp;<span class="op" id="2861959">==</span>&nbsp;<span class="ident" id="2861962">typ</span>&nbsp;<span class="op" id="2861966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2861971">return</span>&nbsp;<span class="ident" id="2861978">cachePut</span><span class="op" id="2861986">(</span><span class="ident" id="2861987">ckey</span><span class="op" id="2861991">,</span>&nbsp;<span class="ident" id="2861993">tt</span><span class="op" id="2861995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2861999">}</span><br>
<span class="lineno">1710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2862002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2862006">//&nbsp;Make&nbsp;an&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2862030">var</span>&nbsp;<span class="ident" id="2862034">iarray</span>&nbsp;<span class="keyword" id="2862041">interface</span><span class="op" id="2862050">{</span><span class="op" id="2862051">}</span>&nbsp;<span class="op" id="2862053">=</span>&nbsp;<span class="op" id="2862055">[</span><span class="num" id="2862056">1</span><span class="op" id="2862057">]</span><span class="ident" id="2862058">unsafe</span><span class="op" id="2862064">.</span><span class="ident" id="2862065">Pointer</span><span class="op" id="2862072">{</span><span class="op" id="2862073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862076">prototype</span>&nbsp;<span class="op" id="2862086">:=</span>&nbsp;<span class="op" id="2862089">*</span><span class="op" id="2862090">(</span><span class="op" id="2862091">*</span><span class="op" id="2862092">*</span><span class="ident" id="2862093">arrayType</span><span class="op" id="2862102">)</span><span class="op" id="2862103">(</span><span class="ident" id="2862104">unsafe</span><span class="op" id="2862110">.</span><span class="ident" id="2862111">Pointer</span><span class="op" id="2862118">(</span><span class="op" id="2862119">&amp;</span><span class="ident" id="2862120">iarray</span><span class="op" id="2862126">)</span><span class="op" id="2862127">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862130">array</span>&nbsp;<span class="op" id="2862136">:=</span>&nbsp;<span class="builtinfunc" id="2862139">new</span><span class="op" id="2862142">(</span><span class="ident" id="2862143">arrayType</span><span class="op" id="2862152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2862155">*</span><span class="ident" id="2862156">array</span>&nbsp;<span class="op" id="2862162">=</span>&nbsp;<span class="op" id="2862164">*</span><span class="ident" id="2862165">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2862176">//&nbsp;TODO:&nbsp;Set&nbsp;extra&nbsp;kind&nbsp;bits&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862217">array</span><span class="op" id="2862222">.</span><span class="builtintype" id="2862223">string</span>&nbsp;<span class="op" id="2862230">=</span>&nbsp;<span class="op" id="2862232">&amp;</span><span class="ident" id="2862233">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862236">array</span><span class="op" id="2862241">.</span><span class="ident" id="2862242">hash</span>&nbsp;<span class="op" id="2862247">=</span>&nbsp;<span class="ident" id="2862249">fnv1</span><span class="op" id="2862253">(</span><span class="ident" id="2862254">typ</span><span class="op" id="2862257">.</span><span class="ident" id="2862258">hash</span><span class="op" id="2862262">,</span>&nbsp;<span class="string" id="2862264">&#39;[&#39;</span><span class="op" id="2862267">)</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2862270">for</span>&nbsp;<span class="ident" id="2862274">n</span>&nbsp;<span class="op" id="2862276">:=</span>&nbsp;<span class="builtintype" id="2862279">uint32</span><span class="op" id="2862285">(</span><span class="ident" id="2862286">count</span><span class="op" id="2862291">)</span><span class="op" id="2862292">;</span>&nbsp;<span class="ident" id="2862294">n</span>&nbsp;<span class="op" id="2862296">&gt;</span>&nbsp;<span class="num" id="2862298">0</span><span class="op" id="2862299">;</span>&nbsp;<span class="ident" id="2862301">n</span>&nbsp;<span class="op" id="2862303">&gt;&gt;=</span>&nbsp;<span class="num" id="2862307">8</span>&nbsp;<span class="op" id="2862309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862313">array</span><span class="op" id="2862318">.</span><span class="ident" id="2862319">hash</span>&nbsp;<span class="op" id="2862324">=</span>&nbsp;<span class="ident" id="2862326">fnv1</span><span class="op" id="2862330">(</span><span class="ident" id="2862331">array</span><span class="op" id="2862336">.</span><span class="ident" id="2862337">hash</span><span class="op" id="2862341">,</span>&nbsp;<span class="builtintype" id="2862343">byte</span><span class="op" id="2862347">(</span><span class="ident" id="2862348">n</span><span class="op" id="2862349">)</span><span class="op" id="2862350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2862353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862356">array</span><span class="op" id="2862361">.</span><span class="ident" id="2862362">hash</span>&nbsp;<span class="op" id="2862367">=</span>&nbsp;<span class="ident" id="2862369">fnv1</span><span class="op" id="2862373">(</span><span class="ident" id="2862374">array</span><span class="op" id="2862379">.</span><span class="ident" id="2862380">hash</span><span class="op" id="2862384">,</span>&nbsp;<span class="string" id="2862386">&#39;]&#39;</span><span class="op" id="2862389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862392">array</span><span class="op" id="2862397">.</span><span class="ident" id="2862398">elem</span>&nbsp;<span class="op" id="2862403">=</span>&nbsp;<span class="ident" id="2862405">typ</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862410">max</span>&nbsp;<span class="op" id="2862414">:=</span>&nbsp;<span class="op" id="2862417">^</span><span class="builtintype" id="2862418">uintptr</span><span class="op" id="2862425">(</span><span class="num" id="2862426">0</span><span class="op" id="2862427">)</span>&nbsp;<span class="op" id="2862429">/</span>&nbsp;<span class="ident" id="2862431">typ</span><span class="op" id="2862434">.</span><span class="ident" id="2862435">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2862441">if</span>&nbsp;<span class="builtintype" id="2862444">uintptr</span><span class="op" id="2862451">(</span><span class="ident" id="2862452">count</span><span class="op" id="2862457">)</span>&nbsp;<span class="op" id="2862459">&gt;</span>&nbsp;<span class="ident" id="2862461">max</span>&nbsp;<span class="op" id="2862465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2862469">panic</span><span class="op" id="2862474">(</span><span class="string" id="2862475">&#34;reflect.ArrayOf:&nbsp;array&nbsp;size&nbsp;would&nbsp;exceed&nbsp;virtual&nbsp;address&nbsp;space&#34;</span><span class="op" id="2862539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2862542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862545">array</span><span class="op" id="2862550">.</span><span class="ident" id="2862551">size</span>&nbsp;<span class="op" id="2862556">=</span>&nbsp;<span class="ident" id="2862558">typ</span><span class="op" id="2862561">.</span><span class="ident" id="2862562">size</span>&nbsp;<span class="op" id="2862567">*</span>&nbsp;<span class="builtintype" id="2862569">uintptr</span><span class="op" id="2862576">(</span><span class="ident" id="2862577">count</span><span class="op" id="2862582">)</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862585">array</span><span class="op" id="2862590">.</span><span class="ident" id="2862591">align</span>&nbsp;<span class="op" id="2862597">=</span>&nbsp;<span class="ident" id="2862599">typ</span><span class="op" id="2862602">.</span><span class="ident" id="2862603">align</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862610">array</span><span class="op" id="2862615">.</span><span class="ident" id="2862616">fieldAlign</span>&nbsp;<span class="op" id="2862627">=</span>&nbsp;<span class="ident" id="2862629">typ</span><span class="op" id="2862632">.</span><span class="ident" id="2862633">fieldAlign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2862645">//&nbsp;TODO:&nbsp;array.alg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2862665">//&nbsp;TODO:&nbsp;array.gc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2862684">//&nbsp;TODO:</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862694">array</span><span class="op" id="2862699">.</span><span class="ident" id="2862700">uncommonType</span>&nbsp;<span class="op" id="2862713">=</span>&nbsp;<span class="builtintype" id="2862715">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862720">array</span><span class="op" id="2862725">.</span><span class="ident" id="2862726">ptrToThis</span>&nbsp;<span class="op" id="2862736">=</span>&nbsp;<span class="builtintype" id="2862738">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862743">array</span><span class="op" id="2862748">.</span><span class="ident" id="2862749">zero</span>&nbsp;<span class="op" id="2862754">=</span>&nbsp;<span class="ident" id="2862756">unsafe</span><span class="op" id="2862762">.</span><span class="ident" id="2862763">Pointer</span><span class="op" id="2862770">(</span><span class="op" id="2862771">&amp;</span><span class="builtinfunc" id="2862772">make</span><span class="op" id="2862776">(</span><span class="op" id="2862777">[</span><span class="op" id="2862778">]</span><span class="builtintype" id="2862779">byte</span><span class="op" id="2862783">,</span>&nbsp;<span class="ident" id="2862785">array</span><span class="op" id="2862790">.</span><span class="ident" id="2862791">size</span><span class="op" id="2862795">)</span><span class="op" id="2862796">[</span><span class="num" id="2862797">0</span><span class="op" id="2862798">]</span><span class="op" id="2862799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862802">array</span><span class="op" id="2862807">.</span><span class="builtinfunc" id="2862808">len</span>&nbsp;<span class="op" id="2862812">=</span>&nbsp;<span class="builtintype" id="2862814">uintptr</span><span class="op" id="2862821">(</span><span class="ident" id="2862822">count</span><span class="op" id="2862827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862830">array</span><span class="op" id="2862835">.</span><span class="ident" id="2862836">slice</span>&nbsp;<span class="op" id="2862842">=</span>&nbsp;<span class="ident" id="2862844">slice</span><span class="op" id="2862849">.</span><span class="op" id="2862850">(</span><span class="op" id="2862851">*</span><span class="ident" id="2862852">rtype</span><span class="op" id="2862857">)</span><br>
<span class="lineno">1740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2862861">return</span>&nbsp;<span class="ident" id="2862868">cachePut</span><span class="op" id="2862876">(</span><span class="ident" id="2862877">ckey</span><span class="op" id="2862881">,</span>&nbsp;<span class="op" id="2862883">&amp;</span><span class="ident" id="2862884">array</span><span class="op" id="2862889">.</span><span class="ident" id="2862890">rtype</span><span class="op" id="2862895">)</span><br>
<span class="lineno"></span><span class="op" id="2862897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2862900">//&nbsp;toType&nbsp;converts&nbsp;from&nbsp;a&nbsp;*rtype&nbsp;to&nbsp;a&nbsp;Type&nbsp;that&nbsp;can&nbsp;be&nbsp;returned</span><br>
<span class="lineno">1745</span><span class="comment" id="2862964">//&nbsp;to&nbsp;the&nbsp;client&nbsp;of&nbsp;package&nbsp;reflect.&nbsp;In&nbsp;gc,&nbsp;the&nbsp;only&nbsp;concern&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2863033">//&nbsp;a&nbsp;nil&nbsp;*rtype&nbsp;must&nbsp;be&nbsp;replaced&nbsp;by&nbsp;a&nbsp;nil&nbsp;Type,&nbsp;but&nbsp;in&nbsp;gccgo&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2863099">//&nbsp;function&nbsp;takes&nbsp;care&nbsp;of&nbsp;ensuring&nbsp;that&nbsp;multiple&nbsp;*rtype&nbsp;for&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2863168">//&nbsp;type&nbsp;are&nbsp;coalesced&nbsp;into&nbsp;a&nbsp;single&nbsp;Type.</span><br>
<span class="lineno"></span><span class="keyword" id="2863210">func</span>&nbsp;<span class="ident" id="2863215">toType</span><span class="op" id="2863221">(</span><span class="ident" id="2863222">t</span>&nbsp;<span class="op" id="2863224">*</span><span class="ident" id="2863225">rtype</span><span class="op" id="2863230">)</span>&nbsp;<span class="ident" id="2863232">Type</span>&nbsp;<span class="op" id="2863237">{</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2863240">if</span>&nbsp;<span class="ident" id="2863243">t</span>&nbsp;<span class="op" id="2863245">==</span>&nbsp;<span class="builtintype" id="2863248">nil</span>&nbsp;<span class="op" id="2863252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2863256">return</span>&nbsp;<span class="builtintype" id="2863263">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2863268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2863271">return</span>&nbsp;<span class="ident" id="2863278">t</span><br>
<span class="lineno"></span><span class="op" id="2863280">}</span><br>
<span class="lineno">1755</span><br>
<span class="lineno"></span><span class="keyword" id="2863283">type</span>&nbsp;<span class="ident" id="2863288">layoutKey</span>&nbsp;<span class="keyword" id="2863298">struct</span>&nbsp;<span class="op" id="2863305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2863308">t</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2863313">*</span><span class="ident" id="2863314">rtype</span>&nbsp;<span class="comment" id="2863320">//&nbsp;function&nbsp;signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2863343">rcvr</span>&nbsp;<span class="op" id="2863348">*</span><span class="ident" id="2863349">rtype</span>&nbsp;<span class="comment" id="2863355">//&nbsp;receiver&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;none</span><br>
<span class="lineno"></span><span class="op" id="2863388">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span><span class="keyword" id="2863391">type</span>&nbsp;<span class="ident" id="2863396">layoutType</span>&nbsp;<span class="keyword" id="2863407">struct</span>&nbsp;<span class="op" id="2863414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2863417">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2863427">*</span><span class="ident" id="2863428">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2863435">argSize</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2863445">uintptr</span>&nbsp;<span class="comment" id="2863453">//&nbsp;size&nbsp;of&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2863475">retOffset</span>&nbsp;<span class="builtintype" id="2863485">uintptr</span>&nbsp;<span class="comment" id="2863493">//&nbsp;offset&nbsp;of&nbsp;return&nbsp;values.</span><br>
<span class="lineno">1765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2863522">stack</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2863532">*</span><span class="ident" id="2863533">bitVector</span><br>
<span class="lineno"></span><span class="op" id="2863543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2863546">var</span>&nbsp;<span class="ident" id="2863550">layoutCache</span>&nbsp;<span class="keyword" id="2863562">struct</span>&nbsp;<span class="op" id="2863569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2863572">sync</span><span class="op" id="2863576">.</span><span class="ident" id="2863577">RWMutex</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2863586">m</span>&nbsp;<span class="keyword" id="2863588">map</span><span class="op" id="2863591">[</span><span class="ident" id="2863592">layoutKey</span><span class="op" id="2863601">]</span><span class="ident" id="2863602">layoutType</span><br>
<span class="lineno"></span><span class="op" id="2863613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2863616">//&nbsp;funcLayout&nbsp;computes&nbsp;a&nbsp;struct&nbsp;type&nbsp;representing&nbsp;the&nbsp;layout&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2863684">//&nbsp;function&nbsp;arguments&nbsp;and&nbsp;return&nbsp;values&nbsp;for&nbsp;the&nbsp;function&nbsp;type&nbsp;t.</span><br>
<span class="lineno">1775</span><span class="comment" id="2863749">//&nbsp;If&nbsp;rcvr&nbsp;!=&nbsp;nil,&nbsp;rcvr&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="2863809">//&nbsp;The&nbsp;returned&nbsp;type&nbsp;exists&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2863888">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2863956">//&nbsp;the&nbsp;name&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2863996">func</span>&nbsp;<span class="ident" id="2864001">funcLayout</span><span class="op" id="2864011">(</span><span class="ident" id="2864012">t</span>&nbsp;<span class="op" id="2864014">*</span><span class="ident" id="2864015">rtype</span><span class="op" id="2864020">,</span>&nbsp;<span class="ident" id="2864022">rcvr</span>&nbsp;<span class="op" id="2864027">*</span><span class="ident" id="2864028">rtype</span><span class="op" id="2864033">)</span>&nbsp;<span class="op" id="2864035">(</span><span class="ident" id="2864036">frametype</span>&nbsp;<span class="op" id="2864046">*</span><span class="ident" id="2864047">rtype</span><span class="op" id="2864052">,</span>&nbsp;<span class="ident" id="2864054">argSize</span><span class="op" id="2864061">,</span>&nbsp;<span class="ident" id="2864063">retOffset</span>&nbsp;<span class="builtintype" id="2864073">uintptr</span><span class="op" id="2864080">,</span>&nbsp;<span class="ident" id="2864082">stack</span>&nbsp;<span class="op" id="2864088">*</span><span class="ident" id="2864089">bitVector</span><span class="op" id="2864098">)</span>&nbsp;<span class="op" id="2864100">{</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2864103">if</span>&nbsp;<span class="ident" id="2864106">t</span><span class="op" id="2864107">.</span><span class="ident" id="2864108">Kind</span><span class="op" id="2864112">(</span><span class="op" id="2864113">)</span>&nbsp;<span class="op" id="2864115">!=</span>&nbsp;<span class="ident" id="2864118">Func</span>&nbsp;<span class="op" id="2864123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2864127">panic</span><span class="op" id="2864132">(</span><span class="string" id="2864133">&#34;reflect:&nbsp;funcLayout&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2864171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2864174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2864177">if</span>&nbsp;<span class="ident" id="2864180">rcvr</span>&nbsp;<span class="op" id="2864185">!=</span>&nbsp;<span class="builtintype" id="2864188">nil</span>&nbsp;<span class="op" id="2864192">&amp;&amp;</span>&nbsp;<span class="ident" id="2864195">rcvr</span><span class="op" id="2864199">.</span><span class="ident" id="2864200">Kind</span><span class="op" id="2864204">(</span><span class="op" id="2864205">)</span>&nbsp;<span class="op" id="2864207">==</span>&nbsp;<span class="ident" id="2864210">Interface</span>&nbsp;<span class="op" id="2864220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2864224">panic</span><span class="op" id="2864229">(</span><span class="string" id="2864230">&#34;reflect:&nbsp;funcLayout&nbsp;with&nbsp;interface&nbsp;receiver&nbsp;&#34;</span>&nbsp;<span class="op" id="2864277">+</span>&nbsp;<span class="ident" id="2864279">rcvr</span><span class="op" id="2864283">.</span><span class="ident" id="2864284">String</span><span class="op" id="2864290">(</span><span class="op" id="2864291">)</span><span class="op" id="2864292">)</span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2864295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2864298">k</span>&nbsp;<span class="op" id="2864300">:=</span>&nbsp;<span class="ident" id="2864303">layoutKey</span><span class="op" id="2864312">{</span><span class="ident" id="2864313">t</span><span class="op" id="2864314">,</span>&nbsp;<span class="ident" id="2864316">rcvr</span><span class="op" id="2864320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2864323">layoutCache</span><span class="op" id="2864334">.</span><span class="ident" id="2864335">RLock</span><span class="op" id="2864340">(</span><span class="op" id="2864341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2864344">if</span>&nbsp;<span class="ident" id="2864347">x</span>&nbsp;<span class="op" id="2864349">:=</span>&nbsp;<span class="ident" id="2864352">layoutCache</span><span class="op" id="2864363">.</span><span class="ident" id="2864364">m</span><span class="op" id="2864365">[</span><span class="ident" id="2864366">k</span><span class="op" id="2864367">]</span><span class="op" id="2864368">;</span>&nbsp;<span class="ident" id="2864370">x</span><span class="op" id="2864371">.</span><span class="ident" id="2864372">t</span>&nbsp;<span class="op" id="2864374">!=</span>&nbsp;<span class="builtintype" id="2864377">nil</span>&nbsp;<span class="op" id="2864381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2864385">layoutCache</span><span class="op" id="2864396">.</span><span class="ident" id="2864397">RUnlock</span><span class="op" id="2864404">(</span><span class="op" id="2864405">)</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2864409">return</span>&nbsp;<span class="ident" id="2864416">x</span><span class="op" id="2864417">.</span><span class="ident" id="2864418">t</span><span class="op" id="2864419">,</span>&nbsp;<span class="ident" id="2864421">x</span><span class="op" id="2864422">.</span><span class="ident" id="2864423">argSize</span><span class="op" id="2864430">,</span>&nbsp;<span class="ident" id="2864432">x</span><span class="op" id="2864433">.</span><span class="ident" id="2864434">retOffset</span><span class="op" id="2864443">,</span>&nbsp;<span class="ident" id="2864445">x</span><span class="op" id="2864446">.</span><span class="ident" id="2864447">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2864454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2864457">layoutCache</span><span class="op" id="2864468">.</span><span class="ident" id="2864469">RUnlock</span><span class="op" id="2864476">(</span><span class="op" id="2864477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2864480">layoutCache</span><span class="op" id="2864491">.</span><span class="ident" id="2864492">Lock</span><span class="op" id="2864496">(</span><span class="op" id="2864497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2864500">if</span>&nbsp;<span class="ident" id="2864503">x</span>&nbsp;<span class="op" id="2864505">:=</span>&nbsp;<span class="ident" id="2864508">layoutCache</span><span class="op" id="2864519">.</span><span class="ident" id="2864520">m</span><span class="op" id="2864521">[</span><span class="ident" id="2864522">k</span><span class="op" id="2864523">]</span><span class="op" id="2864524">;</span>&nbsp;<span class="ident" id="2864526">x</span><span class="op" id="2864527">.</span><span class="ident" id="2864528">t</span>&nbsp;<span class="op" id="2864530">!=</span>&nbsp;<span class="builtintype" id="2864533">nil</span>&nbsp;<span class="op" id="2864537">{</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2864541">layoutCache</span><span class="op" id="2864552">.</span><span class="ident" id="2864553">Unlock</span><span class="op" id="2864559">(</span><span class="op" id="2864560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2864564">return</span>&nbsp;<span class="ident" id="2864571">x</span><span class="op" id="2864572">.</span><span class="ident" id="2864573">t</span><span class="op" id="2864574">,</span>&nbsp;<span class="ident" id="2864576">x</span><span class="op" id="2864577">.</span><span class="ident" id="2864578">argSize</span><span class="op" id="2864585">,</span>&nbsp;<span class="ident" id="2864587">x</span><span class="op" id="2864588">.</span><span class="ident" id="2864589">retOffset</span><span class="op" id="2864598">,</span>&nbsp;<span class="ident" id="2864600">x</span><span class="op" id="2864601">.</span><span class="ident" id="2864602">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2864609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2864613">tt</span>&nbsp;<span class="op" id="2864616">:=</span>&nbsp;<span class="op" id="2864619">(</span><span class="op" id="2864620">*</span><span class="ident" id="2864621">funcType</span><span class="op" id="2864629">)</span><span class="op" id="2864630">(</span><span class="ident" id="2864631">unsafe</span><span class="op" id="2864637">.</span><span class="ident" id="2864638">Pointer</span><span class="op" id="2864645">(</span><span class="ident" id="2864646">t</span><span class="op" id="2864647">)</span><span class="op" id="2864648">)</span><br>
<span class="lineno">1800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2864652">//&nbsp;compute&nbsp;gc&nbsp;program&nbsp;&amp;&nbsp;stack&nbsp;bitmap&nbsp;for&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2864704">stack</span>&nbsp;<span class="op" id="2864710">=</span>&nbsp;<span class="builtinfunc" id="2864712">new</span><span class="op" id="2864715">(</span><span class="ident" id="2864716">bitVector</span><span class="op" id="2864725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2864728">var</span>&nbsp;<span class="ident" id="2864732">gc</span>&nbsp;<span class="ident" id="2864735">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2864743">var</span>&nbsp;<span class="ident" id="2864747">offset</span>&nbsp;<span class="builtintype" id="2864754">uintptr</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2864763">if</span>&nbsp;<span class="ident" id="2864766">rcvr</span>&nbsp;<span class="op" id="2864771">!=</span>&nbsp;<span class="builtintype" id="2864774">nil</span>&nbsp;<span class="op" id="2864778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2864782">//&nbsp;Reflect&nbsp;uses&nbsp;the&nbsp;&#34;interface&#34;&nbsp;calling&nbsp;convention&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2864839">//&nbsp;methods,&nbsp;where&nbsp;receivers&nbsp;take&nbsp;one&nbsp;word&nbsp;of&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2864895">//&nbsp;space&nbsp;no&nbsp;matter&nbsp;how&nbsp;big&nbsp;they&nbsp;actually&nbsp;are.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2864943">if</span>&nbsp;<span class="ident" id="2864946">ifaceIndir</span><span class="op" id="2864956">(</span><span class="ident" id="2864957">rcvr</span><span class="op" id="2864961">)</span>&nbsp;<span class="op" id="2864963">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2864968">//&nbsp;we&nbsp;pass&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865009">gc</span><span class="op" id="2865011">.</span><span class="builtinfunc" id="2865012">append</span><span class="op" id="2865018">(</span><span class="ident" id="2865019">bitsPointer</span><span class="op" id="2865030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865035">stack</span><span class="op" id="2865040">.</span><span class="ident" id="2865041">append2</span><span class="op" id="2865048">(</span><span class="ident" id="2865049">bitsPointer</span><span class="op" id="2865060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2865064">}</span>&nbsp;<span class="keyword" id="2865066">else</span>&nbsp;<span class="keyword" id="2865071">if</span>&nbsp;<span class="ident" id="2865074">rcvr</span><span class="op" id="2865078">.</span><span class="ident" id="2865079">pointers</span><span class="op" id="2865087">(</span><span class="op" id="2865088">)</span>&nbsp;<span class="op" id="2865090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2865095">//&nbsp;rcvr&nbsp;is&nbsp;a&nbsp;one-word&nbsp;pointer&nbsp;object.&nbsp;&nbsp;Its&nbsp;gc&nbsp;program</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2865152">//&nbsp;is&nbsp;just&nbsp;what&nbsp;we&nbsp;need&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865185">gc</span><span class="op" id="2865187">.</span><span class="builtinfunc" id="2865188">append</span><span class="op" id="2865194">(</span><span class="ident" id="2865195">bitsPointer</span><span class="op" id="2865206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865211">stack</span><span class="op" id="2865216">.</span><span class="ident" id="2865217">append2</span><span class="op" id="2865224">(</span><span class="ident" id="2865225">bitsPointer</span><span class="op" id="2865236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2865240">}</span>&nbsp;<span class="keyword" id="2865242">else</span>&nbsp;<span class="op" id="2865247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865252">gc</span><span class="op" id="2865254">.</span><span class="builtinfunc" id="2865255">append</span><span class="op" id="2865261">(</span><span class="ident" id="2865262">bitsScalar</span><span class="op" id="2865272">)</span><br>
<span class="lineno">1820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865277">stack</span><span class="op" id="2865282">.</span><span class="ident" id="2865283">append2</span><span class="op" id="2865290">(</span><span class="ident" id="2865291">bitsScalar</span><span class="op" id="2865301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2865305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865309">offset</span>&nbsp;<span class="op" id="2865316">+=</span>&nbsp;<span class="ident" id="2865319">ptrSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2865328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2865331">for</span>&nbsp;<span class="ident" id="2865335">_</span><span class="op" id="2865336">,</span>&nbsp;<span class="ident" id="2865338">arg</span>&nbsp;<span class="op" id="2865342">:=</span>&nbsp;<span class="keyword" id="2865345">range</span>&nbsp;<span class="ident" id="2865351">tt</span><span class="op" id="2865353">.</span><span class="ident" id="2865354">in</span>&nbsp;<span class="op" id="2865357">{</span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865361">gc</span><span class="op" id="2865363">.</span><span class="ident" id="2865364">appendProg</span><span class="op" id="2865374">(</span><span class="ident" id="2865375">arg</span><span class="op" id="2865378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865382">addTypeBits</span><span class="op" id="2865393">(</span><span class="ident" id="2865394">stack</span><span class="op" id="2865399">,</span>&nbsp;<span class="op" id="2865401">&amp;</span><span class="ident" id="2865402">offset</span><span class="op" id="2865408">,</span>&nbsp;<span class="ident" id="2865410">arg</span><span class="op" id="2865413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2865416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865419">argSize</span>&nbsp;<span class="op" id="2865427">=</span>&nbsp;<span class="ident" id="2865429">gc</span><span class="op" id="2865431">.</span><span class="ident" id="2865432">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2865438">if</span>&nbsp;<span class="ident" id="2865441">runtime</span><span class="op" id="2865448">.</span><span class="ident" id="2865449">GOARCH</span>&nbsp;<span class="op" id="2865456">==</span>&nbsp;<span class="string" id="2865459">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2865470">{</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865474">gc</span><span class="op" id="2865476">.</span><span class="ident" id="2865477">align</span><span class="op" id="2865482">(</span><span class="num" id="2865483">8</span><span class="op" id="2865484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2865487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865490">gc</span><span class="op" id="2865492">.</span><span class="ident" id="2865493">align</span><span class="op" id="2865498">(</span><span class="ident" id="2865499">ptrSize</span><span class="op" id="2865506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865509">retOffset</span>&nbsp;<span class="op" id="2865519">=</span>&nbsp;<span class="ident" id="2865521">gc</span><span class="op" id="2865523">.</span><span class="ident" id="2865524">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2865530">for</span>&nbsp;<span class="ident" id="2865534">_</span><span class="op" id="2865535">,</span>&nbsp;<span class="ident" id="2865537">res</span>&nbsp;<span class="op" id="2865541">:=</span>&nbsp;<span class="keyword" id="2865544">range</span>&nbsp;<span class="ident" id="2865550">tt</span><span class="op" id="2865552">.</span><span class="ident" id="2865553">out</span>&nbsp;<span class="op" id="2865557">{</span><br>
<span class="lineno">1835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865561">gc</span><span class="op" id="2865563">.</span><span class="ident" id="2865564">appendProg</span><span class="op" id="2865574">(</span><span class="ident" id="2865575">res</span><span class="op" id="2865578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2865582">//&nbsp;stack&nbsp;map&nbsp;does&nbsp;not&nbsp;need&nbsp;result&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2865622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865625">gc</span><span class="op" id="2865627">.</span><span class="ident" id="2865628">align</span><span class="op" id="2865633">(</span><span class="ident" id="2865634">ptrSize</span><span class="op" id="2865641">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2865645">//&nbsp;build&nbsp;dummy&nbsp;rtype&nbsp;holding&nbsp;gc&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865686">x</span>&nbsp;<span class="op" id="2865688">:=</span>&nbsp;<span class="builtinfunc" id="2865691">new</span><span class="op" id="2865694">(</span><span class="ident" id="2865695">rtype</span><span class="op" id="2865700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865703">x</span><span class="op" id="2865704">.</span><span class="ident" id="2865705">size</span>&nbsp;<span class="op" id="2865710">=</span>&nbsp;<span class="ident" id="2865712">gc</span><span class="op" id="2865714">.</span><span class="ident" id="2865715">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865721">x</span><span class="op" id="2865722">.</span><span class="ident" id="2865723">gc</span><span class="op" id="2865725">[</span><span class="num" id="2865726">0</span><span class="op" id="2865727">]</span>&nbsp;<span class="op" id="2865729">=</span>&nbsp;<span class="ident" id="2865731">gc</span><span class="op" id="2865733">.</span><span class="ident" id="2865734">finalize</span><span class="op" id="2865742">(</span><span class="op" id="2865743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2865746">var</span>&nbsp;<span class="ident" id="2865750">s</span>&nbsp;<span class="builtintype" id="2865752">string</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2865760">if</span>&nbsp;<span class="ident" id="2865763">rcvr</span>&nbsp;<span class="op" id="2865768">!=</span>&nbsp;<span class="builtintype" id="2865771">nil</span>&nbsp;<span class="op" id="2865775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865779">s</span>&nbsp;<span class="op" id="2865781">=</span>&nbsp;<span class="string" id="2865783">&#34;methodargs(&#34;</span>&nbsp;<span class="op" id="2865797">+</span>&nbsp;<span class="op" id="2865799">*</span><span class="ident" id="2865800">rcvr</span><span class="op" id="2865804">.</span><span class="builtintype" id="2865805">string</span>&nbsp;<span class="op" id="2865812">+</span>&nbsp;<span class="string" id="2865814">&#34;)(&#34;</span>&nbsp;<span class="op" id="2865819">+</span>&nbsp;<span class="op" id="2865821">*</span><span class="ident" id="2865822">t</span><span class="op" id="2865823">.</span><span class="builtintype" id="2865824">string</span>&nbsp;<span class="op" id="2865831">+</span>&nbsp;<span class="string" id="2865833">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2865838">}</span>&nbsp;<span class="keyword" id="2865840">else</span>&nbsp;<span class="op" id="2865845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865849">s</span>&nbsp;<span class="op" id="2865851">=</span>&nbsp;<span class="string" id="2865853">&#34;funcargs(&#34;</span>&nbsp;<span class="op" id="2865865">+</span>&nbsp;<span class="op" id="2865867">*</span><span class="ident" id="2865868">t</span><span class="op" id="2865869">.</span><span class="builtintype" id="2865870">string</span>&nbsp;<span class="op" id="2865877">+</span>&nbsp;<span class="string" id="2865879">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2865884">}</span><br>
<span class="lineno">1850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865887">x</span><span class="op" id="2865888">.</span><span class="builtintype" id="2865889">string</span>&nbsp;<span class="op" id="2865896">=</span>&nbsp;<span class="op" id="2865898">&amp;</span><span class="ident" id="2865899">s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2865903">//&nbsp;cache&nbsp;result&nbsp;for&nbsp;future&nbsp;callers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2865939">if</span>&nbsp;<span class="ident" id="2865942">layoutCache</span><span class="op" id="2865953">.</span><span class="ident" id="2865954">m</span>&nbsp;<span class="op" id="2865956">==</span>&nbsp;<span class="builtintype" id="2865959">nil</span>&nbsp;<span class="op" id="2865963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2865967">layoutCache</span><span class="op" id="2865978">.</span><span class="ident" id="2865979">m</span>&nbsp;<span class="op" id="2865981">=</span>&nbsp;<span class="builtinfunc" id="2865983">make</span><span class="op" id="2865987">(</span><span class="keyword" id="2865988">map</span><span class="op" id="2865991">[</span><span class="ident" id="2865992">layoutKey</span><span class="op" id="2866001">]</span><span class="ident" id="2866002">layoutType</span><span class="op" id="2866012">)</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2866015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2866018">layoutCache</span><span class="op" id="2866029">.</span><span class="ident" id="2866030">m</span><span class="op" id="2866031">[</span><span class="ident" id="2866032">k</span><span class="op" id="2866033">]</span>&nbsp;<span class="op" id="2866035">=</span>&nbsp;<span class="ident" id="2866037">layoutType</span><span class="op" id="2866047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2866051">t</span><span class="op" id="2866052">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2866062">x</span><span class="op" id="2866063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2866067">argSize</span><span class="op" id="2866074">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2866078">argSize</span><span class="op" id="2866085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2866089">retOffset</span><span class="op" id="2866098">:</span>&nbsp;<span class="ident" id="2866100">retOffset</span><span class="op" id="2866109">,</span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2866113">stack</span><span class="op" id="2866118">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2866124">stack</span><span class="op" id="2866129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2866132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2866135">layoutCache</span><span class="op" id="2866146">.</span><span class="ident" id="2866147">Unlock</span><span class="op" id="2866153">(</span><span class="op" id="2866154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2866157">return</span>&nbsp;<span class="ident" id="2866164">x</span><span class="op" id="2866165">,</span>&nbsp;<span class="ident" id="2866167">argSize</span><span class="op" id="2866174">,</span>&nbsp;<span class="ident" id="2866176">retOffset</span><span class="op" id="2866185">,</span>&nbsp;<span class="ident" id="2866187">stack</span><br>
<span class="lineno"></span><span class="op" id="2866193">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span><span class="comment" id="2866196">//&nbsp;ifaceIndir&nbsp;reports&nbsp;whether&nbsp;t&nbsp;is&nbsp;stored&nbsp;indirectly&nbsp;in&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="2866272">func</span>&nbsp;<span class="ident" id="2866277">ifaceIndir</span><span class="op" id="2866287">(</span><span class="ident" id="2866288">t</span>&nbsp;<span class="op" id="2866290">*</span><span class="ident" id="2866291">rtype</span><span class="op" id="2866296">)</span>&nbsp;<span class="builtintype" id="2866298">bool</span>&nbsp;<span class="op" id="2866303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2866306">return</span>&nbsp;<span class="ident" id="2866313">t</span><span class="op" id="2866314">.</span><span class="ident" id="2866315">kind</span><span class="op" id="2866319">&amp;</span><span class="ident" id="2866320">kindDirectIface</span>&nbsp;<span class="op" id="2866336">==</span>&nbsp;<span class="num" id="2866339">0</span><br>
<span class="lineno"></span><span class="op" id="2866341">}</span><br>
<span class="lineno">1870</span><br>
<span class="lineno"></span><span class="comment" id="2866344">//&nbsp;Layout&nbsp;matches&nbsp;runtime.BitVector&nbsp;(well&nbsp;enough).</span><br>
<span class="lineno"></span><span class="keyword" id="2866395">type</span>&nbsp;<span class="ident" id="2866400">bitVector</span>&nbsp;<span class="keyword" id="2866410">struct</span>&nbsp;<span class="op" id="2866417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2866420">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2866425">uint32</span>&nbsp;<span class="comment" id="2866432">//&nbsp;number&nbsp;of&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2866451">data</span>&nbsp;<span class="op" id="2866456">[</span><span class="op" id="2866457">]</span><span class="builtintype" id="2866458">byte</span><br>
<span class="lineno">1875</span><span class="op" id="2866463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2866466">//&nbsp;append&nbsp;a&nbsp;bit&nbsp;pair&nbsp;to&nbsp;the&nbsp;bitmap.</span><br>
<span class="lineno"></span><span class="keyword" id="2866502">func</span>&nbsp;<span class="op" id="2866507">(</span><span class="ident" id="2866508">bv</span>&nbsp;<span class="op" id="2866511">*</span><span class="ident" id="2866512">bitVector</span><span class="op" id="2866521">)</span>&nbsp;<span class="ident" id="2866523">append2</span><span class="op" id="2866530">(</span><span class="ident" id="2866531">bits</span>&nbsp;<span class="builtintype" id="2866536">uint8</span><span class="op" id="2866541">)</span>&nbsp;<span class="op" id="2866543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2866546">//&nbsp;assume&nbsp;bv.n&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;2,&nbsp;since&nbsp;append2&nbsp;is&nbsp;the&nbsp;only&nbsp;operation.</span><br>
<span class="lineno">1880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2866619">if</span>&nbsp;<span class="ident" id="2866622">bv</span><span class="op" id="2866624">.</span><span class="ident" id="2866625">n</span><span class="op" id="2866626">%</span><span class="num" id="2866627">8</span>&nbsp;<span class="op" id="2866629">==</span>&nbsp;<span class="num" id="2866632">0</span>&nbsp;<span class="op" id="2866634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2866638">bv</span><span class="op" id="2866640">.</span><span class="ident" id="2866641">data</span>&nbsp;<span class="op" id="2866646">=</span>&nbsp;<span class="builtinfunc" id="2866648">append</span><span class="op" id="2866654">(</span><span class="ident" id="2866655">bv</span><span class="op" id="2866657">.</span><span class="ident" id="2866658">data</span><span class="op" id="2866662">,</span>&nbsp;<span class="num" id="2866664">0</span><span class="op" id="2866665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2866668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2866671">bv</span><span class="op" id="2866673">.</span><span class="ident" id="2866674">data</span><span class="op" id="2866678">[</span><span class="ident" id="2866679">bv</span><span class="op" id="2866681">.</span><span class="ident" id="2866682">n</span><span class="op" id="2866683">/</span><span class="num" id="2866684">8</span><span class="op" id="2866685">]</span>&nbsp;<span class="op" id="2866687">|=</span>&nbsp;<span class="ident" id="2866690">bits</span>&nbsp;<span class="op" id="2866695">&lt;&lt;</span>&nbsp;<span class="op" id="2866698">(</span><span class="ident" id="2866699">bv</span><span class="op" id="2866701">.</span><span class="ident" id="2866702">n</span>&nbsp;<span class="op" id="2866704">%</span>&nbsp;<span class="num" id="2866706">8</span><span class="op" id="2866707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2866710">bv</span><span class="op" id="2866712">.</span><span class="ident" id="2866713">n</span>&nbsp;<span class="op" id="2866715">+=</span>&nbsp;<span class="num" id="2866718">2</span><br>
<span class="lineno">1885</span><span class="op" id="2866720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2866723">func</span>&nbsp;<span class="ident" id="2866728">addTypeBits</span><span class="op" id="2866739">(</span><span class="ident" id="2866740">bv</span>&nbsp;<span class="op" id="2866743">*</span><span class="ident" id="2866744">bitVector</span><span class="op" id="2866753">,</span>&nbsp;<span class="ident" id="2866755">offset</span>&nbsp;<span class="op" id="2866762">*</span><span class="builtintype" id="2866763">uintptr</span><span class="op" id="2866770">,</span>&nbsp;<span class="ident" id="2866772">t</span>&nbsp;<span class="op" id="2866774">*</span><span class="ident" id="2866775">rtype</span><span class="op" id="2866780">)</span>&nbsp;<span class="op" id="2866782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2866785">*</span><span class="ident" id="2866786">offset</span>&nbsp;<span class="op" id="2866793">=</span>&nbsp;<span class="ident" id="2866795">align</span><span class="op" id="2866800">(</span><span class="op" id="2866801">*</span><span class="ident" id="2866802">offset</span><span class="op" id="2866808">,</span>&nbsp;<span class="builtintype" id="2866810">uintptr</span><span class="op" id="2866817">(</span><span class="ident" id="2866818">t</span><span class="op" id="2866819">.</span><span class="ident" id="2866820">align</span><span class="op" id="2866825">)</span><span class="op" id="2866826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2866829">if</span>&nbsp;<span class="ident" id="2866832">t</span><span class="op" id="2866833">.</span><span class="ident" id="2866834">kind</span><span class="op" id="2866838">&amp;</span><span class="ident" id="2866839">kindNoPointers</span>&nbsp;<span class="op" id="2866854">!=</span>&nbsp;<span class="num" id="2866857">0</span>&nbsp;<span class="op" id="2866859">{</span><br>
<span class="lineno">1890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2866863">*</span><span class="ident" id="2866864">offset</span>&nbsp;<span class="op" id="2866871">+=</span>&nbsp;<span class="ident" id="2866874">t</span><span class="op" id="2866875">.</span><span class="ident" id="2866876">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2866883">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2866891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2866895">switch</span>&nbsp;<span class="ident" id="2866902">Kind</span><span class="op" id="2866906">(</span><span class="ident" id="2866907">t</span><span class="op" id="2866908">.</span><span class="ident" id="2866909">kind</span>&nbsp;<span class="op" id="2866914">&amp;</span>&nbsp;<span class="ident" id="2866916">kindMask</span><span class="op" id="2866924">)</span>&nbsp;<span class="op" id="2866926">{</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2866929">case</span>&nbsp;<span class="ident" id="2866934">Chan</span><span class="op" id="2866938">,</span>&nbsp;<span class="ident" id="2866940">Func</span><span class="op" id="2866944">,</span>&nbsp;<span class="ident" id="2866946">Map</span><span class="op" id="2866949">,</span>&nbsp;<span class="ident" id="2866951">Ptr</span><span class="op" id="2866954">,</span>&nbsp;<span class="ident" id="2866956">Slice</span><span class="op" id="2866961">,</span>&nbsp;<span class="ident" id="2866963">String</span><span class="op" id="2866969">,</span>&nbsp;<span class="ident" id="2866971">UnsafePointer</span><span class="op" id="2866984">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2866988">//&nbsp;1&nbsp;pointer&nbsp;at&nbsp;start&nbsp;of&nbsp;representation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2867030">for</span>&nbsp;<span class="ident" id="2867034">bv</span><span class="op" id="2867036">.</span><span class="ident" id="2867037">n</span>&nbsp;<span class="op" id="2867039">&lt;</span>&nbsp;<span class="num" id="2867041">2</span><span class="op" id="2867042">*</span><span class="builtintype" id="2867043">uint32</span><span class="op" id="2867049">(</span><span class="op" id="2867050">*</span><span class="ident" id="2867051">offset</span><span class="op" id="2867057">/</span><span class="builtintype" id="2867058">uintptr</span><span class="op" id="2867065">(</span><span class="ident" id="2867066">ptrSize</span><span class="op" id="2867073">)</span><span class="op" id="2867074">)</span>&nbsp;<span class="op" id="2867076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2867081">bv</span><span class="op" id="2867083">.</span><span class="ident" id="2867084">append2</span><span class="op" id="2867091">(</span><span class="ident" id="2867092">bitsScalar</span><span class="op" id="2867102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2867106">}</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2867110">bv</span><span class="op" id="2867112">.</span><span class="ident" id="2867113">append2</span><span class="op" id="2867120">(</span><span class="ident" id="2867121">bitsPointer</span><span class="op" id="2867132">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2867136">case</span>&nbsp;<span class="ident" id="2867141">Interface</span><span class="op" id="2867150">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2867154">//&nbsp;2&nbsp;pointers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2867170">for</span>&nbsp;<span class="ident" id="2867174">bv</span><span class="op" id="2867176">.</span><span class="ident" id="2867177">n</span>&nbsp;<span class="op" id="2867179">&lt;</span>&nbsp;<span class="num" id="2867181">2</span><span class="op" id="2867182">*</span><span class="builtintype" id="2867183">uint32</span><span class="op" id="2867189">(</span><span class="op" id="2867190">*</span><span class="ident" id="2867191">offset</span><span class="op" id="2867197">/</span><span class="builtintype" id="2867198">uintptr</span><span class="op" id="2867205">(</span><span class="ident" id="2867206">ptrSize</span><span class="op" id="2867213">)</span><span class="op" id="2867214">)</span>&nbsp;<span class="op" id="2867216">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2867221">bv</span><span class="op" id="2867223">.</span><span class="ident" id="2867224">append2</span><span class="op" id="2867231">(</span><span class="ident" id="2867232">bitsScalar</span><span class="op" id="2867242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2867246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2867250">bv</span><span class="op" id="2867252">.</span><span class="ident" id="2867253">append2</span><span class="op" id="2867260">(</span><span class="ident" id="2867261">bitsPointer</span><span class="op" id="2867272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2867276">bv</span><span class="op" id="2867278">.</span><span class="ident" id="2867279">append2</span><span class="op" id="2867286">(</span><span class="ident" id="2867287">bitsPointer</span><span class="op" id="2867298">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2867302">case</span>&nbsp;<span class="ident" id="2867307">Array</span><span class="op" id="2867312">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2867316">//&nbsp;repeat&nbsp;inner&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2867339">tt</span>&nbsp;<span class="op" id="2867342">:=</span>&nbsp;<span class="op" id="2867345">(</span><span class="op" id="2867346">*</span><span class="ident" id="2867347">arrayType</span><span class="op" id="2867356">)</span><span class="op" id="2867357">(</span><span class="ident" id="2867358">unsafe</span><span class="op" id="2867364">.</span><span class="ident" id="2867365">Pointer</span><span class="op" id="2867372">(</span><span class="ident" id="2867373">t</span><span class="op" id="2867374">)</span><span class="op" id="2867375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2867379">for</span>&nbsp;<span class="ident" id="2867383">i</span>&nbsp;<span class="op" id="2867385">:=</span>&nbsp;<span class="num" id="2867388">0</span><span class="op" id="2867389">;</span>&nbsp;<span class="ident" id="2867391">i</span>&nbsp;<span class="op" id="2867393">&lt;</span>&nbsp;<span class="builtintype" id="2867395">int</span><span class="op" id="2867398">(</span><span class="ident" id="2867399">tt</span><span class="op" id="2867401">.</span><span class="builtinfunc" id="2867402">len</span><span class="op" id="2867405">)</span><span class="op" id="2867406">;</span>&nbsp;<span class="ident" id="2867408">i</span><span class="op" id="2867409">++</span>&nbsp;<span class="op" id="2867412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2867417">addTypeBits</span><span class="op" id="2867428">(</span><span class="ident" id="2867429">bv</span><span class="op" id="2867431">,</span>&nbsp;<span class="ident" id="2867433">offset</span><span class="op" id="2867439">,</span>&nbsp;<span class="ident" id="2867441">tt</span><span class="op" id="2867443">.</span><span class="ident" id="2867444">elem</span><span class="op" id="2867448">)</span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2867452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2867456">case</span>&nbsp;<span class="ident" id="2867461">Struct</span><span class="op" id="2867467">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2867471">//&nbsp;apply&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2867489">tt</span>&nbsp;<span class="op" id="2867492">:=</span>&nbsp;<span class="op" id="2867495">(</span><span class="op" id="2867496">*</span><span class="ident" id="2867497">structType</span><span class="op" id="2867507">)</span><span class="op" id="2867508">(</span><span class="ident" id="2867509">unsafe</span><span class="op" id="2867515">.</span><span class="ident" id="2867516">Pointer</span><span class="op" id="2867523">(</span><span class="ident" id="2867524">t</span><span class="op" id="2867525">)</span><span class="op" id="2867526">)</span><br>
<span class="lineno">1920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2867530">start</span>&nbsp;<span class="op" id="2867536">:=</span>&nbsp;<span class="op" id="2867539">*</span><span class="ident" id="2867540">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2867549">for</span>&nbsp;<span class="ident" id="2867553">i</span>&nbsp;<span class="op" id="2867555">:=</span>&nbsp;<span class="keyword" id="2867558">range</span>&nbsp;<span class="ident" id="2867564">tt</span><span class="op" id="2867566">.</span><span class="ident" id="2867567">fields</span>&nbsp;<span class="op" id="2867574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2867579">f</span>&nbsp;<span class="op" id="2867581">:=</span>&nbsp;<span class="op" id="2867584">&amp;</span><span class="ident" id="2867585">tt</span><span class="op" id="2867587">.</span><span class="ident" id="2867588">fields</span><span class="op" id="2867594">[</span><span class="ident" id="2867595">i</span><span class="op" id="2867596">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2867601">off</span>&nbsp;<span class="op" id="2867605">:=</span>&nbsp;<span class="ident" id="2867608">start</span>&nbsp;<span class="op" id="2867614">+</span>&nbsp;<span class="ident" id="2867616">f</span><span class="op" id="2867617">.</span><span class="ident" id="2867618">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2867628">addTypeBits</span><span class="op" id="2867639">(</span><span class="ident" id="2867640">bv</span><span class="op" id="2867642">,</span>&nbsp;<span class="op" id="2867644">&amp;</span><span class="ident" id="2867645">off</span><span class="op" id="2867648">,</span>&nbsp;<span class="ident" id="2867650">f</span><span class="op" id="2867651">.</span><span class="ident" id="2867652">typ</span><span class="op" id="2867655">)</span><br>
<span class="lineno">1925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2867659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2867662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2867666">*</span><span class="ident" id="2867667">offset</span>&nbsp;<span class="op" id="2867674">+=</span>&nbsp;<span class="ident" id="2867677">t</span><span class="op" id="2867678">.</span><span class="ident" id="2867679">size</span><br>
<span class="lineno"></span><span class="op" id="2867684">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
