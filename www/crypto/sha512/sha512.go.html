<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4268900">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4268955">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4269009">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4269060">//&nbsp;Package&nbsp;sha512&nbsp;implements&nbsp;the&nbsp;SHA384&nbsp;and&nbsp;SHA512&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4269138">//&nbsp;in&nbsp;FIPS&nbsp;180-2.</span><br>
<span class="lineno"></span><span class="keyword" id="4269156">package</span>&nbsp;<span class="ident" id="4269164">sha512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4269172">import</span>&nbsp;<span class="op" id="4269179">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4269182">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4269192">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4269199">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4269202">func</span>&nbsp;<span class="ident" id="4269207">init</span><span class="op" id="4269211">(</span><span class="op" id="4269212">)</span>&nbsp;<span class="op" id="4269214">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269217">crypto</span><span class="op" id="4269223">.</span><span class="ident" id="4269224">RegisterHash</span><span class="op" id="4269236">(</span><span class="ident" id="4269237">crypto</span><span class="op" id="4269243">.</span><span class="ident" id="4269244">SHA384</span><span class="op" id="4269250">,</span>&nbsp;<span class="ident" id="4269252">New384</span><span class="op" id="4269258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269261">crypto</span><span class="op" id="4269267">.</span><span class="ident" id="4269268">RegisterHash</span><span class="op" id="4269280">(</span><span class="ident" id="4269281">crypto</span><span class="op" id="4269287">.</span><span class="ident" id="4269288">SHA512</span><span class="op" id="4269294">,</span>&nbsp;<span class="ident" id="4269296">New</span><span class="op" id="4269299">)</span><br>
<span class="lineno"></span><span class="op" id="4269301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4269304">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA512&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4269347">const</span>&nbsp;<span class="ident" id="4269353">Size</span>&nbsp;<span class="op" id="4269358">=</span>&nbsp;<span class="num" id="4269360">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4269364">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA384&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4269407">const</span>&nbsp;<span class="ident" id="4269413">Size384</span>&nbsp;<span class="op" id="4269421">=</span>&nbsp;<span class="num" id="4269423">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4269427">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA512&nbsp;and&nbsp;SHA384&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4269475">const</span>&nbsp;<span class="ident" id="4269481">BlockSize</span>&nbsp;<span class="op" id="4269491">=</span>&nbsp;<span class="num" id="4269493">128</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4269498">const</span>&nbsp;<span class="op" id="4269504">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269507">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4269517">=</span>&nbsp;<span class="num" id="4269519">128</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269524">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4269534">=</span>&nbsp;<span class="num" id="4269536">0x6a09e667f3bcc908</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269556">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4269566">=</span>&nbsp;<span class="num" id="4269568">0xbb67ae8584caa73b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269588">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4269598">=</span>&nbsp;<span class="num" id="4269600">0x3c6ef372fe94f82b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269620">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4269630">=</span>&nbsp;<span class="num" id="4269632">0xa54ff53a5f1d36f1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269652">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4269662">=</span>&nbsp;<span class="num" id="4269664">0x510e527fade682d1</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269684">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4269694">=</span>&nbsp;<span class="num" id="4269696">0x9b05688c2b3e6c1f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269716">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4269726">=</span>&nbsp;<span class="num" id="4269728">0x1f83d9abfb41bd6b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269748">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4269758">=</span>&nbsp;<span class="num" id="4269760">0x5be0cd19137e2179</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269780">init0_384</span>&nbsp;<span class="op" id="4269790">=</span>&nbsp;<span class="num" id="4269792">0xcbbb9d5dc1059ed8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269812">init1_384</span>&nbsp;<span class="op" id="4269822">=</span>&nbsp;<span class="num" id="4269824">0x629a292a367cd507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269844">init2_384</span>&nbsp;<span class="op" id="4269854">=</span>&nbsp;<span class="num" id="4269856">0x9159015a3070dd17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269876">init3_384</span>&nbsp;<span class="op" id="4269886">=</span>&nbsp;<span class="num" id="4269888">0x152fecd8f70e5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269908">init4_384</span>&nbsp;<span class="op" id="4269918">=</span>&nbsp;<span class="num" id="4269920">0x67332667ffc00b31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269940">init5_384</span>&nbsp;<span class="op" id="4269950">=</span>&nbsp;<span class="num" id="4269952">0x8eb44a8768581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269972">init6_384</span>&nbsp;<span class="op" id="4269982">=</span>&nbsp;<span class="num" id="4269984">0xdb0c2e0d64f98fa7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270004">init7_384</span>&nbsp;<span class="op" id="4270014">=</span>&nbsp;<span class="num" id="4270016">0x47b5481dbefa4fa4</span><br>
<span class="lineno"></span><span class="op" id="4270035">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4270038">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4270097">type</span>&nbsp;<span class="ident" id="4270102">digest</span>&nbsp;<span class="keyword" id="4270109">struct</span>&nbsp;<span class="op" id="4270116">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270119">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4270125">[</span><span class="num" id="4270126">8</span><span class="op" id="4270127">]</span><span class="ident" id="4270128">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270136">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4270142">[</span><span class="ident" id="4270143">chunk</span><span class="op" id="4270148">]</span><span class="builtintype" id="4270149">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270155">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4270161">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4270166">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4270172">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270180">is384</span>&nbsp;<span class="builtintype" id="4270186">bool</span>&nbsp;<span class="comment" id="4270191">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-384</span><br>
<span class="lineno">55</span><span class="op" id="4270225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4270228">func</span>&nbsp;<span class="op" id="4270233">(</span><span class="ident" id="4270234">d</span>&nbsp;<span class="op" id="4270236">*</span><span class="ident" id="4270237">digest</span><span class="op" id="4270243">)</span>&nbsp;<span class="ident" id="4270245">Reset</span><span class="op" id="4270250">(</span><span class="op" id="4270251">)</span>&nbsp;<span class="op" id="4270253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270256">if</span>&nbsp;<span class="op" id="4270259">!</span><span class="ident" id="4270260">d</span><span class="op" id="4270261">.</span><span class="ident" id="4270262">is384</span>&nbsp;<span class="op" id="4270268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270272">d</span><span class="op" id="4270273">.</span><span class="ident" id="4270274">h</span><span class="op" id="4270275">[</span><span class="num" id="4270276">0</span><span class="op" id="4270277">]</span>&nbsp;<span class="op" id="4270279">=</span>&nbsp;<span class="ident" id="4270281">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270289">d</span><span class="op" id="4270290">.</span><span class="ident" id="4270291">h</span><span class="op" id="4270292">[</span><span class="num" id="4270293">1</span><span class="op" id="4270294">]</span>&nbsp;<span class="op" id="4270296">=</span>&nbsp;<span class="ident" id="4270298">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270306">d</span><span class="op" id="4270307">.</span><span class="ident" id="4270308">h</span><span class="op" id="4270309">[</span><span class="num" id="4270310">2</span><span class="op" id="4270311">]</span>&nbsp;<span class="op" id="4270313">=</span>&nbsp;<span class="ident" id="4270315">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270323">d</span><span class="op" id="4270324">.</span><span class="ident" id="4270325">h</span><span class="op" id="4270326">[</span><span class="num" id="4270327">3</span><span class="op" id="4270328">]</span>&nbsp;<span class="op" id="4270330">=</span>&nbsp;<span class="ident" id="4270332">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270340">d</span><span class="op" id="4270341">.</span><span class="ident" id="4270342">h</span><span class="op" id="4270343">[</span><span class="num" id="4270344">4</span><span class="op" id="4270345">]</span>&nbsp;<span class="op" id="4270347">=</span>&nbsp;<span class="ident" id="4270349">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270357">d</span><span class="op" id="4270358">.</span><span class="ident" id="4270359">h</span><span class="op" id="4270360">[</span><span class="num" id="4270361">5</span><span class="op" id="4270362">]</span>&nbsp;<span class="op" id="4270364">=</span>&nbsp;<span class="ident" id="4270366">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270374">d</span><span class="op" id="4270375">.</span><span class="ident" id="4270376">h</span><span class="op" id="4270377">[</span><span class="num" id="4270378">6</span><span class="op" id="4270379">]</span>&nbsp;<span class="op" id="4270381">=</span>&nbsp;<span class="ident" id="4270383">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270391">d</span><span class="op" id="4270392">.</span><span class="ident" id="4270393">h</span><span class="op" id="4270394">[</span><span class="num" id="4270395">7</span><span class="op" id="4270396">]</span>&nbsp;<span class="op" id="4270398">=</span>&nbsp;<span class="ident" id="4270400">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4270407">}</span>&nbsp;<span class="keyword" id="4270409">else</span>&nbsp;<span class="op" id="4270414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270418">d</span><span class="op" id="4270419">.</span><span class="ident" id="4270420">h</span><span class="op" id="4270421">[</span><span class="num" id="4270422">0</span><span class="op" id="4270423">]</span>&nbsp;<span class="op" id="4270425">=</span>&nbsp;<span class="ident" id="4270427">init0_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270439">d</span><span class="op" id="4270440">.</span><span class="ident" id="4270441">h</span><span class="op" id="4270442">[</span><span class="num" id="4270443">1</span><span class="op" id="4270444">]</span>&nbsp;<span class="op" id="4270446">=</span>&nbsp;<span class="ident" id="4270448">init1_384</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270460">d</span><span class="op" id="4270461">.</span><span class="ident" id="4270462">h</span><span class="op" id="4270463">[</span><span class="num" id="4270464">2</span><span class="op" id="4270465">]</span>&nbsp;<span class="op" id="4270467">=</span>&nbsp;<span class="ident" id="4270469">init2_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270481">d</span><span class="op" id="4270482">.</span><span class="ident" id="4270483">h</span><span class="op" id="4270484">[</span><span class="num" id="4270485">3</span><span class="op" id="4270486">]</span>&nbsp;<span class="op" id="4270488">=</span>&nbsp;<span class="ident" id="4270490">init3_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270502">d</span><span class="op" id="4270503">.</span><span class="ident" id="4270504">h</span><span class="op" id="4270505">[</span><span class="num" id="4270506">4</span><span class="op" id="4270507">]</span>&nbsp;<span class="op" id="4270509">=</span>&nbsp;<span class="ident" id="4270511">init4_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270523">d</span><span class="op" id="4270524">.</span><span class="ident" id="4270525">h</span><span class="op" id="4270526">[</span><span class="num" id="4270527">5</span><span class="op" id="4270528">]</span>&nbsp;<span class="op" id="4270530">=</span>&nbsp;<span class="ident" id="4270532">init5_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270544">d</span><span class="op" id="4270545">.</span><span class="ident" id="4270546">h</span><span class="op" id="4270547">[</span><span class="num" id="4270548">6</span><span class="op" id="4270549">]</span>&nbsp;<span class="op" id="4270551">=</span>&nbsp;<span class="ident" id="4270553">init6_384</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270565">d</span><span class="op" id="4270566">.</span><span class="ident" id="4270567">h</span><span class="op" id="4270568">[</span><span class="num" id="4270569">7</span><span class="op" id="4270570">]</span>&nbsp;<span class="op" id="4270572">=</span>&nbsp;<span class="ident" id="4270574">init7_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4270585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270588">d</span><span class="op" id="4270589">.</span><span class="ident" id="4270590">nx</span>&nbsp;<span class="op" id="4270593">=</span>&nbsp;<span class="num" id="4270595">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270598">d</span><span class="op" id="4270599">.</span><span class="builtinfunc" id="4270600">len</span>&nbsp;<span class="op" id="4270604">=</span>&nbsp;<span class="num" id="4270606">0</span><br>
<span class="lineno"></span><span class="op" id="4270608">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4270611">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA512&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4270673">func</span>&nbsp;<span class="ident" id="4270678">New</span><span class="op" id="4270681">(</span><span class="op" id="4270682">)</span>&nbsp;<span class="ident" id="4270684">hash</span><span class="op" id="4270688">.</span><span class="ident" id="4270689">Hash</span>&nbsp;<span class="op" id="4270694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270697">d</span>&nbsp;<span class="op" id="4270699">:=</span>&nbsp;<span class="builtinfunc" id="4270702">new</span><span class="op" id="4270705">(</span><span class="ident" id="4270706">digest</span><span class="op" id="4270712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270715">d</span><span class="op" id="4270716">.</span><span class="ident" id="4270717">Reset</span><span class="op" id="4270722">(</span><span class="op" id="4270723">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270726">return</span>&nbsp;<span class="ident" id="4270733">d</span><br>
<span class="lineno"></span><span class="op" id="4270735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4270738">//&nbsp;New384&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA384&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4270803">func</span>&nbsp;<span class="ident" id="4270808">New384</span><span class="op" id="4270814">(</span><span class="op" id="4270815">)</span>&nbsp;<span class="ident" id="4270817">hash</span><span class="op" id="4270821">.</span><span class="ident" id="4270822">Hash</span>&nbsp;<span class="op" id="4270827">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270830">d</span>&nbsp;<span class="op" id="4270832">:=</span>&nbsp;<span class="builtinfunc" id="4270835">new</span><span class="op" id="4270838">(</span><span class="ident" id="4270839">digest</span><span class="op" id="4270845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270848">d</span><span class="op" id="4270849">.</span><span class="ident" id="4270850">is384</span>&nbsp;<span class="op" id="4270856">=</span>&nbsp;<span class="ident" id="4270858">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270864">d</span><span class="op" id="4270865">.</span><span class="ident" id="4270866">Reset</span><span class="op" id="4270871">(</span><span class="op" id="4270872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270875">return</span>&nbsp;<span class="ident" id="4270882">d</span><br>
<span class="lineno"></span><span class="op" id="4270884">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4270887">func</span>&nbsp;<span class="op" id="4270892">(</span><span class="ident" id="4270893">d</span>&nbsp;<span class="op" id="4270895">*</span><span class="ident" id="4270896">digest</span><span class="op" id="4270902">)</span>&nbsp;<span class="ident" id="4270904">Size</span><span class="op" id="4270908">(</span><span class="op" id="4270909">)</span>&nbsp;<span class="builtintype" id="4270911">int</span>&nbsp;<span class="op" id="4270915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270918">if</span>&nbsp;<span class="op" id="4270921">!</span><span class="ident" id="4270922">d</span><span class="op" id="4270923">.</span><span class="ident" id="4270924">is384</span>&nbsp;<span class="op" id="4270930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270934">return</span>&nbsp;<span class="ident" id="4270941">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4270947">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270950">return</span>&nbsp;<span class="ident" id="4270957">Size384</span><br>
<span class="lineno"></span><span class="op" id="4270965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4270968">func</span>&nbsp;<span class="op" id="4270973">(</span><span class="ident" id="4270974">d</span>&nbsp;<span class="op" id="4270976">*</span><span class="ident" id="4270977">digest</span><span class="op" id="4270983">)</span>&nbsp;<span class="ident" id="4270985">BlockSize</span><span class="op" id="4270994">(</span><span class="op" id="4270995">)</span>&nbsp;<span class="builtintype" id="4270997">int</span>&nbsp;<span class="op" id="4271001">{</span>&nbsp;<span class="keyword" id="4271003">return</span>&nbsp;<span class="ident" id="4271010">BlockSize</span>&nbsp;<span class="op" id="4271020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4271023">func</span>&nbsp;<span class="op" id="4271028">(</span><span class="ident" id="4271029">d</span>&nbsp;<span class="op" id="4271031">*</span><span class="ident" id="4271032">digest</span><span class="op" id="4271038">)</span>&nbsp;<span class="ident" id="4271040">Write</span><span class="op" id="4271045">(</span><span class="ident" id="4271046">p</span>&nbsp;<span class="op" id="4271048">[</span><span class="op" id="4271049">]</span><span class="builtintype" id="4271050">byte</span><span class="op" id="4271054">)</span>&nbsp;<span class="op" id="4271056">(</span><span class="ident" id="4271057">nn</span>&nbsp;<span class="builtintype" id="4271060">int</span><span class="op" id="4271063">,</span>&nbsp;<span class="ident" id="4271065">err</span>&nbsp;<span class="builtintype" id="4271069">error</span><span class="op" id="4271074">)</span>&nbsp;<span class="op" id="4271076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271079">nn</span>&nbsp;<span class="op" id="4271082">=</span>&nbsp;<span class="builtinfunc" id="4271084">len</span><span class="op" id="4271087">(</span><span class="ident" id="4271088">p</span><span class="op" id="4271089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271092">d</span><span class="op" id="4271093">.</span><span class="builtinfunc" id="4271094">len</span>&nbsp;<span class="op" id="4271098">+=</span>&nbsp;<span class="ident" id="4271101">uint64</span><span class="op" id="4271107">(</span><span class="ident" id="4271108">nn</span><span class="op" id="4271110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271113">if</span>&nbsp;<span class="ident" id="4271116">d</span><span class="op" id="4271117">.</span><span class="ident" id="4271118">nx</span>&nbsp;<span class="op" id="4271121">&gt;</span>&nbsp;<span class="num" id="4271123">0</span>&nbsp;<span class="op" id="4271125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271129">n</span>&nbsp;<span class="op" id="4271131">:=</span>&nbsp;<span class="builtinfunc" id="4271134">copy</span><span class="op" id="4271138">(</span><span class="ident" id="4271139">d</span><span class="op" id="4271140">.</span><span class="ident" id="4271141">x</span><span class="op" id="4271142">[</span><span class="ident" id="4271143">d</span><span class="op" id="4271144">.</span><span class="ident" id="4271145">nx</span><span class="op" id="4271147">:</span><span class="op" id="4271148">]</span><span class="op" id="4271149">,</span>&nbsp;<span class="ident" id="4271151">p</span><span class="op" id="4271152">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271156">d</span><span class="op" id="4271157">.</span><span class="ident" id="4271158">nx</span>&nbsp;<span class="op" id="4271161">+=</span>&nbsp;<span class="ident" id="4271164">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271168">if</span>&nbsp;<span class="ident" id="4271171">d</span><span class="op" id="4271172">.</span><span class="ident" id="4271173">nx</span>&nbsp;<span class="op" id="4271176">==</span>&nbsp;<span class="ident" id="4271179">chunk</span>&nbsp;<span class="op" id="4271185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271190">block</span><span class="op" id="4271195">(</span><span class="ident" id="4271196">d</span><span class="op" id="4271197">,</span>&nbsp;<span class="ident" id="4271199">d</span><span class="op" id="4271200">.</span><span class="ident" id="4271201">x</span><span class="op" id="4271202">[</span><span class="op" id="4271203">:</span><span class="op" id="4271204">]</span><span class="op" id="4271205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271210">d</span><span class="op" id="4271211">.</span><span class="ident" id="4271212">nx</span>&nbsp;<span class="op" id="4271215">=</span>&nbsp;<span class="num" id="4271217">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4271221">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271225">p</span>&nbsp;<span class="op" id="4271227">=</span>&nbsp;<span class="ident" id="4271229">p</span><span class="op" id="4271230">[</span><span class="ident" id="4271231">n</span><span class="op" id="4271232">:</span><span class="op" id="4271233">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4271236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271239">if</span>&nbsp;<span class="builtinfunc" id="4271242">len</span><span class="op" id="4271245">(</span><span class="ident" id="4271246">p</span><span class="op" id="4271247">)</span>&nbsp;<span class="op" id="4271249">&gt;=</span>&nbsp;<span class="ident" id="4271252">chunk</span>&nbsp;<span class="op" id="4271258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271262">n</span>&nbsp;<span class="op" id="4271264">:=</span>&nbsp;<span class="builtinfunc" id="4271267">len</span><span class="op" id="4271270">(</span><span class="ident" id="4271271">p</span><span class="op" id="4271272">)</span>&nbsp;<span class="op" id="4271274">&amp;^</span>&nbsp;<span class="op" id="4271277">(</span><span class="ident" id="4271278">chunk</span>&nbsp;<span class="op" id="4271284">-</span>&nbsp;<span class="num" id="4271286">1</span><span class="op" id="4271287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271291">block</span><span class="op" id="4271296">(</span><span class="ident" id="4271297">d</span><span class="op" id="4271298">,</span>&nbsp;<span class="ident" id="4271300">p</span><span class="op" id="4271301">[</span><span class="op" id="4271302">:</span><span class="ident" id="4271303">n</span><span class="op" id="4271304">]</span><span class="op" id="4271305">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271309">p</span>&nbsp;<span class="op" id="4271311">=</span>&nbsp;<span class="ident" id="4271313">p</span><span class="op" id="4271314">[</span><span class="ident" id="4271315">n</span><span class="op" id="4271316">:</span><span class="op" id="4271317">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4271320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271323">if</span>&nbsp;<span class="builtinfunc" id="4271326">len</span><span class="op" id="4271329">(</span><span class="ident" id="4271330">p</span><span class="op" id="4271331">)</span>&nbsp;<span class="op" id="4271333">&gt;</span>&nbsp;<span class="num" id="4271335">0</span>&nbsp;<span class="op" id="4271337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271341">d</span><span class="op" id="4271342">.</span><span class="ident" id="4271343">nx</span>&nbsp;<span class="op" id="4271346">=</span>&nbsp;<span class="builtinfunc" id="4271348">copy</span><span class="op" id="4271352">(</span><span class="ident" id="4271353">d</span><span class="op" id="4271354">.</span><span class="ident" id="4271355">x</span><span class="op" id="4271356">[</span><span class="op" id="4271357">:</span><span class="op" id="4271358">]</span><span class="op" id="4271359">,</span>&nbsp;<span class="ident" id="4271361">p</span><span class="op" id="4271362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4271365">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271368">return</span><br>
<span class="lineno"></span><span class="op" id="4271375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4271378">func</span>&nbsp;<span class="op" id="4271383">(</span><span class="ident" id="4271384">d0</span>&nbsp;<span class="op" id="4271387">*</span><span class="ident" id="4271388">digest</span><span class="op" id="4271394">)</span>&nbsp;<span class="ident" id="4271396">Sum</span><span class="op" id="4271399">(</span><span class="ident" id="4271400">in</span>&nbsp;<span class="op" id="4271403">[</span><span class="op" id="4271404">]</span><span class="builtintype" id="4271405">byte</span><span class="op" id="4271409">)</span>&nbsp;<span class="op" id="4271411">[</span><span class="op" id="4271412">]</span><span class="builtintype" id="4271413">byte</span>&nbsp;<span class="op" id="4271418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4271421">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271488">d</span>&nbsp;<span class="op" id="4271490">:=</span>&nbsp;<span class="builtinfunc" id="4271493">new</span><span class="op" id="4271496">(</span><span class="ident" id="4271497">digest</span><span class="op" id="4271503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4271506">*</span><span class="ident" id="4271507">d</span>&nbsp;<span class="op" id="4271509">=</span>&nbsp;<span class="op" id="4271511">*</span><span class="ident" id="4271512">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271516">hash</span>&nbsp;<span class="op" id="4271521">:=</span>&nbsp;<span class="ident" id="4271524">d</span><span class="op" id="4271525">.</span><span class="ident" id="4271526">checkSum</span><span class="op" id="4271534">(</span><span class="op" id="4271535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271538">if</span>&nbsp;<span class="ident" id="4271541">d</span><span class="op" id="4271542">.</span><span class="ident" id="4271543">is384</span>&nbsp;<span class="op" id="4271549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271553">return</span>&nbsp;<span class="builtinfunc" id="4271560">append</span><span class="op" id="4271566">(</span><span class="ident" id="4271567">in</span><span class="op" id="4271569">,</span>&nbsp;<span class="ident" id="4271571">hash</span><span class="op" id="4271575">[</span><span class="op" id="4271576">:</span><span class="ident" id="4271577">Size384</span><span class="op" id="4271584">]</span><span class="op" id="4271585">...</span><span class="op" id="4271588">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4271591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271594">return</span>&nbsp;<span class="builtinfunc" id="4271601">append</span><span class="op" id="4271607">(</span><span class="ident" id="4271608">in</span><span class="op" id="4271610">,</span>&nbsp;<span class="ident" id="4271612">hash</span><span class="op" id="4271616">[</span><span class="op" id="4271617">:</span><span class="op" id="4271618">]</span><span class="op" id="4271619">...</span><span class="op" id="4271622">)</span><br>
<span class="lineno"></span><span class="op" id="4271624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4271627">func</span>&nbsp;<span class="op" id="4271632">(</span><span class="ident" id="4271633">d</span>&nbsp;<span class="op" id="4271635">*</span><span class="ident" id="4271636">digest</span><span class="op" id="4271642">)</span>&nbsp;<span class="ident" id="4271644">checkSum</span><span class="op" id="4271652">(</span><span class="op" id="4271653">)</span>&nbsp;<span class="op" id="4271655">[</span><span class="ident" id="4271656">Size</span><span class="op" id="4271660">]</span><span class="builtintype" id="4271661">byte</span>&nbsp;<span class="op" id="4271666">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4271669">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;112&nbsp;bytes&nbsp;mod&nbsp;128.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4271731">len</span>&nbsp;<span class="op" id="4271735">:=</span>&nbsp;<span class="ident" id="4271738">d</span><span class="op" id="4271739">.</span><span class="builtinfunc" id="4271740">len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271745">var</span>&nbsp;<span class="ident" id="4271749">tmp</span>&nbsp;<span class="op" id="4271753">[</span><span class="num" id="4271754">128</span><span class="op" id="4271757">]</span><span class="builtintype" id="4271758">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271764">tmp</span><span class="op" id="4271767">[</span><span class="num" id="4271768">0</span><span class="op" id="4271769">]</span>&nbsp;<span class="op" id="4271771">=</span>&nbsp;<span class="num" id="4271773">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271779">if</span>&nbsp;<span class="builtinfunc" id="4271782">len</span><span class="op" id="4271785">%</span><span class="num" id="4271786">128</span>&nbsp;<span class="op" id="4271790">&lt;</span>&nbsp;<span class="num" id="4271792">112</span>&nbsp;<span class="op" id="4271796">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271800">d</span><span class="op" id="4271801">.</span><span class="ident" id="4271802">Write</span><span class="op" id="4271807">(</span><span class="ident" id="4271808">tmp</span><span class="op" id="4271811">[</span><span class="num" id="4271812">0</span>&nbsp;<span class="op" id="4271814">:</span>&nbsp;<span class="num" id="4271816">112</span><span class="op" id="4271819">-</span><span class="builtinfunc" id="4271820">len</span><span class="op" id="4271823">%</span><span class="num" id="4271824">128</span><span class="op" id="4271827">]</span><span class="op" id="4271828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4271831">}</span>&nbsp;<span class="keyword" id="4271833">else</span>&nbsp;<span class="op" id="4271838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271842">d</span><span class="op" id="4271843">.</span><span class="ident" id="4271844">Write</span><span class="op" id="4271849">(</span><span class="ident" id="4271850">tmp</span><span class="op" id="4271853">[</span><span class="num" id="4271854">0</span>&nbsp;<span class="op" id="4271856">:</span>&nbsp;<span class="num" id="4271858">128</span><span class="op" id="4271861">+</span><span class="num" id="4271862">112</span><span class="op" id="4271865">-</span><span class="builtinfunc" id="4271866">len</span><span class="op" id="4271869">%</span><span class="num" id="4271870">128</span><span class="op" id="4271873">]</span><span class="op" id="4271874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4271877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4271881">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4271901">len</span>&nbsp;<span class="op" id="4271905">&lt;&lt;=</span>&nbsp;<span class="num" id="4271909">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271912">for</span>&nbsp;<span class="ident" id="4271916">i</span>&nbsp;<span class="op" id="4271918">:=</span>&nbsp;<span class="builtintype" id="4271921">uint</span><span class="op" id="4271925">(</span><span class="num" id="4271926">0</span><span class="op" id="4271927">)</span><span class="op" id="4271928">;</span>&nbsp;<span class="ident" id="4271930">i</span>&nbsp;<span class="op" id="4271932">&lt;</span>&nbsp;<span class="num" id="4271934">16</span><span class="op" id="4271936">;</span>&nbsp;<span class="ident" id="4271938">i</span><span class="op" id="4271939">++</span>&nbsp;<span class="op" id="4271942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271946">tmp</span><span class="op" id="4271949">[</span><span class="ident" id="4271950">i</span><span class="op" id="4271951">]</span>&nbsp;<span class="op" id="4271953">=</span>&nbsp;<span class="builtintype" id="4271955">byte</span><span class="op" id="4271959">(</span><span class="builtinfunc" id="4271960">len</span>&nbsp;<span class="op" id="4271964">&gt;&gt;</span>&nbsp;<span class="op" id="4271967">(</span><span class="num" id="4271968">120</span>&nbsp;<span class="op" id="4271972">-</span>&nbsp;<span class="num" id="4271974">8</span><span class="op" id="4271975">*</span><span class="ident" id="4271976">i</span><span class="op" id="4271977">)</span><span class="op" id="4271978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4271981">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271984">d</span><span class="op" id="4271985">.</span><span class="ident" id="4271986">Write</span><span class="op" id="4271991">(</span><span class="ident" id="4271992">tmp</span><span class="op" id="4271995">[</span><span class="num" id="4271996">0</span><span class="op" id="4271997">:</span><span class="num" id="4271998">16</span><span class="op" id="4272000">]</span><span class="op" id="4272001">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272005">if</span>&nbsp;<span class="ident" id="4272008">d</span><span class="op" id="4272009">.</span><span class="ident" id="4272010">nx</span>&nbsp;<span class="op" id="4272013">!=</span>&nbsp;<span class="num" id="4272016">0</span>&nbsp;<span class="op" id="4272018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4272022">panic</span><span class="op" id="4272027">(</span><span class="string" id="4272028">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4272039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4272042">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272046">h</span>&nbsp;<span class="op" id="4272048">:=</span>&nbsp;<span class="ident" id="4272051">d</span><span class="op" id="4272052">.</span><span class="ident" id="4272053">h</span><span class="op" id="4272054">[</span><span class="op" id="4272055">:</span><span class="op" id="4272056">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272059">if</span>&nbsp;<span class="ident" id="4272062">d</span><span class="op" id="4272063">.</span><span class="ident" id="4272064">is384</span>&nbsp;<span class="op" id="4272070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272074">h</span>&nbsp;<span class="op" id="4272076">=</span>&nbsp;<span class="ident" id="4272078">d</span><span class="op" id="4272079">.</span><span class="ident" id="4272080">h</span><span class="op" id="4272081">[</span><span class="op" id="4272082">:</span><span class="num" id="4272083">6</span><span class="op" id="4272084">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4272087">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272091">var</span>&nbsp;<span class="ident" id="4272095">digest</span>&nbsp;<span class="op" id="4272102">[</span><span class="ident" id="4272103">Size</span><span class="op" id="4272107">]</span><span class="builtintype" id="4272108">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272114">for</span>&nbsp;<span class="ident" id="4272118">i</span><span class="op" id="4272119">,</span>&nbsp;<span class="ident" id="4272121">s</span>&nbsp;<span class="op" id="4272123">:=</span>&nbsp;<span class="keyword" id="4272126">range</span>&nbsp;<span class="ident" id="4272132">h</span>&nbsp;<span class="op" id="4272134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272138">digest</span><span class="op" id="4272144">[</span><span class="ident" id="4272145">i</span><span class="op" id="4272146">*</span><span class="num" id="4272147">8</span><span class="op" id="4272148">]</span>&nbsp;<span class="op" id="4272150">=</span>&nbsp;<span class="builtintype" id="4272152">byte</span><span class="op" id="4272156">(</span><span class="ident" id="4272157">s</span>&nbsp;<span class="op" id="4272159">&gt;&gt;</span>&nbsp;<span class="num" id="4272162">56</span><span class="op" id="4272164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272168">digest</span><span class="op" id="4272174">[</span><span class="ident" id="4272175">i</span><span class="op" id="4272176">*</span><span class="num" id="4272177">8</span><span class="op" id="4272178">+</span><span class="num" id="4272179">1</span><span class="op" id="4272180">]</span>&nbsp;<span class="op" id="4272182">=</span>&nbsp;<span class="builtintype" id="4272184">byte</span><span class="op" id="4272188">(</span><span class="ident" id="4272189">s</span>&nbsp;<span class="op" id="4272191">&gt;&gt;</span>&nbsp;<span class="num" id="4272194">48</span><span class="op" id="4272196">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272200">digest</span><span class="op" id="4272206">[</span><span class="ident" id="4272207">i</span><span class="op" id="4272208">*</span><span class="num" id="4272209">8</span><span class="op" id="4272210">+</span><span class="num" id="4272211">2</span><span class="op" id="4272212">]</span>&nbsp;<span class="op" id="4272214">=</span>&nbsp;<span class="builtintype" id="4272216">byte</span><span class="op" id="4272220">(</span><span class="ident" id="4272221">s</span>&nbsp;<span class="op" id="4272223">&gt;&gt;</span>&nbsp;<span class="num" id="4272226">40</span><span class="op" id="4272228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272232">digest</span><span class="op" id="4272238">[</span><span class="ident" id="4272239">i</span><span class="op" id="4272240">*</span><span class="num" id="4272241">8</span><span class="op" id="4272242">+</span><span class="num" id="4272243">3</span><span class="op" id="4272244">]</span>&nbsp;<span class="op" id="4272246">=</span>&nbsp;<span class="builtintype" id="4272248">byte</span><span class="op" id="4272252">(</span><span class="ident" id="4272253">s</span>&nbsp;<span class="op" id="4272255">&gt;&gt;</span>&nbsp;<span class="num" id="4272258">32</span><span class="op" id="4272260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272264">digest</span><span class="op" id="4272270">[</span><span class="ident" id="4272271">i</span><span class="op" id="4272272">*</span><span class="num" id="4272273">8</span><span class="op" id="4272274">+</span><span class="num" id="4272275">4</span><span class="op" id="4272276">]</span>&nbsp;<span class="op" id="4272278">=</span>&nbsp;<span class="builtintype" id="4272280">byte</span><span class="op" id="4272284">(</span><span class="ident" id="4272285">s</span>&nbsp;<span class="op" id="4272287">&gt;&gt;</span>&nbsp;<span class="num" id="4272290">24</span><span class="op" id="4272292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272296">digest</span><span class="op" id="4272302">[</span><span class="ident" id="4272303">i</span><span class="op" id="4272304">*</span><span class="num" id="4272305">8</span><span class="op" id="4272306">+</span><span class="num" id="4272307">5</span><span class="op" id="4272308">]</span>&nbsp;<span class="op" id="4272310">=</span>&nbsp;<span class="builtintype" id="4272312">byte</span><span class="op" id="4272316">(</span><span class="ident" id="4272317">s</span>&nbsp;<span class="op" id="4272319">&gt;&gt;</span>&nbsp;<span class="num" id="4272322">16</span><span class="op" id="4272324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272328">digest</span><span class="op" id="4272334">[</span><span class="ident" id="4272335">i</span><span class="op" id="4272336">*</span><span class="num" id="4272337">8</span><span class="op" id="4272338">+</span><span class="num" id="4272339">6</span><span class="op" id="4272340">]</span>&nbsp;<span class="op" id="4272342">=</span>&nbsp;<span class="builtintype" id="4272344">byte</span><span class="op" id="4272348">(</span><span class="ident" id="4272349">s</span>&nbsp;<span class="op" id="4272351">&gt;&gt;</span>&nbsp;<span class="num" id="4272354">8</span><span class="op" id="4272355">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272359">digest</span><span class="op" id="4272365">[</span><span class="ident" id="4272366">i</span><span class="op" id="4272367">*</span><span class="num" id="4272368">8</span><span class="op" id="4272369">+</span><span class="num" id="4272370">7</span><span class="op" id="4272371">]</span>&nbsp;<span class="op" id="4272373">=</span>&nbsp;<span class="builtintype" id="4272375">byte</span><span class="op" id="4272379">(</span><span class="ident" id="4272380">s</span><span class="op" id="4272381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4272384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272388">return</span>&nbsp;<span class="ident" id="4272395">digest</span><br>
<span class="lineno"></span><span class="op" id="4272402">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4272405">//&nbsp;Sum512&nbsp;returns&nbsp;the&nbsp;SHA512&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4272456">func</span>&nbsp;<span class="ident" id="4272461">Sum512</span><span class="op" id="4272467">(</span><span class="ident" id="4272468">data</span>&nbsp;<span class="op" id="4272473">[</span><span class="op" id="4272474">]</span><span class="builtintype" id="4272475">byte</span><span class="op" id="4272479">)</span>&nbsp;<span class="op" id="4272481">[</span><span class="ident" id="4272482">Size</span><span class="op" id="4272486">]</span><span class="builtintype" id="4272487">byte</span>&nbsp;<span class="op" id="4272492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272495">var</span>&nbsp;<span class="ident" id="4272499">d</span>&nbsp;<span class="ident" id="4272501">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272509">d</span><span class="op" id="4272510">.</span><span class="ident" id="4272511">Reset</span><span class="op" id="4272516">(</span><span class="op" id="4272517">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272520">d</span><span class="op" id="4272521">.</span><span class="ident" id="4272522">Write</span><span class="op" id="4272527">(</span><span class="ident" id="4272528">data</span><span class="op" id="4272532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272535">return</span>&nbsp;<span class="ident" id="4272542">d</span><span class="op" id="4272543">.</span><span class="ident" id="4272544">checkSum</span><span class="op" id="4272552">(</span><span class="op" id="4272553">)</span><br>
<span class="lineno"></span><span class="op" id="4272555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4272558">//&nbsp;Sum384&nbsp;returns&nbsp;the&nbsp;SHA384&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">190</span><span class="keyword" id="4272609">func</span>&nbsp;<span class="ident" id="4272614">Sum384</span><span class="op" id="4272620">(</span><span class="ident" id="4272621">data</span>&nbsp;<span class="op" id="4272626">[</span><span class="op" id="4272627">]</span><span class="builtintype" id="4272628">byte</span><span class="op" id="4272632">)</span>&nbsp;<span class="op" id="4272634">(</span><span class="ident" id="4272635">sum384</span>&nbsp;<span class="op" id="4272642">[</span><span class="ident" id="4272643">Size384</span><span class="op" id="4272650">]</span><span class="builtintype" id="4272651">byte</span><span class="op" id="4272655">)</span>&nbsp;<span class="op" id="4272657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272660">var</span>&nbsp;<span class="ident" id="4272664">d</span>&nbsp;<span class="ident" id="4272666">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272674">d</span><span class="op" id="4272675">.</span><span class="ident" id="4272676">is384</span>&nbsp;<span class="op" id="4272682">=</span>&nbsp;<span class="ident" id="4272684">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272690">d</span><span class="op" id="4272691">.</span><span class="ident" id="4272692">Reset</span><span class="op" id="4272697">(</span><span class="op" id="4272698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272701">d</span><span class="op" id="4272702">.</span><span class="ident" id="4272703">Write</span><span class="op" id="4272708">(</span><span class="ident" id="4272709">data</span><span class="op" id="4272713">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272716">sum</span>&nbsp;<span class="op" id="4272720">:=</span>&nbsp;<span class="ident" id="4272723">d</span><span class="op" id="4272724">.</span><span class="ident" id="4272725">checkSum</span><span class="op" id="4272733">(</span><span class="op" id="4272734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4272737">copy</span><span class="op" id="4272741">(</span><span class="ident" id="4272742">sum384</span><span class="op" id="4272748">[</span><span class="op" id="4272749">:</span><span class="op" id="4272750">]</span><span class="op" id="4272751">,</span>&nbsp;<span class="ident" id="4272753">sum</span><span class="op" id="4272756">[</span><span class="op" id="4272757">:</span><span class="ident" id="4272758">Size384</span><span class="op" id="4272765">]</span><span class="op" id="4272766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272769">return</span><br>
<span class="lineno"></span><span class="op" id="4272776">}</span>
</div>
</body>
</html>
