<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/asn1</h2>
<ul>
<li><a href="/gostd/encoding/asn1/asn1.go.html">asn1.go</a></li>
<li><a href="/gostd/encoding/asn1/asn1_test.go.html">asn1_test.go</a></li>
<li><a href="/gostd/encoding/asn1/common.go.html">common.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal_test.go.html">marshal_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4411437">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4411492">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4411546">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4411597">package</span>&nbsp;<span class="ident" id="4411605">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4411611">import</span>&nbsp;<span class="op" id="4411618">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4411621">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4411630">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4411640">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4411647">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4411653">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4411665">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4411676">&#34;time&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4411684">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4411699">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4411702">//&nbsp;A&nbsp;forkableWriter&nbsp;is&nbsp;an&nbsp;in-memory&nbsp;buffer&nbsp;that&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4411757">//&nbsp;&#39;forked&#39;&nbsp;to&nbsp;create&nbsp;new&nbsp;forkableWriters&nbsp;that&nbsp;bracket&nbsp;the</span><br>
<span class="lineno">20</span><span class="comment" id="4411816">//&nbsp;original.&nbsp;&nbsp;After</span><br>
<span class="lineno"></span><span class="comment" id="4411836">//&nbsp;&nbsp;&nbsp;&nbsp;pre,&nbsp;post&nbsp;:=&nbsp;w.fork();</span><br>
<span class="lineno"></span><span class="comment" id="4411865">//&nbsp;the&nbsp;overall&nbsp;sequence&nbsp;of&nbsp;bytes&nbsp;represented&nbsp;is&nbsp;logically&nbsp;w+pre+post.</span><br>
<span class="lineno"></span><span class="keyword" id="4411935">type</span>&nbsp;<span class="ident" id="4411940">forkableWriter</span>&nbsp;<span class="keyword" id="4411955">struct</span>&nbsp;<span class="op" id="4411962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4411965">*</span><span class="ident" id="4411966">bytes</span><span class="op" id="4411971">.</span><span class="ident" id="4411972">Buffer</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4411980">pre</span><span class="op" id="4411983">,</span>&nbsp;<span class="ident" id="4411985">post</span>&nbsp;<span class="op" id="4411990">*</span><span class="ident" id="4411991">forkableWriter</span><br>
<span class="lineno"></span><span class="op" id="4412006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4412009">func</span>&nbsp;<span class="ident" id="4412014">newForkableWriter</span><span class="op" id="4412031">(</span><span class="op" id="4412032">)</span>&nbsp;<span class="op" id="4412034">*</span><span class="ident" id="4412035">forkableWriter</span>&nbsp;<span class="op" id="4412050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412053">return</span>&nbsp;<span class="op" id="4412060">&amp;</span><span class="ident" id="4412061">forkableWriter</span><span class="op" id="4412075">{</span><span class="builtinfunc" id="4412076">new</span><span class="op" id="4412079">(</span><span class="ident" id="4412080">bytes</span><span class="op" id="4412085">.</span><span class="ident" id="4412086">Buffer</span><span class="op" id="4412092">)</span><span class="op" id="4412093">,</span>&nbsp;<span class="ident" id="4412095">nil</span><span class="op" id="4412098">,</span>&nbsp;<span class="ident" id="4412100">nil</span><span class="op" id="4412103">}</span><br>
<span class="lineno">30</span><span class="op" id="4412105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4412108">func</span>&nbsp;<span class="op" id="4412113">(</span><span class="ident" id="4412114">f</span>&nbsp;<span class="op" id="4412116">*</span><span class="ident" id="4412117">forkableWriter</span><span class="op" id="4412131">)</span>&nbsp;<span class="ident" id="4412133">fork</span><span class="op" id="4412137">(</span><span class="op" id="4412138">)</span>&nbsp;<span class="op" id="4412140">(</span><span class="ident" id="4412141">pre</span><span class="op" id="4412144">,</span>&nbsp;<span class="ident" id="4412146">post</span>&nbsp;<span class="op" id="4412151">*</span><span class="ident" id="4412152">forkableWriter</span><span class="op" id="4412166">)</span>&nbsp;<span class="op" id="4412168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412171">if</span>&nbsp;<span class="ident" id="4412174">f</span><span class="op" id="4412175">.</span><span class="ident" id="4412176">pre</span>&nbsp;<span class="op" id="4412180">!=</span>&nbsp;<span class="ident" id="4412183">nil</span>&nbsp;<span class="op" id="4412187">||</span>&nbsp;<span class="ident" id="4412190">f</span><span class="op" id="4412191">.</span><span class="ident" id="4412192">post</span>&nbsp;<span class="op" id="4412197">!=</span>&nbsp;<span class="ident" id="4412200">nil</span>&nbsp;<span class="op" id="4412204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4412208">panic</span><span class="op" id="4412213">(</span><span class="string" id="4412214">&#34;have&nbsp;already&nbsp;forked&#34;</span><span class="op" id="4412235">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4412238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412241">f</span><span class="op" id="4412242">.</span><span class="ident" id="4412243">pre</span>&nbsp;<span class="op" id="4412247">=</span>&nbsp;<span class="ident" id="4412249">newForkableWriter</span><span class="op" id="4412266">(</span><span class="op" id="4412267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412270">f</span><span class="op" id="4412271">.</span><span class="ident" id="4412272">post</span>&nbsp;<span class="op" id="4412277">=</span>&nbsp;<span class="ident" id="4412279">newForkableWriter</span><span class="op" id="4412296">(</span><span class="op" id="4412297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412300">return</span>&nbsp;<span class="ident" id="4412307">f</span><span class="op" id="4412308">.</span><span class="ident" id="4412309">pre</span><span class="op" id="4412312">,</span>&nbsp;<span class="ident" id="4412314">f</span><span class="op" id="4412315">.</span><span class="ident" id="4412316">post</span><br>
<span class="lineno"></span><span class="op" id="4412321">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4412324">func</span>&nbsp;<span class="op" id="4412329">(</span><span class="ident" id="4412330">f</span>&nbsp;<span class="op" id="4412332">*</span><span class="ident" id="4412333">forkableWriter</span><span class="op" id="4412347">)</span>&nbsp;<span class="ident" id="4412349">Len</span><span class="op" id="4412352">(</span><span class="op" id="4412353">)</span>&nbsp;<span class="op" id="4412355">(</span><span class="ident" id="4412356">l</span>&nbsp;<span class="builtintype" id="4412358">int</span><span class="op" id="4412361">)</span>&nbsp;<span class="op" id="4412363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412366">l</span>&nbsp;<span class="op" id="4412368">+=</span>&nbsp;<span class="ident" id="4412371">f</span><span class="op" id="4412372">.</span><span class="ident" id="4412373">Buffer</span><span class="op" id="4412379">.</span><span class="ident" id="4412380">Len</span><span class="op" id="4412383">(</span><span class="op" id="4412384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412387">if</span>&nbsp;<span class="ident" id="4412390">f</span><span class="op" id="4412391">.</span><span class="ident" id="4412392">pre</span>&nbsp;<span class="op" id="4412396">!=</span>&nbsp;<span class="ident" id="4412399">nil</span>&nbsp;<span class="op" id="4412403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412407">l</span>&nbsp;<span class="op" id="4412409">+=</span>&nbsp;<span class="ident" id="4412412">f</span><span class="op" id="4412413">.</span><span class="ident" id="4412414">pre</span><span class="op" id="4412417">.</span><span class="ident" id="4412418">Len</span><span class="op" id="4412421">(</span><span class="op" id="4412422">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4412425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412428">if</span>&nbsp;<span class="ident" id="4412431">f</span><span class="op" id="4412432">.</span><span class="ident" id="4412433">post</span>&nbsp;<span class="op" id="4412438">!=</span>&nbsp;<span class="ident" id="4412441">nil</span>&nbsp;<span class="op" id="4412445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412449">l</span>&nbsp;<span class="op" id="4412451">+=</span>&nbsp;<span class="ident" id="4412454">f</span><span class="op" id="4412455">.</span><span class="ident" id="4412456">post</span><span class="op" id="4412460">.</span><span class="ident" id="4412461">Len</span><span class="op" id="4412464">(</span><span class="op" id="4412465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4412468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412471">return</span><br>
<span class="lineno">50</span><span class="op" id="4412478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4412481">func</span>&nbsp;<span class="op" id="4412486">(</span><span class="ident" id="4412487">f</span>&nbsp;<span class="op" id="4412489">*</span><span class="ident" id="4412490">forkableWriter</span><span class="op" id="4412504">)</span>&nbsp;<span class="ident" id="4412506">writeTo</span><span class="op" id="4412513">(</span><span class="ident" id="4412514">out</span>&nbsp;<span class="ident" id="4412518">io</span><span class="op" id="4412520">.</span><span class="ident" id="4412521">Writer</span><span class="op" id="4412527">)</span>&nbsp;<span class="op" id="4412529">(</span><span class="ident" id="4412530">n</span>&nbsp;<span class="builtintype" id="4412532">int</span><span class="op" id="4412535">,</span>&nbsp;<span class="ident" id="4412537">err</span>&nbsp;<span class="builtintype" id="4412541">error</span><span class="op" id="4412546">)</span>&nbsp;<span class="op" id="4412548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412551">n</span><span class="op" id="4412552">,</span>&nbsp;<span class="ident" id="4412554">err</span>&nbsp;<span class="op" id="4412558">=</span>&nbsp;<span class="ident" id="4412560">out</span><span class="op" id="4412563">.</span><span class="ident" id="4412564">Write</span><span class="op" id="4412569">(</span><span class="ident" id="4412570">f</span><span class="op" id="4412571">.</span><span class="ident" id="4412572">Bytes</span><span class="op" id="4412577">(</span><span class="op" id="4412578">)</span><span class="op" id="4412579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412582">if</span>&nbsp;<span class="ident" id="4412585">err</span>&nbsp;<span class="op" id="4412589">!=</span>&nbsp;<span class="ident" id="4412592">nil</span>&nbsp;<span class="op" id="4412596">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412600">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4412608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412612">var</span>&nbsp;<span class="ident" id="4412616">nn</span>&nbsp;<span class="builtintype" id="4412619">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412625">if</span>&nbsp;<span class="ident" id="4412628">f</span><span class="op" id="4412629">.</span><span class="ident" id="4412630">pre</span>&nbsp;<span class="op" id="4412634">!=</span>&nbsp;<span class="ident" id="4412637">nil</span>&nbsp;<span class="op" id="4412641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412645">nn</span><span class="op" id="4412647">,</span>&nbsp;<span class="ident" id="4412649">err</span>&nbsp;<span class="op" id="4412653">=</span>&nbsp;<span class="ident" id="4412655">f</span><span class="op" id="4412656">.</span><span class="ident" id="4412657">pre</span><span class="op" id="4412660">.</span><span class="ident" id="4412661">writeTo</span><span class="op" id="4412668">(</span><span class="ident" id="4412669">out</span><span class="op" id="4412672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412676">n</span>&nbsp;<span class="op" id="4412678">+=</span>&nbsp;<span class="ident" id="4412681">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412686">if</span>&nbsp;<span class="ident" id="4412689">err</span>&nbsp;<span class="op" id="4412693">!=</span>&nbsp;<span class="ident" id="4412696">nil</span>&nbsp;<span class="op" id="4412700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412705">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4412714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4412717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412721">if</span>&nbsp;<span class="ident" id="4412724">f</span><span class="op" id="4412725">.</span><span class="ident" id="4412726">post</span>&nbsp;<span class="op" id="4412731">!=</span>&nbsp;<span class="ident" id="4412734">nil</span>&nbsp;<span class="op" id="4412738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412742">nn</span><span class="op" id="4412744">,</span>&nbsp;<span class="ident" id="4412746">err</span>&nbsp;<span class="op" id="4412750">=</span>&nbsp;<span class="ident" id="4412752">f</span><span class="op" id="4412753">.</span><span class="ident" id="4412754">post</span><span class="op" id="4412758">.</span><span class="ident" id="4412759">writeTo</span><span class="op" id="4412766">(</span><span class="ident" id="4412767">out</span><span class="op" id="4412770">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412774">n</span>&nbsp;<span class="op" id="4412776">+=</span>&nbsp;<span class="ident" id="4412779">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4412783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412786">return</span><br>
<span class="lineno"></span><span class="op" id="4412793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="4412796">func</span>&nbsp;<span class="ident" id="4412801">marshalBase128Int</span><span class="op" id="4412818">(</span><span class="ident" id="4412819">out</span>&nbsp;<span class="op" id="4412823">*</span><span class="ident" id="4412824">forkableWriter</span><span class="op" id="4412838">,</span>&nbsp;<span class="ident" id="4412840">n</span>&nbsp;<span class="ident" id="4412842">int64</span><span class="op" id="4412847">)</span>&nbsp;<span class="op" id="4412849">(</span><span class="ident" id="4412850">err</span>&nbsp;<span class="builtintype" id="4412854">error</span><span class="op" id="4412859">)</span>&nbsp;<span class="op" id="4412861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412864">if</span>&nbsp;<span class="ident" id="4412867">n</span>&nbsp;<span class="op" id="4412869">==</span>&nbsp;<span class="num" id="4412872">0</span>&nbsp;<span class="op" id="4412874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412878">err</span>&nbsp;<span class="op" id="4412882">=</span>&nbsp;<span class="ident" id="4412884">out</span><span class="op" id="4412887">.</span><span class="ident" id="4412888">WriteByte</span><span class="op" id="4412897">(</span><span class="num" id="4412898">0</span><span class="op" id="4412899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412903">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4412911">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412915">l</span>&nbsp;<span class="op" id="4412917">:=</span>&nbsp;<span class="num" id="4412920">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412923">for</span>&nbsp;<span class="ident" id="4412927">i</span>&nbsp;<span class="op" id="4412929">:=</span>&nbsp;<span class="ident" id="4412932">n</span><span class="op" id="4412933">;</span>&nbsp;<span class="ident" id="4412935">i</span>&nbsp;<span class="op" id="4412937">&gt;</span>&nbsp;<span class="num" id="4412939">0</span><span class="op" id="4412940">;</span>&nbsp;<span class="ident" id="4412942">i</span>&nbsp;<span class="op" id="4412944">&gt;&gt;=</span>&nbsp;<span class="num" id="4412948">7</span>&nbsp;<span class="op" id="4412950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412954">l</span><span class="op" id="4412955">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4412959">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412963">for</span>&nbsp;<span class="ident" id="4412967">i</span>&nbsp;<span class="op" id="4412969">:=</span>&nbsp;<span class="ident" id="4412972">l</span>&nbsp;<span class="op" id="4412974">-</span>&nbsp;<span class="num" id="4412976">1</span><span class="op" id="4412977">;</span>&nbsp;<span class="ident" id="4412979">i</span>&nbsp;<span class="op" id="4412981">&gt;=</span>&nbsp;<span class="num" id="4412984">0</span><span class="op" id="4412985">;</span>&nbsp;<span class="ident" id="4412987">i</span><span class="op" id="4412988">--</span>&nbsp;<span class="op" id="4412991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412995">o</span>&nbsp;<span class="op" id="4412997">:=</span>&nbsp;<span class="builtintype" id="4413000">byte</span><span class="op" id="4413004">(</span><span class="ident" id="4413005">n</span>&nbsp;<span class="op" id="4413007">&gt;&gt;</span>&nbsp;<span class="builtintype" id="4413010">uint</span><span class="op" id="4413014">(</span><span class="ident" id="4413015">i</span><span class="op" id="4413016">*</span><span class="num" id="4413017">7</span><span class="op" id="4413018">)</span><span class="op" id="4413019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413023">o</span>&nbsp;<span class="op" id="4413025">&amp;=</span>&nbsp;<span class="num" id="4413028">0x7f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413035">if</span>&nbsp;<span class="ident" id="4413038">i</span>&nbsp;<span class="op" id="4413040">!=</span>&nbsp;<span class="num" id="4413043">0</span>&nbsp;<span class="op" id="4413045">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413050">o</span>&nbsp;<span class="op" id="4413052">|=</span>&nbsp;<span class="num" id="4413055">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413066">err</span>&nbsp;<span class="op" id="4413070">=</span>&nbsp;<span class="ident" id="4413072">out</span><span class="op" id="4413075">.</span><span class="ident" id="4413076">WriteByte</span><span class="op" id="4413085">(</span><span class="ident" id="4413086">o</span><span class="op" id="4413087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413091">if</span>&nbsp;<span class="ident" id="4413094">err</span>&nbsp;<span class="op" id="4413098">!=</span>&nbsp;<span class="ident" id="4413101">nil</span>&nbsp;<span class="op" id="4413105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413110">return</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413126">return</span>&nbsp;<span class="ident" id="4413133">nil</span><br>
<span class="lineno"></span><span class="op" id="4413137">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4413140">func</span>&nbsp;<span class="ident" id="4413145">marshalInt64</span><span class="op" id="4413157">(</span><span class="ident" id="4413158">out</span>&nbsp;<span class="op" id="4413162">*</span><span class="ident" id="4413163">forkableWriter</span><span class="op" id="4413177">,</span>&nbsp;<span class="ident" id="4413179">i</span>&nbsp;<span class="ident" id="4413181">int64</span><span class="op" id="4413186">)</span>&nbsp;<span class="op" id="4413188">(</span><span class="ident" id="4413189">err</span>&nbsp;<span class="builtintype" id="4413193">error</span><span class="op" id="4413198">)</span>&nbsp;<span class="op" id="4413200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413203">n</span>&nbsp;<span class="op" id="4413205">:=</span>&nbsp;<span class="ident" id="4413208">int64Length</span><span class="op" id="4413219">(</span><span class="ident" id="4413220">i</span><span class="op" id="4413221">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413225">for</span>&nbsp;<span class="op" id="4413229">;</span>&nbsp;<span class="ident" id="4413231">n</span>&nbsp;<span class="op" id="4413233">&gt;</span>&nbsp;<span class="num" id="4413235">0</span><span class="op" id="4413236">;</span>&nbsp;<span class="ident" id="4413238">n</span><span class="op" id="4413239">--</span>&nbsp;<span class="op" id="4413242">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413246">err</span>&nbsp;<span class="op" id="4413250">=</span>&nbsp;<span class="ident" id="4413252">out</span><span class="op" id="4413255">.</span><span class="ident" id="4413256">WriteByte</span><span class="op" id="4413265">(</span><span class="builtintype" id="4413266">byte</span><span class="op" id="4413270">(</span><span class="ident" id="4413271">i</span>&nbsp;<span class="op" id="4413273">&gt;&gt;</span>&nbsp;<span class="builtintype" id="4413276">uint</span><span class="op" id="4413280">(</span><span class="op" id="4413281">(</span><span class="ident" id="4413282">n</span><span class="op" id="4413283">-</span><span class="num" id="4413284">1</span><span class="op" id="4413285">)</span><span class="op" id="4413286">*</span><span class="num" id="4413287">8</span><span class="op" id="4413288">)</span><span class="op" id="4413289">)</span><span class="op" id="4413290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413294">if</span>&nbsp;<span class="ident" id="4413297">err</span>&nbsp;<span class="op" id="4413301">!=</span>&nbsp;<span class="ident" id="4413304">nil</span>&nbsp;<span class="op" id="4413308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413313">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413325">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413329">return</span>&nbsp;<span class="ident" id="4413336">nil</span><br>
<span class="lineno"></span><span class="op" id="4413340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4413343">func</span>&nbsp;<span class="ident" id="4413348">int64Length</span><span class="op" id="4413359">(</span><span class="ident" id="4413360">i</span>&nbsp;<span class="ident" id="4413362">int64</span><span class="op" id="4413367">)</span>&nbsp;<span class="op" id="4413369">(</span><span class="ident" id="4413370">numBytes</span>&nbsp;<span class="builtintype" id="4413379">int</span><span class="op" id="4413382">)</span>&nbsp;<span class="op" id="4413384">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413387">numBytes</span>&nbsp;<span class="op" id="4413396">=</span>&nbsp;<span class="num" id="4413398">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413402">for</span>&nbsp;<span class="ident" id="4413406">i</span>&nbsp;<span class="op" id="4413408">&gt;</span>&nbsp;<span class="num" id="4413410">127</span>&nbsp;<span class="op" id="4413414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413418">numBytes</span><span class="op" id="4413426">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413431">i</span>&nbsp;<span class="op" id="4413433">&gt;&gt;=</span>&nbsp;<span class="num" id="4413437">8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413444">for</span>&nbsp;<span class="ident" id="4413448">i</span>&nbsp;<span class="op" id="4413450">&lt;</span>&nbsp;<span class="op" id="4413452">-</span><span class="num" id="4413453">128</span>&nbsp;<span class="op" id="4413457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413461">numBytes</span><span class="op" id="4413469">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413474">i</span>&nbsp;<span class="op" id="4413476">&gt;&gt;=</span>&nbsp;<span class="num" id="4413480">8</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413487">return</span><br>
<span class="lineno"></span><span class="op" id="4413494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="4413497">func</span>&nbsp;<span class="ident" id="4413502">marshalBigInt</span><span class="op" id="4413515">(</span><span class="ident" id="4413516">out</span>&nbsp;<span class="op" id="4413520">*</span><span class="ident" id="4413521">forkableWriter</span><span class="op" id="4413535">,</span>&nbsp;<span class="ident" id="4413537">n</span>&nbsp;<span class="op" id="4413539">*</span><span class="ident" id="4413540">big</span><span class="op" id="4413543">.</span><span class="ident" id="4413544">Int</span><span class="op" id="4413547">)</span>&nbsp;<span class="op" id="4413549">(</span><span class="ident" id="4413550">err</span>&nbsp;<span class="builtintype" id="4413554">error</span><span class="op" id="4413559">)</span>&nbsp;<span class="op" id="4413561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413564">if</span>&nbsp;<span class="ident" id="4413567">n</span><span class="op" id="4413568">.</span><span class="ident" id="4413569">Sign</span><span class="op" id="4413573">(</span><span class="op" id="4413574">)</span>&nbsp;<span class="op" id="4413576">&lt;</span>&nbsp;<span class="num" id="4413578">0</span>&nbsp;<span class="op" id="4413580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4413584">//&nbsp;A&nbsp;negative&nbsp;number&nbsp;has&nbsp;to&nbsp;be&nbsp;converted&nbsp;to&nbsp;two&#39;s-complement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4413647">//&nbsp;form.&nbsp;So&nbsp;we&#39;ll&nbsp;subtract&nbsp;1&nbsp;and&nbsp;invert.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4413697">//&nbsp;most-significant-bit&nbsp;isn&#39;t&nbsp;set&nbsp;then&nbsp;we&#39;ll&nbsp;need&nbsp;to&nbsp;pad&nbsp;the</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4413760">//&nbsp;beginning&nbsp;with&nbsp;0xff&nbsp;in&nbsp;order&nbsp;to&nbsp;keep&nbsp;the&nbsp;number&nbsp;negative.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413823">nMinus1</span>&nbsp;<span class="op" id="4413831">:=</span>&nbsp;<span class="builtinfunc" id="4413834">new</span><span class="op" id="4413837">(</span><span class="ident" id="4413838">big</span><span class="op" id="4413841">.</span><span class="ident" id="4413842">Int</span><span class="op" id="4413845">)</span><span class="op" id="4413846">.</span><span class="ident" id="4413847">Neg</span><span class="op" id="4413850">(</span><span class="ident" id="4413851">n</span><span class="op" id="4413852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413856">nMinus1</span><span class="op" id="4413863">.</span><span class="ident" id="4413864">Sub</span><span class="op" id="4413867">(</span><span class="ident" id="4413868">nMinus1</span><span class="op" id="4413875">,</span>&nbsp;<span class="ident" id="4413877">bigOne</span><span class="op" id="4413883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413887">bytes</span>&nbsp;<span class="op" id="4413893">:=</span>&nbsp;<span class="ident" id="4413896">nMinus1</span><span class="op" id="4413903">.</span><span class="ident" id="4413904">Bytes</span><span class="op" id="4413909">(</span><span class="op" id="4413910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413914">for</span>&nbsp;<span class="ident" id="4413918">i</span>&nbsp;<span class="op" id="4413920">:=</span>&nbsp;<span class="keyword" id="4413923">range</span>&nbsp;<span class="ident" id="4413929">bytes</span>&nbsp;<span class="op" id="4413935">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413940">bytes</span><span class="op" id="4413945">[</span><span class="ident" id="4413946">i</span><span class="op" id="4413947">]</span>&nbsp;<span class="op" id="4413949">^=</span>&nbsp;<span class="num" id="4413952">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413963">if</span>&nbsp;<span class="builtinfunc" id="4413966">len</span><span class="op" id="4413969">(</span><span class="ident" id="4413970">bytes</span><span class="op" id="4413975">)</span>&nbsp;<span class="op" id="4413977">==</span>&nbsp;<span class="num" id="4413980">0</span>&nbsp;<span class="op" id="4413982">||</span>&nbsp;<span class="ident" id="4413985">bytes</span><span class="op" id="4413990">[</span><span class="num" id="4413991">0</span><span class="op" id="4413992">]</span><span class="op" id="4413993">&amp;</span><span class="num" id="4413994">0x80</span>&nbsp;<span class="op" id="4413999">==</span>&nbsp;<span class="num" id="4414002">0</span>&nbsp;<span class="op" id="4414004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414009">err</span>&nbsp;<span class="op" id="4414013">=</span>&nbsp;<span class="ident" id="4414015">out</span><span class="op" id="4414018">.</span><span class="ident" id="4414019">WriteByte</span><span class="op" id="4414028">(</span><span class="num" id="4414029">0xff</span><span class="op" id="4414033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414038">if</span>&nbsp;<span class="ident" id="4414041">err</span>&nbsp;<span class="op" id="4414045">!=</span>&nbsp;<span class="ident" id="4414048">nil</span>&nbsp;<span class="op" id="4414052">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414058">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414076">_</span><span class="op" id="4414077">,</span>&nbsp;<span class="ident" id="4414079">err</span>&nbsp;<span class="op" id="4414083">=</span>&nbsp;<span class="ident" id="4414085">out</span><span class="op" id="4414088">.</span><span class="ident" id="4414089">Write</span><span class="op" id="4414094">(</span><span class="ident" id="4414095">bytes</span><span class="op" id="4414100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414103">}</span>&nbsp;<span class="keyword" id="4414105">else</span>&nbsp;<span class="keyword" id="4414110">if</span>&nbsp;<span class="ident" id="4414113">n</span><span class="op" id="4414114">.</span><span class="ident" id="4414115">Sign</span><span class="op" id="4414119">(</span><span class="op" id="4414120">)</span>&nbsp;<span class="op" id="4414122">==</span>&nbsp;<span class="num" id="4414125">0</span>&nbsp;<span class="op" id="4414127">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4414131">//&nbsp;Zero&nbsp;is&nbsp;written&nbsp;as&nbsp;a&nbsp;single&nbsp;0&nbsp;zero&nbsp;rather&nbsp;than&nbsp;no&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414193">err</span>&nbsp;<span class="op" id="4414197">=</span>&nbsp;<span class="ident" id="4414199">out</span><span class="op" id="4414202">.</span><span class="ident" id="4414203">WriteByte</span><span class="op" id="4414212">(</span><span class="num" id="4414213">0x00</span><span class="op" id="4414217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414220">}</span>&nbsp;<span class="keyword" id="4414222">else</span>&nbsp;<span class="op" id="4414227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414231">bytes</span>&nbsp;<span class="op" id="4414237">:=</span>&nbsp;<span class="ident" id="4414240">n</span><span class="op" id="4414241">.</span><span class="ident" id="4414242">Bytes</span><span class="op" id="4414247">(</span><span class="op" id="4414248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414252">if</span>&nbsp;<span class="builtinfunc" id="4414255">len</span><span class="op" id="4414258">(</span><span class="ident" id="4414259">bytes</span><span class="op" id="4414264">)</span>&nbsp;<span class="op" id="4414266">&gt;</span>&nbsp;<span class="num" id="4414268">0</span>&nbsp;<span class="op" id="4414270">&amp;&amp;</span>&nbsp;<span class="ident" id="4414273">bytes</span><span class="op" id="4414278">[</span><span class="num" id="4414279">0</span><span class="op" id="4414280">]</span><span class="op" id="4414281">&amp;</span><span class="num" id="4414282">0x80</span>&nbsp;<span class="op" id="4414287">!=</span>&nbsp;<span class="num" id="4414290">0</span>&nbsp;<span class="op" id="4414292">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4414297">//&nbsp;We&#39;ll&nbsp;have&nbsp;to&nbsp;pad&nbsp;this&nbsp;with&nbsp;0x00&nbsp;in&nbsp;order&nbsp;to&nbsp;stop&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4414356">//&nbsp;looking&nbsp;like&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414394">err</span>&nbsp;<span class="op" id="4414398">=</span>&nbsp;<span class="ident" id="4414400">out</span><span class="op" id="4414403">.</span><span class="ident" id="4414404">WriteByte</span><span class="op" id="4414413">(</span><span class="num" id="4414414">0</span><span class="op" id="4414415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414420">if</span>&nbsp;<span class="ident" id="4414423">err</span>&nbsp;<span class="op" id="4414427">!=</span>&nbsp;<span class="ident" id="4414430">nil</span>&nbsp;<span class="op" id="4414434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414440">return</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414458">_</span><span class="op" id="4414459">,</span>&nbsp;<span class="ident" id="4414461">err</span>&nbsp;<span class="op" id="4414465">=</span>&nbsp;<span class="ident" id="4414467">out</span><span class="op" id="4414470">.</span><span class="ident" id="4414471">Write</span><span class="op" id="4414476">(</span><span class="ident" id="4414477">bytes</span><span class="op" id="4414482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414488">return</span><br>
<span class="lineno">165</span><span class="op" id="4414495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4414498">func</span>&nbsp;<span class="ident" id="4414503">marshalLength</span><span class="op" id="4414516">(</span><span class="ident" id="4414517">out</span>&nbsp;<span class="op" id="4414521">*</span><span class="ident" id="4414522">forkableWriter</span><span class="op" id="4414536">,</span>&nbsp;<span class="ident" id="4414538">i</span>&nbsp;<span class="builtintype" id="4414540">int</span><span class="op" id="4414543">)</span>&nbsp;<span class="op" id="4414545">(</span><span class="ident" id="4414546">err</span>&nbsp;<span class="builtintype" id="4414550">error</span><span class="op" id="4414555">)</span>&nbsp;<span class="op" id="4414557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414560">n</span>&nbsp;<span class="op" id="4414562">:=</span>&nbsp;<span class="ident" id="4414565">lengthLength</span><span class="op" id="4414577">(</span><span class="ident" id="4414578">i</span><span class="op" id="4414579">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414583">for</span>&nbsp;<span class="op" id="4414587">;</span>&nbsp;<span class="ident" id="4414589">n</span>&nbsp;<span class="op" id="4414591">&gt;</span>&nbsp;<span class="num" id="4414593">0</span><span class="op" id="4414594">;</span>&nbsp;<span class="ident" id="4414596">n</span><span class="op" id="4414597">--</span>&nbsp;<span class="op" id="4414600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414604">err</span>&nbsp;<span class="op" id="4414608">=</span>&nbsp;<span class="ident" id="4414610">out</span><span class="op" id="4414613">.</span><span class="ident" id="4414614">WriteByte</span><span class="op" id="4414623">(</span><span class="builtintype" id="4414624">byte</span><span class="op" id="4414628">(</span><span class="ident" id="4414629">i</span>&nbsp;<span class="op" id="4414631">&gt;&gt;</span>&nbsp;<span class="builtintype" id="4414634">uint</span><span class="op" id="4414638">(</span><span class="op" id="4414639">(</span><span class="ident" id="4414640">n</span><span class="op" id="4414641">-</span><span class="num" id="4414642">1</span><span class="op" id="4414643">)</span><span class="op" id="4414644">*</span><span class="num" id="4414645">8</span><span class="op" id="4414646">)</span><span class="op" id="4414647">)</span><span class="op" id="4414648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414652">if</span>&nbsp;<span class="ident" id="4414655">err</span>&nbsp;<span class="op" id="4414659">!=</span>&nbsp;<span class="ident" id="4414662">nil</span>&nbsp;<span class="op" id="4414666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414671">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414680">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414687">return</span>&nbsp;<span class="ident" id="4414694">nil</span><br>
<span class="lineno"></span><span class="op" id="4414698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="4414701">func</span>&nbsp;<span class="ident" id="4414706">lengthLength</span><span class="op" id="4414718">(</span><span class="ident" id="4414719">i</span>&nbsp;<span class="builtintype" id="4414721">int</span><span class="op" id="4414724">)</span>&nbsp;<span class="op" id="4414726">(</span><span class="ident" id="4414727">numBytes</span>&nbsp;<span class="builtintype" id="4414736">int</span><span class="op" id="4414739">)</span>&nbsp;<span class="op" id="4414741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414744">numBytes</span>&nbsp;<span class="op" id="4414753">=</span>&nbsp;<span class="num" id="4414755">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414758">for</span>&nbsp;<span class="ident" id="4414762">i</span>&nbsp;<span class="op" id="4414764">&gt;</span>&nbsp;<span class="num" id="4414766">255</span>&nbsp;<span class="op" id="4414770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414774">numBytes</span><span class="op" id="4414782">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414787">i</span>&nbsp;<span class="op" id="4414789">&gt;&gt;=</span>&nbsp;<span class="num" id="4414793">8</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414799">return</span><br>
<span class="lineno"></span><span class="op" id="4414806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4414809">func</span>&nbsp;<span class="ident" id="4414814">marshalTagAndLength</span><span class="op" id="4414833">(</span><span class="ident" id="4414834">out</span>&nbsp;<span class="op" id="4414838">*</span><span class="ident" id="4414839">forkableWriter</span><span class="op" id="4414853">,</span>&nbsp;<span class="ident" id="4414855">t</span>&nbsp;<span class="ident" id="4414857">tagAndLength</span><span class="op" id="4414869">)</span>&nbsp;<span class="op" id="4414871">(</span><span class="ident" id="4414872">err</span>&nbsp;<span class="builtintype" id="4414876">error</span><span class="op" id="4414881">)</span>&nbsp;<span class="op" id="4414883">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414886">b</span>&nbsp;<span class="op" id="4414888">:=</span>&nbsp;<span class="builtintype" id="4414891">uint8</span><span class="op" id="4414896">(</span><span class="ident" id="4414897">t</span><span class="op" id="4414898">.</span><span class="ident" id="4414899">class</span><span class="op" id="4414904">)</span>&nbsp;<span class="op" id="4414906">&lt;&lt;</span>&nbsp;<span class="num" id="4414909">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414912">if</span>&nbsp;<span class="ident" id="4414915">t</span><span class="op" id="4414916">.</span><span class="ident" id="4414917">isCompound</span>&nbsp;<span class="op" id="4414928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414932">b</span>&nbsp;<span class="op" id="4414934">|=</span>&nbsp;<span class="num" id="4414937">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414946">if</span>&nbsp;<span class="ident" id="4414949">t</span><span class="op" id="4414950">.</span><span class="ident" id="4414951">tag</span>&nbsp;<span class="op" id="4414955">&gt;=</span>&nbsp;<span class="num" id="4414958">31</span>&nbsp;<span class="op" id="4414961">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414965">b</span>&nbsp;<span class="op" id="4414967">|=</span>&nbsp;<span class="num" id="4414970">0x1f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414977">err</span>&nbsp;<span class="op" id="4414981">=</span>&nbsp;<span class="ident" id="4414983">out</span><span class="op" id="4414986">.</span><span class="ident" id="4414987">WriteByte</span><span class="op" id="4414996">(</span><span class="ident" id="4414997">b</span><span class="op" id="4414998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415002">if</span>&nbsp;<span class="ident" id="4415005">err</span>&nbsp;<span class="op" id="4415009">!=</span>&nbsp;<span class="ident" id="4415012">nil</span>&nbsp;<span class="op" id="4415016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415021">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415030">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415034">err</span>&nbsp;<span class="op" id="4415038">=</span>&nbsp;<span class="ident" id="4415040">marshalBase128Int</span><span class="op" id="4415057">(</span><span class="ident" id="4415058">out</span><span class="op" id="4415061">,</span>&nbsp;<span class="ident" id="4415063">int64</span><span class="op" id="4415068">(</span><span class="ident" id="4415069">t</span><span class="op" id="4415070">.</span><span class="ident" id="4415071">tag</span><span class="op" id="4415074">)</span><span class="op" id="4415075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415079">if</span>&nbsp;<span class="ident" id="4415082">err</span>&nbsp;<span class="op" id="4415086">!=</span>&nbsp;<span class="ident" id="4415089">nil</span>&nbsp;<span class="op" id="4415093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415098">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415110">}</span>&nbsp;<span class="keyword" id="4415112">else</span>&nbsp;<span class="op" id="4415117">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415121">b</span>&nbsp;<span class="op" id="4415123">|=</span>&nbsp;<span class="builtintype" id="4415126">uint8</span><span class="op" id="4415131">(</span><span class="ident" id="4415132">t</span><span class="op" id="4415133">.</span><span class="ident" id="4415134">tag</span><span class="op" id="4415137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415141">err</span>&nbsp;<span class="op" id="4415145">=</span>&nbsp;<span class="ident" id="4415147">out</span><span class="op" id="4415150">.</span><span class="ident" id="4415151">WriteByte</span><span class="op" id="4415160">(</span><span class="ident" id="4415161">b</span><span class="op" id="4415162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415166">if</span>&nbsp;<span class="ident" id="4415169">err</span>&nbsp;<span class="op" id="4415173">!=</span>&nbsp;<span class="ident" id="4415176">nil</span>&nbsp;<span class="op" id="4415180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415185">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415194">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415201">if</span>&nbsp;<span class="ident" id="4415204">t</span><span class="op" id="4415205">.</span><span class="ident" id="4415206">length</span>&nbsp;<span class="op" id="4415213">&gt;=</span>&nbsp;<span class="num" id="4415216">128</span>&nbsp;<span class="op" id="4415220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415224">l</span>&nbsp;<span class="op" id="4415226">:=</span>&nbsp;<span class="ident" id="4415229">lengthLength</span><span class="op" id="4415241">(</span><span class="ident" id="4415242">t</span><span class="op" id="4415243">.</span><span class="ident" id="4415244">length</span><span class="op" id="4415250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415254">err</span>&nbsp;<span class="op" id="4415258">=</span>&nbsp;<span class="ident" id="4415260">out</span><span class="op" id="4415263">.</span><span class="ident" id="4415264">WriteByte</span><span class="op" id="4415273">(</span><span class="num" id="4415274">0x80</span>&nbsp;<span class="op" id="4415279">|</span>&nbsp;<span class="builtintype" id="4415281">byte</span><span class="op" id="4415285">(</span><span class="ident" id="4415286">l</span><span class="op" id="4415287">)</span><span class="op" id="4415288">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415292">if</span>&nbsp;<span class="ident" id="4415295">err</span>&nbsp;<span class="op" id="4415299">!=</span>&nbsp;<span class="ident" id="4415302">nil</span>&nbsp;<span class="op" id="4415306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415311">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415324">err</span>&nbsp;<span class="op" id="4415328">=</span>&nbsp;<span class="ident" id="4415330">marshalLength</span><span class="op" id="4415343">(</span><span class="ident" id="4415344">out</span><span class="op" id="4415347">,</span>&nbsp;<span class="ident" id="4415349">t</span><span class="op" id="4415350">.</span><span class="ident" id="4415351">length</span><span class="op" id="4415357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415361">if</span>&nbsp;<span class="ident" id="4415364">err</span>&nbsp;<span class="op" id="4415368">!=</span>&nbsp;<span class="ident" id="4415371">nil</span>&nbsp;<span class="op" id="4415375">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415380">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415392">}</span>&nbsp;<span class="keyword" id="4415394">else</span>&nbsp;<span class="op" id="4415399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415403">err</span>&nbsp;<span class="op" id="4415407">=</span>&nbsp;<span class="ident" id="4415409">out</span><span class="op" id="4415412">.</span><span class="ident" id="4415413">WriteByte</span><span class="op" id="4415422">(</span><span class="builtintype" id="4415423">byte</span><span class="op" id="4415427">(</span><span class="ident" id="4415428">t</span><span class="op" id="4415429">.</span><span class="ident" id="4415430">length</span><span class="op" id="4415436">)</span><span class="op" id="4415437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415441">if</span>&nbsp;<span class="ident" id="4415444">err</span>&nbsp;<span class="op" id="4415448">!=</span>&nbsp;<span class="ident" id="4415451">nil</span>&nbsp;<span class="op" id="4415455">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415460">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415476">return</span>&nbsp;<span class="ident" id="4415483">nil</span><br>
<span class="lineno">230</span><span class="op" id="4415487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4415490">func</span>&nbsp;<span class="ident" id="4415495">marshalBitString</span><span class="op" id="4415511">(</span><span class="ident" id="4415512">out</span>&nbsp;<span class="op" id="4415516">*</span><span class="ident" id="4415517">forkableWriter</span><span class="op" id="4415531">,</span>&nbsp;<span class="ident" id="4415533">b</span>&nbsp;<span class="ident" id="4415535">BitString</span><span class="op" id="4415544">)</span>&nbsp;<span class="op" id="4415546">(</span><span class="ident" id="4415547">err</span>&nbsp;<span class="builtintype" id="4415551">error</span><span class="op" id="4415556">)</span>&nbsp;<span class="op" id="4415558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415561">paddingBits</span>&nbsp;<span class="op" id="4415573">:=</span>&nbsp;<span class="builtintype" id="4415576">byte</span><span class="op" id="4415580">(</span><span class="op" id="4415581">(</span><span class="num" id="4415582">8</span>&nbsp;<span class="op" id="4415584">-</span>&nbsp;<span class="ident" id="4415586">b</span><span class="op" id="4415587">.</span><span class="ident" id="4415588">BitLength</span><span class="op" id="4415597">%</span><span class="num" id="4415598">8</span><span class="op" id="4415599">)</span>&nbsp;<span class="op" id="4415601">%</span>&nbsp;<span class="num" id="4415603">8</span><span class="op" id="4415604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415607">err</span>&nbsp;<span class="op" id="4415611">=</span>&nbsp;<span class="ident" id="4415613">out</span><span class="op" id="4415616">.</span><span class="ident" id="4415617">WriteByte</span><span class="op" id="4415626">(</span><span class="ident" id="4415627">paddingBits</span><span class="op" id="4415638">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415641">if</span>&nbsp;<span class="ident" id="4415644">err</span>&nbsp;<span class="op" id="4415648">!=</span>&nbsp;<span class="ident" id="4415651">nil</span>&nbsp;<span class="op" id="4415655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415659">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415670">_</span><span class="op" id="4415671">,</span>&nbsp;<span class="ident" id="4415673">err</span>&nbsp;<span class="op" id="4415677">=</span>&nbsp;<span class="ident" id="4415679">out</span><span class="op" id="4415682">.</span><span class="ident" id="4415683">Write</span><span class="op" id="4415688">(</span><span class="ident" id="4415689">b</span><span class="op" id="4415690">.</span><span class="ident" id="4415691">Bytes</span><span class="op" id="4415696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415699">return</span><br>
<span class="lineno">240</span><span class="op" id="4415706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4415709">func</span>&nbsp;<span class="ident" id="4415714">marshalObjectIdentifier</span><span class="op" id="4415737">(</span><span class="ident" id="4415738">out</span>&nbsp;<span class="op" id="4415742">*</span><span class="ident" id="4415743">forkableWriter</span><span class="op" id="4415757">,</span>&nbsp;<span class="ident" id="4415759">oid</span>&nbsp;<span class="op" id="4415763">[</span><span class="op" id="4415764">]</span><span class="builtintype" id="4415765">int</span><span class="op" id="4415768">)</span>&nbsp;<span class="op" id="4415770">(</span><span class="ident" id="4415771">err</span>&nbsp;<span class="builtintype" id="4415775">error</span><span class="op" id="4415780">)</span>&nbsp;<span class="op" id="4415782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415785">if</span>&nbsp;<span class="builtinfunc" id="4415788">len</span><span class="op" id="4415791">(</span><span class="ident" id="4415792">oid</span><span class="op" id="4415795">)</span>&nbsp;<span class="op" id="4415797">&lt;</span>&nbsp;<span class="num" id="4415799">2</span>&nbsp;<span class="op" id="4415801">||</span>&nbsp;<span class="ident" id="4415804">oid</span><span class="op" id="4415807">[</span><span class="num" id="4415808">0</span><span class="op" id="4415809">]</span>&nbsp;<span class="op" id="4415811">&gt;</span>&nbsp;<span class="num" id="4415813">2</span>&nbsp;<span class="op" id="4415815">||</span>&nbsp;<span class="op" id="4415818">(</span><span class="ident" id="4415819">oid</span><span class="op" id="4415822">[</span><span class="num" id="4415823">0</span><span class="op" id="4415824">]</span>&nbsp;<span class="op" id="4415826">&lt;</span>&nbsp;<span class="num" id="4415828">2</span>&nbsp;<span class="op" id="4415830">&amp;&amp;</span>&nbsp;<span class="ident" id="4415833">oid</span><span class="op" id="4415836">[</span><span class="num" id="4415837">1</span><span class="op" id="4415838">]</span>&nbsp;<span class="op" id="4415840">&gt;=</span>&nbsp;<span class="num" id="4415843">40</span><span class="op" id="4415845">)</span>&nbsp;<span class="op" id="4415847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415851">return</span>&nbsp;<span class="ident" id="4415858">StructuralError</span><span class="op" id="4415873">{</span><span class="string" id="4415874">&#34;invalid&nbsp;object&nbsp;identifier&#34;</span><span class="op" id="4415901">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415908">err</span>&nbsp;<span class="op" id="4415912">=</span>&nbsp;<span class="ident" id="4415914">marshalBase128Int</span><span class="op" id="4415931">(</span><span class="ident" id="4415932">out</span><span class="op" id="4415935">,</span>&nbsp;<span class="ident" id="4415937">int64</span><span class="op" id="4415942">(</span><span class="ident" id="4415943">oid</span><span class="op" id="4415946">[</span><span class="num" id="4415947">0</span><span class="op" id="4415948">]</span><span class="op" id="4415949">*</span><span class="num" id="4415950">40</span><span class="op" id="4415952">+</span><span class="ident" id="4415953">oid</span><span class="op" id="4415956">[</span><span class="num" id="4415957">1</span><span class="op" id="4415958">]</span><span class="op" id="4415959">)</span><span class="op" id="4415960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415963">if</span>&nbsp;<span class="ident" id="4415966">err</span>&nbsp;<span class="op" id="4415970">!=</span>&nbsp;<span class="ident" id="4415973">nil</span>&nbsp;<span class="op" id="4415977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415981">return</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415992">for</span>&nbsp;<span class="ident" id="4415996">i</span>&nbsp;<span class="op" id="4415998">:=</span>&nbsp;<span class="num" id="4416001">2</span><span class="op" id="4416002">;</span>&nbsp;<span class="ident" id="4416004">i</span>&nbsp;<span class="op" id="4416006">&lt;</span>&nbsp;<span class="builtinfunc" id="4416008">len</span><span class="op" id="4416011">(</span><span class="ident" id="4416012">oid</span><span class="op" id="4416015">)</span><span class="op" id="4416016">;</span>&nbsp;<span class="ident" id="4416018">i</span><span class="op" id="4416019">++</span>&nbsp;<span class="op" id="4416022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416026">err</span>&nbsp;<span class="op" id="4416030">=</span>&nbsp;<span class="ident" id="4416032">marshalBase128Int</span><span class="op" id="4416049">(</span><span class="ident" id="4416050">out</span><span class="op" id="4416053">,</span>&nbsp;<span class="ident" id="4416055">int64</span><span class="op" id="4416060">(</span><span class="ident" id="4416061">oid</span><span class="op" id="4416064">[</span><span class="ident" id="4416065">i</span><span class="op" id="4416066">]</span><span class="op" id="4416067">)</span><span class="op" id="4416068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416072">if</span>&nbsp;<span class="ident" id="4416075">err</span>&nbsp;<span class="op" id="4416079">!=</span>&nbsp;<span class="ident" id="4416082">nil</span>&nbsp;<span class="op" id="4416086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416091">return</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4416100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4416103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416107">return</span><br>
<span class="lineno"></span><span class="op" id="4416114">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="4416117">func</span>&nbsp;<span class="ident" id="4416122">marshalPrintableString</span><span class="op" id="4416144">(</span><span class="ident" id="4416145">out</span>&nbsp;<span class="op" id="4416149">*</span><span class="ident" id="4416150">forkableWriter</span><span class="op" id="4416164">,</span>&nbsp;<span class="ident" id="4416166">s</span>&nbsp;<span class="builtintype" id="4416168">string</span><span class="op" id="4416174">)</span>&nbsp;<span class="op" id="4416176">(</span><span class="ident" id="4416177">err</span>&nbsp;<span class="builtintype" id="4416181">error</span><span class="op" id="4416186">)</span>&nbsp;<span class="op" id="4416188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416191">b</span>&nbsp;<span class="op" id="4416193">:=</span>&nbsp;<span class="op" id="4416196">[</span><span class="op" id="4416197">]</span><span class="builtintype" id="4416198">byte</span><span class="op" id="4416202">(</span><span class="ident" id="4416203">s</span><span class="op" id="4416204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416207">for</span>&nbsp;<span class="ident" id="4416211">_</span><span class="op" id="4416212">,</span>&nbsp;<span class="ident" id="4416214">c</span>&nbsp;<span class="op" id="4416216">:=</span>&nbsp;<span class="keyword" id="4416219">range</span>&nbsp;<span class="ident" id="4416225">b</span>&nbsp;<span class="op" id="4416227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416231">if</span>&nbsp;<span class="op" id="4416234">!</span><span class="ident" id="4416235">isPrintable</span><span class="op" id="4416246">(</span><span class="ident" id="4416247">c</span><span class="op" id="4416248">)</span>&nbsp;<span class="op" id="4416250">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416255">return</span>&nbsp;<span class="ident" id="4416262">StructuralError</span><span class="op" id="4416277">{</span><span class="string" id="4416278">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4416322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4416326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4416329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416333">_</span><span class="op" id="4416334">,</span>&nbsp;<span class="ident" id="4416336">err</span>&nbsp;<span class="op" id="4416340">=</span>&nbsp;<span class="ident" id="4416342">out</span><span class="op" id="4416345">.</span><span class="ident" id="4416346">Write</span><span class="op" id="4416351">(</span><span class="ident" id="4416352">b</span><span class="op" id="4416353">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416356">return</span><br>
<span class="lineno"></span><span class="op" id="4416363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4416366">func</span>&nbsp;<span class="ident" id="4416371">marshalIA5String</span><span class="op" id="4416387">(</span><span class="ident" id="4416388">out</span>&nbsp;<span class="op" id="4416392">*</span><span class="ident" id="4416393">forkableWriter</span><span class="op" id="4416407">,</span>&nbsp;<span class="ident" id="4416409">s</span>&nbsp;<span class="builtintype" id="4416411">string</span><span class="op" id="4416417">)</span>&nbsp;<span class="op" id="4416419">(</span><span class="ident" id="4416420">err</span>&nbsp;<span class="builtintype" id="4416424">error</span><span class="op" id="4416429">)</span>&nbsp;<span class="op" id="4416431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416434">b</span>&nbsp;<span class="op" id="4416436">:=</span>&nbsp;<span class="op" id="4416439">[</span><span class="op" id="4416440">]</span><span class="builtintype" id="4416441">byte</span><span class="op" id="4416445">(</span><span class="ident" id="4416446">s</span><span class="op" id="4416447">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416450">for</span>&nbsp;<span class="ident" id="4416454">_</span><span class="op" id="4416455">,</span>&nbsp;<span class="ident" id="4416457">c</span>&nbsp;<span class="op" id="4416459">:=</span>&nbsp;<span class="keyword" id="4416462">range</span>&nbsp;<span class="ident" id="4416468">b</span>&nbsp;<span class="op" id="4416470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416474">if</span>&nbsp;<span class="ident" id="4416477">c</span>&nbsp;<span class="op" id="4416479">&gt;</span>&nbsp;<span class="num" id="4416481">127</span>&nbsp;<span class="op" id="4416485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416490">return</span>&nbsp;<span class="ident" id="4416497">StructuralError</span><span class="op" id="4416512">{</span><span class="string" id="4416513">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4416551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4416555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4416558">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416562">_</span><span class="op" id="4416563">,</span>&nbsp;<span class="ident" id="4416565">err</span>&nbsp;<span class="op" id="4416569">=</span>&nbsp;<span class="ident" id="4416571">out</span><span class="op" id="4416574">.</span><span class="ident" id="4416575">Write</span><span class="op" id="4416580">(</span><span class="ident" id="4416581">b</span><span class="op" id="4416582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416585">return</span><br>
<span class="lineno"></span><span class="op" id="4416592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="4416595">func</span>&nbsp;<span class="ident" id="4416600">marshalUTF8String</span><span class="op" id="4416617">(</span><span class="ident" id="4416618">out</span>&nbsp;<span class="op" id="4416622">*</span><span class="ident" id="4416623">forkableWriter</span><span class="op" id="4416637">,</span>&nbsp;<span class="ident" id="4416639">s</span>&nbsp;<span class="builtintype" id="4416641">string</span><span class="op" id="4416647">)</span>&nbsp;<span class="op" id="4416649">(</span><span class="ident" id="4416650">err</span>&nbsp;<span class="builtintype" id="4416654">error</span><span class="op" id="4416659">)</span>&nbsp;<span class="op" id="4416661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416664">_</span><span class="op" id="4416665">,</span>&nbsp;<span class="ident" id="4416667">err</span>&nbsp;<span class="op" id="4416671">=</span>&nbsp;<span class="ident" id="4416673">out</span><span class="op" id="4416676">.</span><span class="ident" id="4416677">Write</span><span class="op" id="4416682">(</span><span class="op" id="4416683">[</span><span class="op" id="4416684">]</span><span class="builtintype" id="4416685">byte</span><span class="op" id="4416689">(</span><span class="ident" id="4416690">s</span><span class="op" id="4416691">)</span><span class="op" id="4416692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416695">return</span><br>
<span class="lineno"></span><span class="op" id="4416702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="keyword" id="4416705">func</span>&nbsp;<span class="ident" id="4416710">marshalTwoDigits</span><span class="op" id="4416726">(</span><span class="ident" id="4416727">out</span>&nbsp;<span class="op" id="4416731">*</span><span class="ident" id="4416732">forkableWriter</span><span class="op" id="4416746">,</span>&nbsp;<span class="ident" id="4416748">v</span>&nbsp;<span class="builtintype" id="4416750">int</span><span class="op" id="4416753">)</span>&nbsp;<span class="op" id="4416755">(</span><span class="ident" id="4416756">err</span>&nbsp;<span class="builtintype" id="4416760">error</span><span class="op" id="4416765">)</span>&nbsp;<span class="op" id="4416767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416770">err</span>&nbsp;<span class="op" id="4416774">=</span>&nbsp;<span class="ident" id="4416776">out</span><span class="op" id="4416779">.</span><span class="ident" id="4416780">WriteByte</span><span class="op" id="4416789">(</span><span class="builtintype" id="4416790">byte</span><span class="op" id="4416794">(</span><span class="string" id="4416795">&#39;0&#39;</span>&nbsp;<span class="op" id="4416799">+</span>&nbsp;<span class="op" id="4416801">(</span><span class="ident" id="4416802">v</span><span class="op" id="4416803">/</span><span class="num" id="4416804">10</span><span class="op" id="4416806">)</span><span class="op" id="4416807">%</span><span class="num" id="4416808">10</span><span class="op" id="4416810">)</span><span class="op" id="4416811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416814">if</span>&nbsp;<span class="ident" id="4416817">err</span>&nbsp;<span class="op" id="4416821">!=</span>&nbsp;<span class="ident" id="4416824">nil</span>&nbsp;<span class="op" id="4416828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416832">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4416840">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416843">return</span>&nbsp;<span class="ident" id="4416850">out</span><span class="op" id="4416853">.</span><span class="ident" id="4416854">WriteByte</span><span class="op" id="4416863">(</span><span class="builtintype" id="4416864">byte</span><span class="op" id="4416868">(</span><span class="string" id="4416869">&#39;0&#39;</span>&nbsp;<span class="op" id="4416873">+</span>&nbsp;<span class="ident" id="4416875">v</span><span class="op" id="4416876">%</span><span class="num" id="4416877">10</span><span class="op" id="4416879">)</span><span class="op" id="4416880">)</span><br>
<span class="lineno"></span><span class="op" id="4416882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4416885">func</span>&nbsp;<span class="ident" id="4416890">marshalFourDigits</span><span class="op" id="4416907">(</span><span class="ident" id="4416908">out</span>&nbsp;<span class="op" id="4416912">*</span><span class="ident" id="4416913">forkableWriter</span><span class="op" id="4416927">,</span>&nbsp;<span class="ident" id="4416929">v</span>&nbsp;<span class="builtintype" id="4416931">int</span><span class="op" id="4416934">)</span>&nbsp;<span class="op" id="4416936">(</span><span class="ident" id="4416937">err</span>&nbsp;<span class="builtintype" id="4416941">error</span><span class="op" id="4416946">)</span>&nbsp;<span class="op" id="4416948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416951">var</span>&nbsp;<span class="ident" id="4416955">bytes</span>&nbsp;<span class="op" id="4416961">[</span><span class="num" id="4416962">4</span><span class="op" id="4416963">]</span><span class="builtintype" id="4416964">byte</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416970">for</span>&nbsp;<span class="ident" id="4416974">i</span>&nbsp;<span class="op" id="4416976">:=</span>&nbsp;<span class="keyword" id="4416979">range</span>&nbsp;<span class="ident" id="4416985">bytes</span>&nbsp;<span class="op" id="4416991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416995">bytes</span><span class="op" id="4417000">[</span><span class="num" id="4417001">3</span><span class="op" id="4417002">-</span><span class="ident" id="4417003">i</span><span class="op" id="4417004">]</span>&nbsp;<span class="op" id="4417006">=</span>&nbsp;<span class="string" id="4417008">&#39;0&#39;</span>&nbsp;<span class="op" id="4417012">+</span>&nbsp;<span class="builtintype" id="4417014">byte</span><span class="op" id="4417018">(</span><span class="ident" id="4417019">v</span><span class="op" id="4417020">%</span><span class="num" id="4417021">10</span><span class="op" id="4417023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417027">v</span>&nbsp;<span class="op" id="4417029">/=</span>&nbsp;<span class="num" id="4417032">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4417036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417039">_</span><span class="op" id="4417040">,</span>&nbsp;<span class="ident" id="4417042">err</span>&nbsp;<span class="op" id="4417046">=</span>&nbsp;<span class="ident" id="4417048">out</span><span class="op" id="4417051">.</span><span class="ident" id="4417052">Write</span><span class="op" id="4417057">(</span><span class="ident" id="4417058">bytes</span><span class="op" id="4417063">[</span><span class="op" id="4417064">:</span><span class="op" id="4417065">]</span><span class="op" id="4417066">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417069">return</span><br>
<span class="lineno"></span><span class="op" id="4417076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4417079">func</span>&nbsp;<span class="ident" id="4417084">outsideUTCRange</span><span class="op" id="4417099">(</span><span class="ident" id="4417100">t</span>&nbsp;<span class="ident" id="4417102">time</span><span class="op" id="4417106">.</span><span class="ident" id="4417107">Time</span><span class="op" id="4417111">)</span>&nbsp;<span class="builtintype" id="4417113">bool</span>&nbsp;<span class="op" id="4417118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417121">year</span>&nbsp;<span class="op" id="4417126">:=</span>&nbsp;<span class="ident" id="4417129">t</span><span class="op" id="4417130">.</span><span class="ident" id="4417131">Year</span><span class="op" id="4417135">(</span><span class="op" id="4417136">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417139">return</span>&nbsp;<span class="ident" id="4417146">year</span>&nbsp;<span class="op" id="4417151">&lt;</span>&nbsp;<span class="num" id="4417153">1950</span>&nbsp;<span class="op" id="4417158">||</span>&nbsp;<span class="ident" id="4417161">year</span>&nbsp;<span class="op" id="4417166">&gt;=</span>&nbsp;<span class="num" id="4417169">2050</span><br>
<span class="lineno"></span><span class="op" id="4417174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4417177">func</span>&nbsp;<span class="ident" id="4417182">marshalUTCTime</span><span class="op" id="4417196">(</span><span class="ident" id="4417197">out</span>&nbsp;<span class="op" id="4417201">*</span><span class="ident" id="4417202">forkableWriter</span><span class="op" id="4417216">,</span>&nbsp;<span class="ident" id="4417218">t</span>&nbsp;<span class="ident" id="4417220">time</span><span class="op" id="4417224">.</span><span class="ident" id="4417225">Time</span><span class="op" id="4417229">)</span>&nbsp;<span class="op" id="4417231">(</span><span class="ident" id="4417232">err</span>&nbsp;<span class="builtintype" id="4417236">error</span><span class="op" id="4417241">)</span>&nbsp;<span class="op" id="4417243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417246">year</span>&nbsp;<span class="op" id="4417251">:=</span>&nbsp;<span class="ident" id="4417254">t</span><span class="op" id="4417255">.</span><span class="ident" id="4417256">Year</span><span class="op" id="4417260">(</span><span class="op" id="4417261">)</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417265">switch</span>&nbsp;<span class="op" id="4417272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417275">case</span>&nbsp;<span class="num" id="4417280">1950</span>&nbsp;<span class="op" id="4417285">&lt;=</span>&nbsp;<span class="ident" id="4417288">year</span>&nbsp;<span class="op" id="4417293">&amp;&amp;</span>&nbsp;<span class="ident" id="4417296">year</span>&nbsp;<span class="op" id="4417301">&lt;</span>&nbsp;<span class="num" id="4417303">2000</span><span class="op" id="4417307">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417311">err</span>&nbsp;<span class="op" id="4417315">=</span>&nbsp;<span class="ident" id="4417317">marshalTwoDigits</span><span class="op" id="4417333">(</span><span class="ident" id="4417334">out</span><span class="op" id="4417337">,</span>&nbsp;<span class="builtintype" id="4417339">int</span><span class="op" id="4417342">(</span><span class="ident" id="4417343">year</span><span class="op" id="4417347">-</span><span class="num" id="4417348">1900</span><span class="op" id="4417352">)</span><span class="op" id="4417353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417356">case</span>&nbsp;<span class="num" id="4417361">2000</span>&nbsp;<span class="op" id="4417366">&lt;=</span>&nbsp;<span class="ident" id="4417369">year</span>&nbsp;<span class="op" id="4417374">&amp;&amp;</span>&nbsp;<span class="ident" id="4417377">year</span>&nbsp;<span class="op" id="4417382">&lt;</span>&nbsp;<span class="num" id="4417384">2050</span><span class="op" id="4417388">:</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417392">err</span>&nbsp;<span class="op" id="4417396">=</span>&nbsp;<span class="ident" id="4417398">marshalTwoDigits</span><span class="op" id="4417414">(</span><span class="ident" id="4417415">out</span><span class="op" id="4417418">,</span>&nbsp;<span class="builtintype" id="4417420">int</span><span class="op" id="4417423">(</span><span class="ident" id="4417424">year</span><span class="op" id="4417428">-</span><span class="num" id="4417429">2000</span><span class="op" id="4417433">)</span><span class="op" id="4417434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417437">default</span><span class="op" id="4417444">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417448">return</span>&nbsp;<span class="ident" id="4417455">StructuralError</span><span class="op" id="4417470">{</span><span class="string" id="4417471">&#34;cannot&nbsp;represent&nbsp;time&nbsp;as&nbsp;UTCTime&#34;</span><span class="op" id="4417505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4417508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417511">if</span>&nbsp;<span class="ident" id="4417514">err</span>&nbsp;<span class="op" id="4417518">!=</span>&nbsp;<span class="ident" id="4417521">nil</span>&nbsp;<span class="op" id="4417525">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417529">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4417537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417541">return</span>&nbsp;<span class="ident" id="4417548">marshalTimeCommon</span><span class="op" id="4417565">(</span><span class="ident" id="4417566">out</span><span class="op" id="4417569">,</span>&nbsp;<span class="ident" id="4417571">t</span><span class="op" id="4417572">)</span><br>
<span class="lineno"></span><span class="op" id="4417574">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="4417577">func</span>&nbsp;<span class="ident" id="4417582">marshalGeneralizedTime</span><span class="op" id="4417604">(</span><span class="ident" id="4417605">out</span>&nbsp;<span class="op" id="4417609">*</span><span class="ident" id="4417610">forkableWriter</span><span class="op" id="4417624">,</span>&nbsp;<span class="ident" id="4417626">t</span>&nbsp;<span class="ident" id="4417628">time</span><span class="op" id="4417632">.</span><span class="ident" id="4417633">Time</span><span class="op" id="4417637">)</span>&nbsp;<span class="op" id="4417639">(</span><span class="ident" id="4417640">err</span>&nbsp;<span class="builtintype" id="4417644">error</span><span class="op" id="4417649">)</span>&nbsp;<span class="op" id="4417651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417654">year</span>&nbsp;<span class="op" id="4417659">:=</span>&nbsp;<span class="ident" id="4417662">t</span><span class="op" id="4417663">.</span><span class="ident" id="4417664">Year</span><span class="op" id="4417668">(</span><span class="op" id="4417669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417672">if</span>&nbsp;<span class="ident" id="4417675">year</span>&nbsp;<span class="op" id="4417680">&lt;</span>&nbsp;<span class="num" id="4417682">0</span>&nbsp;<span class="op" id="4417684">||</span>&nbsp;<span class="ident" id="4417687">year</span>&nbsp;<span class="op" id="4417692">&gt;</span>&nbsp;<span class="num" id="4417694">9999</span>&nbsp;<span class="op" id="4417699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417703">return</span>&nbsp;<span class="ident" id="4417710">StructuralError</span><span class="op" id="4417725">{</span><span class="string" id="4417726">&#34;cannot&nbsp;represent&nbsp;time&nbsp;as&nbsp;GeneralizedTime&#34;</span><span class="op" id="4417768">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4417771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417774">if</span>&nbsp;<span class="ident" id="4417777">err</span>&nbsp;<span class="op" id="4417781">=</span>&nbsp;<span class="ident" id="4417783">marshalFourDigits</span><span class="op" id="4417800">(</span><span class="ident" id="4417801">out</span><span class="op" id="4417804">,</span>&nbsp;<span class="ident" id="4417806">year</span><span class="op" id="4417810">)</span><span class="op" id="4417811">;</span>&nbsp;<span class="ident" id="4417813">err</span>&nbsp;<span class="op" id="4417817">!=</span>&nbsp;<span class="ident" id="4417820">nil</span>&nbsp;<span class="op" id="4417824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417828">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4417836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417840">return</span>&nbsp;<span class="ident" id="4417847">marshalTimeCommon</span><span class="op" id="4417864">(</span><span class="ident" id="4417865">out</span><span class="op" id="4417868">,</span>&nbsp;<span class="ident" id="4417870">t</span><span class="op" id="4417871">)</span><br>
<span class="lineno"></span><span class="op" id="4417873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4417876">func</span>&nbsp;<span class="ident" id="4417881">marshalTimeCommon</span><span class="op" id="4417898">(</span><span class="ident" id="4417899">out</span>&nbsp;<span class="op" id="4417903">*</span><span class="ident" id="4417904">forkableWriter</span><span class="op" id="4417918">,</span>&nbsp;<span class="ident" id="4417920">t</span>&nbsp;<span class="ident" id="4417922">time</span><span class="op" id="4417926">.</span><span class="ident" id="4417927">Time</span><span class="op" id="4417931">)</span>&nbsp;<span class="op" id="4417933">(</span><span class="ident" id="4417934">err</span>&nbsp;<span class="builtintype" id="4417938">error</span><span class="op" id="4417943">)</span>&nbsp;<span class="op" id="4417945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417948">_</span><span class="op" id="4417949">,</span>&nbsp;<span class="ident" id="4417951">month</span><span class="op" id="4417956">,</span>&nbsp;<span class="ident" id="4417958">day</span>&nbsp;<span class="op" id="4417962">:=</span>&nbsp;<span class="ident" id="4417965">t</span><span class="op" id="4417966">.</span><span class="ident" id="4417967">Date</span><span class="op" id="4417971">(</span><span class="op" id="4417972">)</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417976">err</span>&nbsp;<span class="op" id="4417980">=</span>&nbsp;<span class="ident" id="4417982">marshalTwoDigits</span><span class="op" id="4417998">(</span><span class="ident" id="4417999">out</span><span class="op" id="4418002">,</span>&nbsp;<span class="builtintype" id="4418004">int</span><span class="op" id="4418007">(</span><span class="ident" id="4418008">month</span><span class="op" id="4418013">)</span><span class="op" id="4418014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418017">if</span>&nbsp;<span class="ident" id="4418020">err</span>&nbsp;<span class="op" id="4418024">!=</span>&nbsp;<span class="ident" id="4418027">nil</span>&nbsp;<span class="op" id="4418031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418035">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418043">}</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418047">err</span>&nbsp;<span class="op" id="4418051">=</span>&nbsp;<span class="ident" id="4418053">marshalTwoDigits</span><span class="op" id="4418069">(</span><span class="ident" id="4418070">out</span><span class="op" id="4418073">,</span>&nbsp;<span class="ident" id="4418075">day</span><span class="op" id="4418078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418081">if</span>&nbsp;<span class="ident" id="4418084">err</span>&nbsp;<span class="op" id="4418088">!=</span>&nbsp;<span class="ident" id="4418091">nil</span>&nbsp;<span class="op" id="4418095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418099">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418107">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418111">hour</span><span class="op" id="4418115">,</span>&nbsp;<span class="ident" id="4418117">min</span><span class="op" id="4418120">,</span>&nbsp;<span class="ident" id="4418122">sec</span>&nbsp;<span class="op" id="4418126">:=</span>&nbsp;<span class="ident" id="4418129">t</span><span class="op" id="4418130">.</span><span class="ident" id="4418131">Clock</span><span class="op" id="4418136">(</span><span class="op" id="4418137">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418141">err</span>&nbsp;<span class="op" id="4418145">=</span>&nbsp;<span class="ident" id="4418147">marshalTwoDigits</span><span class="op" id="4418163">(</span><span class="ident" id="4418164">out</span><span class="op" id="4418167">,</span>&nbsp;<span class="ident" id="4418169">hour</span><span class="op" id="4418173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418176">if</span>&nbsp;<span class="ident" id="4418179">err</span>&nbsp;<span class="op" id="4418183">!=</span>&nbsp;<span class="ident" id="4418186">nil</span>&nbsp;<span class="op" id="4418190">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418194">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418206">err</span>&nbsp;<span class="op" id="4418210">=</span>&nbsp;<span class="ident" id="4418212">marshalTwoDigits</span><span class="op" id="4418228">(</span><span class="ident" id="4418229">out</span><span class="op" id="4418232">,</span>&nbsp;<span class="ident" id="4418234">min</span><span class="op" id="4418237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418240">if</span>&nbsp;<span class="ident" id="4418243">err</span>&nbsp;<span class="op" id="4418247">!=</span>&nbsp;<span class="ident" id="4418250">nil</span>&nbsp;<span class="op" id="4418254">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418258">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418270">err</span>&nbsp;<span class="op" id="4418274">=</span>&nbsp;<span class="ident" id="4418276">marshalTwoDigits</span><span class="op" id="4418292">(</span><span class="ident" id="4418293">out</span><span class="op" id="4418296">,</span>&nbsp;<span class="ident" id="4418298">sec</span><span class="op" id="4418301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418304">if</span>&nbsp;<span class="ident" id="4418307">err</span>&nbsp;<span class="op" id="4418311">!=</span>&nbsp;<span class="ident" id="4418314">nil</span>&nbsp;<span class="op" id="4418318">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418322">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418334">_</span><span class="op" id="4418335">,</span>&nbsp;<span class="ident" id="4418337">offset</span>&nbsp;<span class="op" id="4418344">:=</span>&nbsp;<span class="ident" id="4418347">t</span><span class="op" id="4418348">.</span><span class="ident" id="4418349">Zone</span><span class="op" id="4418353">(</span><span class="op" id="4418354">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418358">switch</span>&nbsp;<span class="op" id="4418365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418368">case</span>&nbsp;<span class="ident" id="4418373">offset</span><span class="op" id="4418379">/</span><span class="num" id="4418380">60</span>&nbsp;<span class="op" id="4418383">==</span>&nbsp;<span class="num" id="4418386">0</span><span class="op" id="4418387">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418391">err</span>&nbsp;<span class="op" id="4418395">=</span>&nbsp;<span class="ident" id="4418397">out</span><span class="op" id="4418400">.</span><span class="ident" id="4418401">WriteByte</span><span class="op" id="4418410">(</span><span class="string" id="4418411">&#39;Z&#39;</span><span class="op" id="4418414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418418">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418426">case</span>&nbsp;<span class="ident" id="4418431">offset</span>&nbsp;<span class="op" id="4418438">&gt;</span>&nbsp;<span class="num" id="4418440">0</span><span class="op" id="4418441">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418445">err</span>&nbsp;<span class="op" id="4418449">=</span>&nbsp;<span class="ident" id="4418451">out</span><span class="op" id="4418454">.</span><span class="ident" id="4418455">WriteByte</span><span class="op" id="4418464">(</span><span class="string" id="4418465">&#39;+&#39;</span><span class="op" id="4418468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418471">case</span>&nbsp;<span class="ident" id="4418476">offset</span>&nbsp;<span class="op" id="4418483">&lt;</span>&nbsp;<span class="num" id="4418485">0</span><span class="op" id="4418486">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418490">err</span>&nbsp;<span class="op" id="4418494">=</span>&nbsp;<span class="ident" id="4418496">out</span><span class="op" id="4418499">.</span><span class="ident" id="4418500">WriteByte</span><span class="op" id="4418509">(</span><span class="string" id="4418510">&#39;-&#39;</span><span class="op" id="4418513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418520">if</span>&nbsp;<span class="ident" id="4418523">err</span>&nbsp;<span class="op" id="4418527">!=</span>&nbsp;<span class="ident" id="4418530">nil</span>&nbsp;<span class="op" id="4418534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418538">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418550">offsetMinutes</span>&nbsp;<span class="op" id="4418564">:=</span>&nbsp;<span class="ident" id="4418567">offset</span>&nbsp;<span class="op" id="4418574">/</span>&nbsp;<span class="num" id="4418576">60</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418580">if</span>&nbsp;<span class="ident" id="4418583">offsetMinutes</span>&nbsp;<span class="op" id="4418597">&lt;</span>&nbsp;<span class="num" id="4418599">0</span>&nbsp;<span class="op" id="4418601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418605">offsetMinutes</span>&nbsp;<span class="op" id="4418619">=</span>&nbsp;<span class="op" id="4418621">-</span><span class="ident" id="4418622">offsetMinutes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418641">err</span>&nbsp;<span class="op" id="4418645">=</span>&nbsp;<span class="ident" id="4418647">marshalTwoDigits</span><span class="op" id="4418663">(</span><span class="ident" id="4418664">out</span><span class="op" id="4418667">,</span>&nbsp;<span class="ident" id="4418669">offsetMinutes</span><span class="op" id="4418682">/</span><span class="num" id="4418683">60</span><span class="op" id="4418685">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418688">if</span>&nbsp;<span class="ident" id="4418691">err</span>&nbsp;<span class="op" id="4418695">!=</span>&nbsp;<span class="ident" id="4418698">nil</span>&nbsp;<span class="op" id="4418702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418706">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418718">err</span>&nbsp;<span class="op" id="4418722">=</span>&nbsp;<span class="ident" id="4418724">marshalTwoDigits</span><span class="op" id="4418740">(</span><span class="ident" id="4418741">out</span><span class="op" id="4418744">,</span>&nbsp;<span class="ident" id="4418746">offsetMinutes</span><span class="op" id="4418759">%</span><span class="num" id="4418760">60</span><span class="op" id="4418762">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418765">return</span><br>
<span class="lineno"></span><span class="op" id="4418772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4418775">func</span>&nbsp;<span class="ident" id="4418780">stripTagAndLength</span><span class="op" id="4418797">(</span><span class="ident" id="4418798">in</span>&nbsp;<span class="op" id="4418801">[</span><span class="op" id="4418802">]</span><span class="builtintype" id="4418803">byte</span><span class="op" id="4418807">)</span>&nbsp;<span class="op" id="4418809">[</span><span class="op" id="4418810">]</span><span class="builtintype" id="4418811">byte</span>&nbsp;<span class="op" id="4418816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418819">_</span><span class="op" id="4418820">,</span>&nbsp;<span class="ident" id="4418822">offset</span><span class="op" id="4418828">,</span>&nbsp;<span class="ident" id="4418830">err</span>&nbsp;<span class="op" id="4418834">:=</span>&nbsp;<span class="ident" id="4418837">parseTagAndLength</span><span class="op" id="4418854">(</span><span class="ident" id="4418855">in</span><span class="op" id="4418857">,</span>&nbsp;<span class="num" id="4418859">0</span><span class="op" id="4418860">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418863">if</span>&nbsp;<span class="ident" id="4418866">err</span>&nbsp;<span class="op" id="4418870">!=</span>&nbsp;<span class="ident" id="4418873">nil</span>&nbsp;<span class="op" id="4418877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418881">return</span>&nbsp;<span class="ident" id="4418888">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418895">return</span>&nbsp;<span class="ident" id="4418902">in</span><span class="op" id="4418904">[</span><span class="ident" id="4418905">offset</span><span class="op" id="4418911">:</span><span class="op" id="4418912">]</span><br>
<span class="lineno"></span><span class="op" id="4418914">}</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="keyword" id="4418917">func</span>&nbsp;<span class="ident" id="4418922">marshalBody</span><span class="op" id="4418933">(</span><span class="ident" id="4418934">out</span>&nbsp;<span class="op" id="4418938">*</span><span class="ident" id="4418939">forkableWriter</span><span class="op" id="4418953">,</span>&nbsp;<span class="ident" id="4418955">value</span>&nbsp;<span class="ident" id="4418961">reflect</span><span class="op" id="4418968">.</span><span class="ident" id="4418969">Value</span><span class="op" id="4418974">,</span>&nbsp;<span class="ident" id="4418976">params</span>&nbsp;<span class="ident" id="4418983">fieldParameters</span><span class="op" id="4418998">)</span>&nbsp;<span class="op" id="4419000">(</span><span class="ident" id="4419001">err</span>&nbsp;<span class="builtintype" id="4419005">error</span><span class="op" id="4419010">)</span>&nbsp;<span class="op" id="4419012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419015">switch</span>&nbsp;<span class="ident" id="4419022">value</span><span class="op" id="4419027">.</span><span class="ident" id="4419028">Type</span><span class="op" id="4419032">(</span><span class="op" id="4419033">)</span>&nbsp;<span class="op" id="4419035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419038">case</span>&nbsp;<span class="ident" id="4419043">timeType</span><span class="op" id="4419051">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419055">t</span>&nbsp;<span class="op" id="4419057">:=</span>&nbsp;<span class="ident" id="4419060">value</span><span class="op" id="4419065">.</span><span class="ident" id="4419066">Interface</span><span class="op" id="4419075">(</span><span class="op" id="4419076">)</span><span class="op" id="4419077">.</span><span class="op" id="4419078">(</span><span class="ident" id="4419079">time</span><span class="op" id="4419083">.</span><span class="ident" id="4419084">Time</span><span class="op" id="4419088">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419092">if</span>&nbsp;<span class="ident" id="4419095">outsideUTCRange</span><span class="op" id="4419110">(</span><span class="ident" id="4419111">t</span><span class="op" id="4419112">)</span>&nbsp;<span class="op" id="4419114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419119">return</span>&nbsp;<span class="ident" id="4419126">marshalGeneralizedTime</span><span class="op" id="4419148">(</span><span class="ident" id="4419149">out</span><span class="op" id="4419152">,</span>&nbsp;<span class="ident" id="4419154">t</span><span class="op" id="4419155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419159">}</span>&nbsp;<span class="keyword" id="4419161">else</span>&nbsp;<span class="op" id="4419166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419171">return</span>&nbsp;<span class="ident" id="4419178">marshalUTCTime</span><span class="op" id="4419192">(</span><span class="ident" id="4419193">out</span><span class="op" id="4419196">,</span>&nbsp;<span class="ident" id="4419198">t</span><span class="op" id="4419199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419203">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419206">case</span>&nbsp;<span class="ident" id="4419211">bitStringType</span><span class="op" id="4419224">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419228">return</span>&nbsp;<span class="ident" id="4419235">marshalBitString</span><span class="op" id="4419251">(</span><span class="ident" id="4419252">out</span><span class="op" id="4419255">,</span>&nbsp;<span class="ident" id="4419257">value</span><span class="op" id="4419262">.</span><span class="ident" id="4419263">Interface</span><span class="op" id="4419272">(</span><span class="op" id="4419273">)</span><span class="op" id="4419274">.</span><span class="op" id="4419275">(</span><span class="ident" id="4419276">BitString</span><span class="op" id="4419285">)</span><span class="op" id="4419286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419289">case</span>&nbsp;<span class="ident" id="4419294">objectIdentifierType</span><span class="op" id="4419314">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419318">return</span>&nbsp;<span class="ident" id="4419325">marshalObjectIdentifier</span><span class="op" id="4419348">(</span><span class="ident" id="4419349">out</span><span class="op" id="4419352">,</span>&nbsp;<span class="ident" id="4419354">value</span><span class="op" id="4419359">.</span><span class="ident" id="4419360">Interface</span><span class="op" id="4419369">(</span><span class="op" id="4419370">)</span><span class="op" id="4419371">.</span><span class="op" id="4419372">(</span><span class="ident" id="4419373">ObjectIdentifier</span><span class="op" id="4419389">)</span><span class="op" id="4419390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419393">case</span>&nbsp;<span class="ident" id="4419398">bigIntType</span><span class="op" id="4419408">:</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419412">return</span>&nbsp;<span class="ident" id="4419419">marshalBigInt</span><span class="op" id="4419432">(</span><span class="ident" id="4419433">out</span><span class="op" id="4419436">,</span>&nbsp;<span class="ident" id="4419438">value</span><span class="op" id="4419443">.</span><span class="ident" id="4419444">Interface</span><span class="op" id="4419453">(</span><span class="op" id="4419454">)</span><span class="op" id="4419455">.</span><span class="op" id="4419456">(</span><span class="op" id="4419457">*</span><span class="ident" id="4419458">big</span><span class="op" id="4419461">.</span><span class="ident" id="4419462">Int</span><span class="op" id="4419465">)</span><span class="op" id="4419466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419473">switch</span>&nbsp;<span class="ident" id="4419480">v</span>&nbsp;<span class="op" id="4419482">:=</span>&nbsp;<span class="ident" id="4419485">value</span><span class="op" id="4419490">;</span>&nbsp;<span class="ident" id="4419492">v</span><span class="op" id="4419493">.</span><span class="ident" id="4419494">Kind</span><span class="op" id="4419498">(</span><span class="op" id="4419499">)</span>&nbsp;<span class="op" id="4419501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419504">case</span>&nbsp;<span class="ident" id="4419509">reflect</span><span class="op" id="4419516">.</span><span class="ident" id="4419517">Bool</span><span class="op" id="4419521">:</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419525">if</span>&nbsp;<span class="ident" id="4419528">v</span><span class="op" id="4419529">.</span><span class="ident" id="4419530">Bool</span><span class="op" id="4419534">(</span><span class="op" id="4419535">)</span>&nbsp;<span class="op" id="4419537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419542">return</span>&nbsp;<span class="ident" id="4419549">out</span><span class="op" id="4419552">.</span><span class="ident" id="4419553">WriteByte</span><span class="op" id="4419562">(</span><span class="num" id="4419563">255</span><span class="op" id="4419566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419570">}</span>&nbsp;<span class="keyword" id="4419572">else</span>&nbsp;<span class="op" id="4419577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419582">return</span>&nbsp;<span class="ident" id="4419589">out</span><span class="op" id="4419592">.</span><span class="ident" id="4419593">WriteByte</span><span class="op" id="4419602">(</span><span class="num" id="4419603">0</span><span class="op" id="4419604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419608">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419611">case</span>&nbsp;<span class="ident" id="4419616">reflect</span><span class="op" id="4419623">.</span><span class="ident" id="4419624">Int</span><span class="op" id="4419627">,</span>&nbsp;<span class="ident" id="4419629">reflect</span><span class="op" id="4419636">.</span><span class="ident" id="4419637">Int8</span><span class="op" id="4419641">,</span>&nbsp;<span class="ident" id="4419643">reflect</span><span class="op" id="4419650">.</span><span class="ident" id="4419651">Int16</span><span class="op" id="4419656">,</span>&nbsp;<span class="ident" id="4419658">reflect</span><span class="op" id="4419665">.</span><span class="ident" id="4419666">Int32</span><span class="op" id="4419671">,</span>&nbsp;<span class="ident" id="4419673">reflect</span><span class="op" id="4419680">.</span><span class="ident" id="4419681">Int64</span><span class="op" id="4419686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419690">return</span>&nbsp;<span class="ident" id="4419697">marshalInt64</span><span class="op" id="4419709">(</span><span class="ident" id="4419710">out</span><span class="op" id="4419713">,</span>&nbsp;<span class="ident" id="4419715">int64</span><span class="op" id="4419720">(</span><span class="ident" id="4419721">v</span><span class="op" id="4419722">.</span><span class="ident" id="4419723">Int</span><span class="op" id="4419726">(</span><span class="op" id="4419727">)</span><span class="op" id="4419728">)</span><span class="op" id="4419729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419732">case</span>&nbsp;<span class="ident" id="4419737">reflect</span><span class="op" id="4419744">.</span><span class="ident" id="4419745">Struct</span><span class="op" id="4419751">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419755">t</span>&nbsp;<span class="op" id="4419757">:=</span>&nbsp;<span class="ident" id="4419760">v</span><span class="op" id="4419761">.</span><span class="ident" id="4419762">Type</span><span class="op" id="4419766">(</span><span class="op" id="4419767">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419772">startingField</span>&nbsp;<span class="op" id="4419786">:=</span>&nbsp;<span class="num" id="4419789">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4419794">//&nbsp;If&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;the&nbsp;structure&nbsp;is&nbsp;a&nbsp;non-empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4419852">//&nbsp;RawContents,&nbsp;then&nbsp;we&nbsp;don&#39;t&nbsp;bother&nbsp;serializing&nbsp;the&nbsp;rest.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419913">if</span>&nbsp;<span class="ident" id="4419916">t</span><span class="op" id="4419917">.</span><span class="ident" id="4419918">NumField</span><span class="op" id="4419926">(</span><span class="op" id="4419927">)</span>&nbsp;<span class="op" id="4419929">&gt;</span>&nbsp;<span class="num" id="4419931">0</span>&nbsp;<span class="op" id="4419933">&amp;&amp;</span>&nbsp;<span class="ident" id="4419936">t</span><span class="op" id="4419937">.</span><span class="ident" id="4419938">Field</span><span class="op" id="4419943">(</span><span class="num" id="4419944">0</span><span class="op" id="4419945">)</span><span class="op" id="4419946">.</span><span class="ident" id="4419947">Type</span>&nbsp;<span class="op" id="4419952">==</span>&nbsp;<span class="ident" id="4419955">rawContentsType</span>&nbsp;<span class="op" id="4419971">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419976">s</span>&nbsp;<span class="op" id="4419978">:=</span>&nbsp;<span class="ident" id="4419981">v</span><span class="op" id="4419982">.</span><span class="ident" id="4419983">Field</span><span class="op" id="4419988">(</span><span class="num" id="4419989">0</span><span class="op" id="4419990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419995">if</span>&nbsp;<span class="ident" id="4419998">s</span><span class="op" id="4419999">.</span><span class="ident" id="4420000">Len</span><span class="op" id="4420003">(</span><span class="op" id="4420004">)</span>&nbsp;<span class="op" id="4420006">&gt;</span>&nbsp;<span class="num" id="4420008">0</span>&nbsp;<span class="op" id="4420010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420016">bytes</span>&nbsp;<span class="op" id="4420022">:=</span>&nbsp;<span class="builtinfunc" id="4420025">make</span><span class="op" id="4420029">(</span><span class="op" id="4420030">[</span><span class="op" id="4420031">]</span><span class="builtintype" id="4420032">byte</span><span class="op" id="4420036">,</span>&nbsp;<span class="ident" id="4420038">s</span><span class="op" id="4420039">.</span><span class="ident" id="4420040">Len</span><span class="op" id="4420043">(</span><span class="op" id="4420044">)</span><span class="op" id="4420045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420051">for</span>&nbsp;<span class="ident" id="4420055">i</span>&nbsp;<span class="op" id="4420057">:=</span>&nbsp;<span class="num" id="4420060">0</span><span class="op" id="4420061">;</span>&nbsp;<span class="ident" id="4420063">i</span>&nbsp;<span class="op" id="4420065">&lt;</span>&nbsp;<span class="ident" id="4420067">s</span><span class="op" id="4420068">.</span><span class="ident" id="4420069">Len</span><span class="op" id="4420072">(</span><span class="op" id="4420073">)</span><span class="op" id="4420074">;</span>&nbsp;<span class="ident" id="4420076">i</span><span class="op" id="4420077">++</span>&nbsp;<span class="op" id="4420080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420087">bytes</span><span class="op" id="4420092">[</span><span class="ident" id="4420093">i</span><span class="op" id="4420094">]</span>&nbsp;<span class="op" id="4420096">=</span>&nbsp;<span class="builtintype" id="4420098">uint8</span><span class="op" id="4420103">(</span><span class="ident" id="4420104">s</span><span class="op" id="4420105">.</span><span class="ident" id="4420106">Index</span><span class="op" id="4420111">(</span><span class="ident" id="4420112">i</span><span class="op" id="4420113">)</span><span class="op" id="4420114">.</span><span class="ident" id="4420115">Uint</span><span class="op" id="4420119">(</span><span class="op" id="4420120">)</span><span class="op" id="4420121">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4420133">/*&nbsp;The&nbsp;RawContents&nbsp;will&nbsp;contain&nbsp;the&nbsp;tag&nbsp;and<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;*&nbsp;length&nbsp;fields&nbsp;but&nbsp;we&#39;ll&nbsp;also&nbsp;be&nbsp;writing<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;*&nbsp;those&nbsp;ourselves,&nbsp;so&nbsp;we&nbsp;strip&nbsp;them&nbsp;out&nbsp;of<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;*&nbsp;bytes&nbsp;*/</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420292">_</span><span class="op" id="4420293">,</span>&nbsp;<span class="ident" id="4420295">err</span>&nbsp;<span class="op" id="4420299">=</span>&nbsp;<span class="ident" id="4420301">out</span><span class="op" id="4420304">.</span><span class="ident" id="4420305">Write</span><span class="op" id="4420310">(</span><span class="ident" id="4420311">stripTagAndLength</span><span class="op" id="4420328">(</span><span class="ident" id="4420329">bytes</span><span class="op" id="4420334">)</span><span class="op" id="4420335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420341">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420351">}</span>&nbsp;<span class="keyword" id="4420353">else</span>&nbsp;<span class="op" id="4420358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420364">startingField</span>&nbsp;<span class="op" id="4420378">=</span>&nbsp;<span class="num" id="4420380">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420385">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420394">for</span>&nbsp;<span class="ident" id="4420398">i</span>&nbsp;<span class="op" id="4420400">:=</span>&nbsp;<span class="ident" id="4420403">startingField</span><span class="op" id="4420416">;</span>&nbsp;<span class="ident" id="4420418">i</span>&nbsp;<span class="op" id="4420420">&lt;</span>&nbsp;<span class="ident" id="4420422">t</span><span class="op" id="4420423">.</span><span class="ident" id="4420424">NumField</span><span class="op" id="4420432">(</span><span class="op" id="4420433">)</span><span class="op" id="4420434">;</span>&nbsp;<span class="ident" id="4420436">i</span><span class="op" id="4420437">++</span>&nbsp;<span class="op" id="4420440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420445">var</span>&nbsp;<span class="ident" id="4420449">pre</span>&nbsp;<span class="op" id="4420453">*</span><span class="ident" id="4420454">forkableWriter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420472">pre</span><span class="op" id="4420475">,</span>&nbsp;<span class="ident" id="4420477">out</span>&nbsp;<span class="op" id="4420481">=</span>&nbsp;<span class="ident" id="4420483">out</span><span class="op" id="4420486">.</span><span class="ident" id="4420487">fork</span><span class="op" id="4420491">(</span><span class="op" id="4420492">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420497">err</span>&nbsp;<span class="op" id="4420501">=</span>&nbsp;<span class="ident" id="4420503">marshalField</span><span class="op" id="4420515">(</span><span class="ident" id="4420516">pre</span><span class="op" id="4420519">,</span>&nbsp;<span class="ident" id="4420521">v</span><span class="op" id="4420522">.</span><span class="ident" id="4420523">Field</span><span class="op" id="4420528">(</span><span class="ident" id="4420529">i</span><span class="op" id="4420530">)</span><span class="op" id="4420531">,</span>&nbsp;<span class="ident" id="4420533">parseFieldParameters</span><span class="op" id="4420553">(</span><span class="ident" id="4420554">t</span><span class="op" id="4420555">.</span><span class="ident" id="4420556">Field</span><span class="op" id="4420561">(</span><span class="ident" id="4420562">i</span><span class="op" id="4420563">)</span><span class="op" id="4420564">.</span><span class="ident" id="4420565">Tag</span><span class="op" id="4420568">.</span><span class="ident" id="4420569">Get</span><span class="op" id="4420572">(</span><span class="string" id="4420573">&#34;asn1&#34;</span><span class="op" id="4420579">)</span><span class="op" id="4420580">)</span><span class="op" id="4420581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420586">if</span>&nbsp;<span class="ident" id="4420589">err</span>&nbsp;<span class="op" id="4420593">!=</span>&nbsp;<span class="ident" id="4420596">nil</span>&nbsp;<span class="op" id="4420600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420606">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420620">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420624">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420632">case</span>&nbsp;<span class="ident" id="4420637">reflect</span><span class="op" id="4420644">.</span><span class="ident" id="4420645">Slice</span><span class="op" id="4420650">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420654">sliceType</span>&nbsp;<span class="op" id="4420664">:=</span>&nbsp;<span class="ident" id="4420667">v</span><span class="op" id="4420668">.</span><span class="ident" id="4420669">Type</span><span class="op" id="4420673">(</span><span class="op" id="4420674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420678">if</span>&nbsp;<span class="ident" id="4420681">sliceType</span><span class="op" id="4420690">.</span><span class="ident" id="4420691">Elem</span><span class="op" id="4420695">(</span><span class="op" id="4420696">)</span><span class="op" id="4420697">.</span><span class="ident" id="4420698">Kind</span><span class="op" id="4420702">(</span><span class="op" id="4420703">)</span>&nbsp;<span class="op" id="4420705">==</span>&nbsp;<span class="ident" id="4420708">reflect</span><span class="op" id="4420715">.</span><span class="ident" id="4420716">Uint8</span>&nbsp;<span class="op" id="4420722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420727">bytes</span>&nbsp;<span class="op" id="4420733">:=</span>&nbsp;<span class="builtinfunc" id="4420736">make</span><span class="op" id="4420740">(</span><span class="op" id="4420741">[</span><span class="op" id="4420742">]</span><span class="builtintype" id="4420743">byte</span><span class="op" id="4420747">,</span>&nbsp;<span class="ident" id="4420749">v</span><span class="op" id="4420750">.</span><span class="ident" id="4420751">Len</span><span class="op" id="4420754">(</span><span class="op" id="4420755">)</span><span class="op" id="4420756">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420761">for</span>&nbsp;<span class="ident" id="4420765">i</span>&nbsp;<span class="op" id="4420767">:=</span>&nbsp;<span class="num" id="4420770">0</span><span class="op" id="4420771">;</span>&nbsp;<span class="ident" id="4420773">i</span>&nbsp;<span class="op" id="4420775">&lt;</span>&nbsp;<span class="ident" id="4420777">v</span><span class="op" id="4420778">.</span><span class="ident" id="4420779">Len</span><span class="op" id="4420782">(</span><span class="op" id="4420783">)</span><span class="op" id="4420784">;</span>&nbsp;<span class="ident" id="4420786">i</span><span class="op" id="4420787">++</span>&nbsp;<span class="op" id="4420790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420796">bytes</span><span class="op" id="4420801">[</span><span class="ident" id="4420802">i</span><span class="op" id="4420803">]</span>&nbsp;<span class="op" id="4420805">=</span>&nbsp;<span class="builtintype" id="4420807">uint8</span><span class="op" id="4420812">(</span><span class="ident" id="4420813">v</span><span class="op" id="4420814">.</span><span class="ident" id="4420815">Index</span><span class="op" id="4420820">(</span><span class="ident" id="4420821">i</span><span class="op" id="4420822">)</span><span class="op" id="4420823">.</span><span class="ident" id="4420824">Uint</span><span class="op" id="4420828">(</span><span class="op" id="4420829">)</span><span class="op" id="4420830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420840">_</span><span class="op" id="4420841">,</span>&nbsp;<span class="ident" id="4420843">err</span>&nbsp;<span class="op" id="4420847">=</span>&nbsp;<span class="ident" id="4420849">out</span><span class="op" id="4420852">.</span><span class="ident" id="4420853">Write</span><span class="op" id="4420858">(</span><span class="ident" id="4420859">bytes</span><span class="op" id="4420864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420869">return</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420883">var</span>&nbsp;<span class="ident" id="4420887">fp</span>&nbsp;<span class="ident" id="4420890">fieldParameters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420908">for</span>&nbsp;<span class="ident" id="4420912">i</span>&nbsp;<span class="op" id="4420914">:=</span>&nbsp;<span class="num" id="4420917">0</span><span class="op" id="4420918">;</span>&nbsp;<span class="ident" id="4420920">i</span>&nbsp;<span class="op" id="4420922">&lt;</span>&nbsp;<span class="ident" id="4420924">v</span><span class="op" id="4420925">.</span><span class="ident" id="4420926">Len</span><span class="op" id="4420929">(</span><span class="op" id="4420930">)</span><span class="op" id="4420931">;</span>&nbsp;<span class="ident" id="4420933">i</span><span class="op" id="4420934">++</span>&nbsp;<span class="op" id="4420937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420942">var</span>&nbsp;<span class="ident" id="4420946">pre</span>&nbsp;<span class="op" id="4420950">*</span><span class="ident" id="4420951">forkableWriter</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420969">pre</span><span class="op" id="4420972">,</span>&nbsp;<span class="ident" id="4420974">out</span>&nbsp;<span class="op" id="4420978">=</span>&nbsp;<span class="ident" id="4420980">out</span><span class="op" id="4420983">.</span><span class="ident" id="4420984">fork</span><span class="op" id="4420988">(</span><span class="op" id="4420989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420994">err</span>&nbsp;<span class="op" id="4420998">=</span>&nbsp;<span class="ident" id="4421000">marshalField</span><span class="op" id="4421012">(</span><span class="ident" id="4421013">pre</span><span class="op" id="4421016">,</span>&nbsp;<span class="ident" id="4421018">v</span><span class="op" id="4421019">.</span><span class="ident" id="4421020">Index</span><span class="op" id="4421025">(</span><span class="ident" id="4421026">i</span><span class="op" id="4421027">)</span><span class="op" id="4421028">,</span>&nbsp;<span class="ident" id="4421030">fp</span><span class="op" id="4421032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421037">if</span>&nbsp;<span class="ident" id="4421040">err</span>&nbsp;<span class="op" id="4421044">!=</span>&nbsp;<span class="ident" id="4421047">nil</span>&nbsp;<span class="op" id="4421051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421057">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421067">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421075">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421083">case</span>&nbsp;<span class="ident" id="4421088">reflect</span><span class="op" id="4421095">.</span><span class="ident" id="4421096">String</span><span class="op" id="4421102">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421106">switch</span>&nbsp;<span class="ident" id="4421113">params</span><span class="op" id="4421119">.</span><span class="ident" id="4421120">stringType</span>&nbsp;<span class="op" id="4421131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421135">case</span>&nbsp;<span class="ident" id="4421140">tagIA5String</span><span class="op" id="4421152">:</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421157">return</span>&nbsp;<span class="ident" id="4421164">marshalIA5String</span><span class="op" id="4421180">(</span><span class="ident" id="4421181">out</span><span class="op" id="4421184">,</span>&nbsp;<span class="ident" id="4421186">v</span><span class="op" id="4421187">.</span><span class="ident" id="4421188">String</span><span class="op" id="4421194">(</span><span class="op" id="4421195">)</span><span class="op" id="4421196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421200">case</span>&nbsp;<span class="ident" id="4421205">tagPrintableString</span><span class="op" id="4421223">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421228">return</span>&nbsp;<span class="ident" id="4421235">marshalPrintableString</span><span class="op" id="4421257">(</span><span class="ident" id="4421258">out</span><span class="op" id="4421261">,</span>&nbsp;<span class="ident" id="4421263">v</span><span class="op" id="4421264">.</span><span class="ident" id="4421265">String</span><span class="op" id="4421271">(</span><span class="op" id="4421272">)</span><span class="op" id="4421273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421277">default</span><span class="op" id="4421284">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421289">return</span>&nbsp;<span class="ident" id="4421296">marshalUTF8String</span><span class="op" id="4421313">(</span><span class="ident" id="4421314">out</span><span class="op" id="4421317">,</span>&nbsp;<span class="ident" id="4421319">v</span><span class="op" id="4421320">.</span><span class="ident" id="4421321">String</span><span class="op" id="4421327">(</span><span class="op" id="4421328">)</span><span class="op" id="4421329">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421340">return</span>&nbsp;<span class="ident" id="4421347">StructuralError</span><span class="op" id="4421362">{</span><span class="string" id="4421363">&#34;unknown&nbsp;Go&nbsp;type&#34;</span><span class="op" id="4421380">}</span><br>
<span class="lineno"></span><span class="op" id="4421382">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="keyword" id="4421385">func</span>&nbsp;<span class="ident" id="4421390">marshalField</span><span class="op" id="4421402">(</span><span class="ident" id="4421403">out</span>&nbsp;<span class="op" id="4421407">*</span><span class="ident" id="4421408">forkableWriter</span><span class="op" id="4421422">,</span>&nbsp;<span class="ident" id="4421424">v</span>&nbsp;<span class="ident" id="4421426">reflect</span><span class="op" id="4421433">.</span><span class="ident" id="4421434">Value</span><span class="op" id="4421439">,</span>&nbsp;<span class="ident" id="4421441">params</span>&nbsp;<span class="ident" id="4421448">fieldParameters</span><span class="op" id="4421463">)</span>&nbsp;<span class="op" id="4421465">(</span><span class="ident" id="4421466">err</span>&nbsp;<span class="builtintype" id="4421470">error</span><span class="op" id="4421475">)</span>&nbsp;<span class="op" id="4421477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4421480">//&nbsp;If&nbsp;the&nbsp;field&nbsp;is&nbsp;an&nbsp;interface{}&nbsp;then&nbsp;recurse&nbsp;into&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421537">if</span>&nbsp;<span class="ident" id="4421540">v</span><span class="op" id="4421541">.</span><span class="ident" id="4421542">Kind</span><span class="op" id="4421546">(</span><span class="op" id="4421547">)</span>&nbsp;<span class="op" id="4421549">==</span>&nbsp;<span class="ident" id="4421552">reflect</span><span class="op" id="4421559">.</span><span class="ident" id="4421560">Interface</span>&nbsp;<span class="op" id="4421570">&amp;&amp;</span>&nbsp;<span class="ident" id="4421573">v</span><span class="op" id="4421574">.</span><span class="ident" id="4421575">Type</span><span class="op" id="4421579">(</span><span class="op" id="4421580">)</span><span class="op" id="4421581">.</span><span class="ident" id="4421582">NumMethod</span><span class="op" id="4421591">(</span><span class="op" id="4421592">)</span>&nbsp;<span class="op" id="4421594">==</span>&nbsp;<span class="num" id="4421597">0</span>&nbsp;<span class="op" id="4421599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421603">return</span>&nbsp;<span class="ident" id="4421610">marshalField</span><span class="op" id="4421622">(</span><span class="ident" id="4421623">out</span><span class="op" id="4421626">,</span>&nbsp;<span class="ident" id="4421628">v</span><span class="op" id="4421629">.</span><span class="ident" id="4421630">Elem</span><span class="op" id="4421634">(</span><span class="op" id="4421635">)</span><span class="op" id="4421636">,</span>&nbsp;<span class="ident" id="4421638">params</span><span class="op" id="4421644">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421651">if</span>&nbsp;<span class="ident" id="4421654">v</span><span class="op" id="4421655">.</span><span class="ident" id="4421656">Kind</span><span class="op" id="4421660">(</span><span class="op" id="4421661">)</span>&nbsp;<span class="op" id="4421663">==</span>&nbsp;<span class="ident" id="4421666">reflect</span><span class="op" id="4421673">.</span><span class="ident" id="4421674">Slice</span>&nbsp;<span class="op" id="4421680">&amp;&amp;</span>&nbsp;<span class="ident" id="4421683">v</span><span class="op" id="4421684">.</span><span class="ident" id="4421685">Len</span><span class="op" id="4421688">(</span><span class="op" id="4421689">)</span>&nbsp;<span class="op" id="4421691">==</span>&nbsp;<span class="num" id="4421694">0</span>&nbsp;<span class="op" id="4421696">&amp;&amp;</span>&nbsp;<span class="ident" id="4421699">params</span><span class="op" id="4421705">.</span><span class="ident" id="4421706">omitEmpty</span>&nbsp;<span class="op" id="4421716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421720">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421728">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421732">if</span>&nbsp;<span class="ident" id="4421735">params</span><span class="op" id="4421741">.</span><span class="ident" id="4421742">optional</span>&nbsp;<span class="op" id="4421751">&amp;&amp;</span>&nbsp;<span class="ident" id="4421754">params</span><span class="op" id="4421760">.</span><span class="ident" id="4421761">defaultValue</span>&nbsp;<span class="op" id="4421774">!=</span>&nbsp;<span class="ident" id="4421777">nil</span>&nbsp;<span class="op" id="4421781">&amp;&amp;</span>&nbsp;<span class="ident" id="4421784">canHaveDefaultValue</span><span class="op" id="4421803">(</span><span class="ident" id="4421804">v</span><span class="op" id="4421805">.</span><span class="ident" id="4421806">Kind</span><span class="op" id="4421810">(</span><span class="op" id="4421811">)</span><span class="op" id="4421812">)</span>&nbsp;<span class="op" id="4421814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421818">defaultValue</span>&nbsp;<span class="op" id="4421831">:=</span>&nbsp;<span class="ident" id="4421834">reflect</span><span class="op" id="4421841">.</span><span class="ident" id="4421842">New</span><span class="op" id="4421845">(</span><span class="ident" id="4421846">v</span><span class="op" id="4421847">.</span><span class="ident" id="4421848">Type</span><span class="op" id="4421852">(</span><span class="op" id="4421853">)</span><span class="op" id="4421854">)</span><span class="op" id="4421855">.</span><span class="ident" id="4421856">Elem</span><span class="op" id="4421860">(</span><span class="op" id="4421861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421865">defaultValue</span><span class="op" id="4421877">.</span><span class="ident" id="4421878">SetInt</span><span class="op" id="4421884">(</span><span class="op" id="4421885">*</span><span class="ident" id="4421886">params</span><span class="op" id="4421892">.</span><span class="ident" id="4421893">defaultValue</span><span class="op" id="4421905">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421910">if</span>&nbsp;<span class="ident" id="4421913">reflect</span><span class="op" id="4421920">.</span><span class="ident" id="4421921">DeepEqual</span><span class="op" id="4421930">(</span><span class="ident" id="4421931">v</span><span class="op" id="4421932">.</span><span class="ident" id="4421933">Interface</span><span class="op" id="4421942">(</span><span class="op" id="4421943">)</span><span class="op" id="4421944">,</span>&nbsp;<span class="ident" id="4421946">defaultValue</span><span class="op" id="4421958">.</span><span class="ident" id="4421959">Interface</span><span class="op" id="4421968">(</span><span class="op" id="4421969">)</span><span class="op" id="4421970">)</span>&nbsp;<span class="op" id="4421972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421977">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4421993">//&nbsp;If&nbsp;no&nbsp;default&nbsp;value&nbsp;is&nbsp;given&nbsp;then&nbsp;the&nbsp;zero&nbsp;value&nbsp;for&nbsp;the&nbsp;type&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4422062">//&nbsp;assumed&nbsp;to&nbsp;be&nbsp;the&nbsp;default&nbsp;value.&nbsp;This&nbsp;isn&#39;t&nbsp;obviously&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4422132">//&nbsp;behaviour,&nbsp;but&nbsp;it&#39;s&nbsp;what&nbsp;Go&nbsp;has&nbsp;traditionally&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422188">if</span>&nbsp;<span class="ident" id="4422191">params</span><span class="op" id="4422197">.</span><span class="ident" id="4422198">optional</span>&nbsp;<span class="op" id="4422207">&amp;&amp;</span>&nbsp;<span class="ident" id="4422210">params</span><span class="op" id="4422216">.</span><span class="ident" id="4422217">defaultValue</span>&nbsp;<span class="op" id="4422230">==</span>&nbsp;<span class="ident" id="4422233">nil</span>&nbsp;<span class="op" id="4422237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422241">if</span>&nbsp;<span class="ident" id="4422244">reflect</span><span class="op" id="4422251">.</span><span class="ident" id="4422252">DeepEqual</span><span class="op" id="4422261">(</span><span class="ident" id="4422262">v</span><span class="op" id="4422263">.</span><span class="ident" id="4422264">Interface</span><span class="op" id="4422273">(</span><span class="op" id="4422274">)</span><span class="op" id="4422275">,</span>&nbsp;<span class="ident" id="4422277">reflect</span><span class="op" id="4422284">.</span><span class="ident" id="4422285">Zero</span><span class="op" id="4422289">(</span><span class="ident" id="4422290">v</span><span class="op" id="4422291">.</span><span class="ident" id="4422292">Type</span><span class="op" id="4422296">(</span><span class="op" id="4422297">)</span><span class="op" id="4422298">)</span><span class="op" id="4422299">.</span><span class="ident" id="4422300">Interface</span><span class="op" id="4422309">(</span><span class="op" id="4422310">)</span><span class="op" id="4422311">)</span>&nbsp;<span class="op" id="4422313">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422318">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422334">if</span>&nbsp;<span class="ident" id="4422337">v</span><span class="op" id="4422338">.</span><span class="ident" id="4422339">Type</span><span class="op" id="4422343">(</span><span class="op" id="4422344">)</span>&nbsp;<span class="op" id="4422346">==</span>&nbsp;<span class="ident" id="4422349">rawValueType</span>&nbsp;<span class="op" id="4422362">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422366">rv</span>&nbsp;<span class="op" id="4422369">:=</span>&nbsp;<span class="ident" id="4422372">v</span><span class="op" id="4422373">.</span><span class="ident" id="4422374">Interface</span><span class="op" id="4422383">(</span><span class="op" id="4422384">)</span><span class="op" id="4422385">.</span><span class="op" id="4422386">(</span><span class="ident" id="4422387">RawValue</span><span class="op" id="4422395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422399">if</span>&nbsp;<span class="builtinfunc" id="4422402">len</span><span class="op" id="4422405">(</span><span class="ident" id="4422406">rv</span><span class="op" id="4422408">.</span><span class="ident" id="4422409">FullBytes</span><span class="op" id="4422418">)</span>&nbsp;<span class="op" id="4422420">!=</span>&nbsp;<span class="num" id="4422423">0</span>&nbsp;<span class="op" id="4422425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422430">_</span><span class="op" id="4422431">,</span>&nbsp;<span class="ident" id="4422433">err</span>&nbsp;<span class="op" id="4422437">=</span>&nbsp;<span class="ident" id="4422439">out</span><span class="op" id="4422442">.</span><span class="ident" id="4422443">Write</span><span class="op" id="4422448">(</span><span class="ident" id="4422449">rv</span><span class="op" id="4422451">.</span><span class="ident" id="4422452">FullBytes</span><span class="op" id="4422461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422465">}</span>&nbsp;<span class="keyword" id="4422467">else</span>&nbsp;<span class="op" id="4422472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422477">err</span>&nbsp;<span class="op" id="4422481">=</span>&nbsp;<span class="ident" id="4422483">marshalTagAndLength</span><span class="op" id="4422502">(</span><span class="ident" id="4422503">out</span><span class="op" id="4422506">,</span>&nbsp;<span class="ident" id="4422508">tagAndLength</span><span class="op" id="4422520">{</span><span class="ident" id="4422521">rv</span><span class="op" id="4422523">.</span><span class="ident" id="4422524">Class</span><span class="op" id="4422529">,</span>&nbsp;<span class="ident" id="4422531">rv</span><span class="op" id="4422533">.</span><span class="ident" id="4422534">Tag</span><span class="op" id="4422537">,</span>&nbsp;<span class="builtinfunc" id="4422539">len</span><span class="op" id="4422542">(</span><span class="ident" id="4422543">rv</span><span class="op" id="4422545">.</span><span class="ident" id="4422546">Bytes</span><span class="op" id="4422551">)</span><span class="op" id="4422552">,</span>&nbsp;<span class="ident" id="4422554">rv</span><span class="op" id="4422556">.</span><span class="ident" id="4422557">IsCompound</span><span class="op" id="4422567">}</span><span class="op" id="4422568">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422573">if</span>&nbsp;<span class="ident" id="4422576">err</span>&nbsp;<span class="op" id="4422580">!=</span>&nbsp;<span class="ident" id="4422583">nil</span>&nbsp;<span class="op" id="4422587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422593">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422608">_</span><span class="op" id="4422609">,</span>&nbsp;<span class="ident" id="4422611">err</span>&nbsp;<span class="op" id="4422615">=</span>&nbsp;<span class="ident" id="4422617">out</span><span class="op" id="4422620">.</span><span class="ident" id="4422621">Write</span><span class="op" id="4422626">(</span><span class="ident" id="4422627">rv</span><span class="op" id="4422629">.</span><span class="ident" id="4422630">Bytes</span><span class="op" id="4422635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422639">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422643">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422655">tag</span><span class="op" id="4422658">,</span>&nbsp;<span class="ident" id="4422660">isCompound</span><span class="op" id="4422670">,</span>&nbsp;<span class="ident" id="4422672">ok</span>&nbsp;<span class="op" id="4422675">:=</span>&nbsp;<span class="ident" id="4422678">getUniversalType</span><span class="op" id="4422694">(</span><span class="ident" id="4422695">v</span><span class="op" id="4422696">.</span><span class="ident" id="4422697">Type</span><span class="op" id="4422701">(</span><span class="op" id="4422702">)</span><span class="op" id="4422703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422706">if</span>&nbsp;<span class="op" id="4422709">!</span><span class="ident" id="4422710">ok</span>&nbsp;<span class="op" id="4422713">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422717">err</span>&nbsp;<span class="op" id="4422721">=</span>&nbsp;<span class="ident" id="4422723">StructuralError</span><span class="op" id="4422738">{</span><span class="ident" id="4422739">fmt</span><span class="op" id="4422742">.</span><span class="ident" id="4422743">Sprintf</span><span class="op" id="4422750">(</span><span class="string" id="4422751">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="4422772">,</span>&nbsp;<span class="ident" id="4422774">v</span><span class="op" id="4422775">.</span><span class="ident" id="4422776">Type</span><span class="op" id="4422780">(</span><span class="op" id="4422781">)</span><span class="op" id="4422782">)</span><span class="op" id="4422783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422787">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422798">class</span>&nbsp;<span class="op" id="4422804">:=</span>&nbsp;<span class="ident" id="4422807">classUniversal</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422824">if</span>&nbsp;<span class="ident" id="4422827">params</span><span class="op" id="4422833">.</span><span class="ident" id="4422834">stringType</span>&nbsp;<span class="op" id="4422845">!=</span>&nbsp;<span class="num" id="4422848">0</span>&nbsp;<span class="op" id="4422850">&amp;&amp;</span>&nbsp;<span class="ident" id="4422853">tag</span>&nbsp;<span class="op" id="4422857">!=</span>&nbsp;<span class="ident" id="4422860">tagPrintableString</span>&nbsp;<span class="op" id="4422879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422883">return</span>&nbsp;<span class="ident" id="4422890">StructuralError</span><span class="op" id="4422905">{</span><span class="string" id="4422906">&#34;explicit&nbsp;string&nbsp;type&nbsp;given&nbsp;to&nbsp;non-string&nbsp;member&#34;</span><span class="op" id="4422955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422962">switch</span>&nbsp;<span class="ident" id="4422969">tag</span>&nbsp;<span class="op" id="4422973">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422976">case</span>&nbsp;<span class="ident" id="4422981">tagPrintableString</span><span class="op" id="4422999">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423003">if</span>&nbsp;<span class="ident" id="4423006">params</span><span class="op" id="4423012">.</span><span class="ident" id="4423013">stringType</span>&nbsp;<span class="op" id="4423024">==</span>&nbsp;<span class="num" id="4423027">0</span>&nbsp;<span class="op" id="4423029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4423034">//&nbsp;This&nbsp;is&nbsp;a&nbsp;string&nbsp;without&nbsp;an&nbsp;explicit&nbsp;string&nbsp;type.&nbsp;We&#39;ll&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4423100">//&nbsp;a&nbsp;PrintableString&nbsp;if&nbsp;the&nbsp;character&nbsp;set&nbsp;in&nbsp;the&nbsp;string&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4423162">//&nbsp;sufficiently&nbsp;limited,&nbsp;otherwise&nbsp;we&#39;ll&nbsp;use&nbsp;a&nbsp;UTF8String.</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423224">for</span>&nbsp;<span class="ident" id="4423228">_</span><span class="op" id="4423229">,</span>&nbsp;<span class="ident" id="4423231">r</span>&nbsp;<span class="op" id="4423233">:=</span>&nbsp;<span class="keyword" id="4423236">range</span>&nbsp;<span class="ident" id="4423242">v</span><span class="op" id="4423243">.</span><span class="ident" id="4423244">String</span><span class="op" id="4423250">(</span><span class="op" id="4423251">)</span>&nbsp;<span class="op" id="4423253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423259">if</span>&nbsp;<span class="ident" id="4423262">r</span>&nbsp;<span class="op" id="4423264">&gt;=</span>&nbsp;<span class="ident" id="4423267">utf8</span><span class="op" id="4423271">.</span><span class="ident" id="4423272">RuneSelf</span>&nbsp;<span class="op" id="4423281">||</span>&nbsp;<span class="op" id="4423284">!</span><span class="ident" id="4423285">isPrintable</span><span class="op" id="4423296">(</span><span class="builtintype" id="4423297">byte</span><span class="op" id="4423301">(</span><span class="ident" id="4423302">r</span><span class="op" id="4423303">)</span><span class="op" id="4423304">)</span>&nbsp;<span class="op" id="4423306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423313">if</span>&nbsp;<span class="op" id="4423316">!</span><span class="ident" id="4423317">utf8</span><span class="op" id="4423321">.</span><span class="ident" id="4423322">ValidString</span><span class="op" id="4423333">(</span><span class="ident" id="4423334">v</span><span class="op" id="4423335">.</span><span class="ident" id="4423336">String</span><span class="op" id="4423342">(</span><span class="op" id="4423343">)</span><span class="op" id="4423344">)</span>&nbsp;<span class="op" id="4423346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423354">return</span>&nbsp;<span class="ident" id="4423361">errors</span><span class="op" id="4423367">.</span><span class="ident" id="4423368">New</span><span class="op" id="4423371">(</span><span class="string" id="4423372">&#34;asn1:&nbsp;string&nbsp;not&nbsp;valid&nbsp;UTF-8&#34;</span><span class="op" id="4423402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423409">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423416">tag</span>&nbsp;<span class="op" id="4423420">=</span>&nbsp;<span class="ident" id="4423422">tagUTF8String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423441">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423460">}</span>&nbsp;<span class="keyword" id="4423462">else</span>&nbsp;<span class="op" id="4423467">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423472">tag</span>&nbsp;<span class="op" id="4423476">=</span>&nbsp;<span class="ident" id="4423478">params</span><span class="op" id="4423484">.</span><span class="ident" id="4423485">stringType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423501">case</span>&nbsp;<span class="ident" id="4423506">tagUTCTime</span><span class="op" id="4423516">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423520">if</span>&nbsp;<span class="ident" id="4423523">outsideUTCRange</span><span class="op" id="4423538">(</span><span class="ident" id="4423539">v</span><span class="op" id="4423540">.</span><span class="ident" id="4423541">Interface</span><span class="op" id="4423550">(</span><span class="op" id="4423551">)</span><span class="op" id="4423552">.</span><span class="op" id="4423553">(</span><span class="ident" id="4423554">time</span><span class="op" id="4423558">.</span><span class="ident" id="4423559">Time</span><span class="op" id="4423563">)</span><span class="op" id="4423564">)</span>&nbsp;<span class="op" id="4423566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423571">tag</span>&nbsp;<span class="op" id="4423575">=</span>&nbsp;<span class="ident" id="4423577">tagGeneralizedTime</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423605">if</span>&nbsp;<span class="ident" id="4423608">params</span><span class="op" id="4423614">.</span><span class="ident" id="4423615">set</span>&nbsp;<span class="op" id="4423619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423623">if</span>&nbsp;<span class="ident" id="4423626">tag</span>&nbsp;<span class="op" id="4423630">!=</span>&nbsp;<span class="ident" id="4423633">tagSequence</span>&nbsp;<span class="op" id="4423645">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423650">return</span>&nbsp;<span class="ident" id="4423657">StructuralError</span><span class="op" id="4423672">{</span><span class="string" id="4423673">&#34;non&nbsp;sequence&nbsp;tagged&nbsp;as&nbsp;set&#34;</span><span class="op" id="4423701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423709">tag</span>&nbsp;<span class="op" id="4423713">=</span>&nbsp;<span class="ident" id="4423715">tagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423727">tags</span><span class="op" id="4423731">,</span>&nbsp;<span class="ident" id="4423733">body</span>&nbsp;<span class="op" id="4423738">:=</span>&nbsp;<span class="ident" id="4423741">out</span><span class="op" id="4423744">.</span><span class="ident" id="4423745">fork</span><span class="op" id="4423749">(</span><span class="op" id="4423750">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423754">err</span>&nbsp;<span class="op" id="4423758">=</span>&nbsp;<span class="ident" id="4423760">marshalBody</span><span class="op" id="4423771">(</span><span class="ident" id="4423772">body</span><span class="op" id="4423776">,</span>&nbsp;<span class="ident" id="4423778">v</span><span class="op" id="4423779">,</span>&nbsp;<span class="ident" id="4423781">params</span><span class="op" id="4423787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423790">if</span>&nbsp;<span class="ident" id="4423793">err</span>&nbsp;<span class="op" id="4423797">!=</span>&nbsp;<span class="ident" id="4423800">nil</span>&nbsp;<span class="op" id="4423804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423808">return</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423820">bodyLen</span>&nbsp;<span class="op" id="4423828">:=</span>&nbsp;<span class="ident" id="4423831">body</span><span class="op" id="4423835">.</span><span class="ident" id="4423836">Len</span><span class="op" id="4423839">(</span><span class="op" id="4423840">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423844">var</span>&nbsp;<span class="ident" id="4423848">explicitTag</span>&nbsp;<span class="op" id="4423860">*</span><span class="ident" id="4423861">forkableWriter</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423877">if</span>&nbsp;<span class="ident" id="4423880">params</span><span class="op" id="4423886">.</span><span class="ident" id="4423887">explicit</span>&nbsp;<span class="op" id="4423896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423900">explicitTag</span><span class="op" id="4423911">,</span>&nbsp;<span class="ident" id="4423913">tags</span>&nbsp;<span class="op" id="4423918">=</span>&nbsp;<span class="ident" id="4423920">tags</span><span class="op" id="4423924">.</span><span class="ident" id="4423925">fork</span><span class="op" id="4423929">(</span><span class="op" id="4423930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423937">if</span>&nbsp;<span class="op" id="4423940">!</span><span class="ident" id="4423941">params</span><span class="op" id="4423947">.</span><span class="ident" id="4423948">explicit</span>&nbsp;<span class="op" id="4423957">&amp;&amp;</span>&nbsp;<span class="ident" id="4423960">params</span><span class="op" id="4423966">.</span><span class="ident" id="4423967">tag</span>&nbsp;<span class="op" id="4423971">!=</span>&nbsp;<span class="ident" id="4423974">nil</span>&nbsp;<span class="op" id="4423978">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4423982">//&nbsp;implicit&nbsp;tag.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424001">tag</span>&nbsp;<span class="op" id="4424005">=</span>&nbsp;<span class="op" id="4424007">*</span><span class="ident" id="4424008">params</span><span class="op" id="4424014">.</span><span class="ident" id="4424015">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424021">class</span>&nbsp;<span class="op" id="4424027">=</span>&nbsp;<span class="ident" id="4424029">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4424051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424055">err</span>&nbsp;<span class="op" id="4424059">=</span>&nbsp;<span class="ident" id="4424061">marshalTagAndLength</span><span class="op" id="4424080">(</span><span class="ident" id="4424081">tags</span><span class="op" id="4424085">,</span>&nbsp;<span class="ident" id="4424087">tagAndLength</span><span class="op" id="4424099">{</span><span class="ident" id="4424100">class</span><span class="op" id="4424105">,</span>&nbsp;<span class="ident" id="4424107">tag</span><span class="op" id="4424110">,</span>&nbsp;<span class="ident" id="4424112">bodyLen</span><span class="op" id="4424119">,</span>&nbsp;<span class="ident" id="4424121">isCompound</span><span class="op" id="4424131">}</span><span class="op" id="4424132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424135">if</span>&nbsp;<span class="ident" id="4424138">err</span>&nbsp;<span class="op" id="4424142">!=</span>&nbsp;<span class="ident" id="4424145">nil</span>&nbsp;<span class="op" id="4424149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424153">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4424161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424165">if</span>&nbsp;<span class="ident" id="4424168">params</span><span class="op" id="4424174">.</span><span class="ident" id="4424175">explicit</span>&nbsp;<span class="op" id="4424184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424188">err</span>&nbsp;<span class="op" id="4424192">=</span>&nbsp;<span class="ident" id="4424194">marshalTagAndLength</span><span class="op" id="4424213">(</span><span class="ident" id="4424214">explicitTag</span><span class="op" id="4424225">,</span>&nbsp;<span class="ident" id="4424227">tagAndLength</span><span class="op" id="4424239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424244">class</span><span class="op" id="4424249">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424256">classContextSpecific</span><span class="op" id="4424276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424281">tag</span><span class="op" id="4424284">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4424293">*</span><span class="ident" id="4424294">params</span><span class="op" id="4424300">.</span><span class="ident" id="4424301">tag</span><span class="op" id="4424304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424309">length</span><span class="op" id="4424315">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424321">bodyLen</span>&nbsp;<span class="op" id="4424329">+</span>&nbsp;<span class="ident" id="4424331">tags</span><span class="op" id="4424335">.</span><span class="ident" id="4424336">Len</span><span class="op" id="4424339">(</span><span class="op" id="4424340">)</span><span class="op" id="4424341">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424346">isCompound</span><span class="op" id="4424356">:</span>&nbsp;<span class="builtintype" id="4424358">true</span><span class="op" id="4424362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4424366">}</span><span class="op" id="4424367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4424370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424374">return</span>&nbsp;<span class="ident" id="4424381">nil</span><br>
<span class="lineno">625</span><span class="op" id="4424385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4424388">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;ASN.1&nbsp;encoding&nbsp;of&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="4424434">//</span><br>
<span class="lineno"></span><span class="comment" id="4424437">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;struct&nbsp;tags&nbsp;recognised&nbsp;by&nbsp;Unmarshal,&nbsp;the&nbsp;following&nbsp;can&nbsp;be</span><br>
<span class="lineno">630</span><span class="comment" id="4424517">//&nbsp;used:</span><br>
<span class="lineno"></span><span class="comment" id="4424526">//</span><br>
<span class="lineno"></span><span class="comment" id="4424529">//&nbsp;&nbsp;&nbsp;&nbspia5:&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;strings&nbsp;to&nbsp;be&nbsp;marshaled&nbsp;as&nbsp;ASN.1,&nbsp;IA5&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="4424591">//&nbsp;&nbsp;&nbsp;&nbspomitempty:&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;empty&nbsp;slices&nbsp;to&nbsp;be&nbsp;skipped</span><br>
<span class="lineno"></span><span class="comment" id="4424639">//&nbsp;&nbsp;&nbsp;&nbspprintable:&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;strings&nbsp;to&nbsp;be&nbsp;marshaled&nbsp;as&nbsp;ASN.1,&nbsp;PrintableString&nbsp;strings.</span><br>
<span class="lineno">635</span><span class="comment" id="4424719">//&nbsp;&nbsp;&nbsp;&nbsputf8:&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;strings&nbsp;to&nbsp;be&nbsp;marshaled&nbsp;as&nbsp;ASN.1,&nbsp;UTF8&nbsp;strings</span><br>
<span class="lineno"></span><span class="keyword" id="4424783">func</span>&nbsp;<span class="ident" id="4424788">Marshal</span><span class="op" id="4424795">(</span><span class="ident" id="4424796">val</span>&nbsp;<span class="keyword" id="4424800">interface</span><span class="op" id="4424809">{</span><span class="op" id="4424810">}</span><span class="op" id="4424811">)</span>&nbsp;<span class="op" id="4424813">(</span><span class="op" id="4424814">[</span><span class="op" id="4424815">]</span><span class="builtintype" id="4424816">byte</span><span class="op" id="4424820">,</span>&nbsp;<span class="builtintype" id="4424822">error</span><span class="op" id="4424827">)</span>&nbsp;<span class="op" id="4424829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424832">var</span>&nbsp;<span class="ident" id="4424836">out</span>&nbsp;<span class="ident" id="4424840">bytes</span><span class="op" id="4424845">.</span><span class="ident" id="4424846">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424854">v</span>&nbsp;<span class="op" id="4424856">:=</span>&nbsp;<span class="ident" id="4424859">reflect</span><span class="op" id="4424866">.</span><span class="ident" id="4424867">ValueOf</span><span class="op" id="4424874">(</span><span class="ident" id="4424875">val</span><span class="op" id="4424878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424881">f</span>&nbsp;<span class="op" id="4424883">:=</span>&nbsp;<span class="ident" id="4424886">newForkableWriter</span><span class="op" id="4424903">(</span><span class="op" id="4424904">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424907">err</span>&nbsp;<span class="op" id="4424911">:=</span>&nbsp;<span class="ident" id="4424914">marshalField</span><span class="op" id="4424926">(</span><span class="ident" id="4424927">f</span><span class="op" id="4424928">,</span>&nbsp;<span class="ident" id="4424930">v</span><span class="op" id="4424931">,</span>&nbsp;<span class="ident" id="4424933">fieldParameters</span><span class="op" id="4424948">{</span><span class="op" id="4424949">}</span><span class="op" id="4424950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424953">if</span>&nbsp;<span class="ident" id="4424956">err</span>&nbsp;<span class="op" id="4424960">!=</span>&nbsp;<span class="ident" id="4424963">nil</span>&nbsp;<span class="op" id="4424967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424971">return</span>&nbsp;<span class="ident" id="4424978">nil</span><span class="op" id="4424981">,</span>&nbsp;<span class="ident" id="4424983">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4424988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424991">_</span><span class="op" id="4424992">,</span>&nbsp;<span class="ident" id="4424994">err</span>&nbsp;<span class="op" id="4424998">=</span>&nbsp;<span class="ident" id="4425000">f</span><span class="op" id="4425001">.</span><span class="ident" id="4425002">writeTo</span><span class="op" id="4425009">(</span><span class="op" id="4425010">&amp;</span><span class="ident" id="4425011">out</span><span class="op" id="4425014">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4425017">return</span>&nbsp;<span class="ident" id="4425024">out</span><span class="op" id="4425027">.</span><span class="ident" id="4425028">Bytes</span><span class="op" id="4425033">(</span><span class="op" id="4425034">)</span><span class="op" id="4425035">,</span>&nbsp;<span class="ident" id="4425037">nil</span><br>
<span class="lineno"></span><span class="op" id="4425041">}</span>
</div>
</body>
</html>
