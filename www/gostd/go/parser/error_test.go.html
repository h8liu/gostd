<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/parser</h2>
<ul>
<li><a href="/gostd/go/parser/error_test.go.html" class="current">error_test.go</a></li>
<li><a href="/gostd/go/parser/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/parser/interface.go.html">interface.go</a></li>
<li><a href="/gostd/go/parser/parser.go.html">parser.go</a></li>
<li><a href="/gostd/go/parser/parser_test.go.html">parser_test.go</a></li>
<li><a href="/gostd/go/parser/performance_test.go.html">performance_test.go</a></li>
<li><a href="/gostd/go/parser/short_test.go.html">short_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8535673">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8535728">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8535782">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="8535833">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;a&nbsp;parser&nbsp;test&nbsp;harness.&nbsp;The&nbsp;files&nbsp;in&nbsp;the&nbsp;testdata</span><br>
<span class="lineno"></span><span class="comment" id="8535906">//&nbsp;directory&nbsp;are&nbsp;parsed&nbsp;and&nbsp;the&nbsp;errors&nbsp;reported&nbsp;are&nbsp;compared&nbsp;against&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="8535979">//&nbsp;error&nbsp;messages&nbsp;expected&nbsp;in&nbsp;the&nbsp;test&nbsp;files.&nbsp;The&nbsp;test&nbsp;files&nbsp;must&nbsp;end&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="8536052">//&nbsp;.src&nbsp;rather&nbsp;than&nbsp;.go&nbsp;so&nbsp;that&nbsp;they&nbsp;are&nbsp;not&nbsp;disturbed&nbsp;by&nbsp;gofmt&nbsp;runs.</span><br>
<span class="lineno"></span><span class="comment" id="8536122">//</span><br>
<span class="lineno">10</span><span class="comment" id="8536125">//&nbsp;Expected&nbsp;errors&nbsp;are&nbsp;indicated&nbsp;in&nbsp;the&nbsp;test&nbsp;files&nbsp;by&nbsp;putting&nbsp;a&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="8536197">//&nbsp;of&nbsp;the&nbsp;form&nbsp;/*&nbsp;ERROR&nbsp;&#34;rx&#34;&nbsp;*/&nbsp;immediately&nbsp;following&nbsp;an&nbsp;offending&nbsp;token.</span><br>
<span class="lineno"></span><span class="comment" id="8536271">//&nbsp;The&nbsp;harness&nbsp;will&nbsp;verify&nbsp;that&nbsp;an&nbsp;error&nbsp;matching&nbsp;the&nbsp;regular&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="8536344">//&nbsp;rx&nbsp;is&nbsp;reported&nbsp;at&nbsp;that&nbsp;source&nbsp;position.</span><br>
<span class="lineno"></span><span class="comment" id="8536387">//</span><br>
<span class="lineno">15</span><span class="comment" id="8536390">//&nbsp;For&nbsp;instance,&nbsp;the&nbsp;following&nbsp;test&nbsp;file&nbsp;indicates&nbsp;that&nbsp;a&nbsp;&#34;not&nbsp;declared&#34;</span><br>
<span class="lineno"></span><span class="comment" id="8536463">//&nbsp;error&nbsp;should&nbsp;be&nbsp;reported&nbsp;for&nbsp;the&nbsp;undeclared&nbsp;variable&nbsp;x:</span><br>
<span class="lineno"></span><span class="comment" id="8536522">//</span><br>
<span class="lineno"></span><span class="comment" id="8536525">//&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;p</span><br>
<span class="lineno"></span><span class="comment" id="8536538">//&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;f()&nbsp;{</span><br>
<span class="lineno">20</span><span class="comment" id="8536552">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_&nbsp;=&nbsp;x&nbsp;/*&nbsp;ERROR&nbsp;&#34;not&nbsp;declared&#34;&nbsp;*/&nbsp;+&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="8536593">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8536599">package</span>&nbsp;<span class="ident" id="8536607">parser</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="8536615">import</span>&nbsp;<span class="op" id="8536622">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536625">&#34;go/scanner&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536639">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536651">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536664">&#34;path/filepath&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536681">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536691">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536702">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8536712">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="8536715">const</span>&nbsp;<span class="ident" id="8536721">testdata</span>&nbsp;<span class="op" id="8536730">=</span>&nbsp;<span class="string" id="8536732">&#34;testdata&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8536744">var</span>&nbsp;<span class="ident" id="8536748">fsetErrs</span>&nbsp;<span class="op" id="8536757">=</span>&nbsp;<span class="ident" id="8536759">token</span><span class="op" id="8536764">.</span><span class="ident" id="8536765">NewFileSet</span><span class="op" id="8536775">(</span><span class="op" id="8536776">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8536779">//&nbsp;getFile&nbsp;assumes&nbsp;that&nbsp;each&nbsp;filename&nbsp;occurs&nbsp;at&nbsp;most&nbsp;once</span><br>
<span class="lineno">40</span><span class="keyword" id="8536837">func</span>&nbsp;<span class="ident" id="8536842">getFile</span><span class="op" id="8536849">(</span><span class="ident" id="8536850">filename</span>&nbsp;<span class="builtintype" id="8536859">string</span><span class="op" id="8536865">)</span>&nbsp;<span class="op" id="8536867">(</span><span class="ident" id="8536868">file</span>&nbsp;<span class="op" id="8536873">*</span><span class="ident" id="8536874">token</span><span class="op" id="8536879">.</span><span class="ident" id="8536880">File</span><span class="op" id="8536884">)</span>&nbsp;<span class="op" id="8536886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536889">fsetErrs</span><span class="op" id="8536897">.</span><span class="ident" id="8536898">Iterate</span><span class="op" id="8536905">(</span><span class="keyword" id="8536906">func</span><span class="op" id="8536910">(</span><span class="ident" id="8536911">f</span>&nbsp;<span class="op" id="8536913">*</span><span class="ident" id="8536914">token</span><span class="op" id="8536919">.</span><span class="ident" id="8536920">File</span><span class="op" id="8536924">)</span>&nbsp;<span class="builtintype" id="8536926">bool</span>&nbsp;<span class="op" id="8536931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8536935">if</span>&nbsp;<span class="ident" id="8536938">f</span><span class="op" id="8536939">.</span><span class="ident" id="8536940">Name</span><span class="op" id="8536944">(</span><span class="op" id="8536945">)</span>&nbsp;<span class="op" id="8536947">==</span>&nbsp;<span class="ident" id="8536950">filename</span>&nbsp;<span class="op" id="8536959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8536964">if</span>&nbsp;<span class="ident" id="8536967">file</span>&nbsp;<span class="op" id="8536972">!=</span>&nbsp;<span class="builtintype" id="8536975">nil</span>&nbsp;<span class="op" id="8536979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8536985">panic</span><span class="op" id="8536990">(</span><span class="ident" id="8536991">filename</span>&nbsp;<span class="op" id="8537000">+</span>&nbsp;<span class="string" id="8537002">&#34;&nbsp;used&nbsp;multiple&nbsp;times&#34;</span><span class="op" id="8537024">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537034">file</span>&nbsp;<span class="op" id="8537039">=</span>&nbsp;<span class="ident" id="8537041">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8537049">return</span>&nbsp;<span class="builtintype" id="8537056">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537062">}</span><span class="op" id="8537063">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8537066">return</span>&nbsp;<span class="ident" id="8537073">file</span><br>
<span class="lineno"></span><span class="op" id="8537078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8537081">func</span>&nbsp;<span class="ident" id="8537086">getPos</span><span class="op" id="8537092">(</span><span class="ident" id="8537093">filename</span>&nbsp;<span class="builtintype" id="8537102">string</span><span class="op" id="8537108">,</span>&nbsp;<span class="ident" id="8537110">offset</span>&nbsp;<span class="builtintype" id="8537117">int</span><span class="op" id="8537120">)</span>&nbsp;<span class="ident" id="8537122">token</span><span class="op" id="8537127">.</span><span class="ident" id="8537128">Pos</span>&nbsp;<span class="op" id="8537132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8537135">if</span>&nbsp;<span class="ident" id="8537138">f</span>&nbsp;<span class="op" id="8537140">:=</span>&nbsp;<span class="ident" id="8537143">getFile</span><span class="op" id="8537150">(</span><span class="ident" id="8537151">filename</span><span class="op" id="8537159">)</span><span class="op" id="8537160">;</span>&nbsp;<span class="ident" id="8537162">f</span>&nbsp;<span class="op" id="8537164">!=</span>&nbsp;<span class="builtintype" id="8537167">nil</span>&nbsp;<span class="op" id="8537171">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8537175">return</span>&nbsp;<span class="ident" id="8537182">f</span><span class="op" id="8537183">.</span><span class="ident" id="8537184">Pos</span><span class="op" id="8537187">(</span><span class="ident" id="8537188">offset</span><span class="op" id="8537194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8537200">return</span>&nbsp;<span class="ident" id="8537207">token</span><span class="op" id="8537212">.</span><span class="ident" id="8537213">NoPos</span><br>
<span class="lineno"></span><span class="op" id="8537219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="8537222">//&nbsp;ERROR&nbsp;comments&nbsp;must&nbsp;be&nbsp;of&nbsp;the&nbsp;form&nbsp;/*&nbsp;ERROR&nbsp;&#34;rx&#34;&nbsp;*/&nbsp;and&nbsp;rx&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="8537287">//&nbsp;a&nbsp;regular&nbsp;expression&nbsp;that&nbsp;matches&nbsp;the&nbsp;expected&nbsp;error&nbsp;message.</span><br>
<span class="lineno"></span><span class="comment" id="8537352">//&nbsp;The&nbsp;special&nbsp;form&nbsp;/*&nbsp;ERROR&nbsp;HERE&nbsp;&#34;rx&#34;&nbsp;*/&nbsp;must&nbsp;be&nbsp;used&nbsp;for&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="8537417">//&nbsp;messages&nbsp;that&nbsp;appear&nbsp;immediately&nbsp;after&nbsp;a&nbsp;token,&nbsp;rather&nbsp;than&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="8537483">//&nbsp;a&nbsp;token&#39;s&nbsp;position.</span><br>
<span class="lineno">65</span><span class="comment" id="8537506">//</span><br>
<span class="lineno"></span><span class="keyword" id="8537509">var</span>&nbsp;<span class="ident" id="8537513">errRx</span>&nbsp;<span class="op" id="8537519">=</span>&nbsp;<span class="ident" id="8537521">regexp</span><span class="op" id="8537527">.</span><span class="ident" id="8537528">MustCompile</span><span class="op" id="8537539">(</span><span class="string" id="8537540">`^/\*&nbsp;*ERROR&nbsp;*(HERE)?&nbsp;*&#34;([^&#34;]*)&#34;&nbsp;*\*/$`</span><span class="op" id="8537579">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8537582">//&nbsp;expectedErrors&nbsp;collects&nbsp;the&nbsp;regular&nbsp;expressions&nbsp;of&nbsp;ERROR&nbsp;comments&nbsp;found</span><br>
<span class="lineno"></span><span class="comment" id="8537657">//&nbsp;in&nbsp;files&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a&nbsp;map&nbsp;of&nbsp;error&nbsp;positions&nbsp;to&nbsp;error&nbsp;messages.</span><br>
<span class="lineno">70</span><span class="comment" id="8537733">//</span><br>
<span class="lineno"></span><span class="keyword" id="8537736">func</span>&nbsp;<span class="ident" id="8537741">expectedErrors</span><span class="op" id="8537755">(</span><span class="ident" id="8537756">t</span>&nbsp;<span class="op" id="8537758">*</span><span class="ident" id="8537759">testing</span><span class="op" id="8537766">.</span><span class="ident" id="8537767">T</span><span class="op" id="8537768">,</span>&nbsp;<span class="ident" id="8537770">filename</span>&nbsp;<span class="builtintype" id="8537779">string</span><span class="op" id="8537785">,</span>&nbsp;<span class="ident" id="8537787">src</span>&nbsp;<span class="op" id="8537791">[</span><span class="op" id="8537792">]</span><span class="builtintype" id="8537793">byte</span><span class="op" id="8537797">)</span>&nbsp;<span class="keyword" id="8537799">map</span><span class="op" id="8537802">[</span><span class="ident" id="8537803">token</span><span class="op" id="8537808">.</span><span class="ident" id="8537809">Pos</span><span class="op" id="8537812">]</span><span class="builtintype" id="8537813">string</span>&nbsp;<span class="op" id="8537820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537823">errors</span>&nbsp;<span class="op" id="8537830">:=</span>&nbsp;<span class="builtinfunc" id="8537833">make</span><span class="op" id="8537837">(</span><span class="keyword" id="8537838">map</span><span class="op" id="8537841">[</span><span class="ident" id="8537842">token</span><span class="op" id="8537847">.</span><span class="ident" id="8537848">Pos</span><span class="op" id="8537851">]</span><span class="builtintype" id="8537852">string</span><span class="op" id="8537858">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8537862">var</span>&nbsp;<span class="ident" id="8537866">s</span>&nbsp;<span class="ident" id="8537868">scanner</span><span class="op" id="8537875">.</span><span class="ident" id="8537876">Scanner</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8537885">//&nbsp;file&nbsp;was&nbsp;parsed&nbsp;already&nbsp;-&nbsp;do&nbsp;not&nbsp;add&nbsp;it&nbsp;again&nbsp;to&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8537947">//&nbsp;set&nbsp;otherwise&nbsp;the&nbsp;position&nbsp;information&nbsp;returned&nbsp;here&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8538009">//&nbsp;not&nbsp;match&nbsp;the&nbsp;position&nbsp;information&nbsp;collected&nbsp;by&nbsp;the&nbsp;parser</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538072">s</span><span class="op" id="8538073">.</span><span class="ident" id="8538074">Init</span><span class="op" id="8538078">(</span><span class="ident" id="8538079">getFile</span><span class="op" id="8538086">(</span><span class="ident" id="8538087">filename</span><span class="op" id="8538095">)</span><span class="op" id="8538096">,</span>&nbsp;<span class="ident" id="8538098">src</span><span class="op" id="8538101">,</span>&nbsp;<span class="builtintype" id="8538103">nil</span><span class="op" id="8538106">,</span>&nbsp;<span class="ident" id="8538108">scanner</span><span class="op" id="8538115">.</span><span class="ident" id="8538116">ScanComments</span><span class="op" id="8538128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8538131">var</span>&nbsp;<span class="ident" id="8538135">prev</span>&nbsp;<span class="ident" id="8538140">token</span><span class="op" id="8538145">.</span><span class="ident" id="8538146">Pos</span>&nbsp;<span class="comment" id="8538150">//&nbsp;position&nbsp;of&nbsp;last&nbsp;non-comment,&nbsp;non-semicolon&nbsp;token</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8538204">var</span>&nbsp;<span class="ident" id="8538208">here</span>&nbsp;<span class="ident" id="8538213">token</span><span class="op" id="8538218">.</span><span class="ident" id="8538219">Pos</span>&nbsp;<span class="comment" id="8538223">//&nbsp;position&nbsp;immediately&nbsp;after&nbsp;the&nbsp;token&nbsp;at&nbsp;position&nbsp;prev</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8538282">for</span>&nbsp;<span class="op" id="8538286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538290">pos</span><span class="op" id="8538293">,</span>&nbsp;<span class="ident" id="8538295">tok</span><span class="op" id="8538298">,</span>&nbsp;<span class="ident" id="8538300">lit</span>&nbsp;<span class="op" id="8538304">:=</span>&nbsp;<span class="ident" id="8538307">s</span><span class="op" id="8538308">.</span><span class="ident" id="8538309">Scan</span><span class="op" id="8538313">(</span><span class="op" id="8538314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8538318">switch</span>&nbsp;<span class="ident" id="8538325">tok</span>&nbsp;<span class="op" id="8538329">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8538333">case</span>&nbsp;<span class="ident" id="8538338">token</span><span class="op" id="8538343">.</span><span class="ident" id="8538344">EOF</span><span class="op" id="8538347">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8538352">return</span>&nbsp;<span class="ident" id="8538359">errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8538368">case</span>&nbsp;<span class="ident" id="8538373">token</span><span class="op" id="8538378">.</span><span class="ident" id="8538379">COMMENT</span><span class="op" id="8538386">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538391">s</span>&nbsp;<span class="op" id="8538393">:=</span>&nbsp;<span class="ident" id="8538396">errRx</span><span class="op" id="8538401">.</span><span class="ident" id="8538402">FindStringSubmatch</span><span class="op" id="8538420">(</span><span class="ident" id="8538421">lit</span><span class="op" id="8538424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8538429">if</span>&nbsp;<span class="builtinfunc" id="8538432">len</span><span class="op" id="8538435">(</span><span class="ident" id="8538436">s</span><span class="op" id="8538437">)</span>&nbsp;<span class="op" id="8538439">==</span>&nbsp;<span class="num" id="8538442">3</span>&nbsp;<span class="op" id="8538444">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538450">pos</span>&nbsp;<span class="op" id="8538454">:=</span>&nbsp;<span class="ident" id="8538457">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8538466">if</span>&nbsp;<span class="ident" id="8538469">s</span><span class="op" id="8538470">[</span><span class="num" id="8538471">1</span><span class="op" id="8538472">]</span>&nbsp;<span class="op" id="8538474">==</span>&nbsp;<span class="string" id="8538477">&#34;HERE&#34;</span>&nbsp;<span class="op" id="8538484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538491">pos</span>&nbsp;<span class="op" id="8538495">=</span>&nbsp;<span class="ident" id="8538497">here</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538512">errors</span><span class="op" id="8538518">[</span><span class="ident" id="8538519">pos</span><span class="op" id="8538522">]</span>&nbsp;<span class="op" id="8538524">=</span>&nbsp;<span class="builtintype" id="8538526">string</span><span class="op" id="8538532">(</span><span class="ident" id="8538533">s</span><span class="op" id="8538534">[</span><span class="num" id="8538535">2</span><span class="op" id="8538536">]</span><span class="op" id="8538537">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8538546">default</span><span class="op" id="8538553">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538558">prev</span>&nbsp;<span class="op" id="8538563">=</span>&nbsp;<span class="ident" id="8538565">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8538572">var</span>&nbsp;<span class="ident" id="8538576">l</span>&nbsp;<span class="builtintype" id="8538578">int</span>&nbsp;<span class="comment" id="8538582">//&nbsp;token&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8538601">if</span>&nbsp;<span class="ident" id="8538604">tok</span><span class="op" id="8538607">.</span><span class="ident" id="8538608">IsLiteral</span><span class="op" id="8538617">(</span><span class="op" id="8538618">)</span>&nbsp;<span class="op" id="8538620">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538626">l</span>&nbsp;<span class="op" id="8538628">=</span>&nbsp;<span class="builtinfunc" id="8538630">len</span><span class="op" id="8538633">(</span><span class="ident" id="8538634">lit</span><span class="op" id="8538637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538642">}</span>&nbsp;<span class="keyword" id="8538644">else</span>&nbsp;<span class="op" id="8538649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538655">l</span>&nbsp;<span class="op" id="8538657">=</span>&nbsp;<span class="builtinfunc" id="8538659">len</span><span class="op" id="8538662">(</span><span class="ident" id="8538663">tok</span><span class="op" id="8538666">.</span><span class="ident" id="8538667">String</span><span class="op" id="8538673">(</span><span class="op" id="8538674">)</span><span class="op" id="8538675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538685">here</span>&nbsp;<span class="op" id="8538690">=</span>&nbsp;<span class="ident" id="8538692">prev</span>&nbsp;<span class="op" id="8538697">+</span>&nbsp;<span class="ident" id="8538699">token</span><span class="op" id="8538704">.</span><span class="ident" id="8538705">Pos</span><span class="op" id="8538708">(</span><span class="ident" id="8538709">l</span><span class="op" id="8538710">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538717">}</span><br>
<span class="lineno"></span><span class="op" id="8538719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8538722">//&nbsp;compareErrors&nbsp;compares&nbsp;the&nbsp;map&nbsp;of&nbsp;expected&nbsp;error&nbsp;messages&nbsp;with&nbsp;the&nbsp;list</span><br>
<span class="lineno">110</span><span class="comment" id="8538797">//&nbsp;of&nbsp;found&nbsp;errors&nbsp;and&nbsp;reports&nbsp;discrepancies.</span><br>
<span class="lineno"></span><span class="comment" id="8538843">//</span><br>
<span class="lineno"></span><span class="keyword" id="8538846">func</span>&nbsp;<span class="ident" id="8538851">compareErrors</span><span class="op" id="8538864">(</span><span class="ident" id="8538865">t</span>&nbsp;<span class="op" id="8538867">*</span><span class="ident" id="8538868">testing</span><span class="op" id="8538875">.</span><span class="ident" id="8538876">T</span><span class="op" id="8538877">,</span>&nbsp;<span class="ident" id="8538879">expected</span>&nbsp;<span class="keyword" id="8538888">map</span><span class="op" id="8538891">[</span><span class="ident" id="8538892">token</span><span class="op" id="8538897">.</span><span class="ident" id="8538898">Pos</span><span class="op" id="8538901">]</span><span class="builtintype" id="8538902">string</span><span class="op" id="8538908">,</span>&nbsp;<span class="ident" id="8538910">found</span>&nbsp;<span class="ident" id="8538916">scanner</span><span class="op" id="8538923">.</span><span class="ident" id="8538924">ErrorList</span><span class="op" id="8538933">)</span>&nbsp;<span class="op" id="8538935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8538938">for</span>&nbsp;<span class="ident" id="8538942">_</span><span class="op" id="8538943">,</span>&nbsp;<span class="builtintype" id="8538945">error</span>&nbsp;<span class="op" id="8538951">:=</span>&nbsp;<span class="keyword" id="8538954">range</span>&nbsp;<span class="ident" id="8538960">found</span>&nbsp;<span class="op" id="8538966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8538970">//&nbsp;error.Pos&nbsp;is&nbsp;a&nbsp;token.Position,&nbsp;but&nbsp;we&nbsp;want</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8539018">//&nbsp;a&nbsp;token.Pos&nbsp;so&nbsp;we&nbsp;can&nbsp;do&nbsp;a&nbsp;map&nbsp;lookup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539061">pos</span>&nbsp;<span class="op" id="8539065">:=</span>&nbsp;<span class="ident" id="8539068">getPos</span><span class="op" id="8539074">(</span><span class="builtintype" id="8539075">error</span><span class="op" id="8539080">.</span><span class="ident" id="8539081">Pos</span><span class="op" id="8539084">.</span><span class="ident" id="8539085">Filename</span><span class="op" id="8539093">,</span>&nbsp;<span class="builtintype" id="8539095">error</span><span class="op" id="8539100">.</span><span class="ident" id="8539101">Pos</span><span class="op" id="8539104">.</span><span class="ident" id="8539105">Offset</span><span class="op" id="8539111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8539115">if</span>&nbsp;<span class="ident" id="8539118">msg</span><span class="op" id="8539121">,</span>&nbsp;<span class="ident" id="8539123">found</span>&nbsp;<span class="op" id="8539129">:=</span>&nbsp;<span class="ident" id="8539132">expected</span><span class="op" id="8539140">[</span><span class="ident" id="8539141">pos</span><span class="op" id="8539144">]</span><span class="op" id="8539145">;</span>&nbsp;<span class="ident" id="8539147">found</span>&nbsp;<span class="op" id="8539153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8539158">//&nbsp;we&nbsp;expect&nbsp;a&nbsp;message&nbsp;at&nbsp;pos;&nbsp;check&nbsp;if&nbsp;it&nbsp;matches</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539212">rx</span><span class="op" id="8539214">,</span>&nbsp;<span class="ident" id="8539216">err</span>&nbsp;<span class="op" id="8539220">:=</span>&nbsp;<span class="ident" id="8539223">regexp</span><span class="op" id="8539229">.</span><span class="ident" id="8539230">Compile</span><span class="op" id="8539237">(</span><span class="ident" id="8539238">msg</span><span class="op" id="8539241">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8539246">if</span>&nbsp;<span class="ident" id="8539249">err</span>&nbsp;<span class="op" id="8539253">!=</span>&nbsp;<span class="builtintype" id="8539256">nil</span>&nbsp;<span class="op" id="8539260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539266">t</span><span class="op" id="8539267">.</span><span class="ident" id="8539268">Errorf</span><span class="op" id="8539274">(</span><span class="string" id="8539275">&#34;%s:&nbsp;%v&#34;</span><span class="op" id="8539283">,</span>&nbsp;<span class="builtintype" id="8539285">error</span><span class="op" id="8539290">.</span><span class="ident" id="8539291">Pos</span><span class="op" id="8539294">,</span>&nbsp;<span class="ident" id="8539296">err</span><span class="op" id="8539299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8539305">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8539322">if</span>&nbsp;<span class="ident" id="8539325">match</span>&nbsp;<span class="op" id="8539331">:=</span>&nbsp;<span class="ident" id="8539334">rx</span><span class="op" id="8539336">.</span><span class="ident" id="8539337">MatchString</span><span class="op" id="8539348">(</span><span class="builtintype" id="8539349">error</span><span class="op" id="8539354">.</span><span class="ident" id="8539355">Msg</span><span class="op" id="8539358">)</span><span class="op" id="8539359">;</span>&nbsp;<span class="op" id="8539361">!</span><span class="ident" id="8539362">match</span>&nbsp;<span class="op" id="8539368">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539374">t</span><span class="op" id="8539375">.</span><span class="ident" id="8539376">Errorf</span><span class="op" id="8539382">(</span><span class="string" id="8539383">&#34;%s:&nbsp;%q&nbsp;does&nbsp;not&nbsp;match&nbsp;%q&#34;</span><span class="op" id="8539409">,</span>&nbsp;<span class="builtintype" id="8539411">error</span><span class="op" id="8539416">.</span><span class="ident" id="8539417">Pos</span><span class="op" id="8539420">,</span>&nbsp;<span class="builtintype" id="8539422">error</span><span class="op" id="8539427">.</span><span class="ident" id="8539428">Msg</span><span class="op" id="8539431">,</span>&nbsp;<span class="ident" id="8539433">msg</span><span class="op" id="8539436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8539442">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8539459">//&nbsp;we&nbsp;have&nbsp;a&nbsp;match&nbsp;-&nbsp;eliminate&nbsp;this&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8539504">delete</span><span class="op" id="8539510">(</span><span class="ident" id="8539511">expected</span><span class="op" id="8539519">,</span>&nbsp;<span class="ident" id="8539521">pos</span><span class="op" id="8539524">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539528">}</span>&nbsp;<span class="keyword" id="8539530">else</span>&nbsp;<span class="op" id="8539535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8539540">//&nbsp;To&nbsp;keep&nbsp;in&nbsp;mind&nbsp;when&nbsp;analyzing&nbsp;failed&nbsp;test&nbsp;output:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8539597">//&nbsp;If&nbsp;the&nbsp;same&nbsp;error&nbsp;position&nbsp;occurs&nbsp;multiple&nbsp;times&nbsp;in&nbsp;errors,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8539663">//&nbsp;this&nbsp;message&nbsp;will&nbsp;be&nbsp;triggered&nbsp;(because&nbsp;the&nbsp;first&nbsp;error&nbsp;at</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8539728">//&nbsp;the&nbsp;position&nbsp;removes&nbsp;this&nbsp;position&nbsp;from&nbsp;the&nbsp;expected&nbsp;errors).</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539796">t</span><span class="op" id="8539797">.</span><span class="ident" id="8539798">Errorf</span><span class="op" id="8539804">(</span><span class="string" id="8539805">&#34;%s:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8539831">,</span>&nbsp;<span class="builtintype" id="8539833">error</span><span class="op" id="8539838">.</span><span class="ident" id="8539839">Pos</span><span class="op" id="8539842">,</span>&nbsp;<span class="builtintype" id="8539844">error</span><span class="op" id="8539849">.</span><span class="ident" id="8539850">Msg</span><span class="op" id="8539853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8539864">//&nbsp;there&nbsp;should&nbsp;be&nbsp;no&nbsp;expected&nbsp;errors&nbsp;left</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8539908">if</span>&nbsp;<span class="builtinfunc" id="8539911">len</span><span class="op" id="8539914">(</span><span class="ident" id="8539915">expected</span><span class="op" id="8539923">)</span>&nbsp;<span class="op" id="8539925">&gt;</span>&nbsp;<span class="num" id="8539927">0</span>&nbsp;<span class="op" id="8539929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539933">t</span><span class="op" id="8539934">.</span><span class="ident" id="8539935">Errorf</span><span class="op" id="8539941">(</span><span class="string" id="8539942">&#34;%d&nbsp;errors&nbsp;not&nbsp;reported:&#34;</span><span class="op" id="8539967">,</span>&nbsp;<span class="builtinfunc" id="8539969">len</span><span class="op" id="8539972">(</span><span class="ident" id="8539973">expected</span><span class="op" id="8539981">)</span><span class="op" id="8539982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8539986">for</span>&nbsp;<span class="ident" id="8539990">pos</span><span class="op" id="8539993">,</span>&nbsp;<span class="ident" id="8539995">msg</span>&nbsp;<span class="op" id="8539999">:=</span>&nbsp;<span class="keyword" id="8540002">range</span>&nbsp;<span class="ident" id="8540008">expected</span>&nbsp;<span class="op" id="8540017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540022">t</span><span class="op" id="8540023">.</span><span class="ident" id="8540024">Errorf</span><span class="op" id="8540030">(</span><span class="string" id="8540031">&#34;%s:&nbsp;%s\n&#34;</span><span class="op" id="8540041">,</span>&nbsp;<span class="ident" id="8540043">fsetErrs</span><span class="op" id="8540051">.</span><span class="ident" id="8540052">Position</span><span class="op" id="8540060">(</span><span class="ident" id="8540061">pos</span><span class="op" id="8540064">)</span><span class="op" id="8540065">,</span>&nbsp;<span class="ident" id="8540067">msg</span><span class="op" id="8540070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540074">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540077">}</span><br>
<span class="lineno"></span><span class="op" id="8540079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8540082">func</span>&nbsp;<span class="ident" id="8540087">checkErrors</span><span class="op" id="8540098">(</span><span class="ident" id="8540099">t</span>&nbsp;<span class="op" id="8540101">*</span><span class="ident" id="8540102">testing</span><span class="op" id="8540109">.</span><span class="ident" id="8540110">T</span><span class="op" id="8540111">,</span>&nbsp;<span class="ident" id="8540113">filename</span>&nbsp;<span class="builtintype" id="8540122">string</span><span class="op" id="8540128">,</span>&nbsp;<span class="ident" id="8540130">input</span>&nbsp;<span class="keyword" id="8540136">interface</span><span class="op" id="8540145">{</span><span class="op" id="8540146">}</span><span class="op" id="8540147">)</span>&nbsp;<span class="op" id="8540149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540152">src</span><span class="op" id="8540155">,</span>&nbsp;<span class="ident" id="8540157">err</span>&nbsp;<span class="op" id="8540161">:=</span>&nbsp;<span class="ident" id="8540164">readSource</span><span class="op" id="8540174">(</span><span class="ident" id="8540175">filename</span><span class="op" id="8540183">,</span>&nbsp;<span class="ident" id="8540185">input</span><span class="op" id="8540190">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8540193">if</span>&nbsp;<span class="ident" id="8540196">err</span>&nbsp;<span class="op" id="8540200">!=</span>&nbsp;<span class="builtintype" id="8540203">nil</span>&nbsp;<span class="op" id="8540207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540211">t</span><span class="op" id="8540212">.</span><span class="ident" id="8540213">Error</span><span class="op" id="8540218">(</span><span class="ident" id="8540219">err</span><span class="op" id="8540222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8540226">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540238">_</span><span class="op" id="8540239">,</span>&nbsp;<span class="ident" id="8540241">err</span>&nbsp;<span class="op" id="8540245">=</span>&nbsp;<span class="ident" id="8540247">ParseFile</span><span class="op" id="8540256">(</span><span class="ident" id="8540257">fsetErrs</span><span class="op" id="8540265">,</span>&nbsp;<span class="ident" id="8540267">filename</span><span class="op" id="8540275">,</span>&nbsp;<span class="ident" id="8540277">src</span><span class="op" id="8540280">,</span>&nbsp;<span class="ident" id="8540282">DeclarationErrors</span><span class="op" id="8540299">|</span><span class="ident" id="8540300">AllErrors</span><span class="op" id="8540309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540312">found</span><span class="op" id="8540317">,</span>&nbsp;<span class="ident" id="8540319">ok</span>&nbsp;<span class="op" id="8540322">:=</span>&nbsp;<span class="ident" id="8540325">err</span><span class="op" id="8540328">.</span><span class="op" id="8540329">(</span><span class="ident" id="8540330">scanner</span><span class="op" id="8540337">.</span><span class="ident" id="8540338">ErrorList</span><span class="op" id="8540347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8540350">if</span>&nbsp;<span class="ident" id="8540353">err</span>&nbsp;<span class="op" id="8540357">!=</span>&nbsp;<span class="builtintype" id="8540360">nil</span>&nbsp;<span class="op" id="8540364">&amp;&amp;</span>&nbsp;<span class="op" id="8540367">!</span><span class="ident" id="8540368">ok</span>&nbsp;<span class="op" id="8540371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540375">t</span><span class="op" id="8540376">.</span><span class="ident" id="8540377">Error</span><span class="op" id="8540382">(</span><span class="ident" id="8540383">err</span><span class="op" id="8540386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8540390">return</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540401">found</span><span class="op" id="8540406">.</span><span class="ident" id="8540407">RemoveMultiples</span><span class="op" id="8540422">(</span><span class="op" id="8540423">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8540427">//&nbsp;we&nbsp;are&nbsp;expecting&nbsp;the&nbsp;following&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8540469">//&nbsp;(collect&nbsp;these&nbsp;after&nbsp;parsing&nbsp;a&nbsp;file&nbsp;so&nbsp;that&nbsp;it&nbsp;is&nbsp;found&nbsp;in&nbsp;the&nbsp;file&nbsp;set)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540546">expected</span>&nbsp;<span class="op" id="8540555">:=</span>&nbsp;<span class="ident" id="8540558">expectedErrors</span><span class="op" id="8540572">(</span><span class="ident" id="8540573">t</span><span class="op" id="8540574">,</span>&nbsp;<span class="ident" id="8540576">filename</span><span class="op" id="8540584">,</span>&nbsp;<span class="ident" id="8540586">src</span><span class="op" id="8540589">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8540593">//&nbsp;verify&nbsp;errors&nbsp;returned&nbsp;by&nbsp;the&nbsp;parser</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540634">compareErrors</span><span class="op" id="8540647">(</span><span class="ident" id="8540648">t</span><span class="op" id="8540649">,</span>&nbsp;<span class="ident" id="8540651">expected</span><span class="op" id="8540659">,</span>&nbsp;<span class="ident" id="8540661">found</span><span class="op" id="8540666">)</span><br>
<span class="lineno"></span><span class="op" id="8540668">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8540671">func</span>&nbsp;<span class="ident" id="8540676">TestErrors</span><span class="op" id="8540686">(</span><span class="ident" id="8540687">t</span>&nbsp;<span class="op" id="8540689">*</span><span class="ident" id="8540690">testing</span><span class="op" id="8540697">.</span><span class="ident" id="8540698">T</span><span class="op" id="8540699">)</span>&nbsp;<span class="op" id="8540701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540704">list</span><span class="op" id="8540708">,</span>&nbsp;<span class="ident" id="8540710">err</span>&nbsp;<span class="op" id="8540714">:=</span>&nbsp;<span class="ident" id="8540717">ioutil</span><span class="op" id="8540723">.</span><span class="ident" id="8540724">ReadDir</span><span class="op" id="8540731">(</span><span class="ident" id="8540732">testdata</span><span class="op" id="8540740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8540743">if</span>&nbsp;<span class="ident" id="8540746">err</span>&nbsp;<span class="op" id="8540750">!=</span>&nbsp;<span class="builtintype" id="8540753">nil</span>&nbsp;<span class="op" id="8540757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540761">t</span><span class="op" id="8540762">.</span><span class="ident" id="8540763">Fatal</span><span class="op" id="8540768">(</span><span class="ident" id="8540769">err</span><span class="op" id="8540772">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8540778">for</span>&nbsp;<span class="ident" id="8540782">_</span><span class="op" id="8540783">,</span>&nbsp;<span class="ident" id="8540785">fi</span>&nbsp;<span class="op" id="8540788">:=</span>&nbsp;<span class="keyword" id="8540791">range</span>&nbsp;<span class="ident" id="8540797">list</span>&nbsp;<span class="op" id="8540802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540806">name</span>&nbsp;<span class="op" id="8540811">:=</span>&nbsp;<span class="ident" id="8540814">fi</span><span class="op" id="8540816">.</span><span class="ident" id="8540817">Name</span><span class="op" id="8540821">(</span><span class="op" id="8540822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8540826">if</span>&nbsp;<span class="op" id="8540829">!</span><span class="ident" id="8540830">fi</span><span class="op" id="8540832">.</span><span class="ident" id="8540833">IsDir</span><span class="op" id="8540838">(</span><span class="op" id="8540839">)</span>&nbsp;<span class="op" id="8540841">&amp;&amp;</span>&nbsp;<span class="op" id="8540844">!</span><span class="ident" id="8540845">strings</span><span class="op" id="8540852">.</span><span class="ident" id="8540853">HasPrefix</span><span class="op" id="8540862">(</span><span class="ident" id="8540863">name</span><span class="op" id="8540867">,</span>&nbsp;<span class="string" id="8540869">&#34;.&#34;</span><span class="op" id="8540872">)</span>&nbsp;<span class="op" id="8540874">&amp;&amp;</span>&nbsp;<span class="ident" id="8540877">strings</span><span class="op" id="8540884">.</span><span class="ident" id="8540885">HasSuffix</span><span class="op" id="8540894">(</span><span class="ident" id="8540895">name</span><span class="op" id="8540899">,</span>&nbsp;<span class="string" id="8540901">&#34;.src&#34;</span><span class="op" id="8540907">)</span>&nbsp;<span class="op" id="8540909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540914">checkErrors</span><span class="op" id="8540925">(</span><span class="ident" id="8540926">t</span><span class="op" id="8540927">,</span>&nbsp;<span class="ident" id="8540929">filepath</span><span class="op" id="8540937">.</span><span class="ident" id="8540938">Join</span><span class="op" id="8540942">(</span><span class="ident" id="8540943">testdata</span><span class="op" id="8540951">,</span>&nbsp;<span class="ident" id="8540953">name</span><span class="op" id="8540957">)</span><span class="op" id="8540958">,</span>&nbsp;<span class="builtintype" id="8540960">nil</span><span class="op" id="8540963">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540970">}</span><br>
<span class="lineno"></span><span class="op" id="8540972">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
