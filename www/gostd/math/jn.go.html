<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html" class="current">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2224190">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2224245">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2224299">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2224350">package</span>&nbsp;<span class="ident" id="2224358">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2224364">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;kinds&nbsp;of&nbsp;order&nbsp;n.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2224430">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2224484">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_jn.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2224535">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2224590">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2224620">//</span><br>
<span class="lineno"></span><span class="comment" id="2224623">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2224679">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2224748">//</span><br>
<span class="lineno"></span><span class="comment" id="2224751">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2224810">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2224866">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2224923">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2224940">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2224996">//</span><br>
<span class="lineno">25</span><span class="comment" id="2224999">//&nbsp;__ieee754_jn(n,&nbsp;x),&nbsp;__ieee754_yn(n,&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2225041">//&nbsp;floating&nbsp;point&nbsp;Bessel&#39;s&nbsp;function&nbsp;of&nbsp;the&nbsp;1st&nbsp;and&nbsp;2nd&nbsp;kind</span><br>
<span class="lineno"></span><span class="comment" id="2225101">//&nbsp;of&nbsp;order&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="2225115">//</span><br>
<span class="lineno"></span><span class="comment" id="2225118">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno">30</span><span class="comment" id="2225136">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(0)=y1(0)=yn(n,0)&nbsp;=&nbsp;-inf&nbsp;with&nbsp;division&nbsp;by&nbsp;zero&nbsp;signal;</span><br>
<span class="lineno"></span><span class="comment" id="2225201">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(-ve)=y1(-ve)=yn(n,-ve)&nbsp;are&nbsp;NaN&nbsp;with&nbsp;invalid&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="2225264">//&nbsp;Note&nbsp;2.&nbsp;About&nbsp;jn(n,x),&nbsp;yn(n,x)</span><br>
<span class="lineno"></span><span class="comment" id="2225298">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;n=0,&nbsp;j0(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno"></span><span class="comment" id="2225332">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n=1,&nbsp;j1(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno">35</span><span class="comment" id="2225366">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&lt;x,&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="2225418">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;values&nbsp;of&nbsp;j0(x)&nbsp;and&nbsp;j1(x).</span><br>
<span class="lineno"></span><span class="comment" id="2225458">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&gt;x,&nbsp;a&nbsp;continued&nbsp;fraction&nbsp;approximation&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2225513">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j(n,x)/j(n-1,x)&nbsp;is&nbsp;evaluated&nbsp;and&nbsp;then&nbsp;backward</span><br>
<span class="lineno"></span><span class="comment" id="2225568">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting&nbsp;from&nbsp;a&nbsp;supposed&nbsp;value</span><br>
<span class="lineno">40</span><span class="comment" id="2225625">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j(n,x).&nbsp;The&nbsp;resulting&nbsp;value&nbsp;of&nbsp;j(0,x)&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2225678">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compared&nbsp;with&nbsp;the&nbsp;actual&nbsp;value&nbsp;to&nbsp;correct&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2225732">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;supposed&nbsp;value&nbsp;of&nbsp;j(n,x).</span><br>
<span class="lineno"></span><span class="comment" id="2225766">//</span><br>
<span class="lineno"></span><span class="comment" id="2225769">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yn(n,x)&nbsp;is&nbsp;similar&nbsp;in&nbsp;all&nbsp;respects,&nbsp;except</span><br>
<span class="lineno">45</span><span class="comment" id="2225820">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2225867">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;of&nbsp;n&gt;1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2225891">//&nbsp;Jn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2225952">//</span><br>
<span class="lineno">50</span><span class="comment" id="2225955">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2225977">//&nbsp;&nbsp;&nbsp;&nbsp;Jn(n,&nbsp;Â±Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2225997">//&nbsp;&nbsp;&nbsp;&nbsp;Jn(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2226017">func</span>&nbsp;<span class="ident" id="2226022">Jn</span><span class="op" id="2226024">(</span><span class="ident" id="2226025">n</span>&nbsp;<span class="builtintype" id="2226027">int</span><span class="op" id="2226030">,</span>&nbsp;<span class="ident" id="2226032">x</span>&nbsp;<span class="builtintype" id="2226034">float64</span><span class="op" id="2226041">)</span>&nbsp;<span class="builtintype" id="2226043">float64</span>&nbsp;<span class="op" id="2226051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226054">const</span>&nbsp;<span class="op" id="2226060">(</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226064">TwoM29</span>&nbsp;<span class="op" id="2226071">=</span>&nbsp;<span class="num" id="2226073">1.0</span>&nbsp;<span class="op" id="2226077">/</span>&nbsp;<span class="op" id="2226079">(</span><span class="num" id="2226080">1</span>&nbsp;<span class="op" id="2226082">&lt;&lt;</span>&nbsp;<span class="num" id="2226085">29</span><span class="op" id="2226087">)</span>&nbsp;<span class="comment" id="2226089">//&nbsp;2**-29&nbsp;0x3e10000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226120">Two302</span>&nbsp;<span class="op" id="2226127">=</span>&nbsp;<span class="num" id="2226129">1</span>&nbsp;<span class="op" id="2226131">&lt;&lt;</span>&nbsp;<span class="num" id="2226134">302</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2226145">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2226175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2226178">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226196">switch</span>&nbsp;<span class="op" id="2226203">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226206">case</span>&nbsp;<span class="ident" id="2226211">IsNaN</span><span class="op" id="2226216">(</span><span class="ident" id="2226217">x</span><span class="op" id="2226218">)</span><span class="op" id="2226219">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226223">return</span>&nbsp;<span class="ident" id="2226230">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226233">case</span>&nbsp;<span class="ident" id="2226238">IsInf</span><span class="op" id="2226243">(</span><span class="ident" id="2226244">x</span><span class="op" id="2226245">,</span>&nbsp;<span class="num" id="2226247">0</span><span class="op" id="2226248">)</span><span class="op" id="2226249">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226253">return</span>&nbsp;<span class="num" id="2226260">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2226263">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2226266">//&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x),&nbsp;J(n,&nbsp;-x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2226329">//&nbsp;Thus,&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;J(n,&nbsp;-x)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226360">if</span>&nbsp;<span class="ident" id="2226363">n</span>&nbsp;<span class="op" id="2226365">==</span>&nbsp;<span class="num" id="2226368">0</span>&nbsp;<span class="op" id="2226370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226374">return</span>&nbsp;<span class="ident" id="2226381">J0</span><span class="op" id="2226383">(</span><span class="ident" id="2226384">x</span><span class="op" id="2226385">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2226388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226391">if</span>&nbsp;<span class="ident" id="2226394">x</span>&nbsp;<span class="op" id="2226396">==</span>&nbsp;<span class="num" id="2226399">0</span>&nbsp;<span class="op" id="2226401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226405">return</span>&nbsp;<span class="num" id="2226412">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2226415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226418">if</span>&nbsp;<span class="ident" id="2226421">n</span>&nbsp;<span class="op" id="2226423">&lt;</span>&nbsp;<span class="num" id="2226425">0</span>&nbsp;<span class="op" id="2226427">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226431">n</span><span class="op" id="2226432">,</span>&nbsp;<span class="ident" id="2226434">x</span>&nbsp;<span class="op" id="2226436">=</span>&nbsp;<span class="op" id="2226438">-</span><span class="ident" id="2226439">n</span><span class="op" id="2226440">,</span>&nbsp;<span class="op" id="2226442">-</span><span class="ident" id="2226443">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2226446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226449">if</span>&nbsp;<span class="ident" id="2226452">n</span>&nbsp;<span class="op" id="2226454">==</span>&nbsp;<span class="num" id="2226457">1</span>&nbsp;<span class="op" id="2226459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226463">return</span>&nbsp;<span class="ident" id="2226470">J1</span><span class="op" id="2226472">(</span><span class="ident" id="2226473">x</span><span class="op" id="2226474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2226477">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226480">sign</span>&nbsp;<span class="op" id="2226485">:=</span>&nbsp;<span class="builtintype" id="2226488">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226495">if</span>&nbsp;<span class="ident" id="2226498">x</span>&nbsp;<span class="op" id="2226500">&lt;</span>&nbsp;<span class="num" id="2226502">0</span>&nbsp;<span class="op" id="2226504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226508">x</span>&nbsp;<span class="op" id="2226510">=</span>&nbsp;<span class="op" id="2226512">-</span><span class="ident" id="2226513">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226517">if</span>&nbsp;<span class="ident" id="2226520">n</span><span class="op" id="2226521">&amp;</span><span class="num" id="2226522">1</span>&nbsp;<span class="op" id="2226524">==</span>&nbsp;<span class="num" id="2226527">1</span>&nbsp;<span class="op" id="2226529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226534">sign</span>&nbsp;<span class="op" id="2226539">=</span>&nbsp;<span class="builtintype" id="2226541">true</span>&nbsp;<span class="comment" id="2226546">//&nbsp;odd&nbsp;n&nbsp;and&nbsp;negative&nbsp;x</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2226572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2226575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226578">var</span>&nbsp;<span class="ident" id="2226582">b</span>&nbsp;<span class="builtintype" id="2226584">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226593">if</span>&nbsp;<span class="builtintype" id="2226596">float64</span><span class="op" id="2226603">(</span><span class="ident" id="2226604">n</span><span class="op" id="2226605">)</span>&nbsp;<span class="op" id="2226607">&lt;=</span>&nbsp;<span class="ident" id="2226610">x</span>&nbsp;<span class="op" id="2226612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2226616">//&nbsp;Safe&nbsp;to&nbsp;use&nbsp;J(n+1,x)=2n/x&nbsp;*J(n,x)-J(n-1,x)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226664">if</span>&nbsp;<span class="ident" id="2226667">x</span>&nbsp;<span class="op" id="2226669">&gt;=</span>&nbsp;<span class="ident" id="2226672">Two302</span>&nbsp;<span class="op" id="2226679">{</span>&nbsp;<span class="comment" id="2226681">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2226699">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2226717">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2226772">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2226827">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2226866">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2226923">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2226929">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2226985">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2227039">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2227087">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2227135">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2227183">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227232">var</span>&nbsp;<span class="ident" id="2227236">temp</span>&nbsp;<span class="builtintype" id="2227241">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227252">switch</span>&nbsp;<span class="ident" id="2227259">n</span>&nbsp;<span class="op" id="2227261">&amp;</span>&nbsp;<span class="num" id="2227263">3</span>&nbsp;<span class="op" id="2227265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227270">case</span>&nbsp;<span class="num" id="2227275">0</span><span class="op" id="2227276">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227282">temp</span>&nbsp;<span class="op" id="2227287">=</span>&nbsp;<span class="ident" id="2227289">Cos</span><span class="op" id="2227292">(</span><span class="ident" id="2227293">x</span><span class="op" id="2227294">)</span>&nbsp;<span class="op" id="2227296">+</span>&nbsp;<span class="ident" id="2227298">Sin</span><span class="op" id="2227301">(</span><span class="ident" id="2227302">x</span><span class="op" id="2227303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227308">case</span>&nbsp;<span class="num" id="2227313">1</span><span class="op" id="2227314">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227320">temp</span>&nbsp;<span class="op" id="2227325">=</span>&nbsp;<span class="op" id="2227327">-</span><span class="ident" id="2227328">Cos</span><span class="op" id="2227331">(</span><span class="ident" id="2227332">x</span><span class="op" id="2227333">)</span>&nbsp;<span class="op" id="2227335">+</span>&nbsp;<span class="ident" id="2227337">Sin</span><span class="op" id="2227340">(</span><span class="ident" id="2227341">x</span><span class="op" id="2227342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227347">case</span>&nbsp;<span class="num" id="2227352">2</span><span class="op" id="2227353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227359">temp</span>&nbsp;<span class="op" id="2227364">=</span>&nbsp;<span class="op" id="2227366">-</span><span class="ident" id="2227367">Cos</span><span class="op" id="2227370">(</span><span class="ident" id="2227371">x</span><span class="op" id="2227372">)</span>&nbsp;<span class="op" id="2227374">-</span>&nbsp;<span class="ident" id="2227376">Sin</span><span class="op" id="2227379">(</span><span class="ident" id="2227380">x</span><span class="op" id="2227381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227386">case</span>&nbsp;<span class="num" id="2227391">3</span><span class="op" id="2227392">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227398">temp</span>&nbsp;<span class="op" id="2227403">=</span>&nbsp;<span class="ident" id="2227405">Cos</span><span class="op" id="2227408">(</span><span class="ident" id="2227409">x</span><span class="op" id="2227410">)</span>&nbsp;<span class="op" id="2227412">-</span>&nbsp;<span class="ident" id="2227414">Sin</span><span class="op" id="2227417">(</span><span class="ident" id="2227418">x</span><span class="op" id="2227419">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2227424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227429">b</span>&nbsp;<span class="op" id="2227431">=</span>&nbsp;<span class="op" id="2227433">(</span><span class="num" id="2227434">1</span>&nbsp;<span class="op" id="2227436">/</span>&nbsp;<span class="ident" id="2227438">SqrtPi</span><span class="op" id="2227444">)</span>&nbsp;<span class="op" id="2227446">*</span>&nbsp;<span class="ident" id="2227448">temp</span>&nbsp;<span class="op" id="2227453">/</span>&nbsp;<span class="ident" id="2227455">Sqrt</span><span class="op" id="2227459">(</span><span class="ident" id="2227460">x</span><span class="op" id="2227461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2227465">}</span>&nbsp;<span class="keyword" id="2227467">else</span>&nbsp;<span class="op" id="2227472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227477">b</span>&nbsp;<span class="op" id="2227479">=</span>&nbsp;<span class="ident" id="2227481">J1</span><span class="op" id="2227483">(</span><span class="ident" id="2227484">x</span><span class="op" id="2227485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227490">for</span>&nbsp;<span class="ident" id="2227494">i</span><span class="op" id="2227495">,</span>&nbsp;<span class="ident" id="2227497">a</span>&nbsp;<span class="op" id="2227499">:=</span>&nbsp;<span class="num" id="2227502">1</span><span class="op" id="2227503">,</span>&nbsp;<span class="ident" id="2227505">J0</span><span class="op" id="2227507">(</span><span class="ident" id="2227508">x</span><span class="op" id="2227509">)</span><span class="op" id="2227510">;</span>&nbsp;<span class="ident" id="2227512">i</span>&nbsp;<span class="op" id="2227514">&lt;</span>&nbsp;<span class="ident" id="2227516">n</span><span class="op" id="2227517">;</span>&nbsp;<span class="ident" id="2227519">i</span><span class="op" id="2227520">++</span>&nbsp;<span class="op" id="2227523">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227529">a</span><span class="op" id="2227530">,</span>&nbsp;<span class="ident" id="2227532">b</span>&nbsp;<span class="op" id="2227534">=</span>&nbsp;<span class="ident" id="2227536">b</span><span class="op" id="2227537">,</span>&nbsp;<span class="ident" id="2227539">b</span><span class="op" id="2227540">*</span><span class="op" id="2227541">(</span><span class="builtintype" id="2227542">float64</span><span class="op" id="2227549">(</span><span class="ident" id="2227550">i</span><span class="op" id="2227551">+</span><span class="ident" id="2227552">i</span><span class="op" id="2227553">)</span><span class="op" id="2227554">/</span><span class="ident" id="2227555">x</span><span class="op" id="2227556">)</span><span class="op" id="2227557">-</span><span class="ident" id="2227558">a</span>&nbsp;<span class="comment" id="2227560">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2227582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2227586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2227589">}</span>&nbsp;<span class="keyword" id="2227591">else</span>&nbsp;<span class="op" id="2227596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227600">if</span>&nbsp;<span class="ident" id="2227603">x</span>&nbsp;<span class="op" id="2227605">&lt;</span>&nbsp;<span class="ident" id="2227607">TwoM29</span>&nbsp;<span class="op" id="2227614">{</span>&nbsp;<span class="comment" id="2227616">//&nbsp;x&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2227633">//&nbsp;x&nbsp;is&nbsp;tiny,&nbsp;return&nbsp;the&nbsp;first&nbsp;Taylor&nbsp;expansion&nbsp;of&nbsp;J(n,x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2227694">//&nbsp;J(n,x)&nbsp;=&nbsp;1/n!*(x/2)**n&nbsp;&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227731">if</span>&nbsp;<span class="ident" id="2227734">n</span>&nbsp;<span class="op" id="2227736">&gt;</span>&nbsp;<span class="num" id="2227738">33</span>&nbsp;<span class="op" id="2227741">{</span>&nbsp;<span class="comment" id="2227743">//&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227760">b</span>&nbsp;<span class="op" id="2227762">=</span>&nbsp;<span class="num" id="2227764">0</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2227769">}</span>&nbsp;<span class="keyword" id="2227771">else</span>&nbsp;<span class="op" id="2227776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227782">temp</span>&nbsp;<span class="op" id="2227787">:=</span>&nbsp;<span class="ident" id="2227790">x</span>&nbsp;<span class="op" id="2227792">*</span>&nbsp;<span class="num" id="2227794">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227802">b</span>&nbsp;<span class="op" id="2227804">=</span>&nbsp;<span class="ident" id="2227806">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227815">a</span>&nbsp;<span class="op" id="2227817">:=</span>&nbsp;<span class="num" id="2227820">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227828">for</span>&nbsp;<span class="ident" id="2227832">i</span>&nbsp;<span class="op" id="2227834">:=</span>&nbsp;<span class="num" id="2227837">2</span><span class="op" id="2227838">;</span>&nbsp;<span class="ident" id="2227840">i</span>&nbsp;<span class="op" id="2227842">&lt;=</span>&nbsp;<span class="ident" id="2227845">n</span><span class="op" id="2227846">;</span>&nbsp;<span class="ident" id="2227848">i</span><span class="op" id="2227849">++</span>&nbsp;<span class="op" id="2227852">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227859">a</span>&nbsp;<span class="op" id="2227861">*=</span>&nbsp;<span class="builtintype" id="2227864">float64</span><span class="op" id="2227871">(</span><span class="ident" id="2227872">i</span><span class="op" id="2227873">)</span>&nbsp;<span class="comment" id="2227875">//&nbsp;a&nbsp;=&nbsp;n!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227890">b</span>&nbsp;<span class="op" id="2227892">*=</span>&nbsp;<span class="ident" id="2227895">temp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2227906">//&nbsp;b&nbsp;=&nbsp;(x/2)**n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2227926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227932">b</span>&nbsp;<span class="op" id="2227934">/=</span>&nbsp;<span class="ident" id="2227937">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2227942">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2227946">}</span>&nbsp;<span class="keyword" id="2227948">else</span>&nbsp;<span class="op" id="2227953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2227958">//&nbsp;use&nbsp;backward&nbsp;recurrence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2227988">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228037">//&nbsp;&nbsp;J(n,x)/J(n-1,x)&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228094">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;-&nbsp;2(n+1)&nbsp;-&nbsp;2(n+2)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228143">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228149">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228194">//&nbsp;&nbsp;(for&nbsp;large&nbsp;x)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228250">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;&nbsp;2(n+1)&nbsp;&nbsp;&nbsp;2(n+2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228298">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;-&nbsp;------&nbsp;-&nbsp;------&nbsp;-</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228348">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228394">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228400">//&nbsp;Let&nbsp;w&nbsp;=&nbsp;2n/x&nbsp;and&nbsp;h=2/x,&nbsp;then&nbsp;the&nbsp;above&nbsp;quotient</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228454">//&nbsp;is&nbsp;equal&nbsp;to&nbsp;the&nbsp;continued&nbsp;fraction:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228496">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228521">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;-----------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228558">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228586">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;-&nbsp;-----------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228622">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228653">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+h&nbsp;-&nbsp;---------</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228688">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+2h&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228725">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228731">//&nbsp;To&nbsp;determine&nbsp;how&nbsp;many&nbsp;terms&nbsp;needed,&nbsp;let</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228777">//&nbsp;Q(0)&nbsp;=&nbsp;w,&nbsp;Q(1)&nbsp;=&nbsp;w(w+h)&nbsp;-&nbsp;1,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228812">//&nbsp;Q(k)&nbsp;=&nbsp;(w+k*h)*Q(k-1)&nbsp;-&nbsp;Q(k-2),</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228850">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e4&nbsp;&nbsp;&nbsp;&nbsp;good&nbsp;for&nbsp;single</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228888">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e9&nbsp;&nbsp;&nbsp;&nbsp;good&nbsp;for&nbsp;double</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228926">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e17&nbsp;&nbsp;&nbsp;&nbsp;good&nbsp;for&nbsp;quadruple</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228969">//&nbsp;determine&nbsp;k</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2228987">w</span>&nbsp;<span class="op" id="2228989">:=</span>&nbsp;<span class="builtintype" id="2228992">float64</span><span class="op" id="2228999">(</span><span class="ident" id="2229000">n</span><span class="op" id="2229001">+</span><span class="ident" id="2229002">n</span><span class="op" id="2229003">)</span>&nbsp;<span class="op" id="2229005">/</span>&nbsp;<span class="ident" id="2229007">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229012">h</span>&nbsp;<span class="op" id="2229014">:=</span>&nbsp;<span class="num" id="2229017">2</span>&nbsp;<span class="op" id="2229019">/</span>&nbsp;<span class="ident" id="2229021">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229026">q0</span>&nbsp;<span class="op" id="2229029">:=</span>&nbsp;<span class="ident" id="2229032">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229037">z</span>&nbsp;<span class="op" id="2229039">:=</span>&nbsp;<span class="ident" id="2229042">w</span>&nbsp;<span class="op" id="2229044">+</span>&nbsp;<span class="ident" id="2229046">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229051">q1</span>&nbsp;<span class="op" id="2229054">:=</span>&nbsp;<span class="ident" id="2229057">w</span><span class="op" id="2229058">*</span><span class="ident" id="2229059">z</span>&nbsp;<span class="op" id="2229061">-</span>&nbsp;<span class="num" id="2229063">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229068">k</span>&nbsp;<span class="op" id="2229070">:=</span>&nbsp;<span class="num" id="2229073">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229078">for</span>&nbsp;<span class="ident" id="2229082">q1</span>&nbsp;<span class="op" id="2229085">&lt;</span>&nbsp;<span class="num" id="2229087">1e9</span>&nbsp;<span class="op" id="2229091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229097">k</span>&nbsp;<span class="op" id="2229099">+=</span>&nbsp;<span class="num" id="2229102">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229108">z</span>&nbsp;<span class="op" id="2229110">+=</span>&nbsp;<span class="ident" id="2229113">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229119">q0</span><span class="op" id="2229121">,</span>&nbsp;<span class="ident" id="2229123">q1</span>&nbsp;<span class="op" id="2229126">=</span>&nbsp;<span class="ident" id="2229128">q1</span><span class="op" id="2229130">,</span>&nbsp;<span class="ident" id="2229132">z</span><span class="op" id="2229133">*</span><span class="ident" id="2229134">q1</span><span class="op" id="2229136">-</span><span class="ident" id="2229137">q0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229148">m</span>&nbsp;<span class="op" id="2229150">:=</span>&nbsp;<span class="ident" id="2229153">n</span>&nbsp;<span class="op" id="2229155">+</span>&nbsp;<span class="ident" id="2229157">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229162">t</span>&nbsp;<span class="op" id="2229164">:=</span>&nbsp;<span class="num" id="2229167">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229174">for</span>&nbsp;<span class="ident" id="2229178">i</span>&nbsp;<span class="op" id="2229180">:=</span>&nbsp;<span class="num" id="2229183">2</span>&nbsp;<span class="op" id="2229185">*</span>&nbsp;<span class="op" id="2229187">(</span><span class="ident" id="2229188">n</span>&nbsp;<span class="op" id="2229190">+</span>&nbsp;<span class="ident" id="2229192">k</span><span class="op" id="2229193">)</span><span class="op" id="2229194">;</span>&nbsp;<span class="ident" id="2229196">i</span>&nbsp;<span class="op" id="2229198">&gt;=</span>&nbsp;<span class="ident" id="2229201">m</span><span class="op" id="2229202">;</span>&nbsp;<span class="ident" id="2229204">i</span>&nbsp;<span class="op" id="2229206">-=</span>&nbsp;<span class="num" id="2229209">2</span>&nbsp;<span class="op" id="2229211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229217">t</span>&nbsp;<span class="op" id="2229219">=</span>&nbsp;<span class="num" id="2229221">1</span>&nbsp;<span class="op" id="2229223">/</span>&nbsp;<span class="op" id="2229225">(</span><span class="builtintype" id="2229226">float64</span><span class="op" id="2229233">(</span><span class="ident" id="2229234">i</span><span class="op" id="2229235">)</span><span class="op" id="2229236">/</span><span class="ident" id="2229237">x</span>&nbsp;<span class="op" id="2229239">-</span>&nbsp;<span class="ident" id="2229241">t</span><span class="op" id="2229242">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229252">a</span>&nbsp;<span class="op" id="2229254">:=</span>&nbsp;<span class="ident" id="2229257">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229262">b</span>&nbsp;<span class="op" id="2229264">=</span>&nbsp;<span class="num" id="2229266">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2229271">//&nbsp;&nbsp;estimate&nbsp;log((2/x)**n*n!)&nbsp;=&nbsp;n*log(2/x)+n*ln(n)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2229325">//&nbsp;&nbsp;Hence,&nbsp;if&nbsp;n*(log(2n/x))&nbsp;&gt;&nbsp;...</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2229362">//&nbsp;&nbsp;single&nbsp;8.8722839355e+01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2229393">//&nbsp;&nbsp;double&nbsp;7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2229434">//&nbsp;&nbsp;long&nbsp;double&nbsp;1.1356523406294143949491931077970765006170e+04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2229500">//&nbsp;&nbsp;then&nbsp;recurrent&nbsp;value&nbsp;may&nbsp;overflow&nbsp;and&nbsp;the&nbsp;result&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2229559">//&nbsp;&nbsp;likely&nbsp;underflow&nbsp;to&nbsp;zero</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229592">tmp</span>&nbsp;<span class="op" id="2229596">:=</span>&nbsp;<span class="builtintype" id="2229599">float64</span><span class="op" id="2229606">(</span><span class="ident" id="2229607">n</span><span class="op" id="2229608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229613">v</span>&nbsp;<span class="op" id="2229615">:=</span>&nbsp;<span class="num" id="2229618">2</span>&nbsp;<span class="op" id="2229620">/</span>&nbsp;<span class="ident" id="2229622">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229627">tmp</span>&nbsp;<span class="op" id="2229631">=</span>&nbsp;<span class="ident" id="2229633">tmp</span>&nbsp;<span class="op" id="2229637">*</span>&nbsp;<span class="ident" id="2229639">Log</span><span class="op" id="2229642">(</span><span class="ident" id="2229643">Abs</span><span class="op" id="2229646">(</span><span class="ident" id="2229647">v</span><span class="op" id="2229648">*</span><span class="ident" id="2229649">tmp</span><span class="op" id="2229652">)</span><span class="op" id="2229653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229658">if</span>&nbsp;<span class="ident" id="2229661">tmp</span>&nbsp;<span class="op" id="2229665">&lt;</span>&nbsp;<span class="num" id="2229667">7.09782712893383973096e+02</span>&nbsp;<span class="op" id="2229694">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229700">for</span>&nbsp;<span class="ident" id="2229704">i</span>&nbsp;<span class="op" id="2229706">:=</span>&nbsp;<span class="ident" id="2229709">n</span>&nbsp;<span class="op" id="2229711">-</span>&nbsp;<span class="num" id="2229713">1</span><span class="op" id="2229714">;</span>&nbsp;<span class="ident" id="2229716">i</span>&nbsp;<span class="op" id="2229718">&gt;</span>&nbsp;<span class="num" id="2229720">0</span><span class="op" id="2229721">;</span>&nbsp;<span class="ident" id="2229723">i</span><span class="op" id="2229724">--</span>&nbsp;<span class="op" id="2229727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229734">di</span>&nbsp;<span class="op" id="2229737">:=</span>&nbsp;<span class="builtintype" id="2229740">float64</span><span class="op" id="2229747">(</span><span class="ident" id="2229748">i</span>&nbsp;<span class="op" id="2229750">+</span>&nbsp;<span class="ident" id="2229752">i</span><span class="op" id="2229753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229760">a</span><span class="op" id="2229761">,</span>&nbsp;<span class="ident" id="2229763">b</span>&nbsp;<span class="op" id="2229765">=</span>&nbsp;<span class="ident" id="2229767">b</span><span class="op" id="2229768">,</span>&nbsp;<span class="ident" id="2229770">b</span><span class="op" id="2229771">*</span><span class="ident" id="2229772">di</span><span class="op" id="2229774">/</span><span class="ident" id="2229775">x</span><span class="op" id="2229776">-</span><span class="ident" id="2229777">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229784">di</span>&nbsp;<span class="op" id="2229787">-=</span>&nbsp;<span class="num" id="2229790">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229796">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229801">}</span>&nbsp;<span class="keyword" id="2229803">else</span>&nbsp;<span class="op" id="2229808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229814">for</span>&nbsp;<span class="ident" id="2229818">i</span>&nbsp;<span class="op" id="2229820">:=</span>&nbsp;<span class="ident" id="2229823">n</span>&nbsp;<span class="op" id="2229825">-</span>&nbsp;<span class="num" id="2229827">1</span><span class="op" id="2229828">;</span>&nbsp;<span class="ident" id="2229830">i</span>&nbsp;<span class="op" id="2229832">&gt;</span>&nbsp;<span class="num" id="2229834">0</span><span class="op" id="2229835">;</span>&nbsp;<span class="ident" id="2229837">i</span><span class="op" id="2229838">--</span>&nbsp;<span class="op" id="2229841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229848">di</span>&nbsp;<span class="op" id="2229851">:=</span>&nbsp;<span class="builtintype" id="2229854">float64</span><span class="op" id="2229861">(</span><span class="ident" id="2229862">i</span>&nbsp;<span class="op" id="2229864">+</span>&nbsp;<span class="ident" id="2229866">i</span><span class="op" id="2229867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229874">a</span><span class="op" id="2229875">,</span>&nbsp;<span class="ident" id="2229877">b</span>&nbsp;<span class="op" id="2229879">=</span>&nbsp;<span class="ident" id="2229881">b</span><span class="op" id="2229882">,</span>&nbsp;<span class="ident" id="2229884">b</span><span class="op" id="2229885">*</span><span class="ident" id="2229886">di</span><span class="op" id="2229888">/</span><span class="ident" id="2229889">x</span><span class="op" id="2229890">-</span><span class="ident" id="2229891">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229898">di</span>&nbsp;<span class="op" id="2229901">-=</span>&nbsp;<span class="num" id="2229904">2</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2229911">//&nbsp;scale&nbsp;b&nbsp;to&nbsp;avoid&nbsp;spurious&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229954">if</span>&nbsp;<span class="ident" id="2229957">b</span>&nbsp;<span class="op" id="2229959">&gt;</span>&nbsp;<span class="num" id="2229961">1e100</span>&nbsp;<span class="op" id="2229967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229975">a</span>&nbsp;<span class="op" id="2229977">/=</span>&nbsp;<span class="ident" id="2229980">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229988">t</span>&nbsp;<span class="op" id="2229990">/=</span>&nbsp;<span class="ident" id="2229993">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230001">b</span>&nbsp;<span class="op" id="2230003">=</span>&nbsp;<span class="num" id="2230005">1</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230028">b</span>&nbsp;<span class="op" id="2230030">=</span>&nbsp;<span class="ident" id="2230032">t</span>&nbsp;<span class="op" id="2230034">*</span>&nbsp;<span class="ident" id="2230036">J0</span><span class="op" id="2230038">(</span><span class="ident" id="2230039">x</span><span class="op" id="2230040">)</span>&nbsp;<span class="op" id="2230042">/</span>&nbsp;<span class="ident" id="2230044">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230048">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230054">if</span>&nbsp;<span class="ident" id="2230057">sign</span>&nbsp;<span class="op" id="2230062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230066">return</span>&nbsp;<span class="op" id="2230073">-</span><span class="ident" id="2230074">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230080">return</span>&nbsp;<span class="ident" id="2230087">b</span><br>
<span class="lineno">225</span><span class="op" id="2230089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2230092">//&nbsp;Yn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;second&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2230154">//</span><br>
<span class="lineno"></span><span class="comment" id="2230157">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">230</span><span class="comment" id="2230179">//&nbsp;&nbsp;&nbsp;&nbsp;Yn(n,&nbsp;+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2230198">//&nbsp;&nbsp;&nbsp;&nbsp;Yn(n&nbsp;&gt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2230221">//&nbsp;&nbsp;&nbsp;&nbsp;Yn(n&nbsp;&lt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;+Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;odd,&nbsp;-Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="2230275">//&nbsp;&nbsp;&nbsp;&nbsp;Y1(n,&nbsp;x&nbsp;&lt;&nbsp;0)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2230297">//&nbsp;&nbsp;&nbsp;&nbsp;Y1(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">235</span><span class="keyword" id="2230317">func</span>&nbsp;<span class="ident" id="2230322">Yn</span><span class="op" id="2230324">(</span><span class="ident" id="2230325">n</span>&nbsp;<span class="builtintype" id="2230327">int</span><span class="op" id="2230330">,</span>&nbsp;<span class="ident" id="2230332">x</span>&nbsp;<span class="builtintype" id="2230334">float64</span><span class="op" id="2230341">)</span>&nbsp;<span class="builtintype" id="2230343">float64</span>&nbsp;<span class="op" id="2230351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230354">const</span>&nbsp;<span class="ident" id="2230360">Two302</span>&nbsp;<span class="op" id="2230367">=</span>&nbsp;<span class="num" id="2230369">1</span>&nbsp;<span class="op" id="2230371">&lt;&lt;</span>&nbsp;<span class="num" id="2230374">302</span>&nbsp;<span class="comment" id="2230378">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2230408">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230426">switch</span>&nbsp;<span class="op" id="2230433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230436">case</span>&nbsp;<span class="ident" id="2230441">x</span>&nbsp;<span class="op" id="2230443">&lt;</span>&nbsp;<span class="num" id="2230445">0</span>&nbsp;<span class="op" id="2230447">||</span>&nbsp;<span class="ident" id="2230450">IsNaN</span><span class="op" id="2230455">(</span><span class="ident" id="2230456">x</span><span class="op" id="2230457">)</span><span class="op" id="2230458">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230462">return</span>&nbsp;<span class="ident" id="2230469">NaN</span><span class="op" id="2230472">(</span><span class="op" id="2230473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230476">case</span>&nbsp;<span class="ident" id="2230481">IsInf</span><span class="op" id="2230486">(</span><span class="ident" id="2230487">x</span><span class="op" id="2230488">,</span>&nbsp;<span class="num" id="2230490">1</span><span class="op" id="2230491">)</span><span class="op" id="2230492">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230496">return</span>&nbsp;<span class="num" id="2230503">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230510">if</span>&nbsp;<span class="ident" id="2230513">n</span>&nbsp;<span class="op" id="2230515">==</span>&nbsp;<span class="num" id="2230518">0</span>&nbsp;<span class="op" id="2230520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230524">return</span>&nbsp;<span class="ident" id="2230531">Y0</span><span class="op" id="2230533">(</span><span class="ident" id="2230534">x</span><span class="op" id="2230535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230541">if</span>&nbsp;<span class="ident" id="2230544">x</span>&nbsp;<span class="op" id="2230546">==</span>&nbsp;<span class="num" id="2230549">0</span>&nbsp;<span class="op" id="2230551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230555">if</span>&nbsp;<span class="ident" id="2230558">n</span>&nbsp;<span class="op" id="2230560">&lt;</span>&nbsp;<span class="num" id="2230562">0</span>&nbsp;<span class="op" id="2230564">&amp;&amp;</span>&nbsp;<span class="ident" id="2230567">n</span><span class="op" id="2230568">&amp;</span><span class="num" id="2230569">1</span>&nbsp;<span class="op" id="2230571">==</span>&nbsp;<span class="num" id="2230574">1</span>&nbsp;<span class="op" id="2230576">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230581">return</span>&nbsp;<span class="ident" id="2230588">Inf</span><span class="op" id="2230591">(</span><span class="num" id="2230592">1</span><span class="op" id="2230593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230601">return</span>&nbsp;<span class="ident" id="2230608">Inf</span><span class="op" id="2230611">(</span><span class="op" id="2230612">-</span><span class="num" id="2230613">1</span><span class="op" id="2230614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230620">sign</span>&nbsp;<span class="op" id="2230625">:=</span>&nbsp;<span class="builtintype" id="2230628">false</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230635">if</span>&nbsp;<span class="ident" id="2230638">n</span>&nbsp;<span class="op" id="2230640">&lt;</span>&nbsp;<span class="num" id="2230642">0</span>&nbsp;<span class="op" id="2230644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230648">n</span>&nbsp;<span class="op" id="2230650">=</span>&nbsp;<span class="op" id="2230652">-</span><span class="ident" id="2230653">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230657">if</span>&nbsp;<span class="ident" id="2230660">n</span><span class="op" id="2230661">&amp;</span><span class="num" id="2230662">1</span>&nbsp;<span class="op" id="2230664">==</span>&nbsp;<span class="num" id="2230667">1</span>&nbsp;<span class="op" id="2230669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230674">sign</span>&nbsp;<span class="op" id="2230679">=</span>&nbsp;<span class="builtintype" id="2230681">true</span>&nbsp;<span class="comment" id="2230686">//&nbsp;sign&nbsp;true&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&amp;&amp;&nbsp;|n|&nbsp;odd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230721">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230727">if</span>&nbsp;<span class="ident" id="2230730">n</span>&nbsp;<span class="op" id="2230732">==</span>&nbsp;<span class="num" id="2230735">1</span>&nbsp;<span class="op" id="2230737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230741">if</span>&nbsp;<span class="ident" id="2230744">sign</span>&nbsp;<span class="op" id="2230749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230754">return</span>&nbsp;<span class="op" id="2230761">-</span><span class="ident" id="2230762">Y1</span><span class="op" id="2230764">(</span><span class="ident" id="2230765">x</span><span class="op" id="2230766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230770">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230774">return</span>&nbsp;<span class="ident" id="2230781">Y1</span><span class="op" id="2230783">(</span><span class="ident" id="2230784">x</span><span class="op" id="2230785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230791">var</span>&nbsp;<span class="ident" id="2230795">b</span>&nbsp;<span class="builtintype" id="2230797">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230806">if</span>&nbsp;<span class="ident" id="2230809">x</span>&nbsp;<span class="op" id="2230811">&gt;=</span>&nbsp;<span class="ident" id="2230814">Two302</span>&nbsp;<span class="op" id="2230821">{</span>&nbsp;<span class="comment" id="2230823">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2230839">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2230856">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2230905">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2230954">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2230987">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2231031">//</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2231036">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2231073">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2231114">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2231136">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2231159">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2231181">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231204">var</span>&nbsp;<span class="ident" id="2231208">temp</span>&nbsp;<span class="builtintype" id="2231213">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231223">switch</span>&nbsp;<span class="ident" id="2231230">n</span>&nbsp;<span class="op" id="2231232">&amp;</span>&nbsp;<span class="num" id="2231234">3</span>&nbsp;<span class="op" id="2231236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231240">case</span>&nbsp;<span class="num" id="2231245">0</span><span class="op" id="2231246">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231251">temp</span>&nbsp;<span class="op" id="2231256">=</span>&nbsp;<span class="ident" id="2231258">Sin</span><span class="op" id="2231261">(</span><span class="ident" id="2231262">x</span><span class="op" id="2231263">)</span>&nbsp;<span class="op" id="2231265">-</span>&nbsp;<span class="ident" id="2231267">Cos</span><span class="op" id="2231270">(</span><span class="ident" id="2231271">x</span><span class="op" id="2231272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231276">case</span>&nbsp;<span class="num" id="2231281">1</span><span class="op" id="2231282">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231287">temp</span>&nbsp;<span class="op" id="2231292">=</span>&nbsp;<span class="op" id="2231294">-</span><span class="ident" id="2231295">Sin</span><span class="op" id="2231298">(</span><span class="ident" id="2231299">x</span><span class="op" id="2231300">)</span>&nbsp;<span class="op" id="2231302">-</span>&nbsp;<span class="ident" id="2231304">Cos</span><span class="op" id="2231307">(</span><span class="ident" id="2231308">x</span><span class="op" id="2231309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231313">case</span>&nbsp;<span class="num" id="2231318">2</span><span class="op" id="2231319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231324">temp</span>&nbsp;<span class="op" id="2231329">=</span>&nbsp;<span class="op" id="2231331">-</span><span class="ident" id="2231332">Sin</span><span class="op" id="2231335">(</span><span class="ident" id="2231336">x</span><span class="op" id="2231337">)</span>&nbsp;<span class="op" id="2231339">+</span>&nbsp;<span class="ident" id="2231341">Cos</span><span class="op" id="2231344">(</span><span class="ident" id="2231345">x</span><span class="op" id="2231346">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231350">case</span>&nbsp;<span class="num" id="2231355">3</span><span class="op" id="2231356">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231361">temp</span>&nbsp;<span class="op" id="2231366">=</span>&nbsp;<span class="ident" id="2231368">Sin</span><span class="op" id="2231371">(</span><span class="ident" id="2231372">x</span><span class="op" id="2231373">)</span>&nbsp;<span class="op" id="2231375">+</span>&nbsp;<span class="ident" id="2231377">Cos</span><span class="op" id="2231380">(</span><span class="ident" id="2231381">x</span><span class="op" id="2231382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2231386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231390">b</span>&nbsp;<span class="op" id="2231392">=</span>&nbsp;<span class="op" id="2231394">(</span><span class="num" id="2231395">1</span>&nbsp;<span class="op" id="2231397">/</span>&nbsp;<span class="ident" id="2231399">SqrtPi</span><span class="op" id="2231405">)</span>&nbsp;<span class="op" id="2231407">*</span>&nbsp;<span class="ident" id="2231409">temp</span>&nbsp;<span class="op" id="2231414">/</span>&nbsp;<span class="ident" id="2231416">Sqrt</span><span class="op" id="2231420">(</span><span class="ident" id="2231421">x</span><span class="op" id="2231422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2231425">}</span>&nbsp;<span class="keyword" id="2231427">else</span>&nbsp;<span class="op" id="2231432">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231436">a</span>&nbsp;<span class="op" id="2231438">:=</span>&nbsp;<span class="ident" id="2231441">Y0</span><span class="op" id="2231443">(</span><span class="ident" id="2231444">x</span><span class="op" id="2231445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231449">b</span>&nbsp;<span class="op" id="2231451">=</span>&nbsp;<span class="ident" id="2231453">Y1</span><span class="op" id="2231455">(</span><span class="ident" id="2231456">x</span><span class="op" id="2231457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2231461">//&nbsp;quit&nbsp;if&nbsp;b&nbsp;is&nbsp;-inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231484">for</span>&nbsp;<span class="ident" id="2231488">i</span>&nbsp;<span class="op" id="2231490">:=</span>&nbsp;<span class="num" id="2231493">1</span><span class="op" id="2231494">;</span>&nbsp;<span class="ident" id="2231496">i</span>&nbsp;<span class="op" id="2231498">&lt;</span>&nbsp;<span class="ident" id="2231500">n</span>&nbsp;<span class="op" id="2231502">&amp;&amp;</span>&nbsp;<span class="op" id="2231505">!</span><span class="ident" id="2231506">IsInf</span><span class="op" id="2231511">(</span><span class="ident" id="2231512">b</span><span class="op" id="2231513">,</span>&nbsp;<span class="op" id="2231515">-</span><span class="num" id="2231516">1</span><span class="op" id="2231517">)</span><span class="op" id="2231518">;</span>&nbsp;<span class="ident" id="2231520">i</span><span class="op" id="2231521">++</span>&nbsp;<span class="op" id="2231524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231529">a</span><span class="op" id="2231530">,</span>&nbsp;<span class="ident" id="2231532">b</span>&nbsp;<span class="op" id="2231534">=</span>&nbsp;<span class="ident" id="2231536">b</span><span class="op" id="2231537">,</span>&nbsp;<span class="op" id="2231539">(</span><span class="builtintype" id="2231540">float64</span><span class="op" id="2231547">(</span><span class="ident" id="2231548">i</span><span class="op" id="2231549">+</span><span class="ident" id="2231550">i</span><span class="op" id="2231551">)</span><span class="op" id="2231552">/</span><span class="ident" id="2231553">x</span><span class="op" id="2231554">)</span><span class="op" id="2231555">*</span><span class="ident" id="2231556">b</span><span class="op" id="2231557">-</span><span class="ident" id="2231558">a</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2231562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2231565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231568">if</span>&nbsp;<span class="ident" id="2231571">sign</span>&nbsp;<span class="op" id="2231576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231580">return</span>&nbsp;<span class="op" id="2231587">-</span><span class="ident" id="2231588">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2231591">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231594">return</span>&nbsp;<span class="ident" id="2231601">b</span><br>
<span class="lineno"></span><span class="op" id="2231603">}</span>
</div>
</body>
</html>
