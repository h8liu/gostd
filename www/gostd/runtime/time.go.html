<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1746536">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1746591">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1746645">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1746696">//&nbsp;Time-related&nbsp;runtime&nbsp;and&nbsp;pieces&nbsp;of&nbsp;package&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1746749">package</span>&nbsp;<span class="ident" id="1746757">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1746766">import</span>&nbsp;<span class="string" id="1746773">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1746783">//&nbsp;Package&nbsp;time&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1746835">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../time/sleep.go:/runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="1746901">//&nbsp;For&nbsp;GOOS=nacl,&nbsp;package&nbsp;syscall&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1746971">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../syscall/net_nacl.go:/runtimeTimer.</span><br>
<span class="lineno">15</span><span class="keyword" id="1747043">type</span>&nbsp;<span class="ident" id="1747048">timer</span>&nbsp;<span class="keyword" id="1747054">struct</span>&nbsp;<span class="op" id="1747061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747064">i</span>&nbsp;<span class="builtintype" id="1747066">int</span>&nbsp;<span class="comment" id="1747070">//&nbsp;heap&nbsp;index</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1747086">//&nbsp;Timer&nbsp;wakes&nbsp;up&nbsp;at&nbsp;when,&nbsp;and&nbsp;then&nbsp;at&nbsp;when+period,&nbsp;...&nbsp;(period&nbsp;&gt;&nbsp;0&nbsp;only)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1747161">//&nbsp;each&nbsp;time&nbsp;calling&nbsp;f(now,&nbsp;arg)&nbsp;in&nbsp;the&nbsp;timer&nbsp;goroutine,&nbsp;so&nbsp;f&nbsp;must&nbsp;be</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1747232">//&nbsp;a&nbsp;well-behaved&nbsp;function&nbsp;and&nbsp;not&nbsp;block.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747275">when</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1747282">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747289">period</span>&nbsp;<span class="ident" id="1747296">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747303">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1747310">func</span><span class="op" id="1747314">(</span><span class="keyword" id="1747315">interface</span><span class="op" id="1747324">{</span><span class="op" id="1747325">}</span><span class="op" id="1747326">,</span>&nbsp;<span class="builtintype" id="1747328">uintptr</span><span class="op" id="1747335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747338">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1747345">interface</span><span class="op" id="1747354">{</span><span class="op" id="1747355">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747358">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1747365">uintptr</span><br>
<span class="lineno"></span><span class="op" id="1747373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1747376">var</span>&nbsp;<span class="ident" id="1747380">timers</span>&nbsp;<span class="keyword" id="1747387">struct</span>&nbsp;<span class="op" id="1747394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747397">lock</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1747410">mutex</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747417">gp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1747430">*</span><span class="ident" id="1747431">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747434">created</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1747447">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747453">sleeping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1747466">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747472">rescheduling</span>&nbsp;<span class="builtintype" id="1747485">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747491">waitnote</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1747504">note</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747510">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1747523">[</span><span class="op" id="1747524">]</span><span class="op" id="1747525">*</span><span class="ident" id="1747526">timer</span><br>
<span class="lineno"></span><span class="op" id="1747532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1747535">//&nbsp;nacl&nbsp;fake&nbsp;time&nbsp;support&nbsp;-&nbsp;time&nbsp;in&nbsp;nanoseconds&nbsp;since&nbsp;1970</span><br>
<span class="lineno"></span><span class="keyword" id="1747594">var</span>&nbsp;<span class="ident" id="1747598">faketime</span>&nbsp;<span class="ident" id="1747607">int64</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="1747614">//&nbsp;Package&nbsp;time&nbsp;APIs.</span><br>
<span class="lineno"></span><span class="comment" id="1747636">//&nbsp;Godoc&nbsp;uses&nbsp;the&nbsp;comments&nbsp;in&nbsp;package&nbsp;time,&nbsp;not&nbsp;these.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1747692">//&nbsp;time.now&nbsp;is&nbsp;implemented&nbsp;in&nbsp;assembly.</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="1747733">//&nbsp;Sleep&nbsp;puts&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;to&nbsp;sleep&nbsp;for&nbsp;at&nbsp;least&nbsp;ns&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="1747807">func</span>&nbsp;<span class="ident" id="1747812">timeSleep</span><span class="op" id="1747821">(</span><span class="ident" id="1747822">ns</span>&nbsp;<span class="ident" id="1747825">int64</span><span class="op" id="1747830">)</span>&nbsp;<span class="op" id="1747832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1747835">if</span>&nbsp;<span class="ident" id="1747838">ns</span>&nbsp;<span class="op" id="1747841">&lt;=</span>&nbsp;<span class="num" id="1747844">0</span>&nbsp;<span class="op" id="1747846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1747850">return</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1747858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747862">t</span>&nbsp;<span class="op" id="1747864">:=</span>&nbsp;<span class="builtinfunc" id="1747867">new</span><span class="op" id="1747870">(</span><span class="ident" id="1747871">timer</span><span class="op" id="1747876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747879">t</span><span class="op" id="1747880">.</span><span class="ident" id="1747881">when</span>&nbsp;<span class="op" id="1747886">=</span>&nbsp;<span class="ident" id="1747888">nanotime</span><span class="op" id="1747896">(</span><span class="op" id="1747897">)</span>&nbsp;<span class="op" id="1747899">+</span>&nbsp;<span class="ident" id="1747901">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747905">t</span><span class="op" id="1747906">.</span><span class="ident" id="1747907">f</span>&nbsp;<span class="op" id="1747909">=</span>&nbsp;<span class="ident" id="1747911">goroutineReady</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747927">t</span><span class="op" id="1747928">.</span><span class="ident" id="1747929">arg</span>&nbsp;<span class="op" id="1747933">=</span>&nbsp;<span class="ident" id="1747935">getg</span><span class="op" id="1747939">(</span><span class="op" id="1747940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747943">lock</span><span class="op" id="1747947">(</span><span class="op" id="1747948">&amp;</span><span class="ident" id="1747949">timers</span><span class="op" id="1747955">.</span><span class="ident" id="1747956">lock</span><span class="op" id="1747960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747963">addtimerLocked</span><span class="op" id="1747977">(</span><span class="ident" id="1747978">t</span><span class="op" id="1747979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1747982">goparkunlock</span><span class="op" id="1747994">(</span><span class="op" id="1747995">&amp;</span><span class="ident" id="1747996">timers</span><span class="op" id="1748002">.</span><span class="ident" id="1748003">lock</span><span class="op" id="1748007">,</span>&nbsp;<span class="string" id="1748009">&#34;sleep&#34;</span><span class="op" id="1748016">)</span><br>
<span class="lineno"></span><span class="op" id="1748018">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="1748021">//&nbsp;startTimer&nbsp;adds&nbsp;t&nbsp;to&nbsp;the&nbsp;timer&nbsp;heap.</span><br>
<span class="lineno"></span><span class="keyword" id="1748061">func</span>&nbsp;<span class="ident" id="1748066">startTimer</span><span class="op" id="1748076">(</span><span class="ident" id="1748077">t</span>&nbsp;<span class="op" id="1748079">*</span><span class="ident" id="1748080">timer</span><span class="op" id="1748085">)</span>&nbsp;<span class="op" id="1748087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1748090">if</span>&nbsp;<span class="ident" id="1748093">raceenabled</span>&nbsp;<span class="op" id="1748105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1748109">racerelease</span><span class="op" id="1748120">(</span><span class="ident" id="1748121">unsafe</span><span class="op" id="1748127">.</span><span class="ident" id="1748128">Pointer</span><span class="op" id="1748135">(</span><span class="ident" id="1748136">t</span><span class="op" id="1748137">)</span><span class="op" id="1748138">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1748141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1748144">addtimer</span><span class="op" id="1748152">(</span><span class="ident" id="1748153">t</span><span class="op" id="1748154">)</span><br>
<span class="lineno"></span><span class="op" id="1748156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1748159">//&nbsp;stopTimer&nbsp;removes&nbsp;t&nbsp;from&nbsp;the&nbsp;timer&nbsp;heap&nbsp;if&nbsp;it&nbsp;is&nbsp;there.</span><br>
<span class="lineno">70</span><span class="comment" id="1748218">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;t&nbsp;was&nbsp;removed,&nbsp;false&nbsp;if&nbsp;t&nbsp;wasn&#39;t&nbsp;even&nbsp;there.</span><br>
<span class="lineno"></span><span class="keyword" id="1748285">func</span>&nbsp;<span class="ident" id="1748290">stopTimer</span><span class="op" id="1748299">(</span><span class="ident" id="1748300">t</span>&nbsp;<span class="op" id="1748302">*</span><span class="ident" id="1748303">timer</span><span class="op" id="1748308">)</span>&nbsp;<span class="builtintype" id="1748310">bool</span>&nbsp;<span class="op" id="1748315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1748318">return</span>&nbsp;<span class="ident" id="1748325">deltimer</span><span class="op" id="1748333">(</span><span class="ident" id="1748334">t</span><span class="op" id="1748335">)</span><br>
<span class="lineno"></span><span class="op" id="1748337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="1748340">//&nbsp;Go&nbsp;runtime.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1748356">//&nbsp;Ready&nbsp;the&nbsp;goroutine&nbsp;arg.</span><br>
<span class="lineno"></span><span class="keyword" id="1748384">func</span>&nbsp;<span class="ident" id="1748389">goroutineReady</span><span class="op" id="1748403">(</span><span class="ident" id="1748404">arg</span>&nbsp;<span class="keyword" id="1748408">interface</span><span class="op" id="1748417">{</span><span class="op" id="1748418">}</span><span class="op" id="1748419">,</span>&nbsp;<span class="ident" id="1748421">seq</span>&nbsp;<span class="builtintype" id="1748425">uintptr</span><span class="op" id="1748432">)</span>&nbsp;<span class="op" id="1748434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1748437">goready</span><span class="op" id="1748444">(</span><span class="ident" id="1748445">arg</span><span class="op" id="1748448">.</span><span class="op" id="1748449">(</span><span class="op" id="1748450">*</span><span class="ident" id="1748451">g</span><span class="op" id="1748452">)</span><span class="op" id="1748453">)</span><br>
<span class="lineno">80</span><span class="op" id="1748455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1748458">func</span>&nbsp;<span class="ident" id="1748463">addtimer</span><span class="op" id="1748471">(</span><span class="ident" id="1748472">t</span>&nbsp;<span class="op" id="1748474">*</span><span class="ident" id="1748475">timer</span><span class="op" id="1748480">)</span>&nbsp;<span class="op" id="1748482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1748485">lock</span><span class="op" id="1748489">(</span><span class="op" id="1748490">&amp;</span><span class="ident" id="1748491">timers</span><span class="op" id="1748497">.</span><span class="ident" id="1748498">lock</span><span class="op" id="1748502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1748505">addtimerLocked</span><span class="op" id="1748519">(</span><span class="ident" id="1748520">t</span><span class="op" id="1748521">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1748524">unlock</span><span class="op" id="1748530">(</span><span class="op" id="1748531">&amp;</span><span class="ident" id="1748532">timers</span><span class="op" id="1748538">.</span><span class="ident" id="1748539">lock</span><span class="op" id="1748543">)</span><br>
<span class="lineno"></span><span class="op" id="1748545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1748548">//&nbsp;Add&nbsp;a&nbsp;timer&nbsp;to&nbsp;the&nbsp;heap&nbsp;and&nbsp;start&nbsp;or&nbsp;kick&nbsp;the&nbsp;timer&nbsp;proc.</span><br>
<span class="lineno"></span><span class="comment" id="1748609">//&nbsp;If&nbsp;the&nbsp;new&nbsp;timer&nbsp;is&nbsp;earlier&nbsp;than&nbsp;any&nbsp;of&nbsp;the&nbsp;others.</span><br>
<span class="lineno">90</span><span class="comment" id="1748664">//&nbsp;Timers&nbsp;are&nbsp;locked.</span><br>
<span class="lineno"></span><span class="keyword" id="1748686">func</span>&nbsp;<span class="ident" id="1748691">addtimerLocked</span><span class="op" id="1748705">(</span><span class="ident" id="1748706">t</span>&nbsp;<span class="op" id="1748708">*</span><span class="ident" id="1748709">timer</span><span class="op" id="1748714">)</span>&nbsp;<span class="op" id="1748716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1748719">//&nbsp;when&nbsp;must&nbsp;never&nbsp;be&nbsp;negative;&nbsp;otherwise&nbsp;timerproc&nbsp;will&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1748786">//&nbsp;during&nbsp;its&nbsp;delta&nbsp;calculation&nbsp;and&nbsp;never&nbsp;expire&nbsp;other&nbsp;runtime·timers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1748859">if</span>&nbsp;<span class="ident" id="1748862">t</span><span class="op" id="1748863">.</span><span class="ident" id="1748864">when</span>&nbsp;<span class="op" id="1748869">&lt;</span>&nbsp;<span class="num" id="1748871">0</span>&nbsp;<span class="op" id="1748873">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1748877">t</span><span class="op" id="1748878">.</span><span class="ident" id="1748879">when</span>&nbsp;<span class="op" id="1748884">=</span>&nbsp;<span class="num" id="1748886">1</span><span class="op" id="1748887">&lt;&lt;</span><span class="num" id="1748889">63</span>&nbsp;<span class="op" id="1748892">-</span>&nbsp;<span class="num" id="1748894">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1748897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1748900">t</span><span class="op" id="1748901">.</span><span class="ident" id="1748902">i</span>&nbsp;<span class="op" id="1748904">=</span>&nbsp;<span class="builtinfunc" id="1748906">len</span><span class="op" id="1748909">(</span><span class="ident" id="1748910">timers</span><span class="op" id="1748916">.</span><span class="ident" id="1748917">t</span><span class="op" id="1748918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1748921">timers</span><span class="op" id="1748927">.</span><span class="ident" id="1748928">t</span>&nbsp;<span class="op" id="1748930">=</span>&nbsp;<span class="builtinfunc" id="1748932">append</span><span class="op" id="1748938">(</span><span class="ident" id="1748939">timers</span><span class="op" id="1748945">.</span><span class="ident" id="1748946">t</span><span class="op" id="1748947">,</span>&nbsp;<span class="ident" id="1748949">t</span><span class="op" id="1748950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1748953">siftupTimer</span><span class="op" id="1748964">(</span><span class="ident" id="1748965">t</span><span class="op" id="1748966">.</span><span class="ident" id="1748967">i</span><span class="op" id="1748968">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1748971">if</span>&nbsp;<span class="ident" id="1748974">t</span><span class="op" id="1748975">.</span><span class="ident" id="1748976">i</span>&nbsp;<span class="op" id="1748978">==</span>&nbsp;<span class="num" id="1748981">0</span>&nbsp;<span class="op" id="1748983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1748987">//&nbsp;siftup&nbsp;moved&nbsp;to&nbsp;top:&nbsp;new&nbsp;earliest&nbsp;deadline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1749036">if</span>&nbsp;<span class="ident" id="1749039">timers</span><span class="op" id="1749045">.</span><span class="ident" id="1749046">sleeping</span>&nbsp;<span class="op" id="1749055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1749060">timers</span><span class="op" id="1749066">.</span><span class="ident" id="1749067">sleeping</span>&nbsp;<span class="op" id="1749076">=</span>&nbsp;<span class="builtintype" id="1749078">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1749087">notewakeup</span><span class="op" id="1749097">(</span><span class="op" id="1749098">&amp;</span><span class="ident" id="1749099">timers</span><span class="op" id="1749105">.</span><span class="ident" id="1749106">waitnote</span><span class="op" id="1749114">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1749118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1749122">if</span>&nbsp;<span class="ident" id="1749125">timers</span><span class="op" id="1749131">.</span><span class="ident" id="1749132">rescheduling</span>&nbsp;<span class="op" id="1749145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1749150">timers</span><span class="op" id="1749156">.</span><span class="ident" id="1749157">rescheduling</span>&nbsp;<span class="op" id="1749170">=</span>&nbsp;<span class="builtintype" id="1749172">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1749181">goready</span><span class="op" id="1749188">(</span><span class="ident" id="1749189">timers</span><span class="op" id="1749195">.</span><span class="ident" id="1749196">gp</span><span class="op" id="1749198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1749202">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1749205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1749208">if</span>&nbsp;<span class="op" id="1749211">!</span><span class="ident" id="1749212">timers</span><span class="op" id="1749218">.</span><span class="ident" id="1749219">created</span>&nbsp;<span class="op" id="1749227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1749231">timers</span><span class="op" id="1749237">.</span><span class="ident" id="1749238">created</span>&nbsp;<span class="op" id="1749246">=</span>&nbsp;<span class="builtintype" id="1749248">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1749255">go</span>&nbsp;<span class="ident" id="1749258">timerproc</span><span class="op" id="1749267">(</span><span class="op" id="1749268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1749271">}</span><br>
<span class="lineno">115</span><span class="op" id="1749273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1749276">//&nbsp;Delete&nbsp;timer&nbsp;t&nbsp;from&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span><span class="comment" id="1749309">//&nbsp;Do&nbsp;not&nbsp;need&nbsp;to&nbsp;update&nbsp;the&nbsp;timerproc:&nbsp;if&nbsp;it&nbsp;wakes&nbsp;up&nbsp;early,&nbsp;no&nbsp;big&nbsp;deal.</span><br>
<span class="lineno"></span><span class="keyword" id="1749384">func</span>&nbsp;<span class="ident" id="1749389">deltimer</span><span class="op" id="1749397">(</span><span class="ident" id="1749398">t</span>&nbsp;<span class="op" id="1749400">*</span><span class="ident" id="1749401">timer</span><span class="op" id="1749406">)</span>&nbsp;<span class="builtintype" id="1749408">bool</span>&nbsp;<span class="op" id="1749413">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1749416">//&nbsp;Dereference&nbsp;t&nbsp;so&nbsp;that&nbsp;any&nbsp;panic&nbsp;happens&nbsp;before&nbsp;the&nbsp;lock&nbsp;is&nbsp;held.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1749485">//&nbsp;Discard&nbsp;result,&nbsp;because&nbsp;t&nbsp;might&nbsp;be&nbsp;moving&nbsp;in&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1749544">_</span>&nbsp;<span class="op" id="1749546">=</span>&nbsp;<span class="ident" id="1749548">t</span><span class="op" id="1749549">.</span><span class="ident" id="1749550">i</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1749554">lock</span><span class="op" id="1749558">(</span><span class="op" id="1749559">&amp;</span><span class="ident" id="1749560">timers</span><span class="op" id="1749566">.</span><span class="ident" id="1749567">lock</span><span class="op" id="1749571">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1749574">//&nbsp;t&nbsp;may&nbsp;not&nbsp;be&nbsp;registered&nbsp;anymore&nbsp;and&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1749623">//&nbsp;a&nbsp;bogus&nbsp;i&nbsp;(typically&nbsp;0,&nbsp;if&nbsp;generated&nbsp;by&nbsp;Go).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1749672">//&nbsp;Verify&nbsp;it&nbsp;before&nbsp;proceeding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1749705">i</span>&nbsp;<span class="op" id="1749707">:=</span>&nbsp;<span class="ident" id="1749710">t</span><span class="op" id="1749711">.</span><span class="ident" id="1749712">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1749715">last</span>&nbsp;<span class="op" id="1749720">:=</span>&nbsp;<span class="builtinfunc" id="1749723">len</span><span class="op" id="1749726">(</span><span class="ident" id="1749727">timers</span><span class="op" id="1749733">.</span><span class="ident" id="1749734">t</span><span class="op" id="1749735">)</span>&nbsp;<span class="op" id="1749737">-</span>&nbsp;<span class="num" id="1749739">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1749742">if</span>&nbsp;<span class="ident" id="1749745">i</span>&nbsp;<span class="op" id="1749747">&lt;</span>&nbsp;<span class="num" id="1749749">0</span>&nbsp;<span class="op" id="1749751">||</span>&nbsp;<span class="ident" id="1749754">i</span>&nbsp;<span class="op" id="1749756">&gt;</span>&nbsp;<span class="ident" id="1749758">last</span>&nbsp;<span class="op" id="1749763">||</span>&nbsp;<span class="ident" id="1749766">timers</span><span class="op" id="1749772">.</span><span class="ident" id="1749773">t</span><span class="op" id="1749774">[</span><span class="ident" id="1749775">i</span><span class="op" id="1749776">]</span>&nbsp;<span class="op" id="1749778">!=</span>&nbsp;<span class="ident" id="1749781">t</span>&nbsp;<span class="op" id="1749783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1749787">unlock</span><span class="op" id="1749793">(</span><span class="op" id="1749794">&amp;</span><span class="ident" id="1749795">timers</span><span class="op" id="1749801">.</span><span class="ident" id="1749802">lock</span><span class="op" id="1749806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1749810">return</span>&nbsp;<span class="builtintype" id="1749817">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1749824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1749827">if</span>&nbsp;<span class="ident" id="1749830">i</span>&nbsp;<span class="op" id="1749832">!=</span>&nbsp;<span class="ident" id="1749835">last</span>&nbsp;<span class="op" id="1749840">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1749844">timers</span><span class="op" id="1749850">.</span><span class="ident" id="1749851">t</span><span class="op" id="1749852">[</span><span class="ident" id="1749853">i</span><span class="op" id="1749854">]</span>&nbsp;<span class="op" id="1749856">=</span>&nbsp;<span class="ident" id="1749858">timers</span><span class="op" id="1749864">.</span><span class="ident" id="1749865">t</span><span class="op" id="1749866">[</span><span class="ident" id="1749867">last</span><span class="op" id="1749871">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1749875">timers</span><span class="op" id="1749881">.</span><span class="ident" id="1749882">t</span><span class="op" id="1749883">[</span><span class="ident" id="1749884">i</span><span class="op" id="1749885">]</span><span class="op" id="1749886">.</span><span class="ident" id="1749887">i</span>&nbsp;<span class="op" id="1749889">=</span>&nbsp;<span class="ident" id="1749891">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1749894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1749897">timers</span><span class="op" id="1749903">.</span><span class="ident" id="1749904">t</span><span class="op" id="1749905">[</span><span class="ident" id="1749906">last</span><span class="op" id="1749910">]</span>&nbsp;<span class="op" id="1749912">=</span>&nbsp;<span class="ident" id="1749914">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1749919">timers</span><span class="op" id="1749925">.</span><span class="ident" id="1749926">t</span>&nbsp;<span class="op" id="1749928">=</span>&nbsp;<span class="ident" id="1749930">timers</span><span class="op" id="1749936">.</span><span class="ident" id="1749937">t</span><span class="op" id="1749938">[</span><span class="op" id="1749939">:</span><span class="ident" id="1749940">last</span><span class="op" id="1749944">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1749947">if</span>&nbsp;<span class="ident" id="1749950">i</span>&nbsp;<span class="op" id="1749952">!=</span>&nbsp;<span class="ident" id="1749955">last</span>&nbsp;<span class="op" id="1749960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1749964">siftupTimer</span><span class="op" id="1749975">(</span><span class="ident" id="1749976">i</span><span class="op" id="1749977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1749981">siftdownTimer</span><span class="op" id="1749994">(</span><span class="ident" id="1749995">i</span><span class="op" id="1749996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1749999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750002">unlock</span><span class="op" id="1750008">(</span><span class="op" id="1750009">&amp;</span><span class="ident" id="1750010">timers</span><span class="op" id="1750016">.</span><span class="ident" id="1750017">lock</span><span class="op" id="1750021">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1750024">return</span>&nbsp;<span class="builtintype" id="1750031">true</span><br>
<span class="lineno"></span><span class="op" id="1750036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1750039">//&nbsp;Timerproc&nbsp;runs&nbsp;the&nbsp;time-driven&nbsp;events.</span><br>
<span class="lineno"></span><span class="comment" id="1750081">//&nbsp;It&nbsp;sleeps&nbsp;until&nbsp;the&nbsp;next&nbsp;event&nbsp;in&nbsp;the&nbsp;timers&nbsp;heap.</span><br>
<span class="lineno">150</span><span class="comment" id="1750135">//&nbsp;If&nbsp;addtimer&nbsp;inserts&nbsp;a&nbsp;new&nbsp;earlier&nbsp;event,&nbsp;addtimer1&nbsp;wakes&nbsp;timerproc&nbsp;early.</span><br>
<span class="lineno"></span><span class="keyword" id="1750212">func</span>&nbsp;<span class="ident" id="1750217">timerproc</span><span class="op" id="1750226">(</span><span class="op" id="1750227">)</span>&nbsp;<span class="op" id="1750229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750232">timers</span><span class="op" id="1750238">.</span><span class="ident" id="1750239">gp</span>&nbsp;<span class="op" id="1750242">=</span>&nbsp;<span class="ident" id="1750244">getg</span><span class="op" id="1750248">(</span><span class="op" id="1750249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750252">timers</span><span class="op" id="1750258">.</span><span class="ident" id="1750259">gp</span><span class="op" id="1750261">.</span><span class="ident" id="1750262">issystem</span>&nbsp;<span class="op" id="1750271">=</span>&nbsp;<span class="builtintype" id="1750273">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1750279">for</span>&nbsp;<span class="op" id="1750283">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750287">lock</span><span class="op" id="1750291">(</span><span class="op" id="1750292">&amp;</span><span class="ident" id="1750293">timers</span><span class="op" id="1750299">.</span><span class="ident" id="1750300">lock</span><span class="op" id="1750304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750308">timers</span><span class="op" id="1750314">.</span><span class="ident" id="1750315">sleeping</span>&nbsp;<span class="op" id="1750324">=</span>&nbsp;<span class="builtintype" id="1750326">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750334">now</span>&nbsp;<span class="op" id="1750338">:=</span>&nbsp;<span class="ident" id="1750341">nanotime</span><span class="op" id="1750349">(</span><span class="op" id="1750350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750354">delta</span>&nbsp;<span class="op" id="1750360">:=</span>&nbsp;<span class="ident" id="1750363">int64</span><span class="op" id="1750368">(</span><span class="op" id="1750369">-</span><span class="num" id="1750370">1</span><span class="op" id="1750371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1750375">for</span>&nbsp;<span class="op" id="1750379">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1750384">if</span>&nbsp;<span class="builtinfunc" id="1750387">len</span><span class="op" id="1750390">(</span><span class="ident" id="1750391">timers</span><span class="op" id="1750397">.</span><span class="ident" id="1750398">t</span><span class="op" id="1750399">)</span>&nbsp;<span class="op" id="1750401">==</span>&nbsp;<span class="num" id="1750404">0</span>&nbsp;<span class="op" id="1750406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750412">delta</span>&nbsp;<span class="op" id="1750418">=</span>&nbsp;<span class="op" id="1750420">-</span><span class="num" id="1750421">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1750427">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1750436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750441">t</span>&nbsp;<span class="op" id="1750443">:=</span>&nbsp;<span class="ident" id="1750446">timers</span><span class="op" id="1750452">.</span><span class="ident" id="1750453">t</span><span class="op" id="1750454">[</span><span class="num" id="1750455">0</span><span class="op" id="1750456">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750461">delta</span>&nbsp;<span class="op" id="1750467">=</span>&nbsp;<span class="ident" id="1750469">t</span><span class="op" id="1750470">.</span><span class="ident" id="1750471">when</span>&nbsp;<span class="op" id="1750476">-</span>&nbsp;<span class="ident" id="1750478">now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1750485">if</span>&nbsp;<span class="ident" id="1750488">delta</span>&nbsp;<span class="op" id="1750494">&gt;</span>&nbsp;<span class="num" id="1750496">0</span>&nbsp;<span class="op" id="1750498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1750504">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1750513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1750518">if</span>&nbsp;<span class="ident" id="1750521">t</span><span class="op" id="1750522">.</span><span class="ident" id="1750523">period</span>&nbsp;<span class="op" id="1750530">&gt;</span>&nbsp;<span class="num" id="1750532">0</span>&nbsp;<span class="op" id="1750534">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1750540">//&nbsp;leave&nbsp;in&nbsp;heap&nbsp;but&nbsp;adjust&nbsp;next&nbsp;time&nbsp;to&nbsp;fire</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750590">t</span><span class="op" id="1750591">.</span><span class="ident" id="1750592">when</span>&nbsp;<span class="op" id="1750597">+=</span>&nbsp;<span class="ident" id="1750600">t</span><span class="op" id="1750601">.</span><span class="ident" id="1750602">period</span>&nbsp;<span class="op" id="1750609">*</span>&nbsp;<span class="op" id="1750611">(</span><span class="num" id="1750612">1</span>&nbsp;<span class="op" id="1750614">+</span>&nbsp;<span class="op" id="1750616">-</span><span class="ident" id="1750617">delta</span><span class="op" id="1750622">/</span><span class="ident" id="1750623">t</span><span class="op" id="1750624">.</span><span class="ident" id="1750625">period</span><span class="op" id="1750631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750637">siftdownTimer</span><span class="op" id="1750650">(</span><span class="num" id="1750651">0</span><span class="op" id="1750652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1750657">}</span>&nbsp;<span class="keyword" id="1750659">else</span>&nbsp;<span class="op" id="1750664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1750670">//&nbsp;remove&nbsp;from&nbsp;heap</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750694">last</span>&nbsp;<span class="op" id="1750699">:=</span>&nbsp;<span class="builtinfunc" id="1750702">len</span><span class="op" id="1750705">(</span><span class="ident" id="1750706">timers</span><span class="op" id="1750712">.</span><span class="ident" id="1750713">t</span><span class="op" id="1750714">)</span>&nbsp;<span class="op" id="1750716">-</span>&nbsp;<span class="num" id="1750718">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1750724">if</span>&nbsp;<span class="ident" id="1750727">last</span>&nbsp;<span class="op" id="1750732">&gt;</span>&nbsp;<span class="num" id="1750734">0</span>&nbsp;<span class="op" id="1750736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750743">timers</span><span class="op" id="1750749">.</span><span class="ident" id="1750750">t</span><span class="op" id="1750751">[</span><span class="num" id="1750752">0</span><span class="op" id="1750753">]</span>&nbsp;<span class="op" id="1750755">=</span>&nbsp;<span class="ident" id="1750757">timers</span><span class="op" id="1750763">.</span><span class="ident" id="1750764">t</span><span class="op" id="1750765">[</span><span class="ident" id="1750766">last</span><span class="op" id="1750770">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750777">timers</span><span class="op" id="1750783">.</span><span class="ident" id="1750784">t</span><span class="op" id="1750785">[</span><span class="num" id="1750786">0</span><span class="op" id="1750787">]</span><span class="op" id="1750788">.</span><span class="ident" id="1750789">i</span>&nbsp;<span class="op" id="1750791">=</span>&nbsp;<span class="num" id="1750793">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1750799">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750805">timers</span><span class="op" id="1750811">.</span><span class="ident" id="1750812">t</span><span class="op" id="1750813">[</span><span class="ident" id="1750814">last</span><span class="op" id="1750818">]</span>&nbsp;<span class="op" id="1750820">=</span>&nbsp;<span class="ident" id="1750822">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750830">timers</span><span class="op" id="1750836">.</span><span class="ident" id="1750837">t</span>&nbsp;<span class="op" id="1750839">=</span>&nbsp;<span class="ident" id="1750841">timers</span><span class="op" id="1750847">.</span><span class="ident" id="1750848">t</span><span class="op" id="1750849">[</span><span class="op" id="1750850">:</span><span class="ident" id="1750851">last</span><span class="op" id="1750855">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1750861">if</span>&nbsp;<span class="ident" id="1750864">last</span>&nbsp;<span class="op" id="1750869">&gt;</span>&nbsp;<span class="num" id="1750871">0</span>&nbsp;<span class="op" id="1750873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750880">siftdownTimer</span><span class="op" id="1750893">(</span><span class="num" id="1750894">0</span><span class="op" id="1750895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1750901">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750907">t</span><span class="op" id="1750908">.</span><span class="ident" id="1750909">i</span>&nbsp;<span class="op" id="1750911">=</span>&nbsp;<span class="op" id="1750913">-</span><span class="num" id="1750914">1</span>&nbsp;<span class="comment" id="1750916">//&nbsp;mark&nbsp;as&nbsp;removed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1750938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750943">f</span>&nbsp;<span class="op" id="1750945">:=</span>&nbsp;<span class="ident" id="1750948">t</span><span class="op" id="1750949">.</span><span class="ident" id="1750950">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750955">arg</span>&nbsp;<span class="op" id="1750959">:=</span>&nbsp;<span class="ident" id="1750962">t</span><span class="op" id="1750963">.</span><span class="ident" id="1750964">arg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750971">seq</span>&nbsp;<span class="op" id="1750975">:=</span>&nbsp;<span class="ident" id="1750978">t</span><span class="op" id="1750979">.</span><span class="ident" id="1750980">seq</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1750987">unlock</span><span class="op" id="1750993">(</span><span class="op" id="1750994">&amp;</span><span class="ident" id="1750995">timers</span><span class="op" id="1751001">.</span><span class="ident" id="1751002">lock</span><span class="op" id="1751006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751011">if</span>&nbsp;<span class="ident" id="1751014">raceenabled</span>&nbsp;<span class="op" id="1751026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751032">raceacquire</span><span class="op" id="1751043">(</span><span class="ident" id="1751044">unsafe</span><span class="op" id="1751050">.</span><span class="ident" id="1751051">Pointer</span><span class="op" id="1751058">(</span><span class="ident" id="1751059">t</span><span class="op" id="1751060">)</span><span class="op" id="1751061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1751066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751071">f</span><span class="op" id="1751072">(</span><span class="ident" id="1751073">arg</span><span class="op" id="1751076">,</span>&nbsp;<span class="ident" id="1751078">seq</span><span class="op" id="1751081">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751086">lock</span><span class="op" id="1751090">(</span><span class="op" id="1751091">&amp;</span><span class="ident" id="1751092">timers</span><span class="op" id="1751098">.</span><span class="ident" id="1751099">lock</span><span class="op" id="1751103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1751107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751111">if</span>&nbsp;<span class="ident" id="1751114">delta</span>&nbsp;<span class="op" id="1751120">&lt;</span>&nbsp;<span class="num" id="1751122">0</span>&nbsp;<span class="op" id="1751124">||</span>&nbsp;<span class="ident" id="1751127">faketime</span>&nbsp;<span class="op" id="1751136">&gt;</span>&nbsp;<span class="num" id="1751138">0</span>&nbsp;<span class="op" id="1751140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1751145">//&nbsp;No&nbsp;timers&nbsp;left&nbsp;-&nbsp;put&nbsp;goroutine&nbsp;to&nbsp;sleep.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751192">timers</span><span class="op" id="1751198">.</span><span class="ident" id="1751199">rescheduling</span>&nbsp;<span class="op" id="1751212">=</span>&nbsp;<span class="builtintype" id="1751214">true</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751222">goparkunlock</span><span class="op" id="1751234">(</span><span class="op" id="1751235">&amp;</span><span class="ident" id="1751236">timers</span><span class="op" id="1751242">.</span><span class="ident" id="1751243">lock</span><span class="op" id="1751247">,</span>&nbsp;<span class="string" id="1751249">&#34;timer&nbsp;goroutine&nbsp;(idle)&#34;</span><span class="op" id="1751273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751278">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1751289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1751293">//&nbsp;At&nbsp;least&nbsp;one&nbsp;timer&nbsp;pending.&nbsp;&nbsp;Sleep&nbsp;until&nbsp;then.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751345">timers</span><span class="op" id="1751351">.</span><span class="ident" id="1751352">sleeping</span>&nbsp;<span class="op" id="1751361">=</span>&nbsp;<span class="builtintype" id="1751363">true</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751370">noteclear</span><span class="op" id="1751379">(</span><span class="op" id="1751380">&amp;</span><span class="ident" id="1751381">timers</span><span class="op" id="1751387">.</span><span class="ident" id="1751388">waitnote</span><span class="op" id="1751396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751400">unlock</span><span class="op" id="1751406">(</span><span class="op" id="1751407">&amp;</span><span class="ident" id="1751408">timers</span><span class="op" id="1751414">.</span><span class="ident" id="1751415">lock</span><span class="op" id="1751419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751423">notetsleepg</span><span class="op" id="1751434">(</span><span class="op" id="1751435">&amp;</span><span class="ident" id="1751436">timers</span><span class="op" id="1751442">.</span><span class="ident" id="1751443">waitnote</span><span class="op" id="1751451">,</span>&nbsp;<span class="ident" id="1751453">delta</span><span class="op" id="1751458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1751461">}</span><br>
<span class="lineno"></span><span class="op" id="1751463">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="1751466">func</span>&nbsp;<span class="ident" id="1751471">timejump</span><span class="op" id="1751479">(</span><span class="op" id="1751480">)</span>&nbsp;<span class="op" id="1751482">*</span><span class="ident" id="1751483">g</span>&nbsp;<span class="op" id="1751485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751488">if</span>&nbsp;<span class="ident" id="1751491">faketime</span>&nbsp;<span class="op" id="1751500">==</span>&nbsp;<span class="num" id="1751503">0</span>&nbsp;<span class="op" id="1751505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751509">return</span>&nbsp;<span class="ident" id="1751516">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1751521">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751525">lock</span><span class="op" id="1751529">(</span><span class="op" id="1751530">&amp;</span><span class="ident" id="1751531">timers</span><span class="op" id="1751537">.</span><span class="ident" id="1751538">lock</span><span class="op" id="1751542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751545">if</span>&nbsp;<span class="op" id="1751548">!</span><span class="ident" id="1751549">timers</span><span class="op" id="1751555">.</span><span class="ident" id="1751556">created</span>&nbsp;<span class="op" id="1751564">||</span>&nbsp;<span class="builtinfunc" id="1751567">len</span><span class="op" id="1751570">(</span><span class="ident" id="1751571">timers</span><span class="op" id="1751577">.</span><span class="ident" id="1751578">t</span><span class="op" id="1751579">)</span>&nbsp;<span class="op" id="1751581">==</span>&nbsp;<span class="num" id="1751584">0</span>&nbsp;<span class="op" id="1751586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751590">unlock</span><span class="op" id="1751596">(</span><span class="op" id="1751597">&amp;</span><span class="ident" id="1751598">timers</span><span class="op" id="1751604">.</span><span class="ident" id="1751605">lock</span><span class="op" id="1751609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751613">return</span>&nbsp;<span class="ident" id="1751620">nil</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1751625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751629">var</span>&nbsp;<span class="ident" id="1751633">gp</span>&nbsp;<span class="op" id="1751636">*</span><span class="ident" id="1751637">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751640">if</span>&nbsp;<span class="ident" id="1751643">faketime</span>&nbsp;<span class="op" id="1751652">&lt;</span>&nbsp;<span class="ident" id="1751654">timers</span><span class="op" id="1751660">.</span><span class="ident" id="1751661">t</span><span class="op" id="1751662">[</span><span class="num" id="1751663">0</span><span class="op" id="1751664">]</span><span class="op" id="1751665">.</span><span class="ident" id="1751666">when</span>&nbsp;<span class="op" id="1751671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751675">faketime</span>&nbsp;<span class="op" id="1751684">=</span>&nbsp;<span class="ident" id="1751686">timers</span><span class="op" id="1751692">.</span><span class="ident" id="1751693">t</span><span class="op" id="1751694">[</span><span class="num" id="1751695">0</span><span class="op" id="1751696">]</span><span class="op" id="1751697">.</span><span class="ident" id="1751698">when</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751705">if</span>&nbsp;<span class="ident" id="1751708">timers</span><span class="op" id="1751714">.</span><span class="ident" id="1751715">rescheduling</span>&nbsp;<span class="op" id="1751728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751733">timers</span><span class="op" id="1751739">.</span><span class="ident" id="1751740">rescheduling</span>&nbsp;<span class="op" id="1751753">=</span>&nbsp;<span class="builtintype" id="1751755">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751764">gp</span>&nbsp;<span class="op" id="1751767">=</span>&nbsp;<span class="ident" id="1751769">timers</span><span class="op" id="1751775">.</span><span class="ident" id="1751776">gp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1751781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1751784">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751787">unlock</span><span class="op" id="1751793">(</span><span class="op" id="1751794">&amp;</span><span class="ident" id="1751795">timers</span><span class="op" id="1751801">.</span><span class="ident" id="1751802">lock</span><span class="op" id="1751806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751809">return</span>&nbsp;<span class="ident" id="1751816">gp</span><br>
<span class="lineno"></span><span class="op" id="1751819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1751822">//&nbsp;Heap&nbsp;maintenance&nbsp;algorithms.</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="1751855">func</span>&nbsp;<span class="ident" id="1751860">siftupTimer</span><span class="op" id="1751871">(</span><span class="ident" id="1751872">i</span>&nbsp;<span class="builtintype" id="1751874">int</span><span class="op" id="1751877">)</span>&nbsp;<span class="op" id="1751879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751882">t</span>&nbsp;<span class="op" id="1751884">:=</span>&nbsp;<span class="ident" id="1751887">timers</span><span class="op" id="1751893">.</span><span class="ident" id="1751894">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751897">when</span>&nbsp;<span class="op" id="1751902">:=</span>&nbsp;<span class="ident" id="1751905">t</span><span class="op" id="1751906">[</span><span class="ident" id="1751907">i</span><span class="op" id="1751908">]</span><span class="op" id="1751909">.</span><span class="ident" id="1751910">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751916">tmp</span>&nbsp;<span class="op" id="1751920">:=</span>&nbsp;<span class="ident" id="1751923">t</span><span class="op" id="1751924">[</span><span class="ident" id="1751925">i</span><span class="op" id="1751926">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751929">for</span>&nbsp;<span class="ident" id="1751933">i</span>&nbsp;<span class="op" id="1751935">&gt;</span>&nbsp;<span class="num" id="1751937">0</span>&nbsp;<span class="op" id="1751939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751943">p</span>&nbsp;<span class="op" id="1751945">:=</span>&nbsp;<span class="op" id="1751948">(</span><span class="ident" id="1751949">i</span>&nbsp;<span class="op" id="1751951">-</span>&nbsp;<span class="num" id="1751953">1</span><span class="op" id="1751954">)</span>&nbsp;<span class="op" id="1751956">/</span>&nbsp;<span class="num" id="1751958">4</span>&nbsp;<span class="comment" id="1751960">//&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751972">if</span>&nbsp;<span class="ident" id="1751975">when</span>&nbsp;<span class="op" id="1751980">&gt;=</span>&nbsp;<span class="ident" id="1751983">t</span><span class="op" id="1751984">[</span><span class="ident" id="1751985">p</span><span class="op" id="1751986">]</span><span class="op" id="1751987">.</span><span class="ident" id="1751988">when</span>&nbsp;<span class="op" id="1751993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751998">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752006">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752010">t</span><span class="op" id="1752011">[</span><span class="ident" id="1752012">i</span><span class="op" id="1752013">]</span>&nbsp;<span class="op" id="1752015">=</span>&nbsp;<span class="ident" id="1752017">t</span><span class="op" id="1752018">[</span><span class="ident" id="1752019">p</span><span class="op" id="1752020">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752024">t</span><span class="op" id="1752025">[</span><span class="ident" id="1752026">i</span><span class="op" id="1752027">]</span><span class="op" id="1752028">.</span><span class="ident" id="1752029">i</span>&nbsp;<span class="op" id="1752031">=</span>&nbsp;<span class="ident" id="1752033">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752037">t</span><span class="op" id="1752038">[</span><span class="ident" id="1752039">p</span><span class="op" id="1752040">]</span>&nbsp;<span class="op" id="1752042">=</span>&nbsp;<span class="ident" id="1752044">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752050">t</span><span class="op" id="1752051">[</span><span class="ident" id="1752052">p</span><span class="op" id="1752053">]</span><span class="op" id="1752054">.</span><span class="ident" id="1752055">i</span>&nbsp;<span class="op" id="1752057">=</span>&nbsp;<span class="ident" id="1752059">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752063">i</span>&nbsp;<span class="op" id="1752065">=</span>&nbsp;<span class="ident" id="1752067">p</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752070">}</span><br>
<span class="lineno"></span><span class="op" id="1752072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1752075">func</span>&nbsp;<span class="ident" id="1752080">siftdownTimer</span><span class="op" id="1752093">(</span><span class="ident" id="1752094">i</span>&nbsp;<span class="builtintype" id="1752096">int</span><span class="op" id="1752099">)</span>&nbsp;<span class="op" id="1752101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752104">t</span>&nbsp;<span class="op" id="1752106">:=</span>&nbsp;<span class="ident" id="1752109">timers</span><span class="op" id="1752115">.</span><span class="ident" id="1752116">t</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752119">n</span>&nbsp;<span class="op" id="1752121">:=</span>&nbsp;<span class="builtinfunc" id="1752124">len</span><span class="op" id="1752127">(</span><span class="ident" id="1752128">t</span><span class="op" id="1752129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752132">when</span>&nbsp;<span class="op" id="1752137">:=</span>&nbsp;<span class="ident" id="1752140">t</span><span class="op" id="1752141">[</span><span class="ident" id="1752142">i</span><span class="op" id="1752143">]</span><span class="op" id="1752144">.</span><span class="ident" id="1752145">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752151">tmp</span>&nbsp;<span class="op" id="1752155">:=</span>&nbsp;<span class="ident" id="1752158">t</span><span class="op" id="1752159">[</span><span class="ident" id="1752160">i</span><span class="op" id="1752161">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1752164">for</span>&nbsp;<span class="op" id="1752168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752172">c</span>&nbsp;<span class="op" id="1752174">:=</span>&nbsp;<span class="ident" id="1752177">i</span><span class="op" id="1752178">*</span><span class="num" id="1752179">4</span>&nbsp;<span class="op" id="1752181">+</span>&nbsp;<span class="num" id="1752183">1</span>&nbsp;<span class="comment" id="1752185">//&nbsp;left&nbsp;child</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752201">c3</span>&nbsp;<span class="op" id="1752204">:=</span>&nbsp;<span class="ident" id="1752207">c</span>&nbsp;<span class="op" id="1752209">+</span>&nbsp;<span class="num" id="1752211">2</span>&nbsp;&nbsp;<span class="comment" id="1752214">//&nbsp;mid&nbsp;child</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1752229">if</span>&nbsp;<span class="ident" id="1752232">c</span>&nbsp;<span class="op" id="1752234">&gt;=</span>&nbsp;<span class="ident" id="1752237">n</span>&nbsp;<span class="op" id="1752239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1752244">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752256">w</span>&nbsp;<span class="op" id="1752258">:=</span>&nbsp;<span class="ident" id="1752261">t</span><span class="op" id="1752262">[</span><span class="ident" id="1752263">c</span><span class="op" id="1752264">]</span><span class="op" id="1752265">.</span><span class="ident" id="1752266">when</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1752273">if</span>&nbsp;<span class="ident" id="1752276">c</span><span class="op" id="1752277">+</span><span class="num" id="1752278">1</span>&nbsp;<span class="op" id="1752280">&lt;</span>&nbsp;<span class="ident" id="1752282">n</span>&nbsp;<span class="op" id="1752284">&amp;&amp;</span>&nbsp;<span class="ident" id="1752287">t</span><span class="op" id="1752288">[</span><span class="ident" id="1752289">c</span><span class="op" id="1752290">+</span><span class="num" id="1752291">1</span><span class="op" id="1752292">]</span><span class="op" id="1752293">.</span><span class="ident" id="1752294">when</span>&nbsp;<span class="op" id="1752299">&lt;</span>&nbsp;<span class="ident" id="1752301">w</span>&nbsp;<span class="op" id="1752303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752308">w</span>&nbsp;<span class="op" id="1752310">=</span>&nbsp;<span class="ident" id="1752312">t</span><span class="op" id="1752313">[</span><span class="ident" id="1752314">c</span><span class="op" id="1752315">+</span><span class="num" id="1752316">1</span><span class="op" id="1752317">]</span><span class="op" id="1752318">.</span><span class="ident" id="1752319">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752327">c</span><span class="op" id="1752328">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1752337">if</span>&nbsp;<span class="ident" id="1752340">c3</span>&nbsp;<span class="op" id="1752343">&lt;</span>&nbsp;<span class="ident" id="1752345">n</span>&nbsp;<span class="op" id="1752347">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752352">w3</span>&nbsp;<span class="op" id="1752355">:=</span>&nbsp;<span class="ident" id="1752358">t</span><span class="op" id="1752359">[</span><span class="ident" id="1752360">c3</span><span class="op" id="1752362">]</span><span class="op" id="1752363">.</span><span class="ident" id="1752364">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1752372">if</span>&nbsp;<span class="ident" id="1752375">c3</span><span class="op" id="1752377">+</span><span class="num" id="1752378">1</span>&nbsp;<span class="op" id="1752380">&lt;</span>&nbsp;<span class="ident" id="1752382">n</span>&nbsp;<span class="op" id="1752384">&amp;&amp;</span>&nbsp;<span class="ident" id="1752387">t</span><span class="op" id="1752388">[</span><span class="ident" id="1752389">c3</span><span class="op" id="1752391">+</span><span class="num" id="1752392">1</span><span class="op" id="1752393">]</span><span class="op" id="1752394">.</span><span class="ident" id="1752395">when</span>&nbsp;<span class="op" id="1752400">&lt;</span>&nbsp;<span class="ident" id="1752402">w3</span>&nbsp;<span class="op" id="1752405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752411">w3</span>&nbsp;<span class="op" id="1752414">=</span>&nbsp;<span class="ident" id="1752416">t</span><span class="op" id="1752417">[</span><span class="ident" id="1752418">c3</span><span class="op" id="1752420">+</span><span class="num" id="1752421">1</span><span class="op" id="1752422">]</span><span class="op" id="1752423">.</span><span class="ident" id="1752424">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752433">c3</span><span class="op" id="1752435">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752441">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1752446">if</span>&nbsp;<span class="ident" id="1752449">w3</span>&nbsp;<span class="op" id="1752452">&lt;</span>&nbsp;<span class="ident" id="1752454">w</span>&nbsp;<span class="op" id="1752456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752462">w</span>&nbsp;<span class="op" id="1752464">=</span>&nbsp;<span class="ident" id="1752466">w3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752473">c</span>&nbsp;<span class="op" id="1752475">=</span>&nbsp;<span class="ident" id="1752477">c3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752487">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1752491">if</span>&nbsp;<span class="ident" id="1752494">w</span>&nbsp;<span class="op" id="1752496">&gt;=</span>&nbsp;<span class="ident" id="1752499">when</span>&nbsp;<span class="op" id="1752504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1752509">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752521">t</span><span class="op" id="1752522">[</span><span class="ident" id="1752523">i</span><span class="op" id="1752524">]</span>&nbsp;<span class="op" id="1752526">=</span>&nbsp;<span class="ident" id="1752528">t</span><span class="op" id="1752529">[</span><span class="ident" id="1752530">c</span><span class="op" id="1752531">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752535">t</span><span class="op" id="1752536">[</span><span class="ident" id="1752537">i</span><span class="op" id="1752538">]</span><span class="op" id="1752539">.</span><span class="ident" id="1752540">i</span>&nbsp;<span class="op" id="1752542">=</span>&nbsp;<span class="ident" id="1752544">i</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752548">t</span><span class="op" id="1752549">[</span><span class="ident" id="1752550">c</span><span class="op" id="1752551">]</span>&nbsp;<span class="op" id="1752553">=</span>&nbsp;<span class="ident" id="1752555">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752561">t</span><span class="op" id="1752562">[</span><span class="ident" id="1752563">c</span><span class="op" id="1752564">]</span><span class="op" id="1752565">.</span><span class="ident" id="1752566">i</span>&nbsp;<span class="op" id="1752568">=</span>&nbsp;<span class="ident" id="1752570">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752574">i</span>&nbsp;<span class="op" id="1752576">=</span>&nbsp;<span class="ident" id="1752578">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752581">}</span><br>
<span class="lineno"></span><span class="op" id="1752583">}</span>
</div>
</body>
</html>
