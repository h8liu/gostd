<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html" class="current">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3430961">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3431016">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3431070">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3431121">package</span>&nbsp;<span class="ident" id="3431129">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3431135">import</span>&nbsp;<span class="op" id="3431142">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3431145">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3431154">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3431161">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3431168">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3431175">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3431186">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3431197">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="3431204">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3431207">//&nbsp;This&nbsp;implementation&nbsp;is&nbsp;done&nbsp;according&nbsp;to&nbsp;RFC&nbsp;6265:</span><br>
<span class="lineno"></span><span class="comment" id="3431261">//</span><br>
<span class="lineno"></span><span class="comment" id="3431264">//&nbsp;&nbsp;&nbsp;&nbsp;http://tools.ietf.org/html/rfc6265</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3431306">//&nbsp;A&nbsp;Cookie&nbsp;represents&nbsp;an&nbsp;HTTP&nbsp;cookie&nbsp;as&nbsp;sent&nbsp;in&nbsp;the&nbsp;Set-Cookie&nbsp;header&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3431383">//&nbsp;HTTP&nbsp;response&nbsp;or&nbsp;the&nbsp;Cookie&nbsp;header&nbsp;of&nbsp;an&nbsp;HTTP&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="3431441">type</span>&nbsp;<span class="ident" id="3431446">Cookie</span>&nbsp;<span class="keyword" id="3431453">struct</span>&nbsp;<span class="op" id="3431460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3431463">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3431474">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3431482">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3431493">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3431501">Path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3431512">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3431520">Domain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3431531">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3431539">Expires</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3431550">time</span><span class="op" id="3431554">.</span><span class="ident" id="3431555">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3431561">RawExpires</span>&nbsp;<span class="builtintype" id="3431572">string</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3431581">//&nbsp;MaxAge=0&nbsp;means&nbsp;no&nbsp;&#39;Max-Age&#39;&nbsp;attribute&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3431634">//&nbsp;MaxAge&lt;0&nbsp;means&nbsp;delete&nbsp;cookie&nbsp;now,&nbsp;equivalently&nbsp;&#39;Max-Age:&nbsp;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3431698">//&nbsp;MaxAge&gt;0&nbsp;means&nbsp;Max-Age&nbsp;attribute&nbsp;present&nbsp;and&nbsp;given&nbsp;in&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3431764">MaxAge</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3431773">int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3431778">Secure</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3431787">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3431793">HttpOnly</span>&nbsp;<span class="builtintype" id="3431802">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3431808">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3431817">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3431825">Unparsed</span>&nbsp;<span class="op" id="3431834">[</span><span class="op" id="3431835">]</span><span class="builtintype" id="3431836">string</span>&nbsp;<span class="comment" id="3431843">//&nbsp;Raw&nbsp;text&nbsp;of&nbsp;unparsed&nbsp;attribute-value&nbsp;pairs</span><br>
<span class="lineno"></span><span class="op" id="3431889">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3431892">//&nbsp;readSetCookies&nbsp;parses&nbsp;all&nbsp;&#34;Set-Cookie&#34;&nbsp;values&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="3431946">//&nbsp;the&nbsp;header&nbsp;h&nbsp;and&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="keyword" id="3432007">func</span>&nbsp;<span class="ident" id="3432012">readSetCookies</span><span class="op" id="3432026">(</span><span class="ident" id="3432027">h</span>&nbsp;<span class="ident" id="3432029">Header</span><span class="op" id="3432035">)</span>&nbsp;<span class="op" id="3432037">[</span><span class="op" id="3432038">]</span><span class="op" id="3432039">*</span><span class="ident" id="3432040">Cookie</span>&nbsp;<span class="op" id="3432047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432050">cookies</span>&nbsp;<span class="op" id="3432058">:=</span>&nbsp;<span class="op" id="3432061">[</span><span class="op" id="3432062">]</span><span class="op" id="3432063">*</span><span class="ident" id="3432064">Cookie</span><span class="op" id="3432070">{</span><span class="op" id="3432071">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432074">for</span>&nbsp;<span class="ident" id="3432078">_</span><span class="op" id="3432079">,</span>&nbsp;<span class="ident" id="3432081">line</span>&nbsp;<span class="op" id="3432086">:=</span>&nbsp;<span class="keyword" id="3432089">range</span>&nbsp;<span class="ident" id="3432095">h</span><span class="op" id="3432096">[</span><span class="string" id="3432097">&#34;Set-Cookie&#34;</span><span class="op" id="3432109">]</span>&nbsp;<span class="op" id="3432111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432115">parts</span>&nbsp;<span class="op" id="3432121">:=</span>&nbsp;<span class="ident" id="3432124">strings</span><span class="op" id="3432131">.</span><span class="ident" id="3432132">Split</span><span class="op" id="3432137">(</span><span class="ident" id="3432138">strings</span><span class="op" id="3432145">.</span><span class="ident" id="3432146">TrimSpace</span><span class="op" id="3432155">(</span><span class="ident" id="3432156">line</span><span class="op" id="3432160">)</span><span class="op" id="3432161">,</span>&nbsp;<span class="string" id="3432163">&#34;;&#34;</span><span class="op" id="3432166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432170">if</span>&nbsp;<span class="builtinfunc" id="3432173">len</span><span class="op" id="3432176">(</span><span class="ident" id="3432177">parts</span><span class="op" id="3432182">)</span>&nbsp;<span class="op" id="3432184">==</span>&nbsp;<span class="num" id="3432187">1</span>&nbsp;<span class="op" id="3432189">&amp;&amp;</span>&nbsp;<span class="ident" id="3432192">parts</span><span class="op" id="3432197">[</span><span class="num" id="3432198">0</span><span class="op" id="3432199">]</span>&nbsp;<span class="op" id="3432201">==</span>&nbsp;<span class="string" id="3432204">&#34;&#34;</span>&nbsp;<span class="op" id="3432207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432212">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3432223">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432227">parts</span><span class="op" id="3432232">[</span><span class="num" id="3432233">0</span><span class="op" id="3432234">]</span>&nbsp;<span class="op" id="3432236">=</span>&nbsp;<span class="ident" id="3432238">strings</span><span class="op" id="3432245">.</span><span class="ident" id="3432246">TrimSpace</span><span class="op" id="3432255">(</span><span class="ident" id="3432256">parts</span><span class="op" id="3432261">[</span><span class="num" id="3432262">0</span><span class="op" id="3432263">]</span><span class="op" id="3432264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432268">j</span>&nbsp;<span class="op" id="3432270">:=</span>&nbsp;<span class="ident" id="3432273">strings</span><span class="op" id="3432280">.</span><span class="ident" id="3432281">Index</span><span class="op" id="3432286">(</span><span class="ident" id="3432287">parts</span><span class="op" id="3432292">[</span><span class="num" id="3432293">0</span><span class="op" id="3432294">]</span><span class="op" id="3432295">,</span>&nbsp;<span class="string" id="3432297">&#34;=&#34;</span><span class="op" id="3432300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432304">if</span>&nbsp;<span class="ident" id="3432307">j</span>&nbsp;<span class="op" id="3432309">&lt;</span>&nbsp;<span class="num" id="3432311">0</span>&nbsp;<span class="op" id="3432313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432318">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3432329">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432333">name</span><span class="op" id="3432337">,</span>&nbsp;<span class="ident" id="3432339">value</span>&nbsp;<span class="op" id="3432345">:=</span>&nbsp;<span class="ident" id="3432348">parts</span><span class="op" id="3432353">[</span><span class="num" id="3432354">0</span><span class="op" id="3432355">]</span><span class="op" id="3432356">[</span><span class="op" id="3432357">:</span><span class="ident" id="3432358">j</span><span class="op" id="3432359">]</span><span class="op" id="3432360">,</span>&nbsp;<span class="ident" id="3432362">parts</span><span class="op" id="3432367">[</span><span class="num" id="3432368">0</span><span class="op" id="3432369">]</span><span class="op" id="3432370">[</span><span class="ident" id="3432371">j</span><span class="op" id="3432372">+</span><span class="num" id="3432373">1</span><span class="op" id="3432374">:</span><span class="op" id="3432375">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432379">if</span>&nbsp;<span class="op" id="3432382">!</span><span class="ident" id="3432383">isCookieNameValid</span><span class="op" id="3432400">(</span><span class="ident" id="3432401">name</span><span class="op" id="3432405">)</span>&nbsp;<span class="op" id="3432407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432412">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3432423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432427">value</span><span class="op" id="3432432">,</span>&nbsp;<span class="ident" id="3432434">success</span>&nbsp;<span class="op" id="3432442">:=</span>&nbsp;<span class="ident" id="3432445">parseCookieValue</span><span class="op" id="3432461">(</span><span class="ident" id="3432462">value</span><span class="op" id="3432467">,</span>&nbsp;<span class="builtintype" id="3432469">true</span><span class="op" id="3432473">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432477">if</span>&nbsp;<span class="op" id="3432480">!</span><span class="ident" id="3432481">success</span>&nbsp;<span class="op" id="3432489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432494">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3432505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432509">c</span>&nbsp;<span class="op" id="3432511">:=</span>&nbsp;<span class="op" id="3432514">&amp;</span><span class="ident" id="3432515">Cookie</span><span class="op" id="3432521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432526">Name</span><span class="op" id="3432530">:</span>&nbsp;&nbsp;<span class="ident" id="3432533">name</span><span class="op" id="3432537">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432542">Value</span><span class="op" id="3432547">:</span>&nbsp;<span class="ident" id="3432549">value</span><span class="op" id="3432554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432559">Raw</span><span class="op" id="3432562">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3432566">line</span><span class="op" id="3432570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3432574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432578">for</span>&nbsp;<span class="ident" id="3432582">i</span>&nbsp;<span class="op" id="3432584">:=</span>&nbsp;<span class="num" id="3432587">1</span><span class="op" id="3432588">;</span>&nbsp;<span class="ident" id="3432590">i</span>&nbsp;<span class="op" id="3432592">&lt;</span>&nbsp;<span class="builtinfunc" id="3432594">len</span><span class="op" id="3432597">(</span><span class="ident" id="3432598">parts</span><span class="op" id="3432603">)</span><span class="op" id="3432604">;</span>&nbsp;<span class="ident" id="3432606">i</span><span class="op" id="3432607">++</span>&nbsp;<span class="op" id="3432610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432615">parts</span><span class="op" id="3432620">[</span><span class="ident" id="3432621">i</span><span class="op" id="3432622">]</span>&nbsp;<span class="op" id="3432624">=</span>&nbsp;<span class="ident" id="3432626">strings</span><span class="op" id="3432633">.</span><span class="ident" id="3432634">TrimSpace</span><span class="op" id="3432643">(</span><span class="ident" id="3432644">parts</span><span class="op" id="3432649">[</span><span class="ident" id="3432650">i</span><span class="op" id="3432651">]</span><span class="op" id="3432652">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432657">if</span>&nbsp;<span class="builtinfunc" id="3432660">len</span><span class="op" id="3432663">(</span><span class="ident" id="3432664">parts</span><span class="op" id="3432669">[</span><span class="ident" id="3432670">i</span><span class="op" id="3432671">]</span><span class="op" id="3432672">)</span>&nbsp;<span class="op" id="3432674">==</span>&nbsp;<span class="num" id="3432677">0</span>&nbsp;<span class="op" id="3432679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432685">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3432697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432703">attr</span><span class="op" id="3432707">,</span>&nbsp;<span class="ident" id="3432709">val</span>&nbsp;<span class="op" id="3432713">:=</span>&nbsp;<span class="ident" id="3432716">parts</span><span class="op" id="3432721">[</span><span class="ident" id="3432722">i</span><span class="op" id="3432723">]</span><span class="op" id="3432724">,</span>&nbsp;<span class="string" id="3432726">&#34;&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432732">if</span>&nbsp;<span class="ident" id="3432735">j</span>&nbsp;<span class="op" id="3432737">:=</span>&nbsp;<span class="ident" id="3432740">strings</span><span class="op" id="3432747">.</span><span class="ident" id="3432748">Index</span><span class="op" id="3432753">(</span><span class="ident" id="3432754">attr</span><span class="op" id="3432758">,</span>&nbsp;<span class="string" id="3432760">&#34;=&#34;</span><span class="op" id="3432763">)</span><span class="op" id="3432764">;</span>&nbsp;<span class="ident" id="3432766">j</span>&nbsp;<span class="op" id="3432768">&gt;=</span>&nbsp;<span class="num" id="3432771">0</span>&nbsp;<span class="op" id="3432773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432779">attr</span><span class="op" id="3432783">,</span>&nbsp;<span class="ident" id="3432785">val</span>&nbsp;<span class="op" id="3432789">=</span>&nbsp;<span class="ident" id="3432791">attr</span><span class="op" id="3432795">[</span><span class="op" id="3432796">:</span><span class="ident" id="3432797">j</span><span class="op" id="3432798">]</span><span class="op" id="3432799">,</span>&nbsp;<span class="ident" id="3432801">attr</span><span class="op" id="3432805">[</span><span class="ident" id="3432806">j</span><span class="op" id="3432807">+</span><span class="num" id="3432808">1</span><span class="op" id="3432809">:</span><span class="op" id="3432810">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3432815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432820">lowerAttr</span>&nbsp;<span class="op" id="3432830">:=</span>&nbsp;<span class="ident" id="3432833">strings</span><span class="op" id="3432840">.</span><span class="ident" id="3432841">ToLower</span><span class="op" id="3432848">(</span><span class="ident" id="3432849">attr</span><span class="op" id="3432853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432858">val</span><span class="op" id="3432861">,</span>&nbsp;<span class="ident" id="3432863">success</span>&nbsp;<span class="op" id="3432871">=</span>&nbsp;<span class="ident" id="3432873">parseCookieValue</span><span class="op" id="3432889">(</span><span class="ident" id="3432890">val</span><span class="op" id="3432893">,</span>&nbsp;<span class="builtintype" id="3432895">false</span><span class="op" id="3432900">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432905">if</span>&nbsp;<span class="op" id="3432908">!</span><span class="ident" id="3432909">success</span>&nbsp;<span class="op" id="3432917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432923">c</span><span class="op" id="3432924">.</span><span class="ident" id="3432925">Unparsed</span>&nbsp;<span class="op" id="3432934">=</span>&nbsp;<span class="builtinfunc" id="3432936">append</span><span class="op" id="3432942">(</span><span class="ident" id="3432943">c</span><span class="op" id="3432944">.</span><span class="ident" id="3432945">Unparsed</span><span class="op" id="3432953">,</span>&nbsp;<span class="ident" id="3432955">parts</span><span class="op" id="3432960">[</span><span class="ident" id="3432961">i</span><span class="op" id="3432962">]</span><span class="op" id="3432963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432969">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3432981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432986">switch</span>&nbsp;<span class="ident" id="3432993">lowerAttr</span>&nbsp;<span class="op" id="3433003">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433008">case</span>&nbsp;<span class="string" id="3433013">&#34;secure&#34;</span><span class="op" id="3433021">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433027">c</span><span class="op" id="3433028">.</span><span class="ident" id="3433029">Secure</span>&nbsp;<span class="op" id="3433036">=</span>&nbsp;<span class="builtintype" id="3433038">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433047">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433059">case</span>&nbsp;<span class="string" id="3433064">&#34;httponly&#34;</span><span class="op" id="3433074">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433080">c</span><span class="op" id="3433081">.</span><span class="ident" id="3433082">HttpOnly</span>&nbsp;<span class="op" id="3433091">=</span>&nbsp;<span class="builtintype" id="3433093">true</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433102">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433114">case</span>&nbsp;<span class="string" id="3433119">&#34;domain&#34;</span><span class="op" id="3433127">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433133">c</span><span class="op" id="3433134">.</span><span class="ident" id="3433135">Domain</span>&nbsp;<span class="op" id="3433142">=</span>&nbsp;<span class="ident" id="3433144">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433152">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433164">case</span>&nbsp;<span class="string" id="3433169">&#34;max-age&#34;</span><span class="op" id="3433178">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433184">secs</span><span class="op" id="3433188">,</span>&nbsp;<span class="ident" id="3433190">err</span>&nbsp;<span class="op" id="3433194">:=</span>&nbsp;<span class="ident" id="3433197">strconv</span><span class="op" id="3433204">.</span><span class="ident" id="3433205">Atoi</span><span class="op" id="3433209">(</span><span class="ident" id="3433210">val</span><span class="op" id="3433213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433219">if</span>&nbsp;<span class="ident" id="3433222">err</span>&nbsp;<span class="op" id="3433226">!=</span>&nbsp;<span class="ident" id="3433229">nil</span>&nbsp;<span class="op" id="3433233">||</span>&nbsp;<span class="ident" id="3433236">secs</span>&nbsp;<span class="op" id="3433241">!=</span>&nbsp;<span class="num" id="3433244">0</span>&nbsp;<span class="op" id="3433246">&amp;&amp;</span>&nbsp;<span class="ident" id="3433249">val</span><span class="op" id="3433252">[</span><span class="num" id="3433253">0</span><span class="op" id="3433254">]</span>&nbsp;<span class="op" id="3433256">==</span>&nbsp;<span class="string" id="3433259">&#39;0&#39;</span>&nbsp;<span class="op" id="3433263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433270">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3433280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433286">if</span>&nbsp;<span class="ident" id="3433289">secs</span>&nbsp;<span class="op" id="3433294">&lt;=</span>&nbsp;<span class="num" id="3433297">0</span>&nbsp;<span class="op" id="3433299">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433306">c</span><span class="op" id="3433307">.</span><span class="ident" id="3433308">MaxAge</span>&nbsp;<span class="op" id="3433315">=</span>&nbsp;<span class="op" id="3433317">-</span><span class="num" id="3433318">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3433324">}</span>&nbsp;<span class="keyword" id="3433326">else</span>&nbsp;<span class="op" id="3433331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433338">c</span><span class="op" id="3433339">.</span><span class="ident" id="3433340">MaxAge</span>&nbsp;<span class="op" id="3433347">=</span>&nbsp;<span class="ident" id="3433349">secs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3433358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433364">continue</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433376">case</span>&nbsp;<span class="string" id="3433381">&#34;expires&#34;</span><span class="op" id="3433390">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433396">c</span><span class="op" id="3433397">.</span><span class="ident" id="3433398">RawExpires</span>&nbsp;<span class="op" id="3433409">=</span>&nbsp;<span class="ident" id="3433411">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433419">exptime</span><span class="op" id="3433426">,</span>&nbsp;<span class="ident" id="3433428">err</span>&nbsp;<span class="op" id="3433432">:=</span>&nbsp;<span class="ident" id="3433435">time</span><span class="op" id="3433439">.</span><span class="ident" id="3433440">Parse</span><span class="op" id="3433445">(</span><span class="ident" id="3433446">time</span><span class="op" id="3433450">.</span><span class="ident" id="3433451">RFC1123</span><span class="op" id="3433458">,</span>&nbsp;<span class="ident" id="3433460">val</span><span class="op" id="3433463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433469">if</span>&nbsp;<span class="ident" id="3433472">err</span>&nbsp;<span class="op" id="3433476">!=</span>&nbsp;<span class="ident" id="3433479">nil</span>&nbsp;<span class="op" id="3433483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433490">exptime</span><span class="op" id="3433497">,</span>&nbsp;<span class="ident" id="3433499">err</span>&nbsp;<span class="op" id="3433503">=</span>&nbsp;<span class="ident" id="3433505">time</span><span class="op" id="3433509">.</span><span class="ident" id="3433510">Parse</span><span class="op" id="3433515">(</span><span class="string" id="3433516">&#34;Mon,&nbsp;02-Jan-2006&nbsp;15:04:05&nbsp;MST&#34;</span><span class="op" id="3433547">,</span>&nbsp;<span class="ident" id="3433549">val</span><span class="op" id="3433552">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433559">if</span>&nbsp;<span class="ident" id="3433562">err</span>&nbsp;<span class="op" id="3433566">!=</span>&nbsp;<span class="ident" id="3433569">nil</span>&nbsp;<span class="op" id="3433573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433581">c</span><span class="op" id="3433582">.</span><span class="ident" id="3433583">Expires</span>&nbsp;<span class="op" id="3433591">=</span>&nbsp;<span class="ident" id="3433593">time</span><span class="op" id="3433597">.</span><span class="ident" id="3433598">Time</span><span class="op" id="3433602">{</span><span class="op" id="3433603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433611">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3433622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3433628">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433634">c</span><span class="op" id="3433635">.</span><span class="ident" id="3433636">Expires</span>&nbsp;<span class="op" id="3433644">=</span>&nbsp;<span class="ident" id="3433646">exptime</span><span class="op" id="3433653">.</span><span class="ident" id="3433654">UTC</span><span class="op" id="3433657">(</span><span class="op" id="3433658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433664">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433676">case</span>&nbsp;<span class="string" id="3433681">&#34;path&#34;</span><span class="op" id="3433687">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433693">c</span><span class="op" id="3433694">.</span><span class="ident" id="3433695">Path</span>&nbsp;<span class="op" id="3433700">=</span>&nbsp;<span class="ident" id="3433702">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433710">continue</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3433722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433727">c</span><span class="op" id="3433728">.</span><span class="ident" id="3433729">Unparsed</span>&nbsp;<span class="op" id="3433738">=</span>&nbsp;<span class="builtinfunc" id="3433740">append</span><span class="op" id="3433746">(</span><span class="ident" id="3433747">c</span><span class="op" id="3433748">.</span><span class="ident" id="3433749">Unparsed</span><span class="op" id="3433757">,</span>&nbsp;<span class="ident" id="3433759">parts</span><span class="op" id="3433764">[</span><span class="ident" id="3433765">i</span><span class="op" id="3433766">]</span><span class="op" id="3433767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3433771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433775">cookies</span>&nbsp;<span class="op" id="3433783">=</span>&nbsp;<span class="builtinfunc" id="3433785">append</span><span class="op" id="3433791">(</span><span class="ident" id="3433792">cookies</span><span class="op" id="3433799">,</span>&nbsp;<span class="ident" id="3433801">c</span><span class="op" id="3433802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3433805">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433808">return</span>&nbsp;<span class="ident" id="3433815">cookies</span><br>
<span class="lineno"></span><span class="op" id="3433823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3433826">//&nbsp;SetCookie&nbsp;adds&nbsp;a&nbsp;Set-Cookie&nbsp;header&nbsp;to&nbsp;the&nbsp;provided&nbsp;ResponseWriter&#39;s&nbsp;headers.</span><br>
<span class="lineno"></span><span class="keyword" id="3433906">func</span>&nbsp;<span class="ident" id="3433911">SetCookie</span><span class="op" id="3433920">(</span><span class="ident" id="3433921">w</span>&nbsp;<span class="ident" id="3433923">ResponseWriter</span><span class="op" id="3433937">,</span>&nbsp;<span class="ident" id="3433939">cookie</span>&nbsp;<span class="op" id="3433946">*</span><span class="ident" id="3433947">Cookie</span><span class="op" id="3433953">)</span>&nbsp;<span class="op" id="3433955">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433958">w</span><span class="op" id="3433959">.</span><span class="ident" id="3433960">Header</span><span class="op" id="3433966">(</span><span class="op" id="3433967">)</span><span class="op" id="3433968">.</span><span class="ident" id="3433969">Add</span><span class="op" id="3433972">(</span><span class="string" id="3433973">&#34;Set-Cookie&#34;</span><span class="op" id="3433985">,</span>&nbsp;<span class="ident" id="3433987">cookie</span><span class="op" id="3433993">.</span><span class="ident" id="3433994">String</span><span class="op" id="3434000">(</span><span class="op" id="3434001">)</span><span class="op" id="3434002">)</span><br>
<span class="lineno"></span><span class="op" id="3434004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3434007">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;serialization&nbsp;of&nbsp;the&nbsp;cookie&nbsp;for&nbsp;use&nbsp;in&nbsp;a&nbsp;Cookie</span><br>
<span class="lineno"></span><span class="comment" id="3434077">//&nbsp;header&nbsp;(if&nbsp;only&nbsp;Name&nbsp;and&nbsp;Value&nbsp;are&nbsp;set)&nbsp;or&nbsp;a&nbsp;Set-Cookie&nbsp;response</span><br>
<span class="lineno">135</span><span class="comment" id="3434145">//&nbsp;header&nbsp;(if&nbsp;other&nbsp;fields&nbsp;are&nbsp;set).</span><br>
<span class="lineno"></span><span class="keyword" id="3434182">func</span>&nbsp;<span class="op" id="3434187">(</span><span class="ident" id="3434188">c</span>&nbsp;<span class="op" id="3434190">*</span><span class="ident" id="3434191">Cookie</span><span class="op" id="3434197">)</span>&nbsp;<span class="ident" id="3434199">String</span><span class="op" id="3434205">(</span><span class="op" id="3434206">)</span>&nbsp;<span class="builtintype" id="3434208">string</span>&nbsp;<span class="op" id="3434215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3434218">var</span>&nbsp;<span class="ident" id="3434222">b</span>&nbsp;<span class="ident" id="3434224">bytes</span><span class="op" id="3434229">.</span><span class="ident" id="3434230">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434238">fmt</span><span class="op" id="3434241">.</span><span class="ident" id="3434242">Fprintf</span><span class="op" id="3434249">(</span><span class="op" id="3434250">&amp;</span><span class="ident" id="3434251">b</span><span class="op" id="3434252">,</span>&nbsp;<span class="string" id="3434254">&#34;%s=%s&#34;</span><span class="op" id="3434261">,</span>&nbsp;<span class="ident" id="3434263">sanitizeCookieName</span><span class="op" id="3434281">(</span><span class="ident" id="3434282">c</span><span class="op" id="3434283">.</span><span class="ident" id="3434284">Name</span><span class="op" id="3434288">)</span><span class="op" id="3434289">,</span>&nbsp;<span class="ident" id="3434291">sanitizeCookieValue</span><span class="op" id="3434310">(</span><span class="ident" id="3434311">c</span><span class="op" id="3434312">.</span><span class="ident" id="3434313">Value</span><span class="op" id="3434318">)</span><span class="op" id="3434319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3434322">if</span>&nbsp;<span class="builtinfunc" id="3434325">len</span><span class="op" id="3434328">(</span><span class="ident" id="3434329">c</span><span class="op" id="3434330">.</span><span class="ident" id="3434331">Path</span><span class="op" id="3434335">)</span>&nbsp;<span class="op" id="3434337">&gt;</span>&nbsp;<span class="num" id="3434339">0</span>&nbsp;<span class="op" id="3434341">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434345">fmt</span><span class="op" id="3434348">.</span><span class="ident" id="3434349">Fprintf</span><span class="op" id="3434356">(</span><span class="op" id="3434357">&amp;</span><span class="ident" id="3434358">b</span><span class="op" id="3434359">,</span>&nbsp;<span class="string" id="3434361">&#34;;&nbsp;Path=%s&#34;</span><span class="op" id="3434372">,</span>&nbsp;<span class="ident" id="3434374">sanitizeCookiePath</span><span class="op" id="3434392">(</span><span class="ident" id="3434393">c</span><span class="op" id="3434394">.</span><span class="ident" id="3434395">Path</span><span class="op" id="3434399">)</span><span class="op" id="3434400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3434403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3434406">if</span>&nbsp;<span class="builtinfunc" id="3434409">len</span><span class="op" id="3434412">(</span><span class="ident" id="3434413">c</span><span class="op" id="3434414">.</span><span class="ident" id="3434415">Domain</span><span class="op" id="3434421">)</span>&nbsp;<span class="op" id="3434423">&gt;</span>&nbsp;<span class="num" id="3434425">0</span>&nbsp;<span class="op" id="3434427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3434431">if</span>&nbsp;<span class="ident" id="3434434">validCookieDomain</span><span class="op" id="3434451">(</span><span class="ident" id="3434452">c</span><span class="op" id="3434453">.</span><span class="ident" id="3434454">Domain</span><span class="op" id="3434460">)</span>&nbsp;<span class="op" id="3434462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3434467">//&nbsp;A&nbsp;c.Domain&nbsp;containing&nbsp;illegal&nbsp;characters&nbsp;is&nbsp;not</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3434521">//&nbsp;sanitized&nbsp;but&nbsp;simply&nbsp;dropped&nbsp;which&nbsp;turns&nbsp;the&nbsp;cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3434579">//&nbsp;into&nbsp;a&nbsp;host-only&nbsp;cookie.&nbsp;A&nbsp;leading&nbsp;dot&nbsp;is&nbsp;okay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3434632">//&nbsp;but&nbsp;won&#39;t&nbsp;be&nbsp;sent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434657">d</span>&nbsp;<span class="op" id="3434659">:=</span>&nbsp;<span class="ident" id="3434662">c</span><span class="op" id="3434663">.</span><span class="ident" id="3434664">Domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3434674">if</span>&nbsp;<span class="ident" id="3434677">d</span><span class="op" id="3434678">[</span><span class="num" id="3434679">0</span><span class="op" id="3434680">]</span>&nbsp;<span class="op" id="3434682">==</span>&nbsp;<span class="string" id="3434685">&#39;.&#39;</span>&nbsp;<span class="op" id="3434689">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434695">d</span>&nbsp;<span class="op" id="3434697">=</span>&nbsp;<span class="ident" id="3434699">d</span><span class="op" id="3434700">[</span><span class="num" id="3434701">1</span><span class="op" id="3434702">:</span><span class="op" id="3434703">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3434708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434713">fmt</span><span class="op" id="3434716">.</span><span class="ident" id="3434717">Fprintf</span><span class="op" id="3434724">(</span><span class="op" id="3434725">&amp;</span><span class="ident" id="3434726">b</span><span class="op" id="3434727">,</span>&nbsp;<span class="string" id="3434729">&#34;;&nbsp;Domain=%s&#34;</span><span class="op" id="3434742">,</span>&nbsp;<span class="ident" id="3434744">d</span><span class="op" id="3434745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3434749">}</span>&nbsp;<span class="keyword" id="3434751">else</span>&nbsp;<span class="op" id="3434756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434761">log</span><span class="op" id="3434764">.</span><span class="ident" id="3434765">Printf</span><span class="op" id="3434771">(</span><span class="string" id="3434772">&#34;net/http:&nbsp;invalid&nbsp;Cookie.Domain&nbsp;%q;&nbsp;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="3434835">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434841">c</span><span class="op" id="3434842">.</span><span class="ident" id="3434843">Domain</span><span class="op" id="3434849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3434853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3434856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3434859">if</span>&nbsp;<span class="ident" id="3434862">c</span><span class="op" id="3434863">.</span><span class="ident" id="3434864">Expires</span><span class="op" id="3434871">.</span><span class="ident" id="3434872">Unix</span><span class="op" id="3434876">(</span><span class="op" id="3434877">)</span>&nbsp;<span class="op" id="3434879">&gt;</span>&nbsp;<span class="num" id="3434881">0</span>&nbsp;<span class="op" id="3434883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434887">fmt</span><span class="op" id="3434890">.</span><span class="ident" id="3434891">Fprintf</span><span class="op" id="3434898">(</span><span class="op" id="3434899">&amp;</span><span class="ident" id="3434900">b</span><span class="op" id="3434901">,</span>&nbsp;<span class="string" id="3434903">&#34;;&nbsp;Expires=%s&#34;</span><span class="op" id="3434917">,</span>&nbsp;<span class="ident" id="3434919">c</span><span class="op" id="3434920">.</span><span class="ident" id="3434921">Expires</span><span class="op" id="3434928">.</span><span class="ident" id="3434929">UTC</span><span class="op" id="3434932">(</span><span class="op" id="3434933">)</span><span class="op" id="3434934">.</span><span class="ident" id="3434935">Format</span><span class="op" id="3434941">(</span><span class="ident" id="3434942">time</span><span class="op" id="3434946">.</span><span class="ident" id="3434947">RFC1123</span><span class="op" id="3434954">)</span><span class="op" id="3434955">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3434958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3434961">if</span>&nbsp;<span class="ident" id="3434964">c</span><span class="op" id="3434965">.</span><span class="ident" id="3434966">MaxAge</span>&nbsp;<span class="op" id="3434973">&gt;</span>&nbsp;<span class="num" id="3434975">0</span>&nbsp;<span class="op" id="3434977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434981">fmt</span><span class="op" id="3434984">.</span><span class="ident" id="3434985">Fprintf</span><span class="op" id="3434992">(</span><span class="op" id="3434993">&amp;</span><span class="ident" id="3434994">b</span><span class="op" id="3434995">,</span>&nbsp;<span class="string" id="3434997">&#34;;&nbsp;Max-Age=%d&#34;</span><span class="op" id="3435011">,</span>&nbsp;<span class="ident" id="3435013">c</span><span class="op" id="3435014">.</span><span class="ident" id="3435015">MaxAge</span><span class="op" id="3435021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435024">}</span>&nbsp;<span class="keyword" id="3435026">else</span>&nbsp;<span class="keyword" id="3435031">if</span>&nbsp;<span class="ident" id="3435034">c</span><span class="op" id="3435035">.</span><span class="ident" id="3435036">MaxAge</span>&nbsp;<span class="op" id="3435043">&lt;</span>&nbsp;<span class="num" id="3435045">0</span>&nbsp;<span class="op" id="3435047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435051">fmt</span><span class="op" id="3435054">.</span><span class="ident" id="3435055">Fprintf</span><span class="op" id="3435062">(</span><span class="op" id="3435063">&amp;</span><span class="ident" id="3435064">b</span><span class="op" id="3435065">,</span>&nbsp;<span class="string" id="3435067">&#34;;&nbsp;Max-Age=0&#34;</span><span class="op" id="3435080">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435086">if</span>&nbsp;<span class="ident" id="3435089">c</span><span class="op" id="3435090">.</span><span class="ident" id="3435091">HttpOnly</span>&nbsp;<span class="op" id="3435100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435104">fmt</span><span class="op" id="3435107">.</span><span class="ident" id="3435108">Fprintf</span><span class="op" id="3435115">(</span><span class="op" id="3435116">&amp;</span><span class="ident" id="3435117">b</span><span class="op" id="3435118">,</span>&nbsp;<span class="string" id="3435120">&#34;;&nbsp;HttpOnly&#34;</span><span class="op" id="3435132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435138">if</span>&nbsp;<span class="ident" id="3435141">c</span><span class="op" id="3435142">.</span><span class="ident" id="3435143">Secure</span>&nbsp;<span class="op" id="3435150">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435154">fmt</span><span class="op" id="3435157">.</span><span class="ident" id="3435158">Fprintf</span><span class="op" id="3435165">(</span><span class="op" id="3435166">&amp;</span><span class="ident" id="3435167">b</span><span class="op" id="3435168">,</span>&nbsp;<span class="string" id="3435170">&#34;;&nbsp;Secure&#34;</span><span class="op" id="3435180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435186">return</span>&nbsp;<span class="ident" id="3435193">b</span><span class="op" id="3435194">.</span><span class="ident" id="3435195">String</span><span class="op" id="3435201">(</span><span class="op" id="3435202">)</span><br>
<span class="lineno"></span><span class="op" id="3435204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="3435207">//&nbsp;readCookies&nbsp;parses&nbsp;all&nbsp;&#34;Cookie&#34;&nbsp;values&nbsp;from&nbsp;the&nbsp;header&nbsp;h&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3435271">//&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="comment" id="3435315">//</span><br>
<span class="lineno"></span><span class="comment" id="3435318">//&nbsp;if&nbsp;filter&nbsp;isn&#39;t&nbsp;empty,&nbsp;only&nbsp;cookies&nbsp;of&nbsp;that&nbsp;name&nbsp;are&nbsp;returned</span><br>
<span class="lineno"></span><span class="keyword" id="3435383">func</span>&nbsp;<span class="ident" id="3435388">readCookies</span><span class="op" id="3435399">(</span><span class="ident" id="3435400">h</span>&nbsp;<span class="ident" id="3435402">Header</span><span class="op" id="3435408">,</span>&nbsp;<span class="ident" id="3435410">filter</span>&nbsp;<span class="builtintype" id="3435417">string</span><span class="op" id="3435423">)</span>&nbsp;<span class="op" id="3435425">[</span><span class="op" id="3435426">]</span><span class="op" id="3435427">*</span><span class="ident" id="3435428">Cookie</span>&nbsp;<span class="op" id="3435435">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435438">cookies</span>&nbsp;<span class="op" id="3435446">:=</span>&nbsp;<span class="op" id="3435449">[</span><span class="op" id="3435450">]</span><span class="op" id="3435451">*</span><span class="ident" id="3435452">Cookie</span><span class="op" id="3435458">{</span><span class="op" id="3435459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435462">lines</span><span class="op" id="3435467">,</span>&nbsp;<span class="ident" id="3435469">ok</span>&nbsp;<span class="op" id="3435472">:=</span>&nbsp;<span class="ident" id="3435475">h</span><span class="op" id="3435476">[</span><span class="string" id="3435477">&#34;Cookie&#34;</span><span class="op" id="3435485">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435488">if</span>&nbsp;<span class="op" id="3435491">!</span><span class="ident" id="3435492">ok</span>&nbsp;<span class="op" id="3435495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435499">return</span>&nbsp;<span class="ident" id="3435506">cookies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435515">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435519">for</span>&nbsp;<span class="ident" id="3435523">_</span><span class="op" id="3435524">,</span>&nbsp;<span class="ident" id="3435526">line</span>&nbsp;<span class="op" id="3435531">:=</span>&nbsp;<span class="keyword" id="3435534">range</span>&nbsp;<span class="ident" id="3435540">lines</span>&nbsp;<span class="op" id="3435546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435550">parts</span>&nbsp;<span class="op" id="3435556">:=</span>&nbsp;<span class="ident" id="3435559">strings</span><span class="op" id="3435566">.</span><span class="ident" id="3435567">Split</span><span class="op" id="3435572">(</span><span class="ident" id="3435573">strings</span><span class="op" id="3435580">.</span><span class="ident" id="3435581">TrimSpace</span><span class="op" id="3435590">(</span><span class="ident" id="3435591">line</span><span class="op" id="3435595">)</span><span class="op" id="3435596">,</span>&nbsp;<span class="string" id="3435598">&#34;;&#34;</span><span class="op" id="3435601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435605">if</span>&nbsp;<span class="builtinfunc" id="3435608">len</span><span class="op" id="3435611">(</span><span class="ident" id="3435612">parts</span><span class="op" id="3435617">)</span>&nbsp;<span class="op" id="3435619">==</span>&nbsp;<span class="num" id="3435622">1</span>&nbsp;<span class="op" id="3435624">&amp;&amp;</span>&nbsp;<span class="ident" id="3435627">parts</span><span class="op" id="3435632">[</span><span class="num" id="3435633">0</span><span class="op" id="3435634">]</span>&nbsp;<span class="op" id="3435636">==</span>&nbsp;<span class="string" id="3435639">&#34;&#34;</span>&nbsp;<span class="op" id="3435642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435647">continue</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3435662">//&nbsp;Per-line&nbsp;attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435687">parsedPairs</span>&nbsp;<span class="op" id="3435699">:=</span>&nbsp;<span class="num" id="3435702">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435706">for</span>&nbsp;<span class="ident" id="3435710">i</span>&nbsp;<span class="op" id="3435712">:=</span>&nbsp;<span class="num" id="3435715">0</span><span class="op" id="3435716">;</span>&nbsp;<span class="ident" id="3435718">i</span>&nbsp;<span class="op" id="3435720">&lt;</span>&nbsp;<span class="builtinfunc" id="3435722">len</span><span class="op" id="3435725">(</span><span class="ident" id="3435726">parts</span><span class="op" id="3435731">)</span><span class="op" id="3435732">;</span>&nbsp;<span class="ident" id="3435734">i</span><span class="op" id="3435735">++</span>&nbsp;<span class="op" id="3435738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435743">parts</span><span class="op" id="3435748">[</span><span class="ident" id="3435749">i</span><span class="op" id="3435750">]</span>&nbsp;<span class="op" id="3435752">=</span>&nbsp;<span class="ident" id="3435754">strings</span><span class="op" id="3435761">.</span><span class="ident" id="3435762">TrimSpace</span><span class="op" id="3435771">(</span><span class="ident" id="3435772">parts</span><span class="op" id="3435777">[</span><span class="ident" id="3435778">i</span><span class="op" id="3435779">]</span><span class="op" id="3435780">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435785">if</span>&nbsp;<span class="builtinfunc" id="3435788">len</span><span class="op" id="3435791">(</span><span class="ident" id="3435792">parts</span><span class="op" id="3435797">[</span><span class="ident" id="3435798">i</span><span class="op" id="3435799">]</span><span class="op" id="3435800">)</span>&nbsp;<span class="op" id="3435802">==</span>&nbsp;<span class="num" id="3435805">0</span>&nbsp;<span class="op" id="3435807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435813">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435830">name</span><span class="op" id="3435834">,</span>&nbsp;<span class="ident" id="3435836">val</span>&nbsp;<span class="op" id="3435840">:=</span>&nbsp;<span class="ident" id="3435843">parts</span><span class="op" id="3435848">[</span><span class="ident" id="3435849">i</span><span class="op" id="3435850">]</span><span class="op" id="3435851">,</span>&nbsp;<span class="string" id="3435853">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435859">if</span>&nbsp;<span class="ident" id="3435862">j</span>&nbsp;<span class="op" id="3435864">:=</span>&nbsp;<span class="ident" id="3435867">strings</span><span class="op" id="3435874">.</span><span class="ident" id="3435875">Index</span><span class="op" id="3435880">(</span><span class="ident" id="3435881">name</span><span class="op" id="3435885">,</span>&nbsp;<span class="string" id="3435887">&#34;=&#34;</span><span class="op" id="3435890">)</span><span class="op" id="3435891">;</span>&nbsp;<span class="ident" id="3435893">j</span>&nbsp;<span class="op" id="3435895">&gt;=</span>&nbsp;<span class="num" id="3435898">0</span>&nbsp;<span class="op" id="3435900">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435906">name</span><span class="op" id="3435910">,</span>&nbsp;<span class="ident" id="3435912">val</span>&nbsp;<span class="op" id="3435916">=</span>&nbsp;<span class="ident" id="3435918">name</span><span class="op" id="3435922">[</span><span class="op" id="3435923">:</span><span class="ident" id="3435924">j</span><span class="op" id="3435925">]</span><span class="op" id="3435926">,</span>&nbsp;<span class="ident" id="3435928">name</span><span class="op" id="3435932">[</span><span class="ident" id="3435933">j</span><span class="op" id="3435934">+</span><span class="num" id="3435935">1</span><span class="op" id="3435936">:</span><span class="op" id="3435937">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435947">if</span>&nbsp;<span class="op" id="3435950">!</span><span class="ident" id="3435951">isCookieNameValid</span><span class="op" id="3435968">(</span><span class="ident" id="3435969">name</span><span class="op" id="3435973">)</span>&nbsp;<span class="op" id="3435975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435981">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435993">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435998">if</span>&nbsp;<span class="ident" id="3436001">filter</span>&nbsp;<span class="op" id="3436008">!=</span>&nbsp;<span class="string" id="3436011">&#34;&#34;</span>&nbsp;<span class="op" id="3436014">&amp;&amp;</span>&nbsp;<span class="ident" id="3436017">filter</span>&nbsp;<span class="op" id="3436024">!=</span>&nbsp;<span class="ident" id="3436027">name</span>&nbsp;<span class="op" id="3436032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436038">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3436050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3436055">val</span><span class="op" id="3436058">,</span>&nbsp;<span class="ident" id="3436060">success</span>&nbsp;<span class="op" id="3436068">:=</span>&nbsp;<span class="ident" id="3436071">parseCookieValue</span><span class="op" id="3436087">(</span><span class="ident" id="3436088">val</span><span class="op" id="3436091">,</span>&nbsp;<span class="builtintype" id="3436093">true</span><span class="op" id="3436097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436102">if</span>&nbsp;<span class="op" id="3436105">!</span><span class="ident" id="3436106">success</span>&nbsp;<span class="op" id="3436114">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436120">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3436132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3436137">cookies</span>&nbsp;<span class="op" id="3436145">=</span>&nbsp;<span class="builtinfunc" id="3436147">append</span><span class="op" id="3436153">(</span><span class="ident" id="3436154">cookies</span><span class="op" id="3436161">,</span>&nbsp;<span class="op" id="3436163">&amp;</span><span class="ident" id="3436164">Cookie</span><span class="op" id="3436170">{</span><span class="ident" id="3436171">Name</span><span class="op" id="3436175">:</span>&nbsp;<span class="ident" id="3436177">name</span><span class="op" id="3436181">,</span>&nbsp;<span class="ident" id="3436183">Value</span><span class="op" id="3436188">:</span>&nbsp;<span class="ident" id="3436190">val</span><span class="op" id="3436193">}</span><span class="op" id="3436194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3436199">parsedPairs</span><span class="op" id="3436210">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3436215">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3436218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436221">return</span>&nbsp;<span class="ident" id="3436228">cookies</span><br>
<span class="lineno"></span><span class="op" id="3436236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3436239">//&nbsp;validCookieDomain&nbsp;returns&nbsp;wheter&nbsp;v&nbsp;is&nbsp;a&nbsp;valid&nbsp;cookie&nbsp;domain-value.</span><br>
<span class="lineno">220</span><span class="keyword" id="3436309">func</span>&nbsp;<span class="ident" id="3436314">validCookieDomain</span><span class="op" id="3436331">(</span><span class="ident" id="3436332">v</span>&nbsp;<span class="builtintype" id="3436334">string</span><span class="op" id="3436340">)</span>&nbsp;<span class="builtintype" id="3436342">bool</span>&nbsp;<span class="op" id="3436347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436350">if</span>&nbsp;<span class="ident" id="3436353">isCookieDomainName</span><span class="op" id="3436371">(</span><span class="ident" id="3436372">v</span><span class="op" id="3436373">)</span>&nbsp;<span class="op" id="3436375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436379">return</span>&nbsp;<span class="builtintype" id="3436386">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3436392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436395">if</span>&nbsp;<span class="ident" id="3436398">net</span><span class="op" id="3436401">.</span><span class="ident" id="3436402">ParseIP</span><span class="op" id="3436409">(</span><span class="ident" id="3436410">v</span><span class="op" id="3436411">)</span>&nbsp;<span class="op" id="3436413">!=</span>&nbsp;<span class="ident" id="3436416">nil</span>&nbsp;<span class="op" id="3436420">&amp;&amp;</span>&nbsp;<span class="op" id="3436423">!</span><span class="ident" id="3436424">strings</span><span class="op" id="3436431">.</span><span class="ident" id="3436432">Contains</span><span class="op" id="3436440">(</span><span class="ident" id="3436441">v</span><span class="op" id="3436442">,</span>&nbsp;<span class="string" id="3436444">&#34;:&#34;</span><span class="op" id="3436447">)</span>&nbsp;<span class="op" id="3436449">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436453">return</span>&nbsp;<span class="builtintype" id="3436460">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3436466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436469">return</span>&nbsp;<span class="builtintype" id="3436476">false</span><br>
<span class="lineno"></span><span class="op" id="3436482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="comment" id="3436485">//&nbsp;isCookieDomainName&nbsp;returns&nbsp;whether&nbsp;s&nbsp;is&nbsp;a&nbsp;valid&nbsp;domain&nbsp;name&nbsp;or&nbsp;a&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="3436559">//&nbsp;domain&nbsp;name&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot&nbsp;&#39;.&#39;.&nbsp;&nbsp;It&nbsp;is&nbsp;almost&nbsp;a&nbsp;direct&nbsp;copy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3436629">//&nbsp;package&nbsp;net&#39;s&nbsp;isDomainName.</span><br>
<span class="lineno"></span><span class="keyword" id="3436660">func</span>&nbsp;<span class="ident" id="3436665">isCookieDomainName</span><span class="op" id="3436683">(</span><span class="ident" id="3436684">s</span>&nbsp;<span class="builtintype" id="3436686">string</span><span class="op" id="3436692">)</span>&nbsp;<span class="builtintype" id="3436694">bool</span>&nbsp;<span class="op" id="3436699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436702">if</span>&nbsp;<span class="builtinfunc" id="3436705">len</span><span class="op" id="3436708">(</span><span class="ident" id="3436709">s</span><span class="op" id="3436710">)</span>&nbsp;<span class="op" id="3436712">==</span>&nbsp;<span class="num" id="3436715">0</span>&nbsp;<span class="op" id="3436717">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436721">return</span>&nbsp;<span class="builtintype" id="3436728">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3436735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436738">if</span>&nbsp;<span class="builtinfunc" id="3436741">len</span><span class="op" id="3436744">(</span><span class="ident" id="3436745">s</span><span class="op" id="3436746">)</span>&nbsp;<span class="op" id="3436748">&gt;</span>&nbsp;<span class="num" id="3436750">255</span>&nbsp;<span class="op" id="3436754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436758">return</span>&nbsp;<span class="builtintype" id="3436765">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3436772">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436776">if</span>&nbsp;<span class="ident" id="3436779">s</span><span class="op" id="3436780">[</span><span class="num" id="3436781">0</span><span class="op" id="3436782">]</span>&nbsp;<span class="op" id="3436784">==</span>&nbsp;<span class="string" id="3436787">&#39;.&#39;</span>&nbsp;<span class="op" id="3436791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3436795">//&nbsp;A&nbsp;cookie&nbsp;a&nbsp;domain&nbsp;attribute&nbsp;may&nbsp;start&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3436858">s</span>&nbsp;<span class="op" id="3436860">=</span>&nbsp;<span class="ident" id="3436862">s</span><span class="op" id="3436863">[</span><span class="num" id="3436864">1</span><span class="op" id="3436865">:</span><span class="op" id="3436866">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3436869">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3436872">last</span>&nbsp;<span class="op" id="3436877">:=</span>&nbsp;<span class="builtintype" id="3436880">byte</span><span class="op" id="3436884">(</span><span class="string" id="3436885">&#39;.&#39;</span><span class="op" id="3436888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3436891">ok</span>&nbsp;<span class="op" id="3436894">:=</span>&nbsp;<span class="builtintype" id="3436897">false</span>&nbsp;<span class="comment" id="3436903">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3436936">partlen</span>&nbsp;<span class="op" id="3436944">:=</span>&nbsp;<span class="num" id="3436947">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436950">for</span>&nbsp;<span class="ident" id="3436954">i</span>&nbsp;<span class="op" id="3436956">:=</span>&nbsp;<span class="num" id="3436959">0</span><span class="op" id="3436960">;</span>&nbsp;<span class="ident" id="3436962">i</span>&nbsp;<span class="op" id="3436964">&lt;</span>&nbsp;<span class="builtinfunc" id="3436966">len</span><span class="op" id="3436969">(</span><span class="ident" id="3436970">s</span><span class="op" id="3436971">)</span><span class="op" id="3436972">;</span>&nbsp;<span class="ident" id="3436974">i</span><span class="op" id="3436975">++</span>&nbsp;<span class="op" id="3436978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3436982">c</span>&nbsp;<span class="op" id="3436984">:=</span>&nbsp;<span class="ident" id="3436987">s</span><span class="op" id="3436988">[</span><span class="ident" id="3436989">i</span><span class="op" id="3436990">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436994">switch</span>&nbsp;<span class="op" id="3437001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437005">default</span><span class="op" id="3437012">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437017">return</span>&nbsp;<span class="builtintype" id="3437024">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437032">case</span>&nbsp;<span class="string" id="3437037">&#39;a&#39;</span>&nbsp;<span class="op" id="3437041">&lt;=</span>&nbsp;<span class="ident" id="3437044">c</span>&nbsp;<span class="op" id="3437046">&amp;&amp;</span>&nbsp;<span class="ident" id="3437049">c</span>&nbsp;<span class="op" id="3437051">&lt;=</span>&nbsp;<span class="string" id="3437054">&#39;z&#39;</span>&nbsp;<span class="op" id="3437058">||</span>&nbsp;<span class="string" id="3437061">&#39;A&#39;</span>&nbsp;<span class="op" id="3437065">&lt;=</span>&nbsp;<span class="ident" id="3437068">c</span>&nbsp;<span class="op" id="3437070">&amp;&amp;</span>&nbsp;<span class="ident" id="3437073">c</span>&nbsp;<span class="op" id="3437075">&lt;=</span>&nbsp;<span class="string" id="3437078">&#39;Z&#39;</span><span class="op" id="3437081">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3437086">//&nbsp;No&nbsp;&#39;_&#39;&nbsp;allowed&nbsp;here&nbsp;(in&nbsp;contrast&nbsp;to&nbsp;package&nbsp;net).</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3437142">ok</span>&nbsp;<span class="op" id="3437145">=</span>&nbsp;<span class="builtintype" id="3437147">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3437155">partlen</span><span class="op" id="3437162">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437167">case</span>&nbsp;<span class="string" id="3437172">&#39;0&#39;</span>&nbsp;<span class="op" id="3437176">&lt;=</span>&nbsp;<span class="ident" id="3437179">c</span>&nbsp;<span class="op" id="3437181">&amp;&amp;</span>&nbsp;<span class="ident" id="3437184">c</span>&nbsp;<span class="op" id="3437186">&lt;=</span>&nbsp;<span class="string" id="3437189">&#39;9&#39;</span><span class="op" id="3437192">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3437197">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3437208">partlen</span><span class="op" id="3437215">++</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437220">case</span>&nbsp;<span class="ident" id="3437225">c</span>&nbsp;<span class="op" id="3437227">==</span>&nbsp;<span class="string" id="3437230">&#39;-&#39;</span><span class="op" id="3437233">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3437238">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437276">if</span>&nbsp;<span class="ident" id="3437279">last</span>&nbsp;<span class="op" id="3437284">==</span>&nbsp;<span class="string" id="3437287">&#39;.&#39;</span>&nbsp;<span class="op" id="3437291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437297">return</span>&nbsp;<span class="builtintype" id="3437304">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3437313">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3437318">partlen</span><span class="op" id="3437325">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437330">case</span>&nbsp;<span class="ident" id="3437335">c</span>&nbsp;<span class="op" id="3437337">==</span>&nbsp;<span class="string" id="3437340">&#39;.&#39;</span><span class="op" id="3437343">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3437348">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437391">if</span>&nbsp;<span class="ident" id="3437394">last</span>&nbsp;<span class="op" id="3437399">==</span>&nbsp;<span class="string" id="3437402">&#39;.&#39;</span>&nbsp;<span class="op" id="3437406">||</span>&nbsp;<span class="ident" id="3437409">last</span>&nbsp;<span class="op" id="3437414">==</span>&nbsp;<span class="string" id="3437417">&#39;-&#39;</span>&nbsp;<span class="op" id="3437421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437427">return</span>&nbsp;<span class="builtintype" id="3437434">false</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3437443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437448">if</span>&nbsp;<span class="ident" id="3437451">partlen</span>&nbsp;<span class="op" id="3437459">&gt;</span>&nbsp;<span class="num" id="3437461">63</span>&nbsp;<span class="op" id="3437464">||</span>&nbsp;<span class="ident" id="3437467">partlen</span>&nbsp;<span class="op" id="3437475">==</span>&nbsp;<span class="num" id="3437478">0</span>&nbsp;<span class="op" id="3437480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437486">return</span>&nbsp;<span class="builtintype" id="3437493">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3437502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3437507">partlen</span>&nbsp;<span class="op" id="3437515">=</span>&nbsp;<span class="num" id="3437517">0</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3437521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3437525">last</span>&nbsp;<span class="op" id="3437530">=</span>&nbsp;<span class="ident" id="3437532">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3437535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437538">if</span>&nbsp;<span class="ident" id="3437541">last</span>&nbsp;<span class="op" id="3437546">==</span>&nbsp;<span class="string" id="3437549">&#39;-&#39;</span>&nbsp;<span class="op" id="3437553">||</span>&nbsp;<span class="ident" id="3437556">partlen</span>&nbsp;<span class="op" id="3437564">&gt;</span>&nbsp;<span class="num" id="3437566">63</span>&nbsp;<span class="op" id="3437569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437573">return</span>&nbsp;<span class="builtintype" id="3437580">false</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3437587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437591">return</span>&nbsp;<span class="ident" id="3437598">ok</span><br>
<span class="lineno"></span><span class="op" id="3437601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="3437604">var</span>&nbsp;<span class="ident" id="3437608">cookieNameSanitizer</span>&nbsp;<span class="op" id="3437628">=</span>&nbsp;<span class="ident" id="3437630">strings</span><span class="op" id="3437637">.</span><span class="ident" id="3437638">NewReplacer</span><span class="op" id="3437649">(</span><span class="string" id="3437650">&#34;\n&#34;</span><span class="op" id="3437654">,</span>&nbsp;<span class="string" id="3437656">&#34;-&#34;</span><span class="op" id="3437659">,</span>&nbsp;<span class="string" id="3437661">&#34;\r&#34;</span><span class="op" id="3437665">,</span>&nbsp;<span class="string" id="3437667">&#34;-&#34;</span><span class="op" id="3437670">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3437673">func</span>&nbsp;<span class="ident" id="3437678">sanitizeCookieName</span><span class="op" id="3437696">(</span><span class="ident" id="3437697">n</span>&nbsp;<span class="builtintype" id="3437699">string</span><span class="op" id="3437705">)</span>&nbsp;<span class="builtintype" id="3437707">string</span>&nbsp;<span class="op" id="3437714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437717">return</span>&nbsp;<span class="ident" id="3437724">cookieNameSanitizer</span><span class="op" id="3437743">.</span><span class="ident" id="3437744">Replace</span><span class="op" id="3437751">(</span><span class="ident" id="3437752">n</span><span class="op" id="3437753">)</span><br>
<span class="lineno"></span><span class="op" id="3437755">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="3437758">//&nbsp;http://tools.ietf.org/html/rfc6265#section-4.1.1</span><br>
<span class="lineno"></span><span class="comment" id="3437810">//&nbsp;cookie-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;*cookie-octet&nbsp;/&nbsp;(&nbsp;DQUOTE&nbsp;*cookie-octet&nbsp;DQUOTE&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="3437881">//&nbsp;cookie-octet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;%x21&nbsp;/&nbsp;%x23-2B&nbsp;/&nbsp;%x2D-3A&nbsp;/&nbsp;%x3C-5B&nbsp;/&nbsp;%x5D-7E</span><br>
<span class="lineno"></span><span class="comment" id="3437949">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;US-ASCII&nbsp;characters&nbsp;excluding&nbsp;CTLs,</span><br>
<span class="lineno">295</span><span class="comment" id="3438000">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;whitespace&nbsp;DQUOTE,&nbsp;comma,&nbsp;semicolon,</span><br>
<span class="lineno"></span><span class="comment" id="3438052">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;and&nbsp;backslash</span><br>
<span class="lineno"></span><span class="comment" id="3438081">//&nbsp;We&nbsp;loosen&nbsp;this&nbsp;as&nbsp;spaces&nbsp;and&nbsp;commas&nbsp;are&nbsp;common&nbsp;in&nbsp;cookie&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="3438148">//&nbsp;but&nbsp;we&nbsp;produce&nbsp;a&nbsp;quoted&nbsp;cookie-value&nbsp;in&nbsp;when&nbsp;value&nbsp;starts&nbsp;or&nbsp;ends</span><br>
<span class="lineno"></span><span class="comment" id="3438217">//&nbsp;with&nbsp;a&nbsp;comma&nbsp;or&nbsp;space.</span><br>
<span class="lineno">300</span><span class="comment" id="3438243">//&nbsp;See&nbsp;http://golang.org/issue/7243&nbsp;for&nbsp;the&nbsp;discussion.</span><br>
<span class="lineno"></span><span class="keyword" id="3438299">func</span>&nbsp;<span class="ident" id="3438304">sanitizeCookieValue</span><span class="op" id="3438323">(</span><span class="ident" id="3438324">v</span>&nbsp;<span class="builtintype" id="3438326">string</span><span class="op" id="3438332">)</span>&nbsp;<span class="builtintype" id="3438334">string</span>&nbsp;<span class="op" id="3438341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3438344">v</span>&nbsp;<span class="op" id="3438346">=</span>&nbsp;<span class="ident" id="3438348">sanitizeOrWarn</span><span class="op" id="3438362">(</span><span class="string" id="3438363">&#34;Cookie.Value&#34;</span><span class="op" id="3438377">,</span>&nbsp;<span class="ident" id="3438379">validCookieValueByte</span><span class="op" id="3438399">,</span>&nbsp;<span class="ident" id="3438401">v</span><span class="op" id="3438402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438405">if</span>&nbsp;<span class="builtinfunc" id="3438408">len</span><span class="op" id="3438411">(</span><span class="ident" id="3438412">v</span><span class="op" id="3438413">)</span>&nbsp;<span class="op" id="3438415">==</span>&nbsp;<span class="num" id="3438418">0</span>&nbsp;<span class="op" id="3438420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438424">return</span>&nbsp;<span class="ident" id="3438431">v</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3438434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438437">if</span>&nbsp;<span class="ident" id="3438440">v</span><span class="op" id="3438441">[</span><span class="num" id="3438442">0</span><span class="op" id="3438443">]</span>&nbsp;<span class="op" id="3438445">==</span>&nbsp;<span class="string" id="3438448">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3438452">||</span>&nbsp;<span class="ident" id="3438455">v</span><span class="op" id="3438456">[</span><span class="num" id="3438457">0</span><span class="op" id="3438458">]</span>&nbsp;<span class="op" id="3438460">==</span>&nbsp;<span class="string" id="3438463">&#39;,&#39;</span>&nbsp;<span class="op" id="3438467">||</span>&nbsp;<span class="ident" id="3438470">v</span><span class="op" id="3438471">[</span><span class="builtinfunc" id="3438472">len</span><span class="op" id="3438475">(</span><span class="ident" id="3438476">v</span><span class="op" id="3438477">)</span><span class="op" id="3438478">-</span><span class="num" id="3438479">1</span><span class="op" id="3438480">]</span>&nbsp;<span class="op" id="3438482">==</span>&nbsp;<span class="string" id="3438485">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3438489">||</span>&nbsp;<span class="ident" id="3438492">v</span><span class="op" id="3438493">[</span><span class="builtinfunc" id="3438494">len</span><span class="op" id="3438497">(</span><span class="ident" id="3438498">v</span><span class="op" id="3438499">)</span><span class="op" id="3438500">-</span><span class="num" id="3438501">1</span><span class="op" id="3438502">]</span>&nbsp;<span class="op" id="3438504">==</span>&nbsp;<span class="string" id="3438507">&#39;,&#39;</span>&nbsp;<span class="op" id="3438511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438515">return</span>&nbsp;<span class="string" id="3438522">`&#34;`</span>&nbsp;<span class="op" id="3438526">+</span>&nbsp;<span class="ident" id="3438528">v</span>&nbsp;<span class="op" id="3438530">+</span>&nbsp;<span class="string" id="3438532">`&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3438537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438540">return</span>&nbsp;<span class="ident" id="3438547">v</span><br>
<span class="lineno">310</span><span class="op" id="3438549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3438552">func</span>&nbsp;<span class="ident" id="3438557">validCookieValueByte</span><span class="op" id="3438577">(</span><span class="ident" id="3438578">b</span>&nbsp;<span class="builtintype" id="3438580">byte</span><span class="op" id="3438584">)</span>&nbsp;<span class="builtintype" id="3438586">bool</span>&nbsp;<span class="op" id="3438591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438594">return</span>&nbsp;<span class="num" id="3438601">0x20</span>&nbsp;<span class="op" id="3438606">&lt;=</span>&nbsp;<span class="ident" id="3438609">b</span>&nbsp;<span class="op" id="3438611">&amp;&amp;</span>&nbsp;<span class="ident" id="3438614">b</span>&nbsp;<span class="op" id="3438616">&lt;</span>&nbsp;<span class="num" id="3438618">0x7f</span>&nbsp;<span class="op" id="3438623">&amp;&amp;</span>&nbsp;<span class="ident" id="3438626">b</span>&nbsp;<span class="op" id="3438628">!=</span>&nbsp;<span class="string" id="3438631">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3438635">&amp;&amp;</span>&nbsp;<span class="ident" id="3438638">b</span>&nbsp;<span class="op" id="3438640">!=</span>&nbsp;<span class="string" id="3438643">&#39;;&#39;</span>&nbsp;<span class="op" id="3438647">&amp;&amp;</span>&nbsp;<span class="ident" id="3438650">b</span>&nbsp;<span class="op" id="3438652">!=</span>&nbsp;<span class="string" id="3438655">&#39;\\&#39;</span><br>
<span class="lineno"></span><span class="op" id="3438660">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="3438663">//&nbsp;path-av&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&#34;Path=&#34;&nbsp;path-value</span><br>
<span class="lineno"></span><span class="comment" id="3438705">//&nbsp;path-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;any&nbsp;CHAR&nbsp;except&nbsp;CTLs&nbsp;or&nbsp;&#34;;&#34;&gt;</span><br>
<span class="lineno"></span><span class="keyword" id="3438758">func</span>&nbsp;<span class="ident" id="3438763">sanitizeCookiePath</span><span class="op" id="3438781">(</span><span class="ident" id="3438782">v</span>&nbsp;<span class="builtintype" id="3438784">string</span><span class="op" id="3438790">)</span>&nbsp;<span class="builtintype" id="3438792">string</span>&nbsp;<span class="op" id="3438799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438802">return</span>&nbsp;<span class="ident" id="3438809">sanitizeOrWarn</span><span class="op" id="3438823">(</span><span class="string" id="3438824">&#34;Cookie.Path&#34;</span><span class="op" id="3438837">,</span>&nbsp;<span class="ident" id="3438839">validCookiePathByte</span><span class="op" id="3438858">,</span>&nbsp;<span class="ident" id="3438860">v</span><span class="op" id="3438861">)</span><br>
<span class="lineno">320</span><span class="op" id="3438863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3438866">func</span>&nbsp;<span class="ident" id="3438871">validCookiePathByte</span><span class="op" id="3438890">(</span><span class="ident" id="3438891">b</span>&nbsp;<span class="builtintype" id="3438893">byte</span><span class="op" id="3438897">)</span>&nbsp;<span class="builtintype" id="3438899">bool</span>&nbsp;<span class="op" id="3438904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438907">return</span>&nbsp;<span class="num" id="3438914">0x20</span>&nbsp;<span class="op" id="3438919">&lt;=</span>&nbsp;<span class="ident" id="3438922">b</span>&nbsp;<span class="op" id="3438924">&amp;&amp;</span>&nbsp;<span class="ident" id="3438927">b</span>&nbsp;<span class="op" id="3438929">&lt;</span>&nbsp;<span class="num" id="3438931">0x7f</span>&nbsp;<span class="op" id="3438936">&amp;&amp;</span>&nbsp;<span class="ident" id="3438939">b</span>&nbsp;<span class="op" id="3438941">!=</span>&nbsp;<span class="string" id="3438944">&#39;;&#39;</span><br>
<span class="lineno"></span><span class="op" id="3438948">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="3438951">func</span>&nbsp;<span class="ident" id="3438956">sanitizeOrWarn</span><span class="op" id="3438970">(</span><span class="ident" id="3438971">fieldName</span>&nbsp;<span class="builtintype" id="3438981">string</span><span class="op" id="3438987">,</span>&nbsp;<span class="ident" id="3438989">valid</span>&nbsp;<span class="keyword" id="3438995">func</span><span class="op" id="3438999">(</span><span class="builtintype" id="3439000">byte</span><span class="op" id="3439004">)</span>&nbsp;<span class="builtintype" id="3439006">bool</span><span class="op" id="3439010">,</span>&nbsp;<span class="ident" id="3439012">v</span>&nbsp;<span class="builtintype" id="3439014">string</span><span class="op" id="3439020">)</span>&nbsp;<span class="builtintype" id="3439022">string</span>&nbsp;<span class="op" id="3439029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3439032">ok</span>&nbsp;<span class="op" id="3439035">:=</span>&nbsp;<span class="builtintype" id="3439038">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439044">for</span>&nbsp;<span class="ident" id="3439048">i</span>&nbsp;<span class="op" id="3439050">:=</span>&nbsp;<span class="num" id="3439053">0</span><span class="op" id="3439054">;</span>&nbsp;<span class="ident" id="3439056">i</span>&nbsp;<span class="op" id="3439058">&lt;</span>&nbsp;<span class="builtinfunc" id="3439060">len</span><span class="op" id="3439063">(</span><span class="ident" id="3439064">v</span><span class="op" id="3439065">)</span><span class="op" id="3439066">;</span>&nbsp;<span class="ident" id="3439068">i</span><span class="op" id="3439069">++</span>&nbsp;<span class="op" id="3439072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439076">if</span>&nbsp;<span class="ident" id="3439079">valid</span><span class="op" id="3439084">(</span><span class="ident" id="3439085">v</span><span class="op" id="3439086">[</span><span class="ident" id="3439087">i</span><span class="op" id="3439088">]</span><span class="op" id="3439089">)</span>&nbsp;<span class="op" id="3439091">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439096">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3439107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3439111">log</span><span class="op" id="3439114">.</span><span class="ident" id="3439115">Printf</span><span class="op" id="3439121">(</span><span class="string" id="3439122">&#34;net/http:&nbsp;invalid&nbsp;byte&nbsp;%q&nbsp;in&nbsp;%s;&nbsp;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="3439179">,</span>&nbsp;<span class="ident" id="3439181">v</span><span class="op" id="3439182">[</span><span class="ident" id="3439183">i</span><span class="op" id="3439184">]</span><span class="op" id="3439185">,</span>&nbsp;<span class="ident" id="3439187">fieldName</span><span class="op" id="3439196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3439200">ok</span>&nbsp;<span class="op" id="3439203">=</span>&nbsp;<span class="builtintype" id="3439205">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439213">break</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3439220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439223">if</span>&nbsp;<span class="ident" id="3439226">ok</span>&nbsp;<span class="op" id="3439229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439233">return</span>&nbsp;<span class="ident" id="3439240">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3439243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3439246">buf</span>&nbsp;<span class="op" id="3439250">:=</span>&nbsp;<span class="builtinfunc" id="3439253">make</span><span class="op" id="3439257">(</span><span class="op" id="3439258">[</span><span class="op" id="3439259">]</span><span class="builtintype" id="3439260">byte</span><span class="op" id="3439264">,</span>&nbsp;<span class="num" id="3439266">0</span><span class="op" id="3439267">,</span>&nbsp;<span class="builtinfunc" id="3439269">len</span><span class="op" id="3439272">(</span><span class="ident" id="3439273">v</span><span class="op" id="3439274">)</span><span class="op" id="3439275">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439278">for</span>&nbsp;<span class="ident" id="3439282">i</span>&nbsp;<span class="op" id="3439284">:=</span>&nbsp;<span class="num" id="3439287">0</span><span class="op" id="3439288">;</span>&nbsp;<span class="ident" id="3439290">i</span>&nbsp;<span class="op" id="3439292">&lt;</span>&nbsp;<span class="builtinfunc" id="3439294">len</span><span class="op" id="3439297">(</span><span class="ident" id="3439298">v</span><span class="op" id="3439299">)</span><span class="op" id="3439300">;</span>&nbsp;<span class="ident" id="3439302">i</span><span class="op" id="3439303">++</span>&nbsp;<span class="op" id="3439306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439310">if</span>&nbsp;<span class="ident" id="3439313">b</span>&nbsp;<span class="op" id="3439315">:=</span>&nbsp;<span class="ident" id="3439318">v</span><span class="op" id="3439319">[</span><span class="ident" id="3439320">i</span><span class="op" id="3439321">]</span><span class="op" id="3439322">;</span>&nbsp;<span class="ident" id="3439324">valid</span><span class="op" id="3439329">(</span><span class="ident" id="3439330">b</span><span class="op" id="3439331">)</span>&nbsp;<span class="op" id="3439333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3439338">buf</span>&nbsp;<span class="op" id="3439342">=</span>&nbsp;<span class="builtinfunc" id="3439344">append</span><span class="op" id="3439350">(</span><span class="ident" id="3439351">buf</span><span class="op" id="3439354">,</span>&nbsp;<span class="ident" id="3439356">b</span><span class="op" id="3439357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3439361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3439364">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439367">return</span>&nbsp;<span class="builtintype" id="3439374">string</span><span class="op" id="3439380">(</span><span class="ident" id="3439381">buf</span><span class="op" id="3439384">)</span><br>
<span class="lineno"></span><span class="op" id="3439386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3439389">func</span>&nbsp;<span class="ident" id="3439394">parseCookieValue</span><span class="op" id="3439410">(</span><span class="ident" id="3439411">raw</span>&nbsp;<span class="builtintype" id="3439415">string</span><span class="op" id="3439421">,</span>&nbsp;<span class="ident" id="3439423">allowDoubleQuote</span>&nbsp;<span class="builtintype" id="3439440">bool</span><span class="op" id="3439444">)</span>&nbsp;<span class="op" id="3439446">(</span><span class="builtintype" id="3439447">string</span><span class="op" id="3439453">,</span>&nbsp;<span class="builtintype" id="3439455">bool</span><span class="op" id="3439459">)</span>&nbsp;<span class="op" id="3439461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3439464">//&nbsp;Strip&nbsp;the&nbsp;quotes,&nbsp;if&nbsp;present.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439498">if</span>&nbsp;<span class="ident" id="3439501">allowDoubleQuote</span>&nbsp;<span class="op" id="3439518">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3439521">len</span><span class="op" id="3439524">(</span><span class="ident" id="3439525">raw</span><span class="op" id="3439528">)</span>&nbsp;<span class="op" id="3439530">&gt;</span>&nbsp;<span class="num" id="3439532">1</span>&nbsp;<span class="op" id="3439534">&amp;&amp;</span>&nbsp;<span class="ident" id="3439537">raw</span><span class="op" id="3439540">[</span><span class="num" id="3439541">0</span><span class="op" id="3439542">]</span>&nbsp;<span class="op" id="3439544">==</span>&nbsp;<span class="string" id="3439547">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3439551">&amp;&amp;</span>&nbsp;<span class="ident" id="3439554">raw</span><span class="op" id="3439557">[</span><span class="builtinfunc" id="3439558">len</span><span class="op" id="3439561">(</span><span class="ident" id="3439562">raw</span><span class="op" id="3439565">)</span><span class="op" id="3439566">-</span><span class="num" id="3439567">1</span><span class="op" id="3439568">]</span>&nbsp;<span class="op" id="3439570">==</span>&nbsp;<span class="string" id="3439573">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3439577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3439581">raw</span>&nbsp;<span class="op" id="3439585">=</span>&nbsp;<span class="ident" id="3439587">raw</span><span class="op" id="3439590">[</span><span class="num" id="3439591">1</span>&nbsp;<span class="op" id="3439593">:</span>&nbsp;<span class="builtinfunc" id="3439595">len</span><span class="op" id="3439598">(</span><span class="ident" id="3439599">raw</span><span class="op" id="3439602">)</span><span class="op" id="3439603">-</span><span class="num" id="3439604">1</span><span class="op" id="3439605">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3439608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439611">for</span>&nbsp;<span class="ident" id="3439615">i</span>&nbsp;<span class="op" id="3439617">:=</span>&nbsp;<span class="num" id="3439620">0</span><span class="op" id="3439621">;</span>&nbsp;<span class="ident" id="3439623">i</span>&nbsp;<span class="op" id="3439625">&lt;</span>&nbsp;<span class="builtinfunc" id="3439627">len</span><span class="op" id="3439630">(</span><span class="ident" id="3439631">raw</span><span class="op" id="3439634">)</span><span class="op" id="3439635">;</span>&nbsp;<span class="ident" id="3439637">i</span><span class="op" id="3439638">++</span>&nbsp;<span class="op" id="3439641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439645">if</span>&nbsp;<span class="op" id="3439648">!</span><span class="ident" id="3439649">validCookieValueByte</span><span class="op" id="3439669">(</span><span class="ident" id="3439670">raw</span><span class="op" id="3439673">[</span><span class="ident" id="3439674">i</span><span class="op" id="3439675">]</span><span class="op" id="3439676">)</span>&nbsp;<span class="op" id="3439678">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439683">return</span>&nbsp;<span class="string" id="3439690">&#34;&#34;</span><span class="op" id="3439692">,</span>&nbsp;<span class="builtintype" id="3439694">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3439702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3439705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439708">return</span>&nbsp;<span class="ident" id="3439715">raw</span><span class="op" id="3439718">,</span>&nbsp;<span class="builtintype" id="3439720">true</span><br>
<span class="lineno"></span><span class="op" id="3439725">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="3439728">func</span>&nbsp;<span class="ident" id="3439733">isCookieNameValid</span><span class="op" id="3439750">(</span><span class="ident" id="3439751">raw</span>&nbsp;<span class="builtintype" id="3439755">string</span><span class="op" id="3439761">)</span>&nbsp;<span class="builtintype" id="3439763">bool</span>&nbsp;<span class="op" id="3439768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439771">return</span>&nbsp;<span class="ident" id="3439778">strings</span><span class="op" id="3439785">.</span><span class="ident" id="3439786">IndexFunc</span><span class="op" id="3439795">(</span><span class="ident" id="3439796">raw</span><span class="op" id="3439799">,</span>&nbsp;<span class="ident" id="3439801">isNotToken</span><span class="op" id="3439811">)</span>&nbsp;<span class="op" id="3439813">&lt;</span>&nbsp;<span class="num" id="3439815">0</span><br>
<span class="lineno"></span><span class="op" id="3439817">}</span>
</div>
</body>
</html>
