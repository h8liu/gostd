<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1339459">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1339514">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1339568">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1339619">package</span>&nbsp;<span class="ident" id="1339627">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1339632">import</span>&nbsp;<span class="op" id="1339639">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1339642">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1339655">&#34;sort&#34;</span><br>
<span class="lineno">10</span><span class="op" id="1339662">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1339665">//&nbsp;DNSError&nbsp;represents&nbsp;a&nbsp;DNS&nbsp;lookup&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="1339708">type</span>&nbsp;<span class="ident" id="1339713">DNSError</span>&nbsp;<span class="keyword" id="1339722">struct</span>&nbsp;<span class="op" id="1339729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339732">Err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1339742">string</span>&nbsp;<span class="comment" id="1339749">//&nbsp;description&nbsp;of&nbsp;the&nbsp;error</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339778">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1339788">string</span>&nbsp;<span class="comment" id="1339795">//&nbsp;name&nbsp;looked&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339815">Server</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1339825">string</span>&nbsp;<span class="comment" id="1339832">//&nbsp;server&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339848">IsTimeout</span>&nbsp;<span class="builtintype" id="1339858">bool</span><br>
<span class="lineno"></span><span class="op" id="1339863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="1339866">func</span>&nbsp;<span class="op" id="1339871">(</span><span class="ident" id="1339872">e</span>&nbsp;<span class="op" id="1339874">*</span><span class="ident" id="1339875"><a href="/net/dnsclient.go.html#1339713">DNSError</a></span><span class="op" id="1339883">)</span>&nbsp;<span class="ident" id="1339885">Error</span><span class="op" id="1339890">(</span><span class="op" id="1339891">)</span>&nbsp;<span class="builtintype" id="1339893">string</span>&nbsp;<span class="op" id="1339900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1339903">if</span>&nbsp;<span class="ident" id="1339906"><a href="/net/dnsclient.go.html#1339872">e</a></span>&nbsp;<span class="op" id="1339908">==</span>&nbsp;<span class="ident" id="1339911">nil</span>&nbsp;<span class="op" id="1339915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1339919">return</span>&nbsp;<span class="string" id="1339926">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1339935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339938">s</span>&nbsp;<span class="op" id="1339940">:=</span>&nbsp;<span class="string" id="1339943">&#34;lookup&nbsp;&#34;</span>&nbsp;<span class="op" id="1339953">+</span>&nbsp;<span class="ident" id="1339955"><a href="/net/dnsclient.go.html#1339872">e</a></span><span class="op" id="1339956">.</span><span class="ident" id="1339957">Name</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1339963">if</span>&nbsp;<span class="ident" id="1339966"><a href="/net/dnsclient.go.html#1339872">e</a></span><span class="op" id="1339967">.</span><span class="ident" id="1339968">Server</span>&nbsp;<span class="op" id="1339975">!=</span>&nbsp;<span class="string" id="1339978">&#34;&#34;</span>&nbsp;<span class="op" id="1339981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339985"><a href="/net/dnsclient.go.html#1339938">s</a></span>&nbsp;<span class="op" id="1339987">+=</span>&nbsp;<span class="string" id="1339990">&#34;&nbsp;on&nbsp;&#34;</span>&nbsp;<span class="op" id="1339997">+</span>&nbsp;<span class="ident" id="1339999"><a href="/net/dnsclient.go.html#1339872">e</a></span><span class="op" id="1340000">.</span><span class="ident" id="1340001">Server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1340009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340012"><a href="/net/dnsclient.go.html#1339938">s</a></span>&nbsp;<span class="op" id="1340014">+=</span>&nbsp;<span class="string" id="1340017">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="1340022">+</span>&nbsp;<span class="ident" id="1340024"><a href="/net/dnsclient.go.html#1339872">e</a></span><span class="op" id="1340025">.</span><span class="ident" id="1340026">Err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1340031">return</span>&nbsp;<span class="ident" id="1340038"><a href="/net/dnsclient.go.html#1339938">s</a></span><br>
<span class="lineno">30</span><span class="op" id="1340040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1340043">func</span>&nbsp;<span class="op" id="1340048">(</span><span class="ident" id="1340049">e</span>&nbsp;<span class="op" id="1340051">*</span><span class="ident" id="1340052"><a href="/net/dnsclient.go.html#1339713">DNSError</a></span><span class="op" id="1340060">)</span>&nbsp;<span class="ident" id="1340062">Timeout</span><span class="op" id="1340069">(</span><span class="op" id="1340070">)</span>&nbsp;<span class="builtintype" id="1340072">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1340079">{</span>&nbsp;<span class="keyword" id="1340081">return</span>&nbsp;<span class="ident" id="1340088"><a href="/net/dnsclient.go.html#1340049">e</a></span><span class="op" id="1340089">.</span><span class="ident" id="1340090">IsTimeout</span>&nbsp;<span class="op" id="1340100">}</span><br>
<span class="lineno"></span><span class="keyword" id="1340102">func</span>&nbsp;<span class="op" id="1340107">(</span><span class="ident" id="1340108">e</span>&nbsp;<span class="op" id="1340110">*</span><span class="ident" id="1340111"><a href="/net/dnsclient.go.html#1339713">DNSError</a></span><span class="op" id="1340119">)</span>&nbsp;<span class="ident" id="1340121">Temporary</span><span class="op" id="1340130">(</span><span class="op" id="1340131">)</span>&nbsp;<span class="builtintype" id="1340133">bool</span>&nbsp;<span class="op" id="1340138">{</span>&nbsp;<span class="keyword" id="1340140">return</span>&nbsp;<span class="ident" id="1340147"><a href="/net/dnsclient.go.html#1340108">e</a></span><span class="op" id="1340148">.</span><span class="ident" id="1340149">IsTimeout</span>&nbsp;<span class="op" id="1340159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="1340162">const</span>&nbsp;<span class="ident" id="1340168">noSuchHost</span>&nbsp;<span class="op" id="1340179">=</span>&nbsp;<span class="string" id="1340181">&#34;no&nbsp;such&nbsp;host&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1340197">//&nbsp;reverseaddr&nbsp;returns&nbsp;the&nbsp;in-addr.arpa.&nbsp;or&nbsp;ip6.arpa.&nbsp;hostname&nbsp;of&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="1340270">//&nbsp;address&nbsp;addr&nbsp;suitable&nbsp;for&nbsp;rDNS&nbsp;(PTR)&nbsp;record&nbsp;lookup&nbsp;or&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;fails</span><br>
<span class="lineno"></span><span class="comment" id="1340348">//&nbsp;to&nbsp;parse&nbsp;the&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">40</span><span class="keyword" id="1340376">func</span>&nbsp;<span class="ident" id="1340381">reverseaddr</span><span class="op" id="1340392">(</span><span class="ident" id="1340393">addr</span>&nbsp;<span class="builtintype" id="1340398">string</span><span class="op" id="1340404">)</span>&nbsp;<span class="op" id="1340406">(</span><span class="ident" id="1340407">arpa</span>&nbsp;<span class="builtintype" id="1340412">string</span><span class="op" id="1340418">,</span>&nbsp;<span class="ident" id="1340420">err</span>&nbsp;<span class="builtintype" id="1340424">error</span><span class="op" id="1340429">)</span>&nbsp;<span class="op" id="1340431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340434">ip</span>&nbsp;<span class="op" id="1340437">:=</span>&nbsp;<span class="ident" id="1340440"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="1340447">(</span><span class="ident" id="1340448"><a href="/net/dnsclient.go.html#1340393">addr</a></span><span class="op" id="1340452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1340455">if</span>&nbsp;<span class="ident" id="1340458"><a href="/net/dnsclient.go.html#1340434">ip</a></span>&nbsp;<span class="op" id="1340461">==</span>&nbsp;<span class="ident" id="1340464">nil</span>&nbsp;<span class="op" id="1340468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1340472">return</span>&nbsp;<span class="string" id="1340479">&#34;&#34;</span><span class="op" id="1340481">,</span>&nbsp;<span class="op" id="1340483">&amp;</span><span class="ident" id="1340484"><a href="/net/dnsclient.go.html#1339713">DNSError</a></span><span class="op" id="1340492">{</span><span class="ident" id="1340493">Err</span><span class="op" id="1340496">:</span>&nbsp;<span class="string" id="1340498">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="1340520">,</span>&nbsp;<span class="ident" id="1340522">Name</span><span class="op" id="1340526">:</span>&nbsp;<span class="ident" id="1340528"><a href="/net/dnsclient.go.html#1340393">addr</a></span><span class="op" id="1340532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1340535">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1340538">if</span>&nbsp;<span class="ident" id="1340541"><a href="/net/dnsclient.go.html#1340434">ip</a></span><span class="op" id="1340543">.</span><span class="ident" id="1340544">To4</span><span class="op" id="1340547">(</span><span class="op" id="1340548">)</span>&nbsp;<span class="op" id="1340550">!=</span>&nbsp;<span class="ident" id="1340553">nil</span>&nbsp;<span class="op" id="1340557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1340561">return</span>&nbsp;<span class="ident" id="1340568"><a href="/net/parse.go.html#1479069">itoa</a></span><span class="op" id="1340572">(</span><span class="builtintype" id="1340573">int</span><span class="op" id="1340576">(</span><span class="ident" id="1340577"><a href="/net/dnsclient.go.html#1340434">ip</a></span><span class="op" id="1340579">[</span><span class="num" id="1340580">15</span><span class="op" id="1340582">]</span><span class="op" id="1340583">)</span><span class="op" id="1340584">)</span>&nbsp;<span class="op" id="1340586">+</span>&nbsp;<span class="string" id="1340588">&#34;.&#34;</span>&nbsp;<span class="op" id="1340592">+</span>&nbsp;<span class="ident" id="1340594"><a href="/net/parse.go.html#1479069">itoa</a></span><span class="op" id="1340598">(</span><span class="builtintype" id="1340599">int</span><span class="op" id="1340602">(</span><span class="ident" id="1340603"><a href="/net/dnsclient.go.html#1340434">ip</a></span><span class="op" id="1340605">[</span><span class="num" id="1340606">14</span><span class="op" id="1340608">]</span><span class="op" id="1340609">)</span><span class="op" id="1340610">)</span>&nbsp;<span class="op" id="1340612">+</span>&nbsp;<span class="string" id="1340614">&#34;.&#34;</span>&nbsp;<span class="op" id="1340618">+</span>&nbsp;<span class="ident" id="1340620"><a href="/net/parse.go.html#1479069">itoa</a></span><span class="op" id="1340624">(</span><span class="builtintype" id="1340625">int</span><span class="op" id="1340628">(</span><span class="ident" id="1340629"><a href="/net/dnsclient.go.html#1340434">ip</a></span><span class="op" id="1340631">[</span><span class="num" id="1340632">13</span><span class="op" id="1340634">]</span><span class="op" id="1340635">)</span><span class="op" id="1340636">)</span>&nbsp;<span class="op" id="1340638">+</span>&nbsp;<span class="string" id="1340640">&#34;.&#34;</span>&nbsp;<span class="op" id="1340644">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340649"><a href="/net/parse.go.html#1479069">itoa</a></span><span class="op" id="1340653">(</span><span class="builtintype" id="1340654">int</span><span class="op" id="1340657">(</span><span class="ident" id="1340658"><a href="/net/dnsclient.go.html#1340434">ip</a></span><span class="op" id="1340660">[</span><span class="num" id="1340661">12</span><span class="op" id="1340663">]</span><span class="op" id="1340664">)</span><span class="op" id="1340665">)</span>&nbsp;<span class="op" id="1340667">+</span>&nbsp;<span class="string" id="1340669">&#34;.in-addr.arpa.&#34;</span><span class="op" id="1340685">,</span>&nbsp;<span class="ident" id="1340687">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1340692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1340695">//&nbsp;Must&nbsp;be&nbsp;IPv6</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340712">buf</span>&nbsp;<span class="op" id="1340716">:=</span>&nbsp;<span class="builtinfunc" id="1340719">make</span><span class="op" id="1340723">(</span><span class="op" id="1340724">[</span><span class="op" id="1340725">]</span><span class="builtintype" id="1340726">byte</span><span class="op" id="1340730">,</span>&nbsp;<span class="num" id="1340732">0</span><span class="op" id="1340733">,</span>&nbsp;<span class="builtinfunc" id="1340735">len</span><span class="op" id="1340738">(</span><span class="ident" id="1340739"><a href="/net/dnsclient.go.html#1340434">ip</a></span><span class="op" id="1340741">)</span><span class="op" id="1340742">*</span><span class="num" id="1340743">4</span><span class="op" id="1340744">+</span><span class="builtinfunc" id="1340745">len</span><span class="op" id="1340748">(</span><span class="string" id="1340749">&#34;ip6.arpa.&#34;</span><span class="op" id="1340760">)</span><span class="op" id="1340761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1340764">//&nbsp;Add&nbsp;it,&nbsp;in&nbsp;reverse,&nbsp;to&nbsp;the&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1340802">for</span>&nbsp;<span class="ident" id="1340806">i</span>&nbsp;<span class="op" id="1340808">:=</span>&nbsp;<span class="builtinfunc" id="1340811">len</span><span class="op" id="1340814">(</span><span class="ident" id="1340815"><a href="/net/dnsclient.go.html#1340434">ip</a></span><span class="op" id="1340817">)</span>&nbsp;<span class="op" id="1340819">-</span>&nbsp;<span class="num" id="1340821">1</span><span class="op" id="1340822">;</span>&nbsp;<span class="ident" id="1340824"><a href="/net/dnsclient.go.html#1340806">i</a></span>&nbsp;<span class="op" id="1340826">&gt;=</span>&nbsp;<span class="num" id="1340829">0</span><span class="op" id="1340830">;</span>&nbsp;<span class="ident" id="1340832"><a href="/net/dnsclient.go.html#1340806">i</a></span><span class="op" id="1340833">--</span>&nbsp;<span class="op" id="1340836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340840">v</span>&nbsp;<span class="op" id="1340842">:=</span>&nbsp;<span class="ident" id="1340845"><a href="/net/dnsclient.go.html#1340434">ip</a></span><span class="op" id="1340847">[</span><span class="ident" id="1340848"><a href="/net/dnsclient.go.html#1340806">i</a></span><span class="op" id="1340849">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340853"><a href="/net/dnsclient.go.html#1340712">buf</a></span>&nbsp;<span class="op" id="1340857">=</span>&nbsp;<span class="builtinfunc" id="1340859">append</span><span class="op" id="1340865">(</span><span class="ident" id="1340866"><a href="/net/dnsclient.go.html#1340712">buf</a></span><span class="op" id="1340869">,</span>&nbsp;<span class="ident" id="1340871"><a href="/net/mac.go.html#1462368">hexDigit</a></span><span class="op" id="1340879">[</span><span class="ident" id="1340880"><a href="/net/dnsclient.go.html#1340840">v</a></span><span class="op" id="1340881">&amp;</span><span class="num" id="1340882">0xF</span><span class="op" id="1340885">]</span><span class="op" id="1340886">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340890"><a href="/net/dnsclient.go.html#1340712">buf</a></span>&nbsp;<span class="op" id="1340894">=</span>&nbsp;<span class="builtinfunc" id="1340896">append</span><span class="op" id="1340902">(</span><span class="ident" id="1340903"><a href="/net/dnsclient.go.html#1340712">buf</a></span><span class="op" id="1340906">,</span>&nbsp;<span class="string" id="1340908">&#39;.&#39;</span><span class="op" id="1340911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340915"><a href="/net/dnsclient.go.html#1340712">buf</a></span>&nbsp;<span class="op" id="1340919">=</span>&nbsp;<span class="builtinfunc" id="1340921">append</span><span class="op" id="1340927">(</span><span class="ident" id="1340928"><a href="/net/dnsclient.go.html#1340712">buf</a></span><span class="op" id="1340931">,</span>&nbsp;<span class="ident" id="1340933"><a href="/net/mac.go.html#1462368">hexDigit</a></span><span class="op" id="1340941">[</span><span class="ident" id="1340942"><a href="/net/dnsclient.go.html#1340840">v</a></span><span class="op" id="1340943">&gt;&gt;</span><span class="num" id="1340945">4</span><span class="op" id="1340946">]</span><span class="op" id="1340947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340951"><a href="/net/dnsclient.go.html#1340712">buf</a></span>&nbsp;<span class="op" id="1340955">=</span>&nbsp;<span class="builtinfunc" id="1340957">append</span><span class="op" id="1340963">(</span><span class="ident" id="1340964"><a href="/net/dnsclient.go.html#1340712">buf</a></span><span class="op" id="1340967">,</span>&nbsp;<span class="string" id="1340969">&#39;.&#39;</span><span class="op" id="1340972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1340975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1340978">//&nbsp;Append&nbsp;&#34;ip6.arpa.&#34;&nbsp;and&nbsp;return&nbsp;(buf&nbsp;already&nbsp;has&nbsp;the&nbsp;final&nbsp;.)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1341042"><a href="/net/dnsclient.go.html#1340712">buf</a></span>&nbsp;<span class="op" id="1341046">=</span>&nbsp;<span class="builtinfunc" id="1341048">append</span><span class="op" id="1341054">(</span><span class="ident" id="1341055"><a href="/net/dnsclient.go.html#1340712">buf</a></span><span class="op" id="1341058">,</span>&nbsp;<span class="string" id="1341060">&#34;ip6.arpa.&#34;</span><span class="op" id="1341071">...</span><span class="op" id="1341074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1341077">return</span>&nbsp;<span class="builtintype" id="1341084">string</span><span class="op" id="1341090">(</span><span class="ident" id="1341091"><a href="/net/dnsclient.go.html#1340712">buf</a></span><span class="op" id="1341094">)</span><span class="op" id="1341095">,</span>&nbsp;<span class="ident" id="1341097">nil</span><br>
<span class="lineno"></span><span class="op" id="1341101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1341104">//&nbsp;Find&nbsp;answer&nbsp;for&nbsp;name&nbsp;in&nbsp;dns&nbsp;message.</span><br>
<span class="lineno">65</span><span class="comment" id="1341144">//&nbsp;On&nbsp;return,&nbsp;if&nbsp;err&nbsp;==&nbsp;nil,&nbsp;addrs&nbsp;!=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="1341187">func</span>&nbsp;<span class="ident" id="1341192">answer</span><span class="op" id="1341198">(</span><span class="ident" id="1341199">name</span><span class="op" id="1341203">,</span>&nbsp;<span class="ident" id="1341205">server</span>&nbsp;<span class="builtintype" id="1341212">string</span><span class="op" id="1341218">,</span>&nbsp;<span class="ident" id="1341220">dns</span>&nbsp;<span class="op" id="1341224">*</span><span class="ident" id="1341225"><a href="/net/dnsmsg.go.html#1376790">dnsMsg</a></span><span class="op" id="1341231">,</span>&nbsp;<span class="ident" id="1341233">qtype</span>&nbsp;<span class="builtintype" id="1341239">uint16</span><span class="op" id="1341245">)</span>&nbsp;<span class="op" id="1341247">(</span><span class="ident" id="1341248">cname</span>&nbsp;<span class="builtintype" id="1341254">string</span><span class="op" id="1341260">,</span>&nbsp;<span class="ident" id="1341262">addrs</span>&nbsp;<span class="op" id="1341268">[</span><span class="op" id="1341269">]</span><span class="ident" id="1341270"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span><span class="op" id="1341275">,</span>&nbsp;<span class="ident" id="1341277">err</span>&nbsp;<span class="builtintype" id="1341281">error</span><span class="op" id="1341286">)</span>&nbsp;<span class="op" id="1341288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1341291"><a href="/net/dnsclient.go.html#1341262">addrs</a></span>&nbsp;<span class="op" id="1341297">=</span>&nbsp;<span class="builtinfunc" id="1341299">make</span><span class="op" id="1341303">(</span><span class="op" id="1341304">[</span><span class="op" id="1341305">]</span><span class="ident" id="1341306"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span><span class="op" id="1341311">,</span>&nbsp;<span class="num" id="1341313">0</span><span class="op" id="1341314">,</span>&nbsp;<span class="builtinfunc" id="1341316">len</span><span class="op" id="1341319">(</span><span class="ident" id="1341320"><a href="/net/dnsclient.go.html#1341220">dns</a></span><span class="op" id="1341323">.</span><span class="ident" id="1341324">answer</span><span class="op" id="1341330">)</span><span class="op" id="1341331">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1341335">if</span>&nbsp;<span class="ident" id="1341338"><a href="/net/dnsclient.go.html#1341220">dns</a></span><span class="op" id="1341341">.</span><span class="ident" id="1341342">rcode</span>&nbsp;<span class="op" id="1341348">==</span>&nbsp;<span class="ident" id="1341351"><a href="/net/dnsmsg.go.html#1360385">dnsRcodeNameError</a></span>&nbsp;<span class="op" id="1341369">&amp;&amp;</span>&nbsp;<span class="ident" id="1341372"><a href="/net/dnsclient.go.html#1341220">dns</a></span><span class="op" id="1341375">.</span><span class="ident" id="1341376">recursion_available</span>&nbsp;<span class="op" id="1341396">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1341400">return</span>&nbsp;<span class="string" id="1341407">&#34;&#34;</span><span class="op" id="1341409">,</span>&nbsp;<span class="ident" id="1341411">nil</span><span class="op" id="1341414">,</span>&nbsp;<span class="op" id="1341416">&amp;</span><span class="ident" id="1341417"><a href="/net/dnsclient.go.html#1339713">DNSError</a></span><span class="op" id="1341425">{</span><span class="ident" id="1341426">Err</span><span class="op" id="1341429">:</span>&nbsp;<span class="ident" id="1341431"><a href="/net/dnsclient.go.html#1340168">noSuchHost</a></span><span class="op" id="1341441">,</span>&nbsp;<span class="ident" id="1341443">Name</span><span class="op" id="1341447">:</span>&nbsp;<span class="ident" id="1341449"><a href="/net/dnsclient.go.html#1341199">name</a></span><span class="op" id="1341453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1341456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1341459">if</span>&nbsp;<span class="ident" id="1341462"><a href="/net/dnsclient.go.html#1341220">dns</a></span><span class="op" id="1341465">.</span><span class="ident" id="1341466">rcode</span>&nbsp;<span class="op" id="1341472">!=</span>&nbsp;<span class="ident" id="1341475"><a href="/net/dnsmsg.go.html#1360301">dnsRcodeSuccess</a></span>&nbsp;<span class="op" id="1341491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1341495">//&nbsp;None&nbsp;of&nbsp;the&nbsp;error&nbsp;codes&nbsp;make&nbsp;sense</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1341535">//&nbsp;for&nbsp;the&nbsp;query&nbsp;we&nbsp;sent.&nbsp;&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;get</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1341581">//&nbsp;a&nbsp;name&nbsp;error&nbsp;and&nbsp;we&nbsp;didn&#39;t&nbsp;get&nbsp;success,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1341626">//&nbsp;the&nbsp;server&nbsp;is&nbsp;behaving&nbsp;incorrectly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1341667">return</span>&nbsp;<span class="string" id="1341674">&#34;&#34;</span><span class="op" id="1341676">,</span>&nbsp;<span class="ident" id="1341678">nil</span><span class="op" id="1341681">,</span>&nbsp;<span class="op" id="1341683">&amp;</span><span class="ident" id="1341684"><a href="/net/dnsclient.go.html#1339713">DNSError</a></span><span class="op" id="1341692">{</span><span class="ident" id="1341693">Err</span><span class="op" id="1341696">:</span>&nbsp;<span class="string" id="1341698">&#34;server&nbsp;misbehaving&#34;</span><span class="op" id="1341718">,</span>&nbsp;<span class="ident" id="1341720">Name</span><span class="op" id="1341724">:</span>&nbsp;<span class="ident" id="1341726"><a href="/net/dnsclient.go.html#1341199">name</a></span><span class="op" id="1341730">,</span>&nbsp;<span class="ident" id="1341732">Server</span><span class="op" id="1341738">:</span>&nbsp;<span class="ident" id="1341740"><a href="/net/dnsclient.go.html#1341205">server</a></span><span class="op" id="1341746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1341749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1341753">//&nbsp;Look&nbsp;for&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1341776">//&nbsp;Presotto&nbsp;says&nbsp;it&#39;s&nbsp;okay&nbsp;to&nbsp;assume&nbsp;that&nbsp;servers&nbsp;listed&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1341837">//&nbsp;/etc/resolv.conf&nbsp;are&nbsp;recursive&nbsp;resolvers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1341883">//&nbsp;We&nbsp;asked&nbsp;for&nbsp;recursion,&nbsp;so&nbsp;it&nbsp;should&nbsp;have&nbsp;included</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1341938">//&nbsp;all&nbsp;the&nbsp;answers&nbsp;we&nbsp;need&nbsp;in&nbsp;this&nbsp;one&nbsp;packet.</span><br>
<span class="lineno">85</span><span class="ident" id="1341985">Cname</span><span class="op" id="1341990">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1341993">for</span>&nbsp;<span class="ident" id="1341997">cnameloop</span>&nbsp;<span class="op" id="1342007">:=</span>&nbsp;<span class="num" id="1342010">0</span><span class="op" id="1342011">;</span>&nbsp;<span class="ident" id="1342013"><a href="/net/dnsclient.go.html#1341997">cnameloop</a></span>&nbsp;<span class="op" id="1342023">&lt;</span>&nbsp;<span class="num" id="1342025">10</span><span class="op" id="1342027">;</span>&nbsp;<span class="ident" id="1342029"><a href="/net/dnsclient.go.html#1341997">cnameloop</a></span><span class="op" id="1342038">++</span>&nbsp;<span class="op" id="1342041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1342045"><a href="/net/dnsclient.go.html#1341262">addrs</a></span>&nbsp;<span class="op" id="1342051">=</span>&nbsp;<span class="ident" id="1342053"><a href="/net/dnsclient.go.html#1341262">addrs</a></span><span class="op" id="1342058">[</span><span class="num" id="1342059">0</span><span class="op" id="1342060">:</span><span class="num" id="1342061">0</span><span class="op" id="1342062">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1342066">for</span>&nbsp;<span class="ident" id="1342070">_</span><span class="op" id="1342071">,</span>&nbsp;<span class="ident" id="1342073">rr</span>&nbsp;<span class="op" id="1342076">:=</span>&nbsp;<span class="keyword" id="1342079">range</span>&nbsp;<span class="ident" id="1342085"><a href="/net/dnsclient.go.html#1341220">dns</a></span><span class="op" id="1342088">.</span><span class="ident" id="1342089">answer</span>&nbsp;<span class="op" id="1342096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1342101">if</span>&nbsp;<span class="ident" id="1342104">_</span><span class="op" id="1342105">,</span>&nbsp;<span class="ident" id="1342107">justHeader</span>&nbsp;<span class="op" id="1342118">:=</span>&nbsp;<span class="ident" id="1342121"><a href="/net/dnsclient.go.html#1342073">rr</a></span><span class="op" id="1342123">.</span><span class="op" id="1342124">(</span><span class="op" id="1342125">*</span><span class="ident" id="1342126"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><span class="op" id="1342138">)</span><span class="op" id="1342139">;</span>&nbsp;<span class="ident" id="1342141"><a href="/net/dnsclient.go.html#1342107">justHeader</a></span>&nbsp;<span class="op" id="1342152">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1342158">//&nbsp;Corrupt&nbsp;record:&nbsp;we&nbsp;only&nbsp;have&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1342196">//&nbsp;header.&nbsp;That&nbsp;header&nbsp;might&nbsp;say&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1342238">//&nbsp;of&nbsp;type&nbsp;qtype,&nbsp;but&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1342273">//&nbsp;actually&nbsp;have&nbsp;it.&nbsp;Skip.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1342304">continue</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1342316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1342321">h</span>&nbsp;<span class="op" id="1342323">:=</span>&nbsp;<span class="ident" id="1342326"><a href="/net/dnsclient.go.html#1342073">rr</a></span><span class="op" id="1342328">.</span><span class="ident" id="1342329">Header</span><span class="op" id="1342335">(</span><span class="op" id="1342336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1342341">if</span>&nbsp;<span class="ident" id="1342344"><a href="/net/dnsclient.go.html#1342321">h</a></span><span class="op" id="1342345">.</span><span class="ident" id="1342346">Class</span>&nbsp;<span class="op" id="1342352">==</span>&nbsp;<span class="ident" id="1342355"><a href="/net/dnsmsg.go.html#1360181">dnsClassINET</a></span>&nbsp;<span class="op" id="1342368">&amp;&amp;</span>&nbsp;<span class="ident" id="1342371"><a href="/net/dnsclient.go.html#1342321">h</a></span><span class="op" id="1342372">.</span><span class="ident" id="1342373">Name</span>&nbsp;<span class="op" id="1342378">==</span>&nbsp;<span class="ident" id="1342381"><a href="/net/dnsclient.go.html#1341199">name</a></span>&nbsp;<span class="op" id="1342386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1342392">switch</span>&nbsp;<span class="ident" id="1342399"><a href="/net/dnsclient.go.html#1342321">h</a></span><span class="op" id="1342400">.</span><span class="ident" id="1342401">Rrtype</span>&nbsp;<span class="op" id="1342408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1342414">case</span>&nbsp;<span class="ident" id="1342419"><a href="/net/dnsclient.go.html#1341233">qtype</a></span><span class="op" id="1342424">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1342431"><a href="/net/dnsclient.go.html#1341262">addrs</a></span>&nbsp;<span class="op" id="1342437">=</span>&nbsp;<span class="builtinfunc" id="1342439">append</span><span class="op" id="1342445">(</span><span class="ident" id="1342446"><a href="/net/dnsclient.go.html#1341262">addrs</a></span><span class="op" id="1342451">,</span>&nbsp;<span class="ident" id="1342453"><a href="/net/dnsclient.go.html#1342073">rr</a></span><span class="op" id="1342455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1342461">case</span>&nbsp;<span class="ident" id="1342466"><a href="/net/dnsmsg.go.html#1359776">dnsTypeCNAME</a></span><span class="op" id="1342478">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1342485">//&nbsp;redirect&nbsp;to&nbsp;cname</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1342511"><a href="/net/dnsclient.go.html#1341199">name</a></span>&nbsp;<span class="op" id="1342516">=</span>&nbsp;<span class="ident" id="1342518"><a href="/net/dnsclient.go.html#1342073">rr</a></span><span class="op" id="1342520">.</span><span class="op" id="1342521">(</span><span class="op" id="1342522">*</span><span class="ident" id="1342523"><a href="/net/dnsmsg.go.html#1362812">dnsRR_CNAME</a></span><span class="op" id="1342534">)</span><span class="op" id="1342535">.</span><span class="ident" id="1342536">Cname</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1342547">continue</span>&nbsp;<span class="ident" id="1342556">Cname</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1342566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1342571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1342575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1342579">if</span>&nbsp;<span class="builtinfunc" id="1342582">len</span><span class="op" id="1342585">(</span><span class="ident" id="1342586"><a href="/net/dnsclient.go.html#1341262">addrs</a></span><span class="op" id="1342591">)</span>&nbsp;<span class="op" id="1342593">==</span>&nbsp;<span class="num" id="1342596">0</span>&nbsp;<span class="op" id="1342598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1342603">return</span>&nbsp;<span class="string" id="1342610">&#34;&#34;</span><span class="op" id="1342612">,</span>&nbsp;<span class="ident" id="1342614">nil</span><span class="op" id="1342617">,</span>&nbsp;<span class="op" id="1342619">&amp;</span><span class="ident" id="1342620"><a href="/net/dnsclient.go.html#1339713">DNSError</a></span><span class="op" id="1342628">{</span><span class="ident" id="1342629">Err</span><span class="op" id="1342632">:</span>&nbsp;<span class="ident" id="1342634"><a href="/net/dnsclient.go.html#1340168">noSuchHost</a></span><span class="op" id="1342644">,</span>&nbsp;<span class="ident" id="1342646">Name</span><span class="op" id="1342650">:</span>&nbsp;<span class="ident" id="1342652"><a href="/net/dnsclient.go.html#1341199">name</a></span><span class="op" id="1342656">,</span>&nbsp;<span class="ident" id="1342658">Server</span><span class="op" id="1342664">:</span>&nbsp;<span class="ident" id="1342666"><a href="/net/dnsclient.go.html#1341205">server</a></span><span class="op" id="1342672">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1342676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1342680">return</span>&nbsp;<span class="ident" id="1342687"><a href="/net/dnsclient.go.html#1341199">name</a></span><span class="op" id="1342691">,</span>&nbsp;<span class="ident" id="1342693"><a href="/net/dnsclient.go.html#1341262">addrs</a></span><span class="op" id="1342698">,</span>&nbsp;<span class="ident" id="1342700">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1342705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1342709">return</span>&nbsp;<span class="string" id="1342716">&#34;&#34;</span><span class="op" id="1342718">,</span>&nbsp;<span class="ident" id="1342720">nil</span><span class="op" id="1342723">,</span>&nbsp;<span class="op" id="1342725">&amp;</span><span class="ident" id="1342726"><a href="/net/dnsclient.go.html#1339713">DNSError</a></span><span class="op" id="1342734">{</span><span class="ident" id="1342735">Err</span><span class="op" id="1342738">:</span>&nbsp;<span class="string" id="1342740">&#34;too&nbsp;many&nbsp;redirects&#34;</span><span class="op" id="1342760">,</span>&nbsp;<span class="ident" id="1342762">Name</span><span class="op" id="1342766">:</span>&nbsp;<span class="ident" id="1342768"><a href="/net/dnsclient.go.html#1341199">name</a></span><span class="op" id="1342772">,</span>&nbsp;<span class="ident" id="1342774">Server</span><span class="op" id="1342780">:</span>&nbsp;<span class="ident" id="1342782"><a href="/net/dnsclient.go.html#1341205">server</a></span><span class="op" id="1342788">}</span><br>
<span class="lineno">115</span><span class="op" id="1342790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1342793">func</span>&nbsp;<span class="ident" id="1342798">isDomainName</span><span class="op" id="1342810">(</span><span class="ident" id="1342811">s</span>&nbsp;<span class="builtintype" id="1342813">string</span><span class="op" id="1342819">)</span>&nbsp;<span class="builtintype" id="1342821">bool</span>&nbsp;<span class="op" id="1342826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1342829">//&nbsp;See&nbsp;RFC&nbsp;1035,&nbsp;RFC&nbsp;3696.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1342857">if</span>&nbsp;<span class="builtinfunc" id="1342860">len</span><span class="op" id="1342863">(</span><span class="ident" id="1342864"><a href="/net/dnsclient.go.html#1342811">s</a></span><span class="op" id="1342865">)</span>&nbsp;<span class="op" id="1342867">==</span>&nbsp;<span class="num" id="1342870">0</span>&nbsp;<span class="op" id="1342872">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1342876">return</span>&nbsp;<span class="builtintype" id="1342883">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1342890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1342893">if</span>&nbsp;<span class="builtinfunc" id="1342896">len</span><span class="op" id="1342899">(</span><span class="ident" id="1342900"><a href="/net/dnsclient.go.html#1342811">s</a></span><span class="op" id="1342901">)</span>&nbsp;<span class="op" id="1342903">&gt;</span>&nbsp;<span class="num" id="1342905">255</span>&nbsp;<span class="op" id="1342909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1342913">return</span>&nbsp;<span class="builtintype" id="1342920">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1342927">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1342931">last</span>&nbsp;<span class="op" id="1342936">:=</span>&nbsp;<span class="builtintype" id="1342939">byte</span><span class="op" id="1342943">(</span><span class="string" id="1342944">&#39;.&#39;</span><span class="op" id="1342947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1342950">ok</span>&nbsp;<span class="op" id="1342953">:=</span>&nbsp;<span class="builtintype" id="1342956">false</span>&nbsp;<span class="comment" id="1342962">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1342995">partlen</span>&nbsp;<span class="op" id="1343003">:=</span>&nbsp;<span class="num" id="1343006">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343009">for</span>&nbsp;<span class="ident" id="1343013">i</span>&nbsp;<span class="op" id="1343015">:=</span>&nbsp;<span class="num" id="1343018">0</span><span class="op" id="1343019">;</span>&nbsp;<span class="ident" id="1343021"><a href="/net/dnsclient.go.html#1343013">i</a></span>&nbsp;<span class="op" id="1343023">&lt;</span>&nbsp;<span class="builtinfunc" id="1343025">len</span><span class="op" id="1343028">(</span><span class="ident" id="1343029"><a href="/net/dnsclient.go.html#1342811">s</a></span><span class="op" id="1343030">)</span><span class="op" id="1343031">;</span>&nbsp;<span class="ident" id="1343033"><a href="/net/dnsclient.go.html#1343013">i</a></span><span class="op" id="1343034">++</span>&nbsp;<span class="op" id="1343037">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343041">c</span>&nbsp;<span class="op" id="1343043">:=</span>&nbsp;<span class="ident" id="1343046"><a href="/net/dnsclient.go.html#1342811">s</a></span><span class="op" id="1343047">[</span><span class="ident" id="1343048"><a href="/net/dnsclient.go.html#1343013">i</a></span><span class="op" id="1343049">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343053">switch</span>&nbsp;<span class="op" id="1343060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343064">default</span><span class="op" id="1343071">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343076">return</span>&nbsp;<span class="builtintype" id="1343083">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343091">case</span>&nbsp;<span class="string" id="1343096">&#39;a&#39;</span>&nbsp;<span class="op" id="1343100">&lt;=</span>&nbsp;<span class="ident" id="1343103"><a href="/net/dnsclient.go.html#1343041">c</a></span>&nbsp;<span class="op" id="1343105">&amp;&amp;</span>&nbsp;<span class="ident" id="1343108"><a href="/net/dnsclient.go.html#1343041">c</a></span>&nbsp;<span class="op" id="1343110">&lt;=</span>&nbsp;<span class="string" id="1343113">&#39;z&#39;</span>&nbsp;<span class="op" id="1343117">||</span>&nbsp;<span class="string" id="1343120">&#39;A&#39;</span>&nbsp;<span class="op" id="1343124">&lt;=</span>&nbsp;<span class="ident" id="1343127"><a href="/net/dnsclient.go.html#1343041">c</a></span>&nbsp;<span class="op" id="1343129">&amp;&amp;</span>&nbsp;<span class="ident" id="1343132"><a href="/net/dnsclient.go.html#1343041">c</a></span>&nbsp;<span class="op" id="1343134">&lt;=</span>&nbsp;<span class="string" id="1343137">&#39;Z&#39;</span>&nbsp;<span class="op" id="1343141">||</span>&nbsp;<span class="ident" id="1343144"><a href="/net/dnsclient.go.html#1343041">c</a></span>&nbsp;<span class="op" id="1343146">==</span>&nbsp;<span class="string" id="1343149">&#39;_&#39;</span><span class="op" id="1343152">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343157"><a href="/net/dnsclient.go.html#1342950">ok</a></span>&nbsp;<span class="op" id="1343160">=</span>&nbsp;<span class="builtintype" id="1343162">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343170"><a href="/net/dnsclient.go.html#1342995">partlen</a></span><span class="op" id="1343177">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343182">case</span>&nbsp;<span class="string" id="1343187">&#39;0&#39;</span>&nbsp;<span class="op" id="1343191">&lt;=</span>&nbsp;<span class="ident" id="1343194"><a href="/net/dnsclient.go.html#1343041">c</a></span>&nbsp;<span class="op" id="1343196">&amp;&amp;</span>&nbsp;<span class="ident" id="1343199"><a href="/net/dnsclient.go.html#1343041">c</a></span>&nbsp;<span class="op" id="1343201">&lt;=</span>&nbsp;<span class="string" id="1343204">&#39;9&#39;</span><span class="op" id="1343207">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1343212">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343223"><a href="/net/dnsclient.go.html#1342995">partlen</a></span><span class="op" id="1343230">++</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343235">case</span>&nbsp;<span class="ident" id="1343240"><a href="/net/dnsclient.go.html#1343041">c</a></span>&nbsp;<span class="op" id="1343242">==</span>&nbsp;<span class="string" id="1343245">&#39;-&#39;</span><span class="op" id="1343248">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1343253">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343291">if</span>&nbsp;<span class="ident" id="1343294"><a href="/net/dnsclient.go.html#1342931">last</a></span>&nbsp;<span class="op" id="1343299">==</span>&nbsp;<span class="string" id="1343302">&#39;.&#39;</span>&nbsp;<span class="op" id="1343306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343312">return</span>&nbsp;<span class="builtintype" id="1343319">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1343328">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343333"><a href="/net/dnsclient.go.html#1342995">partlen</a></span><span class="op" id="1343340">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343345">case</span>&nbsp;<span class="ident" id="1343350"><a href="/net/dnsclient.go.html#1343041">c</a></span>&nbsp;<span class="op" id="1343352">==</span>&nbsp;<span class="string" id="1343355">&#39;.&#39;</span><span class="op" id="1343358">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1343363">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343406">if</span>&nbsp;<span class="ident" id="1343409"><a href="/net/dnsclient.go.html#1342931">last</a></span>&nbsp;<span class="op" id="1343414">==</span>&nbsp;<span class="string" id="1343417">&#39;.&#39;</span>&nbsp;<span class="op" id="1343421">||</span>&nbsp;<span class="ident" id="1343424"><a href="/net/dnsclient.go.html#1342931">last</a></span>&nbsp;<span class="op" id="1343429">==</span>&nbsp;<span class="string" id="1343432">&#39;-&#39;</span>&nbsp;<span class="op" id="1343436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343442">return</span>&nbsp;<span class="builtintype" id="1343449">false</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1343458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343463">if</span>&nbsp;<span class="ident" id="1343466"><a href="/net/dnsclient.go.html#1342995">partlen</a></span>&nbsp;<span class="op" id="1343474">&gt;</span>&nbsp;<span class="num" id="1343476">63</span>&nbsp;<span class="op" id="1343479">||</span>&nbsp;<span class="ident" id="1343482"><a href="/net/dnsclient.go.html#1342995">partlen</a></span>&nbsp;<span class="op" id="1343490">==</span>&nbsp;<span class="num" id="1343493">0</span>&nbsp;<span class="op" id="1343495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343501">return</span>&nbsp;<span class="builtintype" id="1343508">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1343517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343522"><a href="/net/dnsclient.go.html#1342995">partlen</a></span>&nbsp;<span class="op" id="1343530">=</span>&nbsp;<span class="num" id="1343532">0</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1343536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343540"><a href="/net/dnsclient.go.html#1342931">last</a></span>&nbsp;<span class="op" id="1343545">=</span>&nbsp;<span class="ident" id="1343547"><a href="/net/dnsclient.go.html#1343041">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1343550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343553">if</span>&nbsp;<span class="ident" id="1343556"><a href="/net/dnsclient.go.html#1342931">last</a></span>&nbsp;<span class="op" id="1343561">==</span>&nbsp;<span class="string" id="1343564">&#39;-&#39;</span>&nbsp;<span class="op" id="1343568">||</span>&nbsp;<span class="ident" id="1343571"><a href="/net/dnsclient.go.html#1342995">partlen</a></span>&nbsp;<span class="op" id="1343579">&gt;</span>&nbsp;<span class="num" id="1343581">63</span>&nbsp;<span class="op" id="1343584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343588">return</span>&nbsp;<span class="builtintype" id="1343595">false</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1343602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343606">return</span>&nbsp;<span class="ident" id="1343613"><a href="/net/dnsclient.go.html#1342950">ok</a></span><br>
<span class="lineno"></span><span class="op" id="1343616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="1343619">//&nbsp;An&nbsp;SRV&nbsp;represents&nbsp;a&nbsp;single&nbsp;DNS&nbsp;SRV&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="1343665">type</span>&nbsp;<span class="ident" id="1343670">SRV</span>&nbsp;<span class="keyword" id="1343674">struct</span>&nbsp;<span class="op" id="1343681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343684">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1343693">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343701">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1343710">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343718">Priority</span>&nbsp;<span class="builtintype" id="1343727">uint16</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343735">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1343744">uint16</span><br>
<span class="lineno"></span><span class="op" id="1343751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1343754">//&nbsp;byPriorityWeight&nbsp;sorts&nbsp;SRV&nbsp;records&nbsp;by&nbsp;ascending&nbsp;priority&nbsp;and&nbsp;weight.</span><br>
<span class="lineno"></span><span class="keyword" id="1343826">type</span>&nbsp;<span class="ident" id="1343831">byPriorityWeight</span>&nbsp;<span class="op" id="1343848">[</span><span class="op" id="1343849">]</span><span class="op" id="1343850">*</span><span class="ident" id="1343851"><a href="/net/dnsclient.go.html#1343670">SRV</a></span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="1343856">func</span>&nbsp;<span class="op" id="1343861">(</span><span class="ident" id="1343862">s</span>&nbsp;<span class="ident" id="1343864"><a href="/net/dnsclient.go.html#1343831">byPriorityWeight</a></span><span class="op" id="1343880">)</span>&nbsp;<span class="ident" id="1343882">Len</span><span class="op" id="1343885">(</span><span class="op" id="1343886">)</span>&nbsp;<span class="builtintype" id="1343888">int</span>&nbsp;<span class="op" id="1343892">{</span>&nbsp;<span class="keyword" id="1343894">return</span>&nbsp;<span class="builtinfunc" id="1343901">len</span><span class="op" id="1343904">(</span><span class="ident" id="1343905"><a href="/net/dnsclient.go.html#1343862">s</a></span><span class="op" id="1343906">)</span>&nbsp;<span class="op" id="1343908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1343911">func</span>&nbsp;<span class="op" id="1343916">(</span><span class="ident" id="1343917">s</span>&nbsp;<span class="ident" id="1343919"><a href="/net/dnsclient.go.html#1343831">byPriorityWeight</a></span><span class="op" id="1343935">)</span>&nbsp;<span class="ident" id="1343937">Swap</span><span class="op" id="1343941">(</span><span class="ident" id="1343942">i</span><span class="op" id="1343943">,</span>&nbsp;<span class="ident" id="1343945">j</span>&nbsp;<span class="builtintype" id="1343947">int</span><span class="op" id="1343950">)</span>&nbsp;<span class="op" id="1343952">{</span>&nbsp;<span class="ident" id="1343954"><a href="/net/dnsclient.go.html#1343917">s</a></span><span class="op" id="1343955">[</span><span class="ident" id="1343956"><a href="/net/dnsclient.go.html#1343942">i</a></span><span class="op" id="1343957">]</span><span class="op" id="1343958">,</span>&nbsp;<span class="ident" id="1343960"><a href="/net/dnsclient.go.html#1343917">s</a></span><span class="op" id="1343961">[</span><span class="ident" id="1343962"><a href="/net/dnsclient.go.html#1343945">j</a></span><span class="op" id="1343963">]</span>&nbsp;<span class="op" id="1343965">=</span>&nbsp;<span class="ident" id="1343967"><a href="/net/dnsclient.go.html#1343917">s</a></span><span class="op" id="1343968">[</span><span class="ident" id="1343969"><a href="/net/dnsclient.go.html#1343945">j</a></span><span class="op" id="1343970">]</span><span class="op" id="1343971">,</span>&nbsp;<span class="ident" id="1343973"><a href="/net/dnsclient.go.html#1343917">s</a></span><span class="op" id="1343974">[</span><span class="ident" id="1343975"><a href="/net/dnsclient.go.html#1343942">i</a></span><span class="op" id="1343976">]</span>&nbsp;<span class="op" id="1343978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="1343981">func</span>&nbsp;<span class="op" id="1343986">(</span><span class="ident" id="1343987">s</span>&nbsp;<span class="ident" id="1343989"><a href="/net/dnsclient.go.html#1343831">byPriorityWeight</a></span><span class="op" id="1344005">)</span>&nbsp;<span class="ident" id="1344007">Less</span><span class="op" id="1344011">(</span><span class="ident" id="1344012">i</span><span class="op" id="1344013">,</span>&nbsp;<span class="ident" id="1344015">j</span>&nbsp;<span class="builtintype" id="1344017">int</span><span class="op" id="1344020">)</span>&nbsp;<span class="builtintype" id="1344022">bool</span>&nbsp;<span class="op" id="1344027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1344030">return</span>&nbsp;<span class="ident" id="1344037"><a href="/net/dnsclient.go.html#1343987">s</a></span><span class="op" id="1344038">[</span><span class="ident" id="1344039"><a href="/net/dnsclient.go.html#1344012">i</a></span><span class="op" id="1344040">]</span><span class="op" id="1344041">.</span><span class="ident" id="1344042">Priority</span>&nbsp;<span class="op" id="1344051">&lt;</span>&nbsp;<span class="ident" id="1344053"><a href="/net/dnsclient.go.html#1343987">s</a></span><span class="op" id="1344054">[</span><span class="ident" id="1344055"><a href="/net/dnsclient.go.html#1344015">j</a></span><span class="op" id="1344056">]</span><span class="op" id="1344057">.</span><span class="ident" id="1344058">Priority</span>&nbsp;<span class="op" id="1344067">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1344072">(</span><span class="ident" id="1344073"><a href="/net/dnsclient.go.html#1343987">s</a></span><span class="op" id="1344074">[</span><span class="ident" id="1344075"><a href="/net/dnsclient.go.html#1344012">i</a></span><span class="op" id="1344076">]</span><span class="op" id="1344077">.</span><span class="ident" id="1344078">Priority</span>&nbsp;<span class="op" id="1344087">==</span>&nbsp;<span class="ident" id="1344090"><a href="/net/dnsclient.go.html#1343987">s</a></span><span class="op" id="1344091">[</span><span class="ident" id="1344092"><a href="/net/dnsclient.go.html#1344015">j</a></span><span class="op" id="1344093">]</span><span class="op" id="1344094">.</span><span class="ident" id="1344095">Priority</span>&nbsp;<span class="op" id="1344104">&amp;&amp;</span>&nbsp;<span class="ident" id="1344107"><a href="/net/dnsclient.go.html#1343987">s</a></span><span class="op" id="1344108">[</span><span class="ident" id="1344109"><a href="/net/dnsclient.go.html#1344012">i</a></span><span class="op" id="1344110">]</span><span class="op" id="1344111">.</span><span class="ident" id="1344112">Weight</span>&nbsp;<span class="op" id="1344119">&lt;</span>&nbsp;<span class="ident" id="1344121"><a href="/net/dnsclient.go.html#1343987">s</a></span><span class="op" id="1344122">[</span><span class="ident" id="1344123"><a href="/net/dnsclient.go.html#1344015">j</a></span><span class="op" id="1344124">]</span><span class="op" id="1344125">.</span><span class="ident" id="1344126">Weight</span><span class="op" id="1344132">)</span><br>
<span class="lineno"></span><span class="op" id="1344134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="comment" id="1344137">//&nbsp;shuffleByWeight&nbsp;shuffles&nbsp;SRV&nbsp;records&nbsp;by&nbsp;weight&nbsp;using&nbsp;the&nbsp;algorithm</span><br>
<span class="lineno"></span><span class="comment" id="1344207">//&nbsp;described&nbsp;in&nbsp;RFC&nbsp;2782.</span><br>
<span class="lineno"></span><span class="keyword" id="1344233">func</span>&nbsp;<span class="op" id="1344238">(</span><span class="ident" id="1344239">addrs</span>&nbsp;<span class="ident" id="1344245"><a href="/net/dnsclient.go.html#1343831">byPriorityWeight</a></span><span class="op" id="1344261">)</span>&nbsp;<span class="ident" id="1344263">shuffleByWeight</span><span class="op" id="1344278">(</span><span class="op" id="1344279">)</span>&nbsp;<span class="op" id="1344281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344284">sum</span>&nbsp;<span class="op" id="1344288">:=</span>&nbsp;<span class="num" id="1344291">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1344294">for</span>&nbsp;<span class="ident" id="1344298">_</span><span class="op" id="1344299">,</span>&nbsp;<span class="ident" id="1344301">addr</span>&nbsp;<span class="op" id="1344306">:=</span>&nbsp;<span class="keyword" id="1344309">range</span>&nbsp;<span class="ident" id="1344315"><a href="/net/dnsclient.go.html#1344239">addrs</a></span>&nbsp;<span class="op" id="1344321">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344325"><a href="/net/dnsclient.go.html#1344284">sum</a></span>&nbsp;<span class="op" id="1344329">+=</span>&nbsp;<span class="builtintype" id="1344332">int</span><span class="op" id="1344335">(</span><span class="ident" id="1344336"><a href="/net/dnsclient.go.html#1344301">addr</a></span><span class="op" id="1344340">.</span><span class="ident" id="1344341">Weight</span><span class="op" id="1344347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1344350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1344353">for</span>&nbsp;<span class="ident" id="1344357"><a href="/net/dnsclient.go.html#1344284">sum</a></span>&nbsp;<span class="op" id="1344361">&gt;</span>&nbsp;<span class="num" id="1344363">0</span>&nbsp;<span class="op" id="1344365">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1344368">len</span><span class="op" id="1344371">(</span><span class="ident" id="1344372"><a href="/net/dnsclient.go.html#1344239">addrs</a></span><span class="op" id="1344377">)</span>&nbsp;<span class="op" id="1344379">&gt;</span>&nbsp;<span class="num" id="1344381">1</span>&nbsp;<span class="op" id="1344383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344387">s</span>&nbsp;<span class="op" id="1344389">:=</span>&nbsp;<span class="num" id="1344392">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344396">n</span>&nbsp;<span class="op" id="1344398">:=</span>&nbsp;<span class="ident" id="1344401"><a href="/net/dnsclient.go.html#1339642">rand</a></span><span class="op" id="1344405">.</span><span class="ident" id="1344406">Intn</span><span class="op" id="1344410">(</span><span class="ident" id="1344411"><a href="/net/dnsclient.go.html#1344284">sum</a></span><span class="op" id="1344414">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1344418">for</span>&nbsp;<span class="ident" id="1344422">i</span>&nbsp;<span class="op" id="1344424">:=</span>&nbsp;<span class="keyword" id="1344427">range</span>&nbsp;<span class="ident" id="1344433"><a href="/net/dnsclient.go.html#1344239">addrs</a></span>&nbsp;<span class="op" id="1344439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344444"><a href="/net/dnsclient.go.html#1344387">s</a></span>&nbsp;<span class="op" id="1344446">+=</span>&nbsp;<span class="builtintype" id="1344449">int</span><span class="op" id="1344452">(</span><span class="ident" id="1344453"><a href="/net/dnsclient.go.html#1344239">addrs</a></span><span class="op" id="1344458">[</span><span class="ident" id="1344459"><a href="/net/dnsclient.go.html#1344422">i</a></span><span class="op" id="1344460">]</span><span class="op" id="1344461">.</span><span class="ident" id="1344462">Weight</span><span class="op" id="1344468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1344473">if</span>&nbsp;<span class="ident" id="1344476"><a href="/net/dnsclient.go.html#1344387">s</a></span>&nbsp;<span class="op" id="1344478">&gt;</span>&nbsp;<span class="ident" id="1344480"><a href="/net/dnsclient.go.html#1344396">n</a></span>&nbsp;<span class="op" id="1344482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1344488">if</span>&nbsp;<span class="ident" id="1344491"><a href="/net/dnsclient.go.html#1344422">i</a></span>&nbsp;<span class="op" id="1344493">&gt;</span>&nbsp;<span class="num" id="1344495">0</span>&nbsp;<span class="op" id="1344497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344504"><a href="/net/dnsclient.go.html#1344239">addrs</a></span><span class="op" id="1344509">[</span><span class="num" id="1344510">0</span><span class="op" id="1344511">]</span><span class="op" id="1344512">,</span>&nbsp;<span class="ident" id="1344514"><a href="/net/dnsclient.go.html#1344239">addrs</a></span><span class="op" id="1344519">[</span><span class="ident" id="1344520"><a href="/net/dnsclient.go.html#1344422">i</a></span><span class="op" id="1344521">]</span>&nbsp;<span class="op" id="1344523">=</span>&nbsp;<span class="ident" id="1344525"><a href="/net/dnsclient.go.html#1344239">addrs</a></span><span class="op" id="1344530">[</span><span class="ident" id="1344531"><a href="/net/dnsclient.go.html#1344422">i</a></span><span class="op" id="1344532">]</span><span class="op" id="1344533">,</span>&nbsp;<span class="ident" id="1344535"><a href="/net/dnsclient.go.html#1344239">addrs</a></span><span class="op" id="1344540">[</span><span class="num" id="1344541">0</span><span class="op" id="1344542">]</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1344548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1344554">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1344563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1344567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344571"><a href="/net/dnsclient.go.html#1344284">sum</a></span>&nbsp;<span class="op" id="1344575">-=</span>&nbsp;<span class="builtintype" id="1344578">int</span><span class="op" id="1344581">(</span><span class="ident" id="1344582"><a href="/net/dnsclient.go.html#1344239">addrs</a></span><span class="op" id="1344587">[</span><span class="num" id="1344588">0</span><span class="op" id="1344589">]</span><span class="op" id="1344590">.</span><span class="ident" id="1344591">Weight</span><span class="op" id="1344597">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344601"><a href="/net/dnsclient.go.html#1344239">addrs</a></span>&nbsp;<span class="op" id="1344607">=</span>&nbsp;<span class="ident" id="1344609"><a href="/net/dnsclient.go.html#1344239">addrs</a></span><span class="op" id="1344614">[</span><span class="num" id="1344615">1</span><span class="op" id="1344616">:</span><span class="op" id="1344617">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1344620">}</span><br>
<span class="lineno"></span><span class="op" id="1344622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1344625">//&nbsp;sort&nbsp;reorders&nbsp;SRV&nbsp;records&nbsp;as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;2782.</span><br>
<span class="lineno">210</span><span class="keyword" id="1344680">func</span>&nbsp;<span class="op" id="1344685">(</span><span class="ident" id="1344686">addrs</span>&nbsp;<span class="ident" id="1344692"><a href="/net/dnsclient.go.html#1343831">byPriorityWeight</a></span><span class="op" id="1344708">)</span>&nbsp;<span class="ident" id="1344710">sort</span><span class="op" id="1344714">(</span><span class="op" id="1344715">)</span>&nbsp;<span class="op" id="1344717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344720"><a href="/net/dnsclient.go.html#1339655">sort</a></span><span class="op" id="1344724">.</span><span class="ident" id="1344725">Sort</span><span class="op" id="1344729">(</span><span class="ident" id="1344730"><a href="/net/dnsclient.go.html#1344686">addrs</a></span><span class="op" id="1344735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344738">i</span>&nbsp;<span class="op" id="1344740">:=</span>&nbsp;<span class="num" id="1344743">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1344746">for</span>&nbsp;<span class="ident" id="1344750">j</span>&nbsp;<span class="op" id="1344752">:=</span>&nbsp;<span class="num" id="1344755">1</span><span class="op" id="1344756">;</span>&nbsp;<span class="ident" id="1344758"><a href="/net/dnsclient.go.html#1344750">j</a></span>&nbsp;<span class="op" id="1344760">&lt;</span>&nbsp;<span class="builtinfunc" id="1344762">len</span><span class="op" id="1344765">(</span><span class="ident" id="1344766"><a href="/net/dnsclient.go.html#1344686">addrs</a></span><span class="op" id="1344771">)</span><span class="op" id="1344772">;</span>&nbsp;<span class="ident" id="1344774"><a href="/net/dnsclient.go.html#1344750">j</a></span><span class="op" id="1344775">++</span>&nbsp;<span class="op" id="1344778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1344782">if</span>&nbsp;<span class="ident" id="1344785"><a href="/net/dnsclient.go.html#1344686">addrs</a></span><span class="op" id="1344790">[</span><span class="ident" id="1344791"><a href="/net/dnsclient.go.html#1344738">i</a></span><span class="op" id="1344792">]</span><span class="op" id="1344793">.</span><span class="ident" id="1344794">Priority</span>&nbsp;<span class="op" id="1344803">!=</span>&nbsp;<span class="ident" id="1344806"><a href="/net/dnsclient.go.html#1344686">addrs</a></span><span class="op" id="1344811">[</span><span class="ident" id="1344812"><a href="/net/dnsclient.go.html#1344750">j</a></span><span class="op" id="1344813">]</span><span class="op" id="1344814">.</span><span class="ident" id="1344815">Priority</span>&nbsp;<span class="op" id="1344824">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344829"><a href="/net/dnsclient.go.html#1344686">addrs</a></span><span class="op" id="1344834">[</span><span class="ident" id="1344835"><a href="/net/dnsclient.go.html#1344738">i</a></span><span class="op" id="1344836">:</span><span class="ident" id="1344837"><a href="/net/dnsclient.go.html#1344750">j</a></span><span class="op" id="1344838">]</span><span class="op" id="1344839">.</span><span class="ident" id="1344840">shuffleByWeight</span><span class="op" id="1344855">(</span><span class="op" id="1344856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344861"><a href="/net/dnsclient.go.html#1344738">i</a></span>&nbsp;<span class="op" id="1344863">=</span>&nbsp;<span class="ident" id="1344865"><a href="/net/dnsclient.go.html#1344750">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1344869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1344872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344875"><a href="/net/dnsclient.go.html#1344686">addrs</a></span><span class="op" id="1344880">[</span><span class="ident" id="1344881"><a href="/net/dnsclient.go.html#1344738">i</a></span><span class="op" id="1344882">:</span><span class="op" id="1344883">]</span><span class="op" id="1344884">.</span><span class="ident" id="1344885">shuffleByWeight</span><span class="op" id="1344900">(</span><span class="op" id="1344901">)</span><br>
<span class="lineno">220</span><span class="op" id="1344903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1344906">//&nbsp;An&nbsp;MX&nbsp;represents&nbsp;a&nbsp;single&nbsp;DNS&nbsp;MX&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="1344950">type</span>&nbsp;<span class="ident" id="1344955">MX</span>&nbsp;<span class="keyword" id="1344958">struct</span>&nbsp;<span class="op" id="1344965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344968">Host</span>&nbsp;<span class="builtintype" id="1344973">string</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1344981">Pref</span>&nbsp;<span class="builtintype" id="1344986">uint16</span><br>
<span class="lineno"></span><span class="op" id="1344993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1344996">//&nbsp;byPref&nbsp;implements&nbsp;sort.Interface&nbsp;to&nbsp;sort&nbsp;MX&nbsp;records&nbsp;by&nbsp;preference</span><br>
<span class="lineno"></span><span class="keyword" id="1345065">type</span>&nbsp;<span class="ident" id="1345070">byPref</span>&nbsp;<span class="op" id="1345077">[</span><span class="op" id="1345078">]</span><span class="op" id="1345079">*</span><span class="ident" id="1345080"><a href="/net/dnsclient.go.html#1344955">MX</a></span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="1345084">func</span>&nbsp;<span class="op" id="1345089">(</span><span class="ident" id="1345090">s</span>&nbsp;<span class="ident" id="1345092"><a href="/net/dnsclient.go.html#1345070">byPref</a></span><span class="op" id="1345098">)</span>&nbsp;<span class="ident" id="1345100">Len</span><span class="op" id="1345103">(</span><span class="op" id="1345104">)</span>&nbsp;<span class="builtintype" id="1345106">int</span>&nbsp;<span class="op" id="1345110">{</span>&nbsp;<span class="keyword" id="1345112">return</span>&nbsp;<span class="builtinfunc" id="1345119">len</span><span class="op" id="1345122">(</span><span class="ident" id="1345123"><a href="/net/dnsclient.go.html#1345090">s</a></span><span class="op" id="1345124">)</span>&nbsp;<span class="op" id="1345126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1345129">func</span>&nbsp;<span class="op" id="1345134">(</span><span class="ident" id="1345135">s</span>&nbsp;<span class="ident" id="1345137"><a href="/net/dnsclient.go.html#1345070">byPref</a></span><span class="op" id="1345143">)</span>&nbsp;<span class="ident" id="1345145">Less</span><span class="op" id="1345149">(</span><span class="ident" id="1345150">i</span><span class="op" id="1345151">,</span>&nbsp;<span class="ident" id="1345153">j</span>&nbsp;<span class="builtintype" id="1345155">int</span><span class="op" id="1345158">)</span>&nbsp;<span class="builtintype" id="1345160">bool</span>&nbsp;<span class="op" id="1345165">{</span>&nbsp;<span class="keyword" id="1345167">return</span>&nbsp;<span class="ident" id="1345174"><a href="/net/dnsclient.go.html#1345135">s</a></span><span class="op" id="1345175">[</span><span class="ident" id="1345176"><a href="/net/dnsclient.go.html#1345150">i</a></span><span class="op" id="1345177">]</span><span class="op" id="1345178">.</span><span class="ident" id="1345179">Pref</span>&nbsp;<span class="op" id="1345184">&lt;</span>&nbsp;<span class="ident" id="1345186"><a href="/net/dnsclient.go.html#1345135">s</a></span><span class="op" id="1345187">[</span><span class="ident" id="1345188"><a href="/net/dnsclient.go.html#1345153">j</a></span><span class="op" id="1345189">]</span><span class="op" id="1345190">.</span><span class="ident" id="1345191">Pref</span>&nbsp;<span class="op" id="1345196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="1345199">func</span>&nbsp;<span class="op" id="1345204">(</span><span class="ident" id="1345205">s</span>&nbsp;<span class="ident" id="1345207"><a href="/net/dnsclient.go.html#1345070">byPref</a></span><span class="op" id="1345213">)</span>&nbsp;<span class="ident" id="1345215">Swap</span><span class="op" id="1345219">(</span><span class="ident" id="1345220">i</span><span class="op" id="1345221">,</span>&nbsp;<span class="ident" id="1345223">j</span>&nbsp;<span class="builtintype" id="1345225">int</span><span class="op" id="1345228">)</span>&nbsp;<span class="op" id="1345230">{</span>&nbsp;<span class="ident" id="1345232"><a href="/net/dnsclient.go.html#1345205">s</a></span><span class="op" id="1345233">[</span><span class="ident" id="1345234"><a href="/net/dnsclient.go.html#1345220">i</a></span><span class="op" id="1345235">]</span><span class="op" id="1345236">,</span>&nbsp;<span class="ident" id="1345238"><a href="/net/dnsclient.go.html#1345205">s</a></span><span class="op" id="1345239">[</span><span class="ident" id="1345240"><a href="/net/dnsclient.go.html#1345223">j</a></span><span class="op" id="1345241">]</span>&nbsp;<span class="op" id="1345243">=</span>&nbsp;<span class="ident" id="1345245"><a href="/net/dnsclient.go.html#1345205">s</a></span><span class="op" id="1345246">[</span><span class="ident" id="1345247"><a href="/net/dnsclient.go.html#1345223">j</a></span><span class="op" id="1345248">]</span><span class="op" id="1345249">,</span>&nbsp;<span class="ident" id="1345251"><a href="/net/dnsclient.go.html#1345205">s</a></span><span class="op" id="1345252">[</span><span class="ident" id="1345253"><a href="/net/dnsclient.go.html#1345220">i</a></span><span class="op" id="1345254">]</span>&nbsp;<span class="op" id="1345256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1345259">//&nbsp;sort&nbsp;reorders&nbsp;MX&nbsp;records&nbsp;as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;5321.</span><br>
<span class="lineno"></span><span class="keyword" id="1345313">func</span>&nbsp;<span class="op" id="1345318">(</span><span class="ident" id="1345319">s</span>&nbsp;<span class="ident" id="1345321"><a href="/net/dnsclient.go.html#1345070">byPref</a></span><span class="op" id="1345327">)</span>&nbsp;<span class="ident" id="1345329">sort</span><span class="op" id="1345333">(</span><span class="op" id="1345334">)</span>&nbsp;<span class="op" id="1345336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1345339">for</span>&nbsp;<span class="ident" id="1345343">i</span>&nbsp;<span class="op" id="1345345">:=</span>&nbsp;<span class="keyword" id="1345348">range</span>&nbsp;<span class="ident" id="1345354"><a href="/net/dnsclient.go.html#1345319">s</a></span>&nbsp;<span class="op" id="1345356">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345360">j</span>&nbsp;<span class="op" id="1345362">:=</span>&nbsp;<span class="ident" id="1345365"><a href="/net/dnsclient.go.html#1339642">rand</a></span><span class="op" id="1345369">.</span><span class="ident" id="1345370">Intn</span><span class="op" id="1345374">(</span><span class="ident" id="1345375"><a href="/net/dnsclient.go.html#1345343">i</a></span>&nbsp;<span class="op" id="1345377">+</span>&nbsp;<span class="num" id="1345379">1</span><span class="op" id="1345380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345384"><a href="/net/dnsclient.go.html#1345319">s</a></span><span class="op" id="1345385">[</span><span class="ident" id="1345386"><a href="/net/dnsclient.go.html#1345343">i</a></span><span class="op" id="1345387">]</span><span class="op" id="1345388">,</span>&nbsp;<span class="ident" id="1345390"><a href="/net/dnsclient.go.html#1345319">s</a></span><span class="op" id="1345391">[</span><span class="ident" id="1345392"><a href="/net/dnsclient.go.html#1345360">j</a></span><span class="op" id="1345393">]</span>&nbsp;<span class="op" id="1345395">=</span>&nbsp;<span class="ident" id="1345397"><a href="/net/dnsclient.go.html#1345319">s</a></span><span class="op" id="1345398">[</span><span class="ident" id="1345399"><a href="/net/dnsclient.go.html#1345360">j</a></span><span class="op" id="1345400">]</span><span class="op" id="1345401">,</span>&nbsp;<span class="ident" id="1345403"><a href="/net/dnsclient.go.html#1345319">s</a></span><span class="op" id="1345404">[</span><span class="ident" id="1345405"><a href="/net/dnsclient.go.html#1345343">i</a></span><span class="op" id="1345406">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1345409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345412"><a href="/net/dnsclient.go.html#1339655">sort</a></span><span class="op" id="1345416">.</span><span class="ident" id="1345417">Sort</span><span class="op" id="1345421">(</span><span class="ident" id="1345422"><a href="/net/dnsclient.go.html#1345319">s</a></span><span class="op" id="1345423">)</span><br>
<span class="lineno"></span><span class="op" id="1345425">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="1345428">//&nbsp;An&nbsp;NS&nbsp;represents&nbsp;a&nbsp;single&nbsp;DNS&nbsp;NS&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="1345472">type</span>&nbsp;<span class="ident" id="1345477">NS</span>&nbsp;<span class="keyword" id="1345480">struct</span>&nbsp;<span class="op" id="1345487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345490">Host</span>&nbsp;<span class="builtintype" id="1345495">string</span><br>
<span class="lineno"></span><span class="op" id="1345502">}</span>
</div>
</body>
</html>
