<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html" class="current">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6647254">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6647309">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6647363">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6647414">package</span>&nbsp;<span class="ident" id="6647422">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6647427">import</span>&nbsp;<span class="op" id="6647434">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6647437">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6647445">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6647452">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6647458">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6647469">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6647480">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6647490">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6647493">//&nbsp;If&nbsp;an&nbsp;IPv6&nbsp;tunnel&nbsp;is&nbsp;running,&nbsp;we&nbsp;can&nbsp;try&nbsp;dialing&nbsp;a&nbsp;real&nbsp;IPv6&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="6647566">var</span>&nbsp;<span class="ident" id="6647570">testIPv6</span>&nbsp;<span class="op" id="6647579">=</span>&nbsp;<span class="ident" id="6647581">flag</span><span class="op" id="6647585">.</span><span class="ident" id="6647586">Bool</span><span class="op" id="6647590">(</span><span class="string" id="6647591">&#34;ipv6&#34;</span><span class="op" id="6647597">,</span>&nbsp;<span class="builtintype" id="6647599">false</span><span class="op" id="6647604">,</span>&nbsp;<span class="string" id="6647606">&#34;assume&nbsp;ipv6&nbsp;tunnel&nbsp;is&nbsp;present&#34;</span><span class="op" id="6647637">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6647640">func</span>&nbsp;<span class="ident" id="6647645">TestResolveGoogle</span><span class="op" id="6647662">(</span><span class="ident" id="6647663">t</span>&nbsp;<span class="op" id="6647665">*</span><span class="ident" id="6647666">testing</span><span class="op" id="6647673">.</span><span class="ident" id="6647674">T</span><span class="op" id="6647675">)</span>&nbsp;<span class="op" id="6647677">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647680">if</span>&nbsp;<span class="ident" id="6647683">testing</span><span class="op" id="6647690">.</span><span class="ident" id="6647691">Short</span><span class="op" id="6647696">(</span><span class="op" id="6647697">)</span>&nbsp;<span class="op" id="6647699">||</span>&nbsp;<span class="op" id="6647702">!</span><span class="op" id="6647703">*</span><span class="ident" id="6647704">testExternal</span>&nbsp;<span class="op" id="6647717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647721">t</span><span class="op" id="6647722">.</span><span class="ident" id="6647723">Skip</span><span class="op" id="6647727">(</span><span class="string" id="6647728">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6647769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647776">for</span>&nbsp;<span class="ident" id="6647780">_</span><span class="op" id="6647781">,</span>&nbsp;<span class="ident" id="6647783">network</span>&nbsp;<span class="op" id="6647791">:=</span>&nbsp;<span class="keyword" id="6647794">range</span>&nbsp;<span class="op" id="6647800">[</span><span class="op" id="6647801">]</span><span class="builtintype" id="6647802">string</span><span class="op" id="6647808">{</span><span class="string" id="6647809">&#34;tcp&#34;</span><span class="op" id="6647814">,</span>&nbsp;<span class="string" id="6647816">&#34;tcp4&#34;</span><span class="op" id="6647822">,</span>&nbsp;<span class="string" id="6647824">&#34;tcp6&#34;</span><span class="op" id="6647830">}</span>&nbsp;<span class="op" id="6647832">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647836">addr</span><span class="op" id="6647840">,</span>&nbsp;<span class="ident" id="6647842">err</span>&nbsp;<span class="op" id="6647846">:=</span>&nbsp;<span class="ident" id="6647849">ResolveTCPAddr</span><span class="op" id="6647863">(</span><span class="ident" id="6647864">network</span><span class="op" id="6647871">,</span>&nbsp;<span class="string" id="6647873">&#34;www.google.com:http&#34;</span><span class="op" id="6647894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647898">if</span>&nbsp;<span class="ident" id="6647901">err</span>&nbsp;<span class="op" id="6647905">!=</span>&nbsp;<span class="builtintype" id="6647908">nil</span>&nbsp;<span class="op" id="6647912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647917">if</span>&nbsp;<span class="op" id="6647920">(</span><span class="ident" id="6647921">network</span>&nbsp;<span class="op" id="6647929">==</span>&nbsp;<span class="string" id="6647932">&#34;tcp&#34;</span>&nbsp;<span class="op" id="6647938">||</span>&nbsp;<span class="ident" id="6647941">network</span>&nbsp;<span class="op" id="6647949">==</span>&nbsp;<span class="string" id="6647952">&#34;tcp4&#34;</span><span class="op" id="6647958">)</span>&nbsp;<span class="op" id="6647960">&amp;&amp;</span>&nbsp;<span class="op" id="6647963">!</span><span class="ident" id="6647964">supportsIPv4</span>&nbsp;<span class="op" id="6647977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647983">t</span><span class="op" id="6647984">.</span><span class="ident" id="6647985">Logf</span><span class="op" id="6647989">(</span><span class="string" id="6647990">&#34;ipv4&nbsp;is&nbsp;not&nbsp;supported:&nbsp;%v&#34;</span><span class="op" id="6648017">,</span>&nbsp;<span class="ident" id="6648019">err</span><span class="op" id="6648022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6648027">}</span>&nbsp;<span class="keyword" id="6648029">else</span>&nbsp;<span class="keyword" id="6648034">if</span>&nbsp;<span class="ident" id="6648037">network</span>&nbsp;<span class="op" id="6648045">==</span>&nbsp;<span class="string" id="6648048">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="6648055">&amp;&amp;</span>&nbsp;<span class="op" id="6648058">!</span><span class="ident" id="6648059">supportsIPv6</span>&nbsp;<span class="op" id="6648072">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648078">t</span><span class="op" id="6648079">.</span><span class="ident" id="6648080">Logf</span><span class="op" id="6648084">(</span><span class="string" id="6648085">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported:&nbsp;%v&#34;</span><span class="op" id="6648112">,</span>&nbsp;<span class="ident" id="6648114">err</span><span class="op" id="6648117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6648122">}</span>&nbsp;<span class="keyword" id="6648124">else</span>&nbsp;<span class="op" id="6648129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648135">t</span><span class="op" id="6648136">.</span><span class="ident" id="6648137">Errorf</span><span class="op" id="6648143">(</span><span class="string" id="6648144">&#34;ResolveTCPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6648171">,</span>&nbsp;<span class="ident" id="6648173">err</span><span class="op" id="6648176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6648181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6648186">continue</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6648197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6648201">if</span>&nbsp;<span class="op" id="6648204">(</span><span class="ident" id="6648205">network</span>&nbsp;<span class="op" id="6648213">==</span>&nbsp;<span class="string" id="6648216">&#34;tcp&#34;</span>&nbsp;<span class="op" id="6648222">||</span>&nbsp;<span class="ident" id="6648225">network</span>&nbsp;<span class="op" id="6648233">==</span>&nbsp;<span class="string" id="6648236">&#34;tcp4&#34;</span><span class="op" id="6648242">)</span>&nbsp;<span class="op" id="6648244">&amp;&amp;</span>&nbsp;<span class="ident" id="6648247">addr</span><span class="op" id="6648251">.</span><span class="ident" id="6648252">IP</span><span class="op" id="6648254">.</span><span class="ident" id="6648255">To4</span><span class="op" id="6648258">(</span><span class="op" id="6648259">)</span>&nbsp;<span class="op" id="6648261">==</span>&nbsp;<span class="builtintype" id="6648264">nil</span>&nbsp;<span class="op" id="6648268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648273">t</span><span class="op" id="6648274">.</span><span class="ident" id="6648275">Errorf</span><span class="op" id="6648281">(</span><span class="string" id="6648282">&#34;got&nbsp;%v;&nbsp;expected&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;on&nbsp;%v&#34;</span><span class="op" id="6648322">,</span>&nbsp;<span class="ident" id="6648324">addr</span><span class="op" id="6648328">,</span>&nbsp;<span class="ident" id="6648330">network</span><span class="op" id="6648337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6648341">}</span>&nbsp;<span class="keyword" id="6648343">else</span>&nbsp;<span class="keyword" id="6648348">if</span>&nbsp;<span class="ident" id="6648351">network</span>&nbsp;<span class="op" id="6648359">==</span>&nbsp;<span class="string" id="6648362">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="6648369">&amp;&amp;</span>&nbsp;<span class="op" id="6648372">(</span><span class="ident" id="6648373">addr</span><span class="op" id="6648377">.</span><span class="ident" id="6648378">IP</span><span class="op" id="6648380">.</span><span class="ident" id="6648381">To16</span><span class="op" id="6648385">(</span><span class="op" id="6648386">)</span>&nbsp;<span class="op" id="6648388">==</span>&nbsp;<span class="builtintype" id="6648391">nil</span>&nbsp;<span class="op" id="6648395">||</span>&nbsp;<span class="ident" id="6648398">addr</span><span class="op" id="6648402">.</span><span class="ident" id="6648403">IP</span><span class="op" id="6648405">.</span><span class="ident" id="6648406">To4</span><span class="op" id="6648409">(</span><span class="op" id="6648410">)</span>&nbsp;<span class="op" id="6648412">!=</span>&nbsp;<span class="builtintype" id="6648415">nil</span><span class="op" id="6648418">)</span>&nbsp;<span class="op" id="6648420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648425">t</span><span class="op" id="6648426">.</span><span class="ident" id="6648427">Errorf</span><span class="op" id="6648433">(</span><span class="string" id="6648434">&#34;got&nbsp;%v;&nbsp;expected&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;on&nbsp;%v&#34;</span><span class="op" id="6648474">,</span>&nbsp;<span class="ident" id="6648476">addr</span><span class="op" id="6648480">,</span>&nbsp;<span class="ident" id="6648482">network</span><span class="op" id="6648489">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6648493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6648496">}</span><br>
<span class="lineno"></span><span class="op" id="6648498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6648501">func</span>&nbsp;<span class="ident" id="6648506">TestDialGoogle</span><span class="op" id="6648520">(</span><span class="ident" id="6648521">t</span>&nbsp;<span class="op" id="6648523">*</span><span class="ident" id="6648524">testing</span><span class="op" id="6648531">.</span><span class="ident" id="6648532">T</span><span class="op" id="6648533">)</span>&nbsp;<span class="op" id="6648535">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6648538">if</span>&nbsp;<span class="ident" id="6648541">testing</span><span class="op" id="6648548">.</span><span class="ident" id="6648549">Short</span><span class="op" id="6648554">(</span><span class="op" id="6648555">)</span>&nbsp;<span class="op" id="6648557">||</span>&nbsp;<span class="op" id="6648560">!</span><span class="op" id="6648561">*</span><span class="ident" id="6648562">testExternal</span>&nbsp;<span class="op" id="6648575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648579">t</span><span class="op" id="6648580">.</span><span class="ident" id="6648581">Skip</span><span class="op" id="6648585">(</span><span class="string" id="6648586">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6648627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6648630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648634">d</span>&nbsp;<span class="op" id="6648636">:=</span>&nbsp;<span class="op" id="6648639">&amp;</span><span class="ident" id="6648640">Dialer</span><span class="op" id="6648646">{</span><span class="ident" id="6648647">DualStack</span><span class="op" id="6648656">:</span>&nbsp;<span class="builtintype" id="6648658">true</span><span class="op" id="6648662">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6648665">for</span>&nbsp;<span class="ident" id="6648669">_</span><span class="op" id="6648670">,</span>&nbsp;<span class="ident" id="6648672">network</span>&nbsp;<span class="op" id="6648680">:=</span>&nbsp;<span class="keyword" id="6648683">range</span>&nbsp;<span class="op" id="6648689">[</span><span class="op" id="6648690">]</span><span class="builtintype" id="6648691">string</span><span class="op" id="6648697">{</span><span class="string" id="6648698">&#34;tcp&#34;</span><span class="op" id="6648703">,</span>&nbsp;<span class="string" id="6648705">&#34;tcp4&#34;</span><span class="op" id="6648711">,</span>&nbsp;<span class="string" id="6648713">&#34;tcp6&#34;</span><span class="op" id="6648719">}</span>&nbsp;<span class="op" id="6648721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6648725">if</span>&nbsp;<span class="ident" id="6648728">network</span>&nbsp;<span class="op" id="6648736">==</span>&nbsp;<span class="string" id="6648739">&#34;tcp&#34;</span>&nbsp;<span class="op" id="6648745">&amp;&amp;</span>&nbsp;<span class="op" id="6648748">!</span><span class="ident" id="6648749">supportsIPv4</span>&nbsp;<span class="op" id="6648762">&amp;&amp;</span>&nbsp;<span class="op" id="6648765">!</span><span class="ident" id="6648766">supportsIPv6</span>&nbsp;<span class="op" id="6648779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648784">t</span><span class="op" id="6648785">.</span><span class="ident" id="6648786">Logf</span><span class="op" id="6648790">(</span><span class="string" id="6648791">&#34;skipping&nbsp;test;&nbsp;both&nbsp;ipv4&nbsp;and&nbsp;ipv6&nbsp;are&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6648844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6648849">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6648860">}</span>&nbsp;<span class="keyword" id="6648862">else</span>&nbsp;<span class="keyword" id="6648867">if</span>&nbsp;<span class="ident" id="6648870">network</span>&nbsp;<span class="op" id="6648878">==</span>&nbsp;<span class="string" id="6648881">&#34;tcp4&#34;</span>&nbsp;<span class="op" id="6648888">&amp;&amp;</span>&nbsp;<span class="op" id="6648891">!</span><span class="ident" id="6648892">supportsIPv4</span>&nbsp;<span class="op" id="6648905">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648910">t</span><span class="op" id="6648911">.</span><span class="ident" id="6648912">Logf</span><span class="op" id="6648916">(</span><span class="string" id="6648917">&#34;skipping&nbsp;test;&nbsp;ipv4&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6648955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6648960">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6648971">}</span>&nbsp;<span class="keyword" id="6648973">else</span>&nbsp;<span class="keyword" id="6648978">if</span>&nbsp;<span class="ident" id="6648981">network</span>&nbsp;<span class="op" id="6648989">==</span>&nbsp;<span class="string" id="6648992">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="6648999">&amp;&amp;</span>&nbsp;<span class="op" id="6649002">!</span><span class="ident" id="6649003">supportsIPv6</span>&nbsp;<span class="op" id="6649016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649021">t</span><span class="op" id="6649022">.</span><span class="ident" id="6649023">Logf</span><span class="op" id="6649027">(</span><span class="string" id="6649028">&#34;skipping&nbsp;test;&nbsp;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6649066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6649071">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6649082">}</span>&nbsp;<span class="keyword" id="6649084">else</span>&nbsp;<span class="keyword" id="6649089">if</span>&nbsp;<span class="ident" id="6649092">network</span>&nbsp;<span class="op" id="6649100">==</span>&nbsp;<span class="string" id="6649103">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="6649110">&amp;&amp;</span>&nbsp;<span class="op" id="6649113">!</span><span class="op" id="6649114">*</span><span class="ident" id="6649115">testIPv6</span>&nbsp;<span class="op" id="6649124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649129">t</span><span class="op" id="6649130">.</span><span class="ident" id="6649131">Logf</span><span class="op" id="6649135">(</span><span class="string" id="6649136">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-ipv6&nbsp;to&nbsp;enable&#34;</span><span class="op" id="6649172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6649177">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6649188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6649192">if</span>&nbsp;<span class="ident" id="6649195">c</span><span class="op" id="6649196">,</span>&nbsp;<span class="ident" id="6649198">err</span>&nbsp;<span class="op" id="6649202">:=</span>&nbsp;<span class="ident" id="6649205">d</span><span class="op" id="6649206">.</span><span class="ident" id="6649207">Dial</span><span class="op" id="6649211">(</span><span class="ident" id="6649212">network</span><span class="op" id="6649219">,</span>&nbsp;<span class="string" id="6649221">&#34;www.google.com:http&#34;</span><span class="op" id="6649242">)</span><span class="op" id="6649243">;</span>&nbsp;<span class="ident" id="6649245">err</span>&nbsp;<span class="op" id="6649249">!=</span>&nbsp;<span class="builtintype" id="6649252">nil</span>&nbsp;<span class="op" id="6649256">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649261">t</span><span class="op" id="6649262">.</span><span class="ident" id="6649263">Errorf</span><span class="op" id="6649269">(</span><span class="string" id="6649270">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6649287">,</span>&nbsp;<span class="ident" id="6649289">err</span><span class="op" id="6649292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6649296">}</span>&nbsp;<span class="keyword" id="6649298">else</span>&nbsp;<span class="op" id="6649303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649308">c</span><span class="op" id="6649309">.</span><span class="ident" id="6649310">Close</span><span class="op" id="6649315">(</span><span class="op" id="6649316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6649320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6649323">}</span><br>
<span class="lineno">70</span><span class="op" id="6649325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6649328">//&nbsp;fd&nbsp;is&nbsp;already&nbsp;connected&nbsp;to&nbsp;the&nbsp;destination,&nbsp;port&nbsp;80.</span><br>
<span class="lineno"></span><span class="comment" id="6649384">//&nbsp;Run&nbsp;an&nbsp;HTTP&nbsp;request&nbsp;to&nbsp;fetch&nbsp;the&nbsp;appropriate&nbsp;page.</span><br>
<span class="lineno"></span><span class="keyword" id="6649438">func</span>&nbsp;<span class="ident" id="6649443">fetchGoogle</span><span class="op" id="6649454">(</span><span class="ident" id="6649455">t</span>&nbsp;<span class="op" id="6649457">*</span><span class="ident" id="6649458">testing</span><span class="op" id="6649465">.</span><span class="ident" id="6649466">T</span><span class="op" id="6649467">,</span>&nbsp;<span class="ident" id="6649469">fd</span>&nbsp;<span class="ident" id="6649472">Conn</span><span class="op" id="6649476">,</span>&nbsp;<span class="ident" id="6649478">network</span><span class="op" id="6649485">,</span>&nbsp;<span class="ident" id="6649487">addr</span>&nbsp;<span class="builtintype" id="6649492">string</span><span class="op" id="6649498">)</span>&nbsp;<span class="op" id="6649500">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649503">req</span>&nbsp;<span class="op" id="6649507">:=</span>&nbsp;<span class="op" id="6649510">[</span><span class="op" id="6649511">]</span><span class="builtintype" id="6649512">byte</span><span class="op" id="6649516">(</span><span class="string" id="6649517">&#34;GET&nbsp;/robots.txt&nbsp;HTTP/1.0\r\nHost:&nbsp;www.google.com\r\n\r\n&#34;</span><span class="op" id="6649575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649578">n</span><span class="op" id="6649579">,</span>&nbsp;<span class="ident" id="6649581">err</span>&nbsp;<span class="op" id="6649585">:=</span>&nbsp;<span class="ident" id="6649588">fd</span><span class="op" id="6649590">.</span><span class="ident" id="6649591">Write</span><span class="op" id="6649596">(</span><span class="ident" id="6649597">req</span><span class="op" id="6649600">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649604">buf</span>&nbsp;<span class="op" id="6649608">:=</span>&nbsp;<span class="builtinfunc" id="6649611">make</span><span class="op" id="6649615">(</span><span class="op" id="6649616">[</span><span class="op" id="6649617">]</span><span class="builtintype" id="6649618">byte</span><span class="op" id="6649622">,</span>&nbsp;<span class="num" id="6649624">1000</span><span class="op" id="6649628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649631">n</span><span class="op" id="6649632">,</span>&nbsp;<span class="ident" id="6649634">err</span>&nbsp;<span class="op" id="6649638">=</span>&nbsp;<span class="ident" id="6649640">io</span><span class="op" id="6649642">.</span><span class="ident" id="6649643">ReadFull</span><span class="op" id="6649651">(</span><span class="ident" id="6649652">fd</span><span class="op" id="6649654">,</span>&nbsp;<span class="ident" id="6649656">buf</span><span class="op" id="6649659">)</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6649663">if</span>&nbsp;<span class="ident" id="6649666">n</span>&nbsp;<span class="op" id="6649668">&lt;</span>&nbsp;<span class="num" id="6649670">1000</span>&nbsp;<span class="op" id="6649675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649679">t</span><span class="op" id="6649680">.</span><span class="ident" id="6649681">Errorf</span><span class="op" id="6649687">(</span><span class="string" id="6649688">&#34;fetchGoogle:&nbsp;short&nbsp;HTTP&nbsp;read&nbsp;from&nbsp;%s&nbsp;%s&nbsp;-&nbsp;%v&#34;</span><span class="op" id="6649734">,</span>&nbsp;<span class="ident" id="6649736">network</span><span class="op" id="6649743">,</span>&nbsp;<span class="ident" id="6649745">addr</span><span class="op" id="6649749">,</span>&nbsp;<span class="ident" id="6649751">err</span><span class="op" id="6649754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6649758">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6649766">}</span><br>
<span class="lineno">85</span><span class="op" id="6649768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6649771">func</span>&nbsp;<span class="ident" id="6649776">doDial</span><span class="op" id="6649782">(</span><span class="ident" id="6649783">t</span>&nbsp;<span class="op" id="6649785">*</span><span class="ident" id="6649786">testing</span><span class="op" id="6649793">.</span><span class="ident" id="6649794">T</span><span class="op" id="6649795">,</span>&nbsp;<span class="ident" id="6649797">network</span><span class="op" id="6649804">,</span>&nbsp;<span class="ident" id="6649806">addr</span>&nbsp;<span class="builtintype" id="6649811">string</span><span class="op" id="6649817">)</span>&nbsp;<span class="op" id="6649819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649822">fd</span><span class="op" id="6649824">,</span>&nbsp;<span class="ident" id="6649826">err</span>&nbsp;<span class="op" id="6649830">:=</span>&nbsp;<span class="ident" id="6649833">Dial</span><span class="op" id="6649837">(</span><span class="ident" id="6649838">network</span><span class="op" id="6649845">,</span>&nbsp;<span class="ident" id="6649847">addr</span><span class="op" id="6649851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6649854">if</span>&nbsp;<span class="ident" id="6649857">err</span>&nbsp;<span class="op" id="6649861">!=</span>&nbsp;<span class="builtintype" id="6649864">nil</span>&nbsp;<span class="op" id="6649868">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649872">t</span><span class="op" id="6649873">.</span><span class="ident" id="6649874">Errorf</span><span class="op" id="6649880">(</span><span class="string" id="6649881">&#34;Dial(%q,&nbsp;%q,&nbsp;%q)&nbsp;=&nbsp;_,&nbsp;%v&#34;</span><span class="op" id="6649907">,</span>&nbsp;<span class="ident" id="6649909">network</span><span class="op" id="6649916">,</span>&nbsp;<span class="string" id="6649918">&#34;&#34;</span><span class="op" id="6649920">,</span>&nbsp;<span class="ident" id="6649922">addr</span><span class="op" id="6649926">,</span>&nbsp;<span class="ident" id="6649928">err</span><span class="op" id="6649931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6649935">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6649943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649946">fetchGoogle</span><span class="op" id="6649957">(</span><span class="ident" id="6649958">t</span><span class="op" id="6649959">,</span>&nbsp;<span class="ident" id="6649961">fd</span><span class="op" id="6649963">,</span>&nbsp;<span class="ident" id="6649965">network</span><span class="op" id="6649972">,</span>&nbsp;<span class="ident" id="6649974">addr</span><span class="op" id="6649978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649981">fd</span><span class="op" id="6649983">.</span><span class="ident" id="6649984">Close</span><span class="op" id="6649989">(</span><span class="op" id="6649990">)</span><br>
<span class="lineno">95</span><span class="op" id="6649992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6649995">var</span>&nbsp;<span class="ident" id="6649999">googleaddrsipv4</span>&nbsp;<span class="op" id="6650015">=</span>&nbsp;<span class="op" id="6650017">[</span><span class="op" id="6650018">]</span><span class="builtintype" id="6650019">string</span><span class="op" id="6650025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6650028">&#34;%d.%d.%d.%d:80&#34;</span><span class="op" id="6650044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6650047">&#34;www.google.com:80&#34;</span><span class="op" id="6650066">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6650069">&#34;%d.%d.%d.%d:http&#34;</span><span class="op" id="6650087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6650090">&#34;www.google.com:http&#34;</span><span class="op" id="6650111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6650114">&#34;%03d.%03d.%03d.%03d:0080&#34;</span><span class="op" id="6650140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6650143">&#34;[::ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="6650168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6650171">&#34;[::ffff:%02x%02x:%02x%02x]:80&#34;</span><span class="op" id="6650202">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6650205">&#34;[0:0:0:0:0000:ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="6650241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6650244">&#34;[0:0:0:0:000000:ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="6650282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6650285">&#34;[0:0:0:0::ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="6650317">,</span><br>
<span class="lineno"></span><span class="op" id="6650319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="6650322">func</span>&nbsp;<span class="ident" id="6650327">TestDialGoogleIPv4</span><span class="op" id="6650345">(</span><span class="ident" id="6650346">t</span>&nbsp;<span class="op" id="6650348">*</span><span class="ident" id="6650349">testing</span><span class="op" id="6650356">.</span><span class="ident" id="6650357">T</span><span class="op" id="6650358">)</span>&nbsp;<span class="op" id="6650360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650363">if</span>&nbsp;<span class="ident" id="6650366">testing</span><span class="op" id="6650373">.</span><span class="ident" id="6650374">Short</span><span class="op" id="6650379">(</span><span class="op" id="6650380">)</span>&nbsp;<span class="op" id="6650382">||</span>&nbsp;<span class="op" id="6650385">!</span><span class="op" id="6650386">*</span><span class="ident" id="6650387">testExternal</span>&nbsp;<span class="op" id="6650400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650404">t</span><span class="op" id="6650405">.</span><span class="ident" id="6650406">Skip</span><span class="op" id="6650410">(</span><span class="string" id="6650411">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6650452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6650455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6650459">//&nbsp;Insert&nbsp;an&nbsp;actual&nbsp;IPv4&nbsp;address&nbsp;for&nbsp;google.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6650508">//&nbsp;into&nbsp;the&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650528">addrs</span><span class="op" id="6650533">,</span>&nbsp;<span class="ident" id="6650535">err</span>&nbsp;<span class="op" id="6650539">:=</span>&nbsp;<span class="ident" id="6650542">LookupIP</span><span class="op" id="6650550">(</span><span class="string" id="6650551">&#34;www.google.com&#34;</span><span class="op" id="6650567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650570">if</span>&nbsp;<span class="ident" id="6650573">err</span>&nbsp;<span class="op" id="6650577">!=</span>&nbsp;<span class="builtintype" id="6650580">nil</span>&nbsp;<span class="op" id="6650584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650588">t</span><span class="op" id="6650589">.</span><span class="ident" id="6650590">Fatalf</span><span class="op" id="6650596">(</span><span class="string" id="6650597">&#34;lookup&nbsp;www.google.com:&nbsp;%v&#34;</span><span class="op" id="6650624">,</span>&nbsp;<span class="ident" id="6650626">err</span><span class="op" id="6650629">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6650632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650635">var</span>&nbsp;<span class="ident" id="6650639">ip</span>&nbsp;<span class="ident" id="6650642">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650646">for</span>&nbsp;<span class="ident" id="6650650">_</span><span class="op" id="6650651">,</span>&nbsp;<span class="ident" id="6650653">addr</span>&nbsp;<span class="op" id="6650658">:=</span>&nbsp;<span class="keyword" id="6650661">range</span>&nbsp;<span class="ident" id="6650667">addrs</span>&nbsp;<span class="op" id="6650673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650677">if</span>&nbsp;<span class="ident" id="6650680">x</span>&nbsp;<span class="op" id="6650682">:=</span>&nbsp;<span class="ident" id="6650685">addr</span><span class="op" id="6650689">.</span><span class="ident" id="6650690">To4</span><span class="op" id="6650693">(</span><span class="op" id="6650694">)</span><span class="op" id="6650695">;</span>&nbsp;<span class="ident" id="6650697">x</span>&nbsp;<span class="op" id="6650699">!=</span>&nbsp;<span class="builtintype" id="6650702">nil</span>&nbsp;<span class="op" id="6650706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650711">ip</span>&nbsp;<span class="op" id="6650714">=</span>&nbsp;<span class="ident" id="6650716">x</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650721">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6650729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6650732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650735">if</span>&nbsp;<span class="ident" id="6650738">ip</span>&nbsp;<span class="op" id="6650741">==</span>&nbsp;<span class="builtintype" id="6650744">nil</span>&nbsp;<span class="op" id="6650748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650752">t</span><span class="op" id="6650753">.</span><span class="ident" id="6650754">Fatalf</span><span class="op" id="6650760">(</span><span class="string" id="6650761">&#34;no&nbsp;IPv4&nbsp;addresses&nbsp;for&nbsp;www.google.com&#34;</span><span class="op" id="6650799">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6650802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650806">for</span>&nbsp;<span class="ident" id="6650810">i</span><span class="op" id="6650811">,</span>&nbsp;<span class="ident" id="6650813">s</span>&nbsp;<span class="op" id="6650815">:=</span>&nbsp;<span class="keyword" id="6650818">range</span>&nbsp;<span class="ident" id="6650824">googleaddrsipv4</span>&nbsp;<span class="op" id="6650840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650844">if</span>&nbsp;<span class="ident" id="6650847">strings</span><span class="op" id="6650854">.</span><span class="ident" id="6650855">Contains</span><span class="op" id="6650863">(</span><span class="ident" id="6650864">s</span><span class="op" id="6650865">,</span>&nbsp;<span class="string" id="6650867">&#34;%&#34;</span><span class="op" id="6650870">)</span>&nbsp;<span class="op" id="6650872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650877">googleaddrsipv4</span><span class="op" id="6650892">[</span><span class="ident" id="6650893">i</span><span class="op" id="6650894">]</span>&nbsp;<span class="op" id="6650896">=</span>&nbsp;<span class="ident" id="6650898">fmt</span><span class="op" id="6650901">.</span><span class="ident" id="6650902">Sprintf</span><span class="op" id="6650909">(</span><span class="ident" id="6650910">s</span><span class="op" id="6650911">,</span>&nbsp;<span class="ident" id="6650913">ip</span><span class="op" id="6650915">[</span><span class="num" id="6650916">0</span><span class="op" id="6650917">]</span><span class="op" id="6650918">,</span>&nbsp;<span class="ident" id="6650920">ip</span><span class="op" id="6650922">[</span><span class="num" id="6650923">1</span><span class="op" id="6650924">]</span><span class="op" id="6650925">,</span>&nbsp;<span class="ident" id="6650927">ip</span><span class="op" id="6650929">[</span><span class="num" id="6650930">2</span><span class="op" id="6650931">]</span><span class="op" id="6650932">,</span>&nbsp;<span class="ident" id="6650934">ip</span><span class="op" id="6650936">[</span><span class="num" id="6650937">3</span><span class="op" id="6650938">]</span><span class="op" id="6650939">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6650943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6650946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650950">for</span>&nbsp;<span class="ident" id="6650954">i</span>&nbsp;<span class="op" id="6650956">:=</span>&nbsp;<span class="num" id="6650959">0</span><span class="op" id="6650960">;</span>&nbsp;<span class="ident" id="6650962">i</span>&nbsp;<span class="op" id="6650964">&lt;</span>&nbsp;<span class="builtinfunc" id="6650966">len</span><span class="op" id="6650969">(</span><span class="ident" id="6650970">googleaddrsipv4</span><span class="op" id="6650985">)</span><span class="op" id="6650986">;</span>&nbsp;<span class="ident" id="6650988">i</span><span class="op" id="6650989">++</span>&nbsp;<span class="op" id="6650992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650996">addr</span>&nbsp;<span class="op" id="6651001">:=</span>&nbsp;<span class="ident" id="6651004">googleaddrsipv4</span><span class="op" id="6651019">[</span><span class="ident" id="6651020">i</span><span class="op" id="6651021">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6651025">if</span>&nbsp;<span class="ident" id="6651028">addr</span>&nbsp;<span class="op" id="6651033">==</span>&nbsp;<span class="string" id="6651036">&#34;&#34;</span>&nbsp;<span class="op" id="6651039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6651044">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651059">t</span><span class="op" id="6651060">.</span><span class="ident" id="6651061">Logf</span><span class="op" id="6651065">(</span><span class="string" id="6651066">&#34;--&nbsp;%s&nbsp;--&#34;</span><span class="op" id="6651076">,</span>&nbsp;<span class="ident" id="6651078">addr</span><span class="op" id="6651082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651086">doDial</span><span class="op" id="6651092">(</span><span class="ident" id="6651093">t</span><span class="op" id="6651094">,</span>&nbsp;<span class="string" id="6651096">&#34;tcp&#34;</span><span class="op" id="6651101">,</span>&nbsp;<span class="ident" id="6651103">addr</span><span class="op" id="6651107">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6651111">if</span>&nbsp;<span class="ident" id="6651114">addr</span><span class="op" id="6651118">[</span><span class="num" id="6651119">0</span><span class="op" id="6651120">]</span>&nbsp;<span class="op" id="6651122">!=</span>&nbsp;<span class="string" id="6651125">&#39;[&#39;</span>&nbsp;<span class="op" id="6651129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651134">doDial</span><span class="op" id="6651140">(</span><span class="ident" id="6651141">t</span><span class="op" id="6651142">,</span>&nbsp;<span class="string" id="6651144">&#34;tcp4&#34;</span><span class="op" id="6651150">,</span>&nbsp;<span class="ident" id="6651152">addr</span><span class="op" id="6651156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6651161">if</span>&nbsp;<span class="ident" id="6651164">supportsIPv6</span>&nbsp;<span class="op" id="6651177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6651183">//&nbsp;make&nbsp;sure&nbsp;syscall.SocketDisableIPv6&nbsp;flag&nbsp;works.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651238">syscall</span><span class="op" id="6651245">.</span><span class="ident" id="6651246">SocketDisableIPv6</span>&nbsp;<span class="op" id="6651264">=</span>&nbsp;<span class="builtintype" id="6651266">true</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651275">doDial</span><span class="op" id="6651281">(</span><span class="ident" id="6651282">t</span><span class="op" id="6651283">,</span>&nbsp;<span class="string" id="6651285">&#34;tcp&#34;</span><span class="op" id="6651290">,</span>&nbsp;<span class="ident" id="6651292">addr</span><span class="op" id="6651296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651302">doDial</span><span class="op" id="6651308">(</span><span class="ident" id="6651309">t</span><span class="op" id="6651310">,</span>&nbsp;<span class="string" id="6651312">&#34;tcp4&#34;</span><span class="op" id="6651318">,</span>&nbsp;<span class="ident" id="6651320">addr</span><span class="op" id="6651324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651330">syscall</span><span class="op" id="6651337">.</span><span class="ident" id="6651338">SocketDisableIPv6</span>&nbsp;<span class="op" id="6651356">=</span>&nbsp;<span class="builtintype" id="6651358">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651371">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651374">}</span><br>
<span class="lineno"></span><span class="op" id="6651376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6651379">var</span>&nbsp;<span class="ident" id="6651383">googleaddrsipv6</span>&nbsp;<span class="op" id="6651399">=</span>&nbsp;<span class="op" id="6651401">[</span><span class="op" id="6651402">]</span><span class="builtintype" id="6651403">string</span><span class="op" id="6651409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6651412">&#34;[%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x]:80&#34;</span><span class="op" id="6651490">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6651493">&#34;ipv6.google.com:80&#34;</span><span class="op" id="6651513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6651516">&#34;[%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x]:http&#34;</span><span class="op" id="6651596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6651599">&#34;ipv6.google.com:http&#34;</span><span class="op" id="6651621">,</span><br>
<span class="lineno"></span><span class="op" id="6651623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="6651626">func</span>&nbsp;<span class="ident" id="6651631">TestDialGoogleIPv6</span><span class="op" id="6651649">(</span><span class="ident" id="6651650">t</span>&nbsp;<span class="op" id="6651652">*</span><span class="ident" id="6651653">testing</span><span class="op" id="6651660">.</span><span class="ident" id="6651661">T</span><span class="op" id="6651662">)</span>&nbsp;<span class="op" id="6651664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6651667">if</span>&nbsp;<span class="ident" id="6651670">testing</span><span class="op" id="6651677">.</span><span class="ident" id="6651678">Short</span><span class="op" id="6651683">(</span><span class="op" id="6651684">)</span>&nbsp;<span class="op" id="6651686">||</span>&nbsp;<span class="op" id="6651689">!</span><span class="op" id="6651690">*</span><span class="ident" id="6651691">testExternal</span>&nbsp;<span class="op" id="6651704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651708">t</span><span class="op" id="6651709">.</span><span class="ident" id="6651710">Skip</span><span class="op" id="6651714">(</span><span class="string" id="6651715">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6651756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6651762">//&nbsp;Only&nbsp;run&nbsp;tcp6&nbsp;if&nbsp;the&nbsp;kernel&nbsp;will&nbsp;take&nbsp;it.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6651808">if</span>&nbsp;<span class="op" id="6651811">!</span><span class="ident" id="6651812">supportsIPv6</span>&nbsp;<span class="op" id="6651825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651829">t</span><span class="op" id="6651830">.</span><span class="ident" id="6651831">Skip</span><span class="op" id="6651835">(</span><span class="string" id="6651836">&#34;skipping&nbsp;test;&nbsp;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6651874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6651880">if</span>&nbsp;<span class="op" id="6651883">!</span><span class="op" id="6651884">*</span><span class="ident" id="6651885">testIPv6</span>&nbsp;<span class="op" id="6651894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651898">t</span><span class="op" id="6651899">.</span><span class="ident" id="6651900">Skip</span><span class="op" id="6651904">(</span><span class="string" id="6651905">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-ipv6&nbsp;to&nbsp;enable&#34;</span><span class="op" id="6651941">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6651948">//&nbsp;Insert&nbsp;an&nbsp;actual&nbsp;IPv6&nbsp;address&nbsp;for&nbsp;ipv6.google.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6652002">//&nbsp;into&nbsp;the&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6652022">addrs</span><span class="op" id="6652027">,</span>&nbsp;<span class="ident" id="6652029">err</span>&nbsp;<span class="op" id="6652033">:=</span>&nbsp;<span class="ident" id="6652036">LookupIP</span><span class="op" id="6652044">(</span><span class="string" id="6652045">&#34;ipv6.google.com&#34;</span><span class="op" id="6652062">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6652065">if</span>&nbsp;<span class="ident" id="6652068">err</span>&nbsp;<span class="op" id="6652072">!=</span>&nbsp;<span class="builtintype" id="6652075">nil</span>&nbsp;<span class="op" id="6652079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6652083">t</span><span class="op" id="6652084">.</span><span class="ident" id="6652085">Fatalf</span><span class="op" id="6652091">(</span><span class="string" id="6652092">&#34;lookup&nbsp;ipv6.google.com:&nbsp;%v&#34;</span><span class="op" id="6652120">,</span>&nbsp;<span class="ident" id="6652122">err</span><span class="op" id="6652125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6652128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6652131">var</span>&nbsp;<span class="ident" id="6652135">ip</span>&nbsp;<span class="ident" id="6652138">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6652142">for</span>&nbsp;<span class="ident" id="6652146">_</span><span class="op" id="6652147">,</span>&nbsp;<span class="ident" id="6652149">addr</span>&nbsp;<span class="op" id="6652154">:=</span>&nbsp;<span class="keyword" id="6652157">range</span>&nbsp;<span class="ident" id="6652163">addrs</span>&nbsp;<span class="op" id="6652169">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6652173">if</span>&nbsp;<span class="ident" id="6652176">x</span>&nbsp;<span class="op" id="6652178">:=</span>&nbsp;<span class="ident" id="6652181">addr</span><span class="op" id="6652185">.</span><span class="ident" id="6652186">To16</span><span class="op" id="6652190">(</span><span class="op" id="6652191">)</span><span class="op" id="6652192">;</span>&nbsp;<span class="ident" id="6652194">x</span>&nbsp;<span class="op" id="6652196">!=</span>&nbsp;<span class="builtintype" id="6652199">nil</span>&nbsp;<span class="op" id="6652203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6652208">ip</span>&nbsp;<span class="op" id="6652211">=</span>&nbsp;<span class="ident" id="6652213">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6652218">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6652226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6652229">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6652232">if</span>&nbsp;<span class="ident" id="6652235">ip</span>&nbsp;<span class="op" id="6652238">==</span>&nbsp;<span class="builtintype" id="6652241">nil</span>&nbsp;<span class="op" id="6652245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6652249">t</span><span class="op" id="6652250">.</span><span class="ident" id="6652251">Fatalf</span><span class="op" id="6652257">(</span><span class="string" id="6652258">&#34;no&nbsp;IPv6&nbsp;addresses&nbsp;for&nbsp;ipv6.google.com&#34;</span><span class="op" id="6652297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6652300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6652304">for</span>&nbsp;<span class="ident" id="6652308">i</span><span class="op" id="6652309">,</span>&nbsp;<span class="ident" id="6652311">s</span>&nbsp;<span class="op" id="6652313">:=</span>&nbsp;<span class="keyword" id="6652316">range</span>&nbsp;<span class="ident" id="6652322">googleaddrsipv6</span>&nbsp;<span class="op" id="6652338">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6652342">if</span>&nbsp;<span class="ident" id="6652345">strings</span><span class="op" id="6652352">.</span><span class="ident" id="6652353">Contains</span><span class="op" id="6652361">(</span><span class="ident" id="6652362">s</span><span class="op" id="6652363">,</span>&nbsp;<span class="string" id="6652365">&#34;%&#34;</span><span class="op" id="6652368">)</span>&nbsp;<span class="op" id="6652370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6652375">googleaddrsipv6</span><span class="op" id="6652390">[</span><span class="ident" id="6652391">i</span><span class="op" id="6652392">]</span>&nbsp;<span class="op" id="6652394">=</span>&nbsp;<span class="ident" id="6652396">fmt</span><span class="op" id="6652399">.</span><span class="ident" id="6652400">Sprintf</span><span class="op" id="6652407">(</span><span class="ident" id="6652408">s</span><span class="op" id="6652409">,</span>&nbsp;<span class="ident" id="6652411">ip</span><span class="op" id="6652413">[</span><span class="num" id="6652414">0</span><span class="op" id="6652415">]</span><span class="op" id="6652416">,</span>&nbsp;<span class="ident" id="6652418">ip</span><span class="op" id="6652420">[</span><span class="num" id="6652421">1</span><span class="op" id="6652422">]</span><span class="op" id="6652423">,</span>&nbsp;<span class="ident" id="6652425">ip</span><span class="op" id="6652427">[</span><span class="num" id="6652428">2</span><span class="op" id="6652429">]</span><span class="op" id="6652430">,</span>&nbsp;<span class="ident" id="6652432">ip</span><span class="op" id="6652434">[</span><span class="num" id="6652435">3</span><span class="op" id="6652436">]</span><span class="op" id="6652437">,</span>&nbsp;<span class="ident" id="6652439">ip</span><span class="op" id="6652441">[</span><span class="num" id="6652442">4</span><span class="op" id="6652443">]</span><span class="op" id="6652444">,</span>&nbsp;<span class="ident" id="6652446">ip</span><span class="op" id="6652448">[</span><span class="num" id="6652449">5</span><span class="op" id="6652450">]</span><span class="op" id="6652451">,</span>&nbsp;<span class="ident" id="6652453">ip</span><span class="op" id="6652455">[</span><span class="num" id="6652456">6</span><span class="op" id="6652457">]</span><span class="op" id="6652458">,</span>&nbsp;<span class="ident" id="6652460">ip</span><span class="op" id="6652462">[</span><span class="num" id="6652463">7</span><span class="op" id="6652464">]</span><span class="op" id="6652465">,</span>&nbsp;<span class="ident" id="6652467">ip</span><span class="op" id="6652469">[</span><span class="num" id="6652470">8</span><span class="op" id="6652471">]</span><span class="op" id="6652472">,</span>&nbsp;<span class="ident" id="6652474">ip</span><span class="op" id="6652476">[</span><span class="num" id="6652477">9</span><span class="op" id="6652478">]</span><span class="op" id="6652479">,</span>&nbsp;<span class="ident" id="6652481">ip</span><span class="op" id="6652483">[</span><span class="num" id="6652484">10</span><span class="op" id="6652486">]</span><span class="op" id="6652487">,</span>&nbsp;<span class="ident" id="6652489">ip</span><span class="op" id="6652491">[</span><span class="num" id="6652492">11</span><span class="op" id="6652494">]</span><span class="op" id="6652495">,</span>&nbsp;<span class="ident" id="6652497">ip</span><span class="op" id="6652499">[</span><span class="num" id="6652500">12</span><span class="op" id="6652502">]</span><span class="op" id="6652503">,</span>&nbsp;<span class="ident" id="6652505">ip</span><span class="op" id="6652507">[</span><span class="num" id="6652508">13</span><span class="op" id="6652510">]</span><span class="op" id="6652511">,</span>&nbsp;<span class="ident" id="6652513">ip</span><span class="op" id="6652515">[</span><span class="num" id="6652516">14</span><span class="op" id="6652518">]</span><span class="op" id="6652519">,</span>&nbsp;<span class="ident" id="6652521">ip</span><span class="op" id="6652523">[</span><span class="num" id="6652524">15</span><span class="op" id="6652526">]</span><span class="op" id="6652527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6652531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6652534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6652538">for</span>&nbsp;<span class="ident" id="6652542">i</span>&nbsp;<span class="op" id="6652544">:=</span>&nbsp;<span class="num" id="6652547">0</span><span class="op" id="6652548">;</span>&nbsp;<span class="ident" id="6652550">i</span>&nbsp;<span class="op" id="6652552">&lt;</span>&nbsp;<span class="builtinfunc" id="6652554">len</span><span class="op" id="6652557">(</span><span class="ident" id="6652558">googleaddrsipv6</span><span class="op" id="6652573">)</span><span class="op" id="6652574">;</span>&nbsp;<span class="ident" id="6652576">i</span><span class="op" id="6652577">++</span>&nbsp;<span class="op" id="6652580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6652584">addr</span>&nbsp;<span class="op" id="6652589">:=</span>&nbsp;<span class="ident" id="6652592">googleaddrsipv6</span><span class="op" id="6652607">[</span><span class="ident" id="6652608">i</span><span class="op" id="6652609">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6652613">if</span>&nbsp;<span class="ident" id="6652616">addr</span>&nbsp;<span class="op" id="6652621">==</span>&nbsp;<span class="string" id="6652624">&#34;&#34;</span>&nbsp;<span class="op" id="6652627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6652632">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6652643">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6652647">t</span><span class="op" id="6652648">.</span><span class="ident" id="6652649">Logf</span><span class="op" id="6652653">(</span><span class="string" id="6652654">&#34;--&nbsp;%s&nbsp;--&#34;</span><span class="op" id="6652664">,</span>&nbsp;<span class="ident" id="6652666">addr</span><span class="op" id="6652670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6652674">doDial</span><span class="op" id="6652680">(</span><span class="ident" id="6652681">t</span><span class="op" id="6652682">,</span>&nbsp;<span class="string" id="6652684">&#34;tcp&#34;</span><span class="op" id="6652689">,</span>&nbsp;<span class="ident" id="6652691">addr</span><span class="op" id="6652695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6652699">doDial</span><span class="op" id="6652705">(</span><span class="ident" id="6652706">t</span><span class="op" id="6652707">,</span>&nbsp;<span class="string" id="6652709">&#34;tcp6&#34;</span><span class="op" id="6652715">,</span>&nbsp;<span class="ident" id="6652717">addr</span><span class="op" id="6652721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6652724">}</span><br>
<span class="lineno"></span><span class="op" id="6652726">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
