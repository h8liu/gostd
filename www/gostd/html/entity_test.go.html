<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html</h2>
<ul>
<li><a href="/gostd/html/entity.go.html">entity.go</a></li>
<li><a href="/gostd/html/entity_test.go.html">entity_test.go</a></li>
<li><a href="/gostd/html/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/escape_test.go.html">escape_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7356743">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7356798">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7356852">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7356903">package</span>&nbsp;<span class="ident" id="7356911">html</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7356917">import</span>&nbsp;<span class="op" id="7356924">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7356927">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7356938">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7356953">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7356956">func</span>&nbsp;<span class="ident" id="7356961">TestEntityLength</span><span class="op" id="7356977">(</span><span class="ident" id="7356978">t</span>&nbsp;<span class="op" id="7356980">*</span><span class="ident" id="7356981">testing</span><span class="op" id="7356988">.</span><span class="ident" id="7356989">T</span><span class="op" id="7356990">)</span>&nbsp;<span class="op" id="7356992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7356995">//&nbsp;We&nbsp;verify&nbsp;that&nbsp;the&nbsp;length&nbsp;of&nbsp;UTF-8&nbsp;encoding&nbsp;of&nbsp;each&nbsp;value&nbsp;is&nbsp;&lt;=&nbsp;1&nbsp;+&nbsp;len(key).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7357077">//&nbsp;The&nbsp;+1&nbsp;comes&nbsp;from&nbsp;the&nbsp;leading&nbsp;&#34;&amp;&#34;.&nbsp;This&nbsp;property&nbsp;implies&nbsp;that&nbsp;the&nbsp;length&nbsp;of</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7357157">//&nbsp;unescaped&nbsp;text&nbsp;is&nbsp;&lt;=&nbsp;the&nbsp;length&nbsp;of&nbsp;escaped&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357210">for</span>&nbsp;<span class="ident" id="7357214">k</span><span class="op" id="7357215">,</span>&nbsp;<span class="ident" id="7357217">v</span>&nbsp;<span class="op" id="7357219">:=</span>&nbsp;<span class="keyword" id="7357222">range</span>&nbsp;<span class="ident" id="7357228">entity</span>&nbsp;<span class="op" id="7357235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357239">if</span>&nbsp;<span class="num" id="7357242">1</span><span class="op" id="7357243">+</span><span class="builtinfunc" id="7357244">len</span><span class="op" id="7357247">(</span><span class="ident" id="7357248">k</span><span class="op" id="7357249">)</span>&nbsp;<span class="op" id="7357251">&lt;</span>&nbsp;<span class="ident" id="7357253">utf8</span><span class="op" id="7357257">.</span><span class="ident" id="7357258">RuneLen</span><span class="op" id="7357265">(</span><span class="ident" id="7357266">v</span><span class="op" id="7357267">)</span>&nbsp;<span class="op" id="7357269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357274">t</span><span class="op" id="7357275">.</span><span class="ident" id="7357276">Error</span><span class="op" id="7357281">(</span><span class="string" id="7357282">&#34;escaped&nbsp;entity&nbsp;&amp;&#34;</span>&nbsp;<span class="op" id="7357301">+</span>&nbsp;<span class="ident" id="7357303">k</span>&nbsp;<span class="op" id="7357305">+</span>&nbsp;<span class="string" id="7357307">&#34;&nbsp;is&nbsp;shorter&nbsp;than&nbsp;its&nbsp;UTF-8&nbsp;encoding&nbsp;&#34;</span>&nbsp;<span class="op" id="7357346">+</span>&nbsp;<span class="builtintype" id="7357348">string</span><span class="op" id="7357354">(</span><span class="ident" id="7357355">v</span><span class="op" id="7357356">)</span><span class="op" id="7357357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7357361">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357365">if</span>&nbsp;<span class="builtinfunc" id="7357368">len</span><span class="op" id="7357371">(</span><span class="ident" id="7357372">k</span><span class="op" id="7357373">)</span>&nbsp;<span class="op" id="7357375">&gt;</span>&nbsp;<span class="ident" id="7357377">longestEntityWithoutSemicolon</span>&nbsp;<span class="op" id="7357407">&amp;&amp;</span>&nbsp;<span class="ident" id="7357410">k</span><span class="op" id="7357411">[</span><span class="builtinfunc" id="7357412">len</span><span class="op" id="7357415">(</span><span class="ident" id="7357416">k</span><span class="op" id="7357417">)</span><span class="op" id="7357418">-</span><span class="num" id="7357419">1</span><span class="op" id="7357420">]</span>&nbsp;<span class="op" id="7357422">!=</span>&nbsp;<span class="string" id="7357425">&#39;;&#39;</span>&nbsp;<span class="op" id="7357429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357434">t</span><span class="op" id="7357435">.</span><span class="ident" id="7357436">Errorf</span><span class="op" id="7357442">(</span><span class="string" id="7357443">&#34;entity&nbsp;name&nbsp;%s&nbsp;is&nbsp;%d&nbsp;characters,&nbsp;but&nbsp;longestEntityWithoutSemicolon=%d&#34;</span><span class="op" id="7357514">,</span>&nbsp;<span class="ident" id="7357516">k</span><span class="op" id="7357517">,</span>&nbsp;<span class="builtinfunc" id="7357519">len</span><span class="op" id="7357522">(</span><span class="ident" id="7357523">k</span><span class="op" id="7357524">)</span><span class="op" id="7357525">,</span>&nbsp;<span class="ident" id="7357527">longestEntityWithoutSemicolon</span><span class="op" id="7357556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7357560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7357563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357566">for</span>&nbsp;<span class="ident" id="7357570">k</span><span class="op" id="7357571">,</span>&nbsp;<span class="ident" id="7357573">v</span>&nbsp;<span class="op" id="7357575">:=</span>&nbsp;<span class="keyword" id="7357578">range</span>&nbsp;<span class="ident" id="7357584">entity2</span>&nbsp;<span class="op" id="7357592">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7357596">if</span>&nbsp;<span class="num" id="7357599">1</span><span class="op" id="7357600">+</span><span class="builtinfunc" id="7357601">len</span><span class="op" id="7357604">(</span><span class="ident" id="7357605">k</span><span class="op" id="7357606">)</span>&nbsp;<span class="op" id="7357608">&lt;</span>&nbsp;<span class="ident" id="7357610">utf8</span><span class="op" id="7357614">.</span><span class="ident" id="7357615">RuneLen</span><span class="op" id="7357622">(</span><span class="ident" id="7357623">v</span><span class="op" id="7357624">[</span><span class="num" id="7357625">0</span><span class="op" id="7357626">]</span><span class="op" id="7357627">)</span><span class="op" id="7357628">+</span><span class="ident" id="7357629">utf8</span><span class="op" id="7357633">.</span><span class="ident" id="7357634">RuneLen</span><span class="op" id="7357641">(</span><span class="ident" id="7357642">v</span><span class="op" id="7357643">[</span><span class="num" id="7357644">1</span><span class="op" id="7357645">]</span><span class="op" id="7357646">)</span>&nbsp;<span class="op" id="7357648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7357653">t</span><span class="op" id="7357654">.</span><span class="ident" id="7357655">Error</span><span class="op" id="7357660">(</span><span class="string" id="7357661">&#34;escaped&nbsp;entity&nbsp;&amp;&#34;</span>&nbsp;<span class="op" id="7357680">+</span>&nbsp;<span class="ident" id="7357682">k</span>&nbsp;<span class="op" id="7357684">+</span>&nbsp;<span class="string" id="7357686">&#34;&nbsp;is&nbsp;shorter&nbsp;than&nbsp;its&nbsp;UTF-8&nbsp;encoding&nbsp;&#34;</span>&nbsp;<span class="op" id="7357725">+</span>&nbsp;<span class="builtintype" id="7357727">string</span><span class="op" id="7357733">(</span><span class="ident" id="7357734">v</span><span class="op" id="7357735">[</span><span class="num" id="7357736">0</span><span class="op" id="7357737">]</span><span class="op" id="7357738">)</span>&nbsp;<span class="op" id="7357740">+</span>&nbsp;<span class="builtintype" id="7357742">string</span><span class="op" id="7357748">(</span><span class="ident" id="7357749">v</span><span class="op" id="7357750">[</span><span class="num" id="7357751">1</span><span class="op" id="7357752">]</span><span class="op" id="7357753">)</span><span class="op" id="7357754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7357758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7357761">}</span><br>
<span class="lineno"></span><span class="op" id="7357763">}</span>
</div>
</body>
</html>
