<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html" class="current">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2123230">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2123285">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2123339">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2123390">package</span>&nbsp;<span class="ident" id="2123398">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2123404">//&nbsp;Exp&nbsp;returns&nbsp;e**x,&nbsp;the&nbsp;base-e&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2123454">//</span><br>
<span class="lineno"></span><span class="comment" id="2123457">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">10</span><span class="comment" id="2123479">//&nbsp;&nbsp;&nbsp;&nbsp;Exp(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2123499">//&nbsp;&nbsp;&nbsp;&nbsp;Exp(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2123517">//&nbsp;Very&nbsp;large&nbsp;values&nbsp;overflow&nbsp;to&nbsp;0&nbsp;or&nbsp;+Inf.</span><br>
<span class="lineno"></span><span class="comment" id="2123561">//&nbsp;Very&nbsp;small&nbsp;values&nbsp;underflow&nbsp;to&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="2123598">func</span>&nbsp;<span class="ident" id="2123603">Exp</span><span class="op" id="2123606">(</span><span class="ident" id="2123607">x</span>&nbsp;<span class="builtintype" id="2123609">float64</span><span class="op" id="2123616">)</span>&nbsp;<span class="builtintype" id="2123618">float64</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2123627">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2123687">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_exp.c</span><br>
<span class="lineno"></span><span class="comment" id="2123745">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2123804">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">20</span><span class="comment" id="2123834">//</span><br>
<span class="lineno"></span><span class="comment" id="2123837">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2123893">//&nbsp;Copyright&nbsp;(C)&nbsp;2004&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2123962">//</span><br>
<span class="lineno"></span><span class="comment" id="2123965">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno">25</span><span class="comment" id="2124021">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2124078">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2124095">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2124151">//</span><br>
<span class="lineno"></span><span class="comment" id="2124154">//</span><br>
<span class="lineno">30</span><span class="comment" id="2124157">//&nbsp;exp(x)</span><br>
<span class="lineno"></span><span class="comment" id="2124167">//&nbsp;Returns&nbsp;the&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2124200">//</span><br>
<span class="lineno"></span><span class="comment" id="2124203">//&nbsp;Method</span><br>
<span class="lineno"></span><span class="comment" id="2124213">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;reduction:</span><br>
<span class="lineno">35</span><span class="comment" id="2124241">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduce&nbsp;x&nbsp;to&nbsp;an&nbsp;r&nbsp;so&nbsp;that&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2&nbsp;~&nbsp;0.34658.</span><br>
<span class="lineno"></span><span class="comment" id="2124300">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Given&nbsp;x,&nbsp;find&nbsp;r&nbsp;and&nbsp;integer&nbsp;k&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2124348">//</span><br>
<span class="lineno"></span><span class="comment" id="2124351">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;r,&nbsp;&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2.</span><br>
<span class="lineno"></span><span class="comment" id="2124400">//</span><br>
<span class="lineno">40</span><span class="comment" id="2124403">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;r&nbsp;will&nbsp;be&nbsp;represented&nbsp;as&nbsp;r&nbsp;=&nbsp;hi-lo&nbsp;for&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="2124462">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accuracy.</span><br>
<span class="lineno"></span><span class="comment" id="2124480">//</span><br>
<span class="lineno"></span><span class="comment" id="2124483">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;exp(r)&nbsp;by&nbsp;a&nbsp;special&nbsp;rational&nbsp;function&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="2124549">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;interval&nbsp;[0,0.34658]:</span><br>
<span class="lineno">45</span><span class="comment" id="2124583">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write</span><br>
<span class="lineno"></span><span class="comment" id="2124597">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(r**2)&nbsp;=&nbsp;r*(exp(r)+1)/(exp(r)-1)&nbsp;=&nbsp;2&nbsp;+&nbsp;r*r/6&nbsp;-&nbsp;r**4/360&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2124672">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Remes&nbsp;algorithm&nbsp;on&nbsp;[0,0.34658]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="2124740">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;5&nbsp;to&nbsp;approximate&nbsp;R.&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2124809">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-59.&nbsp;In</span><br>
<span class="lineno">50</span><span class="comment" id="2124875">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="2124896">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;2.0&nbsp;+&nbsp;P1*z&nbsp;+&nbsp;P2*z**2&nbsp;+&nbsp;P3*z**3&nbsp;+&nbsp;P4*z**4&nbsp;+&nbsp;P5*z**5</span><br>
<span class="lineno"></span><span class="comment" id="2124966">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(where&nbsp;z=r*r,&nbsp;and&nbsp;the&nbsp;values&nbsp;of&nbsp;P1&nbsp;to&nbsp;P5&nbsp;are&nbsp;listed&nbsp;below)</span><br>
<span class="lineno"></span><span class="comment" id="2125033">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2125045">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-59</span><br>
<span class="lineno">55</span><span class="comment" id="2125097">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2.0+P1*z+...+P5*z&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2125146">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="2125190">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;computation&nbsp;of&nbsp;exp(r)&nbsp;thus&nbsp;becomes</span><br>
<span class="lineno"></span><span class="comment" id="2125237">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*r</span><br>
<span class="lineno"></span><span class="comment" id="2125272">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(r)&nbsp;=&nbsp;1&nbsp;+&nbsp;-------</span><br>
<span class="lineno">60</span><span class="comment" id="2125309">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;-&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="2125345">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r*R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2125388">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;+&nbsp;r&nbsp;+&nbsp;-----------&nbsp;(for&nbsp;better&nbsp;accuracy)</span><br>
<span class="lineno"></span><span class="comment" id="2125455">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2125499">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno">65</span><span class="comment" id="2125513">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="2125571">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(r)&nbsp;=&nbsp;r&nbsp;-&nbsp;(P1*r&nbsp;&nbsp;+&nbsp;P2*r&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;P5*r&nbsp;&nbsp;&nbsp;).</span><br>
<span class="lineno"></span><span class="comment" id="2125632">//</span><br>
<span class="lineno"></span><span class="comment" id="2125635">//&nbsp;&nbsp;&nbsp;3.&nbsp;Scale&nbsp;back&nbsp;to&nbsp;obtain&nbsp;exp(x):</span><br>
<span class="lineno"></span><span class="comment" id="2125672">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;step&nbsp;1,&nbsp;we&nbsp;have</span><br>
<span class="lineno">70</span><span class="comment" id="2125701">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(x)&nbsp;=&nbsp;2**k&nbsp;*&nbsp;exp(r)</span><br>
<span class="lineno"></span><span class="comment" id="2125735">//</span><br>
<span class="lineno"></span><span class="comment" id="2125738">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2125756">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(INF)&nbsp;is&nbsp;INF,&nbsp;exp(NaN)&nbsp;is&nbsp;NaN;</span><br>
<span class="lineno"></span><span class="comment" id="2125798">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-INF)&nbsp;is&nbsp;0,&nbsp;and</span><br>
<span class="lineno">75</span><span class="comment" id="2125826">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;finite&nbsp;argument,&nbsp;only&nbsp;exp(0)=1&nbsp;is&nbsp;exact.</span><br>
<span class="lineno"></span><span class="comment" id="2125879">//</span><br>
<span class="lineno"></span><span class="comment" id="2125882">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="2125895">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2125965">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">80</span><span class="comment" id="2126005">//</span><br>
<span class="lineno"></span><span class="comment" id="2126008">//&nbsp;Misc.&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2126023">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;IEEE&nbsp;double</span><br>
<span class="lineno"></span><span class="comment" id="2126047">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;7.09782712893383973096e+02&nbsp;then&nbsp;exp(x)&nbsp;overflow</span><br>
<span class="lineno"></span><span class="comment" id="2126115">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-7.45133219101941108420e+02&nbsp;then&nbsp;exp(x)&nbsp;underflow</span><br>
<span class="lineno">85</span><span class="comment" id="2126184">//</span><br>
<span class="lineno"></span><span class="comment" id="2126187">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="2126201">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="2126267">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2126331">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">90</span><span class="comment" id="2126397">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2126442">func</span>&nbsp;<span class="ident" id="2126447">exp</span><span class="op" id="2126450">(</span><span class="ident" id="2126451">x</span>&nbsp;<span class="builtintype" id="2126453">float64</span><span class="op" id="2126460">)</span>&nbsp;<span class="builtintype" id="2126462">float64</span>&nbsp;<span class="op" id="2126470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2126473">const</span>&nbsp;<span class="op" id="2126479">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2126483">Ln2Hi</span>&nbsp;<span class="op" id="2126489">=</span>&nbsp;<span class="num" id="2126491">6.93147180369123816490e-01</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2126520">Ln2Lo</span>&nbsp;<span class="op" id="2126526">=</span>&nbsp;<span class="num" id="2126528">1.90821492927058770002e-10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2126557">Log2e</span>&nbsp;<span class="op" id="2126563">=</span>&nbsp;<span class="num" id="2126565">1.44269504088896338700e+00</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2126595">Overflow</span>&nbsp;&nbsp;<span class="op" id="2126605">=</span>&nbsp;<span class="num" id="2126607">7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2126636">Underflow</span>&nbsp;<span class="op" id="2126646">=</span>&nbsp;<span class="op" id="2126648">-</span><span class="num" id="2126649">7.45133219101941108420e+02</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2126678">NearZero</span>&nbsp;&nbsp;<span class="op" id="2126688">=</span>&nbsp;<span class="num" id="2126690">1.0</span>&nbsp;<span class="op" id="2126694">/</span>&nbsp;<span class="op" id="2126696">(</span><span class="num" id="2126697">1</span>&nbsp;<span class="op" id="2126699">&lt;&lt;</span>&nbsp;<span class="num" id="2126702">28</span><span class="op" id="2126704">)</span>&nbsp;<span class="comment" id="2126706">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2126717">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2126721">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2126739">switch</span>&nbsp;<span class="op" id="2126746">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2126749">case</span>&nbsp;<span class="ident" id="2126754">IsNaN</span><span class="op" id="2126759">(</span><span class="ident" id="2126760">x</span><span class="op" id="2126761">)</span>&nbsp;<span class="op" id="2126763">||</span>&nbsp;<span class="ident" id="2126766">IsInf</span><span class="op" id="2126771">(</span><span class="ident" id="2126772">x</span><span class="op" id="2126773">,</span>&nbsp;<span class="num" id="2126775">1</span><span class="op" id="2126776">)</span><span class="op" id="2126777">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2126781">return</span>&nbsp;<span class="ident" id="2126788">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2126791">case</span>&nbsp;<span class="ident" id="2126796">IsInf</span><span class="op" id="2126801">(</span><span class="ident" id="2126802">x</span><span class="op" id="2126803">,</span>&nbsp;<span class="op" id="2126805">-</span><span class="num" id="2126806">1</span><span class="op" id="2126807">)</span><span class="op" id="2126808">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2126812">return</span>&nbsp;<span class="num" id="2126819">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2126822">case</span>&nbsp;<span class="ident" id="2126827">x</span>&nbsp;<span class="op" id="2126829">&gt;</span>&nbsp;<span class="ident" id="2126831">Overflow</span><span class="op" id="2126839">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2126843">return</span>&nbsp;<span class="ident" id="2126850">Inf</span><span class="op" id="2126853">(</span><span class="num" id="2126854">1</span><span class="op" id="2126855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2126858">case</span>&nbsp;<span class="ident" id="2126863">x</span>&nbsp;<span class="op" id="2126865">&lt;</span>&nbsp;<span class="ident" id="2126867">Underflow</span><span class="op" id="2126876">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2126880">return</span>&nbsp;<span class="num" id="2126887">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2126890">case</span>&nbsp;<span class="op" id="2126895">-</span><span class="ident" id="2126896">NearZero</span>&nbsp;<span class="op" id="2126905">&lt;</span>&nbsp;<span class="ident" id="2126907">x</span>&nbsp;<span class="op" id="2126909">&amp;&amp;</span>&nbsp;<span class="ident" id="2126912">x</span>&nbsp;<span class="op" id="2126914">&lt;</span>&nbsp;<span class="ident" id="2126916">NearZero</span><span class="op" id="2126924">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2126928">return</span>&nbsp;<span class="num" id="2126935">1</span>&nbsp;<span class="op" id="2126937">+</span>&nbsp;<span class="ident" id="2126939">x</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2126942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2126946">//&nbsp;reduce;&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127003">var</span>&nbsp;<span class="ident" id="2127007">k</span>&nbsp;<span class="builtintype" id="2127009">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127014">switch</span>&nbsp;<span class="op" id="2127021">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127024">case</span>&nbsp;<span class="ident" id="2127029">x</span>&nbsp;<span class="op" id="2127031">&lt;</span>&nbsp;<span class="num" id="2127033">0</span><span class="op" id="2127034">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2127038">k</span>&nbsp;<span class="op" id="2127040">=</span>&nbsp;<span class="builtintype" id="2127042">int</span><span class="op" id="2127045">(</span><span class="ident" id="2127046">Log2e</span><span class="op" id="2127051">*</span><span class="ident" id="2127052">x</span>&nbsp;<span class="op" id="2127054">-</span>&nbsp;<span class="num" id="2127056">0.5</span><span class="op" id="2127059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127062">case</span>&nbsp;<span class="ident" id="2127067">x</span>&nbsp;<span class="op" id="2127069">&gt;</span>&nbsp;<span class="num" id="2127071">0</span><span class="op" id="2127072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2127076">k</span>&nbsp;<span class="op" id="2127078">=</span>&nbsp;<span class="builtintype" id="2127080">int</span><span class="op" id="2127083">(</span><span class="ident" id="2127084">Log2e</span><span class="op" id="2127089">*</span><span class="ident" id="2127090">x</span>&nbsp;<span class="op" id="2127092">+</span>&nbsp;<span class="num" id="2127094">0.5</span><span class="op" id="2127097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2127100">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2127103">hi</span>&nbsp;<span class="op" id="2127106">:=</span>&nbsp;<span class="ident" id="2127109">x</span>&nbsp;<span class="op" id="2127111">-</span>&nbsp;<span class="builtintype" id="2127113">float64</span><span class="op" id="2127120">(</span><span class="ident" id="2127121">k</span><span class="op" id="2127122">)</span><span class="op" id="2127123">*</span><span class="ident" id="2127124">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2127131">lo</span>&nbsp;<span class="op" id="2127134">:=</span>&nbsp;<span class="builtintype" id="2127137">float64</span><span class="op" id="2127144">(</span><span class="ident" id="2127145">k</span><span class="op" id="2127146">)</span>&nbsp;<span class="op" id="2127148">*</span>&nbsp;<span class="ident" id="2127150">Ln2Lo</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2127158">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127170">return</span>&nbsp;<span class="ident" id="2127177">expmulti</span><span class="op" id="2127185">(</span><span class="ident" id="2127186">hi</span><span class="op" id="2127188">,</span>&nbsp;<span class="ident" id="2127190">lo</span><span class="op" id="2127192">,</span>&nbsp;<span class="ident" id="2127194">k</span><span class="op" id="2127195">)</span><br>
<span class="lineno">130</span><span class="op" id="2127197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2127200">//&nbsp;Exp2&nbsp;returns&nbsp;2**x,&nbsp;the&nbsp;base-2&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2127251">//</span><br>
<span class="lineno"></span><span class="comment" id="2127254">//&nbsp;Special&nbsp;cases&nbsp;are&nbsp;the&nbsp;same&nbsp;as&nbsp;Exp.</span><br>
<span class="lineno">135</span><span class="keyword" id="2127292">func</span>&nbsp;<span class="ident" id="2127297">Exp2</span><span class="op" id="2127301">(</span><span class="ident" id="2127302">x</span>&nbsp;<span class="builtintype" id="2127304">float64</span><span class="op" id="2127311">)</span>&nbsp;<span class="builtintype" id="2127313">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2127322">func</span>&nbsp;<span class="ident" id="2127327">exp2</span><span class="op" id="2127331">(</span><span class="ident" id="2127332">x</span>&nbsp;<span class="builtintype" id="2127334">float64</span><span class="op" id="2127341">)</span>&nbsp;<span class="builtintype" id="2127343">float64</span>&nbsp;<span class="op" id="2127351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127354">const</span>&nbsp;<span class="op" id="2127360">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2127364">Ln2Hi</span>&nbsp;<span class="op" id="2127370">=</span>&nbsp;<span class="num" id="2127372">6.93147180369123816490e-01</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2127401">Ln2Lo</span>&nbsp;<span class="op" id="2127407">=</span>&nbsp;<span class="num" id="2127409">1.90821492927058770002e-10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2127439">Overflow</span>&nbsp;&nbsp;<span class="op" id="2127449">=</span>&nbsp;<span class="num" id="2127451">1.0239999999999999e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2127476">Underflow</span>&nbsp;<span class="op" id="2127486">=</span>&nbsp;<span class="op" id="2127488">-</span><span class="num" id="2127489">1.0740e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2127501">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2127505">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127523">switch</span>&nbsp;<span class="op" id="2127530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127533">case</span>&nbsp;<span class="ident" id="2127538">IsNaN</span><span class="op" id="2127543">(</span><span class="ident" id="2127544">x</span><span class="op" id="2127545">)</span>&nbsp;<span class="op" id="2127547">||</span>&nbsp;<span class="ident" id="2127550">IsInf</span><span class="op" id="2127555">(</span><span class="ident" id="2127556">x</span><span class="op" id="2127557">,</span>&nbsp;<span class="num" id="2127559">1</span><span class="op" id="2127560">)</span><span class="op" id="2127561">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127565">return</span>&nbsp;<span class="ident" id="2127572">x</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127575">case</span>&nbsp;<span class="ident" id="2127580">IsInf</span><span class="op" id="2127585">(</span><span class="ident" id="2127586">x</span><span class="op" id="2127587">,</span>&nbsp;<span class="op" id="2127589">-</span><span class="num" id="2127590">1</span><span class="op" id="2127591">)</span><span class="op" id="2127592">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127596">return</span>&nbsp;<span class="num" id="2127603">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127606">case</span>&nbsp;<span class="ident" id="2127611">x</span>&nbsp;<span class="op" id="2127613">&gt;</span>&nbsp;<span class="ident" id="2127615">Overflow</span><span class="op" id="2127623">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127627">return</span>&nbsp;<span class="ident" id="2127634">Inf</span><span class="op" id="2127637">(</span><span class="num" id="2127638">1</span><span class="op" id="2127639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127642">case</span>&nbsp;<span class="ident" id="2127647">x</span>&nbsp;<span class="op" id="2127649">&lt;</span>&nbsp;<span class="ident" id="2127651">Underflow</span><span class="op" id="2127660">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127664">return</span>&nbsp;<span class="num" id="2127671">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2127674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2127678">//&nbsp;argument&nbsp;reduction;&nbsp;x&nbsp;=&nbsp;r×lg(e)&nbsp;+&nbsp;k&nbsp;with&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2127741">//&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127790">var</span>&nbsp;<span class="ident" id="2127794">k</span>&nbsp;<span class="builtintype" id="2127796">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127801">switch</span>&nbsp;<span class="op" id="2127808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127811">case</span>&nbsp;<span class="ident" id="2127816">x</span>&nbsp;<span class="op" id="2127818">&gt;</span>&nbsp;<span class="num" id="2127820">0</span><span class="op" id="2127821">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2127825">k</span>&nbsp;<span class="op" id="2127827">=</span>&nbsp;<span class="builtintype" id="2127829">int</span><span class="op" id="2127832">(</span><span class="ident" id="2127833">x</span>&nbsp;<span class="op" id="2127835">+</span>&nbsp;<span class="num" id="2127837">0.5</span><span class="op" id="2127840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127843">case</span>&nbsp;<span class="ident" id="2127848">x</span>&nbsp;<span class="op" id="2127850">&lt;</span>&nbsp;<span class="num" id="2127852">0</span><span class="op" id="2127853">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2127857">k</span>&nbsp;<span class="op" id="2127859">=</span>&nbsp;<span class="builtintype" id="2127861">int</span><span class="op" id="2127864">(</span><span class="ident" id="2127865">x</span>&nbsp;<span class="op" id="2127867">-</span>&nbsp;<span class="num" id="2127869">0.5</span><span class="op" id="2127872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2127875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2127878">t</span>&nbsp;<span class="op" id="2127880">:=</span>&nbsp;<span class="ident" id="2127883">x</span>&nbsp;<span class="op" id="2127885">-</span>&nbsp;<span class="builtintype" id="2127887">float64</span><span class="op" id="2127894">(</span><span class="ident" id="2127895">k</span><span class="op" id="2127896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2127899">hi</span>&nbsp;<span class="op" id="2127902">:=</span>&nbsp;<span class="ident" id="2127905">t</span>&nbsp;<span class="op" id="2127907">*</span>&nbsp;<span class="ident" id="2127909">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2127916">lo</span>&nbsp;<span class="op" id="2127919">:=</span>&nbsp;<span class="op" id="2127922">-</span><span class="ident" id="2127923">t</span>&nbsp;<span class="op" id="2127925">*</span>&nbsp;<span class="ident" id="2127927">Ln2Lo</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2127935">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2127947">return</span>&nbsp;<span class="ident" id="2127954">expmulti</span><span class="op" id="2127962">(</span><span class="ident" id="2127963">hi</span><span class="op" id="2127965">,</span>&nbsp;<span class="ident" id="2127967">lo</span><span class="op" id="2127969">,</span>&nbsp;<span class="ident" id="2127971">k</span><span class="op" id="2127972">)</span><br>
<span class="lineno"></span><span class="op" id="2127974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="2127977">//&nbsp;exp1&nbsp;returns&nbsp;e**r&nbsp;×&nbsp;2**k&nbsp;where&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;and&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="2128045">func</span>&nbsp;<span class="ident" id="2128050">expmulti</span><span class="op" id="2128058">(</span><span class="ident" id="2128059">hi</span><span class="op" id="2128061">,</span>&nbsp;<span class="ident" id="2128063">lo</span>&nbsp;<span class="builtintype" id="2128066">float64</span><span class="op" id="2128073">,</span>&nbsp;<span class="ident" id="2128075">k</span>&nbsp;<span class="builtintype" id="2128077">int</span><span class="op" id="2128080">)</span>&nbsp;<span class="builtintype" id="2128082">float64</span>&nbsp;<span class="op" id="2128090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2128093">const</span>&nbsp;<span class="op" id="2128099">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2128103">P1</span>&nbsp;<span class="op" id="2128106">=</span>&nbsp;<span class="num" id="2128108">1.66666666666666019037e-01</span>&nbsp;&nbsp;<span class="comment" id="2128136">/*&nbsp;0x3FC55555;&nbsp;0x5555553E&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2128167">P2</span>&nbsp;<span class="op" id="2128170">=</span>&nbsp;<span class="op" id="2128172">-</span><span class="num" id="2128173">2.77777777770155933842e-03</span>&nbsp;<span class="comment" id="2128200">/*&nbsp;0xBF66C16C;&nbsp;0x16BEBD93&nbsp;*/</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2128231">P3</span>&nbsp;<span class="op" id="2128234">=</span>&nbsp;<span class="num" id="2128236">6.61375632143793436117e-05</span>&nbsp;&nbsp;<span class="comment" id="2128264">/*&nbsp;0x3F11566A;&nbsp;0xAF25DE2C&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2128295">P4</span>&nbsp;<span class="op" id="2128298">=</span>&nbsp;<span class="op" id="2128300">-</span><span class="num" id="2128301">1.65339022054652515390e-06</span>&nbsp;<span class="comment" id="2128328">/*&nbsp;0xBEBBBD41;&nbsp;0xC5D26BF1&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2128359">P5</span>&nbsp;<span class="op" id="2128362">=</span>&nbsp;<span class="num" id="2128364">4.13813679705723846039e-08</span>&nbsp;&nbsp;<span class="comment" id="2128392">/*&nbsp;0x3E663769;&nbsp;0x72BEA4D0&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2128422">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2128426">r</span>&nbsp;<span class="op" id="2128428">:=</span>&nbsp;<span class="ident" id="2128431">hi</span>&nbsp;<span class="op" id="2128434">-</span>&nbsp;<span class="ident" id="2128436">lo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2128440">t</span>&nbsp;<span class="op" id="2128442">:=</span>&nbsp;<span class="ident" id="2128445">r</span>&nbsp;<span class="op" id="2128447">*</span>&nbsp;<span class="ident" id="2128449">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2128452">c</span>&nbsp;<span class="op" id="2128454">:=</span>&nbsp;<span class="ident" id="2128457">r</span>&nbsp;<span class="op" id="2128459">-</span>&nbsp;<span class="ident" id="2128461">t</span><span class="op" id="2128462">*</span><span class="op" id="2128463">(</span><span class="ident" id="2128464">P1</span><span class="op" id="2128466">+</span><span class="ident" id="2128467">t</span><span class="op" id="2128468">*</span><span class="op" id="2128469">(</span><span class="ident" id="2128470">P2</span><span class="op" id="2128472">+</span><span class="ident" id="2128473">t</span><span class="op" id="2128474">*</span><span class="op" id="2128475">(</span><span class="ident" id="2128476">P3</span><span class="op" id="2128478">+</span><span class="ident" id="2128479">t</span><span class="op" id="2128480">*</span><span class="op" id="2128481">(</span><span class="ident" id="2128482">P4</span><span class="op" id="2128484">+</span><span class="ident" id="2128485">t</span><span class="op" id="2128486">*</span><span class="ident" id="2128487">P5</span><span class="op" id="2128489">)</span><span class="op" id="2128490">)</span><span class="op" id="2128491">)</span><span class="op" id="2128492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2128495">y</span>&nbsp;<span class="op" id="2128497">:=</span>&nbsp;<span class="num" id="2128500">1</span>&nbsp;<span class="op" id="2128502">-</span>&nbsp;<span class="op" id="2128504">(</span><span class="op" id="2128505">(</span><span class="ident" id="2128506">lo</span>&nbsp;<span class="op" id="2128509">-</span>&nbsp;<span class="op" id="2128511">(</span><span class="ident" id="2128512">r</span><span class="op" id="2128513">*</span><span class="ident" id="2128514">c</span><span class="op" id="2128515">)</span><span class="op" id="2128516">/</span><span class="op" id="2128517">(</span><span class="num" id="2128518">2</span><span class="op" id="2128519">-</span><span class="ident" id="2128520">c</span><span class="op" id="2128521">)</span><span class="op" id="2128522">)</span>&nbsp;<span class="op" id="2128524">-</span>&nbsp;<span class="ident" id="2128526">hi</span><span class="op" id="2128528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2128531">//&nbsp;TODO(rsc):&nbsp;make&nbsp;sure&nbsp;Ldexp&nbsp;can&nbsp;handle&nbsp;boundary&nbsp;k</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2128584">return</span>&nbsp;<span class="ident" id="2128591">Ldexp</span><span class="op" id="2128596">(</span><span class="ident" id="2128597">y</span><span class="op" id="2128598">,</span>&nbsp;<span class="ident" id="2128600">k</span><span class="op" id="2128601">)</span><br>
<span class="lineno"></span><span class="op" id="2128603">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
