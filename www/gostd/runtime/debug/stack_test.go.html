<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html" class="current">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7345791">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7345846">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7345900">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7345951">package</span>&nbsp;<span class="ident" id="7345959">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7345966">import</span>&nbsp;<span class="op" id="7345973">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7345976">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7345987">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7345997">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7346000">type</span>&nbsp;<span class="ident" id="7346005">T</span>&nbsp;<span class="builtintype" id="7346007">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7346012">func</span>&nbsp;<span class="op" id="7346017">(</span><span class="ident" id="7346018">t</span>&nbsp;<span class="op" id="7346020">*</span><span class="ident" id="7346021">T</span><span class="op" id="7346022">)</span>&nbsp;<span class="ident" id="7346024">ptrmethod</span><span class="op" id="7346033">(</span><span class="op" id="7346034">)</span>&nbsp;<span class="op" id="7346036">[</span><span class="op" id="7346037">]</span><span class="builtintype" id="7346038">byte</span>&nbsp;<span class="op" id="7346043">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7346046">return</span>&nbsp;<span class="ident" id="7346053">Stack</span><span class="op" id="7346058">(</span><span class="op" id="7346059">)</span><br>
<span class="lineno"></span><span class="op" id="7346061">}</span><br>
<span class="lineno"></span><span class="keyword" id="7346063">func</span>&nbsp;<span class="op" id="7346068">(</span><span class="ident" id="7346069">t</span>&nbsp;<span class="ident" id="7346071">T</span><span class="op" id="7346072">)</span>&nbsp;<span class="ident" id="7346074">method</span><span class="op" id="7346080">(</span><span class="op" id="7346081">)</span>&nbsp;<span class="op" id="7346083">[</span><span class="op" id="7346084">]</span><span class="builtintype" id="7346085">byte</span>&nbsp;<span class="op" id="7346090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7346093">return</span>&nbsp;<span class="ident" id="7346100">t</span><span class="op" id="7346101">.</span><span class="ident" id="7346102">ptrmethod</span><span class="op" id="7346111">(</span><span class="op" id="7346112">)</span><br>
<span class="lineno"></span><span class="op" id="7346114">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="7346117">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;traceback&nbsp;should&nbsp;look&nbsp;something&nbsp;like&nbsp;this,&nbsp;modulo&nbsp;line&nbsp;numbers&nbsp;and&nbsp;hex&nbsp;constants.<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Don&#39;t&nbsp;worry&nbsp;much&nbsp;about&nbsp;the&nbsp;base&nbsp;levels,&nbsp;but&nbsp;check&nbsp;the&nbsp;ones&nbsp;in&nbsp;our&nbsp;own&nbsp;package.<br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/Users/r/go/src/runtime/debug/stack_test.go:15&nbsp;(0x13878)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*T).ptrmethod:&nbsp;return&nbsp;Stack()<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/Users/r/go/src/runtime/debug/stack_test.go:18&nbsp;(0x138dd)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T.method:&nbsp;return&nbsp;t.ptrmethod()<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/Users/r/go/src/runtime/debug/stack_test.go:23&nbsp;(0x13920)<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TestStack:&nbsp;b&nbsp;:=&nbsp;T(0).method()<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/Users/r/go/src/testing/testing.go:132&nbsp;(0x14a7a)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tRunner:&nbsp;test.F(t)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/Users/r/go/src/runtime/proc.c:145&nbsp;(0xc970)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;???:&nbsp;runtime·unlock(&amp;runtime·sched);<br>
<span class="lineno">35</span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="7346730">func</span>&nbsp;<span class="ident" id="7346735">TestStack</span><span class="op" id="7346744">(</span><span class="ident" id="7346745">t</span>&nbsp;<span class="op" id="7346747">*</span><span class="ident" id="7346748">testing</span><span class="op" id="7346755">.</span><span class="ident" id="7346756">T</span><span class="op" id="7346757">)</span>&nbsp;<span class="op" id="7346759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7346762">b</span>&nbsp;<span class="op" id="7346764">:=</span>&nbsp;<span class="ident" id="7346767">T</span><span class="op" id="7346768">(</span><span class="num" id="7346769">0</span><span class="op" id="7346770">)</span><span class="op" id="7346771">.</span><span class="ident" id="7346772">method</span><span class="op" id="7346778">(</span><span class="op" id="7346779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7346782">lines</span>&nbsp;<span class="op" id="7346788">:=</span>&nbsp;<span class="ident" id="7346791">strings</span><span class="op" id="7346798">.</span><span class="ident" id="7346799">Split</span><span class="op" id="7346804">(</span><span class="builtintype" id="7346805">string</span><span class="op" id="7346811">(</span><span class="ident" id="7346812">b</span><span class="op" id="7346813">)</span><span class="op" id="7346814">,</span>&nbsp;<span class="string" id="7346816">&#34;\n&#34;</span><span class="op" id="7346820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7346823">if</span>&nbsp;<span class="builtinfunc" id="7346826">len</span><span class="op" id="7346829">(</span><span class="ident" id="7346830">lines</span><span class="op" id="7346835">)</span>&nbsp;<span class="op" id="7346837">&lt;</span>&nbsp;<span class="num" id="7346839">6</span>&nbsp;<span class="op" id="7346841">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7346845">t</span><span class="op" id="7346846">.</span><span class="ident" id="7346847">Fatal</span><span class="op" id="7346852">(</span><span class="string" id="7346853">&#34;too&nbsp;few&nbsp;lines&#34;</span><span class="op" id="7346868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7346871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7346874">n</span>&nbsp;<span class="op" id="7346876">:=</span>&nbsp;<span class="num" id="7346879">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7346882">frame</span>&nbsp;<span class="op" id="7346888">:=</span>&nbsp;<span class="keyword" id="7346891">func</span><span class="op" id="7346895">(</span><span class="ident" id="7346896">line</span><span class="op" id="7346900">,</span>&nbsp;<span class="ident" id="7346902">code</span>&nbsp;<span class="builtintype" id="7346907">string</span><span class="op" id="7346913">)</span>&nbsp;<span class="op" id="7346915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7346919">check</span><span class="op" id="7346924">(</span><span class="ident" id="7346925">t</span><span class="op" id="7346926">,</span>&nbsp;<span class="ident" id="7346928">lines</span><span class="op" id="7346933">[</span><span class="ident" id="7346934">n</span><span class="op" id="7346935">]</span><span class="op" id="7346936">,</span>&nbsp;<span class="ident" id="7346938">line</span><span class="op" id="7346942">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7346946">n</span><span class="op" id="7346947">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7346952">//&nbsp;The&nbsp;source&nbsp;might&nbsp;not&nbsp;be&nbsp;available&nbsp;while&nbsp;running&nbsp;the&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7347015">if</span>&nbsp;<span class="ident" id="7347018">strings</span><span class="op" id="7347025">.</span><span class="ident" id="7347026">HasPrefix</span><span class="op" id="7347035">(</span><span class="ident" id="7347036">lines</span><span class="op" id="7347041">[</span><span class="ident" id="7347042">n</span><span class="op" id="7347043">]</span><span class="op" id="7347044">,</span>&nbsp;<span class="string" id="7347046">&#34;\t&#34;</span><span class="op" id="7347050">)</span>&nbsp;<span class="op" id="7347052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7347057">check</span><span class="op" id="7347062">(</span><span class="ident" id="7347063">t</span><span class="op" id="7347064">,</span>&nbsp;<span class="ident" id="7347066">lines</span><span class="op" id="7347071">[</span><span class="ident" id="7347072">n</span><span class="op" id="7347073">]</span><span class="op" id="7347074">,</span>&nbsp;<span class="ident" id="7347076">code</span><span class="op" id="7347080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7347085">n</span><span class="op" id="7347086">++</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7347091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7347094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7347097">frame</span><span class="op" id="7347102">(</span><span class="string" id="7347103">&#34;src/runtime/debug/stack_test.go&#34;</span><span class="op" id="7347136">,</span>&nbsp;<span class="string" id="7347138">&#34;\t(*T).ptrmethod:&nbsp;return&nbsp;Stack()&#34;</span><span class="op" id="7347172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7347175">frame</span><span class="op" id="7347180">(</span><span class="string" id="7347181">&#34;src/runtime/debug/stack_test.go&#34;</span><span class="op" id="7347214">,</span>&nbsp;<span class="string" id="7347216">&#34;\tT.method:&nbsp;return&nbsp;t.ptrmethod()&#34;</span><span class="op" id="7347250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7347253">frame</span><span class="op" id="7347258">(</span><span class="string" id="7347259">&#34;src/runtime/debug/stack_test.go&#34;</span><span class="op" id="7347292">,</span>&nbsp;<span class="string" id="7347294">&#34;\tTestStack:&nbsp;b&nbsp;:=&nbsp;T(0).method()&#34;</span><span class="op" id="7347327">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7347330">frame</span><span class="op" id="7347335">(</span><span class="string" id="7347336">&#34;src/testing/testing.go&#34;</span><span class="op" id="7347360">,</span>&nbsp;<span class="string" id="7347362">&#34;&#34;</span><span class="op" id="7347364">)</span><br>
<span class="lineno"></span><span class="op" id="7347366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7347369">func</span>&nbsp;<span class="ident" id="7347374">check</span><span class="op" id="7347379">(</span><span class="ident" id="7347380">t</span>&nbsp;<span class="op" id="7347382">*</span><span class="ident" id="7347383">testing</span><span class="op" id="7347390">.</span><span class="ident" id="7347391">T</span><span class="op" id="7347392">,</span>&nbsp;<span class="ident" id="7347394">line</span><span class="op" id="7347398">,</span>&nbsp;<span class="ident" id="7347400">has</span>&nbsp;<span class="builtintype" id="7347404">string</span><span class="op" id="7347410">)</span>&nbsp;<span class="op" id="7347412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7347415">if</span>&nbsp;<span class="ident" id="7347418">strings</span><span class="op" id="7347425">.</span><span class="ident" id="7347426">Index</span><span class="op" id="7347431">(</span><span class="ident" id="7347432">line</span><span class="op" id="7347436">,</span>&nbsp;<span class="ident" id="7347438">has</span><span class="op" id="7347441">)</span>&nbsp;<span class="op" id="7347443">&lt;</span>&nbsp;<span class="num" id="7347445">0</span>&nbsp;<span class="op" id="7347447">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7347451">t</span><span class="op" id="7347452">.</span><span class="ident" id="7347453">Errorf</span><span class="op" id="7347459">(</span><span class="string" id="7347460">&#34;expected&nbsp;%q&nbsp;in&nbsp;%q&#34;</span><span class="op" id="7347479">,</span>&nbsp;<span class="ident" id="7347481">has</span><span class="op" id="7347484">,</span>&nbsp;<span class="ident" id="7347486">line</span><span class="op" id="7347490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7347493">}</span><br>
<span class="lineno"></span><span class="op" id="7347495">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
