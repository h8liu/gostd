<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/ecdsa</h2>
<ul>
<li><a href="/gostd/crypto/ecdsa/ecdsa.go.html">ecdsa.go</a></li>
<li><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html" class="current">ecdsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7844391">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7844446">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7844500">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7844551">package</span>&nbsp;<span class="ident" id="7844559">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7844566">import</span>&nbsp;<span class="op" id="7844573">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7844576">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7844585">&#34;compress/bzip2&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7844603">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7844622">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7844637">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7844652">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7844669">&#34;crypto/sha512&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7844686">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7844702">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7844710">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7844716">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7844728">&#34;os&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7844734">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7844745">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7844755">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7844758">func</span>&nbsp;<span class="ident" id="7844763">testKeyGeneration</span><span class="op" id="7844780">(</span><span class="ident" id="7844781">t</span>&nbsp;<span class="op" id="7844783">*</span><span class="ident" id="7844784">testing</span><span class="op" id="7844791">.</span><span class="ident" id="7844792">T</span><span class="op" id="7844793">,</span>&nbsp;<span class="ident" id="7844795">c</span>&nbsp;<span class="ident" id="7844797">elliptic</span><span class="op" id="7844805">.</span><span class="ident" id="7844806">Curve</span><span class="op" id="7844811">,</span>&nbsp;<span class="ident" id="7844813">tag</span>&nbsp;<span class="builtintype" id="7844817">string</span><span class="op" id="7844823">)</span>&nbsp;<span class="op" id="7844825">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7844828">priv</span><span class="op" id="7844832">,</span>&nbsp;<span class="ident" id="7844834">err</span>&nbsp;<span class="op" id="7844838">:=</span>&nbsp;<span class="ident" id="7844841">GenerateKey</span><span class="op" id="7844852">(</span><span class="ident" id="7844853">c</span><span class="op" id="7844854">,</span>&nbsp;<span class="ident" id="7844856">rand</span><span class="op" id="7844860">.</span><span class="ident" id="7844861">Reader</span><span class="op" id="7844867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7844870">if</span>&nbsp;<span class="ident" id="7844873">err</span>&nbsp;<span class="op" id="7844877">!=</span>&nbsp;<span class="builtintype" id="7844880">nil</span>&nbsp;<span class="op" id="7844884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7844888">t</span><span class="op" id="7844889">.</span><span class="ident" id="7844890">Errorf</span><span class="op" id="7844896">(</span><span class="string" id="7844897">&#34;%s:&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7844912">,</span>&nbsp;<span class="ident" id="7844914">tag</span><span class="op" id="7844917">,</span>&nbsp;<span class="ident" id="7844919">err</span><span class="op" id="7844922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7844926">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844934">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7844937">if</span>&nbsp;<span class="op" id="7844940">!</span><span class="ident" id="7844941">c</span><span class="op" id="7844942">.</span><span class="ident" id="7844943">IsOnCurve</span><span class="op" id="7844952">(</span><span class="ident" id="7844953">priv</span><span class="op" id="7844957">.</span><span class="ident" id="7844958">PublicKey</span><span class="op" id="7844967">.</span><span class="ident" id="7844968">X</span><span class="op" id="7844969">,</span>&nbsp;<span class="ident" id="7844971">priv</span><span class="op" id="7844975">.</span><span class="ident" id="7844976">PublicKey</span><span class="op" id="7844985">.</span><span class="ident" id="7844986">Y</span><span class="op" id="7844987">)</span>&nbsp;<span class="op" id="7844989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7844993">t</span><span class="op" id="7844994">.</span><span class="ident" id="7844995">Errorf</span><span class="op" id="7845001">(</span><span class="string" id="7845002">&#34;%s:&nbsp;public&nbsp;key&nbsp;invalid:&nbsp;%s&#34;</span><span class="op" id="7845030">,</span>&nbsp;<span class="ident" id="7845032">tag</span><span class="op" id="7845035">,</span>&nbsp;<span class="ident" id="7845037">err</span><span class="op" id="7845040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845043">}</span><br>
<span class="lineno"></span><span class="op" id="7845045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7845048">func</span>&nbsp;<span class="ident" id="7845053">TestKeyGeneration</span><span class="op" id="7845070">(</span><span class="ident" id="7845071">t</span>&nbsp;<span class="op" id="7845073">*</span><span class="ident" id="7845074">testing</span><span class="op" id="7845081">.</span><span class="ident" id="7845082">T</span><span class="op" id="7845083">)</span>&nbsp;<span class="op" id="7845085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845088">testKeyGeneration</span><span class="op" id="7845105">(</span><span class="ident" id="7845106">t</span><span class="op" id="7845107">,</span>&nbsp;<span class="ident" id="7845109">elliptic</span><span class="op" id="7845117">.</span><span class="ident" id="7845118">P224</span><span class="op" id="7845122">(</span><span class="op" id="7845123">)</span><span class="op" id="7845124">,</span>&nbsp;<span class="string" id="7845126">&#34;p224&#34;</span><span class="op" id="7845132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7845135">if</span>&nbsp;<span class="ident" id="7845138">testing</span><span class="op" id="7845145">.</span><span class="ident" id="7845146">Short</span><span class="op" id="7845151">(</span><span class="op" id="7845152">)</span>&nbsp;<span class="op" id="7845154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7845158">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845166">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845169">testKeyGeneration</span><span class="op" id="7845186">(</span><span class="ident" id="7845187">t</span><span class="op" id="7845188">,</span>&nbsp;<span class="ident" id="7845190">elliptic</span><span class="op" id="7845198">.</span><span class="ident" id="7845199">P256</span><span class="op" id="7845203">(</span><span class="op" id="7845204">)</span><span class="op" id="7845205">,</span>&nbsp;<span class="string" id="7845207">&#34;p256&#34;</span><span class="op" id="7845213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845216">testKeyGeneration</span><span class="op" id="7845233">(</span><span class="ident" id="7845234">t</span><span class="op" id="7845235">,</span>&nbsp;<span class="ident" id="7845237">elliptic</span><span class="op" id="7845245">.</span><span class="ident" id="7845246">P384</span><span class="op" id="7845250">(</span><span class="op" id="7845251">)</span><span class="op" id="7845252">,</span>&nbsp;<span class="string" id="7845254">&#34;p384&#34;</span><span class="op" id="7845260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845263">testKeyGeneration</span><span class="op" id="7845280">(</span><span class="ident" id="7845281">t</span><span class="op" id="7845282">,</span>&nbsp;<span class="ident" id="7845284">elliptic</span><span class="op" id="7845292">.</span><span class="ident" id="7845293">P521</span><span class="op" id="7845297">(</span><span class="op" id="7845298">)</span><span class="op" id="7845299">,</span>&nbsp;<span class="string" id="7845301">&#34;p521&#34;</span><span class="op" id="7845307">)</span><br>
<span class="lineno"></span><span class="op" id="7845309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="7845312">func</span>&nbsp;<span class="ident" id="7845317">testSignAndVerify</span><span class="op" id="7845334">(</span><span class="ident" id="7845335">t</span>&nbsp;<span class="op" id="7845337">*</span><span class="ident" id="7845338">testing</span><span class="op" id="7845345">.</span><span class="ident" id="7845346">T</span><span class="op" id="7845347">,</span>&nbsp;<span class="ident" id="7845349">c</span>&nbsp;<span class="ident" id="7845351">elliptic</span><span class="op" id="7845359">.</span><span class="ident" id="7845360">Curve</span><span class="op" id="7845365">,</span>&nbsp;<span class="ident" id="7845367">tag</span>&nbsp;<span class="builtintype" id="7845371">string</span><span class="op" id="7845377">)</span>&nbsp;<span class="op" id="7845379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845382">priv</span><span class="op" id="7845386">,</span>&nbsp;<span class="ident" id="7845388">_</span>&nbsp;<span class="op" id="7845390">:=</span>&nbsp;<span class="ident" id="7845393">GenerateKey</span><span class="op" id="7845404">(</span><span class="ident" id="7845405">c</span><span class="op" id="7845406">,</span>&nbsp;<span class="ident" id="7845408">rand</span><span class="op" id="7845412">.</span><span class="ident" id="7845413">Reader</span><span class="op" id="7845419">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845423">hashed</span>&nbsp;<span class="op" id="7845430">:=</span>&nbsp;<span class="op" id="7845433">[</span><span class="op" id="7845434">]</span><span class="builtintype" id="7845435">byte</span><span class="op" id="7845439">(</span><span class="string" id="7845440">&#34;testing&#34;</span><span class="op" id="7845449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845452">r</span><span class="op" id="7845453">,</span>&nbsp;<span class="ident" id="7845455">s</span><span class="op" id="7845456">,</span>&nbsp;<span class="ident" id="7845458">err</span>&nbsp;<span class="op" id="7845462">:=</span>&nbsp;<span class="ident" id="7845465">Sign</span><span class="op" id="7845469">(</span><span class="ident" id="7845470">rand</span><span class="op" id="7845474">.</span><span class="ident" id="7845475">Reader</span><span class="op" id="7845481">,</span>&nbsp;<span class="ident" id="7845483">priv</span><span class="op" id="7845487">,</span>&nbsp;<span class="ident" id="7845489">hashed</span><span class="op" id="7845495">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7845498">if</span>&nbsp;<span class="ident" id="7845501">err</span>&nbsp;<span class="op" id="7845505">!=</span>&nbsp;<span class="builtintype" id="7845508">nil</span>&nbsp;<span class="op" id="7845512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845516">t</span><span class="op" id="7845517">.</span><span class="ident" id="7845518">Errorf</span><span class="op" id="7845524">(</span><span class="string" id="7845525">&#34;%s:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7845548">,</span>&nbsp;<span class="ident" id="7845550">tag</span><span class="op" id="7845553">,</span>&nbsp;<span class="ident" id="7845555">err</span><span class="op" id="7845558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7845562">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7845574">if</span>&nbsp;<span class="op" id="7845577">!</span><span class="ident" id="7845578">Verify</span><span class="op" id="7845584">(</span><span class="op" id="7845585">&amp;</span><span class="ident" id="7845586">priv</span><span class="op" id="7845590">.</span><span class="ident" id="7845591">PublicKey</span><span class="op" id="7845600">,</span>&nbsp;<span class="ident" id="7845602">hashed</span><span class="op" id="7845608">,</span>&nbsp;<span class="ident" id="7845610">r</span><span class="op" id="7845611">,</span>&nbsp;<span class="ident" id="7845613">s</span><span class="op" id="7845614">)</span>&nbsp;<span class="op" id="7845616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845620">t</span><span class="op" id="7845621">.</span><span class="ident" id="7845622">Errorf</span><span class="op" id="7845628">(</span><span class="string" id="7845629">&#34;%s:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="7845648">,</span>&nbsp;<span class="ident" id="7845650">tag</span><span class="op" id="7845653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845660">hashed</span><span class="op" id="7845666">[</span><span class="num" id="7845667">0</span><span class="op" id="7845668">]</span>&nbsp;<span class="op" id="7845670">^=</span>&nbsp;<span class="num" id="7845673">0xff</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7845679">if</span>&nbsp;<span class="ident" id="7845682">Verify</span><span class="op" id="7845688">(</span><span class="op" id="7845689">&amp;</span><span class="ident" id="7845690">priv</span><span class="op" id="7845694">.</span><span class="ident" id="7845695">PublicKey</span><span class="op" id="7845704">,</span>&nbsp;<span class="ident" id="7845706">hashed</span><span class="op" id="7845712">,</span>&nbsp;<span class="ident" id="7845714">r</span><span class="op" id="7845715">,</span>&nbsp;<span class="ident" id="7845717">s</span><span class="op" id="7845718">)</span>&nbsp;<span class="op" id="7845720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845724">t</span><span class="op" id="7845725">.</span><span class="ident" id="7845726">Errorf</span><span class="op" id="7845732">(</span><span class="string" id="7845733">&#34;%s:&nbsp;Verify&nbsp;always&nbsp;works!&#34;</span><span class="op" id="7845759">,</span>&nbsp;<span class="ident" id="7845761">tag</span><span class="op" id="7845764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845767">}</span><br>
<span class="lineno"></span><span class="op" id="7845769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="7845772">func</span>&nbsp;<span class="ident" id="7845777">TestSignAndVerify</span><span class="op" id="7845794">(</span><span class="ident" id="7845795">t</span>&nbsp;<span class="op" id="7845797">*</span><span class="ident" id="7845798">testing</span><span class="op" id="7845805">.</span><span class="ident" id="7845806">T</span><span class="op" id="7845807">)</span>&nbsp;<span class="op" id="7845809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845812">testSignAndVerify</span><span class="op" id="7845829">(</span><span class="ident" id="7845830">t</span><span class="op" id="7845831">,</span>&nbsp;<span class="ident" id="7845833">elliptic</span><span class="op" id="7845841">.</span><span class="ident" id="7845842">P224</span><span class="op" id="7845846">(</span><span class="op" id="7845847">)</span><span class="op" id="7845848">,</span>&nbsp;<span class="string" id="7845850">&#34;p224&#34;</span><span class="op" id="7845856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7845859">if</span>&nbsp;<span class="ident" id="7845862">testing</span><span class="op" id="7845869">.</span><span class="ident" id="7845870">Short</span><span class="op" id="7845875">(</span><span class="op" id="7845876">)</span>&nbsp;<span class="op" id="7845878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7845882">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845890">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845893">testSignAndVerify</span><span class="op" id="7845910">(</span><span class="ident" id="7845911">t</span><span class="op" id="7845912">,</span>&nbsp;<span class="ident" id="7845914">elliptic</span><span class="op" id="7845922">.</span><span class="ident" id="7845923">P256</span><span class="op" id="7845927">(</span><span class="op" id="7845928">)</span><span class="op" id="7845929">,</span>&nbsp;<span class="string" id="7845931">&#34;p256&#34;</span><span class="op" id="7845937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845940">testSignAndVerify</span><span class="op" id="7845957">(</span><span class="ident" id="7845958">t</span><span class="op" id="7845959">,</span>&nbsp;<span class="ident" id="7845961">elliptic</span><span class="op" id="7845969">.</span><span class="ident" id="7845970">P384</span><span class="op" id="7845974">(</span><span class="op" id="7845975">)</span><span class="op" id="7845976">,</span>&nbsp;<span class="string" id="7845978">&#34;p384&#34;</span><span class="op" id="7845984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845987">testSignAndVerify</span><span class="op" id="7846004">(</span><span class="ident" id="7846005">t</span><span class="op" id="7846006">,</span>&nbsp;<span class="ident" id="7846008">elliptic</span><span class="op" id="7846016">.</span><span class="ident" id="7846017">P521</span><span class="op" id="7846021">(</span><span class="op" id="7846022">)</span><span class="op" id="7846023">,</span>&nbsp;<span class="string" id="7846025">&#34;p521&#34;</span><span class="op" id="7846031">)</span><br>
<span class="lineno"></span><span class="op" id="7846033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="7846036">func</span>&nbsp;<span class="ident" id="7846041">fromHex</span><span class="op" id="7846048">(</span><span class="ident" id="7846049">s</span>&nbsp;<span class="builtintype" id="7846051">string</span><span class="op" id="7846057">)</span>&nbsp;<span class="op" id="7846059">*</span><span class="ident" id="7846060">big</span><span class="op" id="7846063">.</span><span class="ident" id="7846064">Int</span>&nbsp;<span class="op" id="7846068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846071">r</span><span class="op" id="7846072">,</span>&nbsp;<span class="ident" id="7846074">ok</span>&nbsp;<span class="op" id="7846077">:=</span>&nbsp;<span class="builtinfunc" id="7846080">new</span><span class="op" id="7846083">(</span><span class="ident" id="7846084">big</span><span class="op" id="7846087">.</span><span class="ident" id="7846088">Int</span><span class="op" id="7846091">)</span><span class="op" id="7846092">.</span><span class="ident" id="7846093">SetString</span><span class="op" id="7846102">(</span><span class="ident" id="7846103">s</span><span class="op" id="7846104">,</span>&nbsp;<span class="num" id="7846106">16</span><span class="op" id="7846108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846111">if</span>&nbsp;<span class="op" id="7846114">!</span><span class="ident" id="7846115">ok</span>&nbsp;<span class="op" id="7846118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7846122">panic</span><span class="op" id="7846127">(</span><span class="string" id="7846128">&#34;bad&nbsp;hex&#34;</span><span class="op" id="7846137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846140">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846143">return</span>&nbsp;<span class="ident" id="7846150">r</span><br>
<span class="lineno"></span><span class="op" id="7846152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7846155">func</span>&nbsp;<span class="ident" id="7846160">TestVectors</span><span class="op" id="7846171">(</span><span class="ident" id="7846172">t</span>&nbsp;<span class="op" id="7846174">*</span><span class="ident" id="7846175">testing</span><span class="op" id="7846182">.</span><span class="ident" id="7846183">T</span><span class="op" id="7846184">)</span>&nbsp;<span class="op" id="7846186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7846189">//&nbsp;This&nbsp;test&nbsp;runs&nbsp;the&nbsp;full&nbsp;set&nbsp;of&nbsp;NIST&nbsp;test&nbsp;vectors&nbsp;from</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7846247">//&nbsp;http://csrc.nist.gov/groups/STM/cavp/documents/dss/186-3ecdsatestvectors.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7846328">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7846332">//&nbsp;The&nbsp;SigVer.rsp&nbsp;file&nbsp;has&nbsp;been&nbsp;edited&nbsp;to&nbsp;remove&nbsp;test&nbsp;vectors&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7846399">//&nbsp;unsupported&nbsp;algorithms&nbsp;and&nbsp;has&nbsp;been&nbsp;compressed.</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846452">if</span>&nbsp;<span class="ident" id="7846455">testing</span><span class="op" id="7846462">.</span><span class="ident" id="7846463">Short</span><span class="op" id="7846468">(</span><span class="op" id="7846469">)</span>&nbsp;<span class="op" id="7846471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846475">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846487">f</span><span class="op" id="7846488">,</span>&nbsp;<span class="ident" id="7846490">err</span>&nbsp;<span class="op" id="7846494">:=</span>&nbsp;<span class="ident" id="7846497">os</span><span class="op" id="7846499">.</span><span class="ident" id="7846500">Open</span><span class="op" id="7846504">(</span><span class="string" id="7846505">&#34;testdata/SigVer.rsp.bz2&#34;</span><span class="op" id="7846530">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846533">if</span>&nbsp;<span class="ident" id="7846536">err</span>&nbsp;<span class="op" id="7846540">!=</span>&nbsp;<span class="builtintype" id="7846543">nil</span>&nbsp;<span class="op" id="7846547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846551">t</span><span class="op" id="7846552">.</span><span class="ident" id="7846553">Fatal</span><span class="op" id="7846558">(</span><span class="ident" id="7846559">err</span><span class="op" id="7846562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846569">buf</span>&nbsp;<span class="op" id="7846573">:=</span>&nbsp;<span class="ident" id="7846576">bufio</span><span class="op" id="7846581">.</span><span class="ident" id="7846582">NewReader</span><span class="op" id="7846591">(</span><span class="ident" id="7846592">bzip2</span><span class="op" id="7846597">.</span><span class="ident" id="7846598">NewReader</span><span class="op" id="7846607">(</span><span class="ident" id="7846608">f</span><span class="op" id="7846609">)</span><span class="op" id="7846610">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846614">lineNo</span>&nbsp;<span class="op" id="7846621">:=</span>&nbsp;<span class="num" id="7846624">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846627">var</span>&nbsp;<span class="ident" id="7846631">h</span>&nbsp;<span class="ident" id="7846633">hash</span><span class="op" id="7846637">.</span><span class="ident" id="7846638">Hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846644">var</span>&nbsp;<span class="ident" id="7846648">msg</span>&nbsp;<span class="op" id="7846652">[</span><span class="op" id="7846653">]</span><span class="builtintype" id="7846654">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846660">var</span>&nbsp;<span class="ident" id="7846664">hashed</span>&nbsp;<span class="op" id="7846671">[</span><span class="op" id="7846672">]</span><span class="builtintype" id="7846673">byte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846679">var</span>&nbsp;<span class="ident" id="7846683">r</span><span class="op" id="7846684">,</span>&nbsp;<span class="ident" id="7846686">s</span>&nbsp;<span class="op" id="7846688">*</span><span class="ident" id="7846689">big</span><span class="op" id="7846692">.</span><span class="ident" id="7846693">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846698">pub</span>&nbsp;<span class="op" id="7846702">:=</span>&nbsp;<span class="builtinfunc" id="7846705">new</span><span class="op" id="7846708">(</span><span class="ident" id="7846709">PublicKey</span><span class="op" id="7846718">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846722">for</span>&nbsp;<span class="op" id="7846726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846730">line</span><span class="op" id="7846734">,</span>&nbsp;<span class="ident" id="7846736">err</span>&nbsp;<span class="op" id="7846740">:=</span>&nbsp;<span class="ident" id="7846743">buf</span><span class="op" id="7846746">.</span><span class="ident" id="7846747">ReadString</span><span class="op" id="7846757">(</span><span class="string" id="7846758">&#39;\n&#39;</span><span class="op" id="7846762">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846766">if</span>&nbsp;<span class="builtinfunc" id="7846769">len</span><span class="op" id="7846772">(</span><span class="ident" id="7846773">line</span><span class="op" id="7846777">)</span>&nbsp;<span class="op" id="7846779">==</span>&nbsp;<span class="num" id="7846782">0</span>&nbsp;<span class="op" id="7846784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846789">if</span>&nbsp;<span class="ident" id="7846792">err</span>&nbsp;<span class="op" id="7846796">==</span>&nbsp;<span class="ident" id="7846799">io</span><span class="op" id="7846801">.</span><span class="ident" id="7846802">EOF</span>&nbsp;<span class="op" id="7846806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846812">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846826">t</span><span class="op" id="7846827">.</span><span class="ident" id="7846828">Fatalf</span><span class="op" id="7846834">(</span><span class="string" id="7846835">&#34;error&nbsp;reading&nbsp;from&nbsp;input:&nbsp;%s&#34;</span><span class="op" id="7846865">,</span>&nbsp;<span class="ident" id="7846867">err</span><span class="op" id="7846870">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846878">lineNo</span><span class="op" id="7846884">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7846889">//&nbsp;Need&nbsp;to&nbsp;remove&nbsp;\r\n&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846940">if</span>&nbsp;<span class="op" id="7846943">!</span><span class="ident" id="7846944">strings</span><span class="op" id="7846951">.</span><span class="ident" id="7846952">HasSuffix</span><span class="op" id="7846961">(</span><span class="ident" id="7846962">line</span><span class="op" id="7846966">,</span>&nbsp;<span class="string" id="7846968">&#34;\r\n&#34;</span><span class="op" id="7846974">)</span>&nbsp;<span class="op" id="7846976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846981">t</span><span class="op" id="7846982">.</span><span class="ident" id="7846983">Fatalf</span><span class="op" id="7846989">(</span><span class="string" id="7846990">&#34;bad&nbsp;line&nbsp;ending&nbsp;(expected&nbsp;\\r\\n)&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="7847036">,</span>&nbsp;<span class="ident" id="7847038">lineNo</span><span class="op" id="7847044">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847052">line</span>&nbsp;<span class="op" id="7847057">=</span>&nbsp;<span class="ident" id="7847059">line</span><span class="op" id="7847063">[</span><span class="op" id="7847064">:</span><span class="builtinfunc" id="7847065">len</span><span class="op" id="7847068">(</span><span class="ident" id="7847069">line</span><span class="op" id="7847073">)</span><span class="op" id="7847074">-</span><span class="num" id="7847075">2</span><span class="op" id="7847076">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847081">if</span>&nbsp;<span class="builtinfunc" id="7847084">len</span><span class="op" id="7847087">(</span><span class="ident" id="7847088">line</span><span class="op" id="7847092">)</span>&nbsp;<span class="op" id="7847094">==</span>&nbsp;<span class="num" id="7847097">0</span>&nbsp;<span class="op" id="7847099">||</span>&nbsp;<span class="ident" id="7847102">line</span><span class="op" id="7847106">[</span><span class="num" id="7847107">0</span><span class="op" id="7847108">]</span>&nbsp;<span class="op" id="7847110">==</span>&nbsp;<span class="string" id="7847113">&#39;#&#39;</span>&nbsp;<span class="op" id="7847117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847122">continue</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847138">if</span>&nbsp;<span class="ident" id="7847141">line</span><span class="op" id="7847145">[</span><span class="num" id="7847146">0</span><span class="op" id="7847147">]</span>&nbsp;<span class="op" id="7847149">==</span>&nbsp;<span class="string" id="7847152">&#39;[&#39;</span>&nbsp;<span class="op" id="7847156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847161">line</span>&nbsp;<span class="op" id="7847166">=</span>&nbsp;<span class="ident" id="7847168">line</span><span class="op" id="7847172">[</span><span class="num" id="7847173">1</span>&nbsp;<span class="op" id="7847175">:</span>&nbsp;<span class="builtinfunc" id="7847177">len</span><span class="op" id="7847180">(</span><span class="ident" id="7847181">line</span><span class="op" id="7847185">)</span><span class="op" id="7847186">-</span><span class="num" id="7847187">1</span><span class="op" id="7847188">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847193">parts</span>&nbsp;<span class="op" id="7847199">:=</span>&nbsp;<span class="ident" id="7847202">strings</span><span class="op" id="7847209">.</span><span class="ident" id="7847210">SplitN</span><span class="op" id="7847216">(</span><span class="ident" id="7847217">line</span><span class="op" id="7847221">,</span>&nbsp;<span class="string" id="7847223">&#34;,&#34;</span><span class="op" id="7847226">,</span>&nbsp;<span class="num" id="7847228">2</span><span class="op" id="7847229">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847235">switch</span>&nbsp;<span class="ident" id="7847242">parts</span><span class="op" id="7847247">[</span><span class="num" id="7847248">0</span><span class="op" id="7847249">]</span>&nbsp;<span class="op" id="7847251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847256">case</span>&nbsp;<span class="string" id="7847261">&#34;P-224&#34;</span><span class="op" id="7847268">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847274">pub</span><span class="op" id="7847277">.</span><span class="ident" id="7847278">Curve</span>&nbsp;<span class="op" id="7847284">=</span>&nbsp;<span class="ident" id="7847286">elliptic</span><span class="op" id="7847294">.</span><span class="ident" id="7847295">P224</span><span class="op" id="7847299">(</span><span class="op" id="7847300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847305">case</span>&nbsp;<span class="string" id="7847310">&#34;P-256&#34;</span><span class="op" id="7847317">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847323">pub</span><span class="op" id="7847326">.</span><span class="ident" id="7847327">Curve</span>&nbsp;<span class="op" id="7847333">=</span>&nbsp;<span class="ident" id="7847335">elliptic</span><span class="op" id="7847343">.</span><span class="ident" id="7847344">P256</span><span class="op" id="7847348">(</span><span class="op" id="7847349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847354">case</span>&nbsp;<span class="string" id="7847359">&#34;P-384&#34;</span><span class="op" id="7847366">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847372">pub</span><span class="op" id="7847375">.</span><span class="ident" id="7847376">Curve</span>&nbsp;<span class="op" id="7847382">=</span>&nbsp;<span class="ident" id="7847384">elliptic</span><span class="op" id="7847392">.</span><span class="ident" id="7847393">P384</span><span class="op" id="7847397">(</span><span class="op" id="7847398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847403">case</span>&nbsp;<span class="string" id="7847408">&#34;P-521&#34;</span><span class="op" id="7847415">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847421">pub</span><span class="op" id="7847424">.</span><span class="ident" id="7847425">Curve</span>&nbsp;<span class="op" id="7847431">=</span>&nbsp;<span class="ident" id="7847433">elliptic</span><span class="op" id="7847441">.</span><span class="ident" id="7847442">P521</span><span class="op" id="7847446">(</span><span class="op" id="7847447">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847452">default</span><span class="op" id="7847459">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847465">pub</span><span class="op" id="7847468">.</span><span class="ident" id="7847469">Curve</span>&nbsp;<span class="op" id="7847475">=</span>&nbsp;<span class="builtintype" id="7847477">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847490">switch</span>&nbsp;<span class="ident" id="7847497">parts</span><span class="op" id="7847502">[</span><span class="num" id="7847503">1</span><span class="op" id="7847504">]</span>&nbsp;<span class="op" id="7847506">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847511">case</span>&nbsp;<span class="string" id="7847516">&#34;SHA-1&#34;</span><span class="op" id="7847523">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847529">h</span>&nbsp;<span class="op" id="7847531">=</span>&nbsp;<span class="ident" id="7847533">sha1</span><span class="op" id="7847537">.</span><span class="ident" id="7847538">New</span><span class="op" id="7847541">(</span><span class="op" id="7847542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847547">case</span>&nbsp;<span class="string" id="7847552">&#34;SHA-224&#34;</span><span class="op" id="7847561">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847567">h</span>&nbsp;<span class="op" id="7847569">=</span>&nbsp;<span class="ident" id="7847571">sha256</span><span class="op" id="7847577">.</span><span class="ident" id="7847578">New224</span><span class="op" id="7847584">(</span><span class="op" id="7847585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847590">case</span>&nbsp;<span class="string" id="7847595">&#34;SHA-256&#34;</span><span class="op" id="7847604">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847610">h</span>&nbsp;<span class="op" id="7847612">=</span>&nbsp;<span class="ident" id="7847614">sha256</span><span class="op" id="7847620">.</span><span class="ident" id="7847621">New</span><span class="op" id="7847624">(</span><span class="op" id="7847625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847630">case</span>&nbsp;<span class="string" id="7847635">&#34;SHA-384&#34;</span><span class="op" id="7847644">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847650">h</span>&nbsp;<span class="op" id="7847652">=</span>&nbsp;<span class="ident" id="7847654">sha512</span><span class="op" id="7847660">.</span><span class="ident" id="7847661">New384</span><span class="op" id="7847667">(</span><span class="op" id="7847668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847673">case</span>&nbsp;<span class="string" id="7847678">&#34;SHA-512&#34;</span><span class="op" id="7847687">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847693">h</span>&nbsp;<span class="op" id="7847695">=</span>&nbsp;<span class="ident" id="7847697">sha512</span><span class="op" id="7847703">.</span><span class="ident" id="7847704">New</span><span class="op" id="7847707">(</span><span class="op" id="7847708">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847713">default</span><span class="op" id="7847720">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847726">h</span>&nbsp;<span class="op" id="7847728">=</span>&nbsp;<span class="builtintype" id="7847730">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847743">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847759">if</span>&nbsp;<span class="ident" id="7847762">h</span>&nbsp;<span class="op" id="7847764">==</span>&nbsp;<span class="builtintype" id="7847767">nil</span>&nbsp;<span class="op" id="7847771">||</span>&nbsp;<span class="ident" id="7847774">pub</span><span class="op" id="7847777">.</span><span class="ident" id="7847778">Curve</span>&nbsp;<span class="op" id="7847784">==</span>&nbsp;<span class="builtintype" id="7847787">nil</span>&nbsp;<span class="op" id="7847791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847796">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847807">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847812">switch</span>&nbsp;<span class="op" id="7847819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847823">case</span>&nbsp;<span class="ident" id="7847828">strings</span><span class="op" id="7847835">.</span><span class="ident" id="7847836">HasPrefix</span><span class="op" id="7847845">(</span><span class="ident" id="7847846">line</span><span class="op" id="7847850">,</span>&nbsp;<span class="string" id="7847852">&#34;Msg&nbsp;=&nbsp;&#34;</span><span class="op" id="7847860">)</span><span class="op" id="7847861">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847866">if</span>&nbsp;<span class="ident" id="7847869">msg</span><span class="op" id="7847872">,</span>&nbsp;<span class="ident" id="7847874">err</span>&nbsp;<span class="op" id="7847878">=</span>&nbsp;<span class="ident" id="7847880">hex</span><span class="op" id="7847883">.</span><span class="ident" id="7847884">DecodeString</span><span class="op" id="7847896">(</span><span class="ident" id="7847897">line</span><span class="op" id="7847901">[</span><span class="num" id="7847902">6</span><span class="op" id="7847903">:</span><span class="op" id="7847904">]</span><span class="op" id="7847905">)</span><span class="op" id="7847906">;</span>&nbsp;<span class="ident" id="7847908">err</span>&nbsp;<span class="op" id="7847912">!=</span>&nbsp;<span class="builtintype" id="7847915">nil</span>&nbsp;<span class="op" id="7847919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847925">t</span><span class="op" id="7847926">.</span><span class="ident" id="7847927">Fatalf</span><span class="op" id="7847933">(</span><span class="string" id="7847934">&#34;failed&nbsp;to&nbsp;decode&nbsp;message&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="7847975">,</span>&nbsp;<span class="ident" id="7847977">lineNo</span><span class="op" id="7847983">,</span>&nbsp;<span class="ident" id="7847985">err</span><span class="op" id="7847988">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847997">case</span>&nbsp;<span class="ident" id="7848002">strings</span><span class="op" id="7848009">.</span><span class="ident" id="7848010">HasPrefix</span><span class="op" id="7848019">(</span><span class="ident" id="7848020">line</span><span class="op" id="7848024">,</span>&nbsp;<span class="string" id="7848026">&#34;Qx&nbsp;=&nbsp;&#34;</span><span class="op" id="7848033">)</span><span class="op" id="7848034">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848039">pub</span><span class="op" id="7848042">.</span><span class="ident" id="7848043">X</span>&nbsp;<span class="op" id="7848045">=</span>&nbsp;<span class="ident" id="7848047">fromHex</span><span class="op" id="7848054">(</span><span class="ident" id="7848055">line</span><span class="op" id="7848059">[</span><span class="num" id="7848060">5</span><span class="op" id="7848061">:</span><span class="op" id="7848062">]</span><span class="op" id="7848063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7848067">case</span>&nbsp;<span class="ident" id="7848072">strings</span><span class="op" id="7848079">.</span><span class="ident" id="7848080">HasPrefix</span><span class="op" id="7848089">(</span><span class="ident" id="7848090">line</span><span class="op" id="7848094">,</span>&nbsp;<span class="string" id="7848096">&#34;Qy&nbsp;=&nbsp;&#34;</span><span class="op" id="7848103">)</span><span class="op" id="7848104">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848109">pub</span><span class="op" id="7848112">.</span><span class="ident" id="7848113">Y</span>&nbsp;<span class="op" id="7848115">=</span>&nbsp;<span class="ident" id="7848117">fromHex</span><span class="op" id="7848124">(</span><span class="ident" id="7848125">line</span><span class="op" id="7848129">[</span><span class="num" id="7848130">5</span><span class="op" id="7848131">:</span><span class="op" id="7848132">]</span><span class="op" id="7848133">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7848137">case</span>&nbsp;<span class="ident" id="7848142">strings</span><span class="op" id="7848149">.</span><span class="ident" id="7848150">HasPrefix</span><span class="op" id="7848159">(</span><span class="ident" id="7848160">line</span><span class="op" id="7848164">,</span>&nbsp;<span class="string" id="7848166">&#34;R&nbsp;=&nbsp;&#34;</span><span class="op" id="7848172">)</span><span class="op" id="7848173">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848178">r</span>&nbsp;<span class="op" id="7848180">=</span>&nbsp;<span class="ident" id="7848182">fromHex</span><span class="op" id="7848189">(</span><span class="ident" id="7848190">line</span><span class="op" id="7848194">[</span><span class="num" id="7848195">4</span><span class="op" id="7848196">:</span><span class="op" id="7848197">]</span><span class="op" id="7848198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7848202">case</span>&nbsp;<span class="ident" id="7848207">strings</span><span class="op" id="7848214">.</span><span class="ident" id="7848215">HasPrefix</span><span class="op" id="7848224">(</span><span class="ident" id="7848225">line</span><span class="op" id="7848229">,</span>&nbsp;<span class="string" id="7848231">&#34;S&nbsp;=&nbsp;&#34;</span><span class="op" id="7848237">)</span><span class="op" id="7848238">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848243">s</span>&nbsp;<span class="op" id="7848245">=</span>&nbsp;<span class="ident" id="7848247">fromHex</span><span class="op" id="7848254">(</span><span class="ident" id="7848255">line</span><span class="op" id="7848259">[</span><span class="num" id="7848260">4</span><span class="op" id="7848261">:</span><span class="op" id="7848262">]</span><span class="op" id="7848263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7848267">case</span>&nbsp;<span class="ident" id="7848272">strings</span><span class="op" id="7848279">.</span><span class="ident" id="7848280">HasPrefix</span><span class="op" id="7848289">(</span><span class="ident" id="7848290">line</span><span class="op" id="7848294">,</span>&nbsp;<span class="string" id="7848296">&#34;Result&nbsp;=&nbsp;&#34;</span><span class="op" id="7848307">)</span><span class="op" id="7848308">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848313">expected</span>&nbsp;<span class="op" id="7848322">:=</span>&nbsp;<span class="ident" id="7848325">line</span><span class="op" id="7848329">[</span><span class="num" id="7848330">9</span><span class="op" id="7848331">]</span>&nbsp;<span class="op" id="7848333">==</span>&nbsp;<span class="string" id="7848336">&#39;P&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848343">h</span><span class="op" id="7848344">.</span><span class="ident" id="7848345">Reset</span><span class="op" id="7848350">(</span><span class="op" id="7848351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848356">h</span><span class="op" id="7848357">.</span><span class="ident" id="7848358">Write</span><span class="op" id="7848363">(</span><span class="ident" id="7848364">msg</span><span class="op" id="7848367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848372">hashed</span>&nbsp;<span class="op" id="7848379">:=</span>&nbsp;<span class="ident" id="7848382">h</span><span class="op" id="7848383">.</span><span class="ident" id="7848384">Sum</span><span class="op" id="7848387">(</span><span class="ident" id="7848388">hashed</span><span class="op" id="7848394">[</span><span class="op" id="7848395">:</span><span class="num" id="7848396">0</span><span class="op" id="7848397">]</span><span class="op" id="7848398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7848403">if</span>&nbsp;<span class="ident" id="7848406">Verify</span><span class="op" id="7848412">(</span><span class="ident" id="7848413">pub</span><span class="op" id="7848416">,</span>&nbsp;<span class="ident" id="7848418">hashed</span><span class="op" id="7848424">,</span>&nbsp;<span class="ident" id="7848426">r</span><span class="op" id="7848427">,</span>&nbsp;<span class="ident" id="7848429">s</span><span class="op" id="7848430">)</span>&nbsp;<span class="op" id="7848432">!=</span>&nbsp;<span class="ident" id="7848435">expected</span>&nbsp;<span class="op" id="7848444">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848450">t</span><span class="op" id="7848451">.</span><span class="ident" id="7848452">Fatalf</span><span class="op" id="7848458">(</span><span class="string" id="7848459">&#34;incorrect&nbsp;result&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="7848488">,</span>&nbsp;<span class="ident" id="7848490">lineNo</span><span class="op" id="7848496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7848501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7848505">default</span><span class="op" id="7848512">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848517">t</span><span class="op" id="7848518">.</span><span class="ident" id="7848519">Fatalf</span><span class="op" id="7848525">(</span><span class="string" id="7848526">&#34;unknown&nbsp;variable&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="7848559">,</span>&nbsp;<span class="ident" id="7848561">lineNo</span><span class="op" id="7848567">,</span>&nbsp;<span class="ident" id="7848569">line</span><span class="op" id="7848573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7848577">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7848580">}</span><br>
<span class="lineno"></span><span class="op" id="7848582">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
