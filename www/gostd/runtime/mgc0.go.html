<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1537867">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1537922">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1537976">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1538027">package</span>&nbsp;<span class="ident" id="1538035">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1538044">import</span>&nbsp;<span class="string" id="1538051">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1538061">//&nbsp;Called&nbsp;from&nbsp;C.&nbsp;Returns&nbsp;the&nbsp;Go&nbsp;type&nbsp;*m.</span><br>
<span class="lineno">10</span><span class="keyword" id="1538103">func</span>&nbsp;<span class="ident" id="1538108">gc_m_ptr</span><span class="op" id="1538116">(</span><span class="ident" id="1538117">ret</span>&nbsp;<span class="op" id="1538121">*</span><span class="keyword" id="1538122">interface</span><span class="op" id="1538131">{</span><span class="op" id="1538132">}</span><span class="op" id="1538133">)</span>&nbsp;<span class="op" id="1538135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1538138">*</span><span class="ident" id="1538139">ret</span>&nbsp;<span class="op" id="1538143">=</span>&nbsp;<span class="op" id="1538145">(</span><span class="op" id="1538146">*</span><span class="ident" id="1538147">m</span><span class="op" id="1538148">)</span><span class="op" id="1538149">(</span><span class="ident" id="1538150">nil</span><span class="op" id="1538153">)</span><br>
<span class="lineno"></span><span class="op" id="1538155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1538158">//&nbsp;Called&nbsp;from&nbsp;C.&nbsp;Returns&nbsp;the&nbsp;Go&nbsp;type&nbsp;*g.</span><br>
<span class="lineno">15</span><span class="keyword" id="1538200">func</span>&nbsp;<span class="ident" id="1538205">gc_g_ptr</span><span class="op" id="1538213">(</span><span class="ident" id="1538214">ret</span>&nbsp;<span class="op" id="1538218">*</span><span class="keyword" id="1538219">interface</span><span class="op" id="1538228">{</span><span class="op" id="1538229">}</span><span class="op" id="1538230">)</span>&nbsp;<span class="op" id="1538232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1538235">*</span><span class="ident" id="1538236">ret</span>&nbsp;<span class="op" id="1538240">=</span>&nbsp;<span class="op" id="1538242">(</span><span class="op" id="1538243">*</span><span class="ident" id="1538244">g</span><span class="op" id="1538245">)</span><span class="op" id="1538246">(</span><span class="ident" id="1538247">nil</span><span class="op" id="1538250">)</span><br>
<span class="lineno"></span><span class="op" id="1538252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1538255">//&nbsp;Called&nbsp;from&nbsp;C.&nbsp;Returns&nbsp;the&nbsp;Go&nbsp;type&nbsp;*itab.</span><br>
<span class="lineno">20</span><span class="keyword" id="1538300">func</span>&nbsp;<span class="ident" id="1538305">gc_itab_ptr</span><span class="op" id="1538316">(</span><span class="ident" id="1538317">ret</span>&nbsp;<span class="op" id="1538321">*</span><span class="keyword" id="1538322">interface</span><span class="op" id="1538331">{</span><span class="op" id="1538332">}</span><span class="op" id="1538333">)</span>&nbsp;<span class="op" id="1538335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1538338">*</span><span class="ident" id="1538339">ret</span>&nbsp;<span class="op" id="1538343">=</span>&nbsp;<span class="op" id="1538345">(</span><span class="op" id="1538346">*</span><span class="ident" id="1538347">itab</span><span class="op" id="1538351">)</span><span class="op" id="1538352">(</span><span class="ident" id="1538353">nil</span><span class="op" id="1538356">)</span><br>
<span class="lineno"></span><span class="op" id="1538358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1538361">func</span>&nbsp;<span class="ident" id="1538366">gc_unixnanotime</span><span class="op" id="1538381">(</span><span class="ident" id="1538382">now</span>&nbsp;<span class="op" id="1538386">*</span><span class="ident" id="1538387">int64</span><span class="op" id="1538392">)</span>&nbsp;<span class="op" id="1538394">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538397">sec</span><span class="op" id="1538400">,</span>&nbsp;<span class="ident" id="1538402">nsec</span>&nbsp;<span class="op" id="1538407">:=</span>&nbsp;<span class="ident" id="1538410">timenow</span><span class="op" id="1538417">(</span><span class="op" id="1538418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1538421">*</span><span class="ident" id="1538422">now</span>&nbsp;<span class="op" id="1538426">=</span>&nbsp;<span class="ident" id="1538428">sec</span><span class="op" id="1538431">*</span><span class="num" id="1538432">1e9</span>&nbsp;<span class="op" id="1538436">+</span>&nbsp;<span class="ident" id="1538438">int64</span><span class="op" id="1538443">(</span><span class="ident" id="1538444">nsec</span><span class="op" id="1538448">)</span><br>
<span class="lineno"></span><span class="op" id="1538450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1538453">func</span>&nbsp;<span class="ident" id="1538458">freeOSMemory</span><span class="op" id="1538470">(</span><span class="op" id="1538471">)</span>&nbsp;<span class="op" id="1538473">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538476">gogc</span><span class="op" id="1538480">(</span><span class="num" id="1538481">2</span><span class="op" id="1538482">)</span>&nbsp;<span class="comment" id="1538484">//&nbsp;force&nbsp;GC&nbsp;and&nbsp;do&nbsp;eager&nbsp;sweep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538516">onM</span><span class="op" id="1538519">(</span><span class="ident" id="1538520">scavenge_m</span><span class="op" id="1538530">)</span><br>
<span class="lineno"></span><span class="op" id="1538532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1538535">var</span>&nbsp;<span class="ident" id="1538539">poolcleanup</span>&nbsp;<span class="keyword" id="1538551">func</span><span class="op" id="1538555">(</span><span class="op" id="1538556">)</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="1538559">func</span>&nbsp;<span class="ident" id="1538564">registerPoolCleanup</span><span class="op" id="1538583">(</span><span class="ident" id="1538584">f</span>&nbsp;<span class="keyword" id="1538586">func</span><span class="op" id="1538590">(</span><span class="op" id="1538591">)</span><span class="op" id="1538592">)</span>&nbsp;<span class="op" id="1538594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538597">poolcleanup</span>&nbsp;<span class="op" id="1538609">=</span>&nbsp;<span class="ident" id="1538611">f</span><br>
<span class="lineno"></span><span class="op" id="1538613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="1538616">func</span>&nbsp;<span class="ident" id="1538621">clearpools</span><span class="op" id="1538631">(</span><span class="op" id="1538632">)</span>&nbsp;<span class="op" id="1538634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1538637">//&nbsp;clear&nbsp;sync.Pools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1538658">if</span>&nbsp;<span class="ident" id="1538661">poolcleanup</span>&nbsp;<span class="op" id="1538673">!=</span>&nbsp;<span class="ident" id="1538676">nil</span>&nbsp;<span class="op" id="1538680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538684">poolcleanup</span><span class="op" id="1538695">(</span><span class="op" id="1538696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1538699">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1538703">for</span>&nbsp;<span class="ident" id="1538707">_</span><span class="op" id="1538708">,</span>&nbsp;<span class="ident" id="1538710">p</span>&nbsp;<span class="op" id="1538712">:=</span>&nbsp;<span class="keyword" id="1538715">range</span>&nbsp;<span class="op" id="1538721">&amp;</span><span class="ident" id="1538722">allp</span>&nbsp;<span class="op" id="1538727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1538731">if</span>&nbsp;<span class="ident" id="1538734">p</span>&nbsp;<span class="op" id="1538736">==</span>&nbsp;<span class="ident" id="1538739">nil</span>&nbsp;<span class="op" id="1538743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1538748">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1538756">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1538760">//&nbsp;clear&nbsp;tinyalloc&nbsp;pool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1538786">if</span>&nbsp;<span class="ident" id="1538789">c</span>&nbsp;<span class="op" id="1538791">:=</span>&nbsp;<span class="ident" id="1538794">p</span><span class="op" id="1538795">.</span><span class="ident" id="1538796">mcache</span><span class="op" id="1538802">;</span>&nbsp;<span class="ident" id="1538804">c</span>&nbsp;<span class="op" id="1538806">!=</span>&nbsp;<span class="ident" id="1538809">nil</span>&nbsp;<span class="op" id="1538813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538818">c</span><span class="op" id="1538819">.</span><span class="ident" id="1538820">tiny</span>&nbsp;<span class="op" id="1538825">=</span>&nbsp;<span class="ident" id="1538827">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538834">c</span><span class="op" id="1538835">.</span><span class="ident" id="1538836">tinysize</span>&nbsp;<span class="op" id="1538845">=</span>&nbsp;<span class="num" id="1538847">0</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1538853">//&nbsp;disconnect&nbsp;cached&nbsp;list&nbsp;before&nbsp;dropping&nbsp;it&nbsp;on&nbsp;the&nbsp;floor,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1538915">//&nbsp;so&nbsp;that&nbsp;a&nbsp;dangling&nbsp;ref&nbsp;to&nbsp;one&nbsp;entry&nbsp;does&nbsp;not&nbsp;pin&nbsp;all&nbsp;of&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1538983">var</span>&nbsp;<span class="ident" id="1538987">sg</span><span class="op" id="1538989">,</span>&nbsp;<span class="ident" id="1538991">sgnext</span>&nbsp;<span class="op" id="1538998">*</span><span class="ident" id="1538999">sudog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1539008">for</span>&nbsp;<span class="ident" id="1539012">sg</span>&nbsp;<span class="op" id="1539015">=</span>&nbsp;<span class="ident" id="1539017">c</span><span class="op" id="1539018">.</span><span class="ident" id="1539019">sudogcache</span><span class="op" id="1539029">;</span>&nbsp;<span class="ident" id="1539031">sg</span>&nbsp;<span class="op" id="1539034">!=</span>&nbsp;<span class="ident" id="1539037">nil</span><span class="op" id="1539040">;</span>&nbsp;<span class="ident" id="1539042">sg</span>&nbsp;<span class="op" id="1539045">=</span>&nbsp;<span class="ident" id="1539047">sgnext</span>&nbsp;<span class="op" id="1539054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539060">sgnext</span>&nbsp;<span class="op" id="1539067">=</span>&nbsp;<span class="ident" id="1539069">sg</span><span class="op" id="1539071">.</span><span class="ident" id="1539072">next</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539081">sg</span><span class="op" id="1539083">.</span><span class="ident" id="1539084">next</span>&nbsp;<span class="op" id="1539089">=</span>&nbsp;<span class="ident" id="1539091">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1539098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539103">c</span><span class="op" id="1539104">.</span><span class="ident" id="1539105">sudogcache</span>&nbsp;<span class="op" id="1539116">=</span>&nbsp;<span class="ident" id="1539118">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1539124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1539129">//&nbsp;clear&nbsp;defer&nbsp;pools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1539152">for</span>&nbsp;<span class="ident" id="1539156">i</span>&nbsp;<span class="op" id="1539158">:=</span>&nbsp;<span class="keyword" id="1539161">range</span>&nbsp;<span class="ident" id="1539167">p</span><span class="op" id="1539168">.</span><span class="ident" id="1539169">deferpool</span>&nbsp;<span class="op" id="1539179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1539184">//&nbsp;disconnect&nbsp;cached&nbsp;list&nbsp;before&nbsp;dropping&nbsp;it&nbsp;on&nbsp;the&nbsp;floor,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1539246">//&nbsp;so&nbsp;that&nbsp;a&nbsp;dangling&nbsp;ref&nbsp;to&nbsp;one&nbsp;entry&nbsp;does&nbsp;not&nbsp;pin&nbsp;all&nbsp;of&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1539314">var</span>&nbsp;<span class="ident" id="1539318">d</span><span class="op" id="1539319">,</span>&nbsp;<span class="ident" id="1539321">dlink</span>&nbsp;<span class="op" id="1539327">*</span><span class="ident" id="1539328">_defer</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1539338">for</span>&nbsp;<span class="ident" id="1539342">d</span>&nbsp;<span class="op" id="1539344">=</span>&nbsp;<span class="ident" id="1539346">p</span><span class="op" id="1539347">.</span><span class="ident" id="1539348">deferpool</span><span class="op" id="1539357">[</span><span class="ident" id="1539358">i</span><span class="op" id="1539359">]</span><span class="op" id="1539360">;</span>&nbsp;<span class="ident" id="1539362">d</span>&nbsp;<span class="op" id="1539364">!=</span>&nbsp;<span class="ident" id="1539367">nil</span><span class="op" id="1539370">;</span>&nbsp;<span class="ident" id="1539372">d</span>&nbsp;<span class="op" id="1539374">=</span>&nbsp;<span class="ident" id="1539376">dlink</span>&nbsp;<span class="op" id="1539382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539388">dlink</span>&nbsp;<span class="op" id="1539394">=</span>&nbsp;<span class="ident" id="1539396">d</span><span class="op" id="1539397">.</span><span class="ident" id="1539398">link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539407">d</span><span class="op" id="1539408">.</span><span class="ident" id="1539409">link</span>&nbsp;<span class="op" id="1539414">=</span>&nbsp;<span class="ident" id="1539416">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1539423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539428">p</span><span class="op" id="1539429">.</span><span class="ident" id="1539430">deferpool</span><span class="op" id="1539439">[</span><span class="ident" id="1539440">i</span><span class="op" id="1539441">]</span>&nbsp;<span class="op" id="1539443">=</span>&nbsp;<span class="ident" id="1539445">nil</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1539451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1539454">}</span><br>
<span class="lineno"></span><span class="op" id="1539456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1539459">func</span>&nbsp;<span class="ident" id="1539464">gosweepone</span><span class="op" id="1539474">(</span><span class="op" id="1539475">)</span>&nbsp;<span class="builtintype" id="1539477">uintptr</span><br>
<span class="lineno">80</span><span class="keyword" id="1539485">func</span>&nbsp;<span class="ident" id="1539490">gosweepdone</span><span class="op" id="1539501">(</span><span class="op" id="1539502">)</span>&nbsp;<span class="builtintype" id="1539504">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1539510">func</span>&nbsp;<span class="ident" id="1539515">bgsweep</span><span class="op" id="1539522">(</span><span class="op" id="1539523">)</span>&nbsp;<span class="op" id="1539525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539528">getg</span><span class="op" id="1539532">(</span><span class="op" id="1539533">)</span><span class="op" id="1539534">.</span><span class="ident" id="1539535">issystem</span>&nbsp;<span class="op" id="1539544">=</span>&nbsp;<span class="builtintype" id="1539546">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1539552">for</span>&nbsp;<span class="op" id="1539556">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1539560">for</span>&nbsp;<span class="ident" id="1539564">gosweepone</span><span class="op" id="1539574">(</span><span class="op" id="1539575">)</span>&nbsp;<span class="op" id="1539577">!=</span>&nbsp;<span class="op" id="1539580">^</span><span class="builtintype" id="1539581">uintptr</span><span class="op" id="1539588">(</span><span class="num" id="1539589">0</span><span class="op" id="1539590">)</span>&nbsp;<span class="op" id="1539592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539597">sweep</span><span class="op" id="1539602">.</span><span class="ident" id="1539603">nbgsweep</span><span class="op" id="1539611">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539617">Gosched</span><span class="op" id="1539624">(</span><span class="op" id="1539625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1539629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539633">lock</span><span class="op" id="1539637">(</span><span class="op" id="1539638">&amp;</span><span class="ident" id="1539639">gclock</span><span class="op" id="1539645">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1539649">if</span>&nbsp;<span class="op" id="1539652">!</span><span class="ident" id="1539653">gosweepdone</span><span class="op" id="1539664">(</span><span class="op" id="1539665">)</span>&nbsp;<span class="op" id="1539667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1539672">//&nbsp;This&nbsp;can&nbsp;happen&nbsp;if&nbsp;a&nbsp;GC&nbsp;runs&nbsp;between</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1539715">//&nbsp;gosweepone&nbsp;returning&nbsp;^0&nbsp;above</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1539751">//&nbsp;and&nbsp;the&nbsp;lock&nbsp;being&nbsp;acquired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539786">unlock</span><span class="op" id="1539792">(</span><span class="op" id="1539793">&amp;</span><span class="ident" id="1539794">gclock</span><span class="op" id="1539800">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1539805">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1539816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539820">sweep</span><span class="op" id="1539825">.</span><span class="ident" id="1539826">parked</span>&nbsp;<span class="op" id="1539833">=</span>&nbsp;<span class="builtintype" id="1539835">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539842">goparkunlock</span><span class="op" id="1539854">(</span><span class="op" id="1539855">&amp;</span><span class="ident" id="1539856">gclock</span><span class="op" id="1539862">,</span>&nbsp;<span class="string" id="1539864">&#34;GC&nbsp;sweep&nbsp;wait&#34;</span><span class="op" id="1539879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1539882">}</span><br>
<span class="lineno">100</span><span class="op" id="1539884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1539887">//&nbsp;NOTE:&nbsp;Really&nbsp;dst&nbsp;*unsafe.Pointer,&nbsp;src&nbsp;unsafe.Pointer,</span><br>
<span class="lineno"></span><span class="comment" id="1539944">//&nbsp;but&nbsp;if&nbsp;we&nbsp;do&nbsp;that,&nbsp;Go&nbsp;inserts&nbsp;a&nbsp;write&nbsp;barrier&nbsp;on&nbsp;*dst&nbsp;=&nbsp;src.</span><br>
<span class="lineno"></span><span class="comment" id="1540008">//go:nosplit</span><br>
<span class="lineno">105</span><span class="keyword" id="1540021">func</span>&nbsp;<span class="ident" id="1540026">writebarrierptr</span><span class="op" id="1540041">(</span><span class="ident" id="1540042">dst</span>&nbsp;<span class="op" id="1540046">*</span><span class="builtintype" id="1540047">uintptr</span><span class="op" id="1540054">,</span>&nbsp;<span class="ident" id="1540056">src</span>&nbsp;<span class="builtintype" id="1540060">uintptr</span><span class="op" id="1540067">)</span>&nbsp;<span class="op" id="1540069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1540072">*</span><span class="ident" id="1540073">dst</span>&nbsp;<span class="op" id="1540077">=</span>&nbsp;<span class="ident" id="1540079">src</span><br>
<span class="lineno"></span><span class="op" id="1540083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1540086">//go:nosplit</span><br>
<span class="lineno">110</span><span class="keyword" id="1540099">func</span>&nbsp;<span class="ident" id="1540104">writebarrierstring</span><span class="op" id="1540122">(</span><span class="ident" id="1540123">dst</span>&nbsp;<span class="op" id="1540127">*</span><span class="op" id="1540128">[</span><span class="num" id="1540129">2</span><span class="op" id="1540130">]</span><span class="builtintype" id="1540131">uintptr</span><span class="op" id="1540138">,</span>&nbsp;<span class="ident" id="1540140">src</span>&nbsp;<span class="op" id="1540144">[</span><span class="num" id="1540145">2</span><span class="op" id="1540146">]</span><span class="builtintype" id="1540147">uintptr</span><span class="op" id="1540154">)</span>&nbsp;<span class="op" id="1540156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540159">dst</span><span class="op" id="1540162">[</span><span class="num" id="1540163">0</span><span class="op" id="1540164">]</span>&nbsp;<span class="op" id="1540166">=</span>&nbsp;<span class="ident" id="1540168">src</span><span class="op" id="1540171">[</span><span class="num" id="1540172">0</span><span class="op" id="1540173">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540176">dst</span><span class="op" id="1540179">[</span><span class="num" id="1540180">1</span><span class="op" id="1540181">]</span>&nbsp;<span class="op" id="1540183">=</span>&nbsp;<span class="ident" id="1540185">src</span><span class="op" id="1540188">[</span><span class="num" id="1540189">1</span><span class="op" id="1540190">]</span><br>
<span class="lineno"></span><span class="op" id="1540192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="1540195">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1540208">func</span>&nbsp;<span class="ident" id="1540213">writebarrierslice</span><span class="op" id="1540230">(</span><span class="ident" id="1540231">dst</span>&nbsp;<span class="op" id="1540235">*</span><span class="op" id="1540236">[</span><span class="num" id="1540237">3</span><span class="op" id="1540238">]</span><span class="builtintype" id="1540239">uintptr</span><span class="op" id="1540246">,</span>&nbsp;<span class="ident" id="1540248">src</span>&nbsp;<span class="op" id="1540252">[</span><span class="num" id="1540253">3</span><span class="op" id="1540254">]</span><span class="builtintype" id="1540255">uintptr</span><span class="op" id="1540262">)</span>&nbsp;<span class="op" id="1540264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540267">dst</span><span class="op" id="1540270">[</span><span class="num" id="1540271">0</span><span class="op" id="1540272">]</span>&nbsp;<span class="op" id="1540274">=</span>&nbsp;<span class="ident" id="1540276">src</span><span class="op" id="1540279">[</span><span class="num" id="1540280">0</span><span class="op" id="1540281">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540284">dst</span><span class="op" id="1540287">[</span><span class="num" id="1540288">1</span><span class="op" id="1540289">]</span>&nbsp;<span class="op" id="1540291">=</span>&nbsp;<span class="ident" id="1540293">src</span><span class="op" id="1540296">[</span><span class="num" id="1540297">1</span><span class="op" id="1540298">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540301">dst</span><span class="op" id="1540304">[</span><span class="num" id="1540305">2</span><span class="op" id="1540306">]</span>&nbsp;<span class="op" id="1540308">=</span>&nbsp;<span class="ident" id="1540310">src</span><span class="op" id="1540313">[</span><span class="num" id="1540314">2</span><span class="op" id="1540315">]</span><br>
<span class="lineno">120</span><span class="op" id="1540317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1540320">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1540333">func</span>&nbsp;<span class="ident" id="1540338">writebarrieriface</span><span class="op" id="1540355">(</span><span class="ident" id="1540356">dst</span>&nbsp;<span class="op" id="1540360">*</span><span class="op" id="1540361">[</span><span class="num" id="1540362">2</span><span class="op" id="1540363">]</span><span class="builtintype" id="1540364">uintptr</span><span class="op" id="1540371">,</span>&nbsp;<span class="ident" id="1540373">src</span>&nbsp;<span class="op" id="1540377">[</span><span class="num" id="1540378">2</span><span class="op" id="1540379">]</span><span class="builtintype" id="1540380">uintptr</span><span class="op" id="1540387">)</span>&nbsp;<span class="op" id="1540389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540392">dst</span><span class="op" id="1540395">[</span><span class="num" id="1540396">0</span><span class="op" id="1540397">]</span>&nbsp;<span class="op" id="1540399">=</span>&nbsp;<span class="ident" id="1540401">src</span><span class="op" id="1540404">[</span><span class="num" id="1540405">0</span><span class="op" id="1540406">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540409">dst</span><span class="op" id="1540412">[</span><span class="num" id="1540413">1</span><span class="op" id="1540414">]</span>&nbsp;<span class="op" id="1540416">=</span>&nbsp;<span class="ident" id="1540418">src</span><span class="op" id="1540421">[</span><span class="num" id="1540422">1</span><span class="op" id="1540423">]</span><br>
<span class="lineno"></span><span class="op" id="1540425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1540428">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1540441">func</span>&nbsp;<span class="ident" id="1540446">writebarrierfat2</span><span class="op" id="1540462">(</span><span class="ident" id="1540463">dst</span>&nbsp;<span class="op" id="1540467">*</span><span class="op" id="1540468">[</span><span class="num" id="1540469">2</span><span class="op" id="1540470">]</span><span class="builtintype" id="1540471">uintptr</span><span class="op" id="1540478">,</span>&nbsp;<span class="ident" id="1540480">_</span>&nbsp;<span class="op" id="1540482">*</span><span class="builtintype" id="1540483">byte</span><span class="op" id="1540487">,</span>&nbsp;<span class="ident" id="1540489">src</span>&nbsp;<span class="op" id="1540493">[</span><span class="num" id="1540494">2</span><span class="op" id="1540495">]</span><span class="builtintype" id="1540496">uintptr</span><span class="op" id="1540503">)</span>&nbsp;<span class="op" id="1540505">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540508">dst</span><span class="op" id="1540511">[</span><span class="num" id="1540512">0</span><span class="op" id="1540513">]</span>&nbsp;<span class="op" id="1540515">=</span>&nbsp;<span class="ident" id="1540517">src</span><span class="op" id="1540520">[</span><span class="num" id="1540521">0</span><span class="op" id="1540522">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540525">dst</span><span class="op" id="1540528">[</span><span class="num" id="1540529">1</span><span class="op" id="1540530">]</span>&nbsp;<span class="op" id="1540532">=</span>&nbsp;<span class="ident" id="1540534">src</span><span class="op" id="1540537">[</span><span class="num" id="1540538">1</span><span class="op" id="1540539">]</span><br>
<span class="lineno"></span><span class="op" id="1540541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1540544">//go:nosplit</span><br>
<span class="lineno">135</span><span class="keyword" id="1540557">func</span>&nbsp;<span class="ident" id="1540562">writebarrierfat3</span><span class="op" id="1540578">(</span><span class="ident" id="1540579">dst</span>&nbsp;<span class="op" id="1540583">*</span><span class="op" id="1540584">[</span><span class="num" id="1540585">3</span><span class="op" id="1540586">]</span><span class="builtintype" id="1540587">uintptr</span><span class="op" id="1540594">,</span>&nbsp;<span class="ident" id="1540596">_</span>&nbsp;<span class="op" id="1540598">*</span><span class="builtintype" id="1540599">byte</span><span class="op" id="1540603">,</span>&nbsp;<span class="ident" id="1540605">src</span>&nbsp;<span class="op" id="1540609">[</span><span class="num" id="1540610">3</span><span class="op" id="1540611">]</span><span class="builtintype" id="1540612">uintptr</span><span class="op" id="1540619">)</span>&nbsp;<span class="op" id="1540621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540624">dst</span><span class="op" id="1540627">[</span><span class="num" id="1540628">0</span><span class="op" id="1540629">]</span>&nbsp;<span class="op" id="1540631">=</span>&nbsp;<span class="ident" id="1540633">src</span><span class="op" id="1540636">[</span><span class="num" id="1540637">0</span><span class="op" id="1540638">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540641">dst</span><span class="op" id="1540644">[</span><span class="num" id="1540645">1</span><span class="op" id="1540646">]</span>&nbsp;<span class="op" id="1540648">=</span>&nbsp;<span class="ident" id="1540650">src</span><span class="op" id="1540653">[</span><span class="num" id="1540654">1</span><span class="op" id="1540655">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540658">dst</span><span class="op" id="1540661">[</span><span class="num" id="1540662">2</span><span class="op" id="1540663">]</span>&nbsp;<span class="op" id="1540665">=</span>&nbsp;<span class="ident" id="1540667">src</span><span class="op" id="1540670">[</span><span class="num" id="1540671">2</span><span class="op" id="1540672">]</span><br>
<span class="lineno"></span><span class="op" id="1540674">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="1540677">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1540690">func</span>&nbsp;<span class="ident" id="1540695">writebarrierfat4</span><span class="op" id="1540711">(</span><span class="ident" id="1540712">dst</span>&nbsp;<span class="op" id="1540716">*</span><span class="op" id="1540717">[</span><span class="num" id="1540718">4</span><span class="op" id="1540719">]</span><span class="builtintype" id="1540720">uintptr</span><span class="op" id="1540727">,</span>&nbsp;<span class="ident" id="1540729">_</span>&nbsp;<span class="op" id="1540731">*</span><span class="builtintype" id="1540732">byte</span><span class="op" id="1540736">,</span>&nbsp;<span class="ident" id="1540738">src</span>&nbsp;<span class="op" id="1540742">[</span><span class="num" id="1540743">4</span><span class="op" id="1540744">]</span><span class="builtintype" id="1540745">uintptr</span><span class="op" id="1540752">)</span>&nbsp;<span class="op" id="1540754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540757">dst</span><span class="op" id="1540760">[</span><span class="num" id="1540761">0</span><span class="op" id="1540762">]</span>&nbsp;<span class="op" id="1540764">=</span>&nbsp;<span class="ident" id="1540766">src</span><span class="op" id="1540769">[</span><span class="num" id="1540770">0</span><span class="op" id="1540771">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540774">dst</span><span class="op" id="1540777">[</span><span class="num" id="1540778">1</span><span class="op" id="1540779">]</span>&nbsp;<span class="op" id="1540781">=</span>&nbsp;<span class="ident" id="1540783">src</span><span class="op" id="1540786">[</span><span class="num" id="1540787">1</span><span class="op" id="1540788">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540791">dst</span><span class="op" id="1540794">[</span><span class="num" id="1540795">2</span><span class="op" id="1540796">]</span>&nbsp;<span class="op" id="1540798">=</span>&nbsp;<span class="ident" id="1540800">src</span><span class="op" id="1540803">[</span><span class="num" id="1540804">2</span><span class="op" id="1540805">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540808">dst</span><span class="op" id="1540811">[</span><span class="num" id="1540812">3</span><span class="op" id="1540813">]</span>&nbsp;<span class="op" id="1540815">=</span>&nbsp;<span class="ident" id="1540817">src</span><span class="op" id="1540820">[</span><span class="num" id="1540821">3</span><span class="op" id="1540822">]</span><br>
<span class="lineno"></span><span class="op" id="1540824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1540827">//go:nosplit</span><br>
<span class="lineno">150</span><span class="keyword" id="1540840">func</span>&nbsp;<span class="ident" id="1540845">writebarrierfat</span><span class="op" id="1540860">(</span><span class="ident" id="1540861">typ</span>&nbsp;<span class="op" id="1540865">*</span><span class="ident" id="1540866">_type</span><span class="op" id="1540871">,</span>&nbsp;<span class="ident" id="1540873">dst</span><span class="op" id="1540876">,</span>&nbsp;<span class="ident" id="1540878">src</span>&nbsp;<span class="ident" id="1540882">unsafe</span><span class="op" id="1540888">.</span><span class="ident" id="1540889">Pointer</span><span class="op" id="1540896">)</span>&nbsp;<span class="op" id="1540898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540901">memmove</span><span class="op" id="1540908">(</span><span class="ident" id="1540909">dst</span><span class="op" id="1540912">,</span>&nbsp;<span class="ident" id="1540914">src</span><span class="op" id="1540917">,</span>&nbsp;<span class="ident" id="1540919">typ</span><span class="op" id="1540922">.</span><span class="ident" id="1540923">size</span><span class="op" id="1540927">)</span><br>
<span class="lineno"></span><span class="op" id="1540929">}</span>
</div>
</body>
</html>
