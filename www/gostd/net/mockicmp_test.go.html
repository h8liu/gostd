<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8435112">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8435168">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8435222">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8435273">package</span>&nbsp;<span class="ident" id="8435281">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8435286">import</span>&nbsp;<span class="string" id="8435293">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8435303">const</span>&nbsp;<span class="op" id="8435309">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8435312">icmpv4EchoRequest</span>&nbsp;<span class="op" id="8435330">=</span>&nbsp;<span class="num" id="8435332">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8435335">icmpv4EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8435353">=</span>&nbsp;<span class="num" id="8435355">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8435358">icmpv6EchoRequest</span>&nbsp;<span class="op" id="8435376">=</span>&nbsp;<span class="num" id="8435378">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8435383">icmpv6EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8435401">=</span>&nbsp;<span class="num" id="8435403">129</span><br>
<span class="lineno"></span><span class="op" id="8435407">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="8435410">//&nbsp;icmpMessage&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="8435453">type</span>&nbsp;<span class="ident" id="8435458">icmpMessage</span>&nbsp;<span class="keyword" id="8435470">struct</span>&nbsp;<span class="op" id="8435477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8435480">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8435489">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8435505">//&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8435514">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8435523">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8435539">//&nbsp;code</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8435548">Checksum</span>&nbsp;<span class="builtintype" id="8435557">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8435573">//&nbsp;checksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8435586">Body</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8435595">icmpMessageBody</span>&nbsp;<span class="comment" id="8435611">//&nbsp;body</span><br>
<span class="lineno"></span><span class="op" id="8435619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8435622">//&nbsp;icmpMessageBody&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message&nbsp;body.</span><br>
<span class="lineno">25</span><span class="keyword" id="8435674">type</span>&nbsp;<span class="ident" id="8435679">icmpMessageBody</span>&nbsp;<span class="keyword" id="8435695">interface</span>&nbsp;<span class="op" id="8435705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8435708">Len</span><span class="op" id="8435711">(</span><span class="op" id="8435712">)</span>&nbsp;<span class="builtintype" id="8435714">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8435719">Marshal</span><span class="op" id="8435726">(</span><span class="op" id="8435727">)</span>&nbsp;<span class="op" id="8435729">(</span><span class="op" id="8435730">[</span><span class="op" id="8435731">]</span><span class="builtintype" id="8435732">byte</span><span class="op" id="8435736">,</span>&nbsp;<span class="builtintype" id="8435738">error</span><span class="op" id="8435743">)</span><br>
<span class="lineno"></span><span class="op" id="8435745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="8435748">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="8435816">//&nbsp;reply&nbsp;message&nbsp;m.</span><br>
<span class="lineno"></span><span class="keyword" id="8435836">func</span>&nbsp;<span class="op" id="8435841">(</span><span class="ident" id="8435842">m</span>&nbsp;<span class="op" id="8435844">*</span><span class="ident" id="8435845">icmpMessage</span><span class="op" id="8435856">)</span>&nbsp;<span class="ident" id="8435858">Marshal</span><span class="op" id="8435865">(</span><span class="op" id="8435866">)</span>&nbsp;<span class="op" id="8435868">(</span><span class="op" id="8435869">[</span><span class="op" id="8435870">]</span><span class="builtintype" id="8435871">byte</span><span class="op" id="8435875">,</span>&nbsp;<span class="builtintype" id="8435877">error</span><span class="op" id="8435882">)</span>&nbsp;<span class="op" id="8435884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8435887">b</span>&nbsp;<span class="op" id="8435889">:=</span>&nbsp;<span class="op" id="8435892">[</span><span class="op" id="8435893">]</span><span class="builtintype" id="8435894">byte</span><span class="op" id="8435898">{</span><span class="builtintype" id="8435899">byte</span><span class="op" id="8435903">(</span><span class="ident" id="8435904">m</span><span class="op" id="8435905">.</span><span class="ident" id="8435906">Type</span><span class="op" id="8435910">)</span><span class="op" id="8435911">,</span>&nbsp;<span class="builtintype" id="8435913">byte</span><span class="op" id="8435917">(</span><span class="ident" id="8435918">m</span><span class="op" id="8435919">.</span><span class="ident" id="8435920">Code</span><span class="op" id="8435924">)</span><span class="op" id="8435925">,</span>&nbsp;<span class="num" id="8435927">0</span><span class="op" id="8435928">,</span>&nbsp;<span class="num" id="8435930">0</span><span class="op" id="8435931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8435934">if</span>&nbsp;<span class="ident" id="8435937">m</span><span class="op" id="8435938">.</span><span class="ident" id="8435939">Body</span>&nbsp;<span class="op" id="8435944">!=</span>&nbsp;<span class="ident" id="8435947">nil</span>&nbsp;<span class="op" id="8435951">&amp;&amp;</span>&nbsp;<span class="ident" id="8435954">m</span><span class="op" id="8435955">.</span><span class="ident" id="8435956">Body</span><span class="op" id="8435960">.</span><span class="ident" id="8435961">Len</span><span class="op" id="8435964">(</span><span class="op" id="8435965">)</span>&nbsp;<span class="op" id="8435967">!=</span>&nbsp;<span class="num" id="8435970">0</span>&nbsp;<span class="op" id="8435972">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8435976">mb</span><span class="op" id="8435978">,</span>&nbsp;<span class="ident" id="8435980">err</span>&nbsp;<span class="op" id="8435984">:=</span>&nbsp;<span class="ident" id="8435987">m</span><span class="op" id="8435988">.</span><span class="ident" id="8435989">Body</span><span class="op" id="8435993">.</span><span class="ident" id="8435994">Marshal</span><span class="op" id="8436001">(</span><span class="op" id="8436002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8436006">if</span>&nbsp;<span class="ident" id="8436009">err</span>&nbsp;<span class="op" id="8436013">!=</span>&nbsp;<span class="ident" id="8436016">nil</span>&nbsp;<span class="op" id="8436020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8436025">return</span>&nbsp;<span class="ident" id="8436032">nil</span><span class="op" id="8436035">,</span>&nbsp;<span class="ident" id="8436037">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8436043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8436047">b</span>&nbsp;<span class="op" id="8436049">=</span>&nbsp;<span class="builtinfunc" id="8436051">append</span><span class="op" id="8436057">(</span><span class="ident" id="8436058">b</span><span class="op" id="8436059">,</span>&nbsp;<span class="ident" id="8436061">mb</span><span class="op" id="8436063">...</span><span class="op" id="8436066">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8436069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8436072">switch</span>&nbsp;<span class="ident" id="8436079">m</span><span class="op" id="8436080">.</span><span class="ident" id="8436081">Type</span>&nbsp;<span class="op" id="8436086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8436089">case</span>&nbsp;<span class="ident" id="8436094">icmpv6EchoRequest</span><span class="op" id="8436111">,</span>&nbsp;<span class="ident" id="8436113">icmpv6EchoReply</span><span class="op" id="8436128">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8436132">return</span>&nbsp;<span class="ident" id="8436139">b</span><span class="op" id="8436140">,</span>&nbsp;<span class="ident" id="8436142">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8436147">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8436150">csumcv</span>&nbsp;<span class="op" id="8436157">:=</span>&nbsp;<span class="builtinfunc" id="8436160">len</span><span class="op" id="8436163">(</span><span class="ident" id="8436164">b</span><span class="op" id="8436165">)</span>&nbsp;<span class="op" id="8436167">-</span>&nbsp;<span class="num" id="8436169">1</span>&nbsp;<span class="comment" id="8436171">//&nbsp;checksum&nbsp;coverage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8436193">s</span>&nbsp;<span class="op" id="8436195">:=</span>&nbsp;<span class="builtintype" id="8436198">uint32</span><span class="op" id="8436204">(</span><span class="num" id="8436205">0</span><span class="op" id="8436206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8436209">for</span>&nbsp;<span class="ident" id="8436213">i</span>&nbsp;<span class="op" id="8436215">:=</span>&nbsp;<span class="num" id="8436218">0</span><span class="op" id="8436219">;</span>&nbsp;<span class="ident" id="8436221">i</span>&nbsp;<span class="op" id="8436223">&lt;</span>&nbsp;<span class="ident" id="8436225">csumcv</span><span class="op" id="8436231">;</span>&nbsp;<span class="ident" id="8436233">i</span>&nbsp;<span class="op" id="8436235">+=</span>&nbsp;<span class="num" id="8436238">2</span>&nbsp;<span class="op" id="8436240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8436244">s</span>&nbsp;<span class="op" id="8436246">+=</span>&nbsp;<span class="builtintype" id="8436249">uint32</span><span class="op" id="8436255">(</span><span class="ident" id="8436256">b</span><span class="op" id="8436257">[</span><span class="ident" id="8436258">i</span><span class="op" id="8436259">+</span><span class="num" id="8436260">1</span><span class="op" id="8436261">]</span><span class="op" id="8436262">)</span><span class="op" id="8436263">&lt;&lt;</span><span class="num" id="8436265">8</span>&nbsp;<span class="op" id="8436267">|</span>&nbsp;<span class="builtintype" id="8436269">uint32</span><span class="op" id="8436275">(</span><span class="ident" id="8436276">b</span><span class="op" id="8436277">[</span><span class="ident" id="8436278">i</span><span class="op" id="8436279">]</span><span class="op" id="8436280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8436283">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8436286">if</span>&nbsp;<span class="ident" id="8436289">csumcv</span><span class="op" id="8436295">&amp;</span><span class="num" id="8436296">1</span>&nbsp;<span class="op" id="8436298">==</span>&nbsp;<span class="num" id="8436301">0</span>&nbsp;<span class="op" id="8436303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8436307">s</span>&nbsp;<span class="op" id="8436309">+=</span>&nbsp;<span class="builtintype" id="8436312">uint32</span><span class="op" id="8436318">(</span><span class="ident" id="8436319">b</span><span class="op" id="8436320">[</span><span class="ident" id="8436321">csumcv</span><span class="op" id="8436327">]</span><span class="op" id="8436328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8436331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8436334">s</span>&nbsp;<span class="op" id="8436336">=</span>&nbsp;<span class="ident" id="8436338">s</span><span class="op" id="8436339">&gt;&gt;</span><span class="num" id="8436341">16</span>&nbsp;<span class="op" id="8436344">+</span>&nbsp;<span class="ident" id="8436346">s</span><span class="op" id="8436347">&amp;</span><span class="num" id="8436348">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8436356">s</span>&nbsp;<span class="op" id="8436358">=</span>&nbsp;<span class="ident" id="8436360">s</span>&nbsp;<span class="op" id="8436362">+</span>&nbsp;<span class="ident" id="8436364">s</span><span class="op" id="8436365">&gt;&gt;</span><span class="num" id="8436367">16</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8436371">//&nbsp;Place&nbsp;checksum&nbsp;back&nbsp;in&nbsp;header;&nbsp;using&nbsp;^=&nbsp;avoids&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8436426">//&nbsp;assumption&nbsp;the&nbsp;checksum&nbsp;bytes&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8436470">b</span><span class="op" id="8436471">[</span><span class="num" id="8436472">2</span><span class="op" id="8436473">]</span>&nbsp;<span class="op" id="8436475">^=</span>&nbsp;<span class="builtintype" id="8436478">byte</span><span class="op" id="8436482">(</span><span class="op" id="8436483">^</span><span class="ident" id="8436484">s</span><span class="op" id="8436485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8436488">b</span><span class="op" id="8436489">[</span><span class="num" id="8436490">3</span><span class="op" id="8436491">]</span>&nbsp;<span class="op" id="8436493">^=</span>&nbsp;<span class="builtintype" id="8436496">byte</span><span class="op" id="8436500">(</span><span class="op" id="8436501">^</span><span class="ident" id="8436502">s</span>&nbsp;<span class="op" id="8436504">&gt;&gt;</span>&nbsp;<span class="num" id="8436507">8</span><span class="op" id="8436508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8436511">return</span>&nbsp;<span class="ident" id="8436518">b</span><span class="op" id="8436519">,</span>&nbsp;<span class="ident" id="8436521">nil</span><br>
<span class="lineno">60</span><span class="op" id="8436525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8436528">//&nbsp;parseICMPMessage&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="8436577">func</span>&nbsp;<span class="ident" id="8436582">parseICMPMessage</span><span class="op" id="8436598">(</span><span class="ident" id="8436599">b</span>&nbsp;<span class="op" id="8436601">[</span><span class="op" id="8436602">]</span><span class="builtintype" id="8436603">byte</span><span class="op" id="8436607">)</span>&nbsp;<span class="op" id="8436609">(</span><span class="op" id="8436610">*</span><span class="ident" id="8436611">icmpMessage</span><span class="op" id="8436622">,</span>&nbsp;<span class="builtintype" id="8436624">error</span><span class="op" id="8436629">)</span>&nbsp;<span class="op" id="8436631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8436634">msglen</span>&nbsp;<span class="op" id="8436641">:=</span>&nbsp;<span class="builtinfunc" id="8436644">len</span><span class="op" id="8436647">(</span><span class="ident" id="8436648">b</span><span class="op" id="8436649">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8436652">if</span>&nbsp;<span class="ident" id="8436655">msglen</span>&nbsp;<span class="op" id="8436662">&lt;</span>&nbsp;<span class="num" id="8436664">4</span>&nbsp;<span class="op" id="8436666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8436670">return</span>&nbsp;<span class="ident" id="8436677">nil</span><span class="op" id="8436680">,</span>&nbsp;<span class="ident" id="8436682">errors</span><span class="op" id="8436688">.</span><span class="ident" id="8436689">New</span><span class="op" id="8436692">(</span><span class="string" id="8436693">&#34;message&nbsp;too&nbsp;short&#34;</span><span class="op" id="8436712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8436715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8436718">m</span>&nbsp;<span class="op" id="8436720">:=</span>&nbsp;<span class="op" id="8436723">&amp;</span><span class="ident" id="8436724">icmpMessage</span><span class="op" id="8436735">{</span><span class="ident" id="8436736">Type</span><span class="op" id="8436740">:</span>&nbsp;<span class="builtintype" id="8436742">int</span><span class="op" id="8436745">(</span><span class="ident" id="8436746">b</span><span class="op" id="8436747">[</span><span class="num" id="8436748">0</span><span class="op" id="8436749">]</span><span class="op" id="8436750">)</span><span class="op" id="8436751">,</span>&nbsp;<span class="ident" id="8436753">Code</span><span class="op" id="8436757">:</span>&nbsp;<span class="builtintype" id="8436759">int</span><span class="op" id="8436762">(</span><span class="ident" id="8436763">b</span><span class="op" id="8436764">[</span><span class="num" id="8436765">1</span><span class="op" id="8436766">]</span><span class="op" id="8436767">)</span><span class="op" id="8436768">,</span>&nbsp;<span class="ident" id="8436770">Checksum</span><span class="op" id="8436778">:</span>&nbsp;<span class="builtintype" id="8436780">int</span><span class="op" id="8436783">(</span><span class="ident" id="8436784">b</span><span class="op" id="8436785">[</span><span class="num" id="8436786">2</span><span class="op" id="8436787">]</span><span class="op" id="8436788">)</span><span class="op" id="8436789">&lt;&lt;</span><span class="num" id="8436791">8</span>&nbsp;<span class="op" id="8436793">|</span>&nbsp;<span class="builtintype" id="8436795">int</span><span class="op" id="8436798">(</span><span class="ident" id="8436799">b</span><span class="op" id="8436800">[</span><span class="num" id="8436801">3</span><span class="op" id="8436802">]</span><span class="op" id="8436803">)</span><span class="op" id="8436804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8436807">if</span>&nbsp;<span class="ident" id="8436810">msglen</span>&nbsp;<span class="op" id="8436817">&gt;</span>&nbsp;<span class="num" id="8436819">4</span>&nbsp;<span class="op" id="8436821">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8436825">var</span>&nbsp;<span class="ident" id="8436829">err</span>&nbsp;<span class="builtintype" id="8436833">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8436841">switch</span>&nbsp;<span class="ident" id="8436848">m</span><span class="op" id="8436849">.</span><span class="ident" id="8436850">Type</span>&nbsp;<span class="op" id="8436855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8436859">case</span>&nbsp;<span class="ident" id="8436864">icmpv4EchoRequest</span><span class="op" id="8436881">,</span>&nbsp;<span class="ident" id="8436883">icmpv4EchoReply</span><span class="op" id="8436898">,</span>&nbsp;<span class="ident" id="8436900">icmpv6EchoRequest</span><span class="op" id="8436917">,</span>&nbsp;<span class="ident" id="8436919">icmpv6EchoReply</span><span class="op" id="8436934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8436939">m</span><span class="op" id="8436940">.</span><span class="ident" id="8436941">Body</span><span class="op" id="8436945">,</span>&nbsp;<span class="ident" id="8436947">err</span>&nbsp;<span class="op" id="8436951">=</span>&nbsp;<span class="ident" id="8436953">parseICMPEcho</span><span class="op" id="8436966">(</span><span class="ident" id="8436967">b</span><span class="op" id="8436968">[</span><span class="num" id="8436969">4</span><span class="op" id="8436970">:</span><span class="op" id="8436971">]</span><span class="op" id="8436972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8436977">if</span>&nbsp;<span class="ident" id="8436980">err</span>&nbsp;<span class="op" id="8436984">!=</span>&nbsp;<span class="ident" id="8436987">nil</span>&nbsp;<span class="op" id="8436991">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8436997">return</span>&nbsp;<span class="ident" id="8437004">nil</span><span class="op" id="8437007">,</span>&nbsp;<span class="ident" id="8437009">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8437016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8437020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8437023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8437026">return</span>&nbsp;<span class="ident" id="8437033">m</span><span class="op" id="8437034">,</span>&nbsp;<span class="ident" id="8437036">nil</span><br>
<span class="lineno">80</span><span class="op" id="8437040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8437043">//&nbsp;imcpEcho&nbsp;represenets&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="8437111">type</span>&nbsp;<span class="ident" id="8437116">icmpEcho</span>&nbsp;<span class="keyword" id="8437125">struct</span>&nbsp;<span class="op" id="8437132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8437135">ID</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8437140">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8437147">//&nbsp;identifier</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8437162">Seq</span>&nbsp;&nbsp;<span class="builtintype" id="8437167">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8437174">//&nbsp;sequence&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8437194">Data</span>&nbsp;<span class="op" id="8437199">[</span><span class="op" id="8437200">]</span><span class="builtintype" id="8437201">byte</span>&nbsp;<span class="comment" id="8437206">//&nbsp;data</span><br>
<span class="lineno"></span><span class="op" id="8437214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8437217">func</span>&nbsp;<span class="op" id="8437222">(</span><span class="ident" id="8437223">p</span>&nbsp;<span class="op" id="8437225">*</span><span class="ident" id="8437226">icmpEcho</span><span class="op" id="8437234">)</span>&nbsp;<span class="ident" id="8437236">Len</span><span class="op" id="8437239">(</span><span class="op" id="8437240">)</span>&nbsp;<span class="builtintype" id="8437242">int</span>&nbsp;<span class="op" id="8437246">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8437249">if</span>&nbsp;<span class="ident" id="8437252">p</span>&nbsp;<span class="op" id="8437254">==</span>&nbsp;<span class="ident" id="8437257">nil</span>&nbsp;<span class="op" id="8437261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8437265">return</span>&nbsp;<span class="num" id="8437272">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8437275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8437278">return</span>&nbsp;<span class="num" id="8437285">4</span>&nbsp;<span class="op" id="8437287">+</span>&nbsp;<span class="builtinfunc" id="8437289">len</span><span class="op" id="8437292">(</span><span class="ident" id="8437293">p</span><span class="op" id="8437294">.</span><span class="ident" id="8437295">Data</span><span class="op" id="8437299">)</span><br>
<span class="lineno"></span><span class="op" id="8437301">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="8437304">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="8437372">//&nbsp;reply&nbsp;message&nbsp;body&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="8437397">func</span>&nbsp;<span class="op" id="8437402">(</span><span class="ident" id="8437403">p</span>&nbsp;<span class="op" id="8437405">*</span><span class="ident" id="8437406">icmpEcho</span><span class="op" id="8437414">)</span>&nbsp;<span class="ident" id="8437416">Marshal</span><span class="op" id="8437423">(</span><span class="op" id="8437424">)</span>&nbsp;<span class="op" id="8437426">(</span><span class="op" id="8437427">[</span><span class="op" id="8437428">]</span><span class="builtintype" id="8437429">byte</span><span class="op" id="8437433">,</span>&nbsp;<span class="builtintype" id="8437435">error</span><span class="op" id="8437440">)</span>&nbsp;<span class="op" id="8437442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8437445">b</span>&nbsp;<span class="op" id="8437447">:=</span>&nbsp;<span class="builtinfunc" id="8437450">make</span><span class="op" id="8437454">(</span><span class="op" id="8437455">[</span><span class="op" id="8437456">]</span><span class="builtintype" id="8437457">byte</span><span class="op" id="8437461">,</span>&nbsp;<span class="num" id="8437463">4</span><span class="op" id="8437464">+</span><span class="builtinfunc" id="8437465">len</span><span class="op" id="8437468">(</span><span class="ident" id="8437469">p</span><span class="op" id="8437470">.</span><span class="ident" id="8437471">Data</span><span class="op" id="8437475">)</span><span class="op" id="8437476">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8437479">b</span><span class="op" id="8437480">[</span><span class="num" id="8437481">0</span><span class="op" id="8437482">]</span><span class="op" id="8437483">,</span>&nbsp;<span class="ident" id="8437485">b</span><span class="op" id="8437486">[</span><span class="num" id="8437487">1</span><span class="op" id="8437488">]</span>&nbsp;<span class="op" id="8437490">=</span>&nbsp;<span class="builtintype" id="8437492">byte</span><span class="op" id="8437496">(</span><span class="ident" id="8437497">p</span><span class="op" id="8437498">.</span><span class="ident" id="8437499">ID</span><span class="op" id="8437501">&gt;&gt;</span><span class="num" id="8437503">8</span><span class="op" id="8437504">)</span><span class="op" id="8437505">,</span>&nbsp;<span class="builtintype" id="8437507">byte</span><span class="op" id="8437511">(</span><span class="ident" id="8437512">p</span><span class="op" id="8437513">.</span><span class="ident" id="8437514">ID</span><span class="op" id="8437516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8437519">b</span><span class="op" id="8437520">[</span><span class="num" id="8437521">2</span><span class="op" id="8437522">]</span><span class="op" id="8437523">,</span>&nbsp;<span class="ident" id="8437525">b</span><span class="op" id="8437526">[</span><span class="num" id="8437527">3</span><span class="op" id="8437528">]</span>&nbsp;<span class="op" id="8437530">=</span>&nbsp;<span class="builtintype" id="8437532">byte</span><span class="op" id="8437536">(</span><span class="ident" id="8437537">p</span><span class="op" id="8437538">.</span><span class="ident" id="8437539">Seq</span><span class="op" id="8437542">&gt;&gt;</span><span class="num" id="8437544">8</span><span class="op" id="8437545">)</span><span class="op" id="8437546">,</span>&nbsp;<span class="builtintype" id="8437548">byte</span><span class="op" id="8437552">(</span><span class="ident" id="8437553">p</span><span class="op" id="8437554">.</span><span class="ident" id="8437555">Seq</span><span class="op" id="8437558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8437561">copy</span><span class="op" id="8437565">(</span><span class="ident" id="8437566">b</span><span class="op" id="8437567">[</span><span class="num" id="8437568">4</span><span class="op" id="8437569">:</span><span class="op" id="8437570">]</span><span class="op" id="8437571">,</span>&nbsp;<span class="ident" id="8437573">p</span><span class="op" id="8437574">.</span><span class="ident" id="8437575">Data</span><span class="op" id="8437579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8437582">return</span>&nbsp;<span class="ident" id="8437589">b</span><span class="op" id="8437590">,</span>&nbsp;<span class="ident" id="8437592">nil</span><br>
<span class="lineno"></span><span class="op" id="8437596">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="8437599">//&nbsp;parseICMPEcho&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message</span><br>
<span class="lineno"></span><span class="comment" id="8437666">//&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="8437675">func</span>&nbsp;<span class="ident" id="8437680">parseICMPEcho</span><span class="op" id="8437693">(</span><span class="ident" id="8437694">b</span>&nbsp;<span class="op" id="8437696">[</span><span class="op" id="8437697">]</span><span class="builtintype" id="8437698">byte</span><span class="op" id="8437702">)</span>&nbsp;<span class="op" id="8437704">(</span><span class="op" id="8437705">*</span><span class="ident" id="8437706">icmpEcho</span><span class="op" id="8437714">,</span>&nbsp;<span class="builtintype" id="8437716">error</span><span class="op" id="8437721">)</span>&nbsp;<span class="op" id="8437723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8437726">bodylen</span>&nbsp;<span class="op" id="8437734">:=</span>&nbsp;<span class="builtinfunc" id="8437737">len</span><span class="op" id="8437740">(</span><span class="ident" id="8437741">b</span><span class="op" id="8437742">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8437745">p</span>&nbsp;<span class="op" id="8437747">:=</span>&nbsp;<span class="op" id="8437750">&amp;</span><span class="ident" id="8437751">icmpEcho</span><span class="op" id="8437759">{</span><span class="ident" id="8437760">ID</span><span class="op" id="8437762">:</span>&nbsp;<span class="builtintype" id="8437764">int</span><span class="op" id="8437767">(</span><span class="ident" id="8437768">b</span><span class="op" id="8437769">[</span><span class="num" id="8437770">0</span><span class="op" id="8437771">]</span><span class="op" id="8437772">)</span><span class="op" id="8437773">&lt;&lt;</span><span class="num" id="8437775">8</span>&nbsp;<span class="op" id="8437777">|</span>&nbsp;<span class="builtintype" id="8437779">int</span><span class="op" id="8437782">(</span><span class="ident" id="8437783">b</span><span class="op" id="8437784">[</span><span class="num" id="8437785">1</span><span class="op" id="8437786">]</span><span class="op" id="8437787">)</span><span class="op" id="8437788">,</span>&nbsp;<span class="ident" id="8437790">Seq</span><span class="op" id="8437793">:</span>&nbsp;<span class="builtintype" id="8437795">int</span><span class="op" id="8437798">(</span><span class="ident" id="8437799">b</span><span class="op" id="8437800">[</span><span class="num" id="8437801">2</span><span class="op" id="8437802">]</span><span class="op" id="8437803">)</span><span class="op" id="8437804">&lt;&lt;</span><span class="num" id="8437806">8</span>&nbsp;<span class="op" id="8437808">|</span>&nbsp;<span class="builtintype" id="8437810">int</span><span class="op" id="8437813">(</span><span class="ident" id="8437814">b</span><span class="op" id="8437815">[</span><span class="num" id="8437816">3</span><span class="op" id="8437817">]</span><span class="op" id="8437818">)</span><span class="op" id="8437819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8437822">if</span>&nbsp;<span class="ident" id="8437825">bodylen</span>&nbsp;<span class="op" id="8437833">&gt;</span>&nbsp;<span class="num" id="8437835">4</span>&nbsp;<span class="op" id="8437837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8437841">p</span><span class="op" id="8437842">.</span><span class="ident" id="8437843">Data</span>&nbsp;<span class="op" id="8437848">=</span>&nbsp;<span class="builtinfunc" id="8437850">make</span><span class="op" id="8437854">(</span><span class="op" id="8437855">[</span><span class="op" id="8437856">]</span><span class="builtintype" id="8437857">byte</span><span class="op" id="8437861">,</span>&nbsp;<span class="ident" id="8437863">bodylen</span><span class="op" id="8437870">-</span><span class="num" id="8437871">4</span><span class="op" id="8437872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8437876">copy</span><span class="op" id="8437880">(</span><span class="ident" id="8437881">p</span><span class="op" id="8437882">.</span><span class="ident" id="8437883">Data</span><span class="op" id="8437887">,</span>&nbsp;<span class="ident" id="8437889">b</span><span class="op" id="8437890">[</span><span class="num" id="8437891">4</span><span class="op" id="8437892">:</span><span class="op" id="8437893">]</span><span class="op" id="8437894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8437897">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8437900">return</span>&nbsp;<span class="ident" id="8437907">p</span><span class="op" id="8437908">,</span>&nbsp;<span class="ident" id="8437910">nil</span><br>
<span class="lineno"></span><span class="op" id="8437914">}</span>
</div>
</body>
</html>
