<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/zlib</h2>
<ul>
<li><a href="/gostd/compress/zlib/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/compress/zlib/reader.go.html">reader.go</a></li>
<li><a href="/gostd/compress/zlib/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/zlib/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/zlib/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5983017">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5983072">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5983126">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5983177">/*<br>
<span class="lineno"></span>Package&nbsp;zlib&nbsp;implements&nbsp;reading&nbsp;and&nbsp;writing&nbsp;of&nbsp;zlib&nbsp;format&nbsp;compressed&nbsp;data,<br>
<span class="lineno"></span>as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;1950.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>The&nbsp;implementation&nbsp;provides&nbsp;filters&nbsp;that&nbsp;uncompress&nbsp;during&nbsp;reading<br>
<span class="lineno">10</span>and&nbsp;compress&nbsp;during&nbsp;writing.&nbsp;&nbsp;For&nbsp;example,&nbsp;to&nbsp;write&nbsp;compressed&nbsp;data<br>
<span class="lineno"></span>to&nbsp;a&nbsp;buffer:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;b&nbsp;bytes.Buffer<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspw&nbsp;:=&nbsp;zlib.NewWriter(&amp;b)<br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbspw.Write([]byte(&#34;hello,&nbsp;world\n&#34;))<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspw.Close()<br>
<span class="lineno"></span><br>
<span class="lineno"></span>and&nbsp;to&nbsp;read&nbsp;that&nbsp;data&nbsp;back:<br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbspr,&nbsp;err&nbsp;:=&nbsp;zlib.NewReader(&amp;b)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspio.Copy(os.Stdout,&nbsp;r)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspr.Close()<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="5983620">package</span>&nbsp;<span class="ident" id="5983628">zlib</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="5983634">import</span>&nbsp;<span class="op" id="5983641">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5983644">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5983653">&#34;compress/flate&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5983671">&#34;errors&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5983681">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5983689">&#34;hash/adler32&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5983705">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5983710">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="5983713">const</span>&nbsp;<span class="ident" id="5983719">zlibDeflate</span>&nbsp;<span class="op" id="5983731">=</span>&nbsp;<span class="num" id="5983733">8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5983736">var</span>&nbsp;<span class="op" id="5983740">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5983743">//&nbsp;ErrChecksum&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;checksum.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983824">ErrChecksum</span>&nbsp;<span class="op" id="5983836">=</span>&nbsp;<span class="ident" id="5983838">errors</span><span class="op" id="5983844">.</span><span class="ident" id="5983845">New</span><span class="op" id="5983848">(</span><span class="string" id="5983849">&#34;zlib:&nbsp;invalid&nbsp;checksum&#34;</span><span class="op" id="5983873">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5983876">//&nbsp;ErrDictionary&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;dictionary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983961">ErrDictionary</span>&nbsp;<span class="op" id="5983975">=</span>&nbsp;<span class="ident" id="5983977">errors</span><span class="op" id="5983983">.</span><span class="ident" id="5983984">New</span><span class="op" id="5983987">(</span><span class="string" id="5983988">&#34;zlib:&nbsp;invalid&nbsp;dictionary&#34;</span><span class="op" id="5984014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5984017">//&nbsp;ErrHeader&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984094">ErrHeader</span>&nbsp;<span class="op" id="5984104">=</span>&nbsp;<span class="ident" id="5984106">errors</span><span class="op" id="5984112">.</span><span class="ident" id="5984113">New</span><span class="op" id="5984116">(</span><span class="string" id="5984117">&#34;zlib:&nbsp;invalid&nbsp;header&#34;</span><span class="op" id="5984139">)</span><br>
<span class="lineno"></span><span class="op" id="5984141">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="5984144">type</span>&nbsp;<span class="ident" id="5984149">reader</span>&nbsp;<span class="keyword" id="5984156">struct</span>&nbsp;<span class="op" id="5984163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984166">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5984179">flate</span><span class="op" id="5984184">.</span><span class="ident" id="5984185">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984193">decompressor</span>&nbsp;<span class="ident" id="5984206">io</span><span class="op" id="5984208">.</span><span class="ident" id="5984209">ReadCloser</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984221">digest</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5984234">hash</span><span class="op" id="5984238">.</span><span class="ident" id="5984239">Hash32</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984247">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5984260">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984267">scratch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5984280">[</span><span class="num" id="5984281">4</span><span class="op" id="5984282">]</span><span class="builtintype" id="5984283">byte</span><br>
<span class="lineno"></span><span class="op" id="5984288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5984291">//&nbsp;Resetter&nbsp;resets&nbsp;a&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReader&nbsp;or&nbsp;NewReaderDict&nbsp;to</span><br>
<span class="lineno">55</span><span class="comment" id="5984365">//&nbsp;to&nbsp;switch&nbsp;to&nbsp;a&nbsp;new&nbsp;underlying&nbsp;Reader.&nbsp;This&nbsp;permits&nbsp;reusing&nbsp;a&nbsp;ReadCloser</span><br>
<span class="lineno"></span><span class="comment" id="5984440">//&nbsp;instead&nbsp;of&nbsp;allocating&nbsp;a&nbsp;new&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="5984476">type</span>&nbsp;<span class="ident" id="5984481">Resetter</span>&nbsp;<span class="keyword" id="5984490">interface</span>&nbsp;<span class="op" id="5984500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5984503">//&nbsp;Reset&nbsp;discards&nbsp;any&nbsp;buffered&nbsp;data&nbsp;and&nbsp;resets&nbsp;the&nbsp;Resetter&nbsp;as&nbsp;if&nbsp;it&nbsp;was</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5984577">//&nbsp;newly&nbsp;initialized&nbsp;with&nbsp;the&nbsp;given&nbsp;reader.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984622">Reset</span><span class="op" id="5984627">(</span><span class="ident" id="5984628">r</span>&nbsp;<span class="ident" id="5984630">io</span><span class="op" id="5984632">.</span><span class="ident" id="5984633">Reader</span><span class="op" id="5984639">,</span>&nbsp;<span class="ident" id="5984641">dict</span>&nbsp;<span class="op" id="5984646">[</span><span class="op" id="5984647">]</span><span class="builtintype" id="5984648">byte</span><span class="op" id="5984652">)</span>&nbsp;<span class="builtintype" id="5984654">error</span><br>
<span class="lineno"></span><span class="op" id="5984660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5984663">//&nbsp;NewReader&nbsp;creates&nbsp;a&nbsp;new&nbsp;ReadCloser.</span><br>
<span class="lineno"></span><span class="comment" id="5984702">//&nbsp;Reads&nbsp;from&nbsp;the&nbsp;returned&nbsp;ReadCloser&nbsp;read&nbsp;and&nbsp;decompress&nbsp;data&nbsp;from&nbsp;r.</span><br>
<span class="lineno">65</span><span class="comment" id="5984773">//&nbsp;The&nbsp;implementation&nbsp;buffers&nbsp;input&nbsp;and&nbsp;may&nbsp;read&nbsp;more&nbsp;data&nbsp;than&nbsp;necessary&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="5984855">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;call&nbsp;Close&nbsp;on&nbsp;the&nbsp;ReadCloser&nbsp;when&nbsp;done.</span><br>
<span class="lineno"></span><span class="comment" id="5984935">//</span><br>
<span class="lineno"></span><span class="comment" id="5984938">//&nbsp;The&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReader&nbsp;also&nbsp;implements&nbsp;Resetter.</span><br>
<span class="lineno"></span><span class="keyword" id="5985004">func</span>&nbsp;<span class="ident" id="5985009">NewReader</span><span class="op" id="5985018">(</span><span class="ident" id="5985019">r</span>&nbsp;<span class="ident" id="5985021">io</span><span class="op" id="5985023">.</span><span class="ident" id="5985024">Reader</span><span class="op" id="5985030">)</span>&nbsp;<span class="op" id="5985032">(</span><span class="ident" id="5985033">io</span><span class="op" id="5985035">.</span><span class="ident" id="5985036">ReadCloser</span><span class="op" id="5985046">,</span>&nbsp;<span class="builtintype" id="5985048">error</span><span class="op" id="5985053">)</span>&nbsp;<span class="op" id="5985055">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985058">return</span>&nbsp;<span class="ident" id="5985065">NewReaderDict</span><span class="op" id="5985078">(</span><span class="ident" id="5985079">r</span><span class="op" id="5985080">,</span>&nbsp;<span class="ident" id="5985082">nil</span><span class="op" id="5985085">)</span><br>
<span class="lineno"></span><span class="op" id="5985087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5985090">//&nbsp;NewReaderDict&nbsp;is&nbsp;like&nbsp;NewReader&nbsp;but&nbsp;uses&nbsp;a&nbsp;preset&nbsp;dictionary.</span><br>
<span class="lineno"></span><span class="comment" id="5985155">//&nbsp;NewReaderDict&nbsp;ignores&nbsp;the&nbsp;dictionary&nbsp;if&nbsp;the&nbsp;compressed&nbsp;data&nbsp;does&nbsp;not&nbsp;refer&nbsp;to&nbsp;it.</span><br>
<span class="lineno">75</span><span class="comment" id="5985240">//&nbsp;If&nbsp;the&nbsp;compressed&nbsp;data&nbsp;refers&nbsp;to&nbsp;a&nbsp;different&nbsp;dictionary,&nbsp;NewReaderDict&nbsp;returns&nbsp;ErrDictionary.</span><br>
<span class="lineno"></span><span class="comment" id="5985337">//</span><br>
<span class="lineno"></span><span class="comment" id="5985340">//&nbsp;The&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReaderDict&nbsp;also&nbsp;implements&nbsp;Resetter.</span><br>
<span class="lineno"></span><span class="keyword" id="5985410">func</span>&nbsp;<span class="ident" id="5985415">NewReaderDict</span><span class="op" id="5985428">(</span><span class="ident" id="5985429">r</span>&nbsp;<span class="ident" id="5985431">io</span><span class="op" id="5985433">.</span><span class="ident" id="5985434">Reader</span><span class="op" id="5985440">,</span>&nbsp;<span class="ident" id="5985442">dict</span>&nbsp;<span class="op" id="5985447">[</span><span class="op" id="5985448">]</span><span class="builtintype" id="5985449">byte</span><span class="op" id="5985453">)</span>&nbsp;<span class="op" id="5985455">(</span><span class="ident" id="5985456">io</span><span class="op" id="5985458">.</span><span class="ident" id="5985459">ReadCloser</span><span class="op" id="5985469">,</span>&nbsp;<span class="builtintype" id="5985471">error</span><span class="op" id="5985476">)</span>&nbsp;<span class="op" id="5985478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985481">z</span>&nbsp;<span class="op" id="5985483">:=</span>&nbsp;<span class="builtinfunc" id="5985486">new</span><span class="op" id="5985489">(</span><span class="ident" id="5985490">reader</span><span class="op" id="5985496">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985499">err</span>&nbsp;<span class="op" id="5985503">:=</span>&nbsp;<span class="ident" id="5985506">z</span><span class="op" id="5985507">.</span><span class="ident" id="5985508">Reset</span><span class="op" id="5985513">(</span><span class="ident" id="5985514">r</span><span class="op" id="5985515">,</span>&nbsp;<span class="ident" id="5985517">dict</span><span class="op" id="5985521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985524">if</span>&nbsp;<span class="ident" id="5985527">err</span>&nbsp;<span class="op" id="5985531">!=</span>&nbsp;<span class="ident" id="5985534">nil</span>&nbsp;<span class="op" id="5985538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985542">return</span>&nbsp;<span class="ident" id="5985549">nil</span><span class="op" id="5985552">,</span>&nbsp;<span class="ident" id="5985554">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5985559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985562">return</span>&nbsp;<span class="ident" id="5985569">z</span><span class="op" id="5985570">,</span>&nbsp;<span class="ident" id="5985572">nil</span><br>
<span class="lineno">85</span><span class="op" id="5985576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5985579">func</span>&nbsp;<span class="op" id="5985584">(</span><span class="ident" id="5985585">z</span>&nbsp;<span class="op" id="5985587">*</span><span class="ident" id="5985588">reader</span><span class="op" id="5985594">)</span>&nbsp;<span class="ident" id="5985596">Read</span><span class="op" id="5985600">(</span><span class="ident" id="5985601">p</span>&nbsp;<span class="op" id="5985603">[</span><span class="op" id="5985604">]</span><span class="builtintype" id="5985605">byte</span><span class="op" id="5985609">)</span>&nbsp;<span class="op" id="5985611">(</span><span class="ident" id="5985612">n</span>&nbsp;<span class="builtintype" id="5985614">int</span><span class="op" id="5985617">,</span>&nbsp;<span class="ident" id="5985619">err</span>&nbsp;<span class="builtintype" id="5985623">error</span><span class="op" id="5985628">)</span>&nbsp;<span class="op" id="5985630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985633">if</span>&nbsp;<span class="ident" id="5985636">z</span><span class="op" id="5985637">.</span><span class="ident" id="5985638">err</span>&nbsp;<span class="op" id="5985642">!=</span>&nbsp;<span class="ident" id="5985645">nil</span>&nbsp;<span class="op" id="5985649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985653">return</span>&nbsp;<span class="num" id="5985660">0</span><span class="op" id="5985661">,</span>&nbsp;<span class="ident" id="5985663">z</span><span class="op" id="5985664">.</span><span class="ident" id="5985665">err</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5985670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985673">if</span>&nbsp;<span class="builtinfunc" id="5985676">len</span><span class="op" id="5985679">(</span><span class="ident" id="5985680">p</span><span class="op" id="5985681">)</span>&nbsp;<span class="op" id="5985683">==</span>&nbsp;<span class="num" id="5985686">0</span>&nbsp;<span class="op" id="5985688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985692">return</span>&nbsp;<span class="num" id="5985699">0</span><span class="op" id="5985700">,</span>&nbsp;<span class="ident" id="5985702">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5985707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985711">n</span><span class="op" id="5985712">,</span>&nbsp;<span class="ident" id="5985714">err</span>&nbsp;<span class="op" id="5985718">=</span>&nbsp;<span class="ident" id="5985720">z</span><span class="op" id="5985721">.</span><span class="ident" id="5985722">decompressor</span><span class="op" id="5985734">.</span><span class="ident" id="5985735">Read</span><span class="op" id="5985739">(</span><span class="ident" id="5985740">p</span><span class="op" id="5985741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985744">z</span><span class="op" id="5985745">.</span><span class="ident" id="5985746">digest</span><span class="op" id="5985752">.</span><span class="ident" id="5985753">Write</span><span class="op" id="5985758">(</span><span class="ident" id="5985759">p</span><span class="op" id="5985760">[</span><span class="num" id="5985761">0</span><span class="op" id="5985762">:</span><span class="ident" id="5985763">n</span><span class="op" id="5985764">]</span><span class="op" id="5985765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985768">if</span>&nbsp;<span class="ident" id="5985771">n</span>&nbsp;<span class="op" id="5985773">!=</span>&nbsp;<span class="num" id="5985776">0</span>&nbsp;<span class="op" id="5985778">||</span>&nbsp;<span class="ident" id="5985781">err</span>&nbsp;<span class="op" id="5985785">!=</span>&nbsp;<span class="ident" id="5985788">io</span><span class="op" id="5985790">.</span><span class="ident" id="5985791">EOF</span>&nbsp;<span class="op" id="5985795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985799">z</span><span class="op" id="5985800">.</span><span class="ident" id="5985801">err</span>&nbsp;<span class="op" id="5985805">=</span>&nbsp;<span class="ident" id="5985807">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985813">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5985821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5985825">//&nbsp;Finished&nbsp;file;&nbsp;check&nbsp;checksum.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985860">if</span>&nbsp;<span class="ident" id="5985863">_</span><span class="op" id="5985864">,</span>&nbsp;<span class="ident" id="5985866">err</span>&nbsp;<span class="op" id="5985870">:=</span>&nbsp;<span class="ident" id="5985873">io</span><span class="op" id="5985875">.</span><span class="ident" id="5985876">ReadFull</span><span class="op" id="5985884">(</span><span class="ident" id="5985885">z</span><span class="op" id="5985886">.</span><span class="ident" id="5985887">r</span><span class="op" id="5985888">,</span>&nbsp;<span class="ident" id="5985890">z</span><span class="op" id="5985891">.</span><span class="ident" id="5985892">scratch</span><span class="op" id="5985899">[</span><span class="num" id="5985900">0</span><span class="op" id="5985901">:</span><span class="num" id="5985902">4</span><span class="op" id="5985903">]</span><span class="op" id="5985904">)</span><span class="op" id="5985905">;</span>&nbsp;<span class="ident" id="5985907">err</span>&nbsp;<span class="op" id="5985911">!=</span>&nbsp;<span class="ident" id="5985914">nil</span>&nbsp;<span class="op" id="5985918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985922">z</span><span class="op" id="5985923">.</span><span class="ident" id="5985924">err</span>&nbsp;<span class="op" id="5985928">=</span>&nbsp;<span class="ident" id="5985930">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985936">return</span>&nbsp;<span class="num" id="5985943">0</span><span class="op" id="5985944">,</span>&nbsp;<span class="ident" id="5985946">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5985951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5985954">//&nbsp;ZLIB&nbsp;(RFC&nbsp;1950)&nbsp;is&nbsp;big-endian,&nbsp;unlike&nbsp;GZIP&nbsp;(RFC&nbsp;1952).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986013">checksum</span>&nbsp;<span class="op" id="5986022">:=</span>&nbsp;<span class="builtintype" id="5986025">uint32</span><span class="op" id="5986031">(</span><span class="ident" id="5986032">z</span><span class="op" id="5986033">.</span><span class="ident" id="5986034">scratch</span><span class="op" id="5986041">[</span><span class="num" id="5986042">0</span><span class="op" id="5986043">]</span><span class="op" id="5986044">)</span><span class="op" id="5986045">&lt;&lt;</span><span class="num" id="5986047">24</span>&nbsp;<span class="op" id="5986050">|</span>&nbsp;<span class="builtintype" id="5986052">uint32</span><span class="op" id="5986058">(</span><span class="ident" id="5986059">z</span><span class="op" id="5986060">.</span><span class="ident" id="5986061">scratch</span><span class="op" id="5986068">[</span><span class="num" id="5986069">1</span><span class="op" id="5986070">]</span><span class="op" id="5986071">)</span><span class="op" id="5986072">&lt;&lt;</span><span class="num" id="5986074">16</span>&nbsp;<span class="op" id="5986077">|</span>&nbsp;<span class="builtintype" id="5986079">uint32</span><span class="op" id="5986085">(</span><span class="ident" id="5986086">z</span><span class="op" id="5986087">.</span><span class="ident" id="5986088">scratch</span><span class="op" id="5986095">[</span><span class="num" id="5986096">2</span><span class="op" id="5986097">]</span><span class="op" id="5986098">)</span><span class="op" id="5986099">&lt;&lt;</span><span class="num" id="5986101">8</span>&nbsp;<span class="op" id="5986103">|</span>&nbsp;<span class="builtintype" id="5986105">uint32</span><span class="op" id="5986111">(</span><span class="ident" id="5986112">z</span><span class="op" id="5986113">.</span><span class="ident" id="5986114">scratch</span><span class="op" id="5986121">[</span><span class="num" id="5986122">3</span><span class="op" id="5986123">]</span><span class="op" id="5986124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986127">if</span>&nbsp;<span class="ident" id="5986130">checksum</span>&nbsp;<span class="op" id="5986139">!=</span>&nbsp;<span class="ident" id="5986142">z</span><span class="op" id="5986143">.</span><span class="ident" id="5986144">digest</span><span class="op" id="5986150">.</span><span class="ident" id="5986151">Sum32</span><span class="op" id="5986156">(</span><span class="op" id="5986157">)</span>&nbsp;<span class="op" id="5986159">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986163">z</span><span class="op" id="5986164">.</span><span class="ident" id="5986165">err</span>&nbsp;<span class="op" id="5986169">=</span>&nbsp;<span class="ident" id="5986171">ErrChecksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986185">return</span>&nbsp;<span class="num" id="5986192">0</span><span class="op" id="5986193">,</span>&nbsp;<span class="ident" id="5986195">z</span><span class="op" id="5986196">.</span><span class="ident" id="5986197">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5986202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986205">return</span><br>
<span class="lineno"></span><span class="op" id="5986212">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="5986215">//&nbsp;Calling&nbsp;Close&nbsp;does&nbsp;not&nbsp;close&nbsp;the&nbsp;wrapped&nbsp;io.Reader&nbsp;originally&nbsp;passed&nbsp;to&nbsp;NewReader.</span><br>
<span class="lineno"></span><span class="keyword" id="5986301">func</span>&nbsp;<span class="op" id="5986306">(</span><span class="ident" id="5986307">z</span>&nbsp;<span class="op" id="5986309">*</span><span class="ident" id="5986310">reader</span><span class="op" id="5986316">)</span>&nbsp;<span class="ident" id="5986318">Close</span><span class="op" id="5986323">(</span><span class="op" id="5986324">)</span>&nbsp;<span class="builtintype" id="5986326">error</span>&nbsp;<span class="op" id="5986332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986335">if</span>&nbsp;<span class="ident" id="5986338">z</span><span class="op" id="5986339">.</span><span class="ident" id="5986340">err</span>&nbsp;<span class="op" id="5986344">!=</span>&nbsp;<span class="ident" id="5986347">nil</span>&nbsp;<span class="op" id="5986351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986355">return</span>&nbsp;<span class="ident" id="5986362">z</span><span class="op" id="5986363">.</span><span class="ident" id="5986364">err</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5986369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986372">z</span><span class="op" id="5986373">.</span><span class="ident" id="5986374">err</span>&nbsp;<span class="op" id="5986378">=</span>&nbsp;<span class="ident" id="5986380">z</span><span class="op" id="5986381">.</span><span class="ident" id="5986382">decompressor</span><span class="op" id="5986394">.</span><span class="ident" id="5986395">Close</span><span class="op" id="5986400">(</span><span class="op" id="5986401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986404">return</span>&nbsp;<span class="ident" id="5986411">z</span><span class="op" id="5986412">.</span><span class="ident" id="5986413">err</span><br>
<span class="lineno"></span><span class="op" id="5986417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="5986420">func</span>&nbsp;<span class="op" id="5986425">(</span><span class="ident" id="5986426">z</span>&nbsp;<span class="op" id="5986428">*</span><span class="ident" id="5986429">reader</span><span class="op" id="5986435">)</span>&nbsp;<span class="ident" id="5986437">Reset</span><span class="op" id="5986442">(</span><span class="ident" id="5986443">r</span>&nbsp;<span class="ident" id="5986445">io</span><span class="op" id="5986447">.</span><span class="ident" id="5986448">Reader</span><span class="op" id="5986454">,</span>&nbsp;<span class="ident" id="5986456">dict</span>&nbsp;<span class="op" id="5986461">[</span><span class="op" id="5986462">]</span><span class="builtintype" id="5986463">byte</span><span class="op" id="5986467">)</span>&nbsp;<span class="builtintype" id="5986469">error</span>&nbsp;<span class="op" id="5986475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986478">if</span>&nbsp;<span class="ident" id="5986481">fr</span><span class="op" id="5986483">,</span>&nbsp;<span class="ident" id="5986485">ok</span>&nbsp;<span class="op" id="5986488">:=</span>&nbsp;<span class="ident" id="5986491">r</span><span class="op" id="5986492">.</span><span class="op" id="5986493">(</span><span class="ident" id="5986494">flate</span><span class="op" id="5986499">.</span><span class="ident" id="5986500">Reader</span><span class="op" id="5986506">)</span><span class="op" id="5986507">;</span>&nbsp;<span class="ident" id="5986509">ok</span>&nbsp;<span class="op" id="5986512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986516">z</span><span class="op" id="5986517">.</span><span class="ident" id="5986518">r</span>&nbsp;<span class="op" id="5986520">=</span>&nbsp;<span class="ident" id="5986522">fr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5986526">}</span>&nbsp;<span class="keyword" id="5986528">else</span>&nbsp;<span class="op" id="5986533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986537">z</span><span class="op" id="5986538">.</span><span class="ident" id="5986539">r</span>&nbsp;<span class="op" id="5986541">=</span>&nbsp;<span class="ident" id="5986543">bufio</span><span class="op" id="5986548">.</span><span class="ident" id="5986549">NewReader</span><span class="op" id="5986558">(</span><span class="ident" id="5986559">r</span><span class="op" id="5986560">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5986563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986566">_</span><span class="op" id="5986567">,</span>&nbsp;<span class="ident" id="5986569">err</span>&nbsp;<span class="op" id="5986573">:=</span>&nbsp;<span class="ident" id="5986576">io</span><span class="op" id="5986578">.</span><span class="ident" id="5986579">ReadFull</span><span class="op" id="5986587">(</span><span class="ident" id="5986588">z</span><span class="op" id="5986589">.</span><span class="ident" id="5986590">r</span><span class="op" id="5986591">,</span>&nbsp;<span class="ident" id="5986593">z</span><span class="op" id="5986594">.</span><span class="ident" id="5986595">scratch</span><span class="op" id="5986602">[</span><span class="num" id="5986603">0</span><span class="op" id="5986604">:</span><span class="num" id="5986605">2</span><span class="op" id="5986606">]</span><span class="op" id="5986607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986610">if</span>&nbsp;<span class="ident" id="5986613">err</span>&nbsp;<span class="op" id="5986617">!=</span>&nbsp;<span class="ident" id="5986620">nil</span>&nbsp;<span class="op" id="5986624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986628">return</span>&nbsp;<span class="ident" id="5986635">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5986640">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986643">h</span>&nbsp;<span class="op" id="5986645">:=</span>&nbsp;<span class="builtintype" id="5986648">uint</span><span class="op" id="5986652">(</span><span class="ident" id="5986653">z</span><span class="op" id="5986654">.</span><span class="ident" id="5986655">scratch</span><span class="op" id="5986662">[</span><span class="num" id="5986663">0</span><span class="op" id="5986664">]</span><span class="op" id="5986665">)</span><span class="op" id="5986666">&lt;&lt;</span><span class="num" id="5986668">8</span>&nbsp;<span class="op" id="5986670">|</span>&nbsp;<span class="builtintype" id="5986672">uint</span><span class="op" id="5986676">(</span><span class="ident" id="5986677">z</span><span class="op" id="5986678">.</span><span class="ident" id="5986679">scratch</span><span class="op" id="5986686">[</span><span class="num" id="5986687">1</span><span class="op" id="5986688">]</span><span class="op" id="5986689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986692">if</span>&nbsp;<span class="op" id="5986695">(</span><span class="ident" id="5986696">z</span><span class="op" id="5986697">.</span><span class="ident" id="5986698">scratch</span><span class="op" id="5986705">[</span><span class="num" id="5986706">0</span><span class="op" id="5986707">]</span><span class="op" id="5986708">&amp;</span><span class="num" id="5986709">0x0f</span>&nbsp;<span class="op" id="5986714">!=</span>&nbsp;<span class="ident" id="5986717">zlibDeflate</span><span class="op" id="5986728">)</span>&nbsp;<span class="op" id="5986730">||</span>&nbsp;<span class="op" id="5986733">(</span><span class="ident" id="5986734">h</span><span class="op" id="5986735">%</span><span class="num" id="5986736">31</span>&nbsp;<span class="op" id="5986739">!=</span>&nbsp;<span class="num" id="5986742">0</span><span class="op" id="5986743">)</span>&nbsp;<span class="op" id="5986745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986749">return</span>&nbsp;<span class="ident" id="5986756">ErrHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5986767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986770">haveDict</span>&nbsp;<span class="op" id="5986779">:=</span>&nbsp;<span class="ident" id="5986782">z</span><span class="op" id="5986783">.</span><span class="ident" id="5986784">scratch</span><span class="op" id="5986791">[</span><span class="num" id="5986792">1</span><span class="op" id="5986793">]</span><span class="op" id="5986794">&amp;</span><span class="num" id="5986795">0x20</span>&nbsp;<span class="op" id="5986800">!=</span>&nbsp;<span class="num" id="5986803">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986806">if</span>&nbsp;<span class="ident" id="5986809">haveDict</span>&nbsp;<span class="op" id="5986818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986822">_</span><span class="op" id="5986823">,</span>&nbsp;<span class="ident" id="5986825">err</span>&nbsp;<span class="op" id="5986829">=</span>&nbsp;<span class="ident" id="5986831">io</span><span class="op" id="5986833">.</span><span class="ident" id="5986834">ReadFull</span><span class="op" id="5986842">(</span><span class="ident" id="5986843">z</span><span class="op" id="5986844">.</span><span class="ident" id="5986845">r</span><span class="op" id="5986846">,</span>&nbsp;<span class="ident" id="5986848">z</span><span class="op" id="5986849">.</span><span class="ident" id="5986850">scratch</span><span class="op" id="5986857">[</span><span class="num" id="5986858">0</span><span class="op" id="5986859">:</span><span class="num" id="5986860">4</span><span class="op" id="5986861">]</span><span class="op" id="5986862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986866">if</span>&nbsp;<span class="ident" id="5986869">err</span>&nbsp;<span class="op" id="5986873">!=</span>&nbsp;<span class="ident" id="5986876">nil</span>&nbsp;<span class="op" id="5986880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986885">return</span>&nbsp;<span class="ident" id="5986892">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5986898">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986902">checksum</span>&nbsp;<span class="op" id="5986911">:=</span>&nbsp;<span class="builtintype" id="5986914">uint32</span><span class="op" id="5986920">(</span><span class="ident" id="5986921">z</span><span class="op" id="5986922">.</span><span class="ident" id="5986923">scratch</span><span class="op" id="5986930">[</span><span class="num" id="5986931">0</span><span class="op" id="5986932">]</span><span class="op" id="5986933">)</span><span class="op" id="5986934">&lt;&lt;</span><span class="num" id="5986936">24</span>&nbsp;<span class="op" id="5986939">|</span>&nbsp;<span class="builtintype" id="5986941">uint32</span><span class="op" id="5986947">(</span><span class="ident" id="5986948">z</span><span class="op" id="5986949">.</span><span class="ident" id="5986950">scratch</span><span class="op" id="5986957">[</span><span class="num" id="5986958">1</span><span class="op" id="5986959">]</span><span class="op" id="5986960">)</span><span class="op" id="5986961">&lt;&lt;</span><span class="num" id="5986963">16</span>&nbsp;<span class="op" id="5986966">|</span>&nbsp;<span class="builtintype" id="5986968">uint32</span><span class="op" id="5986974">(</span><span class="ident" id="5986975">z</span><span class="op" id="5986976">.</span><span class="ident" id="5986977">scratch</span><span class="op" id="5986984">[</span><span class="num" id="5986985">2</span><span class="op" id="5986986">]</span><span class="op" id="5986987">)</span><span class="op" id="5986988">&lt;&lt;</span><span class="num" id="5986990">8</span>&nbsp;<span class="op" id="5986992">|</span>&nbsp;<span class="builtintype" id="5986994">uint32</span><span class="op" id="5987000">(</span><span class="ident" id="5987001">z</span><span class="op" id="5987002">.</span><span class="ident" id="5987003">scratch</span><span class="op" id="5987010">[</span><span class="num" id="5987011">3</span><span class="op" id="5987012">]</span><span class="op" id="5987013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5987017">if</span>&nbsp;<span class="ident" id="5987020">checksum</span>&nbsp;<span class="op" id="5987029">!=</span>&nbsp;<span class="ident" id="5987032">adler32</span><span class="op" id="5987039">.</span><span class="ident" id="5987040">Checksum</span><span class="op" id="5987048">(</span><span class="ident" id="5987049">dict</span><span class="op" id="5987053">)</span>&nbsp;<span class="op" id="5987055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5987060">return</span>&nbsp;<span class="ident" id="5987067">ErrDictionary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5987083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5987086">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5987089">if</span>&nbsp;<span class="ident" id="5987092">z</span><span class="op" id="5987093">.</span><span class="ident" id="5987094">decompressor</span>&nbsp;<span class="op" id="5987107">==</span>&nbsp;<span class="ident" id="5987110">nil</span>&nbsp;<span class="op" id="5987114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5987118">if</span>&nbsp;<span class="ident" id="5987121">haveDict</span>&nbsp;<span class="op" id="5987130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5987135">z</span><span class="op" id="5987136">.</span><span class="ident" id="5987137">decompressor</span>&nbsp;<span class="op" id="5987150">=</span>&nbsp;<span class="ident" id="5987152">flate</span><span class="op" id="5987157">.</span><span class="ident" id="5987158">NewReaderDict</span><span class="op" id="5987171">(</span><span class="ident" id="5987172">z</span><span class="op" id="5987173">.</span><span class="ident" id="5987174">r</span><span class="op" id="5987175">,</span>&nbsp;<span class="ident" id="5987177">dict</span><span class="op" id="5987181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5987185">}</span>&nbsp;<span class="keyword" id="5987187">else</span>&nbsp;<span class="op" id="5987192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5987197">z</span><span class="op" id="5987198">.</span><span class="ident" id="5987199">decompressor</span>&nbsp;<span class="op" id="5987212">=</span>&nbsp;<span class="ident" id="5987214">flate</span><span class="op" id="5987219">.</span><span class="ident" id="5987220">NewReader</span><span class="op" id="5987229">(</span><span class="ident" id="5987230">z</span><span class="op" id="5987231">.</span><span class="ident" id="5987232">r</span><span class="op" id="5987233">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5987237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5987240">}</span>&nbsp;<span class="keyword" id="5987242">else</span>&nbsp;<span class="op" id="5987247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5987251">z</span><span class="op" id="5987252">.</span><span class="ident" id="5987253">decompressor</span><span class="op" id="5987265">.</span><span class="op" id="5987266">(</span><span class="ident" id="5987267">flate</span><span class="op" id="5987272">.</span><span class="ident" id="5987273">Resetter</span><span class="op" id="5987281">)</span><span class="op" id="5987282">.</span><span class="ident" id="5987283">Reset</span><span class="op" id="5987288">(</span><span class="ident" id="5987289">z</span><span class="op" id="5987290">.</span><span class="ident" id="5987291">r</span><span class="op" id="5987292">,</span>&nbsp;<span class="ident" id="5987294">dict</span><span class="op" id="5987298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5987301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5987304">z</span><span class="op" id="5987305">.</span><span class="ident" id="5987306">digest</span>&nbsp;<span class="op" id="5987313">=</span>&nbsp;<span class="ident" id="5987315">adler32</span><span class="op" id="5987322">.</span><span class="ident" id="5987323">New</span><span class="op" id="5987326">(</span><span class="op" id="5987327">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5987330">return</span>&nbsp;<span class="ident" id="5987337">nil</span><br>
<span class="lineno"></span><span class="op" id="5987341">}</span>
</div>
</body>
</html>
