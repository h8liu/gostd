<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html" class="current">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6641950">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6642005">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6642059">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6642110">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6642175">package</span>&nbsp;<span class="ident" id="6642183">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6642188">import</span>&nbsp;<span class="op" id="6642195">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6642198">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6642204">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6642217">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6642223">&#34;path&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6642231">&#34;reflect&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6642242">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6642253">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6642260">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6642263">var</span>&nbsp;<span class="ident" id="6642267">dnsTransportFallbackTests</span>&nbsp;<span class="op" id="6642293">=</span>&nbsp;<span class="op" id="6642295">[</span><span class="op" id="6642296">]</span><span class="keyword" id="6642297">struct</span>&nbsp;<span class="op" id="6642304">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642307">server</span>&nbsp;&nbsp;<span class="builtintype" id="6642315">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642323">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6642331">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642339">qtype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6642347">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642355">timeout</span>&nbsp;<span class="builtintype" id="6642363">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642368">rcode</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6642376">int</span><br>
<span class="lineno">25</span><span class="op" id="6642380">}</span><span class="op" id="6642381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6642384">//&nbsp;Querying&nbsp;&#34;com.&#34;&nbsp;with&nbsp;qtype=255&nbsp;usually&nbsp;makes&nbsp;an&nbsp;answer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6642443">//&nbsp;which&nbsp;requires&nbsp;more&nbsp;than&nbsp;512&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6642483">{</span><span class="string" id="6642484">&#34;8.8.8.8:53&#34;</span><span class="op" id="6642496">,</span>&nbsp;<span class="string" id="6642498">&#34;com.&#34;</span><span class="op" id="6642504">,</span>&nbsp;<span class="ident" id="6642506"><a href="/gostd/net/dnsmsg.go.html#3229213">dnsTypeALL</a></span><span class="op" id="6642516">,</span>&nbsp;<span class="num" id="6642518">2</span><span class="op" id="6642519">,</span>&nbsp;<span class="ident" id="6642521"><a href="/gostd/net/dnsmsg.go.html#3229383">dnsRcodeSuccess</a></span><span class="op" id="6642536">}</span><span class="op" id="6642537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6642540">{</span><span class="string" id="6642541">&#34;8.8.4.4:53&#34;</span><span class="op" id="6642553">,</span>&nbsp;<span class="string" id="6642555">&#34;com.&#34;</span><span class="op" id="6642561">,</span>&nbsp;<span class="ident" id="6642563"><a href="/gostd/net/dnsmsg.go.html#3229213">dnsTypeALL</a></span><span class="op" id="6642573">,</span>&nbsp;<span class="num" id="6642575">4</span><span class="op" id="6642576">,</span>&nbsp;<span class="ident" id="6642578"><a href="/gostd/net/dnsmsg.go.html#3229383">dnsRcodeSuccess</a></span><span class="op" id="6642593">}</span><span class="op" id="6642594">,</span><br>
<span class="lineno">30</span><span class="op" id="6642596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6642599">func</span>&nbsp;<span class="ident" id="6642604">TestDNSTransportFallback</span><span class="op" id="6642628">(</span><span class="ident" id="6642629">t</span>&nbsp;<span class="op" id="6642631">*</span><span class="ident" id="6642632"><a href="/gostd/net/dnsclient_unix_test.go.html#6642242">testing</a></span><span class="op" id="6642639">.</span><span class="ident" id="6642640"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6642641">)</span>&nbsp;<span class="op" id="6642643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6642646">if</span>&nbsp;<span class="ident" id="6642649"><a href="/gostd/net/dnsclient_unix_test.go.html#6642242">testing</a></span><span class="op" id="6642656">.</span><span class="ident" id="6642657"><a href="/gostd/testing/testing.go.html#5475359">Short</a></span><span class="op" id="6642662">(</span><span class="op" id="6642663">)</span>&nbsp;<span class="op" id="6642665">||</span>&nbsp;<span class="op" id="6642668">!</span><span class="op" id="6642669">*</span><span class="ident" id="6642670"><a href="/gostd/net/lookup_test.go.html#6707430">testExternal</a></span>&nbsp;<span class="op" id="6642683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642687"><a href="/gostd/net/dnsclient_unix_test.go.html#6642629">t</a></span><span class="op" id="6642688">.</span><span class="ident" id="6642689"><a href="/gostd/testing/testing.go.html#5480575">Skip</a></span><span class="op" id="6642693">(</span><span class="string" id="6642694">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6642735">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6642738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6642742">for</span>&nbsp;<span class="ident" id="6642746">_</span><span class="op" id="6642747">,</span>&nbsp;<span class="ident" id="6642749">tt</span>&nbsp;<span class="op" id="6642752">:=</span>&nbsp;<span class="keyword" id="6642755">range</span>&nbsp;<span class="ident" id="6642761"><a href="/gostd/net/dnsclient_unix_test.go.html#6642267">dnsTransportFallbackTests</a></span>&nbsp;<span class="op" id="6642787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642791">timeout</span>&nbsp;<span class="op" id="6642799">:=</span>&nbsp;<span class="ident" id="6642802"><a href="/gostd/net/dnsclient_unix_test.go.html#6642253">time</a></span><span class="op" id="6642806">.</span><span class="ident" id="6642807"><a href="/gostd/time/time.go.html#2734212">Duration</a></span><span class="op" id="6642815">(</span><span class="ident" id="6642816"><a href="/gostd/net/dnsclient_unix_test.go.html#6642749">tt</a></span><span class="op" id="6642818">.</span><span class="ident" id="6642819"><a href="/gostd/net/dnsclient_unix_test.go.html#6642355">timeout</a></span><span class="op" id="6642826">)</span>&nbsp;<span class="op" id="6642828">*</span>&nbsp;<span class="ident" id="6642830"><a href="/gostd/net/dnsclient_unix_test.go.html#6642253">time</a></span><span class="op" id="6642834">.</span><span class="ident" id="6642835"><a href="/gostd/time/time.go.html#2734862">Second</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642844">msg</span><span class="op" id="6642847">,</span>&nbsp;<span class="ident" id="6642849">err</span>&nbsp;<span class="op" id="6642853">:=</span>&nbsp;<span class="ident" id="6642856"><a href="/gostd/net/dnsclient_unix.go.html#3217568">exchange</a></span><span class="op" id="6642864">(</span><span class="ident" id="6642865"><a href="/gostd/net/dnsclient_unix_test.go.html#6642749">tt</a></span><span class="op" id="6642867">.</span><span class="ident" id="6642868"><a href="/gostd/net/dnsclient_unix_test.go.html#6642307">server</a></span><span class="op" id="6642874">,</span>&nbsp;<span class="ident" id="6642876"><a href="/gostd/net/dnsclient_unix_test.go.html#6642749">tt</a></span><span class="op" id="6642878">.</span><span class="ident" id="6642879"><a href="/gostd/net/dnsclient_unix_test.go.html#6642323">name</a></span><span class="op" id="6642883">,</span>&nbsp;<span class="ident" id="6642885"><a href="/gostd/net/dnsclient_unix_test.go.html#6642749">tt</a></span><span class="op" id="6642887">.</span><span class="ident" id="6642888"><a href="/gostd/net/dnsclient_unix_test.go.html#6642339">qtype</a></span><span class="op" id="6642893">,</span>&nbsp;<span class="ident" id="6642895"><a href="/gostd/net/dnsclient_unix_test.go.html#6642791">timeout</a></span><span class="op" id="6642902">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6642906">if</span>&nbsp;<span class="ident" id="6642909"><a href="/gostd/net/dnsclient_unix_test.go.html#6642849">err</a></span>&nbsp;<span class="op" id="6642913">!=</span>&nbsp;<span class="builtintype" id="6642916">nil</span>&nbsp;<span class="op" id="6642920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642925"><a href="/gostd/net/dnsclient_unix_test.go.html#6642629">t</a></span><span class="op" id="6642926">.</span><span class="ident" id="6642927"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="6642932">(</span><span class="ident" id="6642933"><a href="/gostd/net/dnsclient_unix_test.go.html#6642849">err</a></span><span class="op" id="6642936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6642941">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6642952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6642956">switch</span>&nbsp;<span class="ident" id="6642963"><a href="/gostd/net/dnsclient_unix_test.go.html#6642844">msg</a></span><span class="op" id="6642966">.</span><span class="ident" id="6642967"><a href="/gostd/net/dnsmsg.go.html#3245438">rcode</a></span>&nbsp;<span class="op" id="6642973">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6642977">case</span>&nbsp;<span class="ident" id="6642982"><a href="/gostd/net/dnsclient_unix_test.go.html#6642749">tt</a></span><span class="op" id="6642984">.</span><span class="ident" id="6642985"><a href="/gostd/net/dnsclient_unix_test.go.html#6642368">rcode</a></span><span class="op" id="6642990">,</span>&nbsp;<span class="ident" id="6642992"><a href="/gostd/net/dnsmsg.go.html#3229439">dnsRcodeServerFailure</a></span><span class="op" id="6643013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6643017">default</span><span class="op" id="6643024">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6643029"><a href="/gostd/net/dnsclient_unix_test.go.html#6642629">t</a></span><span class="op" id="6643030">.</span><span class="ident" id="6643031"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6643037">(</span><span class="string" id="6643038">&#34;got&nbsp;%v&nbsp;from&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6643063">,</span>&nbsp;<span class="ident" id="6643065"><a href="/gostd/net/dnsclient_unix_test.go.html#6642844">msg</a></span><span class="op" id="6643068">.</span><span class="ident" id="6643069"><a href="/gostd/net/dnsmsg.go.html#3245438">rcode</a></span><span class="op" id="6643074">,</span>&nbsp;<span class="ident" id="6643076"><a href="/gostd/net/dnsclient_unix_test.go.html#6642749">tt</a></span><span class="op" id="6643078">.</span><span class="ident" id="6643079"><a href="/gostd/net/dnsclient_unix_test.go.html#6642307">server</a></span><span class="op" id="6643085">,</span>&nbsp;<span class="ident" id="6643087"><a href="/gostd/net/dnsclient_unix_test.go.html#6642749">tt</a></span><span class="op" id="6643089">.</span><span class="ident" id="6643090"><a href="/gostd/net/dnsclient_unix_test.go.html#6642368">rcode</a></span><span class="op" id="6643095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6643100">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6643111">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6643114">}</span><br>
<span class="lineno"></span><span class="op" id="6643116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6643119">//&nbsp;See&nbsp;RFC&nbsp;6761&nbsp;for&nbsp;further&nbsp;information&nbsp;about&nbsp;the&nbsp;reserved,&nbsp;pseudo</span><br>
<span class="lineno"></span><span class="comment" id="6643186">//&nbsp;domain&nbsp;names.</span><br>
<span class="lineno">55</span><span class="keyword" id="6643203">var</span>&nbsp;<span class="ident" id="6643207">specialDomainNameTests</span>&nbsp;<span class="op" id="6643230">=</span>&nbsp;<span class="op" id="6643232">[</span><span class="op" id="6643233">]</span><span class="keyword" id="6643234">struct</span>&nbsp;<span class="op" id="6643241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6643244">name</span>&nbsp;&nbsp;<span class="builtintype" id="6643250">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6643258">qtype</span>&nbsp;<span class="builtintype" id="6643264">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6643272">rcode</span>&nbsp;<span class="builtintype" id="6643278">int</span><br>
<span class="lineno"></span><span class="op" id="6643282">}</span><span class="op" id="6643283">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6643286">//&nbsp;Name&nbsp;resoltion&nbsp;APIs&nbsp;and&nbsp;libraries&nbsp;should&nbsp;not&nbsp;recongnize&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6643350">//&nbsp;followings&nbsp;as&nbsp;special.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6643377">{</span><span class="string" id="6643378">&#34;1.0.168.192.in-addr.arpa.&#34;</span><span class="op" id="6643405">,</span>&nbsp;<span class="ident" id="6643407"><a href="/gostd/net/dnsmsg.go.html#3228986">dnsTypePTR</a></span><span class="op" id="6643417">,</span>&nbsp;<span class="ident" id="6643419"><a href="/gostd/net/dnsmsg.go.html#3229467">dnsRcodeNameError</a></span><span class="op" id="6643436">}</span><span class="op" id="6643437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6643440">{</span><span class="string" id="6643441">&#34;test.&#34;</span><span class="op" id="6643448">,</span>&nbsp;<span class="ident" id="6643450"><a href="/gostd/net/dnsmsg.go.html#3229213">dnsTypeALL</a></span><span class="op" id="6643460">,</span>&nbsp;<span class="ident" id="6643462"><a href="/gostd/net/dnsmsg.go.html#3229467">dnsRcodeNameError</a></span><span class="op" id="6643479">}</span><span class="op" id="6643480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6643483">{</span><span class="string" id="6643484">&#34;example.com.&#34;</span><span class="op" id="6643498">,</span>&nbsp;<span class="ident" id="6643500"><a href="/gostd/net/dnsmsg.go.html#3229213">dnsTypeALL</a></span><span class="op" id="6643510">,</span>&nbsp;<span class="ident" id="6643512"><a href="/gostd/net/dnsmsg.go.html#3229383">dnsRcodeSuccess</a></span><span class="op" id="6643527">}</span><span class="op" id="6643528">,</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6643532">//&nbsp;Name&nbsp;resoltion&nbsp;APIs&nbsp;and&nbsp;libraries&nbsp;should&nbsp;recongnize&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6643592">//&nbsp;followings&nbsp;as&nbsp;special&nbsp;and&nbsp;should&nbsp;not&nbsp;send&nbsp;any&nbsp;queries.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6643651">//&nbsp;Though,&nbsp;we&nbsp;test&nbsp;those&nbsp;names&nbsp;here&nbsp;for&nbsp;verifying&nbsp;nagative</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6643711">//&nbsp;answers&nbsp;at&nbsp;DNS&nbsp;query-response&nbsp;interaction&nbsp;level.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6643764">{</span><span class="string" id="6643765">&#34;localhost.&#34;</span><span class="op" id="6643777">,</span>&nbsp;<span class="ident" id="6643779"><a href="/gostd/net/dnsmsg.go.html#3229213">dnsTypeALL</a></span><span class="op" id="6643789">,</span>&nbsp;<span class="ident" id="6643791"><a href="/gostd/net/dnsmsg.go.html#3229467">dnsRcodeNameError</a></span><span class="op" id="6643808">}</span><span class="op" id="6643809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6643812">{</span><span class="string" id="6643813">&#34;invalid.&#34;</span><span class="op" id="6643823">,</span>&nbsp;<span class="ident" id="6643825"><a href="/gostd/net/dnsmsg.go.html#3229213">dnsTypeALL</a></span><span class="op" id="6643835">,</span>&nbsp;<span class="ident" id="6643837"><a href="/gostd/net/dnsmsg.go.html#3229467">dnsRcodeNameError</a></span><span class="op" id="6643854">}</span><span class="op" id="6643855">,</span><br>
<span class="lineno"></span><span class="op" id="6643857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6643860">func</span>&nbsp;<span class="ident" id="6643865">TestSpecialDomainName</span><span class="op" id="6643886">(</span><span class="ident" id="6643887">t</span>&nbsp;<span class="op" id="6643889">*</span><span class="ident" id="6643890"><a href="/gostd/net/dnsclient_unix_test.go.html#6642242">testing</a></span><span class="op" id="6643897">.</span><span class="ident" id="6643898"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6643899">)</span>&nbsp;<span class="op" id="6643901">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6643904">if</span>&nbsp;<span class="ident" id="6643907"><a href="/gostd/net/dnsclient_unix_test.go.html#6642242">testing</a></span><span class="op" id="6643914">.</span><span class="ident" id="6643915"><a href="/gostd/testing/testing.go.html#5475359">Short</a></span><span class="op" id="6643920">(</span><span class="op" id="6643921">)</span>&nbsp;<span class="op" id="6643923">||</span>&nbsp;<span class="op" id="6643926">!</span><span class="op" id="6643927">*</span><span class="ident" id="6643928"><a href="/gostd/net/lookup_test.go.html#6707430">testExternal</a></span>&nbsp;<span class="op" id="6643941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6643945"><a href="/gostd/net/dnsclient_unix_test.go.html#6643887">t</a></span><span class="op" id="6643946">.</span><span class="ident" id="6643947"><a href="/gostd/testing/testing.go.html#5480575">Skip</a></span><span class="op" id="6643951">(</span><span class="string" id="6643952">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6643993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6643996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644000">server</span>&nbsp;<span class="op" id="6644007">:=</span>&nbsp;<span class="string" id="6644010">&#34;8.8.8.8:53&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6644024">for</span>&nbsp;<span class="ident" id="6644028">_</span><span class="op" id="6644029">,</span>&nbsp;<span class="ident" id="6644031">tt</span>&nbsp;<span class="op" id="6644034">:=</span>&nbsp;<span class="keyword" id="6644037">range</span>&nbsp;<span class="ident" id="6644043"><a href="/gostd/net/dnsclient_unix_test.go.html#6643207">specialDomainNameTests</a></span>&nbsp;<span class="op" id="6644066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644070">msg</span><span class="op" id="6644073">,</span>&nbsp;<span class="ident" id="6644075">err</span>&nbsp;<span class="op" id="6644079">:=</span>&nbsp;<span class="ident" id="6644082"><a href="/gostd/net/dnsclient_unix.go.html#3217568">exchange</a></span><span class="op" id="6644090">(</span><span class="ident" id="6644091"><a href="/gostd/net/dnsclient_unix_test.go.html#6644000">server</a></span><span class="op" id="6644097">,</span>&nbsp;<span class="ident" id="6644099"><a href="/gostd/net/dnsclient_unix_test.go.html#6644031">tt</a></span><span class="op" id="6644101">.</span><span class="ident" id="6644102"><a href="/gostd/net/dnsclient_unix_test.go.html#6643244">name</a></span><span class="op" id="6644106">,</span>&nbsp;<span class="ident" id="6644108"><a href="/gostd/net/dnsclient_unix_test.go.html#6644031">tt</a></span><span class="op" id="6644110">.</span><span class="ident" id="6644111"><a href="/gostd/net/dnsclient_unix_test.go.html#6643258">qtype</a></span><span class="op" id="6644116">,</span>&nbsp;<span class="num" id="6644118">0</span><span class="op" id="6644119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6644123">if</span>&nbsp;<span class="ident" id="6644126"><a href="/gostd/net/dnsclient_unix_test.go.html#6644075">err</a></span>&nbsp;<span class="op" id="6644130">!=</span>&nbsp;<span class="builtintype" id="6644133">nil</span>&nbsp;<span class="op" id="6644137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644142"><a href="/gostd/net/dnsclient_unix_test.go.html#6643887">t</a></span><span class="op" id="6644143">.</span><span class="ident" id="6644144"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="6644149">(</span><span class="ident" id="6644150"><a href="/gostd/net/dnsclient_unix_test.go.html#6644075">err</a></span><span class="op" id="6644153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6644158">continue</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6644169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6644173">switch</span>&nbsp;<span class="ident" id="6644180"><a href="/gostd/net/dnsclient_unix_test.go.html#6644070">msg</a></span><span class="op" id="6644183">.</span><span class="ident" id="6644184"><a href="/gostd/net/dnsmsg.go.html#3245438">rcode</a></span>&nbsp;<span class="op" id="6644190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6644194">case</span>&nbsp;<span class="ident" id="6644199"><a href="/gostd/net/dnsclient_unix_test.go.html#6644031">tt</a></span><span class="op" id="6644201">.</span><span class="ident" id="6644202"><a href="/gostd/net/dnsclient_unix_test.go.html#6643272">rcode</a></span><span class="op" id="6644207">,</span>&nbsp;<span class="ident" id="6644209"><a href="/gostd/net/dnsmsg.go.html#3229439">dnsRcodeServerFailure</a></span><span class="op" id="6644230">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6644234">default</span><span class="op" id="6644241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644246"><a href="/gostd/net/dnsclient_unix_test.go.html#6643887">t</a></span><span class="op" id="6644247">.</span><span class="ident" id="6644248"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6644254">(</span><span class="string" id="6644255">&#34;got&nbsp;%v&nbsp;from&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6644280">,</span>&nbsp;<span class="ident" id="6644282"><a href="/gostd/net/dnsclient_unix_test.go.html#6644070">msg</a></span><span class="op" id="6644285">.</span><span class="ident" id="6644286"><a href="/gostd/net/dnsmsg.go.html#3245438">rcode</a></span><span class="op" id="6644291">,</span>&nbsp;<span class="ident" id="6644293"><a href="/gostd/net/dnsclient_unix_test.go.html#6644000">server</a></span><span class="op" id="6644299">,</span>&nbsp;<span class="ident" id="6644301"><a href="/gostd/net/dnsclient_unix_test.go.html#6644031">tt</a></span><span class="op" id="6644303">.</span><span class="ident" id="6644304"><a href="/gostd/net/dnsclient_unix_test.go.html#6643272">rcode</a></span><span class="op" id="6644309">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6644314">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6644325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6644328">}</span><br>
<span class="lineno"></span><span class="op" id="6644330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="6644333">type</span>&nbsp;<span class="ident" id="6644338">resolvConfTest</span>&nbsp;<span class="keyword" id="6644353">struct</span>&nbsp;<span class="op" id="6644360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6644363">*</span><span class="ident" id="6644364"><a href="/gostd/net/dnsclient_unix_test.go.html#6642242">testing</a></span><span class="op" id="6644371">.</span><span class="ident" id="6644372"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644375">dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6644383">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644391">path</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6644399">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644407">started</span>&nbsp;<span class="builtintype" id="6644415">bool</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644421">quitc</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="6644429">chan</span>&nbsp;<span class="keyword" id="6644434">chan</span>&nbsp;<span class="keyword" id="6644439">struct</span><span class="op" id="6644445">{</span><span class="op" id="6644446">}</span><br>
<span class="lineno"></span><span class="op" id="6644448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6644451">func</span>&nbsp;<span class="ident" id="6644456">newResolvConfTest</span><span class="op" id="6644473">(</span><span class="ident" id="6644474">t</span>&nbsp;<span class="op" id="6644476">*</span><span class="ident" id="6644477"><a href="/gostd/net/dnsclient_unix_test.go.html#6642242">testing</a></span><span class="op" id="6644484">.</span><span class="ident" id="6644485"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6644486">)</span>&nbsp;<span class="op" id="6644488">*</span><span class="ident" id="6644489"><a href="/gostd/net/dnsclient_unix_test.go.html#6644338">resolvConfTest</a></span>&nbsp;<span class="op" id="6644504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644507">dir</span><span class="op" id="6644510">,</span>&nbsp;<span class="ident" id="6644512">err</span>&nbsp;<span class="op" id="6644516">:=</span>&nbsp;<span class="ident" id="6644519"><a href="/gostd/net/dnsclient_unix_test.go.html#6642204">ioutil</a></span><span class="op" id="6644525">.</span><span class="ident" id="6644526"><a href="/gostd/io/ioutil/tempfile.go.html#3770600">TempDir</a></span><span class="op" id="6644533">(</span><span class="string" id="6644534">&#34;&#34;</span><span class="op" id="6644536">,</span>&nbsp;<span class="string" id="6644538">&#34;resolvConfTest&#34;</span><span class="op" id="6644554">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6644557">if</span>&nbsp;<span class="ident" id="6644560"><a href="/gostd/net/dnsclient_unix_test.go.html#6644512">err</a></span>&nbsp;<span class="op" id="6644564">!=</span>&nbsp;<span class="builtintype" id="6644567">nil</span>&nbsp;<span class="op" id="6644571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644575"><a href="/gostd/net/dnsclient_unix_test.go.html#6644474">t</a></span><span class="op" id="6644576">.</span><span class="ident" id="6644577"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6644583">(</span><span class="string" id="6644584">&#34;could&nbsp;not&nbsp;create&nbsp;temp&nbsp;dir:&nbsp;%v&#34;</span><span class="op" id="6644615">,</span>&nbsp;<span class="ident" id="6644617"><a href="/gostd/net/dnsclient_unix_test.go.html#6644512">err</a></span><span class="op" id="6644620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6644623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6644627">//&nbsp;Disable&nbsp;the&nbsp;default&nbsp;loadConfig</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644662"><a href="/gostd/net/dnsclient_unix.go.html#3220069">onceLoadConfig</a></span><span class="op" id="6644676">.</span><span class="ident" id="6644677"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="6644679">(</span><span class="keyword" id="6644680">func</span><span class="op" id="6644684">(</span><span class="op" id="6644685">)</span>&nbsp;<span class="op" id="6644687">{</span><span class="op" id="6644688">}</span><span class="op" id="6644689">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644693">r</span>&nbsp;<span class="op" id="6644695">:=</span>&nbsp;<span class="op" id="6644698">&amp;</span><span class="ident" id="6644699"><a href="/gostd/net/dnsclient_unix_test.go.html#6644338">resolvConfTest</a></span><span class="op" id="6644713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644717"><a href="/gostd/net/dnsclient_unix_test.go.html#6644363">T</a></span><span class="op" id="6644718">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644724"><a href="/gostd/net/dnsclient_unix_test.go.html#6644474">t</a></span><span class="op" id="6644725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644729"><a href="/gostd/net/dnsclient_unix_test.go.html#6644375">dir</a></span><span class="op" id="6644732">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6644736"><a href="/gostd/net/dnsclient_unix_test.go.html#6644507">dir</a></span><span class="op" id="6644739">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644743"><a href="/gostd/net/dnsclient_unix_test.go.html#6644391">path</a></span><span class="op" id="6644747">:</span>&nbsp;&nbsp;<span class="ident" id="6644750"><a href="/gostd/net/dnsclient_unix_test.go.html#6642223">path</a></span><span class="op" id="6644754">.</span><span class="ident" id="6644755"><a href="/gostd/path/path.go.html#3923957">Join</a></span><span class="op" id="6644759">(</span><span class="ident" id="6644760"><a href="/gostd/net/dnsclient_unix_test.go.html#6644507">dir</a></span><span class="op" id="6644763">,</span>&nbsp;<span class="string" id="6644765">&#34;resolv.conf&#34;</span><span class="op" id="6644778">)</span><span class="op" id="6644779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644783"><a href="/gostd/net/dnsclient_unix_test.go.html#6644421">quitc</a></span><span class="op" id="6644788">:</span>&nbsp;<span class="builtinfunc" id="6644790">make</span><span class="op" id="6644794">(</span><span class="keyword" id="6644795">chan</span>&nbsp;<span class="keyword" id="6644800">chan</span>&nbsp;<span class="keyword" id="6644805">struct</span><span class="op" id="6644811">{</span><span class="op" id="6644812">}</span><span class="op" id="6644813">)</span><span class="op" id="6644814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6644817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6644821">return</span>&nbsp;<span class="ident" id="6644828"><a href="/gostd/net/dnsclient_unix_test.go.html#6644693">r</a></span><br>
<span class="lineno">120</span><span class="op" id="6644830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6644833">func</span>&nbsp;<span class="op" id="6644838">(</span><span class="ident" id="6644839">r</span>&nbsp;<span class="op" id="6644841">*</span><span class="ident" id="6644842"><a href="/gostd/net/dnsclient_unix_test.go.html#6644338">resolvConfTest</a></span><span class="op" id="6644856">)</span>&nbsp;<span class="ident" id="6644858">Start</span><span class="op" id="6644863">(</span><span class="op" id="6644864">)</span>&nbsp;<span class="op" id="6644866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644869"><a href="/gostd/net/dnsclient_unix.go.html#3220233">loadConfig</a></span><span class="op" id="6644879">(</span><span class="ident" id="6644880"><a href="/gostd/net/dnsclient_unix_test.go.html#6644839">r</a></span><span class="op" id="6644881">.</span><span class="ident" id="6644882"><a href="/gostd/net/dnsclient_unix_test.go.html#6644391">path</a></span><span class="op" id="6644886">,</span>&nbsp;<span class="num" id="6644888">100</span><span class="op" id="6644891">*</span><span class="ident" id="6644892"><a href="/gostd/net/dnsclient_unix_test.go.html#6642253">time</a></span><span class="op" id="6644896">.</span><span class="ident" id="6644897"><a href="/gostd/time/time.go.html#2734819">Millisecond</a></span><span class="op" id="6644908">,</span>&nbsp;<span class="ident" id="6644910"><a href="/gostd/net/dnsclient_unix_test.go.html#6644839">r</a></span><span class="op" id="6644911">.</span><span class="ident" id="6644912"><a href="/gostd/net/dnsclient_unix_test.go.html#6644421">quitc</a></span><span class="op" id="6644917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644920"><a href="/gostd/net/dnsclient_unix_test.go.html#6644839">r</a></span><span class="op" id="6644921">.</span><span class="ident" id="6644922"><a href="/gostd/net/dnsclient_unix_test.go.html#6644407">started</a></span>&nbsp;<span class="op" id="6644930">=</span>&nbsp;<span class="builtintype" id="6644932">true</span><br>
<span class="lineno">125</span><span class="op" id="6644937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6644940">func</span>&nbsp;<span class="op" id="6644945">(</span><span class="ident" id="6644946">r</span>&nbsp;<span class="op" id="6644948">*</span><span class="ident" id="6644949"><a href="/gostd/net/dnsclient_unix_test.go.html#6644338">resolvConfTest</a></span><span class="op" id="6644963">)</span>&nbsp;<span class="ident" id="6644965">SetConf</span><span class="op" id="6644972">(</span><span class="ident" id="6644973">s</span>&nbsp;<span class="builtintype" id="6644975">string</span><span class="op" id="6644981">)</span>&nbsp;<span class="op" id="6644983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6644986">//&nbsp;Make&nbsp;sure&nbsp;the&nbsp;file&nbsp;mtime&nbsp;will&nbsp;be&nbsp;different&nbsp;once&nbsp;we&#39;re&nbsp;done&nbsp;here,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6645055">//&nbsp;even&nbsp;on&nbsp;systems&nbsp;with&nbsp;coarse&nbsp;(1s)&nbsp;mtime&nbsp;resolution.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645110"><a href="/gostd/net/dnsclient_unix_test.go.html#6642253">time</a></span><span class="op" id="6645114">.</span><span class="ident" id="6645115"><a href="/gostd/time/sleep.go.html#2713940">Sleep</a></span><span class="op" id="6645120">(</span><span class="ident" id="6645121"><a href="/gostd/net/dnsclient_unix_test.go.html#6642253">time</a></span><span class="op" id="6645125">.</span><span class="ident" id="6645126"><a href="/gostd/time/time.go.html#2734862">Second</a></span><span class="op" id="6645132">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645136">f</span><span class="op" id="6645137">,</span>&nbsp;<span class="ident" id="6645139">err</span>&nbsp;<span class="op" id="6645143">:=</span>&nbsp;<span class="ident" id="6645146"><a href="/gostd/net/dnsclient_unix_test.go.html#6642217">os</a></span><span class="op" id="6645148">.</span><span class="ident" id="6645149"><a href="/gostd/os/file_unix.go.html#2454095">OpenFile</a></span><span class="op" id="6645157">(</span><span class="ident" id="6645158"><a href="/gostd/net/dnsclient_unix_test.go.html#6644946">r</a></span><span class="op" id="6645159">.</span><span class="ident" id="6645160"><a href="/gostd/net/dnsclient_unix_test.go.html#6644391">path</a></span><span class="op" id="6645164">,</span>&nbsp;<span class="ident" id="6645166"><a href="/gostd/net/dnsclient_unix_test.go.html#6642217">os</a></span><span class="op" id="6645168">.</span><span class="ident" id="6645169"><a href="/gostd/os/file.go.html#2442313">O_CREATE</a></span><span class="op" id="6645177">|</span><span class="ident" id="6645178"><a href="/gostd/net/dnsclient_unix_test.go.html#6642217">os</a></span><span class="op" id="6645180">.</span><span class="ident" id="6645181"><a href="/gostd/os/file.go.html#2442521">O_TRUNC</a></span><span class="op" id="6645188">|</span><span class="ident" id="6645189"><a href="/gostd/net/dnsclient_unix_test.go.html#6642217">os</a></span><span class="op" id="6645191">.</span><span class="ident" id="6645192"><a href="/gostd/os/file.go.html#2442115">O_WRONLY</a></span><span class="op" id="6645200">,</span>&nbsp;<span class="num" id="6645202">0600</span><span class="op" id="6645206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6645209">if</span>&nbsp;<span class="ident" id="6645212"><a href="/gostd/net/dnsclient_unix_test.go.html#6645139">err</a></span>&nbsp;<span class="op" id="6645216">!=</span>&nbsp;<span class="builtintype" id="6645219">nil</span>&nbsp;<span class="op" id="6645223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645227"><a href="/gostd/net/dnsclient_unix_test.go.html#6644946">r</a></span><span class="op" id="6645228">.</span><span class="ident" id="6645229"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6645235">(</span><span class="string" id="6645236">&#34;failed&nbsp;to&nbsp;create&nbsp;temp&nbsp;file&nbsp;%s:&nbsp;%v&#34;</span><span class="op" id="6645271">,</span>&nbsp;<span class="ident" id="6645273"><a href="/gostd/net/dnsclient_unix_test.go.html#6644946">r</a></span><span class="op" id="6645274">.</span><span class="ident" id="6645275"><a href="/gostd/net/dnsclient_unix_test.go.html#6644391">path</a></span><span class="op" id="6645279">,</span>&nbsp;<span class="ident" id="6645281"><a href="/gostd/net/dnsclient_unix_test.go.html#6645139">err</a></span><span class="op" id="6645284">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6645287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6645290">if</span>&nbsp;<span class="ident" id="6645293">_</span><span class="op" id="6645294">,</span>&nbsp;<span class="ident" id="6645296">err</span>&nbsp;<span class="op" id="6645300">:=</span>&nbsp;<span class="ident" id="6645303"><a href="/gostd/net/dnsclient_unix_test.go.html#6642198">io</a></span><span class="op" id="6645305">.</span><span class="ident" id="6645306"><a href="/gostd/io/io.go.html#1428475">WriteString</a></span><span class="op" id="6645317">(</span><span class="ident" id="6645318"><a href="/gostd/net/dnsclient_unix_test.go.html#6645136">f</a></span><span class="op" id="6645319">,</span>&nbsp;<span class="ident" id="6645321"><a href="/gostd/net/dnsclient_unix_test.go.html#6644973">s</a></span><span class="op" id="6645322">)</span><span class="op" id="6645323">;</span>&nbsp;<span class="ident" id="6645325"><a href="/gostd/net/dnsclient_unix_test.go.html#6645296">err</a></span>&nbsp;<span class="op" id="6645329">!=</span>&nbsp;<span class="builtintype" id="6645332">nil</span>&nbsp;<span class="op" id="6645336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645340"><a href="/gostd/net/dnsclient_unix_test.go.html#6645136">f</a></span><span class="op" id="6645341">.</span><span class="ident" id="6645342"><a href="/gostd/os/file_unix.go.html#2454611">Close</a></span><span class="op" id="6645347">(</span><span class="op" id="6645348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645352"><a href="/gostd/net/dnsclient_unix_test.go.html#6644946">r</a></span><span class="op" id="6645353">.</span><span class="ident" id="6645354"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6645360">(</span><span class="string" id="6645361">&#34;failed&nbsp;to&nbsp;write&nbsp;temp&nbsp;file:&nbsp;%v&#34;</span><span class="op" id="6645392">,</span>&nbsp;<span class="ident" id="6645394"><a href="/gostd/net/dnsclient_unix_test.go.html#6645296">err</a></span><span class="op" id="6645397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6645400">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645403"><a href="/gostd/net/dnsclient_unix_test.go.html#6645136">f</a></span><span class="op" id="6645404">.</span><span class="ident" id="6645405"><a href="/gostd/os/file_unix.go.html#2454611">Close</a></span><span class="op" id="6645410">(</span><span class="op" id="6645411">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6645415">if</span>&nbsp;<span class="ident" id="6645418"><a href="/gostd/net/dnsclient_unix_test.go.html#6644946">r</a></span><span class="op" id="6645419">.</span><span class="ident" id="6645420"><a href="/gostd/net/dnsclient_unix_test.go.html#6644407">started</a></span>&nbsp;<span class="op" id="6645428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645432"><a href="/gostd/net/dnsclient_unix.go.html#3219929">cfg</a></span><span class="op" id="6645435">.</span><span class="ident" id="6645436"><a href="/gostd/net/dnsclient_unix.go.html#3219943">ch</a></span>&nbsp;<span class="op" id="6645439">&lt;-</span>&nbsp;<span class="keyword" id="6645442">struct</span><span class="op" id="6645448">{</span><span class="op" id="6645449">}</span><span class="op" id="6645450">{</span><span class="op" id="6645451">}</span>&nbsp;<span class="comment" id="6645453">//&nbsp;fill&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645470"><a href="/gostd/net/dnsclient_unix.go.html#3219929">cfg</a></span><span class="op" id="6645473">.</span><span class="ident" id="6645474"><a href="/gostd/net/dnsclient_unix.go.html#3219943">ch</a></span>&nbsp;<span class="op" id="6645477">&lt;-</span>&nbsp;<span class="keyword" id="6645480">struct</span><span class="op" id="6645486">{</span><span class="op" id="6645487">}</span><span class="op" id="6645488">{</span><span class="op" id="6645489">}</span>&nbsp;<span class="comment" id="6645491">//&nbsp;wait&nbsp;for&nbsp;reload&nbsp;to&nbsp;begin</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645521"><a href="/gostd/net/dnsclient_unix.go.html#3219929">cfg</a></span><span class="op" id="6645524">.</span><span class="ident" id="6645525"><a href="/gostd/net/dnsclient_unix.go.html#3219943">ch</a></span>&nbsp;<span class="op" id="6645528">&lt;-</span>&nbsp;<span class="keyword" id="6645531">struct</span><span class="op" id="6645537">{</span><span class="op" id="6645538">}</span><span class="op" id="6645539">{</span><span class="op" id="6645540">}</span>&nbsp;<span class="comment" id="6645542">//&nbsp;wait&nbsp;for&nbsp;reload&nbsp;to&nbsp;complete</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6645574">}</span><br>
<span class="lineno"></span><span class="op" id="6645576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6645579">func</span>&nbsp;<span class="op" id="6645584">(</span><span class="ident" id="6645585">r</span>&nbsp;<span class="op" id="6645587">*</span><span class="ident" id="6645588"><a href="/gostd/net/dnsclient_unix_test.go.html#6644338">resolvConfTest</a></span><span class="op" id="6645602">)</span>&nbsp;<span class="ident" id="6645604">WantServers</span><span class="op" id="6645615">(</span><span class="ident" id="6645616">want</span>&nbsp;<span class="op" id="6645621">[</span><span class="op" id="6645622">]</span><span class="builtintype" id="6645623">string</span><span class="op" id="6645629">)</span>&nbsp;<span class="op" id="6645631">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645634"><a href="/gostd/net/dnsclient_unix.go.html#3219929">cfg</a></span><span class="op" id="6645637">.</span><span class="ident" id="6645638"><a href="/gostd/net/dnsclient_unix.go.html#3219968">mu</a></span><span class="op" id="6645640">.</span><span class="ident" id="6645641"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="6645646">(</span><span class="op" id="6645647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6645650">defer</span>&nbsp;<span class="ident" id="6645656"><a href="/gostd/net/dnsclient_unix.go.html#3219929">cfg</a></span><span class="op" id="6645659">.</span><span class="ident" id="6645660"><a href="/gostd/net/dnsclient_unix.go.html#3219968">mu</a></span><span class="op" id="6645662">.</span><span class="ident" id="6645663"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="6645670">(</span><span class="op" id="6645671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6645674">if</span>&nbsp;<span class="ident" id="6645677">got</span>&nbsp;<span class="op" id="6645681">:=</span>&nbsp;<span class="ident" id="6645684"><a href="/gostd/net/dnsclient_unix.go.html#3219929">cfg</a></span><span class="op" id="6645687">.</span><span class="ident" id="6645688"><a href="/gostd/net/dnsclient_unix.go.html#3220025">dnsConfig</a></span><span class="op" id="6645697">.</span><span class="ident" id="6645698"><a href="/gostd/net/dnsconfig_unix.go.html#3225551">servers</a></span><span class="op" id="6645705">;</span>&nbsp;<span class="op" id="6645707">!</span><span class="ident" id="6645708"><a href="/gostd/net/dnsclient_unix_test.go.html#6642231">reflect</a></span><span class="op" id="6645715">.</span><span class="ident" id="6645716"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="6645725">(</span><span class="ident" id="6645726"><a href="/gostd/net/dnsclient_unix_test.go.html#6645677">got</a></span><span class="op" id="6645729">,</span>&nbsp;<span class="ident" id="6645731"><a href="/gostd/net/dnsclient_unix_test.go.html#6645616">want</a></span><span class="op" id="6645735">)</span>&nbsp;<span class="op" id="6645737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645741"><a href="/gostd/net/dnsclient_unix_test.go.html#6645585">r</a></span><span class="op" id="6645742">.</span><span class="ident" id="6645743"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6645749">(</span><span class="string" id="6645750">&#34;Unexpected&nbsp;dns&nbsp;server&nbsp;loaded,&nbsp;got&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6645796">,</span>&nbsp;<span class="ident" id="6645798"><a href="/gostd/net/dnsclient_unix_test.go.html#6645677">got</a></span><span class="op" id="6645801">,</span>&nbsp;<span class="ident" id="6645803"><a href="/gostd/net/dnsclient_unix_test.go.html#6645616">want</a></span><span class="op" id="6645807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6645810">}</span><br>
<span class="lineno">155</span><span class="op" id="6645812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6645815">func</span>&nbsp;<span class="op" id="6645820">(</span><span class="ident" id="6645821">r</span>&nbsp;<span class="op" id="6645823">*</span><span class="ident" id="6645824"><a href="/gostd/net/dnsclient_unix_test.go.html#6644338">resolvConfTest</a></span><span class="op" id="6645838">)</span>&nbsp;<span class="ident" id="6645840">Close</span><span class="op" id="6645845">(</span><span class="op" id="6645846">)</span>&nbsp;<span class="op" id="6645848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645851">resp</span>&nbsp;<span class="op" id="6645856">:=</span>&nbsp;<span class="builtinfunc" id="6645859">make</span><span class="op" id="6645863">(</span><span class="keyword" id="6645864">chan</span>&nbsp;<span class="keyword" id="6645869">struct</span><span class="op" id="6645875">{</span><span class="op" id="6645876">}</span><span class="op" id="6645877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645880"><a href="/gostd/net/dnsclient_unix_test.go.html#6645821">r</a></span><span class="op" id="6645881">.</span><span class="ident" id="6645882"><a href="/gostd/net/dnsclient_unix_test.go.html#6644421">quitc</a></span>&nbsp;<span class="op" id="6645888">&lt;-</span>&nbsp;<span class="ident" id="6645891"><a href="/gostd/net/dnsclient_unix_test.go.html#6645851">resp</a></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6645897">&lt;-</span><span class="ident" id="6645899"><a href="/gostd/net/dnsclient_unix_test.go.html#6645851">resp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6645905">if</span>&nbsp;<span class="ident" id="6645908">err</span>&nbsp;<span class="op" id="6645912">:=</span>&nbsp;<span class="ident" id="6645915"><a href="/gostd/net/dnsclient_unix_test.go.html#6642217">os</a></span><span class="op" id="6645917">.</span><span class="ident" id="6645918"><a href="/gostd/os/path.go.html#2465635">RemoveAll</a></span><span class="op" id="6645927">(</span><span class="ident" id="6645928"><a href="/gostd/net/dnsclient_unix_test.go.html#6645821">r</a></span><span class="op" id="6645929">.</span><span class="ident" id="6645930"><a href="/gostd/net/dnsclient_unix_test.go.html#6644375">dir</a></span><span class="op" id="6645933">)</span><span class="op" id="6645934">;</span>&nbsp;<span class="ident" id="6645936"><a href="/gostd/net/dnsclient_unix_test.go.html#6645908">err</a></span>&nbsp;<span class="op" id="6645940">!=</span>&nbsp;<span class="builtintype" id="6645943">nil</span>&nbsp;<span class="op" id="6645947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645951"><a href="/gostd/net/dnsclient_unix_test.go.html#6645821">r</a></span><span class="op" id="6645952">.</span><span class="ident" id="6645953"><a href="/gostd/testing/testing.go.html#5479816">Logf</a></span><span class="op" id="6645957">(</span><span class="string" id="6645958">&#34;failed&nbsp;to&nbsp;remove&nbsp;temp&nbsp;dir&nbsp;%s:&nbsp;%v&#34;</span><span class="op" id="6645992">,</span>&nbsp;<span class="ident" id="6645994"><a href="/gostd/net/dnsclient_unix_test.go.html#6645821">r</a></span><span class="op" id="6645995">.</span><span class="ident" id="6645996"><a href="/gostd/net/dnsclient_unix_test.go.html#6644375">dir</a></span><span class="op" id="6645999">,</span>&nbsp;<span class="ident" id="6646001"><a href="/gostd/net/dnsclient_unix_test.go.html#6645908">err</a></span><span class="op" id="6646004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646007">}</span><br>
<span class="lineno"></span><span class="op" id="6646009">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="6646012">func</span>&nbsp;<span class="ident" id="6646017">TestReloadResolvConfFail</span><span class="op" id="6646041">(</span><span class="ident" id="6646042">t</span>&nbsp;<span class="op" id="6646044">*</span><span class="ident" id="6646045"><a href="/gostd/net/dnsclient_unix_test.go.html#6642242">testing</a></span><span class="op" id="6646052">.</span><span class="ident" id="6646053"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6646054">)</span>&nbsp;<span class="op" id="6646056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646059">if</span>&nbsp;<span class="ident" id="6646062"><a href="/gostd/net/dnsclient_unix_test.go.html#6642242">testing</a></span><span class="op" id="6646069">.</span><span class="ident" id="6646070"><a href="/gostd/testing/testing.go.html#5475359">Short</a></span><span class="op" id="6646075">(</span><span class="op" id="6646076">)</span>&nbsp;<span class="op" id="6646078">||</span>&nbsp;<span class="op" id="6646081">!</span><span class="op" id="6646082">*</span><span class="ident" id="6646083"><a href="/gostd/net/lookup_test.go.html#6707430">testExternal</a></span>&nbsp;<span class="op" id="6646096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646100"><a href="/gostd/net/dnsclient_unix_test.go.html#6646042">t</a></span><span class="op" id="6646101">.</span><span class="ident" id="6646102"><a href="/gostd/testing/testing.go.html#5480575">Skip</a></span><span class="op" id="6646106">(</span><span class="string" id="6646107">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6646148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646151">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646155">r</span>&nbsp;<span class="op" id="6646157">:=</span>&nbsp;<span class="ident" id="6646160"><a href="/gostd/net/dnsclient_unix_test.go.html#6644456">newResolvConfTest</a></span><span class="op" id="6646177">(</span><span class="ident" id="6646178"><a href="/gostd/net/dnsclient_unix_test.go.html#6646042">t</a></span><span class="op" id="6646179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646182">defer</span>&nbsp;<span class="ident" id="6646188"><a href="/gostd/net/dnsclient_unix_test.go.html#6646155">r</a></span><span class="op" id="6646189">.</span><span class="ident" id="6646190"><a href="/gostd/net/dnsclient_unix_test.go.html#6645840">Close</a></span><span class="op" id="6646195">(</span><span class="op" id="6646196">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6646200">//&nbsp;resolv.conf.tmp&nbsp;does&nbsp;not&nbsp;exist&nbsp;yet</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646239"><a href="/gostd/net/dnsclient_unix_test.go.html#6646155">r</a></span><span class="op" id="6646240">.</span><span class="ident" id="6646241"><a href="/gostd/net/dnsclient_unix_test.go.html#6644858">Start</a></span><span class="op" id="6646246">(</span><span class="op" id="6646247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646250">if</span>&nbsp;<span class="ident" id="6646253">_</span><span class="op" id="6646254">,</span>&nbsp;<span class="ident" id="6646256">err</span>&nbsp;<span class="op" id="6646260">:=</span>&nbsp;<span class="ident" id="6646263"><a href="/gostd/net/dnsclient_unix.go.html#3223765">goLookupIP</a></span><span class="op" id="6646273">(</span><span class="string" id="6646274">&#34;golang.org&#34;</span><span class="op" id="6646286">)</span><span class="op" id="6646287">;</span>&nbsp;<span class="ident" id="6646289"><a href="/gostd/net/dnsclient_unix_test.go.html#6646256">err</a></span>&nbsp;<span class="op" id="6646293">==</span>&nbsp;<span class="builtintype" id="6646296">nil</span>&nbsp;<span class="op" id="6646300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646304"><a href="/gostd/net/dnsclient_unix_test.go.html#6646042">t</a></span><span class="op" id="6646305">.</span><span class="ident" id="6646306"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="6646311">(</span><span class="string" id="6646312">&#34;goLookupIP(missing)&nbsp;succeeded&#34;</span><span class="op" id="6646343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646350"><a href="/gostd/net/dnsclient_unix_test.go.html#6646155">r</a></span><span class="op" id="6646351">.</span><span class="ident" id="6646352"><a href="/gostd/net/dnsclient_unix_test.go.html#6644965">SetConf</a></span><span class="op" id="6646359">(</span><span class="string" id="6646360">&#34;nameserver&nbsp;8.8.8.8&#34;</span><span class="op" id="6646380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646383">if</span>&nbsp;<span class="ident" id="6646386">_</span><span class="op" id="6646387">,</span>&nbsp;<span class="ident" id="6646389">err</span>&nbsp;<span class="op" id="6646393">:=</span>&nbsp;<span class="ident" id="6646396"><a href="/gostd/net/dnsclient_unix.go.html#3223765">goLookupIP</a></span><span class="op" id="6646406">(</span><span class="string" id="6646407">&#34;golang.org&#34;</span><span class="op" id="6646419">)</span><span class="op" id="6646420">;</span>&nbsp;<span class="ident" id="6646422"><a href="/gostd/net/dnsclient_unix_test.go.html#6646389">err</a></span>&nbsp;<span class="op" id="6646426">!=</span>&nbsp;<span class="builtintype" id="6646429">nil</span>&nbsp;<span class="op" id="6646433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646437"><a href="/gostd/net/dnsclient_unix_test.go.html#6646042">t</a></span><span class="op" id="6646438">.</span><span class="ident" id="6646439"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6646445">(</span><span class="string" id="6646446">&#34;goLookupIP(missing;&nbsp;good)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6646484">,</span>&nbsp;<span class="ident" id="6646486"><a href="/gostd/net/dnsclient_unix_test.go.html#6646389">err</a></span><span class="op" id="6646489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6646496">//&nbsp;Using&nbsp;a&nbsp;bad&nbsp;resolv.conf&nbsp;while&nbsp;we&nbsp;had&nbsp;a&nbsp;good</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6646544">//&nbsp;one&nbsp;before&nbsp;should&nbsp;not&nbsp;update&nbsp;the&nbsp;config</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646588"><a href="/gostd/net/dnsclient_unix_test.go.html#6646155">r</a></span><span class="op" id="6646589">.</span><span class="ident" id="6646590"><a href="/gostd/net/dnsclient_unix_test.go.html#6644965">SetConf</a></span><span class="op" id="6646597">(</span><span class="string" id="6646598">&#34;&#34;</span><span class="op" id="6646600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646603">if</span>&nbsp;<span class="ident" id="6646606">_</span><span class="op" id="6646607">,</span>&nbsp;<span class="ident" id="6646609">err</span>&nbsp;<span class="op" id="6646613">:=</span>&nbsp;<span class="ident" id="6646616"><a href="/gostd/net/dnsclient_unix.go.html#3223765">goLookupIP</a></span><span class="op" id="6646626">(</span><span class="string" id="6646627">&#34;golang.org&#34;</span><span class="op" id="6646639">)</span><span class="op" id="6646640">;</span>&nbsp;<span class="ident" id="6646642"><a href="/gostd/net/dnsclient_unix_test.go.html#6646609">err</a></span>&nbsp;<span class="op" id="6646646">!=</span>&nbsp;<span class="builtintype" id="6646649">nil</span>&nbsp;<span class="op" id="6646653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646657"><a href="/gostd/net/dnsclient_unix_test.go.html#6646042">t</a></span><span class="op" id="6646658">.</span><span class="ident" id="6646659"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6646665">(</span><span class="string" id="6646666">&#34;goLookupIP(missing;&nbsp;good;&nbsp;bad)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6646709">,</span>&nbsp;<span class="ident" id="6646711"><a href="/gostd/net/dnsclient_unix_test.go.html#6646609">err</a></span><span class="op" id="6646714">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646717">}</span><br>
<span class="lineno"></span><span class="op" id="6646719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6646722">func</span>&nbsp;<span class="ident" id="6646727">TestReloadResolvConfChange</span><span class="op" id="6646753">(</span><span class="ident" id="6646754">t</span>&nbsp;<span class="op" id="6646756">*</span><span class="ident" id="6646757"><a href="/gostd/net/dnsclient_unix_test.go.html#6642242">testing</a></span><span class="op" id="6646764">.</span><span class="ident" id="6646765"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6646766">)</span>&nbsp;<span class="op" id="6646768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646771">if</span>&nbsp;<span class="ident" id="6646774"><a href="/gostd/net/dnsclient_unix_test.go.html#6642242">testing</a></span><span class="op" id="6646781">.</span><span class="ident" id="6646782"><a href="/gostd/testing/testing.go.html#5475359">Short</a></span><span class="op" id="6646787">(</span><span class="op" id="6646788">)</span>&nbsp;<span class="op" id="6646790">||</span>&nbsp;<span class="op" id="6646793">!</span><span class="op" id="6646794">*</span><span class="ident" id="6646795"><a href="/gostd/net/lookup_test.go.html#6707430">testExternal</a></span>&nbsp;<span class="op" id="6646808">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646812"><a href="/gostd/net/dnsclient_unix_test.go.html#6646754">t</a></span><span class="op" id="6646813">.</span><span class="ident" id="6646814"><a href="/gostd/testing/testing.go.html#5480575">Skip</a></span><span class="op" id="6646818">(</span><span class="string" id="6646819">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6646860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646867">r</span>&nbsp;<span class="op" id="6646869">:=</span>&nbsp;<span class="ident" id="6646872"><a href="/gostd/net/dnsclient_unix_test.go.html#6644456">newResolvConfTest</a></span><span class="op" id="6646889">(</span><span class="ident" id="6646890"><a href="/gostd/net/dnsclient_unix_test.go.html#6646754">t</a></span><span class="op" id="6646891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646894">defer</span>&nbsp;<span class="ident" id="6646900"><a href="/gostd/net/dnsclient_unix_test.go.html#6646867">r</a></span><span class="op" id="6646901">.</span><span class="ident" id="6646902"><a href="/gostd/net/dnsclient_unix_test.go.html#6645840">Close</a></span><span class="op" id="6646907">(</span><span class="op" id="6646908">)</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646912"><a href="/gostd/net/dnsclient_unix_test.go.html#6646867">r</a></span><span class="op" id="6646913">.</span><span class="ident" id="6646914"><a href="/gostd/net/dnsclient_unix_test.go.html#6644965">SetConf</a></span><span class="op" id="6646921">(</span><span class="string" id="6646922">&#34;nameserver&nbsp;8.8.8.8&#34;</span><span class="op" id="6646942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646945"><a href="/gostd/net/dnsclient_unix_test.go.html#6646867">r</a></span><span class="op" id="6646946">.</span><span class="ident" id="6646947"><a href="/gostd/net/dnsclient_unix_test.go.html#6644858">Start</a></span><span class="op" id="6646952">(</span><span class="op" id="6646953">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646957">if</span>&nbsp;<span class="ident" id="6646960">_</span><span class="op" id="6646961">,</span>&nbsp;<span class="ident" id="6646963">err</span>&nbsp;<span class="op" id="6646967">:=</span>&nbsp;<span class="ident" id="6646970"><a href="/gostd/net/dnsclient_unix.go.html#3223765">goLookupIP</a></span><span class="op" id="6646980">(</span><span class="string" id="6646981">&#34;golang.org&#34;</span><span class="op" id="6646993">)</span><span class="op" id="6646994">;</span>&nbsp;<span class="ident" id="6646996"><a href="/gostd/net/dnsclient_unix_test.go.html#6646963">err</a></span>&nbsp;<span class="op" id="6647000">!=</span>&nbsp;<span class="builtintype" id="6647003">nil</span>&nbsp;<span class="op" id="6647007">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647011"><a href="/gostd/net/dnsclient_unix_test.go.html#6646754">t</a></span><span class="op" id="6647012">.</span><span class="ident" id="6647013"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6647019">(</span><span class="string" id="6647020">&#34;goLookupIP(good)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6647049">,</span>&nbsp;<span class="ident" id="6647051"><a href="/gostd/net/dnsclient_unix_test.go.html#6646963">err</a></span><span class="op" id="6647054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647060"><a href="/gostd/net/dnsclient_unix_test.go.html#6646867">r</a></span><span class="op" id="6647061">.</span><span class="ident" id="6647062"><a href="/gostd/net/dnsclient_unix_test.go.html#6645604">WantServers</a></span><span class="op" id="6647073">(</span><span class="op" id="6647074">[</span><span class="op" id="6647075">]</span><span class="builtintype" id="6647076">string</span><span class="op" id="6647082">{</span><span class="string" id="6647083">&#34;8.8.8.8&#34;</span><span class="op" id="6647092">}</span><span class="op" id="6647093">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6647097">//&nbsp;Using&nbsp;a&nbsp;bad&nbsp;resolv.conf&nbsp;when&nbsp;we&nbsp;had&nbsp;a&nbsp;good&nbsp;one</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6647148">//&nbsp;before&nbsp;should&nbsp;not&nbsp;update&nbsp;the&nbsp;config</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647188"><a href="/gostd/net/dnsclient_unix_test.go.html#6646867">r</a></span><span class="op" id="6647189">.</span><span class="ident" id="6647190"><a href="/gostd/net/dnsclient_unix_test.go.html#6644965">SetConf</a></span><span class="op" id="6647197">(</span><span class="string" id="6647198">&#34;&#34;</span><span class="op" id="6647200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647203">if</span>&nbsp;<span class="ident" id="6647206">_</span><span class="op" id="6647207">,</span>&nbsp;<span class="ident" id="6647209">err</span>&nbsp;<span class="op" id="6647213">:=</span>&nbsp;<span class="ident" id="6647216"><a href="/gostd/net/dnsclient_unix.go.html#3223765">goLookupIP</a></span><span class="op" id="6647226">(</span><span class="string" id="6647227">&#34;golang.org&#34;</span><span class="op" id="6647239">)</span><span class="op" id="6647240">;</span>&nbsp;<span class="ident" id="6647242"><a href="/gostd/net/dnsclient_unix_test.go.html#6647209">err</a></span>&nbsp;<span class="op" id="6647246">!=</span>&nbsp;<span class="builtintype" id="6647249">nil</span>&nbsp;<span class="op" id="6647253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647257"><a href="/gostd/net/dnsclient_unix_test.go.html#6646754">t</a></span><span class="op" id="6647258">.</span><span class="ident" id="6647259"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6647265">(</span><span class="string" id="6647266">&#34;goLookupIP(good;&nbsp;bad)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6647300">,</span>&nbsp;<span class="ident" id="6647302"><a href="/gostd/net/dnsclient_unix_test.go.html#6647209">err</a></span><span class="op" id="6647305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647308">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6647312">//&nbsp;A&nbsp;new&nbsp;good&nbsp;config&nbsp;should&nbsp;get&nbsp;picked&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647355"><a href="/gostd/net/dnsclient_unix_test.go.html#6646867">r</a></span><span class="op" id="6647356">.</span><span class="ident" id="6647357"><a href="/gostd/net/dnsclient_unix_test.go.html#6644965">SetConf</a></span><span class="op" id="6647364">(</span><span class="string" id="6647365">&#34;nameserver&nbsp;8.8.4.4&#34;</span><span class="op" id="6647385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647388"><a href="/gostd/net/dnsclient_unix_test.go.html#6646867">r</a></span><span class="op" id="6647389">.</span><span class="ident" id="6647390"><a href="/gostd/net/dnsclient_unix_test.go.html#6645604">WantServers</a></span><span class="op" id="6647401">(</span><span class="op" id="6647402">[</span><span class="op" id="6647403">]</span><span class="builtintype" id="6647404">string</span><span class="op" id="6647410">{</span><span class="string" id="6647411">&#34;8.8.4.4&#34;</span><span class="op" id="6647420">}</span><span class="op" id="6647421">)</span><br>
<span class="lineno"></span><span class="op" id="6647423">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="6647426">func</span>&nbsp;<span class="ident" id="6647431">BenchmarkGoLookupIP</span><span class="op" id="6647450">(</span><span class="ident" id="6647451">b</span>&nbsp;<span class="op" id="6647453">*</span><span class="ident" id="6647454"><a href="/gostd/net/dnsclient_unix_test.go.html#6642242">testing</a></span><span class="op" id="6647461">.</span><span class="ident" id="6647462"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="6647463">)</span>&nbsp;<span class="op" id="6647465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647468">for</span>&nbsp;<span class="ident" id="6647472">i</span>&nbsp;<span class="op" id="6647474">:=</span>&nbsp;<span class="num" id="6647477">0</span><span class="op" id="6647478">;</span>&nbsp;<span class="ident" id="6647480"><a href="/gostd/net/dnsclient_unix_test.go.html#6647472">i</a></span>&nbsp;<span class="op" id="6647482">&lt;</span>&nbsp;<span class="ident" id="6647484"><a href="/gostd/net/dnsclient_unix_test.go.html#6647451">b</a></span><span class="op" id="6647485">.</span><span class="ident" id="6647486"><a href="/gostd/testing/benchmark.go.html#5450983">N</a></span><span class="op" id="6647487">;</span>&nbsp;<span class="ident" id="6647489"><a href="/gostd/net/dnsclient_unix_test.go.html#6647472">i</a></span><span class="op" id="6647490">++</span>&nbsp;<span class="op" id="6647493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647497"><a href="/gostd/net/dnsclient_unix.go.html#3223765">goLookupIP</a></span><span class="op" id="6647507">(</span><span class="string" id="6647508">&#34;www.example.com&#34;</span><span class="op" id="6647525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647528">}</span><br>
<span class="lineno">225</span><span class="op" id="6647530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6647533">func</span>&nbsp;<span class="ident" id="6647538">BenchmarkGoLookupIPNoSuchHost</span><span class="op" id="6647567">(</span><span class="ident" id="6647568">b</span>&nbsp;<span class="op" id="6647570">*</span><span class="ident" id="6647571"><a href="/gostd/net/dnsclient_unix_test.go.html#6642242">testing</a></span><span class="op" id="6647578">.</span><span class="ident" id="6647579"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="6647580">)</span>&nbsp;<span class="op" id="6647582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647585">for</span>&nbsp;<span class="ident" id="6647589">i</span>&nbsp;<span class="op" id="6647591">:=</span>&nbsp;<span class="num" id="6647594">0</span><span class="op" id="6647595">;</span>&nbsp;<span class="ident" id="6647597"><a href="/gostd/net/dnsclient_unix_test.go.html#6647589">i</a></span>&nbsp;<span class="op" id="6647599">&lt;</span>&nbsp;<span class="ident" id="6647601"><a href="/gostd/net/dnsclient_unix_test.go.html#6647568">b</a></span><span class="op" id="6647602">.</span><span class="ident" id="6647603"><a href="/gostd/testing/benchmark.go.html#5450983">N</a></span><span class="op" id="6647604">;</span>&nbsp;<span class="ident" id="6647606"><a href="/gostd/net/dnsclient_unix_test.go.html#6647589">i</a></span><span class="op" id="6647607">++</span>&nbsp;<span class="op" id="6647610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647614"><a href="/gostd/net/dnsclient_unix.go.html#3223765">goLookupIP</a></span><span class="op" id="6647624">(</span><span class="string" id="6647625">&#34;some.nonexistent&#34;</span><span class="op" id="6647643">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647646">}</span><br>
<span class="lineno"></span><span class="op" id="6647648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6647651">func</span>&nbsp;<span class="ident" id="6647656">BenchmarkGoLookupIPWithBrokenNameServer</span><span class="op" id="6647695">(</span><span class="ident" id="6647696">b</span>&nbsp;<span class="op" id="6647698">*</span><span class="ident" id="6647699"><a href="/gostd/net/dnsclient_unix_test.go.html#6642242">testing</a></span><span class="op" id="6647706">.</span><span class="ident" id="6647707"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="6647708">)</span>&nbsp;<span class="op" id="6647710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647713"><a href="/gostd/net/dnsclient_unix.go.html#3220069">onceLoadConfig</a></span><span class="op" id="6647727">.</span><span class="ident" id="6647728"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="6647730">(</span><span class="ident" id="6647731"><a href="/gostd/net/dnsclient_unix.go.html#3220151">loadDefaultConfig</a></span><span class="op" id="6647748">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647751">if</span>&nbsp;<span class="ident" id="6647754"><a href="/gostd/net/dnsclient_unix.go.html#3219929">cfg</a></span><span class="op" id="6647757">.</span><span class="ident" id="6647758"><a href="/gostd/net/dnsclient_unix.go.html#3220047">dnserr</a></span>&nbsp;<span class="op" id="6647765">!=</span>&nbsp;<span class="builtintype" id="6647768">nil</span>&nbsp;<span class="op" id="6647772">||</span>&nbsp;<span class="ident" id="6647775"><a href="/gostd/net/dnsclient_unix.go.html#3219929">cfg</a></span><span class="op" id="6647778">.</span><span class="ident" id="6647779"><a href="/gostd/net/dnsclient_unix.go.html#3220025">dnsConfig</a></span>&nbsp;<span class="op" id="6647789">==</span>&nbsp;<span class="builtintype" id="6647792">nil</span>&nbsp;<span class="op" id="6647796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647800"><a href="/gostd/net/dnsclient_unix_test.go.html#6647696">b</a></span><span class="op" id="6647801">.</span><span class="ident" id="6647802"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6647808">(</span><span class="string" id="6647809">&#34;loadConfig&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6647832">,</span>&nbsp;<span class="ident" id="6647834"><a href="/gostd/net/dnsclient_unix.go.html#3219929">cfg</a></span><span class="op" id="6647837">.</span><span class="ident" id="6647838"><a href="/gostd/net/dnsclient_unix.go.html#3220047">dnserr</a></span><span class="op" id="6647844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6647850">//&nbsp;This&nbsp;looks&nbsp;ugly&nbsp;but&nbsp;it&#39;s&nbsp;safe&nbsp;as&nbsp;long&nbsp;as&nbsp;benchmarks&nbsp;are&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6647914">//&nbsp;sequentially&nbsp;in&nbsp;package&nbsp;testing.</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647951">orig</span>&nbsp;<span class="op" id="6647956">:=</span>&nbsp;<span class="ident" id="6647959"><a href="/gostd/net/dnsclient_unix.go.html#3219929">cfg</a></span><span class="op" id="6647962">.</span><span class="ident" id="6647963"><a href="/gostd/net/dnsclient_unix.go.html#3220025">dnsConfig</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647974"><a href="/gostd/net/dnsclient_unix.go.html#3219929">cfg</a></span><span class="op" id="6647977">.</span><span class="ident" id="6647978"><a href="/gostd/net/dnsclient_unix.go.html#3220025">dnsConfig</a></span><span class="op" id="6647987">.</span><span class="ident" id="6647988"><a href="/gostd/net/dnsconfig_unix.go.html#3225551">servers</a></span>&nbsp;<span class="op" id="6647996">=</span>&nbsp;<span class="builtinfunc" id="6647998">append</span><span class="op" id="6648004">(</span><span class="op" id="6648005">[</span><span class="op" id="6648006">]</span><span class="builtintype" id="6648007">string</span><span class="op" id="6648013">{</span><span class="string" id="6648014">&#34;203.0.113.254&#34;</span><span class="op" id="6648029">}</span><span class="op" id="6648030">,</span>&nbsp;<span class="ident" id="6648032"><a href="/gostd/net/dnsclient_unix.go.html#3219929">cfg</a></span><span class="op" id="6648035">.</span><span class="ident" id="6648036"><a href="/gostd/net/dnsclient_unix.go.html#3220025">dnsConfig</a></span><span class="op" id="6648045">.</span><span class="ident" id="6648046"><a href="/gostd/net/dnsconfig_unix.go.html#3225551">servers</a></span><span class="op" id="6648053">...</span><span class="op" id="6648056">)</span>&nbsp;<span class="comment" id="6648058">//&nbsp;use&nbsp;TEST-NET-3&nbsp;block,&nbsp;see&nbsp;RFC&nbsp;5737</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6648097">for</span>&nbsp;<span class="ident" id="6648101">i</span>&nbsp;<span class="op" id="6648103">:=</span>&nbsp;<span class="num" id="6648106">0</span><span class="op" id="6648107">;</span>&nbsp;<span class="ident" id="6648109"><a href="/gostd/net/dnsclient_unix_test.go.html#6648101">i</a></span>&nbsp;<span class="op" id="6648111">&lt;</span>&nbsp;<span class="ident" id="6648113"><a href="/gostd/net/dnsclient_unix_test.go.html#6647696">b</a></span><span class="op" id="6648114">.</span><span class="ident" id="6648115"><a href="/gostd/testing/benchmark.go.html#5450983">N</a></span><span class="op" id="6648116">;</span>&nbsp;<span class="ident" id="6648118"><a href="/gostd/net/dnsclient_unix_test.go.html#6648101">i</a></span><span class="op" id="6648119">++</span>&nbsp;<span class="op" id="6648122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648126"><a href="/gostd/net/dnsclient_unix.go.html#3223765">goLookupIP</a></span><span class="op" id="6648136">(</span><span class="string" id="6648137">&#34;www.example.com&#34;</span><span class="op" id="6648154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6648157">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648160"><a href="/gostd/net/dnsclient_unix.go.html#3219929">cfg</a></span><span class="op" id="6648163">.</span><span class="ident" id="6648164"><a href="/gostd/net/dnsclient_unix.go.html#3220025">dnsConfig</a></span>&nbsp;<span class="op" id="6648174">=</span>&nbsp;<span class="ident" id="6648176"><a href="/gostd/net/dnsclient_unix_test.go.html#6647951">orig</a></span><br>
<span class="lineno"></span><span class="op" id="6648181">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
