<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4067215">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4067270">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4067324">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4067375">//&nbsp;Counter&nbsp;(CTR)&nbsp;mode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4067399">//&nbsp;CTR&nbsp;converts&nbsp;a&nbsp;block&nbsp;cipher&nbsp;into&nbsp;a&nbsp;stream&nbsp;cipher&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4067454">//&nbsp;repeatedly&nbsp;encrypting&nbsp;an&nbsp;incrementing&nbsp;counter&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4067507">//&nbsp;xoring&nbsp;the&nbsp;resulting&nbsp;stream&nbsp;of&nbsp;data&nbsp;with&nbsp;the&nbsp;input.</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="4067563">//&nbsp;See&nbsp;NIST&nbsp;SP&nbsp;800-38A,&nbsp;pp&nbsp;13-15</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4067597">package</span>&nbsp;<span class="ident" id="4067605">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4067613">type</span>&nbsp;<span class="ident" id="4067618">ctr</span>&nbsp;<span class="keyword" id="4067622">struct</span>&nbsp;<span class="op" id="4067629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067632">b</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067640"><a href="/crypto/cipher/cipher.go.html#4066162">Block</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067647">ctr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067655">[</span><span class="op" id="4067656">]</span><span class="builtintype" id="4067657">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067663">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067671">[</span><span class="op" id="4067672">]</span><span class="builtintype" id="4067673">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067679">outUsed</span>&nbsp;<span class="builtintype" id="4067687">int</span><br>
<span class="lineno">20</span><span class="op" id="4067691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4067694">const</span>&nbsp;<span class="ident" id="4067700">streamBufferSize</span>&nbsp;<span class="op" id="4067717">=</span>&nbsp;<span class="num" id="4067719">512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4067724">//&nbsp;NewCTR&nbsp;returns&nbsp;a&nbsp;Stream&nbsp;which&nbsp;encrypts/decrypts&nbsp;using&nbsp;the&nbsp;given&nbsp;Block&nbsp;in</span><br>
<span class="lineno">25</span><span class="comment" id="4067800">//&nbsp;counter&nbsp;mode.&nbsp;The&nbsp;length&nbsp;of&nbsp;iv&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;Block&#39;s&nbsp;block&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="4067878">func</span>&nbsp;<span class="ident" id="4067883">NewCTR</span><span class="op" id="4067889">(</span><span class="ident" id="4067890">block</span>&nbsp;<span class="ident" id="4067896"><a href="/crypto/cipher/cipher.go.html#4066162">Block</a></span><span class="op" id="4067901">,</span>&nbsp;<span class="ident" id="4067903">iv</span>&nbsp;<span class="op" id="4067906">[</span><span class="op" id="4067907">]</span><span class="builtintype" id="4067908">byte</span><span class="op" id="4067912">)</span>&nbsp;<span class="ident" id="4067914"><a href="/crypto/cipher/cipher.go.html#4066546">Stream</a></span>&nbsp;<span class="op" id="4067921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067924">if</span>&nbsp;<span class="builtinfunc" id="4067927">len</span><span class="op" id="4067930">(</span><span class="ident" id="4067931"><a href="/crypto/cipher/ctr.go.html#4067903">iv</a></span><span class="op" id="4067933">)</span>&nbsp;<span class="op" id="4067935">!=</span>&nbsp;<span class="ident" id="4067938"><a href="/crypto/cipher/ctr.go.html#4067890">block</a></span><span class="op" id="4067943">.</span><span class="ident" id="4067944">BlockSize</span><span class="op" id="4067953">(</span><span class="op" id="4067954">)</span>&nbsp;<span class="op" id="4067956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4067960">panic</span><span class="op" id="4067965">(</span><span class="string" id="4067966">&#34;cipher.NewCTR:&nbsp;IV&nbsp;length&nbsp;must&nbsp;equal&nbsp;block&nbsp;size&#34;</span><span class="op" id="4068014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068017">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068020">bufSize</span>&nbsp;<span class="op" id="4068028">:=</span>&nbsp;<span class="ident" id="4068031"><a href="/crypto/cipher/ctr.go.html#4067700">streamBufferSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068049">if</span>&nbsp;<span class="ident" id="4068052"><a href="/crypto/cipher/ctr.go.html#4068020">bufSize</a></span>&nbsp;<span class="op" id="4068060">&lt;</span>&nbsp;<span class="ident" id="4068062"><a href="/crypto/cipher/ctr.go.html#4067890">block</a></span><span class="op" id="4068067">.</span><span class="ident" id="4068068">BlockSize</span><span class="op" id="4068077">(</span><span class="op" id="4068078">)</span>&nbsp;<span class="op" id="4068080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068084"><a href="/crypto/cipher/ctr.go.html#4068020">bufSize</a></span>&nbsp;<span class="op" id="4068092">=</span>&nbsp;<span class="ident" id="4068094"><a href="/crypto/cipher/ctr.go.html#4067890">block</a></span><span class="op" id="4068099">.</span><span class="ident" id="4068100">BlockSize</span><span class="op" id="4068109">(</span><span class="op" id="4068110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068116">return</span>&nbsp;<span class="op" id="4068123">&amp;</span><span class="ident" id="4068124"><a href="/crypto/cipher/ctr.go.html#4067618">ctr</a></span><span class="op" id="4068127">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068131">b</span><span class="op" id="4068132">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068140"><a href="/crypto/cipher/ctr.go.html#4067890">block</a></span><span class="op" id="4068145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068149">ctr</span><span class="op" id="4068152">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068158"><a href="/crypto/cipher/cipher.go.html#4067140">dup</a></span><span class="op" id="4068161">(</span><span class="ident" id="4068162"><a href="/crypto/cipher/ctr.go.html#4067903">iv</a></span><span class="op" id="4068164">)</span><span class="op" id="4068165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068169">out</span><span class="op" id="4068172">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4068178">make</span><span class="op" id="4068182">(</span><span class="op" id="4068183">[</span><span class="op" id="4068184">]</span><span class="builtintype" id="4068185">byte</span><span class="op" id="4068189">,</span>&nbsp;<span class="num" id="4068191">0</span><span class="op" id="4068192">,</span>&nbsp;<span class="ident" id="4068194"><a href="/crypto/cipher/ctr.go.html#4068020">bufSize</a></span><span class="op" id="4068201">)</span><span class="op" id="4068202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068206">outUsed</span><span class="op" id="4068213">:</span>&nbsp;<span class="num" id="4068215">0</span><span class="op" id="4068216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068219">}</span><br>
<span class="lineno">40</span><span class="op" id="4068221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4068224">func</span>&nbsp;<span class="op" id="4068229">(</span><span class="ident" id="4068230">x</span>&nbsp;<span class="op" id="4068232">*</span><span class="ident" id="4068233"><a href="/crypto/cipher/ctr.go.html#4067618">ctr</a></span><span class="op" id="4068236">)</span>&nbsp;<span class="ident" id="4068238">refill</span><span class="op" id="4068244">(</span><span class="op" id="4068245">)</span>&nbsp;<span class="op" id="4068247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068250">remain</span>&nbsp;<span class="op" id="4068257">:=</span>&nbsp;<span class="builtinfunc" id="4068260">len</span><span class="op" id="4068263">(</span><span class="ident" id="4068264"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068265">.</span><span class="ident" id="4068266">out</span><span class="op" id="4068269">)</span>&nbsp;<span class="op" id="4068271">-</span>&nbsp;<span class="ident" id="4068273"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068274">.</span><span class="ident" id="4068275">outUsed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068284">if</span>&nbsp;<span class="ident" id="4068287"><a href="/crypto/cipher/ctr.go.html#4068250">remain</a></span>&nbsp;<span class="op" id="4068294">&gt;</span>&nbsp;<span class="ident" id="4068296"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068297">.</span><span class="ident" id="4068298">outUsed</span>&nbsp;<span class="op" id="4068306">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068310">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4068321">copy</span><span class="op" id="4068325">(</span><span class="ident" id="4068326"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068327">.</span><span class="ident" id="4068328">out</span><span class="op" id="4068331">,</span>&nbsp;<span class="ident" id="4068333"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068334">.</span><span class="ident" id="4068335">out</span><span class="op" id="4068338">[</span><span class="ident" id="4068339"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068340">.</span><span class="ident" id="4068341">outUsed</span><span class="op" id="4068348">:</span><span class="op" id="4068349">]</span><span class="op" id="4068350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068353"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068354">.</span><span class="ident" id="4068355">out</span>&nbsp;<span class="op" id="4068359">=</span>&nbsp;<span class="ident" id="4068361"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068362">.</span><span class="ident" id="4068363">out</span><span class="op" id="4068366">[</span><span class="op" id="4068367">:</span><span class="builtinfunc" id="4068368">cap</span><span class="op" id="4068371">(</span><span class="ident" id="4068372"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068373">.</span><span class="ident" id="4068374">out</span><span class="op" id="4068377">)</span><span class="op" id="4068378">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068381">bs</span>&nbsp;<span class="op" id="4068384">:=</span>&nbsp;<span class="ident" id="4068387"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068388">.</span><span class="ident" id="4068389">b</span><span class="op" id="4068390">.</span><span class="ident" id="4068391">BlockSize</span><span class="op" id="4068400">(</span><span class="op" id="4068401">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068404">for</span>&nbsp;<span class="ident" id="4068408"><a href="/crypto/cipher/ctr.go.html#4068250">remain</a></span>&nbsp;<span class="op" id="4068415">&lt;</span>&nbsp;<span class="builtinfunc" id="4068417">len</span><span class="op" id="4068420">(</span><span class="ident" id="4068421"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068422">.</span><span class="ident" id="4068423">out</span><span class="op" id="4068426">)</span><span class="op" id="4068427">-</span><span class="ident" id="4068428"><a href="/crypto/cipher/ctr.go.html#4068381">bs</a></span>&nbsp;<span class="op" id="4068431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068435"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068436">.</span><span class="ident" id="4068437">b</span><span class="op" id="4068438">.</span><span class="ident" id="4068439">Encrypt</span><span class="op" id="4068446">(</span><span class="ident" id="4068447"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068448">.</span><span class="ident" id="4068449">out</span><span class="op" id="4068452">[</span><span class="ident" id="4068453"><a href="/crypto/cipher/ctr.go.html#4068250">remain</a></span><span class="op" id="4068459">:</span><span class="op" id="4068460">]</span><span class="op" id="4068461">,</span>&nbsp;<span class="ident" id="4068463"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068464">.</span><span class="ident" id="4068465">ctr</span><span class="op" id="4068468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068472"><a href="/crypto/cipher/ctr.go.html#4068250">remain</a></span>&nbsp;<span class="op" id="4068479">+=</span>&nbsp;<span class="ident" id="4068482"><a href="/crypto/cipher/ctr.go.html#4068381">bs</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4068488">//&nbsp;Increment&nbsp;counter</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068511">for</span>&nbsp;<span class="ident" id="4068515">i</span>&nbsp;<span class="op" id="4068517">:=</span>&nbsp;<span class="builtinfunc" id="4068520">len</span><span class="op" id="4068523">(</span><span class="ident" id="4068524"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068525">.</span><span class="ident" id="4068526">ctr</span><span class="op" id="4068529">)</span>&nbsp;<span class="op" id="4068531">-</span>&nbsp;<span class="num" id="4068533">1</span><span class="op" id="4068534">;</span>&nbsp;<span class="ident" id="4068536"><a href="/crypto/cipher/ctr.go.html#4068515">i</a></span>&nbsp;<span class="op" id="4068538">&gt;=</span>&nbsp;<span class="num" id="4068541">0</span><span class="op" id="4068542">;</span>&nbsp;<span class="ident" id="4068544"><a href="/crypto/cipher/ctr.go.html#4068515">i</a></span><span class="op" id="4068545">--</span>&nbsp;<span class="op" id="4068548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068553"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068554">.</span><span class="ident" id="4068555">ctr</span><span class="op" id="4068558">[</span><span class="ident" id="4068559"><a href="/crypto/cipher/ctr.go.html#4068515">i</a></span><span class="op" id="4068560">]</span><span class="op" id="4068561">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068567">if</span>&nbsp;<span class="ident" id="4068570"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068571">.</span><span class="ident" id="4068572">ctr</span><span class="op" id="4068575">[</span><span class="ident" id="4068576"><a href="/crypto/cipher/ctr.go.html#4068515">i</a></span><span class="op" id="4068577">]</span>&nbsp;<span class="op" id="4068579">!=</span>&nbsp;<span class="num" id="4068582">0</span>&nbsp;<span class="op" id="4068584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068590">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068599">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068609"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068610">.</span><span class="ident" id="4068611">out</span>&nbsp;<span class="op" id="4068615">=</span>&nbsp;<span class="ident" id="4068617"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068618">.</span><span class="ident" id="4068619">out</span><span class="op" id="4068622">[</span><span class="op" id="4068623">:</span><span class="ident" id="4068624"><a href="/crypto/cipher/ctr.go.html#4068250">remain</a></span><span class="op" id="4068630">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068633"><a href="/crypto/cipher/ctr.go.html#4068230">x</a></span><span class="op" id="4068634">.</span><span class="ident" id="4068635">outUsed</span>&nbsp;<span class="op" id="4068643">=</span>&nbsp;<span class="num" id="4068645">0</span><br>
<span class="lineno"></span><span class="op" id="4068647">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="4068650">func</span>&nbsp;<span class="op" id="4068655">(</span><span class="ident" id="4068656">x</span>&nbsp;<span class="op" id="4068658">*</span><span class="ident" id="4068659"><a href="/crypto/cipher/ctr.go.html#4067618">ctr</a></span><span class="op" id="4068662">)</span>&nbsp;<span class="ident" id="4068664">XORKeyStream</span><span class="op" id="4068676">(</span><span class="ident" id="4068677">dst</span><span class="op" id="4068680">,</span>&nbsp;<span class="ident" id="4068682">src</span>&nbsp;<span class="op" id="4068686">[</span><span class="op" id="4068687">]</span><span class="builtintype" id="4068688">byte</span><span class="op" id="4068692">)</span>&nbsp;<span class="op" id="4068694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068697">for</span>&nbsp;<span class="builtinfunc" id="4068701">len</span><span class="op" id="4068704">(</span><span class="ident" id="4068705"><a href="/crypto/cipher/ctr.go.html#4068682">src</a></span><span class="op" id="4068708">)</span>&nbsp;<span class="op" id="4068710">&gt;</span>&nbsp;<span class="num" id="4068712">0</span>&nbsp;<span class="op" id="4068714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4068718">if</span>&nbsp;<span class="ident" id="4068721"><a href="/crypto/cipher/ctr.go.html#4068656">x</a></span><span class="op" id="4068722">.</span><span class="ident" id="4068723">outUsed</span>&nbsp;<span class="op" id="4068731">&gt;=</span>&nbsp;<span class="builtinfunc" id="4068734">len</span><span class="op" id="4068737">(</span><span class="ident" id="4068738"><a href="/crypto/cipher/ctr.go.html#4068656">x</a></span><span class="op" id="4068739">.</span><span class="ident" id="4068740">out</span><span class="op" id="4068743">)</span><span class="op" id="4068744">-</span><span class="ident" id="4068745"><a href="/crypto/cipher/ctr.go.html#4068656">x</a></span><span class="op" id="4068746">.</span><span class="ident" id="4068747">b</span><span class="op" id="4068748">.</span><span class="ident" id="4068749">BlockSize</span><span class="op" id="4068758">(</span><span class="op" id="4068759">)</span>&nbsp;<span class="op" id="4068761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068766"><a href="/crypto/cipher/ctr.go.html#4068656">x</a></span><span class="op" id="4068767">.</span><span class="ident" id="4068768">refill</span><span class="op" id="4068774">(</span><span class="op" id="4068775">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068783">n</span>&nbsp;<span class="op" id="4068785">:=</span>&nbsp;<span class="ident" id="4068788"><a href="/crypto/cipher/xor.go.html#4082665">xorBytes</a></span><span class="op" id="4068796">(</span><span class="ident" id="4068797"><a href="/crypto/cipher/ctr.go.html#4068677">dst</a></span><span class="op" id="4068800">,</span>&nbsp;<span class="ident" id="4068802"><a href="/crypto/cipher/ctr.go.html#4068682">src</a></span><span class="op" id="4068805">,</span>&nbsp;<span class="ident" id="4068807"><a href="/crypto/cipher/ctr.go.html#4068656">x</a></span><span class="op" id="4068808">.</span><span class="ident" id="4068809">out</span><span class="op" id="4068812">[</span><span class="ident" id="4068813"><a href="/crypto/cipher/ctr.go.html#4068656">x</a></span><span class="op" id="4068814">.</span><span class="ident" id="4068815">outUsed</span><span class="op" id="4068822">:</span><span class="op" id="4068823">]</span><span class="op" id="4068824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068828"><a href="/crypto/cipher/ctr.go.html#4068677">dst</a></span>&nbsp;<span class="op" id="4068832">=</span>&nbsp;<span class="ident" id="4068834"><a href="/crypto/cipher/ctr.go.html#4068677">dst</a></span><span class="op" id="4068837">[</span><span class="ident" id="4068838"><a href="/crypto/cipher/ctr.go.html#4068783">n</a></span><span class="op" id="4068839">:</span><span class="op" id="4068840">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068844"><a href="/crypto/cipher/ctr.go.html#4068682">src</a></span>&nbsp;<span class="op" id="4068848">=</span>&nbsp;<span class="ident" id="4068850"><a href="/crypto/cipher/ctr.go.html#4068682">src</a></span><span class="op" id="4068853">[</span><span class="ident" id="4068854"><a href="/crypto/cipher/ctr.go.html#4068783">n</a></span><span class="op" id="4068855">:</span><span class="op" id="4068856">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4068860"><a href="/crypto/cipher/ctr.go.html#4068656">x</a></span><span class="op" id="4068861">.</span><span class="ident" id="4068862">outUsed</span>&nbsp;<span class="op" id="4068870">+=</span>&nbsp;<span class="ident" id="4068873"><a href="/crypto/cipher/ctr.go.html#4068783">n</a></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4068876">}</span><br>
<span class="lineno"></span><span class="op" id="4068878">}</span>
</div>
</body>
</html>
