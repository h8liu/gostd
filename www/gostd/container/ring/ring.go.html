<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5917126">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5917181">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5917235">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5917286">//&nbsp;Package&nbsp;ring&nbsp;implements&nbsp;operations&nbsp;on&nbsp;circular&nbsp;lists.</span><br>
<span class="lineno"></span><span class="keyword" id="5917343">package</span>&nbsp;<span class="ident" id="5917351">ring</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5917357">//&nbsp;A&nbsp;Ring&nbsp;is&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;circular&nbsp;list,&nbsp;or&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="5917410">//&nbsp;Rings&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;beginning&nbsp;or&nbsp;end;&nbsp;a&nbsp;pointer&nbsp;to&nbsp;any&nbsp;ring&nbsp;element</span><br>
<span class="lineno">10</span><span class="comment" id="5917481">//&nbsp;serves&nbsp;as&nbsp;reference&nbsp;to&nbsp;the&nbsp;entire&nbsp;ring.&nbsp;Empty&nbsp;rings&nbsp;are&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="5917552">//&nbsp;as&nbsp;nil&nbsp;Ring&nbsp;pointers.&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Ring&nbsp;is&nbsp;a&nbsp;one-element</span><br>
<span class="lineno"></span><span class="comment" id="5917620">//&nbsp;ring&nbsp;with&nbsp;a&nbsp;nil&nbsp;Value.</span><br>
<span class="lineno"></span><span class="comment" id="5917646">//</span><br>
<span class="lineno"></span><span class="keyword" id="5917649">type</span>&nbsp;<span class="ident" id="5917654">Ring</span>&nbsp;<span class="keyword" id="5917659">struct</span>&nbsp;<span class="op" id="5917666">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5917669">next</span><span class="op" id="5917673">,</span>&nbsp;<span class="ident" id="5917675">prev</span>&nbsp;<span class="op" id="5917680">*</span><span class="ident" id="5917681">Ring</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5917687">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5917698">interface</span><span class="op" id="5917707">{</span><span class="op" id="5917708">}</span>&nbsp;<span class="comment" id="5917710">//&nbsp;for&nbsp;use&nbsp;by&nbsp;client;&nbsp;untouched&nbsp;by&nbsp;this&nbsp;library</span><br>
<span class="lineno"></span><span class="op" id="5917758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5917761">func</span>&nbsp;<span class="op" id="5917766">(</span><span class="ident" id="5917767">r</span>&nbsp;<span class="op" id="5917769">*</span><span class="ident" id="5917770">Ring</span><span class="op" id="5917774">)</span>&nbsp;<span class="ident" id="5917776">init</span><span class="op" id="5917780">(</span><span class="op" id="5917781">)</span>&nbsp;<span class="op" id="5917783">*</span><span class="ident" id="5917784">Ring</span>&nbsp;<span class="op" id="5917789">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5917792">r</span><span class="op" id="5917793">.</span><span class="ident" id="5917794">next</span>&nbsp;<span class="op" id="5917799">=</span>&nbsp;<span class="ident" id="5917801">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5917804">r</span><span class="op" id="5917805">.</span><span class="ident" id="5917806">prev</span>&nbsp;<span class="op" id="5917811">=</span>&nbsp;<span class="ident" id="5917813">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5917816">return</span>&nbsp;<span class="ident" id="5917823">r</span><br>
<span class="lineno"></span><span class="op" id="5917825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="5917828">//&nbsp;Next&nbsp;returns&nbsp;the&nbsp;next&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="5917888">func</span>&nbsp;<span class="op" id="5917893">(</span><span class="ident" id="5917894">r</span>&nbsp;<span class="op" id="5917896">*</span><span class="ident" id="5917897">Ring</span><span class="op" id="5917901">)</span>&nbsp;<span class="ident" id="5917903">Next</span><span class="op" id="5917907">(</span><span class="op" id="5917908">)</span>&nbsp;<span class="op" id="5917910">*</span><span class="ident" id="5917911">Ring</span>&nbsp;<span class="op" id="5917916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5917919">if</span>&nbsp;<span class="ident" id="5917922">r</span><span class="op" id="5917923">.</span><span class="ident" id="5917924">next</span>&nbsp;<span class="op" id="5917929">==</span>&nbsp;<span class="ident" id="5917932">nil</span>&nbsp;<span class="op" id="5917936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5917940">return</span>&nbsp;<span class="ident" id="5917947">r</span><span class="op" id="5917948">.</span><span class="ident" id="5917949">init</span><span class="op" id="5917953">(</span><span class="op" id="5917954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5917957">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5917960">return</span>&nbsp;<span class="ident" id="5917967">r</span><span class="op" id="5917968">.</span><span class="ident" id="5917969">next</span><br>
<span class="lineno"></span><span class="op" id="5917974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5917977">//&nbsp;Prev&nbsp;returns&nbsp;the&nbsp;previous&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="5918041">func</span>&nbsp;<span class="op" id="5918046">(</span><span class="ident" id="5918047">r</span>&nbsp;<span class="op" id="5918049">*</span><span class="ident" id="5918050">Ring</span><span class="op" id="5918054">)</span>&nbsp;<span class="ident" id="5918056">Prev</span><span class="op" id="5918060">(</span><span class="op" id="5918061">)</span>&nbsp;<span class="op" id="5918063">*</span><span class="ident" id="5918064">Ring</span>&nbsp;<span class="op" id="5918069">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5918072">if</span>&nbsp;<span class="ident" id="5918075">r</span><span class="op" id="5918076">.</span><span class="ident" id="5918077">next</span>&nbsp;<span class="op" id="5918082">==</span>&nbsp;<span class="ident" id="5918085">nil</span>&nbsp;<span class="op" id="5918089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5918093">return</span>&nbsp;<span class="ident" id="5918100">r</span><span class="op" id="5918101">.</span><span class="ident" id="5918102">init</span><span class="op" id="5918106">(</span><span class="op" id="5918107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5918110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5918113">return</span>&nbsp;<span class="ident" id="5918120">r</span><span class="op" id="5918121">.</span><span class="ident" id="5918122">prev</span><br>
<span class="lineno"></span><span class="op" id="5918127">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="5918130">//&nbsp;Move&nbsp;moves&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;backward&nbsp;(n&nbsp;&lt;&nbsp;0)&nbsp;or&nbsp;forward&nbsp;(n&nbsp;&gt;=&nbsp;0)</span><br>
<span class="lineno"></span><span class="comment" id="5918202">//&nbsp;in&nbsp;the&nbsp;ring&nbsp;and&nbsp;returns&nbsp;that&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="5918269">//</span><br>
<span class="lineno"></span><span class="keyword" id="5918272">func</span>&nbsp;<span class="op" id="5918277">(</span><span class="ident" id="5918278">r</span>&nbsp;<span class="op" id="5918280">*</span><span class="ident" id="5918281">Ring</span><span class="op" id="5918285">)</span>&nbsp;<span class="ident" id="5918287">Move</span><span class="op" id="5918291">(</span><span class="ident" id="5918292">n</span>&nbsp;<span class="builtintype" id="5918294">int</span><span class="op" id="5918297">)</span>&nbsp;<span class="op" id="5918299">*</span><span class="ident" id="5918300">Ring</span>&nbsp;<span class="op" id="5918305">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5918308">if</span>&nbsp;<span class="ident" id="5918311">r</span><span class="op" id="5918312">.</span><span class="ident" id="5918313">next</span>&nbsp;<span class="op" id="5918318">==</span>&nbsp;<span class="ident" id="5918321">nil</span>&nbsp;<span class="op" id="5918325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5918329">return</span>&nbsp;<span class="ident" id="5918336">r</span><span class="op" id="5918337">.</span><span class="ident" id="5918338">init</span><span class="op" id="5918342">(</span><span class="op" id="5918343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5918346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5918349">switch</span>&nbsp;<span class="op" id="5918356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5918359">case</span>&nbsp;<span class="ident" id="5918364">n</span>&nbsp;<span class="op" id="5918366">&lt;</span>&nbsp;<span class="num" id="5918368">0</span><span class="op" id="5918369">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5918373">for</span>&nbsp;<span class="op" id="5918377">;</span>&nbsp;<span class="ident" id="5918379">n</span>&nbsp;<span class="op" id="5918381">&lt;</span>&nbsp;<span class="num" id="5918383">0</span><span class="op" id="5918384">;</span>&nbsp;<span class="ident" id="5918386">n</span><span class="op" id="5918387">++</span>&nbsp;<span class="op" id="5918390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5918395">r</span>&nbsp;<span class="op" id="5918397">=</span>&nbsp;<span class="ident" id="5918399">r</span><span class="op" id="5918400">.</span><span class="ident" id="5918401">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5918408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5918411">case</span>&nbsp;<span class="ident" id="5918416">n</span>&nbsp;<span class="op" id="5918418">&gt;</span>&nbsp;<span class="num" id="5918420">0</span><span class="op" id="5918421">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5918425">for</span>&nbsp;<span class="op" id="5918429">;</span>&nbsp;<span class="ident" id="5918431">n</span>&nbsp;<span class="op" id="5918433">&gt;</span>&nbsp;<span class="num" id="5918435">0</span><span class="op" id="5918436">;</span>&nbsp;<span class="ident" id="5918438">n</span><span class="op" id="5918439">--</span>&nbsp;<span class="op" id="5918442">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5918447">r</span>&nbsp;<span class="op" id="5918449">=</span>&nbsp;<span class="ident" id="5918451">r</span><span class="op" id="5918452">.</span><span class="ident" id="5918453">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5918460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5918463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5918466">return</span>&nbsp;<span class="ident" id="5918473">r</span><br>
<span class="lineno"></span><span class="op" id="5918475">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5918478">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;ring&nbsp;of&nbsp;n&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="5918515">func</span>&nbsp;<span class="ident" id="5918520">New</span><span class="op" id="5918523">(</span><span class="ident" id="5918524">n</span>&nbsp;<span class="builtintype" id="5918526">int</span><span class="op" id="5918529">)</span>&nbsp;<span class="op" id="5918531">*</span><span class="ident" id="5918532">Ring</span>&nbsp;<span class="op" id="5918537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5918540">if</span>&nbsp;<span class="ident" id="5918543">n</span>&nbsp;<span class="op" id="5918545">&lt;=</span>&nbsp;<span class="num" id="5918548">0</span>&nbsp;<span class="op" id="5918550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5918554">return</span>&nbsp;<span class="ident" id="5918561">nil</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5918566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5918569">r</span>&nbsp;<span class="op" id="5918571">:=</span>&nbsp;<span class="builtinfunc" id="5918574">new</span><span class="op" id="5918577">(</span><span class="ident" id="5918578">Ring</span><span class="op" id="5918582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5918585">p</span>&nbsp;<span class="op" id="5918587">:=</span>&nbsp;<span class="ident" id="5918590">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5918593">for</span>&nbsp;<span class="ident" id="5918597">i</span>&nbsp;<span class="op" id="5918599">:=</span>&nbsp;<span class="num" id="5918602">1</span><span class="op" id="5918603">;</span>&nbsp;<span class="ident" id="5918605">i</span>&nbsp;<span class="op" id="5918607">&lt;</span>&nbsp;<span class="ident" id="5918609">n</span><span class="op" id="5918610">;</span>&nbsp;<span class="ident" id="5918612">i</span><span class="op" id="5918613">++</span>&nbsp;<span class="op" id="5918616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5918620">p</span><span class="op" id="5918621">.</span><span class="ident" id="5918622">next</span>&nbsp;<span class="op" id="5918627">=</span>&nbsp;<span class="op" id="5918629">&amp;</span><span class="ident" id="5918630">Ring</span><span class="op" id="5918634">{</span><span class="ident" id="5918635">prev</span><span class="op" id="5918639">:</span>&nbsp;<span class="ident" id="5918641">p</span><span class="op" id="5918642">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5918646">p</span>&nbsp;<span class="op" id="5918648">=</span>&nbsp;<span class="ident" id="5918650">p</span><span class="op" id="5918651">.</span><span class="ident" id="5918652">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5918658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5918661">p</span><span class="op" id="5918662">.</span><span class="ident" id="5918663">next</span>&nbsp;<span class="op" id="5918668">=</span>&nbsp;<span class="ident" id="5918670">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5918673">r</span><span class="op" id="5918674">.</span><span class="ident" id="5918675">prev</span>&nbsp;<span class="op" id="5918680">=</span>&nbsp;<span class="ident" id="5918682">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5918685">return</span>&nbsp;<span class="ident" id="5918692">r</span><br>
<span class="lineno">75</span><span class="op" id="5918694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5918697">//&nbsp;Link&nbsp;connects&nbsp;ring&nbsp;r&nbsp;with&nbsp;ring&nbsp;s&nbsp;such&nbsp;that&nbsp;r.Next()</span><br>
<span class="lineno"></span><span class="comment" id="5918752">//&nbsp;becomes&nbsp;s&nbsp;and&nbsp;returns&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next().</span><br>
<span class="lineno"></span><span class="comment" id="5918810">//&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">80</span><span class="comment" id="5918834">//</span><br>
<span class="lineno"></span><span class="comment" id="5918837">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;ring,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="5918883">//&nbsp;them&nbsp;removes&nbsp;the&nbsp;elements&nbsp;between&nbsp;r&nbsp;and&nbsp;s&nbsp;from&nbsp;the&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="5918943">//&nbsp;The&nbsp;removed&nbsp;elements&nbsp;form&nbsp;a&nbsp;subring&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5919002">//&nbsp;reference&nbsp;to&nbsp;that&nbsp;subring&nbsp;(if&nbsp;no&nbsp;elements&nbsp;were&nbsp;removed,</span><br>
<span class="lineno">85</span><span class="comment" id="5919061">//&nbsp;the&nbsp;result&nbsp;is&nbsp;still&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next(),</span><br>
<span class="lineno"></span><span class="comment" id="5919117">//&nbsp;and&nbsp;not&nbsp;nil).</span><br>
<span class="lineno"></span><span class="comment" id="5919134">//</span><br>
<span class="lineno"></span><span class="comment" id="5919137">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;different&nbsp;rings,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="5919185">//&nbsp;them&nbsp;creates&nbsp;a&nbsp;single&nbsp;ring&nbsp;with&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;inserted</span><br>
<span class="lineno">90</span><span class="comment" id="5919247">//&nbsp;after&nbsp;r.&nbsp;The&nbsp;result&nbsp;points&nbsp;to&nbsp;the&nbsp;element&nbsp;following&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5919306">//&nbsp;last&nbsp;element&nbsp;of&nbsp;s&nbsp;after&nbsp;insertion.</span><br>
<span class="lineno"></span><span class="comment" id="5919344">//</span><br>
<span class="lineno"></span><span class="keyword" id="5919347">func</span>&nbsp;<span class="op" id="5919352">(</span><span class="ident" id="5919353">r</span>&nbsp;<span class="op" id="5919355">*</span><span class="ident" id="5919356">Ring</span><span class="op" id="5919360">)</span>&nbsp;<span class="ident" id="5919362">Link</span><span class="op" id="5919366">(</span><span class="ident" id="5919367">s</span>&nbsp;<span class="op" id="5919369">*</span><span class="ident" id="5919370">Ring</span><span class="op" id="5919374">)</span>&nbsp;<span class="op" id="5919376">*</span><span class="ident" id="5919377">Ring</span>&nbsp;<span class="op" id="5919382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5919385">n</span>&nbsp;<span class="op" id="5919387">:=</span>&nbsp;<span class="ident" id="5919390">r</span><span class="op" id="5919391">.</span><span class="ident" id="5919392">Next</span><span class="op" id="5919396">(</span><span class="op" id="5919397">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5919400">if</span>&nbsp;<span class="ident" id="5919403">s</span>&nbsp;<span class="op" id="5919405">!=</span>&nbsp;<span class="ident" id="5919408">nil</span>&nbsp;<span class="op" id="5919412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5919416">p</span>&nbsp;<span class="op" id="5919418">:=</span>&nbsp;<span class="ident" id="5919421">s</span><span class="op" id="5919422">.</span><span class="ident" id="5919423">Prev</span><span class="op" id="5919427">(</span><span class="op" id="5919428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5919432">//&nbsp;Note:&nbsp;Cannot&nbsp;use&nbsp;multiple&nbsp;assignment&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5919482">//&nbsp;evaluation&nbsp;order&nbsp;of&nbsp;LHS&nbsp;is&nbsp;not&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5919529">r</span><span class="op" id="5919530">.</span><span class="ident" id="5919531">next</span>&nbsp;<span class="op" id="5919536">=</span>&nbsp;<span class="ident" id="5919538">s</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5919542">s</span><span class="op" id="5919543">.</span><span class="ident" id="5919544">prev</span>&nbsp;<span class="op" id="5919549">=</span>&nbsp;<span class="ident" id="5919551">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5919555">n</span><span class="op" id="5919556">.</span><span class="ident" id="5919557">prev</span>&nbsp;<span class="op" id="5919562">=</span>&nbsp;<span class="ident" id="5919564">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5919568">p</span><span class="op" id="5919569">.</span><span class="ident" id="5919570">next</span>&nbsp;<span class="op" id="5919575">=</span>&nbsp;<span class="ident" id="5919577">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5919580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5919583">return</span>&nbsp;<span class="ident" id="5919590">n</span><br>
<span class="lineno">105</span><span class="op" id="5919592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5919595">//&nbsp;Unlink&nbsp;removes&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;from&nbsp;the&nbsp;ring&nbsp;r,&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="5919660">//&nbsp;at&nbsp;r.Next().&nbsp;If&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;==&nbsp;0,&nbsp;r&nbsp;remains&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="comment" id="5919718">//&nbsp;The&nbsp;result&nbsp;is&nbsp;the&nbsp;removed&nbsp;subring.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">110</span><span class="comment" id="5919777">//</span><br>
<span class="lineno"></span><span class="keyword" id="5919780">func</span>&nbsp;<span class="op" id="5919785">(</span><span class="ident" id="5919786">r</span>&nbsp;<span class="op" id="5919788">*</span><span class="ident" id="5919789">Ring</span><span class="op" id="5919793">)</span>&nbsp;<span class="ident" id="5919795">Unlink</span><span class="op" id="5919801">(</span><span class="ident" id="5919802">n</span>&nbsp;<span class="builtintype" id="5919804">int</span><span class="op" id="5919807">)</span>&nbsp;<span class="op" id="5919809">*</span><span class="ident" id="5919810">Ring</span>&nbsp;<span class="op" id="5919815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5919818">if</span>&nbsp;<span class="ident" id="5919821">n</span>&nbsp;<span class="op" id="5919823">&lt;=</span>&nbsp;<span class="num" id="5919826">0</span>&nbsp;<span class="op" id="5919828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5919832">return</span>&nbsp;<span class="ident" id="5919839">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5919844">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5919847">return</span>&nbsp;<span class="ident" id="5919854">r</span><span class="op" id="5919855">.</span><span class="ident" id="5919856">Link</span><span class="op" id="5919860">(</span><span class="ident" id="5919861">r</span><span class="op" id="5919862">.</span><span class="ident" id="5919863">Move</span><span class="op" id="5919867">(</span><span class="ident" id="5919868">n</span>&nbsp;<span class="op" id="5919870">+</span>&nbsp;<span class="num" id="5919872">1</span><span class="op" id="5919873">)</span><span class="op" id="5919874">)</span><br>
<span class="lineno"></span><span class="op" id="5919876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5919879">//&nbsp;Len&nbsp;computes&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;in&nbsp;ring&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="5919929">//&nbsp;It&nbsp;executes&nbsp;in&nbsp;time&nbsp;proportional&nbsp;to&nbsp;the&nbsp;number&nbsp;of&nbsp;elements.</span><br>
<span class="lineno">120</span><span class="comment" id="5919992">//</span><br>
<span class="lineno"></span><span class="keyword" id="5919995">func</span>&nbsp;<span class="op" id="5920000">(</span><span class="ident" id="5920001">r</span>&nbsp;<span class="op" id="5920003">*</span><span class="ident" id="5920004">Ring</span><span class="op" id="5920008">)</span>&nbsp;<span class="ident" id="5920010">Len</span><span class="op" id="5920013">(</span><span class="op" id="5920014">)</span>&nbsp;<span class="builtintype" id="5920016">int</span>&nbsp;<span class="op" id="5920020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5920023">n</span>&nbsp;<span class="op" id="5920025">:=</span>&nbsp;<span class="num" id="5920028">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5920031">if</span>&nbsp;<span class="ident" id="5920034">r</span>&nbsp;<span class="op" id="5920036">!=</span>&nbsp;<span class="ident" id="5920039">nil</span>&nbsp;<span class="op" id="5920043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5920047">n</span>&nbsp;<span class="op" id="5920049">=</span>&nbsp;<span class="num" id="5920051">1</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5920055">for</span>&nbsp;<span class="ident" id="5920059">p</span>&nbsp;<span class="op" id="5920061">:=</span>&nbsp;<span class="ident" id="5920064">r</span><span class="op" id="5920065">.</span><span class="ident" id="5920066">Next</span><span class="op" id="5920070">(</span><span class="op" id="5920071">)</span><span class="op" id="5920072">;</span>&nbsp;<span class="ident" id="5920074">p</span>&nbsp;<span class="op" id="5920076">!=</span>&nbsp;<span class="ident" id="5920079">r</span><span class="op" id="5920080">;</span>&nbsp;<span class="ident" id="5920082">p</span>&nbsp;<span class="op" id="5920084">=</span>&nbsp;<span class="ident" id="5920086">p</span><span class="op" id="5920087">.</span><span class="ident" id="5920088">next</span>&nbsp;<span class="op" id="5920093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5920098">n</span><span class="op" id="5920099">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5920104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5920107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5920110">return</span>&nbsp;<span class="ident" id="5920117">n</span><br>
<span class="lineno">130</span><span class="op" id="5920119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5920122">//&nbsp;Do&nbsp;calls&nbsp;function&nbsp;f&nbsp;on&nbsp;each&nbsp;element&nbsp;of&nbsp;the&nbsp;ring,&nbsp;in&nbsp;forward&nbsp;order.</span><br>
<span class="lineno"></span><span class="comment" id="5920192">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Do&nbsp;is&nbsp;undefined&nbsp;if&nbsp;f&nbsp;changes&nbsp;*r.</span><br>
<span class="lineno"></span><span class="keyword" id="5920244">func</span>&nbsp;<span class="op" id="5920249">(</span><span class="ident" id="5920250">r</span>&nbsp;<span class="op" id="5920252">*</span><span class="ident" id="5920253">Ring</span><span class="op" id="5920257">)</span>&nbsp;<span class="ident" id="5920259">Do</span><span class="op" id="5920261">(</span><span class="ident" id="5920262">f</span>&nbsp;<span class="keyword" id="5920264">func</span><span class="op" id="5920268">(</span><span class="keyword" id="5920269">interface</span><span class="op" id="5920278">{</span><span class="op" id="5920279">}</span><span class="op" id="5920280">)</span><span class="op" id="5920281">)</span>&nbsp;<span class="op" id="5920283">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5920286">if</span>&nbsp;<span class="ident" id="5920289">r</span>&nbsp;<span class="op" id="5920291">!=</span>&nbsp;<span class="ident" id="5920294">nil</span>&nbsp;<span class="op" id="5920298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5920302">f</span><span class="op" id="5920303">(</span><span class="ident" id="5920304">r</span><span class="op" id="5920305">.</span><span class="ident" id="5920306">Value</span><span class="op" id="5920311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5920315">for</span>&nbsp;<span class="ident" id="5920319">p</span>&nbsp;<span class="op" id="5920321">:=</span>&nbsp;<span class="ident" id="5920324">r</span><span class="op" id="5920325">.</span><span class="ident" id="5920326">Next</span><span class="op" id="5920330">(</span><span class="op" id="5920331">)</span><span class="op" id="5920332">;</span>&nbsp;<span class="ident" id="5920334">p</span>&nbsp;<span class="op" id="5920336">!=</span>&nbsp;<span class="ident" id="5920339">r</span><span class="op" id="5920340">;</span>&nbsp;<span class="ident" id="5920342">p</span>&nbsp;<span class="op" id="5920344">=</span>&nbsp;<span class="ident" id="5920346">p</span><span class="op" id="5920347">.</span><span class="ident" id="5920348">next</span>&nbsp;<span class="op" id="5920353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5920358">f</span><span class="op" id="5920359">(</span><span class="ident" id="5920360">p</span><span class="op" id="5920361">.</span><span class="ident" id="5920362">Value</span><span class="op" id="5920367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5920371">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5920374">}</span><br>
<span class="lineno"></span><span class="op" id="5920376">}</span>
</div>
</body>
</html>
