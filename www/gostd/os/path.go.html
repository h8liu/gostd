<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2180154">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2180209">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2180263">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2180314">package</span>&nbsp;<span class="ident" id="2180322">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2180326">import</span>&nbsp;<span class="op" id="2180333">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2180336">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2180342">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2180352">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2180355">//&nbsp;MkdirAll&nbsp;creates&nbsp;a&nbsp;directory&nbsp;named&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="2180399">//&nbsp;along&nbsp;with&nbsp;any&nbsp;necessary&nbsp;parents,&nbsp;and&nbsp;returns&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="2180453">//&nbsp;or&nbsp;else&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno">15</span><span class="comment" id="2180482">//&nbsp;The&nbsp;permission&nbsp;bits&nbsp;perm&nbsp;are&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2180527">//&nbsp;directories&nbsp;that&nbsp;MkdirAll&nbsp;creates.</span><br>
<span class="lineno"></span><span class="comment" id="2180565">//&nbsp;If&nbsp;path&nbsp;is&nbsp;already&nbsp;a&nbsp;directory,&nbsp;MkdirAll&nbsp;does&nbsp;nothing</span><br>
<span class="lineno"></span><span class="comment" id="2180622">//&nbsp;and&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2180642">func</span>&nbsp;<span class="ident" id="2180647">MkdirAll</span><span class="op" id="2180655">(</span><span class="ident" id="2180656">path</span>&nbsp;<span class="builtintype" id="2180661">string</span><span class="op" id="2180667">,</span>&nbsp;<span class="ident" id="2180669">perm</span>&nbsp;<span class="ident" id="2180674">FileMode</span><span class="op" id="2180682">)</span>&nbsp;<span class="builtintype" id="2180684">error</span>&nbsp;<span class="op" id="2180690">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2180693">//&nbsp;Fast&nbsp;path:&nbsp;if&nbsp;we&nbsp;can&nbsp;tell&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;directory&nbsp;or&nbsp;file,&nbsp;stop&nbsp;with&nbsp;success&nbsp;or&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180788">dir</span><span class="op" id="2180791">,</span>&nbsp;<span class="ident" id="2180793">err</span>&nbsp;<span class="op" id="2180797">:=</span>&nbsp;<span class="ident" id="2180800">Stat</span><span class="op" id="2180804">(</span><span class="ident" id="2180805">path</span><span class="op" id="2180809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180812">if</span>&nbsp;<span class="ident" id="2180815">err</span>&nbsp;<span class="op" id="2180819">==</span>&nbsp;<span class="ident" id="2180822">nil</span>&nbsp;<span class="op" id="2180826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180830">if</span>&nbsp;<span class="ident" id="2180833">dir</span><span class="op" id="2180836">.</span><span class="ident" id="2180837">IsDir</span><span class="op" id="2180842">(</span><span class="op" id="2180843">)</span>&nbsp;<span class="op" id="2180845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180850">return</span>&nbsp;<span class="ident" id="2180857">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180867">return</span>&nbsp;<span class="op" id="2180874">&amp;</span><span class="ident" id="2180875">PathError</span><span class="op" id="2180884">{</span><span class="string" id="2180885">&#34;mkdir&#34;</span><span class="op" id="2180892">,</span>&nbsp;<span class="ident" id="2180894">path</span><span class="op" id="2180898">,</span>&nbsp;<span class="ident" id="2180900">syscall</span><span class="op" id="2180907">.</span><span class="ident" id="2180908">ENOTDIR</span><span class="op" id="2180915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2180922">//&nbsp;Slow&nbsp;path:&nbsp;make&nbsp;sure&nbsp;parent&nbsp;exists&nbsp;and&nbsp;then&nbsp;call&nbsp;Mkdir&nbsp;for&nbsp;path.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180991">i</span>&nbsp;<span class="op" id="2180993">:=</span>&nbsp;<span class="builtinfunc" id="2180996">len</span><span class="op" id="2180999">(</span><span class="ident" id="2181000">path</span><span class="op" id="2181004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181007">for</span>&nbsp;<span class="ident" id="2181011">i</span>&nbsp;<span class="op" id="2181013">&gt;</span>&nbsp;<span class="num" id="2181015">0</span>&nbsp;<span class="op" id="2181017">&amp;&amp;</span>&nbsp;<span class="ident" id="2181020">IsPathSeparator</span><span class="op" id="2181035">(</span><span class="ident" id="2181036">path</span><span class="op" id="2181040">[</span><span class="ident" id="2181041">i</span><span class="op" id="2181042">-</span><span class="num" id="2181043">1</span><span class="op" id="2181044">]</span><span class="op" id="2181045">)</span>&nbsp;<span class="op" id="2181047">{</span>&nbsp;<span class="comment" id="2181049">//&nbsp;Skip&nbsp;trailing&nbsp;path&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181084">i</span><span class="op" id="2181085">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181093">j</span>&nbsp;<span class="op" id="2181095">:=</span>&nbsp;<span class="ident" id="2181098">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181101">for</span>&nbsp;<span class="ident" id="2181105">j</span>&nbsp;<span class="op" id="2181107">&gt;</span>&nbsp;<span class="num" id="2181109">0</span>&nbsp;<span class="op" id="2181111">&amp;&amp;</span>&nbsp;<span class="op" id="2181114">!</span><span class="ident" id="2181115">IsPathSeparator</span><span class="op" id="2181130">(</span><span class="ident" id="2181131">path</span><span class="op" id="2181135">[</span><span class="ident" id="2181136">j</span><span class="op" id="2181137">-</span><span class="num" id="2181138">1</span><span class="op" id="2181139">]</span><span class="op" id="2181140">)</span>&nbsp;<span class="op" id="2181142">{</span>&nbsp;<span class="comment" id="2181144">//&nbsp;Scan&nbsp;backward&nbsp;over&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181177">j</span><span class="op" id="2181178">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181186">if</span>&nbsp;<span class="ident" id="2181189">j</span>&nbsp;<span class="op" id="2181191">&gt;</span>&nbsp;<span class="num" id="2181193">1</span>&nbsp;<span class="op" id="2181195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2181199">//&nbsp;Create&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181218">err</span>&nbsp;<span class="op" id="2181222">=</span>&nbsp;<span class="ident" id="2181224">MkdirAll</span><span class="op" id="2181232">(</span><span class="ident" id="2181233">path</span><span class="op" id="2181237">[</span><span class="num" id="2181238">0</span><span class="op" id="2181239">:</span><span class="ident" id="2181240">j</span><span class="op" id="2181241">-</span><span class="num" id="2181242">1</span><span class="op" id="2181243">]</span><span class="op" id="2181244">,</span>&nbsp;<span class="ident" id="2181246">perm</span><span class="op" id="2181250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181254">if</span>&nbsp;<span class="ident" id="2181257">err</span>&nbsp;<span class="op" id="2181261">!=</span>&nbsp;<span class="ident" id="2181264">nil</span>&nbsp;<span class="op" id="2181268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181273">return</span>&nbsp;<span class="ident" id="2181280">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2181293">//&nbsp;Parent&nbsp;now&nbsp;exists;&nbsp;invoke&nbsp;Mkdir&nbsp;and&nbsp;use&nbsp;its&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181349">err</span>&nbsp;<span class="op" id="2181353">=</span>&nbsp;<span class="ident" id="2181355">Mkdir</span><span class="op" id="2181360">(</span><span class="ident" id="2181361">path</span><span class="op" id="2181365">,</span>&nbsp;<span class="ident" id="2181367">perm</span><span class="op" id="2181371">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181374">if</span>&nbsp;<span class="ident" id="2181377">err</span>&nbsp;<span class="op" id="2181381">!=</span>&nbsp;<span class="ident" id="2181384">nil</span>&nbsp;<span class="op" id="2181388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2181392">//&nbsp;Handle&nbsp;arguments&nbsp;like&nbsp;&#34;foo/.&#34;&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2181430">//&nbsp;double-checking&nbsp;that&nbsp;directory&nbsp;doesn&#39;t&nbsp;exist.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181481">dir</span><span class="op" id="2181484">,</span>&nbsp;<span class="ident" id="2181486">err1</span>&nbsp;<span class="op" id="2181491">:=</span>&nbsp;<span class="ident" id="2181494">Lstat</span><span class="op" id="2181499">(</span><span class="ident" id="2181500">path</span><span class="op" id="2181504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181508">if</span>&nbsp;<span class="ident" id="2181511">err1</span>&nbsp;<span class="op" id="2181516">==</span>&nbsp;<span class="ident" id="2181519">nil</span>&nbsp;<span class="op" id="2181523">&amp;&amp;</span>&nbsp;<span class="ident" id="2181526">dir</span><span class="op" id="2181529">.</span><span class="ident" id="2181530">IsDir</span><span class="op" id="2181535">(</span><span class="op" id="2181536">)</span>&nbsp;<span class="op" id="2181538">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181543">return</span>&nbsp;<span class="ident" id="2181550">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181560">return</span>&nbsp;<span class="ident" id="2181567">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181575">return</span>&nbsp;<span class="ident" id="2181582">nil</span><br>
<span class="lineno">60</span><span class="op" id="2181586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2181589">//&nbsp;RemoveAll&nbsp;removes&nbsp;path&nbsp;and&nbsp;any&nbsp;children&nbsp;it&nbsp;contains.</span><br>
<span class="lineno"></span><span class="comment" id="2181645">//&nbsp;It&nbsp;removes&nbsp;everything&nbsp;it&nbsp;can&nbsp;but&nbsp;returns&nbsp;the&nbsp;first&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2181705">//&nbsp;it&nbsp;encounters.&nbsp;&nbsp;If&nbsp;the&nbsp;path&nbsp;does&nbsp;not&nbsp;exist,&nbsp;RemoveAll</span><br>
<span class="lineno">65</span><span class="comment" id="2181762">//&nbsp;returns&nbsp;nil&nbsp;(no&nbsp;error).</span><br>
<span class="lineno"></span><span class="keyword" id="2181789">func</span>&nbsp;<span class="ident" id="2181794">RemoveAll</span><span class="op" id="2181803">(</span><span class="ident" id="2181804">path</span>&nbsp;<span class="builtintype" id="2181809">string</span><span class="op" id="2181815">)</span>&nbsp;<span class="builtintype" id="2181817">error</span>&nbsp;<span class="op" id="2181823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2181826">//&nbsp;Simple&nbsp;case:&nbsp;if&nbsp;Remove&nbsp;works,&nbsp;we&#39;re&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181872">err</span>&nbsp;<span class="op" id="2181876">:=</span>&nbsp;<span class="ident" id="2181879">Remove</span><span class="op" id="2181885">(</span><span class="ident" id="2181886">path</span><span class="op" id="2181890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181893">if</span>&nbsp;<span class="ident" id="2181896">err</span>&nbsp;<span class="op" id="2181900">==</span>&nbsp;<span class="ident" id="2181903">nil</span>&nbsp;<span class="op" id="2181907">||</span>&nbsp;<span class="ident" id="2181910">IsNotExist</span><span class="op" id="2181920">(</span><span class="ident" id="2181921">err</span><span class="op" id="2181924">)</span>&nbsp;<span class="op" id="2181926">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181930">return</span>&nbsp;<span class="ident" id="2181937">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2181946">//&nbsp;Otherwise,&nbsp;is&nbsp;this&nbsp;a&nbsp;directory&nbsp;we&nbsp;need&nbsp;to&nbsp;recurse&nbsp;into?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182006">dir</span><span class="op" id="2182009">,</span>&nbsp;<span class="ident" id="2182011">serr</span>&nbsp;<span class="op" id="2182016">:=</span>&nbsp;<span class="ident" id="2182019">Lstat</span><span class="op" id="2182024">(</span><span class="ident" id="2182025">path</span><span class="op" id="2182029">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182032">if</span>&nbsp;<span class="ident" id="2182035">serr</span>&nbsp;<span class="op" id="2182040">!=</span>&nbsp;<span class="ident" id="2182043">nil</span>&nbsp;<span class="op" id="2182047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182051">if</span>&nbsp;<span class="ident" id="2182054">serr</span><span class="op" id="2182058">,</span>&nbsp;<span class="ident" id="2182060">ok</span>&nbsp;<span class="op" id="2182063">:=</span>&nbsp;<span class="ident" id="2182066">serr</span><span class="op" id="2182070">.</span><span class="op" id="2182071">(</span><span class="op" id="2182072">*</span><span class="ident" id="2182073">PathError</span><span class="op" id="2182082">)</span><span class="op" id="2182083">;</span>&nbsp;<span class="ident" id="2182085">ok</span>&nbsp;<span class="op" id="2182088">&amp;&amp;</span>&nbsp;<span class="op" id="2182091">(</span><span class="ident" id="2182092">IsNotExist</span><span class="op" id="2182102">(</span><span class="ident" id="2182103">serr</span><span class="op" id="2182107">.</span><span class="ident" id="2182108">Err</span><span class="op" id="2182111">)</span>&nbsp;<span class="op" id="2182113">||</span>&nbsp;<span class="ident" id="2182116">serr</span><span class="op" id="2182120">.</span><span class="ident" id="2182121">Err</span>&nbsp;<span class="op" id="2182125">==</span>&nbsp;<span class="ident" id="2182128">syscall</span><span class="op" id="2182135">.</span><span class="ident" id="2182136">ENOTDIR</span><span class="op" id="2182143">)</span>&nbsp;<span class="op" id="2182145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182150">return</span>&nbsp;<span class="ident" id="2182157">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182167">return</span>&nbsp;<span class="ident" id="2182174">serr</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182183">if</span>&nbsp;<span class="op" id="2182186">!</span><span class="ident" id="2182187">dir</span><span class="op" id="2182190">.</span><span class="ident" id="2182191">IsDir</span><span class="op" id="2182196">(</span><span class="op" id="2182197">)</span>&nbsp;<span class="op" id="2182199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182203">//&nbsp;Not&nbsp;a&nbsp;directory;&nbsp;return&nbsp;the&nbsp;error&nbsp;from&nbsp;Remove.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182255">return</span>&nbsp;<span class="ident" id="2182262">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182267">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182271">//&nbsp;Directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182286">fd</span><span class="op" id="2182288">,</span>&nbsp;<span class="ident" id="2182290">err</span>&nbsp;<span class="op" id="2182294">:=</span>&nbsp;<span class="ident" id="2182297">Open</span><span class="op" id="2182301">(</span><span class="ident" id="2182302">path</span><span class="op" id="2182306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182309">if</span>&nbsp;<span class="ident" id="2182312">err</span>&nbsp;<span class="op" id="2182316">!=</span>&nbsp;<span class="ident" id="2182319">nil</span>&nbsp;<span class="op" id="2182323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182327">if</span>&nbsp;<span class="ident" id="2182330">IsNotExist</span><span class="op" id="2182340">(</span><span class="ident" id="2182341">err</span><span class="op" id="2182344">)</span>&nbsp;<span class="op" id="2182346">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182351">//&nbsp;Race.&nbsp;It&nbsp;was&nbsp;deleted&nbsp;between&nbsp;the&nbsp;Lstat&nbsp;and&nbsp;Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182406">//&nbsp;Return&nbsp;nil&nbsp;per&nbsp;RemoveAll&#39;s&nbsp;docs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182445">return</span>&nbsp;<span class="ident" id="2182452">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182462">return</span>&nbsp;<span class="ident" id="2182469">err</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182478">//&nbsp;Remove&nbsp;contents&nbsp;&amp;&nbsp;return&nbsp;first&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182520">err</span>&nbsp;<span class="op" id="2182524">=</span>&nbsp;<span class="ident" id="2182526">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182531">for</span>&nbsp;<span class="op" id="2182535">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182539">names</span><span class="op" id="2182544">,</span>&nbsp;<span class="ident" id="2182546">err1</span>&nbsp;<span class="op" id="2182551">:=</span>&nbsp;<span class="ident" id="2182554">fd</span><span class="op" id="2182556">.</span><span class="ident" id="2182557">Readdirnames</span><span class="op" id="2182569">(</span><span class="num" id="2182570">100</span><span class="op" id="2182573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182577">for</span>&nbsp;<span class="ident" id="2182581">_</span><span class="op" id="2182582">,</span>&nbsp;<span class="ident" id="2182584">name</span>&nbsp;<span class="op" id="2182589">:=</span>&nbsp;<span class="keyword" id="2182592">range</span>&nbsp;<span class="ident" id="2182598">names</span>&nbsp;<span class="op" id="2182604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182609">err1</span>&nbsp;<span class="op" id="2182614">:=</span>&nbsp;<span class="ident" id="2182617">RemoveAll</span><span class="op" id="2182626">(</span><span class="ident" id="2182627">path</span>&nbsp;<span class="op" id="2182632">+</span>&nbsp;<span class="builtintype" id="2182634">string</span><span class="op" id="2182640">(</span><span class="ident" id="2182641">PathSeparator</span><span class="op" id="2182654">)</span>&nbsp;<span class="op" id="2182656">+</span>&nbsp;<span class="ident" id="2182658">name</span><span class="op" id="2182662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182667">if</span>&nbsp;<span class="ident" id="2182670">err</span>&nbsp;<span class="op" id="2182674">==</span>&nbsp;<span class="ident" id="2182677">nil</span>&nbsp;<span class="op" id="2182681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182687">err</span>&nbsp;<span class="op" id="2182691">=</span>&nbsp;<span class="ident" id="2182693">err1</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182709">if</span>&nbsp;<span class="ident" id="2182712">err1</span>&nbsp;<span class="op" id="2182717">==</span>&nbsp;<span class="ident" id="2182720">io</span><span class="op" id="2182722">.</span><span class="ident" id="2182723">EOF</span>&nbsp;<span class="op" id="2182727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182732">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182740">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182744">//&nbsp;If&nbsp;Readdirnames&nbsp;returned&nbsp;an&nbsp;error,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182792">if</span>&nbsp;<span class="ident" id="2182795">err</span>&nbsp;<span class="op" id="2182799">==</span>&nbsp;<span class="ident" id="2182802">nil</span>&nbsp;<span class="op" id="2182806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182811">err</span>&nbsp;<span class="op" id="2182815">=</span>&nbsp;<span class="ident" id="2182817">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182828">if</span>&nbsp;<span class="builtinfunc" id="2182831">len</span><span class="op" id="2182834">(</span><span class="ident" id="2182835">names</span><span class="op" id="2182840">)</span>&nbsp;<span class="op" id="2182842">==</span>&nbsp;<span class="num" id="2182845">0</span>&nbsp;<span class="op" id="2182847">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182852">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182867">//&nbsp;Close&nbsp;directory,&nbsp;because&nbsp;windows&nbsp;won&#39;t&nbsp;remove&nbsp;opened&nbsp;directory.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182935">fd</span><span class="op" id="2182937">.</span><span class="ident" id="2182938">Close</span><span class="op" id="2182943">(</span><span class="op" id="2182944">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182948">//&nbsp;Remove&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182970">err1</span>&nbsp;<span class="op" id="2182975">:=</span>&nbsp;<span class="ident" id="2182978">Remove</span><span class="op" id="2182984">(</span><span class="ident" id="2182985">path</span><span class="op" id="2182989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182992">if</span>&nbsp;<span class="ident" id="2182995">err1</span>&nbsp;<span class="op" id="2183000">==</span>&nbsp;<span class="ident" id="2183003">nil</span>&nbsp;<span class="op" id="2183007">||</span>&nbsp;<span class="ident" id="2183010">IsNotExist</span><span class="op" id="2183020">(</span><span class="ident" id="2183021">err1</span><span class="op" id="2183025">)</span>&nbsp;<span class="op" id="2183027">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183031">return</span>&nbsp;<span class="ident" id="2183038">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2183043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183046">if</span>&nbsp;<span class="ident" id="2183049">err</span>&nbsp;<span class="op" id="2183053">==</span>&nbsp;<span class="ident" id="2183056">nil</span>&nbsp;<span class="op" id="2183060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183064">err</span>&nbsp;<span class="op" id="2183068">=</span>&nbsp;<span class="ident" id="2183070">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2183076">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183079">return</span>&nbsp;<span class="ident" id="2183086">err</span><br>
<span class="lineno"></span><span class="op" id="2183090">}</span>
</div>
</body>
</html>
