<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2596596">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2596651">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2596705">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2596756">package</span>&nbsp;<span class="ident" id="2596764">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2596770">//&nbsp;Sleep&nbsp;pauses&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;for&nbsp;at&nbsp;least&nbsp;the&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="comment" id="2596837">//&nbsp;A&nbsp;negative&nbsp;or&nbsp;zero&nbsp;duration&nbsp;causes&nbsp;Sleep&nbsp;to&nbsp;return&nbsp;immediately.</span><br>
<span class="lineno"></span><span class="keyword" id="2596904">func</span>&nbsp;<span class="ident" id="2596909">Sleep</span><span class="op" id="2596914">(</span><span class="ident" id="2596915">d</span>&nbsp;<span class="ident" id="2596917">Duration</span><span class="op" id="2596925">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2596928">//&nbsp;runtimeNano&nbsp;returns&nbsp;the&nbsp;current&nbsp;value&nbsp;of&nbsp;the&nbsp;runtime&nbsp;clock&nbsp;in&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="2597006">func</span>&nbsp;<span class="ident" id="2597011">runtimeNano</span><span class="op" id="2597022">(</span><span class="op" id="2597023">)</span>&nbsp;<span class="ident" id="2597025">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2597032">//&nbsp;Interface&nbsp;to&nbsp;timers&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno">15</span><span class="comment" id="2597087">//&nbsp;Must&nbsp;be&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/runtime.h:/^struct.Timer$</span><br>
<span class="lineno"></span><span class="keyword" id="2597148">type</span>&nbsp;<span class="ident" id="2597153">runtimeTimer</span>&nbsp;<span class="keyword" id="2597166">struct</span>&nbsp;<span class="op" id="2597173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597176">i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2597183">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597188">when</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2597195">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597202">period</span>&nbsp;<span class="ident" id="2597209">int64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597216">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2597223">func</span><span class="op" id="2597227">(</span><span class="keyword" id="2597228">interface</span><span class="op" id="2597237">{</span><span class="op" id="2597238">}</span><span class="op" id="2597239">,</span>&nbsp;<span class="builtintype" id="2597241">uintptr</span><span class="op" id="2597248">)</span>&nbsp;<span class="comment" id="2597250">//&nbsp;NOTE:&nbsp;must&nbsp;not&nbsp;be&nbsp;closure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597280">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2597287">interface</span><span class="op" id="2597296">{</span><span class="op" id="2597297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597300">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2597307">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2597315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2597318">//&nbsp;when&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;setting&nbsp;the&nbsp;&#39;when&#39;&nbsp;field&nbsp;of&nbsp;a&nbsp;runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="2597395">//&nbsp;It&nbsp;returns&nbsp;what&nbsp;the&nbsp;time&nbsp;will&nbsp;be,&nbsp;in&nbsp;nanoseconds,&nbsp;Duration&nbsp;d&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span><span class="comment" id="2597474">//&nbsp;If&nbsp;d&nbsp;is&nbsp;negative,&nbsp;it&nbsp;is&nbsp;ignored.&nbsp;&nbsp;If&nbsp;the&nbsp;returned&nbsp;value&nbsp;would&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2597552">//&nbsp;zero&nbsp;because&nbsp;of&nbsp;an&nbsp;overflow,&nbsp;MaxInt64&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span><span class="keyword" id="2597606">func</span>&nbsp;<span class="ident" id="2597611">when</span><span class="op" id="2597615">(</span><span class="ident" id="2597616">d</span>&nbsp;<span class="ident" id="2597618">Duration</span><span class="op" id="2597626">)</span>&nbsp;<span class="ident" id="2597628">int64</span>&nbsp;<span class="op" id="2597634">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597637">if</span>&nbsp;<span class="ident" id="2597640">d</span>&nbsp;<span class="op" id="2597642">&lt;=</span>&nbsp;<span class="num" id="2597645">0</span>&nbsp;<span class="op" id="2597647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597651">return</span>&nbsp;<span class="ident" id="2597658">runtimeNano</span><span class="op" id="2597669">(</span><span class="op" id="2597670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2597673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597676">t</span>&nbsp;<span class="op" id="2597678">:=</span>&nbsp;<span class="ident" id="2597681">runtimeNano</span><span class="op" id="2597692">(</span><span class="op" id="2597693">)</span>&nbsp;<span class="op" id="2597695">+</span>&nbsp;<span class="ident" id="2597697">int64</span><span class="op" id="2597702">(</span><span class="ident" id="2597703">d</span><span class="op" id="2597704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597707">if</span>&nbsp;<span class="ident" id="2597710">t</span>&nbsp;<span class="op" id="2597712">&lt;</span>&nbsp;<span class="num" id="2597714">0</span>&nbsp;<span class="op" id="2597716">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597720">t</span>&nbsp;<span class="op" id="2597722">=</span>&nbsp;<span class="num" id="2597724">1</span><span class="op" id="2597725">&lt;&lt;</span><span class="num" id="2597727">63</span>&nbsp;<span class="op" id="2597730">-</span>&nbsp;<span class="num" id="2597732">1</span>&nbsp;<span class="comment" id="2597734">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2597752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597755">return</span>&nbsp;<span class="ident" id="2597762">t</span><br>
<span class="lineno"></span><span class="op" id="2597764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2597767">func</span>&nbsp;<span class="ident" id="2597772">startTimer</span><span class="op" id="2597782">(</span><span class="op" id="2597783">*</span><span class="ident" id="2597784">runtimeTimer</span><span class="op" id="2597796">)</span><br>
<span class="lineno"></span><span class="keyword" id="2597798">func</span>&nbsp;<span class="ident" id="2597803">stopTimer</span><span class="op" id="2597812">(</span><span class="op" id="2597813">*</span><span class="ident" id="2597814">runtimeTimer</span><span class="op" id="2597826">)</span>&nbsp;<span class="builtintype" id="2597828">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2597834">//&nbsp;The&nbsp;Timer&nbsp;type&nbsp;represents&nbsp;a&nbsp;single&nbsp;event.</span><br>
<span class="lineno"></span><span class="comment" id="2597879">//&nbsp;When&nbsp;the&nbsp;Timer&nbsp;expires,&nbsp;the&nbsp;current&nbsp;time&nbsp;will&nbsp;be&nbsp;sent&nbsp;on&nbsp;C,</span><br>
<span class="lineno">45</span><span class="comment" id="2597942">//&nbsp;unless&nbsp;the&nbsp;Timer&nbsp;was&nbsp;created&nbsp;by&nbsp;AfterFunc.</span><br>
<span class="lineno"></span><span class="comment" id="2597988">//&nbsp;A&nbsp;Timer&nbsp;must&nbsp;be&nbsp;created&nbsp;with&nbsp;NewTimer&nbsp;or&nbsp;AfterFunc.</span><br>
<span class="lineno"></span><span class="keyword" id="2598043">type</span>&nbsp;<span class="ident" id="2598048">Timer</span>&nbsp;<span class="keyword" id="2598054">struct</span>&nbsp;<span class="op" id="2598061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598064">C</span>&nbsp;<span class="op" id="2598066">&lt;-</span><span class="keyword" id="2598068">chan</span>&nbsp;<span class="ident" id="2598073">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598079">r</span>&nbsp;<span class="ident" id="2598081">runtimeTimer</span><br>
<span class="lineno">50</span><span class="op" id="2598094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2598097">//&nbsp;Stop&nbsp;prevents&nbsp;the&nbsp;Timer&nbsp;from&nbsp;firing.</span><br>
<span class="lineno"></span><span class="comment" id="2598137">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;call&nbsp;stops&nbsp;the&nbsp;timer,&nbsp;false&nbsp;if&nbsp;the&nbsp;timer&nbsp;has&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="2598216">//&nbsp;expired&nbsp;or&nbsp;been&nbsp;stopped.</span><br>
<span class="lineno">55</span><span class="comment" id="2598244">//&nbsp;Stop&nbsp;does&nbsp;not&nbsp;close&nbsp;the&nbsp;channel,&nbsp;to&nbsp;prevent&nbsp;a&nbsp;read&nbsp;from&nbsp;the&nbsp;channel&nbsp;succeeding</span><br>
<span class="lineno"></span><span class="comment" id="2598326">//&nbsp;incorrectly.</span><br>
<span class="lineno"></span><span class="keyword" id="2598342">func</span>&nbsp;<span class="op" id="2598347">(</span><span class="ident" id="2598348">t</span>&nbsp;<span class="op" id="2598350">*</span><span class="ident" id="2598351">Timer</span><span class="op" id="2598356">)</span>&nbsp;<span class="ident" id="2598358">Stop</span><span class="op" id="2598362">(</span><span class="op" id="2598363">)</span>&nbsp;<span class="builtintype" id="2598365">bool</span>&nbsp;<span class="op" id="2598370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598373">if</span>&nbsp;<span class="ident" id="2598376">t</span><span class="op" id="2598377">.</span><span class="ident" id="2598378">r</span><span class="op" id="2598379">.</span><span class="ident" id="2598380">f</span>&nbsp;<span class="op" id="2598382">==</span>&nbsp;<span class="ident" id="2598385">nil</span>&nbsp;<span class="op" id="2598389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2598393">panic</span><span class="op" id="2598398">(</span><span class="string" id="2598399">&#34;time:&nbsp;Stop&nbsp;called&nbsp;on&nbsp;uninitialized&nbsp;Timer&#34;</span><span class="op" id="2598441">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2598444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598447">return</span>&nbsp;<span class="ident" id="2598454">stopTimer</span><span class="op" id="2598463">(</span><span class="op" id="2598464">&amp;</span><span class="ident" id="2598465">t</span><span class="op" id="2598466">.</span><span class="ident" id="2598467">r</span><span class="op" id="2598468">)</span><br>
<span class="lineno"></span><span class="op" id="2598470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2598473">//&nbsp;NewTimer&nbsp;creates&nbsp;a&nbsp;new&nbsp;Timer&nbsp;that&nbsp;will&nbsp;send</span><br>
<span class="lineno">65</span><span class="comment" id="2598520">//&nbsp;the&nbsp;current&nbsp;time&nbsp;on&nbsp;its&nbsp;channel&nbsp;after&nbsp;at&nbsp;least&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="keyword" id="2598582">func</span>&nbsp;<span class="ident" id="2598587">NewTimer</span><span class="op" id="2598595">(</span><span class="ident" id="2598596">d</span>&nbsp;<span class="ident" id="2598598">Duration</span><span class="op" id="2598606">)</span>&nbsp;<span class="op" id="2598608">*</span><span class="ident" id="2598609">Timer</span>&nbsp;<span class="op" id="2598615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598618">c</span>&nbsp;<span class="op" id="2598620">:=</span>&nbsp;<span class="builtinfunc" id="2598623">make</span><span class="op" id="2598627">(</span><span class="keyword" id="2598628">chan</span>&nbsp;<span class="ident" id="2598633">Time</span><span class="op" id="2598637">,</span>&nbsp;<span class="num" id="2598639">1</span><span class="op" id="2598640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598643">t</span>&nbsp;<span class="op" id="2598645">:=</span>&nbsp;<span class="op" id="2598648">&amp;</span><span class="ident" id="2598649">Timer</span><span class="op" id="2598654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598658">C</span><span class="op" id="2598659">:</span>&nbsp;<span class="ident" id="2598661">c</span><span class="op" id="2598662">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598666">r</span><span class="op" id="2598667">:</span>&nbsp;<span class="ident" id="2598669">runtimeTimer</span><span class="op" id="2598681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598686">when</span><span class="op" id="2598690">:</span>&nbsp;<span class="ident" id="2598692">when</span><span class="op" id="2598696">(</span><span class="ident" id="2598697">d</span><span class="op" id="2598698">)</span><span class="op" id="2598699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598704">f</span><span class="op" id="2598705">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2598710">sendTime</span><span class="op" id="2598718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598723">arg</span><span class="op" id="2598726">:</span>&nbsp;&nbsp;<span class="ident" id="2598729">c</span><span class="op" id="2598730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2598734">}</span><span class="op" id="2598735">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2598738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598741">startTimer</span><span class="op" id="2598751">(</span><span class="op" id="2598752">&amp;</span><span class="ident" id="2598753">t</span><span class="op" id="2598754">.</span><span class="ident" id="2598755">r</span><span class="op" id="2598756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598759">return</span>&nbsp;<span class="ident" id="2598766">t</span><br>
<span class="lineno"></span><span class="op" id="2598768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="2598771">//&nbsp;Reset&nbsp;changes&nbsp;the&nbsp;timer&nbsp;to&nbsp;expire&nbsp;after&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="comment" id="2598826">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;timer&nbsp;had&nbsp;been&nbsp;active,&nbsp;false&nbsp;if&nbsp;the&nbsp;timer&nbsp;had</span><br>
<span class="lineno"></span><span class="comment" id="2598898">//&nbsp;expired&nbsp;or&nbsp;been&nbsp;stopped.</span><br>
<span class="lineno"></span><span class="keyword" id="2598926">func</span>&nbsp;<span class="op" id="2598931">(</span><span class="ident" id="2598932">t</span>&nbsp;<span class="op" id="2598934">*</span><span class="ident" id="2598935">Timer</span><span class="op" id="2598940">)</span>&nbsp;<span class="ident" id="2598942">Reset</span><span class="op" id="2598947">(</span><span class="ident" id="2598948">d</span>&nbsp;<span class="ident" id="2598950">Duration</span><span class="op" id="2598958">)</span>&nbsp;<span class="builtintype" id="2598960">bool</span>&nbsp;<span class="op" id="2598965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598968">if</span>&nbsp;<span class="ident" id="2598971">t</span><span class="op" id="2598972">.</span><span class="ident" id="2598973">r</span><span class="op" id="2598974">.</span><span class="ident" id="2598975">f</span>&nbsp;<span class="op" id="2598977">==</span>&nbsp;<span class="ident" id="2598980">nil</span>&nbsp;<span class="op" id="2598984">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2598988">panic</span><span class="op" id="2598993">(</span><span class="string" id="2598994">&#34;time:&nbsp;Reset&nbsp;called&nbsp;on&nbsp;uninitialized&nbsp;Timer&#34;</span><span class="op" id="2599037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599043">w</span>&nbsp;<span class="op" id="2599045">:=</span>&nbsp;<span class="ident" id="2599048">when</span><span class="op" id="2599052">(</span><span class="ident" id="2599053">d</span><span class="op" id="2599054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599057">active</span>&nbsp;<span class="op" id="2599064">:=</span>&nbsp;<span class="ident" id="2599067">stopTimer</span><span class="op" id="2599076">(</span><span class="op" id="2599077">&amp;</span><span class="ident" id="2599078">t</span><span class="op" id="2599079">.</span><span class="ident" id="2599080">r</span><span class="op" id="2599081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599084">t</span><span class="op" id="2599085">.</span><span class="ident" id="2599086">r</span><span class="op" id="2599087">.</span><span class="ident" id="2599088">when</span>&nbsp;<span class="op" id="2599093">=</span>&nbsp;<span class="ident" id="2599095">w</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599098">startTimer</span><span class="op" id="2599108">(</span><span class="op" id="2599109">&amp;</span><span class="ident" id="2599110">t</span><span class="op" id="2599111">.</span><span class="ident" id="2599112">r</span><span class="op" id="2599113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599116">return</span>&nbsp;<span class="ident" id="2599123">active</span><br>
<span class="lineno"></span><span class="op" id="2599130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2599133">func</span>&nbsp;<span class="ident" id="2599138">sendTime</span><span class="op" id="2599146">(</span><span class="ident" id="2599147">c</span>&nbsp;<span class="keyword" id="2599149">interface</span><span class="op" id="2599158">{</span><span class="op" id="2599159">}</span><span class="op" id="2599160">,</span>&nbsp;<span class="ident" id="2599162">seq</span>&nbsp;<span class="builtintype" id="2599166">uintptr</span><span class="op" id="2599173">)</span>&nbsp;<span class="op" id="2599175">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2599178">//&nbsp;Non-blocking&nbsp;send&nbsp;of&nbsp;time&nbsp;on&nbsp;c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2599214">//&nbsp;Used&nbsp;in&nbsp;NewTimer,&nbsp;it&nbsp;cannot&nbsp;block&nbsp;anyway&nbsp;(buffer).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2599269">//&nbsp;Used&nbsp;in&nbsp;NewTicker,&nbsp;dropping&nbsp;sends&nbsp;on&nbsp;the&nbsp;floor&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2599323">//&nbsp;the&nbsp;desired&nbsp;behavior&nbsp;when&nbsp;the&nbsp;reader&nbsp;gets&nbsp;behind,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2599377">//&nbsp;because&nbsp;the&nbsp;sends&nbsp;are&nbsp;periodic.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599413">select</span>&nbsp;<span class="op" id="2599420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599423">case</span>&nbsp;<span class="ident" id="2599428">c</span><span class="op" id="2599429">.</span><span class="op" id="2599430">(</span><span class="keyword" id="2599431">chan</span>&nbsp;<span class="ident" id="2599436">Time</span><span class="op" id="2599440">)</span>&nbsp;<span class="op" id="2599442">&lt;-</span>&nbsp;<span class="ident" id="2599445">Now</span><span class="op" id="2599448">(</span><span class="op" id="2599449">)</span><span class="op" id="2599450">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599453">default</span><span class="op" id="2599460">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599463">}</span><br>
<span class="lineno"></span><span class="op" id="2599465">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="2599468">//&nbsp;After&nbsp;waits&nbsp;for&nbsp;the&nbsp;duration&nbsp;to&nbsp;elapse&nbsp;and&nbsp;then&nbsp;sends&nbsp;the&nbsp;current&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2599542">//&nbsp;on&nbsp;the&nbsp;returned&nbsp;channel.</span><br>
<span class="lineno"></span><span class="comment" id="2599570">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;NewTimer(d).C.</span><br>
<span class="lineno"></span><span class="keyword" id="2599608">func</span>&nbsp;<span class="ident" id="2599613">After</span><span class="op" id="2599618">(</span><span class="ident" id="2599619">d</span>&nbsp;<span class="ident" id="2599621">Duration</span><span class="op" id="2599629">)</span>&nbsp;<span class="op" id="2599631">&lt;-</span><span class="keyword" id="2599633">chan</span>&nbsp;<span class="ident" id="2599638">Time</span>&nbsp;<span class="op" id="2599643">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599646">return</span>&nbsp;<span class="ident" id="2599653">NewTimer</span><span class="op" id="2599661">(</span><span class="ident" id="2599662">d</span><span class="op" id="2599663">)</span><span class="op" id="2599664">.</span><span class="ident" id="2599665">C</span><br>
<span class="lineno"></span><span class="op" id="2599667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2599670">//&nbsp;AfterFunc&nbsp;waits&nbsp;for&nbsp;the&nbsp;duration&nbsp;to&nbsp;elapse&nbsp;and&nbsp;then&nbsp;calls&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="2599733">//&nbsp;in&nbsp;its&nbsp;own&nbsp;goroutine.&nbsp;It&nbsp;returns&nbsp;a&nbsp;Timer&nbsp;that&nbsp;can</span><br>
<span class="lineno">115</span><span class="comment" id="2599786">//&nbsp;be&nbsp;used&nbsp;to&nbsp;cancel&nbsp;the&nbsp;call&nbsp;using&nbsp;its&nbsp;Stop&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2599839">func</span>&nbsp;<span class="ident" id="2599844">AfterFunc</span><span class="op" id="2599853">(</span><span class="ident" id="2599854">d</span>&nbsp;<span class="ident" id="2599856">Duration</span><span class="op" id="2599864">,</span>&nbsp;<span class="ident" id="2599866">f</span>&nbsp;<span class="keyword" id="2599868">func</span><span class="op" id="2599872">(</span><span class="op" id="2599873">)</span><span class="op" id="2599874">)</span>&nbsp;<span class="op" id="2599876">*</span><span class="ident" id="2599877">Timer</span>&nbsp;<span class="op" id="2599883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599886">t</span>&nbsp;<span class="op" id="2599888">:=</span>&nbsp;<span class="op" id="2599891">&amp;</span><span class="ident" id="2599892">Timer</span><span class="op" id="2599897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599901">r</span><span class="op" id="2599902">:</span>&nbsp;<span class="ident" id="2599904">runtimeTimer</span><span class="op" id="2599916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599921">when</span><span class="op" id="2599925">:</span>&nbsp;<span class="ident" id="2599927">when</span><span class="op" id="2599931">(</span><span class="ident" id="2599932">d</span><span class="op" id="2599933">)</span><span class="op" id="2599934">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599939">f</span><span class="op" id="2599940">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2599945">goFunc</span><span class="op" id="2599951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599956">arg</span><span class="op" id="2599959">:</span>&nbsp;&nbsp;<span class="ident" id="2599962">f</span><span class="op" id="2599963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599967">}</span><span class="op" id="2599968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599974">startTimer</span><span class="op" id="2599984">(</span><span class="op" id="2599985">&amp;</span><span class="ident" id="2599986">t</span><span class="op" id="2599987">.</span><span class="ident" id="2599988">r</span><span class="op" id="2599989">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599992">return</span>&nbsp;<span class="ident" id="2599999">t</span><br>
<span class="lineno"></span><span class="op" id="2600001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2600004">func</span>&nbsp;<span class="ident" id="2600009">goFunc</span><span class="op" id="2600015">(</span><span class="ident" id="2600016">arg</span>&nbsp;<span class="keyword" id="2600020">interface</span><span class="op" id="2600029">{</span><span class="op" id="2600030">}</span><span class="op" id="2600031">,</span>&nbsp;<span class="ident" id="2600033">seq</span>&nbsp;<span class="builtintype" id="2600037">uintptr</span><span class="op" id="2600044">)</span>&nbsp;<span class="op" id="2600046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600049">go</span>&nbsp;<span class="ident" id="2600052">arg</span><span class="op" id="2600055">.</span><span class="op" id="2600056">(</span><span class="keyword" id="2600057">func</span><span class="op" id="2600061">(</span><span class="op" id="2600062">)</span><span class="op" id="2600063">)</span><span class="op" id="2600064">(</span><span class="op" id="2600065">)</span><br>
<span class="lineno">130</span><span class="op" id="2600067">}</span>
</div>
</body>
</html>
