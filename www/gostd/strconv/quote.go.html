<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2292760">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2292815">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2292869">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2292920">//go:generate&nbsp;go&nbsp;run&nbsp;makeisprint.go&nbsp;-output&nbsp;isprint.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2292976">package</span>&nbsp;<span class="ident" id="2292984">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2292993">import</span>&nbsp;<span class="op" id="2293000">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2293003">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2293018">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2293021">const</span>&nbsp;<span class="ident" id="2293027">lowerhex</span>&nbsp;<span class="op" id="2293036">=</span>&nbsp;<span class="string" id="2293038">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2293058">func</span>&nbsp;<span class="ident" id="2293063">quoteWith</span><span class="op" id="2293072">(</span><span class="ident" id="2293073">s</span>&nbsp;<span class="builtintype" id="2293075">string</span><span class="op" id="2293081">,</span>&nbsp;<span class="ident" id="2293083">quote</span>&nbsp;<span class="builtintype" id="2293089">byte</span><span class="op" id="2293093">,</span>&nbsp;<span class="ident" id="2293095">ASCIIonly</span>&nbsp;<span class="builtintype" id="2293105">bool</span><span class="op" id="2293109">)</span>&nbsp;<span class="builtintype" id="2293111">string</span>&nbsp;<span class="op" id="2293118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293121">var</span>&nbsp;<span class="ident" id="2293125">runeTmp</span>&nbsp;<span class="op" id="2293133">[</span><span class="ident" id="2293134">utf8</span><span class="op" id="2293138">.</span><span class="ident" id="2293139">UTFMax</span><span class="op" id="2293145">]</span><span class="builtintype" id="2293146">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293152">buf</span>&nbsp;<span class="op" id="2293156">:=</span>&nbsp;<span class="builtinfunc" id="2293159">make</span><span class="op" id="2293163">(</span><span class="op" id="2293164">[</span><span class="op" id="2293165">]</span><span class="builtintype" id="2293166">byte</span><span class="op" id="2293170">,</span>&nbsp;<span class="num" id="2293172">0</span><span class="op" id="2293173">,</span>&nbsp;<span class="num" id="2293175">3</span><span class="op" id="2293176">*</span><span class="builtinfunc" id="2293177">len</span><span class="op" id="2293180">(</span><span class="ident" id="2293181">s</span><span class="op" id="2293182">)</span><span class="op" id="2293183">/</span><span class="num" id="2293184">2</span><span class="op" id="2293185">)</span>&nbsp;<span class="comment" id="2293187">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293222">buf</span>&nbsp;<span class="op" id="2293226">=</span>&nbsp;<span class="builtinfunc" id="2293228">append</span><span class="op" id="2293234">(</span><span class="ident" id="2293235">buf</span><span class="op" id="2293238">,</span>&nbsp;<span class="ident" id="2293240">quote</span><span class="op" id="2293245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293248">for</span>&nbsp;<span class="ident" id="2293252">width</span>&nbsp;<span class="op" id="2293258">:=</span>&nbsp;<span class="num" id="2293261">0</span><span class="op" id="2293262">;</span>&nbsp;<span class="builtinfunc" id="2293264">len</span><span class="op" id="2293267">(</span><span class="ident" id="2293268">s</span><span class="op" id="2293269">)</span>&nbsp;<span class="op" id="2293271">&gt;</span>&nbsp;<span class="num" id="2293273">0</span><span class="op" id="2293274">;</span>&nbsp;<span class="ident" id="2293276">s</span>&nbsp;<span class="op" id="2293278">=</span>&nbsp;<span class="ident" id="2293280">s</span><span class="op" id="2293281">[</span><span class="ident" id="2293282">width</span><span class="op" id="2293287">:</span><span class="op" id="2293288">]</span>&nbsp;<span class="op" id="2293290">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293294">r</span>&nbsp;<span class="op" id="2293296">:=</span>&nbsp;<span class="builtintype" id="2293299">rune</span><span class="op" id="2293303">(</span><span class="ident" id="2293304">s</span><span class="op" id="2293305">[</span><span class="num" id="2293306">0</span><span class="op" id="2293307">]</span><span class="op" id="2293308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293312">width</span>&nbsp;<span class="op" id="2293318">=</span>&nbsp;<span class="num" id="2293320">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293324">if</span>&nbsp;<span class="ident" id="2293327">r</span>&nbsp;<span class="op" id="2293329">&gt;=</span>&nbsp;<span class="ident" id="2293332">utf8</span><span class="op" id="2293336">.</span><span class="ident" id="2293337">RuneSelf</span>&nbsp;<span class="op" id="2293346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293351">r</span><span class="op" id="2293352">,</span>&nbsp;<span class="ident" id="2293354">width</span>&nbsp;<span class="op" id="2293360">=</span>&nbsp;<span class="ident" id="2293362">utf8</span><span class="op" id="2293366">.</span><span class="ident" id="2293367">DecodeRuneInString</span><span class="op" id="2293385">(</span><span class="ident" id="2293386">s</span><span class="op" id="2293387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293391">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293395">if</span>&nbsp;<span class="ident" id="2293398">width</span>&nbsp;<span class="op" id="2293404">==</span>&nbsp;<span class="num" id="2293407">1</span>&nbsp;<span class="op" id="2293409">&amp;&amp;</span>&nbsp;<span class="ident" id="2293412">r</span>&nbsp;<span class="op" id="2293414">==</span>&nbsp;<span class="ident" id="2293417">utf8</span><span class="op" id="2293421">.</span><span class="ident" id="2293422">RuneError</span>&nbsp;<span class="op" id="2293432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293437">buf</span>&nbsp;<span class="op" id="2293441">=</span>&nbsp;<span class="builtinfunc" id="2293443">append</span><span class="op" id="2293449">(</span><span class="ident" id="2293450">buf</span><span class="op" id="2293453">,</span>&nbsp;<span class="string" id="2293455">`\x`</span><span class="op" id="2293459">...</span><span class="op" id="2293462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293467">buf</span>&nbsp;<span class="op" id="2293471">=</span>&nbsp;<span class="builtinfunc" id="2293473">append</span><span class="op" id="2293479">(</span><span class="ident" id="2293480">buf</span><span class="op" id="2293483">,</span>&nbsp;<span class="ident" id="2293485">lowerhex</span><span class="op" id="2293493">[</span><span class="ident" id="2293494">s</span><span class="op" id="2293495">[</span><span class="num" id="2293496">0</span><span class="op" id="2293497">]</span><span class="op" id="2293498">&gt;&gt;</span><span class="num" id="2293500">4</span><span class="op" id="2293501">]</span><span class="op" id="2293502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293507">buf</span>&nbsp;<span class="op" id="2293511">=</span>&nbsp;<span class="builtinfunc" id="2293513">append</span><span class="op" id="2293519">(</span><span class="ident" id="2293520">buf</span><span class="op" id="2293523">,</span>&nbsp;<span class="ident" id="2293525">lowerhex</span><span class="op" id="2293533">[</span><span class="ident" id="2293534">s</span><span class="op" id="2293535">[</span><span class="num" id="2293536">0</span><span class="op" id="2293537">]</span><span class="op" id="2293538">&amp;</span><span class="num" id="2293539">0xF</span><span class="op" id="2293542">]</span><span class="op" id="2293543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293548">continue</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293563">if</span>&nbsp;<span class="ident" id="2293566">r</span>&nbsp;<span class="op" id="2293568">==</span>&nbsp;<span class="builtintype" id="2293571">rune</span><span class="op" id="2293575">(</span><span class="ident" id="2293576">quote</span><span class="op" id="2293581">)</span>&nbsp;<span class="op" id="2293583">||</span>&nbsp;<span class="ident" id="2293586">r</span>&nbsp;<span class="op" id="2293588">==</span>&nbsp;<span class="string" id="2293591">&#39;\\&#39;</span>&nbsp;<span class="op" id="2293596">{</span>&nbsp;<span class="comment" id="2293598">//&nbsp;always&nbsp;backslashed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293623">buf</span>&nbsp;<span class="op" id="2293627">=</span>&nbsp;<span class="builtinfunc" id="2293629">append</span><span class="op" id="2293635">(</span><span class="ident" id="2293636">buf</span><span class="op" id="2293639">,</span>&nbsp;<span class="string" id="2293641">&#39;\\&#39;</span><span class="op" id="2293645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293650">buf</span>&nbsp;<span class="op" id="2293654">=</span>&nbsp;<span class="builtinfunc" id="2293656">append</span><span class="op" id="2293662">(</span><span class="ident" id="2293663">buf</span><span class="op" id="2293666">,</span>&nbsp;<span class="builtintype" id="2293668">byte</span><span class="op" id="2293672">(</span><span class="ident" id="2293673">r</span><span class="op" id="2293674">)</span><span class="op" id="2293675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293680">continue</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293695">if</span>&nbsp;<span class="ident" id="2293698">ASCIIonly</span>&nbsp;<span class="op" id="2293708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293713">if</span>&nbsp;<span class="ident" id="2293716">r</span>&nbsp;<span class="op" id="2293718">&lt;</span>&nbsp;<span class="ident" id="2293720">utf8</span><span class="op" id="2293724">.</span><span class="ident" id="2293725">RuneSelf</span>&nbsp;<span class="op" id="2293734">&amp;&amp;</span>&nbsp;<span class="ident" id="2293737">IsPrint</span><span class="op" id="2293744">(</span><span class="ident" id="2293745">r</span><span class="op" id="2293746">)</span>&nbsp;<span class="op" id="2293748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293754">buf</span>&nbsp;<span class="op" id="2293758">=</span>&nbsp;<span class="builtinfunc" id="2293760">append</span><span class="op" id="2293766">(</span><span class="ident" id="2293767">buf</span><span class="op" id="2293770">,</span>&nbsp;<span class="builtintype" id="2293772">byte</span><span class="op" id="2293776">(</span><span class="ident" id="2293777">r</span><span class="op" id="2293778">)</span><span class="op" id="2293779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293785">continue</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293801">}</span>&nbsp;<span class="keyword" id="2293803">else</span>&nbsp;<span class="keyword" id="2293808">if</span>&nbsp;<span class="ident" id="2293811">IsPrint</span><span class="op" id="2293818">(</span><span class="ident" id="2293819">r</span><span class="op" id="2293820">)</span>&nbsp;<span class="op" id="2293822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293827">n</span>&nbsp;<span class="op" id="2293829">:=</span>&nbsp;<span class="ident" id="2293832">utf8</span><span class="op" id="2293836">.</span><span class="ident" id="2293837">EncodeRune</span><span class="op" id="2293847">(</span><span class="ident" id="2293848">runeTmp</span><span class="op" id="2293855">[</span><span class="op" id="2293856">:</span><span class="op" id="2293857">]</span><span class="op" id="2293858">,</span>&nbsp;<span class="ident" id="2293860">r</span><span class="op" id="2293861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293866">buf</span>&nbsp;<span class="op" id="2293870">=</span>&nbsp;<span class="builtinfunc" id="2293872">append</span><span class="op" id="2293878">(</span><span class="ident" id="2293879">buf</span><span class="op" id="2293882">,</span>&nbsp;<span class="ident" id="2293884">runeTmp</span><span class="op" id="2293891">[</span><span class="op" id="2293892">:</span><span class="ident" id="2293893">n</span><span class="op" id="2293894">]</span><span class="op" id="2293895">...</span><span class="op" id="2293898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293903">continue</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293918">switch</span>&nbsp;<span class="ident" id="2293925">r</span>&nbsp;<span class="op" id="2293927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293931">case</span>&nbsp;<span class="string" id="2293936">&#39;\a&#39;</span><span class="op" id="2293940">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293945">buf</span>&nbsp;<span class="op" id="2293949">=</span>&nbsp;<span class="builtinfunc" id="2293951">append</span><span class="op" id="2293957">(</span><span class="ident" id="2293958">buf</span><span class="op" id="2293961">,</span>&nbsp;<span class="string" id="2293963">`\a`</span><span class="op" id="2293967">...</span><span class="op" id="2293970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293974">case</span>&nbsp;<span class="string" id="2293979">&#39;\b&#39;</span><span class="op" id="2293983">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293988">buf</span>&nbsp;<span class="op" id="2293992">=</span>&nbsp;<span class="builtinfunc" id="2293994">append</span><span class="op" id="2294000">(</span><span class="ident" id="2294001">buf</span><span class="op" id="2294004">,</span>&nbsp;<span class="string" id="2294006">`\b`</span><span class="op" id="2294010">...</span><span class="op" id="2294013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294017">case</span>&nbsp;<span class="string" id="2294022">&#39;\f&#39;</span><span class="op" id="2294026">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294031">buf</span>&nbsp;<span class="op" id="2294035">=</span>&nbsp;<span class="builtinfunc" id="2294037">append</span><span class="op" id="2294043">(</span><span class="ident" id="2294044">buf</span><span class="op" id="2294047">,</span>&nbsp;<span class="string" id="2294049">`\f`</span><span class="op" id="2294053">...</span><span class="op" id="2294056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294060">case</span>&nbsp;<span class="string" id="2294065">&#39;\n&#39;</span><span class="op" id="2294069">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294074">buf</span>&nbsp;<span class="op" id="2294078">=</span>&nbsp;<span class="builtinfunc" id="2294080">append</span><span class="op" id="2294086">(</span><span class="ident" id="2294087">buf</span><span class="op" id="2294090">,</span>&nbsp;<span class="string" id="2294092">`\n`</span><span class="op" id="2294096">...</span><span class="op" id="2294099">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294103">case</span>&nbsp;<span class="string" id="2294108">&#39;\r&#39;</span><span class="op" id="2294112">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294117">buf</span>&nbsp;<span class="op" id="2294121">=</span>&nbsp;<span class="builtinfunc" id="2294123">append</span><span class="op" id="2294129">(</span><span class="ident" id="2294130">buf</span><span class="op" id="2294133">,</span>&nbsp;<span class="string" id="2294135">`\r`</span><span class="op" id="2294139">...</span><span class="op" id="2294142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294146">case</span>&nbsp;<span class="string" id="2294151">&#39;\t&#39;</span><span class="op" id="2294155">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294160">buf</span>&nbsp;<span class="op" id="2294164">=</span>&nbsp;<span class="builtinfunc" id="2294166">append</span><span class="op" id="2294172">(</span><span class="ident" id="2294173">buf</span><span class="op" id="2294176">,</span>&nbsp;<span class="string" id="2294178">`\t`</span><span class="op" id="2294182">...</span><span class="op" id="2294185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294189">case</span>&nbsp;<span class="string" id="2294194">&#39;\v&#39;</span><span class="op" id="2294198">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294203">buf</span>&nbsp;<span class="op" id="2294207">=</span>&nbsp;<span class="builtinfunc" id="2294209">append</span><span class="op" id="2294215">(</span><span class="ident" id="2294216">buf</span><span class="op" id="2294219">,</span>&nbsp;<span class="string" id="2294221">`\v`</span><span class="op" id="2294225">...</span><span class="op" id="2294228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294232">default</span><span class="op" id="2294239">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294244">switch</span>&nbsp;<span class="op" id="2294251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294256">case</span>&nbsp;<span class="ident" id="2294261">r</span>&nbsp;<span class="op" id="2294263">&lt;</span>&nbsp;<span class="string" id="2294265">&#39;&nbsp;&#39;</span><span class="op" id="2294268">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294274">buf</span>&nbsp;<span class="op" id="2294278">=</span>&nbsp;<span class="builtinfunc" id="2294280">append</span><span class="op" id="2294286">(</span><span class="ident" id="2294287">buf</span><span class="op" id="2294290">,</span>&nbsp;<span class="string" id="2294292">`\x`</span><span class="op" id="2294296">...</span><span class="op" id="2294299">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294305">buf</span>&nbsp;<span class="op" id="2294309">=</span>&nbsp;<span class="builtinfunc" id="2294311">append</span><span class="op" id="2294317">(</span><span class="ident" id="2294318">buf</span><span class="op" id="2294321">,</span>&nbsp;<span class="ident" id="2294323">lowerhex</span><span class="op" id="2294331">[</span><span class="ident" id="2294332">s</span><span class="op" id="2294333">[</span><span class="num" id="2294334">0</span><span class="op" id="2294335">]</span><span class="op" id="2294336">&gt;&gt;</span><span class="num" id="2294338">4</span><span class="op" id="2294339">]</span><span class="op" id="2294340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294346">buf</span>&nbsp;<span class="op" id="2294350">=</span>&nbsp;<span class="builtinfunc" id="2294352">append</span><span class="op" id="2294358">(</span><span class="ident" id="2294359">buf</span><span class="op" id="2294362">,</span>&nbsp;<span class="ident" id="2294364">lowerhex</span><span class="op" id="2294372">[</span><span class="ident" id="2294373">s</span><span class="op" id="2294374">[</span><span class="num" id="2294375">0</span><span class="op" id="2294376">]</span><span class="op" id="2294377">&amp;</span><span class="num" id="2294378">0xF</span><span class="op" id="2294381">]</span><span class="op" id="2294382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294387">case</span>&nbsp;<span class="ident" id="2294392">r</span>&nbsp;<span class="op" id="2294394">&gt;</span>&nbsp;<span class="ident" id="2294396">utf8</span><span class="op" id="2294400">.</span><span class="ident" id="2294401">MaxRune</span><span class="op" id="2294408">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294414">r</span>&nbsp;<span class="op" id="2294416">=</span>&nbsp;<span class="num" id="2294418">0xFFFD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294429">fallthrough</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294444">case</span>&nbsp;<span class="ident" id="2294449">r</span>&nbsp;<span class="op" id="2294451">&lt;</span>&nbsp;<span class="num" id="2294453">0x10000</span><span class="op" id="2294460">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294466">buf</span>&nbsp;<span class="op" id="2294470">=</span>&nbsp;<span class="builtinfunc" id="2294472">append</span><span class="op" id="2294478">(</span><span class="ident" id="2294479">buf</span><span class="op" id="2294482">,</span>&nbsp;<span class="string" id="2294484">`\u`</span><span class="op" id="2294488">...</span><span class="op" id="2294491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294497">for</span>&nbsp;<span class="ident" id="2294501">s</span>&nbsp;<span class="op" id="2294503">:=</span>&nbsp;<span class="num" id="2294506">12</span><span class="op" id="2294508">;</span>&nbsp;<span class="ident" id="2294510">s</span>&nbsp;<span class="op" id="2294512">&gt;=</span>&nbsp;<span class="num" id="2294515">0</span><span class="op" id="2294516">;</span>&nbsp;<span class="ident" id="2294518">s</span>&nbsp;<span class="op" id="2294520">-=</span>&nbsp;<span class="num" id="2294523">4</span>&nbsp;<span class="op" id="2294525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294532">buf</span>&nbsp;<span class="op" id="2294536">=</span>&nbsp;<span class="builtinfunc" id="2294538">append</span><span class="op" id="2294544">(</span><span class="ident" id="2294545">buf</span><span class="op" id="2294548">,</span>&nbsp;<span class="ident" id="2294550">lowerhex</span><span class="op" id="2294558">[</span><span class="ident" id="2294559">r</span><span class="op" id="2294560">&gt;&gt;</span><span class="builtintype" id="2294562">uint</span><span class="op" id="2294566">(</span><span class="ident" id="2294567">s</span><span class="op" id="2294568">)</span><span class="op" id="2294569">&amp;</span><span class="num" id="2294570">0xF</span><span class="op" id="2294573">]</span><span class="op" id="2294574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294580">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294585">default</span><span class="op" id="2294592">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294598">buf</span>&nbsp;<span class="op" id="2294602">=</span>&nbsp;<span class="builtinfunc" id="2294604">append</span><span class="op" id="2294610">(</span><span class="ident" id="2294611">buf</span><span class="op" id="2294614">,</span>&nbsp;<span class="string" id="2294616">`\U`</span><span class="op" id="2294620">...</span><span class="op" id="2294623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294629">for</span>&nbsp;<span class="ident" id="2294633">s</span>&nbsp;<span class="op" id="2294635">:=</span>&nbsp;<span class="num" id="2294638">28</span><span class="op" id="2294640">;</span>&nbsp;<span class="ident" id="2294642">s</span>&nbsp;<span class="op" id="2294644">&gt;=</span>&nbsp;<span class="num" id="2294647">0</span><span class="op" id="2294648">;</span>&nbsp;<span class="ident" id="2294650">s</span>&nbsp;<span class="op" id="2294652">-=</span>&nbsp;<span class="num" id="2294655">4</span>&nbsp;<span class="op" id="2294657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294664">buf</span>&nbsp;<span class="op" id="2294668">=</span>&nbsp;<span class="builtinfunc" id="2294670">append</span><span class="op" id="2294676">(</span><span class="ident" id="2294677">buf</span><span class="op" id="2294680">,</span>&nbsp;<span class="ident" id="2294682">lowerhex</span><span class="op" id="2294690">[</span><span class="ident" id="2294691">r</span><span class="op" id="2294692">&gt;&gt;</span><span class="builtintype" id="2294694">uint</span><span class="op" id="2294698">(</span><span class="ident" id="2294699">s</span><span class="op" id="2294700">)</span><span class="op" id="2294701">&amp;</span><span class="num" id="2294702">0xF</span><span class="op" id="2294705">]</span><span class="op" id="2294706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294712">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294727">buf</span>&nbsp;<span class="op" id="2294731">=</span>&nbsp;<span class="builtinfunc" id="2294733">append</span><span class="op" id="2294739">(</span><span class="ident" id="2294740">buf</span><span class="op" id="2294743">,</span>&nbsp;<span class="ident" id="2294745">quote</span><span class="op" id="2294750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294753">return</span>&nbsp;<span class="builtintype" id="2294760">string</span><span class="op" id="2294766">(</span><span class="ident" id="2294767">buf</span><span class="op" id="2294770">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="op" id="2294773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2294776">//&nbsp;Quote&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.&nbsp;&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="2294848">//&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno">90</span><span class="comment" id="2294919">//&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2294984">//&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2294996">func</span>&nbsp;<span class="ident" id="2295001">Quote</span><span class="op" id="2295006">(</span><span class="ident" id="2295007">s</span>&nbsp;<span class="builtintype" id="2295009">string</span><span class="op" id="2295015">)</span>&nbsp;<span class="builtintype" id="2295017">string</span>&nbsp;<span class="op" id="2295024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295027">return</span>&nbsp;<span class="ident" id="2295034">quoteWith</span><span class="op" id="2295043">(</span><span class="ident" id="2295044">s</span><span class="op" id="2295045">,</span>&nbsp;<span class="string" id="2295047">&#39;&#34;&#39;</span><span class="op" id="2295050">,</span>&nbsp;<span class="builtintype" id="2295052">false</span><span class="op" id="2295057">)</span><br>
<span class="lineno"></span><span class="op" id="2295059">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="2295062">//&nbsp;AppendQuote&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno"></span><span class="comment" id="2295135">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;Quote,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="2295201">func</span>&nbsp;<span class="ident" id="2295206">AppendQuote</span><span class="op" id="2295217">(</span><span class="ident" id="2295218">dst</span>&nbsp;<span class="op" id="2295222">[</span><span class="op" id="2295223">]</span><span class="builtintype" id="2295224">byte</span><span class="op" id="2295228">,</span>&nbsp;<span class="ident" id="2295230">s</span>&nbsp;<span class="builtintype" id="2295232">string</span><span class="op" id="2295238">)</span>&nbsp;<span class="op" id="2295240">[</span><span class="op" id="2295241">]</span><span class="builtintype" id="2295242">byte</span>&nbsp;<span class="op" id="2295247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295250">return</span>&nbsp;<span class="builtinfunc" id="2295257">append</span><span class="op" id="2295263">(</span><span class="ident" id="2295264">dst</span><span class="op" id="2295267">,</span>&nbsp;<span class="ident" id="2295269">Quote</span><span class="op" id="2295274">(</span><span class="ident" id="2295275">s</span><span class="op" id="2295276">)</span><span class="op" id="2295277">...</span><span class="op" id="2295280">)</span><br>
<span class="lineno">100</span><span class="op" id="2295282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2295285">//&nbsp;QuoteToASCII&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2295359">//&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="2295434">//&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno">105</span><span class="keyword" id="2295510">func</span>&nbsp;<span class="ident" id="2295515">QuoteToASCII</span><span class="op" id="2295527">(</span><span class="ident" id="2295528">s</span>&nbsp;<span class="builtintype" id="2295530">string</span><span class="op" id="2295536">)</span>&nbsp;<span class="builtintype" id="2295538">string</span>&nbsp;<span class="op" id="2295545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295548">return</span>&nbsp;<span class="ident" id="2295555">quoteWith</span><span class="op" id="2295564">(</span><span class="ident" id="2295565">s</span><span class="op" id="2295566">,</span>&nbsp;<span class="string" id="2295568">&#39;&#34;&#39;</span><span class="op" id="2295571">,</span>&nbsp;<span class="builtintype" id="2295573">true</span><span class="op" id="2295577">)</span><br>
<span class="lineno"></span><span class="op" id="2295579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2295582">//&nbsp;AppendQuoteToASCII&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno">110</span><span class="comment" id="2295662">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="2295735">func</span>&nbsp;<span class="ident" id="2295740">AppendQuoteToASCII</span><span class="op" id="2295758">(</span><span class="ident" id="2295759">dst</span>&nbsp;<span class="op" id="2295763">[</span><span class="op" id="2295764">]</span><span class="builtintype" id="2295765">byte</span><span class="op" id="2295769">,</span>&nbsp;<span class="ident" id="2295771">s</span>&nbsp;<span class="builtintype" id="2295773">string</span><span class="op" id="2295779">)</span>&nbsp;<span class="op" id="2295781">[</span><span class="op" id="2295782">]</span><span class="builtintype" id="2295783">byte</span>&nbsp;<span class="op" id="2295788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295791">return</span>&nbsp;<span class="builtinfunc" id="2295798">append</span><span class="op" id="2295804">(</span><span class="ident" id="2295805">dst</span><span class="op" id="2295808">,</span>&nbsp;<span class="ident" id="2295810">QuoteToASCII</span><span class="op" id="2295822">(</span><span class="ident" id="2295823">s</span><span class="op" id="2295824">)</span><span class="op" id="2295825">...</span><span class="op" id="2295828">)</span><br>
<span class="lineno"></span><span class="op" id="2295830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="2295833">//&nbsp;QuoteRune&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2295908">//&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)</span><br>
<span class="lineno"></span><span class="comment" id="2295986">//&nbsp;for&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2296064">func</span>&nbsp;<span class="ident" id="2296069">QuoteRune</span><span class="op" id="2296078">(</span><span class="ident" id="2296079">r</span>&nbsp;<span class="builtintype" id="2296081">rune</span><span class="op" id="2296085">)</span>&nbsp;<span class="builtintype" id="2296087">string</span>&nbsp;<span class="op" id="2296094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2296097">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296134">return</span>&nbsp;<span class="ident" id="2296141">quoteWith</span><span class="op" id="2296150">(</span><span class="builtintype" id="2296151">string</span><span class="op" id="2296157">(</span><span class="ident" id="2296158">r</span><span class="op" id="2296159">)</span><span class="op" id="2296160">,</span>&nbsp;<span class="string" id="2296162">&#39;\&#39;&#39;</span><span class="op" id="2296166">,</span>&nbsp;<span class="builtintype" id="2296168">false</span><span class="op" id="2296173">)</span><br>
<span class="lineno"></span><span class="op" id="2296175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2296178">//&nbsp;AppendQuoteRune&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="2296265">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRune,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">125</span><span class="keyword" id="2296335">func</span>&nbsp;<span class="ident" id="2296340">AppendQuoteRune</span><span class="op" id="2296355">(</span><span class="ident" id="2296356">dst</span>&nbsp;<span class="op" id="2296360">[</span><span class="op" id="2296361">]</span><span class="builtintype" id="2296362">byte</span><span class="op" id="2296366">,</span>&nbsp;<span class="ident" id="2296368">r</span>&nbsp;<span class="builtintype" id="2296370">rune</span><span class="op" id="2296374">)</span>&nbsp;<span class="op" id="2296376">[</span><span class="op" id="2296377">]</span><span class="builtintype" id="2296378">byte</span>&nbsp;<span class="op" id="2296383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296386">return</span>&nbsp;<span class="builtinfunc" id="2296393">append</span><span class="op" id="2296399">(</span><span class="ident" id="2296400">dst</span><span class="op" id="2296403">,</span>&nbsp;<span class="ident" id="2296405">QuoteRune</span><span class="op" id="2296414">(</span><span class="ident" id="2296415">r</span><span class="op" id="2296416">)</span><span class="op" id="2296417">...</span><span class="op" id="2296420">)</span><br>
<span class="lineno"></span><span class="op" id="2296422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2296425">//&nbsp;QuoteRuneToASCII&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing</span><br>
<span class="lineno">130</span><span class="comment" id="2296503">//&nbsp;the&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,</span><br>
<span class="lineno"></span><span class="comment" id="2296577">//&nbsp;\u0100)&nbsp;for&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="2296653">//&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2296668">func</span>&nbsp;<span class="ident" id="2296673">QuoteRuneToASCII</span><span class="op" id="2296689">(</span><span class="ident" id="2296690">r</span>&nbsp;<span class="builtintype" id="2296692">rune</span><span class="op" id="2296696">)</span>&nbsp;<span class="builtintype" id="2296698">string</span>&nbsp;<span class="op" id="2296705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2296708">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296745">return</span>&nbsp;<span class="ident" id="2296752">quoteWith</span><span class="op" id="2296761">(</span><span class="builtintype" id="2296762">string</span><span class="op" id="2296768">(</span><span class="ident" id="2296769">r</span><span class="op" id="2296770">)</span><span class="op" id="2296771">,</span>&nbsp;<span class="string" id="2296773">&#39;\&#39;&#39;</span><span class="op" id="2296777">,</span>&nbsp;<span class="builtintype" id="2296779">true</span><span class="op" id="2296783">)</span><br>
<span class="lineno"></span><span class="op" id="2296785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2296788">//&nbsp;AppendQuoteRuneToASCII&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="2296882">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRuneToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">140</span><span class="keyword" id="2296959">func</span>&nbsp;<span class="ident" id="2296964">AppendQuoteRuneToASCII</span><span class="op" id="2296986">(</span><span class="ident" id="2296987">dst</span>&nbsp;<span class="op" id="2296991">[</span><span class="op" id="2296992">]</span><span class="builtintype" id="2296993">byte</span><span class="op" id="2296997">,</span>&nbsp;<span class="ident" id="2296999">r</span>&nbsp;<span class="builtintype" id="2297001">rune</span><span class="op" id="2297005">)</span>&nbsp;<span class="op" id="2297007">[</span><span class="op" id="2297008">]</span><span class="builtintype" id="2297009">byte</span>&nbsp;<span class="op" id="2297014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297017">return</span>&nbsp;<span class="builtinfunc" id="2297024">append</span><span class="op" id="2297030">(</span><span class="ident" id="2297031">dst</span><span class="op" id="2297034">,</span>&nbsp;<span class="ident" id="2297036">QuoteRuneToASCII</span><span class="op" id="2297052">(</span><span class="ident" id="2297053">r</span><span class="op" id="2297054">)</span><span class="op" id="2297055">...</span><span class="op" id="2297058">)</span><br>
<span class="lineno"></span><span class="op" id="2297060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2297063">//&nbsp;CanBackquote&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;represented</span><br>
<span class="lineno">145</span><span class="comment" id="2297127">//&nbsp;unchanged&nbsp;as&nbsp;a&nbsp;single-line&nbsp;backquoted&nbsp;string&nbsp;without&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="2297191">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;tab.</span><br>
<span class="lineno"></span><span class="keyword" id="2297221">func</span>&nbsp;<span class="ident" id="2297226">CanBackquote</span><span class="op" id="2297238">(</span><span class="ident" id="2297239">s</span>&nbsp;<span class="builtintype" id="2297241">string</span><span class="op" id="2297247">)</span>&nbsp;<span class="builtintype" id="2297249">bool</span>&nbsp;<span class="op" id="2297254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297257">for</span>&nbsp;<span class="builtinfunc" id="2297261">len</span><span class="op" id="2297264">(</span><span class="ident" id="2297265">s</span><span class="op" id="2297266">)</span>&nbsp;<span class="op" id="2297268">&gt;</span>&nbsp;<span class="num" id="2297270">0</span>&nbsp;<span class="op" id="2297272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297276">r</span><span class="op" id="2297277">,</span>&nbsp;<span class="ident" id="2297279">wid</span>&nbsp;<span class="op" id="2297283">:=</span>&nbsp;<span class="ident" id="2297286">utf8</span><span class="op" id="2297290">.</span><span class="ident" id="2297291">DecodeRuneInString</span><span class="op" id="2297309">(</span><span class="ident" id="2297310">s</span><span class="op" id="2297311">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297315">s</span>&nbsp;<span class="op" id="2297317">=</span>&nbsp;<span class="ident" id="2297319">s</span><span class="op" id="2297320">[</span><span class="ident" id="2297321">wid</span><span class="op" id="2297324">:</span><span class="op" id="2297325">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297329">if</span>&nbsp;<span class="ident" id="2297332">wid</span>&nbsp;<span class="op" id="2297336">&gt;</span>&nbsp;<span class="num" id="2297338">1</span>&nbsp;<span class="op" id="2297340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297345">if</span>&nbsp;<span class="ident" id="2297348">r</span>&nbsp;<span class="op" id="2297350">==</span>&nbsp;<span class="string" id="2297353">&#39;\ufeff&#39;</span>&nbsp;<span class="op" id="2297362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297368">return</span>&nbsp;<span class="builtintype" id="2297375">false</span>&nbsp;<span class="comment" id="2297381">//&nbsp;BOMs&nbsp;are&nbsp;invisible&nbsp;and&nbsp;should&nbsp;not&nbsp;be&nbsp;quoted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297432">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297437">continue</span>&nbsp;<span class="comment" id="2297446">//&nbsp;All&nbsp;other&nbsp;multibyte&nbsp;runes&nbsp;are&nbsp;correctly&nbsp;encoded&nbsp;and&nbsp;assumed&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297526">if</span>&nbsp;<span class="ident" id="2297529">r</span>&nbsp;<span class="op" id="2297531">==</span>&nbsp;<span class="ident" id="2297534">utf8</span><span class="op" id="2297538">.</span><span class="ident" id="2297539">RuneError</span>&nbsp;<span class="op" id="2297549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297554">return</span>&nbsp;<span class="builtintype" id="2297561">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297569">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297573">if</span>&nbsp;<span class="op" id="2297576">(</span><span class="ident" id="2297577">r</span>&nbsp;<span class="op" id="2297579">&lt;</span>&nbsp;<span class="string" id="2297581">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2297585">&amp;&amp;</span>&nbsp;<span class="ident" id="2297588">r</span>&nbsp;<span class="op" id="2297590">!=</span>&nbsp;<span class="string" id="2297593">&#39;\t&#39;</span><span class="op" id="2297597">)</span>&nbsp;<span class="op" id="2297599">||</span>&nbsp;<span class="ident" id="2297602">r</span>&nbsp;<span class="op" id="2297604">==</span>&nbsp;<span class="string" id="2297607">&#39;`&#39;</span>&nbsp;<span class="op" id="2297611">||</span>&nbsp;<span class="ident" id="2297614">r</span>&nbsp;<span class="op" id="2297616">==</span>&nbsp;<span class="string" id="2297619">&#39;\u007F&#39;</span>&nbsp;<span class="op" id="2297628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297633">return</span>&nbsp;<span class="builtintype" id="2297640">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297654">return</span>&nbsp;<span class="builtintype" id="2297661">true</span><br>
<span class="lineno">165</span><span class="op" id="2297666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2297669">func</span>&nbsp;<span class="ident" id="2297674">unhex</span><span class="op" id="2297679">(</span><span class="ident" id="2297680">b</span>&nbsp;<span class="builtintype" id="2297682">byte</span><span class="op" id="2297686">)</span>&nbsp;<span class="op" id="2297688">(</span><span class="ident" id="2297689">v</span>&nbsp;<span class="builtintype" id="2297691">rune</span><span class="op" id="2297695">,</span>&nbsp;<span class="ident" id="2297697">ok</span>&nbsp;<span class="builtintype" id="2297700">bool</span><span class="op" id="2297704">)</span>&nbsp;<span class="op" id="2297706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297709">c</span>&nbsp;<span class="op" id="2297711">:=</span>&nbsp;<span class="builtintype" id="2297714">rune</span><span class="op" id="2297718">(</span><span class="ident" id="2297719">b</span><span class="op" id="2297720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297723">switch</span>&nbsp;<span class="op" id="2297730">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297733">case</span>&nbsp;<span class="string" id="2297738">&#39;0&#39;</span>&nbsp;<span class="op" id="2297742">&lt;=</span>&nbsp;<span class="ident" id="2297745">c</span>&nbsp;<span class="op" id="2297747">&amp;&amp;</span>&nbsp;<span class="ident" id="2297750">c</span>&nbsp;<span class="op" id="2297752">&lt;=</span>&nbsp;<span class="string" id="2297755">&#39;9&#39;</span><span class="op" id="2297758">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297762">return</span>&nbsp;<span class="ident" id="2297769">c</span>&nbsp;<span class="op" id="2297771">-</span>&nbsp;<span class="string" id="2297773">&#39;0&#39;</span><span class="op" id="2297776">,</span>&nbsp;<span class="builtintype" id="2297778">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297784">case</span>&nbsp;<span class="string" id="2297789">&#39;a&#39;</span>&nbsp;<span class="op" id="2297793">&lt;=</span>&nbsp;<span class="ident" id="2297796">c</span>&nbsp;<span class="op" id="2297798">&amp;&amp;</span>&nbsp;<span class="ident" id="2297801">c</span>&nbsp;<span class="op" id="2297803">&lt;=</span>&nbsp;<span class="string" id="2297806">&#39;f&#39;</span><span class="op" id="2297809">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297813">return</span>&nbsp;<span class="ident" id="2297820">c</span>&nbsp;<span class="op" id="2297822">-</span>&nbsp;<span class="string" id="2297824">&#39;a&#39;</span>&nbsp;<span class="op" id="2297828">+</span>&nbsp;<span class="num" id="2297830">10</span><span class="op" id="2297832">,</span>&nbsp;<span class="builtintype" id="2297834">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297840">case</span>&nbsp;<span class="string" id="2297845">&#39;A&#39;</span>&nbsp;<span class="op" id="2297849">&lt;=</span>&nbsp;<span class="ident" id="2297852">c</span>&nbsp;<span class="op" id="2297854">&amp;&amp;</span>&nbsp;<span class="ident" id="2297857">c</span>&nbsp;<span class="op" id="2297859">&lt;=</span>&nbsp;<span class="string" id="2297862">&#39;F&#39;</span><span class="op" id="2297865">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297869">return</span>&nbsp;<span class="ident" id="2297876">c</span>&nbsp;<span class="op" id="2297878">-</span>&nbsp;<span class="string" id="2297880">&#39;A&#39;</span>&nbsp;<span class="op" id="2297884">+</span>&nbsp;<span class="num" id="2297886">10</span><span class="op" id="2297888">,</span>&nbsp;<span class="builtintype" id="2297890">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297899">return</span><br>
<span class="lineno"></span><span class="op" id="2297906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="2297909">//&nbsp;UnquoteChar&nbsp;decodes&nbsp;the&nbsp;first&nbsp;character&nbsp;or&nbsp;byte&nbsp;in&nbsp;the&nbsp;escaped&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2297982">//&nbsp;or&nbsp;character&nbsp;literal&nbsp;represented&nbsp;by&nbsp;the&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2298035">//&nbsp;It&nbsp;returns&nbsp;four&nbsp;values:</span><br>
<span class="lineno"></span><span class="comment" id="2298062">//</span><br>
<span class="lineno"></span><span class="comment" id="2298065">//&nbsp;&nbsp;&nbsp;&nbsp1)&nbsp;value,&nbsp;the&nbsp;decoded&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;byte&nbsp;value;</span><br>
<span class="lineno">185</span><span class="comment" id="2298124">//&nbsp;&nbsp;&nbsp;&nbsp2)&nbsp;multibyte,&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;whether&nbsp;the&nbsp;decoded&nbsp;character&nbsp;requires&nbsp;a&nbsp;multibyte&nbsp;UTF-8&nbsp;representation;</span><br>
<span class="lineno"></span><span class="comment" id="2298235">//&nbsp;&nbsp;&nbsp;&nbsp3)&nbsp;tail,&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;string&nbsp;after&nbsp;the&nbsp;character;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2298300">//&nbsp;&nbsp;&nbsp;&nbsp4)&nbsp;an&nbsp;error&nbsp;that&nbsp;will&nbsp;be&nbsp;nil&nbsp;if&nbsp;the&nbsp;character&nbsp;is&nbsp;syntactically&nbsp;valid.</span><br>
<span class="lineno"></span><span class="comment" id="2298373">//</span><br>
<span class="lineno"></span><span class="comment" id="2298376">//&nbsp;The&nbsp;second&nbsp;argument,&nbsp;quote,&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;literal&nbsp;being&nbsp;parsed</span><br>
<span class="lineno">190</span><span class="comment" id="2298450">//&nbsp;and&nbsp;therefore&nbsp;which&nbsp;escaped&nbsp;quote&nbsp;character&nbsp;is&nbsp;permitted.</span><br>
<span class="lineno"></span><span class="comment" id="2298511">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;single&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;the&nbsp;sequence&nbsp;\&#39;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="2298594">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;double&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;\&#34;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2298664">//&nbsp;If&nbsp;set&nbsp;to&nbsp;zero,&nbsp;it&nbsp;does&nbsp;not&nbsp;permit&nbsp;either&nbsp;escape&nbsp;and&nbsp;allows&nbsp;both&nbsp;quote&nbsp;characters&nbsp;to&nbsp;appear&nbsp;unescaped.</span><br>
<span class="lineno"></span><span class="keyword" id="2298770">func</span>&nbsp;<span class="ident" id="2298775">UnquoteChar</span><span class="op" id="2298786">(</span><span class="ident" id="2298787">s</span>&nbsp;<span class="builtintype" id="2298789">string</span><span class="op" id="2298795">,</span>&nbsp;<span class="ident" id="2298797">quote</span>&nbsp;<span class="builtintype" id="2298803">byte</span><span class="op" id="2298807">)</span>&nbsp;<span class="op" id="2298809">(</span><span class="ident" id="2298810">value</span>&nbsp;<span class="builtintype" id="2298816">rune</span><span class="op" id="2298820">,</span>&nbsp;<span class="ident" id="2298822">multibyte</span>&nbsp;<span class="builtintype" id="2298832">bool</span><span class="op" id="2298836">,</span>&nbsp;<span class="ident" id="2298838">tail</span>&nbsp;<span class="builtintype" id="2298843">string</span><span class="op" id="2298849">,</span>&nbsp;<span class="ident" id="2298851">err</span>&nbsp;<span class="builtintype" id="2298855">error</span><span class="op" id="2298860">)</span>&nbsp;<span class="op" id="2298862">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2298865">//&nbsp;easy&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298880">switch</span>&nbsp;<span class="ident" id="2298887">c</span>&nbsp;<span class="op" id="2298889">:=</span>&nbsp;<span class="ident" id="2298892">s</span><span class="op" id="2298893">[</span><span class="num" id="2298894">0</span><span class="op" id="2298895">]</span><span class="op" id="2298896">;</span>&nbsp;<span class="op" id="2298898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298901">case</span>&nbsp;<span class="ident" id="2298906">c</span>&nbsp;<span class="op" id="2298908">==</span>&nbsp;<span class="ident" id="2298911">quote</span>&nbsp;<span class="op" id="2298917">&amp;&amp;</span>&nbsp;<span class="op" id="2298920">(</span><span class="ident" id="2298921">quote</span>&nbsp;<span class="op" id="2298927">==</span>&nbsp;<span class="string" id="2298930">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2298935">||</span>&nbsp;<span class="ident" id="2298938">quote</span>&nbsp;<span class="op" id="2298944">==</span>&nbsp;<span class="string" id="2298947">&#39;&#34;&#39;</span><span class="op" id="2298950">)</span><span class="op" id="2298951">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2298955">err</span>&nbsp;<span class="op" id="2298959">=</span>&nbsp;<span class="ident" id="2298961">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298973">return</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298981">case</span>&nbsp;<span class="ident" id="2298986">c</span>&nbsp;<span class="op" id="2298988">&gt;=</span>&nbsp;<span class="ident" id="2298991">utf8</span><span class="op" id="2298995">.</span><span class="ident" id="2298996">RuneSelf</span><span class="op" id="2299004">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299008">r</span><span class="op" id="2299009">,</span>&nbsp;<span class="ident" id="2299011">size</span>&nbsp;<span class="op" id="2299016">:=</span>&nbsp;<span class="ident" id="2299019">utf8</span><span class="op" id="2299023">.</span><span class="ident" id="2299024">DecodeRuneInString</span><span class="op" id="2299042">(</span><span class="ident" id="2299043">s</span><span class="op" id="2299044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299048">return</span>&nbsp;<span class="ident" id="2299055">r</span><span class="op" id="2299056">,</span>&nbsp;<span class="builtintype" id="2299058">true</span><span class="op" id="2299062">,</span>&nbsp;<span class="ident" id="2299064">s</span><span class="op" id="2299065">[</span><span class="ident" id="2299066">size</span><span class="op" id="2299070">:</span><span class="op" id="2299071">]</span><span class="op" id="2299072">,</span>&nbsp;<span class="ident" id="2299074">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299079">case</span>&nbsp;<span class="ident" id="2299084">c</span>&nbsp;<span class="op" id="2299086">!=</span>&nbsp;<span class="string" id="2299089">&#39;\\&#39;</span><span class="op" id="2299093">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299097">return</span>&nbsp;<span class="builtintype" id="2299104">rune</span><span class="op" id="2299108">(</span><span class="ident" id="2299109">s</span><span class="op" id="2299110">[</span><span class="num" id="2299111">0</span><span class="op" id="2299112">]</span><span class="op" id="2299113">)</span><span class="op" id="2299114">,</span>&nbsp;<span class="builtintype" id="2299116">false</span><span class="op" id="2299121">,</span>&nbsp;<span class="ident" id="2299123">s</span><span class="op" id="2299124">[</span><span class="num" id="2299125">1</span><span class="op" id="2299126">:</span><span class="op" id="2299127">]</span><span class="op" id="2299128">,</span>&nbsp;<span class="ident" id="2299130">nil</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2299139">//&nbsp;hard&nbsp;case:&nbsp;c&nbsp;is&nbsp;backslash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299169">if</span>&nbsp;<span class="builtinfunc" id="2299172">len</span><span class="op" id="2299175">(</span><span class="ident" id="2299176">s</span><span class="op" id="2299177">)</span>&nbsp;<span class="op" id="2299179">&lt;=</span>&nbsp;<span class="num" id="2299182">1</span>&nbsp;<span class="op" id="2299184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299188">err</span>&nbsp;<span class="op" id="2299192">=</span>&nbsp;<span class="ident" id="2299194">ErrSyntax</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299206">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299217">c</span>&nbsp;<span class="op" id="2299219">:=</span>&nbsp;<span class="ident" id="2299222">s</span><span class="op" id="2299223">[</span><span class="num" id="2299224">1</span><span class="op" id="2299225">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299228">s</span>&nbsp;<span class="op" id="2299230">=</span>&nbsp;<span class="ident" id="2299232">s</span><span class="op" id="2299233">[</span><span class="num" id="2299234">2</span><span class="op" id="2299235">:</span><span class="op" id="2299236">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299240">switch</span>&nbsp;<span class="ident" id="2299247">c</span>&nbsp;<span class="op" id="2299249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299252">case</span>&nbsp;<span class="string" id="2299257">&#39;a&#39;</span><span class="op" id="2299260">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299264">value</span>&nbsp;<span class="op" id="2299270">=</span>&nbsp;<span class="string" id="2299272">&#39;\a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299278">case</span>&nbsp;<span class="string" id="2299283">&#39;b&#39;</span><span class="op" id="2299286">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299290">value</span>&nbsp;<span class="op" id="2299296">=</span>&nbsp;<span class="string" id="2299298">&#39;\b&#39;</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299304">case</span>&nbsp;<span class="string" id="2299309">&#39;f&#39;</span><span class="op" id="2299312">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299316">value</span>&nbsp;<span class="op" id="2299322">=</span>&nbsp;<span class="string" id="2299324">&#39;\f&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299330">case</span>&nbsp;<span class="string" id="2299335">&#39;n&#39;</span><span class="op" id="2299338">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299342">value</span>&nbsp;<span class="op" id="2299348">=</span>&nbsp;<span class="string" id="2299350">&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299356">case</span>&nbsp;<span class="string" id="2299361">&#39;r&#39;</span><span class="op" id="2299364">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299368">value</span>&nbsp;<span class="op" id="2299374">=</span>&nbsp;<span class="string" id="2299376">&#39;\r&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299382">case</span>&nbsp;<span class="string" id="2299387">&#39;t&#39;</span><span class="op" id="2299390">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299394">value</span>&nbsp;<span class="op" id="2299400">=</span>&nbsp;<span class="string" id="2299402">&#39;\t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299408">case</span>&nbsp;<span class="string" id="2299413">&#39;v&#39;</span><span class="op" id="2299416">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299420">value</span>&nbsp;<span class="op" id="2299426">=</span>&nbsp;<span class="string" id="2299428">&#39;\v&#39;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299434">case</span>&nbsp;<span class="string" id="2299439">&#39;x&#39;</span><span class="op" id="2299442">,</span>&nbsp;<span class="string" id="2299444">&#39;u&#39;</span><span class="op" id="2299447">,</span>&nbsp;<span class="string" id="2299449">&#39;U&#39;</span><span class="op" id="2299452">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299456">n</span>&nbsp;<span class="op" id="2299458">:=</span>&nbsp;<span class="num" id="2299461">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299465">switch</span>&nbsp;<span class="ident" id="2299472">c</span>&nbsp;<span class="op" id="2299474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299478">case</span>&nbsp;<span class="string" id="2299483">&#39;x&#39;</span><span class="op" id="2299486">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299491">n</span>&nbsp;<span class="op" id="2299493">=</span>&nbsp;<span class="num" id="2299495">2</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299499">case</span>&nbsp;<span class="string" id="2299504">&#39;u&#39;</span><span class="op" id="2299507">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299512">n</span>&nbsp;<span class="op" id="2299514">=</span>&nbsp;<span class="num" id="2299516">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299520">case</span>&nbsp;<span class="string" id="2299525">&#39;U&#39;</span><span class="op" id="2299528">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299533">n</span>&nbsp;<span class="op" id="2299535">=</span>&nbsp;<span class="num" id="2299537">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299541">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299545">var</span>&nbsp;<span class="ident" id="2299549">v</span>&nbsp;<span class="builtintype" id="2299551">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299558">if</span>&nbsp;<span class="builtinfunc" id="2299561">len</span><span class="op" id="2299564">(</span><span class="ident" id="2299565">s</span><span class="op" id="2299566">)</span>&nbsp;<span class="op" id="2299568">&lt;</span>&nbsp;<span class="ident" id="2299570">n</span>&nbsp;<span class="op" id="2299572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299577">err</span>&nbsp;<span class="op" id="2299581">=</span>&nbsp;<span class="ident" id="2299583">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299596">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299605">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299609">for</span>&nbsp;<span class="ident" id="2299613">j</span>&nbsp;<span class="op" id="2299615">:=</span>&nbsp;<span class="num" id="2299618">0</span><span class="op" id="2299619">;</span>&nbsp;<span class="ident" id="2299621">j</span>&nbsp;<span class="op" id="2299623">&lt;</span>&nbsp;<span class="ident" id="2299625">n</span><span class="op" id="2299626">;</span>&nbsp;<span class="ident" id="2299628">j</span><span class="op" id="2299629">++</span>&nbsp;<span class="op" id="2299632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299637">x</span><span class="op" id="2299638">,</span>&nbsp;<span class="ident" id="2299640">ok</span>&nbsp;<span class="op" id="2299643">:=</span>&nbsp;<span class="ident" id="2299646">unhex</span><span class="op" id="2299651">(</span><span class="ident" id="2299652">s</span><span class="op" id="2299653">[</span><span class="ident" id="2299654">j</span><span class="op" id="2299655">]</span><span class="op" id="2299656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299661">if</span>&nbsp;<span class="op" id="2299664">!</span><span class="ident" id="2299665">ok</span>&nbsp;<span class="op" id="2299668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299674">err</span>&nbsp;<span class="op" id="2299678">=</span>&nbsp;<span class="ident" id="2299680">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299694">return</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299709">v</span>&nbsp;<span class="op" id="2299711">=</span>&nbsp;<span class="ident" id="2299713">v</span><span class="op" id="2299714">&lt;&lt;</span><span class="num" id="2299716">4</span>&nbsp;<span class="op" id="2299718">|</span>&nbsp;<span class="ident" id="2299720">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299728">s</span>&nbsp;<span class="op" id="2299730">=</span>&nbsp;<span class="ident" id="2299732">s</span><span class="op" id="2299733">[</span><span class="ident" id="2299734">n</span><span class="op" id="2299735">:</span><span class="op" id="2299736">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299740">if</span>&nbsp;<span class="ident" id="2299743">c</span>&nbsp;<span class="op" id="2299745">==</span>&nbsp;<span class="string" id="2299748">&#39;x&#39;</span>&nbsp;<span class="op" id="2299752">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2299757">//&nbsp;single-byte&nbsp;string,&nbsp;possibly&nbsp;not&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299802">value</span>&nbsp;<span class="op" id="2299808">=</span>&nbsp;<span class="ident" id="2299810">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299815">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299827">if</span>&nbsp;<span class="ident" id="2299830">v</span>&nbsp;<span class="op" id="2299832">&gt;</span>&nbsp;<span class="ident" id="2299834">utf8</span><span class="op" id="2299838">.</span><span class="ident" id="2299839">MaxRune</span>&nbsp;<span class="op" id="2299847">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299852">err</span>&nbsp;<span class="op" id="2299856">=</span>&nbsp;<span class="ident" id="2299858">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299871">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299884">value</span>&nbsp;<span class="op" id="2299890">=</span>&nbsp;<span class="ident" id="2299892">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299896">multibyte</span>&nbsp;<span class="op" id="2299906">=</span>&nbsp;<span class="builtintype" id="2299908">true</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299914">case</span>&nbsp;<span class="string" id="2299919">&#39;0&#39;</span><span class="op" id="2299922">,</span>&nbsp;<span class="string" id="2299924">&#39;1&#39;</span><span class="op" id="2299927">,</span>&nbsp;<span class="string" id="2299929">&#39;2&#39;</span><span class="op" id="2299932">,</span>&nbsp;<span class="string" id="2299934">&#39;3&#39;</span><span class="op" id="2299937">,</span>&nbsp;<span class="string" id="2299939">&#39;4&#39;</span><span class="op" id="2299942">,</span>&nbsp;<span class="string" id="2299944">&#39;5&#39;</span><span class="op" id="2299947">,</span>&nbsp;<span class="string" id="2299949">&#39;6&#39;</span><span class="op" id="2299952">,</span>&nbsp;<span class="string" id="2299954">&#39;7&#39;</span><span class="op" id="2299957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299961">v</span>&nbsp;<span class="op" id="2299963">:=</span>&nbsp;<span class="builtintype" id="2299966">rune</span><span class="op" id="2299970">(</span><span class="ident" id="2299971">c</span><span class="op" id="2299972">)</span>&nbsp;<span class="op" id="2299974">-</span>&nbsp;<span class="string" id="2299976">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299982">if</span>&nbsp;<span class="builtinfunc" id="2299985">len</span><span class="op" id="2299988">(</span><span class="ident" id="2299989">s</span><span class="op" id="2299990">)</span>&nbsp;<span class="op" id="2299992">&lt;</span>&nbsp;<span class="num" id="2299994">2</span>&nbsp;<span class="op" id="2299996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300001">err</span>&nbsp;<span class="op" id="2300005">=</span>&nbsp;<span class="ident" id="2300007">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300020">return</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300033">for</span>&nbsp;<span class="ident" id="2300037">j</span>&nbsp;<span class="op" id="2300039">:=</span>&nbsp;<span class="num" id="2300042">0</span><span class="op" id="2300043">;</span>&nbsp;<span class="ident" id="2300045">j</span>&nbsp;<span class="op" id="2300047">&lt;</span>&nbsp;<span class="num" id="2300049">2</span><span class="op" id="2300050">;</span>&nbsp;<span class="ident" id="2300052">j</span><span class="op" id="2300053">++</span>&nbsp;<span class="op" id="2300056">{</span>&nbsp;<span class="comment" id="2300058">//&nbsp;one&nbsp;digit&nbsp;already;&nbsp;two&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300092">x</span>&nbsp;<span class="op" id="2300094">:=</span>&nbsp;<span class="builtintype" id="2300097">rune</span><span class="op" id="2300101">(</span><span class="ident" id="2300102">s</span><span class="op" id="2300103">[</span><span class="ident" id="2300104">j</span><span class="op" id="2300105">]</span><span class="op" id="2300106">)</span>&nbsp;<span class="op" id="2300108">-</span>&nbsp;<span class="string" id="2300110">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300117">if</span>&nbsp;<span class="ident" id="2300120">x</span>&nbsp;<span class="op" id="2300122">&lt;</span>&nbsp;<span class="num" id="2300124">0</span>&nbsp;<span class="op" id="2300126">||</span>&nbsp;<span class="ident" id="2300129">x</span>&nbsp;<span class="op" id="2300131">&gt;</span>&nbsp;<span class="num" id="2300133">7</span>&nbsp;<span class="op" id="2300135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300141">err</span>&nbsp;<span class="op" id="2300145">=</span>&nbsp;<span class="ident" id="2300147">ErrSyntax</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300161">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300176">v</span>&nbsp;<span class="op" id="2300178">=</span>&nbsp;<span class="op" id="2300180">(</span><span class="ident" id="2300181">v</span>&nbsp;<span class="op" id="2300183">&lt;&lt;</span>&nbsp;<span class="num" id="2300186">3</span><span class="op" id="2300187">)</span>&nbsp;<span class="op" id="2300189">|</span>&nbsp;<span class="ident" id="2300191">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300199">s</span>&nbsp;<span class="op" id="2300201">=</span>&nbsp;<span class="ident" id="2300203">s</span><span class="op" id="2300204">[</span><span class="num" id="2300205">2</span><span class="op" id="2300206">:</span><span class="op" id="2300207">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300211">if</span>&nbsp;<span class="ident" id="2300214">v</span>&nbsp;<span class="op" id="2300216">&gt;</span>&nbsp;<span class="num" id="2300218">255</span>&nbsp;<span class="op" id="2300222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300227">err</span>&nbsp;<span class="op" id="2300231">=</span>&nbsp;<span class="ident" id="2300233">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300246">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300259">value</span>&nbsp;<span class="op" id="2300265">=</span>&nbsp;<span class="ident" id="2300267">v</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300270">case</span>&nbsp;<span class="string" id="2300275">&#39;\\&#39;</span><span class="op" id="2300279">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300283">value</span>&nbsp;<span class="op" id="2300289">=</span>&nbsp;<span class="string" id="2300291">&#39;\\&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300297">case</span>&nbsp;<span class="string" id="2300302">&#39;\&#39;&#39;</span><span class="op" id="2300306">,</span>&nbsp;<span class="string" id="2300308">&#39;&#34;&#39;</span><span class="op" id="2300311">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300315">if</span>&nbsp;<span class="ident" id="2300318">c</span>&nbsp;<span class="op" id="2300320">!=</span>&nbsp;<span class="ident" id="2300323">quote</span>&nbsp;<span class="op" id="2300329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300334">err</span>&nbsp;<span class="op" id="2300338">=</span>&nbsp;<span class="ident" id="2300340">ErrSyntax</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300353">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300366">value</span>&nbsp;<span class="op" id="2300372">=</span>&nbsp;<span class="builtintype" id="2300374">rune</span><span class="op" id="2300378">(</span><span class="ident" id="2300379">c</span><span class="op" id="2300380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300383">default</span><span class="op" id="2300390">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300394">err</span>&nbsp;<span class="op" id="2300398">=</span>&nbsp;<span class="ident" id="2300400">ErrSyntax</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300412">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300423">tail</span>&nbsp;<span class="op" id="2300428">=</span>&nbsp;<span class="ident" id="2300430">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300433">return</span><br>
<span class="lineno"></span><span class="op" id="2300440">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="2300443">//&nbsp;Unquote&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;double-quoted,</span><br>
<span class="lineno"></span><span class="comment" id="2300502">//&nbsp;or&nbsp;backquoted&nbsp;Go&nbsp;string&nbsp;literal,&nbsp;returning&nbsp;the&nbsp;string&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2300565">//&nbsp;that&nbsp;s&nbsp;quotes.&nbsp;&nbsp;(If&nbsp;s&nbsp;is&nbsp;single-quoted,&nbsp;it&nbsp;would&nbsp;be&nbsp;a&nbsp;Go</span><br>
<span class="lineno"></span><span class="comment" id="2300625">//&nbsp;character&nbsp;literal;&nbsp;Unquote&nbsp;returns&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno">305</span><span class="comment" id="2300681">//&nbsp;one-character&nbsp;string.)</span><br>
<span class="lineno"></span><span class="keyword" id="2300707">func</span>&nbsp;<span class="ident" id="2300712">Unquote</span><span class="op" id="2300719">(</span><span class="ident" id="2300720">s</span>&nbsp;<span class="builtintype" id="2300722">string</span><span class="op" id="2300728">)</span>&nbsp;<span class="op" id="2300730">(</span><span class="ident" id="2300731">t</span>&nbsp;<span class="builtintype" id="2300733">string</span><span class="op" id="2300739">,</span>&nbsp;<span class="ident" id="2300741">err</span>&nbsp;<span class="builtintype" id="2300745">error</span><span class="op" id="2300750">)</span>&nbsp;<span class="op" id="2300752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300755">n</span>&nbsp;<span class="op" id="2300757">:=</span>&nbsp;<span class="builtinfunc" id="2300760">len</span><span class="op" id="2300763">(</span><span class="ident" id="2300764">s</span><span class="op" id="2300765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300768">if</span>&nbsp;<span class="ident" id="2300771">n</span>&nbsp;<span class="op" id="2300773">&lt;</span>&nbsp;<span class="num" id="2300775">2</span>&nbsp;<span class="op" id="2300777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300781">return</span>&nbsp;<span class="string" id="2300788">&#34;&#34;</span><span class="op" id="2300790">,</span>&nbsp;<span class="ident" id="2300792">ErrSyntax</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300806">quote</span>&nbsp;<span class="op" id="2300812">:=</span>&nbsp;<span class="ident" id="2300815">s</span><span class="op" id="2300816">[</span><span class="num" id="2300817">0</span><span class="op" id="2300818">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300821">if</span>&nbsp;<span class="ident" id="2300824">quote</span>&nbsp;<span class="op" id="2300830">!=</span>&nbsp;<span class="ident" id="2300833">s</span><span class="op" id="2300834">[</span><span class="ident" id="2300835">n</span><span class="op" id="2300836">-</span><span class="num" id="2300837">1</span><span class="op" id="2300838">]</span>&nbsp;<span class="op" id="2300840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300844">return</span>&nbsp;<span class="string" id="2300851">&#34;&#34;</span><span class="op" id="2300853">,</span>&nbsp;<span class="ident" id="2300855">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300866">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300869">s</span>&nbsp;<span class="op" id="2300871">=</span>&nbsp;<span class="ident" id="2300873">s</span><span class="op" id="2300874">[</span><span class="num" id="2300875">1</span>&nbsp;<span class="op" id="2300877">:</span>&nbsp;<span class="ident" id="2300879">n</span><span class="op" id="2300880">-</span><span class="num" id="2300881">1</span><span class="op" id="2300882">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300886">if</span>&nbsp;<span class="ident" id="2300889">quote</span>&nbsp;<span class="op" id="2300895">==</span>&nbsp;<span class="string" id="2300898">&#39;`&#39;</span>&nbsp;<span class="op" id="2300902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300906">if</span>&nbsp;<span class="ident" id="2300909">contains</span><span class="op" id="2300917">(</span><span class="ident" id="2300918">s</span><span class="op" id="2300919">,</span>&nbsp;<span class="string" id="2300921">&#39;`&#39;</span><span class="op" id="2300924">)</span>&nbsp;<span class="op" id="2300926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300931">return</span>&nbsp;<span class="string" id="2300938">&#34;&#34;</span><span class="op" id="2300940">,</span>&nbsp;<span class="ident" id="2300942">ErrSyntax</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300958">return</span>&nbsp;<span class="ident" id="2300965">s</span><span class="op" id="2300966">,</span>&nbsp;<span class="ident" id="2300968">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300976">if</span>&nbsp;<span class="ident" id="2300979">quote</span>&nbsp;<span class="op" id="2300985">!=</span>&nbsp;<span class="string" id="2300988">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2300992">&amp;&amp;</span>&nbsp;<span class="ident" id="2300995">quote</span>&nbsp;<span class="op" id="2301001">!=</span>&nbsp;<span class="string" id="2301004">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2301009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301013">return</span>&nbsp;<span class="string" id="2301020">&#34;&#34;</span><span class="op" id="2301022">,</span>&nbsp;<span class="ident" id="2301024">ErrSyntax</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301038">if</span>&nbsp;<span class="ident" id="2301041">contains</span><span class="op" id="2301049">(</span><span class="ident" id="2301050">s</span><span class="op" id="2301051">,</span>&nbsp;<span class="string" id="2301053">&#39;\n&#39;</span><span class="op" id="2301057">)</span>&nbsp;<span class="op" id="2301059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301063">return</span>&nbsp;<span class="string" id="2301070">&#34;&#34;</span><span class="op" id="2301072">,</span>&nbsp;<span class="ident" id="2301074">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2301089">//&nbsp;Is&nbsp;it&nbsp;trivial?&nbsp;&nbsp;Avoid&nbsp;allocation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301127">if</span>&nbsp;<span class="op" id="2301130">!</span><span class="ident" id="2301131">contains</span><span class="op" id="2301139">(</span><span class="ident" id="2301140">s</span><span class="op" id="2301141">,</span>&nbsp;<span class="string" id="2301143">&#39;\\&#39;</span><span class="op" id="2301147">)</span>&nbsp;<span class="op" id="2301149">&amp;&amp;</span>&nbsp;<span class="op" id="2301152">!</span><span class="ident" id="2301153">contains</span><span class="op" id="2301161">(</span><span class="ident" id="2301162">s</span><span class="op" id="2301163">,</span>&nbsp;<span class="ident" id="2301165">quote</span><span class="op" id="2301170">)</span>&nbsp;<span class="op" id="2301172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301176">switch</span>&nbsp;<span class="ident" id="2301183">quote</span>&nbsp;<span class="op" id="2301189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301193">case</span>&nbsp;<span class="string" id="2301198">&#39;&#34;&#39;</span><span class="op" id="2301201">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301206">return</span>&nbsp;<span class="ident" id="2301213">s</span><span class="op" id="2301214">,</span>&nbsp;<span class="ident" id="2301216">nil</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301222">case</span>&nbsp;<span class="string" id="2301227">&#39;\&#39;&#39;</span><span class="op" id="2301231">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301236">r</span><span class="op" id="2301237">,</span>&nbsp;<span class="ident" id="2301239">size</span>&nbsp;<span class="op" id="2301244">:=</span>&nbsp;<span class="ident" id="2301247">utf8</span><span class="op" id="2301251">.</span><span class="ident" id="2301252">DecodeRuneInString</span><span class="op" id="2301270">(</span><span class="ident" id="2301271">s</span><span class="op" id="2301272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301277">if</span>&nbsp;<span class="ident" id="2301280">size</span>&nbsp;<span class="op" id="2301285">==</span>&nbsp;<span class="builtinfunc" id="2301288">len</span><span class="op" id="2301291">(</span><span class="ident" id="2301292">s</span><span class="op" id="2301293">)</span>&nbsp;<span class="op" id="2301295">&amp;&amp;</span>&nbsp;<span class="op" id="2301298">(</span><span class="ident" id="2301299">r</span>&nbsp;<span class="op" id="2301301">!=</span>&nbsp;<span class="ident" id="2301304">utf8</span><span class="op" id="2301308">.</span><span class="ident" id="2301309">RuneError</span>&nbsp;<span class="op" id="2301319">||</span>&nbsp;<span class="ident" id="2301322">size</span>&nbsp;<span class="op" id="2301327">!=</span>&nbsp;<span class="num" id="2301330">1</span><span class="op" id="2301331">)</span>&nbsp;<span class="op" id="2301333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301339">return</span>&nbsp;<span class="ident" id="2301346">s</span><span class="op" id="2301347">,</span>&nbsp;<span class="ident" id="2301349">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301356">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301367">var</span>&nbsp;<span class="ident" id="2301371">runeTmp</span>&nbsp;<span class="op" id="2301379">[</span><span class="ident" id="2301380">utf8</span><span class="op" id="2301384">.</span><span class="ident" id="2301385">UTFMax</span><span class="op" id="2301391">]</span><span class="builtintype" id="2301392">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301398">buf</span>&nbsp;<span class="op" id="2301402">:=</span>&nbsp;<span class="builtinfunc" id="2301405">make</span><span class="op" id="2301409">(</span><span class="op" id="2301410">[</span><span class="op" id="2301411">]</span><span class="builtintype" id="2301412">byte</span><span class="op" id="2301416">,</span>&nbsp;<span class="num" id="2301418">0</span><span class="op" id="2301419">,</span>&nbsp;<span class="num" id="2301421">3</span><span class="op" id="2301422">*</span><span class="builtinfunc" id="2301423">len</span><span class="op" id="2301426">(</span><span class="ident" id="2301427">s</span><span class="op" id="2301428">)</span><span class="op" id="2301429">/</span><span class="num" id="2301430">2</span><span class="op" id="2301431">)</span>&nbsp;<span class="comment" id="2301433">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301468">for</span>&nbsp;<span class="builtinfunc" id="2301472">len</span><span class="op" id="2301475">(</span><span class="ident" id="2301476">s</span><span class="op" id="2301477">)</span>&nbsp;<span class="op" id="2301479">&gt;</span>&nbsp;<span class="num" id="2301481">0</span>&nbsp;<span class="op" id="2301483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301487">c</span><span class="op" id="2301488">,</span>&nbsp;<span class="ident" id="2301490">multibyte</span><span class="op" id="2301499">,</span>&nbsp;<span class="ident" id="2301501">ss</span><span class="op" id="2301503">,</span>&nbsp;<span class="ident" id="2301505">err</span>&nbsp;<span class="op" id="2301509">:=</span>&nbsp;<span class="ident" id="2301512">UnquoteChar</span><span class="op" id="2301523">(</span><span class="ident" id="2301524">s</span><span class="op" id="2301525">,</span>&nbsp;<span class="ident" id="2301527">quote</span><span class="op" id="2301532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301536">if</span>&nbsp;<span class="ident" id="2301539">err</span>&nbsp;<span class="op" id="2301543">!=</span>&nbsp;<span class="ident" id="2301546">nil</span>&nbsp;<span class="op" id="2301550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301555">return</span>&nbsp;<span class="string" id="2301562">&#34;&#34;</span><span class="op" id="2301564">,</span>&nbsp;<span class="ident" id="2301566">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301572">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301576">s</span>&nbsp;<span class="op" id="2301578">=</span>&nbsp;<span class="ident" id="2301580">ss</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301585">if</span>&nbsp;<span class="ident" id="2301588">c</span>&nbsp;<span class="op" id="2301590">&lt;</span>&nbsp;<span class="ident" id="2301592">utf8</span><span class="op" id="2301596">.</span><span class="ident" id="2301597">RuneSelf</span>&nbsp;<span class="op" id="2301606">||</span>&nbsp;<span class="op" id="2301609">!</span><span class="ident" id="2301610">multibyte</span>&nbsp;<span class="op" id="2301620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301625">buf</span>&nbsp;<span class="op" id="2301629">=</span>&nbsp;<span class="builtinfunc" id="2301631">append</span><span class="op" id="2301637">(</span><span class="ident" id="2301638">buf</span><span class="op" id="2301641">,</span>&nbsp;<span class="builtintype" id="2301643">byte</span><span class="op" id="2301647">(</span><span class="ident" id="2301648">c</span><span class="op" id="2301649">)</span><span class="op" id="2301650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301654">}</span>&nbsp;<span class="keyword" id="2301656">else</span>&nbsp;<span class="op" id="2301661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301666">n</span>&nbsp;<span class="op" id="2301668">:=</span>&nbsp;<span class="ident" id="2301671">utf8</span><span class="op" id="2301675">.</span><span class="ident" id="2301676">EncodeRune</span><span class="op" id="2301686">(</span><span class="ident" id="2301687">runeTmp</span><span class="op" id="2301694">[</span><span class="op" id="2301695">:</span><span class="op" id="2301696">]</span><span class="op" id="2301697">,</span>&nbsp;<span class="ident" id="2301699">c</span><span class="op" id="2301700">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301705">buf</span>&nbsp;<span class="op" id="2301709">=</span>&nbsp;<span class="builtinfunc" id="2301711">append</span><span class="op" id="2301717">(</span><span class="ident" id="2301718">buf</span><span class="op" id="2301721">,</span>&nbsp;<span class="ident" id="2301723">runeTmp</span><span class="op" id="2301730">[</span><span class="op" id="2301731">:</span><span class="ident" id="2301732">n</span><span class="op" id="2301733">]</span><span class="op" id="2301734">...</span><span class="op" id="2301737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301745">if</span>&nbsp;<span class="ident" id="2301748">quote</span>&nbsp;<span class="op" id="2301754">==</span>&nbsp;<span class="string" id="2301757">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2301762">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2301765">len</span><span class="op" id="2301768">(</span><span class="ident" id="2301769">s</span><span class="op" id="2301770">)</span>&nbsp;<span class="op" id="2301772">!=</span>&nbsp;<span class="num" id="2301775">0</span>&nbsp;<span class="op" id="2301777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2301782">//&nbsp;single-quoted&nbsp;must&nbsp;be&nbsp;single&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301827">return</span>&nbsp;<span class="string" id="2301834">&#34;&#34;</span><span class="op" id="2301836">,</span>&nbsp;<span class="ident" id="2301838">ErrSyntax</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301856">return</span>&nbsp;<span class="builtintype" id="2301863">string</span><span class="op" id="2301869">(</span><span class="ident" id="2301870">buf</span><span class="op" id="2301873">)</span><span class="op" id="2301874">,</span>&nbsp;<span class="ident" id="2301876">nil</span><br>
<span class="lineno"></span><span class="op" id="2301880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="2301883">//&nbsp;contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;contains&nbsp;the&nbsp;byte&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="2301943">func</span>&nbsp;<span class="ident" id="2301948">contains</span><span class="op" id="2301956">(</span><span class="ident" id="2301957">s</span>&nbsp;<span class="builtintype" id="2301959">string</span><span class="op" id="2301965">,</span>&nbsp;<span class="ident" id="2301967">c</span>&nbsp;<span class="builtintype" id="2301969">byte</span><span class="op" id="2301973">)</span>&nbsp;<span class="builtintype" id="2301975">bool</span>&nbsp;<span class="op" id="2301980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301983">for</span>&nbsp;<span class="ident" id="2301987">i</span>&nbsp;<span class="op" id="2301989">:=</span>&nbsp;<span class="num" id="2301992">0</span><span class="op" id="2301993">;</span>&nbsp;<span class="ident" id="2301995">i</span>&nbsp;<span class="op" id="2301997">&lt;</span>&nbsp;<span class="builtinfunc" id="2301999">len</span><span class="op" id="2302002">(</span><span class="ident" id="2302003">s</span><span class="op" id="2302004">)</span><span class="op" id="2302005">;</span>&nbsp;<span class="ident" id="2302007">i</span><span class="op" id="2302008">++</span>&nbsp;<span class="op" id="2302011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302015">if</span>&nbsp;<span class="ident" id="2302018">s</span><span class="op" id="2302019">[</span><span class="ident" id="2302020">i</span><span class="op" id="2302021">]</span>&nbsp;<span class="op" id="2302023">==</span>&nbsp;<span class="ident" id="2302026">c</span>&nbsp;<span class="op" id="2302028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302033">return</span>&nbsp;<span class="builtintype" id="2302040">true</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302053">return</span>&nbsp;<span class="builtintype" id="2302060">false</span><br>
<span class="lineno"></span><span class="op" id="2302066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="2302069">//&nbsp;bsearch16&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2302126">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch16&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="2302178">func</span>&nbsp;<span class="ident" id="2302183">bsearch16</span><span class="op" id="2302192">(</span><span class="ident" id="2302193">a</span>&nbsp;<span class="op" id="2302195">[</span><span class="op" id="2302196">]</span><span class="builtintype" id="2302197">uint16</span><span class="op" id="2302203">,</span>&nbsp;<span class="ident" id="2302205">x</span>&nbsp;<span class="builtintype" id="2302207">uint16</span><span class="op" id="2302213">)</span>&nbsp;<span class="builtintype" id="2302215">int</span>&nbsp;<span class="op" id="2302219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302222">i</span><span class="op" id="2302223">,</span>&nbsp;<span class="ident" id="2302225">j</span>&nbsp;<span class="op" id="2302227">:=</span>&nbsp;<span class="num" id="2302230">0</span><span class="op" id="2302231">,</span>&nbsp;<span class="builtinfunc" id="2302233">len</span><span class="op" id="2302236">(</span><span class="ident" id="2302237">a</span><span class="op" id="2302238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302241">for</span>&nbsp;<span class="ident" id="2302245">i</span>&nbsp;<span class="op" id="2302247">&lt;</span>&nbsp;<span class="ident" id="2302249">j</span>&nbsp;<span class="op" id="2302251">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302255">h</span>&nbsp;<span class="op" id="2302257">:=</span>&nbsp;<span class="ident" id="2302260">i</span>&nbsp;<span class="op" id="2302262">+</span>&nbsp;<span class="op" id="2302264">(</span><span class="ident" id="2302265">j</span><span class="op" id="2302266">-</span><span class="ident" id="2302267">i</span><span class="op" id="2302268">)</span><span class="op" id="2302269">/</span><span class="num" id="2302270">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302274">if</span>&nbsp;<span class="ident" id="2302277">a</span><span class="op" id="2302278">[</span><span class="ident" id="2302279">h</span><span class="op" id="2302280">]</span>&nbsp;<span class="op" id="2302282">&lt;</span>&nbsp;<span class="ident" id="2302284">x</span>&nbsp;<span class="op" id="2302286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302291">i</span>&nbsp;<span class="op" id="2302293">=</span>&nbsp;<span class="ident" id="2302295">h</span>&nbsp;<span class="op" id="2302297">+</span>&nbsp;<span class="num" id="2302299">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302303">}</span>&nbsp;<span class="keyword" id="2302305">else</span>&nbsp;<span class="op" id="2302310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302315">j</span>&nbsp;<span class="op" id="2302317">=</span>&nbsp;<span class="ident" id="2302319">h</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302329">return</span>&nbsp;<span class="ident" id="2302336">i</span><br>
<span class="lineno"></span><span class="op" id="2302338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="2302341">//&nbsp;bsearch32&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2302398">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch32&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="2302450">func</span>&nbsp;<span class="ident" id="2302455">bsearch32</span><span class="op" id="2302464">(</span><span class="ident" id="2302465">a</span>&nbsp;<span class="op" id="2302467">[</span><span class="op" id="2302468">]</span><span class="builtintype" id="2302469">uint32</span><span class="op" id="2302475">,</span>&nbsp;<span class="ident" id="2302477">x</span>&nbsp;<span class="builtintype" id="2302479">uint32</span><span class="op" id="2302485">)</span>&nbsp;<span class="builtintype" id="2302487">int</span>&nbsp;<span class="op" id="2302491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302494">i</span><span class="op" id="2302495">,</span>&nbsp;<span class="ident" id="2302497">j</span>&nbsp;<span class="op" id="2302499">:=</span>&nbsp;<span class="num" id="2302502">0</span><span class="op" id="2302503">,</span>&nbsp;<span class="builtinfunc" id="2302505">len</span><span class="op" id="2302508">(</span><span class="ident" id="2302509">a</span><span class="op" id="2302510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302513">for</span>&nbsp;<span class="ident" id="2302517">i</span>&nbsp;<span class="op" id="2302519">&lt;</span>&nbsp;<span class="ident" id="2302521">j</span>&nbsp;<span class="op" id="2302523">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302527">h</span>&nbsp;<span class="op" id="2302529">:=</span>&nbsp;<span class="ident" id="2302532">i</span>&nbsp;<span class="op" id="2302534">+</span>&nbsp;<span class="op" id="2302536">(</span><span class="ident" id="2302537">j</span><span class="op" id="2302538">-</span><span class="ident" id="2302539">i</span><span class="op" id="2302540">)</span><span class="op" id="2302541">/</span><span class="num" id="2302542">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302546">if</span>&nbsp;<span class="ident" id="2302549">a</span><span class="op" id="2302550">[</span><span class="ident" id="2302551">h</span><span class="op" id="2302552">]</span>&nbsp;<span class="op" id="2302554">&lt;</span>&nbsp;<span class="ident" id="2302556">x</span>&nbsp;<span class="op" id="2302558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302563">i</span>&nbsp;<span class="op" id="2302565">=</span>&nbsp;<span class="ident" id="2302567">h</span>&nbsp;<span class="op" id="2302569">+</span>&nbsp;<span class="num" id="2302571">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302575">}</span>&nbsp;<span class="keyword" id="2302577">else</span>&nbsp;<span class="op" id="2302582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302587">j</span>&nbsp;<span class="op" id="2302589">=</span>&nbsp;<span class="ident" id="2302591">h</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302601">return</span>&nbsp;<span class="ident" id="2302608">i</span><br>
<span class="lineno"></span><span class="op" id="2302610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="2302613">//&nbsp;TODO:&nbsp;IsPrint&nbsp;is&nbsp;a&nbsp;local&nbsp;implementation&nbsp;of&nbsp;unicode.IsPrint,&nbsp;verified&nbsp;by&nbsp;the&nbsp;tests</span><br>
<span class="lineno"></span><span class="comment" id="2302698">//&nbsp;to&nbsp;give&nbsp;the&nbsp;same&nbsp;answer.&nbsp;It&nbsp;allows&nbsp;this&nbsp;package&nbsp;not&nbsp;to&nbsp;depend&nbsp;on&nbsp;unicode,</span><br>
<span class="lineno"></span><span class="comment" id="2302775">//&nbsp;and&nbsp;therefore&nbsp;not&nbsp;pull&nbsp;in&nbsp;all&nbsp;the&nbsp;Unicode&nbsp;tables.&nbsp;If&nbsp;the&nbsp;linker&nbsp;were&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="2302854">//&nbsp;at&nbsp;tossing&nbsp;unused&nbsp;tables,&nbsp;we&nbsp;could&nbsp;get&nbsp;rid&nbsp;of&nbsp;this&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="comment" id="2302924">//&nbsp;That&nbsp;would&nbsp;be&nbsp;nice.</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="2302948">//&nbsp;IsPrint&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;defined&nbsp;as&nbsp;printable&nbsp;by&nbsp;Go,&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2303020">//&nbsp;the&nbsp;same&nbsp;definition&nbsp;as&nbsp;unicode.IsPrint:&nbsp;letters,&nbsp;numbers,&nbsp;punctuation,</span><br>
<span class="lineno"></span><span class="comment" id="2303094">//&nbsp;symbols&nbsp;and&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="2303122">func</span>&nbsp;<span class="ident" id="2303127">IsPrint</span><span class="op" id="2303134">(</span><span class="ident" id="2303135">r</span>&nbsp;<span class="builtintype" id="2303137">rune</span><span class="op" id="2303141">)</span>&nbsp;<span class="builtintype" id="2303143">bool</span>&nbsp;<span class="op" id="2303148">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2303151">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;Latin-1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303178">if</span>&nbsp;<span class="ident" id="2303181">r</span>&nbsp;<span class="op" id="2303183">&lt;=</span>&nbsp;<span class="num" id="2303186">0xFF</span>&nbsp;<span class="op" id="2303191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303195">if</span>&nbsp;<span class="num" id="2303198">0x20</span>&nbsp;<span class="op" id="2303203">&lt;=</span>&nbsp;<span class="ident" id="2303206">r</span>&nbsp;<span class="op" id="2303208">&amp;&amp;</span>&nbsp;<span class="ident" id="2303211">r</span>&nbsp;<span class="op" id="2303213">&lt;=</span>&nbsp;<span class="num" id="2303216">0x7E</span>&nbsp;<span class="op" id="2303221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2303226">//&nbsp;All&nbsp;the&nbsp;ASCII&nbsp;is&nbsp;printable&nbsp;from&nbsp;space&nbsp;through&nbsp;DEL-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303285">return</span>&nbsp;<span class="builtintype" id="2303292">true</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2303299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303303">if</span>&nbsp;<span class="num" id="2303306">0xA1</span>&nbsp;<span class="op" id="2303311">&lt;=</span>&nbsp;<span class="ident" id="2303314">r</span>&nbsp;<span class="op" id="2303316">&amp;&amp;</span>&nbsp;<span class="ident" id="2303319">r</span>&nbsp;<span class="op" id="2303321">&lt;=</span>&nbsp;<span class="num" id="2303324">0xFF</span>&nbsp;<span class="op" id="2303329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2303334">//&nbsp;Similarly&nbsp;for&nbsp;&nbsp;through&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303371">return</span>&nbsp;<span class="ident" id="2303378">r</span>&nbsp;<span class="op" id="2303380">!=</span>&nbsp;<span class="num" id="2303383">0xAD</span>&nbsp;<span class="comment" id="2303388">//&nbsp;...except&nbsp;for&nbsp;the&nbsp;bizarre&nbsp;soft&nbsp;hyphen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2303432">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303436">return</span>&nbsp;<span class="builtintype" id="2303443">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2303450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2303454">//&nbsp;Same&nbsp;algorithm,&nbsp;either&nbsp;on&nbsp;uint16&nbsp;or&nbsp;uint32&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2303508">//&nbsp;First,&nbsp;find&nbsp;first&nbsp;i&nbsp;such&nbsp;that&nbsp;isPrint[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2303559">//&nbsp;This&nbsp;is&nbsp;the&nbsp;index&nbsp;of&nbsp;either&nbsp;the&nbsp;start&nbsp;or&nbsp;end&nbsp;of&nbsp;a&nbsp;pair&nbsp;that&nbsp;might&nbsp;span&nbsp;x.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2303637">//&nbsp;The&nbsp;start&nbsp;is&nbsp;even&nbsp;(isPrint[i&amp;^1])&nbsp;and&nbsp;the&nbsp;end&nbsp;is&nbsp;odd&nbsp;(isPrint[i|1]).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2303710">//&nbsp;If&nbsp;we&nbsp;find&nbsp;x&nbsp;in&nbsp;a&nbsp;range,&nbsp;make&nbsp;sure&nbsp;x&nbsp;is&nbsp;not&nbsp;in&nbsp;isNotPrint&nbsp;list.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303779">if</span>&nbsp;<span class="num" id="2303782">0</span>&nbsp;<span class="op" id="2303784">&lt;=</span>&nbsp;<span class="ident" id="2303787">r</span>&nbsp;<span class="op" id="2303789">&amp;&amp;</span>&nbsp;<span class="ident" id="2303792">r</span>&nbsp;<span class="op" id="2303794">&lt;</span>&nbsp;<span class="num" id="2303796">1</span><span class="op" id="2303797">&lt;&lt;</span><span class="num" id="2303799">16</span>&nbsp;<span class="op" id="2303802">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2303806">rr</span><span class="op" id="2303808">,</span>&nbsp;<span class="ident" id="2303810">isPrint</span><span class="op" id="2303817">,</span>&nbsp;<span class="ident" id="2303819">isNotPrint</span>&nbsp;<span class="op" id="2303830">:=</span>&nbsp;<span class="builtintype" id="2303833">uint16</span><span class="op" id="2303839">(</span><span class="ident" id="2303840">r</span><span class="op" id="2303841">)</span><span class="op" id="2303842">,</span>&nbsp;<span class="ident" id="2303844">isPrint16</span><span class="op" id="2303853">,</span>&nbsp;<span class="ident" id="2303855">isNotPrint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2303870">i</span>&nbsp;<span class="op" id="2303872">:=</span>&nbsp;<span class="ident" id="2303875">bsearch16</span><span class="op" id="2303884">(</span><span class="ident" id="2303885">isPrint</span><span class="op" id="2303892">,</span>&nbsp;<span class="ident" id="2303894">rr</span><span class="op" id="2303896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303900">if</span>&nbsp;<span class="ident" id="2303903">i</span>&nbsp;<span class="op" id="2303905">&gt;=</span>&nbsp;<span class="builtinfunc" id="2303908">len</span><span class="op" id="2303911">(</span><span class="ident" id="2303912">isPrint</span><span class="op" id="2303919">)</span>&nbsp;<span class="op" id="2303921">||</span>&nbsp;<span class="ident" id="2303924">rr</span>&nbsp;<span class="op" id="2303927">&lt;</span>&nbsp;<span class="ident" id="2303929">isPrint</span><span class="op" id="2303936">[</span><span class="ident" id="2303937">i</span><span class="op" id="2303938">&amp;^</span><span class="num" id="2303940">1</span><span class="op" id="2303941">]</span>&nbsp;<span class="op" id="2303943">||</span>&nbsp;<span class="ident" id="2303946">isPrint</span><span class="op" id="2303953">[</span><span class="ident" id="2303954">i</span><span class="op" id="2303955">|</span><span class="num" id="2303956">1</span><span class="op" id="2303957">]</span>&nbsp;<span class="op" id="2303959">&lt;</span>&nbsp;<span class="ident" id="2303961">rr</span>&nbsp;<span class="op" id="2303964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303969">return</span>&nbsp;<span class="builtintype" id="2303976">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2303984">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2303988">j</span>&nbsp;<span class="op" id="2303990">:=</span>&nbsp;<span class="ident" id="2303993">bsearch16</span><span class="op" id="2304002">(</span><span class="ident" id="2304003">isNotPrint</span><span class="op" id="2304013">,</span>&nbsp;<span class="ident" id="2304015">rr</span><span class="op" id="2304017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304021">return</span>&nbsp;<span class="ident" id="2304028">j</span>&nbsp;<span class="op" id="2304030">&gt;=</span>&nbsp;<span class="builtinfunc" id="2304033">len</span><span class="op" id="2304036">(</span><span class="ident" id="2304037">isNotPrint</span><span class="op" id="2304047">)</span>&nbsp;<span class="op" id="2304049">||</span>&nbsp;<span class="ident" id="2304052">isNotPrint</span><span class="op" id="2304062">[</span><span class="ident" id="2304063">j</span><span class="op" id="2304064">]</span>&nbsp;<span class="op" id="2304066">!=</span>&nbsp;<span class="ident" id="2304069">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304077">rr</span><span class="op" id="2304079">,</span>&nbsp;<span class="ident" id="2304081">isPrint</span><span class="op" id="2304088">,</span>&nbsp;<span class="ident" id="2304090">isNotPrint</span>&nbsp;<span class="op" id="2304101">:=</span>&nbsp;<span class="builtintype" id="2304104">uint32</span><span class="op" id="2304110">(</span><span class="ident" id="2304111">r</span><span class="op" id="2304112">)</span><span class="op" id="2304113">,</span>&nbsp;<span class="ident" id="2304115">isPrint32</span><span class="op" id="2304124">,</span>&nbsp;<span class="ident" id="2304126">isNotPrint32</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304140">i</span>&nbsp;<span class="op" id="2304142">:=</span>&nbsp;<span class="ident" id="2304145">bsearch32</span><span class="op" id="2304154">(</span><span class="ident" id="2304155">isPrint</span><span class="op" id="2304162">,</span>&nbsp;<span class="ident" id="2304164">rr</span><span class="op" id="2304166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304169">if</span>&nbsp;<span class="ident" id="2304172">i</span>&nbsp;<span class="op" id="2304174">&gt;=</span>&nbsp;<span class="builtinfunc" id="2304177">len</span><span class="op" id="2304180">(</span><span class="ident" id="2304181">isPrint</span><span class="op" id="2304188">)</span>&nbsp;<span class="op" id="2304190">||</span>&nbsp;<span class="ident" id="2304193">rr</span>&nbsp;<span class="op" id="2304196">&lt;</span>&nbsp;<span class="ident" id="2304198">isPrint</span><span class="op" id="2304205">[</span><span class="ident" id="2304206">i</span><span class="op" id="2304207">&amp;^</span><span class="num" id="2304209">1</span><span class="op" id="2304210">]</span>&nbsp;<span class="op" id="2304212">||</span>&nbsp;<span class="ident" id="2304215">isPrint</span><span class="op" id="2304222">[</span><span class="ident" id="2304223">i</span><span class="op" id="2304224">|</span><span class="num" id="2304225">1</span><span class="op" id="2304226">]</span>&nbsp;<span class="op" id="2304228">&lt;</span>&nbsp;<span class="ident" id="2304230">rr</span>&nbsp;<span class="op" id="2304233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304237">return</span>&nbsp;<span class="builtintype" id="2304244">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304254">if</span>&nbsp;<span class="ident" id="2304257">r</span>&nbsp;<span class="op" id="2304259">&gt;=</span>&nbsp;<span class="num" id="2304262">0x20000</span>&nbsp;<span class="op" id="2304270">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304274">return</span>&nbsp;<span class="builtintype" id="2304281">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304290">r</span>&nbsp;<span class="op" id="2304292">-=</span>&nbsp;<span class="num" id="2304295">0x10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304304">j</span>&nbsp;<span class="op" id="2304306">:=</span>&nbsp;<span class="ident" id="2304309">bsearch16</span><span class="op" id="2304318">(</span><span class="ident" id="2304319">isNotPrint</span><span class="op" id="2304329">,</span>&nbsp;<span class="builtintype" id="2304331">uint16</span><span class="op" id="2304337">(</span><span class="ident" id="2304338">r</span><span class="op" id="2304339">)</span><span class="op" id="2304340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304343">return</span>&nbsp;<span class="ident" id="2304350">j</span>&nbsp;<span class="op" id="2304352">&gt;=</span>&nbsp;<span class="builtinfunc" id="2304355">len</span><span class="op" id="2304358">(</span><span class="ident" id="2304359">isNotPrint</span><span class="op" id="2304369">)</span>&nbsp;<span class="op" id="2304371">||</span>&nbsp;<span class="ident" id="2304374">isNotPrint</span><span class="op" id="2304384">[</span><span class="ident" id="2304385">j</span><span class="op" id="2304386">]</span>&nbsp;<span class="op" id="2304388">!=</span>&nbsp;<span class="builtintype" id="2304391">uint16</span><span class="op" id="2304397">(</span><span class="ident" id="2304398">r</span><span class="op" id="2304399">)</span><br>
<span class="lineno">455</span><span class="op" id="2304401">}</span>
</div>
</body>
</html>
