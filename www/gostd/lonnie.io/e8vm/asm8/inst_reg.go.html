<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/asm8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/asm8/bare_func.go.html">bare_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_file.go.html">build_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_func.go.html">build_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_lib.go.html">build_lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_var.go.html">build_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/builder.go.html">builder.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/check_type.go.html">check_type.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_hex.go.html">data_hex.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_nums.go.html">data_nums.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_str.go.html">data_str.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/file.go.html">file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_decl.go.html">func_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_stmt.go.html">func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst.go.html">inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all.go.html">lex_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all_test.go.html">lex_all_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_comment.go.html">lex_comment.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_operand.go.html">lex_operand.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_string.go.html">lex_string.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lib.go.html">lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/package.go.html">package.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_arg.go.html">parse_arg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_file.go.html">parse_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func.go.html">parse_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_stmt.go.html">parse_func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_test.go.html">parse_func_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_inst.go.html">parse_inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_label.go.html">parse_label.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_reg.go.html">parse_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_sym.go.html">parse_sym.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var.go.html">parse_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var_stmt.go.html">parse_var_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parser.go.html">parser.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/single_file.go.html">single_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/stmt_lexer.go.html">stmt_lexer.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_scope.go.html">sym_scope.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_table.go.html">sym_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/symbol.go.html">symbol.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/token.go.html">token.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_decl.go.html">var_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_stmt.go.html">var_stmt.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="3641654">package</span>&nbsp;<span class="ident" id="3641662">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3641668">import</span>&nbsp;<span class="op" id="3641675">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3641678">&#34;strconv&#34;</span><br>
<span class="lineno">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3641690">&#34;lonnie.io/e8vm/lex8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3641712">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3641715">var</span>&nbsp;<span class="op" id="3641719">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3641722">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3641743">opShiftMap</span>&nbsp;<span class="op" id="3641754">=</span>&nbsp;<span class="keyword" id="3641756">map</span><span class="op" id="3641759">[</span><span class="builtintype" id="3641760">string</span><span class="op" id="3641766">]</span><span class="builtintype" id="3641767">uint32</span><span class="op" id="3641773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3641777">&#34;sll&#34;</span><span class="op" id="3641782">:</span>&nbsp;<span class="num" id="3641784">0</span><span class="op" id="3641785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3641789">&#34;srl&#34;</span><span class="op" id="3641794">:</span>&nbsp;<span class="num" id="3641796">1</span><span class="op" id="3641797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3641801">&#34;sra&#34;</span><span class="op" id="3641806">:</span>&nbsp;<span class="num" id="3641808">2</span><span class="op" id="3641809">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3641812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3641816">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3641835">opReg3Map</span>&nbsp;<span class="op" id="3641845">=</span>&nbsp;<span class="keyword" id="3641847">map</span><span class="op" id="3641850">[</span><span class="builtintype" id="3641851">string</span><span class="op" id="3641857">]</span><span class="builtintype" id="3641858">uint32</span><span class="op" id="3641864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3641868">&#34;sllv&#34;</span><span class="op" id="3641874">:</span>&nbsp;<span class="num" id="3641876">3</span><span class="op" id="3641877">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3641881">&#34;srlv&#34;</span><span class="op" id="3641887">:</span>&nbsp;<span class="num" id="3641889">4</span><span class="op" id="3641890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3641894">&#34;srla&#34;</span><span class="op" id="3641900">:</span>&nbsp;<span class="num" id="3641902">5</span><span class="op" id="3641903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3641907">&#34;add&#34;</span><span class="op" id="3641912">:</span>&nbsp;&nbsp;<span class="num" id="3641915">6</span><span class="op" id="3641916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3641920">&#34;sub&#34;</span><span class="op" id="3641925">:</span>&nbsp;&nbsp;<span class="num" id="3641928">7</span><span class="op" id="3641929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3641933">&#34;and&#34;</span><span class="op" id="3641938">:</span>&nbsp;&nbsp;<span class="num" id="3641941">8</span><span class="op" id="3641942">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3641946">&#34;or&#34;</span><span class="op" id="3641950">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="3641954">9</span><span class="op" id="3641955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3641959">&#34;xor&#34;</span><span class="op" id="3641964">:</span>&nbsp;&nbsp;<span class="num" id="3641967">10</span><span class="op" id="3641969">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3641973">&#34;nor&#34;</span><span class="op" id="3641978">:</span>&nbsp;&nbsp;<span class="num" id="3641981">11</span><span class="op" id="3641983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3641987">&#34;slt&#34;</span><span class="op" id="3641992">:</span>&nbsp;&nbsp;<span class="num" id="3641995">12</span><span class="op" id="3641997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3642001">&#34;sltu&#34;</span><span class="op" id="3642007">:</span>&nbsp;<span class="num" id="3642009">13</span><span class="op" id="3642011">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3642015">&#34;mul&#34;</span><span class="op" id="3642020">:</span>&nbsp;&nbsp;<span class="num" id="3642023">14</span><span class="op" id="3642025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3642029">&#34;mulu&#34;</span><span class="op" id="3642035">:</span>&nbsp;<span class="num" id="3642037">15</span><span class="op" id="3642039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3642043">&#34;div&#34;</span><span class="op" id="3642048">:</span>&nbsp;&nbsp;<span class="num" id="3642051">16</span><span class="op" id="3642053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3642057">&#34;divu&#34;</span><span class="op" id="3642063">:</span>&nbsp;<span class="num" id="3642065">17</span><span class="op" id="3642067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3642071">&#34;mod&#34;</span><span class="op" id="3642076">:</span>&nbsp;&nbsp;<span class="num" id="3642079">18</span><span class="op" id="3642081">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3642085">&#34;modu&#34;</span><span class="op" id="3642091">:</span>&nbsp;<span class="num" id="3642093">19</span><span class="op" id="3642095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3642102">//&nbsp;op&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642117">opReg2Map</span>&nbsp;<span class="op" id="3642127">=</span>&nbsp;<span class="keyword" id="3642129">map</span><span class="op" id="3642132">[</span><span class="builtintype" id="3642133">string</span><span class="op" id="3642139">]</span><span class="builtintype" id="3642140">uint32</span><span class="op" id="3642146">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3642150">&#34;mov&#34;</span><span class="op" id="3642155">:</span>&nbsp;<span class="num" id="3642157">0</span><span class="op" id="3642158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3642165">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642184">opFloatMap</span>&nbsp;<span class="op" id="3642195">=</span>&nbsp;<span class="keyword" id="3642197">map</span><span class="op" id="3642200">[</span><span class="builtintype" id="3642201">string</span><span class="op" id="3642207">]</span><span class="builtintype" id="3642208">uint32</span><span class="op" id="3642214">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3642218">&#34;fadd&#34;</span><span class="op" id="3642224">:</span>&nbsp;<span class="num" id="3642226">0</span><span class="op" id="3642227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3642231">&#34;fsub&#34;</span><span class="op" id="3642237">:</span>&nbsp;<span class="num" id="3642239">1</span><span class="op" id="3642240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3642244">&#34;fmul&#34;</span><span class="op" id="3642250">:</span>&nbsp;<span class="num" id="3642252">2</span><span class="op" id="3642253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3642257">&#34;fdiv&#34;</span><span class="op" id="3642263">:</span>&nbsp;<span class="num" id="3642265">3</span><span class="op" id="3642266">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3642270">&#34;fint&#34;</span><span class="op" id="3642276">:</span>&nbsp;<span class="num" id="3642278">4</span><span class="op" id="3642279">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642282">}</span><br>
<span class="lineno"></span><span class="op" id="3642284">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3642287">func</span>&nbsp;<span class="ident" id="3642292">parseShift</span><span class="op" id="3642302">(</span><span class="ident" id="3642303">p</span>&nbsp;<span class="op" id="3642305">*</span><span class="ident" id="3642306">parser</span><span class="op" id="3642312">,</span>&nbsp;<span class="ident" id="3642314">op</span>&nbsp;<span class="op" id="3642317">*</span><span class="ident" id="3642318">lex8</span><span class="op" id="3642322">.</span><span class="ident" id="3642323">Token</span><span class="op" id="3642328">)</span>&nbsp;<span class="builtintype" id="3642330">uint32</span>&nbsp;<span class="op" id="3642337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642340">ret</span><span class="op" id="3642343">,</span>&nbsp;<span class="ident" id="3642345">e</span>&nbsp;<span class="op" id="3642347">:=</span>&nbsp;<span class="ident" id="3642350">strconv</span><span class="op" id="3642357">.</span><span class="ident" id="3642358">ParseUint</span><span class="op" id="3642367">(</span><span class="ident" id="3642368">op</span><span class="op" id="3642370">.</span><span class="ident" id="3642371">Lit</span><span class="op" id="3642374">,</span>&nbsp;<span class="num" id="3642376">0</span><span class="op" id="3642377">,</span>&nbsp;<span class="num" id="3642379">32</span><span class="op" id="3642381">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642384">if</span>&nbsp;<span class="ident" id="3642387">e</span>&nbsp;<span class="op" id="3642389">!=</span>&nbsp;<span class="ident" id="3642392">nil</span>&nbsp;<span class="op" id="3642396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642400">p</span><span class="op" id="3642401">.</span><span class="ident" id="3642402">err</span><span class="op" id="3642405">(</span><span class="ident" id="3642406">op</span><span class="op" id="3642408">.</span><span class="ident" id="3642409">Pos</span><span class="op" id="3642412">,</span>&nbsp;<span class="string" id="3642414">&#34;invalid&nbsp;shift&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="3642436">,</span>&nbsp;<span class="ident" id="3642438">op</span><span class="op" id="3642440">.</span><span class="ident" id="3642441">Lit</span><span class="op" id="3642444">,</span>&nbsp;<span class="ident" id="3642446">e</span><span class="op" id="3642447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642451">return</span>&nbsp;<span class="num" id="3642458">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642465">if</span>&nbsp;<span class="op" id="3642468">(</span><span class="ident" id="3642469">ret</span>&nbsp;<span class="op" id="3642473">&amp;</span>&nbsp;<span class="num" id="3642475">0x1f</span><span class="op" id="3642479">)</span>&nbsp;<span class="op" id="3642481">!=</span>&nbsp;<span class="ident" id="3642484">ret</span>&nbsp;<span class="op" id="3642488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642492">p</span><span class="op" id="3642493">.</span><span class="ident" id="3642494">err</span><span class="op" id="3642497">(</span><span class="ident" id="3642498">op</span><span class="op" id="3642500">.</span><span class="ident" id="3642501">Pos</span><span class="op" id="3642504">,</span>&nbsp;<span class="string" id="3642506">&#34;shift&nbsp;too&nbsp;large:&nbsp;%s&#34;</span><span class="op" id="3642527">,</span>&nbsp;<span class="ident" id="3642529">op</span><span class="op" id="3642531">.</span><span class="ident" id="3642532">Lit</span><span class="op" id="3642535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642539">return</span>&nbsp;<span class="num" id="3642546">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642553">return</span>&nbsp;<span class="builtintype" id="3642560">uint32</span><span class="op" id="3642566">(</span><span class="ident" id="3642567">ret</span><span class="op" id="3642570">)</span><br>
<span class="lineno"></span><span class="op" id="3642572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3642575">func</span>&nbsp;<span class="ident" id="3642580">makeInstReg</span><span class="op" id="3642591">(</span><span class="ident" id="3642592">fn</span><span class="op" id="3642594">,</span>&nbsp;<span class="ident" id="3642596">d</span><span class="op" id="3642597">,</span>&nbsp;<span class="ident" id="3642599">s1</span><span class="op" id="3642601">,</span>&nbsp;<span class="ident" id="3642603">s2</span><span class="op" id="3642605">,</span>&nbsp;<span class="ident" id="3642607">sh</span><span class="op" id="3642609">,</span>&nbsp;<span class="ident" id="3642611">isFloat</span>&nbsp;<span class="builtintype" id="3642619">uint32</span><span class="op" id="3642625">)</span>&nbsp;<span class="op" id="3642627">*</span><span class="ident" id="3642628">inst</span>&nbsp;<span class="op" id="3642633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642636">ret</span>&nbsp;<span class="op" id="3642640">:=</span>&nbsp;<span class="builtintype" id="3642643">uint32</span><span class="op" id="3642649">(</span><span class="num" id="3642650">0</span><span class="op" id="3642651">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642654">ret</span>&nbsp;<span class="op" id="3642658">|=</span>&nbsp;<span class="op" id="3642661">(</span><span class="ident" id="3642662">d</span>&nbsp;<span class="op" id="3642664">&amp;</span>&nbsp;<span class="num" id="3642666">0x7</span><span class="op" id="3642669">)</span>&nbsp;<span class="op" id="3642671">&lt;&lt;</span>&nbsp;<span class="num" id="3642674">21</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642678">ret</span>&nbsp;<span class="op" id="3642682">|=</span>&nbsp;<span class="op" id="3642685">(</span><span class="ident" id="3642686">s1</span>&nbsp;<span class="op" id="3642689">&amp;</span>&nbsp;<span class="num" id="3642691">0x7</span><span class="op" id="3642694">)</span>&nbsp;<span class="op" id="3642696">&lt;&lt;</span>&nbsp;<span class="num" id="3642699">18</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642703">ret</span>&nbsp;<span class="op" id="3642707">|=</span>&nbsp;<span class="op" id="3642710">(</span><span class="ident" id="3642711">s2</span>&nbsp;<span class="op" id="3642714">&amp;</span>&nbsp;<span class="num" id="3642716">0x7</span><span class="op" id="3642719">)</span>&nbsp;<span class="op" id="3642721">&lt;&lt;</span>&nbsp;<span class="num" id="3642724">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642728">ret</span>&nbsp;<span class="op" id="3642732">|=</span>&nbsp;<span class="op" id="3642735">(</span><span class="ident" id="3642736">sh</span>&nbsp;<span class="op" id="3642739">&amp;</span>&nbsp;<span class="num" id="3642741">0x1f</span><span class="op" id="3642745">)</span>&nbsp;<span class="op" id="3642747">&lt;&lt;</span>&nbsp;<span class="num" id="3642750">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642754">ret</span>&nbsp;<span class="op" id="3642758">|=</span>&nbsp;<span class="op" id="3642761">(</span><span class="ident" id="3642762">isFloat</span>&nbsp;<span class="op" id="3642770">&amp;</span>&nbsp;<span class="num" id="3642772">0x1</span><span class="op" id="3642775">)</span>&nbsp;<span class="op" id="3642777">&lt;&lt;</span>&nbsp;<span class="num" id="3642780">8</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642783">ret</span>&nbsp;<span class="op" id="3642787">|=</span>&nbsp;<span class="ident" id="3642790">fn</span>&nbsp;<span class="op" id="3642793">&amp;</span>&nbsp;<span class="num" id="3642795">0xff</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642802">return</span>&nbsp;<span class="op" id="3642809">&amp;</span><span class="ident" id="3642810">inst</span><span class="op" id="3642814">{</span><span class="ident" id="3642815">inst</span><span class="op" id="3642819">:</span>&nbsp;<span class="ident" id="3642821">ret</span><span class="op" id="3642824">}</span><br>
<span class="lineno"></span><span class="op" id="3642826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="3642829">func</span>&nbsp;<span class="ident" id="3642834">parseInstReg</span><span class="op" id="3642846">(</span><span class="ident" id="3642847">p</span>&nbsp;<span class="op" id="3642849">*</span><span class="ident" id="3642850">parser</span><span class="op" id="3642856">,</span>&nbsp;<span class="ident" id="3642858">ops</span>&nbsp;<span class="op" id="3642862">[</span><span class="op" id="3642863">]</span><span class="op" id="3642864">*</span><span class="ident" id="3642865">lex8</span><span class="op" id="3642869">.</span><span class="ident" id="3642870">Token</span><span class="op" id="3642875">)</span>&nbsp;<span class="op" id="3642877">(</span><span class="op" id="3642878">*</span><span class="ident" id="3642879">inst</span><span class="op" id="3642883">,</span>&nbsp;<span class="builtintype" id="3642885">bool</span><span class="op" id="3642889">)</span>&nbsp;<span class="op" id="3642891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642894">op0</span>&nbsp;<span class="op" id="3642898">:=</span>&nbsp;<span class="ident" id="3642901">ops</span><span class="op" id="3642904">[</span><span class="num" id="3642905">0</span><span class="op" id="3642906">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642909">opName</span>&nbsp;<span class="op" id="3642916">:=</span>&nbsp;<span class="ident" id="3642919">op0</span><span class="op" id="3642922">.</span><span class="ident" id="3642923">Lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642928">args</span>&nbsp;<span class="op" id="3642933">:=</span>&nbsp;<span class="ident" id="3642936">ops</span><span class="op" id="3642939">[</span><span class="num" id="3642940">1</span><span class="op" id="3642941">:</span><span class="op" id="3642942">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3642946">//&nbsp;common&nbsp;args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642962">var</span>&nbsp;<span class="ident" id="3642966">fn</span><span class="op" id="3642968">,</span>&nbsp;<span class="ident" id="3642970">d</span><span class="op" id="3642971">,</span>&nbsp;<span class="ident" id="3642973">s1</span><span class="op" id="3642975">,</span>&nbsp;<span class="ident" id="3642977">s2</span><span class="op" id="3642979">,</span>&nbsp;<span class="ident" id="3642981">sh</span><span class="op" id="3642983">,</span>&nbsp;<span class="ident" id="3642985">isFloat</span>&nbsp;<span class="builtintype" id="3642993">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643002">argCount</span>&nbsp;<span class="op" id="3643011">:=</span>&nbsp;<span class="keyword" id="3643014">func</span><span class="op" id="3643018">(</span><span class="ident" id="3643019">n</span>&nbsp;<span class="builtintype" id="3643021">int</span><span class="op" id="3643024">)</span>&nbsp;<span class="builtintype" id="3643026">bool</span>&nbsp;<span class="op" id="3643031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643035">if</span>&nbsp;<span class="op" id="3643038">!</span><span class="ident" id="3643039">argCount</span><span class="op" id="3643047">(</span><span class="ident" id="3643048">p</span><span class="op" id="3643049">,</span>&nbsp;<span class="ident" id="3643051">ops</span><span class="op" id="3643054">,</span>&nbsp;<span class="ident" id="3643056">n</span><span class="op" id="3643057">)</span>&nbsp;<span class="op" id="3643059">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643064">return</span>&nbsp;<span class="builtintype" id="3643071">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643083">if</span>&nbsp;<span class="ident" id="3643086">n</span>&nbsp;<span class="op" id="3643088">&gt;=</span>&nbsp;<span class="num" id="3643091">2</span>&nbsp;<span class="op" id="3643093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643098">d</span>&nbsp;<span class="op" id="3643100">=</span>&nbsp;<span class="ident" id="3643102">parseReg</span><span class="op" id="3643110">(</span><span class="ident" id="3643111">p</span><span class="op" id="3643112">,</span>&nbsp;<span class="ident" id="3643114">args</span><span class="op" id="3643118">[</span><span class="num" id="3643119">0</span><span class="op" id="3643120">]</span><span class="op" id="3643121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643126">s1</span>&nbsp;<span class="op" id="3643129">=</span>&nbsp;<span class="ident" id="3643131">parseReg</span><span class="op" id="3643139">(</span><span class="ident" id="3643140">p</span><span class="op" id="3643141">,</span>&nbsp;<span class="ident" id="3643143">args</span><span class="op" id="3643147">[</span><span class="num" id="3643148">1</span><span class="op" id="3643149">]</span><span class="op" id="3643150">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643158">return</span>&nbsp;<span class="builtintype" id="3643165">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643175">var</span>&nbsp;<span class="ident" id="3643179">found</span>&nbsp;<span class="builtintype" id="3643185">bool</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643191">if</span>&nbsp;<span class="ident" id="3643194">fn</span><span class="op" id="3643196">,</span>&nbsp;<span class="ident" id="3643198">found</span>&nbsp;<span class="op" id="3643204">=</span>&nbsp;<span class="ident" id="3643206">opShiftMap</span><span class="op" id="3643216">[</span><span class="ident" id="3643217">opName</span><span class="op" id="3643223">]</span><span class="op" id="3643224">;</span>&nbsp;<span class="ident" id="3643226">found</span>&nbsp;<span class="op" id="3643232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3643236">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643258">if</span>&nbsp;<span class="ident" id="3643261">argCount</span><span class="op" id="3643269">(</span><span class="num" id="3643270">3</span><span class="op" id="3643271">)</span>&nbsp;<span class="op" id="3643273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643278">sh</span>&nbsp;<span class="op" id="3643281">=</span>&nbsp;<span class="ident" id="3643283">parseShift</span><span class="op" id="3643293">(</span><span class="ident" id="3643294">p</span><span class="op" id="3643295">,</span>&nbsp;<span class="ident" id="3643297">args</span><span class="op" id="3643301">[</span><span class="num" id="3643302">2</span><span class="op" id="3643303">]</span><span class="op" id="3643304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643308">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643311">}</span>&nbsp;<span class="keyword" id="3643313">else</span>&nbsp;<span class="keyword" id="3643318">if</span>&nbsp;<span class="ident" id="3643321">fn</span><span class="op" id="3643323">,</span>&nbsp;<span class="ident" id="3643325">found</span>&nbsp;<span class="op" id="3643331">=</span>&nbsp;<span class="ident" id="3643333">opReg3Map</span><span class="op" id="3643342">[</span><span class="ident" id="3643343">opName</span><span class="op" id="3643349">]</span><span class="op" id="3643350">;</span>&nbsp;<span class="ident" id="3643352">found</span>&nbsp;<span class="op" id="3643358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3643362">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643382">if</span>&nbsp;<span class="ident" id="3643385">argCount</span><span class="op" id="3643393">(</span><span class="num" id="3643394">3</span><span class="op" id="3643395">)</span>&nbsp;<span class="op" id="3643397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643402">s2</span>&nbsp;<span class="op" id="3643405">=</span>&nbsp;<span class="ident" id="3643407">parseReg</span><span class="op" id="3643415">(</span><span class="ident" id="3643416">p</span><span class="op" id="3643417">,</span>&nbsp;<span class="ident" id="3643419">args</span><span class="op" id="3643423">[</span><span class="num" id="3643424">2</span><span class="op" id="3643425">]</span><span class="op" id="3643426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643430">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643433">}</span>&nbsp;<span class="keyword" id="3643435">else</span>&nbsp;<span class="keyword" id="3643440">if</span>&nbsp;<span class="ident" id="3643443">fn</span><span class="op" id="3643445">,</span>&nbsp;<span class="ident" id="3643447">found</span>&nbsp;<span class="op" id="3643453">=</span>&nbsp;<span class="ident" id="3643455">opReg2Map</span><span class="op" id="3643464">[</span><span class="ident" id="3643465">opName</span><span class="op" id="3643471">]</span><span class="op" id="3643472">;</span>&nbsp;<span class="ident" id="3643474">found</span>&nbsp;<span class="op" id="3643480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3643484">//&nbsp;op&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643500">argCount</span><span class="op" id="3643508">(</span><span class="num" id="3643509">2</span><span class="op" id="3643510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643513">}</span>&nbsp;<span class="keyword" id="3643515">else</span>&nbsp;<span class="keyword" id="3643520">if</span>&nbsp;<span class="ident" id="3643523">fn</span><span class="op" id="3643525">,</span>&nbsp;<span class="ident" id="3643527">found</span>&nbsp;<span class="op" id="3643533">=</span>&nbsp;<span class="ident" id="3643535">opFloatMap</span><span class="op" id="3643545">[</span><span class="ident" id="3643546">opName</span><span class="op" id="3643552">]</span><span class="op" id="3643553">;</span>&nbsp;<span class="ident" id="3643555">found</span>&nbsp;<span class="op" id="3643561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3643565">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643585">if</span>&nbsp;<span class="ident" id="3643588">argCount</span><span class="op" id="3643596">(</span><span class="num" id="3643597">3</span><span class="op" id="3643598">)</span>&nbsp;<span class="op" id="3643600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643605">s2</span>&nbsp;<span class="op" id="3643608">=</span>&nbsp;<span class="ident" id="3643610">parseReg</span><span class="op" id="3643618">(</span><span class="ident" id="3643619">p</span><span class="op" id="3643620">,</span>&nbsp;<span class="ident" id="3643622">args</span><span class="op" id="3643626">[</span><span class="num" id="3643627">2</span><span class="op" id="3643628">]</span><span class="op" id="3643629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643637">isFloat</span>&nbsp;<span class="op" id="3643645">=</span>&nbsp;<span class="num" id="3643647">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643650">}</span>&nbsp;<span class="keyword" id="3643652">else</span>&nbsp;<span class="op" id="3643657">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643661">return</span>&nbsp;<span class="ident" id="3643668">nil</span><span class="op" id="3643671">,</span>&nbsp;<span class="builtintype" id="3643673">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643684">return</span>&nbsp;<span class="ident" id="3643691">makeInstReg</span><span class="op" id="3643702">(</span><span class="ident" id="3643703">fn</span><span class="op" id="3643705">,</span>&nbsp;<span class="ident" id="3643707">d</span><span class="op" id="3643708">,</span>&nbsp;<span class="ident" id="3643710">s1</span><span class="op" id="3643712">,</span>&nbsp;<span class="ident" id="3643714">s2</span><span class="op" id="3643716">,</span>&nbsp;<span class="ident" id="3643718">sh</span><span class="op" id="3643720">,</span>&nbsp;<span class="ident" id="3643722">isFloat</span><span class="op" id="3643729">)</span><span class="op" id="3643730">,</span>&nbsp;<span class="builtintype" id="3643732">true</span><br>
<span class="lineno"></span><span class="op" id="3643737">}</span>
</div>
</body>
</html>
