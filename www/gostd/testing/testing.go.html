<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing</h2>
<ul>
<li><a href="/gostd/testing/allocs.go.html">allocs.go</a></li>
<li><a href="/gostd/testing/allocs_test.go.html">allocs_test.go</a></li>
<li><a href="/gostd/testing/benchmark.go.html">benchmark.go</a></li>
<li><a href="/gostd/testing/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/testing/cover.go.html">cover.go</a></li>
<li><a href="/gostd/testing/example.go.html">example.go</a></li>
<li><a href="/gostd/testing/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/testing/testing.go.html" class="current">testing.go</a></li>
<li><a href="/gostd/testing/testing_test.go.html">testing_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6099607">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6099662">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6099716">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6099767">//&nbsp;Package&nbsp;testing&nbsp;provides&nbsp;support&nbsp;for&nbsp;automated&nbsp;testing&nbsp;of&nbsp;Go&nbsp;packages.</span><br>
<span class="lineno"></span><span class="comment" id="6099841">//&nbsp;It&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;used&nbsp;in&nbsp;concert&nbsp;with&nbsp;the&nbsp;``go&nbsp;test&#39;&#39;&nbsp;command,&nbsp;which&nbsp;automates</span><br>
<span class="lineno"></span><span class="comment" id="6099927">//&nbsp;execution&nbsp;of&nbsp;any&nbsp;function&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span><span class="comment" id="6099968">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;TestXxx(*testing.T)</span><br>
<span class="lineno"></span><span class="comment" id="6100000">//&nbsp;where&nbsp;Xxx&nbsp;can&nbsp;be&nbsp;any&nbsp;alphanumeric&nbsp;string&nbsp;(but&nbsp;the&nbsp;first&nbsp;letter&nbsp;must&nbsp;not&nbsp;be&nbsp;in</span><br>
<span class="lineno">10</span><span class="comment" id="6100081">//&nbsp;[a-z])&nbsp;and&nbsp;serves&nbsp;to&nbsp;identify&nbsp;the&nbsp;test&nbsp;routine.</span><br>
<span class="lineno"></span><span class="comment" id="6100132">//</span><br>
<span class="lineno"></span><span class="comment" id="6100135">//&nbsp;Within&nbsp;these&nbsp;functions,&nbsp;use&nbsp;the&nbsp;Error,&nbsp;Fail&nbsp;or&nbsp;related&nbsp;methods&nbsp;to&nbsp;signal&nbsp;failure.</span><br>
<span class="lineno"></span><span class="comment" id="6100220">//</span><br>
<span class="lineno"></span><span class="comment" id="6100223">//&nbsp;To&nbsp;write&nbsp;a&nbsp;new&nbsp;test&nbsp;suite,&nbsp;create&nbsp;a&nbsp;file&nbsp;whose&nbsp;name&nbsp;ends&nbsp;_test.go&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="6100297">//&nbsp;contains&nbsp;the&nbsp;TestXxx&nbsp;functions&nbsp;as&nbsp;described&nbsp;here.&nbsp;Put&nbsp;the&nbsp;file&nbsp;in&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="6100375">//&nbsp;package&nbsp;as&nbsp;the&nbsp;one&nbsp;being&nbsp;tested.&nbsp;The&nbsp;file&nbsp;will&nbsp;be&nbsp;excluded&nbsp;from&nbsp;regular</span><br>
<span class="lineno"></span><span class="comment" id="6100450">//&nbsp;package&nbsp;builds&nbsp;but&nbsp;will&nbsp;be&nbsp;included&nbsp;when&nbsp;the&nbsp;``go&nbsp;test&#39;&#39;&nbsp;command&nbsp;is&nbsp;run.</span><br>
<span class="lineno"></span><span class="comment" id="6100526">//&nbsp;For&nbsp;more&nbsp;detail,&nbsp;run&nbsp;``go&nbsp;help&nbsp;test&#39;&#39;&nbsp;and&nbsp;``go&nbsp;help&nbsp;testflag&#39;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="6100593">//</span><br>
<span class="lineno">20</span><span class="comment" id="6100596">//&nbsp;Tests&nbsp;and&nbsp;benchmarks&nbsp;may&nbsp;be&nbsp;skipped&nbsp;if&nbsp;not&nbsp;applicable&nbsp;with&nbsp;a&nbsp;call&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6100668">//&nbsp;the&nbsp;Skip&nbsp;method&nbsp;of&nbsp;*T&nbsp;and&nbsp;*B:</span><br>
<span class="lineno"></span><span class="comment" id="6100701">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;TestTimeConsuming(t&nbsp;*testing.T)&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6100747">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;testing.Short()&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6100779">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.Skip(&#34;skipping&nbsp;test&nbsp;in&nbsp;short&nbsp;mode.&#34;)</span><br>
<span class="lineno">25</span><span class="comment" id="6100833">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6100846">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="6100861">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6100870">//</span><br>
<span class="lineno"></span><span class="comment" id="6100873">//&nbsp;Benchmarks</span><br>
<span class="lineno">30</span><span class="comment" id="6100887">//</span><br>
<span class="lineno"></span><span class="comment" id="6100890">//&nbsp;Functions&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span><span class="comment" id="6100915">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;BenchmarkXxx(*testing.B)</span><br>
<span class="lineno"></span><span class="comment" id="6100952">//&nbsp;are&nbsp;considered&nbsp;benchmarks,&nbsp;and&nbsp;are&nbsp;executed&nbsp;by&nbsp;the&nbsp;&#34;go&nbsp;test&#34;&nbsp;command&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="6101029">//&nbsp;its&nbsp;-bench&nbsp;flag&nbsp;is&nbsp;provided.&nbsp;Benchmarks&nbsp;are&nbsp;run&nbsp;sequentially.</span><br>
<span class="lineno">35</span><span class="comment" id="6101094">//</span><br>
<span class="lineno"></span><span class="comment" id="6101097">//&nbsp;For&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;testing&nbsp;flags,&nbsp;see</span><br>
<span class="lineno"></span><span class="comment" id="6101144">//&nbsp;http://golang.org/cmd/go/#hdr-Description_of_testing_flags.</span><br>
<span class="lineno"></span><span class="comment" id="6101207">//</span><br>
<span class="lineno"></span><span class="comment" id="6101210">//&nbsp;A&nbsp;sample&nbsp;benchmark&nbsp;function&nbsp;looks&nbsp;like&nbsp;this:</span><br>
<span class="lineno">40</span><span class="comment" id="6101258">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;BenchmarkHello(b&nbsp;*testing.B)&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6101301">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;:=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;b.N;&nbsp;i++&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6101339">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt.Sprintf(&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="6101375">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6101388">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno">45</span><span class="comment" id="6101397">//</span><br>
<span class="lineno"></span><span class="comment" id="6101400">//&nbsp;The&nbsp;benchmark&nbsp;function&nbsp;must&nbsp;run&nbsp;the&nbsp;target&nbsp;code&nbsp;b.N&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="6101462">//&nbsp;During&nbsp;benchark&nbsp;execution,&nbsp;b.N&nbsp;is&nbsp;adjusted&nbsp;until&nbsp;the&nbsp;benchmark&nbsp;function&nbsp;lasts</span><br>
<span class="lineno"></span><span class="comment" id="6101543">//&nbsp;long&nbsp;enough&nbsp;to&nbsp;be&nbsp;timed&nbsp;reliably.&nbsp;&nbsp;The&nbsp;output</span><br>
<span class="lineno"></span><span class="comment" id="6101592">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BenchmarkHello&nbsp;&nbsp;&nbsp;&nbsp;10000000&nbsp;&nbsp;&nbsp;&nbsp;282&nbsp;ns/op</span><br>
<span class="lineno">50</span><span class="comment" id="6101639">//&nbsp;means&nbsp;that&nbsp;the&nbsp;loop&nbsp;ran&nbsp;10000000&nbsp;times&nbsp;at&nbsp;a&nbsp;speed&nbsp;of&nbsp;282&nbsp;ns&nbsp;per&nbsp;loop.</span><br>
<span class="lineno"></span><span class="comment" id="6101712">//</span><br>
<span class="lineno"></span><span class="comment" id="6101715">//&nbsp;If&nbsp;a&nbsp;benchmark&nbsp;needs&nbsp;some&nbsp;expensive&nbsp;setup&nbsp;before&nbsp;running,&nbsp;the&nbsp;timer</span><br>
<span class="lineno"></span><span class="comment" id="6101786">//&nbsp;may&nbsp;be&nbsp;reset:</span><br>
<span class="lineno"></span><span class="comment" id="6101803">//</span><br>
<span class="lineno">55</span><span class="comment" id="6101806">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;BenchmarkBigLen(b&nbsp;*testing.B)&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6101850">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;big&nbsp;:=&nbsp;NewBig()</span><br>
<span class="lineno"></span><span class="comment" id="6101877">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.ResetTimer()</span><br>
<span class="lineno"></span><span class="comment" id="6101903">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;:=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;b.N;&nbsp;i++&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6101941">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;big.Len()</span><br>
<span class="lineno">60</span><span class="comment" id="6101966">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6101979">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6101988">//</span><br>
<span class="lineno"></span><span class="comment" id="6101991">//&nbsp;If&nbsp;a&nbsp;benchmark&nbsp;needs&nbsp;to&nbsp;test&nbsp;performance&nbsp;in&nbsp;a&nbsp;parallel&nbsp;setting,&nbsp;it&nbsp;may&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="6102069">//&nbsp;the&nbsp;RunParallel&nbsp;helper&nbsp;function;&nbsp;such&nbsp;benchmarks&nbsp;are&nbsp;intended&nbsp;to&nbsp;be&nbsp;used&nbsp;with</span><br>
<span class="lineno">65</span><span class="comment" id="6102150">//&nbsp;the&nbsp;go&nbsp;test&nbsp;-cpu&nbsp;flag:</span><br>
<span class="lineno"></span><span class="comment" id="6102176">//</span><br>
<span class="lineno"></span><span class="comment" id="6102179">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;BenchmarkTemplateParallel(b&nbsp;*testing.B)&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6102233">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;templ&nbsp;:=&nbsp;template.Must(template.New(&#34;test&#34;).Parse(&#34;Hello,&nbsp;{{.}}!&#34;))</span><br>
<span class="lineno"></span><span class="comment" id="6102312">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.RunParallel(func(pb&nbsp;*testing.PB)&nbsp;{</span><br>
<span class="lineno">70</span><span class="comment" id="6102360">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;buf&nbsp;bytes.Buffer</span><br>
<span class="lineno"></span><span class="comment" id="6102396">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;pb.Next()&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6102427">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf.Reset()</span><br>
<span class="lineno"></span><span class="comment" id="6102458">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;templ.Execute(&amp;buf,&nbsp;&#34;World&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="6102506">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno">75</span><span class="comment" id="6102523">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</span><br>
<span class="lineno"></span><span class="comment" id="6102537">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6102546">//</span><br>
<span class="lineno"></span><span class="comment" id="6102549">//&nbsp;Examples</span><br>
<span class="lineno"></span><span class="comment" id="6102561">//</span><br>
<span class="lineno">80</span><span class="comment" id="6102564">//&nbsp;The&nbsp;package&nbsp;also&nbsp;runs&nbsp;and&nbsp;verifies&nbsp;example&nbsp;code.&nbsp;Example&nbsp;functions&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="6102638">//&nbsp;include&nbsp;a&nbsp;concluding&nbsp;line&nbsp;comment&nbsp;that&nbsp;begins&nbsp;with&nbsp;&#34;Output:&#34;&nbsp;and&nbsp;is&nbsp;compared&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6102723">//&nbsp;the&nbsp;standard&nbsp;output&nbsp;of&nbsp;the&nbsp;function&nbsp;when&nbsp;the&nbsp;tests&nbsp;are&nbsp;run.&nbsp;(The&nbsp;comparison</span><br>
<span class="lineno"></span><span class="comment" id="6102802">//&nbsp;ignores&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;space.)&nbsp;These&nbsp;are&nbsp;examples&nbsp;of&nbsp;an&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="6102876">//</span><br>
<span class="lineno">85</span><span class="comment" id="6102879">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleHello()&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6102908">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt.Println(&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="6102944">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Output:&nbsp;hello</span><br>
<span class="lineno"></span><span class="comment" id="6102976">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6102985">//</span><br>
<span class="lineno">90</span><span class="comment" id="6102988">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleSalutations()&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6103023">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt.Println(&#34;hello,&nbsp;and&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="6103064">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt.Println(&#34;goodbye&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="6103102">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Output:</span><br>
<span class="lineno"></span><span class="comment" id="6103128">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;hello,&nbsp;and</span><br>
<span class="lineno">95</span><span class="comment" id="6103157">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;goodbye</span><br>
<span class="lineno"></span><span class="comment" id="6103183">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6103192">//</span><br>
<span class="lineno"></span><span class="comment" id="6103195">//&nbsp;Example&nbsp;functions&nbsp;without&nbsp;output&nbsp;comments&nbsp;are&nbsp;compiled&nbsp;but&nbsp;not&nbsp;executed.</span><br>
<span class="lineno"></span><span class="comment" id="6103271">//</span><br>
<span class="lineno">100</span><span class="comment" id="6103274">//&nbsp;The&nbsp;naming&nbsp;convention&nbsp;to&nbsp;declare&nbsp;examples&nbsp;for&nbsp;the&nbsp;package,&nbsp;a&nbsp;function&nbsp;F,&nbsp;a&nbsp;type&nbsp;T&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6103363">//&nbsp;method&nbsp;M&nbsp;on&nbsp;type&nbsp;T&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="6103390">//</span><br>
<span class="lineno"></span><span class="comment" id="6103393">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;Example()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6103423">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleF()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno">105</span><span class="comment" id="6103454">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleT()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6103485">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleT_M()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6103518">//</span><br>
<span class="lineno"></span><span class="comment" id="6103521">//&nbsp;Multiple&nbsp;example&nbsp;functions&nbsp;for&nbsp;a&nbsp;package/type/function/method&nbsp;may&nbsp;be&nbsp;provided&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6103605">//&nbsp;appending&nbsp;a&nbsp;distinct&nbsp;suffix&nbsp;to&nbsp;the&nbsp;name.&nbsp;The&nbsp;suffix&nbsp;must&nbsp;start&nbsp;with&nbsp;a</span><br>
<span class="lineno">110</span><span class="comment" id="6103678">//&nbsp;lower-case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="comment" id="6103700">//</span><br>
<span class="lineno"></span><span class="comment" id="6103703">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;Example_suffix()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6103740">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleF_suffix()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6103778">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleT_suffix()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno">115</span><span class="comment" id="6103816">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleT_M_suffix()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6103856">//</span><br>
<span class="lineno"></span><span class="comment" id="6103859">//&nbsp;The&nbsp;entire&nbsp;test&nbsp;file&nbsp;is&nbsp;presented&nbsp;as&nbsp;the&nbsp;example&nbsp;when&nbsp;it&nbsp;contains&nbsp;a&nbsp;single</span><br>
<span class="lineno"></span><span class="comment" id="6103937">//&nbsp;example&nbsp;function,&nbsp;at&nbsp;least&nbsp;one&nbsp;other&nbsp;function,&nbsp;type,&nbsp;variable,&nbsp;or&nbsp;constant</span><br>
<span class="lineno"></span><span class="comment" id="6104015">//&nbsp;declaration,&nbsp;and&nbsp;no&nbsp;test&nbsp;or&nbsp;benchmark&nbsp;functions.</span><br>
<span class="lineno">120</span><span class="comment" id="6104067">//</span><br>
<span class="lineno"></span><span class="comment" id="6104070">//&nbsp;Main</span><br>
<span class="lineno"></span><span class="comment" id="6104078">//</span><br>
<span class="lineno"></span><span class="comment" id="6104081">//&nbsp;It&nbsp;is&nbsp;sometimes&nbsp;necessary&nbsp;for&nbsp;a&nbsp;test&nbsp;program&nbsp;to&nbsp;do&nbsp;extra&nbsp;setup&nbsp;or&nbsp;teardown</span><br>
<span class="lineno"></span><span class="comment" id="6104159">//&nbsp;before&nbsp;or&nbsp;after&nbsp;testing.&nbsp;It&nbsp;is&nbsp;also&nbsp;sometimes&nbsp;necessary&nbsp;for&nbsp;a&nbsp;test&nbsp;to&nbsp;control</span><br>
<span class="lineno">125</span><span class="comment" id="6104240">//&nbsp;which&nbsp;code&nbsp;runs&nbsp;on&nbsp;the&nbsp;main&nbsp;thread.&nbsp;To&nbsp;support&nbsp;these&nbsp;and&nbsp;other&nbsp;cases,</span><br>
<span class="lineno"></span><span class="comment" id="6104313">//&nbsp;if&nbsp;a&nbsp;test&nbsp;file&nbsp;contains&nbsp;a&nbsp;function:</span><br>
<span class="lineno"></span><span class="comment" id="6104352">//</span><br>
<span class="lineno"></span><span class="comment" id="6104355">//&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;TestMain(m&nbsp;*testing.M)</span><br>
<span class="lineno"></span><span class="comment" id="6104386">//</span><br>
<span class="lineno">130</span><span class="comment" id="6104389">//&nbsp;then&nbsp;the&nbsp;generated&nbsp;test&nbsp;will&nbsp;call&nbsp;TestMain(m)&nbsp;instead&nbsp;of&nbsp;running&nbsp;the&nbsp;tests</span><br>
<span class="lineno"></span><span class="comment" id="6104467">//&nbsp;directly.&nbsp;TestMain&nbsp;runs&nbsp;in&nbsp;the&nbsp;main&nbsp;goroutine&nbsp;and&nbsp;can&nbsp;do&nbsp;whatever&nbsp;setup</span><br>
<span class="lineno"></span><span class="comment" id="6104542">//&nbsp;and&nbsp;teardown&nbsp;is&nbsp;necessary&nbsp;around&nbsp;a&nbsp;call&nbsp;to&nbsp;m.Run.&nbsp;It&nbsp;should&nbsp;then&nbsp;call</span><br>
<span class="lineno"></span><span class="comment" id="6104615">//&nbsp;os.Exit&nbsp;with&nbsp;the&nbsp;result&nbsp;of&nbsp;m.Run.</span><br>
<span class="lineno"></span><span class="comment" id="6104652">//</span><br>
<span class="lineno">135</span><span class="comment" id="6104655">//&nbsp;The&nbsp;minimal&nbsp;implementation&nbsp;of&nbsp;TestMain&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="6104701">//</span><br>
<span class="lineno"></span><span class="comment" id="6104704">//&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;TestMain(m&nbsp;*testing.M)&nbsp;{&nbsp;os.Exit(m.Run())&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6104756">//</span><br>
<span class="lineno"></span><span class="comment" id="6104759">//&nbsp;In&nbsp;effect,&nbsp;that&nbsp;is&nbsp;the&nbsp;implementation&nbsp;used&nbsp;when&nbsp;no&nbsp;TestMain&nbsp;is&nbsp;explicitly&nbsp;defined.</span><br>
<span class="lineno">140</span><span class="keyword" id="6104845">package</span>&nbsp;<span class="ident" id="6104853">testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6104862">import</span>&nbsp;<span class="op" id="6104869">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6104872">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6104881">&#34;flag&#34;</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6104889">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6104896">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6104902">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6104913">&#34;runtime/pprof&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6104930">&#34;strconv&#34;</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6104941">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6104952">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6104960">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6104967">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="keyword" id="6104970">var</span>&nbsp;<span class="op" id="6104974">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6104977">//&nbsp;The&nbsp;short&nbsp;flag&nbsp;requests&nbsp;that&nbsp;tests&nbsp;run&nbsp;more&nbsp;quickly,&nbsp;but&nbsp;its&nbsp;functionality</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6105056">//&nbsp;is&nbsp;provided&nbsp;by&nbsp;test&nbsp;writers&nbsp;themselves.&nbsp;&nbsp;The&nbsp;testing&nbsp;package&nbsp;is&nbsp;just&nbsp;its</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6105133">//&nbsp;home.&nbsp;&nbsp;The&nbsp;all.bash&nbsp;installation&nbsp;script&nbsp;sets&nbsp;it&nbsp;to&nbsp;make&nbsp;installation&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6105211">//&nbsp;efficient,&nbsp;but&nbsp;by&nbsp;default&nbsp;the&nbsp;flag&nbsp;is&nbsp;off&nbsp;so&nbsp;a&nbsp;plain&nbsp;&#34;go&nbsp;test&#34;&nbsp;will&nbsp;do&nbsp;a</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6105288">//&nbsp;full&nbsp;test&nbsp;of&nbsp;the&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6105318">short</span>&nbsp;<span class="op" id="6105324">=</span>&nbsp;<span class="ident" id="6105326">flag</span><span class="op" id="6105330">.</span><span class="ident" id="6105331">Bool</span><span class="op" id="6105335">(</span><span class="string" id="6105336">&#34;test.short&#34;</span><span class="op" id="6105348">,</span>&nbsp;<span class="builtintype" id="6105350">false</span><span class="op" id="6105355">,</span>&nbsp;<span class="string" id="6105357">&#34;run&nbsp;smaller&nbsp;test&nbsp;suite&nbsp;to&nbsp;save&nbsp;time&#34;</span><span class="op" id="6105394">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6105398">//&nbsp;The&nbsp;directory&nbsp;in&nbsp;which&nbsp;to&nbsp;create&nbsp;profile&nbsp;files&nbsp;and&nbsp;the&nbsp;like.&nbsp;When&nbsp;run&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6105477">//&nbsp;&#34;go&nbsp;test&#34;,&nbsp;the&nbsp;binary&nbsp;always&nbsp;runs&nbsp;in&nbsp;the&nbsp;source&nbsp;directory&nbsp;for&nbsp;the&nbsp;package;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6105556">//&nbsp;this&nbsp;flag&nbsp;lets&nbsp;&#34;go&nbsp;test&#34;&nbsp;tell&nbsp;the&nbsp;binary&nbsp;to&nbsp;write&nbsp;the&nbsp;files&nbsp;in&nbsp;the&nbsp;directory&nbsp;where</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6105643">//&nbsp;the&nbsp;&#34;go&nbsp;test&#34;&nbsp;command&nbsp;is&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6105677">outputDir</span>&nbsp;<span class="op" id="6105687">=</span>&nbsp;<span class="ident" id="6105689">flag</span><span class="op" id="6105693">.</span><span class="ident" id="6105694">String</span><span class="op" id="6105700">(</span><span class="string" id="6105701">&#34;test.outputdir&#34;</span><span class="op" id="6105717">,</span>&nbsp;<span class="string" id="6105719">&#34;&#34;</span><span class="op" id="6105721">,</span>&nbsp;<span class="string" id="6105723">&#34;directory&nbsp;in&nbsp;which&nbsp;to&nbsp;write&nbsp;profiles&#34;</span><span class="op" id="6105761">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6105765">//&nbsp;Report&nbsp;as&nbsp;tests&nbsp;are&nbsp;run;&nbsp;default&nbsp;is&nbsp;silent&nbsp;for&nbsp;success.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6105825">chatty</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6105842">=</span>&nbsp;<span class="ident" id="6105844">flag</span><span class="op" id="6105848">.</span><span class="ident" id="6105849">Bool</span><span class="op" id="6105853">(</span><span class="string" id="6105854">&#34;test.v&#34;</span><span class="op" id="6105862">,</span>&nbsp;<span class="builtintype" id="6105864">false</span><span class="op" id="6105869">,</span>&nbsp;<span class="string" id="6105871">&#34;verbose:&nbsp;print&nbsp;additional&nbsp;output&#34;</span><span class="op" id="6105905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6105908">coverProfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6105925">=</span>&nbsp;<span class="ident" id="6105927">flag</span><span class="op" id="6105931">.</span><span class="ident" id="6105932">String</span><span class="op" id="6105938">(</span><span class="string" id="6105939">&#34;test.coverprofile&#34;</span><span class="op" id="6105958">,</span>&nbsp;<span class="string" id="6105960">&#34;&#34;</span><span class="op" id="6105962">,</span>&nbsp;<span class="string" id="6105964">&#34;write&nbsp;a&nbsp;coverage&nbsp;profile&nbsp;to&nbsp;the&nbsp;named&nbsp;file&nbsp;after&nbsp;execution&#34;</span><span class="op" id="6106024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6106027">match</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6106044">=</span>&nbsp;<span class="ident" id="6106046">flag</span><span class="op" id="6106050">.</span><span class="ident" id="6106051">String</span><span class="op" id="6106057">(</span><span class="string" id="6106058">&#34;test.run&#34;</span><span class="op" id="6106068">,</span>&nbsp;<span class="string" id="6106070">&#34;&#34;</span><span class="op" id="6106072">,</span>&nbsp;<span class="string" id="6106074">&#34;regular&nbsp;expression&nbsp;to&nbsp;select&nbsp;tests&nbsp;and&nbsp;examples&nbsp;to&nbsp;run&#34;</span><span class="op" id="6106130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6106133">memProfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6106150">=</span>&nbsp;<span class="ident" id="6106152">flag</span><span class="op" id="6106156">.</span><span class="ident" id="6106157">String</span><span class="op" id="6106163">(</span><span class="string" id="6106164">&#34;test.memprofile&#34;</span><span class="op" id="6106181">,</span>&nbsp;<span class="string" id="6106183">&#34;&#34;</span><span class="op" id="6106185">,</span>&nbsp;<span class="string" id="6106187">&#34;write&nbsp;a&nbsp;memory&nbsp;profile&nbsp;to&nbsp;the&nbsp;named&nbsp;file&nbsp;after&nbsp;execution&#34;</span><span class="op" id="6106245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6106248">memProfileRate</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6106265">=</span>&nbsp;<span class="ident" id="6106267">flag</span><span class="op" id="6106271">.</span><span class="ident" id="6106272">Int</span><span class="op" id="6106275">(</span><span class="string" id="6106276">&#34;test.memprofilerate&#34;</span><span class="op" id="6106297">,</span>&nbsp;<span class="num" id="6106299">0</span><span class="op" id="6106300">,</span>&nbsp;<span class="string" id="6106302">&#34;if&nbsp;&gt;=0,&nbsp;sets&nbsp;runtime.MemProfileRate&#34;</span><span class="op" id="6106339">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6106342">cpuProfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6106359">=</span>&nbsp;<span class="ident" id="6106361">flag</span><span class="op" id="6106365">.</span><span class="ident" id="6106366">String</span><span class="op" id="6106372">(</span><span class="string" id="6106373">&#34;test.cpuprofile&#34;</span><span class="op" id="6106390">,</span>&nbsp;<span class="string" id="6106392">&#34;&#34;</span><span class="op" id="6106394">,</span>&nbsp;<span class="string" id="6106396">&#34;write&nbsp;a&nbsp;cpu&nbsp;profile&nbsp;to&nbsp;the&nbsp;named&nbsp;file&nbsp;during&nbsp;execution&#34;</span><span class="op" id="6106452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6106455">blockProfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6106472">=</span>&nbsp;<span class="ident" id="6106474">flag</span><span class="op" id="6106478">.</span><span class="ident" id="6106479">String</span><span class="op" id="6106485">(</span><span class="string" id="6106486">&#34;test.blockprofile&#34;</span><span class="op" id="6106505">,</span>&nbsp;<span class="string" id="6106507">&#34;&#34;</span><span class="op" id="6106509">,</span>&nbsp;<span class="string" id="6106511">&#34;write&nbsp;a&nbsp;goroutine&nbsp;blocking&nbsp;profile&nbsp;to&nbsp;the&nbsp;named&nbsp;file&nbsp;after&nbsp;execution&#34;</span><span class="op" id="6106581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6106584">blockProfileRate</span>&nbsp;<span class="op" id="6106601">=</span>&nbsp;<span class="ident" id="6106603">flag</span><span class="op" id="6106607">.</span><span class="ident" id="6106608">Int</span><span class="op" id="6106611">(</span><span class="string" id="6106612">&#34;test.blockprofilerate&#34;</span><span class="op" id="6106635">,</span>&nbsp;<span class="num" id="6106637">1</span><span class="op" id="6106638">,</span>&nbsp;<span class="string" id="6106640">&#34;if&nbsp;&gt;=&nbsp;0,&nbsp;calls&nbsp;runtime.SetBlockProfileRate()&#34;</span><span class="op" id="6106686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6106689">timeout</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6106706">=</span>&nbsp;<span class="ident" id="6106708">flag</span><span class="op" id="6106712">.</span><span class="ident" id="6106713">Duration</span><span class="op" id="6106721">(</span><span class="string" id="6106722">&#34;test.timeout&#34;</span><span class="op" id="6106736">,</span>&nbsp;<span class="num" id="6106738">0</span><span class="op" id="6106739">,</span>&nbsp;<span class="string" id="6106741">&#34;if&nbsp;positive,&nbsp;sets&nbsp;an&nbsp;aggregate&nbsp;time&nbsp;limit&nbsp;for&nbsp;all&nbsp;tests&#34;</span><span class="op" id="6106798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6106801">cpuListStr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6106818">=</span>&nbsp;<span class="ident" id="6106820">flag</span><span class="op" id="6106824">.</span><span class="ident" id="6106825">String</span><span class="op" id="6106831">(</span><span class="string" id="6106832">&#34;test.cpu&#34;</span><span class="op" id="6106842">,</span>&nbsp;<span class="string" id="6106844">&#34;&#34;</span><span class="op" id="6106846">,</span>&nbsp;<span class="string" id="6106848">&#34;comma-separated&nbsp;list&nbsp;of&nbsp;number&nbsp;of&nbsp;CPUs&nbsp;to&nbsp;use&nbsp;for&nbsp;each&nbsp;test&#34;</span><span class="op" id="6106909">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6106912">parallel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6106929">=</span>&nbsp;<span class="ident" id="6106931">flag</span><span class="op" id="6106935">.</span><span class="ident" id="6106936">Int</span><span class="op" id="6106939">(</span><span class="string" id="6106940">&#34;test.parallel&#34;</span><span class="op" id="6106955">,</span>&nbsp;<span class="ident" id="6106957">runtime</span><span class="op" id="6106964">.</span><span class="ident" id="6106965">GOMAXPROCS</span><span class="op" id="6106975">(</span><span class="num" id="6106976">0</span><span class="op" id="6106977">)</span><span class="op" id="6106978">,</span>&nbsp;<span class="string" id="6106980">&#34;maximum&nbsp;test&nbsp;parallelism&#34;</span><span class="op" id="6107006">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107010">haveExamples</span>&nbsp;<span class="builtintype" id="6107023">bool</span>&nbsp;<span class="comment" id="6107028">//&nbsp;are&nbsp;there&nbsp;examples?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107053">cpuList</span>&nbsp;<span class="op" id="6107061">[</span><span class="op" id="6107062">]</span><span class="builtintype" id="6107063">int</span><br>
<span class="lineno">185</span><span class="op" id="6107067">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6107070">//&nbsp;common&nbsp;holds&nbsp;the&nbsp;elements&nbsp;common&nbsp;between&nbsp;T&nbsp;and&nbsp;B&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6107126">//&nbsp;captures&nbsp;common&nbsp;methods&nbsp;such&nbsp;as&nbsp;Errorf.</span><br>
<span class="lineno"></span><span class="keyword" id="6107169">type</span>&nbsp;<span class="ident" id="6107174">common</span>&nbsp;<span class="keyword" id="6107181">struct</span>&nbsp;<span class="op" id="6107188">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107191">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107200">sync</span><span class="op" id="6107204">.</span><span class="ident" id="6107205">RWMutex</span>&nbsp;<span class="comment" id="6107213">//&nbsp;guards&nbsp;output&nbsp;and&nbsp;failed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107242">output</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6107251">[</span><span class="op" id="6107252">]</span><span class="builtintype" id="6107253">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6107264">//&nbsp;Output&nbsp;generated&nbsp;by&nbsp;test&nbsp;or&nbsp;benchmark.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107307">failed</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6107316">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6107329">//&nbsp;Test&nbsp;or&nbsp;benchmark&nbsp;has&nbsp;failed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107363">skipped</span>&nbsp;&nbsp;<span class="builtintype" id="6107372">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6107385">//&nbsp;Test&nbsp;of&nbsp;benchmark&nbsp;has&nbsp;been&nbsp;skipped.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107425">finished</span>&nbsp;<span class="builtintype" id="6107434">bool</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107441">start</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107450">time</span><span class="op" id="6107454">.</span><span class="ident" id="6107455">Time</span>&nbsp;<span class="comment" id="6107460">//&nbsp;Time&nbsp;test&nbsp;or&nbsp;benchmark&nbsp;started</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107495">duration</span>&nbsp;<span class="ident" id="6107504">time</span><span class="op" id="6107508">.</span><span class="ident" id="6107509">Duration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107519">self</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6107528">interface</span><span class="op" id="6107537">{</span><span class="op" id="6107538">}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6107545">//&nbsp;To&nbsp;be&nbsp;sent&nbsp;on&nbsp;signal&nbsp;channel&nbsp;when&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107589">signal</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="6107598">chan</span>&nbsp;<span class="keyword" id="6107603">interface</span><span class="op" id="6107612">{</span><span class="op" id="6107613">}</span>&nbsp;<span class="comment" id="6107615">//&nbsp;Output&nbsp;for&nbsp;serial&nbsp;tests.</span><br>
<span class="lineno">200</span><span class="op" id="6107643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6107646">//&nbsp;Short&nbsp;reports&nbsp;whether&nbsp;the&nbsp;-test.short&nbsp;flag&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="6107700">func</span>&nbsp;<span class="ident" id="6107705">Short</span><span class="op" id="6107710">(</span><span class="op" id="6107711">)</span>&nbsp;<span class="builtintype" id="6107713">bool</span>&nbsp;<span class="op" id="6107718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6107721">return</span>&nbsp;<span class="op" id="6107728">*</span><span class="ident" id="6107729">short</span><br>
<span class="lineno">205</span><span class="op" id="6107735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6107738">//&nbsp;Verbose&nbsp;reports&nbsp;whether&nbsp;the&nbsp;-test.v&nbsp;flag&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="6107790">func</span>&nbsp;<span class="ident" id="6107795">Verbose</span><span class="op" id="6107802">(</span><span class="op" id="6107803">)</span>&nbsp;<span class="builtintype" id="6107805">bool</span>&nbsp;<span class="op" id="6107810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6107813">return</span>&nbsp;<span class="op" id="6107820">*</span><span class="ident" id="6107821">chatty</span><br>
<span class="lineno">210</span><span class="op" id="6107828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6107831">//&nbsp;decorate&nbsp;prefixes&nbsp;the&nbsp;string&nbsp;with&nbsp;the&nbsp;file&nbsp;and&nbsp;line&nbsp;of&nbsp;the&nbsp;call&nbsp;site</span><br>
<span class="lineno"></span><span class="comment" id="6107903">//&nbsp;and&nbsp;inserts&nbsp;the&nbsp;final&nbsp;newline&nbsp;if&nbsp;needed&nbsp;and&nbsp;indentation&nbsp;tabs&nbsp;for&nbsp;formatting.</span><br>
<span class="lineno"></span><span class="keyword" id="6107983">func</span>&nbsp;<span class="ident" id="6107988">decorate</span><span class="op" id="6107996">(</span><span class="ident" id="6107997">s</span>&nbsp;<span class="builtintype" id="6107999">string</span><span class="op" id="6108005">)</span>&nbsp;<span class="builtintype" id="6108007">string</span>&nbsp;<span class="op" id="6108014">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108017">_</span><span class="op" id="6108018">,</span>&nbsp;<span class="ident" id="6108020">file</span><span class="op" id="6108024">,</span>&nbsp;<span class="ident" id="6108026">line</span><span class="op" id="6108030">,</span>&nbsp;<span class="ident" id="6108032">ok</span>&nbsp;<span class="op" id="6108035">:=</span>&nbsp;<span class="ident" id="6108038">runtime</span><span class="op" id="6108045">.</span><span class="ident" id="6108046">Caller</span><span class="op" id="6108052">(</span><span class="num" id="6108053">3</span><span class="op" id="6108054">)</span>&nbsp;<span class="comment" id="6108056">//&nbsp;decorate&nbsp;+&nbsp;log&nbsp;+&nbsp;public&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6108094">if</span>&nbsp;<span class="ident" id="6108097">ok</span>&nbsp;<span class="op" id="6108100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6108104">//&nbsp;Truncate&nbsp;file&nbsp;name&nbsp;at&nbsp;last&nbsp;file&nbsp;name&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6108157">if</span>&nbsp;<span class="ident" id="6108160">index</span>&nbsp;<span class="op" id="6108166">:=</span>&nbsp;<span class="ident" id="6108169">strings</span><span class="op" id="6108176">.</span><span class="ident" id="6108177">LastIndex</span><span class="op" id="6108186">(</span><span class="ident" id="6108187">file</span><span class="op" id="6108191">,</span>&nbsp;<span class="string" id="6108193">&#34;/&#34;</span><span class="op" id="6108196">)</span><span class="op" id="6108197">;</span>&nbsp;<span class="ident" id="6108199">index</span>&nbsp;<span class="op" id="6108205">&gt;=</span>&nbsp;<span class="num" id="6108208">0</span>&nbsp;<span class="op" id="6108210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108215">file</span>&nbsp;<span class="op" id="6108220">=</span>&nbsp;<span class="ident" id="6108222">file</span><span class="op" id="6108226">[</span><span class="ident" id="6108227">index</span><span class="op" id="6108232">+</span><span class="num" id="6108233">1</span><span class="op" id="6108234">:</span><span class="op" id="6108235">]</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6108239">}</span>&nbsp;<span class="keyword" id="6108241">else</span>&nbsp;<span class="keyword" id="6108246">if</span>&nbsp;<span class="ident" id="6108249">index</span>&nbsp;<span class="op" id="6108255">=</span>&nbsp;<span class="ident" id="6108257">strings</span><span class="op" id="6108264">.</span><span class="ident" id="6108265">LastIndex</span><span class="op" id="6108274">(</span><span class="ident" id="6108275">file</span><span class="op" id="6108279">,</span>&nbsp;<span class="string" id="6108281">&#34;\\&#34;</span><span class="op" id="6108285">)</span><span class="op" id="6108286">;</span>&nbsp;<span class="ident" id="6108288">index</span>&nbsp;<span class="op" id="6108294">&gt;=</span>&nbsp;<span class="num" id="6108297">0</span>&nbsp;<span class="op" id="6108299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108304">file</span>&nbsp;<span class="op" id="6108309">=</span>&nbsp;<span class="ident" id="6108311">file</span><span class="op" id="6108315">[</span><span class="ident" id="6108316">index</span><span class="op" id="6108321">+</span><span class="num" id="6108322">1</span><span class="op" id="6108323">:</span><span class="op" id="6108324">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6108328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6108331">}</span>&nbsp;<span class="keyword" id="6108333">else</span>&nbsp;<span class="op" id="6108338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108342">file</span>&nbsp;<span class="op" id="6108347">=</span>&nbsp;<span class="string" id="6108349">&#34;???&#34;</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108357">line</span>&nbsp;<span class="op" id="6108362">=</span>&nbsp;<span class="num" id="6108364">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6108367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108370">buf</span>&nbsp;<span class="op" id="6108374">:=</span>&nbsp;<span class="builtinfunc" id="6108377">new</span><span class="op" id="6108380">(</span><span class="ident" id="6108381">bytes</span><span class="op" id="6108386">.</span><span class="ident" id="6108387">Buffer</span><span class="op" id="6108393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6108396">//&nbsp;Every&nbsp;line&nbsp;is&nbsp;indented&nbsp;at&nbsp;least&nbsp;one&nbsp;tab.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108441">buf</span><span class="op" id="6108444">.</span><span class="ident" id="6108445">WriteByte</span><span class="op" id="6108454">(</span><span class="string" id="6108455">&#39;\t&#39;</span><span class="op" id="6108459">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108462">fmt</span><span class="op" id="6108465">.</span><span class="ident" id="6108466">Fprintf</span><span class="op" id="6108473">(</span><span class="ident" id="6108474">buf</span><span class="op" id="6108477">,</span>&nbsp;<span class="string" id="6108479">&#34;%s:%d:&nbsp;&#34;</span><span class="op" id="6108488">,</span>&nbsp;<span class="ident" id="6108490">file</span><span class="op" id="6108494">,</span>&nbsp;<span class="ident" id="6108496">line</span><span class="op" id="6108500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108503">lines</span>&nbsp;<span class="op" id="6108509">:=</span>&nbsp;<span class="ident" id="6108512">strings</span><span class="op" id="6108519">.</span><span class="ident" id="6108520">Split</span><span class="op" id="6108525">(</span><span class="ident" id="6108526">s</span><span class="op" id="6108527">,</span>&nbsp;<span class="string" id="6108529">&#34;\n&#34;</span><span class="op" id="6108533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6108536">if</span>&nbsp;<span class="ident" id="6108539">l</span>&nbsp;<span class="op" id="6108541">:=</span>&nbsp;<span class="builtinfunc" id="6108544">len</span><span class="op" id="6108547">(</span><span class="ident" id="6108548">lines</span><span class="op" id="6108553">)</span><span class="op" id="6108554">;</span>&nbsp;<span class="ident" id="6108556">l</span>&nbsp;<span class="op" id="6108558">&gt;</span>&nbsp;<span class="num" id="6108560">1</span>&nbsp;<span class="op" id="6108562">&amp;&amp;</span>&nbsp;<span class="ident" id="6108565">lines</span><span class="op" id="6108570">[</span><span class="ident" id="6108571">l</span><span class="op" id="6108572">-</span><span class="num" id="6108573">1</span><span class="op" id="6108574">]</span>&nbsp;<span class="op" id="6108576">==</span>&nbsp;<span class="string" id="6108579">&#34;&#34;</span>&nbsp;<span class="op" id="6108582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108586">lines</span>&nbsp;<span class="op" id="6108592">=</span>&nbsp;<span class="ident" id="6108594">lines</span><span class="op" id="6108599">[</span><span class="op" id="6108600">:</span><span class="ident" id="6108601">l</span><span class="op" id="6108602">-</span><span class="num" id="6108603">1</span><span class="op" id="6108604">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6108607">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6108610">for</span>&nbsp;<span class="ident" id="6108614">i</span><span class="op" id="6108615">,</span>&nbsp;<span class="ident" id="6108617">line</span>&nbsp;<span class="op" id="6108622">:=</span>&nbsp;<span class="keyword" id="6108625">range</span>&nbsp;<span class="ident" id="6108631">lines</span>&nbsp;<span class="op" id="6108637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6108641">if</span>&nbsp;<span class="ident" id="6108644">i</span>&nbsp;<span class="op" id="6108646">&gt;</span>&nbsp;<span class="num" id="6108648">0</span>&nbsp;<span class="op" id="6108650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6108655">//&nbsp;Second&nbsp;and&nbsp;subsequent&nbsp;lines&nbsp;are&nbsp;indented&nbsp;an&nbsp;extra&nbsp;tab.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108716">buf</span><span class="op" id="6108719">.</span><span class="ident" id="6108720">WriteString</span><span class="op" id="6108731">(</span><span class="string" id="6108732">&#34;\n\t\t&#34;</span><span class="op" id="6108740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6108744">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108748">buf</span><span class="op" id="6108751">.</span><span class="ident" id="6108752">WriteString</span><span class="op" id="6108763">(</span><span class="ident" id="6108764">line</span><span class="op" id="6108768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6108771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108774">buf</span><span class="op" id="6108777">.</span><span class="ident" id="6108778">WriteByte</span><span class="op" id="6108787">(</span><span class="string" id="6108788">&#39;\n&#39;</span><span class="op" id="6108792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6108795">return</span>&nbsp;<span class="ident" id="6108802">buf</span><span class="op" id="6108805">.</span><span class="ident" id="6108806">String</span><span class="op" id="6108812">(</span><span class="op" id="6108813">)</span><br>
<span class="lineno"></span><span class="op" id="6108815">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="6108818">//&nbsp;fmtDuration&nbsp;returns&nbsp;a&nbsp;string&nbsp;representing&nbsp;d&nbsp;in&nbsp;the&nbsp;form&nbsp;&#34;87.00s&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="6108887">func</span>&nbsp;<span class="ident" id="6108892">fmtDuration</span><span class="op" id="6108903">(</span><span class="ident" id="6108904">d</span>&nbsp;<span class="ident" id="6108906">time</span><span class="op" id="6108910">.</span><span class="ident" id="6108911">Duration</span><span class="op" id="6108919">)</span>&nbsp;<span class="builtintype" id="6108921">string</span>&nbsp;<span class="op" id="6108928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6108931">return</span>&nbsp;<span class="ident" id="6108938">fmt</span><span class="op" id="6108941">.</span><span class="ident" id="6108942">Sprintf</span><span class="op" id="6108949">(</span><span class="string" id="6108950">&#34;%.2fs&#34;</span><span class="op" id="6108957">,</span>&nbsp;<span class="ident" id="6108959">d</span><span class="op" id="6108960">.</span><span class="ident" id="6108961">Seconds</span><span class="op" id="6108968">(</span><span class="op" id="6108969">)</span><span class="op" id="6108970">)</span><br>
<span class="lineno"></span><span class="op" id="6108972">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span><span class="comment" id="6108975">//&nbsp;TB&nbsp;is&nbsp;the&nbsp;interface&nbsp;common&nbsp;to&nbsp;T&nbsp;and&nbsp;B.</span><br>
<span class="lineno"></span><span class="keyword" id="6109017">type</span>&nbsp;<span class="ident" id="6109022">TB</span>&nbsp;<span class="keyword" id="6109025">interface</span>&nbsp;<span class="op" id="6109035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109038">Error</span><span class="op" id="6109043">(</span><span class="ident" id="6109044">args</span>&nbsp;<span class="op" id="6109049">...</span><span class="keyword" id="6109052">interface</span><span class="op" id="6109061">{</span><span class="op" id="6109062">}</span><span class="op" id="6109063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109066">Errorf</span><span class="op" id="6109072">(</span><span class="ident" id="6109073">format</span>&nbsp;<span class="builtintype" id="6109080">string</span><span class="op" id="6109086">,</span>&nbsp;<span class="ident" id="6109088">args</span>&nbsp;<span class="op" id="6109093">...</span><span class="keyword" id="6109096">interface</span><span class="op" id="6109105">{</span><span class="op" id="6109106">}</span><span class="op" id="6109107">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109110">Fail</span><span class="op" id="6109114">(</span><span class="op" id="6109115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109118">FailNow</span><span class="op" id="6109125">(</span><span class="op" id="6109126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109129">Failed</span><span class="op" id="6109135">(</span><span class="op" id="6109136">)</span>&nbsp;<span class="builtintype" id="6109138">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109144">Fatal</span><span class="op" id="6109149">(</span><span class="ident" id="6109150">args</span>&nbsp;<span class="op" id="6109155">...</span><span class="keyword" id="6109158">interface</span><span class="op" id="6109167">{</span><span class="op" id="6109168">}</span><span class="op" id="6109169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109172">Fatalf</span><span class="op" id="6109178">(</span><span class="ident" id="6109179">format</span>&nbsp;<span class="builtintype" id="6109186">string</span><span class="op" id="6109192">,</span>&nbsp;<span class="ident" id="6109194">args</span>&nbsp;<span class="op" id="6109199">...</span><span class="keyword" id="6109202">interface</span><span class="op" id="6109211">{</span><span class="op" id="6109212">}</span><span class="op" id="6109213">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109216">Log</span><span class="op" id="6109219">(</span><span class="ident" id="6109220">args</span>&nbsp;<span class="op" id="6109225">...</span><span class="keyword" id="6109228">interface</span><span class="op" id="6109237">{</span><span class="op" id="6109238">}</span><span class="op" id="6109239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109242">Logf</span><span class="op" id="6109246">(</span><span class="ident" id="6109247">format</span>&nbsp;<span class="builtintype" id="6109254">string</span><span class="op" id="6109260">,</span>&nbsp;<span class="ident" id="6109262">args</span>&nbsp;<span class="op" id="6109267">...</span><span class="keyword" id="6109270">interface</span><span class="op" id="6109279">{</span><span class="op" id="6109280">}</span><span class="op" id="6109281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109284">Skip</span><span class="op" id="6109288">(</span><span class="ident" id="6109289">args</span>&nbsp;<span class="op" id="6109294">...</span><span class="keyword" id="6109297">interface</span><span class="op" id="6109306">{</span><span class="op" id="6109307">}</span><span class="op" id="6109308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109311">SkipNow</span><span class="op" id="6109318">(</span><span class="op" id="6109319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109322">Skipf</span><span class="op" id="6109327">(</span><span class="ident" id="6109328">format</span>&nbsp;<span class="builtintype" id="6109335">string</span><span class="op" id="6109341">,</span>&nbsp;<span class="ident" id="6109343">args</span>&nbsp;<span class="op" id="6109348">...</span><span class="keyword" id="6109351">interface</span><span class="op" id="6109360">{</span><span class="op" id="6109361">}</span><span class="op" id="6109362">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109365">Skipped</span><span class="op" id="6109372">(</span><span class="op" id="6109373">)</span>&nbsp;<span class="builtintype" id="6109375">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6109382">//&nbsp;A&nbsp;private&nbsp;method&nbsp;to&nbsp;prevent&nbsp;users&nbsp;implementing&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6109437">//&nbsp;interface&nbsp;and&nbsp;so&nbsp;future&nbsp;additions&nbsp;to&nbsp;it&nbsp;will&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6109490">//&nbsp;violate&nbsp;Go&nbsp;1&nbsp;compatibility.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109522">private</span><span class="op" id="6109529">(</span><span class="op" id="6109530">)</span><br>
<span class="lineno"></span><span class="op" id="6109532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6109535">var</span>&nbsp;<span class="ident" id="6109539">_</span>&nbsp;<span class="ident" id="6109541">TB</span>&nbsp;<span class="op" id="6109544">=</span>&nbsp;<span class="op" id="6109546">(</span><span class="op" id="6109547">*</span><span class="ident" id="6109548">T</span><span class="op" id="6109549">)</span><span class="op" id="6109550">(</span><span class="builtintype" id="6109551">nil</span><span class="op" id="6109554">)</span><br>
<span class="lineno"></span><span class="keyword" id="6109556">var</span>&nbsp;<span class="ident" id="6109560">_</span>&nbsp;<span class="ident" id="6109562">TB</span>&nbsp;<span class="op" id="6109565">=</span>&nbsp;<span class="op" id="6109567">(</span><span class="op" id="6109568">*</span><span class="ident" id="6109569">B</span><span class="op" id="6109570">)</span><span class="op" id="6109571">(</span><span class="builtintype" id="6109572">nil</span><span class="op" id="6109575">)</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="6109578">//&nbsp;T&nbsp;is&nbsp;a&nbsp;type&nbsp;passed&nbsp;to&nbsp;Test&nbsp;functions&nbsp;to&nbsp;manage&nbsp;test&nbsp;state&nbsp;and&nbsp;support&nbsp;formatted&nbsp;test&nbsp;logs.</span><br>
<span class="lineno"></span><span class="comment" id="6109672">//&nbsp;Logs&nbsp;are&nbsp;accumulated&nbsp;during&nbsp;execution&nbsp;and&nbsp;dumped&nbsp;to&nbsp;standard&nbsp;error&nbsp;when&nbsp;done.</span><br>
<span class="lineno"></span><span class="keyword" id="6109753">type</span>&nbsp;<span class="ident" id="6109758">T</span>&nbsp;<span class="keyword" id="6109760">struct</span>&nbsp;<span class="op" id="6109767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109770">common</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109778">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6109792">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6109802">//&nbsp;Name&nbsp;of&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109820">startParallel</span>&nbsp;<span class="keyword" id="6109834">chan</span>&nbsp;<span class="builtintype" id="6109839">bool</span>&nbsp;<span class="comment" id="6109844">//&nbsp;Parallel&nbsp;tests&nbsp;will&nbsp;wait&nbsp;on&nbsp;this.</span><br>
<span class="lineno"></span><span class="op" id="6109881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6109884">func</span>&nbsp;<span class="op" id="6109889">(</span><span class="ident" id="6109890">c</span>&nbsp;<span class="op" id="6109892">*</span><span class="ident" id="6109893">common</span><span class="op" id="6109899">)</span>&nbsp;<span class="ident" id="6109901">private</span><span class="op" id="6109908">(</span><span class="op" id="6109909">)</span>&nbsp;<span class="op" id="6109911">{</span><span class="op" id="6109912">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="6109915">//&nbsp;Fail&nbsp;marks&nbsp;the&nbsp;function&nbsp;as&nbsp;having&nbsp;failed&nbsp;but&nbsp;continues&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="6109984">func</span>&nbsp;<span class="op" id="6109989">(</span><span class="ident" id="6109990">c</span>&nbsp;<span class="op" id="6109992">*</span><span class="ident" id="6109993">common</span><span class="op" id="6109999">)</span>&nbsp;<span class="ident" id="6110001">Fail</span><span class="op" id="6110005">(</span><span class="op" id="6110006">)</span>&nbsp;<span class="op" id="6110008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6110011">c</span><span class="op" id="6110012">.</span><span class="ident" id="6110013">mu</span><span class="op" id="6110015">.</span><span class="ident" id="6110016">Lock</span><span class="op" id="6110020">(</span><span class="op" id="6110021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6110024">defer</span>&nbsp;<span class="ident" id="6110030">c</span><span class="op" id="6110031">.</span><span class="ident" id="6110032">mu</span><span class="op" id="6110034">.</span><span class="ident" id="6110035">Unlock</span><span class="op" id="6110041">(</span><span class="op" id="6110042">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6110045">c</span><span class="op" id="6110046">.</span><span class="ident" id="6110047">failed</span>&nbsp;<span class="op" id="6110054">=</span>&nbsp;<span class="builtintype" id="6110056">true</span><br>
<span class="lineno"></span><span class="op" id="6110061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6110064">//&nbsp;Failed&nbsp;reports&nbsp;whether&nbsp;the&nbsp;function&nbsp;has&nbsp;failed.</span><br>
<span class="lineno"></span><span class="keyword" id="6110115">func</span>&nbsp;<span class="op" id="6110120">(</span><span class="ident" id="6110121">c</span>&nbsp;<span class="op" id="6110123">*</span><span class="ident" id="6110124">common</span><span class="op" id="6110130">)</span>&nbsp;<span class="ident" id="6110132">Failed</span><span class="op" id="6110138">(</span><span class="op" id="6110139">)</span>&nbsp;<span class="builtintype" id="6110141">bool</span>&nbsp;<span class="op" id="6110146">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6110149">c</span><span class="op" id="6110150">.</span><span class="ident" id="6110151">mu</span><span class="op" id="6110153">.</span><span class="ident" id="6110154">RLock</span><span class="op" id="6110159">(</span><span class="op" id="6110160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6110163">defer</span>&nbsp;<span class="ident" id="6110169">c</span><span class="op" id="6110170">.</span><span class="ident" id="6110171">mu</span><span class="op" id="6110173">.</span><span class="ident" id="6110174">RUnlock</span><span class="op" id="6110181">(</span><span class="op" id="6110182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6110185">return</span>&nbsp;<span class="ident" id="6110192">c</span><span class="op" id="6110193">.</span><span class="ident" id="6110194">failed</span><br>
<span class="lineno"></span><span class="op" id="6110201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="6110204">//&nbsp;FailNow&nbsp;marks&nbsp;the&nbsp;function&nbsp;as&nbsp;having&nbsp;failed&nbsp;and&nbsp;stops&nbsp;its&nbsp;execution.</span><br>
<span class="lineno"></span><span class="comment" id="6110276">//&nbsp;Execution&nbsp;will&nbsp;continue&nbsp;at&nbsp;the&nbsp;next&nbsp;test&nbsp;or&nbsp;benchmark.</span><br>
<span class="lineno"></span><span class="comment" id="6110334">//&nbsp;FailNow&nbsp;must&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;goroutine&nbsp;running&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6110391">//&nbsp;test&nbsp;or&nbsp;benchmark&nbsp;function,&nbsp;not&nbsp;from&nbsp;other&nbsp;goroutines</span><br>
<span class="lineno"></span><span class="comment" id="6110448">//&nbsp;created&nbsp;during&nbsp;the&nbsp;test.&nbsp;Calling&nbsp;FailNow&nbsp;does&nbsp;not&nbsp;stop</span><br>
<span class="lineno">305</span><span class="comment" id="6110506">//&nbsp;those&nbsp;other&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="keyword" id="6110533">func</span>&nbsp;<span class="op" id="6110538">(</span><span class="ident" id="6110539">c</span>&nbsp;<span class="op" id="6110541">*</span><span class="ident" id="6110542">common</span><span class="op" id="6110548">)</span>&nbsp;<span class="ident" id="6110550">FailNow</span><span class="op" id="6110557">(</span><span class="op" id="6110558">)</span>&nbsp;<span class="op" id="6110560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6110563">c</span><span class="op" id="6110564">.</span><span class="ident" id="6110565">Fail</span><span class="op" id="6110569">(</span><span class="op" id="6110570">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6110574">//&nbsp;Calling&nbsp;runtime.Goexit&nbsp;will&nbsp;exit&nbsp;the&nbsp;goroutine,&nbsp;which</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6110632">//&nbsp;will&nbsp;run&nbsp;the&nbsp;deferred&nbsp;functions&nbsp;in&nbsp;this&nbsp;goroutine,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6110687">//&nbsp;which&nbsp;will&nbsp;eventually&nbsp;run&nbsp;the&nbsp;deferred&nbsp;lines&nbsp;in&nbsp;tRunner,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6110748">//&nbsp;which&nbsp;will&nbsp;signal&nbsp;to&nbsp;the&nbsp;test&nbsp;loop&nbsp;that&nbsp;this&nbsp;test&nbsp;is&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6110811">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6110815">//&nbsp;A&nbsp;previous&nbsp;version&nbsp;of&nbsp;this&nbsp;code&nbsp;said:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6110857">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6110861">//&nbsp;&nbsp;&nbsp;&nbsp;c.duration&nbsp;=&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6110882">//&nbsp;&nbsp;&nbsp;&nbsp;c.signal&nbsp;&lt;-&nbsp;c.self</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6110905">//&nbsp;&nbsp;&nbsp;&nbsp;runtime.Goexit()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6110926">//</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6110930">//&nbsp;This&nbsp;previous&nbsp;version&nbsp;duplicated&nbsp;code&nbsp;(those&nbsp;lines&nbsp;are&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6110992">//&nbsp;tRunner&nbsp;no&nbsp;matter&nbsp;what),&nbsp;but&nbsp;worse&nbsp;the&nbsp;goroutine&nbsp;teardown</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6111054">//&nbsp;implicit&nbsp;in&nbsp;runtime.Goexit&nbsp;was&nbsp;not&nbsp;guaranteed&nbsp;to&nbsp;complete</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6111116">//&nbsp;before&nbsp;the&nbsp;test&nbsp;exited.&nbsp;&nbsp;If&nbsp;a&nbsp;test&nbsp;deferred&nbsp;an&nbsp;important&nbsp;cleanup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6111185">//&nbsp;function&nbsp;(like&nbsp;removing&nbsp;temporary&nbsp;files),&nbsp;there&nbsp;was&nbsp;no&nbsp;guarantee</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6111254">//&nbsp;it&nbsp;would&nbsp;run&nbsp;on&nbsp;a&nbsp;test&nbsp;failure.&nbsp;&nbsp;Because&nbsp;we&nbsp;send&nbsp;on&nbsp;c.signal&nbsp;during</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6111326">//&nbsp;a&nbsp;top-of-stack&nbsp;deferred&nbsp;function&nbsp;now,&nbsp;we&nbsp;know&nbsp;that&nbsp;the&nbsp;send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6111390">//&nbsp;only&nbsp;happens&nbsp;after&nbsp;any&nbsp;other&nbsp;stacked&nbsp;defers&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6111454">c</span><span class="op" id="6111455">.</span><span class="ident" id="6111456">finished</span>&nbsp;<span class="op" id="6111465">=</span>&nbsp;<span class="builtintype" id="6111467">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6111473">runtime</span><span class="op" id="6111480">.</span><span class="ident" id="6111481">Goexit</span><span class="op" id="6111487">(</span><span class="op" id="6111488">)</span><br>
<span class="lineno">330</span><span class="op" id="6111490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6111493">//&nbsp;log&nbsp;generates&nbsp;the&nbsp;output.&nbsp;It&#39;s&nbsp;always&nbsp;at&nbsp;the&nbsp;same&nbsp;stack&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="6111559">func</span>&nbsp;<span class="op" id="6111564">(</span><span class="ident" id="6111565">c</span>&nbsp;<span class="op" id="6111567">*</span><span class="ident" id="6111568">common</span><span class="op" id="6111574">)</span>&nbsp;<span class="ident" id="6111576">log</span><span class="op" id="6111579">(</span><span class="ident" id="6111580">s</span>&nbsp;<span class="builtintype" id="6111582">string</span><span class="op" id="6111588">)</span>&nbsp;<span class="op" id="6111590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6111593">c</span><span class="op" id="6111594">.</span><span class="ident" id="6111595">mu</span><span class="op" id="6111597">.</span><span class="ident" id="6111598">Lock</span><span class="op" id="6111602">(</span><span class="op" id="6111603">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6111606">defer</span>&nbsp;<span class="ident" id="6111612">c</span><span class="op" id="6111613">.</span><span class="ident" id="6111614">mu</span><span class="op" id="6111616">.</span><span class="ident" id="6111617">Unlock</span><span class="op" id="6111623">(</span><span class="op" id="6111624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6111627">c</span><span class="op" id="6111628">.</span><span class="ident" id="6111629">output</span>&nbsp;<span class="op" id="6111636">=</span>&nbsp;<span class="builtinfunc" id="6111638">append</span><span class="op" id="6111644">(</span><span class="ident" id="6111645">c</span><span class="op" id="6111646">.</span><span class="ident" id="6111647">output</span><span class="op" id="6111653">,</span>&nbsp;<span class="ident" id="6111655">decorate</span><span class="op" id="6111663">(</span><span class="ident" id="6111664">s</span><span class="op" id="6111665">)</span><span class="op" id="6111666">...</span><span class="op" id="6111669">)</span><br>
<span class="lineno"></span><span class="op" id="6111671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6111674">//&nbsp;Log&nbsp;formats&nbsp;its&nbsp;arguments&nbsp;using&nbsp;default&nbsp;formatting,&nbsp;analogous&nbsp;to&nbsp;Println,</span><br>
<span class="lineno">340</span><span class="comment" id="6111751">//&nbsp;and&nbsp;records&nbsp;the&nbsp;text&nbsp;in&nbsp;the&nbsp;error&nbsp;log.&nbsp;The&nbsp;text&nbsp;will&nbsp;be&nbsp;printed&nbsp;only&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="6111826">//&nbsp;the&nbsp;test&nbsp;fails&nbsp;or&nbsp;the&nbsp;-test.v&nbsp;flag&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="6111872">func</span>&nbsp;<span class="op" id="6111877">(</span><span class="ident" id="6111878">c</span>&nbsp;<span class="op" id="6111880">*</span><span class="ident" id="6111881">common</span><span class="op" id="6111887">)</span>&nbsp;<span class="ident" id="6111889">Log</span><span class="op" id="6111892">(</span><span class="ident" id="6111893">args</span>&nbsp;<span class="op" id="6111898">...</span><span class="keyword" id="6111901">interface</span><span class="op" id="6111910">{</span><span class="op" id="6111911">}</span><span class="op" id="6111912">)</span>&nbsp;<span class="op" id="6111914">{</span>&nbsp;<span class="ident" id="6111916">c</span><span class="op" id="6111917">.</span><span class="ident" id="6111918">log</span><span class="op" id="6111921">(</span><span class="ident" id="6111922">fmt</span><span class="op" id="6111925">.</span><span class="ident" id="6111926">Sprintln</span><span class="op" id="6111934">(</span><span class="ident" id="6111935">args</span><span class="op" id="6111939">...</span><span class="op" id="6111942">)</span><span class="op" id="6111943">)</span>&nbsp;<span class="op" id="6111945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6111948">//&nbsp;Logf&nbsp;formats&nbsp;its&nbsp;arguments&nbsp;according&nbsp;to&nbsp;the&nbsp;format,&nbsp;analogous&nbsp;to&nbsp;Printf,</span><br>
<span class="lineno">345</span><span class="comment" id="6112024">//&nbsp;and&nbsp;records&nbsp;the&nbsp;text&nbsp;in&nbsp;the&nbsp;error&nbsp;log.&nbsp;The&nbsp;text&nbsp;will&nbsp;be&nbsp;printed&nbsp;only&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="6112099">//&nbsp;the&nbsp;test&nbsp;fails&nbsp;or&nbsp;the&nbsp;-test.v&nbsp;flag&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="6112145">func</span>&nbsp;<span class="op" id="6112150">(</span><span class="ident" id="6112151">c</span>&nbsp;<span class="op" id="6112153">*</span><span class="ident" id="6112154">common</span><span class="op" id="6112160">)</span>&nbsp;<span class="ident" id="6112162">Logf</span><span class="op" id="6112166">(</span><span class="ident" id="6112167">format</span>&nbsp;<span class="builtintype" id="6112174">string</span><span class="op" id="6112180">,</span>&nbsp;<span class="ident" id="6112182">args</span>&nbsp;<span class="op" id="6112187">...</span><span class="keyword" id="6112190">interface</span><span class="op" id="6112199">{</span><span class="op" id="6112200">}</span><span class="op" id="6112201">)</span>&nbsp;<span class="op" id="6112203">{</span>&nbsp;<span class="ident" id="6112205">c</span><span class="op" id="6112206">.</span><span class="ident" id="6112207">log</span><span class="op" id="6112210">(</span><span class="ident" id="6112211">fmt</span><span class="op" id="6112214">.</span><span class="ident" id="6112215">Sprintf</span><span class="op" id="6112222">(</span><span class="ident" id="6112223">format</span><span class="op" id="6112229">,</span>&nbsp;<span class="ident" id="6112231">args</span><span class="op" id="6112235">...</span><span class="op" id="6112238">)</span><span class="op" id="6112239">)</span>&nbsp;<span class="op" id="6112241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6112244">//&nbsp;Error&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Log&nbsp;followed&nbsp;by&nbsp;Fail.</span><br>
<span class="lineno">350</span><span class="keyword" id="6112292">func</span>&nbsp;<span class="op" id="6112297">(</span><span class="ident" id="6112298">c</span>&nbsp;<span class="op" id="6112300">*</span><span class="ident" id="6112301">common</span><span class="op" id="6112307">)</span>&nbsp;<span class="ident" id="6112309">Error</span><span class="op" id="6112314">(</span><span class="ident" id="6112315">args</span>&nbsp;<span class="op" id="6112320">...</span><span class="keyword" id="6112323">interface</span><span class="op" id="6112332">{</span><span class="op" id="6112333">}</span><span class="op" id="6112334">)</span>&nbsp;<span class="op" id="6112336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6112339">c</span><span class="op" id="6112340">.</span><span class="ident" id="6112341">log</span><span class="op" id="6112344">(</span><span class="ident" id="6112345">fmt</span><span class="op" id="6112348">.</span><span class="ident" id="6112349">Sprintln</span><span class="op" id="6112357">(</span><span class="ident" id="6112358">args</span><span class="op" id="6112362">...</span><span class="op" id="6112365">)</span><span class="op" id="6112366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6112369">c</span><span class="op" id="6112370">.</span><span class="ident" id="6112371">Fail</span><span class="op" id="6112375">(</span><span class="op" id="6112376">)</span><br>
<span class="lineno"></span><span class="op" id="6112378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="6112381">//&nbsp;Errorf&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Logf&nbsp;followed&nbsp;by&nbsp;Fail.</span><br>
<span class="lineno"></span><span class="keyword" id="6112431">func</span>&nbsp;<span class="op" id="6112436">(</span><span class="ident" id="6112437">c</span>&nbsp;<span class="op" id="6112439">*</span><span class="ident" id="6112440">common</span><span class="op" id="6112446">)</span>&nbsp;<span class="ident" id="6112448">Errorf</span><span class="op" id="6112454">(</span><span class="ident" id="6112455">format</span>&nbsp;<span class="builtintype" id="6112462">string</span><span class="op" id="6112468">,</span>&nbsp;<span class="ident" id="6112470">args</span>&nbsp;<span class="op" id="6112475">...</span><span class="keyword" id="6112478">interface</span><span class="op" id="6112487">{</span><span class="op" id="6112488">}</span><span class="op" id="6112489">)</span>&nbsp;<span class="op" id="6112491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6112494">c</span><span class="op" id="6112495">.</span><span class="ident" id="6112496">log</span><span class="op" id="6112499">(</span><span class="ident" id="6112500">fmt</span><span class="op" id="6112503">.</span><span class="ident" id="6112504">Sprintf</span><span class="op" id="6112511">(</span><span class="ident" id="6112512">format</span><span class="op" id="6112518">,</span>&nbsp;<span class="ident" id="6112520">args</span><span class="op" id="6112524">...</span><span class="op" id="6112527">)</span><span class="op" id="6112528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6112531">c</span><span class="op" id="6112532">.</span><span class="ident" id="6112533">Fail</span><span class="op" id="6112537">(</span><span class="op" id="6112538">)</span><br>
<span class="lineno"></span><span class="op" id="6112540">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="6112543">//&nbsp;Fatal&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Log&nbsp;followed&nbsp;by&nbsp;FailNow.</span><br>
<span class="lineno"></span><span class="keyword" id="6112594">func</span>&nbsp;<span class="op" id="6112599">(</span><span class="ident" id="6112600">c</span>&nbsp;<span class="op" id="6112602">*</span><span class="ident" id="6112603">common</span><span class="op" id="6112609">)</span>&nbsp;<span class="ident" id="6112611">Fatal</span><span class="op" id="6112616">(</span><span class="ident" id="6112617">args</span>&nbsp;<span class="op" id="6112622">...</span><span class="keyword" id="6112625">interface</span><span class="op" id="6112634">{</span><span class="op" id="6112635">}</span><span class="op" id="6112636">)</span>&nbsp;<span class="op" id="6112638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6112641">c</span><span class="op" id="6112642">.</span><span class="ident" id="6112643">log</span><span class="op" id="6112646">(</span><span class="ident" id="6112647">fmt</span><span class="op" id="6112650">.</span><span class="ident" id="6112651">Sprintln</span><span class="op" id="6112659">(</span><span class="ident" id="6112660">args</span><span class="op" id="6112664">...</span><span class="op" id="6112667">)</span><span class="op" id="6112668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6112671">c</span><span class="op" id="6112672">.</span><span class="ident" id="6112673">FailNow</span><span class="op" id="6112680">(</span><span class="op" id="6112681">)</span><br>
<span class="lineno">365</span><span class="op" id="6112683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6112686">//&nbsp;Fatalf&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Logf&nbsp;followed&nbsp;by&nbsp;FailNow.</span><br>
<span class="lineno"></span><span class="keyword" id="6112739">func</span>&nbsp;<span class="op" id="6112744">(</span><span class="ident" id="6112745">c</span>&nbsp;<span class="op" id="6112747">*</span><span class="ident" id="6112748">common</span><span class="op" id="6112754">)</span>&nbsp;<span class="ident" id="6112756">Fatalf</span><span class="op" id="6112762">(</span><span class="ident" id="6112763">format</span>&nbsp;<span class="builtintype" id="6112770">string</span><span class="op" id="6112776">,</span>&nbsp;<span class="ident" id="6112778">args</span>&nbsp;<span class="op" id="6112783">...</span><span class="keyword" id="6112786">interface</span><span class="op" id="6112795">{</span><span class="op" id="6112796">}</span><span class="op" id="6112797">)</span>&nbsp;<span class="op" id="6112799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6112802">c</span><span class="op" id="6112803">.</span><span class="ident" id="6112804">log</span><span class="op" id="6112807">(</span><span class="ident" id="6112808">fmt</span><span class="op" id="6112811">.</span><span class="ident" id="6112812">Sprintf</span><span class="op" id="6112819">(</span><span class="ident" id="6112820">format</span><span class="op" id="6112826">,</span>&nbsp;<span class="ident" id="6112828">args</span><span class="op" id="6112832">...</span><span class="op" id="6112835">)</span><span class="op" id="6112836">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6112839">c</span><span class="op" id="6112840">.</span><span class="ident" id="6112841">FailNow</span><span class="op" id="6112848">(</span><span class="op" id="6112849">)</span><br>
<span class="lineno"></span><span class="op" id="6112851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6112854">//&nbsp;Skip&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Log&nbsp;followed&nbsp;by&nbsp;SkipNow.</span><br>
<span class="lineno"></span><span class="keyword" id="6112904">func</span>&nbsp;<span class="op" id="6112909">(</span><span class="ident" id="6112910">c</span>&nbsp;<span class="op" id="6112912">*</span><span class="ident" id="6112913">common</span><span class="op" id="6112919">)</span>&nbsp;<span class="ident" id="6112921">Skip</span><span class="op" id="6112925">(</span><span class="ident" id="6112926">args</span>&nbsp;<span class="op" id="6112931">...</span><span class="keyword" id="6112934">interface</span><span class="op" id="6112943">{</span><span class="op" id="6112944">}</span><span class="op" id="6112945">)</span>&nbsp;<span class="op" id="6112947">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6112950">c</span><span class="op" id="6112951">.</span><span class="ident" id="6112952">log</span><span class="op" id="6112955">(</span><span class="ident" id="6112956">fmt</span><span class="op" id="6112959">.</span><span class="ident" id="6112960">Sprintln</span><span class="op" id="6112968">(</span><span class="ident" id="6112969">args</span><span class="op" id="6112973">...</span><span class="op" id="6112976">)</span><span class="op" id="6112977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6112980">c</span><span class="op" id="6112981">.</span><span class="ident" id="6112982">SkipNow</span><span class="op" id="6112989">(</span><span class="op" id="6112990">)</span><br>
<span class="lineno"></span><span class="op" id="6112992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6112995">//&nbsp;Skipf&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Logf&nbsp;followed&nbsp;by&nbsp;SkipNow.</span><br>
<span class="lineno">380</span><span class="keyword" id="6113047">func</span>&nbsp;<span class="op" id="6113052">(</span><span class="ident" id="6113053">c</span>&nbsp;<span class="op" id="6113055">*</span><span class="ident" id="6113056">common</span><span class="op" id="6113062">)</span>&nbsp;<span class="ident" id="6113064">Skipf</span><span class="op" id="6113069">(</span><span class="ident" id="6113070">format</span>&nbsp;<span class="builtintype" id="6113077">string</span><span class="op" id="6113083">,</span>&nbsp;<span class="ident" id="6113085">args</span>&nbsp;<span class="op" id="6113090">...</span><span class="keyword" id="6113093">interface</span><span class="op" id="6113102">{</span><span class="op" id="6113103">}</span><span class="op" id="6113104">)</span>&nbsp;<span class="op" id="6113106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6113109">c</span><span class="op" id="6113110">.</span><span class="ident" id="6113111">log</span><span class="op" id="6113114">(</span><span class="ident" id="6113115">fmt</span><span class="op" id="6113118">.</span><span class="ident" id="6113119">Sprintf</span><span class="op" id="6113126">(</span><span class="ident" id="6113127">format</span><span class="op" id="6113133">,</span>&nbsp;<span class="ident" id="6113135">args</span><span class="op" id="6113139">...</span><span class="op" id="6113142">)</span><span class="op" id="6113143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6113146">c</span><span class="op" id="6113147">.</span><span class="ident" id="6113148">SkipNow</span><span class="op" id="6113155">(</span><span class="op" id="6113156">)</span><br>
<span class="lineno"></span><span class="op" id="6113158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="6113161">//&nbsp;SkipNow&nbsp;marks&nbsp;the&nbsp;test&nbsp;as&nbsp;having&nbsp;been&nbsp;skipped&nbsp;and&nbsp;stops&nbsp;its&nbsp;execution.</span><br>
<span class="lineno"></span><span class="comment" id="6113235">//&nbsp;Execution&nbsp;will&nbsp;continue&nbsp;at&nbsp;the&nbsp;next&nbsp;test&nbsp;or&nbsp;benchmark.&nbsp;See&nbsp;also&nbsp;FailNow.</span><br>
<span class="lineno"></span><span class="comment" id="6113311">//&nbsp;SkipNow&nbsp;must&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;goroutine&nbsp;running&nbsp;the&nbsp;test,&nbsp;not&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="6113383">//&nbsp;other&nbsp;goroutines&nbsp;created&nbsp;during&nbsp;the&nbsp;test.&nbsp;Calling&nbsp;SkipNow&nbsp;does&nbsp;not&nbsp;stop</span><br>
<span class="lineno"></span><span class="comment" id="6113458">//&nbsp;those&nbsp;other&nbsp;goroutines.</span><br>
<span class="lineno">390</span><span class="keyword" id="6113485">func</span>&nbsp;<span class="op" id="6113490">(</span><span class="ident" id="6113491">c</span>&nbsp;<span class="op" id="6113493">*</span><span class="ident" id="6113494">common</span><span class="op" id="6113500">)</span>&nbsp;<span class="ident" id="6113502">SkipNow</span><span class="op" id="6113509">(</span><span class="op" id="6113510">)</span>&nbsp;<span class="op" id="6113512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6113515">c</span><span class="op" id="6113516">.</span><span class="ident" id="6113517">skip</span><span class="op" id="6113521">(</span><span class="op" id="6113522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6113525">c</span><span class="op" id="6113526">.</span><span class="ident" id="6113527">finished</span>&nbsp;<span class="op" id="6113536">=</span>&nbsp;<span class="builtintype" id="6113538">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6113544">runtime</span><span class="op" id="6113551">.</span><span class="ident" id="6113552">Goexit</span><span class="op" id="6113558">(</span><span class="op" id="6113559">)</span><br>
<span class="lineno"></span><span class="op" id="6113561">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="keyword" id="6113564">func</span>&nbsp;<span class="op" id="6113569">(</span><span class="ident" id="6113570">c</span>&nbsp;<span class="op" id="6113572">*</span><span class="ident" id="6113573">common</span><span class="op" id="6113579">)</span>&nbsp;<span class="ident" id="6113581">skip</span><span class="op" id="6113585">(</span><span class="op" id="6113586">)</span>&nbsp;<span class="op" id="6113588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6113591">c</span><span class="op" id="6113592">.</span><span class="ident" id="6113593">mu</span><span class="op" id="6113595">.</span><span class="ident" id="6113596">Lock</span><span class="op" id="6113600">(</span><span class="op" id="6113601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6113604">defer</span>&nbsp;<span class="ident" id="6113610">c</span><span class="op" id="6113611">.</span><span class="ident" id="6113612">mu</span><span class="op" id="6113614">.</span><span class="ident" id="6113615">Unlock</span><span class="op" id="6113621">(</span><span class="op" id="6113622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6113625">c</span><span class="op" id="6113626">.</span><span class="ident" id="6113627">skipped</span>&nbsp;<span class="op" id="6113635">=</span>&nbsp;<span class="builtintype" id="6113637">true</span><br>
<span class="lineno">400</span><span class="op" id="6113642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6113645">//&nbsp;Skipped&nbsp;reports&nbsp;whether&nbsp;the&nbsp;test&nbsp;was&nbsp;skipped.</span><br>
<span class="lineno"></span><span class="keyword" id="6113694">func</span>&nbsp;<span class="op" id="6113699">(</span><span class="ident" id="6113700">c</span>&nbsp;<span class="op" id="6113702">*</span><span class="ident" id="6113703">common</span><span class="op" id="6113709">)</span>&nbsp;<span class="ident" id="6113711">Skipped</span><span class="op" id="6113718">(</span><span class="op" id="6113719">)</span>&nbsp;<span class="builtintype" id="6113721">bool</span>&nbsp;<span class="op" id="6113726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6113729">c</span><span class="op" id="6113730">.</span><span class="ident" id="6113731">mu</span><span class="op" id="6113733">.</span><span class="ident" id="6113734">RLock</span><span class="op" id="6113739">(</span><span class="op" id="6113740">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6113743">defer</span>&nbsp;<span class="ident" id="6113749">c</span><span class="op" id="6113750">.</span><span class="ident" id="6113751">mu</span><span class="op" id="6113753">.</span><span class="ident" id="6113754">RUnlock</span><span class="op" id="6113761">(</span><span class="op" id="6113762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6113765">return</span>&nbsp;<span class="ident" id="6113772">c</span><span class="op" id="6113773">.</span><span class="ident" id="6113774">skipped</span><br>
<span class="lineno"></span><span class="op" id="6113782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6113785">//&nbsp;Parallel&nbsp;signals&nbsp;that&nbsp;this&nbsp;test&nbsp;is&nbsp;to&nbsp;be&nbsp;run&nbsp;in&nbsp;parallel&nbsp;with&nbsp;(and&nbsp;only&nbsp;with)</span><br>
<span class="lineno">410</span><span class="comment" id="6113866">//&nbsp;other&nbsp;parallel&nbsp;tests.</span><br>
<span class="lineno"></span><span class="keyword" id="6113891">func</span>&nbsp;<span class="op" id="6113896">(</span><span class="ident" id="6113897">t</span>&nbsp;<span class="op" id="6113899">*</span><span class="ident" id="6113900">T</span><span class="op" id="6113901">)</span>&nbsp;<span class="ident" id="6113903">Parallel</span><span class="op" id="6113911">(</span><span class="op" id="6113912">)</span>&nbsp;<span class="op" id="6113914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6113917">t</span><span class="op" id="6113918">.</span><span class="ident" id="6113919">signal</span>&nbsp;<span class="op" id="6113926">&lt;-</span>&nbsp;<span class="op" id="6113929">(</span><span class="op" id="6113930">*</span><span class="ident" id="6113931">T</span><span class="op" id="6113932">)</span><span class="op" id="6113933">(</span><span class="builtintype" id="6113934">nil</span><span class="op" id="6113937">)</span>&nbsp;<span class="comment" id="6113939">//&nbsp;Release&nbsp;main&nbsp;testing&nbsp;loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6113969">&lt;-</span><span class="ident" id="6113971">t</span><span class="op" id="6113972">.</span><span class="ident" id="6113973">startParallel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6113991">//&nbsp;Wait&nbsp;for&nbsp;serial&nbsp;tests&nbsp;to&nbsp;finish</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6114027">//&nbsp;Assuming&nbsp;Parallel&nbsp;is&nbsp;the&nbsp;first&nbsp;thing&nbsp;a&nbsp;test&nbsp;does,&nbsp;which&nbsp;is&nbsp;reasonable,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6114102">//&nbsp;reinitialize&nbsp;the&nbsp;test&#39;s&nbsp;start&nbsp;time&nbsp;because&nbsp;it&#39;s&nbsp;actually&nbsp;starting&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6114177">t</span><span class="op" id="6114178">.</span><span class="ident" id="6114179">start</span>&nbsp;<span class="op" id="6114185">=</span>&nbsp;<span class="ident" id="6114187">time</span><span class="op" id="6114191">.</span><span class="ident" id="6114192">Now</span><span class="op" id="6114195">(</span><span class="op" id="6114196">)</span><br>
<span class="lineno"></span><span class="op" id="6114198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6114201">//&nbsp;An&nbsp;internal&nbsp;type&nbsp;but&nbsp;exported&nbsp;because&nbsp;it&nbsp;is&nbsp;cross-package;&nbsp;part&nbsp;of&nbsp;the&nbsp;implementation</span><br>
<span class="lineno">420</span><span class="comment" id="6114290">//&nbsp;of&nbsp;the&nbsp;&#34;go&nbsp;test&#34;&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="6114319">type</span>&nbsp;<span class="ident" id="6114324">InternalTest</span>&nbsp;<span class="keyword" id="6114337">struct</span>&nbsp;<span class="op" id="6114344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6114347">Name</span>&nbsp;<span class="builtintype" id="6114352">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6114360">F</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6114365">func</span><span class="op" id="6114369">(</span><span class="op" id="6114370">*</span><span class="ident" id="6114371">T</span><span class="op" id="6114372">)</span><br>
<span class="lineno"></span><span class="op" id="6114374">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="6114377">func</span>&nbsp;<span class="ident" id="6114382">tRunner</span><span class="op" id="6114389">(</span><span class="ident" id="6114390">t</span>&nbsp;<span class="op" id="6114392">*</span><span class="ident" id="6114393">T</span><span class="op" id="6114394">,</span>&nbsp;<span class="ident" id="6114396">test</span>&nbsp;<span class="op" id="6114401">*</span><span class="ident" id="6114402">InternalTest</span><span class="op" id="6114414">)</span>&nbsp;<span class="op" id="6114416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6114419">//&nbsp;When&nbsp;this&nbsp;goroutine&nbsp;is&nbsp;done,&nbsp;either&nbsp;because&nbsp;test.F(t)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6114477">//&nbsp;returned&nbsp;normally&nbsp;or&nbsp;because&nbsp;a&nbsp;test&nbsp;failure&nbsp;triggered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6114535">//&nbsp;a&nbsp;call&nbsp;to&nbsp;runtime.Goexit,&nbsp;record&nbsp;the&nbsp;duration&nbsp;and&nbsp;send</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6114594">//&nbsp;a&nbsp;signal&nbsp;saying&nbsp;that&nbsp;the&nbsp;test&nbsp;is&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6114637">defer</span>&nbsp;<span class="keyword" id="6114643">func</span><span class="op" id="6114647">(</span><span class="op" id="6114648">)</span>&nbsp;<span class="op" id="6114650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6114654">t</span><span class="op" id="6114655">.</span><span class="ident" id="6114656">duration</span>&nbsp;<span class="op" id="6114665">=</span>&nbsp;<span class="ident" id="6114667">time</span><span class="op" id="6114671">.</span><span class="ident" id="6114672">Now</span><span class="op" id="6114675">(</span><span class="op" id="6114676">)</span><span class="op" id="6114677">.</span><span class="ident" id="6114678">Sub</span><span class="op" id="6114681">(</span><span class="ident" id="6114682">t</span><span class="op" id="6114683">.</span><span class="ident" id="6114684">start</span><span class="op" id="6114689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6114693">//&nbsp;If&nbsp;the&nbsp;test&nbsp;panicked,&nbsp;print&nbsp;any&nbsp;test&nbsp;output&nbsp;before&nbsp;dying.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6114756">err</span>&nbsp;<span class="op" id="6114760">:=</span>&nbsp;<span class="builtinfunc" id="6114763">recover</span><span class="op" id="6114770">(</span><span class="op" id="6114771">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6114775">if</span>&nbsp;<span class="op" id="6114778">!</span><span class="ident" id="6114779">t</span><span class="op" id="6114780">.</span><span class="ident" id="6114781">finished</span>&nbsp;<span class="op" id="6114790">&amp;&amp;</span>&nbsp;<span class="ident" id="6114793">err</span>&nbsp;<span class="op" id="6114797">==</span>&nbsp;<span class="builtintype" id="6114800">nil</span>&nbsp;<span class="op" id="6114804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6114809">err</span>&nbsp;<span class="op" id="6114813">=</span>&nbsp;<span class="ident" id="6114815">fmt</span><span class="op" id="6114818">.</span><span class="ident" id="6114819">Errorf</span><span class="op" id="6114825">(</span><span class="string" id="6114826">&#34;test&nbsp;executed&nbsp;panic(nil)&nbsp;or&nbsp;runtime.Goexit&#34;</span><span class="op" id="6114870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6114874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6114878">if</span>&nbsp;<span class="ident" id="6114881">err</span>&nbsp;<span class="op" id="6114885">!=</span>&nbsp;<span class="builtintype" id="6114888">nil</span>&nbsp;<span class="op" id="6114892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6114897">t</span><span class="op" id="6114898">.</span><span class="ident" id="6114899">Fail</span><span class="op" id="6114903">(</span><span class="op" id="6114904">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6114909">t</span><span class="op" id="6114910">.</span><span class="ident" id="6114911">report</span><span class="op" id="6114917">(</span><span class="op" id="6114918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6114923">panic</span><span class="op" id="6114928">(</span><span class="ident" id="6114929">err</span><span class="op" id="6114932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6114936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6114940">t</span><span class="op" id="6114941">.</span><span class="ident" id="6114942">signal</span>&nbsp;<span class="op" id="6114949">&lt;-</span>&nbsp;<span class="ident" id="6114952">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6114955">}</span><span class="op" id="6114956">(</span><span class="op" id="6114957">)</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6114961">t</span><span class="op" id="6114962">.</span><span class="ident" id="6114963">start</span>&nbsp;<span class="op" id="6114969">=</span>&nbsp;<span class="ident" id="6114971">time</span><span class="op" id="6114975">.</span><span class="ident" id="6114976">Now</span><span class="op" id="6114979">(</span><span class="op" id="6114980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6114983">test</span><span class="op" id="6114987">.</span><span class="ident" id="6114988">F</span><span class="op" id="6114989">(</span><span class="ident" id="6114990">t</span><span class="op" id="6114991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6114994">t</span><span class="op" id="6114995">.</span><span class="ident" id="6114996">finished</span>&nbsp;<span class="op" id="6115005">=</span>&nbsp;<span class="builtintype" id="6115007">true</span><br>
<span class="lineno"></span><span class="op" id="6115012">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="6115015">//&nbsp;An&nbsp;internal&nbsp;function&nbsp;but&nbsp;exported&nbsp;because&nbsp;it&nbsp;is&nbsp;cross-package;&nbsp;part&nbsp;of&nbsp;the&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="6115108">//&nbsp;of&nbsp;the&nbsp;&#34;go&nbsp;test&#34;&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="6115137">func</span>&nbsp;<span class="ident" id="6115142">Main</span><span class="op" id="6115146">(</span><span class="ident" id="6115147">matchString</span>&nbsp;<span class="keyword" id="6115159">func</span><span class="op" id="6115163">(</span><span class="ident" id="6115164">pat</span><span class="op" id="6115167">,</span>&nbsp;<span class="ident" id="6115169">str</span>&nbsp;<span class="builtintype" id="6115173">string</span><span class="op" id="6115179">)</span>&nbsp;<span class="op" id="6115181">(</span><span class="builtintype" id="6115182">bool</span><span class="op" id="6115186">,</span>&nbsp;<span class="builtintype" id="6115188">error</span><span class="op" id="6115193">)</span><span class="op" id="6115194">,</span>&nbsp;<span class="ident" id="6115196">tests</span>&nbsp;<span class="op" id="6115202">[</span><span class="op" id="6115203">]</span><span class="ident" id="6115204">InternalTest</span><span class="op" id="6115216">,</span>&nbsp;<span class="ident" id="6115218">benchmarks</span>&nbsp;<span class="op" id="6115229">[</span><span class="op" id="6115230">]</span><span class="ident" id="6115231">InternalBenchmark</span><span class="op" id="6115248">,</span>&nbsp;<span class="ident" id="6115250">examples</span>&nbsp;<span class="op" id="6115259">[</span><span class="op" id="6115260">]</span><span class="ident" id="6115261">InternalExample</span><span class="op" id="6115276">)</span>&nbsp;<span class="op" id="6115278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6115281">os</span><span class="op" id="6115283">.</span><span class="ident" id="6115284">Exit</span><span class="op" id="6115288">(</span><span class="ident" id="6115289">MainStart</span><span class="op" id="6115298">(</span><span class="ident" id="6115299">matchString</span><span class="op" id="6115310">,</span>&nbsp;<span class="ident" id="6115312">tests</span><span class="op" id="6115317">,</span>&nbsp;<span class="ident" id="6115319">benchmarks</span><span class="op" id="6115329">,</span>&nbsp;<span class="ident" id="6115331">examples</span><span class="op" id="6115339">)</span><span class="op" id="6115340">.</span><span class="ident" id="6115341">Run</span><span class="op" id="6115344">(</span><span class="op" id="6115345">)</span><span class="op" id="6115346">)</span><br>
<span class="lineno">455</span><span class="op" id="6115348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6115351">//&nbsp;M&nbsp;is&nbsp;a&nbsp;type&nbsp;passed&nbsp;to&nbsp;a&nbsp;TestMain&nbsp;function&nbsp;to&nbsp;run&nbsp;the&nbsp;actual&nbsp;tests.</span><br>
<span class="lineno"></span><span class="keyword" id="6115421">type</span>&nbsp;<span class="ident" id="6115426">M</span>&nbsp;<span class="keyword" id="6115428">struct</span>&nbsp;<span class="op" id="6115435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6115438">matchString</span>&nbsp;<span class="keyword" id="6115450">func</span><span class="op" id="6115454">(</span><span class="ident" id="6115455">pat</span><span class="op" id="6115458">,</span>&nbsp;<span class="ident" id="6115460">str</span>&nbsp;<span class="builtintype" id="6115464">string</span><span class="op" id="6115470">)</span>&nbsp;<span class="op" id="6115472">(</span><span class="builtintype" id="6115473">bool</span><span class="op" id="6115477">,</span>&nbsp;<span class="builtintype" id="6115479">error</span><span class="op" id="6115484">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6115487">tests</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6115499">[</span><span class="op" id="6115500">]</span><span class="ident" id="6115501">InternalTest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6115515">benchmarks</span>&nbsp;&nbsp;<span class="op" id="6115527">[</span><span class="op" id="6115528">]</span><span class="ident" id="6115529">InternalBenchmark</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6115548">examples</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6115560">[</span><span class="op" id="6115561">]</span><span class="ident" id="6115562">InternalExample</span><br>
<span class="lineno"></span><span class="op" id="6115578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="6115581">//&nbsp;MainStart&nbsp;is&nbsp;meant&nbsp;for&nbsp;use&nbsp;by&nbsp;tests&nbsp;generated&nbsp;by&nbsp;&#39;go&nbsp;test&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="6115644">//&nbsp;It&nbsp;is&nbsp;not&nbsp;meant&nbsp;to&nbsp;be&nbsp;called&nbsp;directly&nbsp;and&nbsp;is&nbsp;not&nbsp;subject&nbsp;to&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;document.</span><br>
<span class="lineno"></span><span class="comment" id="6115740">//&nbsp;It&nbsp;may&nbsp;change&nbsp;signature&nbsp;from&nbsp;release&nbsp;to&nbsp;release.</span><br>
<span class="lineno"></span><span class="keyword" id="6115792">func</span>&nbsp;<span class="ident" id="6115797">MainStart</span><span class="op" id="6115806">(</span><span class="ident" id="6115807">matchString</span>&nbsp;<span class="keyword" id="6115819">func</span><span class="op" id="6115823">(</span><span class="ident" id="6115824">pat</span><span class="op" id="6115827">,</span>&nbsp;<span class="ident" id="6115829">str</span>&nbsp;<span class="builtintype" id="6115833">string</span><span class="op" id="6115839">)</span>&nbsp;<span class="op" id="6115841">(</span><span class="builtintype" id="6115842">bool</span><span class="op" id="6115846">,</span>&nbsp;<span class="builtintype" id="6115848">error</span><span class="op" id="6115853">)</span><span class="op" id="6115854">,</span>&nbsp;<span class="ident" id="6115856">tests</span>&nbsp;<span class="op" id="6115862">[</span><span class="op" id="6115863">]</span><span class="ident" id="6115864">InternalTest</span><span class="op" id="6115876">,</span>&nbsp;<span class="ident" id="6115878">benchmarks</span>&nbsp;<span class="op" id="6115889">[</span><span class="op" id="6115890">]</span><span class="ident" id="6115891">InternalBenchmark</span><span class="op" id="6115908">,</span>&nbsp;<span class="ident" id="6115910">examples</span>&nbsp;<span class="op" id="6115919">[</span><span class="op" id="6115920">]</span><span class="ident" id="6115921">InternalExample</span><span class="op" id="6115936">)</span>&nbsp;<span class="op" id="6115938">*</span><span class="ident" id="6115939">M</span>&nbsp;<span class="op" id="6115941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6115944">return</span>&nbsp;<span class="op" id="6115951">&amp;</span><span class="ident" id="6115952">M</span><span class="op" id="6115953">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6115957">matchString</span><span class="op" id="6115968">:</span>&nbsp;<span class="ident" id="6115970">matchString</span><span class="op" id="6115981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6115985">tests</span><span class="op" id="6115990">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6115998">tests</span><span class="op" id="6116003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116007">benchmarks</span><span class="op" id="6116017">:</span>&nbsp;&nbsp;<span class="ident" id="6116020">benchmarks</span><span class="op" id="6116030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116034">examples</span><span class="op" id="6116042">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116047">examples</span><span class="op" id="6116055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6116058">}</span><br>
<span class="lineno">475</span><span class="op" id="6116060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6116063">//&nbsp;Run&nbsp;runs&nbsp;the&nbsp;tests.&nbsp;It&nbsp;returns&nbsp;an&nbsp;exit&nbsp;code&nbsp;to&nbsp;pass&nbsp;to&nbsp;os.Exit.</span><br>
<span class="lineno"></span><span class="keyword" id="6116130">func</span>&nbsp;<span class="op" id="6116135">(</span><span class="ident" id="6116136">m</span>&nbsp;<span class="op" id="6116138">*</span><span class="ident" id="6116139">M</span><span class="op" id="6116140">)</span>&nbsp;<span class="ident" id="6116142">Run</span><span class="op" id="6116145">(</span><span class="op" id="6116146">)</span>&nbsp;<span class="builtintype" id="6116148">int</span>&nbsp;<span class="op" id="6116152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116155">flag</span><span class="op" id="6116159">.</span><span class="ident" id="6116160">Parse</span><span class="op" id="6116165">(</span><span class="op" id="6116166">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116169">parseCpuList</span><span class="op" id="6116181">(</span><span class="op" id="6116182">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116186">before</span><span class="op" id="6116192">(</span><span class="op" id="6116193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116196">startAlarm</span><span class="op" id="6116206">(</span><span class="op" id="6116207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116210">haveExamples</span>&nbsp;<span class="op" id="6116223">=</span>&nbsp;<span class="builtinfunc" id="6116225">len</span><span class="op" id="6116228">(</span><span class="ident" id="6116229">m</span><span class="op" id="6116230">.</span><span class="ident" id="6116231">examples</span><span class="op" id="6116239">)</span>&nbsp;<span class="op" id="6116241">&gt;</span>&nbsp;<span class="num" id="6116243">0</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116246">testOk</span>&nbsp;<span class="op" id="6116253">:=</span>&nbsp;<span class="ident" id="6116256">RunTests</span><span class="op" id="6116264">(</span><span class="ident" id="6116265">m</span><span class="op" id="6116266">.</span><span class="ident" id="6116267">matchString</span><span class="op" id="6116278">,</span>&nbsp;<span class="ident" id="6116280">m</span><span class="op" id="6116281">.</span><span class="ident" id="6116282">tests</span><span class="op" id="6116287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116290">exampleOk</span>&nbsp;<span class="op" id="6116300">:=</span>&nbsp;<span class="ident" id="6116303">RunExamples</span><span class="op" id="6116314">(</span><span class="ident" id="6116315">m</span><span class="op" id="6116316">.</span><span class="ident" id="6116317">matchString</span><span class="op" id="6116328">,</span>&nbsp;<span class="ident" id="6116330">m</span><span class="op" id="6116331">.</span><span class="ident" id="6116332">examples</span><span class="op" id="6116340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116343">stopAlarm</span><span class="op" id="6116352">(</span><span class="op" id="6116353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6116356">if</span>&nbsp;<span class="op" id="6116359">!</span><span class="ident" id="6116360">testOk</span>&nbsp;<span class="op" id="6116367">||</span>&nbsp;<span class="op" id="6116370">!</span><span class="ident" id="6116371">exampleOk</span>&nbsp;<span class="op" id="6116381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116385">fmt</span><span class="op" id="6116388">.</span><span class="ident" id="6116389">Println</span><span class="op" id="6116396">(</span><span class="string" id="6116397">&#34;FAIL&#34;</span><span class="op" id="6116403">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116407">after</span><span class="op" id="6116412">(</span><span class="op" id="6116413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6116417">return</span>&nbsp;<span class="num" id="6116424">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6116427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116430">fmt</span><span class="op" id="6116433">.</span><span class="ident" id="6116434">Println</span><span class="op" id="6116441">(</span><span class="string" id="6116442">&#34;PASS&#34;</span><span class="op" id="6116448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116451">RunBenchmarks</span><span class="op" id="6116464">(</span><span class="ident" id="6116465">m</span><span class="op" id="6116466">.</span><span class="ident" id="6116467">matchString</span><span class="op" id="6116478">,</span>&nbsp;<span class="ident" id="6116480">m</span><span class="op" id="6116481">.</span><span class="ident" id="6116482">benchmarks</span><span class="op" id="6116492">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116495">after</span><span class="op" id="6116500">(</span><span class="op" id="6116501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6116504">return</span>&nbsp;<span class="num" id="6116511">0</span><br>
<span class="lineno"></span><span class="op" id="6116513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6116516">func</span>&nbsp;<span class="op" id="6116521">(</span><span class="ident" id="6116522">t</span>&nbsp;<span class="op" id="6116524">*</span><span class="ident" id="6116525">T</span><span class="op" id="6116526">)</span>&nbsp;<span class="ident" id="6116528">report</span><span class="op" id="6116534">(</span><span class="op" id="6116535">)</span>&nbsp;<span class="op" id="6116537">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116540">dstr</span>&nbsp;<span class="op" id="6116545">:=</span>&nbsp;<span class="ident" id="6116548">fmtDuration</span><span class="op" id="6116559">(</span><span class="ident" id="6116560">t</span><span class="op" id="6116561">.</span><span class="ident" id="6116562">duration</span><span class="op" id="6116570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116573">format</span>&nbsp;<span class="op" id="6116580">:=</span>&nbsp;<span class="string" id="6116583">&#34;---&nbsp;%s:&nbsp;%s&nbsp;(%s)\n%s&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6116606">if</span>&nbsp;<span class="ident" id="6116609">t</span><span class="op" id="6116610">.</span><span class="ident" id="6116611">Failed</span><span class="op" id="6116617">(</span><span class="op" id="6116618">)</span>&nbsp;<span class="op" id="6116620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116624">fmt</span><span class="op" id="6116627">.</span><span class="ident" id="6116628">Printf</span><span class="op" id="6116634">(</span><span class="ident" id="6116635">format</span><span class="op" id="6116641">,</span>&nbsp;<span class="string" id="6116643">&#34;FAIL&#34;</span><span class="op" id="6116649">,</span>&nbsp;<span class="ident" id="6116651">t</span><span class="op" id="6116652">.</span><span class="ident" id="6116653">name</span><span class="op" id="6116657">,</span>&nbsp;<span class="ident" id="6116659">dstr</span><span class="op" id="6116663">,</span>&nbsp;<span class="ident" id="6116665">t</span><span class="op" id="6116666">.</span><span class="ident" id="6116667">output</span><span class="op" id="6116673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6116676">}</span>&nbsp;<span class="keyword" id="6116678">else</span>&nbsp;<span class="keyword" id="6116683">if</span>&nbsp;<span class="op" id="6116686">*</span><span class="ident" id="6116687">chatty</span>&nbsp;<span class="op" id="6116694">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6116698">if</span>&nbsp;<span class="ident" id="6116701">t</span><span class="op" id="6116702">.</span><span class="ident" id="6116703">Skipped</span><span class="op" id="6116710">(</span><span class="op" id="6116711">)</span>&nbsp;<span class="op" id="6116713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116718">fmt</span><span class="op" id="6116721">.</span><span class="ident" id="6116722">Printf</span><span class="op" id="6116728">(</span><span class="ident" id="6116729">format</span><span class="op" id="6116735">,</span>&nbsp;<span class="string" id="6116737">&#34;SKIP&#34;</span><span class="op" id="6116743">,</span>&nbsp;<span class="ident" id="6116745">t</span><span class="op" id="6116746">.</span><span class="ident" id="6116747">name</span><span class="op" id="6116751">,</span>&nbsp;<span class="ident" id="6116753">dstr</span><span class="op" id="6116757">,</span>&nbsp;<span class="ident" id="6116759">t</span><span class="op" id="6116760">.</span><span class="ident" id="6116761">output</span><span class="op" id="6116767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6116771">}</span>&nbsp;<span class="keyword" id="6116773">else</span>&nbsp;<span class="op" id="6116778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116783">fmt</span><span class="op" id="6116786">.</span><span class="ident" id="6116787">Printf</span><span class="op" id="6116793">(</span><span class="ident" id="6116794">format</span><span class="op" id="6116800">,</span>&nbsp;<span class="string" id="6116802">&#34;PASS&#34;</span><span class="op" id="6116808">,</span>&nbsp;<span class="ident" id="6116810">t</span><span class="op" id="6116811">.</span><span class="ident" id="6116812">name</span><span class="op" id="6116816">,</span>&nbsp;<span class="ident" id="6116818">dstr</span><span class="op" id="6116822">,</span>&nbsp;<span class="ident" id="6116824">t</span><span class="op" id="6116825">.</span><span class="ident" id="6116826">output</span><span class="op" id="6116832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6116836">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6116839">}</span><br>
<span class="lineno"></span><span class="op" id="6116841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6116844">func</span>&nbsp;<span class="ident" id="6116849">RunTests</span><span class="op" id="6116857">(</span><span class="ident" id="6116858">matchString</span>&nbsp;<span class="keyword" id="6116870">func</span><span class="op" id="6116874">(</span><span class="ident" id="6116875">pat</span><span class="op" id="6116878">,</span>&nbsp;<span class="ident" id="6116880">str</span>&nbsp;<span class="builtintype" id="6116884">string</span><span class="op" id="6116890">)</span>&nbsp;<span class="op" id="6116892">(</span><span class="builtintype" id="6116893">bool</span><span class="op" id="6116897">,</span>&nbsp;<span class="builtintype" id="6116899">error</span><span class="op" id="6116904">)</span><span class="op" id="6116905">,</span>&nbsp;<span class="ident" id="6116907">tests</span>&nbsp;<span class="op" id="6116913">[</span><span class="op" id="6116914">]</span><span class="ident" id="6116915">InternalTest</span><span class="op" id="6116927">)</span>&nbsp;<span class="op" id="6116929">(</span><span class="ident" id="6116930">ok</span>&nbsp;<span class="builtintype" id="6116933">bool</span><span class="op" id="6116937">)</span>&nbsp;<span class="op" id="6116939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116942">ok</span>&nbsp;<span class="op" id="6116945">=</span>&nbsp;<span class="builtintype" id="6116947">true</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6116953">if</span>&nbsp;<span class="builtinfunc" id="6116956">len</span><span class="op" id="6116959">(</span><span class="ident" id="6116960">tests</span><span class="op" id="6116965">)</span>&nbsp;<span class="op" id="6116967">==</span>&nbsp;<span class="num" id="6116970">0</span>&nbsp;<span class="op" id="6116972">&amp;&amp;</span>&nbsp;<span class="op" id="6116975">!</span><span class="ident" id="6116976">haveExamples</span>&nbsp;<span class="op" id="6116989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6116993">fmt</span><span class="op" id="6116996">.</span><span class="ident" id="6116997">Fprintln</span><span class="op" id="6117005">(</span><span class="ident" id="6117006">os</span><span class="op" id="6117008">.</span><span class="ident" id="6117009">Stderr</span><span class="op" id="6117015">,</span>&nbsp;<span class="string" id="6117017">&#34;testing:&nbsp;warning:&nbsp;no&nbsp;tests&nbsp;to&nbsp;run&#34;</span><span class="op" id="6117052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6117056">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6117064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6117067">for</span>&nbsp;<span class="ident" id="6117071">_</span><span class="op" id="6117072">,</span>&nbsp;<span class="ident" id="6117074">procs</span>&nbsp;<span class="op" id="6117080">:=</span>&nbsp;<span class="keyword" id="6117083">range</span>&nbsp;<span class="ident" id="6117089">cpuList</span>&nbsp;<span class="op" id="6117097">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6117101">runtime</span><span class="op" id="6117108">.</span><span class="ident" id="6117109">GOMAXPROCS</span><span class="op" id="6117119">(</span><span class="ident" id="6117120">procs</span><span class="op" id="6117125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6117129">//&nbsp;We&nbsp;build&nbsp;a&nbsp;new&nbsp;channel&nbsp;tree&nbsp;for&nbsp;each&nbsp;run&nbsp;of&nbsp;the&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6117188">//&nbsp;collector&nbsp;merges&nbsp;in&nbsp;one&nbsp;channel&nbsp;all&nbsp;the&nbsp;upstream&nbsp;signals&nbsp;from&nbsp;parallel&nbsp;tests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6117271">//&nbsp;If&nbsp;all&nbsp;tests&nbsp;pump&nbsp;to&nbsp;the&nbsp;same&nbsp;channel,&nbsp;a&nbsp;bug&nbsp;can&nbsp;occur&nbsp;where&nbsp;a&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6117344">//&nbsp;kicks&nbsp;off&nbsp;a&nbsp;goroutine&nbsp;that&nbsp;Fails,&nbsp;yet&nbsp;the&nbsp;test&nbsp;still&nbsp;delivers&nbsp;a&nbsp;completion&nbsp;signal,</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6117432">//&nbsp;which&nbsp;skews&nbsp;the&nbsp;counting.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6117463">var</span>&nbsp;<span class="ident" id="6117467">collector</span>&nbsp;<span class="op" id="6117477">=</span>&nbsp;<span class="builtinfunc" id="6117479">make</span><span class="op" id="6117483">(</span><span class="keyword" id="6117484">chan</span>&nbsp;<span class="keyword" id="6117489">interface</span><span class="op" id="6117498">{</span><span class="op" id="6117499">}</span><span class="op" id="6117500">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6117505">numParallel</span>&nbsp;<span class="op" id="6117517">:=</span>&nbsp;<span class="num" id="6117520">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6117524">startParallel</span>&nbsp;<span class="op" id="6117538">:=</span>&nbsp;<span class="builtinfunc" id="6117541">make</span><span class="op" id="6117545">(</span><span class="keyword" id="6117546">chan</span>&nbsp;<span class="builtintype" id="6117551">bool</span><span class="op" id="6117555">)</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6117560">for</span>&nbsp;<span class="ident" id="6117564">i</span>&nbsp;<span class="op" id="6117566">:=</span>&nbsp;<span class="num" id="6117569">0</span><span class="op" id="6117570">;</span>&nbsp;<span class="ident" id="6117572">i</span>&nbsp;<span class="op" id="6117574">&lt;</span>&nbsp;<span class="builtinfunc" id="6117576">len</span><span class="op" id="6117579">(</span><span class="ident" id="6117580">tests</span><span class="op" id="6117585">)</span><span class="op" id="6117586">;</span>&nbsp;<span class="ident" id="6117588">i</span><span class="op" id="6117589">++</span>&nbsp;<span class="op" id="6117592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6117597">matched</span><span class="op" id="6117604">,</span>&nbsp;<span class="ident" id="6117606">err</span>&nbsp;<span class="op" id="6117610">:=</span>&nbsp;<span class="ident" id="6117613">matchString</span><span class="op" id="6117624">(</span><span class="op" id="6117625">*</span><span class="ident" id="6117626">match</span><span class="op" id="6117631">,</span>&nbsp;<span class="ident" id="6117633">tests</span><span class="op" id="6117638">[</span><span class="ident" id="6117639">i</span><span class="op" id="6117640">]</span><span class="op" id="6117641">.</span><span class="ident" id="6117642">Name</span><span class="op" id="6117646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6117651">if</span>&nbsp;<span class="ident" id="6117654">err</span>&nbsp;<span class="op" id="6117658">!=</span>&nbsp;<span class="builtintype" id="6117661">nil</span>&nbsp;<span class="op" id="6117665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6117671">fmt</span><span class="op" id="6117674">.</span><span class="ident" id="6117675">Fprintf</span><span class="op" id="6117682">(</span><span class="ident" id="6117683">os</span><span class="op" id="6117685">.</span><span class="ident" id="6117686">Stderr</span><span class="op" id="6117692">,</span>&nbsp;<span class="string" id="6117694">&#34;testing:&nbsp;invalid&nbsp;regexp&nbsp;for&nbsp;-test.run:&nbsp;%s\n&#34;</span><span class="op" id="6117739">,</span>&nbsp;<span class="ident" id="6117741">err</span><span class="op" id="6117744">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6117750">os</span><span class="op" id="6117752">.</span><span class="ident" id="6117753">Exit</span><span class="op" id="6117757">(</span><span class="num" id="6117758">1</span><span class="op" id="6117759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6117764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6117769">if</span>&nbsp;<span class="op" id="6117772">!</span><span class="ident" id="6117773">matched</span>&nbsp;<span class="op" id="6117781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6117787">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6117799">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6117804">testName</span>&nbsp;<span class="op" id="6117813">:=</span>&nbsp;<span class="ident" id="6117816">tests</span><span class="op" id="6117821">[</span><span class="ident" id="6117822">i</span><span class="op" id="6117823">]</span><span class="op" id="6117824">.</span><span class="ident" id="6117825">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6117833">if</span>&nbsp;<span class="ident" id="6117836">procs</span>&nbsp;<span class="op" id="6117842">!=</span>&nbsp;<span class="num" id="6117845">1</span>&nbsp;<span class="op" id="6117847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6117853">testName</span>&nbsp;<span class="op" id="6117862">=</span>&nbsp;<span class="ident" id="6117864">fmt</span><span class="op" id="6117867">.</span><span class="ident" id="6117868">Sprintf</span><span class="op" id="6117875">(</span><span class="string" id="6117876">&#34;%s-%d&#34;</span><span class="op" id="6117883">,</span>&nbsp;<span class="ident" id="6117885">tests</span><span class="op" id="6117890">[</span><span class="ident" id="6117891">i</span><span class="op" id="6117892">]</span><span class="op" id="6117893">.</span><span class="ident" id="6117894">Name</span><span class="op" id="6117898">,</span>&nbsp;<span class="ident" id="6117900">procs</span><span class="op" id="6117905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6117910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6117915">t</span>&nbsp;<span class="op" id="6117917">:=</span>&nbsp;<span class="op" id="6117920">&amp;</span><span class="ident" id="6117921">T</span><span class="op" id="6117922">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6117928">common</span><span class="op" id="6117934">:</span>&nbsp;<span class="ident" id="6117936">common</span><span class="op" id="6117942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6117949">signal</span><span class="op" id="6117955">:</span>&nbsp;<span class="builtinfunc" id="6117957">make</span><span class="op" id="6117961">(</span><span class="keyword" id="6117962">chan</span>&nbsp;<span class="keyword" id="6117967">interface</span><span class="op" id="6117976">{</span><span class="op" id="6117977">}</span><span class="op" id="6117978">)</span><span class="op" id="6117979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6117985">}</span><span class="op" id="6117986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6117992">name</span><span class="op" id="6117996">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118007">testName</span><span class="op" id="6118015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118021">startParallel</span><span class="op" id="6118034">:</span>&nbsp;<span class="ident" id="6118036">startParallel</span><span class="op" id="6118049">,</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6118054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118059">t</span><span class="op" id="6118060">.</span><span class="ident" id="6118061">self</span>&nbsp;<span class="op" id="6118066">=</span>&nbsp;<span class="ident" id="6118068">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6118073">if</span>&nbsp;<span class="op" id="6118076">*</span><span class="ident" id="6118077">chatty</span>&nbsp;<span class="op" id="6118084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118090">fmt</span><span class="op" id="6118093">.</span><span class="ident" id="6118094">Printf</span><span class="op" id="6118100">(</span><span class="string" id="6118101">&#34;===&nbsp;RUN&nbsp;%s\n&#34;</span><span class="op" id="6118115">,</span>&nbsp;<span class="ident" id="6118117">t</span><span class="op" id="6118118">.</span><span class="ident" id="6118119">name</span><span class="op" id="6118123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6118128">}</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6118133">go</span>&nbsp;<span class="ident" id="6118136">tRunner</span><span class="op" id="6118143">(</span><span class="ident" id="6118144">t</span><span class="op" id="6118145">,</span>&nbsp;<span class="op" id="6118147">&amp;</span><span class="ident" id="6118148">tests</span><span class="op" id="6118153">[</span><span class="ident" id="6118154">i</span><span class="op" id="6118155">]</span><span class="op" id="6118156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118161">out</span>&nbsp;<span class="op" id="6118165">:=</span>&nbsp;<span class="op" id="6118168">(</span><span class="op" id="6118169">&lt;-</span><span class="ident" id="6118171">t</span><span class="op" id="6118172">.</span><span class="ident" id="6118173">signal</span><span class="op" id="6118179">)</span><span class="op" id="6118180">.</span><span class="op" id="6118181">(</span><span class="op" id="6118182">*</span><span class="ident" id="6118183">T</span><span class="op" id="6118184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6118189">if</span>&nbsp;<span class="ident" id="6118192">out</span>&nbsp;<span class="op" id="6118196">==</span>&nbsp;<span class="builtintype" id="6118199">nil</span>&nbsp;<span class="op" id="6118203">{</span>&nbsp;<span class="comment" id="6118205">//&nbsp;Parallel&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6118226">go</span>&nbsp;<span class="keyword" id="6118229">func</span><span class="op" id="6118233">(</span><span class="op" id="6118234">)</span>&nbsp;<span class="op" id="6118236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118243">collector</span>&nbsp;<span class="op" id="6118253">&lt;-</span>&nbsp;<span class="op" id="6118256">&lt;-</span><span class="ident" id="6118258">t</span><span class="op" id="6118259">.</span><span class="ident" id="6118260">signal</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6118271">}</span><span class="op" id="6118272">(</span><span class="op" id="6118273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118279">numParallel</span><span class="op" id="6118290">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6118297">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6118309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118314">t</span><span class="op" id="6118315">.</span><span class="ident" id="6118316">report</span><span class="op" id="6118322">(</span><span class="op" id="6118323">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118328">ok</span>&nbsp;<span class="op" id="6118331">=</span>&nbsp;<span class="ident" id="6118333">ok</span>&nbsp;<span class="op" id="6118336">&amp;&amp;</span>&nbsp;<span class="op" id="6118339">!</span><span class="ident" id="6118340">out</span><span class="op" id="6118343">.</span><span class="ident" id="6118344">Failed</span><span class="op" id="6118350">(</span><span class="op" id="6118351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6118355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118360">running</span>&nbsp;<span class="op" id="6118368">:=</span>&nbsp;<span class="num" id="6118371">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6118375">for</span>&nbsp;<span class="ident" id="6118379">numParallel</span><span class="op" id="6118390">+</span><span class="ident" id="6118391">running</span>&nbsp;<span class="op" id="6118399">&gt;</span>&nbsp;<span class="num" id="6118401">0</span>&nbsp;<span class="op" id="6118403">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6118408">if</span>&nbsp;<span class="ident" id="6118411">running</span>&nbsp;<span class="op" id="6118419">&lt;</span>&nbsp;<span class="op" id="6118421">*</span><span class="ident" id="6118422">parallel</span>&nbsp;<span class="op" id="6118431">&amp;&amp;</span>&nbsp;<span class="ident" id="6118434">numParallel</span>&nbsp;<span class="op" id="6118446">&gt;</span>&nbsp;<span class="num" id="6118448">0</span>&nbsp;<span class="op" id="6118450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118456">startParallel</span>&nbsp;<span class="op" id="6118470">&lt;-</span>&nbsp;<span class="builtintype" id="6118473">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118482">running</span><span class="op" id="6118489">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118496">numParallel</span><span class="op" id="6118507">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6118514">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6118526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118531">t</span>&nbsp;<span class="op" id="6118533">:=</span>&nbsp;<span class="op" id="6118536">(</span><span class="op" id="6118537">&lt;-</span><span class="ident" id="6118539">collector</span><span class="op" id="6118548">)</span><span class="op" id="6118549">.</span><span class="op" id="6118550">(</span><span class="op" id="6118551">*</span><span class="ident" id="6118552">T</span><span class="op" id="6118553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118558">t</span><span class="op" id="6118559">.</span><span class="ident" id="6118560">report</span><span class="op" id="6118566">(</span><span class="op" id="6118567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118572">ok</span>&nbsp;<span class="op" id="6118575">=</span>&nbsp;<span class="ident" id="6118577">ok</span>&nbsp;<span class="op" id="6118580">&amp;&amp;</span>&nbsp;<span class="op" id="6118583">!</span><span class="ident" id="6118584">t</span><span class="op" id="6118585">.</span><span class="ident" id="6118586">Failed</span><span class="op" id="6118592">(</span><span class="op" id="6118593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118598">running</span><span class="op" id="6118605">--</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6118610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6118613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6118616">return</span><br>
<span class="lineno"></span><span class="op" id="6118623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="comment" id="6118626">//&nbsp;before&nbsp;runs&nbsp;before&nbsp;all&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="6118661">func</span>&nbsp;<span class="ident" id="6118666">before</span><span class="op" id="6118672">(</span><span class="op" id="6118673">)</span>&nbsp;<span class="op" id="6118675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6118678">if</span>&nbsp;<span class="op" id="6118681">*</span><span class="ident" id="6118682">memProfileRate</span>&nbsp;<span class="op" id="6118697">&gt;</span>&nbsp;<span class="num" id="6118699">0</span>&nbsp;<span class="op" id="6118701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118705">runtime</span><span class="op" id="6118712">.</span><span class="ident" id="6118713">MemProfileRate</span>&nbsp;<span class="op" id="6118728">=</span>&nbsp;<span class="op" id="6118730">*</span><span class="ident" id="6118731">memProfileRate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6118747">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6118750">if</span>&nbsp;<span class="op" id="6118753">*</span><span class="ident" id="6118754">cpuProfile</span>&nbsp;<span class="op" id="6118765">!=</span>&nbsp;<span class="string" id="6118768">&#34;&#34;</span>&nbsp;<span class="op" id="6118771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118775">f</span><span class="op" id="6118776">,</span>&nbsp;<span class="ident" id="6118778">err</span>&nbsp;<span class="op" id="6118782">:=</span>&nbsp;<span class="ident" id="6118785">os</span><span class="op" id="6118787">.</span><span class="ident" id="6118788">Create</span><span class="op" id="6118794">(</span><span class="ident" id="6118795">toOutputDir</span><span class="op" id="6118806">(</span><span class="op" id="6118807">*</span><span class="ident" id="6118808">cpuProfile</span><span class="op" id="6118818">)</span><span class="op" id="6118819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6118823">if</span>&nbsp;<span class="ident" id="6118826">err</span>&nbsp;<span class="op" id="6118830">!=</span>&nbsp;<span class="builtintype" id="6118833">nil</span>&nbsp;<span class="op" id="6118837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118842">fmt</span><span class="op" id="6118845">.</span><span class="ident" id="6118846">Fprintf</span><span class="op" id="6118853">(</span><span class="ident" id="6118854">os</span><span class="op" id="6118856">.</span><span class="ident" id="6118857">Stderr</span><span class="op" id="6118863">,</span>&nbsp;<span class="string" id="6118865">&#34;testing:&nbsp;%s&#34;</span><span class="op" id="6118878">,</span>&nbsp;<span class="ident" id="6118880">err</span><span class="op" id="6118883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6118888">return</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6118897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6118901">if</span>&nbsp;<span class="ident" id="6118904">err</span>&nbsp;<span class="op" id="6118908">:=</span>&nbsp;<span class="ident" id="6118911">pprof</span><span class="op" id="6118916">.</span><span class="ident" id="6118917">StartCPUProfile</span><span class="op" id="6118932">(</span><span class="ident" id="6118933">f</span><span class="op" id="6118934">)</span><span class="op" id="6118935">;</span>&nbsp;<span class="ident" id="6118937">err</span>&nbsp;<span class="op" id="6118941">!=</span>&nbsp;<span class="builtintype" id="6118944">nil</span>&nbsp;<span class="op" id="6118948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6118953">fmt</span><span class="op" id="6118956">.</span><span class="ident" id="6118957">Fprintf</span><span class="op" id="6118964">(</span><span class="ident" id="6118965">os</span><span class="op" id="6118967">.</span><span class="ident" id="6118968">Stderr</span><span class="op" id="6118974">,</span>&nbsp;<span class="string" id="6118976">&#34;testing:&nbsp;can&#39;t&nbsp;start&nbsp;cpu&nbsp;profile:&nbsp;%s&#34;</span><span class="op" id="6119014">,</span>&nbsp;<span class="ident" id="6119016">err</span><span class="op" id="6119019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6119024">f</span><span class="op" id="6119025">.</span><span class="ident" id="6119026">Close</span><span class="op" id="6119031">(</span><span class="op" id="6119032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6119037">return</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6119046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6119050">//&nbsp;Could&nbsp;save&nbsp;f&nbsp;so&nbsp;after&nbsp;can&nbsp;call&nbsp;f.Close;&nbsp;not&nbsp;worth&nbsp;the&nbsp;effort.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6119116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6119119">if</span>&nbsp;<span class="op" id="6119122">*</span><span class="ident" id="6119123">blockProfile</span>&nbsp;<span class="op" id="6119136">!=</span>&nbsp;<span class="string" id="6119139">&#34;&#34;</span>&nbsp;<span class="op" id="6119142">&amp;&amp;</span>&nbsp;<span class="op" id="6119145">*</span><span class="ident" id="6119146">blockProfileRate</span>&nbsp;<span class="op" id="6119163">&gt;=</span>&nbsp;<span class="num" id="6119166">0</span>&nbsp;<span class="op" id="6119168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6119172">runtime</span><span class="op" id="6119179">.</span><span class="ident" id="6119180">SetBlockProfileRate</span><span class="op" id="6119199">(</span><span class="op" id="6119200">*</span><span class="ident" id="6119201">blockProfileRate</span><span class="op" id="6119217">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6119220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6119223">if</span>&nbsp;<span class="op" id="6119226">*</span><span class="ident" id="6119227">coverProfile</span>&nbsp;<span class="op" id="6119240">!=</span>&nbsp;<span class="string" id="6119243">&#34;&#34;</span>&nbsp;<span class="op" id="6119246">&amp;&amp;</span>&nbsp;<span class="ident" id="6119249">cover</span><span class="op" id="6119254">.</span><span class="ident" id="6119255">Mode</span>&nbsp;<span class="op" id="6119260">==</span>&nbsp;<span class="string" id="6119263">&#34;&#34;</span>&nbsp;<span class="op" id="6119266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6119270">fmt</span><span class="op" id="6119273">.</span><span class="ident" id="6119274">Fprintf</span><span class="op" id="6119281">(</span><span class="ident" id="6119282">os</span><span class="op" id="6119284">.</span><span class="ident" id="6119285">Stderr</span><span class="op" id="6119291">,</span>&nbsp;<span class="string" id="6119293">&#34;testing:&nbsp;cannot&nbsp;use&nbsp;-test.coverprofile&nbsp;because&nbsp;test&nbsp;binary&nbsp;was&nbsp;not&nbsp;built&nbsp;with&nbsp;coverage&nbsp;enabled\n&#34;</span><span class="op" id="6119391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6119395">os</span><span class="op" id="6119397">.</span><span class="ident" id="6119398">Exit</span><span class="op" id="6119402">(</span><span class="num" id="6119403">2</span><span class="op" id="6119404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6119407">}</span><br>
<span class="lineno">610</span><span class="op" id="6119409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6119412">//&nbsp;after&nbsp;runs&nbsp;after&nbsp;all&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="6119445">func</span>&nbsp;<span class="ident" id="6119450">after</span><span class="op" id="6119455">(</span><span class="op" id="6119456">)</span>&nbsp;<span class="op" id="6119458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6119461">if</span>&nbsp;<span class="op" id="6119464">*</span><span class="ident" id="6119465">cpuProfile</span>&nbsp;<span class="op" id="6119476">!=</span>&nbsp;<span class="string" id="6119479">&#34;&#34;</span>&nbsp;<span class="op" id="6119482">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6119486">pprof</span><span class="op" id="6119491">.</span><span class="ident" id="6119492">StopCPUProfile</span><span class="op" id="6119506">(</span><span class="op" id="6119507">)</span>&nbsp;<span class="comment" id="6119509">//&nbsp;flushes&nbsp;profile&nbsp;to&nbsp;disk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6119537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6119540">if</span>&nbsp;<span class="op" id="6119543">*</span><span class="ident" id="6119544">memProfile</span>&nbsp;<span class="op" id="6119555">!=</span>&nbsp;<span class="string" id="6119558">&#34;&#34;</span>&nbsp;<span class="op" id="6119561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6119565">f</span><span class="op" id="6119566">,</span>&nbsp;<span class="ident" id="6119568">err</span>&nbsp;<span class="op" id="6119572">:=</span>&nbsp;<span class="ident" id="6119575">os</span><span class="op" id="6119577">.</span><span class="ident" id="6119578">Create</span><span class="op" id="6119584">(</span><span class="ident" id="6119585">toOutputDir</span><span class="op" id="6119596">(</span><span class="op" id="6119597">*</span><span class="ident" id="6119598">memProfile</span><span class="op" id="6119608">)</span><span class="op" id="6119609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6119613">if</span>&nbsp;<span class="ident" id="6119616">err</span>&nbsp;<span class="op" id="6119620">!=</span>&nbsp;<span class="builtintype" id="6119623">nil</span>&nbsp;<span class="op" id="6119627">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6119632">fmt</span><span class="op" id="6119635">.</span><span class="ident" id="6119636">Fprintf</span><span class="op" id="6119643">(</span><span class="ident" id="6119644">os</span><span class="op" id="6119646">.</span><span class="ident" id="6119647">Stderr</span><span class="op" id="6119653">,</span>&nbsp;<span class="string" id="6119655">&#34;testing:&nbsp;%s\n&#34;</span><span class="op" id="6119670">,</span>&nbsp;<span class="ident" id="6119672">err</span><span class="op" id="6119675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6119680">os</span><span class="op" id="6119682">.</span><span class="ident" id="6119683">Exit</span><span class="op" id="6119687">(</span><span class="num" id="6119688">2</span><span class="op" id="6119689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6119693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6119697">runtime</span><span class="op" id="6119704">.</span><span class="ident" id="6119705">GC</span><span class="op" id="6119707">(</span><span class="op" id="6119708">)</span>&nbsp;<span class="comment" id="6119710">//&nbsp;materialize&nbsp;all&nbsp;statistics</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6119742">if</span>&nbsp;<span class="ident" id="6119745">err</span>&nbsp;<span class="op" id="6119749">=</span>&nbsp;<span class="ident" id="6119751">pprof</span><span class="op" id="6119756">.</span><span class="ident" id="6119757">WriteHeapProfile</span><span class="op" id="6119773">(</span><span class="ident" id="6119774">f</span><span class="op" id="6119775">)</span><span class="op" id="6119776">;</span>&nbsp;<span class="ident" id="6119778">err</span>&nbsp;<span class="op" id="6119782">!=</span>&nbsp;<span class="builtintype" id="6119785">nil</span>&nbsp;<span class="op" id="6119789">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6119794">fmt</span><span class="op" id="6119797">.</span><span class="ident" id="6119798">Fprintf</span><span class="op" id="6119805">(</span><span class="ident" id="6119806">os</span><span class="op" id="6119808">.</span><span class="ident" id="6119809">Stderr</span><span class="op" id="6119815">,</span>&nbsp;<span class="string" id="6119817">&#34;testing:&nbsp;can&#39;t&nbsp;write&nbsp;%s:&nbsp;%s\n&#34;</span><span class="op" id="6119848">,</span>&nbsp;<span class="op" id="6119850">*</span><span class="ident" id="6119851">memProfile</span><span class="op" id="6119861">,</span>&nbsp;<span class="ident" id="6119863">err</span><span class="op" id="6119866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6119871">os</span><span class="op" id="6119873">.</span><span class="ident" id="6119874">Exit</span><span class="op" id="6119878">(</span><span class="num" id="6119879">2</span><span class="op" id="6119880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6119884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6119888">f</span><span class="op" id="6119889">.</span><span class="ident" id="6119890">Close</span><span class="op" id="6119895">(</span><span class="op" id="6119896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6119899">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6119902">if</span>&nbsp;<span class="op" id="6119905">*</span><span class="ident" id="6119906">blockProfile</span>&nbsp;<span class="op" id="6119919">!=</span>&nbsp;<span class="string" id="6119922">&#34;&#34;</span>&nbsp;<span class="op" id="6119925">&amp;&amp;</span>&nbsp;<span class="op" id="6119928">*</span><span class="ident" id="6119929">blockProfileRate</span>&nbsp;<span class="op" id="6119946">&gt;=</span>&nbsp;<span class="num" id="6119949">0</span>&nbsp;<span class="op" id="6119951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6119955">f</span><span class="op" id="6119956">,</span>&nbsp;<span class="ident" id="6119958">err</span>&nbsp;<span class="op" id="6119962">:=</span>&nbsp;<span class="ident" id="6119965">os</span><span class="op" id="6119967">.</span><span class="ident" id="6119968">Create</span><span class="op" id="6119974">(</span><span class="ident" id="6119975">toOutputDir</span><span class="op" id="6119986">(</span><span class="op" id="6119987">*</span><span class="ident" id="6119988">blockProfile</span><span class="op" id="6120000">)</span><span class="op" id="6120001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6120005">if</span>&nbsp;<span class="ident" id="6120008">err</span>&nbsp;<span class="op" id="6120012">!=</span>&nbsp;<span class="builtintype" id="6120015">nil</span>&nbsp;<span class="op" id="6120019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6120024">fmt</span><span class="op" id="6120027">.</span><span class="ident" id="6120028">Fprintf</span><span class="op" id="6120035">(</span><span class="ident" id="6120036">os</span><span class="op" id="6120038">.</span><span class="ident" id="6120039">Stderr</span><span class="op" id="6120045">,</span>&nbsp;<span class="string" id="6120047">&#34;testing:&nbsp;%s\n&#34;</span><span class="op" id="6120062">,</span>&nbsp;<span class="ident" id="6120064">err</span><span class="op" id="6120067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6120072">os</span><span class="op" id="6120074">.</span><span class="ident" id="6120075">Exit</span><span class="op" id="6120079">(</span><span class="num" id="6120080">2</span><span class="op" id="6120081">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6120085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6120089">if</span>&nbsp;<span class="ident" id="6120092">err</span>&nbsp;<span class="op" id="6120096">=</span>&nbsp;<span class="ident" id="6120098">pprof</span><span class="op" id="6120103">.</span><span class="ident" id="6120104">Lookup</span><span class="op" id="6120110">(</span><span class="string" id="6120111">&#34;block&#34;</span><span class="op" id="6120118">)</span><span class="op" id="6120119">.</span><span class="ident" id="6120120">WriteTo</span><span class="op" id="6120127">(</span><span class="ident" id="6120128">f</span><span class="op" id="6120129">,</span>&nbsp;<span class="num" id="6120131">0</span><span class="op" id="6120132">)</span><span class="op" id="6120133">;</span>&nbsp;<span class="ident" id="6120135">err</span>&nbsp;<span class="op" id="6120139">!=</span>&nbsp;<span class="builtintype" id="6120142">nil</span>&nbsp;<span class="op" id="6120146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6120151">fmt</span><span class="op" id="6120154">.</span><span class="ident" id="6120155">Fprintf</span><span class="op" id="6120162">(</span><span class="ident" id="6120163">os</span><span class="op" id="6120165">.</span><span class="ident" id="6120166">Stderr</span><span class="op" id="6120172">,</span>&nbsp;<span class="string" id="6120174">&#34;testing:&nbsp;can&#39;t&nbsp;write&nbsp;%s:&nbsp;%s\n&#34;</span><span class="op" id="6120205">,</span>&nbsp;<span class="op" id="6120207">*</span><span class="ident" id="6120208">blockProfile</span><span class="op" id="6120220">,</span>&nbsp;<span class="ident" id="6120222">err</span><span class="op" id="6120225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6120230">os</span><span class="op" id="6120232">.</span><span class="ident" id="6120233">Exit</span><span class="op" id="6120237">(</span><span class="num" id="6120238">2</span><span class="op" id="6120239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6120243">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6120247">f</span><span class="op" id="6120248">.</span><span class="ident" id="6120249">Close</span><span class="op" id="6120254">(</span><span class="op" id="6120255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6120258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6120261">if</span>&nbsp;<span class="ident" id="6120264">cover</span><span class="op" id="6120269">.</span><span class="ident" id="6120270">Mode</span>&nbsp;<span class="op" id="6120275">!=</span>&nbsp;<span class="string" id="6120278">&#34;&#34;</span>&nbsp;<span class="op" id="6120281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6120285">coverReport</span><span class="op" id="6120296">(</span><span class="op" id="6120297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6120300">}</span><br>
<span class="lineno">645</span><span class="op" id="6120302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6120305">//&nbsp;toOutputDir&nbsp;returns&nbsp;the&nbsp;file&nbsp;name&nbsp;relocated,&nbsp;if&nbsp;required,&nbsp;to&nbsp;outputDir.</span><br>
<span class="lineno"></span><span class="comment" id="6120380">//&nbsp;Simple&nbsp;implementation&nbsp;to&nbsp;avoid&nbsp;pulling&nbsp;in&nbsp;path/filepath.</span><br>
<span class="lineno"></span><span class="keyword" id="6120440">func</span>&nbsp;<span class="ident" id="6120445">toOutputDir</span><span class="op" id="6120456">(</span><span class="ident" id="6120457">path</span>&nbsp;<span class="builtintype" id="6120462">string</span><span class="op" id="6120468">)</span>&nbsp;<span class="builtintype" id="6120470">string</span>&nbsp;<span class="op" id="6120477">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6120480">if</span>&nbsp;<span class="op" id="6120483">*</span><span class="ident" id="6120484">outputDir</span>&nbsp;<span class="op" id="6120494">==</span>&nbsp;<span class="string" id="6120497">&#34;&#34;</span>&nbsp;<span class="op" id="6120500">||</span>&nbsp;<span class="ident" id="6120503">path</span>&nbsp;<span class="op" id="6120508">==</span>&nbsp;<span class="string" id="6120511">&#34;&#34;</span>&nbsp;<span class="op" id="6120514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6120518">return</span>&nbsp;<span class="ident" id="6120525">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6120531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6120534">if</span>&nbsp;<span class="ident" id="6120537">runtime</span><span class="op" id="6120544">.</span><span class="ident" id="6120545">GOOS</span>&nbsp;<span class="op" id="6120550">==</span>&nbsp;<span class="string" id="6120553">&#34;windows&#34;</span>&nbsp;<span class="op" id="6120563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6120567">//&nbsp;On&nbsp;Windows,&nbsp;it&#39;s&nbsp;clumsy,&nbsp;but&nbsp;we&nbsp;can&nbsp;be&nbsp;almost&nbsp;always&nbsp;correct</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6120633">//&nbsp;by&nbsp;just&nbsp;looking&nbsp;for&nbsp;a&nbsp;drive&nbsp;letter&nbsp;and&nbsp;a&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6120686">//&nbsp;Absolute&nbsp;paths&nbsp;always&nbsp;have&nbsp;a&nbsp;drive&nbsp;letter&nbsp;(ignoring&nbsp;UNC).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6120749">//&nbsp;Problem:&nbsp;if&nbsp;path&nbsp;==&nbsp;&#34;C:A&#34;&nbsp;and&nbsp;outputdir&nbsp;==&nbsp;&#34;C:\Go&#34;&nbsp;it&#39;s&nbsp;unclear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6120818">//&nbsp;what&nbsp;to&nbsp;do,&nbsp;but&nbsp;even&nbsp;then&nbsp;path/filepath&nbsp;doesn&#39;t&nbsp;help.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6120877">//&nbsp;TODO:&nbsp;Worth&nbsp;doing&nbsp;better?&nbsp;Probably&nbsp;not,&nbsp;because&nbsp;we&#39;re&nbsp;here&nbsp;only</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6120946">//&nbsp;under&nbsp;the&nbsp;management&nbsp;of&nbsp;go&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6120984">if</span>&nbsp;<span class="builtinfunc" id="6120987">len</span><span class="op" id="6120990">(</span><span class="ident" id="6120991">path</span><span class="op" id="6120995">)</span>&nbsp;<span class="op" id="6120997">&gt;=</span>&nbsp;<span class="num" id="6121000">2</span>&nbsp;<span class="op" id="6121002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6121007">letter</span><span class="op" id="6121013">,</span>&nbsp;<span class="ident" id="6121015">colon</span>&nbsp;<span class="op" id="6121021">:=</span>&nbsp;<span class="ident" id="6121024">path</span><span class="op" id="6121028">[</span><span class="num" id="6121029">0</span><span class="op" id="6121030">]</span><span class="op" id="6121031">,</span>&nbsp;<span class="ident" id="6121033">path</span><span class="op" id="6121037">[</span><span class="num" id="6121038">1</span><span class="op" id="6121039">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6121044">if</span>&nbsp;<span class="op" id="6121047">(</span><span class="string" id="6121048">&#39;a&#39;</span>&nbsp;<span class="op" id="6121052">&lt;=</span>&nbsp;<span class="ident" id="6121055">letter</span>&nbsp;<span class="op" id="6121062">&amp;&amp;</span>&nbsp;<span class="ident" id="6121065">letter</span>&nbsp;<span class="op" id="6121072">&lt;=</span>&nbsp;<span class="string" id="6121075">&#39;z&#39;</span>&nbsp;<span class="op" id="6121079">||</span>&nbsp;<span class="string" id="6121082">&#39;A&#39;</span>&nbsp;<span class="op" id="6121086">&lt;=</span>&nbsp;<span class="ident" id="6121089">letter</span>&nbsp;<span class="op" id="6121096">&amp;&amp;</span>&nbsp;<span class="ident" id="6121099">letter</span>&nbsp;<span class="op" id="6121106">&lt;=</span>&nbsp;<span class="string" id="6121109">&#39;Z&#39;</span><span class="op" id="6121112">)</span>&nbsp;<span class="op" id="6121114">&amp;&amp;</span>&nbsp;<span class="ident" id="6121117">colon</span>&nbsp;<span class="op" id="6121123">==</span>&nbsp;<span class="string" id="6121126">&#39;:&#39;</span>&nbsp;<span class="op" id="6121130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6121136">//&nbsp;If&nbsp;path&nbsp;starts&nbsp;with&nbsp;a&nbsp;drive&nbsp;letter&nbsp;we&#39;re&nbsp;stuck&nbsp;with&nbsp;it&nbsp;regardless.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6121210">return</span>&nbsp;<span class="ident" id="6121217">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6121225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6121229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6121232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6121235">if</span>&nbsp;<span class="ident" id="6121238">os</span><span class="op" id="6121240">.</span><span class="ident" id="6121241">IsPathSeparator</span><span class="op" id="6121256">(</span><span class="ident" id="6121257">path</span><span class="op" id="6121261">[</span><span class="num" id="6121262">0</span><span class="op" id="6121263">]</span><span class="op" id="6121264">)</span>&nbsp;<span class="op" id="6121266">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6121270">return</span>&nbsp;<span class="ident" id="6121277">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6121283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6121286">return</span>&nbsp;<span class="ident" id="6121293">fmt</span><span class="op" id="6121296">.</span><span class="ident" id="6121297">Sprintf</span><span class="op" id="6121304">(</span><span class="string" id="6121305">&#34;%s%c%s&#34;</span><span class="op" id="6121313">,</span>&nbsp;<span class="op" id="6121315">*</span><span class="ident" id="6121316">outputDir</span><span class="op" id="6121325">,</span>&nbsp;<span class="ident" id="6121327">os</span><span class="op" id="6121329">.</span><span class="ident" id="6121330">PathSeparator</span><span class="op" id="6121343">,</span>&nbsp;<span class="ident" id="6121345">path</span><span class="op" id="6121349">)</span><br>
<span class="lineno"></span><span class="op" id="6121351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="6121354">var</span>&nbsp;<span class="ident" id="6121358">timer</span>&nbsp;<span class="op" id="6121364">*</span><span class="ident" id="6121365">time</span><span class="op" id="6121369">.</span><span class="ident" id="6121370">Timer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6121377">//&nbsp;startAlarm&nbsp;starts&nbsp;an&nbsp;alarm&nbsp;if&nbsp;requested.</span><br>
<span class="lineno"></span><span class="keyword" id="6121421">func</span>&nbsp;<span class="ident" id="6121426">startAlarm</span><span class="op" id="6121436">(</span><span class="op" id="6121437">)</span>&nbsp;<span class="op" id="6121439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6121442">if</span>&nbsp;<span class="op" id="6121445">*</span><span class="ident" id="6121446">timeout</span>&nbsp;<span class="op" id="6121454">&gt;</span>&nbsp;<span class="num" id="6121456">0</span>&nbsp;<span class="op" id="6121458">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6121462">timer</span>&nbsp;<span class="op" id="6121468">=</span>&nbsp;<span class="ident" id="6121470">time</span><span class="op" id="6121474">.</span><span class="ident" id="6121475">AfterFunc</span><span class="op" id="6121484">(</span><span class="op" id="6121485">*</span><span class="ident" id="6121486">timeout</span><span class="op" id="6121493">,</span>&nbsp;<span class="keyword" id="6121495">func</span><span class="op" id="6121499">(</span><span class="op" id="6121500">)</span>&nbsp;<span class="op" id="6121502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6121507">panic</span><span class="op" id="6121512">(</span><span class="ident" id="6121513">fmt</span><span class="op" id="6121516">.</span><span class="ident" id="6121517">Sprintf</span><span class="op" id="6121524">(</span><span class="string" id="6121525">&#34;test&nbsp;timed&nbsp;out&nbsp;after&nbsp;%v&#34;</span><span class="op" id="6121550">,</span>&nbsp;<span class="op" id="6121552">*</span><span class="ident" id="6121553">timeout</span><span class="op" id="6121560">)</span><span class="op" id="6121561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6121565">}</span><span class="op" id="6121566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6121569">}</span><br>
<span class="lineno"></span><span class="op" id="6121571">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="comment" id="6121574">//&nbsp;stopAlarm&nbsp;turns&nbsp;off&nbsp;the&nbsp;alarm.</span><br>
<span class="lineno"></span><span class="keyword" id="6121608">func</span>&nbsp;<span class="ident" id="6121613">stopAlarm</span><span class="op" id="6121622">(</span><span class="op" id="6121623">)</span>&nbsp;<span class="op" id="6121625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6121628">if</span>&nbsp;<span class="op" id="6121631">*</span><span class="ident" id="6121632">timeout</span>&nbsp;<span class="op" id="6121640">&gt;</span>&nbsp;<span class="num" id="6121642">0</span>&nbsp;<span class="op" id="6121644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6121648">timer</span><span class="op" id="6121653">.</span><span class="ident" id="6121654">Stop</span><span class="op" id="6121658">(</span><span class="op" id="6121659">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6121662">}</span><br>
<span class="lineno"></span><span class="op" id="6121664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6121667">func</span>&nbsp;<span class="ident" id="6121672">parseCpuList</span><span class="op" id="6121684">(</span><span class="op" id="6121685">)</span>&nbsp;<span class="op" id="6121687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6121690">for</span>&nbsp;<span class="ident" id="6121694">_</span><span class="op" id="6121695">,</span>&nbsp;<span class="ident" id="6121697">val</span>&nbsp;<span class="op" id="6121701">:=</span>&nbsp;<span class="keyword" id="6121704">range</span>&nbsp;<span class="ident" id="6121710">strings</span><span class="op" id="6121717">.</span><span class="ident" id="6121718">Split</span><span class="op" id="6121723">(</span><span class="op" id="6121724">*</span><span class="ident" id="6121725">cpuListStr</span><span class="op" id="6121735">,</span>&nbsp;<span class="string" id="6121737">&#34;,&#34;</span><span class="op" id="6121740">)</span>&nbsp;<span class="op" id="6121742">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6121746">val</span>&nbsp;<span class="op" id="6121750">=</span>&nbsp;<span class="ident" id="6121752">strings</span><span class="op" id="6121759">.</span><span class="ident" id="6121760">TrimSpace</span><span class="op" id="6121769">(</span><span class="ident" id="6121770">val</span><span class="op" id="6121773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6121777">if</span>&nbsp;<span class="ident" id="6121780">val</span>&nbsp;<span class="op" id="6121784">==</span>&nbsp;<span class="string" id="6121787">&#34;&#34;</span>&nbsp;<span class="op" id="6121790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6121795">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6121806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6121810">cpu</span><span class="op" id="6121813">,</span>&nbsp;<span class="ident" id="6121815">err</span>&nbsp;<span class="op" id="6121819">:=</span>&nbsp;<span class="ident" id="6121822">strconv</span><span class="op" id="6121829">.</span><span class="ident" id="6121830">Atoi</span><span class="op" id="6121834">(</span><span class="ident" id="6121835">val</span><span class="op" id="6121838">)</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6121842">if</span>&nbsp;<span class="ident" id="6121845">err</span>&nbsp;<span class="op" id="6121849">!=</span>&nbsp;<span class="builtintype" id="6121852">nil</span>&nbsp;<span class="op" id="6121856">||</span>&nbsp;<span class="ident" id="6121859">cpu</span>&nbsp;<span class="op" id="6121863">&lt;=</span>&nbsp;<span class="num" id="6121866">0</span>&nbsp;<span class="op" id="6121868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6121873">fmt</span><span class="op" id="6121876">.</span><span class="ident" id="6121877">Fprintf</span><span class="op" id="6121884">(</span><span class="ident" id="6121885">os</span><span class="op" id="6121887">.</span><span class="ident" id="6121888">Stderr</span><span class="op" id="6121894">,</span>&nbsp;<span class="string" id="6121896">&#34;testing:&nbsp;invalid&nbsp;value&nbsp;%q&nbsp;for&nbsp;-test.cpu\n&#34;</span><span class="op" id="6121939">,</span>&nbsp;<span class="ident" id="6121941">val</span><span class="op" id="6121944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6121949">os</span><span class="op" id="6121951">.</span><span class="ident" id="6121952">Exit</span><span class="op" id="6121956">(</span><span class="num" id="6121957">1</span><span class="op" id="6121958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6121962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6121966">cpuList</span>&nbsp;<span class="op" id="6121974">=</span>&nbsp;<span class="builtinfunc" id="6121976">append</span><span class="op" id="6121982">(</span><span class="ident" id="6121983">cpuList</span><span class="op" id="6121990">,</span>&nbsp;<span class="ident" id="6121992">cpu</span><span class="op" id="6121995">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6121998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6122001">if</span>&nbsp;<span class="ident" id="6122004">cpuList</span>&nbsp;<span class="op" id="6122012">==</span>&nbsp;<span class="builtintype" id="6122015">nil</span>&nbsp;<span class="op" id="6122019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6122023">cpuList</span>&nbsp;<span class="op" id="6122031">=</span>&nbsp;<span class="builtinfunc" id="6122033">append</span><span class="op" id="6122039">(</span><span class="ident" id="6122040">cpuList</span><span class="op" id="6122047">,</span>&nbsp;<span class="ident" id="6122049">runtime</span><span class="op" id="6122056">.</span><span class="ident" id="6122057">GOMAXPROCS</span><span class="op" id="6122067">(</span><span class="op" id="6122068">-</span><span class="num" id="6122069">1</span><span class="op" id="6122070">)</span><span class="op" id="6122071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6122074">}</span><br>
<span class="lineno"></span><span class="op" id="6122076">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
