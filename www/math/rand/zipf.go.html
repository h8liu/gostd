<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2764993">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2765048">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2765102">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2765153">//&nbsp;W.Hormann,&nbsp;G.Derflinger:</span><br>
<span class="lineno"></span><span class="comment" id="2765181">//&nbsp;&#34;Rejection-Inversion&nbsp;to&nbsp;Generate&nbsp;Variates</span><br>
<span class="lineno"></span><span class="comment" id="2765226">//&nbsp;from&nbsp;Monotone&nbsp;Discrete&nbsp;Distributions&#34;</span><br>
<span class="lineno"></span><span class="comment" id="2765267">//&nbsp;http://eeyore.wu-wien.ac.at/papers/96-04-04.wh-der.ps.gz</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2765328">package</span>&nbsp;<span class="ident" id="2765336">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2765342">import</span>&nbsp;<span class="string" id="2765349">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2765357">//&nbsp;A&nbsp;Zipf&nbsp;generates&nbsp;Zipf&nbsp;distributed&nbsp;variates.</span><br>
<span class="lineno">15</span><span class="keyword" id="2765404">type</span>&nbsp;<span class="ident" id="2765409">Zipf</span>&nbsp;<span class="keyword" id="2765414">struct</span>&nbsp;<span class="op" id="2765421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2765424">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2765437">*</span><span class="ident" id="2765438"><a href="/math/rand/rand.go.html#2743488">Rand</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2765444">imax</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2765457">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2765466">v</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2765479">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2765488">q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2765501">float64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2765510">s</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2765523">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2765532">oneminusQ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2765545">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2765554">oneminusQinv</span>&nbsp;<span class="builtintype" id="2765567">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2765576">hxm</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2765589">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2765598">hx0minusHxm</span>&nbsp;&nbsp;<span class="builtintype" id="2765611">float64</span><br>
<span class="lineno">25</span><span class="op" id="2765619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2765622">func</span>&nbsp;<span class="op" id="2765627">(</span><span class="ident" id="2765628">z</span>&nbsp;<span class="op" id="2765630">*</span><span class="ident" id="2765631"><a href="/math/rand/zipf.go.html#2765409">Zipf</a></span><span class="op" id="2765635">)</span>&nbsp;<span class="ident" id="2765637">h</span><span class="op" id="2765638">(</span><span class="ident" id="2765639">x</span>&nbsp;<span class="builtintype" id="2765641">float64</span><span class="op" id="2765648">)</span>&nbsp;<span class="builtintype" id="2765650">float64</span>&nbsp;<span class="op" id="2765658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2765661">return</span>&nbsp;<span class="ident" id="2765668"><a href="/math/rand/zipf.go.html#2765349">math</a></span><span class="op" id="2765672">.</span><span class="ident" id="2765673">Exp</span><span class="op" id="2765676">(</span><span class="ident" id="2765677"><a href="/math/rand/zipf.go.html#2765628">z</a></span><span class="op" id="2765678">.</span><span class="ident" id="2765679">oneminusQ</span><span class="op" id="2765688">*</span><span class="ident" id="2765689"><a href="/math/rand/zipf.go.html#2765349">math</a></span><span class="op" id="2765693">.</span><span class="ident" id="2765694">Log</span><span class="op" id="2765697">(</span><span class="ident" id="2765698"><a href="/math/rand/zipf.go.html#2765628">z</a></span><span class="op" id="2765699">.</span><span class="ident" id="2765700">v</span><span class="op" id="2765701">+</span><span class="ident" id="2765702"><a href="/math/rand/zipf.go.html#2765639">x</a></span><span class="op" id="2765703">)</span><span class="op" id="2765704">)</span>&nbsp;<span class="op" id="2765706">*</span>&nbsp;<span class="ident" id="2765708"><a href="/math/rand/zipf.go.html#2765628">z</a></span><span class="op" id="2765709">.</span><span class="ident" id="2765710">oneminusQinv</span><br>
<span class="lineno"></span><span class="op" id="2765723">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="2765726">func</span>&nbsp;<span class="op" id="2765731">(</span><span class="ident" id="2765732">z</span>&nbsp;<span class="op" id="2765734">*</span><span class="ident" id="2765735"><a href="/math/rand/zipf.go.html#2765409">Zipf</a></span><span class="op" id="2765739">)</span>&nbsp;<span class="ident" id="2765741">hinv</span><span class="op" id="2765745">(</span><span class="ident" id="2765746">x</span>&nbsp;<span class="builtintype" id="2765748">float64</span><span class="op" id="2765755">)</span>&nbsp;<span class="builtintype" id="2765757">float64</span>&nbsp;<span class="op" id="2765765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2765768">return</span>&nbsp;<span class="ident" id="2765775"><a href="/math/rand/zipf.go.html#2765349">math</a></span><span class="op" id="2765779">.</span><span class="ident" id="2765780">Exp</span><span class="op" id="2765783">(</span><span class="ident" id="2765784"><a href="/math/rand/zipf.go.html#2765732">z</a></span><span class="op" id="2765785">.</span><span class="ident" id="2765786">oneminusQinv</span><span class="op" id="2765798">*</span><span class="ident" id="2765799"><a href="/math/rand/zipf.go.html#2765349">math</a></span><span class="op" id="2765803">.</span><span class="ident" id="2765804">Log</span><span class="op" id="2765807">(</span><span class="ident" id="2765808"><a href="/math/rand/zipf.go.html#2765732">z</a></span><span class="op" id="2765809">.</span><span class="ident" id="2765810">oneminusQ</span><span class="op" id="2765819">*</span><span class="ident" id="2765820"><a href="/math/rand/zipf.go.html#2765746">x</a></span><span class="op" id="2765821">)</span><span class="op" id="2765822">)</span>&nbsp;<span class="op" id="2765824">-</span>&nbsp;<span class="ident" id="2765826"><a href="/math/rand/zipf.go.html#2765732">z</a></span><span class="op" id="2765827">.</span><span class="ident" id="2765828">v</span><br>
<span class="lineno"></span><span class="op" id="2765830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="2765833">//&nbsp;NewZipf&nbsp;returns&nbsp;a&nbsp;Zipf&nbsp;generating&nbsp;variates&nbsp;p(k)&nbsp;on&nbsp;[0,&nbsp;imax]</span><br>
<span class="lineno"></span><span class="comment" id="2765897">//&nbsp;proportional&nbsp;to&nbsp;(v+k)**(-s)&nbsp;where&nbsp;s&gt;1&nbsp;and&nbsp;k&gt;=0,&nbsp;and&nbsp;v&gt;=1.</span><br>
<span class="lineno"></span><span class="keyword" id="2765958">func</span>&nbsp;<span class="ident" id="2765963">NewZipf</span><span class="op" id="2765970">(</span><span class="ident" id="2765971">r</span>&nbsp;<span class="op" id="2765973">*</span><span class="ident" id="2765974"><a href="/math/rand/rand.go.html#2743488">Rand</a></span><span class="op" id="2765978">,</span>&nbsp;<span class="ident" id="2765980">s</span>&nbsp;<span class="builtintype" id="2765982">float64</span><span class="op" id="2765989">,</span>&nbsp;<span class="ident" id="2765991">v</span>&nbsp;<span class="builtintype" id="2765993">float64</span><span class="op" id="2766000">,</span>&nbsp;<span class="ident" id="2766002">imax</span>&nbsp;<span class="ident" id="2766007">uint64</span><span class="op" id="2766013">)</span>&nbsp;<span class="op" id="2766015">*</span><span class="ident" id="2766016"><a href="/math/rand/zipf.go.html#2765409">Zipf</a></span>&nbsp;<span class="op" id="2766021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766024">z</span>&nbsp;<span class="op" id="2766026">:=</span>&nbsp;<span class="builtinfunc" id="2766029">new</span><span class="op" id="2766032">(</span><span class="ident" id="2766033"><a href="/math/rand/zipf.go.html#2765409">Zipf</a></span><span class="op" id="2766037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766040">if</span>&nbsp;<span class="ident" id="2766043"><a href="/math/rand/zipf.go.html#2765980">s</a></span>&nbsp;<span class="op" id="2766045">&lt;=</span>&nbsp;<span class="num" id="2766048">1.0</span>&nbsp;<span class="op" id="2766052">||</span>&nbsp;<span class="ident" id="2766055"><a href="/math/rand/zipf.go.html#2765991">v</a></span>&nbsp;<span class="op" id="2766057">&lt;</span>&nbsp;<span class="num" id="2766059">1</span>&nbsp;<span class="op" id="2766061">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766065">return</span>&nbsp;<span class="ident" id="2766072">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2766077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766080"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766081">.</span><span class="ident" id="2766082">r</span>&nbsp;<span class="op" id="2766084">=</span>&nbsp;<span class="ident" id="2766086"><a href="/math/rand/zipf.go.html#2765971">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766089"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766090">.</span><span class="ident" id="2766091">imax</span>&nbsp;<span class="op" id="2766096">=</span>&nbsp;<span class="builtintype" id="2766098">float64</span><span class="op" id="2766105">(</span><span class="ident" id="2766106"><a href="/math/rand/zipf.go.html#2766002">imax</a></span><span class="op" id="2766110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766113"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766114">.</span><span class="ident" id="2766115">v</span>&nbsp;<span class="op" id="2766117">=</span>&nbsp;<span class="ident" id="2766119"><a href="/math/rand/zipf.go.html#2765991">v</a></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766122"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766123">.</span><span class="ident" id="2766124">q</span>&nbsp;<span class="op" id="2766126">=</span>&nbsp;<span class="ident" id="2766128"><a href="/math/rand/zipf.go.html#2765980">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766131"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766132">.</span><span class="ident" id="2766133">oneminusQ</span>&nbsp;<span class="op" id="2766143">=</span>&nbsp;<span class="num" id="2766145">1.0</span>&nbsp;<span class="op" id="2766149">-</span>&nbsp;<span class="ident" id="2766151"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766152">.</span><span class="ident" id="2766153">q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766156"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766157">.</span><span class="ident" id="2766158">oneminusQinv</span>&nbsp;<span class="op" id="2766171">=</span>&nbsp;<span class="num" id="2766173">1.0</span>&nbsp;<span class="op" id="2766177">/</span>&nbsp;<span class="ident" id="2766179"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766180">.</span><span class="ident" id="2766181">oneminusQ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766192"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766193">.</span><span class="ident" id="2766194">hxm</span>&nbsp;<span class="op" id="2766198">=</span>&nbsp;<span class="ident" id="2766200"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766201">.</span><span class="ident" id="2766202">h</span><span class="op" id="2766203">(</span><span class="ident" id="2766204"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766205">.</span><span class="ident" id="2766206">imax</span>&nbsp;<span class="op" id="2766211">+</span>&nbsp;<span class="num" id="2766213">0.5</span><span class="op" id="2766216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766219"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766220">.</span><span class="ident" id="2766221">hx0minusHxm</span>&nbsp;<span class="op" id="2766233">=</span>&nbsp;<span class="ident" id="2766235"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766236">.</span><span class="ident" id="2766237">h</span><span class="op" id="2766238">(</span><span class="num" id="2766239">0.5</span><span class="op" id="2766242">)</span>&nbsp;<span class="op" id="2766244">-</span>&nbsp;<span class="ident" id="2766246"><a href="/math/rand/zipf.go.html#2765349">math</a></span><span class="op" id="2766250">.</span><span class="ident" id="2766251">Exp</span><span class="op" id="2766254">(</span><span class="ident" id="2766255"><a href="/math/rand/zipf.go.html#2765349">math</a></span><span class="op" id="2766259">.</span><span class="ident" id="2766260">Log</span><span class="op" id="2766263">(</span><span class="ident" id="2766264"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766265">.</span><span class="ident" id="2766266">v</span><span class="op" id="2766267">)</span><span class="op" id="2766268">*</span><span class="op" id="2766269">(</span><span class="op" id="2766270">-</span><span class="ident" id="2766271"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766272">.</span><span class="ident" id="2766273">q</span><span class="op" id="2766274">)</span><span class="op" id="2766275">)</span>&nbsp;<span class="op" id="2766277">-</span>&nbsp;<span class="ident" id="2766279"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766280">.</span><span class="ident" id="2766281">hxm</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766286"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766287">.</span><span class="ident" id="2766288">s</span>&nbsp;<span class="op" id="2766290">=</span>&nbsp;<span class="num" id="2766292">1</span>&nbsp;<span class="op" id="2766294">-</span>&nbsp;<span class="ident" id="2766296"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766297">.</span><span class="ident" id="2766298">hinv</span><span class="op" id="2766302">(</span><span class="ident" id="2766303"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766304">.</span><span class="ident" id="2766305">h</span><span class="op" id="2766306">(</span><span class="num" id="2766307">1.5</span><span class="op" id="2766310">)</span><span class="op" id="2766311">-</span><span class="ident" id="2766312"><a href="/math/rand/zipf.go.html#2765349">math</a></span><span class="op" id="2766316">.</span><span class="ident" id="2766317">Exp</span><span class="op" id="2766320">(</span><span class="op" id="2766321">-</span><span class="ident" id="2766322"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766323">.</span><span class="ident" id="2766324">q</span><span class="op" id="2766325">*</span><span class="ident" id="2766326"><a href="/math/rand/zipf.go.html#2765349">math</a></span><span class="op" id="2766330">.</span><span class="ident" id="2766331">Log</span><span class="op" id="2766334">(</span><span class="ident" id="2766335"><a href="/math/rand/zipf.go.html#2766024">z</a></span><span class="op" id="2766336">.</span><span class="ident" id="2766337">v</span><span class="op" id="2766338">+</span><span class="num" id="2766339">1.0</span><span class="op" id="2766342">)</span><span class="op" id="2766343">)</span><span class="op" id="2766344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766347">return</span>&nbsp;<span class="ident" id="2766354"><a href="/math/rand/zipf.go.html#2766024">z</a></span><br>
<span class="lineno"></span><span class="op" id="2766356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2766359">//&nbsp;Uint64&nbsp;returns&nbsp;a&nbsp;value&nbsp;drawn&nbsp;from&nbsp;the&nbsp;Zipf&nbsp;distribution&nbsp;described</span><br>
<span class="lineno">55</span><span class="comment" id="2766428">//&nbsp;by&nbsp;the&nbsp;Zipf&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="2766451">func</span>&nbsp;<span class="op" id="2766456">(</span><span class="ident" id="2766457">z</span>&nbsp;<span class="op" id="2766459">*</span><span class="ident" id="2766460"><a href="/math/rand/zipf.go.html#2765409">Zipf</a></span><span class="op" id="2766464">)</span>&nbsp;<span class="ident" id="2766466">Uint64</span><span class="op" id="2766472">(</span><span class="op" id="2766473">)</span>&nbsp;<span class="ident" id="2766475">uint64</span>&nbsp;<span class="op" id="2766482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766485">if</span>&nbsp;<span class="ident" id="2766488"><a href="/math/rand/zipf.go.html#2766457">z</a></span>&nbsp;<span class="op" id="2766490">==</span>&nbsp;<span class="ident" id="2766493">nil</span>&nbsp;<span class="op" id="2766497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2766501">panic</span><span class="op" id="2766506">(</span><span class="string" id="2766507">&#34;rand:&nbsp;nil&nbsp;Zipf&#34;</span><span class="op" id="2766523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2766526">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766529">k</span>&nbsp;<span class="op" id="2766531">:=</span>&nbsp;<span class="num" id="2766534">0.0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766540">for</span>&nbsp;<span class="op" id="2766544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766548">r</span>&nbsp;<span class="op" id="2766550">:=</span>&nbsp;<span class="ident" id="2766553"><a href="/math/rand/zipf.go.html#2766457">z</a></span><span class="op" id="2766554">.</span><span class="ident" id="2766555">r</span><span class="op" id="2766556">.</span><span class="ident" id="2766557">Float64</span><span class="op" id="2766564">(</span><span class="op" id="2766565">)</span>&nbsp;<span class="comment" id="2766567">//&nbsp;r&nbsp;on&nbsp;[0,1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766583">ur</span>&nbsp;<span class="op" id="2766586">:=</span>&nbsp;<span class="ident" id="2766589"><a href="/math/rand/zipf.go.html#2766457">z</a></span><span class="op" id="2766590">.</span><span class="ident" id="2766591">hxm</span>&nbsp;<span class="op" id="2766595">+</span>&nbsp;<span class="ident" id="2766597"><a href="/math/rand/zipf.go.html#2766548">r</a></span><span class="op" id="2766598">*</span><span class="ident" id="2766599"><a href="/math/rand/zipf.go.html#2766457">z</a></span><span class="op" id="2766600">.</span><span class="ident" id="2766601">hx0minusHxm</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766615">x</span>&nbsp;<span class="op" id="2766617">:=</span>&nbsp;<span class="ident" id="2766620"><a href="/math/rand/zipf.go.html#2766457">z</a></span><span class="op" id="2766621">.</span><span class="ident" id="2766622">hinv</span><span class="op" id="2766626">(</span><span class="ident" id="2766627"><a href="/math/rand/zipf.go.html#2766583">ur</a></span><span class="op" id="2766629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2766633"><a href="/math/rand/zipf.go.html#2766529">k</a></span>&nbsp;<span class="op" id="2766635">=</span>&nbsp;<span class="ident" id="2766637"><a href="/math/rand/zipf.go.html#2765349">math</a></span><span class="op" id="2766641">.</span><span class="ident" id="2766642">Floor</span><span class="op" id="2766647">(</span><span class="ident" id="2766648"><a href="/math/rand/zipf.go.html#2766615">x</a></span>&nbsp;<span class="op" id="2766650">+</span>&nbsp;<span class="num" id="2766652">0.5</span><span class="op" id="2766655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766659">if</span>&nbsp;<span class="ident" id="2766662"><a href="/math/rand/zipf.go.html#2766529">k</a></span><span class="op" id="2766663">-</span><span class="ident" id="2766664"><a href="/math/rand/zipf.go.html#2766615">x</a></span>&nbsp;<span class="op" id="2766666">&lt;=</span>&nbsp;<span class="ident" id="2766669"><a href="/math/rand/zipf.go.html#2766457">z</a></span><span class="op" id="2766670">.</span><span class="ident" id="2766671">s</span>&nbsp;<span class="op" id="2766673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766678">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2766686">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766690">if</span>&nbsp;<span class="ident" id="2766693"><a href="/math/rand/zipf.go.html#2766583">ur</a></span>&nbsp;<span class="op" id="2766696">&gt;=</span>&nbsp;<span class="ident" id="2766699"><a href="/math/rand/zipf.go.html#2766457">z</a></span><span class="op" id="2766700">.</span><span class="ident" id="2766701">h</span><span class="op" id="2766702">(</span><span class="ident" id="2766703"><a href="/math/rand/zipf.go.html#2766529">k</a></span><span class="op" id="2766704">+</span><span class="num" id="2766705">0.5</span><span class="op" id="2766708">)</span><span class="op" id="2766709">-</span><span class="ident" id="2766710"><a href="/math/rand/zipf.go.html#2765349">math</a></span><span class="op" id="2766714">.</span><span class="ident" id="2766715">Exp</span><span class="op" id="2766718">(</span><span class="op" id="2766719">-</span><span class="ident" id="2766720"><a href="/math/rand/zipf.go.html#2765349">math</a></span><span class="op" id="2766724">.</span><span class="ident" id="2766725">Log</span><span class="op" id="2766728">(</span><span class="ident" id="2766729"><a href="/math/rand/zipf.go.html#2766529">k</a></span><span class="op" id="2766730">+</span><span class="ident" id="2766731"><a href="/math/rand/zipf.go.html#2766457">z</a></span><span class="op" id="2766732">.</span><span class="ident" id="2766733">v</span><span class="op" id="2766734">)</span><span class="op" id="2766735">*</span><span class="ident" id="2766736"><a href="/math/rand/zipf.go.html#2766457">z</a></span><span class="op" id="2766737">.</span><span class="ident" id="2766738">q</span><span class="op" id="2766739">)</span>&nbsp;<span class="op" id="2766741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766746">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2766754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2766757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2766760">return</span>&nbsp;<span class="ident" id="2766767">uint64</span><span class="op" id="2766773">(</span><span class="ident" id="2766774"><a href="/math/rand/zipf.go.html#2766529">k</a></span><span class="op" id="2766775">)</span><br>
<span class="lineno">75</span><span class="op" id="2766777">}</span>
</div>
</body>
</html>
