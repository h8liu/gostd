<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8109509">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8109564">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8109618">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8109669">package</span>&nbsp;<span class="ident" id="8109677">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8109682">import</span>&nbsp;<span class="op" id="8109689">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8109692">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8109702">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="8109705">func</span>&nbsp;<span class="ident" id="8109710">TestRoundUp</span><span class="op" id="8109721">(</span><span class="ident" id="8109722">t</span>&nbsp;<span class="op" id="8109724">*</span><span class="ident" id="8109725">testing</span><span class="op" id="8109732">.</span><span class="ident" id="8109733">T</span><span class="op" id="8109734">)</span>&nbsp;<span class="op" id="8109736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8109739">if</span>&nbsp;<span class="ident" id="8109742">roundUp</span><span class="op" id="8109749">(</span><span class="num" id="8109750">0</span><span class="op" id="8109751">,</span>&nbsp;<span class="num" id="8109753">16</span><span class="op" id="8109755">)</span>&nbsp;<span class="op" id="8109757">!=</span>&nbsp;<span class="num" id="8109760">0</span>&nbsp;<span class="op" id="8109762">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109767">roundUp</span><span class="op" id="8109774">(</span><span class="num" id="8109775">1</span><span class="op" id="8109776">,</span>&nbsp;<span class="num" id="8109778">16</span><span class="op" id="8109780">)</span>&nbsp;<span class="op" id="8109782">!=</span>&nbsp;<span class="num" id="8109785">16</span>&nbsp;<span class="op" id="8109788">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109793">roundUp</span><span class="op" id="8109800">(</span><span class="num" id="8109801">15</span><span class="op" id="8109803">,</span>&nbsp;<span class="num" id="8109805">16</span><span class="op" id="8109807">)</span>&nbsp;<span class="op" id="8109809">!=</span>&nbsp;<span class="num" id="8109812">16</span>&nbsp;<span class="op" id="8109815">||</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109820">roundUp</span><span class="op" id="8109827">(</span><span class="num" id="8109828">16</span><span class="op" id="8109830">,</span>&nbsp;<span class="num" id="8109832">16</span><span class="op" id="8109834">)</span>&nbsp;<span class="op" id="8109836">!=</span>&nbsp;<span class="num" id="8109839">16</span>&nbsp;<span class="op" id="8109842">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109847">roundUp</span><span class="op" id="8109854">(</span><span class="num" id="8109855">17</span><span class="op" id="8109857">,</span>&nbsp;<span class="num" id="8109859">16</span><span class="op" id="8109861">)</span>&nbsp;<span class="op" id="8109863">!=</span>&nbsp;<span class="num" id="8109866">32</span>&nbsp;<span class="op" id="8109869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109873">t</span><span class="op" id="8109874">.</span><span class="ident" id="8109875">Error</span><span class="op" id="8109880">(</span><span class="string" id="8109881">&#34;roundUp&nbsp;broken&#34;</span><span class="op" id="8109897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8109900">}</span><br>
<span class="lineno"></span><span class="op" id="8109902">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="8109905">var</span>&nbsp;<span class="ident" id="8109909">paddingTests</span>&nbsp;<span class="op" id="8109922">=</span>&nbsp;<span class="op" id="8109924">[</span><span class="op" id="8109925">]</span><span class="keyword" id="8109926">struct</span>&nbsp;<span class="op" id="8109933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109936">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8109948">[</span><span class="op" id="8109949">]</span><span class="builtintype" id="8109950">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109956">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8109968">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8109974">expectedLen</span>&nbsp;<span class="builtintype" id="8109986">int</span><br>
<span class="lineno">25</span><span class="op" id="8109990">}</span><span class="op" id="8109991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8109994">{</span><span class="op" id="8109995">[</span><span class="op" id="8109996">]</span><span class="builtintype" id="8109997">byte</span><span class="op" id="8110001">{</span><span class="num" id="8110002">1</span><span class="op" id="8110003">,</span>&nbsp;<span class="num" id="8110005">2</span><span class="op" id="8110006">,</span>&nbsp;<span class="num" id="8110008">3</span><span class="op" id="8110009">,</span>&nbsp;<span class="num" id="8110011">4</span><span class="op" id="8110012">,</span>&nbsp;<span class="num" id="8110014">0</span><span class="op" id="8110015">}</span><span class="op" id="8110016">,</span>&nbsp;<span class="builtintype" id="8110018">true</span><span class="op" id="8110022">,</span>&nbsp;<span class="num" id="8110024">4</span><span class="op" id="8110025">}</span><span class="op" id="8110026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8110029">{</span><span class="op" id="8110030">[</span><span class="op" id="8110031">]</span><span class="builtintype" id="8110032">byte</span><span class="op" id="8110036">{</span><span class="num" id="8110037">1</span><span class="op" id="8110038">,</span>&nbsp;<span class="num" id="8110040">2</span><span class="op" id="8110041">,</span>&nbsp;<span class="num" id="8110043">3</span><span class="op" id="8110044">,</span>&nbsp;<span class="num" id="8110046">4</span><span class="op" id="8110047">,</span>&nbsp;<span class="num" id="8110049">0</span><span class="op" id="8110050">,</span>&nbsp;<span class="num" id="8110052">1</span><span class="op" id="8110053">}</span><span class="op" id="8110054">,</span>&nbsp;<span class="builtintype" id="8110056">false</span><span class="op" id="8110061">,</span>&nbsp;<span class="num" id="8110063">0</span><span class="op" id="8110064">}</span><span class="op" id="8110065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8110068">{</span><span class="op" id="8110069">[</span><span class="op" id="8110070">]</span><span class="builtintype" id="8110071">byte</span><span class="op" id="8110075">{</span><span class="num" id="8110076">1</span><span class="op" id="8110077">,</span>&nbsp;<span class="num" id="8110079">2</span><span class="op" id="8110080">,</span>&nbsp;<span class="num" id="8110082">3</span><span class="op" id="8110083">,</span>&nbsp;<span class="num" id="8110085">4</span><span class="op" id="8110086">,</span>&nbsp;<span class="num" id="8110088">99</span><span class="op" id="8110090">,</span>&nbsp;<span class="num" id="8110092">99</span><span class="op" id="8110094">}</span><span class="op" id="8110095">,</span>&nbsp;<span class="builtintype" id="8110097">false</span><span class="op" id="8110102">,</span>&nbsp;<span class="num" id="8110104">0</span><span class="op" id="8110105">}</span><span class="op" id="8110106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8110109">{</span><span class="op" id="8110110">[</span><span class="op" id="8110111">]</span><span class="builtintype" id="8110112">byte</span><span class="op" id="8110116">{</span><span class="num" id="8110117">1</span><span class="op" id="8110118">,</span>&nbsp;<span class="num" id="8110120">2</span><span class="op" id="8110121">,</span>&nbsp;<span class="num" id="8110123">3</span><span class="op" id="8110124">,</span>&nbsp;<span class="num" id="8110126">4</span><span class="op" id="8110127">,</span>&nbsp;<span class="num" id="8110129">1</span><span class="op" id="8110130">,</span>&nbsp;<span class="num" id="8110132">1</span><span class="op" id="8110133">}</span><span class="op" id="8110134">,</span>&nbsp;<span class="builtintype" id="8110136">true</span><span class="op" id="8110140">,</span>&nbsp;<span class="num" id="8110142">4</span><span class="op" id="8110143">}</span><span class="op" id="8110144">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8110147">{</span><span class="op" id="8110148">[</span><span class="op" id="8110149">]</span><span class="builtintype" id="8110150">byte</span><span class="op" id="8110154">{</span><span class="num" id="8110155">1</span><span class="op" id="8110156">,</span>&nbsp;<span class="num" id="8110158">2</span><span class="op" id="8110159">,</span>&nbsp;<span class="num" id="8110161">3</span><span class="op" id="8110162">,</span>&nbsp;<span class="num" id="8110164">2</span><span class="op" id="8110165">,</span>&nbsp;<span class="num" id="8110167">2</span><span class="op" id="8110168">,</span>&nbsp;<span class="num" id="8110170">2</span><span class="op" id="8110171">}</span><span class="op" id="8110172">,</span>&nbsp;<span class="builtintype" id="8110174">true</span><span class="op" id="8110178">,</span>&nbsp;<span class="num" id="8110180">3</span><span class="op" id="8110181">}</span><span class="op" id="8110182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8110185">{</span><span class="op" id="8110186">[</span><span class="op" id="8110187">]</span><span class="builtintype" id="8110188">byte</span><span class="op" id="8110192">{</span><span class="num" id="8110193">1</span><span class="op" id="8110194">,</span>&nbsp;<span class="num" id="8110196">2</span><span class="op" id="8110197">,</span>&nbsp;<span class="num" id="8110199">3</span><span class="op" id="8110200">,</span>&nbsp;<span class="num" id="8110202">3</span><span class="op" id="8110203">,</span>&nbsp;<span class="num" id="8110205">3</span><span class="op" id="8110206">,</span>&nbsp;<span class="num" id="8110208">3</span><span class="op" id="8110209">}</span><span class="op" id="8110210">,</span>&nbsp;<span class="builtintype" id="8110212">true</span><span class="op" id="8110216">,</span>&nbsp;<span class="num" id="8110218">2</span><span class="op" id="8110219">}</span><span class="op" id="8110220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8110223">{</span><span class="op" id="8110224">[</span><span class="op" id="8110225">]</span><span class="builtintype" id="8110226">byte</span><span class="op" id="8110230">{</span><span class="num" id="8110231">1</span><span class="op" id="8110232">,</span>&nbsp;<span class="num" id="8110234">2</span><span class="op" id="8110235">,</span>&nbsp;<span class="num" id="8110237">3</span><span class="op" id="8110238">,</span>&nbsp;<span class="num" id="8110240">4</span><span class="op" id="8110241">,</span>&nbsp;<span class="num" id="8110243">3</span><span class="op" id="8110244">,</span>&nbsp;<span class="num" id="8110246">3</span><span class="op" id="8110247">}</span><span class="op" id="8110248">,</span>&nbsp;<span class="builtintype" id="8110250">false</span><span class="op" id="8110255">,</span>&nbsp;<span class="num" id="8110257">0</span><span class="op" id="8110258">}</span><span class="op" id="8110259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8110262">{</span><span class="op" id="8110263">[</span><span class="op" id="8110264">]</span><span class="builtintype" id="8110265">byte</span><span class="op" id="8110269">{</span><span class="num" id="8110270">1</span><span class="op" id="8110271">,</span>&nbsp;<span class="num" id="8110273">4</span><span class="op" id="8110274">,</span>&nbsp;<span class="num" id="8110276">4</span><span class="op" id="8110277">,</span>&nbsp;<span class="num" id="8110279">4</span><span class="op" id="8110280">,</span>&nbsp;<span class="num" id="8110282">4</span><span class="op" id="8110283">,</span>&nbsp;<span class="num" id="8110285">4</span><span class="op" id="8110286">}</span><span class="op" id="8110287">,</span>&nbsp;<span class="builtintype" id="8110289">true</span><span class="op" id="8110293">,</span>&nbsp;<span class="num" id="8110295">1</span><span class="op" id="8110296">}</span><span class="op" id="8110297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8110300">{</span><span class="op" id="8110301">[</span><span class="op" id="8110302">]</span><span class="builtintype" id="8110303">byte</span><span class="op" id="8110307">{</span><span class="num" id="8110308">5</span><span class="op" id="8110309">,</span>&nbsp;<span class="num" id="8110311">5</span><span class="op" id="8110312">,</span>&nbsp;<span class="num" id="8110314">5</span><span class="op" id="8110315">,</span>&nbsp;<span class="num" id="8110317">5</span><span class="op" id="8110318">,</span>&nbsp;<span class="num" id="8110320">5</span><span class="op" id="8110321">,</span>&nbsp;<span class="num" id="8110323">5</span><span class="op" id="8110324">}</span><span class="op" id="8110325">,</span>&nbsp;<span class="builtintype" id="8110327">true</span><span class="op" id="8110331">,</span>&nbsp;<span class="num" id="8110333">0</span><span class="op" id="8110334">}</span><span class="op" id="8110335">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8110338">{</span><span class="op" id="8110339">[</span><span class="op" id="8110340">]</span><span class="builtintype" id="8110341">byte</span><span class="op" id="8110345">{</span><span class="num" id="8110346">6</span><span class="op" id="8110347">,</span>&nbsp;<span class="num" id="8110349">6</span><span class="op" id="8110350">,</span>&nbsp;<span class="num" id="8110352">6</span><span class="op" id="8110353">,</span>&nbsp;<span class="num" id="8110355">6</span><span class="op" id="8110356">,</span>&nbsp;<span class="num" id="8110358">6</span><span class="op" id="8110359">,</span>&nbsp;<span class="num" id="8110361">6</span><span class="op" id="8110362">}</span><span class="op" id="8110363">,</span>&nbsp;<span class="builtintype" id="8110365">false</span><span class="op" id="8110370">,</span>&nbsp;<span class="num" id="8110372">0</span><span class="op" id="8110373">}</span><span class="op" id="8110374">,</span><br>
<span class="lineno"></span><span class="op" id="8110376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8110379">func</span>&nbsp;<span class="ident" id="8110384">TestRemovePadding</span><span class="op" id="8110401">(</span><span class="ident" id="8110402">t</span>&nbsp;<span class="op" id="8110404">*</span><span class="ident" id="8110405">testing</span><span class="op" id="8110412">.</span><span class="ident" id="8110413">T</span><span class="op" id="8110414">)</span>&nbsp;<span class="op" id="8110416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8110419">for</span>&nbsp;<span class="ident" id="8110423">i</span><span class="op" id="8110424">,</span>&nbsp;<span class="ident" id="8110426">test</span>&nbsp;<span class="op" id="8110431">:=</span>&nbsp;<span class="keyword" id="8110434">range</span>&nbsp;<span class="ident" id="8110440">paddingTests</span>&nbsp;<span class="op" id="8110453">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8110457">payload</span><span class="op" id="8110464">,</span>&nbsp;<span class="ident" id="8110466">good</span>&nbsp;<span class="op" id="8110471">:=</span>&nbsp;<span class="ident" id="8110474">removePadding</span><span class="op" id="8110487">(</span><span class="ident" id="8110488">test</span><span class="op" id="8110492">.</span><span class="ident" id="8110493">in</span><span class="op" id="8110495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8110499">expectedGood</span>&nbsp;<span class="op" id="8110512">:=</span>&nbsp;<span class="builtintype" id="8110515">byte</span><span class="op" id="8110519">(</span><span class="num" id="8110520">255</span><span class="op" id="8110523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8110527">if</span>&nbsp;<span class="op" id="8110530">!</span><span class="ident" id="8110531">test</span><span class="op" id="8110535">.</span><span class="ident" id="8110536">good</span>&nbsp;<span class="op" id="8110541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8110546">expectedGood</span>&nbsp;<span class="op" id="8110559">=</span>&nbsp;<span class="num" id="8110561">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8110565">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8110569">if</span>&nbsp;<span class="ident" id="8110572">good</span>&nbsp;<span class="op" id="8110577">!=</span>&nbsp;<span class="ident" id="8110580">expectedGood</span>&nbsp;<span class="op" id="8110593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8110598">t</span><span class="op" id="8110599">.</span><span class="ident" id="8110600">Errorf</span><span class="op" id="8110606">(</span><span class="string" id="8110607">&#34;#%d:&nbsp;wrong&nbsp;validity,&nbsp;want:%d&nbsp;got:%d&#34;</span><span class="op" id="8110644">,</span>&nbsp;<span class="ident" id="8110646">i</span><span class="op" id="8110647">,</span>&nbsp;<span class="ident" id="8110649">expectedGood</span><span class="op" id="8110661">,</span>&nbsp;<span class="ident" id="8110663">good</span><span class="op" id="8110667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8110671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8110675">if</span>&nbsp;<span class="ident" id="8110678">good</span>&nbsp;<span class="op" id="8110683">==</span>&nbsp;<span class="num" id="8110686">255</span>&nbsp;<span class="op" id="8110690">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="8110693">len</span><span class="op" id="8110696">(</span><span class="ident" id="8110697">payload</span><span class="op" id="8110704">)</span>&nbsp;<span class="op" id="8110706">!=</span>&nbsp;<span class="ident" id="8110709">test</span><span class="op" id="8110713">.</span><span class="ident" id="8110714">expectedLen</span>&nbsp;<span class="op" id="8110726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8110731">t</span><span class="op" id="8110732">.</span><span class="ident" id="8110733">Errorf</span><span class="op" id="8110739">(</span><span class="string" id="8110740">&#34;#%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8110762">,</span>&nbsp;<span class="ident" id="8110764">i</span><span class="op" id="8110765">,</span>&nbsp;<span class="builtinfunc" id="8110767">len</span><span class="op" id="8110770">(</span><span class="ident" id="8110771">payload</span><span class="op" id="8110778">)</span><span class="op" id="8110779">,</span>&nbsp;<span class="ident" id="8110781">test</span><span class="op" id="8110785">.</span><span class="ident" id="8110786">expectedLen</span><span class="op" id="8110797">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8110801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8110804">}</span><br>
<span class="lineno"></span><span class="op" id="8110806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8110809">var</span>&nbsp;<span class="ident" id="8110813">certExampleCom</span>&nbsp;<span class="op" id="8110828">=</span>&nbsp;<span class="string" id="8110830">`308201403081eda003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313138353835325a170d3132303933303138353835325a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31a301830160603551d11040f300d820b6578616d706c652e636f6d300b06092a864886f70d0101050341001a0b419d2c74474c6450654e5f10b32bf426ffdf55cad1c52602e7a9151513a3424c70f5960dcd682db0c33769cc1daa3fcdd3db10809d2392ed4a1bf50ced18`</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="8111482">var</span>&nbsp;<span class="ident" id="8111486">certWildcardExampleCom</span>&nbsp;<span class="op" id="8111509">=</span>&nbsp;<span class="string" id="8111511">`308201423081efa003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303034365a170d3132303933303139303034365a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31c301a30180603551d110411300f820d2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001676f0c9e7c33c1b656ed5a6476c4e2ee9ec8e62df7407accb1875272b2edd0a22096cb2c22598d11604104d604f810eb4b5987ca6bb319c7e6ce48725c54059`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8112167">var</span>&nbsp;<span class="ident" id="8112171">certFooExampleCom</span>&nbsp;<span class="op" id="8112189">=</span>&nbsp;<span class="string" id="8112191">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303131345a170d3132303933303139303131345a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f666f6f2e6578616d706c652e636f6d300b06092a864886f70d010105034100646a2a51f2aa2477add854b462cf5207ba16d3213ffb5d3d0eed473fbf09935019192d1d5b8ca6a2407b424cf04d97c4cd9197c83ecf81f0eab9464a1109d09f`</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="8112851">var</span>&nbsp;<span class="ident" id="8112855">certDoubleWildcardExampleCom</span>&nbsp;<span class="op" id="8112884">=</span>&nbsp;<span class="string" id="8112886">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303134315a170d3132303933303139303134315a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f2a2e2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001c3de267975f56ef57771c6218ef95ecc65102e57bd1defe6f7efea90d9b26cf40de5bd7ad75e46201c7f2a92aaa3e907451e9409f65e28ddb6db80d726290f6`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8113546">func</span>&nbsp;<span class="ident" id="8113551">TestCertificateSelection</span><span class="op" id="8113575">(</span><span class="ident" id="8113576">t</span>&nbsp;<span class="op" id="8113578">*</span><span class="ident" id="8113579">testing</span><span class="op" id="8113586">.</span><span class="ident" id="8113587">T</span><span class="op" id="8113588">)</span>&nbsp;<span class="op" id="8113590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8113593">config</span>&nbsp;<span class="op" id="8113600">:=</span>&nbsp;<span class="ident" id="8113603">Config</span><span class="op" id="8113609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8113613">Certificates</span><span class="op" id="8113625">:</span>&nbsp;<span class="op" id="8113627">[</span><span class="op" id="8113628">]</span><span class="ident" id="8113629">Certificate</span><span class="op" id="8113640">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8113651">Certificate</span><span class="op" id="8113662">:</span>&nbsp;<span class="op" id="8113664">[</span><span class="op" id="8113665">]</span><span class="op" id="8113666">[</span><span class="op" id="8113667">]</span><span class="builtintype" id="8113668">byte</span><span class="op" id="8113672">{</span><span class="ident" id="8113673">fromHex</span><span class="op" id="8113680">(</span><span class="ident" id="8113681">certExampleCom</span><span class="op" id="8113695">)</span><span class="op" id="8113696">}</span><span class="op" id="8113697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113702">}</span><span class="op" id="8113703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8113714">Certificate</span><span class="op" id="8113725">:</span>&nbsp;<span class="op" id="8113727">[</span><span class="op" id="8113728">]</span><span class="op" id="8113729">[</span><span class="op" id="8113730">]</span><span class="builtintype" id="8113731">byte</span><span class="op" id="8113735">{</span><span class="ident" id="8113736">fromHex</span><span class="op" id="8113743">(</span><span class="ident" id="8113744">certWildcardExampleCom</span><span class="op" id="8113766">)</span><span class="op" id="8113767">}</span><span class="op" id="8113768">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113773">}</span><span class="op" id="8113774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8113785">Certificate</span><span class="op" id="8113796">:</span>&nbsp;<span class="op" id="8113798">[</span><span class="op" id="8113799">]</span><span class="op" id="8113800">[</span><span class="op" id="8113801">]</span><span class="builtintype" id="8113802">byte</span><span class="op" id="8113806">{</span><span class="ident" id="8113807">fromHex</span><span class="op" id="8113814">(</span><span class="ident" id="8113815">certFooExampleCom</span><span class="op" id="8113832">)</span><span class="op" id="8113833">}</span><span class="op" id="8113834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113839">}</span><span class="op" id="8113840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113845">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8113851">Certificate</span><span class="op" id="8113862">:</span>&nbsp;<span class="op" id="8113864">[</span><span class="op" id="8113865">]</span><span class="op" id="8113866">[</span><span class="op" id="8113867">]</span><span class="builtintype" id="8113868">byte</span><span class="op" id="8113872">{</span><span class="ident" id="8113873">fromHex</span><span class="op" id="8113880">(</span><span class="ident" id="8113881">certDoubleWildcardExampleCom</span><span class="op" id="8113909">)</span><span class="op" id="8113910">}</span><span class="op" id="8113911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113916">}</span><span class="op" id="8113917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113921">}</span><span class="op" id="8113922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8113929">config</span><span class="op" id="8113935">.</span><span class="ident" id="8113936">BuildNameToCertificate</span><span class="op" id="8113958">(</span><span class="op" id="8113959">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8113963">pointerToIndex</span>&nbsp;<span class="op" id="8113978">:=</span>&nbsp;<span class="keyword" id="8113981">func</span><span class="op" id="8113985">(</span><span class="ident" id="8113986">c</span>&nbsp;<span class="op" id="8113988">*</span><span class="ident" id="8113989">Certificate</span><span class="op" id="8114000">)</span>&nbsp;<span class="builtintype" id="8114002">int</span>&nbsp;<span class="op" id="8114006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8114010">for</span>&nbsp;<span class="ident" id="8114014">i</span>&nbsp;<span class="op" id="8114016">:=</span>&nbsp;<span class="keyword" id="8114019">range</span>&nbsp;<span class="ident" id="8114025">config</span><span class="op" id="8114031">.</span><span class="ident" id="8114032">Certificates</span>&nbsp;<span class="op" id="8114045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8114050">if</span>&nbsp;<span class="ident" id="8114053">c</span>&nbsp;<span class="op" id="8114055">==</span>&nbsp;<span class="op" id="8114058">&amp;</span><span class="ident" id="8114059">config</span><span class="op" id="8114065">.</span><span class="ident" id="8114066">Certificates</span><span class="op" id="8114078">[</span><span class="ident" id="8114079">i</span><span class="op" id="8114080">]</span>&nbsp;<span class="op" id="8114082">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8114088">return</span>&nbsp;<span class="ident" id="8114095">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8114108">return</span>&nbsp;<span class="op" id="8114115">-</span><span class="num" id="8114116">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114119">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8114123">certificateForName</span>&nbsp;<span class="op" id="8114142">:=</span>&nbsp;<span class="keyword" id="8114145">func</span><span class="op" id="8114149">(</span><span class="ident" id="8114150">name</span>&nbsp;<span class="builtintype" id="8114155">string</span><span class="op" id="8114161">)</span>&nbsp;<span class="op" id="8114163">*</span><span class="ident" id="8114164">Certificate</span>&nbsp;<span class="op" id="8114176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8114180">clientHello</span>&nbsp;<span class="op" id="8114192">:=</span>&nbsp;<span class="op" id="8114195">&amp;</span><span class="ident" id="8114196">ClientHelloInfo</span><span class="op" id="8114211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8114216">ServerName</span><span class="op" id="8114226">:</span>&nbsp;<span class="ident" id="8114228">name</span><span class="op" id="8114232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114236">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8114240">if</span>&nbsp;<span class="ident" id="8114243">cert</span><span class="op" id="8114247">,</span>&nbsp;<span class="ident" id="8114249">err</span>&nbsp;<span class="op" id="8114253">:=</span>&nbsp;<span class="ident" id="8114256">config</span><span class="op" id="8114262">.</span><span class="ident" id="8114263">getCertificate</span><span class="op" id="8114277">(</span><span class="ident" id="8114278">clientHello</span><span class="op" id="8114289">)</span><span class="op" id="8114290">;</span>&nbsp;<span class="ident" id="8114292">err</span>&nbsp;<span class="op" id="8114296">!=</span>&nbsp;<span class="ident" id="8114299">nil</span>&nbsp;<span class="op" id="8114303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8114308">t</span><span class="op" id="8114309">.</span><span class="ident" id="8114310">Errorf</span><span class="op" id="8114316">(</span><span class="string" id="8114317">&#34;unable&nbsp;to&nbsp;get&nbsp;certificate&nbsp;for&nbsp;name&nbsp;&#39;%s&#39;:&nbsp;%s&#34;</span><span class="op" id="8114362">,</span>&nbsp;<span class="ident" id="8114364">name</span><span class="op" id="8114368">,</span>&nbsp;<span class="ident" id="8114370">err</span><span class="op" id="8114373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8114378">return</span>&nbsp;<span class="ident" id="8114385">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114391">}</span>&nbsp;<span class="keyword" id="8114393">else</span>&nbsp;<span class="op" id="8114398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8114403">return</span>&nbsp;<span class="ident" id="8114410">cert</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8114424">if</span>&nbsp;<span class="ident" id="8114427">n</span>&nbsp;<span class="op" id="8114429">:=</span>&nbsp;<span class="ident" id="8114432">pointerToIndex</span><span class="op" id="8114446">(</span><span class="ident" id="8114447">certificateForName</span><span class="op" id="8114465">(</span><span class="string" id="8114466">&#34;example.com&#34;</span><span class="op" id="8114479">)</span><span class="op" id="8114480">)</span><span class="op" id="8114481">;</span>&nbsp;<span class="ident" id="8114483">n</span>&nbsp;<span class="op" id="8114485">!=</span>&nbsp;<span class="num" id="8114488">0</span>&nbsp;<span class="op" id="8114490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8114494">t</span><span class="op" id="8114495">.</span><span class="ident" id="8114496">Errorf</span><span class="op" id="8114502">(</span><span class="string" id="8114503">&#34;example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="8114547">,</span>&nbsp;<span class="ident" id="8114549">n</span><span class="op" id="8114550">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8114556">if</span>&nbsp;<span class="ident" id="8114559">n</span>&nbsp;<span class="op" id="8114561">:=</span>&nbsp;<span class="ident" id="8114564">pointerToIndex</span><span class="op" id="8114578">(</span><span class="ident" id="8114579">certificateForName</span><span class="op" id="8114597">(</span><span class="string" id="8114598">&#34;bar.example.com&#34;</span><span class="op" id="8114615">)</span><span class="op" id="8114616">)</span><span class="op" id="8114617">;</span>&nbsp;<span class="ident" id="8114619">n</span>&nbsp;<span class="op" id="8114621">!=</span>&nbsp;<span class="num" id="8114624">1</span>&nbsp;<span class="op" id="8114626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8114630">t</span><span class="op" id="8114631">.</span><span class="ident" id="8114632">Errorf</span><span class="op" id="8114638">(</span><span class="string" id="8114639">&#34;bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;1&#34;</span><span class="op" id="8114687">,</span>&nbsp;<span class="ident" id="8114689">n</span><span class="op" id="8114690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8114696">if</span>&nbsp;<span class="ident" id="8114699">n</span>&nbsp;<span class="op" id="8114701">:=</span>&nbsp;<span class="ident" id="8114704">pointerToIndex</span><span class="op" id="8114718">(</span><span class="ident" id="8114719">certificateForName</span><span class="op" id="8114737">(</span><span class="string" id="8114738">&#34;foo.example.com&#34;</span><span class="op" id="8114755">)</span><span class="op" id="8114756">)</span><span class="op" id="8114757">;</span>&nbsp;<span class="ident" id="8114759">n</span>&nbsp;<span class="op" id="8114761">!=</span>&nbsp;<span class="num" id="8114764">2</span>&nbsp;<span class="op" id="8114766">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8114770">t</span><span class="op" id="8114771">.</span><span class="ident" id="8114772">Errorf</span><span class="op" id="8114778">(</span><span class="string" id="8114779">&#34;foo.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;2&#34;</span><span class="op" id="8114827">,</span>&nbsp;<span class="ident" id="8114829">n</span><span class="op" id="8114830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8114836">if</span>&nbsp;<span class="ident" id="8114839">n</span>&nbsp;<span class="op" id="8114841">:=</span>&nbsp;<span class="ident" id="8114844">pointerToIndex</span><span class="op" id="8114858">(</span><span class="ident" id="8114859">certificateForName</span><span class="op" id="8114877">(</span><span class="string" id="8114878">&#34;foo.bar.example.com&#34;</span><span class="op" id="8114899">)</span><span class="op" id="8114900">)</span><span class="op" id="8114901">;</span>&nbsp;<span class="ident" id="8114903">n</span>&nbsp;<span class="op" id="8114905">!=</span>&nbsp;<span class="num" id="8114908">3</span>&nbsp;<span class="op" id="8114910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8114914">t</span><span class="op" id="8114915">.</span><span class="ident" id="8114916">Errorf</span><span class="op" id="8114922">(</span><span class="string" id="8114923">&#34;foo.bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;3&#34;</span><span class="op" id="8114975">,</span>&nbsp;<span class="ident" id="8114977">n</span><span class="op" id="8114978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114981">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8114984">if</span>&nbsp;<span class="ident" id="8114987">n</span>&nbsp;<span class="op" id="8114989">:=</span>&nbsp;<span class="ident" id="8114992">pointerToIndex</span><span class="op" id="8115006">(</span><span class="ident" id="8115007">certificateForName</span><span class="op" id="8115025">(</span><span class="string" id="8115026">&#34;foo.bar.baz.example.com&#34;</span><span class="op" id="8115051">)</span><span class="op" id="8115052">)</span><span class="op" id="8115053">;</span>&nbsp;<span class="ident" id="8115055">n</span>&nbsp;<span class="op" id="8115057">!=</span>&nbsp;<span class="num" id="8115060">0</span>&nbsp;<span class="op" id="8115062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8115066">t</span><span class="op" id="8115067">.</span><span class="ident" id="8115068">Errorf</span><span class="op" id="8115074">(</span><span class="string" id="8115075">&#34;foo.bar.baz.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="8115131">,</span>&nbsp;<span class="ident" id="8115133">n</span><span class="op" id="8115134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8115137">}</span><br>
<span class="lineno"></span><span class="op" id="8115139">}</span>
</div>
</body>
</html>
