<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2396734">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2396789">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2396843">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2396894">//&nbsp;Linux&nbsp;system&nbsp;calls.</span><br>
<span class="lineno"></span><span class="comment" id="2396917">//&nbsp;This&nbsp;file&nbsp;is&nbsp;compiled&nbsp;as&nbsp;ordinary&nbsp;Go&nbsp;code,</span><br>
<span class="lineno"></span><span class="comment" id="2396963">//&nbsp;but&nbsp;it&nbsp;is&nbsp;also&nbsp;input&nbsp;to&nbsp;mksyscall,</span><br>
<span class="lineno"></span><span class="comment" id="2397001">//&nbsp;which&nbsp;parses&nbsp;the&nbsp;//sys&nbsp;lines&nbsp;and&nbsp;generates&nbsp;system&nbsp;call&nbsp;stubs.</span><br>
<span class="lineno"></span><span class="comment" id="2397066">//&nbsp;Note&nbsp;that&nbsp;sometimes&nbsp;we&nbsp;use&nbsp;a&nbsp;lowercase&nbsp;//sys&nbsp;name&nbsp;and</span><br>
<span class="lineno">10</span><span class="comment" id="2397123">//&nbsp;wrap&nbsp;it&nbsp;in&nbsp;our&nbsp;own&nbsp;nicer&nbsp;implementation.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2397168">package</span>&nbsp;<span class="ident" id="2397176">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2397185">import</span>&nbsp;<span class="string" id="2397192">&#34;unsafe&#34;</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2397202">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Wrapped<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="2397221">//sys&nbsp;&nbsp;&nbsp;&nbspopen(path&nbsp;string,&nbsp;mode&nbsp;int,&nbsp;perm&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2397289">func</span>&nbsp;<span class="ident" id="2397294">Open</span><span class="op" id="2397298">(</span><span class="ident" id="2397299">path</span>&nbsp;<span class="builtintype" id="2397304">string</span><span class="op" id="2397310">,</span>&nbsp;<span class="ident" id="2397312">mode</span>&nbsp;<span class="builtintype" id="2397317">int</span><span class="op" id="2397320">,</span>&nbsp;<span class="ident" id="2397322">perm</span>&nbsp;<span class="builtintype" id="2397327">uint32</span><span class="op" id="2397333">)</span>&nbsp;<span class="op" id="2397335">(</span><span class="ident" id="2397336">fd</span>&nbsp;<span class="builtintype" id="2397339">int</span><span class="op" id="2397342">,</span>&nbsp;<span class="ident" id="2397344">err</span>&nbsp;<span class="builtintype" id="2397348">error</span><span class="op" id="2397353">)</span>&nbsp;<span class="op" id="2397355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397358">return</span>&nbsp;<span class="ident" id="2397365">open</span><span class="op" id="2397369">(</span><span class="ident" id="2397370">path</span><span class="op" id="2397374">,</span>&nbsp;<span class="ident" id="2397376">mode</span><span class="op" id="2397380">|</span><span class="ident" id="2397381">O_LARGEFILE</span><span class="op" id="2397392">,</span>&nbsp;<span class="ident" id="2397394">perm</span><span class="op" id="2397398">)</span><br>
<span class="lineno"></span><span class="op" id="2397400">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2397403">//sys&nbsp;&nbsp;&nbsp;&nbspopenat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;flags&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2397485">func</span>&nbsp;<span class="ident" id="2397490">Openat</span><span class="op" id="2397496">(</span><span class="ident" id="2397497">dirfd</span>&nbsp;<span class="builtintype" id="2397503">int</span><span class="op" id="2397506">,</span>&nbsp;<span class="ident" id="2397508">path</span>&nbsp;<span class="builtintype" id="2397513">string</span><span class="op" id="2397519">,</span>&nbsp;<span class="ident" id="2397521">flags</span>&nbsp;<span class="builtintype" id="2397527">int</span><span class="op" id="2397530">,</span>&nbsp;<span class="ident" id="2397532">mode</span>&nbsp;<span class="builtintype" id="2397537">uint32</span><span class="op" id="2397543">)</span>&nbsp;<span class="op" id="2397545">(</span><span class="ident" id="2397546">fd</span>&nbsp;<span class="builtintype" id="2397549">int</span><span class="op" id="2397552">,</span>&nbsp;<span class="ident" id="2397554">err</span>&nbsp;<span class="builtintype" id="2397558">error</span><span class="op" id="2397563">)</span>&nbsp;<span class="op" id="2397565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397568">return</span>&nbsp;<span class="ident" id="2397575">openat</span><span class="op" id="2397581">(</span><span class="ident" id="2397582">dirfd</span><span class="op" id="2397587">,</span>&nbsp;<span class="ident" id="2397589">path</span><span class="op" id="2397593">,</span>&nbsp;<span class="ident" id="2397595">flags</span><span class="op" id="2397600">|</span><span class="ident" id="2397601">O_LARGEFILE</span><span class="op" id="2397612">,</span>&nbsp;<span class="ident" id="2397614">mode</span><span class="op" id="2397618">)</span><br>
<span class="lineno">30</span><span class="op" id="2397620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2397623">//sysnb&nbsp;&nbsp;&nbsp;&nbsppipe(p&nbsp;*[2]_C_int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2397663">func</span>&nbsp;<span class="ident" id="2397668">Pipe</span><span class="op" id="2397672">(</span><span class="ident" id="2397673">p</span>&nbsp;<span class="op" id="2397675">[</span><span class="op" id="2397676">]</span><span class="builtintype" id="2397677">int</span><span class="op" id="2397680">)</span>&nbsp;<span class="op" id="2397682">(</span><span class="ident" id="2397683">err</span>&nbsp;<span class="builtintype" id="2397687">error</span><span class="op" id="2397692">)</span>&nbsp;<span class="op" id="2397694">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397697">if</span>&nbsp;<span class="builtinfunc" id="2397700">len</span><span class="op" id="2397703">(</span><span class="ident" id="2397704">p</span><span class="op" id="2397705">)</span>&nbsp;<span class="op" id="2397707">!=</span>&nbsp;<span class="num" id="2397710">2</span>&nbsp;<span class="op" id="2397712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397716">return</span>&nbsp;<span class="ident" id="2397723">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2397731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397734">var</span>&nbsp;<span class="ident" id="2397738">pp</span>&nbsp;<span class="op" id="2397741">[</span><span class="num" id="2397742">2</span><span class="op" id="2397743">]</span><span class="ident" id="2397744">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2397752">err</span>&nbsp;<span class="op" id="2397756">=</span>&nbsp;<span class="ident" id="2397758">pipe</span><span class="op" id="2397762">(</span><span class="op" id="2397763">&amp;</span><span class="ident" id="2397764">pp</span><span class="op" id="2397766">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2397769">p</span><span class="op" id="2397770">[</span><span class="num" id="2397771">0</span><span class="op" id="2397772">]</span>&nbsp;<span class="op" id="2397774">=</span>&nbsp;<span class="builtintype" id="2397776">int</span><span class="op" id="2397779">(</span><span class="ident" id="2397780">pp</span><span class="op" id="2397782">[</span><span class="num" id="2397783">0</span><span class="op" id="2397784">]</span><span class="op" id="2397785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2397788">p</span><span class="op" id="2397789">[</span><span class="num" id="2397790">1</span><span class="op" id="2397791">]</span>&nbsp;<span class="op" id="2397793">=</span>&nbsp;<span class="builtintype" id="2397795">int</span><span class="op" id="2397798">(</span><span class="ident" id="2397799">pp</span><span class="op" id="2397801">[</span><span class="num" id="2397802">1</span><span class="op" id="2397803">]</span><span class="op" id="2397804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397807">return</span><br>
<span class="lineno"></span><span class="op" id="2397814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="2397817">//sysnb&nbsp;pipe2(p&nbsp;*[2]_C_int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2397869">func</span>&nbsp;<span class="ident" id="2397874">Pipe2</span><span class="op" id="2397879">(</span><span class="ident" id="2397880">p</span>&nbsp;<span class="op" id="2397882">[</span><span class="op" id="2397883">]</span><span class="builtintype" id="2397884">int</span><span class="op" id="2397887">,</span>&nbsp;<span class="ident" id="2397889">flags</span>&nbsp;<span class="builtintype" id="2397895">int</span><span class="op" id="2397898">)</span>&nbsp;<span class="op" id="2397900">(</span><span class="ident" id="2397901">err</span>&nbsp;<span class="builtintype" id="2397905">error</span><span class="op" id="2397910">)</span>&nbsp;<span class="op" id="2397912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397915">if</span>&nbsp;<span class="builtinfunc" id="2397918">len</span><span class="op" id="2397921">(</span><span class="ident" id="2397922">p</span><span class="op" id="2397923">)</span>&nbsp;<span class="op" id="2397925">!=</span>&nbsp;<span class="num" id="2397928">2</span>&nbsp;<span class="op" id="2397930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397934">return</span>&nbsp;<span class="ident" id="2397941">EINVAL</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2397949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2397952">var</span>&nbsp;<span class="ident" id="2397956">pp</span>&nbsp;<span class="op" id="2397959">[</span><span class="num" id="2397960">2</span><span class="op" id="2397961">]</span><span class="ident" id="2397962">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2397970">err</span>&nbsp;<span class="op" id="2397974">=</span>&nbsp;<span class="ident" id="2397976">pipe2</span><span class="op" id="2397981">(</span><span class="op" id="2397982">&amp;</span><span class="ident" id="2397983">pp</span><span class="op" id="2397985">,</span>&nbsp;<span class="ident" id="2397987">flags</span><span class="op" id="2397992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2397995">p</span><span class="op" id="2397996">[</span><span class="num" id="2397997">0</span><span class="op" id="2397998">]</span>&nbsp;<span class="op" id="2398000">=</span>&nbsp;<span class="builtintype" id="2398002">int</span><span class="op" id="2398005">(</span><span class="ident" id="2398006">pp</span><span class="op" id="2398008">[</span><span class="num" id="2398009">0</span><span class="op" id="2398010">]</span><span class="op" id="2398011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2398014">p</span><span class="op" id="2398015">[</span><span class="num" id="2398016">1</span><span class="op" id="2398017">]</span>&nbsp;<span class="op" id="2398019">=</span>&nbsp;<span class="builtintype" id="2398021">int</span><span class="op" id="2398024">(</span><span class="ident" id="2398025">pp</span><span class="op" id="2398027">[</span><span class="num" id="2398028">1</span><span class="op" id="2398029">]</span><span class="op" id="2398030">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398033">return</span><br>
<span class="lineno"></span><span class="op" id="2398040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2398043">//sys&nbsp;&nbsp;&nbsp;&nbsputimes(path&nbsp;string,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="2398101">func</span>&nbsp;<span class="ident" id="2398106">Utimes</span><span class="op" id="2398112">(</span><span class="ident" id="2398113">path</span>&nbsp;<span class="builtintype" id="2398118">string</span><span class="op" id="2398124">,</span>&nbsp;<span class="ident" id="2398126">tv</span>&nbsp;<span class="op" id="2398129">[</span><span class="op" id="2398130">]</span><span class="ident" id="2398131">Timeval</span><span class="op" id="2398138">)</span>&nbsp;<span class="op" id="2398140">(</span><span class="ident" id="2398141">err</span>&nbsp;<span class="builtintype" id="2398145">error</span><span class="op" id="2398150">)</span>&nbsp;<span class="op" id="2398152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398155">if</span>&nbsp;<span class="builtinfunc" id="2398158">len</span><span class="op" id="2398161">(</span><span class="ident" id="2398162">tv</span><span class="op" id="2398164">)</span>&nbsp;<span class="op" id="2398166">!=</span>&nbsp;<span class="num" id="2398169">2</span>&nbsp;<span class="op" id="2398171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398175">return</span>&nbsp;<span class="ident" id="2398182">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2398190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398193">return</span>&nbsp;<span class="ident" id="2398200">utimes</span><span class="op" id="2398206">(</span><span class="ident" id="2398207">path</span><span class="op" id="2398211">,</span>&nbsp;<span class="op" id="2398213">(</span><span class="op" id="2398214">*</span><span class="op" id="2398215">[</span><span class="num" id="2398216">2</span><span class="op" id="2398217">]</span><span class="ident" id="2398218">Timeval</span><span class="op" id="2398225">)</span><span class="op" id="2398226">(</span><span class="ident" id="2398227">unsafe</span><span class="op" id="2398233">.</span><span class="ident" id="2398234">Pointer</span><span class="op" id="2398241">(</span><span class="op" id="2398242">&amp;</span><span class="ident" id="2398243">tv</span><span class="op" id="2398245">[</span><span class="num" id="2398246">0</span><span class="op" id="2398247">]</span><span class="op" id="2398248">)</span><span class="op" id="2398249">)</span><span class="op" id="2398250">)</span><br>
<span class="lineno">65</span><span class="op" id="2398252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2398255">//sys&nbsp;&nbsp;&nbsp;&nbsputimensat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;times&nbsp;*[2]Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2398328">func</span>&nbsp;<span class="ident" id="2398333">UtimesNano</span><span class="op" id="2398343">(</span><span class="ident" id="2398344">path</span>&nbsp;<span class="builtintype" id="2398349">string</span><span class="op" id="2398355">,</span>&nbsp;<span class="ident" id="2398357">ts</span>&nbsp;<span class="op" id="2398360">[</span><span class="op" id="2398361">]</span><span class="ident" id="2398362">Timespec</span><span class="op" id="2398370">)</span>&nbsp;<span class="op" id="2398372">(</span><span class="ident" id="2398373">err</span>&nbsp;<span class="builtintype" id="2398377">error</span><span class="op" id="2398382">)</span>&nbsp;<span class="op" id="2398384">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398387">if</span>&nbsp;<span class="builtinfunc" id="2398390">len</span><span class="op" id="2398393">(</span><span class="ident" id="2398394">ts</span><span class="op" id="2398396">)</span>&nbsp;<span class="op" id="2398398">!=</span>&nbsp;<span class="num" id="2398401">2</span>&nbsp;<span class="op" id="2398403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398407">return</span>&nbsp;<span class="ident" id="2398414">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2398422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2398425">err</span>&nbsp;<span class="op" id="2398429">=</span>&nbsp;<span class="ident" id="2398431">utimensat</span><span class="op" id="2398440">(</span><span class="ident" id="2398441">_AT_FDCWD</span><span class="op" id="2398450">,</span>&nbsp;<span class="ident" id="2398452">path</span><span class="op" id="2398456">,</span>&nbsp;<span class="op" id="2398458">(</span><span class="op" id="2398459">*</span><span class="op" id="2398460">[</span><span class="num" id="2398461">2</span><span class="op" id="2398462">]</span><span class="ident" id="2398463">Timespec</span><span class="op" id="2398471">)</span><span class="op" id="2398472">(</span><span class="ident" id="2398473">unsafe</span><span class="op" id="2398479">.</span><span class="ident" id="2398480">Pointer</span><span class="op" id="2398487">(</span><span class="op" id="2398488">&amp;</span><span class="ident" id="2398489">ts</span><span class="op" id="2398491">[</span><span class="num" id="2398492">0</span><span class="op" id="2398493">]</span><span class="op" id="2398494">)</span><span class="op" id="2398495">)</span><span class="op" id="2398496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398499">if</span>&nbsp;<span class="ident" id="2398502">err</span>&nbsp;<span class="op" id="2398506">!=</span>&nbsp;<span class="ident" id="2398509">ENOSYS</span>&nbsp;<span class="op" id="2398516">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398520">return</span>&nbsp;<span class="ident" id="2398527">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2398532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2398535">//&nbsp;If&nbsp;the&nbsp;utimensat&nbsp;syscall&nbsp;isn&#39;t&nbsp;available&nbsp;(utimensat&nbsp;was&nbsp;added&nbsp;to&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2398610">//&nbsp;in&nbsp;2.6.22,&nbsp;Released,&nbsp;8&nbsp;July&nbsp;2007)&nbsp;then&nbsp;fall&nbsp;back&nbsp;to&nbsp;utimes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398673">var</span>&nbsp;<span class="ident" id="2398677">tv</span>&nbsp;<span class="op" id="2398680">[</span><span class="num" id="2398681">2</span><span class="op" id="2398682">]</span><span class="ident" id="2398683">Timeval</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398692">for</span>&nbsp;<span class="ident" id="2398696">i</span>&nbsp;<span class="op" id="2398698">:=</span>&nbsp;<span class="num" id="2398701">0</span><span class="op" id="2398702">;</span>&nbsp;<span class="ident" id="2398704">i</span>&nbsp;<span class="op" id="2398706">&lt;</span>&nbsp;<span class="num" id="2398708">2</span><span class="op" id="2398709">;</span>&nbsp;<span class="ident" id="2398711">i</span><span class="op" id="2398712">++</span>&nbsp;<span class="op" id="2398715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2398719">tv</span><span class="op" id="2398721">[</span><span class="ident" id="2398722">i</span><span class="op" id="2398723">]</span><span class="op" id="2398724">.</span><span class="ident" id="2398725">Sec</span>&nbsp;<span class="op" id="2398729">=</span>&nbsp;<span class="ident" id="2398731">ts</span><span class="op" id="2398733">[</span><span class="ident" id="2398734">i</span><span class="op" id="2398735">]</span><span class="op" id="2398736">.</span><span class="ident" id="2398737">Sec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2398743">tv</span><span class="op" id="2398745">[</span><span class="ident" id="2398746">i</span><span class="op" id="2398747">]</span><span class="op" id="2398748">.</span><span class="ident" id="2398749">Usec</span>&nbsp;<span class="op" id="2398754">=</span>&nbsp;<span class="ident" id="2398756">ts</span><span class="op" id="2398758">[</span><span class="ident" id="2398759">i</span><span class="op" id="2398760">]</span><span class="op" id="2398761">.</span><span class="ident" id="2398762">Nsec</span>&nbsp;<span class="op" id="2398767">/</span>&nbsp;<span class="num" id="2398769">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2398775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398778">return</span>&nbsp;<span class="ident" id="2398785">utimes</span><span class="op" id="2398791">(</span><span class="ident" id="2398792">path</span><span class="op" id="2398796">,</span>&nbsp;<span class="op" id="2398798">(</span><span class="op" id="2398799">*</span><span class="op" id="2398800">[</span><span class="num" id="2398801">2</span><span class="op" id="2398802">]</span><span class="ident" id="2398803">Timeval</span><span class="op" id="2398810">)</span><span class="op" id="2398811">(</span><span class="ident" id="2398812">unsafe</span><span class="op" id="2398818">.</span><span class="ident" id="2398819">Pointer</span><span class="op" id="2398826">(</span><span class="op" id="2398827">&amp;</span><span class="ident" id="2398828">tv</span><span class="op" id="2398830">[</span><span class="num" id="2398831">0</span><span class="op" id="2398832">]</span><span class="op" id="2398833">)</span><span class="op" id="2398834">)</span><span class="op" id="2398835">)</span><br>
<span class="lineno">85</span><span class="op" id="2398837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2398840">//sys&nbsp;&nbsp;&nbsp;&nbspfutimesat(dirfd&nbsp;int,&nbsp;path&nbsp;*byte,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2398911">func</span>&nbsp;<span class="ident" id="2398916">Futimesat</span><span class="op" id="2398925">(</span><span class="ident" id="2398926">dirfd</span>&nbsp;<span class="builtintype" id="2398932">int</span><span class="op" id="2398935">,</span>&nbsp;<span class="ident" id="2398937">path</span>&nbsp;<span class="builtintype" id="2398942">string</span><span class="op" id="2398948">,</span>&nbsp;<span class="ident" id="2398950">tv</span>&nbsp;<span class="op" id="2398953">[</span><span class="op" id="2398954">]</span><span class="ident" id="2398955">Timeval</span><span class="op" id="2398962">)</span>&nbsp;<span class="op" id="2398964">(</span><span class="ident" id="2398965">err</span>&nbsp;<span class="builtintype" id="2398969">error</span><span class="op" id="2398974">)</span>&nbsp;<span class="op" id="2398976">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398979">if</span>&nbsp;<span class="builtinfunc" id="2398982">len</span><span class="op" id="2398985">(</span><span class="ident" id="2398986">tv</span><span class="op" id="2398988">)</span>&nbsp;<span class="op" id="2398990">!=</span>&nbsp;<span class="num" id="2398993">2</span>&nbsp;<span class="op" id="2398995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2398999">return</span>&nbsp;<span class="ident" id="2399006">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2399014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2399017">pathp</span><span class="op" id="2399022">,</span>&nbsp;<span class="ident" id="2399024">err</span>&nbsp;<span class="op" id="2399028">:=</span>&nbsp;<span class="ident" id="2399031">BytePtrFromString</span><span class="op" id="2399048">(</span><span class="ident" id="2399049">path</span><span class="op" id="2399053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399056">if</span>&nbsp;<span class="ident" id="2399059">err</span>&nbsp;<span class="op" id="2399063">!=</span>&nbsp;<span class="ident" id="2399066">nil</span>&nbsp;<span class="op" id="2399070">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399074">return</span>&nbsp;<span class="ident" id="2399081">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2399086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2399089">err</span>&nbsp;<span class="op" id="2399093">=</span>&nbsp;<span class="ident" id="2399095">futimesat</span><span class="op" id="2399104">(</span><span class="ident" id="2399105">dirfd</span><span class="op" id="2399110">,</span>&nbsp;<span class="ident" id="2399112">pathp</span><span class="op" id="2399117">,</span>&nbsp;<span class="op" id="2399119">(</span><span class="op" id="2399120">*</span><span class="op" id="2399121">[</span><span class="num" id="2399122">2</span><span class="op" id="2399123">]</span><span class="ident" id="2399124">Timeval</span><span class="op" id="2399131">)</span><span class="op" id="2399132">(</span><span class="ident" id="2399133">unsafe</span><span class="op" id="2399139">.</span><span class="ident" id="2399140">Pointer</span><span class="op" id="2399147">(</span><span class="op" id="2399148">&amp;</span><span class="ident" id="2399149">tv</span><span class="op" id="2399151">[</span><span class="num" id="2399152">0</span><span class="op" id="2399153">]</span><span class="op" id="2399154">)</span><span class="op" id="2399155">)</span><span class="op" id="2399156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2399159">use</span><span class="op" id="2399162">(</span><span class="ident" id="2399163">unsafe</span><span class="op" id="2399169">.</span><span class="ident" id="2399170">Pointer</span><span class="op" id="2399177">(</span><span class="ident" id="2399178">pathp</span><span class="op" id="2399183">)</span><span class="op" id="2399184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399187">return</span>&nbsp;<span class="ident" id="2399194">err</span><br>
<span class="lineno">100</span><span class="op" id="2399198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2399201">func</span>&nbsp;<span class="ident" id="2399206">Futimes</span><span class="op" id="2399213">(</span><span class="ident" id="2399214">fd</span>&nbsp;<span class="builtintype" id="2399217">int</span><span class="op" id="2399220">,</span>&nbsp;<span class="ident" id="2399222">tv</span>&nbsp;<span class="op" id="2399225">[</span><span class="op" id="2399226">]</span><span class="ident" id="2399227">Timeval</span><span class="op" id="2399234">)</span>&nbsp;<span class="op" id="2399236">(</span><span class="ident" id="2399237">err</span>&nbsp;<span class="builtintype" id="2399241">error</span><span class="op" id="2399246">)</span>&nbsp;<span class="op" id="2399248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2399251">//&nbsp;Believe&nbsp;it&nbsp;or&nbsp;not,&nbsp;this&nbsp;is&nbsp;the&nbsp;best&nbsp;we&nbsp;can&nbsp;do&nbsp;on&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2399310">//&nbsp;(and&nbsp;is&nbsp;what&nbsp;glibc&nbsp;does).</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399340">return</span>&nbsp;<span class="ident" id="2399347">Utimes</span><span class="op" id="2399353">(</span><span class="string" id="2399354">&#34;/proc/self/fd/&#34;</span><span class="op" id="2399370">+</span><span class="ident" id="2399371">itoa</span><span class="op" id="2399375">(</span><span class="ident" id="2399376">fd</span><span class="op" id="2399378">)</span><span class="op" id="2399379">,</span>&nbsp;<span class="ident" id="2399381">tv</span><span class="op" id="2399383">)</span><br>
<span class="lineno"></span><span class="op" id="2399385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2399388">const</span>&nbsp;<span class="ident" id="2399394">ImplementsGetwd</span>&nbsp;<span class="op" id="2399410">=</span>&nbsp;<span class="builtintype" id="2399412">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="2399418">//sys&nbsp;&nbsp;&nbsp;&nbspGetcwd(buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2399463">func</span>&nbsp;<span class="ident" id="2399468">Getwd</span><span class="op" id="2399473">(</span><span class="op" id="2399474">)</span>&nbsp;<span class="op" id="2399476">(</span><span class="ident" id="2399477">wd</span>&nbsp;<span class="builtintype" id="2399480">string</span><span class="op" id="2399486">,</span>&nbsp;<span class="ident" id="2399488">err</span>&nbsp;<span class="builtintype" id="2399492">error</span><span class="op" id="2399497">)</span>&nbsp;<span class="op" id="2399499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399502">var</span>&nbsp;<span class="ident" id="2399506">buf</span>&nbsp;<span class="op" id="2399510">[</span><span class="ident" id="2399511">PathMax</span><span class="op" id="2399518">]</span><span class="builtintype" id="2399519">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2399525">n</span><span class="op" id="2399526">,</span>&nbsp;<span class="ident" id="2399528">err</span>&nbsp;<span class="op" id="2399532">:=</span>&nbsp;<span class="ident" id="2399535">Getcwd</span><span class="op" id="2399541">(</span><span class="ident" id="2399542">buf</span><span class="op" id="2399545">[</span><span class="num" id="2399546">0</span><span class="op" id="2399547">:</span><span class="op" id="2399548">]</span><span class="op" id="2399549">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399552">if</span>&nbsp;<span class="ident" id="2399555">err</span>&nbsp;<span class="op" id="2399559">!=</span>&nbsp;<span class="ident" id="2399562">nil</span>&nbsp;<span class="op" id="2399566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399570">return</span>&nbsp;<span class="string" id="2399577">&#34;&#34;</span><span class="op" id="2399579">,</span>&nbsp;<span class="ident" id="2399581">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2399586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2399589">//&nbsp;Getcwd&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;to&nbsp;buf,&nbsp;including&nbsp;the&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399663">if</span>&nbsp;<span class="ident" id="2399666">n</span>&nbsp;<span class="op" id="2399668">&lt;</span>&nbsp;<span class="num" id="2399670">1</span>&nbsp;<span class="op" id="2399672">||</span>&nbsp;<span class="ident" id="2399675">n</span>&nbsp;<span class="op" id="2399677">&gt;</span>&nbsp;<span class="builtinfunc" id="2399679">len</span><span class="op" id="2399682">(</span><span class="ident" id="2399683">buf</span><span class="op" id="2399686">)</span>&nbsp;<span class="op" id="2399688">||</span>&nbsp;<span class="ident" id="2399691">buf</span><span class="op" id="2399694">[</span><span class="ident" id="2399695">n</span><span class="op" id="2399696">-</span><span class="num" id="2399697">1</span><span class="op" id="2399698">]</span>&nbsp;<span class="op" id="2399700">!=</span>&nbsp;<span class="num" id="2399703">0</span>&nbsp;<span class="op" id="2399705">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399709">return</span>&nbsp;<span class="string" id="2399716">&#34;&#34;</span><span class="op" id="2399718">,</span>&nbsp;<span class="ident" id="2399720">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2399728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399731">return</span>&nbsp;<span class="builtintype" id="2399738">string</span><span class="op" id="2399744">(</span><span class="ident" id="2399745">buf</span><span class="op" id="2399748">[</span><span class="num" id="2399749">0</span>&nbsp;<span class="op" id="2399751">:</span>&nbsp;<span class="ident" id="2399753">n</span><span class="op" id="2399754">-</span><span class="num" id="2399755">1</span><span class="op" id="2399756">]</span><span class="op" id="2399757">)</span><span class="op" id="2399758">,</span>&nbsp;<span class="ident" id="2399760">nil</span><br>
<span class="lineno"></span><span class="op" id="2399764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2399767">func</span>&nbsp;<span class="ident" id="2399772">Getgroups</span><span class="op" id="2399781">(</span><span class="op" id="2399782">)</span>&nbsp;<span class="op" id="2399784">(</span><span class="ident" id="2399785">gids</span>&nbsp;<span class="op" id="2399790">[</span><span class="op" id="2399791">]</span><span class="builtintype" id="2399792">int</span><span class="op" id="2399795">,</span>&nbsp;<span class="ident" id="2399797">err</span>&nbsp;<span class="builtintype" id="2399801">error</span><span class="op" id="2399806">)</span>&nbsp;<span class="op" id="2399808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2399811">n</span><span class="op" id="2399812">,</span>&nbsp;<span class="ident" id="2399814">err</span>&nbsp;<span class="op" id="2399818">:=</span>&nbsp;<span class="ident" id="2399821">getgroups</span><span class="op" id="2399830">(</span><span class="num" id="2399831">0</span><span class="op" id="2399832">,</span>&nbsp;<span class="ident" id="2399834">nil</span><span class="op" id="2399837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399840">if</span>&nbsp;<span class="ident" id="2399843">err</span>&nbsp;<span class="op" id="2399847">!=</span>&nbsp;<span class="ident" id="2399850">nil</span>&nbsp;<span class="op" id="2399854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399858">return</span>&nbsp;<span class="ident" id="2399865">nil</span><span class="op" id="2399868">,</span>&nbsp;<span class="ident" id="2399870">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2399875">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399878">if</span>&nbsp;<span class="ident" id="2399881">n</span>&nbsp;<span class="op" id="2399883">==</span>&nbsp;<span class="num" id="2399886">0</span>&nbsp;<span class="op" id="2399888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399892">return</span>&nbsp;<span class="ident" id="2399899">nil</span><span class="op" id="2399902">,</span>&nbsp;<span class="ident" id="2399904">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2399909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2399913">//&nbsp;Sanity&nbsp;check&nbsp;group&nbsp;count.&nbsp;&nbsp;Max&nbsp;is&nbsp;1&lt;&lt;16&nbsp;on&nbsp;Linux.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399967">if</span>&nbsp;<span class="ident" id="2399970">n</span>&nbsp;<span class="op" id="2399972">&lt;</span>&nbsp;<span class="num" id="2399974">0</span>&nbsp;<span class="op" id="2399976">||</span>&nbsp;<span class="ident" id="2399979">n</span>&nbsp;<span class="op" id="2399981">&gt;</span>&nbsp;<span class="num" id="2399983">1</span><span class="op" id="2399984">&lt;&lt;</span><span class="num" id="2399986">20</span>&nbsp;<span class="op" id="2399989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2399993">return</span>&nbsp;<span class="ident" id="2400000">nil</span><span class="op" id="2400003">,</span>&nbsp;<span class="ident" id="2400005">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2400013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400017">a</span>&nbsp;<span class="op" id="2400019">:=</span>&nbsp;<span class="builtinfunc" id="2400022">make</span><span class="op" id="2400026">(</span><span class="op" id="2400027">[</span><span class="op" id="2400028">]</span><span class="ident" id="2400029">_Gid_t</span><span class="op" id="2400035">,</span>&nbsp;<span class="ident" id="2400037">n</span><span class="op" id="2400038">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400041">n</span><span class="op" id="2400042">,</span>&nbsp;<span class="ident" id="2400044">err</span>&nbsp;<span class="op" id="2400048">=</span>&nbsp;<span class="ident" id="2400050">getgroups</span><span class="op" id="2400059">(</span><span class="ident" id="2400060">n</span><span class="op" id="2400061">,</span>&nbsp;<span class="op" id="2400063">&amp;</span><span class="ident" id="2400064">a</span><span class="op" id="2400065">[</span><span class="num" id="2400066">0</span><span class="op" id="2400067">]</span><span class="op" id="2400068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400071">if</span>&nbsp;<span class="ident" id="2400074">err</span>&nbsp;<span class="op" id="2400078">!=</span>&nbsp;<span class="ident" id="2400081">nil</span>&nbsp;<span class="op" id="2400085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400089">return</span>&nbsp;<span class="ident" id="2400096">nil</span><span class="op" id="2400099">,</span>&nbsp;<span class="ident" id="2400101">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2400106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400109">gids</span>&nbsp;<span class="op" id="2400114">=</span>&nbsp;<span class="builtinfunc" id="2400116">make</span><span class="op" id="2400120">(</span><span class="op" id="2400121">[</span><span class="op" id="2400122">]</span><span class="builtintype" id="2400123">int</span><span class="op" id="2400126">,</span>&nbsp;<span class="ident" id="2400128">n</span><span class="op" id="2400129">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400132">for</span>&nbsp;<span class="ident" id="2400136">i</span><span class="op" id="2400137">,</span>&nbsp;<span class="ident" id="2400139">v</span>&nbsp;<span class="op" id="2400141">:=</span>&nbsp;<span class="keyword" id="2400144">range</span>&nbsp;<span class="ident" id="2400150">a</span><span class="op" id="2400151">[</span><span class="num" id="2400152">0</span><span class="op" id="2400153">:</span><span class="ident" id="2400154">n</span><span class="op" id="2400155">]</span>&nbsp;<span class="op" id="2400157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400161">gids</span><span class="op" id="2400165">[</span><span class="ident" id="2400166">i</span><span class="op" id="2400167">]</span>&nbsp;<span class="op" id="2400169">=</span>&nbsp;<span class="builtintype" id="2400171">int</span><span class="op" id="2400174">(</span><span class="ident" id="2400175">v</span><span class="op" id="2400176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2400179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400182">return</span><br>
<span class="lineno"></span><span class="op" id="2400189">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="2400192">func</span>&nbsp;<span class="ident" id="2400197">Setgroups</span><span class="op" id="2400206">(</span><span class="ident" id="2400207">gids</span>&nbsp;<span class="op" id="2400212">[</span><span class="op" id="2400213">]</span><span class="builtintype" id="2400214">int</span><span class="op" id="2400217">)</span>&nbsp;<span class="op" id="2400219">(</span><span class="ident" id="2400220">err</span>&nbsp;<span class="builtintype" id="2400224">error</span><span class="op" id="2400229">)</span>&nbsp;<span class="op" id="2400231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400234">if</span>&nbsp;<span class="builtinfunc" id="2400237">len</span><span class="op" id="2400240">(</span><span class="ident" id="2400241">gids</span><span class="op" id="2400245">)</span>&nbsp;<span class="op" id="2400247">==</span>&nbsp;<span class="num" id="2400250">0</span>&nbsp;<span class="op" id="2400252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400256">return</span>&nbsp;<span class="ident" id="2400263">setgroups</span><span class="op" id="2400272">(</span><span class="num" id="2400273">0</span><span class="op" id="2400274">,</span>&nbsp;<span class="ident" id="2400276">nil</span><span class="op" id="2400279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2400282">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400286">a</span>&nbsp;<span class="op" id="2400288">:=</span>&nbsp;<span class="builtinfunc" id="2400291">make</span><span class="op" id="2400295">(</span><span class="op" id="2400296">[</span><span class="op" id="2400297">]</span><span class="ident" id="2400298">_Gid_t</span><span class="op" id="2400304">,</span>&nbsp;<span class="builtinfunc" id="2400306">len</span><span class="op" id="2400309">(</span><span class="ident" id="2400310">gids</span><span class="op" id="2400314">)</span><span class="op" id="2400315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400318">for</span>&nbsp;<span class="ident" id="2400322">i</span><span class="op" id="2400323">,</span>&nbsp;<span class="ident" id="2400325">v</span>&nbsp;<span class="op" id="2400327">:=</span>&nbsp;<span class="keyword" id="2400330">range</span>&nbsp;<span class="ident" id="2400336">gids</span>&nbsp;<span class="op" id="2400341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400345">a</span><span class="op" id="2400346">[</span><span class="ident" id="2400347">i</span><span class="op" id="2400348">]</span>&nbsp;<span class="op" id="2400350">=</span>&nbsp;<span class="ident" id="2400352">_Gid_t</span><span class="op" id="2400358">(</span><span class="ident" id="2400359">v</span><span class="op" id="2400360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2400363">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2400366">return</span>&nbsp;<span class="ident" id="2400373">setgroups</span><span class="op" id="2400382">(</span><span class="builtinfunc" id="2400383">len</span><span class="op" id="2400386">(</span><span class="ident" id="2400387">a</span><span class="op" id="2400388">)</span><span class="op" id="2400389">,</span>&nbsp;<span class="op" id="2400391">&amp;</span><span class="ident" id="2400392">a</span><span class="op" id="2400393">[</span><span class="num" id="2400394">0</span><span class="op" id="2400395">]</span><span class="op" id="2400396">)</span><br>
<span class="lineno"></span><span class="op" id="2400398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2400401">type</span>&nbsp;<span class="ident" id="2400406">WaitStatus</span>&nbsp;<span class="builtintype" id="2400417">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="2400425">//&nbsp;Wait&nbsp;status&nbsp;is&nbsp;7&nbsp;bits&nbsp;at&nbsp;bottom,&nbsp;either&nbsp;0&nbsp;(exited),</span><br>
<span class="lineno"></span><span class="comment" id="2400480">//&nbsp;0x7F&nbsp;(stopped),&nbsp;or&nbsp;a&nbsp;signal&nbsp;number&nbsp;that&nbsp;caused&nbsp;an&nbsp;exit.</span><br>
<span class="lineno"></span><span class="comment" id="2400539">//&nbsp;The&nbsp;0x80&nbsp;bit&nbsp;is&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;core&nbsp;dump.</span><br>
<span class="lineno"></span><span class="comment" id="2400589">//&nbsp;An&nbsp;extra&nbsp;number&nbsp;(exit&nbsp;code,&nbsp;signal&nbsp;causing&nbsp;a&nbsp;stop)</span><br>
<span class="lineno"></span><span class="comment" id="2400643">//&nbsp;is&nbsp;in&nbsp;the&nbsp;high&nbsp;bits.&nbsp;&nbsp;At&nbsp;least&nbsp;that&#39;s&nbsp;the&nbsp;idea.</span><br>
<span class="lineno">170</span><span class="comment" id="2400694">//&nbsp;There&nbsp;are&nbsp;various&nbsp;irregularities.&nbsp;&nbsp;For&nbsp;example,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2400749">//&nbsp;&#34;continued&#34;&nbsp;status&nbsp;is&nbsp;0xFFFF,&nbsp;distinguishing&nbsp;itself</span><br>
<span class="lineno"></span><span class="comment" id="2400804">//&nbsp;from&nbsp;stopped&nbsp;via&nbsp;the&nbsp;core&nbsp;dump&nbsp;bit.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2400844">const</span>&nbsp;<span class="op" id="2400850">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400853">mask</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2400861">=</span>&nbsp;<span class="num" id="2400863">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400869">core</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2400877">=</span>&nbsp;<span class="num" id="2400879">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400885">exited</span>&nbsp;&nbsp;<span class="op" id="2400893">=</span>&nbsp;<span class="num" id="2400895">0x00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400901">stopped</span>&nbsp;<span class="op" id="2400909">=</span>&nbsp;<span class="num" id="2400911">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2400917">shift</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2400925">=</span>&nbsp;<span class="num" id="2400927">8</span><br>
<span class="lineno">180</span><span class="op" id="2400929">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2400932">func</span>&nbsp;<span class="op" id="2400937">(</span><span class="ident" id="2400938">w</span>&nbsp;<span class="ident" id="2400940">WaitStatus</span><span class="op" id="2400950">)</span>&nbsp;<span class="ident" id="2400952">Exited</span><span class="op" id="2400958">(</span><span class="op" id="2400959">)</span>&nbsp;<span class="builtintype" id="2400961">bool</span>&nbsp;<span class="op" id="2400966">{</span>&nbsp;<span class="keyword" id="2400968">return</span>&nbsp;<span class="ident" id="2400975">w</span><span class="op" id="2400976">&amp;</span><span class="ident" id="2400977">mask</span>&nbsp;<span class="op" id="2400982">==</span>&nbsp;<span class="ident" id="2400985">exited</span>&nbsp;<span class="op" id="2400992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2400995">func</span>&nbsp;<span class="op" id="2401000">(</span><span class="ident" id="2401001">w</span>&nbsp;<span class="ident" id="2401003">WaitStatus</span><span class="op" id="2401013">)</span>&nbsp;<span class="ident" id="2401015">Signaled</span><span class="op" id="2401023">(</span><span class="op" id="2401024">)</span>&nbsp;<span class="builtintype" id="2401026">bool</span>&nbsp;<span class="op" id="2401031">{</span>&nbsp;<span class="keyword" id="2401033">return</span>&nbsp;<span class="ident" id="2401040">w</span><span class="op" id="2401041">&amp;</span><span class="ident" id="2401042">mask</span>&nbsp;<span class="op" id="2401047">!=</span>&nbsp;<span class="ident" id="2401050">stopped</span>&nbsp;<span class="op" id="2401058">&amp;&amp;</span>&nbsp;<span class="ident" id="2401061">w</span><span class="op" id="2401062">&amp;</span><span class="ident" id="2401063">mask</span>&nbsp;<span class="op" id="2401068">!=</span>&nbsp;<span class="ident" id="2401071">exited</span>&nbsp;<span class="op" id="2401078">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="2401081">func</span>&nbsp;<span class="op" id="2401086">(</span><span class="ident" id="2401087">w</span>&nbsp;<span class="ident" id="2401089">WaitStatus</span><span class="op" id="2401099">)</span>&nbsp;<span class="ident" id="2401101">Stopped</span><span class="op" id="2401108">(</span><span class="op" id="2401109">)</span>&nbsp;<span class="builtintype" id="2401111">bool</span>&nbsp;<span class="op" id="2401116">{</span>&nbsp;<span class="keyword" id="2401118">return</span>&nbsp;<span class="ident" id="2401125">w</span><span class="op" id="2401126">&amp;</span><span class="num" id="2401127">0xFF</span>&nbsp;<span class="op" id="2401132">==</span>&nbsp;<span class="ident" id="2401135">stopped</span>&nbsp;<span class="op" id="2401143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2401146">func</span>&nbsp;<span class="op" id="2401151">(</span><span class="ident" id="2401152">w</span>&nbsp;<span class="ident" id="2401154">WaitStatus</span><span class="op" id="2401164">)</span>&nbsp;<span class="ident" id="2401166">Continued</span><span class="op" id="2401175">(</span><span class="op" id="2401176">)</span>&nbsp;<span class="builtintype" id="2401178">bool</span>&nbsp;<span class="op" id="2401183">{</span>&nbsp;<span class="keyword" id="2401185">return</span>&nbsp;<span class="ident" id="2401192">w</span>&nbsp;<span class="op" id="2401194">==</span>&nbsp;<span class="num" id="2401197">0xFFFF</span>&nbsp;<span class="op" id="2401204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="2401207">func</span>&nbsp;<span class="op" id="2401212">(</span><span class="ident" id="2401213">w</span>&nbsp;<span class="ident" id="2401215">WaitStatus</span><span class="op" id="2401225">)</span>&nbsp;<span class="ident" id="2401227">CoreDump</span><span class="op" id="2401235">(</span><span class="op" id="2401236">)</span>&nbsp;<span class="builtintype" id="2401238">bool</span>&nbsp;<span class="op" id="2401243">{</span>&nbsp;<span class="keyword" id="2401245">return</span>&nbsp;<span class="ident" id="2401252">w</span><span class="op" id="2401253">.</span><span class="ident" id="2401254">Signaled</span><span class="op" id="2401262">(</span><span class="op" id="2401263">)</span>&nbsp;<span class="op" id="2401265">&amp;&amp;</span>&nbsp;<span class="ident" id="2401268">w</span><span class="op" id="2401269">&amp;</span><span class="ident" id="2401270">core</span>&nbsp;<span class="op" id="2401275">!=</span>&nbsp;<span class="num" id="2401278">0</span>&nbsp;<span class="op" id="2401280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2401283">func</span>&nbsp;<span class="op" id="2401288">(</span><span class="ident" id="2401289">w</span>&nbsp;<span class="ident" id="2401291">WaitStatus</span><span class="op" id="2401301">)</span>&nbsp;<span class="ident" id="2401303">ExitStatus</span><span class="op" id="2401313">(</span><span class="op" id="2401314">)</span>&nbsp;<span class="builtintype" id="2401316">int</span>&nbsp;<span class="op" id="2401320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401323">if</span>&nbsp;<span class="op" id="2401326">!</span><span class="ident" id="2401327">w</span><span class="op" id="2401328">.</span><span class="ident" id="2401329">Exited</span><span class="op" id="2401335">(</span><span class="op" id="2401336">)</span>&nbsp;<span class="op" id="2401338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401342">return</span>&nbsp;<span class="op" id="2401349">-</span><span class="num" id="2401350">1</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2401353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401356">return</span>&nbsp;<span class="builtintype" id="2401363">int</span><span class="op" id="2401366">(</span><span class="ident" id="2401367">w</span><span class="op" id="2401368">&gt;&gt;</span><span class="ident" id="2401370">shift</span><span class="op" id="2401375">)</span>&nbsp;<span class="op" id="2401377">&amp;</span>&nbsp;<span class="num" id="2401379">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2401384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2401387">func</span>&nbsp;<span class="op" id="2401392">(</span><span class="ident" id="2401393">w</span>&nbsp;<span class="ident" id="2401395">WaitStatus</span><span class="op" id="2401405">)</span>&nbsp;<span class="ident" id="2401407">Signal</span><span class="op" id="2401413">(</span><span class="op" id="2401414">)</span>&nbsp;<span class="ident" id="2401416">Signal</span>&nbsp;<span class="op" id="2401423">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401426">if</span>&nbsp;<span class="op" id="2401429">!</span><span class="ident" id="2401430">w</span><span class="op" id="2401431">.</span><span class="ident" id="2401432">Signaled</span><span class="op" id="2401440">(</span><span class="op" id="2401441">)</span>&nbsp;<span class="op" id="2401443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401447">return</span>&nbsp;<span class="op" id="2401454">-</span><span class="num" id="2401455">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2401458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401461">return</span>&nbsp;<span class="ident" id="2401468">Signal</span><span class="op" id="2401474">(</span><span class="ident" id="2401475">w</span>&nbsp;<span class="op" id="2401477">&amp;</span>&nbsp;<span class="ident" id="2401479">mask</span><span class="op" id="2401483">)</span><br>
<span class="lineno"></span><span class="op" id="2401485">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="2401488">func</span>&nbsp;<span class="op" id="2401493">(</span><span class="ident" id="2401494">w</span>&nbsp;<span class="ident" id="2401496">WaitStatus</span><span class="op" id="2401506">)</span>&nbsp;<span class="ident" id="2401508">StopSignal</span><span class="op" id="2401518">(</span><span class="op" id="2401519">)</span>&nbsp;<span class="ident" id="2401521">Signal</span>&nbsp;<span class="op" id="2401528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401531">if</span>&nbsp;<span class="op" id="2401534">!</span><span class="ident" id="2401535">w</span><span class="op" id="2401536">.</span><span class="ident" id="2401537">Stopped</span><span class="op" id="2401544">(</span><span class="op" id="2401545">)</span>&nbsp;<span class="op" id="2401547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401551">return</span>&nbsp;<span class="op" id="2401558">-</span><span class="num" id="2401559">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2401562">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401565">return</span>&nbsp;<span class="ident" id="2401572">Signal</span><span class="op" id="2401578">(</span><span class="ident" id="2401579">w</span><span class="op" id="2401580">&gt;&gt;</span><span class="ident" id="2401582">shift</span><span class="op" id="2401587">)</span>&nbsp;<span class="op" id="2401589">&amp;</span>&nbsp;<span class="num" id="2401591">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2401596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2401599">func</span>&nbsp;<span class="op" id="2401604">(</span><span class="ident" id="2401605">w</span>&nbsp;<span class="ident" id="2401607">WaitStatus</span><span class="op" id="2401617">)</span>&nbsp;<span class="ident" id="2401619">TrapCause</span><span class="op" id="2401628">(</span><span class="op" id="2401629">)</span>&nbsp;<span class="builtintype" id="2401631">int</span>&nbsp;<span class="op" id="2401635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401638">if</span>&nbsp;<span class="ident" id="2401641">w</span><span class="op" id="2401642">.</span><span class="ident" id="2401643">StopSignal</span><span class="op" id="2401653">(</span><span class="op" id="2401654">)</span>&nbsp;<span class="op" id="2401656">!=</span>&nbsp;<span class="ident" id="2401659">SIGTRAP</span>&nbsp;<span class="op" id="2401667">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401671">return</span>&nbsp;<span class="op" id="2401678">-</span><span class="num" id="2401679">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2401682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401685">return</span>&nbsp;<span class="builtintype" id="2401692">int</span><span class="op" id="2401695">(</span><span class="ident" id="2401696">w</span><span class="op" id="2401697">&gt;&gt;</span><span class="ident" id="2401699">shift</span><span class="op" id="2401704">)</span>&nbsp;<span class="op" id="2401706">&gt;&gt;</span>&nbsp;<span class="num" id="2401709">8</span><br>
<span class="lineno"></span><span class="op" id="2401711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2401714">//sys&nbsp;&nbsp;&nbsp;&nbspwait4(pid&nbsp;int,&nbsp;wstatus&nbsp;*_C_int,&nbsp;options&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(wpid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2401804">func</span>&nbsp;<span class="ident" id="2401809">Wait4</span><span class="op" id="2401814">(</span><span class="ident" id="2401815">pid</span>&nbsp;<span class="builtintype" id="2401819">int</span><span class="op" id="2401822">,</span>&nbsp;<span class="ident" id="2401824">wstatus</span>&nbsp;<span class="op" id="2401832">*</span><span class="ident" id="2401833">WaitStatus</span><span class="op" id="2401843">,</span>&nbsp;<span class="ident" id="2401845">options</span>&nbsp;<span class="builtintype" id="2401853">int</span><span class="op" id="2401856">,</span>&nbsp;<span class="ident" id="2401858">rusage</span>&nbsp;<span class="op" id="2401865">*</span><span class="ident" id="2401866">Rusage</span><span class="op" id="2401872">)</span>&nbsp;<span class="op" id="2401874">(</span><span class="ident" id="2401875">wpid</span>&nbsp;<span class="builtintype" id="2401880">int</span><span class="op" id="2401883">,</span>&nbsp;<span class="ident" id="2401885">err</span>&nbsp;<span class="builtintype" id="2401889">error</span><span class="op" id="2401894">)</span>&nbsp;<span class="op" id="2401896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401899">var</span>&nbsp;<span class="ident" id="2401903">status</span>&nbsp;<span class="ident" id="2401910">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2401918">wpid</span><span class="op" id="2401922">,</span>&nbsp;<span class="ident" id="2401924">err</span>&nbsp;<span class="op" id="2401928">=</span>&nbsp;<span class="ident" id="2401930">wait4</span><span class="op" id="2401935">(</span><span class="ident" id="2401936">pid</span><span class="op" id="2401939">,</span>&nbsp;<span class="op" id="2401941">&amp;</span><span class="ident" id="2401942">status</span><span class="op" id="2401948">,</span>&nbsp;<span class="ident" id="2401950">options</span><span class="op" id="2401957">,</span>&nbsp;<span class="ident" id="2401959">rusage</span><span class="op" id="2401965">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2401968">if</span>&nbsp;<span class="ident" id="2401971">wstatus</span>&nbsp;<span class="op" id="2401979">!=</span>&nbsp;<span class="ident" id="2401982">nil</span>&nbsp;<span class="op" id="2401986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2401990">*</span><span class="ident" id="2401991">wstatus</span>&nbsp;<span class="op" id="2401999">=</span>&nbsp;<span class="ident" id="2402001">WaitStatus</span><span class="op" id="2402011">(</span><span class="ident" id="2402012">status</span><span class="op" id="2402018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2402021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402024">return</span><br>
<span class="lineno"></span><span class="op" id="2402031">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="2402034">func</span>&nbsp;<span class="ident" id="2402039">Mkfifo</span><span class="op" id="2402045">(</span><span class="ident" id="2402046">path</span>&nbsp;<span class="builtintype" id="2402051">string</span><span class="op" id="2402057">,</span>&nbsp;<span class="ident" id="2402059">mode</span>&nbsp;<span class="builtintype" id="2402064">uint32</span><span class="op" id="2402070">)</span>&nbsp;<span class="op" id="2402072">(</span><span class="ident" id="2402073">err</span>&nbsp;<span class="builtintype" id="2402077">error</span><span class="op" id="2402082">)</span>&nbsp;<span class="op" id="2402084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402087">return</span>&nbsp;<span class="ident" id="2402094">Mknod</span><span class="op" id="2402099">(</span><span class="ident" id="2402100">path</span><span class="op" id="2402104">,</span>&nbsp;<span class="ident" id="2402106">mode</span><span class="op" id="2402110">|</span><span class="ident" id="2402111">S_IFIFO</span><span class="op" id="2402118">,</span>&nbsp;<span class="num" id="2402120">0</span><span class="op" id="2402121">)</span><br>
<span class="lineno"></span><span class="op" id="2402123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="2402126">func</span>&nbsp;<span class="op" id="2402131">(</span><span class="ident" id="2402132">sa</span>&nbsp;<span class="op" id="2402135">*</span><span class="ident" id="2402136">SockaddrInet4</span><span class="op" id="2402149">)</span>&nbsp;<span class="ident" id="2402151">sockaddr</span><span class="op" id="2402159">(</span><span class="op" id="2402160">)</span>&nbsp;<span class="op" id="2402162">(</span><span class="ident" id="2402163">unsafe</span><span class="op" id="2402169">.</span><span class="ident" id="2402170">Pointer</span><span class="op" id="2402177">,</span>&nbsp;<span class="ident" id="2402179">_Socklen</span><span class="op" id="2402187">,</span>&nbsp;<span class="builtintype" id="2402189">error</span><span class="op" id="2402194">)</span>&nbsp;<span class="op" id="2402196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402199">if</span>&nbsp;<span class="ident" id="2402202">sa</span><span class="op" id="2402204">.</span><span class="ident" id="2402205">Port</span>&nbsp;<span class="op" id="2402210">&lt;</span>&nbsp;<span class="num" id="2402212">0</span>&nbsp;<span class="op" id="2402214">||</span>&nbsp;<span class="ident" id="2402217">sa</span><span class="op" id="2402219">.</span><span class="ident" id="2402220">Port</span>&nbsp;<span class="op" id="2402225">&gt;</span>&nbsp;<span class="num" id="2402227">0xFFFF</span>&nbsp;<span class="op" id="2402234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402238">return</span>&nbsp;<span class="ident" id="2402245">nil</span><span class="op" id="2402248">,</span>&nbsp;<span class="num" id="2402250">0</span><span class="op" id="2402251">,</span>&nbsp;<span class="ident" id="2402253">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2402261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402264">sa</span><span class="op" id="2402266">.</span><span class="ident" id="2402267">raw</span><span class="op" id="2402270">.</span><span class="ident" id="2402271">Family</span>&nbsp;<span class="op" id="2402278">=</span>&nbsp;<span class="ident" id="2402280">AF_INET</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402289">p</span>&nbsp;<span class="op" id="2402291">:=</span>&nbsp;<span class="op" id="2402294">(</span><span class="op" id="2402295">*</span><span class="op" id="2402296">[</span><span class="num" id="2402297">2</span><span class="op" id="2402298">]</span><span class="builtintype" id="2402299">byte</span><span class="op" id="2402303">)</span><span class="op" id="2402304">(</span><span class="ident" id="2402305">unsafe</span><span class="op" id="2402311">.</span><span class="ident" id="2402312">Pointer</span><span class="op" id="2402319">(</span><span class="op" id="2402320">&amp;</span><span class="ident" id="2402321">sa</span><span class="op" id="2402323">.</span><span class="ident" id="2402324">raw</span><span class="op" id="2402327">.</span><span class="ident" id="2402328">Port</span><span class="op" id="2402332">)</span><span class="op" id="2402333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402336">p</span><span class="op" id="2402337">[</span><span class="num" id="2402338">0</span><span class="op" id="2402339">]</span>&nbsp;<span class="op" id="2402341">=</span>&nbsp;<span class="builtintype" id="2402343">byte</span><span class="op" id="2402347">(</span><span class="ident" id="2402348">sa</span><span class="op" id="2402350">.</span><span class="ident" id="2402351">Port</span>&nbsp;<span class="op" id="2402356">&gt;&gt;</span>&nbsp;<span class="num" id="2402359">8</span><span class="op" id="2402360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402363">p</span><span class="op" id="2402364">[</span><span class="num" id="2402365">1</span><span class="op" id="2402366">]</span>&nbsp;<span class="op" id="2402368">=</span>&nbsp;<span class="builtintype" id="2402370">byte</span><span class="op" id="2402374">(</span><span class="ident" id="2402375">sa</span><span class="op" id="2402377">.</span><span class="ident" id="2402378">Port</span><span class="op" id="2402382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402385">for</span>&nbsp;<span class="ident" id="2402389">i</span>&nbsp;<span class="op" id="2402391">:=</span>&nbsp;<span class="num" id="2402394">0</span><span class="op" id="2402395">;</span>&nbsp;<span class="ident" id="2402397">i</span>&nbsp;<span class="op" id="2402399">&lt;</span>&nbsp;<span class="builtinfunc" id="2402401">len</span><span class="op" id="2402404">(</span><span class="ident" id="2402405">sa</span><span class="op" id="2402407">.</span><span class="ident" id="2402408">Addr</span><span class="op" id="2402412">)</span><span class="op" id="2402413">;</span>&nbsp;<span class="ident" id="2402415">i</span><span class="op" id="2402416">++</span>&nbsp;<span class="op" id="2402419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402423">sa</span><span class="op" id="2402425">.</span><span class="ident" id="2402426">raw</span><span class="op" id="2402429">.</span><span class="ident" id="2402430">Addr</span><span class="op" id="2402434">[</span><span class="ident" id="2402435">i</span><span class="op" id="2402436">]</span>&nbsp;<span class="op" id="2402438">=</span>&nbsp;<span class="ident" id="2402440">sa</span><span class="op" id="2402442">.</span><span class="ident" id="2402443">Addr</span><span class="op" id="2402447">[</span><span class="ident" id="2402448">i</span><span class="op" id="2402449">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2402452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402455">return</span>&nbsp;<span class="ident" id="2402462">unsafe</span><span class="op" id="2402468">.</span><span class="ident" id="2402469">Pointer</span><span class="op" id="2402476">(</span><span class="op" id="2402477">&amp;</span><span class="ident" id="2402478">sa</span><span class="op" id="2402480">.</span><span class="ident" id="2402481">raw</span><span class="op" id="2402484">)</span><span class="op" id="2402485">,</span>&nbsp;<span class="ident" id="2402487">SizeofSockaddrInet4</span><span class="op" id="2402506">,</span>&nbsp;<span class="ident" id="2402508">nil</span><br>
<span class="lineno"></span><span class="op" id="2402512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2402515">func</span>&nbsp;<span class="op" id="2402520">(</span><span class="ident" id="2402521">sa</span>&nbsp;<span class="op" id="2402524">*</span><span class="ident" id="2402525">SockaddrInet6</span><span class="op" id="2402538">)</span>&nbsp;<span class="ident" id="2402540">sockaddr</span><span class="op" id="2402548">(</span><span class="op" id="2402549">)</span>&nbsp;<span class="op" id="2402551">(</span><span class="ident" id="2402552">unsafe</span><span class="op" id="2402558">.</span><span class="ident" id="2402559">Pointer</span><span class="op" id="2402566">,</span>&nbsp;<span class="ident" id="2402568">_Socklen</span><span class="op" id="2402576">,</span>&nbsp;<span class="builtintype" id="2402578">error</span><span class="op" id="2402583">)</span>&nbsp;<span class="op" id="2402585">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402588">if</span>&nbsp;<span class="ident" id="2402591">sa</span><span class="op" id="2402593">.</span><span class="ident" id="2402594">Port</span>&nbsp;<span class="op" id="2402599">&lt;</span>&nbsp;<span class="num" id="2402601">0</span>&nbsp;<span class="op" id="2402603">||</span>&nbsp;<span class="ident" id="2402606">sa</span><span class="op" id="2402608">.</span><span class="ident" id="2402609">Port</span>&nbsp;<span class="op" id="2402614">&gt;</span>&nbsp;<span class="num" id="2402616">0xFFFF</span>&nbsp;<span class="op" id="2402623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402627">return</span>&nbsp;<span class="ident" id="2402634">nil</span><span class="op" id="2402637">,</span>&nbsp;<span class="num" id="2402639">0</span><span class="op" id="2402640">,</span>&nbsp;<span class="ident" id="2402642">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2402650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402653">sa</span><span class="op" id="2402655">.</span><span class="ident" id="2402656">raw</span><span class="op" id="2402659">.</span><span class="ident" id="2402660">Family</span>&nbsp;<span class="op" id="2402667">=</span>&nbsp;<span class="ident" id="2402669">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402679">p</span>&nbsp;<span class="op" id="2402681">:=</span>&nbsp;<span class="op" id="2402684">(</span><span class="op" id="2402685">*</span><span class="op" id="2402686">[</span><span class="num" id="2402687">2</span><span class="op" id="2402688">]</span><span class="builtintype" id="2402689">byte</span><span class="op" id="2402693">)</span><span class="op" id="2402694">(</span><span class="ident" id="2402695">unsafe</span><span class="op" id="2402701">.</span><span class="ident" id="2402702">Pointer</span><span class="op" id="2402709">(</span><span class="op" id="2402710">&amp;</span><span class="ident" id="2402711">sa</span><span class="op" id="2402713">.</span><span class="ident" id="2402714">raw</span><span class="op" id="2402717">.</span><span class="ident" id="2402718">Port</span><span class="op" id="2402722">)</span><span class="op" id="2402723">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402726">p</span><span class="op" id="2402727">[</span><span class="num" id="2402728">0</span><span class="op" id="2402729">]</span>&nbsp;<span class="op" id="2402731">=</span>&nbsp;<span class="builtintype" id="2402733">byte</span><span class="op" id="2402737">(</span><span class="ident" id="2402738">sa</span><span class="op" id="2402740">.</span><span class="ident" id="2402741">Port</span>&nbsp;<span class="op" id="2402746">&gt;&gt;</span>&nbsp;<span class="num" id="2402749">8</span><span class="op" id="2402750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402753">p</span><span class="op" id="2402754">[</span><span class="num" id="2402755">1</span><span class="op" id="2402756">]</span>&nbsp;<span class="op" id="2402758">=</span>&nbsp;<span class="builtintype" id="2402760">byte</span><span class="op" id="2402764">(</span><span class="ident" id="2402765">sa</span><span class="op" id="2402767">.</span><span class="ident" id="2402768">Port</span><span class="op" id="2402772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402775">sa</span><span class="op" id="2402777">.</span><span class="ident" id="2402778">raw</span><span class="op" id="2402781">.</span><span class="ident" id="2402782">Scope_id</span>&nbsp;<span class="op" id="2402791">=</span>&nbsp;<span class="ident" id="2402793">sa</span><span class="op" id="2402795">.</span><span class="ident" id="2402796">ZoneId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402804">for</span>&nbsp;<span class="ident" id="2402808">i</span>&nbsp;<span class="op" id="2402810">:=</span>&nbsp;<span class="num" id="2402813">0</span><span class="op" id="2402814">;</span>&nbsp;<span class="ident" id="2402816">i</span>&nbsp;<span class="op" id="2402818">&lt;</span>&nbsp;<span class="builtinfunc" id="2402820">len</span><span class="op" id="2402823">(</span><span class="ident" id="2402824">sa</span><span class="op" id="2402826">.</span><span class="ident" id="2402827">Addr</span><span class="op" id="2402831">)</span><span class="op" id="2402832">;</span>&nbsp;<span class="ident" id="2402834">i</span><span class="op" id="2402835">++</span>&nbsp;<span class="op" id="2402838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402842">sa</span><span class="op" id="2402844">.</span><span class="ident" id="2402845">raw</span><span class="op" id="2402848">.</span><span class="ident" id="2402849">Addr</span><span class="op" id="2402853">[</span><span class="ident" id="2402854">i</span><span class="op" id="2402855">]</span>&nbsp;<span class="op" id="2402857">=</span>&nbsp;<span class="ident" id="2402859">sa</span><span class="op" id="2402861">.</span><span class="ident" id="2402862">Addr</span><span class="op" id="2402866">[</span><span class="ident" id="2402867">i</span><span class="op" id="2402868">]</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2402871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402874">return</span>&nbsp;<span class="ident" id="2402881">unsafe</span><span class="op" id="2402887">.</span><span class="ident" id="2402888">Pointer</span><span class="op" id="2402895">(</span><span class="op" id="2402896">&amp;</span><span class="ident" id="2402897">sa</span><span class="op" id="2402899">.</span><span class="ident" id="2402900">raw</span><span class="op" id="2402903">)</span><span class="op" id="2402904">,</span>&nbsp;<span class="ident" id="2402906">SizeofSockaddrInet6</span><span class="op" id="2402925">,</span>&nbsp;<span class="ident" id="2402927">nil</span><br>
<span class="lineno"></span><span class="op" id="2402931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2402934">func</span>&nbsp;<span class="op" id="2402939">(</span><span class="ident" id="2402940">sa</span>&nbsp;<span class="op" id="2402943">*</span><span class="ident" id="2402944">SockaddrUnix</span><span class="op" id="2402956">)</span>&nbsp;<span class="ident" id="2402958">sockaddr</span><span class="op" id="2402966">(</span><span class="op" id="2402967">)</span>&nbsp;<span class="op" id="2402969">(</span><span class="ident" id="2402970">unsafe</span><span class="op" id="2402976">.</span><span class="ident" id="2402977">Pointer</span><span class="op" id="2402984">,</span>&nbsp;<span class="ident" id="2402986">_Socklen</span><span class="op" id="2402994">,</span>&nbsp;<span class="builtintype" id="2402996">error</span><span class="op" id="2403001">)</span>&nbsp;<span class="op" id="2403003">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403006">name</span>&nbsp;<span class="op" id="2403011">:=</span>&nbsp;<span class="ident" id="2403014">sa</span><span class="op" id="2403016">.</span><span class="ident" id="2403017">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403023">n</span>&nbsp;<span class="op" id="2403025">:=</span>&nbsp;<span class="builtinfunc" id="2403028">len</span><span class="op" id="2403031">(</span><span class="ident" id="2403032">name</span><span class="op" id="2403036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403039">if</span>&nbsp;<span class="ident" id="2403042">n</span>&nbsp;<span class="op" id="2403044">&gt;=</span>&nbsp;<span class="builtinfunc" id="2403047">len</span><span class="op" id="2403050">(</span><span class="ident" id="2403051">sa</span><span class="op" id="2403053">.</span><span class="ident" id="2403054">raw</span><span class="op" id="2403057">.</span><span class="ident" id="2403058">Path</span><span class="op" id="2403062">)</span>&nbsp;<span class="op" id="2403064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403068">return</span>&nbsp;<span class="ident" id="2403075">nil</span><span class="op" id="2403078">,</span>&nbsp;<span class="num" id="2403080">0</span><span class="op" id="2403081">,</span>&nbsp;<span class="ident" id="2403083">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2403091">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403094">sa</span><span class="op" id="2403096">.</span><span class="ident" id="2403097">raw</span><span class="op" id="2403100">.</span><span class="ident" id="2403101">Family</span>&nbsp;<span class="op" id="2403108">=</span>&nbsp;<span class="ident" id="2403110">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403119">for</span>&nbsp;<span class="ident" id="2403123">i</span>&nbsp;<span class="op" id="2403125">:=</span>&nbsp;<span class="num" id="2403128">0</span><span class="op" id="2403129">;</span>&nbsp;<span class="ident" id="2403131">i</span>&nbsp;<span class="op" id="2403133">&lt;</span>&nbsp;<span class="ident" id="2403135">n</span><span class="op" id="2403136">;</span>&nbsp;<span class="ident" id="2403138">i</span><span class="op" id="2403139">++</span>&nbsp;<span class="op" id="2403142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403146">sa</span><span class="op" id="2403148">.</span><span class="ident" id="2403149">raw</span><span class="op" id="2403152">.</span><span class="ident" id="2403153">Path</span><span class="op" id="2403157">[</span><span class="ident" id="2403158">i</span><span class="op" id="2403159">]</span>&nbsp;<span class="op" id="2403161">=</span>&nbsp;<span class="builtintype" id="2403163">int8</span><span class="op" id="2403167">(</span><span class="ident" id="2403168">name</span><span class="op" id="2403172">[</span><span class="ident" id="2403173">i</span><span class="op" id="2403174">]</span><span class="op" id="2403175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2403178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2403181">//&nbsp;length&nbsp;is&nbsp;family&nbsp;(uint16),&nbsp;name,&nbsp;NUL.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403223">sl</span>&nbsp;<span class="op" id="2403226">:=</span>&nbsp;<span class="ident" id="2403229">_Socklen</span><span class="op" id="2403237">(</span><span class="num" id="2403238">2</span><span class="op" id="2403239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403242">if</span>&nbsp;<span class="ident" id="2403245">n</span>&nbsp;<span class="op" id="2403247">&gt;</span>&nbsp;<span class="num" id="2403249">0</span>&nbsp;<span class="op" id="2403251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403255">sl</span>&nbsp;<span class="op" id="2403258">+=</span>&nbsp;<span class="ident" id="2403261">_Socklen</span><span class="op" id="2403269">(</span><span class="ident" id="2403270">n</span><span class="op" id="2403271">)</span>&nbsp;<span class="op" id="2403273">+</span>&nbsp;<span class="num" id="2403275">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2403278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403281">if</span>&nbsp;<span class="ident" id="2403284">sa</span><span class="op" id="2403286">.</span><span class="ident" id="2403287">raw</span><span class="op" id="2403290">.</span><span class="ident" id="2403291">Path</span><span class="op" id="2403295">[</span><span class="num" id="2403296">0</span><span class="op" id="2403297">]</span>&nbsp;<span class="op" id="2403299">==</span>&nbsp;<span class="string" id="2403302">&#39;@&#39;</span>&nbsp;<span class="op" id="2403306">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403310">sa</span><span class="op" id="2403312">.</span><span class="ident" id="2403313">raw</span><span class="op" id="2403316">.</span><span class="ident" id="2403317">Path</span><span class="op" id="2403321">[</span><span class="num" id="2403322">0</span><span class="op" id="2403323">]</span>&nbsp;<span class="op" id="2403325">=</span>&nbsp;<span class="num" id="2403327">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2403331">//&nbsp;Don&#39;t&nbsp;count&nbsp;trailing&nbsp;NUL&nbsp;for&nbsp;abstract&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403383">sl</span><span class="op" id="2403385">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2403389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403393">return</span>&nbsp;<span class="ident" id="2403400">unsafe</span><span class="op" id="2403406">.</span><span class="ident" id="2403407">Pointer</span><span class="op" id="2403414">(</span><span class="op" id="2403415">&amp;</span><span class="ident" id="2403416">sa</span><span class="op" id="2403418">.</span><span class="ident" id="2403419">raw</span><span class="op" id="2403422">)</span><span class="op" id="2403423">,</span>&nbsp;<span class="ident" id="2403425">sl</span><span class="op" id="2403427">,</span>&nbsp;<span class="ident" id="2403429">nil</span><br>
<span class="lineno"></span><span class="op" id="2403433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2403436">type</span>&nbsp;<span class="ident" id="2403441">SockaddrLinklayer</span>&nbsp;<span class="keyword" id="2403459">struct</span>&nbsp;<span class="op" id="2403466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403469">Protocol</span>&nbsp;<span class="builtintype" id="2403478">uint16</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403486">Ifindex</span>&nbsp;&nbsp;<span class="builtintype" id="2403495">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403500">Hatype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2403509">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403517">Pkttype</span>&nbsp;&nbsp;<span class="builtintype" id="2403526">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403533">Halen</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2403542">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403549">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2403558">[</span><span class="num" id="2403559">8</span><span class="op" id="2403560">]</span><span class="builtintype" id="2403561">byte</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403567">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2403576">RawSockaddrLinklayer</span><br>
<span class="lineno"></span><span class="op" id="2403597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2403600">func</span>&nbsp;<span class="op" id="2403605">(</span><span class="ident" id="2403606">sa</span>&nbsp;<span class="op" id="2403609">*</span><span class="ident" id="2403610">SockaddrLinklayer</span><span class="op" id="2403627">)</span>&nbsp;<span class="ident" id="2403629">sockaddr</span><span class="op" id="2403637">(</span><span class="op" id="2403638">)</span>&nbsp;<span class="op" id="2403640">(</span><span class="ident" id="2403641">unsafe</span><span class="op" id="2403647">.</span><span class="ident" id="2403648">Pointer</span><span class="op" id="2403655">,</span>&nbsp;<span class="ident" id="2403657">_Socklen</span><span class="op" id="2403665">,</span>&nbsp;<span class="builtintype" id="2403667">error</span><span class="op" id="2403672">)</span>&nbsp;<span class="op" id="2403674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403677">if</span>&nbsp;<span class="ident" id="2403680">sa</span><span class="op" id="2403682">.</span><span class="ident" id="2403683">Ifindex</span>&nbsp;<span class="op" id="2403691">&lt;</span>&nbsp;<span class="num" id="2403693">0</span>&nbsp;<span class="op" id="2403695">||</span>&nbsp;<span class="ident" id="2403698">sa</span><span class="op" id="2403700">.</span><span class="ident" id="2403701">Ifindex</span>&nbsp;<span class="op" id="2403709">&gt;</span>&nbsp;<span class="num" id="2403711">0x7fffffff</span>&nbsp;<span class="op" id="2403722">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403726">return</span>&nbsp;<span class="ident" id="2403733">nil</span><span class="op" id="2403736">,</span>&nbsp;<span class="num" id="2403738">0</span><span class="op" id="2403739">,</span>&nbsp;<span class="ident" id="2403741">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2403749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403752">sa</span><span class="op" id="2403754">.</span><span class="ident" id="2403755">raw</span><span class="op" id="2403758">.</span><span class="ident" id="2403759">Family</span>&nbsp;<span class="op" id="2403766">=</span>&nbsp;<span class="ident" id="2403768">AF_PACKET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403779">sa</span><span class="op" id="2403781">.</span><span class="ident" id="2403782">raw</span><span class="op" id="2403785">.</span><span class="ident" id="2403786">Protocol</span>&nbsp;<span class="op" id="2403795">=</span>&nbsp;<span class="ident" id="2403797">sa</span><span class="op" id="2403799">.</span><span class="ident" id="2403800">Protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403810">sa</span><span class="op" id="2403812">.</span><span class="ident" id="2403813">raw</span><span class="op" id="2403816">.</span><span class="ident" id="2403817">Ifindex</span>&nbsp;<span class="op" id="2403825">=</span>&nbsp;<span class="builtintype" id="2403827">int32</span><span class="op" id="2403832">(</span><span class="ident" id="2403833">sa</span><span class="op" id="2403835">.</span><span class="ident" id="2403836">Ifindex</span><span class="op" id="2403843">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403846">sa</span><span class="op" id="2403848">.</span><span class="ident" id="2403849">raw</span><span class="op" id="2403852">.</span><span class="ident" id="2403853">Hatype</span>&nbsp;<span class="op" id="2403860">=</span>&nbsp;<span class="ident" id="2403862">sa</span><span class="op" id="2403864">.</span><span class="ident" id="2403865">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403873">sa</span><span class="op" id="2403875">.</span><span class="ident" id="2403876">raw</span><span class="op" id="2403879">.</span><span class="ident" id="2403880">Pkttype</span>&nbsp;<span class="op" id="2403888">=</span>&nbsp;<span class="ident" id="2403890">sa</span><span class="op" id="2403892">.</span><span class="ident" id="2403893">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403902">sa</span><span class="op" id="2403904">.</span><span class="ident" id="2403905">raw</span><span class="op" id="2403908">.</span><span class="ident" id="2403909">Halen</span>&nbsp;<span class="op" id="2403915">=</span>&nbsp;<span class="ident" id="2403917">sa</span><span class="op" id="2403919">.</span><span class="ident" id="2403920">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403927">for</span>&nbsp;<span class="ident" id="2403931">i</span>&nbsp;<span class="op" id="2403933">:=</span>&nbsp;<span class="num" id="2403936">0</span><span class="op" id="2403937">;</span>&nbsp;<span class="ident" id="2403939">i</span>&nbsp;<span class="op" id="2403941">&lt;</span>&nbsp;<span class="builtinfunc" id="2403943">len</span><span class="op" id="2403946">(</span><span class="ident" id="2403947">sa</span><span class="op" id="2403949">.</span><span class="ident" id="2403950">Addr</span><span class="op" id="2403954">)</span><span class="op" id="2403955">;</span>&nbsp;<span class="ident" id="2403957">i</span><span class="op" id="2403958">++</span>&nbsp;<span class="op" id="2403961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403965">sa</span><span class="op" id="2403967">.</span><span class="ident" id="2403968">raw</span><span class="op" id="2403971">.</span><span class="ident" id="2403972">Addr</span><span class="op" id="2403976">[</span><span class="ident" id="2403977">i</span><span class="op" id="2403978">]</span>&nbsp;<span class="op" id="2403980">=</span>&nbsp;<span class="ident" id="2403982">sa</span><span class="op" id="2403984">.</span><span class="ident" id="2403985">Addr</span><span class="op" id="2403989">[</span><span class="ident" id="2403990">i</span><span class="op" id="2403991">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2403994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403997">return</span>&nbsp;<span class="ident" id="2404004">unsafe</span><span class="op" id="2404010">.</span><span class="ident" id="2404011">Pointer</span><span class="op" id="2404018">(</span><span class="op" id="2404019">&amp;</span><span class="ident" id="2404020">sa</span><span class="op" id="2404022">.</span><span class="ident" id="2404023">raw</span><span class="op" id="2404026">)</span><span class="op" id="2404027">,</span>&nbsp;<span class="ident" id="2404029">SizeofSockaddrLinklayer</span><span class="op" id="2404052">,</span>&nbsp;<span class="ident" id="2404054">nil</span><br>
<span class="lineno"></span><span class="op" id="2404058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2404061">type</span>&nbsp;<span class="ident" id="2404066">SockaddrNetlink</span>&nbsp;<span class="keyword" id="2404082">struct</span>&nbsp;<span class="op" id="2404089">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404092">Family</span>&nbsp;<span class="builtintype" id="2404099">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404107">Pad</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2404114">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404122">Pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2404129">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404137">Groups</span>&nbsp;<span class="builtintype" id="2404144">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404152">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2404159">RawSockaddrNetlink</span><br>
<span class="lineno">320</span><span class="op" id="2404178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2404181">func</span>&nbsp;<span class="op" id="2404186">(</span><span class="ident" id="2404187">sa</span>&nbsp;<span class="op" id="2404190">*</span><span class="ident" id="2404191">SockaddrNetlink</span><span class="op" id="2404206">)</span>&nbsp;<span class="ident" id="2404208">sockaddr</span><span class="op" id="2404216">(</span><span class="op" id="2404217">)</span>&nbsp;<span class="op" id="2404219">(</span><span class="ident" id="2404220">unsafe</span><span class="op" id="2404226">.</span><span class="ident" id="2404227">Pointer</span><span class="op" id="2404234">,</span>&nbsp;<span class="ident" id="2404236">_Socklen</span><span class="op" id="2404244">,</span>&nbsp;<span class="builtintype" id="2404246">error</span><span class="op" id="2404251">)</span>&nbsp;<span class="op" id="2404253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404256">sa</span><span class="op" id="2404258">.</span><span class="ident" id="2404259">raw</span><span class="op" id="2404262">.</span><span class="ident" id="2404263">Family</span>&nbsp;<span class="op" id="2404270">=</span>&nbsp;<span class="ident" id="2404272">AF_NETLINK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404284">sa</span><span class="op" id="2404286">.</span><span class="ident" id="2404287">raw</span><span class="op" id="2404290">.</span><span class="ident" id="2404291">Pad</span>&nbsp;<span class="op" id="2404295">=</span>&nbsp;<span class="ident" id="2404297">sa</span><span class="op" id="2404299">.</span><span class="ident" id="2404300">Pad</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404305">sa</span><span class="op" id="2404307">.</span><span class="ident" id="2404308">raw</span><span class="op" id="2404311">.</span><span class="ident" id="2404312">Pid</span>&nbsp;<span class="op" id="2404316">=</span>&nbsp;<span class="ident" id="2404318">sa</span><span class="op" id="2404320">.</span><span class="ident" id="2404321">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404326">sa</span><span class="op" id="2404328">.</span><span class="ident" id="2404329">raw</span><span class="op" id="2404332">.</span><span class="ident" id="2404333">Groups</span>&nbsp;<span class="op" id="2404340">=</span>&nbsp;<span class="ident" id="2404342">sa</span><span class="op" id="2404344">.</span><span class="ident" id="2404345">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404353">return</span>&nbsp;<span class="ident" id="2404360">unsafe</span><span class="op" id="2404366">.</span><span class="ident" id="2404367">Pointer</span><span class="op" id="2404374">(</span><span class="op" id="2404375">&amp;</span><span class="ident" id="2404376">sa</span><span class="op" id="2404378">.</span><span class="ident" id="2404379">raw</span><span class="op" id="2404382">)</span><span class="op" id="2404383">,</span>&nbsp;<span class="ident" id="2404385">SizeofSockaddrNetlink</span><span class="op" id="2404406">,</span>&nbsp;<span class="ident" id="2404408">nil</span><br>
<span class="lineno"></span><span class="op" id="2404412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="2404415">func</span>&nbsp;<span class="ident" id="2404420">anyToSockaddr</span><span class="op" id="2404433">(</span><span class="ident" id="2404434">rsa</span>&nbsp;<span class="op" id="2404438">*</span><span class="ident" id="2404439">RawSockaddrAny</span><span class="op" id="2404453">)</span>&nbsp;<span class="op" id="2404455">(</span><span class="ident" id="2404456">Sockaddr</span><span class="op" id="2404464">,</span>&nbsp;<span class="builtintype" id="2404466">error</span><span class="op" id="2404471">)</span>&nbsp;<span class="op" id="2404473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404476">switch</span>&nbsp;<span class="ident" id="2404483">rsa</span><span class="op" id="2404486">.</span><span class="ident" id="2404487">Addr</span><span class="op" id="2404491">.</span><span class="ident" id="2404492">Family</span>&nbsp;<span class="op" id="2404499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404502">case</span>&nbsp;<span class="ident" id="2404507">AF_NETLINK</span><span class="op" id="2404517">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404521">pp</span>&nbsp;<span class="op" id="2404524">:=</span>&nbsp;<span class="op" id="2404527">(</span><span class="op" id="2404528">*</span><span class="ident" id="2404529">RawSockaddrNetlink</span><span class="op" id="2404547">)</span><span class="op" id="2404548">(</span><span class="ident" id="2404549">unsafe</span><span class="op" id="2404555">.</span><span class="ident" id="2404556">Pointer</span><span class="op" id="2404563">(</span><span class="ident" id="2404564">rsa</span><span class="op" id="2404567">)</span><span class="op" id="2404568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404572">sa</span>&nbsp;<span class="op" id="2404575">:=</span>&nbsp;<span class="builtinfunc" id="2404578">new</span><span class="op" id="2404581">(</span><span class="ident" id="2404582">SockaddrNetlink</span><span class="op" id="2404597">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404601">sa</span><span class="op" id="2404603">.</span><span class="ident" id="2404604">Family</span>&nbsp;<span class="op" id="2404611">=</span>&nbsp;<span class="ident" id="2404613">pp</span><span class="op" id="2404615">.</span><span class="ident" id="2404616">Family</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404625">sa</span><span class="op" id="2404627">.</span><span class="ident" id="2404628">Pad</span>&nbsp;<span class="op" id="2404632">=</span>&nbsp;<span class="ident" id="2404634">pp</span><span class="op" id="2404636">.</span><span class="ident" id="2404637">Pad</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404643">sa</span><span class="op" id="2404645">.</span><span class="ident" id="2404646">Pid</span>&nbsp;<span class="op" id="2404650">=</span>&nbsp;<span class="ident" id="2404652">pp</span><span class="op" id="2404654">.</span><span class="ident" id="2404655">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404661">sa</span><span class="op" id="2404663">.</span><span class="ident" id="2404664">Groups</span>&nbsp;<span class="op" id="2404671">=</span>&nbsp;<span class="ident" id="2404673">pp</span><span class="op" id="2404675">.</span><span class="ident" id="2404676">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404685">return</span>&nbsp;<span class="ident" id="2404692">sa</span><span class="op" id="2404694">,</span>&nbsp;<span class="ident" id="2404696">nil</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404702">case</span>&nbsp;<span class="ident" id="2404707">AF_PACKET</span><span class="op" id="2404716">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404720">pp</span>&nbsp;<span class="op" id="2404723">:=</span>&nbsp;<span class="op" id="2404726">(</span><span class="op" id="2404727">*</span><span class="ident" id="2404728">RawSockaddrLinklayer</span><span class="op" id="2404748">)</span><span class="op" id="2404749">(</span><span class="ident" id="2404750">unsafe</span><span class="op" id="2404756">.</span><span class="ident" id="2404757">Pointer</span><span class="op" id="2404764">(</span><span class="ident" id="2404765">rsa</span><span class="op" id="2404768">)</span><span class="op" id="2404769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404773">sa</span>&nbsp;<span class="op" id="2404776">:=</span>&nbsp;<span class="builtinfunc" id="2404779">new</span><span class="op" id="2404782">(</span><span class="ident" id="2404783">SockaddrLinklayer</span><span class="op" id="2404800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404804">sa</span><span class="op" id="2404806">.</span><span class="ident" id="2404807">Protocol</span>&nbsp;<span class="op" id="2404816">=</span>&nbsp;<span class="ident" id="2404818">pp</span><span class="op" id="2404820">.</span><span class="ident" id="2404821">Protocol</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404832">sa</span><span class="op" id="2404834">.</span><span class="ident" id="2404835">Ifindex</span>&nbsp;<span class="op" id="2404843">=</span>&nbsp;<span class="builtintype" id="2404845">int</span><span class="op" id="2404848">(</span><span class="ident" id="2404849">pp</span><span class="op" id="2404851">.</span><span class="ident" id="2404852">Ifindex</span><span class="op" id="2404859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404863">sa</span><span class="op" id="2404865">.</span><span class="ident" id="2404866">Hatype</span>&nbsp;<span class="op" id="2404873">=</span>&nbsp;<span class="ident" id="2404875">pp</span><span class="op" id="2404877">.</span><span class="ident" id="2404878">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404887">sa</span><span class="op" id="2404889">.</span><span class="ident" id="2404890">Pkttype</span>&nbsp;<span class="op" id="2404898">=</span>&nbsp;<span class="ident" id="2404900">pp</span><span class="op" id="2404902">.</span><span class="ident" id="2404903">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404913">sa</span><span class="op" id="2404915">.</span><span class="ident" id="2404916">Halen</span>&nbsp;<span class="op" id="2404922">=</span>&nbsp;<span class="ident" id="2404924">pp</span><span class="op" id="2404926">.</span><span class="ident" id="2404927">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404935">for</span>&nbsp;<span class="ident" id="2404939">i</span>&nbsp;<span class="op" id="2404941">:=</span>&nbsp;<span class="num" id="2404944">0</span><span class="op" id="2404945">;</span>&nbsp;<span class="ident" id="2404947">i</span>&nbsp;<span class="op" id="2404949">&lt;</span>&nbsp;<span class="builtinfunc" id="2404951">len</span><span class="op" id="2404954">(</span><span class="ident" id="2404955">sa</span><span class="op" id="2404957">.</span><span class="ident" id="2404958">Addr</span><span class="op" id="2404962">)</span><span class="op" id="2404963">;</span>&nbsp;<span class="ident" id="2404965">i</span><span class="op" id="2404966">++</span>&nbsp;<span class="op" id="2404969">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404974">sa</span><span class="op" id="2404976">.</span><span class="ident" id="2404977">Addr</span><span class="op" id="2404981">[</span><span class="ident" id="2404982">i</span><span class="op" id="2404983">]</span>&nbsp;<span class="op" id="2404985">=</span>&nbsp;<span class="ident" id="2404987">pp</span><span class="op" id="2404989">.</span><span class="ident" id="2404990">Addr</span><span class="op" id="2404994">[</span><span class="ident" id="2404995">i</span><span class="op" id="2404996">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2405000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405004">return</span>&nbsp;<span class="ident" id="2405011">sa</span><span class="op" id="2405013">,</span>&nbsp;<span class="ident" id="2405015">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405021">case</span>&nbsp;<span class="ident" id="2405026">AF_UNIX</span><span class="op" id="2405033">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405037">pp</span>&nbsp;<span class="op" id="2405040">:=</span>&nbsp;<span class="op" id="2405043">(</span><span class="op" id="2405044">*</span><span class="ident" id="2405045">RawSockaddrUnix</span><span class="op" id="2405060">)</span><span class="op" id="2405061">(</span><span class="ident" id="2405062">unsafe</span><span class="op" id="2405068">.</span><span class="ident" id="2405069">Pointer</span><span class="op" id="2405076">(</span><span class="ident" id="2405077">rsa</span><span class="op" id="2405080">)</span><span class="op" id="2405081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405085">sa</span>&nbsp;<span class="op" id="2405088">:=</span>&nbsp;<span class="builtinfunc" id="2405091">new</span><span class="op" id="2405094">(</span><span class="ident" id="2405095">SockaddrUnix</span><span class="op" id="2405107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405111">if</span>&nbsp;<span class="ident" id="2405114">pp</span><span class="op" id="2405116">.</span><span class="ident" id="2405117">Path</span><span class="op" id="2405121">[</span><span class="num" id="2405122">0</span><span class="op" id="2405123">]</span>&nbsp;<span class="op" id="2405125">==</span>&nbsp;<span class="num" id="2405128">0</span>&nbsp;<span class="op" id="2405130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2405135">//&nbsp;&#34;Abstract&#34;&nbsp;Unix&nbsp;domain&nbsp;socket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2405172">//&nbsp;Rewrite&nbsp;leading&nbsp;NUL&nbsp;as&nbsp;@&nbsp;for&nbsp;textual&nbsp;display.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2405224">//&nbsp;(This&nbsp;is&nbsp;the&nbsp;standard&nbsp;convention.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2405265">//&nbsp;Not&nbsp;friendly&nbsp;to&nbsp;overwrite&nbsp;in&nbsp;place,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2405307">//&nbsp;but&nbsp;the&nbsp;callers&nbsp;below&nbsp;don&#39;t&nbsp;care.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405347">pp</span><span class="op" id="2405349">.</span><span class="ident" id="2405350">Path</span><span class="op" id="2405354">[</span><span class="num" id="2405355">0</span><span class="op" id="2405356">]</span>&nbsp;<span class="op" id="2405358">=</span>&nbsp;<span class="string" id="2405360">&#39;@&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2405366">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2405371">//&nbsp;Assume&nbsp;path&nbsp;ends&nbsp;at&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2405401">//&nbsp;This&nbsp;is&nbsp;not&nbsp;technically&nbsp;the&nbsp;Linux&nbsp;semantics&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2405454">//&nbsp;abstract&nbsp;Unix&nbsp;domain&nbsp;sockets--they&nbsp;are&nbsp;supposed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2405507">//&nbsp;to&nbsp;be&nbsp;uninterpreted&nbsp;fixed-size&nbsp;binary&nbsp;blobs--but</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2405561">//&nbsp;everyone&nbsp;uses&nbsp;this&nbsp;convention.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405597">n</span>&nbsp;<span class="op" id="2405599">:=</span>&nbsp;<span class="num" id="2405602">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405606">for</span>&nbsp;<span class="ident" id="2405610">n</span>&nbsp;<span class="op" id="2405612">&lt;</span>&nbsp;<span class="builtinfunc" id="2405614">len</span><span class="op" id="2405617">(</span><span class="ident" id="2405618">pp</span><span class="op" id="2405620">.</span><span class="ident" id="2405621">Path</span><span class="op" id="2405625">)</span>&nbsp;<span class="op" id="2405627">&amp;&amp;</span>&nbsp;<span class="ident" id="2405630">pp</span><span class="op" id="2405632">.</span><span class="ident" id="2405633">Path</span><span class="op" id="2405637">[</span><span class="ident" id="2405638">n</span><span class="op" id="2405639">]</span>&nbsp;<span class="op" id="2405641">!=</span>&nbsp;<span class="num" id="2405644">0</span>&nbsp;<span class="op" id="2405646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405651">n</span><span class="op" id="2405652">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2405657">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405661">bytes</span>&nbsp;<span class="op" id="2405667">:=</span>&nbsp;<span class="op" id="2405670">(</span><span class="op" id="2405671">*</span><span class="op" id="2405672">[</span><span class="num" id="2405673">10000</span><span class="op" id="2405678">]</span><span class="builtintype" id="2405679">byte</span><span class="op" id="2405683">)</span><span class="op" id="2405684">(</span><span class="ident" id="2405685">unsafe</span><span class="op" id="2405691">.</span><span class="ident" id="2405692">Pointer</span><span class="op" id="2405699">(</span><span class="op" id="2405700">&amp;</span><span class="ident" id="2405701">pp</span><span class="op" id="2405703">.</span><span class="ident" id="2405704">Path</span><span class="op" id="2405708">[</span><span class="num" id="2405709">0</span><span class="op" id="2405710">]</span><span class="op" id="2405711">)</span><span class="op" id="2405712">)</span><span class="op" id="2405713">[</span><span class="num" id="2405714">0</span><span class="op" id="2405715">:</span><span class="ident" id="2405716">n</span><span class="op" id="2405717">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405721">sa</span><span class="op" id="2405723">.</span><span class="ident" id="2405724">Name</span>&nbsp;<span class="op" id="2405729">=</span>&nbsp;<span class="builtintype" id="2405731">string</span><span class="op" id="2405737">(</span><span class="ident" id="2405738">bytes</span><span class="op" id="2405743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405747">return</span>&nbsp;<span class="ident" id="2405754">sa</span><span class="op" id="2405756">,</span>&nbsp;<span class="ident" id="2405758">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405764">case</span>&nbsp;<span class="ident" id="2405769">AF_INET</span><span class="op" id="2405776">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405780">pp</span>&nbsp;<span class="op" id="2405783">:=</span>&nbsp;<span class="op" id="2405786">(</span><span class="op" id="2405787">*</span><span class="ident" id="2405788">RawSockaddrInet4</span><span class="op" id="2405804">)</span><span class="op" id="2405805">(</span><span class="ident" id="2405806">unsafe</span><span class="op" id="2405812">.</span><span class="ident" id="2405813">Pointer</span><span class="op" id="2405820">(</span><span class="ident" id="2405821">rsa</span><span class="op" id="2405824">)</span><span class="op" id="2405825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405829">sa</span>&nbsp;<span class="op" id="2405832">:=</span>&nbsp;<span class="builtinfunc" id="2405835">new</span><span class="op" id="2405838">(</span><span class="ident" id="2405839">SockaddrInet4</span><span class="op" id="2405852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405856">p</span>&nbsp;<span class="op" id="2405858">:=</span>&nbsp;<span class="op" id="2405861">(</span><span class="op" id="2405862">*</span><span class="op" id="2405863">[</span><span class="num" id="2405864">2</span><span class="op" id="2405865">]</span><span class="builtintype" id="2405866">byte</span><span class="op" id="2405870">)</span><span class="op" id="2405871">(</span><span class="ident" id="2405872">unsafe</span><span class="op" id="2405878">.</span><span class="ident" id="2405879">Pointer</span><span class="op" id="2405886">(</span><span class="op" id="2405887">&amp;</span><span class="ident" id="2405888">pp</span><span class="op" id="2405890">.</span><span class="ident" id="2405891">Port</span><span class="op" id="2405895">)</span><span class="op" id="2405896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405900">sa</span><span class="op" id="2405902">.</span><span class="ident" id="2405903">Port</span>&nbsp;<span class="op" id="2405908">=</span>&nbsp;<span class="builtintype" id="2405910">int</span><span class="op" id="2405913">(</span><span class="ident" id="2405914">p</span><span class="op" id="2405915">[</span><span class="num" id="2405916">0</span><span class="op" id="2405917">]</span><span class="op" id="2405918">)</span><span class="op" id="2405919">&lt;&lt;</span><span class="num" id="2405921">8</span>&nbsp;<span class="op" id="2405923">+</span>&nbsp;<span class="builtintype" id="2405925">int</span><span class="op" id="2405928">(</span><span class="ident" id="2405929">p</span><span class="op" id="2405930">[</span><span class="num" id="2405931">1</span><span class="op" id="2405932">]</span><span class="op" id="2405933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405937">for</span>&nbsp;<span class="ident" id="2405941">i</span>&nbsp;<span class="op" id="2405943">:=</span>&nbsp;<span class="num" id="2405946">0</span><span class="op" id="2405947">;</span>&nbsp;<span class="ident" id="2405949">i</span>&nbsp;<span class="op" id="2405951">&lt;</span>&nbsp;<span class="builtinfunc" id="2405953">len</span><span class="op" id="2405956">(</span><span class="ident" id="2405957">sa</span><span class="op" id="2405959">.</span><span class="ident" id="2405960">Addr</span><span class="op" id="2405964">)</span><span class="op" id="2405965">;</span>&nbsp;<span class="ident" id="2405967">i</span><span class="op" id="2405968">++</span>&nbsp;<span class="op" id="2405971">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405976">sa</span><span class="op" id="2405978">.</span><span class="ident" id="2405979">Addr</span><span class="op" id="2405983">[</span><span class="ident" id="2405984">i</span><span class="op" id="2405985">]</span>&nbsp;<span class="op" id="2405987">=</span>&nbsp;<span class="ident" id="2405989">pp</span><span class="op" id="2405991">.</span><span class="ident" id="2405992">Addr</span><span class="op" id="2405996">[</span><span class="ident" id="2405997">i</span><span class="op" id="2405998">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2406002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406006">return</span>&nbsp;<span class="ident" id="2406013">sa</span><span class="op" id="2406015">,</span>&nbsp;<span class="ident" id="2406017">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406023">case</span>&nbsp;<span class="ident" id="2406028">AF_INET6</span><span class="op" id="2406036">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406040">pp</span>&nbsp;<span class="op" id="2406043">:=</span>&nbsp;<span class="op" id="2406046">(</span><span class="op" id="2406047">*</span><span class="ident" id="2406048">RawSockaddrInet6</span><span class="op" id="2406064">)</span><span class="op" id="2406065">(</span><span class="ident" id="2406066">unsafe</span><span class="op" id="2406072">.</span><span class="ident" id="2406073">Pointer</span><span class="op" id="2406080">(</span><span class="ident" id="2406081">rsa</span><span class="op" id="2406084">)</span><span class="op" id="2406085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406089">sa</span>&nbsp;<span class="op" id="2406092">:=</span>&nbsp;<span class="builtinfunc" id="2406095">new</span><span class="op" id="2406098">(</span><span class="ident" id="2406099">SockaddrInet6</span><span class="op" id="2406112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406116">p</span>&nbsp;<span class="op" id="2406118">:=</span>&nbsp;<span class="op" id="2406121">(</span><span class="op" id="2406122">*</span><span class="op" id="2406123">[</span><span class="num" id="2406124">2</span><span class="op" id="2406125">]</span><span class="builtintype" id="2406126">byte</span><span class="op" id="2406130">)</span><span class="op" id="2406131">(</span><span class="ident" id="2406132">unsafe</span><span class="op" id="2406138">.</span><span class="ident" id="2406139">Pointer</span><span class="op" id="2406146">(</span><span class="op" id="2406147">&amp;</span><span class="ident" id="2406148">pp</span><span class="op" id="2406150">.</span><span class="ident" id="2406151">Port</span><span class="op" id="2406155">)</span><span class="op" id="2406156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406160">sa</span><span class="op" id="2406162">.</span><span class="ident" id="2406163">Port</span>&nbsp;<span class="op" id="2406168">=</span>&nbsp;<span class="builtintype" id="2406170">int</span><span class="op" id="2406173">(</span><span class="ident" id="2406174">p</span><span class="op" id="2406175">[</span><span class="num" id="2406176">0</span><span class="op" id="2406177">]</span><span class="op" id="2406178">)</span><span class="op" id="2406179">&lt;&lt;</span><span class="num" id="2406181">8</span>&nbsp;<span class="op" id="2406183">+</span>&nbsp;<span class="builtintype" id="2406185">int</span><span class="op" id="2406188">(</span><span class="ident" id="2406189">p</span><span class="op" id="2406190">[</span><span class="num" id="2406191">1</span><span class="op" id="2406192">]</span><span class="op" id="2406193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406197">sa</span><span class="op" id="2406199">.</span><span class="ident" id="2406200">ZoneId</span>&nbsp;<span class="op" id="2406207">=</span>&nbsp;<span class="ident" id="2406209">pp</span><span class="op" id="2406211">.</span><span class="ident" id="2406212">Scope_id</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406223">for</span>&nbsp;<span class="ident" id="2406227">i</span>&nbsp;<span class="op" id="2406229">:=</span>&nbsp;<span class="num" id="2406232">0</span><span class="op" id="2406233">;</span>&nbsp;<span class="ident" id="2406235">i</span>&nbsp;<span class="op" id="2406237">&lt;</span>&nbsp;<span class="builtinfunc" id="2406239">len</span><span class="op" id="2406242">(</span><span class="ident" id="2406243">sa</span><span class="op" id="2406245">.</span><span class="ident" id="2406246">Addr</span><span class="op" id="2406250">)</span><span class="op" id="2406251">;</span>&nbsp;<span class="ident" id="2406253">i</span><span class="op" id="2406254">++</span>&nbsp;<span class="op" id="2406257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406262">sa</span><span class="op" id="2406264">.</span><span class="ident" id="2406265">Addr</span><span class="op" id="2406269">[</span><span class="ident" id="2406270">i</span><span class="op" id="2406271">]</span>&nbsp;<span class="op" id="2406273">=</span>&nbsp;<span class="ident" id="2406275">pp</span><span class="op" id="2406277">.</span><span class="ident" id="2406278">Addr</span><span class="op" id="2406282">[</span><span class="ident" id="2406283">i</span><span class="op" id="2406284">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2406288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406292">return</span>&nbsp;<span class="ident" id="2406299">sa</span><span class="op" id="2406301">,</span>&nbsp;<span class="ident" id="2406303">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2406308">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406311">return</span>&nbsp;<span class="ident" id="2406318">nil</span><span class="op" id="2406321">,</span>&nbsp;<span class="ident" id="2406323">EAFNOSUPPORT</span><br>
<span class="lineno"></span><span class="op" id="2406336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406339">func</span>&nbsp;<span class="ident" id="2406344">Accept</span><span class="op" id="2406350">(</span><span class="ident" id="2406351">fd</span>&nbsp;<span class="builtintype" id="2406354">int</span><span class="op" id="2406357">)</span>&nbsp;<span class="op" id="2406359">(</span><span class="ident" id="2406360">nfd</span>&nbsp;<span class="builtintype" id="2406364">int</span><span class="op" id="2406367">,</span>&nbsp;<span class="ident" id="2406369">sa</span>&nbsp;<span class="ident" id="2406372">Sockaddr</span><span class="op" id="2406380">,</span>&nbsp;<span class="ident" id="2406382">err</span>&nbsp;<span class="builtintype" id="2406386">error</span><span class="op" id="2406391">)</span>&nbsp;<span class="op" id="2406393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406396">var</span>&nbsp;<span class="ident" id="2406400">rsa</span>&nbsp;<span class="ident" id="2406404">RawSockaddrAny</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406420">var</span>&nbsp;<span class="builtinfunc" id="2406424">len</span>&nbsp;<span class="ident" id="2406428">_Socklen</span>&nbsp;<span class="op" id="2406437">=</span>&nbsp;<span class="ident" id="2406439">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406458">nfd</span><span class="op" id="2406461">,</span>&nbsp;<span class="ident" id="2406463">err</span>&nbsp;<span class="op" id="2406467">=</span>&nbsp;<span class="ident" id="2406469">accept</span><span class="op" id="2406475">(</span><span class="ident" id="2406476">fd</span><span class="op" id="2406478">,</span>&nbsp;<span class="op" id="2406480">&amp;</span><span class="ident" id="2406481">rsa</span><span class="op" id="2406484">,</span>&nbsp;<span class="op" id="2406486">&amp;</span><span class="builtinfunc" id="2406487">len</span><span class="op" id="2406490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406493">if</span>&nbsp;<span class="ident" id="2406496">err</span>&nbsp;<span class="op" id="2406500">!=</span>&nbsp;<span class="ident" id="2406503">nil</span>&nbsp;<span class="op" id="2406507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406511">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2406519">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406522">sa</span><span class="op" id="2406524">,</span>&nbsp;<span class="ident" id="2406526">err</span>&nbsp;<span class="op" id="2406530">=</span>&nbsp;<span class="ident" id="2406532">anyToSockaddr</span><span class="op" id="2406545">(</span><span class="op" id="2406546">&amp;</span><span class="ident" id="2406547">rsa</span><span class="op" id="2406550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406553">if</span>&nbsp;<span class="ident" id="2406556">err</span>&nbsp;<span class="op" id="2406560">!=</span>&nbsp;<span class="ident" id="2406563">nil</span>&nbsp;<span class="op" id="2406567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406571">Close</span><span class="op" id="2406576">(</span><span class="ident" id="2406577">nfd</span><span class="op" id="2406580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406584">nfd</span>&nbsp;<span class="op" id="2406588">=</span>&nbsp;<span class="num" id="2406590">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2406593">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406596">return</span><br>
<span class="lineno"></span><span class="op" id="2406603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406606">func</span>&nbsp;<span class="ident" id="2406611">Accept4</span><span class="op" id="2406618">(</span><span class="ident" id="2406619">fd</span>&nbsp;<span class="builtintype" id="2406622">int</span><span class="op" id="2406625">,</span>&nbsp;<span class="ident" id="2406627">flags</span>&nbsp;<span class="builtintype" id="2406633">int</span><span class="op" id="2406636">)</span>&nbsp;<span class="op" id="2406638">(</span><span class="ident" id="2406639">nfd</span>&nbsp;<span class="builtintype" id="2406643">int</span><span class="op" id="2406646">,</span>&nbsp;<span class="ident" id="2406648">sa</span>&nbsp;<span class="ident" id="2406651">Sockaddr</span><span class="op" id="2406659">,</span>&nbsp;<span class="ident" id="2406661">err</span>&nbsp;<span class="builtintype" id="2406665">error</span><span class="op" id="2406670">)</span>&nbsp;<span class="op" id="2406672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406675">var</span>&nbsp;<span class="ident" id="2406679">rsa</span>&nbsp;<span class="ident" id="2406683">RawSockaddrAny</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406699">var</span>&nbsp;<span class="builtinfunc" id="2406703">len</span>&nbsp;<span class="ident" id="2406707">_Socklen</span>&nbsp;<span class="op" id="2406716">=</span>&nbsp;<span class="ident" id="2406718">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406737">nfd</span><span class="op" id="2406740">,</span>&nbsp;<span class="ident" id="2406742">err</span>&nbsp;<span class="op" id="2406746">=</span>&nbsp;<span class="ident" id="2406748">accept4</span><span class="op" id="2406755">(</span><span class="ident" id="2406756">fd</span><span class="op" id="2406758">,</span>&nbsp;<span class="op" id="2406760">&amp;</span><span class="ident" id="2406761">rsa</span><span class="op" id="2406764">,</span>&nbsp;<span class="op" id="2406766">&amp;</span><span class="builtinfunc" id="2406767">len</span><span class="op" id="2406770">,</span>&nbsp;<span class="ident" id="2406772">flags</span><span class="op" id="2406777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406780">if</span>&nbsp;<span class="ident" id="2406783">err</span>&nbsp;<span class="op" id="2406787">!=</span>&nbsp;<span class="ident" id="2406790">nil</span>&nbsp;<span class="op" id="2406794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406798">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2406806">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406809">if</span>&nbsp;<span class="builtinfunc" id="2406812">len</span>&nbsp;<span class="op" id="2406816">&gt;</span>&nbsp;<span class="ident" id="2406818">SizeofSockaddrAny</span>&nbsp;<span class="op" id="2406836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2406840">panic</span><span class="op" id="2406845">(</span><span class="string" id="2406846">&#34;RawSockaddrAny&nbsp;too&nbsp;small&#34;</span><span class="op" id="2406872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2406875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406878">sa</span><span class="op" id="2406880">,</span>&nbsp;<span class="ident" id="2406882">err</span>&nbsp;<span class="op" id="2406886">=</span>&nbsp;<span class="ident" id="2406888">anyToSockaddr</span><span class="op" id="2406901">(</span><span class="op" id="2406902">&amp;</span><span class="ident" id="2406903">rsa</span><span class="op" id="2406906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406909">if</span>&nbsp;<span class="ident" id="2406912">err</span>&nbsp;<span class="op" id="2406916">!=</span>&nbsp;<span class="ident" id="2406919">nil</span>&nbsp;<span class="op" id="2406923">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406927">Close</span><span class="op" id="2406932">(</span><span class="ident" id="2406933">nfd</span><span class="op" id="2406936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406940">nfd</span>&nbsp;<span class="op" id="2406944">=</span>&nbsp;<span class="num" id="2406946">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2406949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406952">return</span><br>
<span class="lineno"></span><span class="op" id="2406959">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2406962">func</span>&nbsp;<span class="ident" id="2406967">Getsockname</span><span class="op" id="2406978">(</span><span class="ident" id="2406979">fd</span>&nbsp;<span class="builtintype" id="2406982">int</span><span class="op" id="2406985">)</span>&nbsp;<span class="op" id="2406987">(</span><span class="ident" id="2406988">sa</span>&nbsp;<span class="ident" id="2406991">Sockaddr</span><span class="op" id="2406999">,</span>&nbsp;<span class="ident" id="2407001">err</span>&nbsp;<span class="builtintype" id="2407005">error</span><span class="op" id="2407010">)</span>&nbsp;<span class="op" id="2407012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407015">var</span>&nbsp;<span class="ident" id="2407019">rsa</span>&nbsp;<span class="ident" id="2407023">RawSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407039">var</span>&nbsp;<span class="builtinfunc" id="2407043">len</span>&nbsp;<span class="ident" id="2407047">_Socklen</span>&nbsp;<span class="op" id="2407056">=</span>&nbsp;<span class="ident" id="2407058">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407077">if</span>&nbsp;<span class="ident" id="2407080">err</span>&nbsp;<span class="op" id="2407084">=</span>&nbsp;<span class="ident" id="2407086">getsockname</span><span class="op" id="2407097">(</span><span class="ident" id="2407098">fd</span><span class="op" id="2407100">,</span>&nbsp;<span class="op" id="2407102">&amp;</span><span class="ident" id="2407103">rsa</span><span class="op" id="2407106">,</span>&nbsp;<span class="op" id="2407108">&amp;</span><span class="builtinfunc" id="2407109">len</span><span class="op" id="2407112">)</span><span class="op" id="2407113">;</span>&nbsp;<span class="ident" id="2407115">err</span>&nbsp;<span class="op" id="2407119">!=</span>&nbsp;<span class="ident" id="2407122">nil</span>&nbsp;<span class="op" id="2407126">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407130">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2407138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407141">return</span>&nbsp;<span class="ident" id="2407148">anyToSockaddr</span><span class="op" id="2407161">(</span><span class="op" id="2407162">&amp;</span><span class="ident" id="2407163">rsa</span><span class="op" id="2407166">)</span><br>
<span class="lineno"></span><span class="op" id="2407168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span><span class="keyword" id="2407171">func</span>&nbsp;<span class="ident" id="2407176">GetsockoptInet4Addr</span><span class="op" id="2407195">(</span><span class="ident" id="2407196">fd</span><span class="op" id="2407198">,</span>&nbsp;<span class="ident" id="2407200">level</span><span class="op" id="2407205">,</span>&nbsp;<span class="ident" id="2407207">opt</span>&nbsp;<span class="builtintype" id="2407211">int</span><span class="op" id="2407214">)</span>&nbsp;<span class="op" id="2407216">(</span><span class="ident" id="2407217">value</span>&nbsp;<span class="op" id="2407223">[</span><span class="num" id="2407224">4</span><span class="op" id="2407225">]</span><span class="builtintype" id="2407226">byte</span><span class="op" id="2407230">,</span>&nbsp;<span class="ident" id="2407232">err</span>&nbsp;<span class="builtintype" id="2407236">error</span><span class="op" id="2407241">)</span>&nbsp;<span class="op" id="2407243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407246">vallen</span>&nbsp;<span class="op" id="2407253">:=</span>&nbsp;<span class="ident" id="2407256">_Socklen</span><span class="op" id="2407264">(</span><span class="num" id="2407265">4</span><span class="op" id="2407266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407269">err</span>&nbsp;<span class="op" id="2407273">=</span>&nbsp;<span class="ident" id="2407275">getsockopt</span><span class="op" id="2407285">(</span><span class="ident" id="2407286">fd</span><span class="op" id="2407288">,</span>&nbsp;<span class="ident" id="2407290">level</span><span class="op" id="2407295">,</span>&nbsp;<span class="ident" id="2407297">opt</span><span class="op" id="2407300">,</span>&nbsp;<span class="ident" id="2407302">unsafe</span><span class="op" id="2407308">.</span><span class="ident" id="2407309">Pointer</span><span class="op" id="2407316">(</span><span class="op" id="2407317">&amp;</span><span class="ident" id="2407318">value</span><span class="op" id="2407323">[</span><span class="num" id="2407324">0</span><span class="op" id="2407325">]</span><span class="op" id="2407326">)</span><span class="op" id="2407327">,</span>&nbsp;<span class="op" id="2407329">&amp;</span><span class="ident" id="2407330">vallen</span><span class="op" id="2407336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407339">return</span>&nbsp;<span class="ident" id="2407346">value</span><span class="op" id="2407351">,</span>&nbsp;<span class="ident" id="2407353">err</span><br>
<span class="lineno"></span><span class="op" id="2407357">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="2407360">func</span>&nbsp;<span class="ident" id="2407365">GetsockoptIPMreq</span><span class="op" id="2407381">(</span><span class="ident" id="2407382">fd</span><span class="op" id="2407384">,</span>&nbsp;<span class="ident" id="2407386">level</span><span class="op" id="2407391">,</span>&nbsp;<span class="ident" id="2407393">opt</span>&nbsp;<span class="builtintype" id="2407397">int</span><span class="op" id="2407400">)</span>&nbsp;<span class="op" id="2407402">(</span><span class="op" id="2407403">*</span><span class="ident" id="2407404">IPMreq</span><span class="op" id="2407410">,</span>&nbsp;<span class="builtintype" id="2407412">error</span><span class="op" id="2407417">)</span>&nbsp;<span class="op" id="2407419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407422">var</span>&nbsp;<span class="ident" id="2407426">value</span>&nbsp;<span class="ident" id="2407432">IPMreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407440">vallen</span>&nbsp;<span class="op" id="2407447">:=</span>&nbsp;<span class="ident" id="2407450">_Socklen</span><span class="op" id="2407458">(</span><span class="ident" id="2407459">SizeofIPMreq</span><span class="op" id="2407471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407474">err</span>&nbsp;<span class="op" id="2407478">:=</span>&nbsp;<span class="ident" id="2407481">getsockopt</span><span class="op" id="2407491">(</span><span class="ident" id="2407492">fd</span><span class="op" id="2407494">,</span>&nbsp;<span class="ident" id="2407496">level</span><span class="op" id="2407501">,</span>&nbsp;<span class="ident" id="2407503">opt</span><span class="op" id="2407506">,</span>&nbsp;<span class="ident" id="2407508">unsafe</span><span class="op" id="2407514">.</span><span class="ident" id="2407515">Pointer</span><span class="op" id="2407522">(</span><span class="op" id="2407523">&amp;</span><span class="ident" id="2407524">value</span><span class="op" id="2407529">)</span><span class="op" id="2407530">,</span>&nbsp;<span class="op" id="2407532">&amp;</span><span class="ident" id="2407533">vallen</span><span class="op" id="2407539">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407542">return</span>&nbsp;<span class="op" id="2407549">&amp;</span><span class="ident" id="2407550">value</span><span class="op" id="2407555">,</span>&nbsp;<span class="ident" id="2407557">err</span><br>
<span class="lineno"></span><span class="op" id="2407561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2407564">func</span>&nbsp;<span class="ident" id="2407569">GetsockoptIPMreqn</span><span class="op" id="2407586">(</span><span class="ident" id="2407587">fd</span><span class="op" id="2407589">,</span>&nbsp;<span class="ident" id="2407591">level</span><span class="op" id="2407596">,</span>&nbsp;<span class="ident" id="2407598">opt</span>&nbsp;<span class="builtintype" id="2407602">int</span><span class="op" id="2407605">)</span>&nbsp;<span class="op" id="2407607">(</span><span class="op" id="2407608">*</span><span class="ident" id="2407609">IPMreqn</span><span class="op" id="2407616">,</span>&nbsp;<span class="builtintype" id="2407618">error</span><span class="op" id="2407623">)</span>&nbsp;<span class="op" id="2407625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407628">var</span>&nbsp;<span class="ident" id="2407632">value</span>&nbsp;<span class="ident" id="2407638">IPMreqn</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407647">vallen</span>&nbsp;<span class="op" id="2407654">:=</span>&nbsp;<span class="ident" id="2407657">_Socklen</span><span class="op" id="2407665">(</span><span class="ident" id="2407666">SizeofIPMreqn</span><span class="op" id="2407679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407682">err</span>&nbsp;<span class="op" id="2407686">:=</span>&nbsp;<span class="ident" id="2407689">getsockopt</span><span class="op" id="2407699">(</span><span class="ident" id="2407700">fd</span><span class="op" id="2407702">,</span>&nbsp;<span class="ident" id="2407704">level</span><span class="op" id="2407709">,</span>&nbsp;<span class="ident" id="2407711">opt</span><span class="op" id="2407714">,</span>&nbsp;<span class="ident" id="2407716">unsafe</span><span class="op" id="2407722">.</span><span class="ident" id="2407723">Pointer</span><span class="op" id="2407730">(</span><span class="op" id="2407731">&amp;</span><span class="ident" id="2407732">value</span><span class="op" id="2407737">)</span><span class="op" id="2407738">,</span>&nbsp;<span class="op" id="2407740">&amp;</span><span class="ident" id="2407741">vallen</span><span class="op" id="2407747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407750">return</span>&nbsp;<span class="op" id="2407757">&amp;</span><span class="ident" id="2407758">value</span><span class="op" id="2407763">,</span>&nbsp;<span class="ident" id="2407765">err</span><br>
<span class="lineno"></span><span class="op" id="2407769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="keyword" id="2407772">func</span>&nbsp;<span class="ident" id="2407777">GetsockoptIPv6Mreq</span><span class="op" id="2407795">(</span><span class="ident" id="2407796">fd</span><span class="op" id="2407798">,</span>&nbsp;<span class="ident" id="2407800">level</span><span class="op" id="2407805">,</span>&nbsp;<span class="ident" id="2407807">opt</span>&nbsp;<span class="builtintype" id="2407811">int</span><span class="op" id="2407814">)</span>&nbsp;<span class="op" id="2407816">(</span><span class="op" id="2407817">*</span><span class="ident" id="2407818">IPv6Mreq</span><span class="op" id="2407826">,</span>&nbsp;<span class="builtintype" id="2407828">error</span><span class="op" id="2407833">)</span>&nbsp;<span class="op" id="2407835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407838">var</span>&nbsp;<span class="ident" id="2407842">value</span>&nbsp;<span class="ident" id="2407848">IPv6Mreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407858">vallen</span>&nbsp;<span class="op" id="2407865">:=</span>&nbsp;<span class="ident" id="2407868">_Socklen</span><span class="op" id="2407876">(</span><span class="ident" id="2407877">SizeofIPv6Mreq</span><span class="op" id="2407891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407894">err</span>&nbsp;<span class="op" id="2407898">:=</span>&nbsp;<span class="ident" id="2407901">getsockopt</span><span class="op" id="2407911">(</span><span class="ident" id="2407912">fd</span><span class="op" id="2407914">,</span>&nbsp;<span class="ident" id="2407916">level</span><span class="op" id="2407921">,</span>&nbsp;<span class="ident" id="2407923">opt</span><span class="op" id="2407926">,</span>&nbsp;<span class="ident" id="2407928">unsafe</span><span class="op" id="2407934">.</span><span class="ident" id="2407935">Pointer</span><span class="op" id="2407942">(</span><span class="op" id="2407943">&amp;</span><span class="ident" id="2407944">value</span><span class="op" id="2407949">)</span><span class="op" id="2407950">,</span>&nbsp;<span class="op" id="2407952">&amp;</span><span class="ident" id="2407953">vallen</span><span class="op" id="2407959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407962">return</span>&nbsp;<span class="op" id="2407969">&amp;</span><span class="ident" id="2407970">value</span><span class="op" id="2407975">,</span>&nbsp;<span class="ident" id="2407977">err</span><br>
<span class="lineno">470</span><span class="op" id="2407981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2407984">func</span>&nbsp;<span class="ident" id="2407989">GetsockoptIPv6MTUInfo</span><span class="op" id="2408010">(</span><span class="ident" id="2408011">fd</span><span class="op" id="2408013">,</span>&nbsp;<span class="ident" id="2408015">level</span><span class="op" id="2408020">,</span>&nbsp;<span class="ident" id="2408022">opt</span>&nbsp;<span class="builtintype" id="2408026">int</span><span class="op" id="2408029">)</span>&nbsp;<span class="op" id="2408031">(</span><span class="op" id="2408032">*</span><span class="ident" id="2408033">IPv6MTUInfo</span><span class="op" id="2408044">,</span>&nbsp;<span class="builtintype" id="2408046">error</span><span class="op" id="2408051">)</span>&nbsp;<span class="op" id="2408053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408056">var</span>&nbsp;<span class="ident" id="2408060">value</span>&nbsp;<span class="ident" id="2408066">IPv6MTUInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408079">vallen</span>&nbsp;<span class="op" id="2408086">:=</span>&nbsp;<span class="ident" id="2408089">_Socklen</span><span class="op" id="2408097">(</span><span class="ident" id="2408098">SizeofIPv6MTUInfo</span><span class="op" id="2408115">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408118">err</span>&nbsp;<span class="op" id="2408122">:=</span>&nbsp;<span class="ident" id="2408125">getsockopt</span><span class="op" id="2408135">(</span><span class="ident" id="2408136">fd</span><span class="op" id="2408138">,</span>&nbsp;<span class="ident" id="2408140">level</span><span class="op" id="2408145">,</span>&nbsp;<span class="ident" id="2408147">opt</span><span class="op" id="2408150">,</span>&nbsp;<span class="ident" id="2408152">unsafe</span><span class="op" id="2408158">.</span><span class="ident" id="2408159">Pointer</span><span class="op" id="2408166">(</span><span class="op" id="2408167">&amp;</span><span class="ident" id="2408168">value</span><span class="op" id="2408173">)</span><span class="op" id="2408174">,</span>&nbsp;<span class="op" id="2408176">&amp;</span><span class="ident" id="2408177">vallen</span><span class="op" id="2408183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408186">return</span>&nbsp;<span class="op" id="2408193">&amp;</span><span class="ident" id="2408194">value</span><span class="op" id="2408199">,</span>&nbsp;<span class="ident" id="2408201">err</span><br>
<span class="lineno"></span><span class="op" id="2408205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2408208">func</span>&nbsp;<span class="ident" id="2408213">GetsockoptICMPv6Filter</span><span class="op" id="2408235">(</span><span class="ident" id="2408236">fd</span><span class="op" id="2408238">,</span>&nbsp;<span class="ident" id="2408240">level</span><span class="op" id="2408245">,</span>&nbsp;<span class="ident" id="2408247">opt</span>&nbsp;<span class="builtintype" id="2408251">int</span><span class="op" id="2408254">)</span>&nbsp;<span class="op" id="2408256">(</span><span class="op" id="2408257">*</span><span class="ident" id="2408258">ICMPv6Filter</span><span class="op" id="2408270">,</span>&nbsp;<span class="builtintype" id="2408272">error</span><span class="op" id="2408277">)</span>&nbsp;<span class="op" id="2408279">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408282">var</span>&nbsp;<span class="ident" id="2408286">value</span>&nbsp;<span class="ident" id="2408292">ICMPv6Filter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408306">vallen</span>&nbsp;<span class="op" id="2408313">:=</span>&nbsp;<span class="ident" id="2408316">_Socklen</span><span class="op" id="2408324">(</span><span class="ident" id="2408325">SizeofICMPv6Filter</span><span class="op" id="2408343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408346">err</span>&nbsp;<span class="op" id="2408350">:=</span>&nbsp;<span class="ident" id="2408353">getsockopt</span><span class="op" id="2408363">(</span><span class="ident" id="2408364">fd</span><span class="op" id="2408366">,</span>&nbsp;<span class="ident" id="2408368">level</span><span class="op" id="2408373">,</span>&nbsp;<span class="ident" id="2408375">opt</span><span class="op" id="2408378">,</span>&nbsp;<span class="ident" id="2408380">unsafe</span><span class="op" id="2408386">.</span><span class="ident" id="2408387">Pointer</span><span class="op" id="2408394">(</span><span class="op" id="2408395">&amp;</span><span class="ident" id="2408396">value</span><span class="op" id="2408401">)</span><span class="op" id="2408402">,</span>&nbsp;<span class="op" id="2408404">&amp;</span><span class="ident" id="2408405">vallen</span><span class="op" id="2408411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408414">return</span>&nbsp;<span class="op" id="2408421">&amp;</span><span class="ident" id="2408422">value</span><span class="op" id="2408427">,</span>&nbsp;<span class="ident" id="2408429">err</span><br>
<span class="lineno"></span><span class="op" id="2408433">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="2408436">func</span>&nbsp;<span class="ident" id="2408441">GetsockoptUcred</span><span class="op" id="2408456">(</span><span class="ident" id="2408457">fd</span><span class="op" id="2408459">,</span>&nbsp;<span class="ident" id="2408461">level</span><span class="op" id="2408466">,</span>&nbsp;<span class="ident" id="2408468">opt</span>&nbsp;<span class="builtintype" id="2408472">int</span><span class="op" id="2408475">)</span>&nbsp;<span class="op" id="2408477">(</span><span class="op" id="2408478">*</span><span class="ident" id="2408479">Ucred</span><span class="op" id="2408484">,</span>&nbsp;<span class="builtintype" id="2408486">error</span><span class="op" id="2408491">)</span>&nbsp;<span class="op" id="2408493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408496">var</span>&nbsp;<span class="ident" id="2408500">value</span>&nbsp;<span class="ident" id="2408506">Ucred</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408513">vallen</span>&nbsp;<span class="op" id="2408520">:=</span>&nbsp;<span class="ident" id="2408523">_Socklen</span><span class="op" id="2408531">(</span><span class="ident" id="2408532">SizeofUcred</span><span class="op" id="2408543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408546">err</span>&nbsp;<span class="op" id="2408550">:=</span>&nbsp;<span class="ident" id="2408553">getsockopt</span><span class="op" id="2408563">(</span><span class="ident" id="2408564">fd</span><span class="op" id="2408566">,</span>&nbsp;<span class="ident" id="2408568">level</span><span class="op" id="2408573">,</span>&nbsp;<span class="ident" id="2408575">opt</span><span class="op" id="2408578">,</span>&nbsp;<span class="ident" id="2408580">unsafe</span><span class="op" id="2408586">.</span><span class="ident" id="2408587">Pointer</span><span class="op" id="2408594">(</span><span class="op" id="2408595">&amp;</span><span class="ident" id="2408596">value</span><span class="op" id="2408601">)</span><span class="op" id="2408602">,</span>&nbsp;<span class="op" id="2408604">&amp;</span><span class="ident" id="2408605">vallen</span><span class="op" id="2408611">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408614">return</span>&nbsp;<span class="op" id="2408621">&amp;</span><span class="ident" id="2408622">value</span><span class="op" id="2408627">,</span>&nbsp;<span class="ident" id="2408629">err</span><br>
<span class="lineno"></span><span class="op" id="2408633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2408636">func</span>&nbsp;<span class="ident" id="2408641">SetsockoptIPMreqn</span><span class="op" id="2408658">(</span><span class="ident" id="2408659">fd</span><span class="op" id="2408661">,</span>&nbsp;<span class="ident" id="2408663">level</span><span class="op" id="2408668">,</span>&nbsp;<span class="ident" id="2408670">opt</span>&nbsp;<span class="builtintype" id="2408674">int</span><span class="op" id="2408677">,</span>&nbsp;<span class="ident" id="2408679">mreq</span>&nbsp;<span class="op" id="2408684">*</span><span class="ident" id="2408685">IPMreqn</span><span class="op" id="2408692">)</span>&nbsp;<span class="op" id="2408694">(</span><span class="ident" id="2408695">err</span>&nbsp;<span class="builtintype" id="2408699">error</span><span class="op" id="2408704">)</span>&nbsp;<span class="op" id="2408706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408709">return</span>&nbsp;<span class="ident" id="2408716">setsockopt</span><span class="op" id="2408726">(</span><span class="ident" id="2408727">fd</span><span class="op" id="2408729">,</span>&nbsp;<span class="ident" id="2408731">level</span><span class="op" id="2408736">,</span>&nbsp;<span class="ident" id="2408738">opt</span><span class="op" id="2408741">,</span>&nbsp;<span class="ident" id="2408743">unsafe</span><span class="op" id="2408749">.</span><span class="ident" id="2408750">Pointer</span><span class="op" id="2408757">(</span><span class="ident" id="2408758">mreq</span><span class="op" id="2408762">)</span><span class="op" id="2408763">,</span>&nbsp;<span class="ident" id="2408765">unsafe</span><span class="op" id="2408771">.</span><span class="ident" id="2408772">Sizeof</span><span class="op" id="2408778">(</span><span class="op" id="2408779">*</span><span class="ident" id="2408780">mreq</span><span class="op" id="2408784">)</span><span class="op" id="2408785">)</span><br>
<span class="lineno">495</span><span class="op" id="2408787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2408790">func</span>&nbsp;<span class="ident" id="2408795">Recvmsg</span><span class="op" id="2408802">(</span><span class="ident" id="2408803">fd</span>&nbsp;<span class="builtintype" id="2408806">int</span><span class="op" id="2408809">,</span>&nbsp;<span class="ident" id="2408811">p</span><span class="op" id="2408812">,</span>&nbsp;<span class="ident" id="2408814">oob</span>&nbsp;<span class="op" id="2408818">[</span><span class="op" id="2408819">]</span><span class="builtintype" id="2408820">byte</span><span class="op" id="2408824">,</span>&nbsp;<span class="ident" id="2408826">flags</span>&nbsp;<span class="builtintype" id="2408832">int</span><span class="op" id="2408835">)</span>&nbsp;<span class="op" id="2408837">(</span><span class="ident" id="2408838">n</span><span class="op" id="2408839">,</span>&nbsp;<span class="ident" id="2408841">oobn</span>&nbsp;<span class="builtintype" id="2408846">int</span><span class="op" id="2408849">,</span>&nbsp;<span class="ident" id="2408851">recvflags</span>&nbsp;<span class="builtintype" id="2408861">int</span><span class="op" id="2408864">,</span>&nbsp;<span class="ident" id="2408866">from</span>&nbsp;<span class="ident" id="2408871">Sockaddr</span><span class="op" id="2408879">,</span>&nbsp;<span class="ident" id="2408881">err</span>&nbsp;<span class="builtintype" id="2408885">error</span><span class="op" id="2408890">)</span>&nbsp;<span class="op" id="2408892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408895">var</span>&nbsp;<span class="ident" id="2408899">msg</span>&nbsp;<span class="ident" id="2408903">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408911">var</span>&nbsp;<span class="ident" id="2408915">rsa</span>&nbsp;<span class="ident" id="2408919">RawSockaddrAny</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408935">msg</span><span class="op" id="2408938">.</span><span class="ident" id="2408939">Name</span>&nbsp;<span class="op" id="2408944">=</span>&nbsp;<span class="op" id="2408946">(</span><span class="op" id="2408947">*</span><span class="builtintype" id="2408948">byte</span><span class="op" id="2408952">)</span><span class="op" id="2408953">(</span><span class="ident" id="2408954">unsafe</span><span class="op" id="2408960">.</span><span class="ident" id="2408961">Pointer</span><span class="op" id="2408968">(</span><span class="op" id="2408969">&amp;</span><span class="ident" id="2408970">rsa</span><span class="op" id="2408973">)</span><span class="op" id="2408974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408977">msg</span><span class="op" id="2408980">.</span><span class="ident" id="2408981">Namelen</span>&nbsp;<span class="op" id="2408989">=</span>&nbsp;<span class="builtintype" id="2408991">uint32</span><span class="op" id="2408997">(</span><span class="ident" id="2408998">SizeofSockaddrAny</span><span class="op" id="2409015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409018">var</span>&nbsp;<span class="ident" id="2409022">iov</span>&nbsp;<span class="ident" id="2409026">Iovec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409033">if</span>&nbsp;<span class="builtinfunc" id="2409036">len</span><span class="op" id="2409039">(</span><span class="ident" id="2409040">p</span><span class="op" id="2409041">)</span>&nbsp;<span class="op" id="2409043">&gt;</span>&nbsp;<span class="num" id="2409045">0</span>&nbsp;<span class="op" id="2409047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409051">iov</span><span class="op" id="2409054">.</span><span class="ident" id="2409055">Base</span>&nbsp;<span class="op" id="2409060">=</span>&nbsp;<span class="op" id="2409062">(</span><span class="op" id="2409063">*</span><span class="builtintype" id="2409064">byte</span><span class="op" id="2409068">)</span><span class="op" id="2409069">(</span><span class="ident" id="2409070">unsafe</span><span class="op" id="2409076">.</span><span class="ident" id="2409077">Pointer</span><span class="op" id="2409084">(</span><span class="op" id="2409085">&amp;</span><span class="ident" id="2409086">p</span><span class="op" id="2409087">[</span><span class="num" id="2409088">0</span><span class="op" id="2409089">]</span><span class="op" id="2409090">)</span><span class="op" id="2409091">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409095">iov</span><span class="op" id="2409098">.</span><span class="ident" id="2409099">SetLen</span><span class="op" id="2409105">(</span><span class="builtinfunc" id="2409106">len</span><span class="op" id="2409109">(</span><span class="ident" id="2409110">p</span><span class="op" id="2409111">)</span><span class="op" id="2409112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2409115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409118">var</span>&nbsp;<span class="ident" id="2409122">dummy</span>&nbsp;<span class="builtintype" id="2409128">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409134">if</span>&nbsp;<span class="builtinfunc" id="2409137">len</span><span class="op" id="2409140">(</span><span class="ident" id="2409141">oob</span><span class="op" id="2409144">)</span>&nbsp;<span class="op" id="2409146">&gt;</span>&nbsp;<span class="num" id="2409148">0</span>&nbsp;<span class="op" id="2409150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2409154">//&nbsp;receive&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409192">if</span>&nbsp;<span class="builtinfunc" id="2409195">len</span><span class="op" id="2409198">(</span><span class="ident" id="2409199">p</span><span class="op" id="2409200">)</span>&nbsp;<span class="op" id="2409202">==</span>&nbsp;<span class="num" id="2409205">0</span>&nbsp;<span class="op" id="2409207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409212">iov</span><span class="op" id="2409215">.</span><span class="ident" id="2409216">Base</span>&nbsp;<span class="op" id="2409221">=</span>&nbsp;<span class="op" id="2409223">&amp;</span><span class="ident" id="2409224">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409233">iov</span><span class="op" id="2409236">.</span><span class="ident" id="2409237">SetLen</span><span class="op" id="2409243">(</span><span class="num" id="2409244">1</span><span class="op" id="2409245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2409249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409253">msg</span><span class="op" id="2409256">.</span><span class="ident" id="2409257">Control</span>&nbsp;<span class="op" id="2409265">=</span>&nbsp;<span class="op" id="2409267">(</span><span class="op" id="2409268">*</span><span class="builtintype" id="2409269">byte</span><span class="op" id="2409273">)</span><span class="op" id="2409274">(</span><span class="ident" id="2409275">unsafe</span><span class="op" id="2409281">.</span><span class="ident" id="2409282">Pointer</span><span class="op" id="2409289">(</span><span class="op" id="2409290">&amp;</span><span class="ident" id="2409291">oob</span><span class="op" id="2409294">[</span><span class="num" id="2409295">0</span><span class="op" id="2409296">]</span><span class="op" id="2409297">)</span><span class="op" id="2409298">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409302">msg</span><span class="op" id="2409305">.</span><span class="ident" id="2409306">SetControllen</span><span class="op" id="2409319">(</span><span class="builtinfunc" id="2409320">len</span><span class="op" id="2409323">(</span><span class="ident" id="2409324">oob</span><span class="op" id="2409327">)</span><span class="op" id="2409328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2409331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409334">msg</span><span class="op" id="2409337">.</span><span class="ident" id="2409338">Iov</span>&nbsp;<span class="op" id="2409342">=</span>&nbsp;<span class="op" id="2409344">&amp;</span><span class="ident" id="2409345">iov</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409350">msg</span><span class="op" id="2409353">.</span><span class="ident" id="2409354">Iovlen</span>&nbsp;<span class="op" id="2409361">=</span>&nbsp;<span class="num" id="2409363">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409366">if</span>&nbsp;<span class="ident" id="2409369">n</span><span class="op" id="2409370">,</span>&nbsp;<span class="ident" id="2409372">err</span>&nbsp;<span class="op" id="2409376">=</span>&nbsp;<span class="ident" id="2409378">recvmsg</span><span class="op" id="2409385">(</span><span class="ident" id="2409386">fd</span><span class="op" id="2409388">,</span>&nbsp;<span class="op" id="2409390">&amp;</span><span class="ident" id="2409391">msg</span><span class="op" id="2409394">,</span>&nbsp;<span class="ident" id="2409396">flags</span><span class="op" id="2409401">)</span><span class="op" id="2409402">;</span>&nbsp;<span class="ident" id="2409404">err</span>&nbsp;<span class="op" id="2409408">!=</span>&nbsp;<span class="ident" id="2409411">nil</span>&nbsp;<span class="op" id="2409415">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409419">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2409427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409430">oobn</span>&nbsp;<span class="op" id="2409435">=</span>&nbsp;<span class="builtintype" id="2409437">int</span><span class="op" id="2409440">(</span><span class="ident" id="2409441">msg</span><span class="op" id="2409444">.</span><span class="ident" id="2409445">Controllen</span><span class="op" id="2409455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409458">recvflags</span>&nbsp;<span class="op" id="2409468">=</span>&nbsp;<span class="builtintype" id="2409470">int</span><span class="op" id="2409473">(</span><span class="ident" id="2409474">msg</span><span class="op" id="2409477">.</span><span class="ident" id="2409478">Flags</span><span class="op" id="2409483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2409486">//&nbsp;source&nbsp;address&nbsp;is&nbsp;only&nbsp;specified&nbsp;if&nbsp;the&nbsp;socket&nbsp;is&nbsp;unconnected</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409552">if</span>&nbsp;<span class="ident" id="2409555">rsa</span><span class="op" id="2409558">.</span><span class="ident" id="2409559">Addr</span><span class="op" id="2409563">.</span><span class="ident" id="2409564">Family</span>&nbsp;<span class="op" id="2409571">!=</span>&nbsp;<span class="ident" id="2409574">AF_UNSPEC</span>&nbsp;<span class="op" id="2409584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409588">from</span><span class="op" id="2409592">,</span>&nbsp;<span class="ident" id="2409594">err</span>&nbsp;<span class="op" id="2409598">=</span>&nbsp;<span class="ident" id="2409600">anyToSockaddr</span><span class="op" id="2409613">(</span><span class="op" id="2409614">&amp;</span><span class="ident" id="2409615">rsa</span><span class="op" id="2409618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2409621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409624">return</span><br>
<span class="lineno"></span><span class="op" id="2409631">}</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span><span class="keyword" id="2409634">func</span>&nbsp;<span class="ident" id="2409639">Sendmsg</span><span class="op" id="2409646">(</span><span class="ident" id="2409647">fd</span>&nbsp;<span class="builtintype" id="2409650">int</span><span class="op" id="2409653">,</span>&nbsp;<span class="ident" id="2409655">p</span><span class="op" id="2409656">,</span>&nbsp;<span class="ident" id="2409658">oob</span>&nbsp;<span class="op" id="2409662">[</span><span class="op" id="2409663">]</span><span class="builtintype" id="2409664">byte</span><span class="op" id="2409668">,</span>&nbsp;<span class="ident" id="2409670">to</span>&nbsp;<span class="ident" id="2409673">Sockaddr</span><span class="op" id="2409681">,</span>&nbsp;<span class="ident" id="2409683">flags</span>&nbsp;<span class="builtintype" id="2409689">int</span><span class="op" id="2409692">)</span>&nbsp;<span class="op" id="2409694">(</span><span class="ident" id="2409695">err</span>&nbsp;<span class="builtintype" id="2409699">error</span><span class="op" id="2409704">)</span>&nbsp;<span class="op" id="2409706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409709">_</span><span class="op" id="2409710">,</span>&nbsp;<span class="ident" id="2409712">err</span>&nbsp;<span class="op" id="2409716">=</span>&nbsp;<span class="ident" id="2409718">SendmsgN</span><span class="op" id="2409726">(</span><span class="ident" id="2409727">fd</span><span class="op" id="2409729">,</span>&nbsp;<span class="ident" id="2409731">p</span><span class="op" id="2409732">,</span>&nbsp;<span class="ident" id="2409734">oob</span><span class="op" id="2409737">,</span>&nbsp;<span class="ident" id="2409739">to</span><span class="op" id="2409741">,</span>&nbsp;<span class="ident" id="2409743">flags</span><span class="op" id="2409748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409751">return</span><br>
<span class="lineno"></span><span class="op" id="2409758">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="2409761">func</span>&nbsp;<span class="ident" id="2409766">SendmsgN</span><span class="op" id="2409774">(</span><span class="ident" id="2409775">fd</span>&nbsp;<span class="builtintype" id="2409778">int</span><span class="op" id="2409781">,</span>&nbsp;<span class="ident" id="2409783">p</span><span class="op" id="2409784">,</span>&nbsp;<span class="ident" id="2409786">oob</span>&nbsp;<span class="op" id="2409790">[</span><span class="op" id="2409791">]</span><span class="builtintype" id="2409792">byte</span><span class="op" id="2409796">,</span>&nbsp;<span class="ident" id="2409798">to</span>&nbsp;<span class="ident" id="2409801">Sockaddr</span><span class="op" id="2409809">,</span>&nbsp;<span class="ident" id="2409811">flags</span>&nbsp;<span class="builtintype" id="2409817">int</span><span class="op" id="2409820">)</span>&nbsp;<span class="op" id="2409822">(</span><span class="ident" id="2409823">n</span>&nbsp;<span class="builtintype" id="2409825">int</span><span class="op" id="2409828">,</span>&nbsp;<span class="ident" id="2409830">err</span>&nbsp;<span class="builtintype" id="2409834">error</span><span class="op" id="2409839">)</span>&nbsp;<span class="op" id="2409841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409844">var</span>&nbsp;<span class="ident" id="2409848">ptr</span>&nbsp;<span class="ident" id="2409852">unsafe</span><span class="op" id="2409858">.</span><span class="ident" id="2409859">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409868">var</span>&nbsp;<span class="ident" id="2409872">salen</span>&nbsp;<span class="ident" id="2409878">_Socklen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409888">if</span>&nbsp;<span class="ident" id="2409891">to</span>&nbsp;<span class="op" id="2409894">!=</span>&nbsp;<span class="ident" id="2409897">nil</span>&nbsp;<span class="op" id="2409901">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409905">var</span>&nbsp;<span class="ident" id="2409909">err</span>&nbsp;<span class="builtintype" id="2409913">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409921">ptr</span><span class="op" id="2409924">,</span>&nbsp;<span class="ident" id="2409926">salen</span><span class="op" id="2409931">,</span>&nbsp;<span class="ident" id="2409933">err</span>&nbsp;<span class="op" id="2409937">=</span>&nbsp;<span class="ident" id="2409939">to</span><span class="op" id="2409941">.</span><span class="ident" id="2409942">sockaddr</span><span class="op" id="2409950">(</span><span class="op" id="2409951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409955">if</span>&nbsp;<span class="ident" id="2409958">err</span>&nbsp;<span class="op" id="2409962">!=</span>&nbsp;<span class="ident" id="2409965">nil</span>&nbsp;<span class="op" id="2409969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409974">return</span>&nbsp;<span class="num" id="2409981">0</span><span class="op" id="2409982">,</span>&nbsp;<span class="ident" id="2409984">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2409990">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2409993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409996">var</span>&nbsp;<span class="ident" id="2410000">msg</span>&nbsp;<span class="ident" id="2410004">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410012">msg</span><span class="op" id="2410015">.</span><span class="ident" id="2410016">Name</span>&nbsp;<span class="op" id="2410021">=</span>&nbsp;<span class="op" id="2410023">(</span><span class="op" id="2410024">*</span><span class="builtintype" id="2410025">byte</span><span class="op" id="2410029">)</span><span class="op" id="2410030">(</span><span class="ident" id="2410031">unsafe</span><span class="op" id="2410037">.</span><span class="ident" id="2410038">Pointer</span><span class="op" id="2410045">(</span><span class="ident" id="2410046">ptr</span><span class="op" id="2410049">)</span><span class="op" id="2410050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410053">msg</span><span class="op" id="2410056">.</span><span class="ident" id="2410057">Namelen</span>&nbsp;<span class="op" id="2410065">=</span>&nbsp;<span class="builtintype" id="2410067">uint32</span><span class="op" id="2410073">(</span><span class="ident" id="2410074">salen</span><span class="op" id="2410079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410082">var</span>&nbsp;<span class="ident" id="2410086">iov</span>&nbsp;<span class="ident" id="2410090">Iovec</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410097">if</span>&nbsp;<span class="builtinfunc" id="2410100">len</span><span class="op" id="2410103">(</span><span class="ident" id="2410104">p</span><span class="op" id="2410105">)</span>&nbsp;<span class="op" id="2410107">&gt;</span>&nbsp;<span class="num" id="2410109">0</span>&nbsp;<span class="op" id="2410111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410115">iov</span><span class="op" id="2410118">.</span><span class="ident" id="2410119">Base</span>&nbsp;<span class="op" id="2410124">=</span>&nbsp;<span class="op" id="2410126">(</span><span class="op" id="2410127">*</span><span class="builtintype" id="2410128">byte</span><span class="op" id="2410132">)</span><span class="op" id="2410133">(</span><span class="ident" id="2410134">unsafe</span><span class="op" id="2410140">.</span><span class="ident" id="2410141">Pointer</span><span class="op" id="2410148">(</span><span class="op" id="2410149">&amp;</span><span class="ident" id="2410150">p</span><span class="op" id="2410151">[</span><span class="num" id="2410152">0</span><span class="op" id="2410153">]</span><span class="op" id="2410154">)</span><span class="op" id="2410155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410159">iov</span><span class="op" id="2410162">.</span><span class="ident" id="2410163">SetLen</span><span class="op" id="2410169">(</span><span class="builtinfunc" id="2410170">len</span><span class="op" id="2410173">(</span><span class="ident" id="2410174">p</span><span class="op" id="2410175">)</span><span class="op" id="2410176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2410179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410182">var</span>&nbsp;<span class="ident" id="2410186">dummy</span>&nbsp;<span class="builtintype" id="2410192">byte</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410198">if</span>&nbsp;<span class="builtinfunc" id="2410201">len</span><span class="op" id="2410204">(</span><span class="ident" id="2410205">oob</span><span class="op" id="2410208">)</span>&nbsp;<span class="op" id="2410210">&gt;</span>&nbsp;<span class="num" id="2410212">0</span>&nbsp;<span class="op" id="2410214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2410218">//&nbsp;send&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410253">if</span>&nbsp;<span class="builtinfunc" id="2410256">len</span><span class="op" id="2410259">(</span><span class="ident" id="2410260">p</span><span class="op" id="2410261">)</span>&nbsp;<span class="op" id="2410263">==</span>&nbsp;<span class="num" id="2410266">0</span>&nbsp;<span class="op" id="2410268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410273">iov</span><span class="op" id="2410276">.</span><span class="ident" id="2410277">Base</span>&nbsp;<span class="op" id="2410282">=</span>&nbsp;<span class="op" id="2410284">&amp;</span><span class="ident" id="2410285">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410294">iov</span><span class="op" id="2410297">.</span><span class="ident" id="2410298">SetLen</span><span class="op" id="2410304">(</span><span class="num" id="2410305">1</span><span class="op" id="2410306">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2410310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410314">msg</span><span class="op" id="2410317">.</span><span class="ident" id="2410318">Control</span>&nbsp;<span class="op" id="2410326">=</span>&nbsp;<span class="op" id="2410328">(</span><span class="op" id="2410329">*</span><span class="builtintype" id="2410330">byte</span><span class="op" id="2410334">)</span><span class="op" id="2410335">(</span><span class="ident" id="2410336">unsafe</span><span class="op" id="2410342">.</span><span class="ident" id="2410343">Pointer</span><span class="op" id="2410350">(</span><span class="op" id="2410351">&amp;</span><span class="ident" id="2410352">oob</span><span class="op" id="2410355">[</span><span class="num" id="2410356">0</span><span class="op" id="2410357">]</span><span class="op" id="2410358">)</span><span class="op" id="2410359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410363">msg</span><span class="op" id="2410366">.</span><span class="ident" id="2410367">SetControllen</span><span class="op" id="2410380">(</span><span class="builtinfunc" id="2410381">len</span><span class="op" id="2410384">(</span><span class="ident" id="2410385">oob</span><span class="op" id="2410388">)</span><span class="op" id="2410389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2410392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410395">msg</span><span class="op" id="2410398">.</span><span class="ident" id="2410399">Iov</span>&nbsp;<span class="op" id="2410403">=</span>&nbsp;<span class="op" id="2410405">&amp;</span><span class="ident" id="2410406">iov</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410411">msg</span><span class="op" id="2410414">.</span><span class="ident" id="2410415">Iovlen</span>&nbsp;<span class="op" id="2410422">=</span>&nbsp;<span class="num" id="2410424">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410427">if</span>&nbsp;<span class="ident" id="2410430">n</span><span class="op" id="2410431">,</span>&nbsp;<span class="ident" id="2410433">err</span>&nbsp;<span class="op" id="2410437">=</span>&nbsp;<span class="ident" id="2410439">sendmsg</span><span class="op" id="2410446">(</span><span class="ident" id="2410447">fd</span><span class="op" id="2410449">,</span>&nbsp;<span class="op" id="2410451">&amp;</span><span class="ident" id="2410452">msg</span><span class="op" id="2410455">,</span>&nbsp;<span class="ident" id="2410457">flags</span><span class="op" id="2410462">)</span><span class="op" id="2410463">;</span>&nbsp;<span class="ident" id="2410465">err</span>&nbsp;<span class="op" id="2410469">!=</span>&nbsp;<span class="ident" id="2410472">nil</span>&nbsp;<span class="op" id="2410476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410480">return</span>&nbsp;<span class="num" id="2410487">0</span><span class="op" id="2410488">,</span>&nbsp;<span class="ident" id="2410490">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2410495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410498">if</span>&nbsp;<span class="builtinfunc" id="2410501">len</span><span class="op" id="2410504">(</span><span class="ident" id="2410505">oob</span><span class="op" id="2410508">)</span>&nbsp;<span class="op" id="2410510">&gt;</span>&nbsp;<span class="num" id="2410512">0</span>&nbsp;<span class="op" id="2410514">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2410517">len</span><span class="op" id="2410520">(</span><span class="ident" id="2410521">p</span><span class="op" id="2410522">)</span>&nbsp;<span class="op" id="2410524">==</span>&nbsp;<span class="num" id="2410527">0</span>&nbsp;<span class="op" id="2410529">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410533">n</span>&nbsp;<span class="op" id="2410535">=</span>&nbsp;<span class="num" id="2410537">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2410540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410543">return</span>&nbsp;<span class="ident" id="2410550">n</span><span class="op" id="2410551">,</span>&nbsp;<span class="ident" id="2410553">nil</span><br>
<span class="lineno"></span><span class="op" id="2410557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="2410560">//&nbsp;BindToDevice&nbsp;binds&nbsp;the&nbsp;socket&nbsp;associated&nbsp;with&nbsp;fd&nbsp;to&nbsp;device.</span><br>
<span class="lineno"></span><span class="keyword" id="2410623">func</span>&nbsp;<span class="ident" id="2410628">BindToDevice</span><span class="op" id="2410640">(</span><span class="ident" id="2410641">fd</span>&nbsp;<span class="builtintype" id="2410644">int</span><span class="op" id="2410647">,</span>&nbsp;<span class="ident" id="2410649">device</span>&nbsp;<span class="builtintype" id="2410656">string</span><span class="op" id="2410662">)</span>&nbsp;<span class="op" id="2410664">(</span><span class="ident" id="2410665">err</span>&nbsp;<span class="builtintype" id="2410669">error</span><span class="op" id="2410674">)</span>&nbsp;<span class="op" id="2410676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410679">return</span>&nbsp;<span class="ident" id="2410686">SetsockoptString</span><span class="op" id="2410702">(</span><span class="ident" id="2410703">fd</span><span class="op" id="2410705">,</span>&nbsp;<span class="ident" id="2410707">SOL_SOCKET</span><span class="op" id="2410717">,</span>&nbsp;<span class="ident" id="2410719">SO_BINDTODEVICE</span><span class="op" id="2410734">,</span>&nbsp;<span class="ident" id="2410736">device</span><span class="op" id="2410742">)</span><br>
<span class="lineno"></span><span class="op" id="2410744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span><span class="comment" id="2410747">//sys&nbsp;&nbsp;&nbsp;&nbspptrace(request&nbsp;int,&nbsp;pid&nbsp;int,&nbsp;addr&nbsp;uintptr,&nbsp;data&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2410823">func</span>&nbsp;<span class="ident" id="2410828">ptracePeek</span><span class="op" id="2410838">(</span><span class="ident" id="2410839">req</span>&nbsp;<span class="builtintype" id="2410843">int</span><span class="op" id="2410846">,</span>&nbsp;<span class="ident" id="2410848">pid</span>&nbsp;<span class="builtintype" id="2410852">int</span><span class="op" id="2410855">,</span>&nbsp;<span class="ident" id="2410857">addr</span>&nbsp;<span class="builtintype" id="2410862">uintptr</span><span class="op" id="2410869">,</span>&nbsp;<span class="ident" id="2410871">out</span>&nbsp;<span class="op" id="2410875">[</span><span class="op" id="2410876">]</span><span class="builtintype" id="2410877">byte</span><span class="op" id="2410881">)</span>&nbsp;<span class="op" id="2410883">(</span><span class="ident" id="2410884">count</span>&nbsp;<span class="builtintype" id="2410890">int</span><span class="op" id="2410893">,</span>&nbsp;<span class="ident" id="2410895">err</span>&nbsp;<span class="builtintype" id="2410899">error</span><span class="op" id="2410904">)</span>&nbsp;<span class="op" id="2410906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2410909">//&nbsp;The&nbsp;peek&nbsp;requests&nbsp;are&nbsp;machine-size&nbsp;oriented,&nbsp;so&nbsp;we&nbsp;wrap&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2410972">//&nbsp;to&nbsp;retrieve&nbsp;arbitrary-length&nbsp;data.</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2411012">//&nbsp;The&nbsp;ptrace&nbsp;syscall&nbsp;differs&nbsp;from&nbsp;glibc&#39;s&nbsp;ptrace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2411064">//&nbsp;Peeks&nbsp;returns&nbsp;the&nbsp;word&nbsp;in&nbsp;*data,&nbsp;not&nbsp;as&nbsp;the&nbsp;return&nbsp;value.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411127">var</span>&nbsp;<span class="ident" id="2411131">buf</span>&nbsp;<span class="op" id="2411135">[</span><span class="ident" id="2411136">sizeofPtr</span><span class="op" id="2411145">]</span><span class="builtintype" id="2411146">byte</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2411153">//&nbsp;Leading&nbsp;edge.&nbsp;&nbsp;PEEKTEXT/PEEKDATA&nbsp;don&#39;t&nbsp;require&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2411212">//&nbsp;access&nbsp;(PEEKUSER&nbsp;warns&nbsp;that&nbsp;it&nbsp;might),&nbsp;but&nbsp;if&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2411271">//&nbsp;align&nbsp;our&nbsp;reads,&nbsp;we&nbsp;might&nbsp;straddle&nbsp;an&nbsp;unmapped&nbsp;page</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2411327">//&nbsp;boundary&nbsp;and&nbsp;not&nbsp;get&nbsp;the&nbsp;bytes&nbsp;leading&nbsp;up&nbsp;to&nbsp;the&nbsp;page</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2411385">//&nbsp;boundary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411399">n</span>&nbsp;<span class="op" id="2411401">:=</span>&nbsp;<span class="num" id="2411404">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411407">if</span>&nbsp;<span class="ident" id="2411410">addr</span><span class="op" id="2411414">%</span><span class="ident" id="2411415">sizeofPtr</span>&nbsp;<span class="op" id="2411425">!=</span>&nbsp;<span class="num" id="2411428">0</span>&nbsp;<span class="op" id="2411430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411434">err</span>&nbsp;<span class="op" id="2411438">=</span>&nbsp;<span class="ident" id="2411440">ptrace</span><span class="op" id="2411446">(</span><span class="ident" id="2411447">req</span><span class="op" id="2411450">,</span>&nbsp;<span class="ident" id="2411452">pid</span><span class="op" id="2411455">,</span>&nbsp;<span class="ident" id="2411457">addr</span><span class="op" id="2411461">-</span><span class="ident" id="2411462">addr</span><span class="op" id="2411466">%</span><span class="ident" id="2411467">sizeofPtr</span><span class="op" id="2411476">,</span>&nbsp;<span class="builtintype" id="2411478">uintptr</span><span class="op" id="2411485">(</span><span class="ident" id="2411486">unsafe</span><span class="op" id="2411492">.</span><span class="ident" id="2411493">Pointer</span><span class="op" id="2411500">(</span><span class="op" id="2411501">&amp;</span><span class="ident" id="2411502">buf</span><span class="op" id="2411505">[</span><span class="num" id="2411506">0</span><span class="op" id="2411507">]</span><span class="op" id="2411508">)</span><span class="op" id="2411509">)</span><span class="op" id="2411510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411514">if</span>&nbsp;<span class="ident" id="2411517">err</span>&nbsp;<span class="op" id="2411521">!=</span>&nbsp;<span class="ident" id="2411524">nil</span>&nbsp;<span class="op" id="2411528">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411533">return</span>&nbsp;<span class="num" id="2411540">0</span><span class="op" id="2411541">,</span>&nbsp;<span class="ident" id="2411543">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2411549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411553">n</span>&nbsp;<span class="op" id="2411555">+=</span>&nbsp;<span class="builtinfunc" id="2411558">copy</span><span class="op" id="2411562">(</span><span class="ident" id="2411563">out</span><span class="op" id="2411566">,</span>&nbsp;<span class="ident" id="2411568">buf</span><span class="op" id="2411571">[</span><span class="ident" id="2411572">addr</span><span class="op" id="2411576">%</span><span class="ident" id="2411577">sizeofPtr</span><span class="op" id="2411586">:</span><span class="op" id="2411587">]</span><span class="op" id="2411588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411592">out</span>&nbsp;<span class="op" id="2411596">=</span>&nbsp;<span class="ident" id="2411598">out</span><span class="op" id="2411601">[</span><span class="ident" id="2411602">n</span><span class="op" id="2411603">:</span><span class="op" id="2411604">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2411607">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2411611">//&nbsp;Remainder.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411626">for</span>&nbsp;<span class="builtinfunc" id="2411630">len</span><span class="op" id="2411633">(</span><span class="ident" id="2411634">out</span><span class="op" id="2411637">)</span>&nbsp;<span class="op" id="2411639">&gt;</span>&nbsp;<span class="num" id="2411641">0</span>&nbsp;<span class="op" id="2411643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2411647">//&nbsp;We&nbsp;use&nbsp;an&nbsp;internal&nbsp;buffer&nbsp;to&nbsp;guarantee&nbsp;alignment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2411702">//&nbsp;It&#39;s&nbsp;not&nbsp;documented&nbsp;if&nbsp;this&nbsp;is&nbsp;necessary,&nbsp;but&nbsp;we&#39;re&nbsp;paranoid.</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411769">err</span>&nbsp;<span class="op" id="2411773">=</span>&nbsp;<span class="ident" id="2411775">ptrace</span><span class="op" id="2411781">(</span><span class="ident" id="2411782">req</span><span class="op" id="2411785">,</span>&nbsp;<span class="ident" id="2411787">pid</span><span class="op" id="2411790">,</span>&nbsp;<span class="ident" id="2411792">addr</span><span class="op" id="2411796">+</span><span class="builtintype" id="2411797">uintptr</span><span class="op" id="2411804">(</span><span class="ident" id="2411805">n</span><span class="op" id="2411806">)</span><span class="op" id="2411807">,</span>&nbsp;<span class="builtintype" id="2411809">uintptr</span><span class="op" id="2411816">(</span><span class="ident" id="2411817">unsafe</span><span class="op" id="2411823">.</span><span class="ident" id="2411824">Pointer</span><span class="op" id="2411831">(</span><span class="op" id="2411832">&amp;</span><span class="ident" id="2411833">buf</span><span class="op" id="2411836">[</span><span class="num" id="2411837">0</span><span class="op" id="2411838">]</span><span class="op" id="2411839">)</span><span class="op" id="2411840">)</span><span class="op" id="2411841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411845">if</span>&nbsp;<span class="ident" id="2411848">err</span>&nbsp;<span class="op" id="2411852">!=</span>&nbsp;<span class="ident" id="2411855">nil</span>&nbsp;<span class="op" id="2411859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411864">return</span>&nbsp;<span class="ident" id="2411871">n</span><span class="op" id="2411872">,</span>&nbsp;<span class="ident" id="2411874">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2411880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411884">copied</span>&nbsp;<span class="op" id="2411891">:=</span>&nbsp;<span class="builtinfunc" id="2411894">copy</span><span class="op" id="2411898">(</span><span class="ident" id="2411899">out</span><span class="op" id="2411902">,</span>&nbsp;<span class="ident" id="2411904">buf</span><span class="op" id="2411907">[</span><span class="num" id="2411908">0</span><span class="op" id="2411909">:</span><span class="op" id="2411910">]</span><span class="op" id="2411911">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411915">n</span>&nbsp;<span class="op" id="2411917">+=</span>&nbsp;<span class="ident" id="2411920">copied</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411929">out</span>&nbsp;<span class="op" id="2411933">=</span>&nbsp;<span class="ident" id="2411935">out</span><span class="op" id="2411938">[</span><span class="ident" id="2411939">copied</span><span class="op" id="2411945">:</span><span class="op" id="2411946">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2411949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411953">return</span>&nbsp;<span class="ident" id="2411960">n</span><span class="op" id="2411961">,</span>&nbsp;<span class="ident" id="2411963">nil</span><br>
<span class="lineno">620</span><span class="op" id="2411967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2411970">func</span>&nbsp;<span class="ident" id="2411975">PtracePeekText</span><span class="op" id="2411989">(</span><span class="ident" id="2411990">pid</span>&nbsp;<span class="builtintype" id="2411994">int</span><span class="op" id="2411997">,</span>&nbsp;<span class="ident" id="2411999">addr</span>&nbsp;<span class="builtintype" id="2412004">uintptr</span><span class="op" id="2412011">,</span>&nbsp;<span class="ident" id="2412013">out</span>&nbsp;<span class="op" id="2412017">[</span><span class="op" id="2412018">]</span><span class="builtintype" id="2412019">byte</span><span class="op" id="2412023">)</span>&nbsp;<span class="op" id="2412025">(</span><span class="ident" id="2412026">count</span>&nbsp;<span class="builtintype" id="2412032">int</span><span class="op" id="2412035">,</span>&nbsp;<span class="ident" id="2412037">err</span>&nbsp;<span class="builtintype" id="2412041">error</span><span class="op" id="2412046">)</span>&nbsp;<span class="op" id="2412048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412051">return</span>&nbsp;<span class="ident" id="2412058">ptracePeek</span><span class="op" id="2412068">(</span><span class="ident" id="2412069">PTRACE_PEEKTEXT</span><span class="op" id="2412084">,</span>&nbsp;<span class="ident" id="2412086">pid</span><span class="op" id="2412089">,</span>&nbsp;<span class="ident" id="2412091">addr</span><span class="op" id="2412095">,</span>&nbsp;<span class="ident" id="2412097">out</span><span class="op" id="2412100">)</span><br>
<span class="lineno"></span><span class="op" id="2412102">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="2412105">func</span>&nbsp;<span class="ident" id="2412110">PtracePeekData</span><span class="op" id="2412124">(</span><span class="ident" id="2412125">pid</span>&nbsp;<span class="builtintype" id="2412129">int</span><span class="op" id="2412132">,</span>&nbsp;<span class="ident" id="2412134">addr</span>&nbsp;<span class="builtintype" id="2412139">uintptr</span><span class="op" id="2412146">,</span>&nbsp;<span class="ident" id="2412148">out</span>&nbsp;<span class="op" id="2412152">[</span><span class="op" id="2412153">]</span><span class="builtintype" id="2412154">byte</span><span class="op" id="2412158">)</span>&nbsp;<span class="op" id="2412160">(</span><span class="ident" id="2412161">count</span>&nbsp;<span class="builtintype" id="2412167">int</span><span class="op" id="2412170">,</span>&nbsp;<span class="ident" id="2412172">err</span>&nbsp;<span class="builtintype" id="2412176">error</span><span class="op" id="2412181">)</span>&nbsp;<span class="op" id="2412183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412186">return</span>&nbsp;<span class="ident" id="2412193">ptracePeek</span><span class="op" id="2412203">(</span><span class="ident" id="2412204">PTRACE_PEEKDATA</span><span class="op" id="2412219">,</span>&nbsp;<span class="ident" id="2412221">pid</span><span class="op" id="2412224">,</span>&nbsp;<span class="ident" id="2412226">addr</span><span class="op" id="2412230">,</span>&nbsp;<span class="ident" id="2412232">out</span><span class="op" id="2412235">)</span><br>
<span class="lineno"></span><span class="op" id="2412237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">630</span><span class="keyword" id="2412240">func</span>&nbsp;<span class="ident" id="2412245">ptracePoke</span><span class="op" id="2412255">(</span><span class="ident" id="2412256">pokeReq</span>&nbsp;<span class="builtintype" id="2412264">int</span><span class="op" id="2412267">,</span>&nbsp;<span class="ident" id="2412269">peekReq</span>&nbsp;<span class="builtintype" id="2412277">int</span><span class="op" id="2412280">,</span>&nbsp;<span class="ident" id="2412282">pid</span>&nbsp;<span class="builtintype" id="2412286">int</span><span class="op" id="2412289">,</span>&nbsp;<span class="ident" id="2412291">addr</span>&nbsp;<span class="builtintype" id="2412296">uintptr</span><span class="op" id="2412303">,</span>&nbsp;<span class="ident" id="2412305">data</span>&nbsp;<span class="op" id="2412310">[</span><span class="op" id="2412311">]</span><span class="builtintype" id="2412312">byte</span><span class="op" id="2412316">)</span>&nbsp;<span class="op" id="2412318">(</span><span class="ident" id="2412319">count</span>&nbsp;<span class="builtintype" id="2412325">int</span><span class="op" id="2412328">,</span>&nbsp;<span class="ident" id="2412330">err</span>&nbsp;<span class="builtintype" id="2412334">error</span><span class="op" id="2412339">)</span>&nbsp;<span class="op" id="2412341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2412344">//&nbsp;As&nbsp;for&nbsp;ptracePeek,&nbsp;we&nbsp;need&nbsp;to&nbsp;align&nbsp;our&nbsp;accesses&nbsp;to&nbsp;deal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2412405">//&nbsp;with&nbsp;the&nbsp;possibility&nbsp;of&nbsp;straddling&nbsp;an&nbsp;invalid&nbsp;page.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2412462">//&nbsp;Leading&nbsp;edge.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412480">n</span>&nbsp;<span class="op" id="2412482">:=</span>&nbsp;<span class="num" id="2412485">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412488">if</span>&nbsp;<span class="ident" id="2412491">addr</span><span class="op" id="2412495">%</span><span class="ident" id="2412496">sizeofPtr</span>&nbsp;<span class="op" id="2412506">!=</span>&nbsp;<span class="num" id="2412509">0</span>&nbsp;<span class="op" id="2412511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412515">var</span>&nbsp;<span class="ident" id="2412519">buf</span>&nbsp;<span class="op" id="2412523">[</span><span class="ident" id="2412524">sizeofPtr</span><span class="op" id="2412533">]</span><span class="builtintype" id="2412534">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412541">err</span>&nbsp;<span class="op" id="2412545">=</span>&nbsp;<span class="ident" id="2412547">ptrace</span><span class="op" id="2412553">(</span><span class="ident" id="2412554">peekReq</span><span class="op" id="2412561">,</span>&nbsp;<span class="ident" id="2412563">pid</span><span class="op" id="2412566">,</span>&nbsp;<span class="ident" id="2412568">addr</span><span class="op" id="2412572">-</span><span class="ident" id="2412573">addr</span><span class="op" id="2412577">%</span><span class="ident" id="2412578">sizeofPtr</span><span class="op" id="2412587">,</span>&nbsp;<span class="builtintype" id="2412589">uintptr</span><span class="op" id="2412596">(</span><span class="ident" id="2412597">unsafe</span><span class="op" id="2412603">.</span><span class="ident" id="2412604">Pointer</span><span class="op" id="2412611">(</span><span class="op" id="2412612">&amp;</span><span class="ident" id="2412613">buf</span><span class="op" id="2412616">[</span><span class="num" id="2412617">0</span><span class="op" id="2412618">]</span><span class="op" id="2412619">)</span><span class="op" id="2412620">)</span><span class="op" id="2412621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412625">if</span>&nbsp;<span class="ident" id="2412628">err</span>&nbsp;<span class="op" id="2412632">!=</span>&nbsp;<span class="ident" id="2412635">nil</span>&nbsp;<span class="op" id="2412639">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412644">return</span>&nbsp;<span class="num" id="2412651">0</span><span class="op" id="2412652">,</span>&nbsp;<span class="ident" id="2412654">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2412660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412664">n</span>&nbsp;<span class="op" id="2412666">+=</span>&nbsp;<span class="builtinfunc" id="2412669">copy</span><span class="op" id="2412673">(</span><span class="ident" id="2412674">buf</span><span class="op" id="2412677">[</span><span class="ident" id="2412678">addr</span><span class="op" id="2412682">%</span><span class="ident" id="2412683">sizeofPtr</span><span class="op" id="2412692">:</span><span class="op" id="2412693">]</span><span class="op" id="2412694">,</span>&nbsp;<span class="ident" id="2412696">data</span><span class="op" id="2412700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412704">word</span>&nbsp;<span class="op" id="2412709">:=</span>&nbsp;<span class="op" id="2412712">*</span><span class="op" id="2412713">(</span><span class="op" id="2412714">(</span><span class="op" id="2412715">*</span><span class="builtintype" id="2412716">uintptr</span><span class="op" id="2412723">)</span><span class="op" id="2412724">(</span><span class="ident" id="2412725">unsafe</span><span class="op" id="2412731">.</span><span class="ident" id="2412732">Pointer</span><span class="op" id="2412739">(</span><span class="op" id="2412740">&amp;</span><span class="ident" id="2412741">buf</span><span class="op" id="2412744">[</span><span class="num" id="2412745">0</span><span class="op" id="2412746">]</span><span class="op" id="2412747">)</span><span class="op" id="2412748">)</span><span class="op" id="2412749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412753">err</span>&nbsp;<span class="op" id="2412757">=</span>&nbsp;<span class="ident" id="2412759">ptrace</span><span class="op" id="2412765">(</span><span class="ident" id="2412766">pokeReq</span><span class="op" id="2412773">,</span>&nbsp;<span class="ident" id="2412775">pid</span><span class="op" id="2412778">,</span>&nbsp;<span class="ident" id="2412780">addr</span><span class="op" id="2412784">-</span><span class="ident" id="2412785">addr</span><span class="op" id="2412789">%</span><span class="ident" id="2412790">sizeofPtr</span><span class="op" id="2412799">,</span>&nbsp;<span class="ident" id="2412801">word</span><span class="op" id="2412805">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412809">if</span>&nbsp;<span class="ident" id="2412812">err</span>&nbsp;<span class="op" id="2412816">!=</span>&nbsp;<span class="ident" id="2412819">nil</span>&nbsp;<span class="op" id="2412823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412828">return</span>&nbsp;<span class="num" id="2412835">0</span><span class="op" id="2412836">,</span>&nbsp;<span class="ident" id="2412838">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2412844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412848">data</span>&nbsp;<span class="op" id="2412853">=</span>&nbsp;<span class="ident" id="2412855">data</span><span class="op" id="2412859">[</span><span class="ident" id="2412860">n</span><span class="op" id="2412861">:</span><span class="op" id="2412862">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2412865">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2412869">//&nbsp;Interior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412883">for</span>&nbsp;<span class="builtinfunc" id="2412887">len</span><span class="op" id="2412890">(</span><span class="ident" id="2412891">data</span><span class="op" id="2412895">)</span>&nbsp;<span class="op" id="2412897">&gt;</span>&nbsp;<span class="ident" id="2412899">sizeofPtr</span>&nbsp;<span class="op" id="2412909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412913">word</span>&nbsp;<span class="op" id="2412918">:=</span>&nbsp;<span class="op" id="2412921">*</span><span class="op" id="2412922">(</span><span class="op" id="2412923">(</span><span class="op" id="2412924">*</span><span class="builtintype" id="2412925">uintptr</span><span class="op" id="2412932">)</span><span class="op" id="2412933">(</span><span class="ident" id="2412934">unsafe</span><span class="op" id="2412940">.</span><span class="ident" id="2412941">Pointer</span><span class="op" id="2412948">(</span><span class="op" id="2412949">&amp;</span><span class="ident" id="2412950">data</span><span class="op" id="2412954">[</span><span class="num" id="2412955">0</span><span class="op" id="2412956">]</span><span class="op" id="2412957">)</span><span class="op" id="2412958">)</span><span class="op" id="2412959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412963">err</span>&nbsp;<span class="op" id="2412967">=</span>&nbsp;<span class="ident" id="2412969">ptrace</span><span class="op" id="2412975">(</span><span class="ident" id="2412976">pokeReq</span><span class="op" id="2412983">,</span>&nbsp;<span class="ident" id="2412985">pid</span><span class="op" id="2412988">,</span>&nbsp;<span class="ident" id="2412990">addr</span><span class="op" id="2412994">+</span><span class="builtintype" id="2412995">uintptr</span><span class="op" id="2413002">(</span><span class="ident" id="2413003">n</span><span class="op" id="2413004">)</span><span class="op" id="2413005">,</span>&nbsp;<span class="ident" id="2413007">word</span><span class="op" id="2413011">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413015">if</span>&nbsp;<span class="ident" id="2413018">err</span>&nbsp;<span class="op" id="2413022">!=</span>&nbsp;<span class="ident" id="2413025">nil</span>&nbsp;<span class="op" id="2413029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413034">return</span>&nbsp;<span class="ident" id="2413041">n</span><span class="op" id="2413042">,</span>&nbsp;<span class="ident" id="2413044">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2413050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413054">n</span>&nbsp;<span class="op" id="2413056">+=</span>&nbsp;<span class="ident" id="2413059">sizeofPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413071">data</span>&nbsp;<span class="op" id="2413076">=</span>&nbsp;<span class="ident" id="2413078">data</span><span class="op" id="2413082">[</span><span class="ident" id="2413083">sizeofPtr</span><span class="op" id="2413092">:</span><span class="op" id="2413093">]</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2413096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2413100">//&nbsp;Trailing&nbsp;edge.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413119">if</span>&nbsp;<span class="builtinfunc" id="2413122">len</span><span class="op" id="2413125">(</span><span class="ident" id="2413126">data</span><span class="op" id="2413130">)</span>&nbsp;<span class="op" id="2413132">&gt;</span>&nbsp;<span class="num" id="2413134">0</span>&nbsp;<span class="op" id="2413136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413140">var</span>&nbsp;<span class="ident" id="2413144">buf</span>&nbsp;<span class="op" id="2413148">[</span><span class="ident" id="2413149">sizeofPtr</span><span class="op" id="2413158">]</span><span class="builtintype" id="2413159">byte</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413166">err</span>&nbsp;<span class="op" id="2413170">=</span>&nbsp;<span class="ident" id="2413172">ptrace</span><span class="op" id="2413178">(</span><span class="ident" id="2413179">peekReq</span><span class="op" id="2413186">,</span>&nbsp;<span class="ident" id="2413188">pid</span><span class="op" id="2413191">,</span>&nbsp;<span class="ident" id="2413193">addr</span><span class="op" id="2413197">+</span><span class="builtintype" id="2413198">uintptr</span><span class="op" id="2413205">(</span><span class="ident" id="2413206">n</span><span class="op" id="2413207">)</span><span class="op" id="2413208">,</span>&nbsp;<span class="builtintype" id="2413210">uintptr</span><span class="op" id="2413217">(</span><span class="ident" id="2413218">unsafe</span><span class="op" id="2413224">.</span><span class="ident" id="2413225">Pointer</span><span class="op" id="2413232">(</span><span class="op" id="2413233">&amp;</span><span class="ident" id="2413234">buf</span><span class="op" id="2413237">[</span><span class="num" id="2413238">0</span><span class="op" id="2413239">]</span><span class="op" id="2413240">)</span><span class="op" id="2413241">)</span><span class="op" id="2413242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413246">if</span>&nbsp;<span class="ident" id="2413249">err</span>&nbsp;<span class="op" id="2413253">!=</span>&nbsp;<span class="ident" id="2413256">nil</span>&nbsp;<span class="op" id="2413260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413265">return</span>&nbsp;<span class="ident" id="2413272">n</span><span class="op" id="2413273">,</span>&nbsp;<span class="ident" id="2413275">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2413281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2413285">copy</span><span class="op" id="2413289">(</span><span class="ident" id="2413290">buf</span><span class="op" id="2413293">[</span><span class="num" id="2413294">0</span><span class="op" id="2413295">:</span><span class="op" id="2413296">]</span><span class="op" id="2413297">,</span>&nbsp;<span class="ident" id="2413299">data</span><span class="op" id="2413303">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413307">word</span>&nbsp;<span class="op" id="2413312">:=</span>&nbsp;<span class="op" id="2413315">*</span><span class="op" id="2413316">(</span><span class="op" id="2413317">(</span><span class="op" id="2413318">*</span><span class="builtintype" id="2413319">uintptr</span><span class="op" id="2413326">)</span><span class="op" id="2413327">(</span><span class="ident" id="2413328">unsafe</span><span class="op" id="2413334">.</span><span class="ident" id="2413335">Pointer</span><span class="op" id="2413342">(</span><span class="op" id="2413343">&amp;</span><span class="ident" id="2413344">buf</span><span class="op" id="2413347">[</span><span class="num" id="2413348">0</span><span class="op" id="2413349">]</span><span class="op" id="2413350">)</span><span class="op" id="2413351">)</span><span class="op" id="2413352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413356">err</span>&nbsp;<span class="op" id="2413360">=</span>&nbsp;<span class="ident" id="2413362">ptrace</span><span class="op" id="2413368">(</span><span class="ident" id="2413369">pokeReq</span><span class="op" id="2413376">,</span>&nbsp;<span class="ident" id="2413378">pid</span><span class="op" id="2413381">,</span>&nbsp;<span class="ident" id="2413383">addr</span><span class="op" id="2413387">+</span><span class="builtintype" id="2413388">uintptr</span><span class="op" id="2413395">(</span><span class="ident" id="2413396">n</span><span class="op" id="2413397">)</span><span class="op" id="2413398">,</span>&nbsp;<span class="ident" id="2413400">word</span><span class="op" id="2413404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413408">if</span>&nbsp;<span class="ident" id="2413411">err</span>&nbsp;<span class="op" id="2413415">!=</span>&nbsp;<span class="ident" id="2413418">nil</span>&nbsp;<span class="op" id="2413422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413427">return</span>&nbsp;<span class="ident" id="2413434">n</span><span class="op" id="2413435">,</span>&nbsp;<span class="ident" id="2413437">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2413443">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413447">n</span>&nbsp;<span class="op" id="2413449">+=</span>&nbsp;<span class="builtinfunc" id="2413452">len</span><span class="op" id="2413455">(</span><span class="ident" id="2413456">data</span><span class="op" id="2413460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2413463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413467">return</span>&nbsp;<span class="ident" id="2413474">n</span><span class="op" id="2413475">,</span>&nbsp;<span class="ident" id="2413477">nil</span><br>
<span class="lineno"></span><span class="op" id="2413481">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="2413484">func</span>&nbsp;<span class="ident" id="2413489">PtracePokeText</span><span class="op" id="2413503">(</span><span class="ident" id="2413504">pid</span>&nbsp;<span class="builtintype" id="2413508">int</span><span class="op" id="2413511">,</span>&nbsp;<span class="ident" id="2413513">addr</span>&nbsp;<span class="builtintype" id="2413518">uintptr</span><span class="op" id="2413525">,</span>&nbsp;<span class="ident" id="2413527">data</span>&nbsp;<span class="op" id="2413532">[</span><span class="op" id="2413533">]</span><span class="builtintype" id="2413534">byte</span><span class="op" id="2413538">)</span>&nbsp;<span class="op" id="2413540">(</span><span class="ident" id="2413541">count</span>&nbsp;<span class="builtintype" id="2413547">int</span><span class="op" id="2413550">,</span>&nbsp;<span class="ident" id="2413552">err</span>&nbsp;<span class="builtintype" id="2413556">error</span><span class="op" id="2413561">)</span>&nbsp;<span class="op" id="2413563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413566">return</span>&nbsp;<span class="ident" id="2413573">ptracePoke</span><span class="op" id="2413583">(</span><span class="ident" id="2413584">PTRACE_POKETEXT</span><span class="op" id="2413599">,</span>&nbsp;<span class="ident" id="2413601">PTRACE_PEEKTEXT</span><span class="op" id="2413616">,</span>&nbsp;<span class="ident" id="2413618">pid</span><span class="op" id="2413621">,</span>&nbsp;<span class="ident" id="2413623">addr</span><span class="op" id="2413627">,</span>&nbsp;<span class="ident" id="2413629">data</span><span class="op" id="2413633">)</span><br>
<span class="lineno"></span><span class="op" id="2413635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="keyword" id="2413638">func</span>&nbsp;<span class="ident" id="2413643">PtracePokeData</span><span class="op" id="2413657">(</span><span class="ident" id="2413658">pid</span>&nbsp;<span class="builtintype" id="2413662">int</span><span class="op" id="2413665">,</span>&nbsp;<span class="ident" id="2413667">addr</span>&nbsp;<span class="builtintype" id="2413672">uintptr</span><span class="op" id="2413679">,</span>&nbsp;<span class="ident" id="2413681">data</span>&nbsp;<span class="op" id="2413686">[</span><span class="op" id="2413687">]</span><span class="builtintype" id="2413688">byte</span><span class="op" id="2413692">)</span>&nbsp;<span class="op" id="2413694">(</span><span class="ident" id="2413695">count</span>&nbsp;<span class="builtintype" id="2413701">int</span><span class="op" id="2413704">,</span>&nbsp;<span class="ident" id="2413706">err</span>&nbsp;<span class="builtintype" id="2413710">error</span><span class="op" id="2413715">)</span>&nbsp;<span class="op" id="2413717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413720">return</span>&nbsp;<span class="ident" id="2413727">ptracePoke</span><span class="op" id="2413737">(</span><span class="ident" id="2413738">PTRACE_POKEDATA</span><span class="op" id="2413753">,</span>&nbsp;<span class="ident" id="2413755">PTRACE_PEEKDATA</span><span class="op" id="2413770">,</span>&nbsp;<span class="ident" id="2413772">pid</span><span class="op" id="2413775">,</span>&nbsp;<span class="ident" id="2413777">addr</span><span class="op" id="2413781">,</span>&nbsp;<span class="ident" id="2413783">data</span><span class="op" id="2413787">)</span><br>
<span class="lineno"></span><span class="op" id="2413789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2413792">func</span>&nbsp;<span class="ident" id="2413797">PtraceGetRegs</span><span class="op" id="2413810">(</span><span class="ident" id="2413811">pid</span>&nbsp;<span class="builtintype" id="2413815">int</span><span class="op" id="2413818">,</span>&nbsp;<span class="ident" id="2413820">regsout</span>&nbsp;<span class="op" id="2413828">*</span><span class="ident" id="2413829">PtraceRegs</span><span class="op" id="2413839">)</span>&nbsp;<span class="op" id="2413841">(</span><span class="ident" id="2413842">err</span>&nbsp;<span class="builtintype" id="2413846">error</span><span class="op" id="2413851">)</span>&nbsp;<span class="op" id="2413853">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413856">return</span>&nbsp;<span class="ident" id="2413863">ptrace</span><span class="op" id="2413869">(</span><span class="ident" id="2413870">PTRACE_GETREGS</span><span class="op" id="2413884">,</span>&nbsp;<span class="ident" id="2413886">pid</span><span class="op" id="2413889">,</span>&nbsp;<span class="num" id="2413891">0</span><span class="op" id="2413892">,</span>&nbsp;<span class="builtintype" id="2413894">uintptr</span><span class="op" id="2413901">(</span><span class="ident" id="2413902">unsafe</span><span class="op" id="2413908">.</span><span class="ident" id="2413909">Pointer</span><span class="op" id="2413916">(</span><span class="ident" id="2413917">regsout</span><span class="op" id="2413924">)</span><span class="op" id="2413925">)</span><span class="op" id="2413926">)</span><br>
<span class="lineno"></span><span class="op" id="2413928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2413931">func</span>&nbsp;<span class="ident" id="2413936">PtraceSetRegs</span><span class="op" id="2413949">(</span><span class="ident" id="2413950">pid</span>&nbsp;<span class="builtintype" id="2413954">int</span><span class="op" id="2413957">,</span>&nbsp;<span class="ident" id="2413959">regs</span>&nbsp;<span class="op" id="2413964">*</span><span class="ident" id="2413965">PtraceRegs</span><span class="op" id="2413975">)</span>&nbsp;<span class="op" id="2413977">(</span><span class="ident" id="2413978">err</span>&nbsp;<span class="builtintype" id="2413982">error</span><span class="op" id="2413987">)</span>&nbsp;<span class="op" id="2413989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413992">return</span>&nbsp;<span class="ident" id="2413999">ptrace</span><span class="op" id="2414005">(</span><span class="ident" id="2414006">PTRACE_SETREGS</span><span class="op" id="2414020">,</span>&nbsp;<span class="ident" id="2414022">pid</span><span class="op" id="2414025">,</span>&nbsp;<span class="num" id="2414027">0</span><span class="op" id="2414028">,</span>&nbsp;<span class="builtintype" id="2414030">uintptr</span><span class="op" id="2414037">(</span><span class="ident" id="2414038">unsafe</span><span class="op" id="2414044">.</span><span class="ident" id="2414045">Pointer</span><span class="op" id="2414052">(</span><span class="ident" id="2414053">regs</span><span class="op" id="2414057">)</span><span class="op" id="2414058">)</span><span class="op" id="2414059">)</span><br>
<span class="lineno">695</span><span class="op" id="2414061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2414064">func</span>&nbsp;<span class="ident" id="2414069">PtraceSetOptions</span><span class="op" id="2414085">(</span><span class="ident" id="2414086">pid</span>&nbsp;<span class="builtintype" id="2414090">int</span><span class="op" id="2414093">,</span>&nbsp;<span class="ident" id="2414095">options</span>&nbsp;<span class="builtintype" id="2414103">int</span><span class="op" id="2414106">)</span>&nbsp;<span class="op" id="2414108">(</span><span class="ident" id="2414109">err</span>&nbsp;<span class="builtintype" id="2414113">error</span><span class="op" id="2414118">)</span>&nbsp;<span class="op" id="2414120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414123">return</span>&nbsp;<span class="ident" id="2414130">ptrace</span><span class="op" id="2414136">(</span><span class="ident" id="2414137">PTRACE_SETOPTIONS</span><span class="op" id="2414154">,</span>&nbsp;<span class="ident" id="2414156">pid</span><span class="op" id="2414159">,</span>&nbsp;<span class="num" id="2414161">0</span><span class="op" id="2414162">,</span>&nbsp;<span class="builtintype" id="2414164">uintptr</span><span class="op" id="2414171">(</span><span class="ident" id="2414172">options</span><span class="op" id="2414179">)</span><span class="op" id="2414180">)</span><br>
<span class="lineno"></span><span class="op" id="2414182">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="keyword" id="2414185">func</span>&nbsp;<span class="ident" id="2414190">PtraceGetEventMsg</span><span class="op" id="2414207">(</span><span class="ident" id="2414208">pid</span>&nbsp;<span class="builtintype" id="2414212">int</span><span class="op" id="2414215">)</span>&nbsp;<span class="op" id="2414217">(</span><span class="ident" id="2414218">msg</span>&nbsp;<span class="builtintype" id="2414222">uint</span><span class="op" id="2414226">,</span>&nbsp;<span class="ident" id="2414228">err</span>&nbsp;<span class="builtintype" id="2414232">error</span><span class="op" id="2414237">)</span>&nbsp;<span class="op" id="2414239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414242">var</span>&nbsp;<span class="ident" id="2414246">data</span>&nbsp;<span class="ident" id="2414251">_C_long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414260">err</span>&nbsp;<span class="op" id="2414264">=</span>&nbsp;<span class="ident" id="2414266">ptrace</span><span class="op" id="2414272">(</span><span class="ident" id="2414273">PTRACE_GETEVENTMSG</span><span class="op" id="2414291">,</span>&nbsp;<span class="ident" id="2414293">pid</span><span class="op" id="2414296">,</span>&nbsp;<span class="num" id="2414298">0</span><span class="op" id="2414299">,</span>&nbsp;<span class="builtintype" id="2414301">uintptr</span><span class="op" id="2414308">(</span><span class="ident" id="2414309">unsafe</span><span class="op" id="2414315">.</span><span class="ident" id="2414316">Pointer</span><span class="op" id="2414323">(</span><span class="op" id="2414324">&amp;</span><span class="ident" id="2414325">data</span><span class="op" id="2414329">)</span><span class="op" id="2414330">)</span><span class="op" id="2414331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414334">msg</span>&nbsp;<span class="op" id="2414338">=</span>&nbsp;<span class="builtintype" id="2414340">uint</span><span class="op" id="2414344">(</span><span class="ident" id="2414345">data</span><span class="op" id="2414349">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414352">return</span><br>
<span class="lineno"></span><span class="op" id="2414359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2414362">func</span>&nbsp;<span class="ident" id="2414367">PtraceCont</span><span class="op" id="2414377">(</span><span class="ident" id="2414378">pid</span>&nbsp;<span class="builtintype" id="2414382">int</span><span class="op" id="2414385">,</span>&nbsp;<span class="ident" id="2414387">signal</span>&nbsp;<span class="builtintype" id="2414394">int</span><span class="op" id="2414397">)</span>&nbsp;<span class="op" id="2414399">(</span><span class="ident" id="2414400">err</span>&nbsp;<span class="builtintype" id="2414404">error</span><span class="op" id="2414409">)</span>&nbsp;<span class="op" id="2414411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414414">return</span>&nbsp;<span class="ident" id="2414421">ptrace</span><span class="op" id="2414427">(</span><span class="ident" id="2414428">PTRACE_CONT</span><span class="op" id="2414439">,</span>&nbsp;<span class="ident" id="2414441">pid</span><span class="op" id="2414444">,</span>&nbsp;<span class="num" id="2414446">0</span><span class="op" id="2414447">,</span>&nbsp;<span class="builtintype" id="2414449">uintptr</span><span class="op" id="2414456">(</span><span class="ident" id="2414457">signal</span><span class="op" id="2414463">)</span><span class="op" id="2414464">)</span><br>
<span class="lineno">710</span><span class="op" id="2414466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2414469">func</span>&nbsp;<span class="ident" id="2414474">PtraceSyscall</span><span class="op" id="2414487">(</span><span class="ident" id="2414488">pid</span>&nbsp;<span class="builtintype" id="2414492">int</span><span class="op" id="2414495">,</span>&nbsp;<span class="ident" id="2414497">signal</span>&nbsp;<span class="builtintype" id="2414504">int</span><span class="op" id="2414507">)</span>&nbsp;<span class="op" id="2414509">(</span><span class="ident" id="2414510">err</span>&nbsp;<span class="builtintype" id="2414514">error</span><span class="op" id="2414519">)</span>&nbsp;<span class="op" id="2414521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414524">return</span>&nbsp;<span class="ident" id="2414531">ptrace</span><span class="op" id="2414537">(</span><span class="ident" id="2414538">PTRACE_SYSCALL</span><span class="op" id="2414552">,</span>&nbsp;<span class="ident" id="2414554">pid</span><span class="op" id="2414557">,</span>&nbsp;<span class="num" id="2414559">0</span><span class="op" id="2414560">,</span>&nbsp;<span class="builtintype" id="2414562">uintptr</span><span class="op" id="2414569">(</span><span class="ident" id="2414570">signal</span><span class="op" id="2414576">)</span><span class="op" id="2414577">)</span><br>
<span class="lineno"></span><span class="op" id="2414579">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="2414582">func</span>&nbsp;<span class="ident" id="2414587">PtraceSingleStep</span><span class="op" id="2414603">(</span><span class="ident" id="2414604">pid</span>&nbsp;<span class="builtintype" id="2414608">int</span><span class="op" id="2414611">)</span>&nbsp;<span class="op" id="2414613">(</span><span class="ident" id="2414614">err</span>&nbsp;<span class="builtintype" id="2414618">error</span><span class="op" id="2414623">)</span>&nbsp;<span class="op" id="2414625">{</span>&nbsp;<span class="keyword" id="2414627">return</span>&nbsp;<span class="ident" id="2414634">ptrace</span><span class="op" id="2414640">(</span><span class="ident" id="2414641">PTRACE_SINGLESTEP</span><span class="op" id="2414658">,</span>&nbsp;<span class="ident" id="2414660">pid</span><span class="op" id="2414663">,</span>&nbsp;<span class="num" id="2414665">0</span><span class="op" id="2414666">,</span>&nbsp;<span class="num" id="2414668">0</span><span class="op" id="2414669">)</span>&nbsp;<span class="op" id="2414671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2414674">func</span>&nbsp;<span class="ident" id="2414679">PtraceAttach</span><span class="op" id="2414691">(</span><span class="ident" id="2414692">pid</span>&nbsp;<span class="builtintype" id="2414696">int</span><span class="op" id="2414699">)</span>&nbsp;<span class="op" id="2414701">(</span><span class="ident" id="2414702">err</span>&nbsp;<span class="builtintype" id="2414706">error</span><span class="op" id="2414711">)</span>&nbsp;<span class="op" id="2414713">{</span>&nbsp;<span class="keyword" id="2414715">return</span>&nbsp;<span class="ident" id="2414722">ptrace</span><span class="op" id="2414728">(</span><span class="ident" id="2414729">PTRACE_ATTACH</span><span class="op" id="2414742">,</span>&nbsp;<span class="ident" id="2414744">pid</span><span class="op" id="2414747">,</span>&nbsp;<span class="num" id="2414749">0</span><span class="op" id="2414750">,</span>&nbsp;<span class="num" id="2414752">0</span><span class="op" id="2414753">)</span>&nbsp;<span class="op" id="2414755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span><span class="keyword" id="2414758">func</span>&nbsp;<span class="ident" id="2414763">PtraceDetach</span><span class="op" id="2414775">(</span><span class="ident" id="2414776">pid</span>&nbsp;<span class="builtintype" id="2414780">int</span><span class="op" id="2414783">)</span>&nbsp;<span class="op" id="2414785">(</span><span class="ident" id="2414786">err</span>&nbsp;<span class="builtintype" id="2414790">error</span><span class="op" id="2414795">)</span>&nbsp;<span class="op" id="2414797">{</span>&nbsp;<span class="keyword" id="2414799">return</span>&nbsp;<span class="ident" id="2414806">ptrace</span><span class="op" id="2414812">(</span><span class="ident" id="2414813">PTRACE_DETACH</span><span class="op" id="2414826">,</span>&nbsp;<span class="ident" id="2414828">pid</span><span class="op" id="2414831">,</span>&nbsp;<span class="num" id="2414833">0</span><span class="op" id="2414834">,</span>&nbsp;<span class="num" id="2414836">0</span><span class="op" id="2414837">)</span>&nbsp;<span class="op" id="2414839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2414842">//sys&nbsp;&nbsp;&nbsp;&nbspreboot(magic1&nbsp;uint,&nbsp;magic2&nbsp;uint,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2414915">func</span>&nbsp;<span class="ident" id="2414920">Reboot</span><span class="op" id="2414926">(</span><span class="ident" id="2414927">cmd</span>&nbsp;<span class="builtintype" id="2414931">int</span><span class="op" id="2414934">)</span>&nbsp;<span class="op" id="2414936">(</span><span class="ident" id="2414937">err</span>&nbsp;<span class="builtintype" id="2414941">error</span><span class="op" id="2414946">)</span>&nbsp;<span class="op" id="2414948">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414951">return</span>&nbsp;<span class="ident" id="2414958">reboot</span><span class="op" id="2414964">(</span><span class="ident" id="2414965">LINUX_REBOOT_MAGIC1</span><span class="op" id="2414984">,</span>&nbsp;<span class="ident" id="2414986">LINUX_REBOOT_MAGIC2</span><span class="op" id="2415005">,</span>&nbsp;<span class="ident" id="2415007">cmd</span><span class="op" id="2415010">,</span>&nbsp;<span class="string" id="2415012">&#34;&#34;</span><span class="op" id="2415014">)</span><br>
<span class="lineno"></span><span class="op" id="2415016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2415019">func</span>&nbsp;<span class="ident" id="2415024">clen</span><span class="op" id="2415028">(</span><span class="ident" id="2415029">n</span>&nbsp;<span class="op" id="2415031">[</span><span class="op" id="2415032">]</span><span class="builtintype" id="2415033">byte</span><span class="op" id="2415037">)</span>&nbsp;<span class="builtintype" id="2415039">int</span>&nbsp;<span class="op" id="2415043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415046">for</span>&nbsp;<span class="ident" id="2415050">i</span>&nbsp;<span class="op" id="2415052">:=</span>&nbsp;<span class="num" id="2415055">0</span><span class="op" id="2415056">;</span>&nbsp;<span class="ident" id="2415058">i</span>&nbsp;<span class="op" id="2415060">&lt;</span>&nbsp;<span class="builtinfunc" id="2415062">len</span><span class="op" id="2415065">(</span><span class="ident" id="2415066">n</span><span class="op" id="2415067">)</span><span class="op" id="2415068">;</span>&nbsp;<span class="ident" id="2415070">i</span><span class="op" id="2415071">++</span>&nbsp;<span class="op" id="2415074">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415078">if</span>&nbsp;<span class="ident" id="2415081">n</span><span class="op" id="2415082">[</span><span class="ident" id="2415083">i</span><span class="op" id="2415084">]</span>&nbsp;<span class="op" id="2415086">==</span>&nbsp;<span class="num" id="2415089">0</span>&nbsp;<span class="op" id="2415091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415096">return</span>&nbsp;<span class="ident" id="2415103">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2415107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2415110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415113">return</span>&nbsp;<span class="builtinfunc" id="2415120">len</span><span class="op" id="2415123">(</span><span class="ident" id="2415124">n</span><span class="op" id="2415125">)</span><br>
<span class="lineno">735</span><span class="op" id="2415127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2415130">func</span>&nbsp;<span class="ident" id="2415135">ReadDirent</span><span class="op" id="2415145">(</span><span class="ident" id="2415146">fd</span>&nbsp;<span class="builtintype" id="2415149">int</span><span class="op" id="2415152">,</span>&nbsp;<span class="ident" id="2415154">buf</span>&nbsp;<span class="op" id="2415158">[</span><span class="op" id="2415159">]</span><span class="builtintype" id="2415160">byte</span><span class="op" id="2415164">)</span>&nbsp;<span class="op" id="2415166">(</span><span class="ident" id="2415167">n</span>&nbsp;<span class="builtintype" id="2415169">int</span><span class="op" id="2415172">,</span>&nbsp;<span class="ident" id="2415174">err</span>&nbsp;<span class="builtintype" id="2415178">error</span><span class="op" id="2415183">)</span>&nbsp;<span class="op" id="2415185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415188">return</span>&nbsp;<span class="ident" id="2415195">Getdents</span><span class="op" id="2415203">(</span><span class="ident" id="2415204">fd</span><span class="op" id="2415206">,</span>&nbsp;<span class="ident" id="2415208">buf</span><span class="op" id="2415211">)</span><br>
<span class="lineno"></span><span class="op" id="2415213">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="2415216">func</span>&nbsp;<span class="ident" id="2415221">ParseDirent</span><span class="op" id="2415232">(</span><span class="ident" id="2415233">buf</span>&nbsp;<span class="op" id="2415237">[</span><span class="op" id="2415238">]</span><span class="builtintype" id="2415239">byte</span><span class="op" id="2415243">,</span>&nbsp;<span class="ident" id="2415245">max</span>&nbsp;<span class="builtintype" id="2415249">int</span><span class="op" id="2415252">,</span>&nbsp;<span class="ident" id="2415254">names</span>&nbsp;<span class="op" id="2415260">[</span><span class="op" id="2415261">]</span><span class="builtintype" id="2415262">string</span><span class="op" id="2415268">)</span>&nbsp;<span class="op" id="2415270">(</span><span class="ident" id="2415271">consumed</span>&nbsp;<span class="builtintype" id="2415280">int</span><span class="op" id="2415283">,</span>&nbsp;<span class="ident" id="2415285">count</span>&nbsp;<span class="builtintype" id="2415291">int</span><span class="op" id="2415294">,</span>&nbsp;<span class="ident" id="2415296">newnames</span>&nbsp;<span class="op" id="2415305">[</span><span class="op" id="2415306">]</span><span class="builtintype" id="2415307">string</span><span class="op" id="2415313">)</span>&nbsp;<span class="op" id="2415315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415318">origlen</span>&nbsp;<span class="op" id="2415326">:=</span>&nbsp;<span class="builtinfunc" id="2415329">len</span><span class="op" id="2415332">(</span><span class="ident" id="2415333">buf</span><span class="op" id="2415336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415339">count</span>&nbsp;<span class="op" id="2415345">=</span>&nbsp;<span class="num" id="2415347">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415350">for</span>&nbsp;<span class="ident" id="2415354">max</span>&nbsp;<span class="op" id="2415358">!=</span>&nbsp;<span class="num" id="2415361">0</span>&nbsp;<span class="op" id="2415363">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2415366">len</span><span class="op" id="2415369">(</span><span class="ident" id="2415370">buf</span><span class="op" id="2415373">)</span>&nbsp;<span class="op" id="2415375">&gt;</span>&nbsp;<span class="num" id="2415377">0</span>&nbsp;<span class="op" id="2415379">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415383">dirent</span>&nbsp;<span class="op" id="2415390">:=</span>&nbsp;<span class="op" id="2415393">(</span><span class="op" id="2415394">*</span><span class="ident" id="2415395">Dirent</span><span class="op" id="2415401">)</span><span class="op" id="2415402">(</span><span class="ident" id="2415403">unsafe</span><span class="op" id="2415409">.</span><span class="ident" id="2415410">Pointer</span><span class="op" id="2415417">(</span><span class="op" id="2415418">&amp;</span><span class="ident" id="2415419">buf</span><span class="op" id="2415422">[</span><span class="num" id="2415423">0</span><span class="op" id="2415424">]</span><span class="op" id="2415425">)</span><span class="op" id="2415426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415430">buf</span>&nbsp;<span class="op" id="2415434">=</span>&nbsp;<span class="ident" id="2415436">buf</span><span class="op" id="2415439">[</span><span class="ident" id="2415440">dirent</span><span class="op" id="2415446">.</span><span class="ident" id="2415447">Reclen</span><span class="op" id="2415453">:</span><span class="op" id="2415454">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415458">if</span>&nbsp;<span class="ident" id="2415461">dirent</span><span class="op" id="2415467">.</span><span class="ident" id="2415468">Ino</span>&nbsp;<span class="op" id="2415472">==</span>&nbsp;<span class="num" id="2415475">0</span>&nbsp;<span class="op" id="2415477">{</span>&nbsp;<span class="comment" id="2415479">//&nbsp;File&nbsp;absent&nbsp;in&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415511">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2415522">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415526">bytes</span>&nbsp;<span class="op" id="2415532">:=</span>&nbsp;<span class="op" id="2415535">(</span><span class="op" id="2415536">*</span><span class="op" id="2415537">[</span><span class="num" id="2415538">10000</span><span class="op" id="2415543">]</span><span class="builtintype" id="2415544">byte</span><span class="op" id="2415548">)</span><span class="op" id="2415549">(</span><span class="ident" id="2415550">unsafe</span><span class="op" id="2415556">.</span><span class="ident" id="2415557">Pointer</span><span class="op" id="2415564">(</span><span class="op" id="2415565">&amp;</span><span class="ident" id="2415566">dirent</span><span class="op" id="2415572">.</span><span class="ident" id="2415573">Name</span><span class="op" id="2415577">[</span><span class="num" id="2415578">0</span><span class="op" id="2415579">]</span><span class="op" id="2415580">)</span><span class="op" id="2415581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415585">var</span>&nbsp;<span class="ident" id="2415589">name</span>&nbsp;<span class="op" id="2415594">=</span>&nbsp;<span class="builtintype" id="2415596">string</span><span class="op" id="2415602">(</span><span class="ident" id="2415603">bytes</span><span class="op" id="2415608">[</span><span class="num" id="2415609">0</span><span class="op" id="2415610">:</span><span class="ident" id="2415611">clen</span><span class="op" id="2415615">(</span><span class="ident" id="2415616">bytes</span><span class="op" id="2415621">[</span><span class="op" id="2415622">:</span><span class="op" id="2415623">]</span><span class="op" id="2415624">)</span><span class="op" id="2415625">]</span><span class="op" id="2415626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415630">if</span>&nbsp;<span class="ident" id="2415633">name</span>&nbsp;<span class="op" id="2415638">==</span>&nbsp;<span class="string" id="2415641">&#34;.&#34;</span>&nbsp;<span class="op" id="2415645">||</span>&nbsp;<span class="ident" id="2415648">name</span>&nbsp;<span class="op" id="2415653">==</span>&nbsp;<span class="string" id="2415656">&#34;..&#34;</span>&nbsp;<span class="op" id="2415661">{</span>&nbsp;<span class="comment" id="2415663">//&nbsp;Useless&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415683">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2415694">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415698">max</span><span class="op" id="2415701">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415706">count</span><span class="op" id="2415711">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415716">names</span>&nbsp;<span class="op" id="2415722">=</span>&nbsp;<span class="builtinfunc" id="2415724">append</span><span class="op" id="2415730">(</span><span class="ident" id="2415731">names</span><span class="op" id="2415736">,</span>&nbsp;<span class="ident" id="2415738">name</span><span class="op" id="2415742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2415745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415748">return</span>&nbsp;<span class="ident" id="2415755">origlen</span>&nbsp;<span class="op" id="2415763">-</span>&nbsp;<span class="builtinfunc" id="2415765">len</span><span class="op" id="2415768">(</span><span class="ident" id="2415769">buf</span><span class="op" id="2415772">)</span><span class="op" id="2415773">,</span>&nbsp;<span class="ident" id="2415775">count</span><span class="op" id="2415780">,</span>&nbsp;<span class="ident" id="2415782">names</span><br>
<span class="lineno">760</span><span class="op" id="2415788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2415791">//sys&nbsp;&nbsp;&nbsp;&nbspmount(source&nbsp;string,&nbsp;target&nbsp;string,&nbsp;fstype&nbsp;string,&nbsp;flags&nbsp;uintptr,&nbsp;data&nbsp;*byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2415888">func</span>&nbsp;<span class="ident" id="2415893">Mount</span><span class="op" id="2415898">(</span><span class="ident" id="2415899">source</span>&nbsp;<span class="builtintype" id="2415906">string</span><span class="op" id="2415912">,</span>&nbsp;<span class="ident" id="2415914">target</span>&nbsp;<span class="builtintype" id="2415921">string</span><span class="op" id="2415927">,</span>&nbsp;<span class="ident" id="2415929">fstype</span>&nbsp;<span class="builtintype" id="2415936">string</span><span class="op" id="2415942">,</span>&nbsp;<span class="ident" id="2415944">flags</span>&nbsp;<span class="builtintype" id="2415950">uintptr</span><span class="op" id="2415957">,</span>&nbsp;<span class="ident" id="2415959">data</span>&nbsp;<span class="builtintype" id="2415964">string</span><span class="op" id="2415970">)</span>&nbsp;<span class="op" id="2415972">(</span><span class="ident" id="2415973">err</span>&nbsp;<span class="builtintype" id="2415977">error</span><span class="op" id="2415982">)</span>&nbsp;<span class="op" id="2415984">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2415987">//&nbsp;Certain&nbsp;file&nbsp;systems&nbsp;get&nbsp;rather&nbsp;angry&nbsp;and&nbsp;EINVAL&nbsp;if&nbsp;you&nbsp;give</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2416052">//&nbsp;them&nbsp;an&nbsp;empty&nbsp;string&nbsp;of&nbsp;data,&nbsp;rather&nbsp;than&nbsp;NULL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2416104">if</span>&nbsp;<span class="ident" id="2416107">data</span>&nbsp;<span class="op" id="2416112">==</span>&nbsp;<span class="string" id="2416115">&#34;&#34;</span>&nbsp;<span class="op" id="2416118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2416122">return</span>&nbsp;<span class="ident" id="2416129">mount</span><span class="op" id="2416134">(</span><span class="ident" id="2416135">source</span><span class="op" id="2416141">,</span>&nbsp;<span class="ident" id="2416143">target</span><span class="op" id="2416149">,</span>&nbsp;<span class="ident" id="2416151">fstype</span><span class="op" id="2416157">,</span>&nbsp;<span class="ident" id="2416159">flags</span><span class="op" id="2416164">,</span>&nbsp;<span class="ident" id="2416166">nil</span><span class="op" id="2416169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2416172">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2416175">datap</span><span class="op" id="2416180">,</span>&nbsp;<span class="ident" id="2416182">err</span>&nbsp;<span class="op" id="2416186">:=</span>&nbsp;<span class="ident" id="2416189">BytePtrFromString</span><span class="op" id="2416206">(</span><span class="ident" id="2416207">data</span><span class="op" id="2416211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2416214">if</span>&nbsp;<span class="ident" id="2416217">err</span>&nbsp;<span class="op" id="2416221">!=</span>&nbsp;<span class="ident" id="2416224">nil</span>&nbsp;<span class="op" id="2416228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2416232">return</span>&nbsp;<span class="ident" id="2416239">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2416244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2416247">err</span>&nbsp;<span class="op" id="2416251">=</span>&nbsp;<span class="ident" id="2416253">mount</span><span class="op" id="2416258">(</span><span class="ident" id="2416259">source</span><span class="op" id="2416265">,</span>&nbsp;<span class="ident" id="2416267">target</span><span class="op" id="2416273">,</span>&nbsp;<span class="ident" id="2416275">fstype</span><span class="op" id="2416281">,</span>&nbsp;<span class="ident" id="2416283">flags</span><span class="op" id="2416288">,</span>&nbsp;<span class="ident" id="2416290">datap</span><span class="op" id="2416295">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2416298">use</span><span class="op" id="2416301">(</span><span class="ident" id="2416302">unsafe</span><span class="op" id="2416308">.</span><span class="ident" id="2416309">Pointer</span><span class="op" id="2416316">(</span><span class="ident" id="2416317">datap</span><span class="op" id="2416322">)</span><span class="op" id="2416323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2416326">return</span>&nbsp;<span class="ident" id="2416333">err</span><br>
<span class="lineno"></span><span class="op" id="2416337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2416340">//&nbsp;Sendto</span><br>
<span class="lineno">780</span><span class="comment" id="2416350">//&nbsp;Recvfrom</span><br>
<span class="lineno"></span><span class="comment" id="2416362">//&nbsp;Socketpair</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2416377">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Direct&nbsp;access<br>
<span class="lineno">785</span>&nbsp;*/</span><br>
<span class="lineno"></span><span class="comment" id="2416401">//sys&nbsp;&nbsp;&nbsp;&nbspAccess(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416452">//sys&nbsp;&nbsp;&nbsp;&nbspAcct(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416488">//sys&nbsp;&nbsp;&nbsp;&nbspAdjtimex(buf&nbsp;*Timex)&nbsp;(state&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416538">//sys&nbsp;&nbsp;&nbsp;&nbspChdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">790</span><span class="comment" id="2416575">//sys&nbsp;&nbsp;&nbsp;&nbspChmod(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416625">//sys&nbsp;&nbsp;&nbsp;&nbspChroot(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416663">//sys&nbsp;&nbsp;&nbsp;&nbspClose(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416695">//sys&nbsp;&nbsp;&nbsp;&nbspCreat(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416753">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup(oldfd&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">795</span><span class="comment" id="2416796">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup2(oldfd&nbsp;int,&nbsp;newfd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416843">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup3(oldfd&nbsp;int,&nbsp;newfd&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416901">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCreate(size&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2416951">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCreate1(flag&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417002">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCtl(epfd&nbsp;int,&nbsp;op&nbsp;int,&nbsp;fd&nbsp;int,&nbsp;event&nbsp;*EpollEvent)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">800</span><span class="comment" id="2417076">//sys&nbsp;&nbsp;&nbsp;&nbspEpollWait(epfd&nbsp;int,&nbsp;events&nbsp;[]EpollEvent,&nbsp;msec&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417152">//sys&nbsp;&nbsp;&nbsp;&nbspExit(code&nbsp;int)&nbsp;=&nbsp;SYS_EXIT_GROUP</span><br>
<span class="lineno"></span><span class="comment" id="2417190">//sys&nbsp;&nbsp;&nbsp;&nbspFaccessat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417266">//sys&nbsp;&nbsp;&nbsp;&nbspFallocate(fd&nbsp;int,&nbsp;mode&nbsp;uint32,&nbsp;off&nbsp;int64,&nbsp;len&nbsp;int64)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417337">//sys&nbsp;&nbsp;&nbsp;&nbspFchdir(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">805</span><span class="comment" id="2417370">//sys&nbsp;&nbsp;&nbsp;&nbspFchmod(fd&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417416">//sys&nbsp;&nbsp;&nbsp;&nbspFchmodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417491">//sys&nbsp;&nbsp;&nbsp;&nbspFchownat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;uid&nbsp;int,&nbsp;gid&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417571">//sys&nbsp;&nbsp;&nbsp;&nbspfcntl(fd&nbsp;int,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;int)&nbsp;(val&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417630">//sys&nbsp;&nbsp;&nbsp;&nbspFdatasync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">810</span><span class="comment" id="2417666">//sys&nbsp;&nbsp;&nbsp;&nbspFlock(fd&nbsp;int,&nbsp;how&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417707">//sys&nbsp;&nbsp;&nbsp;&nbspFsync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417739">//sys&nbsp;&nbsp;&nbsp;&nbspGetdents(fd&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_GETDENTS64</span><br>
<span class="lineno"></span><span class="comment" id="2417810">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpgid(pid&nbsp;int)&nbsp;(pgid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2417857">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpgrp()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno">815</span><span class="comment" id="2417885">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpid()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2417912">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetppid()&nbsp;(ppid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2417941">//sys&nbsp;&nbsp;&nbsp;&nbspGetpriority(which&nbsp;int,&nbsp;who&nbsp;int)&nbsp;(prio&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418001">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetrusage(who&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418056">//sysnb&nbsp;&nbsp;&nbsp;&nbspGettid()&nbsp;(tid&nbsp;int)</span><br>
<span class="lineno">820</span><span class="comment" id="2418083">//sys&nbsp;&nbsp;&nbsp;&nbspGetxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418157">//sys&nbsp;&nbsp;&nbsp;&nbspInotifyAddWatch(fd&nbsp;int,&nbsp;pathname&nbsp;string,&nbsp;mask&nbsp;uint32)&nbsp;(watchdesc&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418244">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyInit()&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418286">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyInit1(flags&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418338">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyRmWatch(fd&nbsp;int,&nbsp;watchdesc&nbsp;uint32)&nbsp;(success&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">825</span><span class="comment" id="2418412">//sysnb&nbsp;&nbsp;&nbsp;&nbspKill(pid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418458">//sys&nbsp;&nbsp;&nbsp;&nbspKlogctl(typ&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_SYSLOG</span><br>
<span class="lineno"></span><span class="comment" id="2418525">//sys&nbsp;&nbsp;&nbsp;&nbspLink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418580">//sys&nbsp;&nbsp;&nbsp;&nbspListxattr(path&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418642">//sys&nbsp;&nbsp;&nbsp;&nbspMkdir(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">830</span><span class="comment" id="2418692">//sys&nbsp;&nbsp;&nbsp;&nbspMkdirat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418755">//sys&nbsp;&nbsp;&nbsp;&nbspMknod(path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418814">//sys&nbsp;&nbsp;&nbsp;&nbspMknodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418886">//sys&nbsp;&nbsp;&nbsp;&nbspNanosleep(time&nbsp;*Timespec,&nbsp;leftover&nbsp;*Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2418950">//sys&nbsp;&nbsp;&nbsp;&nbspPause()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">835</span><span class="comment" id="2418976">//sys&nbsp;&nbsp;&nbsp;&nbspPivotRoot(newroot&nbsp;string,&nbsp;putold&nbsp;string)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PIVOT_ROOT</span><br>
<span class="lineno"></span><span class="comment" id="2419052">//sysnb&nbsp;prlimit(pid&nbsp;int,&nbsp;resource&nbsp;int,&nbsp;old&nbsp;*Rlimit,&nbsp;newlimit&nbsp;*Rlimit)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PRLIMIT64</span><br>
<span class="lineno"></span><span class="comment" id="2419150">//sys&nbsp;&nbsp;&nbsp;&nbspread(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2419198">//sys&nbsp;&nbsp;&nbsp;&nbspReadlink(path&nbsp;string,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2419257">//sys&nbsp;&nbsp;&nbsp;&nbspRemovexattr(path&nbsp;string,&nbsp;attr&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">840</span><span class="comment" id="2419313">//sys&nbsp;&nbsp;&nbsp;&nbspRename(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2419370">//sys&nbsp;&nbsp;&nbsp;&nbspRenameat(olddirfd&nbsp;int,&nbsp;oldpath&nbsp;string,&nbsp;newdirfd&nbsp;int,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2419457">//sys&nbsp;&nbsp;&nbsp;&nbspRmdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2419494">//sys&nbsp;&nbsp;&nbsp;&nbspSetdomainname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2419536">//sys&nbsp;&nbsp;&nbsp;&nbspSethostname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">845</span><span class="comment" id="2419576">//sysnb&nbsp;&nbsp;&nbsp;&nbspSetpgid(pid&nbsp;int,&nbsp;pgid&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2419623">//sysnb&nbsp;&nbsp;&nbsp;&nbspSetsid()&nbsp;(pid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2419661">//sysnb&nbsp;&nbsp;&nbsp;&nbspSettimeofday(tv&nbsp;*Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2419708">//&nbsp;issue&nbsp;1435.</span><br>
<span class="lineno">850</span><span class="comment" id="2419723">//&nbsp;On&nbsp;linux&nbsp;Setuid&nbsp;and&nbsp;Setgid&nbsp;only&nbsp;affects&nbsp;the&nbsp;current&nbsp;thread,&nbsp;not&nbsp;the&nbsp;process.</span><br>
<span class="lineno"></span><span class="comment" id="2419803">//&nbsp;This&nbsp;does&nbsp;not&nbsp;match&nbsp;what&nbsp;most&nbsp;callers&nbsp;expect&nbsp;so&nbsp;we&nbsp;must&nbsp;return&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2419878">//&nbsp;here&nbsp;rather&nbsp;than&nbsp;letting&nbsp;the&nbsp;caller&nbsp;think&nbsp;that&nbsp;the&nbsp;call&nbsp;succeeded.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2419949">func</span>&nbsp;<span class="ident" id="2419954">Setuid</span><span class="op" id="2419960">(</span><span class="ident" id="2419961">uid</span>&nbsp;<span class="builtintype" id="2419965">int</span><span class="op" id="2419968">)</span>&nbsp;<span class="op" id="2419970">(</span><span class="ident" id="2419971">err</span>&nbsp;<span class="builtintype" id="2419975">error</span><span class="op" id="2419980">)</span>&nbsp;<span class="op" id="2419982">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2419985">return</span>&nbsp;<span class="ident" id="2419992">EOPNOTSUPP</span><br>
<span class="lineno"></span><span class="op" id="2420003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2420006">func</span>&nbsp;<span class="ident" id="2420011">Setgid</span><span class="op" id="2420017">(</span><span class="ident" id="2420018">uid</span>&nbsp;<span class="builtintype" id="2420022">int</span><span class="op" id="2420025">)</span>&nbsp;<span class="op" id="2420027">(</span><span class="ident" id="2420028">err</span>&nbsp;<span class="builtintype" id="2420032">error</span><span class="op" id="2420037">)</span>&nbsp;<span class="op" id="2420039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420042">return</span>&nbsp;<span class="ident" id="2420049">EOPNOTSUPP</span><br>
<span class="lineno">860</span><span class="op" id="2420060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2420063">//sys&nbsp;&nbsp;&nbsp;&nbspSetpriority(which&nbsp;int,&nbsp;who&nbsp;int,&nbsp;prio&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2420123">//sys&nbsp;&nbsp;&nbsp;&nbspSetxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;data&nbsp;[]byte,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2420200">//sys&nbsp;&nbsp;&nbsp;&nbspSymlink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">865</span><span class="comment" id="2420258">//sys&nbsp;&nbsp;&nbsp;&nbspSync()</span><br>
<span class="lineno"></span><span class="comment" id="2420271">//sysnb&nbsp;&nbsp;&nbsp;&nbspSysinfo(info&nbsp;*Sysinfo_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2420316">//sys&nbsp;&nbsp;&nbsp;&nbspTee(rfd&nbsp;int,&nbsp;wfd&nbsp;int,&nbsp;len&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(n&nbsp;int64,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2420385">//sysnb&nbsp;&nbsp;&nbsp;&nbspTgkill(tgid&nbsp;int,&nbsp;tid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2420443">//sysnb&nbsp;&nbsp;&nbsp;&nbspTimes(tms&nbsp;*Tms)&nbsp;(ticks&nbsp;uintptr,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">870</span><span class="comment" id="2420494">//sysnb&nbsp;&nbsp;&nbsp;&nbspUmask(mask&nbsp;int)&nbsp;(oldmask&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2420532">//sysnb&nbsp;&nbsp;&nbsp;&nbspUname(buf&nbsp;*Utsname)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2420572">//sys&nbsp;&nbsp;&nbsp;&nbspUnlink(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2420610">//sys&nbsp;&nbsp;&nbsp;&nbspUnlinkat(dirfd&nbsp;int,&nbsp;path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2420661">//sys&nbsp;&nbsp;&nbsp;&nbspUnmount(target&nbsp;string,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_UMOUNT2</span><br>
<span class="lineno">875</span><span class="comment" id="2420727">//sys&nbsp;&nbsp;&nbsp;&nbspUnshare(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2420764">//sys&nbsp;&nbsp;&nbsp;&nbspUstat(dev&nbsp;int,&nbsp;ubuf&nbsp;*Ustat_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2420812">//sys&nbsp;&nbsp;&nbsp;&nbspUtime(path&nbsp;string,&nbsp;buf&nbsp;*Utimbuf)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2420863">//sys&nbsp;&nbsp;&nbsp;&nbspwrite(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2420912">//sys&nbsp;&nbsp;&nbsp;&nbspexitThread(code&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_EXIT</span><br>
<span class="lineno">880</span><span class="comment" id="2420962">//sys&nbsp;&nbsp;&nbsp;&nbspreadlen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_READ</span><br>
<span class="lineno"></span><span class="comment" id="2421031">//sys&nbsp;&nbsp;&nbsp;&nbspwritelen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_WRITE</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2421103">//&nbsp;mmap&nbsp;varies&nbsp;by&nbsp;architecture;&nbsp;see&nbsp;syscall_linux_*.go.</span><br>
<span class="lineno"></span><span class="comment" id="2421159">//sys&nbsp;&nbsp;&nbsp;&nbspmunmap(addr&nbsp;uintptr,&nbsp;length&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span><span class="keyword" id="2421215">var</span>&nbsp;<span class="ident" id="2421219">mapper</span>&nbsp;<span class="op" id="2421226">=</span>&nbsp;<span class="op" id="2421228">&amp;</span><span class="ident" id="2421229">mmapper</span><span class="op" id="2421236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2421239">active</span><span class="op" id="2421245">:</span>&nbsp;<span class="builtinfunc" id="2421247">make</span><span class="op" id="2421251">(</span><span class="keyword" id="2421252">map</span><span class="op" id="2421255">[</span><span class="op" id="2421256">*</span><span class="builtintype" id="2421257">byte</span><span class="op" id="2421261">]</span><span class="op" id="2421262">[</span><span class="op" id="2421263">]</span><span class="builtintype" id="2421264">byte</span><span class="op" id="2421268">)</span><span class="op" id="2421269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2421272">mmap</span><span class="op" id="2421276">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2421280">mmap</span><span class="op" id="2421284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2421287">munmap</span><span class="op" id="2421293">:</span>&nbsp;<span class="ident" id="2421295">munmap</span><span class="op" id="2421301">,</span><br>
<span class="lineno">890</span><span class="op" id="2421303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2421306">func</span>&nbsp;<span class="ident" id="2421311">Mmap</span><span class="op" id="2421315">(</span><span class="ident" id="2421316">fd</span>&nbsp;<span class="builtintype" id="2421319">int</span><span class="op" id="2421322">,</span>&nbsp;<span class="ident" id="2421324">offset</span>&nbsp;<span class="ident" id="2421331">int64</span><span class="op" id="2421336">,</span>&nbsp;<span class="ident" id="2421338">length</span>&nbsp;<span class="builtintype" id="2421345">int</span><span class="op" id="2421348">,</span>&nbsp;<span class="ident" id="2421350">prot</span>&nbsp;<span class="builtintype" id="2421355">int</span><span class="op" id="2421358">,</span>&nbsp;<span class="ident" id="2421360">flags</span>&nbsp;<span class="builtintype" id="2421366">int</span><span class="op" id="2421369">)</span>&nbsp;<span class="op" id="2421371">(</span><span class="ident" id="2421372">data</span>&nbsp;<span class="op" id="2421377">[</span><span class="op" id="2421378">]</span><span class="builtintype" id="2421379">byte</span><span class="op" id="2421383">,</span>&nbsp;<span class="ident" id="2421385">err</span>&nbsp;<span class="builtintype" id="2421389">error</span><span class="op" id="2421394">)</span>&nbsp;<span class="op" id="2421396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421399">return</span>&nbsp;<span class="ident" id="2421406">mapper</span><span class="op" id="2421412">.</span><span class="ident" id="2421413">Mmap</span><span class="op" id="2421417">(</span><span class="ident" id="2421418">fd</span><span class="op" id="2421420">,</span>&nbsp;<span class="ident" id="2421422">offset</span><span class="op" id="2421428">,</span>&nbsp;<span class="ident" id="2421430">length</span><span class="op" id="2421436">,</span>&nbsp;<span class="ident" id="2421438">prot</span><span class="op" id="2421442">,</span>&nbsp;<span class="ident" id="2421444">flags</span><span class="op" id="2421449">)</span><br>
<span class="lineno"></span><span class="op" id="2421451">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="keyword" id="2421454">func</span>&nbsp;<span class="ident" id="2421459">Munmap</span><span class="op" id="2421465">(</span><span class="ident" id="2421466">b</span>&nbsp;<span class="op" id="2421468">[</span><span class="op" id="2421469">]</span><span class="builtintype" id="2421470">byte</span><span class="op" id="2421474">)</span>&nbsp;<span class="op" id="2421476">(</span><span class="ident" id="2421477">err</span>&nbsp;<span class="builtintype" id="2421481">error</span><span class="op" id="2421486">)</span>&nbsp;<span class="op" id="2421488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421491">return</span>&nbsp;<span class="ident" id="2421498">mapper</span><span class="op" id="2421504">.</span><span class="ident" id="2421505">Munmap</span><span class="op" id="2421511">(</span><span class="ident" id="2421512">b</span><span class="op" id="2421513">)</span><br>
<span class="lineno"></span><span class="op" id="2421515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="2421518">//sys&nbsp;&nbsp;&nbsp;&nbspMadvise(b&nbsp;[]byte,&nbsp;advice&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2421566">//sys&nbsp;&nbsp;&nbsp;&nbspMprotect(b&nbsp;[]byte,&nbsp;prot&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2421613">//sys&nbsp;&nbsp;&nbsp;&nbspMlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2421647">//sys&nbsp;&nbsp;&nbsp;&nbspMunlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2421683">//sys&nbsp;&nbsp;&nbsp;&nbspMlockall(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">905</span><span class="comment" id="2421721">//sys&nbsp;&nbsp;&nbsp;&nbspMunlockall()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2421753">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Unimplemented<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno">910</span><span class="comment" id="2421777">//&nbsp;AddKey</span><br>
<span class="lineno"></span><span class="comment" id="2421787">//&nbsp;AfsSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2421801">//&nbsp;Alarm</span><br>
<span class="lineno"></span><span class="comment" id="2421810">//&nbsp;ArchPrctl</span><br>
<span class="lineno"></span><span class="comment" id="2421823">//&nbsp;Brk</span><br>
<span class="lineno">915</span><span class="comment" id="2421830">//&nbsp;Capget</span><br>
<span class="lineno"></span><span class="comment" id="2421840">//&nbsp;Capset</span><br>
<span class="lineno"></span><span class="comment" id="2421850">//&nbsp;ClockGetres</span><br>
<span class="lineno"></span><span class="comment" id="2421865">//&nbsp;ClockGettime</span><br>
<span class="lineno"></span><span class="comment" id="2421881">//&nbsp;ClockNanosleep</span><br>
<span class="lineno">920</span><span class="comment" id="2421899">//&nbsp;ClockSettime</span><br>
<span class="lineno"></span><span class="comment" id="2421915">//&nbsp;Clone</span><br>
<span class="lineno"></span><span class="comment" id="2421924">//&nbsp;CreateModule</span><br>
<span class="lineno"></span><span class="comment" id="2421940">//&nbsp;DeleteModule</span><br>
<span class="lineno"></span><span class="comment" id="2421956">//&nbsp;EpollCtlOld</span><br>
<span class="lineno">925</span><span class="comment" id="2421971">//&nbsp;EpollPwait</span><br>
<span class="lineno"></span><span class="comment" id="2421985">//&nbsp;EpollWaitOld</span><br>
<span class="lineno"></span><span class="comment" id="2422001">//&nbsp;Eventfd</span><br>
<span class="lineno"></span><span class="comment" id="2422012">//&nbsp;Execve</span><br>
<span class="lineno"></span><span class="comment" id="2422022">//&nbsp;Fadvise64</span><br>
<span class="lineno">930</span><span class="comment" id="2422035">//&nbsp;Fgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2422048">//&nbsp;Flistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2422062">//&nbsp;Fork</span><br>
<span class="lineno"></span><span class="comment" id="2422070">//&nbsp;Fremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2422086">//&nbsp;Fsetxattr</span><br>
<span class="lineno">935</span><span class="comment" id="2422099">//&nbsp;Futex</span><br>
<span class="lineno"></span><span class="comment" id="2422108">//&nbsp;GetKernelSyms</span><br>
<span class="lineno"></span><span class="comment" id="2422125">//&nbsp;GetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2422141">//&nbsp;GetRobustList</span><br>
<span class="lineno"></span><span class="comment" id="2422158">//&nbsp;GetThreadArea</span><br>
<span class="lineno">940</span><span class="comment" id="2422175">//&nbsp;Getitimer</span><br>
<span class="lineno"></span><span class="comment" id="2422188">//&nbsp;Getpmsg</span><br>
<span class="lineno"></span><span class="comment" id="2422199">//&nbsp;IoCancel</span><br>
<span class="lineno"></span><span class="comment" id="2422211">//&nbsp;IoDestroy</span><br>
<span class="lineno"></span><span class="comment" id="2422224">//&nbsp;IoGetevents</span><br>
<span class="lineno">945</span><span class="comment" id="2422239">//&nbsp;IoSetup</span><br>
<span class="lineno"></span><span class="comment" id="2422250">//&nbsp;IoSubmit</span><br>
<span class="lineno"></span><span class="comment" id="2422262">//&nbsp;Ioctl</span><br>
<span class="lineno"></span><span class="comment" id="2422271">//&nbsp;IoprioGet</span><br>
<span class="lineno"></span><span class="comment" id="2422284">//&nbsp;IoprioSet</span><br>
<span class="lineno">950</span><span class="comment" id="2422297">//&nbsp;KexecLoad</span><br>
<span class="lineno"></span><span class="comment" id="2422310">//&nbsp;Keyctl</span><br>
<span class="lineno"></span><span class="comment" id="2422320">//&nbsp;Lgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2422333">//&nbsp;Llistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2422347">//&nbsp;LookupDcookie</span><br>
<span class="lineno">955</span><span class="comment" id="2422364">//&nbsp;Lremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2422380">//&nbsp;Lsetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2422393">//&nbsp;Mbind</span><br>
<span class="lineno"></span><span class="comment" id="2422402">//&nbsp;MigratePages</span><br>
<span class="lineno"></span><span class="comment" id="2422418">//&nbsp;Mincore</span><br>
<span class="lineno">960</span><span class="comment" id="2422429">//&nbsp;ModifyLdt</span><br>
<span class="lineno"></span><span class="comment" id="2422442">//&nbsp;Mount</span><br>
<span class="lineno"></span><span class="comment" id="2422451">//&nbsp;MovePages</span><br>
<span class="lineno"></span><span class="comment" id="2422464">//&nbsp;Mprotect</span><br>
<span class="lineno"></span><span class="comment" id="2422476">//&nbsp;MqGetsetattr</span><br>
<span class="lineno">965</span><span class="comment" id="2422492">//&nbsp;MqNotify</span><br>
<span class="lineno"></span><span class="comment" id="2422504">//&nbsp;MqOpen</span><br>
<span class="lineno"></span><span class="comment" id="2422514">//&nbsp;MqTimedreceive</span><br>
<span class="lineno"></span><span class="comment" id="2422532">//&nbsp;MqTimedsend</span><br>
<span class="lineno"></span><span class="comment" id="2422547">//&nbsp;MqUnlink</span><br>
<span class="lineno">970</span><span class="comment" id="2422559">//&nbsp;Mremap</span><br>
<span class="lineno"></span><span class="comment" id="2422569">//&nbsp;Msgctl</span><br>
<span class="lineno"></span><span class="comment" id="2422579">//&nbsp;Msgget</span><br>
<span class="lineno"></span><span class="comment" id="2422589">//&nbsp;Msgrcv</span><br>
<span class="lineno"></span><span class="comment" id="2422599">//&nbsp;Msgsnd</span><br>
<span class="lineno">975</span><span class="comment" id="2422609">//&nbsp;Msync</span><br>
<span class="lineno"></span><span class="comment" id="2422618">//&nbsp;Newfstatat</span><br>
<span class="lineno"></span><span class="comment" id="2422632">//&nbsp;Nfsservctl</span><br>
<span class="lineno"></span><span class="comment" id="2422646">//&nbsp;Personality</span><br>
<span class="lineno"></span><span class="comment" id="2422661">//&nbsp;Poll</span><br>
<span class="lineno">980</span><span class="comment" id="2422669">//&nbsp;Ppoll</span><br>
<span class="lineno"></span><span class="comment" id="2422678">//&nbsp;Prctl</span><br>
<span class="lineno"></span><span class="comment" id="2422687">//&nbsp;Pselect6</span><br>
<span class="lineno"></span><span class="comment" id="2422699">//&nbsp;Ptrace</span><br>
<span class="lineno"></span><span class="comment" id="2422709">//&nbsp;Putpmsg</span><br>
<span class="lineno">985</span><span class="comment" id="2422720">//&nbsp;QueryModule</span><br>
<span class="lineno"></span><span class="comment" id="2422735">//&nbsp;Quotactl</span><br>
<span class="lineno"></span><span class="comment" id="2422747">//&nbsp;Readahead</span><br>
<span class="lineno"></span><span class="comment" id="2422760">//&nbsp;Readv</span><br>
<span class="lineno"></span><span class="comment" id="2422769">//&nbsp;RemapFilePages</span><br>
<span class="lineno">990</span><span class="comment" id="2422787">//&nbsp;RequestKey</span><br>
<span class="lineno"></span><span class="comment" id="2422801">//&nbsp;RestartSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2422819">//&nbsp;RtSigaction</span><br>
<span class="lineno"></span><span class="comment" id="2422834">//&nbsp;RtSigpending</span><br>
<span class="lineno"></span><span class="comment" id="2422850">//&nbsp;RtSigprocmask</span><br>
<span class="lineno">995</span><span class="comment" id="2422867">//&nbsp;RtSigqueueinfo</span><br>
<span class="lineno"></span><span class="comment" id="2422885">//&nbsp;RtSigreturn</span><br>
<span class="lineno"></span><span class="comment" id="2422900">//&nbsp;RtSigsuspend</span><br>
<span class="lineno"></span><span class="comment" id="2422916">//&nbsp;RtSigtimedwait</span><br>
<span class="lineno"></span><span class="comment" id="2422934">//&nbsp;SchedGetPriorityMax</span><br>
<span class="lineno">1000</span><span class="comment" id="2422957">//&nbsp;SchedGetPriorityMin</span><br>
<span class="lineno"></span><span class="comment" id="2422980">//&nbsp;SchedGetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2423000">//&nbsp;SchedGetparam</span><br>
<span class="lineno"></span><span class="comment" id="2423017">//&nbsp;SchedGetscheduler</span><br>
<span class="lineno"></span><span class="comment" id="2423038">//&nbsp;SchedRrGetInterval</span><br>
<span class="lineno">1005</span><span class="comment" id="2423060">//&nbsp;SchedSetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2423080">//&nbsp;SchedSetparam</span><br>
<span class="lineno"></span><span class="comment" id="2423097">//&nbsp;SchedYield</span><br>
<span class="lineno"></span><span class="comment" id="2423111">//&nbsp;Security</span><br>
<span class="lineno"></span><span class="comment" id="2423123">//&nbsp;Semctl</span><br>
<span class="lineno">1010</span><span class="comment" id="2423133">//&nbsp;Semget</span><br>
<span class="lineno"></span><span class="comment" id="2423143">//&nbsp;Semop</span><br>
<span class="lineno"></span><span class="comment" id="2423152">//&nbsp;Semtimedop</span><br>
<span class="lineno"></span><span class="comment" id="2423166">//&nbsp;SetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2423182">//&nbsp;SetRobustList</span><br>
<span class="lineno">1015</span><span class="comment" id="2423199">//&nbsp;SetThreadArea</span><br>
<span class="lineno"></span><span class="comment" id="2423216">//&nbsp;SetTidAddress</span><br>
<span class="lineno"></span><span class="comment" id="2423233">//&nbsp;Shmat</span><br>
<span class="lineno"></span><span class="comment" id="2423242">//&nbsp;Shmctl</span><br>
<span class="lineno"></span><span class="comment" id="2423252">//&nbsp;Shmdt</span><br>
<span class="lineno">1020</span><span class="comment" id="2423261">//&nbsp;Shmget</span><br>
<span class="lineno"></span><span class="comment" id="2423271">//&nbsp;Sigaltstack</span><br>
<span class="lineno"></span><span class="comment" id="2423286">//&nbsp;Signalfd</span><br>
<span class="lineno"></span><span class="comment" id="2423298">//&nbsp;Swapoff</span><br>
<span class="lineno"></span><span class="comment" id="2423309">//&nbsp;Swapon</span><br>
<span class="lineno">1025</span><span class="comment" id="2423319">//&nbsp;Sysfs</span><br>
<span class="lineno"></span><span class="comment" id="2423328">//&nbsp;TimerCreate</span><br>
<span class="lineno"></span><span class="comment" id="2423343">//&nbsp;TimerDelete</span><br>
<span class="lineno"></span><span class="comment" id="2423358">//&nbsp;TimerGetoverrun</span><br>
<span class="lineno"></span><span class="comment" id="2423377">//&nbsp;TimerGettime</span><br>
<span class="lineno">1030</span><span class="comment" id="2423393">//&nbsp;TimerSettime</span><br>
<span class="lineno"></span><span class="comment" id="2423409">//&nbsp;Timerfd</span><br>
<span class="lineno"></span><span class="comment" id="2423420">//&nbsp;Tkill&nbsp;(obsolete)</span><br>
<span class="lineno"></span><span class="comment" id="2423440">//&nbsp;Tuxcall</span><br>
<span class="lineno"></span><span class="comment" id="2423451">//&nbsp;Umount2</span><br>
<span class="lineno">1035</span><span class="comment" id="2423462">//&nbsp;Uselib</span><br>
<span class="lineno"></span><span class="comment" id="2423472">//&nbsp;Utimensat</span><br>
<span class="lineno"></span><span class="comment" id="2423485">//&nbsp;Vfork</span><br>
<span class="lineno"></span><span class="comment" id="2423494">//&nbsp;Vhangup</span><br>
<span class="lineno"></span><span class="comment" id="2423505">//&nbsp;Vmsplice</span><br>
<span class="lineno">1040</span><span class="comment" id="2423517">//&nbsp;Vserver</span><br>
<span class="lineno"></span><span class="comment" id="2423528">//&nbsp;Waitid</span><br>
<span class="lineno"></span><span class="comment" id="2423538">//&nbsp;_Sysctl</span>
</div>
</body>
</html>
