<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/token</h2>
<ul>
<li><a href="/gostd/go/token/position.go.html">position.go</a></li>
<li><a href="/gostd/go/token/position_test.go.html">position_test.go</a></li>
<li><a href="/gostd/go/token/serialize.go.html" class="current">serialize.go</a></li>
<li><a href="/gostd/go/token/serialize_test.go.html">serialize_test.go</a></li>
<li><a href="/gostd/go/token/token.go.html">token.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3283556">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3283611">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3283665">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3283716">package</span>&nbsp;<span class="ident" id="3283724">token</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3283731">type</span>&nbsp;<span class="ident" id="3283736">serializedFile</span>&nbsp;<span class="keyword" id="3283751">struct</span>&nbsp;<span class="op" id="3283758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3283761">//&nbsp;fields&nbsp;correspond&nbsp;1:1&nbsp;to&nbsp;fields&nbsp;with&nbsp;same&nbsp;(lower-case)&nbsp;name&nbsp;in&nbsp;File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3283833">Name</span>&nbsp;&nbsp;<span class="builtintype" id="3283839">string</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3283847">Base</span>&nbsp;&nbsp;<span class="builtintype" id="3283853">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3283858">Size</span>&nbsp;&nbsp;<span class="builtintype" id="3283864">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3283869">Lines</span>&nbsp;<span class="op" id="3283875">[</span><span class="op" id="3283876">]</span><span class="builtintype" id="3283877">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3283882">Infos</span>&nbsp;<span class="op" id="3283888">[</span><span class="op" id="3283889">]</span><span class="ident" id="3283890">lineInfo</span><br>
<span class="lineno"></span><span class="op" id="3283899">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3283902">type</span>&nbsp;<span class="ident" id="3283907">serializedFileSet</span>&nbsp;<span class="keyword" id="3283925">struct</span>&nbsp;<span class="op" id="3283932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3283935">Base</span>&nbsp;&nbsp;<span class="builtintype" id="3283941">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3283946">Files</span>&nbsp;<span class="op" id="3283952">[</span><span class="op" id="3283953">]</span><span class="ident" id="3283954">serializedFile</span><br>
<span class="lineno"></span><span class="op" id="3283969">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3283972">//&nbsp;Read&nbsp;calls&nbsp;decode&nbsp;to&nbsp;deserialize&nbsp;a&nbsp;file&nbsp;set&nbsp;into&nbsp;s;&nbsp;s&nbsp;must&nbsp;not&nbsp;be&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3284046">func</span>&nbsp;<span class="op" id="3284051">(</span><span class="ident" id="3284052">s</span>&nbsp;<span class="op" id="3284054">*</span><span class="ident" id="3284055">FileSet</span><span class="op" id="3284062">)</span>&nbsp;<span class="ident" id="3284064">Read</span><span class="op" id="3284068">(</span><span class="ident" id="3284069">decode</span>&nbsp;<span class="keyword" id="3284076">func</span><span class="op" id="3284080">(</span><span class="keyword" id="3284081">interface</span><span class="op" id="3284090">{</span><span class="op" id="3284091">}</span><span class="op" id="3284092">)</span>&nbsp;<span class="builtintype" id="3284094">error</span><span class="op" id="3284099">)</span>&nbsp;<span class="builtintype" id="3284101">error</span>&nbsp;<span class="op" id="3284107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284110">var</span>&nbsp;<span class="ident" id="3284114">ss</span>&nbsp;<span class="ident" id="3284117">serializedFileSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284136">if</span>&nbsp;<span class="ident" id="3284139">err</span>&nbsp;<span class="op" id="3284143">:=</span>&nbsp;<span class="ident" id="3284146">decode</span><span class="op" id="3284152">(</span><span class="op" id="3284153">&amp;</span><span class="ident" id="3284154">ss</span><span class="op" id="3284156">)</span><span class="op" id="3284157">;</span>&nbsp;<span class="ident" id="3284159">err</span>&nbsp;<span class="op" id="3284163">!=</span>&nbsp;<span class="builtintype" id="3284166">nil</span>&nbsp;<span class="op" id="3284170">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284174">return</span>&nbsp;<span class="ident" id="3284181">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3284186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284190">s</span><span class="op" id="3284191">.</span><span class="ident" id="3284192">mutex</span><span class="op" id="3284197">.</span><span class="ident" id="3284198">Lock</span><span class="op" id="3284202">(</span><span class="op" id="3284203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284206">s</span><span class="op" id="3284207">.</span><span class="ident" id="3284208">base</span>&nbsp;<span class="op" id="3284213">=</span>&nbsp;<span class="ident" id="3284215">ss</span><span class="op" id="3284217">.</span><span class="ident" id="3284218">Base</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284224">files</span>&nbsp;<span class="op" id="3284230">:=</span>&nbsp;<span class="builtinfunc" id="3284233">make</span><span class="op" id="3284237">(</span><span class="op" id="3284238">[</span><span class="op" id="3284239">]</span><span class="op" id="3284240">*</span><span class="ident" id="3284241">File</span><span class="op" id="3284245">,</span>&nbsp;<span class="builtinfunc" id="3284247">len</span><span class="op" id="3284250">(</span><span class="ident" id="3284251">ss</span><span class="op" id="3284253">.</span><span class="ident" id="3284254">Files</span><span class="op" id="3284259">)</span><span class="op" id="3284260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284263">for</span>&nbsp;<span class="ident" id="3284267">i</span>&nbsp;<span class="op" id="3284269">:=</span>&nbsp;<span class="num" id="3284272">0</span><span class="op" id="3284273">;</span>&nbsp;<span class="ident" id="3284275">i</span>&nbsp;<span class="op" id="3284277">&lt;</span>&nbsp;<span class="builtinfunc" id="3284279">len</span><span class="op" id="3284282">(</span><span class="ident" id="3284283">ss</span><span class="op" id="3284285">.</span><span class="ident" id="3284286">Files</span><span class="op" id="3284291">)</span><span class="op" id="3284292">;</span>&nbsp;<span class="ident" id="3284294">i</span><span class="op" id="3284295">++</span>&nbsp;<span class="op" id="3284298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284302">f</span>&nbsp;<span class="op" id="3284304">:=</span>&nbsp;<span class="op" id="3284307">&amp;</span><span class="ident" id="3284308">ss</span><span class="op" id="3284310">.</span><span class="ident" id="3284311">Files</span><span class="op" id="3284316">[</span><span class="ident" id="3284317">i</span><span class="op" id="3284318">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284322">files</span><span class="op" id="3284327">[</span><span class="ident" id="3284328">i</span><span class="op" id="3284329">]</span>&nbsp;<span class="op" id="3284331">=</span>&nbsp;<span class="op" id="3284333">&amp;</span><span class="ident" id="3284334">File</span><span class="op" id="3284338">{</span><span class="ident" id="3284339">s</span><span class="op" id="3284340">,</span>&nbsp;<span class="ident" id="3284342">f</span><span class="op" id="3284343">.</span><span class="ident" id="3284344">Name</span><span class="op" id="3284348">,</span>&nbsp;<span class="ident" id="3284350">f</span><span class="op" id="3284351">.</span><span class="ident" id="3284352">Base</span><span class="op" id="3284356">,</span>&nbsp;<span class="ident" id="3284358">f</span><span class="op" id="3284359">.</span><span class="ident" id="3284360">Size</span><span class="op" id="3284364">,</span>&nbsp;<span class="ident" id="3284366">f</span><span class="op" id="3284367">.</span><span class="ident" id="3284368">Lines</span><span class="op" id="3284373">,</span>&nbsp;<span class="ident" id="3284375">f</span><span class="op" id="3284376">.</span><span class="ident" id="3284377">Infos</span><span class="op" id="3284382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3284385">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284388">s</span><span class="op" id="3284389">.</span><span class="ident" id="3284390">files</span>&nbsp;<span class="op" id="3284396">=</span>&nbsp;<span class="ident" id="3284398">files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284405">s</span><span class="op" id="3284406">.</span><span class="ident" id="3284407">last</span>&nbsp;<span class="op" id="3284412">=</span>&nbsp;<span class="builtintype" id="3284414">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284419">s</span><span class="op" id="3284420">.</span><span class="ident" id="3284421">mutex</span><span class="op" id="3284426">.</span><span class="ident" id="3284427">Unlock</span><span class="op" id="3284433">(</span><span class="op" id="3284434">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284438">return</span>&nbsp;<span class="builtintype" id="3284445">nil</span><br>
<span class="lineno">40</span><span class="op" id="3284449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3284452">//&nbsp;Write&nbsp;calls&nbsp;encode&nbsp;to&nbsp;serialize&nbsp;the&nbsp;file&nbsp;set&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3284503">func</span>&nbsp;<span class="op" id="3284508">(</span><span class="ident" id="3284509">s</span>&nbsp;<span class="op" id="3284511">*</span><span class="ident" id="3284512">FileSet</span><span class="op" id="3284519">)</span>&nbsp;<span class="ident" id="3284521">Write</span><span class="op" id="3284526">(</span><span class="ident" id="3284527">encode</span>&nbsp;<span class="keyword" id="3284534">func</span><span class="op" id="3284538">(</span><span class="keyword" id="3284539">interface</span><span class="op" id="3284548">{</span><span class="op" id="3284549">}</span><span class="op" id="3284550">)</span>&nbsp;<span class="builtintype" id="3284552">error</span><span class="op" id="3284557">)</span>&nbsp;<span class="builtintype" id="3284559">error</span>&nbsp;<span class="op" id="3284565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284568">var</span>&nbsp;<span class="ident" id="3284572">ss</span>&nbsp;<span class="ident" id="3284575">serializedFileSet</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284595">s</span><span class="op" id="3284596">.</span><span class="ident" id="3284597">mutex</span><span class="op" id="3284602">.</span><span class="ident" id="3284603">Lock</span><span class="op" id="3284607">(</span><span class="op" id="3284608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284611">ss</span><span class="op" id="3284613">.</span><span class="ident" id="3284614">Base</span>&nbsp;<span class="op" id="3284619">=</span>&nbsp;<span class="ident" id="3284621">s</span><span class="op" id="3284622">.</span><span class="ident" id="3284623">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284629">files</span>&nbsp;<span class="op" id="3284635">:=</span>&nbsp;<span class="builtinfunc" id="3284638">make</span><span class="op" id="3284642">(</span><span class="op" id="3284643">[</span><span class="op" id="3284644">]</span><span class="ident" id="3284645">serializedFile</span><span class="op" id="3284659">,</span>&nbsp;<span class="builtinfunc" id="3284661">len</span><span class="op" id="3284664">(</span><span class="ident" id="3284665">s</span><span class="op" id="3284666">.</span><span class="ident" id="3284667">files</span><span class="op" id="3284672">)</span><span class="op" id="3284673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284676">for</span>&nbsp;<span class="ident" id="3284680">i</span><span class="op" id="3284681">,</span>&nbsp;<span class="ident" id="3284683">f</span>&nbsp;<span class="op" id="3284685">:=</span>&nbsp;<span class="keyword" id="3284688">range</span>&nbsp;<span class="ident" id="3284694">s</span><span class="op" id="3284695">.</span><span class="ident" id="3284696">files</span>&nbsp;<span class="op" id="3284702">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284706">files</span><span class="op" id="3284711">[</span><span class="ident" id="3284712">i</span><span class="op" id="3284713">]</span>&nbsp;<span class="op" id="3284715">=</span>&nbsp;<span class="ident" id="3284717">serializedFile</span><span class="op" id="3284731">{</span><span class="ident" id="3284732">f</span><span class="op" id="3284733">.</span><span class="ident" id="3284734">name</span><span class="op" id="3284738">,</span>&nbsp;<span class="ident" id="3284740">f</span><span class="op" id="3284741">.</span><span class="ident" id="3284742">base</span><span class="op" id="3284746">,</span>&nbsp;<span class="ident" id="3284748">f</span><span class="op" id="3284749">.</span><span class="ident" id="3284750">size</span><span class="op" id="3284754">,</span>&nbsp;<span class="ident" id="3284756">f</span><span class="op" id="3284757">.</span><span class="ident" id="3284758">lines</span><span class="op" id="3284763">,</span>&nbsp;<span class="ident" id="3284765">f</span><span class="op" id="3284766">.</span><span class="ident" id="3284767">infos</span><span class="op" id="3284772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3284775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284778">ss</span><span class="op" id="3284780">.</span><span class="ident" id="3284781">Files</span>&nbsp;<span class="op" id="3284787">=</span>&nbsp;<span class="ident" id="3284789">files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3284796">s</span><span class="op" id="3284797">.</span><span class="ident" id="3284798">mutex</span><span class="op" id="3284803">.</span><span class="ident" id="3284804">Unlock</span><span class="op" id="3284810">(</span><span class="op" id="3284811">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3284815">return</span>&nbsp;<span class="ident" id="3284822">encode</span><span class="op" id="3284828">(</span><span class="ident" id="3284829">ss</span><span class="op" id="3284831">)</span><br>
<span class="lineno"></span><span class="op" id="3284833">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
