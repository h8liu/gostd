<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/parser</h2>
<ul>
<li><a href="/gostd/go/parser/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/go/parser/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/parser/interface.go.html">interface.go</a></li>
<li><a href="/gostd/go/parser/parser.go.html">parser.go</a></li>
<li><a href="/gostd/go/parser/parser_test.go.html" class="current">parser_test.go</a></li>
<li><a href="/gostd/go/parser/performance_test.go.html">performance_test.go</a></li>
<li><a href="/gostd/go/parser/short_test.go.html">short_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7122401">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7122456">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7122510">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7122561">package</span>&nbsp;<span class="ident" id="7122569">parser</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7122577">import</span>&nbsp;<span class="op" id="7122584">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7122587">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7122596">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7122603">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7122613">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7122625">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7122631">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7122642">&#34;testing&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7122652">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7122655">var</span>&nbsp;<span class="ident" id="7122659">fset</span>&nbsp;<span class="op" id="7122664">=</span>&nbsp;<span class="ident" id="7122666">token</span><span class="op" id="7122671">.</span><span class="ident" id="7122672">NewFileSet</span><span class="op" id="7122682">(</span><span class="op" id="7122683">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7122686">var</span>&nbsp;<span class="ident" id="7122690">validFiles</span>&nbsp;<span class="op" id="7122701">=</span>&nbsp;<span class="op" id="7122703">[</span><span class="op" id="7122704">]</span><span class="builtintype" id="7122705">string</span><span class="op" id="7122711">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7122714">&#34;parser.go&#34;</span><span class="op" id="7122725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7122728">&#34;parser_test.go&#34;</span><span class="op" id="7122744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7122747">&#34;error_test.go&#34;</span><span class="op" id="7122762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7122765">&#34;short_test.go&#34;</span><span class="op" id="7122780">,</span><br>
<span class="lineno"></span><span class="op" id="7122782">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="7122785">func</span>&nbsp;<span class="ident" id="7122790">TestParse</span><span class="op" id="7122799">(</span><span class="ident" id="7122800">t</span>&nbsp;<span class="op" id="7122802">*</span><span class="ident" id="7122803">testing</span><span class="op" id="7122810">.</span><span class="ident" id="7122811">T</span><span class="op" id="7122812">)</span>&nbsp;<span class="op" id="7122814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7122817">for</span>&nbsp;<span class="ident" id="7122821">_</span><span class="op" id="7122822">,</span>&nbsp;<span class="ident" id="7122824">filename</span>&nbsp;<span class="op" id="7122833">:=</span>&nbsp;<span class="keyword" id="7122836">range</span>&nbsp;<span class="ident" id="7122842">validFiles</span>&nbsp;<span class="op" id="7122853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7122857">_</span><span class="op" id="7122858">,</span>&nbsp;<span class="ident" id="7122860">err</span>&nbsp;<span class="op" id="7122864">:=</span>&nbsp;<span class="ident" id="7122867">ParseFile</span><span class="op" id="7122876">(</span><span class="ident" id="7122877">fset</span><span class="op" id="7122881">,</span>&nbsp;<span class="ident" id="7122883">filename</span><span class="op" id="7122891">,</span>&nbsp;<span class="ident" id="7122893">nil</span><span class="op" id="7122896">,</span>&nbsp;<span class="ident" id="7122898">DeclarationErrors</span><span class="op" id="7122915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7122919">if</span>&nbsp;<span class="ident" id="7122922">err</span>&nbsp;<span class="op" id="7122926">!=</span>&nbsp;<span class="ident" id="7122929">nil</span>&nbsp;<span class="op" id="7122933">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7122938">t</span><span class="op" id="7122939">.</span><span class="ident" id="7122940">Fatalf</span><span class="op" id="7122946">(</span><span class="string" id="7122947">&#34;ParseFile(%s):&nbsp;%v&#34;</span><span class="op" id="7122966">,</span>&nbsp;<span class="ident" id="7122968">filename</span><span class="op" id="7122976">,</span>&nbsp;<span class="ident" id="7122978">err</span><span class="op" id="7122981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7122985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7122988">}</span><br>
<span class="lineno"></span><span class="op" id="7122990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7122993">func</span>&nbsp;<span class="ident" id="7122998">nameFilter</span><span class="op" id="7123008">(</span><span class="ident" id="7123009">filename</span>&nbsp;<span class="builtintype" id="7123018">string</span><span class="op" id="7123024">)</span>&nbsp;<span class="builtintype" id="7123026">bool</span>&nbsp;<span class="op" id="7123031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123034">switch</span>&nbsp;<span class="ident" id="7123041">filename</span>&nbsp;<span class="op" id="7123050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123053">case</span>&nbsp;<span class="string" id="7123058">&#34;parser.go&#34;</span><span class="op" id="7123069">,</span>&nbsp;<span class="string" id="7123071">&#34;interface.go&#34;</span><span class="op" id="7123085">,</span>&nbsp;<span class="string" id="7123087">&#34;parser_test.go&#34;</span><span class="op" id="7123103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123107">return</span>&nbsp;<span class="builtintype" id="7123114">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123120">case</span>&nbsp;<span class="string" id="7123125">&#34;parser.go.orig&#34;</span><span class="op" id="7123141">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123145">return</span>&nbsp;<span class="builtintype" id="7123152">true</span>&nbsp;<span class="comment" id="7123157">//&nbsp;permit&nbsp;but&nbsp;should&nbsp;be&nbsp;ignored&nbsp;by&nbsp;ParseDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7123202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123205">return</span>&nbsp;<span class="builtintype" id="7123212">false</span><br>
<span class="lineno"></span><span class="op" id="7123218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="7123221">func</span>&nbsp;<span class="ident" id="7123226">dirFilter</span><span class="op" id="7123235">(</span><span class="ident" id="7123236">f</span>&nbsp;<span class="ident" id="7123238">os</span><span class="op" id="7123240">.</span><span class="ident" id="7123241">FileInfo</span><span class="op" id="7123249">)</span>&nbsp;<span class="builtintype" id="7123251">bool</span>&nbsp;<span class="op" id="7123256">{</span>&nbsp;<span class="keyword" id="7123258">return</span>&nbsp;<span class="ident" id="7123265">nameFilter</span><span class="op" id="7123275">(</span><span class="ident" id="7123276">f</span><span class="op" id="7123277">.</span><span class="ident" id="7123278">Name</span><span class="op" id="7123282">(</span><span class="op" id="7123283">)</span><span class="op" id="7123284">)</span>&nbsp;<span class="op" id="7123286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7123289">func</span>&nbsp;<span class="ident" id="7123294">TestParseDir</span><span class="op" id="7123306">(</span><span class="ident" id="7123307">t</span>&nbsp;<span class="op" id="7123309">*</span><span class="ident" id="7123310">testing</span><span class="op" id="7123317">.</span><span class="ident" id="7123318">T</span><span class="op" id="7123319">)</span>&nbsp;<span class="op" id="7123321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123324">path</span>&nbsp;<span class="op" id="7123329">:=</span>&nbsp;<span class="string" id="7123332">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123337">pkgs</span><span class="op" id="7123341">,</span>&nbsp;<span class="ident" id="7123343">err</span>&nbsp;<span class="op" id="7123347">:=</span>&nbsp;<span class="ident" id="7123350">ParseDir</span><span class="op" id="7123358">(</span><span class="ident" id="7123359">fset</span><span class="op" id="7123363">,</span>&nbsp;<span class="ident" id="7123365">path</span><span class="op" id="7123369">,</span>&nbsp;<span class="ident" id="7123371">dirFilter</span><span class="op" id="7123380">,</span>&nbsp;<span class="num" id="7123382">0</span><span class="op" id="7123383">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123386">if</span>&nbsp;<span class="ident" id="7123389">err</span>&nbsp;<span class="op" id="7123393">!=</span>&nbsp;<span class="ident" id="7123396">nil</span>&nbsp;<span class="op" id="7123400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123404">t</span><span class="op" id="7123405">.</span><span class="ident" id="7123406">Fatalf</span><span class="op" id="7123412">(</span><span class="string" id="7123413">&#34;ParseDir(%s):&nbsp;%v&#34;</span><span class="op" id="7123431">,</span>&nbsp;<span class="ident" id="7123433">path</span><span class="op" id="7123437">,</span>&nbsp;<span class="ident" id="7123439">err</span><span class="op" id="7123442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7123445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123448">if</span>&nbsp;<span class="ident" id="7123451">n</span>&nbsp;<span class="op" id="7123453">:=</span>&nbsp;<span class="builtinfunc" id="7123456">len</span><span class="op" id="7123459">(</span><span class="ident" id="7123460">pkgs</span><span class="op" id="7123464">)</span><span class="op" id="7123465">;</span>&nbsp;<span class="ident" id="7123467">n</span>&nbsp;<span class="op" id="7123469">!=</span>&nbsp;<span class="num" id="7123472">1</span>&nbsp;<span class="op" id="7123474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123478">t</span><span class="op" id="7123479">.</span><span class="ident" id="7123480">Errorf</span><span class="op" id="7123486">(</span><span class="string" id="7123487">&#34;got&nbsp;%d&nbsp;packages;&nbsp;want&nbsp;1&#34;</span><span class="op" id="7123512">,</span>&nbsp;<span class="ident" id="7123514">n</span><span class="op" id="7123515">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7123518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123521">pkg</span>&nbsp;<span class="op" id="7123525">:=</span>&nbsp;<span class="ident" id="7123528">pkgs</span><span class="op" id="7123532">[</span><span class="string" id="7123533">&#34;parser&#34;</span><span class="op" id="7123541">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123544">if</span>&nbsp;<span class="ident" id="7123547">pkg</span>&nbsp;<span class="op" id="7123551">==</span>&nbsp;<span class="ident" id="7123554">nil</span>&nbsp;<span class="op" id="7123558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123562">t</span><span class="op" id="7123563">.</span><span class="ident" id="7123564">Errorf</span><span class="op" id="7123570">(</span><span class="string" id="7123571">`package&nbsp;&#34;parser&#34;&nbsp;not&nbsp;found`</span><span class="op" id="7123599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123603">return</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7123611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123614">if</span>&nbsp;<span class="ident" id="7123617">n</span>&nbsp;<span class="op" id="7123619">:=</span>&nbsp;<span class="builtinfunc" id="7123622">len</span><span class="op" id="7123625">(</span><span class="ident" id="7123626">pkg</span><span class="op" id="7123629">.</span><span class="ident" id="7123630">Files</span><span class="op" id="7123635">)</span><span class="op" id="7123636">;</span>&nbsp;<span class="ident" id="7123638">n</span>&nbsp;<span class="op" id="7123640">!=</span>&nbsp;<span class="num" id="7123643">3</span>&nbsp;<span class="op" id="7123645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123649">t</span><span class="op" id="7123650">.</span><span class="ident" id="7123651">Errorf</span><span class="op" id="7123657">(</span><span class="string" id="7123658">&#34;got&nbsp;%d&nbsp;package&nbsp;files;&nbsp;want&nbsp;3&#34;</span><span class="op" id="7123688">,</span>&nbsp;<span class="ident" id="7123690">n</span><span class="op" id="7123691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7123694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123697">for</span>&nbsp;<span class="ident" id="7123701">filename</span>&nbsp;<span class="op" id="7123710">:=</span>&nbsp;<span class="keyword" id="7123713">range</span>&nbsp;<span class="ident" id="7123719">pkg</span><span class="op" id="7123722">.</span><span class="ident" id="7123723">Files</span>&nbsp;<span class="op" id="7123729">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123733">if</span>&nbsp;<span class="op" id="7123736">!</span><span class="ident" id="7123737">nameFilter</span><span class="op" id="7123747">(</span><span class="ident" id="7123748">filename</span><span class="op" id="7123756">)</span>&nbsp;<span class="op" id="7123758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123763">t</span><span class="op" id="7123764">.</span><span class="ident" id="7123765">Errorf</span><span class="op" id="7123771">(</span><span class="string" id="7123772">&#34;unexpected&nbsp;package&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="7123801">,</span>&nbsp;<span class="ident" id="7123803">filename</span><span class="op" id="7123811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7123815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7123818">}</span><br>
<span class="lineno"></span><span class="op" id="7123820">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7123823">func</span>&nbsp;<span class="ident" id="7123828">TestParseExpr</span><span class="op" id="7123841">(</span><span class="ident" id="7123842">t</span>&nbsp;<span class="op" id="7123844">*</span><span class="ident" id="7123845">testing</span><span class="op" id="7123852">.</span><span class="ident" id="7123853">T</span><span class="op" id="7123854">)</span>&nbsp;<span class="op" id="7123856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7123859">//&nbsp;just&nbsp;kicking&nbsp;the&nbsp;tires:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7123887">//&nbsp;a&nbsp;valid&nbsp;arithmetic&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123921">src</span>&nbsp;<span class="op" id="7123925">:=</span>&nbsp;<span class="string" id="7123928">&#34;a&nbsp;+&nbsp;b&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123937">x</span><span class="op" id="7123938">,</span>&nbsp;<span class="ident" id="7123940">err</span>&nbsp;<span class="op" id="7123944">:=</span>&nbsp;<span class="ident" id="7123947">ParseExpr</span><span class="op" id="7123956">(</span><span class="ident" id="7123957">src</span><span class="op" id="7123960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123963">if</span>&nbsp;<span class="ident" id="7123966">err</span>&nbsp;<span class="op" id="7123970">!=</span>&nbsp;<span class="ident" id="7123973">nil</span>&nbsp;<span class="op" id="7123977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123981">t</span><span class="op" id="7123982">.</span><span class="ident" id="7123983">Errorf</span><span class="op" id="7123989">(</span><span class="string" id="7123990">&#34;ParseExpr(%q):&nbsp;%v&#34;</span><span class="op" id="7124009">,</span>&nbsp;<span class="ident" id="7124011">src</span><span class="op" id="7124014">,</span>&nbsp;<span class="ident" id="7124016">err</span><span class="op" id="7124019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7124022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7124025">//&nbsp;sanity&nbsp;check</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7124042">if</span>&nbsp;<span class="ident" id="7124045">_</span><span class="op" id="7124046">,</span>&nbsp;<span class="ident" id="7124048">ok</span>&nbsp;<span class="op" id="7124051">:=</span>&nbsp;<span class="ident" id="7124054">x</span><span class="op" id="7124055">.</span><span class="op" id="7124056">(</span><span class="op" id="7124057">*</span><span class="ident" id="7124058">ast</span><span class="op" id="7124061">.</span><span class="ident" id="7124062">BinaryExpr</span><span class="op" id="7124072">)</span><span class="op" id="7124073">;</span>&nbsp;<span class="op" id="7124075">!</span><span class="ident" id="7124076">ok</span>&nbsp;<span class="op" id="7124079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7124083">t</span><span class="op" id="7124084">.</span><span class="ident" id="7124085">Errorf</span><span class="op" id="7124091">(</span><span class="string" id="7124092">&#34;ParseExpr(%q):&nbsp;got&nbsp;%T,&nbsp;want&nbsp;*ast.BinaryExpr&#34;</span><span class="op" id="7124137">,</span>&nbsp;<span class="ident" id="7124139">src</span><span class="op" id="7124142">,</span>&nbsp;<span class="ident" id="7124144">x</span><span class="op" id="7124145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7124148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7124152">//&nbsp;a&nbsp;valid&nbsp;type&nbsp;expression</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7124180">src</span>&nbsp;<span class="op" id="7124184">=</span>&nbsp;<span class="string" id="7124186">&#34;struct{x&nbsp;*int}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7124204">x</span><span class="op" id="7124205">,</span>&nbsp;<span class="ident" id="7124207">err</span>&nbsp;<span class="op" id="7124211">=</span>&nbsp;<span class="ident" id="7124213">ParseExpr</span><span class="op" id="7124222">(</span><span class="ident" id="7124223">src</span><span class="op" id="7124226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7124229">if</span>&nbsp;<span class="ident" id="7124232">err</span>&nbsp;<span class="op" id="7124236">!=</span>&nbsp;<span class="ident" id="7124239">nil</span>&nbsp;<span class="op" id="7124243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7124247">t</span><span class="op" id="7124248">.</span><span class="ident" id="7124249">Errorf</span><span class="op" id="7124255">(</span><span class="string" id="7124256">&#34;ParseExpr(%q):&nbsp;%v&#34;</span><span class="op" id="7124275">,</span>&nbsp;<span class="ident" id="7124277">src</span><span class="op" id="7124280">,</span>&nbsp;<span class="ident" id="7124282">err</span><span class="op" id="7124285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7124288">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7124291">//&nbsp;sanity&nbsp;check</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7124308">if</span>&nbsp;<span class="ident" id="7124311">_</span><span class="op" id="7124312">,</span>&nbsp;<span class="ident" id="7124314">ok</span>&nbsp;<span class="op" id="7124317">:=</span>&nbsp;<span class="ident" id="7124320">x</span><span class="op" id="7124321">.</span><span class="op" id="7124322">(</span><span class="op" id="7124323">*</span><span class="ident" id="7124324">ast</span><span class="op" id="7124327">.</span><span class="ident" id="7124328">StructType</span><span class="op" id="7124338">)</span><span class="op" id="7124339">;</span>&nbsp;<span class="op" id="7124341">!</span><span class="ident" id="7124342">ok</span>&nbsp;<span class="op" id="7124345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7124349">t</span><span class="op" id="7124350">.</span><span class="ident" id="7124351">Errorf</span><span class="op" id="7124357">(</span><span class="string" id="7124358">&#34;ParseExpr(%q):&nbsp;got&nbsp;%T,&nbsp;want&nbsp;*ast.StructType&#34;</span><span class="op" id="7124403">,</span>&nbsp;<span class="ident" id="7124405">src</span><span class="op" id="7124408">,</span>&nbsp;<span class="ident" id="7124410">x</span><span class="op" id="7124411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7124414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7124418">//&nbsp;an&nbsp;invalid&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7124444">src</span>&nbsp;<span class="op" id="7124448">=</span>&nbsp;<span class="string" id="7124450">&#34;a&nbsp;+&nbsp;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7124459">if</span>&nbsp;<span class="ident" id="7124462">_</span><span class="op" id="7124463">,</span>&nbsp;<span class="ident" id="7124465">err</span>&nbsp;<span class="op" id="7124469">:=</span>&nbsp;<span class="ident" id="7124472">ParseExpr</span><span class="op" id="7124481">(</span><span class="ident" id="7124482">src</span><span class="op" id="7124485">)</span><span class="op" id="7124486">;</span>&nbsp;<span class="ident" id="7124488">err</span>&nbsp;<span class="op" id="7124492">==</span>&nbsp;<span class="ident" id="7124495">nil</span>&nbsp;<span class="op" id="7124499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7124503">t</span><span class="op" id="7124504">.</span><span class="ident" id="7124505">Errorf</span><span class="op" id="7124511">(</span><span class="string" id="7124512">&#34;ParseExpr(%q):&nbsp;got&nbsp;no&nbsp;error&#34;</span><span class="op" id="7124541">,</span>&nbsp;<span class="ident" id="7124543">src</span><span class="op" id="7124546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7124549">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7124553">//&nbsp;a&nbsp;valid&nbsp;expression&nbsp;followed&nbsp;by&nbsp;extra&nbsp;tokens&nbsp;is&nbsp;invalid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7124612">src</span>&nbsp;<span class="op" id="7124616">=</span>&nbsp;<span class="string" id="7124618">&#34;a[i]&nbsp;:=&nbsp;x&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7124631">if</span>&nbsp;<span class="ident" id="7124634">_</span><span class="op" id="7124635">,</span>&nbsp;<span class="ident" id="7124637">err</span>&nbsp;<span class="op" id="7124641">:=</span>&nbsp;<span class="ident" id="7124644">ParseExpr</span><span class="op" id="7124653">(</span><span class="ident" id="7124654">src</span><span class="op" id="7124657">)</span><span class="op" id="7124658">;</span>&nbsp;<span class="ident" id="7124660">err</span>&nbsp;<span class="op" id="7124664">==</span>&nbsp;<span class="ident" id="7124667">nil</span>&nbsp;<span class="op" id="7124671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7124675">t</span><span class="op" id="7124676">.</span><span class="ident" id="7124677">Errorf</span><span class="op" id="7124683">(</span><span class="string" id="7124684">&#34;ParseExpr(%q):&nbsp;got&nbsp;no&nbsp;error&#34;</span><span class="op" id="7124713">,</span>&nbsp;<span class="ident" id="7124715">src</span><span class="op" id="7124718">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7124721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7124725">//&nbsp;a&nbsp;semicolon&nbsp;is&nbsp;not&nbsp;permitted&nbsp;unless&nbsp;automatically&nbsp;inserted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7124788">src</span>&nbsp;<span class="op" id="7124792">=</span>&nbsp;<span class="string" id="7124794">&#34;a&nbsp;+&nbsp;b\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7124805">if</span>&nbsp;<span class="ident" id="7124808">_</span><span class="op" id="7124809">,</span>&nbsp;<span class="ident" id="7124811">err</span>&nbsp;<span class="op" id="7124815">:=</span>&nbsp;<span class="ident" id="7124818">ParseExpr</span><span class="op" id="7124827">(</span><span class="ident" id="7124828">src</span><span class="op" id="7124831">)</span><span class="op" id="7124832">;</span>&nbsp;<span class="ident" id="7124834">err</span>&nbsp;<span class="op" id="7124838">!=</span>&nbsp;<span class="ident" id="7124841">nil</span>&nbsp;<span class="op" id="7124845">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7124849">t</span><span class="op" id="7124850">.</span><span class="ident" id="7124851">Errorf</span><span class="op" id="7124857">(</span><span class="string" id="7124858">&#34;ParseExpr(%q):&nbsp;got&nbsp;error&nbsp;%s&#34;</span><span class="op" id="7124887">,</span>&nbsp;<span class="ident" id="7124889">src</span><span class="op" id="7124892">,</span>&nbsp;<span class="ident" id="7124894">err</span><span class="op" id="7124897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7124900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7124903">src</span>&nbsp;<span class="op" id="7124907">=</span>&nbsp;<span class="string" id="7124909">&#34;a&nbsp;+&nbsp;b;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7124919">if</span>&nbsp;<span class="ident" id="7124922">_</span><span class="op" id="7124923">,</span>&nbsp;<span class="ident" id="7124925">err</span>&nbsp;<span class="op" id="7124929">:=</span>&nbsp;<span class="ident" id="7124932">ParseExpr</span><span class="op" id="7124941">(</span><span class="ident" id="7124942">src</span><span class="op" id="7124945">)</span><span class="op" id="7124946">;</span>&nbsp;<span class="ident" id="7124948">err</span>&nbsp;<span class="op" id="7124952">==</span>&nbsp;<span class="ident" id="7124955">nil</span>&nbsp;<span class="op" id="7124959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7124963">t</span><span class="op" id="7124964">.</span><span class="ident" id="7124965">Errorf</span><span class="op" id="7124971">(</span><span class="string" id="7124972">&#34;ParseExpr(%q):&nbsp;got&nbsp;no&nbsp;error&#34;</span><span class="op" id="7125001">,</span>&nbsp;<span class="ident" id="7125003">src</span><span class="op" id="7125006">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7125009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7125013">//&nbsp;various&nbsp;other&nbsp;stuff&nbsp;following&nbsp;a&nbsp;valid&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7125066">const</span>&nbsp;<span class="ident" id="7125072">validExpr</span>&nbsp;<span class="op" id="7125082">=</span>&nbsp;<span class="string" id="7125084">&#34;a&nbsp;+&nbsp;b&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7125093">const</span>&nbsp;<span class="ident" id="7125099">anything</span>&nbsp;<span class="op" id="7125108">=</span>&nbsp;<span class="string" id="7125110">&#34;dh3*#D)#_&#34;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7125123">for</span>&nbsp;<span class="ident" id="7125127">_</span><span class="op" id="7125128">,</span>&nbsp;<span class="ident" id="7125130">c</span>&nbsp;<span class="op" id="7125132">:=</span>&nbsp;<span class="keyword" id="7125135">range</span>&nbsp;<span class="string" id="7125141">&#34;!)]};,&#34;</span>&nbsp;<span class="op" id="7125150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7125154">src</span>&nbsp;<span class="op" id="7125158">:=</span>&nbsp;<span class="ident" id="7125161">validExpr</span>&nbsp;<span class="op" id="7125171">+</span>&nbsp;<span class="builtintype" id="7125173">string</span><span class="op" id="7125179">(</span><span class="ident" id="7125180">c</span><span class="op" id="7125181">)</span>&nbsp;<span class="op" id="7125183">+</span>&nbsp;<span class="ident" id="7125185">anything</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7125196">if</span>&nbsp;<span class="ident" id="7125199">_</span><span class="op" id="7125200">,</span>&nbsp;<span class="ident" id="7125202">err</span>&nbsp;<span class="op" id="7125206">:=</span>&nbsp;<span class="ident" id="7125209">ParseExpr</span><span class="op" id="7125218">(</span><span class="ident" id="7125219">src</span><span class="op" id="7125222">)</span><span class="op" id="7125223">;</span>&nbsp;<span class="ident" id="7125225">err</span>&nbsp;<span class="op" id="7125229">==</span>&nbsp;<span class="ident" id="7125232">nil</span>&nbsp;<span class="op" id="7125236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7125241">t</span><span class="op" id="7125242">.</span><span class="ident" id="7125243">Errorf</span><span class="op" id="7125249">(</span><span class="string" id="7125250">&#34;ParseExpr(%q):&nbsp;got&nbsp;no&nbsp;error&#34;</span><span class="op" id="7125279">,</span>&nbsp;<span class="ident" id="7125281">src</span><span class="op" id="7125284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7125288">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7125291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7125295">//&nbsp;ParseExpr&nbsp;must&nbsp;not&nbsp;crash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7125324">for</span>&nbsp;<span class="ident" id="7125328">_</span><span class="op" id="7125329">,</span>&nbsp;<span class="ident" id="7125331">src</span>&nbsp;<span class="op" id="7125335">:=</span>&nbsp;<span class="keyword" id="7125338">range</span>&nbsp;<span class="ident" id="7125344">valids</span>&nbsp;<span class="op" id="7125351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7125355">ParseExpr</span><span class="op" id="7125364">(</span><span class="ident" id="7125365">src</span><span class="op" id="7125368">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7125371">}</span><br>
<span class="lineno"></span><span class="op" id="7125373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7125376">func</span>&nbsp;<span class="ident" id="7125381">TestColonEqualsScope</span><span class="op" id="7125401">(</span><span class="ident" id="7125402">t</span>&nbsp;<span class="op" id="7125404">*</span><span class="ident" id="7125405">testing</span><span class="op" id="7125412">.</span><span class="ident" id="7125413">T</span><span class="op" id="7125414">)</span>&nbsp;<span class="op" id="7125416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7125419">f</span><span class="op" id="7125420">,</span>&nbsp;<span class="ident" id="7125422">err</span>&nbsp;<span class="op" id="7125426">:=</span>&nbsp;<span class="ident" id="7125429">ParseFile</span><span class="op" id="7125438">(</span><span class="ident" id="7125439">fset</span><span class="op" id="7125443">,</span>&nbsp;<span class="string" id="7125445">&#34;&#34;</span><span class="op" id="7125447">,</span>&nbsp;<span class="string" id="7125449">`package&nbsp;p;&nbsp;func&nbsp;f()&nbsp;{&nbsp;x,&nbsp;y,&nbsp;z&nbsp;:=&nbsp;x,&nbsp;y,&nbsp;z&nbsp;}`</span><span class="op" id="7125493">,</span>&nbsp;<span class="num" id="7125495">0</span><span class="op" id="7125496">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7125499">if</span>&nbsp;<span class="ident" id="7125502">err</span>&nbsp;<span class="op" id="7125506">!=</span>&nbsp;<span class="ident" id="7125509">nil</span>&nbsp;<span class="op" id="7125513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7125517">t</span><span class="op" id="7125518">.</span><span class="ident" id="7125519">Fatal</span><span class="op" id="7125524">(</span><span class="ident" id="7125525">err</span><span class="op" id="7125528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7125531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7125535">//&nbsp;RHS&nbsp;refers&nbsp;to&nbsp;undefined&nbsp;globals;&nbsp;LHS&nbsp;does&nbsp;not.</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7125586">as</span>&nbsp;<span class="op" id="7125589">:=</span>&nbsp;<span class="ident" id="7125592">f</span><span class="op" id="7125593">.</span><span class="ident" id="7125594">Decls</span><span class="op" id="7125599">[</span><span class="num" id="7125600">0</span><span class="op" id="7125601">]</span><span class="op" id="7125602">.</span><span class="op" id="7125603">(</span><span class="op" id="7125604">*</span><span class="ident" id="7125605">ast</span><span class="op" id="7125608">.</span><span class="ident" id="7125609">FuncDecl</span><span class="op" id="7125617">)</span><span class="op" id="7125618">.</span><span class="ident" id="7125619">Body</span><span class="op" id="7125623">.</span><span class="ident" id="7125624">List</span><span class="op" id="7125628">[</span><span class="num" id="7125629">0</span><span class="op" id="7125630">]</span><span class="op" id="7125631">.</span><span class="op" id="7125632">(</span><span class="op" id="7125633">*</span><span class="ident" id="7125634">ast</span><span class="op" id="7125637">.</span><span class="ident" id="7125638">AssignStmt</span><span class="op" id="7125648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7125651">for</span>&nbsp;<span class="ident" id="7125655">_</span><span class="op" id="7125656">,</span>&nbsp;<span class="ident" id="7125658">v</span>&nbsp;<span class="op" id="7125660">:=</span>&nbsp;<span class="keyword" id="7125663">range</span>&nbsp;<span class="ident" id="7125669">as</span><span class="op" id="7125671">.</span><span class="ident" id="7125672">Rhs</span>&nbsp;<span class="op" id="7125676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7125680">id</span>&nbsp;<span class="op" id="7125683">:=</span>&nbsp;<span class="ident" id="7125686">v</span><span class="op" id="7125687">.</span><span class="op" id="7125688">(</span><span class="op" id="7125689">*</span><span class="ident" id="7125690">ast</span><span class="op" id="7125693">.</span><span class="ident" id="7125694">Ident</span><span class="op" id="7125699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7125703">if</span>&nbsp;<span class="ident" id="7125706">id</span><span class="op" id="7125708">.</span><span class="ident" id="7125709">Obj</span>&nbsp;<span class="op" id="7125713">!=</span>&nbsp;<span class="ident" id="7125716">nil</span>&nbsp;<span class="op" id="7125720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7125725">t</span><span class="op" id="7125726">.</span><span class="ident" id="7125727">Errorf</span><span class="op" id="7125733">(</span><span class="string" id="7125734">&#34;rhs&nbsp;%s&nbsp;has&nbsp;Obj,&nbsp;should&nbsp;not&#34;</span><span class="op" id="7125762">,</span>&nbsp;<span class="ident" id="7125764">id</span><span class="op" id="7125766">.</span><span class="ident" id="7125767">Name</span><span class="op" id="7125771">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7125775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7125778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7125781">for</span>&nbsp;<span class="ident" id="7125785">_</span><span class="op" id="7125786">,</span>&nbsp;<span class="ident" id="7125788">v</span>&nbsp;<span class="op" id="7125790">:=</span>&nbsp;<span class="keyword" id="7125793">range</span>&nbsp;<span class="ident" id="7125799">as</span><span class="op" id="7125801">.</span><span class="ident" id="7125802">Lhs</span>&nbsp;<span class="op" id="7125806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7125810">id</span>&nbsp;<span class="op" id="7125813">:=</span>&nbsp;<span class="ident" id="7125816">v</span><span class="op" id="7125817">.</span><span class="op" id="7125818">(</span><span class="op" id="7125819">*</span><span class="ident" id="7125820">ast</span><span class="op" id="7125823">.</span><span class="ident" id="7125824">Ident</span><span class="op" id="7125829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7125833">if</span>&nbsp;<span class="ident" id="7125836">id</span><span class="op" id="7125838">.</span><span class="ident" id="7125839">Obj</span>&nbsp;<span class="op" id="7125843">==</span>&nbsp;<span class="ident" id="7125846">nil</span>&nbsp;<span class="op" id="7125850">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7125855">t</span><span class="op" id="7125856">.</span><span class="ident" id="7125857">Errorf</span><span class="op" id="7125863">(</span><span class="string" id="7125864">&#34;lhs&nbsp;%s&nbsp;does&nbsp;not&nbsp;have&nbsp;Obj,&nbsp;should&#34;</span><span class="op" id="7125898">,</span>&nbsp;<span class="ident" id="7125900">id</span><span class="op" id="7125902">.</span><span class="ident" id="7125903">Name</span><span class="op" id="7125907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7125911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7125914">}</span><br>
<span class="lineno"></span><span class="op" id="7125916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="keyword" id="7125919">func</span>&nbsp;<span class="ident" id="7125924">TestVarScope</span><span class="op" id="7125936">(</span><span class="ident" id="7125937">t</span>&nbsp;<span class="op" id="7125939">*</span><span class="ident" id="7125940">testing</span><span class="op" id="7125947">.</span><span class="ident" id="7125948">T</span><span class="op" id="7125949">)</span>&nbsp;<span class="op" id="7125951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7125954">f</span><span class="op" id="7125955">,</span>&nbsp;<span class="ident" id="7125957">err</span>&nbsp;<span class="op" id="7125961">:=</span>&nbsp;<span class="ident" id="7125964">ParseFile</span><span class="op" id="7125973">(</span><span class="ident" id="7125974">fset</span><span class="op" id="7125978">,</span>&nbsp;<span class="string" id="7125980">&#34;&#34;</span><span class="op" id="7125982">,</span>&nbsp;<span class="string" id="7125984">`package&nbsp;p;&nbsp;func&nbsp;f()&nbsp;{&nbsp;var&nbsp;x,&nbsp;y,&nbsp;z&nbsp;=&nbsp;x,&nbsp;y,&nbsp;z&nbsp;}`</span><span class="op" id="7126031">,</span>&nbsp;<span class="num" id="7126033">0</span><span class="op" id="7126034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7126037">if</span>&nbsp;<span class="ident" id="7126040">err</span>&nbsp;<span class="op" id="7126044">!=</span>&nbsp;<span class="ident" id="7126047">nil</span>&nbsp;<span class="op" id="7126051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7126055">t</span><span class="op" id="7126056">.</span><span class="ident" id="7126057">Fatal</span><span class="op" id="7126062">(</span><span class="ident" id="7126063">err</span><span class="op" id="7126066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7126069">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7126073">//&nbsp;RHS&nbsp;refers&nbsp;to&nbsp;undefined&nbsp;globals;&nbsp;LHS&nbsp;does&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7126124">as</span>&nbsp;<span class="op" id="7126127">:=</span>&nbsp;<span class="ident" id="7126130">f</span><span class="op" id="7126131">.</span><span class="ident" id="7126132">Decls</span><span class="op" id="7126137">[</span><span class="num" id="7126138">0</span><span class="op" id="7126139">]</span><span class="op" id="7126140">.</span><span class="op" id="7126141">(</span><span class="op" id="7126142">*</span><span class="ident" id="7126143">ast</span><span class="op" id="7126146">.</span><span class="ident" id="7126147">FuncDecl</span><span class="op" id="7126155">)</span><span class="op" id="7126156">.</span><span class="ident" id="7126157">Body</span><span class="op" id="7126161">.</span><span class="ident" id="7126162">List</span><span class="op" id="7126166">[</span><span class="num" id="7126167">0</span><span class="op" id="7126168">]</span><span class="op" id="7126169">.</span><span class="op" id="7126170">(</span><span class="op" id="7126171">*</span><span class="ident" id="7126172">ast</span><span class="op" id="7126175">.</span><span class="ident" id="7126176">DeclStmt</span><span class="op" id="7126184">)</span><span class="op" id="7126185">.</span><span class="ident" id="7126186">Decl</span><span class="op" id="7126190">.</span><span class="op" id="7126191">(</span><span class="op" id="7126192">*</span><span class="ident" id="7126193">ast</span><span class="op" id="7126196">.</span><span class="ident" id="7126197">GenDecl</span><span class="op" id="7126204">)</span><span class="op" id="7126205">.</span><span class="ident" id="7126206">Specs</span><span class="op" id="7126211">[</span><span class="num" id="7126212">0</span><span class="op" id="7126213">]</span><span class="op" id="7126214">.</span><span class="op" id="7126215">(</span><span class="op" id="7126216">*</span><span class="ident" id="7126217">ast</span><span class="op" id="7126220">.</span><span class="ident" id="7126221">ValueSpec</span><span class="op" id="7126230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7126233">for</span>&nbsp;<span class="ident" id="7126237">_</span><span class="op" id="7126238">,</span>&nbsp;<span class="ident" id="7126240">v</span>&nbsp;<span class="op" id="7126242">:=</span>&nbsp;<span class="keyword" id="7126245">range</span>&nbsp;<span class="ident" id="7126251">as</span><span class="op" id="7126253">.</span><span class="ident" id="7126254">Values</span>&nbsp;<span class="op" id="7126261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7126265">id</span>&nbsp;<span class="op" id="7126268">:=</span>&nbsp;<span class="ident" id="7126271">v</span><span class="op" id="7126272">.</span><span class="op" id="7126273">(</span><span class="op" id="7126274">*</span><span class="ident" id="7126275">ast</span><span class="op" id="7126278">.</span><span class="ident" id="7126279">Ident</span><span class="op" id="7126284">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7126288">if</span>&nbsp;<span class="ident" id="7126291">id</span><span class="op" id="7126293">.</span><span class="ident" id="7126294">Obj</span>&nbsp;<span class="op" id="7126298">!=</span>&nbsp;<span class="ident" id="7126301">nil</span>&nbsp;<span class="op" id="7126305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7126310">t</span><span class="op" id="7126311">.</span><span class="ident" id="7126312">Errorf</span><span class="op" id="7126318">(</span><span class="string" id="7126319">&#34;rhs&nbsp;%s&nbsp;has&nbsp;Obj,&nbsp;should&nbsp;not&#34;</span><span class="op" id="7126347">,</span>&nbsp;<span class="ident" id="7126349">id</span><span class="op" id="7126351">.</span><span class="ident" id="7126352">Name</span><span class="op" id="7126356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7126360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7126363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7126366">for</span>&nbsp;<span class="ident" id="7126370">_</span><span class="op" id="7126371">,</span>&nbsp;<span class="ident" id="7126373">id</span>&nbsp;<span class="op" id="7126376">:=</span>&nbsp;<span class="keyword" id="7126379">range</span>&nbsp;<span class="ident" id="7126385">as</span><span class="op" id="7126387">.</span><span class="ident" id="7126388">Names</span>&nbsp;<span class="op" id="7126394">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7126398">if</span>&nbsp;<span class="ident" id="7126401">id</span><span class="op" id="7126403">.</span><span class="ident" id="7126404">Obj</span>&nbsp;<span class="op" id="7126408">==</span>&nbsp;<span class="ident" id="7126411">nil</span>&nbsp;<span class="op" id="7126415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7126420">t</span><span class="op" id="7126421">.</span><span class="ident" id="7126422">Errorf</span><span class="op" id="7126428">(</span><span class="string" id="7126429">&#34;lhs&nbsp;%s&nbsp;does&nbsp;not&nbsp;have&nbsp;Obj,&nbsp;should&#34;</span><span class="op" id="7126463">,</span>&nbsp;<span class="ident" id="7126465">id</span><span class="op" id="7126467">.</span><span class="ident" id="7126468">Name</span><span class="op" id="7126472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7126476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7126479">}</span><br>
<span class="lineno"></span><span class="op" id="7126481">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="7126484">func</span>&nbsp;<span class="ident" id="7126489">TestObjects</span><span class="op" id="7126500">(</span><span class="ident" id="7126501">t</span>&nbsp;<span class="op" id="7126503">*</span><span class="ident" id="7126504">testing</span><span class="op" id="7126511">.</span><span class="ident" id="7126512">T</span><span class="op" id="7126513">)</span>&nbsp;<span class="op" id="7126515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7126518">const</span>&nbsp;<span class="ident" id="7126524">src</span>&nbsp;<span class="op" id="7126528">=</span>&nbsp;<span class="string" id="7126530">`<br>
<span class="lineno"></span>package&nbsp;p<br>
<span class="lineno"></span>import&nbsp;fmt&nbsp;&#34;fmt&#34;<br>
<span class="lineno">180</span>const&nbsp;pi&nbsp;=&nbsp;3.14<br>
<span class="lineno"></span>type&nbsp;T&nbsp;struct{}<br>
<span class="lineno"></span>var&nbsp;x&nbsp;int<br>
<span class="lineno"></span>func&nbsp;f()&nbsp;{&nbsp;L:&nbsp;}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7126621">f</span><span class="op" id="7126622">,</span>&nbsp;<span class="ident" id="7126624">err</span>&nbsp;<span class="op" id="7126628">:=</span>&nbsp;<span class="ident" id="7126631">ParseFile</span><span class="op" id="7126640">(</span><span class="ident" id="7126641">fset</span><span class="op" id="7126645">,</span>&nbsp;<span class="string" id="7126647">&#34;&#34;</span><span class="op" id="7126649">,</span>&nbsp;<span class="ident" id="7126651">src</span><span class="op" id="7126654">,</span>&nbsp;<span class="num" id="7126656">0</span><span class="op" id="7126657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7126660">if</span>&nbsp;<span class="ident" id="7126663">err</span>&nbsp;<span class="op" id="7126667">!=</span>&nbsp;<span class="ident" id="7126670">nil</span>&nbsp;<span class="op" id="7126674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7126678">t</span><span class="op" id="7126679">.</span><span class="ident" id="7126680">Fatal</span><span class="op" id="7126685">(</span><span class="ident" id="7126686">err</span><span class="op" id="7126689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7126692">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7126696">objects</span>&nbsp;<span class="op" id="7126704">:=</span>&nbsp;<span class="keyword" id="7126707">map</span><span class="op" id="7126710">[</span><span class="builtintype" id="7126711">string</span><span class="op" id="7126717">]</span><span class="ident" id="7126718">ast</span><span class="op" id="7126721">.</span><span class="ident" id="7126722">ObjKind</span><span class="op" id="7126729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7126733">&#34;p&#34;</span><span class="op" id="7126736">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7126740">ast</span><span class="op" id="7126743">.</span><span class="ident" id="7126744">Bad</span><span class="op" id="7126747">,</span>&nbsp;<span class="comment" id="7126749">//&nbsp;not&nbsp;in&nbsp;a&nbsp;scope</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7126769">&#34;fmt&#34;</span><span class="op" id="7126774">:</span>&nbsp;<span class="ident" id="7126776">ast</span><span class="op" id="7126779">.</span><span class="ident" id="7126780">Bad</span><span class="op" id="7126783">,</span>&nbsp;<span class="comment" id="7126785">//&nbsp;not&nbsp;resolved&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7126807">&#34;pi&#34;</span><span class="op" id="7126811">:</span>&nbsp;&nbsp;<span class="ident" id="7126814">ast</span><span class="op" id="7126817">.</span><span class="ident" id="7126818">Con</span><span class="op" id="7126821">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7126825">&#34;T&#34;</span><span class="op" id="7126828">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7126832">ast</span><span class="op" id="7126835">.</span><span class="ident" id="7126836">Typ</span><span class="op" id="7126839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7126843">&#34;x&#34;</span><span class="op" id="7126846">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7126850">ast</span><span class="op" id="7126853">.</span><span class="ident" id="7126854">Var</span><span class="op" id="7126857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7126861">&#34;int&#34;</span><span class="op" id="7126866">:</span>&nbsp;<span class="ident" id="7126868">ast</span><span class="op" id="7126871">.</span><span class="ident" id="7126872">Bad</span><span class="op" id="7126875">,</span>&nbsp;<span class="comment" id="7126877">//&nbsp;not&nbsp;resolved&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7126899">&#34;f&#34;</span><span class="op" id="7126902">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7126906">ast</span><span class="op" id="7126909">.</span><span class="ident" id="7126910">Fun</span><span class="op" id="7126913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7126917">&#34;L&#34;</span><span class="op" id="7126920">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7126924">ast</span><span class="op" id="7126927">.</span><span class="ident" id="7126928">Lbl</span><span class="op" id="7126931">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7126934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7126938">ast</span><span class="op" id="7126941">.</span><span class="ident" id="7126942">Inspect</span><span class="op" id="7126949">(</span><span class="ident" id="7126950">f</span><span class="op" id="7126951">,</span>&nbsp;<span class="keyword" id="7126953">func</span><span class="op" id="7126957">(</span><span class="ident" id="7126958">n</span>&nbsp;<span class="ident" id="7126960">ast</span><span class="op" id="7126963">.</span><span class="ident" id="7126964">Node</span><span class="op" id="7126968">)</span>&nbsp;<span class="builtintype" id="7126970">bool</span>&nbsp;<span class="op" id="7126975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7126979">if</span>&nbsp;<span class="ident" id="7126982">ident</span><span class="op" id="7126987">,</span>&nbsp;<span class="ident" id="7126989">ok</span>&nbsp;<span class="op" id="7126992">:=</span>&nbsp;<span class="ident" id="7126995">n</span><span class="op" id="7126996">.</span><span class="op" id="7126997">(</span><span class="op" id="7126998">*</span><span class="ident" id="7126999">ast</span><span class="op" id="7127002">.</span><span class="ident" id="7127003">Ident</span><span class="op" id="7127008">)</span><span class="op" id="7127009">;</span>&nbsp;<span class="ident" id="7127011">ok</span>&nbsp;<span class="op" id="7127014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7127019">obj</span>&nbsp;<span class="op" id="7127023">:=</span>&nbsp;<span class="ident" id="7127026">ident</span><span class="op" id="7127031">.</span><span class="ident" id="7127032">Obj</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7127039">if</span>&nbsp;<span class="ident" id="7127042">obj</span>&nbsp;<span class="op" id="7127046">==</span>&nbsp;<span class="ident" id="7127049">nil</span>&nbsp;<span class="op" id="7127053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7127059">if</span>&nbsp;<span class="ident" id="7127062">objects</span><span class="op" id="7127069">[</span><span class="ident" id="7127070">ident</span><span class="op" id="7127075">.</span><span class="ident" id="7127076">Name</span><span class="op" id="7127080">]</span>&nbsp;<span class="op" id="7127082">!=</span>&nbsp;<span class="ident" id="7127085">ast</span><span class="op" id="7127088">.</span><span class="ident" id="7127089">Bad</span>&nbsp;<span class="op" id="7127093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7127100">t</span><span class="op" id="7127101">.</span><span class="ident" id="7127102">Errorf</span><span class="op" id="7127108">(</span><span class="string" id="7127109">&#34;no&nbsp;object&nbsp;for&nbsp;%s&#34;</span><span class="op" id="7127127">,</span>&nbsp;<span class="ident" id="7127129">ident</span><span class="op" id="7127134">.</span><span class="ident" id="7127135">Name</span><span class="op" id="7127139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7127145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7127151">return</span>&nbsp;<span class="builtintype" id="7127158">true</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7127166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7127171">if</span>&nbsp;<span class="ident" id="7127174">obj</span><span class="op" id="7127177">.</span><span class="ident" id="7127178">Name</span>&nbsp;<span class="op" id="7127183">!=</span>&nbsp;<span class="ident" id="7127186">ident</span><span class="op" id="7127191">.</span><span class="ident" id="7127192">Name</span>&nbsp;<span class="op" id="7127197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7127203">t</span><span class="op" id="7127204">.</span><span class="ident" id="7127205">Errorf</span><span class="op" id="7127211">(</span><span class="string" id="7127212">&#34;names&nbsp;don&#39;t&nbsp;match:&nbsp;obj.Name&nbsp;=&nbsp;%s,&nbsp;ident.Name&nbsp;=&nbsp;%s&#34;</span><span class="op" id="7127263">,</span>&nbsp;<span class="ident" id="7127265">obj</span><span class="op" id="7127268">.</span><span class="ident" id="7127269">Name</span><span class="op" id="7127273">,</span>&nbsp;<span class="ident" id="7127275">ident</span><span class="op" id="7127280">.</span><span class="ident" id="7127281">Name</span><span class="op" id="7127285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7127290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7127295">kind</span>&nbsp;<span class="op" id="7127300">:=</span>&nbsp;<span class="ident" id="7127303">objects</span><span class="op" id="7127310">[</span><span class="ident" id="7127311">ident</span><span class="op" id="7127316">.</span><span class="ident" id="7127317">Name</span><span class="op" id="7127321">]</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7127326">if</span>&nbsp;<span class="ident" id="7127329">obj</span><span class="op" id="7127332">.</span><span class="ident" id="7127333">Kind</span>&nbsp;<span class="op" id="7127338">!=</span>&nbsp;<span class="ident" id="7127341">kind</span>&nbsp;<span class="op" id="7127346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7127352">t</span><span class="op" id="7127353">.</span><span class="ident" id="7127354">Errorf</span><span class="op" id="7127360">(</span><span class="string" id="7127361">&#34;%s:&nbsp;obj.Kind&nbsp;=&nbsp;%s;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7127389">,</span>&nbsp;<span class="ident" id="7127391">ident</span><span class="op" id="7127396">.</span><span class="ident" id="7127397">Name</span><span class="op" id="7127401">,</span>&nbsp;<span class="ident" id="7127403">obj</span><span class="op" id="7127406">.</span><span class="ident" id="7127407">Kind</span><span class="op" id="7127411">,</span>&nbsp;<span class="ident" id="7127413">kind</span><span class="op" id="7127417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7127422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7127426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7127430">return</span>&nbsp;<span class="builtintype" id="7127437">true</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7127443">}</span><span class="op" id="7127444">)</span><br>
<span class="lineno"></span><span class="op" id="7127446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7127449">func</span>&nbsp;<span class="ident" id="7127454">TestUnresolved</span><span class="op" id="7127468">(</span><span class="ident" id="7127469">t</span>&nbsp;<span class="op" id="7127471">*</span><span class="ident" id="7127472">testing</span><span class="op" id="7127479">.</span><span class="ident" id="7127480">T</span><span class="op" id="7127481">)</span>&nbsp;<span class="op" id="7127483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7127486">f</span><span class="op" id="7127487">,</span>&nbsp;<span class="ident" id="7127489">err</span>&nbsp;<span class="op" id="7127493">:=</span>&nbsp;<span class="ident" id="7127496">ParseFile</span><span class="op" id="7127505">(</span><span class="ident" id="7127506">fset</span><span class="op" id="7127510">,</span>&nbsp;<span class="string" id="7127512">&#34;&#34;</span><span class="op" id="7127514">,</span>&nbsp;<span class="string" id="7127516">`<br>
<span class="lineno">225</span>package&nbsp;p<br>
<span class="lineno"></span>//<br>
<span class="lineno"></span>func&nbsp;f1a(int)<br>
<span class="lineno"></span>func&nbsp;f2a(byte,&nbsp;int,&nbsp;float)<br>
<span class="lineno"></span>func&nbsp;f3a(a,&nbsp;b&nbsp;int,&nbsp;c&nbsp;float)<br>
<span class="lineno">230</span>func&nbsp;f4a(...complex)<br>
<span class="lineno"></span>func&nbsp;f5a(a&nbsp;s1a,&nbsp;b&nbsp;...complex)<br>
<span class="lineno"></span>//<br>
<span class="lineno"></span>func&nbsp;f1b(*int)<br>
<span class="lineno"></span>func&nbsp;f2b([]byte,&nbsp;(int),&nbsp;*float)<br>
<span class="lineno">235</span>func&nbsp;f3b(a,&nbsp;b&nbsp;*int,&nbsp;c&nbsp;[]float)<br>
<span class="lineno"></span>func&nbsp;f4b(...*complex)<br>
<span class="lineno"></span>func&nbsp;f5b(a&nbsp;s1a,&nbsp;b&nbsp;...[]complex)<br>
<span class="lineno"></span>//<br>
<span class="lineno"></span>type&nbsp;s1a&nbsp;struct&nbsp;{&nbsp;int&nbsp;}<br>
<span class="lineno">240</span>type&nbsp;s2a&nbsp;struct&nbsp;{&nbsp;byte;&nbsp;int;&nbsp;s1a&nbsp;}<br>
<span class="lineno"></span>type&nbsp;s3a&nbsp;struct&nbsp;{&nbsp;a,&nbsp;b&nbsp;int;&nbsp;c&nbsp;float&nbsp;}<br>
<span class="lineno"></span>//<br>
<span class="lineno"></span>type&nbsp;s1b&nbsp;struct&nbsp;{&nbsp;*int&nbsp;}<br>
<span class="lineno"></span>type&nbsp;s2b&nbsp;struct&nbsp;{&nbsp;byte;&nbsp;int;&nbsp;*float&nbsp;}<br>
<span class="lineno">245</span>type&nbsp;s3b&nbsp;struct&nbsp;{&nbsp;a,&nbsp;b&nbsp;*s3b;&nbsp;c&nbsp;[]float&nbsp;}<br>
<span class="lineno"></span>`</span><span class="op" id="7127994">,</span>&nbsp;<span class="num" id="7127996">0</span><span class="op" id="7127997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7128000">if</span>&nbsp;<span class="ident" id="7128003">err</span>&nbsp;<span class="op" id="7128007">!=</span>&nbsp;<span class="ident" id="7128010">nil</span>&nbsp;<span class="op" id="7128014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7128018">t</span><span class="op" id="7128019">.</span><span class="ident" id="7128020">Fatal</span><span class="op" id="7128025">(</span><span class="ident" id="7128026">err</span><span class="op" id="7128029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7128032">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7128036">want</span>&nbsp;<span class="op" id="7128041">:=</span>&nbsp;<span class="string" id="7128044">&#34;int&nbsp;&#34;</span>&nbsp;<span class="op" id="7128051">+</span>&nbsp;<span class="comment" id="7128053">//&nbsp;f1a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128062">&#34;byte&nbsp;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7128080">+</span>&nbsp;<span class="comment" id="7128082">//&nbsp;f2a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128091">&#34;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7128104">+</span>&nbsp;<span class="comment" id="7128106">//&nbsp;f3a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128115">&#34;complex&nbsp;&#34;</span>&nbsp;<span class="op" id="7128126">+</span>&nbsp;<span class="comment" id="7128128">//&nbsp;f4a</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128137">&#34;complex&nbsp;&#34;</span>&nbsp;<span class="op" id="7128148">+</span>&nbsp;<span class="comment" id="7128150">//&nbsp;f5a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7128159">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128164">&#34;int&nbsp;&#34;</span>&nbsp;<span class="op" id="7128171">+</span>&nbsp;<span class="comment" id="7128173">//&nbsp;f1b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128182">&#34;byte&nbsp;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7128200">+</span>&nbsp;<span class="comment" id="7128202">//&nbsp;f2b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128211">&#34;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7128224">+</span>&nbsp;<span class="comment" id="7128226">//&nbsp;f3b</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128235">&#34;complex&nbsp;&#34;</span>&nbsp;<span class="op" id="7128246">+</span>&nbsp;<span class="comment" id="7128248">//&nbsp;f4b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128257">&#34;complex&nbsp;&#34;</span>&nbsp;<span class="op" id="7128268">+</span>&nbsp;<span class="comment" id="7128270">//&nbsp;f5b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7128279">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128284">&#34;int&nbsp;&#34;</span>&nbsp;<span class="op" id="7128291">+</span>&nbsp;<span class="comment" id="7128293">//&nbsp;s1a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128302">&#34;byte&nbsp;int&nbsp;&#34;</span>&nbsp;<span class="op" id="7128314">+</span>&nbsp;<span class="comment" id="7128316">//&nbsp;s2a</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128325">&#34;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7128338">+</span>&nbsp;<span class="comment" id="7128340">//&nbsp;s3a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7128349">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128354">&#34;int&nbsp;&#34;</span>&nbsp;<span class="op" id="7128361">+</span>&nbsp;<span class="comment" id="7128363">//&nbsp;s1a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128372">&#34;byte&nbsp;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7128390">+</span>&nbsp;<span class="comment" id="7128392">//&nbsp;s2a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128401">&#34;float&nbsp;&#34;</span>&nbsp;<span class="comment" id="7128410">//&nbsp;s3a</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7128419">//&nbsp;collect&nbsp;unresolved&nbsp;identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7128454">var</span>&nbsp;<span class="ident" id="7128458">buf</span>&nbsp;<span class="ident" id="7128462">bytes</span><span class="op" id="7128467">.</span><span class="ident" id="7128468">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7128476">for</span>&nbsp;<span class="ident" id="7128480">_</span><span class="op" id="7128481">,</span>&nbsp;<span class="ident" id="7128483">u</span>&nbsp;<span class="op" id="7128485">:=</span>&nbsp;<span class="keyword" id="7128488">range</span>&nbsp;<span class="ident" id="7128494">f</span><span class="op" id="7128495">.</span><span class="ident" id="7128496">Unresolved</span>&nbsp;<span class="op" id="7128507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7128511">buf</span><span class="op" id="7128514">.</span><span class="ident" id="7128515">WriteString</span><span class="op" id="7128526">(</span><span class="ident" id="7128527">u</span><span class="op" id="7128528">.</span><span class="ident" id="7128529">Name</span><span class="op" id="7128533">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7128537">buf</span><span class="op" id="7128540">.</span><span class="ident" id="7128541">WriteByte</span><span class="op" id="7128550">(</span><span class="string" id="7128551">&#39;&nbsp;&#39;</span><span class="op" id="7128554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7128557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7128560">got</span>&nbsp;<span class="op" id="7128564">:=</span>&nbsp;<span class="ident" id="7128567">buf</span><span class="op" id="7128570">.</span><span class="ident" id="7128571">String</span><span class="op" id="7128577">(</span><span class="op" id="7128578">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7128582">if</span>&nbsp;<span class="ident" id="7128585">got</span>&nbsp;<span class="op" id="7128589">!=</span>&nbsp;<span class="ident" id="7128592">want</span>&nbsp;<span class="op" id="7128597">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7128601">t</span><span class="op" id="7128602">.</span><span class="ident" id="7128603">Errorf</span><span class="op" id="7128609">(</span><span class="string" id="7128610">&#34;\ngot:&nbsp;&nbsp;%s\nwant:&nbsp;%s&#34;</span><span class="op" id="7128632">,</span>&nbsp;<span class="ident" id="7128634">got</span><span class="op" id="7128637">,</span>&nbsp;<span class="ident" id="7128639">want</span><span class="op" id="7128643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7128646">}</span><br>
<span class="lineno"></span><span class="op" id="7128648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7128651">var</span>&nbsp;<span class="ident" id="7128655">imports</span>&nbsp;<span class="op" id="7128663">=</span>&nbsp;<span class="keyword" id="7128665">map</span><span class="op" id="7128668">[</span><span class="builtintype" id="7128669">string</span><span class="op" id="7128675">]</span><span class="builtintype" id="7128676">bool</span><span class="op" id="7128680">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128683">`&#34;a&#34;`</span><span class="op" id="7128688">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7128697">true</span><span class="op" id="7128701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128704">&#34;`a`&#34;</span><span class="op" id="7128709">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7128718">true</span><span class="op" id="7128722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128725">`&#34;a/b&#34;`</span><span class="op" id="7128732">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7128739">true</span><span class="op" id="7128743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128746">`&#34;a.b&#34;`</span><span class="op" id="7128753">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7128760">true</span><span class="op" id="7128764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128767">`&#34;m\x61th&#34;`</span><span class="op" id="7128778">:</span>&nbsp;&nbsp;<span class="builtintype" id="7128781">true</span><span class="op" id="7128785">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128788">`&#34;greek/&#34;`</span><span class="op" id="7128802">:</span>&nbsp;<span class="builtintype" id="7128804">true</span><span class="op" id="7128808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7128811">`&#34;&#34;`</span><span class="op" id="7128815">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7128825">false</span><span class="op" id="7128830">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7128834">//&nbsp;Each&nbsp;of&nbsp;these&nbsp;pairs&nbsp;tests&nbsp;both&nbsp;``&nbsp;vs&nbsp;&#34;&#34;&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7128886">//&nbsp;and&nbsp;also&nbsp;use&nbsp;of&nbsp;invalid&nbsp;characters&nbsp;spelled&nbsp;out&nbsp;as</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7128940">//&nbsp;escape&nbsp;sequences&nbsp;and&nbsp;written&nbsp;directly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7128983">//&nbsp;For&nbsp;example&nbsp;`&#34;\x00&#34;`&nbsp;tests&nbsp;import&nbsp;&#34;\x00&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7129028">//&nbsp;while&nbsp;&#34;`\x00`&#34;&nbsp;tests&nbsp;import&nbsp;`&lt;actual-NUL-byte&gt;`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7129081">`&#34;\x00&#34;`</span><span class="op" id="7129089">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7129095">false</span><span class="op" id="7129100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7129103">&#34;`\x00`&#34;</span><span class="op" id="7129111">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7129117">false</span><span class="op" id="7129122">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7129125">`&#34;\x7f&#34;`</span><span class="op" id="7129133">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7129139">false</span><span class="op" id="7129144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7129147">&#34;`\x7f`&#34;</span><span class="op" id="7129155">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7129161">false</span><span class="op" id="7129166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7129169">`&#34;a!&#34;`</span><span class="op" id="7129175">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7129183">false</span><span class="op" id="7129188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7129191">&#34;`a!`&#34;</span><span class="op" id="7129197">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7129205">false</span><span class="op" id="7129210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7129213">`&#34;a&nbsp;b&#34;`</span><span class="op" id="7129220">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7129227">false</span><span class="op" id="7129232">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7129235">&#34;`a&nbsp;b`&#34;</span><span class="op" id="7129242">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7129249">false</span><span class="op" id="7129254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7129257">`&#34;a\\b&#34;`</span><span class="op" id="7129265">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7129271">false</span><span class="op" id="7129276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7129279">&#34;`a\\b`&#34;</span><span class="op" id="7129287">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7129293">false</span><span class="op" id="7129298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7129301">&#34;\&#34;`a`\&#34;&#34;</span><span class="op" id="7129310">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7129315">false</span><span class="op" id="7129320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7129323">&#34;`\&#34;a\&#34;`&#34;</span><span class="op" id="7129332">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7129337">false</span><span class="op" id="7129342">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7129345">`&#34;\x80\x80&#34;`</span><span class="op" id="7129357">:</span>&nbsp;<span class="builtintype" id="7129359">false</span><span class="op" id="7129364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7129367">&#34;`\x80\x80`&#34;</span><span class="op" id="7129379">:</span>&nbsp;<span class="builtintype" id="7129381">false</span><span class="op" id="7129386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7129389">`&#34;\xFFFD&#34;`</span><span class="op" id="7129399">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7129403">false</span><span class="op" id="7129408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7129411">&#34;`\xFFFD`&#34;</span><span class="op" id="7129421">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7129425">false</span><span class="op" id="7129430">,</span><br>
<span class="lineno"></span><span class="op" id="7129432">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="7129435">func</span>&nbsp;<span class="ident" id="7129440">TestImports</span><span class="op" id="7129451">(</span><span class="ident" id="7129452">t</span>&nbsp;<span class="op" id="7129454">*</span><span class="ident" id="7129455">testing</span><span class="op" id="7129462">.</span><span class="ident" id="7129463">T</span><span class="op" id="7129464">)</span>&nbsp;<span class="op" id="7129466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7129469">for</span>&nbsp;<span class="ident" id="7129473">path</span><span class="op" id="7129477">,</span>&nbsp;<span class="ident" id="7129479">isValid</span>&nbsp;<span class="op" id="7129487">:=</span>&nbsp;<span class="keyword" id="7129490">range</span>&nbsp;<span class="ident" id="7129496">imports</span>&nbsp;<span class="op" id="7129504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7129508">src</span>&nbsp;<span class="op" id="7129512">:=</span>&nbsp;<span class="ident" id="7129515">fmt</span><span class="op" id="7129518">.</span><span class="ident" id="7129519">Sprintf</span><span class="op" id="7129526">(</span><span class="string" id="7129527">&#34;package&nbsp;p;&nbsp;import&nbsp;%s&#34;</span><span class="op" id="7129549">,</span>&nbsp;<span class="ident" id="7129551">path</span><span class="op" id="7129555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7129559">_</span><span class="op" id="7129560">,</span>&nbsp;<span class="ident" id="7129562">err</span>&nbsp;<span class="op" id="7129566">:=</span>&nbsp;<span class="ident" id="7129569">ParseFile</span><span class="op" id="7129578">(</span><span class="ident" id="7129579">fset</span><span class="op" id="7129583">,</span>&nbsp;<span class="string" id="7129585">&#34;&#34;</span><span class="op" id="7129587">,</span>&nbsp;<span class="ident" id="7129589">src</span><span class="op" id="7129592">,</span>&nbsp;<span class="num" id="7129594">0</span><span class="op" id="7129595">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7129599">switch</span>&nbsp;<span class="op" id="7129606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7129610">case</span>&nbsp;<span class="ident" id="7129615">err</span>&nbsp;<span class="op" id="7129619">!=</span>&nbsp;<span class="ident" id="7129622">nil</span>&nbsp;<span class="op" id="7129626">&amp;&amp;</span>&nbsp;<span class="ident" id="7129629">isValid</span><span class="op" id="7129636">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7129641">t</span><span class="op" id="7129642">.</span><span class="ident" id="7129643">Errorf</span><span class="op" id="7129649">(</span><span class="string" id="7129650">&#34;ParseFile(%s):&nbsp;got&nbsp;%v;&nbsp;expected&nbsp;no&nbsp;error&#34;</span><span class="op" id="7129692">,</span>&nbsp;<span class="ident" id="7129694">src</span><span class="op" id="7129697">,</span>&nbsp;<span class="ident" id="7129699">err</span><span class="op" id="7129702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7129706">case</span>&nbsp;<span class="ident" id="7129711">err</span>&nbsp;<span class="op" id="7129715">==</span>&nbsp;<span class="ident" id="7129718">nil</span>&nbsp;<span class="op" id="7129722">&amp;&amp;</span>&nbsp;<span class="op" id="7129725">!</span><span class="ident" id="7129726">isValid</span><span class="op" id="7129733">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7129738">t</span><span class="op" id="7129739">.</span><span class="ident" id="7129740">Errorf</span><span class="op" id="7129746">(</span><span class="string" id="7129747">&#34;ParseFile(%s):&nbsp;got&nbsp;no&nbsp;error;&nbsp;expected&nbsp;one&#34;</span><span class="op" id="7129790">,</span>&nbsp;<span class="ident" id="7129792">src</span><span class="op" id="7129795">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7129799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7129802">}</span><br>
<span class="lineno"></span><span class="op" id="7129804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7129807">func</span>&nbsp;<span class="ident" id="7129812">TestCommentGroups</span><span class="op" id="7129829">(</span><span class="ident" id="7129830">t</span>&nbsp;<span class="op" id="7129832">*</span><span class="ident" id="7129833">testing</span><span class="op" id="7129840">.</span><span class="ident" id="7129841">T</span><span class="op" id="7129842">)</span>&nbsp;<span class="op" id="7129844">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7129847">f</span><span class="op" id="7129848">,</span>&nbsp;<span class="ident" id="7129850">err</span>&nbsp;<span class="op" id="7129854">:=</span>&nbsp;<span class="ident" id="7129857">ParseFile</span><span class="op" id="7129866">(</span><span class="ident" id="7129867">fset</span><span class="op" id="7129871">,</span>&nbsp;<span class="string" id="7129873">&#34;&#34;</span><span class="op" id="7129875">,</span>&nbsp;<span class="string" id="7129877">`<br>
<span class="lineno"></span>package&nbsp;p&nbsp;/*&nbsp;1a&nbsp;*/&nbsp;/*&nbsp;1b&nbsp;*/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;1c&nbsp;*/&nbsp;//&nbsp;1d<br>
<span class="lineno"></span>/*&nbsp;2a<br>
<span class="lineno"></span>*/<br>
<span class="lineno"></span>//&nbsp;2b<br>
<span class="lineno">335</span>const&nbsp;pi&nbsp;=&nbsp;3.1415<br>
<span class="lineno"></span>/*&nbsp;3a&nbsp;*/&nbsp;//&nbsp;3b<br>
<span class="lineno"></span>/*&nbsp;3c&nbsp;*/&nbsp;const&nbsp;e&nbsp;=&nbsp;2.7182<br>
<span class="lineno"></span><br>
<span class="lineno"></span>//&nbsp;Example&nbsp;from&nbsp;issue&nbsp;3139<br>
<span class="lineno">340</span>func&nbsp;ExampleCount()&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;fmt.Println(strings.Count(&#34;cheese&#34;,&nbsp;&#34;e&#34;))<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;fmt.Println(strings.Count(&#34;five&#34;,&nbsp;&#34;&#34;))&nbsp;//&nbsp;before&nbsp;&amp;&nbsp;after&nbsp;each&nbsp;rune<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Output:<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;3<br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;5<br>
<span class="lineno"></span>}<br>
<span class="lineno"></span>`</span><span class="op" id="7130189">,</span>&nbsp;<span class="ident" id="7130191">ParseComments</span><span class="op" id="7130204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7130207">if</span>&nbsp;<span class="ident" id="7130210">err</span>&nbsp;<span class="op" id="7130214">!=</span>&nbsp;<span class="ident" id="7130217">nil</span>&nbsp;<span class="op" id="7130221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7130225">t</span><span class="op" id="7130226">.</span><span class="ident" id="7130227">Fatal</span><span class="op" id="7130232">(</span><span class="ident" id="7130233">err</span><span class="op" id="7130236">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7130239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7130242">expected</span>&nbsp;<span class="op" id="7130251">:=</span>&nbsp;<span class="op" id="7130254">[</span><span class="op" id="7130255">]</span><span class="op" id="7130256">[</span><span class="op" id="7130257">]</span><span class="builtintype" id="7130258">string</span><span class="op" id="7130264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7130268">{</span><span class="string" id="7130269">&#34;/*&nbsp;1a&nbsp;*/&#34;</span><span class="op" id="7130279">,</span>&nbsp;<span class="string" id="7130281">&#34;/*&nbsp;1b&nbsp;*/&#34;</span><span class="op" id="7130291">,</span>&nbsp;<span class="string" id="7130293">&#34;/*&nbsp;1c&nbsp;*/&#34;</span><span class="op" id="7130303">,</span>&nbsp;<span class="string" id="7130305">&#34;//&nbsp;1d&#34;</span><span class="op" id="7130312">}</span><span class="op" id="7130313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7130317">{</span><span class="string" id="7130318">&#34;/*&nbsp;2a\n*/&#34;</span><span class="op" id="7130329">,</span>&nbsp;<span class="string" id="7130331">&#34;//&nbsp;2b&#34;</span><span class="op" id="7130338">}</span><span class="op" id="7130339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7130343">{</span><span class="string" id="7130344">&#34;/*&nbsp;3a&nbsp;*/&#34;</span><span class="op" id="7130354">,</span>&nbsp;<span class="string" id="7130356">&#34;//&nbsp;3b&#34;</span><span class="op" id="7130363">,</span>&nbsp;<span class="string" id="7130365">&#34;/*&nbsp;3c&nbsp;*/&#34;</span><span class="op" id="7130375">}</span><span class="op" id="7130376">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7130380">{</span><span class="string" id="7130381">&#34;//&nbsp;Example&nbsp;from&nbsp;issue&nbsp;3139&#34;</span><span class="op" id="7130409">}</span><span class="op" id="7130410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7130414">{</span><span class="string" id="7130415">&#34;//&nbsp;before&nbsp;&amp;&nbsp;after&nbsp;each&nbsp;rune&#34;</span><span class="op" id="7130444">}</span><span class="op" id="7130445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7130449">{</span><span class="string" id="7130450">&#34;//&nbsp;Output:&#34;</span><span class="op" id="7130462">,</span>&nbsp;<span class="string" id="7130464">&#34;//&nbsp;3&#34;</span><span class="op" id="7130470">,</span>&nbsp;<span class="string" id="7130472">&#34;//&nbsp;5&#34;</span><span class="op" id="7130478">}</span><span class="op" id="7130479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7130482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7130485">if</span>&nbsp;<span class="builtinfunc" id="7130488">len</span><span class="op" id="7130491">(</span><span class="ident" id="7130492">f</span><span class="op" id="7130493">.</span><span class="ident" id="7130494">Comments</span><span class="op" id="7130502">)</span>&nbsp;<span class="op" id="7130504">!=</span>&nbsp;<span class="builtinfunc" id="7130507">len</span><span class="op" id="7130510">(</span><span class="ident" id="7130511">expected</span><span class="op" id="7130519">)</span>&nbsp;<span class="op" id="7130521">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7130525">t</span><span class="op" id="7130526">.</span><span class="ident" id="7130527">Fatalf</span><span class="op" id="7130533">(</span><span class="string" id="7130534">&#34;got&nbsp;%d&nbsp;comment&nbsp;groups;&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="7130570">,</span>&nbsp;<span class="builtinfunc" id="7130572">len</span><span class="op" id="7130575">(</span><span class="ident" id="7130576">f</span><span class="op" id="7130577">.</span><span class="ident" id="7130578">Comments</span><span class="op" id="7130586">)</span><span class="op" id="7130587">,</span>&nbsp;<span class="builtinfunc" id="7130589">len</span><span class="op" id="7130592">(</span><span class="ident" id="7130593">expected</span><span class="op" id="7130601">)</span><span class="op" id="7130602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7130605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7130608">for</span>&nbsp;<span class="ident" id="7130612">i</span><span class="op" id="7130613">,</span>&nbsp;<span class="ident" id="7130615">exp</span>&nbsp;<span class="op" id="7130619">:=</span>&nbsp;<span class="keyword" id="7130622">range</span>&nbsp;<span class="ident" id="7130628">expected</span>&nbsp;<span class="op" id="7130637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7130641">got</span>&nbsp;<span class="op" id="7130645">:=</span>&nbsp;<span class="ident" id="7130648">f</span><span class="op" id="7130649">.</span><span class="ident" id="7130650">Comments</span><span class="op" id="7130658">[</span><span class="ident" id="7130659">i</span><span class="op" id="7130660">]</span><span class="op" id="7130661">.</span><span class="ident" id="7130662">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7130669">if</span>&nbsp;<span class="builtinfunc" id="7130672">len</span><span class="op" id="7130675">(</span><span class="ident" id="7130676">got</span><span class="op" id="7130679">)</span>&nbsp;<span class="op" id="7130681">!=</span>&nbsp;<span class="builtinfunc" id="7130684">len</span><span class="op" id="7130687">(</span><span class="ident" id="7130688">exp</span><span class="op" id="7130691">)</span>&nbsp;<span class="op" id="7130693">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7130698">t</span><span class="op" id="7130699">.</span><span class="ident" id="7130700">Errorf</span><span class="op" id="7130706">(</span><span class="string" id="7130707">&#34;got&nbsp;%d&nbsp;comments&nbsp;in&nbsp;group&nbsp;%d;&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="7130749">,</span>&nbsp;<span class="builtinfunc" id="7130751">len</span><span class="op" id="7130754">(</span><span class="ident" id="7130755">got</span><span class="op" id="7130758">)</span><span class="op" id="7130759">,</span>&nbsp;<span class="ident" id="7130761">i</span><span class="op" id="7130762">,</span>&nbsp;<span class="builtinfunc" id="7130764">len</span><span class="op" id="7130767">(</span><span class="ident" id="7130768">exp</span><span class="op" id="7130771">)</span><span class="op" id="7130772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7130777">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7130788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7130792">for</span>&nbsp;<span class="ident" id="7130796">j</span><span class="op" id="7130797">,</span>&nbsp;<span class="ident" id="7130799">exp</span>&nbsp;<span class="op" id="7130803">:=</span>&nbsp;<span class="keyword" id="7130806">range</span>&nbsp;<span class="ident" id="7130812">exp</span>&nbsp;<span class="op" id="7130816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7130821">got</span>&nbsp;<span class="op" id="7130825">:=</span>&nbsp;<span class="ident" id="7130828">got</span><span class="op" id="7130831">[</span><span class="ident" id="7130832">j</span><span class="op" id="7130833">]</span><span class="op" id="7130834">.</span><span class="ident" id="7130835">Text</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7130843">if</span>&nbsp;<span class="ident" id="7130846">got</span>&nbsp;<span class="op" id="7130850">!=</span>&nbsp;<span class="ident" id="7130853">exp</span>&nbsp;<span class="op" id="7130857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7130863">t</span><span class="op" id="7130864">.</span><span class="ident" id="7130865">Errorf</span><span class="op" id="7130871">(</span><span class="string" id="7130872">&#34;got&nbsp;%q&nbsp;in&nbsp;group&nbsp;%d;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7130905">,</span>&nbsp;<span class="ident" id="7130907">got</span><span class="op" id="7130910">,</span>&nbsp;<span class="ident" id="7130912">i</span><span class="op" id="7130913">,</span>&nbsp;<span class="ident" id="7130915">exp</span><span class="op" id="7130918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7130923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7130927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7130930">}</span><br>
<span class="lineno">375</span><span class="op" id="7130932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7130935">func</span>&nbsp;<span class="ident" id="7130940">getField</span><span class="op" id="7130948">(</span><span class="ident" id="7130949">file</span>&nbsp;<span class="op" id="7130954">*</span><span class="ident" id="7130955">ast</span><span class="op" id="7130958">.</span><span class="ident" id="7130959">File</span><span class="op" id="7130963">,</span>&nbsp;<span class="ident" id="7130965">fieldname</span>&nbsp;<span class="builtintype" id="7130975">string</span><span class="op" id="7130981">)</span>&nbsp;<span class="op" id="7130983">*</span><span class="ident" id="7130984">ast</span><span class="op" id="7130987">.</span><span class="ident" id="7130988">Field</span>&nbsp;<span class="op" id="7130994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7130997">parts</span>&nbsp;<span class="op" id="7131003">:=</span>&nbsp;<span class="ident" id="7131006">strings</span><span class="op" id="7131013">.</span><span class="ident" id="7131014">Split</span><span class="op" id="7131019">(</span><span class="ident" id="7131020">fieldname</span><span class="op" id="7131029">,</span>&nbsp;<span class="string" id="7131031">&#34;.&#34;</span><span class="op" id="7131034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7131037">for</span>&nbsp;<span class="ident" id="7131041">_</span><span class="op" id="7131042">,</span>&nbsp;<span class="ident" id="7131044">d</span>&nbsp;<span class="op" id="7131046">:=</span>&nbsp;<span class="keyword" id="7131049">range</span>&nbsp;<span class="ident" id="7131055">file</span><span class="op" id="7131059">.</span><span class="ident" id="7131060">Decls</span>&nbsp;<span class="op" id="7131066">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7131070">if</span>&nbsp;<span class="ident" id="7131073">d</span><span class="op" id="7131074">,</span>&nbsp;<span class="ident" id="7131076">ok</span>&nbsp;<span class="op" id="7131079">:=</span>&nbsp;<span class="ident" id="7131082">d</span><span class="op" id="7131083">.</span><span class="op" id="7131084">(</span><span class="op" id="7131085">*</span><span class="ident" id="7131086">ast</span><span class="op" id="7131089">.</span><span class="ident" id="7131090">GenDecl</span><span class="op" id="7131097">)</span><span class="op" id="7131098">;</span>&nbsp;<span class="ident" id="7131100">ok</span>&nbsp;<span class="op" id="7131103">&amp;&amp;</span>&nbsp;<span class="ident" id="7131106">d</span><span class="op" id="7131107">.</span><span class="ident" id="7131108">Tok</span>&nbsp;<span class="op" id="7131112">==</span>&nbsp;<span class="ident" id="7131115">token</span><span class="op" id="7131120">.</span><span class="ident" id="7131121">TYPE</span>&nbsp;<span class="op" id="7131126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7131131">for</span>&nbsp;<span class="ident" id="7131135">_</span><span class="op" id="7131136">,</span>&nbsp;<span class="ident" id="7131138">s</span>&nbsp;<span class="op" id="7131140">:=</span>&nbsp;<span class="keyword" id="7131143">range</span>&nbsp;<span class="ident" id="7131149">d</span><span class="op" id="7131150">.</span><span class="ident" id="7131151">Specs</span>&nbsp;<span class="op" id="7131157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7131163">if</span>&nbsp;<span class="ident" id="7131166">s</span><span class="op" id="7131167">,</span>&nbsp;<span class="ident" id="7131169">ok</span>&nbsp;<span class="op" id="7131172">:=</span>&nbsp;<span class="ident" id="7131175">s</span><span class="op" id="7131176">.</span><span class="op" id="7131177">(</span><span class="op" id="7131178">*</span><span class="ident" id="7131179">ast</span><span class="op" id="7131182">.</span><span class="ident" id="7131183">TypeSpec</span><span class="op" id="7131191">)</span><span class="op" id="7131192">;</span>&nbsp;<span class="ident" id="7131194">ok</span>&nbsp;<span class="op" id="7131197">&amp;&amp;</span>&nbsp;<span class="ident" id="7131200">s</span><span class="op" id="7131201">.</span><span class="ident" id="7131202">Name</span><span class="op" id="7131206">.</span><span class="ident" id="7131207">Name</span>&nbsp;<span class="op" id="7131212">==</span>&nbsp;<span class="ident" id="7131215">parts</span><span class="op" id="7131220">[</span><span class="num" id="7131221">0</span><span class="op" id="7131222">]</span>&nbsp;<span class="op" id="7131224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7131231">if</span>&nbsp;<span class="ident" id="7131234">s</span><span class="op" id="7131235">,</span>&nbsp;<span class="ident" id="7131237">ok</span>&nbsp;<span class="op" id="7131240">:=</span>&nbsp;<span class="ident" id="7131243">s</span><span class="op" id="7131244">.</span><span class="ident" id="7131245">Type</span><span class="op" id="7131249">.</span><span class="op" id="7131250">(</span><span class="op" id="7131251">*</span><span class="ident" id="7131252">ast</span><span class="op" id="7131255">.</span><span class="ident" id="7131256">StructType</span><span class="op" id="7131266">)</span><span class="op" id="7131267">;</span>&nbsp;<span class="ident" id="7131269">ok</span>&nbsp;<span class="op" id="7131272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7131280">for</span>&nbsp;<span class="ident" id="7131284">_</span><span class="op" id="7131285">,</span>&nbsp;<span class="ident" id="7131287">f</span>&nbsp;<span class="op" id="7131289">:=</span>&nbsp;<span class="keyword" id="7131292">range</span>&nbsp;<span class="ident" id="7131298">s</span><span class="op" id="7131299">.</span><span class="ident" id="7131300">Fields</span><span class="op" id="7131306">.</span><span class="ident" id="7131307">List</span>&nbsp;<span class="op" id="7131312">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7131321">for</span>&nbsp;<span class="ident" id="7131325">_</span><span class="op" id="7131326">,</span>&nbsp;<span class="ident" id="7131328">name</span>&nbsp;<span class="op" id="7131333">:=</span>&nbsp;<span class="keyword" id="7131336">range</span>&nbsp;<span class="ident" id="7131342">f</span><span class="op" id="7131343">.</span><span class="ident" id="7131344">Names</span>&nbsp;<span class="op" id="7131350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7131360">if</span>&nbsp;<span class="ident" id="7131363">name</span><span class="op" id="7131367">.</span><span class="ident" id="7131368">Name</span>&nbsp;<span class="op" id="7131373">==</span>&nbsp;<span class="ident" id="7131376">parts</span><span class="op" id="7131381">[</span><span class="num" id="7131382">1</span><span class="op" id="7131383">]</span>&nbsp;<span class="op" id="7131385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7131396">return</span>&nbsp;<span class="ident" id="7131403">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7131413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7131422">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7131430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7131437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7131443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7131448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7131452">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7131455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7131458">return</span>&nbsp;<span class="ident" id="7131465">nil</span><br>
<span class="lineno"></span><span class="op" id="7131469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7131472">//&nbsp;Don&#39;t&nbsp;use&nbsp;ast.CommentGroup.Text()&nbsp;-&nbsp;we&nbsp;want&nbsp;to&nbsp;see&nbsp;exact&nbsp;comment&nbsp;text.</span><br>
<span class="lineno">400</span><span class="keyword" id="7131546">func</span>&nbsp;<span class="ident" id="7131551">commentText</span><span class="op" id="7131562">(</span><span class="ident" id="7131563">c</span>&nbsp;<span class="op" id="7131565">*</span><span class="ident" id="7131566">ast</span><span class="op" id="7131569">.</span><span class="ident" id="7131570">CommentGroup</span><span class="op" id="7131582">)</span>&nbsp;<span class="builtintype" id="7131584">string</span>&nbsp;<span class="op" id="7131591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7131594">var</span>&nbsp;<span class="ident" id="7131598">buf</span>&nbsp;<span class="ident" id="7131602">bytes</span><span class="op" id="7131607">.</span><span class="ident" id="7131608">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7131616">if</span>&nbsp;<span class="ident" id="7131619">c</span>&nbsp;<span class="op" id="7131621">!=</span>&nbsp;<span class="ident" id="7131624">nil</span>&nbsp;<span class="op" id="7131628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7131632">for</span>&nbsp;<span class="ident" id="7131636">_</span><span class="op" id="7131637">,</span>&nbsp;<span class="ident" id="7131639">c</span>&nbsp;<span class="op" id="7131641">:=</span>&nbsp;<span class="keyword" id="7131644">range</span>&nbsp;<span class="ident" id="7131650">c</span><span class="op" id="7131651">.</span><span class="ident" id="7131652">List</span>&nbsp;<span class="op" id="7131657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7131662">buf</span><span class="op" id="7131665">.</span><span class="ident" id="7131666">WriteString</span><span class="op" id="7131677">(</span><span class="ident" id="7131678">c</span><span class="op" id="7131679">.</span><span class="ident" id="7131680">Text</span><span class="op" id="7131684">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7131688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7131691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7131694">return</span>&nbsp;<span class="ident" id="7131701">buf</span><span class="op" id="7131704">.</span><span class="ident" id="7131705">String</span><span class="op" id="7131711">(</span><span class="op" id="7131712">)</span><br>
<span class="lineno"></span><span class="op" id="7131714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="7131717">func</span>&nbsp;<span class="ident" id="7131722">checkFieldComments</span><span class="op" id="7131740">(</span><span class="ident" id="7131741">t</span>&nbsp;<span class="op" id="7131743">*</span><span class="ident" id="7131744">testing</span><span class="op" id="7131751">.</span><span class="ident" id="7131752">T</span><span class="op" id="7131753">,</span>&nbsp;<span class="ident" id="7131755">file</span>&nbsp;<span class="op" id="7131760">*</span><span class="ident" id="7131761">ast</span><span class="op" id="7131764">.</span><span class="ident" id="7131765">File</span><span class="op" id="7131769">,</span>&nbsp;<span class="ident" id="7131771">fieldname</span><span class="op" id="7131780">,</span>&nbsp;<span class="ident" id="7131782">lead</span><span class="op" id="7131786">,</span>&nbsp;<span class="ident" id="7131788">line</span>&nbsp;<span class="builtintype" id="7131793">string</span><span class="op" id="7131799">)</span>&nbsp;<span class="op" id="7131801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7131804">f</span>&nbsp;<span class="op" id="7131806">:=</span>&nbsp;<span class="ident" id="7131809">getField</span><span class="op" id="7131817">(</span><span class="ident" id="7131818">file</span><span class="op" id="7131822">,</span>&nbsp;<span class="ident" id="7131824">fieldname</span><span class="op" id="7131833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7131836">if</span>&nbsp;<span class="ident" id="7131839">f</span>&nbsp;<span class="op" id="7131841">==</span>&nbsp;<span class="ident" id="7131844">nil</span>&nbsp;<span class="op" id="7131848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7131852">t</span><span class="op" id="7131853">.</span><span class="ident" id="7131854">Fatalf</span><span class="op" id="7131860">(</span><span class="string" id="7131861">&#34;field&nbsp;not&nbsp;found:&nbsp;%s&#34;</span><span class="op" id="7131882">,</span>&nbsp;<span class="ident" id="7131884">fieldname</span><span class="op" id="7131893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7131896">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7131899">if</span>&nbsp;<span class="ident" id="7131902">got</span>&nbsp;<span class="op" id="7131906">:=</span>&nbsp;<span class="ident" id="7131909">commentText</span><span class="op" id="7131920">(</span><span class="ident" id="7131921">f</span><span class="op" id="7131922">.</span><span class="ident" id="7131923">Doc</span><span class="op" id="7131926">)</span><span class="op" id="7131927">;</span>&nbsp;<span class="ident" id="7131929">got</span>&nbsp;<span class="op" id="7131933">!=</span>&nbsp;<span class="ident" id="7131936">lead</span>&nbsp;<span class="op" id="7131941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7131945">t</span><span class="op" id="7131946">.</span><span class="ident" id="7131947">Errorf</span><span class="op" id="7131953">(</span><span class="string" id="7131954">&#34;got&nbsp;lead&nbsp;comment&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7131988">,</span>&nbsp;<span class="ident" id="7131990">got</span><span class="op" id="7131993">,</span>&nbsp;<span class="ident" id="7131995">lead</span><span class="op" id="7131999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7132002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7132005">if</span>&nbsp;<span class="ident" id="7132008">got</span>&nbsp;<span class="op" id="7132012">:=</span>&nbsp;<span class="ident" id="7132015">commentText</span><span class="op" id="7132026">(</span><span class="ident" id="7132027">f</span><span class="op" id="7132028">.</span><span class="ident" id="7132029">Comment</span><span class="op" id="7132036">)</span><span class="op" id="7132037">;</span>&nbsp;<span class="ident" id="7132039">got</span>&nbsp;<span class="op" id="7132043">!=</span>&nbsp;<span class="ident" id="7132046">line</span>&nbsp;<span class="op" id="7132051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7132055">t</span><span class="op" id="7132056">.</span><span class="ident" id="7132057">Errorf</span><span class="op" id="7132063">(</span><span class="string" id="7132064">&#34;got&nbsp;line&nbsp;comment&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7132098">,</span>&nbsp;<span class="ident" id="7132100">got</span><span class="op" id="7132103">,</span>&nbsp;<span class="ident" id="7132105">line</span><span class="op" id="7132109">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7132112">}</span><br>
<span class="lineno"></span><span class="op" id="7132114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7132117">func</span>&nbsp;<span class="ident" id="7132122">TestLeadAndLineComments</span><span class="op" id="7132145">(</span><span class="ident" id="7132146">t</span>&nbsp;<span class="op" id="7132148">*</span><span class="ident" id="7132149">testing</span><span class="op" id="7132156">.</span><span class="ident" id="7132157">T</span><span class="op" id="7132158">)</span>&nbsp;<span class="op" id="7132160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7132163">f</span><span class="op" id="7132164">,</span>&nbsp;<span class="ident" id="7132166">err</span>&nbsp;<span class="op" id="7132170">:=</span>&nbsp;<span class="ident" id="7132173">ParseFile</span><span class="op" id="7132182">(</span><span class="ident" id="7132183">fset</span><span class="op" id="7132187">,</span>&nbsp;<span class="string" id="7132189">&#34;&#34;</span><span class="op" id="7132191">,</span>&nbsp;<span class="string" id="7132193">`<br>
<span class="lineno">425</span>package&nbsp;p<br>
<span class="lineno"></span>type&nbsp;T&nbsp;struct&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;F1&nbsp;lead&nbsp;comment&nbsp;*/<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;//<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;F1&nbsp;int&nbsp;&nbsp;/*&nbsp;F1&nbsp;*/&nbsp;//&nbsp;line&nbsp;comment<br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;F2&nbsp;lead<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;comment<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;F2&nbsp;int&nbsp;&nbsp;//&nbsp;F2&nbsp;line&nbsp;comment<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;f3&nbsp;lead&nbsp;comment<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;f3&nbsp;int&nbsp;&nbsp;//&nbsp;f3&nbsp;line&nbsp;comment<br>
<span class="lineno">435</span>}<br>
<span class="lineno"></span>`</span><span class="op" id="7132385">,</span>&nbsp;<span class="ident" id="7132387">ParseComments</span><span class="op" id="7132400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7132403">if</span>&nbsp;<span class="ident" id="7132406">err</span>&nbsp;<span class="op" id="7132410">!=</span>&nbsp;<span class="ident" id="7132413">nil</span>&nbsp;<span class="op" id="7132417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7132421">t</span><span class="op" id="7132422">.</span><span class="ident" id="7132423">Fatal</span><span class="op" id="7132428">(</span><span class="ident" id="7132429">err</span><span class="op" id="7132432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7132435">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7132438">checkFieldComments</span><span class="op" id="7132456">(</span><span class="ident" id="7132457">t</span><span class="op" id="7132458">,</span>&nbsp;<span class="ident" id="7132460">f</span><span class="op" id="7132461">,</span>&nbsp;<span class="string" id="7132463">&#34;T.F1&#34;</span><span class="op" id="7132469">,</span>&nbsp;<span class="string" id="7132471">&#34;/*&nbsp;F1&nbsp;lead&nbsp;comment&nbsp;*///&#34;</span><span class="op" id="7132496">,</span>&nbsp;<span class="string" id="7132498">&#34;/*&nbsp;F1&nbsp;*///&nbsp;line&nbsp;comment&#34;</span><span class="op" id="7132523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7132526">checkFieldComments</span><span class="op" id="7132544">(</span><span class="ident" id="7132545">t</span><span class="op" id="7132546">,</span>&nbsp;<span class="ident" id="7132548">f</span><span class="op" id="7132549">,</span>&nbsp;<span class="string" id="7132551">&#34;T.F2&#34;</span><span class="op" id="7132557">,</span>&nbsp;<span class="string" id="7132559">&#34;//&nbsp;F2&nbsp;lead//&nbsp;comment&#34;</span><span class="op" id="7132581">,</span>&nbsp;<span class="string" id="7132583">&#34;//&nbsp;F2&nbsp;line&nbsp;comment&#34;</span><span class="op" id="7132603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7132606">checkFieldComments</span><span class="op" id="7132624">(</span><span class="ident" id="7132625">t</span><span class="op" id="7132626">,</span>&nbsp;<span class="ident" id="7132628">f</span><span class="op" id="7132629">,</span>&nbsp;<span class="string" id="7132631">&#34;T.f3&#34;</span><span class="op" id="7132637">,</span>&nbsp;<span class="string" id="7132639">&#34;//&nbsp;f3&nbsp;lead&nbsp;comment&#34;</span><span class="op" id="7132659">,</span>&nbsp;<span class="string" id="7132661">&#34;//&nbsp;f3&nbsp;line&nbsp;comment&#34;</span><span class="op" id="7132681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7132684">ast</span><span class="op" id="7132687">.</span><span class="ident" id="7132688">FileExports</span><span class="op" id="7132699">(</span><span class="ident" id="7132700">f</span><span class="op" id="7132701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7132704">checkFieldComments</span><span class="op" id="7132722">(</span><span class="ident" id="7132723">t</span><span class="op" id="7132724">,</span>&nbsp;<span class="ident" id="7132726">f</span><span class="op" id="7132727">,</span>&nbsp;<span class="string" id="7132729">&#34;T.F1&#34;</span><span class="op" id="7132735">,</span>&nbsp;<span class="string" id="7132737">&#34;/*&nbsp;F1&nbsp;lead&nbsp;comment&nbsp;*///&#34;</span><span class="op" id="7132762">,</span>&nbsp;<span class="string" id="7132764">&#34;/*&nbsp;F1&nbsp;*///&nbsp;line&nbsp;comment&#34;</span><span class="op" id="7132789">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7132792">checkFieldComments</span><span class="op" id="7132810">(</span><span class="ident" id="7132811">t</span><span class="op" id="7132812">,</span>&nbsp;<span class="ident" id="7132814">f</span><span class="op" id="7132815">,</span>&nbsp;<span class="string" id="7132817">&#34;T.F2&#34;</span><span class="op" id="7132823">,</span>&nbsp;<span class="string" id="7132825">&#34;//&nbsp;F2&nbsp;lead//&nbsp;comment&#34;</span><span class="op" id="7132847">,</span>&nbsp;<span class="string" id="7132849">&#34;//&nbsp;F2&nbsp;line&nbsp;comment&#34;</span><span class="op" id="7132869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7132872">if</span>&nbsp;<span class="ident" id="7132875">getField</span><span class="op" id="7132883">(</span><span class="ident" id="7132884">f</span><span class="op" id="7132885">,</span>&nbsp;<span class="string" id="7132887">&#34;T.f3&#34;</span><span class="op" id="7132893">)</span>&nbsp;<span class="op" id="7132895">!=</span>&nbsp;<span class="ident" id="7132898">nil</span>&nbsp;<span class="op" id="7132902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7132906">t</span><span class="op" id="7132907">.</span><span class="ident" id="7132908">Error</span><span class="op" id="7132913">(</span><span class="string" id="7132914">&#34;not&nbsp;expected&nbsp;to&nbsp;find&nbsp;T.f3&#34;</span><span class="op" id="7132941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7132944">}</span><br>
<span class="lineno"></span><span class="op" id="7132946">}</span>
</div>
</body>
</html>
