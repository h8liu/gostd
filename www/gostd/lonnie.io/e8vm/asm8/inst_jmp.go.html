<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5095906">package</span>&nbsp;<span class="ident" id="5095914">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5095920">import</span>&nbsp;<span class="op" id="5095927">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5095930">&#34;lonnie.io/e8vm/lex8&#34;</span><br>
<span class="lineno">5</span><span class="op" id="5095952">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5095955">var</span>&nbsp;<span class="ident" id="5095959">opJmpMap</span>&nbsp;<span class="op" id="5095968">=</span>&nbsp;<span class="keyword" id="5095970">map</span><span class="op" id="5095973">[</span><span class="builtintype" id="5095974">string</span><span class="op" id="5095980">]</span><span class="builtintype" id="5095981">uint32</span><span class="op" id="5095987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5095990">&#34;j&#34;</span><span class="op" id="5095993">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="5095997">2</span><span class="op" id="5095998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5096001">&#34;jal&#34;</span><span class="op" id="5096006">:</span>&nbsp;<span class="num" id="5096008">3</span><span class="op" id="5096009">,</span><br>
<span class="lineno">10</span><span class="op" id="5096011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5096014">func</span>&nbsp;<span class="ident" id="5096019">isValidSymbol</span><span class="op" id="5096032">(</span><span class="ident" id="5096033">sym</span>&nbsp;<span class="builtintype" id="5096037">string</span><span class="op" id="5096043">)</span>&nbsp;<span class="builtintype" id="5096045">bool</span>&nbsp;<span class="op" id="5096050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096053">return</span>&nbsp;<span class="builtintype" id="5096060">true</span><br>
<span class="lineno"></span><span class="op" id="5096065">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="5096068">func</span>&nbsp;<span class="ident" id="5096073">parseInstJmp</span><span class="op" id="5096085">(</span><span class="ident" id="5096086">p</span>&nbsp;<span class="op" id="5096088">*</span><span class="ident" id="5096089">parser</span><span class="op" id="5096095">,</span>&nbsp;<span class="ident" id="5096097">ops</span>&nbsp;<span class="op" id="5096101">[</span><span class="op" id="5096102">]</span><span class="op" id="5096103">*</span><span class="ident" id="5096104">lex8</span><span class="op" id="5096108">.</span><span class="ident" id="5096109">Token</span><span class="op" id="5096114">)</span>&nbsp;<span class="op" id="5096116">(</span><span class="op" id="5096117">*</span><span class="ident" id="5096118">inst</span><span class="op" id="5096122">,</span>&nbsp;<span class="builtintype" id="5096124">bool</span><span class="op" id="5096128">)</span>&nbsp;<span class="op" id="5096130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096133">op0</span>&nbsp;<span class="op" id="5096137">:=</span>&nbsp;<span class="ident" id="5096140">ops</span><span class="op" id="5096143">[</span><span class="num" id="5096144">0</span><span class="op" id="5096145">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096148">opName</span>&nbsp;<span class="op" id="5096155">:=</span>&nbsp;<span class="ident" id="5096158">op0</span><span class="op" id="5096161">.</span><span class="ident" id="5096162">Lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096167">var</span>&nbsp;<span class="ident" id="5096171">op</span>&nbsp;<span class="builtintype" id="5096174">uint32</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5096183">//&nbsp;op&nbsp;sym</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096194">switch</span>&nbsp;<span class="ident" id="5096201">opName</span>&nbsp;<span class="op" id="5096208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096211">case</span>&nbsp;<span class="string" id="5096216">&#34;j&#34;</span><span class="op" id="5096219">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096223">op</span>&nbsp;<span class="op" id="5096226">=</span>&nbsp;<span class="num" id="5096228">2</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096231">case</span>&nbsp;<span class="string" id="5096236">&#34;jal&#34;</span><span class="op" id="5096241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096245">op</span>&nbsp;<span class="op" id="5096248">=</span>&nbsp;<span class="num" id="5096250">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096253">default</span><span class="op" id="5096260">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096264">return</span>&nbsp;<span class="ident" id="5096271">nil</span><span class="op" id="5096274">,</span>&nbsp;<span class="builtintype" id="5096276">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5096283">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096287">var</span>&nbsp;<span class="ident" id="5096291">pack</span><span class="op" id="5096295">,</span>&nbsp;<span class="ident" id="5096297">sym</span>&nbsp;<span class="builtintype" id="5096301">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096309">var</span>&nbsp;<span class="ident" id="5096313">fill</span>&nbsp;<span class="builtintype" id="5096318">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096323">var</span>&nbsp;<span class="ident" id="5096327">symTok</span>&nbsp;<span class="op" id="5096334">*</span><span class="ident" id="5096335">lex8</span><span class="op" id="5096339">.</span><span class="ident" id="5096340">Token</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096348">if</span>&nbsp;<span class="ident" id="5096351">argCount</span><span class="op" id="5096359">(</span><span class="ident" id="5096360">p</span><span class="op" id="5096361">,</span>&nbsp;<span class="ident" id="5096363">ops</span><span class="op" id="5096366">,</span>&nbsp;<span class="num" id="5096368">1</span><span class="op" id="5096369">)</span>&nbsp;<span class="op" id="5096371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096375">symTok</span>&nbsp;<span class="op" id="5096382">=</span>&nbsp;<span class="ident" id="5096384">ops</span><span class="op" id="5096387">[</span><span class="num" id="5096388">1</span><span class="op" id="5096389">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096393">if</span>&nbsp;<span class="ident" id="5096396">parseLabel</span><span class="op" id="5096406">(</span><span class="ident" id="5096407">p</span><span class="op" id="5096408">,</span>&nbsp;<span class="ident" id="5096410">ops</span><span class="op" id="5096413">[</span><span class="num" id="5096414">1</span><span class="op" id="5096415">]</span><span class="op" id="5096416">)</span>&nbsp;<span class="op" id="5096418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096423">sym</span>&nbsp;<span class="op" id="5096427">=</span>&nbsp;<span class="ident" id="5096429">ops</span><span class="op" id="5096432">[</span><span class="num" id="5096433">1</span><span class="op" id="5096434">]</span><span class="op" id="5096435">.</span><span class="ident" id="5096436">Lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096443">fill</span>&nbsp;<span class="op" id="5096448">=</span>&nbsp;<span class="ident" id="5096450">fillLabel</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5096462">}</span>&nbsp;<span class="keyword" id="5096464">else</span>&nbsp;<span class="op" id="5096469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096474">pack</span><span class="op" id="5096478">,</span>&nbsp;<span class="ident" id="5096480">sym</span>&nbsp;<span class="op" id="5096484">=</span>&nbsp;<span class="ident" id="5096486">parseSym</span><span class="op" id="5096494">(</span><span class="ident" id="5096495">p</span><span class="op" id="5096496">,</span>&nbsp;<span class="ident" id="5096498">ops</span><span class="op" id="5096501">[</span><span class="num" id="5096502">1</span><span class="op" id="5096503">]</span><span class="op" id="5096504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096509">fill</span>&nbsp;<span class="op" id="5096514">=</span>&nbsp;<span class="ident" id="5096516">fillLink</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5096527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5096530">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096534">ret</span>&nbsp;<span class="op" id="5096538">:=</span>&nbsp;<span class="op" id="5096541">&amp;</span><span class="ident" id="5096542">inst</span><span class="op" id="5096546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096550">inst</span><span class="op" id="5096554">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5096558">(</span><span class="ident" id="5096559">op</span>&nbsp;<span class="op" id="5096562">&amp;</span>&nbsp;<span class="num" id="5096564">0x3</span><span class="op" id="5096567">)</span>&nbsp;<span class="op" id="5096569">&lt;&lt;</span>&nbsp;<span class="num" id="5096572">30</span><span class="op" id="5096574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096578">pack</span><span class="op" id="5096582">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5096586">pack</span><span class="op" id="5096590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096594">symbol</span><span class="op" id="5096600">:</span>&nbsp;<span class="ident" id="5096602">sym</span><span class="op" id="5096605">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096609">fill</span><span class="op" id="5096613">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5096617">fill</span><span class="op" id="5096621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096625">symTok</span><span class="op" id="5096631">:</span>&nbsp;<span class="ident" id="5096633">symTok</span><span class="op" id="5096639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5096642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096645">return</span>&nbsp;<span class="ident" id="5096652">ret</span><span class="op" id="5096655">,</span>&nbsp;<span class="builtintype" id="5096657">true</span><br>
<span class="lineno"></span><span class="op" id="5096662">}</span>
</div>
</body>
</html>
