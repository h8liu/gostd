<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2872388">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2872443">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2872497">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2872548">//&nbsp;Package&nbsp;big&nbsp;implements&nbsp;multi-precision&nbsp;arithmetic&nbsp;(big&nbsp;numbers).</span><br>
<span class="lineno"></span><span class="comment" id="2872616">//&nbsp;The&nbsp;following&nbsp;numeric&nbsp;types&nbsp;are&nbsp;supported:</span><br>
<span class="lineno"></span><span class="comment" id="2872662">//</span><br>
<span class="lineno"></span><span class="comment" id="2872665">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;Int&nbsp;&nbsp;&nbsp;&nbspsigned&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="2872690">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;Rat&nbsp;&nbsp;&nbsp;&nbsprational&nbsp;numbers</span><br>
<span class="lineno">10</span><span class="comment" id="2872716">//</span><br>
<span class="lineno"></span><span class="comment" id="2872719">//&nbsp;Methods&nbsp;are&nbsp;typically&nbsp;of&nbsp;the&nbsp;form:</span><br>
<span class="lineno"></span><span class="comment" id="2872757">//</span><br>
<span class="lineno"></span><span class="comment" id="2872760">//&nbsp;&nbsp;&nbsp;&nbspfunc&nbsp;(z&nbsp;*Int)&nbsp;Op(x,&nbsp;y&nbsp;*Int)&nbsp;*Int&nbsp;&nbsp;&nbsp;&nbsp(similar&nbsp;for&nbsp;*Rat)</span><br>
<span class="lineno"></span><span class="comment" id="2872815">//</span><br>
<span class="lineno">15</span><span class="comment" id="2872818">//&nbsp;and&nbsp;implement&nbsp;operations&nbsp;z&nbsp;=&nbsp;x&nbsp;Op&nbsp;y&nbsp;with&nbsp;the&nbsp;result&nbsp;as&nbsp;receiver;&nbsp;if&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="2872892">//&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;operands&nbsp;it&nbsp;may&nbsp;be&nbsp;overwritten&nbsp;(and&nbsp;its&nbsp;memory&nbsp;reused).</span><br>
<span class="lineno"></span><span class="comment" id="2872965">//&nbsp;To&nbsp;enable&nbsp;chaining&nbsp;of&nbsp;operations,&nbsp;the&nbsp;result&nbsp;is&nbsp;also&nbsp;returned.&nbsp;Methods</span><br>
<span class="lineno"></span><span class="comment" id="2873039">//&nbsp;returning&nbsp;a&nbsp;result&nbsp;other&nbsp;than&nbsp;*Int&nbsp;or&nbsp;*Rat&nbsp;take&nbsp;one&nbsp;of&nbsp;the&nbsp;operands&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2873113">//&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno">20</span><span class="comment" id="2873130">//</span><br>
<span class="lineno"></span><span class="keyword" id="2873133">package</span>&nbsp;<span class="ident" id="2873141">big</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2873146">//&nbsp;This&nbsp;file&nbsp;contains&nbsp;operations&nbsp;on&nbsp;unsigned&nbsp;multi-precision&nbsp;integers.</span><br>
<span class="lineno"></span><span class="comment" id="2873217">//&nbsp;These&nbsp;are&nbsp;the&nbsp;building&nbsp;blocks&nbsp;for&nbsp;the&nbsp;operations&nbsp;on&nbsp;signed&nbsp;integers</span><br>
<span class="lineno">25</span><span class="comment" id="2873288">//&nbsp;and&nbsp;rationals.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2873307">import</span>&nbsp;<span class="op" id="2873314">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2873317">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2873327">&#34;io&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2873333">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2873341">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2873354">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="2873361">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="2873364">//&nbsp;An&nbsp;unsigned&nbsp;integer&nbsp;x&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span><span class="comment" id="2873401">//</span><br>
<span class="lineno"></span><span class="comment" id="2873404">//&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;x[n-1]*_B^(n-1)&nbsp;+&nbsp;x[n-2]*_B^(n-2)&nbsp;+&nbsp;...&nbsp;+&nbsp;x[1]*_B&nbsp;+&nbsp;x[0]</span><br>
<span class="lineno"></span><span class="comment" id="2873470">//</span><br>
<span class="lineno"></span><span class="comment" id="2873473">//&nbsp;with&nbsp;0&nbsp;&lt;=&nbsp;x[i]&nbsp;&lt;&nbsp;_B&nbsp;and&nbsp;0&nbsp;&lt;=&nbsp;i&nbsp;&lt;&nbsp;n&nbsp;is&nbsp;stored&nbsp;in&nbsp;a&nbsp;slice&nbsp;of&nbsp;length&nbsp;n,</span><br>
<span class="lineno">40</span><span class="comment" id="2873545">//&nbsp;with&nbsp;the&nbsp;digits&nbsp;x[i]&nbsp;as&nbsp;the&nbsp;slice&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="2873592">//</span><br>
<span class="lineno"></span><span class="comment" id="2873595">//&nbsp;A&nbsp;number&nbsp;is&nbsp;normalized&nbsp;if&nbsp;the&nbsp;slice&nbsp;contains&nbsp;no&nbsp;leading&nbsp;0&nbsp;digits.</span><br>
<span class="lineno"></span><span class="comment" id="2873664">//&nbsp;During&nbsp;arithmetic&nbsp;operations,&nbsp;denormalized&nbsp;values&nbsp;may&nbsp;occur&nbsp;but&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2873735">//&nbsp;always&nbsp;normalized&nbsp;before&nbsp;returning&nbsp;the&nbsp;final&nbsp;result.&nbsp;The&nbsp;normalized</span><br>
<span class="lineno">45</span><span class="comment" id="2873806">//&nbsp;representation&nbsp;of&nbsp;0&nbsp;is&nbsp;the&nbsp;empty&nbsp;or&nbsp;nil&nbsp;slice&nbsp;(length&nbsp;=&nbsp;0).</span><br>
<span class="lineno"></span><span class="comment" id="2873869">//</span><br>
<span class="lineno"></span><span class="keyword" id="2873872">type</span>&nbsp;<span class="ident" id="2873877">nat</span>&nbsp;<span class="op" id="2873881">[</span><span class="op" id="2873882">]</span><span class="ident" id="2873883"><a href="/math/big/arith.go.html#2842733">Word</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2873889">var</span>&nbsp;<span class="op" id="2873893">(</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2873896">natOne</span>&nbsp;<span class="op" id="2873903">=</span>&nbsp;<span class="ident" id="2873905"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2873908">{</span><span class="num" id="2873909">1</span><span class="op" id="2873910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2873913">natTwo</span>&nbsp;<span class="op" id="2873920">=</span>&nbsp;<span class="ident" id="2873922"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2873925">{</span><span class="num" id="2873926">2</span><span class="op" id="2873927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2873930">natTen</span>&nbsp;<span class="op" id="2873937">=</span>&nbsp;<span class="ident" id="2873939"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2873942">{</span><span class="num" id="2873943">10</span><span class="op" id="2873945">}</span><br>
<span class="lineno"></span><span class="op" id="2873947">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="2873950">func</span>&nbsp;<span class="op" id="2873955">(</span><span class="ident" id="2873956">z</span>&nbsp;<span class="ident" id="2873958"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2873961">)</span>&nbsp;<span class="ident" id="2873963">clear</span><span class="op" id="2873968">(</span><span class="op" id="2873969">)</span>&nbsp;<span class="op" id="2873971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2873974">for</span>&nbsp;<span class="ident" id="2873978">i</span>&nbsp;<span class="op" id="2873980">:=</span>&nbsp;<span class="keyword" id="2873983">range</span>&nbsp;<span class="ident" id="2873989"><a href="/math/big/nat.go.html#2873956">z</a></span>&nbsp;<span class="op" id="2873991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2873995"><a href="/math/big/nat.go.html#2873956">z</a></span><span class="op" id="2873996">[</span><span class="ident" id="2873997"><a href="/math/big/nat.go.html#2873978">i</a></span><span class="op" id="2873998">]</span>&nbsp;<span class="op" id="2874000">=</span>&nbsp;<span class="num" id="2874002">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2874005">}</span><br>
<span class="lineno"></span><span class="op" id="2874007">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="2874010">func</span>&nbsp;<span class="op" id="2874015">(</span><span class="ident" id="2874016">z</span>&nbsp;<span class="ident" id="2874018"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2874021">)</span>&nbsp;<span class="ident" id="2874023">norm</span><span class="op" id="2874027">(</span><span class="op" id="2874028">)</span>&nbsp;<span class="ident" id="2874030"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2874034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2874037">i</span>&nbsp;<span class="op" id="2874039">:=</span>&nbsp;<span class="builtinfunc" id="2874042">len</span><span class="op" id="2874045">(</span><span class="ident" id="2874046"><a href="/math/big/nat.go.html#2874016">z</a></span><span class="op" id="2874047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874050">for</span>&nbsp;<span class="ident" id="2874054"><a href="/math/big/nat.go.html#2874037">i</a></span>&nbsp;<span class="op" id="2874056">&gt;</span>&nbsp;<span class="num" id="2874058">0</span>&nbsp;<span class="op" id="2874060">&amp;&amp;</span>&nbsp;<span class="ident" id="2874063"><a href="/math/big/nat.go.html#2874016">z</a></span><span class="op" id="2874064">[</span><span class="ident" id="2874065"><a href="/math/big/nat.go.html#2874037">i</a></span><span class="op" id="2874066">-</span><span class="num" id="2874067">1</span><span class="op" id="2874068">]</span>&nbsp;<span class="op" id="2874070">==</span>&nbsp;<span class="num" id="2874073">0</span>&nbsp;<span class="op" id="2874075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2874079"><a href="/math/big/nat.go.html#2874037">i</a></span><span class="op" id="2874080">--</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2874084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874087">return</span>&nbsp;<span class="ident" id="2874094"><a href="/math/big/nat.go.html#2874016">z</a></span><span class="op" id="2874095">[</span><span class="num" id="2874096">0</span><span class="op" id="2874097">:</span><span class="ident" id="2874098"><a href="/math/big/nat.go.html#2874037">i</a></span><span class="op" id="2874099">]</span><br>
<span class="lineno"></span><span class="op" id="2874101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2874104">func</span>&nbsp;<span class="op" id="2874109">(</span><span class="ident" id="2874110">z</span>&nbsp;<span class="ident" id="2874112"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2874115">)</span>&nbsp;<span class="builtinfunc" id="2874117">make</span><span class="op" id="2874121">(</span><span class="ident" id="2874122">n</span>&nbsp;<span class="builtintype" id="2874124">int</span><span class="op" id="2874127">)</span>&nbsp;<span class="ident" id="2874129"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2874133">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874136">if</span>&nbsp;<span class="ident" id="2874139"><a href="/math/big/nat.go.html#2874122">n</a></span>&nbsp;<span class="op" id="2874141">&lt;=</span>&nbsp;<span class="builtinfunc" id="2874144">cap</span><span class="op" id="2874147">(</span><span class="ident" id="2874148"><a href="/math/big/nat.go.html#2874110">z</a></span><span class="op" id="2874149">)</span>&nbsp;<span class="op" id="2874151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874155">return</span>&nbsp;<span class="ident" id="2874162"><a href="/math/big/nat.go.html#2874110">z</a></span><span class="op" id="2874163">[</span><span class="num" id="2874164">0</span><span class="op" id="2874165">:</span><span class="ident" id="2874166"><a href="/math/big/nat.go.html#2874122">n</a></span><span class="op" id="2874167">]</span>&nbsp;<span class="comment" id="2874169">//&nbsp;reuse&nbsp;z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2874181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2874184">//&nbsp;Choosing&nbsp;a&nbsp;good&nbsp;value&nbsp;for&nbsp;e&nbsp;has&nbsp;significant&nbsp;performance&nbsp;impact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2874251">//&nbsp;because&nbsp;it&nbsp;increases&nbsp;the&nbsp;chance&nbsp;that&nbsp;a&nbsp;value&nbsp;can&nbsp;be&nbsp;reused.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874315">const</span>&nbsp;<span class="ident" id="2874321">e</span>&nbsp;<span class="op" id="2874323">=</span>&nbsp;<span class="num" id="2874325">4</span>&nbsp;<span class="comment" id="2874327">//&nbsp;extra&nbsp;capacity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874346">return</span>&nbsp;<span class="builtinfunc" id="2874353">make</span><span class="op" id="2874357">(</span><span class="ident" id="2874358"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2874361">,</span>&nbsp;<span class="ident" id="2874363"><a href="/math/big/nat.go.html#2874122">n</a></span><span class="op" id="2874364">,</span>&nbsp;<span class="ident" id="2874366"><a href="/math/big/nat.go.html#2874122">n</a></span><span class="op" id="2874367">+</span><span class="ident" id="2874368"><a href="/math/big/nat.go.html#2874321">e</a></span><span class="op" id="2874369">)</span><br>
<span class="lineno"></span><span class="op" id="2874371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2874374">func</span>&nbsp;<span class="op" id="2874379">(</span><span class="ident" id="2874380">z</span>&nbsp;<span class="ident" id="2874382"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2874385">)</span>&nbsp;<span class="ident" id="2874387">setWord</span><span class="op" id="2874394">(</span><span class="ident" id="2874395">x</span>&nbsp;<span class="ident" id="2874397"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2874401">)</span>&nbsp;<span class="ident" id="2874403"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2874407">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874410">if</span>&nbsp;<span class="ident" id="2874413"><a href="/math/big/nat.go.html#2874395">x</a></span>&nbsp;<span class="op" id="2874415">==</span>&nbsp;<span class="num" id="2874418">0</span>&nbsp;<span class="op" id="2874420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874424">return</span>&nbsp;<span class="ident" id="2874431"><a href="/math/big/nat.go.html#2874380">z</a></span><span class="op" id="2874432">.</span><span class="builtinfunc" id="2874433">make</span><span class="op" id="2874437">(</span><span class="num" id="2874438">0</span><span class="op" id="2874439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2874442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2874445"><a href="/math/big/nat.go.html#2874380">z</a></span>&nbsp;<span class="op" id="2874447">=</span>&nbsp;<span class="ident" id="2874449"><a href="/math/big/nat.go.html#2874380">z</a></span><span class="op" id="2874450">.</span><span class="builtinfunc" id="2874451">make</span><span class="op" id="2874455">(</span><span class="num" id="2874456">1</span><span class="op" id="2874457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2874460"><a href="/math/big/nat.go.html#2874380">z</a></span><span class="op" id="2874461">[</span><span class="num" id="2874462">0</span><span class="op" id="2874463">]</span>&nbsp;<span class="op" id="2874465">=</span>&nbsp;<span class="ident" id="2874467"><a href="/math/big/nat.go.html#2874395">x</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874470">return</span>&nbsp;<span class="ident" id="2874477"><a href="/math/big/nat.go.html#2874380">z</a></span><br>
<span class="lineno"></span><span class="op" id="2874479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2874482">func</span>&nbsp;<span class="op" id="2874487">(</span><span class="ident" id="2874488">z</span>&nbsp;<span class="ident" id="2874490"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2874493">)</span>&nbsp;<span class="ident" id="2874495">setUint64</span><span class="op" id="2874504">(</span><span class="ident" id="2874505">x</span>&nbsp;<span class="ident" id="2874507">uint64</span><span class="op" id="2874513">)</span>&nbsp;<span class="ident" id="2874515"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2874519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2874522">//&nbsp;single-digit&nbsp;values</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874546">if</span>&nbsp;<span class="ident" id="2874549">w</span>&nbsp;<span class="op" id="2874551">:=</span>&nbsp;<span class="ident" id="2874554"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2874558">(</span><span class="ident" id="2874559"><a href="/math/big/nat.go.html#2874505">x</a></span><span class="op" id="2874560">)</span><span class="op" id="2874561">;</span>&nbsp;<span class="ident" id="2874563">uint64</span><span class="op" id="2874569">(</span><span class="ident" id="2874570"><a href="/math/big/nat.go.html#2874549">w</a></span><span class="op" id="2874571">)</span>&nbsp;<span class="op" id="2874573">==</span>&nbsp;<span class="ident" id="2874576"><a href="/math/big/nat.go.html#2874505">x</a></span>&nbsp;<span class="op" id="2874578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874582">return</span>&nbsp;<span class="ident" id="2874589"><a href="/math/big/nat.go.html#2874488">z</a></span><span class="op" id="2874590">.</span><span class="ident" id="2874591">setWord</span><span class="op" id="2874598">(</span><span class="ident" id="2874599"><a href="/math/big/nat.go.html#2874549">w</a></span><span class="op" id="2874600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2874603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2874607">//&nbsp;compute&nbsp;number&nbsp;of&nbsp;words&nbsp;n&nbsp;required&nbsp;to&nbsp;represent&nbsp;x</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2874661">n</span>&nbsp;<span class="op" id="2874663">:=</span>&nbsp;<span class="num" id="2874666">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874669">for</span>&nbsp;<span class="ident" id="2874673">t</span>&nbsp;<span class="op" id="2874675">:=</span>&nbsp;<span class="ident" id="2874678"><a href="/math/big/nat.go.html#2874505">x</a></span><span class="op" id="2874679">;</span>&nbsp;<span class="ident" id="2874681"><a href="/math/big/nat.go.html#2874673">t</a></span>&nbsp;<span class="op" id="2874683">&gt;</span>&nbsp;<span class="num" id="2874685">0</span><span class="op" id="2874686">;</span>&nbsp;<span class="ident" id="2874688"><a href="/math/big/nat.go.html#2874673">t</a></span>&nbsp;<span class="op" id="2874690">&gt;&gt;=</span>&nbsp;<span class="ident" id="2874694"><a href="/math/big/arith.go.html#2842878">_W</a></span>&nbsp;<span class="op" id="2874697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2874701"><a href="/math/big/nat.go.html#2874661">n</a></span><span class="op" id="2874702">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2874706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2874710">//&nbsp;split&nbsp;x&nbsp;into&nbsp;n&nbsp;words</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2874735"><a href="/math/big/nat.go.html#2874488">z</a></span>&nbsp;<span class="op" id="2874737">=</span>&nbsp;<span class="ident" id="2874739"><a href="/math/big/nat.go.html#2874488">z</a></span><span class="op" id="2874740">.</span><span class="builtinfunc" id="2874741">make</span><span class="op" id="2874745">(</span><span class="ident" id="2874746"><a href="/math/big/nat.go.html#2874661">n</a></span><span class="op" id="2874747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874750">for</span>&nbsp;<span class="ident" id="2874754">i</span>&nbsp;<span class="op" id="2874756">:=</span>&nbsp;<span class="keyword" id="2874759">range</span>&nbsp;<span class="ident" id="2874765"><a href="/math/big/nat.go.html#2874488">z</a></span>&nbsp;<span class="op" id="2874767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2874771"><a href="/math/big/nat.go.html#2874488">z</a></span><span class="op" id="2874772">[</span><span class="ident" id="2874773"><a href="/math/big/nat.go.html#2874754">i</a></span><span class="op" id="2874774">]</span>&nbsp;<span class="op" id="2874776">=</span>&nbsp;<span class="ident" id="2874778"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2874782">(</span><span class="ident" id="2874783"><a href="/math/big/nat.go.html#2874505">x</a></span>&nbsp;<span class="op" id="2874785">&amp;</span>&nbsp;<span class="ident" id="2874787"><a href="/math/big/arith.go.html#2842941">_M</a></span><span class="op" id="2874789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2874793"><a href="/math/big/nat.go.html#2874505">x</a></span>&nbsp;<span class="op" id="2874795">&gt;&gt;=</span>&nbsp;<span class="ident" id="2874799"><a href="/math/big/arith.go.html#2842878">_W</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2874803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874807">return</span>&nbsp;<span class="ident" id="2874814"><a href="/math/big/nat.go.html#2874488">z</a></span><br>
<span class="lineno"></span><span class="op" id="2874816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="2874819">func</span>&nbsp;<span class="op" id="2874824">(</span><span class="ident" id="2874825">z</span>&nbsp;<span class="ident" id="2874827"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2874830">)</span>&nbsp;<span class="ident" id="2874832">set</span><span class="op" id="2874835">(</span><span class="ident" id="2874836">x</span>&nbsp;<span class="ident" id="2874838"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2874841">)</span>&nbsp;<span class="ident" id="2874843"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2874847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2874850"><a href="/math/big/nat.go.html#2874825">z</a></span>&nbsp;<span class="op" id="2874852">=</span>&nbsp;<span class="ident" id="2874854"><a href="/math/big/nat.go.html#2874825">z</a></span><span class="op" id="2874855">.</span><span class="builtinfunc" id="2874856">make</span><span class="op" id="2874860">(</span><span class="builtinfunc" id="2874861">len</span><span class="op" id="2874864">(</span><span class="ident" id="2874865"><a href="/math/big/nat.go.html#2874836">x</a></span><span class="op" id="2874866">)</span><span class="op" id="2874867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2874870">copy</span><span class="op" id="2874874">(</span><span class="ident" id="2874875"><a href="/math/big/nat.go.html#2874825">z</a></span><span class="op" id="2874876">,</span>&nbsp;<span class="ident" id="2874878"><a href="/math/big/nat.go.html#2874836">x</a></span><span class="op" id="2874879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874882">return</span>&nbsp;<span class="ident" id="2874889"><a href="/math/big/nat.go.html#2874825">z</a></span><br>
<span class="lineno"></span><span class="op" id="2874891">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="2874894">func</span>&nbsp;<span class="op" id="2874899">(</span><span class="ident" id="2874900">z</span>&nbsp;<span class="ident" id="2874902"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2874905">)</span>&nbsp;<span class="ident" id="2874907">add</span><span class="op" id="2874910">(</span><span class="ident" id="2874911">x</span><span class="op" id="2874912">,</span>&nbsp;<span class="ident" id="2874914">y</span>&nbsp;<span class="ident" id="2874916"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2874919">)</span>&nbsp;<span class="ident" id="2874921"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2874925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2874928">m</span>&nbsp;<span class="op" id="2874930">:=</span>&nbsp;<span class="builtinfunc" id="2874933">len</span><span class="op" id="2874936">(</span><span class="ident" id="2874937"><a href="/math/big/nat.go.html#2874911">x</a></span><span class="op" id="2874938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2874941">n</span>&nbsp;<span class="op" id="2874943">:=</span>&nbsp;<span class="builtinfunc" id="2874946">len</span><span class="op" id="2874949">(</span><span class="ident" id="2874950"><a href="/math/big/nat.go.html#2874914">y</a></span><span class="op" id="2874951">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874955">switch</span>&nbsp;<span class="op" id="2874962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874965">case</span>&nbsp;<span class="ident" id="2874970"><a href="/math/big/nat.go.html#2874928">m</a></span>&nbsp;<span class="op" id="2874972">&lt;</span>&nbsp;<span class="ident" id="2874974"><a href="/math/big/nat.go.html#2874941">n</a></span><span class="op" id="2874975">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874979">return</span>&nbsp;<span class="ident" id="2874986"><a href="/math/big/nat.go.html#2874900">z</a></span><span class="op" id="2874987">.</span><span class="ident" id="2874988">add</span><span class="op" id="2874991">(</span><span class="ident" id="2874992"><a href="/math/big/nat.go.html#2874914">y</a></span><span class="op" id="2874993">,</span>&nbsp;<span class="ident" id="2874995"><a href="/math/big/nat.go.html#2874911">x</a></span><span class="op" id="2874996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2874999">case</span>&nbsp;<span class="ident" id="2875004"><a href="/math/big/nat.go.html#2874928">m</a></span>&nbsp;<span class="op" id="2875006">==</span>&nbsp;<span class="num" id="2875009">0</span><span class="op" id="2875010">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2875014">//&nbsp;n&nbsp;==&nbsp;0&nbsp;because&nbsp;m&nbsp;&gt;=&nbsp;n;&nbsp;result&nbsp;is&nbsp;0</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875054">return</span>&nbsp;<span class="ident" id="2875061"><a href="/math/big/nat.go.html#2874900">z</a></span><span class="op" id="2875062">.</span><span class="builtinfunc" id="2875063">make</span><span class="op" id="2875067">(</span><span class="num" id="2875068">0</span><span class="op" id="2875069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875072">case</span>&nbsp;<span class="ident" id="2875077"><a href="/math/big/nat.go.html#2874941">n</a></span>&nbsp;<span class="op" id="2875079">==</span>&nbsp;<span class="num" id="2875082">0</span><span class="op" id="2875083">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2875087">//&nbsp;result&nbsp;is&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875104">return</span>&nbsp;<span class="ident" id="2875111"><a href="/math/big/nat.go.html#2874900">z</a></span><span class="op" id="2875112">.</span><span class="ident" id="2875113">set</span><span class="op" id="2875116">(</span><span class="ident" id="2875117"><a href="/math/big/nat.go.html#2874911">x</a></span><span class="op" id="2875118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2875121">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2875124">//&nbsp;m&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875135"><a href="/math/big/nat.go.html#2874900">z</a></span>&nbsp;<span class="op" id="2875137">=</span>&nbsp;<span class="ident" id="2875139"><a href="/math/big/nat.go.html#2874900">z</a></span><span class="op" id="2875140">.</span><span class="builtinfunc" id="2875141">make</span><span class="op" id="2875145">(</span><span class="ident" id="2875146"><a href="/math/big/nat.go.html#2874928">m</a></span>&nbsp;<span class="op" id="2875148">+</span>&nbsp;<span class="num" id="2875150">1</span><span class="op" id="2875151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875154">c</span>&nbsp;<span class="op" id="2875156">:=</span>&nbsp;<span class="ident" id="2875159"><a href="/math/big/arith_decl.go.html#2846893">addVV</a></span><span class="op" id="2875164">(</span><span class="ident" id="2875165"><a href="/math/big/nat.go.html#2874900">z</a></span><span class="op" id="2875166">[</span><span class="num" id="2875167">0</span><span class="op" id="2875168">:</span><span class="ident" id="2875169"><a href="/math/big/nat.go.html#2874941">n</a></span><span class="op" id="2875170">]</span><span class="op" id="2875171">,</span>&nbsp;<span class="ident" id="2875173"><a href="/math/big/nat.go.html#2874911">x</a></span><span class="op" id="2875174">,</span>&nbsp;<span class="ident" id="2875176"><a href="/math/big/nat.go.html#2874914">y</a></span><span class="op" id="2875177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875180">if</span>&nbsp;<span class="ident" id="2875183"><a href="/math/big/nat.go.html#2874928">m</a></span>&nbsp;<span class="op" id="2875185">&gt;</span>&nbsp;<span class="ident" id="2875187"><a href="/math/big/nat.go.html#2874941">n</a></span>&nbsp;<span class="op" id="2875189">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875193"><a href="/math/big/nat.go.html#2875154">c</a></span>&nbsp;<span class="op" id="2875195">=</span>&nbsp;<span class="ident" id="2875197"><a href="/math/big/arith_decl.go.html#2846965">addVW</a></span><span class="op" id="2875202">(</span><span class="ident" id="2875203"><a href="/math/big/nat.go.html#2874900">z</a></span><span class="op" id="2875204">[</span><span class="ident" id="2875205"><a href="/math/big/nat.go.html#2874941">n</a></span><span class="op" id="2875206">:</span><span class="ident" id="2875207"><a href="/math/big/nat.go.html#2874928">m</a></span><span class="op" id="2875208">]</span><span class="op" id="2875209">,</span>&nbsp;<span class="ident" id="2875211"><a href="/math/big/nat.go.html#2874911">x</a></span><span class="op" id="2875212">[</span><span class="ident" id="2875213"><a href="/math/big/nat.go.html#2874941">n</a></span><span class="op" id="2875214">:</span><span class="op" id="2875215">]</span><span class="op" id="2875216">,</span>&nbsp;<span class="ident" id="2875218"><a href="/math/big/nat.go.html#2875154">c</a></span><span class="op" id="2875219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2875222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875225"><a href="/math/big/nat.go.html#2874900">z</a></span><span class="op" id="2875226">[</span><span class="ident" id="2875227"><a href="/math/big/nat.go.html#2874928">m</a></span><span class="op" id="2875228">]</span>&nbsp;<span class="op" id="2875230">=</span>&nbsp;<span class="ident" id="2875232"><a href="/math/big/nat.go.html#2875154">c</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875236">return</span>&nbsp;<span class="ident" id="2875243"><a href="/math/big/nat.go.html#2874900">z</a></span><span class="op" id="2875244">.</span><span class="ident" id="2875245">norm</span><span class="op" id="2875249">(</span><span class="op" id="2875250">)</span><br>
<span class="lineno">140</span><span class="op" id="2875252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2875255">func</span>&nbsp;<span class="op" id="2875260">(</span><span class="ident" id="2875261">z</span>&nbsp;<span class="ident" id="2875263"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2875266">)</span>&nbsp;<span class="ident" id="2875268">sub</span><span class="op" id="2875271">(</span><span class="ident" id="2875272">x</span><span class="op" id="2875273">,</span>&nbsp;<span class="ident" id="2875275">y</span>&nbsp;<span class="ident" id="2875277"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2875280">)</span>&nbsp;<span class="ident" id="2875282"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2875286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875289">m</span>&nbsp;<span class="op" id="2875291">:=</span>&nbsp;<span class="builtinfunc" id="2875294">len</span><span class="op" id="2875297">(</span><span class="ident" id="2875298"><a href="/math/big/nat.go.html#2875272">x</a></span><span class="op" id="2875299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875302">n</span>&nbsp;<span class="op" id="2875304">:=</span>&nbsp;<span class="builtinfunc" id="2875307">len</span><span class="op" id="2875310">(</span><span class="ident" id="2875311"><a href="/math/big/nat.go.html#2875275">y</a></span><span class="op" id="2875312">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875316">switch</span>&nbsp;<span class="op" id="2875323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875326">case</span>&nbsp;<span class="ident" id="2875331"><a href="/math/big/nat.go.html#2875289">m</a></span>&nbsp;<span class="op" id="2875333">&lt;</span>&nbsp;<span class="ident" id="2875335"><a href="/math/big/nat.go.html#2875302">n</a></span><span class="op" id="2875336">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2875340">panic</span><span class="op" id="2875345">(</span><span class="string" id="2875346">&#34;underflow&#34;</span><span class="op" id="2875357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875360">case</span>&nbsp;<span class="ident" id="2875365"><a href="/math/big/nat.go.html#2875289">m</a></span>&nbsp;<span class="op" id="2875367">==</span>&nbsp;<span class="num" id="2875370">0</span><span class="op" id="2875371">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2875375">//&nbsp;n&nbsp;==&nbsp;0&nbsp;because&nbsp;m&nbsp;&gt;=&nbsp;n;&nbsp;result&nbsp;is&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875415">return</span>&nbsp;<span class="ident" id="2875422"><a href="/math/big/nat.go.html#2875261">z</a></span><span class="op" id="2875423">.</span><span class="builtinfunc" id="2875424">make</span><span class="op" id="2875428">(</span><span class="num" id="2875429">0</span><span class="op" id="2875430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875433">case</span>&nbsp;<span class="ident" id="2875438"><a href="/math/big/nat.go.html#2875302">n</a></span>&nbsp;<span class="op" id="2875440">==</span>&nbsp;<span class="num" id="2875443">0</span><span class="op" id="2875444">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2875448">//&nbsp;result&nbsp;is&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875465">return</span>&nbsp;<span class="ident" id="2875472"><a href="/math/big/nat.go.html#2875261">z</a></span><span class="op" id="2875473">.</span><span class="ident" id="2875474">set</span><span class="op" id="2875477">(</span><span class="ident" id="2875478"><a href="/math/big/nat.go.html#2875272">x</a></span><span class="op" id="2875479">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2875482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2875485">//&nbsp;m&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875496"><a href="/math/big/nat.go.html#2875261">z</a></span>&nbsp;<span class="op" id="2875498">=</span>&nbsp;<span class="ident" id="2875500"><a href="/math/big/nat.go.html#2875261">z</a></span><span class="op" id="2875501">.</span><span class="builtinfunc" id="2875502">make</span><span class="op" id="2875506">(</span><span class="ident" id="2875507"><a href="/math/big/nat.go.html#2875289">m</a></span><span class="op" id="2875508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875511">c</span>&nbsp;<span class="op" id="2875513">:=</span>&nbsp;<span class="ident" id="2875516"><a href="/math/big/arith_decl.go.html#2846929">subVV</a></span><span class="op" id="2875521">(</span><span class="ident" id="2875522"><a href="/math/big/nat.go.html#2875261">z</a></span><span class="op" id="2875523">[</span><span class="num" id="2875524">0</span><span class="op" id="2875525">:</span><span class="ident" id="2875526"><a href="/math/big/nat.go.html#2875302">n</a></span><span class="op" id="2875527">]</span><span class="op" id="2875528">,</span>&nbsp;<span class="ident" id="2875530"><a href="/math/big/nat.go.html#2875272">x</a></span><span class="op" id="2875531">,</span>&nbsp;<span class="ident" id="2875533"><a href="/math/big/nat.go.html#2875275">y</a></span><span class="op" id="2875534">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875537">if</span>&nbsp;<span class="ident" id="2875540"><a href="/math/big/nat.go.html#2875289">m</a></span>&nbsp;<span class="op" id="2875542">&gt;</span>&nbsp;<span class="ident" id="2875544"><a href="/math/big/nat.go.html#2875302">n</a></span>&nbsp;<span class="op" id="2875546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875550"><a href="/math/big/nat.go.html#2875511">c</a></span>&nbsp;<span class="op" id="2875552">=</span>&nbsp;<span class="ident" id="2875554"><a href="/math/big/arith_decl.go.html#2847006">subVW</a></span><span class="op" id="2875559">(</span><span class="ident" id="2875560"><a href="/math/big/nat.go.html#2875261">z</a></span><span class="op" id="2875561">[</span><span class="ident" id="2875562"><a href="/math/big/nat.go.html#2875302">n</a></span><span class="op" id="2875563">:</span><span class="op" id="2875564">]</span><span class="op" id="2875565">,</span>&nbsp;<span class="ident" id="2875567"><a href="/math/big/nat.go.html#2875272">x</a></span><span class="op" id="2875568">[</span><span class="ident" id="2875569"><a href="/math/big/nat.go.html#2875302">n</a></span><span class="op" id="2875570">:</span><span class="op" id="2875571">]</span><span class="op" id="2875572">,</span>&nbsp;<span class="ident" id="2875574"><a href="/math/big/nat.go.html#2875511">c</a></span><span class="op" id="2875575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2875578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875581">if</span>&nbsp;<span class="ident" id="2875584"><a href="/math/big/nat.go.html#2875511">c</a></span>&nbsp;<span class="op" id="2875586">!=</span>&nbsp;<span class="num" id="2875589">0</span>&nbsp;<span class="op" id="2875591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2875595">panic</span><span class="op" id="2875600">(</span><span class="string" id="2875601">&#34;underflow&#34;</span><span class="op" id="2875612">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2875615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875619">return</span>&nbsp;<span class="ident" id="2875626"><a href="/math/big/nat.go.html#2875261">z</a></span><span class="op" id="2875627">.</span><span class="ident" id="2875628">norm</span><span class="op" id="2875632">(</span><span class="op" id="2875633">)</span><br>
<span class="lineno"></span><span class="op" id="2875635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="2875638">func</span>&nbsp;<span class="op" id="2875643">(</span><span class="ident" id="2875644">x</span>&nbsp;<span class="ident" id="2875646"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2875649">)</span>&nbsp;<span class="ident" id="2875651">cmp</span><span class="op" id="2875654">(</span><span class="ident" id="2875655">y</span>&nbsp;<span class="ident" id="2875657"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2875660">)</span>&nbsp;<span class="op" id="2875662">(</span><span class="ident" id="2875663">r</span>&nbsp;<span class="builtintype" id="2875665">int</span><span class="op" id="2875668">)</span>&nbsp;<span class="op" id="2875670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875673">m</span>&nbsp;<span class="op" id="2875675">:=</span>&nbsp;<span class="builtinfunc" id="2875678">len</span><span class="op" id="2875681">(</span><span class="ident" id="2875682"><a href="/math/big/nat.go.html#2875644">x</a></span><span class="op" id="2875683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875686">n</span>&nbsp;<span class="op" id="2875688">:=</span>&nbsp;<span class="builtinfunc" id="2875691">len</span><span class="op" id="2875694">(</span><span class="ident" id="2875695"><a href="/math/big/nat.go.html#2875655">y</a></span><span class="op" id="2875696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875699">if</span>&nbsp;<span class="ident" id="2875702"><a href="/math/big/nat.go.html#2875673">m</a></span>&nbsp;<span class="op" id="2875704">!=</span>&nbsp;<span class="ident" id="2875707"><a href="/math/big/nat.go.html#2875686">n</a></span>&nbsp;<span class="op" id="2875709">||</span>&nbsp;<span class="ident" id="2875712"><a href="/math/big/nat.go.html#2875673">m</a></span>&nbsp;<span class="op" id="2875714">==</span>&nbsp;<span class="num" id="2875717">0</span>&nbsp;<span class="op" id="2875719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875723">switch</span>&nbsp;<span class="op" id="2875730">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875734">case</span>&nbsp;<span class="ident" id="2875739"><a href="/math/big/nat.go.html#2875673">m</a></span>&nbsp;<span class="op" id="2875741">&lt;</span>&nbsp;<span class="ident" id="2875743"><a href="/math/big/nat.go.html#2875686">n</a></span><span class="op" id="2875744">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875749"><a href="/math/big/nat.go.html#2875663">r</a></span>&nbsp;<span class="op" id="2875751">=</span>&nbsp;<span class="op" id="2875753">-</span><span class="num" id="2875754">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875758">case</span>&nbsp;<span class="ident" id="2875763"><a href="/math/big/nat.go.html#2875673">m</a></span>&nbsp;<span class="op" id="2875765">&gt;</span>&nbsp;<span class="ident" id="2875767"><a href="/math/big/nat.go.html#2875686">n</a></span><span class="op" id="2875768">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875773"><a href="/math/big/nat.go.html#2875663">r</a></span>&nbsp;<span class="op" id="2875775">=</span>&nbsp;<span class="num" id="2875777">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2875781">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875785">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2875793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875797">i</span>&nbsp;<span class="op" id="2875799">:=</span>&nbsp;<span class="ident" id="2875802"><a href="/math/big/nat.go.html#2875673">m</a></span>&nbsp;<span class="op" id="2875804">-</span>&nbsp;<span class="num" id="2875806">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875809">for</span>&nbsp;<span class="ident" id="2875813"><a href="/math/big/nat.go.html#2875797">i</a></span>&nbsp;<span class="op" id="2875815">&gt;</span>&nbsp;<span class="num" id="2875817">0</span>&nbsp;<span class="op" id="2875819">&amp;&amp;</span>&nbsp;<span class="ident" id="2875822"><a href="/math/big/nat.go.html#2875644">x</a></span><span class="op" id="2875823">[</span><span class="ident" id="2875824"><a href="/math/big/nat.go.html#2875797">i</a></span><span class="op" id="2875825">]</span>&nbsp;<span class="op" id="2875827">==</span>&nbsp;<span class="ident" id="2875830"><a href="/math/big/nat.go.html#2875655">y</a></span><span class="op" id="2875831">[</span><span class="ident" id="2875832"><a href="/math/big/nat.go.html#2875797">i</a></span><span class="op" id="2875833">]</span>&nbsp;<span class="op" id="2875835">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875839"><a href="/math/big/nat.go.html#2875797">i</a></span><span class="op" id="2875840">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2875844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875848">switch</span>&nbsp;<span class="op" id="2875855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875858">case</span>&nbsp;<span class="ident" id="2875863"><a href="/math/big/nat.go.html#2875644">x</a></span><span class="op" id="2875864">[</span><span class="ident" id="2875865"><a href="/math/big/nat.go.html#2875797">i</a></span><span class="op" id="2875866">]</span>&nbsp;<span class="op" id="2875868">&lt;</span>&nbsp;<span class="ident" id="2875870"><a href="/math/big/nat.go.html#2875655">y</a></span><span class="op" id="2875871">[</span><span class="ident" id="2875872"><a href="/math/big/nat.go.html#2875797">i</a></span><span class="op" id="2875873">]</span><span class="op" id="2875874">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875878"><a href="/math/big/nat.go.html#2875663">r</a></span>&nbsp;<span class="op" id="2875880">=</span>&nbsp;<span class="op" id="2875882">-</span><span class="num" id="2875883">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875886">case</span>&nbsp;<span class="ident" id="2875891"><a href="/math/big/nat.go.html#2875644">x</a></span><span class="op" id="2875892">[</span><span class="ident" id="2875893"><a href="/math/big/nat.go.html#2875797">i</a></span><span class="op" id="2875894">]</span>&nbsp;<span class="op" id="2875896">&gt;</span>&nbsp;<span class="ident" id="2875898"><a href="/math/big/nat.go.html#2875655">y</a></span><span class="op" id="2875899">[</span><span class="ident" id="2875900"><a href="/math/big/nat.go.html#2875797">i</a></span><span class="op" id="2875901">]</span><span class="op" id="2875902">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875906"><a href="/math/big/nat.go.html#2875663">r</a></span>&nbsp;<span class="op" id="2875908">=</span>&nbsp;<span class="num" id="2875910">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2875913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875916">return</span><br>
<span class="lineno">195</span><span class="op" id="2875923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2875926">func</span>&nbsp;<span class="op" id="2875931">(</span><span class="ident" id="2875932">z</span>&nbsp;<span class="ident" id="2875934"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2875937">)</span>&nbsp;<span class="ident" id="2875939">mulAddWW</span><span class="op" id="2875947">(</span><span class="ident" id="2875948">x</span>&nbsp;<span class="ident" id="2875950"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2875953">,</span>&nbsp;<span class="ident" id="2875955">y</span><span class="op" id="2875956">,</span>&nbsp;<span class="ident" id="2875958">r</span>&nbsp;<span class="ident" id="2875960"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2875964">)</span>&nbsp;<span class="ident" id="2875966"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2875970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2875973">m</span>&nbsp;<span class="op" id="2875975">:=</span>&nbsp;<span class="builtinfunc" id="2875978">len</span><span class="op" id="2875981">(</span><span class="ident" id="2875982"><a href="/math/big/nat.go.html#2875948">x</a></span><span class="op" id="2875983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2875986">if</span>&nbsp;<span class="ident" id="2875989"><a href="/math/big/nat.go.html#2875973">m</a></span>&nbsp;<span class="op" id="2875991">==</span>&nbsp;<span class="num" id="2875994">0</span>&nbsp;<span class="op" id="2875996">||</span>&nbsp;<span class="ident" id="2875999"><a href="/math/big/nat.go.html#2875955">y</a></span>&nbsp;<span class="op" id="2876001">==</span>&nbsp;<span class="num" id="2876004">0</span>&nbsp;<span class="op" id="2876006">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2876010">return</span>&nbsp;<span class="ident" id="2876017"><a href="/math/big/nat.go.html#2875932">z</a></span><span class="op" id="2876018">.</span><span class="ident" id="2876019">setWord</span><span class="op" id="2876026">(</span><span class="ident" id="2876027"><a href="/math/big/nat.go.html#2875958">r</a></span><span class="op" id="2876028">)</span>&nbsp;<span class="comment" id="2876030">//&nbsp;result&nbsp;is&nbsp;r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2876046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2876049">//&nbsp;m&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2876060"><a href="/math/big/nat.go.html#2875932">z</a></span>&nbsp;<span class="op" id="2876062">=</span>&nbsp;<span class="ident" id="2876064"><a href="/math/big/nat.go.html#2875932">z</a></span><span class="op" id="2876065">.</span><span class="builtinfunc" id="2876066">make</span><span class="op" id="2876070">(</span><span class="ident" id="2876071"><a href="/math/big/nat.go.html#2875973">m</a></span>&nbsp;<span class="op" id="2876073">+</span>&nbsp;<span class="num" id="2876075">1</span><span class="op" id="2876076">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2876079"><a href="/math/big/nat.go.html#2875932">z</a></span><span class="op" id="2876080">[</span><span class="ident" id="2876081"><a href="/math/big/nat.go.html#2875973">m</a></span><span class="op" id="2876082">]</span>&nbsp;<span class="op" id="2876084">=</span>&nbsp;<span class="ident" id="2876086"><a href="/math/big/arith_decl.go.html#2847129">mulAddVWW</a></span><span class="op" id="2876095">(</span><span class="ident" id="2876096"><a href="/math/big/nat.go.html#2875932">z</a></span><span class="op" id="2876097">[</span><span class="num" id="2876098">0</span><span class="op" id="2876099">:</span><span class="ident" id="2876100"><a href="/math/big/nat.go.html#2875973">m</a></span><span class="op" id="2876101">]</span><span class="op" id="2876102">,</span>&nbsp;<span class="ident" id="2876104"><a href="/math/big/nat.go.html#2875948">x</a></span><span class="op" id="2876105">,</span>&nbsp;<span class="ident" id="2876107"><a href="/math/big/nat.go.html#2875955">y</a></span><span class="op" id="2876108">,</span>&nbsp;<span class="ident" id="2876110"><a href="/math/big/nat.go.html#2875958">r</a></span><span class="op" id="2876111">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2876115">return</span>&nbsp;<span class="ident" id="2876122"><a href="/math/big/nat.go.html#2875932">z</a></span><span class="op" id="2876123">.</span><span class="ident" id="2876124">norm</span><span class="op" id="2876128">(</span><span class="op" id="2876129">)</span><br>
<span class="lineno"></span><span class="op" id="2876131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="comment" id="2876134">//&nbsp;basicMul&nbsp;multiplies&nbsp;x&nbsp;and&nbsp;y&nbsp;and&nbsp;leaves&nbsp;the&nbsp;result&nbsp;in&nbsp;z.</span><br>
<span class="lineno"></span><span class="comment" id="2876193">//&nbsp;The&nbsp;(non-normalized)&nbsp;result&nbsp;is&nbsp;placed&nbsp;in&nbsp;z[0&nbsp;:&nbsp;len(x)&nbsp;+&nbsp;len(y)].</span><br>
<span class="lineno"></span><span class="keyword" id="2876261">func</span>&nbsp;<span class="ident" id="2876266">basicMul</span><span class="op" id="2876274">(</span><span class="ident" id="2876275">z</span><span class="op" id="2876276">,</span>&nbsp;<span class="ident" id="2876278">x</span><span class="op" id="2876279">,</span>&nbsp;<span class="ident" id="2876281">y</span>&nbsp;<span class="ident" id="2876283"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2876286">)</span>&nbsp;<span class="op" id="2876288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2876291"><a href="/math/big/nat.go.html#2876275">z</a></span><span class="op" id="2876292">[</span><span class="num" id="2876293">0</span>&nbsp;<span class="op" id="2876295">:</span>&nbsp;<span class="builtinfunc" id="2876297">len</span><span class="op" id="2876300">(</span><span class="ident" id="2876301"><a href="/math/big/nat.go.html#2876278">x</a></span><span class="op" id="2876302">)</span><span class="op" id="2876303">+</span><span class="builtinfunc" id="2876304">len</span><span class="op" id="2876307">(</span><span class="ident" id="2876308"><a href="/math/big/nat.go.html#2876281">y</a></span><span class="op" id="2876309">)</span><span class="op" id="2876310">]</span><span class="op" id="2876311">.</span><span class="ident" id="2876312">clear</span><span class="op" id="2876317">(</span><span class="op" id="2876318">)</span>&nbsp;<span class="comment" id="2876320">//&nbsp;initialize&nbsp;z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2876337">for</span>&nbsp;<span class="ident" id="2876341">i</span><span class="op" id="2876342">,</span>&nbsp;<span class="ident" id="2876344">d</span>&nbsp;<span class="op" id="2876346">:=</span>&nbsp;<span class="keyword" id="2876349">range</span>&nbsp;<span class="ident" id="2876355"><a href="/math/big/nat.go.html#2876281">y</a></span>&nbsp;<span class="op" id="2876357">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2876361">if</span>&nbsp;<span class="ident" id="2876364"><a href="/math/big/nat.go.html#2876344">d</a></span>&nbsp;<span class="op" id="2876366">!=</span>&nbsp;<span class="num" id="2876369">0</span>&nbsp;<span class="op" id="2876371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2876376"><a href="/math/big/nat.go.html#2876275">z</a></span><span class="op" id="2876377">[</span><span class="builtinfunc" id="2876378">len</span><span class="op" id="2876381">(</span><span class="ident" id="2876382"><a href="/math/big/nat.go.html#2876278">x</a></span><span class="op" id="2876383">)</span><span class="op" id="2876384">+</span><span class="ident" id="2876385"><a href="/math/big/nat.go.html#2876341">i</a></span><span class="op" id="2876386">]</span>&nbsp;<span class="op" id="2876388">=</span>&nbsp;<span class="ident" id="2876390"><a href="/math/big/arith_decl.go.html#2847177">addMulVVW</a></span><span class="op" id="2876399">(</span><span class="ident" id="2876400"><a href="/math/big/nat.go.html#2876275">z</a></span><span class="op" id="2876401">[</span><span class="ident" id="2876402"><a href="/math/big/nat.go.html#2876341">i</a></span><span class="op" id="2876403">:</span><span class="ident" id="2876404"><a href="/math/big/nat.go.html#2876341">i</a></span><span class="op" id="2876405">+</span><span class="builtinfunc" id="2876406">len</span><span class="op" id="2876409">(</span><span class="ident" id="2876410"><a href="/math/big/nat.go.html#2876278">x</a></span><span class="op" id="2876411">)</span><span class="op" id="2876412">]</span><span class="op" id="2876413">,</span>&nbsp;<span class="ident" id="2876415"><a href="/math/big/nat.go.html#2876278">x</a></span><span class="op" id="2876416">,</span>&nbsp;<span class="ident" id="2876418"><a href="/math/big/nat.go.html#2876344">d</a></span><span class="op" id="2876419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2876423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2876426">}</span><br>
<span class="lineno"></span><span class="op" id="2876428">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="2876431">//&nbsp;Fast&nbsp;version&nbsp;of&nbsp;z[0:n+n&gt;&gt;1].add(z[0:n+n&gt;&gt;1],&nbsp;x[0:n])&nbsp;w/o&nbsp;bounds&nbsp;checks.</span><br>
<span class="lineno"></span><span class="comment" id="2876506">//&nbsp;Factored&nbsp;out&nbsp;for&nbsp;readability&nbsp;-&nbsp;do&nbsp;not&nbsp;use&nbsp;outside&nbsp;karatsuba.</span><br>
<span class="lineno"></span><span class="keyword" id="2876570">func</span>&nbsp;<span class="ident" id="2876575">karatsubaAdd</span><span class="op" id="2876587">(</span><span class="ident" id="2876588">z</span><span class="op" id="2876589">,</span>&nbsp;<span class="ident" id="2876591">x</span>&nbsp;<span class="ident" id="2876593"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2876596">,</span>&nbsp;<span class="ident" id="2876598">n</span>&nbsp;<span class="builtintype" id="2876600">int</span><span class="op" id="2876603">)</span>&nbsp;<span class="op" id="2876605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2876608">if</span>&nbsp;<span class="ident" id="2876611">c</span>&nbsp;<span class="op" id="2876613">:=</span>&nbsp;<span class="ident" id="2876616"><a href="/math/big/arith_decl.go.html#2846893">addVV</a></span><span class="op" id="2876621">(</span><span class="ident" id="2876622"><a href="/math/big/nat.go.html#2876588">z</a></span><span class="op" id="2876623">[</span><span class="num" id="2876624">0</span><span class="op" id="2876625">:</span><span class="ident" id="2876626"><a href="/math/big/nat.go.html#2876598">n</a></span><span class="op" id="2876627">]</span><span class="op" id="2876628">,</span>&nbsp;<span class="ident" id="2876630"><a href="/math/big/nat.go.html#2876588">z</a></span><span class="op" id="2876631">,</span>&nbsp;<span class="ident" id="2876633"><a href="/math/big/nat.go.html#2876591">x</a></span><span class="op" id="2876634">)</span><span class="op" id="2876635">;</span>&nbsp;<span class="ident" id="2876637"><a href="/math/big/nat.go.html#2876611">c</a></span>&nbsp;<span class="op" id="2876639">!=</span>&nbsp;<span class="num" id="2876642">0</span>&nbsp;<span class="op" id="2876644">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2876648"><a href="/math/big/arith_decl.go.html#2846965">addVW</a></span><span class="op" id="2876653">(</span><span class="ident" id="2876654"><a href="/math/big/nat.go.html#2876588">z</a></span><span class="op" id="2876655">[</span><span class="ident" id="2876656"><a href="/math/big/nat.go.html#2876598">n</a></span><span class="op" id="2876657">:</span><span class="ident" id="2876658"><a href="/math/big/nat.go.html#2876598">n</a></span><span class="op" id="2876659">+</span><span class="ident" id="2876660"><a href="/math/big/nat.go.html#2876598">n</a></span><span class="op" id="2876661">&gt;&gt;</span><span class="num" id="2876663">1</span><span class="op" id="2876664">]</span><span class="op" id="2876665">,</span>&nbsp;<span class="ident" id="2876667"><a href="/math/big/nat.go.html#2876588">z</a></span><span class="op" id="2876668">[</span><span class="ident" id="2876669"><a href="/math/big/nat.go.html#2876598">n</a></span><span class="op" id="2876670">:</span><span class="op" id="2876671">]</span><span class="op" id="2876672">,</span>&nbsp;<span class="ident" id="2876674"><a href="/math/big/nat.go.html#2876611">c</a></span><span class="op" id="2876675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2876678">}</span><br>
<span class="lineno"></span><span class="op" id="2876680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2876683">//&nbsp;Like&nbsp;karatsubaAdd,&nbsp;but&nbsp;does&nbsp;subtract.</span><br>
<span class="lineno">230</span><span class="keyword" id="2876724">func</span>&nbsp;<span class="ident" id="2876729">karatsubaSub</span><span class="op" id="2876741">(</span><span class="ident" id="2876742">z</span><span class="op" id="2876743">,</span>&nbsp;<span class="ident" id="2876745">x</span>&nbsp;<span class="ident" id="2876747"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2876750">,</span>&nbsp;<span class="ident" id="2876752">n</span>&nbsp;<span class="builtintype" id="2876754">int</span><span class="op" id="2876757">)</span>&nbsp;<span class="op" id="2876759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2876762">if</span>&nbsp;<span class="ident" id="2876765">c</span>&nbsp;<span class="op" id="2876767">:=</span>&nbsp;<span class="ident" id="2876770"><a href="/math/big/arith_decl.go.html#2846929">subVV</a></span><span class="op" id="2876775">(</span><span class="ident" id="2876776"><a href="/math/big/nat.go.html#2876742">z</a></span><span class="op" id="2876777">[</span><span class="num" id="2876778">0</span><span class="op" id="2876779">:</span><span class="ident" id="2876780"><a href="/math/big/nat.go.html#2876752">n</a></span><span class="op" id="2876781">]</span><span class="op" id="2876782">,</span>&nbsp;<span class="ident" id="2876784"><a href="/math/big/nat.go.html#2876742">z</a></span><span class="op" id="2876785">,</span>&nbsp;<span class="ident" id="2876787"><a href="/math/big/nat.go.html#2876745">x</a></span><span class="op" id="2876788">)</span><span class="op" id="2876789">;</span>&nbsp;<span class="ident" id="2876791"><a href="/math/big/nat.go.html#2876765">c</a></span>&nbsp;<span class="op" id="2876793">!=</span>&nbsp;<span class="num" id="2876796">0</span>&nbsp;<span class="op" id="2876798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2876802"><a href="/math/big/arith_decl.go.html#2847006">subVW</a></span><span class="op" id="2876807">(</span><span class="ident" id="2876808"><a href="/math/big/nat.go.html#2876742">z</a></span><span class="op" id="2876809">[</span><span class="ident" id="2876810"><a href="/math/big/nat.go.html#2876752">n</a></span><span class="op" id="2876811">:</span><span class="ident" id="2876812"><a href="/math/big/nat.go.html#2876752">n</a></span><span class="op" id="2876813">+</span><span class="ident" id="2876814"><a href="/math/big/nat.go.html#2876752">n</a></span><span class="op" id="2876815">&gt;&gt;</span><span class="num" id="2876817">1</span><span class="op" id="2876818">]</span><span class="op" id="2876819">,</span>&nbsp;<span class="ident" id="2876821"><a href="/math/big/nat.go.html#2876742">z</a></span><span class="op" id="2876822">[</span><span class="ident" id="2876823"><a href="/math/big/nat.go.html#2876752">n</a></span><span class="op" id="2876824">:</span><span class="op" id="2876825">]</span><span class="op" id="2876826">,</span>&nbsp;<span class="ident" id="2876828"><a href="/math/big/nat.go.html#2876765">c</a></span><span class="op" id="2876829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2876832">}</span><br>
<span class="lineno"></span><span class="op" id="2876834">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="2876837">//&nbsp;Operands&nbsp;that&nbsp;are&nbsp;shorter&nbsp;than&nbsp;karatsubaThreshold&nbsp;are&nbsp;multiplied&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="2876911">//&nbsp;&#34;grade&nbsp;school&#34;&nbsp;multiplication;&nbsp;for&nbsp;longer&nbsp;operands&nbsp;the&nbsp;Karatsuba&nbsp;algorithm</span><br>
<span class="lineno"></span><span class="comment" id="2876989">//&nbsp;is&nbsp;used.</span><br>
<span class="lineno"></span><span class="keyword" id="2877001">var</span>&nbsp;<span class="ident" id="2877005">karatsubaThreshold</span>&nbsp;<span class="builtintype" id="2877024">int</span>&nbsp;<span class="op" id="2877028">=</span>&nbsp;<span class="num" id="2877030">40</span>&nbsp;<span class="comment" id="2877033">//&nbsp;computed&nbsp;by&nbsp;calibrate.go</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="comment" id="2877062">//&nbsp;karatsuba&nbsp;multiplies&nbsp;x&nbsp;and&nbsp;y&nbsp;and&nbsp;leaves&nbsp;the&nbsp;result&nbsp;in&nbsp;z.</span><br>
<span class="lineno"></span><span class="comment" id="2877122">//&nbsp;Both&nbsp;x&nbsp;and&nbsp;y&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;length&nbsp;n&nbsp;and&nbsp;n&nbsp;must&nbsp;be&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2877182">//&nbsp;power&nbsp;of&nbsp;2.&nbsp;The&nbsp;result&nbsp;vector&nbsp;z&nbsp;must&nbsp;have&nbsp;len(z)&nbsp;&gt;=&nbsp;6*n.</span><br>
<span class="lineno"></span><span class="comment" id="2877242">//&nbsp;The&nbsp;(non-normalized)&nbsp;result&nbsp;is&nbsp;placed&nbsp;in&nbsp;z[0&nbsp;:&nbsp;2*n].</span><br>
<span class="lineno">245</span><span class="keyword" id="2877298">func</span>&nbsp;<span class="ident" id="2877303">karatsuba</span><span class="op" id="2877312">(</span><span class="ident" id="2877313">z</span><span class="op" id="2877314">,</span>&nbsp;<span class="ident" id="2877316">x</span><span class="op" id="2877317">,</span>&nbsp;<span class="ident" id="2877319">y</span>&nbsp;<span class="ident" id="2877321"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2877324">)</span>&nbsp;<span class="op" id="2877326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2877329">n</span>&nbsp;<span class="op" id="2877331">:=</span>&nbsp;<span class="builtinfunc" id="2877334">len</span><span class="op" id="2877337">(</span><span class="ident" id="2877338"><a href="/math/big/nat.go.html#2877319">y</a></span><span class="op" id="2877339">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877343">//&nbsp;Switch&nbsp;to&nbsp;basic&nbsp;multiplication&nbsp;if&nbsp;numbers&nbsp;are&nbsp;odd&nbsp;or&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877407">//&nbsp;(n&nbsp;is&nbsp;always&nbsp;even&nbsp;if&nbsp;karatsubaThreshold&nbsp;is&nbsp;even,&nbsp;but&nbsp;be</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877467">//&nbsp;conservative)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2877485">if</span>&nbsp;<span class="ident" id="2877488"><a href="/math/big/nat.go.html#2877329">n</a></span><span class="op" id="2877489">&amp;</span><span class="num" id="2877490">1</span>&nbsp;<span class="op" id="2877492">!=</span>&nbsp;<span class="num" id="2877495">0</span>&nbsp;<span class="op" id="2877497">||</span>&nbsp;<span class="ident" id="2877500"><a href="/math/big/nat.go.html#2877329">n</a></span>&nbsp;<span class="op" id="2877502">&lt;</span>&nbsp;<span class="ident" id="2877504"><a href="/math/big/nat.go.html#2877005">karatsubaThreshold</a></span>&nbsp;<span class="op" id="2877523">||</span>&nbsp;<span class="ident" id="2877526"><a href="/math/big/nat.go.html#2877329">n</a></span>&nbsp;<span class="op" id="2877528">&lt;</span>&nbsp;<span class="num" id="2877530">2</span>&nbsp;<span class="op" id="2877532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2877536"><a href="/math/big/nat.go.html#2876266">basicMul</a></span><span class="op" id="2877544">(</span><span class="ident" id="2877545"><a href="/math/big/nat.go.html#2877313">z</a></span><span class="op" id="2877546">,</span>&nbsp;<span class="ident" id="2877548"><a href="/math/big/nat.go.html#2877316">x</a></span><span class="op" id="2877549">,</span>&nbsp;<span class="ident" id="2877551"><a href="/math/big/nat.go.html#2877319">y</a></span><span class="op" id="2877552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2877556">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2877564">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877567">//&nbsp;n&amp;1&nbsp;==&nbsp;0&nbsp;&amp;&amp;&nbsp;n&nbsp;&gt;=&nbsp;karatsubaThreshold&nbsp;&amp;&amp;&nbsp;n&nbsp;&gt;=&nbsp;2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877618">//&nbsp;Karatsuba&nbsp;multiplication&nbsp;is&nbsp;based&nbsp;on&nbsp;the&nbsp;observation&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877680">//&nbsp;for&nbsp;two&nbsp;numbers&nbsp;x&nbsp;and&nbsp;y&nbsp;with:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877714">//</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877718">//&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;x1*b&nbsp;+&nbsp;x0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877738">//&nbsp;&nbsp;&nbsp;y&nbsp;=&nbsp;y1*b&nbsp;+&nbsp;y0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877758">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877762">//&nbsp;the&nbsp;product&nbsp;x*y&nbsp;can&nbsp;be&nbsp;obtained&nbsp;with&nbsp;3&nbsp;products&nbsp;z2,&nbsp;z1,&nbsp;z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877825">//&nbsp;instead&nbsp;of&nbsp;4:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877843">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877847">//&nbsp;&nbsp;&nbsp;x*y&nbsp;=&nbsp;x1*y1*b*b&nbsp;+&nbsp;(x1*y0&nbsp;+&nbsp;x0*y1)*b&nbsp;+&nbsp;x0*y0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877897">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;z2*b*b&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z1*b&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877947">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877951">//&nbsp;with:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877961">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877965">//&nbsp;&nbsp;&nbsp;xd&nbsp;=&nbsp;x1&nbsp;-&nbsp;x0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2877984">//&nbsp;&nbsp;&nbsp;yd&nbsp;=&nbsp;y0&nbsp;-&nbsp;y1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878003">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878007">//&nbsp;&nbsp;&nbsp;z1&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xd*yd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;z2&nbsp;+&nbsp;z0</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878058">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(x1-x0)*(y0&nbsp;-&nbsp;y1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;z2&nbsp;+&nbsp;z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878109">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;x1*y0&nbsp;-&nbsp;x1*y1&nbsp;-&nbsp;x0*y0&nbsp;+&nbsp;x0*y1&nbsp;+&nbsp;z2&nbsp;+&nbsp;z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878160">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;x1*y0&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;z2&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;z0&nbsp;+&nbsp;x0*y1&nbsp;+&nbsp;z2&nbsp;+&nbsp;z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878211">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;x1*y0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;x0*y1</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878253">//&nbsp;split&nbsp;x,&nbsp;y&nbsp;into&nbsp;&#34;digits&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878282">n2</span>&nbsp;<span class="op" id="2878285">:=</span>&nbsp;<span class="ident" id="2878288"><a href="/math/big/nat.go.html#2877329">n</a></span>&nbsp;<span class="op" id="2878290">&gt;&gt;</span>&nbsp;<span class="num" id="2878293">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2878308">//&nbsp;n2&nbsp;&gt;=&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878320">x1</span><span class="op" id="2878322">,</span>&nbsp;<span class="ident" id="2878324">x0</span>&nbsp;<span class="op" id="2878327">:=</span>&nbsp;<span class="ident" id="2878330"><a href="/math/big/nat.go.html#2877316">x</a></span><span class="op" id="2878331">[</span><span class="ident" id="2878332"><a href="/math/big/nat.go.html#2878282">n2</a></span><span class="op" id="2878334">:</span><span class="op" id="2878335">]</span><span class="op" id="2878336">,</span>&nbsp;<span class="ident" id="2878338"><a href="/math/big/nat.go.html#2877316">x</a></span><span class="op" id="2878339">[</span><span class="num" id="2878340">0</span><span class="op" id="2878341">:</span><span class="ident" id="2878342"><a href="/math/big/nat.go.html#2878282">n2</a></span><span class="op" id="2878344">]</span>&nbsp;<span class="comment" id="2878346">//&nbsp;x&nbsp;=&nbsp;x1*b&nbsp;+&nbsp;y0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878364">y1</span><span class="op" id="2878366">,</span>&nbsp;<span class="ident" id="2878368">y0</span>&nbsp;<span class="op" id="2878371">:=</span>&nbsp;<span class="ident" id="2878374"><a href="/math/big/nat.go.html#2877319">y</a></span><span class="op" id="2878375">[</span><span class="ident" id="2878376"><a href="/math/big/nat.go.html#2878282">n2</a></span><span class="op" id="2878378">:</span><span class="op" id="2878379">]</span><span class="op" id="2878380">,</span>&nbsp;<span class="ident" id="2878382"><a href="/math/big/nat.go.html#2877319">y</a></span><span class="op" id="2878383">[</span><span class="num" id="2878384">0</span><span class="op" id="2878385">:</span><span class="ident" id="2878386"><a href="/math/big/nat.go.html#2878282">n2</a></span><span class="op" id="2878388">]</span>&nbsp;<span class="comment" id="2878390">//&nbsp;y&nbsp;=&nbsp;y1*b&nbsp;+&nbsp;y0</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878409">//&nbsp;z&nbsp;is&nbsp;used&nbsp;for&nbsp;the&nbsp;result&nbsp;and&nbsp;temporary&nbsp;storage:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878461">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878465">//&nbsp;&nbsp;&nbsp;6*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0*n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878523">//&nbsp;z&nbsp;=&nbsp;[z2&nbsp;copy|z0&nbsp;copy|&nbsp;xd*yd&nbsp;|&nbsp;yd:xd&nbsp;|&nbsp;x1*y1&nbsp;|&nbsp;x0*y0&nbsp;]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878581">//</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878585">//&nbsp;For&nbsp;each&nbsp;recursive&nbsp;call&nbsp;of&nbsp;karatsuba,&nbsp;an&nbsp;unused&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878646">//&nbsp;z&nbsp;is&nbsp;passed&nbsp;in&nbsp;that&nbsp;has&nbsp;(at&nbsp;least)&nbsp;half&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878708">//&nbsp;caller&#39;s&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878725">//&nbsp;compute&nbsp;z0&nbsp;and&nbsp;z2&nbsp;with&nbsp;the&nbsp;result&nbsp;&#34;in&nbsp;place&#34;&nbsp;in&nbsp;z</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878779"><a href="/math/big/nat.go.html#2877303">karatsuba</a></span><span class="op" id="2878788">(</span><span class="ident" id="2878789"><a href="/math/big/nat.go.html#2877313">z</a></span><span class="op" id="2878790">,</span>&nbsp;<span class="ident" id="2878792"><a href="/math/big/nat.go.html#2878324">x0</a></span><span class="op" id="2878794">,</span>&nbsp;<span class="ident" id="2878796"><a href="/math/big/nat.go.html#2878368">y0</a></span><span class="op" id="2878798">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2878804">//&nbsp;z0&nbsp;=&nbsp;x0*y0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878819"><a href="/math/big/nat.go.html#2877303">karatsuba</a></span><span class="op" id="2878828">(</span><span class="ident" id="2878829"><a href="/math/big/nat.go.html#2877313">z</a></span><span class="op" id="2878830">[</span><span class="ident" id="2878831"><a href="/math/big/nat.go.html#2877329">n</a></span><span class="op" id="2878832">:</span><span class="op" id="2878833">]</span><span class="op" id="2878834">,</span>&nbsp;<span class="ident" id="2878836"><a href="/math/big/nat.go.html#2878320">x1</a></span><span class="op" id="2878838">,</span>&nbsp;<span class="ident" id="2878840"><a href="/math/big/nat.go.html#2878364">y1</a></span><span class="op" id="2878842">)</span>&nbsp;<span class="comment" id="2878844">//&nbsp;z2&nbsp;=&nbsp;x1*y1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2878860">//&nbsp;compute&nbsp;xd&nbsp;(or&nbsp;the&nbsp;negative&nbsp;value&nbsp;if&nbsp;underflow&nbsp;occurs)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878919">s</span>&nbsp;<span class="op" id="2878921">:=</span>&nbsp;<span class="num" id="2878924">1</span>&nbsp;<span class="comment" id="2878926">//&nbsp;sign&nbsp;of&nbsp;product&nbsp;xd*yd</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2878952">xd</span>&nbsp;<span class="op" id="2878955">:=</span>&nbsp;<span class="ident" id="2878958"><a href="/math/big/nat.go.html#2877313">z</a></span><span class="op" id="2878959">[</span><span class="num" id="2878960">2</span><span class="op" id="2878961">*</span><span class="ident" id="2878962"><a href="/math/big/nat.go.html#2877329">n</a></span>&nbsp;<span class="op" id="2878964">:</span>&nbsp;<span class="num" id="2878966">2</span><span class="op" id="2878967">*</span><span class="ident" id="2878968"><a href="/math/big/nat.go.html#2877329">n</a></span><span class="op" id="2878969">+</span><span class="ident" id="2878970"><a href="/math/big/nat.go.html#2878282">n2</a></span><span class="op" id="2878972">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2878975">if</span>&nbsp;<span class="ident" id="2878978"><a href="/math/big/arith_decl.go.html#2846929">subVV</a></span><span class="op" id="2878983">(</span><span class="ident" id="2878984"><a href="/math/big/nat.go.html#2878952">xd</a></span><span class="op" id="2878986">,</span>&nbsp;<span class="ident" id="2878988"><a href="/math/big/nat.go.html#2878320">x1</a></span><span class="op" id="2878990">,</span>&nbsp;<span class="ident" id="2878992"><a href="/math/big/nat.go.html#2878324">x0</a></span><span class="op" id="2878994">)</span>&nbsp;<span class="op" id="2878996">!=</span>&nbsp;<span class="num" id="2878999">0</span>&nbsp;<span class="op" id="2879001">{</span>&nbsp;<span class="comment" id="2879003">//&nbsp;x1-x0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879014"><a href="/math/big/nat.go.html#2878919">s</a></span>&nbsp;<span class="op" id="2879016">=</span>&nbsp;<span class="op" id="2879018">-</span><span class="ident" id="2879019"><a href="/math/big/nat.go.html#2878919">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879023"><a href="/math/big/arith_decl.go.html#2846929">subVV</a></span><span class="op" id="2879028">(</span><span class="ident" id="2879029"><a href="/math/big/nat.go.html#2878952">xd</a></span><span class="op" id="2879031">,</span>&nbsp;<span class="ident" id="2879033"><a href="/math/big/nat.go.html#2878324">x0</a></span><span class="op" id="2879035">,</span>&nbsp;<span class="ident" id="2879037"><a href="/math/big/nat.go.html#2878320">x1</a></span><span class="op" id="2879039">)</span>&nbsp;<span class="comment" id="2879041">//&nbsp;x0-x1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2879051">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2879055">//&nbsp;compute&nbsp;yd&nbsp;(or&nbsp;the&nbsp;negative&nbsp;value&nbsp;if&nbsp;underflow&nbsp;occurs)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879114">yd</span>&nbsp;<span class="op" id="2879117">:=</span>&nbsp;<span class="ident" id="2879120"><a href="/math/big/nat.go.html#2877313">z</a></span><span class="op" id="2879121">[</span><span class="num" id="2879122">2</span><span class="op" id="2879123">*</span><span class="ident" id="2879124"><a href="/math/big/nat.go.html#2877329">n</a></span><span class="op" id="2879125">+</span><span class="ident" id="2879126"><a href="/math/big/nat.go.html#2878282">n2</a></span>&nbsp;<span class="op" id="2879129">:</span>&nbsp;<span class="num" id="2879131">3</span><span class="op" id="2879132">*</span><span class="ident" id="2879133"><a href="/math/big/nat.go.html#2877329">n</a></span><span class="op" id="2879134">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2879137">if</span>&nbsp;<span class="ident" id="2879140"><a href="/math/big/arith_decl.go.html#2846929">subVV</a></span><span class="op" id="2879145">(</span><span class="ident" id="2879146"><a href="/math/big/nat.go.html#2879114">yd</a></span><span class="op" id="2879148">,</span>&nbsp;<span class="ident" id="2879150"><a href="/math/big/nat.go.html#2878368">y0</a></span><span class="op" id="2879152">,</span>&nbsp;<span class="ident" id="2879154"><a href="/math/big/nat.go.html#2878364">y1</a></span><span class="op" id="2879156">)</span>&nbsp;<span class="op" id="2879158">!=</span>&nbsp;<span class="num" id="2879161">0</span>&nbsp;<span class="op" id="2879163">{</span>&nbsp;<span class="comment" id="2879165">//&nbsp;y0-y1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879176"><a href="/math/big/nat.go.html#2878919">s</a></span>&nbsp;<span class="op" id="2879178">=</span>&nbsp;<span class="op" id="2879180">-</span><span class="ident" id="2879181"><a href="/math/big/nat.go.html#2878919">s</a></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879185"><a href="/math/big/arith_decl.go.html#2846929">subVV</a></span><span class="op" id="2879190">(</span><span class="ident" id="2879191"><a href="/math/big/nat.go.html#2879114">yd</a></span><span class="op" id="2879193">,</span>&nbsp;<span class="ident" id="2879195"><a href="/math/big/nat.go.html#2878364">y1</a></span><span class="op" id="2879197">,</span>&nbsp;<span class="ident" id="2879199"><a href="/math/big/nat.go.html#2878368">y0</a></span><span class="op" id="2879201">)</span>&nbsp;<span class="comment" id="2879203">//&nbsp;y1-y0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2879213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2879217">//&nbsp;p&nbsp;=&nbsp;(x1-x0)*(y0-y1)&nbsp;==&nbsp;x1*y0&nbsp;-&nbsp;x1*y1&nbsp;-&nbsp;x0*y0&nbsp;+&nbsp;x0*y1&nbsp;for&nbsp;s&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2879284">//&nbsp;p&nbsp;=&nbsp;(x0-x1)*(y0-y1)&nbsp;==&nbsp;x0*y0&nbsp;-&nbsp;x0*y1&nbsp;-&nbsp;x1*y0&nbsp;+&nbsp;x1*y1&nbsp;for&nbsp;s&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879351">p</span>&nbsp;<span class="op" id="2879353">:=</span>&nbsp;<span class="ident" id="2879356"><a href="/math/big/nat.go.html#2877313">z</a></span><span class="op" id="2879357">[</span><span class="ident" id="2879358"><a href="/math/big/nat.go.html#2877329">n</a></span><span class="op" id="2879359">*</span><span class="num" id="2879360">3</span><span class="op" id="2879361">:</span><span class="op" id="2879362">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879365"><a href="/math/big/nat.go.html#2877303">karatsuba</a></span><span class="op" id="2879374">(</span><span class="ident" id="2879375"><a href="/math/big/nat.go.html#2879351">p</a></span><span class="op" id="2879376">,</span>&nbsp;<span class="ident" id="2879378"><a href="/math/big/nat.go.html#2878952">xd</a></span><span class="op" id="2879380">,</span>&nbsp;<span class="ident" id="2879382"><a href="/math/big/nat.go.html#2879114">yd</a></span><span class="op" id="2879384">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2879388">//&nbsp;save&nbsp;original&nbsp;z2:z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2879412">//&nbsp;(ok&nbsp;to&nbsp;use&nbsp;upper&nbsp;half&nbsp;of&nbsp;z&nbsp;since&nbsp;we&#39;re&nbsp;done&nbsp;recursing)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879471">r</span>&nbsp;<span class="op" id="2879473">:=</span>&nbsp;<span class="ident" id="2879476"><a href="/math/big/nat.go.html#2877313">z</a></span><span class="op" id="2879477">[</span><span class="ident" id="2879478"><a href="/math/big/nat.go.html#2877329">n</a></span><span class="op" id="2879479">*</span><span class="num" id="2879480">4</span><span class="op" id="2879481">:</span><span class="op" id="2879482">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2879485">copy</span><span class="op" id="2879489">(</span><span class="ident" id="2879490"><a href="/math/big/nat.go.html#2879471">r</a></span><span class="op" id="2879491">,</span>&nbsp;<span class="ident" id="2879493"><a href="/math/big/nat.go.html#2877313">z</a></span><span class="op" id="2879494">[</span><span class="op" id="2879495">:</span><span class="ident" id="2879496"><a href="/math/big/nat.go.html#2877329">n</a></span><span class="op" id="2879497">*</span><span class="num" id="2879498">2</span><span class="op" id="2879499">]</span><span class="op" id="2879500">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2879504">//&nbsp;add&nbsp;up&nbsp;all&nbsp;partial&nbsp;products</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2879536">//</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2879540">//&nbsp;&nbsp;&nbsp;2*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2879562">//&nbsp;z&nbsp;=&nbsp;[&nbsp;z2&nbsp;&nbsp;|&nbsp;z0&nbsp;&nbsp;]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2879584">//&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;z0&nbsp;&nbsp;]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2879603">//&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;z2&nbsp;&nbsp;]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2879622">//&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;&nbsp;p&nbsp;&nbsp;]</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2879641">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879645"><a href="/math/big/nat.go.html#2876575">karatsubaAdd</a></span><span class="op" id="2879657">(</span><span class="ident" id="2879658"><a href="/math/big/nat.go.html#2877313">z</a></span><span class="op" id="2879659">[</span><span class="ident" id="2879660"><a href="/math/big/nat.go.html#2878282">n2</a></span><span class="op" id="2879662">:</span><span class="op" id="2879663">]</span><span class="op" id="2879664">,</span>&nbsp;<span class="ident" id="2879666"><a href="/math/big/nat.go.html#2879471">r</a></span><span class="op" id="2879667">,</span>&nbsp;<span class="ident" id="2879669"><a href="/math/big/nat.go.html#2877329">n</a></span><span class="op" id="2879670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879673"><a href="/math/big/nat.go.html#2876575">karatsubaAdd</a></span><span class="op" id="2879685">(</span><span class="ident" id="2879686"><a href="/math/big/nat.go.html#2877313">z</a></span><span class="op" id="2879687">[</span><span class="ident" id="2879688"><a href="/math/big/nat.go.html#2878282">n2</a></span><span class="op" id="2879690">:</span><span class="op" id="2879691">]</span><span class="op" id="2879692">,</span>&nbsp;<span class="ident" id="2879694"><a href="/math/big/nat.go.html#2879471">r</a></span><span class="op" id="2879695">[</span><span class="ident" id="2879696"><a href="/math/big/nat.go.html#2877329">n</a></span><span class="op" id="2879697">:</span><span class="op" id="2879698">]</span><span class="op" id="2879699">,</span>&nbsp;<span class="ident" id="2879701"><a href="/math/big/nat.go.html#2877329">n</a></span><span class="op" id="2879702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2879705">if</span>&nbsp;<span class="ident" id="2879708"><a href="/math/big/nat.go.html#2878919">s</a></span>&nbsp;<span class="op" id="2879710">&gt;</span>&nbsp;<span class="num" id="2879712">0</span>&nbsp;<span class="op" id="2879714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879718"><a href="/math/big/nat.go.html#2876575">karatsubaAdd</a></span><span class="op" id="2879730">(</span><span class="ident" id="2879731"><a href="/math/big/nat.go.html#2877313">z</a></span><span class="op" id="2879732">[</span><span class="ident" id="2879733"><a href="/math/big/nat.go.html#2878282">n2</a></span><span class="op" id="2879735">:</span><span class="op" id="2879736">]</span><span class="op" id="2879737">,</span>&nbsp;<span class="ident" id="2879739"><a href="/math/big/nat.go.html#2879351">p</a></span><span class="op" id="2879740">,</span>&nbsp;<span class="ident" id="2879742"><a href="/math/big/nat.go.html#2877329">n</a></span><span class="op" id="2879743">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2879746">}</span>&nbsp;<span class="keyword" id="2879748">else</span>&nbsp;<span class="op" id="2879753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2879757"><a href="/math/big/nat.go.html#2876729">karatsubaSub</a></span><span class="op" id="2879769">(</span><span class="ident" id="2879770"><a href="/math/big/nat.go.html#2877313">z</a></span><span class="op" id="2879771">[</span><span class="ident" id="2879772"><a href="/math/big/nat.go.html#2878282">n2</a></span><span class="op" id="2879774">:</span><span class="op" id="2879775">]</span><span class="op" id="2879776">,</span>&nbsp;<span class="ident" id="2879778"><a href="/math/big/nat.go.html#2879351">p</a></span><span class="op" id="2879779">,</span>&nbsp;<span class="ident" id="2879781"><a href="/math/big/nat.go.html#2877329">n</a></span><span class="op" id="2879782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2879785">}</span><br>
<span class="lineno"></span><span class="op" id="2879787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="2879790">//&nbsp;alias&nbsp;returns&nbsp;true&nbsp;if&nbsp;x&nbsp;and&nbsp;y&nbsp;share&nbsp;the&nbsp;same&nbsp;base&nbsp;array.</span><br>
<span class="lineno"></span><span class="keyword" id="2879850">func</span>&nbsp;<span class="ident" id="2879855">alias</span><span class="op" id="2879860">(</span><span class="ident" id="2879861">x</span><span class="op" id="2879862">,</span>&nbsp;<span class="ident" id="2879864">y</span>&nbsp;<span class="ident" id="2879866"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2879869">)</span>&nbsp;<span class="builtintype" id="2879871">bool</span>&nbsp;<span class="op" id="2879876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2879879">return</span>&nbsp;<span class="builtinfunc" id="2879886">cap</span><span class="op" id="2879889">(</span><span class="ident" id="2879890"><a href="/math/big/nat.go.html#2879861">x</a></span><span class="op" id="2879891">)</span>&nbsp;<span class="op" id="2879893">&gt;</span>&nbsp;<span class="num" id="2879895">0</span>&nbsp;<span class="op" id="2879897">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2879900">cap</span><span class="op" id="2879903">(</span><span class="ident" id="2879904"><a href="/math/big/nat.go.html#2879864">y</a></span><span class="op" id="2879905">)</span>&nbsp;<span class="op" id="2879907">&gt;</span>&nbsp;<span class="num" id="2879909">0</span>&nbsp;<span class="op" id="2879911">&amp;&amp;</span>&nbsp;<span class="op" id="2879914">&amp;</span><span class="ident" id="2879915"><a href="/math/big/nat.go.html#2879861">x</a></span><span class="op" id="2879916">[</span><span class="num" id="2879917">0</span><span class="op" id="2879918">:</span><span class="builtinfunc" id="2879919">cap</span><span class="op" id="2879922">(</span><span class="ident" id="2879923"><a href="/math/big/nat.go.html#2879861">x</a></span><span class="op" id="2879924">)</span><span class="op" id="2879925">]</span><span class="op" id="2879926">[</span><span class="builtinfunc" id="2879927">cap</span><span class="op" id="2879930">(</span><span class="ident" id="2879931"><a href="/math/big/nat.go.html#2879861">x</a></span><span class="op" id="2879932">)</span><span class="op" id="2879933">-</span><span class="num" id="2879934">1</span><span class="op" id="2879935">]</span>&nbsp;<span class="op" id="2879937">==</span>&nbsp;<span class="op" id="2879940">&amp;</span><span class="ident" id="2879941"><a href="/math/big/nat.go.html#2879864">y</a></span><span class="op" id="2879942">[</span><span class="num" id="2879943">0</span><span class="op" id="2879944">:</span><span class="builtinfunc" id="2879945">cap</span><span class="op" id="2879948">(</span><span class="ident" id="2879949"><a href="/math/big/nat.go.html#2879864">y</a></span><span class="op" id="2879950">)</span><span class="op" id="2879951">]</span><span class="op" id="2879952">[</span><span class="builtinfunc" id="2879953">cap</span><span class="op" id="2879956">(</span><span class="ident" id="2879957"><a href="/math/big/nat.go.html#2879864">y</a></span><span class="op" id="2879958">)</span><span class="op" id="2879959">-</span><span class="num" id="2879960">1</span><span class="op" id="2879961">]</span><br>
<span class="lineno"></span><span class="op" id="2879963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="comment" id="2879966">//&nbsp;addAt&nbsp;implements&nbsp;z&nbsp;+=&nbsp;x&lt;&lt;(_W*i);&nbsp;z&nbsp;must&nbsp;be&nbsp;long&nbsp;enough.</span><br>
<span class="lineno"></span><span class="comment" id="2880025">//&nbsp;(we&nbsp;don&#39;t&nbsp;use&nbsp;nat.add&nbsp;because&nbsp;we&nbsp;need&nbsp;z&nbsp;to&nbsp;stay&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2880085">//&nbsp;slice,&nbsp;and&nbsp;we&nbsp;don&#39;t&nbsp;need&nbsp;to&nbsp;normalize&nbsp;z&nbsp;after&nbsp;each&nbsp;addition)</span><br>
<span class="lineno"></span><span class="keyword" id="2880149">func</span>&nbsp;<span class="ident" id="2880154">addAt</span><span class="op" id="2880159">(</span><span class="ident" id="2880160">z</span><span class="op" id="2880161">,</span>&nbsp;<span class="ident" id="2880163">x</span>&nbsp;<span class="ident" id="2880165"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2880168">,</span>&nbsp;<span class="ident" id="2880170">i</span>&nbsp;<span class="builtintype" id="2880172">int</span><span class="op" id="2880175">)</span>&nbsp;<span class="op" id="2880177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880180">if</span>&nbsp;<span class="ident" id="2880183">n</span>&nbsp;<span class="op" id="2880185">:=</span>&nbsp;<span class="builtinfunc" id="2880188">len</span><span class="op" id="2880191">(</span><span class="ident" id="2880192"><a href="/math/big/nat.go.html#2880163">x</a></span><span class="op" id="2880193">)</span><span class="op" id="2880194">;</span>&nbsp;<span class="ident" id="2880196"><a href="/math/big/nat.go.html#2880183">n</a></span>&nbsp;<span class="op" id="2880198">&gt;</span>&nbsp;<span class="num" id="2880200">0</span>&nbsp;<span class="op" id="2880202">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880206">if</span>&nbsp;<span class="ident" id="2880209">c</span>&nbsp;<span class="op" id="2880211">:=</span>&nbsp;<span class="ident" id="2880214"><a href="/math/big/arith_decl.go.html#2846893">addVV</a></span><span class="op" id="2880219">(</span><span class="ident" id="2880220"><a href="/math/big/nat.go.html#2880160">z</a></span><span class="op" id="2880221">[</span><span class="ident" id="2880222"><a href="/math/big/nat.go.html#2880170">i</a></span><span class="op" id="2880223">:</span><span class="ident" id="2880224"><a href="/math/big/nat.go.html#2880170">i</a></span><span class="op" id="2880225">+</span><span class="ident" id="2880226"><a href="/math/big/nat.go.html#2880183">n</a></span><span class="op" id="2880227">]</span><span class="op" id="2880228">,</span>&nbsp;<span class="ident" id="2880230"><a href="/math/big/nat.go.html#2880160">z</a></span><span class="op" id="2880231">[</span><span class="ident" id="2880232"><a href="/math/big/nat.go.html#2880170">i</a></span><span class="op" id="2880233">:</span><span class="op" id="2880234">]</span><span class="op" id="2880235">,</span>&nbsp;<span class="ident" id="2880237"><a href="/math/big/nat.go.html#2880163">x</a></span><span class="op" id="2880238">)</span><span class="op" id="2880239">;</span>&nbsp;<span class="ident" id="2880241"><a href="/math/big/nat.go.html#2880209">c</a></span>&nbsp;<span class="op" id="2880243">!=</span>&nbsp;<span class="num" id="2880246">0</span>&nbsp;<span class="op" id="2880248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2880253">j</span>&nbsp;<span class="op" id="2880255">:=</span>&nbsp;<span class="ident" id="2880258"><a href="/math/big/nat.go.html#2880170">i</a></span>&nbsp;<span class="op" id="2880260">+</span>&nbsp;<span class="ident" id="2880262"><a href="/math/big/nat.go.html#2880183">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880267">if</span>&nbsp;<span class="ident" id="2880270"><a href="/math/big/nat.go.html#2880253">j</a></span>&nbsp;<span class="op" id="2880272">&lt;</span>&nbsp;<span class="builtinfunc" id="2880274">len</span><span class="op" id="2880277">(</span><span class="ident" id="2880278"><a href="/math/big/nat.go.html#2880160">z</a></span><span class="op" id="2880279">)</span>&nbsp;<span class="op" id="2880281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2880287"><a href="/math/big/arith_decl.go.html#2846965">addVW</a></span><span class="op" id="2880292">(</span><span class="ident" id="2880293"><a href="/math/big/nat.go.html#2880160">z</a></span><span class="op" id="2880294">[</span><span class="ident" id="2880295"><a href="/math/big/nat.go.html#2880253">j</a></span><span class="op" id="2880296">:</span><span class="op" id="2880297">]</span><span class="op" id="2880298">,</span>&nbsp;<span class="ident" id="2880300"><a href="/math/big/nat.go.html#2880160">z</a></span><span class="op" id="2880301">[</span><span class="ident" id="2880302"><a href="/math/big/nat.go.html#2880253">j</a></span><span class="op" id="2880303">:</span><span class="op" id="2880304">]</span><span class="op" id="2880305">,</span>&nbsp;<span class="ident" id="2880307"><a href="/math/big/nat.go.html#2880209">c</a></span><span class="op" id="2880308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2880313">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2880317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2880320">}</span><br>
<span class="lineno"></span><span class="op" id="2880322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2880325">func</span>&nbsp;<span class="ident" id="2880330">max</span><span class="op" id="2880333">(</span><span class="ident" id="2880334">x</span><span class="op" id="2880335">,</span>&nbsp;<span class="ident" id="2880337">y</span>&nbsp;<span class="builtintype" id="2880339">int</span><span class="op" id="2880342">)</span>&nbsp;<span class="builtintype" id="2880344">int</span>&nbsp;<span class="op" id="2880348">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880351">if</span>&nbsp;<span class="ident" id="2880354"><a href="/math/big/nat.go.html#2880334">x</a></span>&nbsp;<span class="op" id="2880356">&gt;</span>&nbsp;<span class="ident" id="2880358"><a href="/math/big/nat.go.html#2880337">y</a></span>&nbsp;<span class="op" id="2880360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880364">return</span>&nbsp;<span class="ident" id="2880371"><a href="/math/big/nat.go.html#2880334">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2880374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880377">return</span>&nbsp;<span class="ident" id="2880384"><a href="/math/big/nat.go.html#2880337">y</a></span><br>
<span class="lineno"></span><span class="op" id="2880386">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="2880389">//&nbsp;karatsubaLen&nbsp;computes&nbsp;an&nbsp;approximation&nbsp;to&nbsp;the&nbsp;maximum&nbsp;k&nbsp;&lt;=&nbsp;n&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2880463">//&nbsp;k&nbsp;=&nbsp;p&lt;&lt;i&nbsp;for&nbsp;a&nbsp;number&nbsp;p&nbsp;&lt;=&nbsp;karatsubaThreshold&nbsp;and&nbsp;an&nbsp;i&nbsp;&gt;=&nbsp;0.&nbsp;Thus,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2880537">//&nbsp;result&nbsp;is&nbsp;the&nbsp;largest&nbsp;number&nbsp;that&nbsp;can&nbsp;be&nbsp;divided&nbsp;repeatedly&nbsp;by&nbsp;2&nbsp;before</span><br>
<span class="lineno"></span><span class="comment" id="2880612">//&nbsp;becoming&nbsp;about&nbsp;the&nbsp;value&nbsp;of&nbsp;karatsubaThreshold.</span><br>
<span class="lineno">370</span><span class="keyword" id="2880663">func</span>&nbsp;<span class="ident" id="2880668">karatsubaLen</span><span class="op" id="2880680">(</span><span class="ident" id="2880681">n</span>&nbsp;<span class="builtintype" id="2880683">int</span><span class="op" id="2880686">)</span>&nbsp;<span class="builtintype" id="2880688">int</span>&nbsp;<span class="op" id="2880692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2880695">i</span>&nbsp;<span class="op" id="2880697">:=</span>&nbsp;<span class="builtintype" id="2880700">uint</span><span class="op" id="2880704">(</span><span class="num" id="2880705">0</span><span class="op" id="2880706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880709">for</span>&nbsp;<span class="ident" id="2880713"><a href="/math/big/nat.go.html#2880681">n</a></span>&nbsp;<span class="op" id="2880715">&gt;</span>&nbsp;<span class="ident" id="2880717"><a href="/math/big/nat.go.html#2877005">karatsubaThreshold</a></span>&nbsp;<span class="op" id="2880736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2880740"><a href="/math/big/nat.go.html#2880681">n</a></span>&nbsp;<span class="op" id="2880742">&gt;&gt;=</span>&nbsp;<span class="num" id="2880746">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2880750"><a href="/math/big/nat.go.html#2880695">i</a></span><span class="op" id="2880751">++</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2880755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880758">return</span>&nbsp;<span class="ident" id="2880765"><a href="/math/big/nat.go.html#2880681">n</a></span>&nbsp;<span class="op" id="2880767">&lt;&lt;</span>&nbsp;<span class="ident" id="2880770"><a href="/math/big/nat.go.html#2880695">i</a></span><br>
<span class="lineno"></span><span class="op" id="2880772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2880775">func</span>&nbsp;<span class="op" id="2880780">(</span><span class="ident" id="2880781">z</span>&nbsp;<span class="ident" id="2880783"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2880786">)</span>&nbsp;<span class="ident" id="2880788">mul</span><span class="op" id="2880791">(</span><span class="ident" id="2880792">x</span><span class="op" id="2880793">,</span>&nbsp;<span class="ident" id="2880795">y</span>&nbsp;<span class="ident" id="2880797"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2880800">)</span>&nbsp;<span class="ident" id="2880802"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2880806">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2880809">m</span>&nbsp;<span class="op" id="2880811">:=</span>&nbsp;<span class="builtinfunc" id="2880814">len</span><span class="op" id="2880817">(</span><span class="ident" id="2880818"><a href="/math/big/nat.go.html#2880792">x</a></span><span class="op" id="2880819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2880822">n</span>&nbsp;<span class="op" id="2880824">:=</span>&nbsp;<span class="builtinfunc" id="2880827">len</span><span class="op" id="2880830">(</span><span class="ident" id="2880831"><a href="/math/big/nat.go.html#2880795">y</a></span><span class="op" id="2880832">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880836">switch</span>&nbsp;<span class="op" id="2880843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880846">case</span>&nbsp;<span class="ident" id="2880851"><a href="/math/big/nat.go.html#2880809">m</a></span>&nbsp;<span class="op" id="2880853">&lt;</span>&nbsp;<span class="ident" id="2880855"><a href="/math/big/nat.go.html#2880822">n</a></span><span class="op" id="2880856">:</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880860">return</span>&nbsp;<span class="ident" id="2880867"><a href="/math/big/nat.go.html#2880781">z</a></span><span class="op" id="2880868">.</span><span class="ident" id="2880869">mul</span><span class="op" id="2880872">(</span><span class="ident" id="2880873"><a href="/math/big/nat.go.html#2880795">y</a></span><span class="op" id="2880874">,</span>&nbsp;<span class="ident" id="2880876"><a href="/math/big/nat.go.html#2880792">x</a></span><span class="op" id="2880877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880880">case</span>&nbsp;<span class="ident" id="2880885"><a href="/math/big/nat.go.html#2880809">m</a></span>&nbsp;<span class="op" id="2880887">==</span>&nbsp;<span class="num" id="2880890">0</span>&nbsp;<span class="op" id="2880892">||</span>&nbsp;<span class="ident" id="2880895"><a href="/math/big/nat.go.html#2880822">n</a></span>&nbsp;<span class="op" id="2880897">==</span>&nbsp;<span class="num" id="2880900">0</span><span class="op" id="2880901">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880905">return</span>&nbsp;<span class="ident" id="2880912"><a href="/math/big/nat.go.html#2880781">z</a></span><span class="op" id="2880913">.</span><span class="builtinfunc" id="2880914">make</span><span class="op" id="2880918">(</span><span class="num" id="2880919">0</span><span class="op" id="2880920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880923">case</span>&nbsp;<span class="ident" id="2880928"><a href="/math/big/nat.go.html#2880822">n</a></span>&nbsp;<span class="op" id="2880930">==</span>&nbsp;<span class="num" id="2880933">1</span><span class="op" id="2880934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2880938">return</span>&nbsp;<span class="ident" id="2880945"><a href="/math/big/nat.go.html#2880781">z</a></span><span class="op" id="2880946">.</span><span class="ident" id="2880947">mulAddWW</span><span class="op" id="2880955">(</span><span class="ident" id="2880956"><a href="/math/big/nat.go.html#2880792">x</a></span><span class="op" id="2880957">,</span>&nbsp;<span class="ident" id="2880959"><a href="/math/big/nat.go.html#2880795">y</a></span><span class="op" id="2880960">[</span><span class="num" id="2880961">0</span><span class="op" id="2880962">]</span><span class="op" id="2880963">,</span>&nbsp;<span class="num" id="2880965">0</span><span class="op" id="2880966">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2880969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2880972">//&nbsp;m&nbsp;&gt;=&nbsp;n&nbsp;&gt;&nbsp;1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2880988">//&nbsp;determine&nbsp;if&nbsp;z&nbsp;can&nbsp;be&nbsp;reused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2881021">if</span>&nbsp;<span class="ident" id="2881024"><a href="/math/big/nat.go.html#2879855">alias</a></span><span class="op" id="2881029">(</span><span class="ident" id="2881030"><a href="/math/big/nat.go.html#2880781">z</a></span><span class="op" id="2881031">,</span>&nbsp;<span class="ident" id="2881033"><a href="/math/big/nat.go.html#2880792">x</a></span><span class="op" id="2881034">)</span>&nbsp;<span class="op" id="2881036">||</span>&nbsp;<span class="ident" id="2881039"><a href="/math/big/nat.go.html#2879855">alias</a></span><span class="op" id="2881044">(</span><span class="ident" id="2881045"><a href="/math/big/nat.go.html#2880781">z</a></span><span class="op" id="2881046">,</span>&nbsp;<span class="ident" id="2881048"><a href="/math/big/nat.go.html#2880795">y</a></span><span class="op" id="2881049">)</span>&nbsp;<span class="op" id="2881051">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2881055"><a href="/math/big/nat.go.html#2880781">z</a></span>&nbsp;<span class="op" id="2881057">=</span>&nbsp;<span class="ident" id="2881059">nil</span>&nbsp;<span class="comment" id="2881063">//&nbsp;z&nbsp;is&nbsp;an&nbsp;alias&nbsp;for&nbsp;x&nbsp;or&nbsp;y&nbsp;-&nbsp;cannot&nbsp;reuse</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2881107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2881111">//&nbsp;use&nbsp;basic&nbsp;multiplication&nbsp;if&nbsp;the&nbsp;numbers&nbsp;are&nbsp;small</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2881165">if</span>&nbsp;<span class="ident" id="2881168"><a href="/math/big/nat.go.html#2880822">n</a></span>&nbsp;<span class="op" id="2881170">&lt;</span>&nbsp;<span class="ident" id="2881172"><a href="/math/big/nat.go.html#2877005">karatsubaThreshold</a></span>&nbsp;<span class="op" id="2881191">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2881195"><a href="/math/big/nat.go.html#2880781">z</a></span>&nbsp;<span class="op" id="2881197">=</span>&nbsp;<span class="ident" id="2881199"><a href="/math/big/nat.go.html#2880781">z</a></span><span class="op" id="2881200">.</span><span class="builtinfunc" id="2881201">make</span><span class="op" id="2881205">(</span><span class="ident" id="2881206"><a href="/math/big/nat.go.html#2880809">m</a></span>&nbsp;<span class="op" id="2881208">+</span>&nbsp;<span class="ident" id="2881210"><a href="/math/big/nat.go.html#2880822">n</a></span><span class="op" id="2881211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2881215"><a href="/math/big/nat.go.html#2876266">basicMul</a></span><span class="op" id="2881223">(</span><span class="ident" id="2881224"><a href="/math/big/nat.go.html#2880781">z</a></span><span class="op" id="2881225">,</span>&nbsp;<span class="ident" id="2881227"><a href="/math/big/nat.go.html#2880792">x</a></span><span class="op" id="2881228">,</span>&nbsp;<span class="ident" id="2881230"><a href="/math/big/nat.go.html#2880795">y</a></span><span class="op" id="2881231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2881235">return</span>&nbsp;<span class="ident" id="2881242"><a href="/math/big/nat.go.html#2880781">z</a></span><span class="op" id="2881243">.</span><span class="ident" id="2881244">norm</span><span class="op" id="2881248">(</span><span class="op" id="2881249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2881252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2881255">//&nbsp;m&nbsp;&gt;=&nbsp;n&nbsp;&amp;&amp;&nbsp;n&nbsp;&gt;=&nbsp;karatsubaThreshold&nbsp;&amp;&amp;&nbsp;n&nbsp;&gt;=&nbsp;2</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2881304">//&nbsp;determine&nbsp;Karatsuba&nbsp;length&nbsp;k&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2881347">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2881351">//&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;xh*b&nbsp;+&nbsp;x0&nbsp;&nbsp;(0&nbsp;&lt;=&nbsp;x0&nbsp;&lt;&nbsp;b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2881386">//&nbsp;&nbsp;&nbsp;y&nbsp;=&nbsp;yh*b&nbsp;+&nbsp;y0&nbsp;&nbsp;(0&nbsp;&lt;=&nbsp;y0&nbsp;&lt;&nbsp;b)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2881421">//&nbsp;&nbsp;&nbsp;b&nbsp;=&nbsp;1&lt;&lt;(_W*k)&nbsp;&nbsp;(&#34;base&#34;&nbsp;of&nbsp;digits&nbsp;xi,&nbsp;yi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2881468">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2881472">k</span>&nbsp;<span class="op" id="2881474">:=</span>&nbsp;<span class="ident" id="2881477"><a href="/math/big/nat.go.html#2880668">karatsubaLen</a></span><span class="op" id="2881489">(</span><span class="ident" id="2881490"><a href="/math/big/nat.go.html#2880822">n</a></span><span class="op" id="2881491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2881494">//&nbsp;k&nbsp;&lt;=&nbsp;n</span><br>
<span class="lineno"></span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2881506">//&nbsp;multiply&nbsp;x0&nbsp;and&nbsp;y0&nbsp;via&nbsp;Karatsuba</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2881543">x0</span>&nbsp;<span class="op" id="2881546">:=</span>&nbsp;<span class="ident" id="2881549"><a href="/math/big/nat.go.html#2880792">x</a></span><span class="op" id="2881550">[</span><span class="num" id="2881551">0</span><span class="op" id="2881552">:</span><span class="ident" id="2881553"><a href="/math/big/nat.go.html#2881472">k</a></span><span class="op" id="2881554">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2881569">//&nbsp;x0&nbsp;is&nbsp;not&nbsp;normalized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2881594">y0</span>&nbsp;<span class="op" id="2881597">:=</span>&nbsp;<span class="ident" id="2881600"><a href="/math/big/nat.go.html#2880795">y</a></span><span class="op" id="2881601">[</span><span class="num" id="2881602">0</span><span class="op" id="2881603">:</span><span class="ident" id="2881604"><a href="/math/big/nat.go.html#2881472">k</a></span><span class="op" id="2881605">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2881620">//&nbsp;y0&nbsp;is&nbsp;not&nbsp;normalized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2881645"><a href="/math/big/nat.go.html#2880781">z</a></span>&nbsp;<span class="op" id="2881647">=</span>&nbsp;<span class="ident" id="2881649"><a href="/math/big/nat.go.html#2880781">z</a></span><span class="op" id="2881650">.</span><span class="builtinfunc" id="2881651">make</span><span class="op" id="2881655">(</span><span class="ident" id="2881656"><a href="/math/big/nat.go.html#2880330">max</a></span><span class="op" id="2881659">(</span><span class="num" id="2881660">6</span><span class="op" id="2881661">*</span><span class="ident" id="2881662"><a href="/math/big/nat.go.html#2881472">k</a></span><span class="op" id="2881663">,</span>&nbsp;<span class="ident" id="2881665"><a href="/math/big/nat.go.html#2880809">m</a></span><span class="op" id="2881666">+</span><span class="ident" id="2881667"><a href="/math/big/nat.go.html#2880822">n</a></span><span class="op" id="2881668">)</span><span class="op" id="2881669">)</span>&nbsp;<span class="comment" id="2881671">//&nbsp;enough&nbsp;space&nbsp;for&nbsp;karatsuba&nbsp;of&nbsp;x0*y0&nbsp;and&nbsp;full&nbsp;result&nbsp;of&nbsp;x*y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2881734"><a href="/math/big/nat.go.html#2877303">karatsuba</a></span><span class="op" id="2881743">(</span><span class="ident" id="2881744"><a href="/math/big/nat.go.html#2880781">z</a></span><span class="op" id="2881745">,</span>&nbsp;<span class="ident" id="2881747"><a href="/math/big/nat.go.html#2881543">x0</a></span><span class="op" id="2881749">,</span>&nbsp;<span class="ident" id="2881751"><a href="/math/big/nat.go.html#2881594">y0</a></span><span class="op" id="2881753">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2881756"><a href="/math/big/nat.go.html#2880781">z</a></span>&nbsp;<span class="op" id="2881758">=</span>&nbsp;<span class="ident" id="2881760"><a href="/math/big/nat.go.html#2880781">z</a></span><span class="op" id="2881761">[</span><span class="num" id="2881762">0</span>&nbsp;<span class="op" id="2881764">:</span>&nbsp;<span class="ident" id="2881766"><a href="/math/big/nat.go.html#2880809">m</a></span><span class="op" id="2881767">+</span><span class="ident" id="2881768"><a href="/math/big/nat.go.html#2880822">n</a></span><span class="op" id="2881769">]</span>&nbsp;&nbsp;<span class="comment" id="2881772">//&nbsp;z&nbsp;has&nbsp;final&nbsp;length&nbsp;but&nbsp;may&nbsp;be&nbsp;incomplete</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2881817"><a href="/math/big/nat.go.html#2880781">z</a></span><span class="op" id="2881818">[</span><span class="num" id="2881819">2</span><span class="op" id="2881820">*</span><span class="ident" id="2881821"><a href="/math/big/nat.go.html#2881472">k</a></span><span class="op" id="2881822">:</span><span class="op" id="2881823">]</span><span class="op" id="2881824">.</span><span class="ident" id="2881825">clear</span><span class="op" id="2881830">(</span><span class="op" id="2881831">)</span>&nbsp;<span class="comment" id="2881833">//&nbsp;upper&nbsp;portion&nbsp;of&nbsp;z&nbsp;is&nbsp;garbage&nbsp;(and&nbsp;2*k&nbsp;&lt;=&nbsp;m+n&nbsp;since&nbsp;k&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;m)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2881903">//&nbsp;If&nbsp;xh&nbsp;!=&nbsp;0&nbsp;or&nbsp;yh&nbsp;!=&nbsp;0,&nbsp;add&nbsp;the&nbsp;missing&nbsp;terms&nbsp;to&nbsp;z.&nbsp;For</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2881962">//</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2881966">//&nbsp;&nbsp;&nbsp;xh&nbsp;=&nbsp;xi*b^i&nbsp;+&nbsp;...&nbsp;+&nbsp;x2*b^2&nbsp;+&nbsp;x1*b&nbsp;(0&nbsp;&lt;=&nbsp;xi&nbsp;&lt;&nbsp;b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2882020">//&nbsp;&nbsp;&nbsp;yh&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y1*b&nbsp;(0&nbsp;&lt;=&nbsp;y1&nbsp;&lt;&nbsp;b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2882074">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2882078">//&nbsp;the&nbsp;missing&nbsp;terms&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2882104">//</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2882108">//&nbsp;&nbsp;&nbsp;x0*y1*b&nbsp;and&nbsp;xi*y0*b^i,&nbsp;xi*y1*b^(i+1)&nbsp;for&nbsp;i&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2882161">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2882165">//&nbsp;since&nbsp;all&nbsp;the&nbsp;yi&nbsp;for&nbsp;i&nbsp;&gt;&nbsp;1&nbsp;are&nbsp;0&nbsp;by&nbsp;choice&nbsp;of&nbsp;k:&nbsp;If&nbsp;any&nbsp;of&nbsp;them</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2882233">//&nbsp;were&nbsp;&gt;&nbsp;0,&nbsp;then&nbsp;yh&nbsp;&gt;=&nbsp;b^2&nbsp;and&nbsp;thus&nbsp;y&nbsp;&gt;=&nbsp;b^2.&nbsp;Then&nbsp;k&#39;&nbsp;=&nbsp;k*2&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2882301">//&nbsp;be&nbsp;a&nbsp;larger&nbsp;valid&nbsp;threshold&nbsp;contradicting&nbsp;the&nbsp;assumption&nbsp;about&nbsp;k.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2882371">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882375">if</span>&nbsp;<span class="ident" id="2882378"><a href="/math/big/nat.go.html#2881472">k</a></span>&nbsp;<span class="op" id="2882380">&lt;</span>&nbsp;<span class="ident" id="2882382"><a href="/math/big/nat.go.html#2880822">n</a></span>&nbsp;<span class="op" id="2882384">||</span>&nbsp;<span class="ident" id="2882387"><a href="/math/big/nat.go.html#2880809">m</a></span>&nbsp;<span class="op" id="2882389">!=</span>&nbsp;<span class="ident" id="2882392"><a href="/math/big/nat.go.html#2880822">n</a></span>&nbsp;<span class="op" id="2882394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882398">var</span>&nbsp;<span class="ident" id="2882402">t</span>&nbsp;<span class="ident" id="2882404"><a href="/math/big/nat.go.html#2873877">nat</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2882411">//&nbsp;add&nbsp;x0*y1*b</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882428">x0</span>&nbsp;<span class="op" id="2882431">:=</span>&nbsp;<span class="ident" id="2882434"><a href="/math/big/nat.go.html#2881543">x0</a></span><span class="op" id="2882436">.</span><span class="ident" id="2882437">norm</span><span class="op" id="2882441">(</span><span class="op" id="2882442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882446">y1</span>&nbsp;<span class="op" id="2882449">:=</span>&nbsp;<span class="ident" id="2882452"><a href="/math/big/nat.go.html#2880795">y</a></span><span class="op" id="2882453">[</span><span class="ident" id="2882454"><a href="/math/big/nat.go.html#2881472">k</a></span><span class="op" id="2882455">:</span><span class="op" id="2882456">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2882464">//&nbsp;y1&nbsp;is&nbsp;normalized&nbsp;because&nbsp;y&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882499"><a href="/math/big/nat.go.html#2882402">t</a></span>&nbsp;<span class="op" id="2882501">=</span>&nbsp;<span class="ident" id="2882503"><a href="/math/big/nat.go.html#2882402">t</a></span><span class="op" id="2882504">.</span><span class="ident" id="2882505">mul</span><span class="op" id="2882508">(</span><span class="ident" id="2882509"><a href="/math/big/nat.go.html#2882428">x0</a></span><span class="op" id="2882511">,</span>&nbsp;<span class="ident" id="2882513"><a href="/math/big/nat.go.html#2882446">y1</a></span><span class="op" id="2882515">)</span>&nbsp;<span class="comment" id="2882517">//&nbsp;update&nbsp;t&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;t&#39;s&nbsp;underlying&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882569"><a href="/math/big/nat.go.html#2880154">addAt</a></span><span class="op" id="2882574">(</span><span class="ident" id="2882575"><a href="/math/big/nat.go.html#2880781">z</a></span><span class="op" id="2882576">,</span>&nbsp;<span class="ident" id="2882578"><a href="/math/big/nat.go.html#2882402">t</a></span><span class="op" id="2882579">,</span>&nbsp;<span class="ident" id="2882581"><a href="/math/big/nat.go.html#2881472">k</a></span><span class="op" id="2882582">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2882587">//&nbsp;add&nbsp;xi*y0&lt;&lt;i,&nbsp;xi*y1*b&lt;&lt;(i+k)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882621">y0</span>&nbsp;<span class="op" id="2882624">:=</span>&nbsp;<span class="ident" id="2882627"><a href="/math/big/nat.go.html#2881594">y0</a></span><span class="op" id="2882629">.</span><span class="ident" id="2882630">norm</span><span class="op" id="2882634">(</span><span class="op" id="2882635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882639">for</span>&nbsp;<span class="ident" id="2882643">i</span>&nbsp;<span class="op" id="2882645">:=</span>&nbsp;<span class="ident" id="2882648"><a href="/math/big/nat.go.html#2881472">k</a></span><span class="op" id="2882649">;</span>&nbsp;<span class="ident" id="2882651"><a href="/math/big/nat.go.html#2882643">i</a></span>&nbsp;<span class="op" id="2882653">&lt;</span>&nbsp;<span class="builtinfunc" id="2882655">len</span><span class="op" id="2882658">(</span><span class="ident" id="2882659"><a href="/math/big/nat.go.html#2880792">x</a></span><span class="op" id="2882660">)</span><span class="op" id="2882661">;</span>&nbsp;<span class="ident" id="2882663"><a href="/math/big/nat.go.html#2882643">i</a></span>&nbsp;<span class="op" id="2882665">+=</span>&nbsp;<span class="ident" id="2882668"><a href="/math/big/nat.go.html#2881472">k</a></span>&nbsp;<span class="op" id="2882670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882675">xi</span>&nbsp;<span class="op" id="2882678">:=</span>&nbsp;<span class="ident" id="2882681"><a href="/math/big/nat.go.html#2880792">x</a></span><span class="op" id="2882682">[</span><span class="ident" id="2882683"><a href="/math/big/nat.go.html#2882643">i</a></span><span class="op" id="2882684">:</span><span class="op" id="2882685">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882690">if</span>&nbsp;<span class="builtinfunc" id="2882693">len</span><span class="op" id="2882696">(</span><span class="ident" id="2882697"><a href="/math/big/nat.go.html#2882675">xi</a></span><span class="op" id="2882699">)</span>&nbsp;<span class="op" id="2882701">&gt;</span>&nbsp;<span class="ident" id="2882703"><a href="/math/big/nat.go.html#2881472">k</a></span>&nbsp;<span class="op" id="2882705">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882711"><a href="/math/big/nat.go.html#2882675">xi</a></span>&nbsp;<span class="op" id="2882714">=</span>&nbsp;<span class="ident" id="2882716"><a href="/math/big/nat.go.html#2882675">xi</a></span><span class="op" id="2882718">[</span><span class="op" id="2882719">:</span><span class="ident" id="2882720"><a href="/math/big/nat.go.html#2881472">k</a></span><span class="op" id="2882721">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2882726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882731"><a href="/math/big/nat.go.html#2882675">xi</a></span>&nbsp;<span class="op" id="2882734">=</span>&nbsp;<span class="ident" id="2882736"><a href="/math/big/nat.go.html#2882675">xi</a></span><span class="op" id="2882738">.</span><span class="ident" id="2882739">norm</span><span class="op" id="2882743">(</span><span class="op" id="2882744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882749"><a href="/math/big/nat.go.html#2882402">t</a></span>&nbsp;<span class="op" id="2882751">=</span>&nbsp;<span class="ident" id="2882753"><a href="/math/big/nat.go.html#2882402">t</a></span><span class="op" id="2882754">.</span><span class="ident" id="2882755">mul</span><span class="op" id="2882758">(</span><span class="ident" id="2882759"><a href="/math/big/nat.go.html#2882675">xi</a></span><span class="op" id="2882761">,</span>&nbsp;<span class="ident" id="2882763"><a href="/math/big/nat.go.html#2882621">y0</a></span><span class="op" id="2882765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882770"><a href="/math/big/nat.go.html#2880154">addAt</a></span><span class="op" id="2882775">(</span><span class="ident" id="2882776"><a href="/math/big/nat.go.html#2880781">z</a></span><span class="op" id="2882777">,</span>&nbsp;<span class="ident" id="2882779"><a href="/math/big/nat.go.html#2882402">t</a></span><span class="op" id="2882780">,</span>&nbsp;<span class="ident" id="2882782"><a href="/math/big/nat.go.html#2882643">i</a></span><span class="op" id="2882783">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882788"><a href="/math/big/nat.go.html#2882402">t</a></span>&nbsp;<span class="op" id="2882790">=</span>&nbsp;<span class="ident" id="2882792"><a href="/math/big/nat.go.html#2882402">t</a></span><span class="op" id="2882793">.</span><span class="ident" id="2882794">mul</span><span class="op" id="2882797">(</span><span class="ident" id="2882798"><a href="/math/big/nat.go.html#2882675">xi</a></span><span class="op" id="2882800">,</span>&nbsp;<span class="ident" id="2882802"><a href="/math/big/nat.go.html#2882446">y1</a></span><span class="op" id="2882804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882809"><a href="/math/big/nat.go.html#2880154">addAt</a></span><span class="op" id="2882814">(</span><span class="ident" id="2882815"><a href="/math/big/nat.go.html#2880781">z</a></span><span class="op" id="2882816">,</span>&nbsp;<span class="ident" id="2882818"><a href="/math/big/nat.go.html#2882402">t</a></span><span class="op" id="2882819">,</span>&nbsp;<span class="ident" id="2882821"><a href="/math/big/nat.go.html#2882643">i</a></span><span class="op" id="2882822">+</span><span class="ident" id="2882823"><a href="/math/big/nat.go.html#2881472">k</a></span><span class="op" id="2882824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2882828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2882831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882835">return</span>&nbsp;<span class="ident" id="2882842"><a href="/math/big/nat.go.html#2880781">z</a></span><span class="op" id="2882843">.</span><span class="ident" id="2882844">norm</span><span class="op" id="2882848">(</span><span class="op" id="2882849">)</span><br>
<span class="lineno"></span><span class="op" id="2882851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2882854">//&nbsp;mulRange&nbsp;computes&nbsp;the&nbsp;product&nbsp;of&nbsp;all&nbsp;the&nbsp;unsigned&nbsp;integers&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2882923">//&nbsp;range&nbsp;[a,&nbsp;b]&nbsp;inclusively.&nbsp;If&nbsp;a&nbsp;&gt;&nbsp;b&nbsp;(empty&nbsp;range),&nbsp;the&nbsp;result&nbsp;is&nbsp;1.</span><br>
<span class="lineno">465</span><span class="keyword" id="2882993">func</span>&nbsp;<span class="op" id="2882998">(</span><span class="ident" id="2882999">z</span>&nbsp;<span class="ident" id="2883001"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2883004">)</span>&nbsp;<span class="ident" id="2883006">mulRange</span><span class="op" id="2883014">(</span><span class="ident" id="2883015">a</span><span class="op" id="2883016">,</span>&nbsp;<span class="ident" id="2883018">b</span>&nbsp;<span class="ident" id="2883020">uint64</span><span class="op" id="2883026">)</span>&nbsp;<span class="ident" id="2883028"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2883032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883035">switch</span>&nbsp;<span class="op" id="2883042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883045">case</span>&nbsp;<span class="ident" id="2883050"><a href="/math/big/nat.go.html#2883015">a</a></span>&nbsp;<span class="op" id="2883052">==</span>&nbsp;<span class="num" id="2883055">0</span><span class="op" id="2883056">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2883060">//&nbsp;cut&nbsp;long&nbsp;ranges&nbsp;short&nbsp;(optimization)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883102">return</span>&nbsp;<span class="ident" id="2883109"><a href="/math/big/nat.go.html#2882999">z</a></span><span class="op" id="2883110">.</span><span class="ident" id="2883111">setUint64</span><span class="op" id="2883120">(</span><span class="num" id="2883121">0</span><span class="op" id="2883122">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883125">case</span>&nbsp;<span class="ident" id="2883130"><a href="/math/big/nat.go.html#2883015">a</a></span>&nbsp;<span class="op" id="2883132">&gt;</span>&nbsp;<span class="ident" id="2883134"><a href="/math/big/nat.go.html#2883018">b</a></span><span class="op" id="2883135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883139">return</span>&nbsp;<span class="ident" id="2883146"><a href="/math/big/nat.go.html#2882999">z</a></span><span class="op" id="2883147">.</span><span class="ident" id="2883148">setUint64</span><span class="op" id="2883157">(</span><span class="num" id="2883158">1</span><span class="op" id="2883159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883162">case</span>&nbsp;<span class="ident" id="2883167"><a href="/math/big/nat.go.html#2883015">a</a></span>&nbsp;<span class="op" id="2883169">==</span>&nbsp;<span class="ident" id="2883172"><a href="/math/big/nat.go.html#2883018">b</a></span><span class="op" id="2883173">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883177">return</span>&nbsp;<span class="ident" id="2883184"><a href="/math/big/nat.go.html#2882999">z</a></span><span class="op" id="2883185">.</span><span class="ident" id="2883186">setUint64</span><span class="op" id="2883195">(</span><span class="ident" id="2883196"><a href="/math/big/nat.go.html#2883015">a</a></span><span class="op" id="2883197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883200">case</span>&nbsp;<span class="ident" id="2883205"><a href="/math/big/nat.go.html#2883015">a</a></span><span class="op" id="2883206">+</span><span class="num" id="2883207">1</span>&nbsp;<span class="op" id="2883209">==</span>&nbsp;<span class="ident" id="2883212"><a href="/math/big/nat.go.html#2883018">b</a></span><span class="op" id="2883213">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883217">return</span>&nbsp;<span class="ident" id="2883224"><a href="/math/big/nat.go.html#2882999">z</a></span><span class="op" id="2883225">.</span><span class="ident" id="2883226">mul</span><span class="op" id="2883229">(</span><span class="ident" id="2883230"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2883233">(</span><span class="ident" id="2883234">nil</span><span class="op" id="2883237">)</span><span class="op" id="2883238">.</span><span class="ident" id="2883239">setUint64</span><span class="op" id="2883248">(</span><span class="ident" id="2883249"><a href="/math/big/nat.go.html#2883015">a</a></span><span class="op" id="2883250">)</span><span class="op" id="2883251">,</span>&nbsp;<span class="ident" id="2883253"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2883256">(</span><span class="ident" id="2883257">nil</span><span class="op" id="2883260">)</span><span class="op" id="2883261">.</span><span class="ident" id="2883262">setUint64</span><span class="op" id="2883271">(</span><span class="ident" id="2883272"><a href="/math/big/nat.go.html#2883018">b</a></span><span class="op" id="2883273">)</span><span class="op" id="2883274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883280">m</span>&nbsp;<span class="op" id="2883282">:=</span>&nbsp;<span class="op" id="2883285">(</span><span class="ident" id="2883286"><a href="/math/big/nat.go.html#2883015">a</a></span>&nbsp;<span class="op" id="2883288">+</span>&nbsp;<span class="ident" id="2883290"><a href="/math/big/nat.go.html#2883018">b</a></span><span class="op" id="2883291">)</span>&nbsp;<span class="op" id="2883293">/</span>&nbsp;<span class="num" id="2883295">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883298">return</span>&nbsp;<span class="ident" id="2883305"><a href="/math/big/nat.go.html#2882999">z</a></span><span class="op" id="2883306">.</span><span class="ident" id="2883307">mul</span><span class="op" id="2883310">(</span><span class="ident" id="2883311"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2883314">(</span><span class="ident" id="2883315">nil</span><span class="op" id="2883318">)</span><span class="op" id="2883319">.</span><span class="ident" id="2883320">mulRange</span><span class="op" id="2883328">(</span><span class="ident" id="2883329"><a href="/math/big/nat.go.html#2883015">a</a></span><span class="op" id="2883330">,</span>&nbsp;<span class="ident" id="2883332"><a href="/math/big/nat.go.html#2883280">m</a></span><span class="op" id="2883333">)</span><span class="op" id="2883334">,</span>&nbsp;<span class="ident" id="2883336"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2883339">(</span><span class="ident" id="2883340">nil</span><span class="op" id="2883343">)</span><span class="op" id="2883344">.</span><span class="ident" id="2883345">mulRange</span><span class="op" id="2883353">(</span><span class="ident" id="2883354"><a href="/math/big/nat.go.html#2883280">m</a></span><span class="op" id="2883355">+</span><span class="num" id="2883356">1</span><span class="op" id="2883357">,</span>&nbsp;<span class="ident" id="2883359"><a href="/math/big/nat.go.html#2883018">b</a></span><span class="op" id="2883360">)</span><span class="op" id="2883361">)</span><br>
<span class="lineno"></span><span class="op" id="2883363">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="comment" id="2883366">//&nbsp;q&nbsp;=&nbsp;(x-r)/y,&nbsp;with&nbsp;0&nbsp;&lt;=&nbsp;r&nbsp;&lt;&nbsp;y</span><br>
<span class="lineno"></span><span class="keyword" id="2883398">func</span>&nbsp;<span class="op" id="2883403">(</span><span class="ident" id="2883404">z</span>&nbsp;<span class="ident" id="2883406"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2883409">)</span>&nbsp;<span class="ident" id="2883411">divW</span><span class="op" id="2883415">(</span><span class="ident" id="2883416">x</span>&nbsp;<span class="ident" id="2883418"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2883421">,</span>&nbsp;<span class="ident" id="2883423">y</span>&nbsp;<span class="ident" id="2883425"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2883429">)</span>&nbsp;<span class="op" id="2883431">(</span><span class="ident" id="2883432">q</span>&nbsp;<span class="ident" id="2883434"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2883437">,</span>&nbsp;<span class="ident" id="2883439">r</span>&nbsp;<span class="ident" id="2883441"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2883445">)</span>&nbsp;<span class="op" id="2883447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883450">m</span>&nbsp;<span class="op" id="2883452">:=</span>&nbsp;<span class="builtinfunc" id="2883455">len</span><span class="op" id="2883458">(</span><span class="ident" id="2883459"><a href="/math/big/nat.go.html#2883416">x</a></span><span class="op" id="2883460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883463">switch</span>&nbsp;<span class="op" id="2883470">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883473">case</span>&nbsp;<span class="ident" id="2883478"><a href="/math/big/nat.go.html#2883423">y</a></span>&nbsp;<span class="op" id="2883480">==</span>&nbsp;<span class="num" id="2883483">0</span><span class="op" id="2883484">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2883488">panic</span><span class="op" id="2883493">(</span><span class="string" id="2883494">&#34;division&nbsp;by&nbsp;zero&#34;</span><span class="op" id="2883512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883515">case</span>&nbsp;<span class="ident" id="2883520"><a href="/math/big/nat.go.html#2883423">y</a></span>&nbsp;<span class="op" id="2883522">==</span>&nbsp;<span class="num" id="2883525">1</span><span class="op" id="2883526">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883530"><a href="/math/big/nat.go.html#2883432">q</a></span>&nbsp;<span class="op" id="2883532">=</span>&nbsp;<span class="ident" id="2883534"><a href="/math/big/nat.go.html#2883404">z</a></span><span class="op" id="2883535">.</span><span class="ident" id="2883536">set</span><span class="op" id="2883539">(</span><span class="ident" id="2883540"><a href="/math/big/nat.go.html#2883416">x</a></span><span class="op" id="2883541">)</span>&nbsp;<span class="comment" id="2883543">//&nbsp;result&nbsp;is&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883560">return</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883568">case</span>&nbsp;<span class="ident" id="2883573"><a href="/math/big/nat.go.html#2883450">m</a></span>&nbsp;<span class="op" id="2883575">==</span>&nbsp;<span class="num" id="2883578">0</span><span class="op" id="2883579">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883583"><a href="/math/big/nat.go.html#2883432">q</a></span>&nbsp;<span class="op" id="2883585">=</span>&nbsp;<span class="ident" id="2883587"><a href="/math/big/nat.go.html#2883404">z</a></span><span class="op" id="2883588">.</span><span class="builtinfunc" id="2883589">make</span><span class="op" id="2883593">(</span><span class="num" id="2883594">0</span><span class="op" id="2883595">)</span>&nbsp;<span class="comment" id="2883597">//&nbsp;result&nbsp;is&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883614">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2883625">//&nbsp;m&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883635"><a href="/math/big/nat.go.html#2883404">z</a></span>&nbsp;<span class="op" id="2883637">=</span>&nbsp;<span class="ident" id="2883639"><a href="/math/big/nat.go.html#2883404">z</a></span><span class="op" id="2883640">.</span><span class="builtinfunc" id="2883641">make</span><span class="op" id="2883645">(</span><span class="ident" id="2883646"><a href="/math/big/nat.go.html#2883450">m</a></span><span class="op" id="2883647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883650"><a href="/math/big/nat.go.html#2883439">r</a></span>&nbsp;<span class="op" id="2883652">=</span>&nbsp;<span class="ident" id="2883654"><a href="/math/big/arith_decl.go.html#2847222">divWVW</a></span><span class="op" id="2883660">(</span><span class="ident" id="2883661"><a href="/math/big/nat.go.html#2883404">z</a></span><span class="op" id="2883662">,</span>&nbsp;<span class="num" id="2883664">0</span><span class="op" id="2883665">,</span>&nbsp;<span class="ident" id="2883667"><a href="/math/big/nat.go.html#2883416">x</a></span><span class="op" id="2883668">,</span>&nbsp;<span class="ident" id="2883670"><a href="/math/big/nat.go.html#2883423">y</a></span><span class="op" id="2883671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883674"><a href="/math/big/nat.go.html#2883432">q</a></span>&nbsp;<span class="op" id="2883676">=</span>&nbsp;<span class="ident" id="2883678"><a href="/math/big/nat.go.html#2883404">z</a></span><span class="op" id="2883679">.</span><span class="ident" id="2883680">norm</span><span class="op" id="2883684">(</span><span class="op" id="2883685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883688">return</span><br>
<span class="lineno"></span><span class="op" id="2883695">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span><span class="keyword" id="2883698">func</span>&nbsp;<span class="op" id="2883703">(</span><span class="ident" id="2883704">z</span>&nbsp;<span class="ident" id="2883706"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2883709">)</span>&nbsp;<span class="ident" id="2883711">div</span><span class="op" id="2883714">(</span><span class="ident" id="2883715">z2</span><span class="op" id="2883717">,</span>&nbsp;<span class="ident" id="2883719">u</span><span class="op" id="2883720">,</span>&nbsp;<span class="ident" id="2883722">v</span>&nbsp;<span class="ident" id="2883724"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2883727">)</span>&nbsp;<span class="op" id="2883729">(</span><span class="ident" id="2883730">q</span><span class="op" id="2883731">,</span>&nbsp;<span class="ident" id="2883733">r</span>&nbsp;<span class="ident" id="2883735"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2883738">)</span>&nbsp;<span class="op" id="2883740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883743">if</span>&nbsp;<span class="builtinfunc" id="2883746">len</span><span class="op" id="2883749">(</span><span class="ident" id="2883750"><a href="/math/big/nat.go.html#2883722">v</a></span><span class="op" id="2883751">)</span>&nbsp;<span class="op" id="2883753">==</span>&nbsp;<span class="num" id="2883756">0</span>&nbsp;<span class="op" id="2883758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2883762">panic</span><span class="op" id="2883767">(</span><span class="string" id="2883768">&#34;division&nbsp;by&nbsp;zero&#34;</span><span class="op" id="2883786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883789">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883793">if</span>&nbsp;<span class="ident" id="2883796"><a href="/math/big/nat.go.html#2883719">u</a></span><span class="op" id="2883797">.</span><span class="ident" id="2883798">cmp</span><span class="op" id="2883801">(</span><span class="ident" id="2883802"><a href="/math/big/nat.go.html#2883722">v</a></span><span class="op" id="2883803">)</span>&nbsp;<span class="op" id="2883805">&lt;</span>&nbsp;<span class="num" id="2883807">0</span>&nbsp;<span class="op" id="2883809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883813"><a href="/math/big/nat.go.html#2883730">q</a></span>&nbsp;<span class="op" id="2883815">=</span>&nbsp;<span class="ident" id="2883817"><a href="/math/big/nat.go.html#2883704">z</a></span><span class="op" id="2883818">.</span><span class="builtinfunc" id="2883819">make</span><span class="op" id="2883823">(</span><span class="num" id="2883824">0</span><span class="op" id="2883825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883829"><a href="/math/big/nat.go.html#2883733">r</a></span>&nbsp;<span class="op" id="2883831">=</span>&nbsp;<span class="ident" id="2883833"><a href="/math/big/nat.go.html#2883715">z2</a></span><span class="op" id="2883835">.</span><span class="ident" id="2883836">set</span><span class="op" id="2883839">(</span><span class="ident" id="2883840"><a href="/math/big/nat.go.html#2883719">u</a></span><span class="op" id="2883841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883845">return</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883857">if</span>&nbsp;<span class="builtinfunc" id="2883860">len</span><span class="op" id="2883863">(</span><span class="ident" id="2883864"><a href="/math/big/nat.go.html#2883722">v</a></span><span class="op" id="2883865">)</span>&nbsp;<span class="op" id="2883867">==</span>&nbsp;<span class="num" id="2883870">1</span>&nbsp;<span class="op" id="2883872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883876">var</span>&nbsp;<span class="ident" id="2883880">r2</span>&nbsp;<span class="ident" id="2883883"><a href="/math/big/arith.go.html#2842733">Word</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883890"><a href="/math/big/nat.go.html#2883730">q</a></span><span class="op" id="2883891">,</span>&nbsp;<span class="ident" id="2883893"><a href="/math/big/nat.go.html#2883880">r2</a></span>&nbsp;<span class="op" id="2883896">=</span>&nbsp;<span class="ident" id="2883898"><a href="/math/big/nat.go.html#2883704">z</a></span><span class="op" id="2883899">.</span><span class="ident" id="2883900">divW</span><span class="op" id="2883904">(</span><span class="ident" id="2883905"><a href="/math/big/nat.go.html#2883719">u</a></span><span class="op" id="2883906">,</span>&nbsp;<span class="ident" id="2883908"><a href="/math/big/nat.go.html#2883722">v</a></span><span class="op" id="2883909">[</span><span class="num" id="2883910">0</span><span class="op" id="2883911">]</span><span class="op" id="2883912">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883916"><a href="/math/big/nat.go.html#2883733">r</a></span>&nbsp;<span class="op" id="2883918">=</span>&nbsp;<span class="ident" id="2883920"><a href="/math/big/nat.go.html#2883715">z2</a></span><span class="op" id="2883922">.</span><span class="ident" id="2883923">setWord</span><span class="op" id="2883930">(</span><span class="ident" id="2883931"><a href="/math/big/nat.go.html#2883880">r2</a></span><span class="op" id="2883933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883937">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883949"><a href="/math/big/nat.go.html#2883730">q</a></span><span class="op" id="2883950">,</span>&nbsp;<span class="ident" id="2883952"><a href="/math/big/nat.go.html#2883733">r</a></span>&nbsp;<span class="op" id="2883954">=</span>&nbsp;<span class="ident" id="2883956"><a href="/math/big/nat.go.html#2883704">z</a></span><span class="op" id="2883957">.</span><span class="ident" id="2883958">divLarge</span><span class="op" id="2883966">(</span><span class="ident" id="2883967"><a href="/math/big/nat.go.html#2883715">z2</a></span><span class="op" id="2883969">,</span>&nbsp;<span class="ident" id="2883971"><a href="/math/big/nat.go.html#2883719">u</a></span><span class="op" id="2883972">,</span>&nbsp;<span class="ident" id="2883974"><a href="/math/big/nat.go.html#2883722">v</a></span><span class="op" id="2883975">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883978">return</span><br>
<span class="lineno"></span><span class="op" id="2883985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2883988">//&nbsp;q&nbsp;=&nbsp;(uIn-r)/v,&nbsp;with&nbsp;0&nbsp;&lt;=&nbsp;r&nbsp;&lt;&nbsp;y</span><br>
<span class="lineno"></span><span class="comment" id="2884022">//&nbsp;Uses&nbsp;z&nbsp;as&nbsp;storage&nbsp;for&nbsp;q,&nbsp;and&nbsp;u&nbsp;as&nbsp;storage&nbsp;for&nbsp;r&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">525</span><span class="comment" id="2884086">//&nbsp;See&nbsp;Knuth,&nbsp;Volume&nbsp;2,&nbsp;section&nbsp;4.3.1,&nbsp;Algorithm&nbsp;D.</span><br>
<span class="lineno"></span><span class="comment" id="2884138">//&nbsp;Preconditions:</span><br>
<span class="lineno"></span><span class="comment" id="2884156">//&nbsp;&nbsp;&nbsp;&nbsp;len(v)&nbsp;&gt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2884174">//&nbsp;&nbsp;&nbsp;&nbsp;len(uIn)&nbsp;&gt;=&nbsp;len(v)</span><br>
<span class="lineno"></span><span class="keyword" id="2884199">func</span>&nbsp;<span class="op" id="2884204">(</span><span class="ident" id="2884205">z</span>&nbsp;<span class="ident" id="2884207"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2884210">)</span>&nbsp;<span class="ident" id="2884212">divLarge</span><span class="op" id="2884220">(</span><span class="ident" id="2884221">u</span><span class="op" id="2884222">,</span>&nbsp;<span class="ident" id="2884224">uIn</span><span class="op" id="2884227">,</span>&nbsp;<span class="ident" id="2884229">v</span>&nbsp;<span class="ident" id="2884231"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2884234">)</span>&nbsp;<span class="op" id="2884236">(</span><span class="ident" id="2884237">q</span><span class="op" id="2884238">,</span>&nbsp;<span class="ident" id="2884240">r</span>&nbsp;<span class="ident" id="2884242"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2884245">)</span>&nbsp;<span class="op" id="2884247">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884250">n</span>&nbsp;<span class="op" id="2884252">:=</span>&nbsp;<span class="builtinfunc" id="2884255">len</span><span class="op" id="2884258">(</span><span class="ident" id="2884259"><a href="/math/big/nat.go.html#2884229">v</a></span><span class="op" id="2884260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884263">m</span>&nbsp;<span class="op" id="2884265">:=</span>&nbsp;<span class="builtinfunc" id="2884268">len</span><span class="op" id="2884271">(</span><span class="ident" id="2884272"><a href="/math/big/nat.go.html#2884224">uIn</a></span><span class="op" id="2884275">)</span>&nbsp;<span class="op" id="2884277">-</span>&nbsp;<span class="ident" id="2884279"><a href="/math/big/nat.go.html#2884250">n</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2884283">//&nbsp;determine&nbsp;if&nbsp;z&nbsp;can&nbsp;be&nbsp;reused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2884316">//&nbsp;TODO(gri)&nbsp;should&nbsp;find&nbsp;a&nbsp;better&nbsp;solution&nbsp;-&nbsp;this&nbsp;if&nbsp;statement</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2884380">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;very&nbsp;costly&nbsp;(see&nbsp;e.g.&nbsp;time&nbsp;pidigits&nbsp;-s&nbsp;-n&nbsp;10000)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884446">if</span>&nbsp;<span class="ident" id="2884449"><a href="/math/big/nat.go.html#2879855">alias</a></span><span class="op" id="2884454">(</span><span class="ident" id="2884455"><a href="/math/big/nat.go.html#2884205">z</a></span><span class="op" id="2884456">,</span>&nbsp;<span class="ident" id="2884458"><a href="/math/big/nat.go.html#2884224">uIn</a></span><span class="op" id="2884461">)</span>&nbsp;<span class="op" id="2884463">||</span>&nbsp;<span class="ident" id="2884466"><a href="/math/big/nat.go.html#2879855">alias</a></span><span class="op" id="2884471">(</span><span class="ident" id="2884472"><a href="/math/big/nat.go.html#2884205">z</a></span><span class="op" id="2884473">,</span>&nbsp;<span class="ident" id="2884475"><a href="/math/big/nat.go.html#2884229">v</a></span><span class="op" id="2884476">)</span>&nbsp;<span class="op" id="2884478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884482"><a href="/math/big/nat.go.html#2884205">z</a></span>&nbsp;<span class="op" id="2884484">=</span>&nbsp;<span class="ident" id="2884486">nil</span>&nbsp;<span class="comment" id="2884490">//&nbsp;z&nbsp;is&nbsp;an&nbsp;alias&nbsp;for&nbsp;uIn&nbsp;or&nbsp;v&nbsp;-&nbsp;cannot&nbsp;reuse</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2884536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884539"><a href="/math/big/nat.go.html#2884237">q</a></span>&nbsp;<span class="op" id="2884541">=</span>&nbsp;<span class="ident" id="2884543"><a href="/math/big/nat.go.html#2884205">z</a></span><span class="op" id="2884544">.</span><span class="builtinfunc" id="2884545">make</span><span class="op" id="2884549">(</span><span class="ident" id="2884550"><a href="/math/big/nat.go.html#2884263">m</a></span>&nbsp;<span class="op" id="2884552">+</span>&nbsp;<span class="num" id="2884554">1</span><span class="op" id="2884555">)</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884559">qhatv</span>&nbsp;<span class="op" id="2884565">:=</span>&nbsp;<span class="builtinfunc" id="2884568">make</span><span class="op" id="2884572">(</span><span class="ident" id="2884573"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2884576">,</span>&nbsp;<span class="ident" id="2884578"><a href="/math/big/nat.go.html#2884250">n</a></span><span class="op" id="2884579">+</span><span class="num" id="2884580">1</span><span class="op" id="2884581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884584">if</span>&nbsp;<span class="ident" id="2884587"><a href="/math/big/nat.go.html#2879855">alias</a></span><span class="op" id="2884592">(</span><span class="ident" id="2884593"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2884594">,</span>&nbsp;<span class="ident" id="2884596"><a href="/math/big/nat.go.html#2884224">uIn</a></span><span class="op" id="2884599">)</span>&nbsp;<span class="op" id="2884601">||</span>&nbsp;<span class="ident" id="2884604"><a href="/math/big/nat.go.html#2879855">alias</a></span><span class="op" id="2884609">(</span><span class="ident" id="2884610"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2884611">,</span>&nbsp;<span class="ident" id="2884613"><a href="/math/big/nat.go.html#2884229">v</a></span><span class="op" id="2884614">)</span>&nbsp;<span class="op" id="2884616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884620"><a href="/math/big/nat.go.html#2884221">u</a></span>&nbsp;<span class="op" id="2884622">=</span>&nbsp;<span class="ident" id="2884624">nil</span>&nbsp;<span class="comment" id="2884628">//&nbsp;u&nbsp;is&nbsp;an&nbsp;alias&nbsp;for&nbsp;uIn&nbsp;or&nbsp;v&nbsp;-&nbsp;cannot&nbsp;reuse</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2884674">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884677"><a href="/math/big/nat.go.html#2884221">u</a></span>&nbsp;<span class="op" id="2884679">=</span>&nbsp;<span class="ident" id="2884681"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2884682">.</span><span class="builtinfunc" id="2884683">make</span><span class="op" id="2884687">(</span><span class="builtinfunc" id="2884688">len</span><span class="op" id="2884691">(</span><span class="ident" id="2884692"><a href="/math/big/nat.go.html#2884224">uIn</a></span><span class="op" id="2884695">)</span>&nbsp;<span class="op" id="2884697">+</span>&nbsp;<span class="num" id="2884699">1</span><span class="op" id="2884700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884703"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2884704">.</span><span class="ident" id="2884705">clear</span><span class="op" id="2884710">(</span><span class="op" id="2884711">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2884715">//&nbsp;D1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884723">shift</span>&nbsp;<span class="op" id="2884729">:=</span>&nbsp;<span class="ident" id="2884732"><a href="/math/big/arith.go.html#2844506">leadingZeros</a></span><span class="op" id="2884744">(</span><span class="ident" id="2884745"><a href="/math/big/nat.go.html#2884229">v</a></span><span class="op" id="2884746">[</span><span class="ident" id="2884747"><a href="/math/big/nat.go.html#2884250">n</a></span><span class="op" id="2884748">-</span><span class="num" id="2884749">1</span><span class="op" id="2884750">]</span><span class="op" id="2884751">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884754">if</span>&nbsp;<span class="ident" id="2884757"><a href="/math/big/nat.go.html#2884723">shift</a></span>&nbsp;<span class="op" id="2884763">&gt;</span>&nbsp;<span class="num" id="2884765">0</span>&nbsp;<span class="op" id="2884767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2884771">//&nbsp;do&nbsp;not&nbsp;modify&nbsp;v,&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;by&nbsp;another&nbsp;goroutine&nbsp;simultaneously</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884844">v1</span>&nbsp;<span class="op" id="2884847">:=</span>&nbsp;<span class="builtinfunc" id="2884850">make</span><span class="op" id="2884854">(</span><span class="ident" id="2884855"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2884858">,</span>&nbsp;<span class="ident" id="2884860"><a href="/math/big/nat.go.html#2884250">n</a></span><span class="op" id="2884861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884865"><a href="/math/big/arith_decl.go.html#2847047">shlVU</a></span><span class="op" id="2884870">(</span><span class="ident" id="2884871"><a href="/math/big/nat.go.html#2884844">v1</a></span><span class="op" id="2884873">,</span>&nbsp;<span class="ident" id="2884875"><a href="/math/big/nat.go.html#2884229">v</a></span><span class="op" id="2884876">,</span>&nbsp;<span class="ident" id="2884878"><a href="/math/big/nat.go.html#2884723">shift</a></span><span class="op" id="2884883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884887"><a href="/math/big/nat.go.html#2884229">v</a></span>&nbsp;<span class="op" id="2884889">=</span>&nbsp;<span class="ident" id="2884891"><a href="/math/big/nat.go.html#2884844">v1</a></span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2884895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884898"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2884899">[</span><span class="builtinfunc" id="2884900">len</span><span class="op" id="2884903">(</span><span class="ident" id="2884904"><a href="/math/big/nat.go.html#2884224">uIn</a></span><span class="op" id="2884907">)</span><span class="op" id="2884908">]</span>&nbsp;<span class="op" id="2884910">=</span>&nbsp;<span class="ident" id="2884912"><a href="/math/big/arith_decl.go.html#2847047">shlVU</a></span><span class="op" id="2884917">(</span><span class="ident" id="2884918"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2884919">[</span><span class="num" id="2884920">0</span><span class="op" id="2884921">:</span><span class="builtinfunc" id="2884922">len</span><span class="op" id="2884925">(</span><span class="ident" id="2884926"><a href="/math/big/nat.go.html#2884224">uIn</a></span><span class="op" id="2884929">)</span><span class="op" id="2884930">]</span><span class="op" id="2884931">,</span>&nbsp;<span class="ident" id="2884933"><a href="/math/big/nat.go.html#2884224">uIn</a></span><span class="op" id="2884936">,</span>&nbsp;<span class="ident" id="2884938"><a href="/math/big/nat.go.html#2884723">shift</a></span><span class="op" id="2884943">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2884947">//&nbsp;D2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884955">for</span>&nbsp;<span class="ident" id="2884959">j</span>&nbsp;<span class="op" id="2884961">:=</span>&nbsp;<span class="ident" id="2884964"><a href="/math/big/nat.go.html#2884263">m</a></span><span class="op" id="2884965">;</span>&nbsp;<span class="ident" id="2884967"><a href="/math/big/nat.go.html#2884959">j</a></span>&nbsp;<span class="op" id="2884969">&gt;=</span>&nbsp;<span class="num" id="2884972">0</span><span class="op" id="2884973">;</span>&nbsp;<span class="ident" id="2884975"><a href="/math/big/nat.go.html#2884959">j</a></span><span class="op" id="2884976">--</span>&nbsp;<span class="op" id="2884979">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2884983">//&nbsp;D3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884992">qhat</span>&nbsp;<span class="op" id="2884997">:=</span>&nbsp;<span class="ident" id="2885000"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2885004">(</span><span class="ident" id="2885005"><a href="/math/big/arith.go.html#2842941">_M</a></span><span class="op" id="2885007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885011">if</span>&nbsp;<span class="ident" id="2885014"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2885015">[</span><span class="ident" id="2885016"><a href="/math/big/nat.go.html#2884959">j</a></span><span class="op" id="2885017">+</span><span class="ident" id="2885018"><a href="/math/big/nat.go.html#2884250">n</a></span><span class="op" id="2885019">]</span>&nbsp;<span class="op" id="2885021">!=</span>&nbsp;<span class="ident" id="2885024"><a href="/math/big/nat.go.html#2884229">v</a></span><span class="op" id="2885025">[</span><span class="ident" id="2885026"><a href="/math/big/nat.go.html#2884250">n</a></span><span class="op" id="2885027">-</span><span class="num" id="2885028">1</span><span class="op" id="2885029">]</span>&nbsp;<span class="op" id="2885031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885036">var</span>&nbsp;<span class="ident" id="2885040">rhat</span>&nbsp;<span class="ident" id="2885045"><a href="/math/big/arith.go.html#2842733">Word</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885053"><a href="/math/big/nat.go.html#2884992">qhat</a></span><span class="op" id="2885057">,</span>&nbsp;<span class="ident" id="2885059"><a href="/math/big/nat.go.html#2885040">rhat</a></span>&nbsp;<span class="op" id="2885064">=</span>&nbsp;<span class="ident" id="2885066"><a href="/math/big/arith_decl.go.html#2846854">divWW</a></span><span class="op" id="2885071">(</span><span class="ident" id="2885072"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2885073">[</span><span class="ident" id="2885074"><a href="/math/big/nat.go.html#2884959">j</a></span><span class="op" id="2885075">+</span><span class="ident" id="2885076"><a href="/math/big/nat.go.html#2884250">n</a></span><span class="op" id="2885077">]</span><span class="op" id="2885078">,</span>&nbsp;<span class="ident" id="2885080"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2885081">[</span><span class="ident" id="2885082"><a href="/math/big/nat.go.html#2884959">j</a></span><span class="op" id="2885083">+</span><span class="ident" id="2885084"><a href="/math/big/nat.go.html#2884250">n</a></span><span class="op" id="2885085">-</span><span class="num" id="2885086">1</span><span class="op" id="2885087">]</span><span class="op" id="2885088">,</span>&nbsp;<span class="ident" id="2885090"><a href="/math/big/nat.go.html#2884229">v</a></span><span class="op" id="2885091">[</span><span class="ident" id="2885092"><a href="/math/big/nat.go.html#2884250">n</a></span><span class="op" id="2885093">-</span><span class="num" id="2885094">1</span><span class="op" id="2885095">]</span><span class="op" id="2885096">)</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885102">//&nbsp;x1&nbsp;|&nbsp;x2&nbsp;=&nbsp;q̂v_{n-2}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885129">x1</span><span class="op" id="2885131">,</span>&nbsp;<span class="ident" id="2885133">x2</span>&nbsp;<span class="op" id="2885136">:=</span>&nbsp;<span class="ident" id="2885139"><a href="/math/big/arith_decl.go.html#2846818">mulWW</a></span><span class="op" id="2885144">(</span><span class="ident" id="2885145"><a href="/math/big/nat.go.html#2884992">qhat</a></span><span class="op" id="2885149">,</span>&nbsp;<span class="ident" id="2885151"><a href="/math/big/nat.go.html#2884229">v</a></span><span class="op" id="2885152">[</span><span class="ident" id="2885153"><a href="/math/big/nat.go.html#2884250">n</a></span><span class="op" id="2885154">-</span><span class="num" id="2885155">2</span><span class="op" id="2885156">]</span><span class="op" id="2885157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885162">//&nbsp;test&nbsp;if&nbsp;q̂v_{n-2}&nbsp;&gt;&nbsp;br̂&nbsp;+&nbsp;u_{j+n-2}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885206">for</span>&nbsp;<span class="ident" id="2885210"><a href="/math/big/nat.go.html#2900682">greaterThan</a></span><span class="op" id="2885221">(</span><span class="ident" id="2885222"><a href="/math/big/nat.go.html#2885129">x1</a></span><span class="op" id="2885224">,</span>&nbsp;<span class="ident" id="2885226"><a href="/math/big/nat.go.html#2885133">x2</a></span><span class="op" id="2885228">,</span>&nbsp;<span class="ident" id="2885230"><a href="/math/big/nat.go.html#2885040">rhat</a></span><span class="op" id="2885234">,</span>&nbsp;<span class="ident" id="2885236"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2885237">[</span><span class="ident" id="2885238"><a href="/math/big/nat.go.html#2884959">j</a></span><span class="op" id="2885239">+</span><span class="ident" id="2885240"><a href="/math/big/nat.go.html#2884250">n</a></span><span class="op" id="2885241">-</span><span class="num" id="2885242">2</span><span class="op" id="2885243">]</span><span class="op" id="2885244">)</span>&nbsp;<span class="op" id="2885246">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885252"><a href="/math/big/nat.go.html#2884992">qhat</a></span><span class="op" id="2885256">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885263">prevRhat</span>&nbsp;<span class="op" id="2885272">:=</span>&nbsp;<span class="ident" id="2885275"><a href="/math/big/nat.go.html#2885040">rhat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885284"><a href="/math/big/nat.go.html#2885040">rhat</a></span>&nbsp;<span class="op" id="2885289">+=</span>&nbsp;<span class="ident" id="2885292"><a href="/math/big/nat.go.html#2884229">v</a></span><span class="op" id="2885293">[</span><span class="ident" id="2885294"><a href="/math/big/nat.go.html#2884250">n</a></span><span class="op" id="2885295">-</span><span class="num" id="2885296">1</span><span class="op" id="2885297">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885303">//&nbsp;v[n-1]&nbsp;&gt;=&nbsp;0,&nbsp;so&nbsp;this&nbsp;tests&nbsp;for&nbsp;overflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885351">if</span>&nbsp;<span class="ident" id="2885354"><a href="/math/big/nat.go.html#2885040">rhat</a></span>&nbsp;<span class="op" id="2885359">&lt;</span>&nbsp;<span class="ident" id="2885361"><a href="/math/big/nat.go.html#2885263">prevRhat</a></span>&nbsp;<span class="op" id="2885370">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885377">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885393"><a href="/math/big/nat.go.html#2885129">x1</a></span><span class="op" id="2885395">,</span>&nbsp;<span class="ident" id="2885397"><a href="/math/big/nat.go.html#2885133">x2</a></span>&nbsp;<span class="op" id="2885400">=</span>&nbsp;<span class="ident" id="2885402"><a href="/math/big/arith_decl.go.html#2846818">mulWW</a></span><span class="op" id="2885407">(</span><span class="ident" id="2885408"><a href="/math/big/nat.go.html#2884992">qhat</a></span><span class="op" id="2885412">,</span>&nbsp;<span class="ident" id="2885414"><a href="/math/big/nat.go.html#2884229">v</a></span><span class="op" id="2885415">[</span><span class="ident" id="2885416"><a href="/math/big/nat.go.html#2884250">n</a></span><span class="op" id="2885417">-</span><span class="num" id="2885418">2</span><span class="op" id="2885419">]</span><span class="op" id="2885420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885429">}</span><br>
<span class="lineno">580</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2885434">//&nbsp;D4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885443"><a href="/math/big/nat.go.html#2884559">qhatv</a></span><span class="op" id="2885448">[</span><span class="ident" id="2885449"><a href="/math/big/nat.go.html#2884250">n</a></span><span class="op" id="2885450">]</span>&nbsp;<span class="op" id="2885452">=</span>&nbsp;<span class="ident" id="2885454"><a href="/math/big/arith_decl.go.html#2847129">mulAddVWW</a></span><span class="op" id="2885463">(</span><span class="ident" id="2885464"><a href="/math/big/nat.go.html#2884559">qhatv</a></span><span class="op" id="2885469">[</span><span class="num" id="2885470">0</span><span class="op" id="2885471">:</span><span class="ident" id="2885472"><a href="/math/big/nat.go.html#2884250">n</a></span><span class="op" id="2885473">]</span><span class="op" id="2885474">,</span>&nbsp;<span class="ident" id="2885476"><a href="/math/big/nat.go.html#2884229">v</a></span><span class="op" id="2885477">,</span>&nbsp;<span class="ident" id="2885479"><a href="/math/big/nat.go.html#2884992">qhat</a></span><span class="op" id="2885483">,</span>&nbsp;<span class="num" id="2885485">0</span><span class="op" id="2885486">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885491">c</span>&nbsp;<span class="op" id="2885493">:=</span>&nbsp;<span class="ident" id="2885496"><a href="/math/big/arith_decl.go.html#2846929">subVV</a></span><span class="op" id="2885501">(</span><span class="ident" id="2885502"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2885503">[</span><span class="ident" id="2885504"><a href="/math/big/nat.go.html#2884959">j</a></span><span class="op" id="2885505">:</span><span class="ident" id="2885506"><a href="/math/big/nat.go.html#2884959">j</a></span><span class="op" id="2885507">+</span><span class="builtinfunc" id="2885508">len</span><span class="op" id="2885511">(</span><span class="ident" id="2885512"><a href="/math/big/nat.go.html#2884559">qhatv</a></span><span class="op" id="2885517">)</span><span class="op" id="2885518">]</span><span class="op" id="2885519">,</span>&nbsp;<span class="ident" id="2885521"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2885522">[</span><span class="ident" id="2885523"><a href="/math/big/nat.go.html#2884959">j</a></span><span class="op" id="2885524">:</span><span class="op" id="2885525">]</span><span class="op" id="2885526">,</span>&nbsp;<span class="ident" id="2885528"><a href="/math/big/nat.go.html#2884559">qhatv</a></span><span class="op" id="2885533">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885537">if</span>&nbsp;<span class="ident" id="2885540"><a href="/math/big/nat.go.html#2885491">c</a></span>&nbsp;<span class="op" id="2885542">!=</span>&nbsp;<span class="num" id="2885545">0</span>&nbsp;<span class="op" id="2885547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885552">c</span>&nbsp;<span class="op" id="2885554">:=</span>&nbsp;<span class="ident" id="2885557"><a href="/math/big/arith_decl.go.html#2846893">addVV</a></span><span class="op" id="2885562">(</span><span class="ident" id="2885563"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2885564">[</span><span class="ident" id="2885565"><a href="/math/big/nat.go.html#2884959">j</a></span><span class="op" id="2885566">:</span><span class="ident" id="2885567"><a href="/math/big/nat.go.html#2884959">j</a></span><span class="op" id="2885568">+</span><span class="ident" id="2885569"><a href="/math/big/nat.go.html#2884250">n</a></span><span class="op" id="2885570">]</span><span class="op" id="2885571">,</span>&nbsp;<span class="ident" id="2885573"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2885574">[</span><span class="ident" id="2885575"><a href="/math/big/nat.go.html#2884959">j</a></span><span class="op" id="2885576">:</span><span class="op" id="2885577">]</span><span class="op" id="2885578">,</span>&nbsp;<span class="ident" id="2885580"><a href="/math/big/nat.go.html#2884229">v</a></span><span class="op" id="2885581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885586"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2885587">[</span><span class="ident" id="2885588"><a href="/math/big/nat.go.html#2884959">j</a></span><span class="op" id="2885589">+</span><span class="ident" id="2885590"><a href="/math/big/nat.go.html#2884250">n</a></span><span class="op" id="2885591">]</span>&nbsp;<span class="op" id="2885593">+=</span>&nbsp;<span class="ident" id="2885596"><a href="/math/big/nat.go.html#2885552">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885601"><a href="/math/big/nat.go.html#2884992">qhat</a></span><span class="op" id="2885605">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885610">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885615"><a href="/math/big/nat.go.html#2884237">q</a></span><span class="op" id="2885616">[</span><span class="ident" id="2885617"><a href="/math/big/nat.go.html#2884959">j</a></span><span class="op" id="2885618">]</span>&nbsp;<span class="op" id="2885620">=</span>&nbsp;<span class="ident" id="2885622"><a href="/math/big/nat.go.html#2884992">qhat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885632"><a href="/math/big/nat.go.html#2884237">q</a></span>&nbsp;<span class="op" id="2885634">=</span>&nbsp;<span class="ident" id="2885636"><a href="/math/big/nat.go.html#2884237">q</a></span><span class="op" id="2885637">.</span><span class="ident" id="2885638">norm</span><span class="op" id="2885642">(</span><span class="op" id="2885643">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885646"><a href="/math/big/arith_decl.go.html#2847088">shrVU</a></span><span class="op" id="2885651">(</span><span class="ident" id="2885652"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2885653">,</span>&nbsp;<span class="ident" id="2885655"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2885656">,</span>&nbsp;<span class="ident" id="2885658"><a href="/math/big/nat.go.html#2884723">shift</a></span><span class="op" id="2885663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885666"><a href="/math/big/nat.go.html#2884240">r</a></span>&nbsp;<span class="op" id="2885668">=</span>&nbsp;<span class="ident" id="2885670"><a href="/math/big/nat.go.html#2884221">u</a></span><span class="op" id="2885671">.</span><span class="ident" id="2885672">norm</span><span class="op" id="2885676">(</span><span class="op" id="2885677">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885681">return</span>&nbsp;<span class="ident" id="2885688"><a href="/math/big/nat.go.html#2884237">q</a></span><span class="op" id="2885689">,</span>&nbsp;<span class="ident" id="2885691"><a href="/math/big/nat.go.html#2884240">r</a></span><br>
<span class="lineno"></span><span class="op" id="2885693">}</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span><span class="comment" id="2885696">//&nbsp;Length&nbsp;of&nbsp;x&nbsp;in&nbsp;bits.&nbsp;x&nbsp;must&nbsp;be&nbsp;normalized.</span><br>
<span class="lineno"></span><span class="keyword" id="2885742">func</span>&nbsp;<span class="op" id="2885747">(</span><span class="ident" id="2885748">x</span>&nbsp;<span class="ident" id="2885750"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2885753">)</span>&nbsp;<span class="ident" id="2885755">bitLen</span><span class="op" id="2885761">(</span><span class="op" id="2885762">)</span>&nbsp;<span class="builtintype" id="2885764">int</span>&nbsp;<span class="op" id="2885768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885771">if</span>&nbsp;<span class="ident" id="2885774">i</span>&nbsp;<span class="op" id="2885776">:=</span>&nbsp;<span class="builtinfunc" id="2885779">len</span><span class="op" id="2885782">(</span><span class="ident" id="2885783"><a href="/math/big/nat.go.html#2885748">x</a></span><span class="op" id="2885784">)</span>&nbsp;<span class="op" id="2885786">-</span>&nbsp;<span class="num" id="2885788">1</span><span class="op" id="2885789">;</span>&nbsp;<span class="ident" id="2885791"><a href="/math/big/nat.go.html#2885774">i</a></span>&nbsp;<span class="op" id="2885793">&gt;=</span>&nbsp;<span class="num" id="2885796">0</span>&nbsp;<span class="op" id="2885798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885802">return</span>&nbsp;<span class="ident" id="2885809"><a href="/math/big/nat.go.html#2885774">i</a></span><span class="op" id="2885810">*</span><span class="ident" id="2885811"><a href="/math/big/arith.go.html#2842878">_W</a></span>&nbsp;<span class="op" id="2885814">+</span>&nbsp;<span class="ident" id="2885816"><a href="/math/big/arith_decl.go.html#2847280">bitLen</a></span><span class="op" id="2885822">(</span><span class="ident" id="2885823"><a href="/math/big/nat.go.html#2885748">x</a></span><span class="op" id="2885824">[</span><span class="ident" id="2885825"><a href="/math/big/nat.go.html#2885774">i</a></span><span class="op" id="2885826">]</span><span class="op" id="2885827">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885833">return</span>&nbsp;<span class="num" id="2885840">0</span><br>
<span class="lineno"></span><span class="op" id="2885842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2885845">//&nbsp;MaxBase&nbsp;is&nbsp;the&nbsp;largest&nbsp;number&nbsp;base&nbsp;accepted&nbsp;for&nbsp;string&nbsp;conversions.</span><br>
<span class="lineno">610</span><span class="keyword" id="2885916">const</span>&nbsp;<span class="ident" id="2885922">MaxBase</span>&nbsp;<span class="op" id="2885930">=</span>&nbsp;<span class="string" id="2885932">&#39;z&#39;</span>&nbsp;<span class="op" id="2885936">-</span>&nbsp;<span class="string" id="2885938">&#39;a&#39;</span>&nbsp;<span class="op" id="2885942">+</span>&nbsp;<span class="num" id="2885944">10</span>&nbsp;<span class="op" id="2885947">+</span>&nbsp;<span class="num" id="2885949">1</span>&nbsp;<span class="comment" id="2885951">//&nbsp;=&nbsp;hexValue(&#39;z&#39;)&nbsp;+&nbsp;1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2885975">func</span>&nbsp;<span class="ident" id="2885980">hexValue</span><span class="op" id="2885988">(</span><span class="ident" id="2885989">ch</span>&nbsp;<span class="builtintype" id="2885992">rune</span><span class="op" id="2885996">)</span>&nbsp;<span class="ident" id="2885998"><a href="/math/big/arith.go.html#2842733">Word</a></span>&nbsp;<span class="op" id="2886003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2886006">d</span>&nbsp;<span class="op" id="2886008">:=</span>&nbsp;<span class="builtintype" id="2886011">int</span><span class="op" id="2886014">(</span><span class="ident" id="2886015"><a href="/math/big/nat.go.html#2885922">MaxBase</a></span>&nbsp;<span class="op" id="2886023">+</span>&nbsp;<span class="num" id="2886025">1</span><span class="op" id="2886026">)</span>&nbsp;<span class="comment" id="2886028">//&nbsp;illegal&nbsp;base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2886045">switch</span>&nbsp;<span class="op" id="2886052">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2886055">case</span>&nbsp;<span class="string" id="2886060">&#39;0&#39;</span>&nbsp;<span class="op" id="2886064">&lt;=</span>&nbsp;<span class="ident" id="2886067"><a href="/math/big/nat.go.html#2885989">ch</a></span>&nbsp;<span class="op" id="2886070">&amp;&amp;</span>&nbsp;<span class="ident" id="2886073"><a href="/math/big/nat.go.html#2885989">ch</a></span>&nbsp;<span class="op" id="2886076">&lt;=</span>&nbsp;<span class="string" id="2886079">&#39;9&#39;</span><span class="op" id="2886082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2886086"><a href="/math/big/nat.go.html#2886006">d</a></span>&nbsp;<span class="op" id="2886088">=</span>&nbsp;<span class="builtintype" id="2886090">int</span><span class="op" id="2886093">(</span><span class="ident" id="2886094"><a href="/math/big/nat.go.html#2885989">ch</a></span>&nbsp;<span class="op" id="2886097">-</span>&nbsp;<span class="string" id="2886099">&#39;0&#39;</span><span class="op" id="2886102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2886105">case</span>&nbsp;<span class="string" id="2886110">&#39;a&#39;</span>&nbsp;<span class="op" id="2886114">&lt;=</span>&nbsp;<span class="ident" id="2886117"><a href="/math/big/nat.go.html#2885989">ch</a></span>&nbsp;<span class="op" id="2886120">&amp;&amp;</span>&nbsp;<span class="ident" id="2886123"><a href="/math/big/nat.go.html#2885989">ch</a></span>&nbsp;<span class="op" id="2886126">&lt;=</span>&nbsp;<span class="string" id="2886129">&#39;z&#39;</span><span class="op" id="2886132">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2886136"><a href="/math/big/nat.go.html#2886006">d</a></span>&nbsp;<span class="op" id="2886138">=</span>&nbsp;<span class="builtintype" id="2886140">int</span><span class="op" id="2886143">(</span><span class="ident" id="2886144"><a href="/math/big/nat.go.html#2885989">ch</a></span>&nbsp;<span class="op" id="2886147">-</span>&nbsp;<span class="string" id="2886149">&#39;a&#39;</span>&nbsp;<span class="op" id="2886153">+</span>&nbsp;<span class="num" id="2886155">10</span><span class="op" id="2886157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2886160">case</span>&nbsp;<span class="string" id="2886165">&#39;A&#39;</span>&nbsp;<span class="op" id="2886169">&lt;=</span>&nbsp;<span class="ident" id="2886172"><a href="/math/big/nat.go.html#2885989">ch</a></span>&nbsp;<span class="op" id="2886175">&amp;&amp;</span>&nbsp;<span class="ident" id="2886178"><a href="/math/big/nat.go.html#2885989">ch</a></span>&nbsp;<span class="op" id="2886181">&lt;=</span>&nbsp;<span class="string" id="2886184">&#39;Z&#39;</span><span class="op" id="2886187">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2886191"><a href="/math/big/nat.go.html#2886006">d</a></span>&nbsp;<span class="op" id="2886193">=</span>&nbsp;<span class="builtintype" id="2886195">int</span><span class="op" id="2886198">(</span><span class="ident" id="2886199"><a href="/math/big/nat.go.html#2885989">ch</a></span>&nbsp;<span class="op" id="2886202">-</span>&nbsp;<span class="string" id="2886204">&#39;A&#39;</span>&nbsp;<span class="op" id="2886208">+</span>&nbsp;<span class="num" id="2886210">10</span><span class="op" id="2886212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2886215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2886218">return</span>&nbsp;<span class="ident" id="2886225"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2886229">(</span><span class="ident" id="2886230"><a href="/math/big/nat.go.html#2886006">d</a></span><span class="op" id="2886231">)</span><br>
<span class="lineno"></span><span class="op" id="2886233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="comment" id="2886236">//&nbsp;scan&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;natural&nbsp;number&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;longest&nbsp;possible&nbsp;prefix</span><br>
<span class="lineno"></span><span class="comment" id="2886318">//&nbsp;read&nbsp;from&nbsp;r&nbsp;representing&nbsp;an&nbsp;unsigned&nbsp;integer&nbsp;in&nbsp;a&nbsp;given&nbsp;conversion&nbsp;base.</span><br>
<span class="lineno"></span><span class="comment" id="2886394">//&nbsp;It&nbsp;returns&nbsp;z,&nbsp;the&nbsp;actual&nbsp;conversion&nbsp;base&nbsp;used,&nbsp;and&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.&nbsp;In&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2886473">//&nbsp;error&nbsp;case,&nbsp;the&nbsp;value&nbsp;of&nbsp;z&nbsp;is&nbsp;undefined.&nbsp;The&nbsp;syntax&nbsp;follows&nbsp;the&nbsp;syntax&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2886550">//&nbsp;unsigned&nbsp;integer&nbsp;literals&nbsp;in&nbsp;Go.</span><br>
<span class="lineno">630</span><span class="comment" id="2886586">//</span><br>
<span class="lineno"></span><span class="comment" id="2886589">//&nbsp;The&nbsp;base&nbsp;argument&nbsp;must&nbsp;be&nbsp;0&nbsp;or&nbsp;a&nbsp;value&nbsp;from&nbsp;2&nbsp;through&nbsp;MaxBase.&nbsp;If&nbsp;the&nbsp;base</span><br>
<span class="lineno"></span><span class="comment" id="2886667">//&nbsp;is&nbsp;0,&nbsp;the&nbsp;string&nbsp;prefix&nbsp;determines&nbsp;the&nbsp;actual&nbsp;conversion&nbsp;base.&nbsp;A&nbsp;prefix&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2886745">//&nbsp;``0x&#39;&#39;&nbsp;or&nbsp;``0X&#39;&#39;&nbsp;selects&nbsp;base&nbsp;16;&nbsp;the&nbsp;``0&#39;&#39;&nbsp;prefix&nbsp;selects&nbsp;base&nbsp;8,&nbsp;and&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2886821">//&nbsp;``0b&#39;&#39;&nbsp;or&nbsp;``0B&#39;&#39;&nbsp;prefix&nbsp;selects&nbsp;base&nbsp;2.&nbsp;Otherwise&nbsp;the&nbsp;selected&nbsp;base&nbsp;is&nbsp;10.</span><br>
<span class="lineno">635</span><span class="comment" id="2886899">//</span><br>
<span class="lineno"></span><span class="keyword" id="2886902">func</span>&nbsp;<span class="op" id="2886907">(</span><span class="ident" id="2886908">z</span>&nbsp;<span class="ident" id="2886910"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2886913">)</span>&nbsp;<span class="ident" id="2886915">scan</span><span class="op" id="2886919">(</span><span class="ident" id="2886920">r</span>&nbsp;<span class="ident" id="2886922"><a href="/math/big/nat.go.html#2873327">io</a></span><span class="op" id="2886924">.</span><span class="ident" id="2886925">RuneScanner</span><span class="op" id="2886936">,</span>&nbsp;<span class="ident" id="2886938">base</span>&nbsp;<span class="builtintype" id="2886943">int</span><span class="op" id="2886946">)</span>&nbsp;<span class="op" id="2886948">(</span><span class="ident" id="2886949"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2886952">,</span>&nbsp;<span class="builtintype" id="2886954">int</span><span class="op" id="2886957">,</span>&nbsp;<span class="builtintype" id="2886959">error</span><span class="op" id="2886964">)</span>&nbsp;<span class="op" id="2886966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2886969">//&nbsp;reject&nbsp;illegal&nbsp;bases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2886994">if</span>&nbsp;<span class="ident" id="2886997"><a href="/math/big/nat.go.html#2886938">base</a></span>&nbsp;<span class="op" id="2887002">&lt;</span>&nbsp;<span class="num" id="2887004">0</span>&nbsp;<span class="op" id="2887006">||</span>&nbsp;<span class="ident" id="2887009"><a href="/math/big/nat.go.html#2886938">base</a></span>&nbsp;<span class="op" id="2887014">==</span>&nbsp;<span class="num" id="2887017">1</span>&nbsp;<span class="op" id="2887019">||</span>&nbsp;<span class="ident" id="2887022"><a href="/math/big/nat.go.html#2885922">MaxBase</a></span>&nbsp;<span class="op" id="2887030">&lt;</span>&nbsp;<span class="ident" id="2887032"><a href="/math/big/nat.go.html#2886938">base</a></span>&nbsp;<span class="op" id="2887037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887041">return</span>&nbsp;<span class="ident" id="2887048"><a href="/math/big/nat.go.html#2886908">z</a></span><span class="op" id="2887049">,</span>&nbsp;<span class="num" id="2887051">0</span><span class="op" id="2887052">,</span>&nbsp;<span class="ident" id="2887054"><a href="/math/big/nat.go.html#2873317">errors</a></span><span class="op" id="2887060">.</span><span class="ident" id="2887061">New</span><span class="op" id="2887064">(</span><span class="string" id="2887065">&#34;illegal&nbsp;number&nbsp;base&#34;</span><span class="op" id="2887086">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2887089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887093">//&nbsp;one&nbsp;char&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887117">ch</span><span class="op" id="2887119">,</span>&nbsp;<span class="ident" id="2887121">_</span><span class="op" id="2887122">,</span>&nbsp;<span class="ident" id="2887124">err</span>&nbsp;<span class="op" id="2887128">:=</span>&nbsp;<span class="ident" id="2887131"><a href="/math/big/nat.go.html#2886920">r</a></span><span class="op" id="2887132">.</span><span class="ident" id="2887133">ReadRune</span><span class="op" id="2887141">(</span><span class="op" id="2887142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887145">if</span>&nbsp;<span class="ident" id="2887148"><a href="/math/big/nat.go.html#2887124">err</a></span>&nbsp;<span class="op" id="2887152">!=</span>&nbsp;<span class="ident" id="2887155">nil</span>&nbsp;<span class="op" id="2887159">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887163">return</span>&nbsp;<span class="ident" id="2887170"><a href="/math/big/nat.go.html#2886908">z</a></span><span class="op" id="2887171">,</span>&nbsp;<span class="num" id="2887173">0</span><span class="op" id="2887174">,</span>&nbsp;<span class="ident" id="2887176"><a href="/math/big/nat.go.html#2887124">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2887181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887185">//&nbsp;determine&nbsp;base&nbsp;if&nbsp;necessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887217">b</span>&nbsp;<span class="op" id="2887219">:=</span>&nbsp;<span class="ident" id="2887222"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2887226">(</span><span class="ident" id="2887227"><a href="/math/big/nat.go.html#2886938">base</a></span><span class="op" id="2887231">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887234">if</span>&nbsp;<span class="ident" id="2887237"><a href="/math/big/nat.go.html#2886938">base</a></span>&nbsp;<span class="op" id="2887242">==</span>&nbsp;<span class="num" id="2887245">0</span>&nbsp;<span class="op" id="2887247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887251"><a href="/math/big/nat.go.html#2887217">b</a></span>&nbsp;<span class="op" id="2887253">=</span>&nbsp;<span class="num" id="2887255">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887260">if</span>&nbsp;<span class="ident" id="2887263"><a href="/math/big/nat.go.html#2887117">ch</a></span>&nbsp;<span class="op" id="2887266">==</span>&nbsp;<span class="string" id="2887269">&#39;0&#39;</span>&nbsp;<span class="op" id="2887273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887278">switch</span>&nbsp;<span class="ident" id="2887285"><a href="/math/big/nat.go.html#2887117">ch</a></span><span class="op" id="2887287">,</span>&nbsp;<span class="ident" id="2887289">_</span><span class="op" id="2887290">,</span>&nbsp;<span class="ident" id="2887292"><a href="/math/big/nat.go.html#2887124">err</a></span>&nbsp;<span class="op" id="2887296">=</span>&nbsp;<span class="ident" id="2887298"><a href="/math/big/nat.go.html#2886920">r</a></span><span class="op" id="2887299">.</span><span class="ident" id="2887300">ReadRune</span><span class="op" id="2887308">(</span><span class="op" id="2887309">)</span><span class="op" id="2887310">;</span>&nbsp;<span class="ident" id="2887312"><a href="/math/big/nat.go.html#2887124">err</a></span>&nbsp;<span class="op" id="2887316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887321">case</span>&nbsp;<span class="ident" id="2887326">nil</span><span class="op" id="2887329">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887335"><a href="/math/big/nat.go.html#2887217">b</a></span>&nbsp;<span class="op" id="2887337">=</span>&nbsp;<span class="num" id="2887339">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887345">switch</span>&nbsp;<span class="ident" id="2887352"><a href="/math/big/nat.go.html#2887117">ch</a></span>&nbsp;<span class="op" id="2887355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887361">case</span>&nbsp;<span class="string" id="2887366">&#39;x&#39;</span><span class="op" id="2887369">,</span>&nbsp;<span class="string" id="2887371">&#39;X&#39;</span><span class="op" id="2887374">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887381"><a href="/math/big/nat.go.html#2887217">b</a></span>&nbsp;<span class="op" id="2887383">=</span>&nbsp;<span class="num" id="2887385">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887392">case</span>&nbsp;<span class="string" id="2887397">&#39;b&#39;</span><span class="op" id="2887400">,</span>&nbsp;<span class="string" id="2887402">&#39;B&#39;</span><span class="op" id="2887405">:</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887412"><a href="/math/big/nat.go.html#2887217">b</a></span>&nbsp;<span class="op" id="2887414">=</span>&nbsp;<span class="num" id="2887416">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2887422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887428">if</span>&nbsp;<span class="ident" id="2887431"><a href="/math/big/nat.go.html#2887217">b</a></span>&nbsp;<span class="op" id="2887433">==</span>&nbsp;<span class="num" id="2887436">2</span>&nbsp;<span class="op" id="2887438">||</span>&nbsp;<span class="ident" id="2887441"><a href="/math/big/nat.go.html#2887217">b</a></span>&nbsp;<span class="op" id="2887443">==</span>&nbsp;<span class="num" id="2887446">16</span>&nbsp;<span class="op" id="2887449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887456">if</span>&nbsp;<span class="ident" id="2887459"><a href="/math/big/nat.go.html#2887117">ch</a></span><span class="op" id="2887461">,</span>&nbsp;<span class="ident" id="2887463">_</span><span class="op" id="2887464">,</span>&nbsp;<span class="ident" id="2887466"><a href="/math/big/nat.go.html#2887124">err</a></span>&nbsp;<span class="op" id="2887470">=</span>&nbsp;<span class="ident" id="2887472"><a href="/math/big/nat.go.html#2886920">r</a></span><span class="op" id="2887473">.</span><span class="ident" id="2887474">ReadRune</span><span class="op" id="2887482">(</span><span class="op" id="2887483">)</span><span class="op" id="2887484">;</span>&nbsp;<span class="ident" id="2887486"><a href="/math/big/nat.go.html#2887124">err</a></span>&nbsp;<span class="op" id="2887490">!=</span>&nbsp;<span class="ident" id="2887493">nil</span>&nbsp;<span class="op" id="2887497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887505">return</span>&nbsp;<span class="ident" id="2887512"><a href="/math/big/nat.go.html#2886908">z</a></span><span class="op" id="2887513">,</span>&nbsp;<span class="num" id="2887515">0</span><span class="op" id="2887516">,</span>&nbsp;<span class="ident" id="2887518"><a href="/math/big/nat.go.html#2887124">err</a></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2887527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2887533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887538">case</span>&nbsp;<span class="ident" id="2887543"><a href="/math/big/nat.go.html#2873327">io</a></span><span class="op" id="2887545">.</span><span class="ident" id="2887546">EOF</span><span class="op" id="2887549">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887555">return</span>&nbsp;<span class="ident" id="2887562"><a href="/math/big/nat.go.html#2886908">z</a></span><span class="op" id="2887563">.</span><span class="builtinfunc" id="2887564">make</span><span class="op" id="2887568">(</span><span class="num" id="2887569">0</span><span class="op" id="2887570">)</span><span class="op" id="2887571">,</span>&nbsp;<span class="num" id="2887573">10</span><span class="op" id="2887575">,</span>&nbsp;<span class="ident" id="2887577">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887584">default</span><span class="op" id="2887591">:</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887597">return</span>&nbsp;<span class="ident" id="2887604"><a href="/math/big/nat.go.html#2886908">z</a></span><span class="op" id="2887605">,</span>&nbsp;<span class="num" id="2887607">10</span><span class="op" id="2887609">,</span>&nbsp;<span class="ident" id="2887611"><a href="/math/big/nat.go.html#2887124">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2887618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2887622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2887625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887629">//&nbsp;convert&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887648">//&nbsp;-&nbsp;group&nbsp;as&nbsp;many&nbsp;digits&nbsp;d&nbsp;as&nbsp;possible&nbsp;together&nbsp;into&nbsp;a&nbsp;&#34;super-digit&#34;&nbsp;dd&nbsp;with&nbsp;&#34;super-base&#34;&nbsp;bb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2887743">//&nbsp;-&nbsp;only&nbsp;when&nbsp;bb&nbsp;does&nbsp;not&nbsp;fit&nbsp;into&nbsp;a&nbsp;word&nbsp;anymore,&nbsp;do&nbsp;a&nbsp;full&nbsp;number&nbsp;mulAddWW&nbsp;using&nbsp;bb&nbsp;and&nbsp;dd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887838"><a href="/math/big/nat.go.html#2886908">z</a></span>&nbsp;<span class="op" id="2887840">=</span>&nbsp;<span class="ident" id="2887842"><a href="/math/big/nat.go.html#2886908">z</a></span><span class="op" id="2887843">.</span><span class="builtinfunc" id="2887844">make</span><span class="op" id="2887848">(</span><span class="num" id="2887849">0</span><span class="op" id="2887850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887853">bb</span>&nbsp;<span class="op" id="2887856">:=</span>&nbsp;<span class="ident" id="2887859"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2887863">(</span><span class="num" id="2887864">1</span><span class="op" id="2887865">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887868">dd</span>&nbsp;<span class="op" id="2887871">:=</span>&nbsp;<span class="ident" id="2887874"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2887878">(</span><span class="num" id="2887879">0</span><span class="op" id="2887880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887883">for</span>&nbsp;<span class="ident" id="2887887">max</span>&nbsp;<span class="op" id="2887891">:=</span>&nbsp;<span class="ident" id="2887894"><a href="/math/big/arith.go.html#2842941">_M</a></span>&nbsp;<span class="op" id="2887897">/</span>&nbsp;<span class="ident" id="2887899"><a href="/math/big/nat.go.html#2887217">b</a></span><span class="op" id="2887900">;</span>&nbsp;<span class="op" id="2887902">;</span>&nbsp;<span class="op" id="2887904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887908">d</span>&nbsp;<span class="op" id="2887910">:=</span>&nbsp;<span class="ident" id="2887913"><a href="/math/big/nat.go.html#2885980">hexValue</a></span><span class="op" id="2887921">(</span><span class="ident" id="2887922"><a href="/math/big/nat.go.html#2887117">ch</a></span><span class="op" id="2887924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887928">if</span>&nbsp;<span class="ident" id="2887931"><a href="/math/big/nat.go.html#2887908">d</a></span>&nbsp;<span class="op" id="2887933">&gt;=</span>&nbsp;<span class="ident" id="2887936"><a href="/math/big/nat.go.html#2887217">b</a></span>&nbsp;<span class="op" id="2887938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2887943"><a href="/math/big/nat.go.html#2886920">r</a></span><span class="op" id="2887944">.</span><span class="ident" id="2887945">UnreadRune</span><span class="op" id="2887955">(</span><span class="op" id="2887956">)</span>&nbsp;<span class="comment" id="2887958">//&nbsp;ch&nbsp;does&nbsp;not&nbsp;belong&nbsp;to&nbsp;number&nbsp;anymore</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888001">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2888009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888014">if</span>&nbsp;<span class="ident" id="2888017"><a href="/math/big/nat.go.html#2887853">bb</a></span>&nbsp;<span class="op" id="2888020">&lt;=</span>&nbsp;<span class="ident" id="2888023"><a href="/math/big/nat.go.html#2887887">max</a></span>&nbsp;<span class="op" id="2888027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888032"><a href="/math/big/nat.go.html#2887853">bb</a></span>&nbsp;<span class="op" id="2888035">*=</span>&nbsp;<span class="ident" id="2888038"><a href="/math/big/nat.go.html#2887217">b</a></span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888043"><a href="/math/big/nat.go.html#2887868">dd</a></span>&nbsp;<span class="op" id="2888046">=</span>&nbsp;<span class="ident" id="2888048"><a href="/math/big/nat.go.html#2887868">dd</a></span><span class="op" id="2888050">*</span><span class="ident" id="2888051"><a href="/math/big/nat.go.html#2887217">b</a></span>&nbsp;<span class="op" id="2888053">+</span>&nbsp;<span class="ident" id="2888055"><a href="/math/big/nat.go.html#2887908">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2888059">}</span>&nbsp;<span class="keyword" id="2888061">else</span>&nbsp;<span class="op" id="2888066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888071">//&nbsp;bb&nbsp;*&nbsp;b&nbsp;would&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888099"><a href="/math/big/nat.go.html#2886908">z</a></span>&nbsp;<span class="op" id="2888101">=</span>&nbsp;<span class="ident" id="2888103"><a href="/math/big/nat.go.html#2886908">z</a></span><span class="op" id="2888104">.</span><span class="ident" id="2888105">mulAddWW</span><span class="op" id="2888113">(</span><span class="ident" id="2888114"><a href="/math/big/nat.go.html#2886908">z</a></span><span class="op" id="2888115">,</span>&nbsp;<span class="ident" id="2888117"><a href="/math/big/nat.go.html#2887853">bb</a></span><span class="op" id="2888119">,</span>&nbsp;<span class="ident" id="2888121"><a href="/math/big/nat.go.html#2887868">dd</a></span><span class="op" id="2888123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888128"><a href="/math/big/nat.go.html#2887853">bb</a></span>&nbsp;<span class="op" id="2888131">=</span>&nbsp;<span class="ident" id="2888133"><a href="/math/big/nat.go.html#2887217">b</a></span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888138"><a href="/math/big/nat.go.html#2887868">dd</a></span>&nbsp;<span class="op" id="2888141">=</span>&nbsp;<span class="ident" id="2888143"><a href="/math/big/nat.go.html#2887908">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2888147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888152">if</span>&nbsp;<span class="ident" id="2888155"><a href="/math/big/nat.go.html#2887117">ch</a></span><span class="op" id="2888157">,</span>&nbsp;<span class="ident" id="2888159">_</span><span class="op" id="2888160">,</span>&nbsp;<span class="ident" id="2888162"><a href="/math/big/nat.go.html#2887124">err</a></span>&nbsp;<span class="op" id="2888166">=</span>&nbsp;<span class="ident" id="2888168"><a href="/math/big/nat.go.html#2886920">r</a></span><span class="op" id="2888169">.</span><span class="ident" id="2888170">ReadRune</span><span class="op" id="2888178">(</span><span class="op" id="2888179">)</span><span class="op" id="2888180">;</span>&nbsp;<span class="ident" id="2888182"><a href="/math/big/nat.go.html#2887124">err</a></span>&nbsp;<span class="op" id="2888186">!=</span>&nbsp;<span class="ident" id="2888189">nil</span>&nbsp;<span class="op" id="2888193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888198">if</span>&nbsp;<span class="ident" id="2888201"><a href="/math/big/nat.go.html#2887124">err</a></span>&nbsp;<span class="op" id="2888205">!=</span>&nbsp;<span class="ident" id="2888208"><a href="/math/big/nat.go.html#2873327">io</a></span><span class="op" id="2888210">.</span><span class="ident" id="2888211">EOF</span>&nbsp;<span class="op" id="2888215">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888221">return</span>&nbsp;<span class="ident" id="2888228"><a href="/math/big/nat.go.html#2886908">z</a></span><span class="op" id="2888229">,</span>&nbsp;<span class="builtintype" id="2888231">int</span><span class="op" id="2888234">(</span><span class="ident" id="2888235"><a href="/math/big/nat.go.html#2887217">b</a></span><span class="op" id="2888236">)</span><span class="op" id="2888237">,</span>&nbsp;<span class="ident" id="2888239"><a href="/math/big/nat.go.html#2887124">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2888246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888251">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2888259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2888262">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888266">switch</span>&nbsp;<span class="op" id="2888273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888276">case</span>&nbsp;<span class="ident" id="2888281"><a href="/math/big/nat.go.html#2887853">bb</a></span>&nbsp;<span class="op" id="2888284">&gt;</span>&nbsp;<span class="num" id="2888286">1</span><span class="op" id="2888287">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888291">//&nbsp;there&nbsp;was&nbsp;at&nbsp;least&nbsp;one&nbsp;mantissa&nbsp;digit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888334"><a href="/math/big/nat.go.html#2886908">z</a></span>&nbsp;<span class="op" id="2888336">=</span>&nbsp;<span class="ident" id="2888338"><a href="/math/big/nat.go.html#2886908">z</a></span><span class="op" id="2888339">.</span><span class="ident" id="2888340">mulAddWW</span><span class="op" id="2888348">(</span><span class="ident" id="2888349"><a href="/math/big/nat.go.html#2886908">z</a></span><span class="op" id="2888350">,</span>&nbsp;<span class="ident" id="2888352"><a href="/math/big/nat.go.html#2887853">bb</a></span><span class="op" id="2888354">,</span>&nbsp;<span class="ident" id="2888356"><a href="/math/big/nat.go.html#2887868">dd</a></span><span class="op" id="2888358">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888361">case</span>&nbsp;<span class="ident" id="2888366"><a href="/math/big/nat.go.html#2886938">base</a></span>&nbsp;<span class="op" id="2888371">==</span>&nbsp;<span class="num" id="2888374">0</span>&nbsp;<span class="op" id="2888376">&amp;&amp;</span>&nbsp;<span class="ident" id="2888379"><a href="/math/big/nat.go.html#2887217">b</a></span>&nbsp;<span class="op" id="2888381">==</span>&nbsp;<span class="num" id="2888384">8</span><span class="op" id="2888385">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888389">//&nbsp;there&nbsp;was&nbsp;only&nbsp;the&nbsp;octal&nbsp;prefix&nbsp;0&nbsp;(possibly&nbsp;followed&nbsp;by&nbsp;digits&nbsp;&gt;&nbsp;7);</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888463">//&nbsp;return&nbsp;base&nbsp;10,&nbsp;not&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888490">return</span>&nbsp;<span class="ident" id="2888497"><a href="/math/big/nat.go.html#2886908">z</a></span><span class="op" id="2888498">,</span>&nbsp;<span class="num" id="2888500">10</span><span class="op" id="2888502">,</span>&nbsp;<span class="ident" id="2888504">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888509">case</span>&nbsp;<span class="ident" id="2888514"><a href="/math/big/nat.go.html#2886938">base</a></span>&nbsp;<span class="op" id="2888519">!=</span>&nbsp;<span class="num" id="2888522">0</span>&nbsp;<span class="op" id="2888524">||</span>&nbsp;<span class="ident" id="2888527"><a href="/math/big/nat.go.html#2887217">b</a></span>&nbsp;<span class="op" id="2888529">!=</span>&nbsp;<span class="num" id="2888532">8</span><span class="op" id="2888533">:</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2888537">//&nbsp;there&nbsp;was&nbsp;neither&nbsp;a&nbsp;mantissa&nbsp;digit&nbsp;nor&nbsp;the&nbsp;octal&nbsp;prefix&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888600">return</span>&nbsp;<span class="ident" id="2888607"><a href="/math/big/nat.go.html#2886908">z</a></span><span class="op" id="2888608">,</span>&nbsp;<span class="builtintype" id="2888610">int</span><span class="op" id="2888613">(</span><span class="ident" id="2888614"><a href="/math/big/nat.go.html#2887217">b</a></span><span class="op" id="2888615">)</span><span class="op" id="2888616">,</span>&nbsp;<span class="ident" id="2888618"><a href="/math/big/nat.go.html#2873317">errors</a></span><span class="op" id="2888624">.</span><span class="ident" id="2888625">New</span><span class="op" id="2888628">(</span><span class="string" id="2888629">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;number&#34;</span><span class="op" id="2888659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2888662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888666">return</span>&nbsp;<span class="ident" id="2888673"><a href="/math/big/nat.go.html#2886908">z</a></span><span class="op" id="2888674">.</span><span class="ident" id="2888675">norm</span><span class="op" id="2888679">(</span><span class="op" id="2888680">)</span><span class="op" id="2888681">,</span>&nbsp;<span class="builtintype" id="2888683">int</span><span class="op" id="2888686">(</span><span class="ident" id="2888687"><a href="/math/big/nat.go.html#2887217">b</a></span><span class="op" id="2888688">)</span><span class="op" id="2888689">,</span>&nbsp;<span class="ident" id="2888691">nil</span><br>
<span class="lineno">720</span><span class="op" id="2888695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2888698">//&nbsp;Character&nbsp;sets&nbsp;for&nbsp;string&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="keyword" id="2888739">const</span>&nbsp;<span class="op" id="2888745">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888748">lowercaseDigits</span>&nbsp;<span class="op" id="2888764">=</span>&nbsp;<span class="string" id="2888766">&#34;0123456789abcdefghijklmnopqrstuvwxyz&#34;</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888806">uppercaseDigits</span>&nbsp;<span class="op" id="2888822">=</span>&nbsp;<span class="string" id="2888824">&#34;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span><br>
<span class="lineno"></span><span class="op" id="2888863">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2888866">//&nbsp;decimalString&nbsp;returns&nbsp;a&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2888922">//&nbsp;It&nbsp;calls&nbsp;x.string&nbsp;with&nbsp;the&nbsp;charset&nbsp;&#34;0123456789&#34;.</span><br>
<span class="lineno">730</span><span class="keyword" id="2888974">func</span>&nbsp;<span class="op" id="2888979">(</span><span class="ident" id="2888980">x</span>&nbsp;<span class="ident" id="2888982"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2888985">)</span>&nbsp;<span class="ident" id="2888987">decimalString</span><span class="op" id="2889000">(</span><span class="op" id="2889001">)</span>&nbsp;<span class="builtintype" id="2889003">string</span>&nbsp;<span class="op" id="2889010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889013">return</span>&nbsp;<span class="ident" id="2889020"><a href="/math/big/nat.go.html#2888980">x</a></span><span class="op" id="2889021">.</span><span class="builtintype" id="2889022">string</span><span class="op" id="2889028">(</span><span class="ident" id="2889029"><a href="/math/big/nat.go.html#2888748">lowercaseDigits</a></span><span class="op" id="2889044">[</span><span class="num" id="2889045">0</span><span class="op" id="2889046">:</span><span class="num" id="2889047">10</span><span class="op" id="2889049">]</span><span class="op" id="2889050">)</span><br>
<span class="lineno"></span><span class="op" id="2889052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2889055">//&nbsp;string&nbsp;converts&nbsp;x&nbsp;to&nbsp;a&nbsp;string&nbsp;using&nbsp;digits&nbsp;from&nbsp;a&nbsp;charset;&nbsp;a&nbsp;digit&nbsp;with</span><br>
<span class="lineno">735</span><span class="comment" id="2889130">//&nbsp;value&nbsp;d&nbsp;is&nbsp;represented&nbsp;by&nbsp;charset[d].&nbsp;The&nbsp;conversion&nbsp;base&nbsp;is&nbsp;determined</span><br>
<span class="lineno"></span><span class="comment" id="2889205">//&nbsp;by&nbsp;len(charset),&nbsp;which&nbsp;must&nbsp;be&nbsp;&gt;=&nbsp;2&nbsp;and&nbsp;&lt;=&nbsp;256.</span><br>
<span class="lineno"></span><span class="keyword" id="2889256">func</span>&nbsp;<span class="op" id="2889261">(</span><span class="ident" id="2889262">x</span>&nbsp;<span class="ident" id="2889264"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2889267">)</span>&nbsp;<span class="builtintype" id="2889269">string</span><span class="op" id="2889275">(</span><span class="ident" id="2889276">charset</span>&nbsp;<span class="builtintype" id="2889284">string</span><span class="op" id="2889290">)</span>&nbsp;<span class="builtintype" id="2889292">string</span>&nbsp;<span class="op" id="2889299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889302">b</span>&nbsp;<span class="op" id="2889304">:=</span>&nbsp;<span class="ident" id="2889307"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2889311">(</span><span class="builtinfunc" id="2889312">len</span><span class="op" id="2889315">(</span><span class="ident" id="2889316"><a href="/math/big/nat.go.html#2889276">charset</a></span><span class="op" id="2889323">)</span><span class="op" id="2889324">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889328">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889346">switch</span>&nbsp;<span class="op" id="2889353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889356">case</span>&nbsp;<span class="ident" id="2889361"><a href="/math/big/nat.go.html#2889302">b</a></span>&nbsp;<span class="op" id="2889363">&lt;</span>&nbsp;<span class="num" id="2889365">2</span>&nbsp;<span class="op" id="2889367">||</span>&nbsp;<span class="ident" id="2889370"><a href="/math/big/nat.go.html#2885922">MaxBase</a></span>&nbsp;<span class="op" id="2889378">&gt;</span>&nbsp;<span class="num" id="2889380">256</span><span class="op" id="2889383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2889387">panic</span><span class="op" id="2889392">(</span><span class="string" id="2889393">&#34;illegal&nbsp;base&#34;</span><span class="op" id="2889407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889410">case</span>&nbsp;<span class="builtinfunc" id="2889415">len</span><span class="op" id="2889418">(</span><span class="ident" id="2889419"><a href="/math/big/nat.go.html#2889262">x</a></span><span class="op" id="2889420">)</span>&nbsp;<span class="op" id="2889422">==</span>&nbsp;<span class="num" id="2889425">0</span><span class="op" id="2889426">:</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889430">return</span>&nbsp;<span class="builtintype" id="2889437">string</span><span class="op" id="2889443">(</span><span class="ident" id="2889444"><a href="/math/big/nat.go.html#2889276">charset</a></span><span class="op" id="2889451">[</span><span class="num" id="2889452">0</span><span class="op" id="2889453">]</span><span class="op" id="2889454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2889457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889461">//&nbsp;allocate&nbsp;buffer&nbsp;for&nbsp;conversion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889496">i</span>&nbsp;<span class="op" id="2889498">:=</span>&nbsp;<span class="builtintype" id="2889501">int</span><span class="op" id="2889504">(</span><span class="builtintype" id="2889505">float64</span><span class="op" id="2889512">(</span><span class="ident" id="2889513"><a href="/math/big/nat.go.html#2889262">x</a></span><span class="op" id="2889514">.</span><span class="ident" id="2889515">bitLen</span><span class="op" id="2889521">(</span><span class="op" id="2889522">)</span><span class="op" id="2889523">)</span><span class="op" id="2889524">/</span><span class="ident" id="2889525"><a href="/math/big/nat.go.html#2873333">math</a></span><span class="op" id="2889529">.</span><span class="ident" id="2889530">Log2</span><span class="op" id="2889534">(</span><span class="builtintype" id="2889535">float64</span><span class="op" id="2889542">(</span><span class="ident" id="2889543"><a href="/math/big/nat.go.html#2889302">b</a></span><span class="op" id="2889544">)</span><span class="op" id="2889545">)</span><span class="op" id="2889546">)</span>&nbsp;<span class="op" id="2889548">+</span>&nbsp;<span class="num" id="2889550">1</span>&nbsp;<span class="comment" id="2889552">//&nbsp;off&nbsp;by&nbsp;one&nbsp;at&nbsp;most</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889575">s</span>&nbsp;<span class="op" id="2889577">:=</span>&nbsp;<span class="builtinfunc" id="2889580">make</span><span class="op" id="2889584">(</span><span class="op" id="2889585">[</span><span class="op" id="2889586">]</span><span class="builtintype" id="2889587">byte</span><span class="op" id="2889591">,</span>&nbsp;<span class="ident" id="2889593"><a href="/math/big/nat.go.html#2889496">i</a></span><span class="op" id="2889594">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889598">//&nbsp;convert&nbsp;power&nbsp;of&nbsp;two&nbsp;and&nbsp;non&nbsp;power&nbsp;of&nbsp;two&nbsp;bases&nbsp;separately</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889661">if</span>&nbsp;<span class="ident" id="2889664"><a href="/math/big/nat.go.html#2889302">b</a></span>&nbsp;<span class="op" id="2889666">==</span>&nbsp;<span class="ident" id="2889669"><a href="/math/big/nat.go.html#2889302">b</a></span><span class="op" id="2889670">&amp;</span><span class="op" id="2889671">-</span><span class="ident" id="2889672"><a href="/math/big/nat.go.html#2889302">b</a></span>&nbsp;<span class="op" id="2889674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889678">//&nbsp;shift&nbsp;is&nbsp;base-b&nbsp;digit&nbsp;size&nbsp;in&nbsp;bits</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889718">shift</span>&nbsp;<span class="op" id="2889724">:=</span>&nbsp;<span class="ident" id="2889727"><a href="/math/big/nat.go.html#2897756">trailingZeroBits</a></span><span class="op" id="2889743">(</span><span class="ident" id="2889744"><a href="/math/big/nat.go.html#2889302">b</a></span><span class="op" id="2889745">)</span>&nbsp;<span class="comment" id="2889747">//&nbsp;shift&nbsp;&gt;&nbsp;0&nbsp;because&nbsp;b&nbsp;&gt;=&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889777">mask</span>&nbsp;<span class="op" id="2889782">:=</span>&nbsp;<span class="ident" id="2889785"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2889789">(</span><span class="num" id="2889790">1</span><span class="op" id="2889791">)</span><span class="op" id="2889792">&lt;&lt;</span><span class="ident" id="2889794"><a href="/math/big/nat.go.html#2889718">shift</a></span>&nbsp;<span class="op" id="2889800">-</span>&nbsp;<span class="num" id="2889802">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889806">w</span>&nbsp;<span class="op" id="2889808">:=</span>&nbsp;<span class="ident" id="2889811"><a href="/math/big/nat.go.html#2889262">x</a></span><span class="op" id="2889812">[</span><span class="num" id="2889813">0</span><span class="op" id="2889814">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889818">nbits</span>&nbsp;<span class="op" id="2889824">:=</span>&nbsp;<span class="builtintype" id="2889827">uint</span><span class="op" id="2889831">(</span><span class="ident" id="2889832"><a href="/math/big/arith.go.html#2842878">_W</a></span><span class="op" id="2889834">)</span>&nbsp;<span class="comment" id="2889836">//&nbsp;number&nbsp;of&nbsp;unprocessed&nbsp;bits&nbsp;in&nbsp;w</span><br>
<span class="lineno"></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889874">//&nbsp;convert&nbsp;less-significant&nbsp;words</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889910">for</span>&nbsp;<span class="ident" id="2889914">k</span>&nbsp;<span class="op" id="2889916">:=</span>&nbsp;<span class="num" id="2889919">1</span><span class="op" id="2889920">;</span>&nbsp;<span class="ident" id="2889922"><a href="/math/big/nat.go.html#2889914">k</a></span>&nbsp;<span class="op" id="2889924">&lt;</span>&nbsp;<span class="builtinfunc" id="2889926">len</span><span class="op" id="2889929">(</span><span class="ident" id="2889930"><a href="/math/big/nat.go.html#2889262">x</a></span><span class="op" id="2889931">)</span><span class="op" id="2889932">;</span>&nbsp;<span class="ident" id="2889934"><a href="/math/big/nat.go.html#2889914">k</a></span><span class="op" id="2889935">++</span>&nbsp;<span class="op" id="2889938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889943">//&nbsp;convert&nbsp;full&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889969">for</span>&nbsp;<span class="ident" id="2889973"><a href="/math/big/nat.go.html#2889818">nbits</a></span>&nbsp;<span class="op" id="2889979">&gt;=</span>&nbsp;<span class="ident" id="2889982"><a href="/math/big/nat.go.html#2889718">shift</a></span>&nbsp;<span class="op" id="2889988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889994"><a href="/math/big/nat.go.html#2889496">i</a></span><span class="op" id="2889995">--</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890002"><a href="/math/big/nat.go.html#2889575">s</a></span><span class="op" id="2890003">[</span><span class="ident" id="2890004"><a href="/math/big/nat.go.html#2889496">i</a></span><span class="op" id="2890005">]</span>&nbsp;<span class="op" id="2890007">=</span>&nbsp;<span class="ident" id="2890009"><a href="/math/big/nat.go.html#2889276">charset</a></span><span class="op" id="2890016">[</span><span class="ident" id="2890017"><a href="/math/big/nat.go.html#2889806">w</a></span><span class="op" id="2890018">&amp;</span><span class="ident" id="2890019"><a href="/math/big/nat.go.html#2889777">mask</a></span><span class="op" id="2890023">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890029"><a href="/math/big/nat.go.html#2889806">w</a></span>&nbsp;<span class="op" id="2890031">&gt;&gt;=</span>&nbsp;<span class="ident" id="2890035"><a href="/math/big/nat.go.html#2889718">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890045"><a href="/math/big/nat.go.html#2889818">nbits</a></span>&nbsp;<span class="op" id="2890051">-=</span>&nbsp;<span class="ident" id="2890054"><a href="/math/big/nat.go.html#2889718">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2890063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890069">//&nbsp;convert&nbsp;any&nbsp;partial&nbsp;leading&nbsp;digit&nbsp;and&nbsp;advance&nbsp;to&nbsp;next&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2890134">if</span>&nbsp;<span class="ident" id="2890137"><a href="/math/big/nat.go.html#2889818">nbits</a></span>&nbsp;<span class="op" id="2890143">==</span>&nbsp;<span class="num" id="2890146">0</span>&nbsp;<span class="op" id="2890148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890154">//&nbsp;no&nbsp;partial&nbsp;digit&nbsp;remaining,&nbsp;just&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890202"><a href="/math/big/nat.go.html#2889806">w</a></span>&nbsp;<span class="op" id="2890204">=</span>&nbsp;<span class="ident" id="2890206"><a href="/math/big/nat.go.html#2889262">x</a></span><span class="op" id="2890207">[</span><span class="ident" id="2890208"><a href="/math/big/nat.go.html#2889914">k</a></span><span class="op" id="2890209">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890215"><a href="/math/big/nat.go.html#2889818">nbits</a></span>&nbsp;<span class="op" id="2890221">=</span>&nbsp;<span class="ident" id="2890223"><a href="/math/big/arith.go.html#2842878">_W</a></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2890229">}</span>&nbsp;<span class="keyword" id="2890231">else</span>&nbsp;<span class="op" id="2890236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890242">//&nbsp;partial&nbsp;digit&nbsp;in&nbsp;current&nbsp;(k-1)&nbsp;and&nbsp;next&nbsp;(k)&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890298"><a href="/math/big/nat.go.html#2889806">w</a></span>&nbsp;<span class="op" id="2890300">|=</span>&nbsp;<span class="ident" id="2890303"><a href="/math/big/nat.go.html#2889262">x</a></span><span class="op" id="2890304">[</span><span class="ident" id="2890305"><a href="/math/big/nat.go.html#2889914">k</a></span><span class="op" id="2890306">]</span>&nbsp;<span class="op" id="2890308">&lt;&lt;</span>&nbsp;<span class="ident" id="2890311"><a href="/math/big/nat.go.html#2889818">nbits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890321"><a href="/math/big/nat.go.html#2889496">i</a></span><span class="op" id="2890322">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890329"><a href="/math/big/nat.go.html#2889575">s</a></span><span class="op" id="2890330">[</span><span class="ident" id="2890331"><a href="/math/big/nat.go.html#2889496">i</a></span><span class="op" id="2890332">]</span>&nbsp;<span class="op" id="2890334">=</span>&nbsp;<span class="ident" id="2890336"><a href="/math/big/nat.go.html#2889276">charset</a></span><span class="op" id="2890343">[</span><span class="ident" id="2890344"><a href="/math/big/nat.go.html#2889806">w</a></span><span class="op" id="2890345">&amp;</span><span class="ident" id="2890346"><a href="/math/big/nat.go.html#2889777">mask</a></span><span class="op" id="2890350">]</span><br>
<span class="lineno">780</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890357">//&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890372"><a href="/math/big/nat.go.html#2889806">w</a></span>&nbsp;<span class="op" id="2890374">=</span>&nbsp;<span class="ident" id="2890376"><a href="/math/big/nat.go.html#2889262">x</a></span><span class="op" id="2890377">[</span><span class="ident" id="2890378"><a href="/math/big/nat.go.html#2889914">k</a></span><span class="op" id="2890379">]</span>&nbsp;<span class="op" id="2890381">&gt;&gt;</span>&nbsp;<span class="op" id="2890384">(</span><span class="ident" id="2890385"><a href="/math/big/nat.go.html#2889718">shift</a></span>&nbsp;<span class="op" id="2890391">-</span>&nbsp;<span class="ident" id="2890393"><a href="/math/big/nat.go.html#2889818">nbits</a></span><span class="op" id="2890398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890404"><a href="/math/big/nat.go.html#2889818">nbits</a></span>&nbsp;<span class="op" id="2890410">=</span>&nbsp;<span class="ident" id="2890412"><a href="/math/big/arith.go.html#2842878">_W</a></span>&nbsp;<span class="op" id="2890415">-</span>&nbsp;<span class="op" id="2890417">(</span><span class="ident" id="2890418"><a href="/math/big/nat.go.html#2889718">shift</a></span>&nbsp;<span class="op" id="2890424">-</span>&nbsp;<span class="ident" id="2890426"><a href="/math/big/nat.go.html#2889818">nbits</a></span><span class="op" id="2890431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2890436">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2890440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890445">//&nbsp;convert&nbsp;digits&nbsp;of&nbsp;most-significant&nbsp;word&nbsp;(omit&nbsp;leading&nbsp;zeros)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2890511">for</span>&nbsp;<span class="ident" id="2890515"><a href="/math/big/nat.go.html#2889818">nbits</a></span>&nbsp;<span class="op" id="2890521">&gt;=</span>&nbsp;<span class="num" id="2890524">0</span>&nbsp;<span class="op" id="2890526">&amp;&amp;</span>&nbsp;<span class="ident" id="2890529"><a href="/math/big/nat.go.html#2889806">w</a></span>&nbsp;<span class="op" id="2890531">!=</span>&nbsp;<span class="num" id="2890534">0</span>&nbsp;<span class="op" id="2890536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890541"><a href="/math/big/nat.go.html#2889496">i</a></span><span class="op" id="2890542">--</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890548"><a href="/math/big/nat.go.html#2889575">s</a></span><span class="op" id="2890549">[</span><span class="ident" id="2890550"><a href="/math/big/nat.go.html#2889496">i</a></span><span class="op" id="2890551">]</span>&nbsp;<span class="op" id="2890553">=</span>&nbsp;<span class="ident" id="2890555"><a href="/math/big/nat.go.html#2889276">charset</a></span><span class="op" id="2890562">[</span><span class="ident" id="2890563"><a href="/math/big/nat.go.html#2889806">w</a></span><span class="op" id="2890564">&amp;</span><span class="ident" id="2890565"><a href="/math/big/nat.go.html#2889777">mask</a></span><span class="op" id="2890569">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890574"><a href="/math/big/nat.go.html#2889806">w</a></span>&nbsp;<span class="op" id="2890576">&gt;&gt;=</span>&nbsp;<span class="ident" id="2890580"><a href="/math/big/nat.go.html#2889718">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890589"><a href="/math/big/nat.go.html#2889818">nbits</a></span>&nbsp;<span class="op" id="2890595">-=</span>&nbsp;<span class="ident" id="2890598"><a href="/math/big/nat.go.html#2889718">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2890606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2890610">}</span>&nbsp;<span class="keyword" id="2890612">else</span>&nbsp;<span class="op" id="2890617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890621">//&nbsp;determine&nbsp;&#34;big&nbsp;base&#34;;&nbsp;i.e.,&nbsp;the&nbsp;largest&nbsp;possible&nbsp;value&nbsp;bb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890684">//&nbsp;that&nbsp;is&nbsp;a&nbsp;power&nbsp;of&nbsp;base&nbsp;b&nbsp;and&nbsp;still&nbsp;fits&nbsp;into&nbsp;a&nbsp;Word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890742">//&nbsp;(as&nbsp;in&nbsp;10^19&nbsp;for&nbsp;19&nbsp;decimal&nbsp;digits&nbsp;in&nbsp;a&nbsp;64bit&nbsp;Word)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890799">bb</span>&nbsp;<span class="op" id="2890802">:=</span>&nbsp;<span class="ident" id="2890805"><a href="/math/big/nat.go.html#2889302">b</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2890812">//&nbsp;big&nbsp;base&nbsp;is&nbsp;b**ndigits</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890840">ndigits</span>&nbsp;<span class="op" id="2890848">:=</span>&nbsp;<span class="num" id="2890851">1</span>&nbsp;<span class="comment" id="2890853">//&nbsp;number&nbsp;of&nbsp;base&nbsp;b&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2890882">for</span>&nbsp;<span class="ident" id="2890886">max</span>&nbsp;<span class="op" id="2890890">:=</span>&nbsp;<span class="ident" id="2890893"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2890897">(</span><span class="ident" id="2890898"><a href="/math/big/arith.go.html#2842941">_M</a></span>&nbsp;<span class="op" id="2890901">/</span>&nbsp;<span class="ident" id="2890903"><a href="/math/big/nat.go.html#2889302">b</a></span><span class="op" id="2890904">)</span><span class="op" id="2890905">;</span>&nbsp;<span class="ident" id="2890907"><a href="/math/big/nat.go.html#2890799">bb</a></span>&nbsp;<span class="op" id="2890910">&lt;=</span>&nbsp;<span class="ident" id="2890913"><a href="/math/big/nat.go.html#2890886">max</a></span><span class="op" id="2890916">;</span>&nbsp;<span class="ident" id="2890918"><a href="/math/big/nat.go.html#2890799">bb</a></span>&nbsp;<span class="op" id="2890921">*=</span>&nbsp;<span class="ident" id="2890924"><a href="/math/big/nat.go.html#2889302">b</a></span>&nbsp;<span class="op" id="2890926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890931"><a href="/math/big/nat.go.html#2890840">ndigits</a></span><span class="op" id="2890938">++</span>&nbsp;<span class="comment" id="2890941">//&nbsp;maximize&nbsp;ndigits&nbsp;where&nbsp;bb&nbsp;=&nbsp;b**ndigits,&nbsp;bb&nbsp;&lt;=&nbsp;_M</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2890995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2891000">//&nbsp;construct&nbsp;table&nbsp;of&nbsp;successive&nbsp;squares&nbsp;of&nbsp;bb*leafSize&nbsp;to&nbsp;use&nbsp;in&nbsp;subdivisions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2891081">//&nbsp;result&nbsp;(table&nbsp;!=&nbsp;nil)&nbsp;&lt;=&gt;&nbsp;(len(x)&nbsp;&gt;&nbsp;leafSize&nbsp;&gt;&nbsp;0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891136">table</span>&nbsp;<span class="op" id="2891142">:=</span>&nbsp;<span class="ident" id="2891145"><a href="/math/big/nat.go.html#2895719">divisors</a></span><span class="op" id="2891153">(</span><span class="builtinfunc" id="2891154">len</span><span class="op" id="2891157">(</span><span class="ident" id="2891158"><a href="/math/big/nat.go.html#2889262">x</a></span><span class="op" id="2891159">)</span><span class="op" id="2891160">,</span>&nbsp;<span class="ident" id="2891162"><a href="/math/big/nat.go.html#2889302">b</a></span><span class="op" id="2891163">,</span>&nbsp;<span class="ident" id="2891165"><a href="/math/big/nat.go.html#2890840">ndigits</a></span><span class="op" id="2891172">,</span>&nbsp;<span class="ident" id="2891174"><a href="/math/big/nat.go.html#2890799">bb</a></span><span class="op" id="2891176">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2891181">//&nbsp;preserve&nbsp;x,&nbsp;create&nbsp;local&nbsp;copy&nbsp;for&nbsp;use&nbsp;by&nbsp;convertWords</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891240">q</span>&nbsp;<span class="op" id="2891242">:=</span>&nbsp;<span class="ident" id="2891245"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2891248">(</span><span class="ident" id="2891249">nil</span><span class="op" id="2891252">)</span><span class="op" id="2891253">.</span><span class="ident" id="2891254">set</span><span class="op" id="2891257">(</span><span class="ident" id="2891258"><a href="/math/big/nat.go.html#2889262">x</a></span><span class="op" id="2891259">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2891264">//&nbsp;convert&nbsp;q&nbsp;to&nbsp;string&nbsp;s&nbsp;in&nbsp;base&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891301"><a href="/math/big/nat.go.html#2891240">q</a></span><span class="op" id="2891302">.</span><span class="ident" id="2891303">convertWords</span><span class="op" id="2891315">(</span><span class="ident" id="2891316"><a href="/math/big/nat.go.html#2889575">s</a></span><span class="op" id="2891317">,</span>&nbsp;<span class="ident" id="2891319"><a href="/math/big/nat.go.html#2889276">charset</a></span><span class="op" id="2891326">,</span>&nbsp;<span class="ident" id="2891328"><a href="/math/big/nat.go.html#2889302">b</a></span><span class="op" id="2891329">,</span>&nbsp;<span class="ident" id="2891331"><a href="/math/big/nat.go.html#2890840">ndigits</a></span><span class="op" id="2891338">,</span>&nbsp;<span class="ident" id="2891340"><a href="/math/big/nat.go.html#2890799">bb</a></span><span class="op" id="2891342">,</span>&nbsp;<span class="ident" id="2891344"><a href="/math/big/nat.go.html#2891136">table</a></span><span class="op" id="2891349">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2891354">//&nbsp;strip&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2891379">//&nbsp;(x&nbsp;!=&nbsp;0;&nbsp;thus&nbsp;s&nbsp;must&nbsp;contain&nbsp;at&nbsp;least&nbsp;one&nbsp;non-zero&nbsp;digit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2891441">//&nbsp;and&nbsp;the&nbsp;loop&nbsp;will&nbsp;terminate)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891475"><a href="/math/big/nat.go.html#2889496">i</a></span>&nbsp;<span class="op" id="2891477">=</span>&nbsp;<span class="num" id="2891479">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2891483">for</span>&nbsp;<span class="ident" id="2891487">zero</span>&nbsp;<span class="op" id="2891492">:=</span>&nbsp;<span class="ident" id="2891495"><a href="/math/big/nat.go.html#2889276">charset</a></span><span class="op" id="2891502">[</span><span class="num" id="2891503">0</span><span class="op" id="2891504">]</span><span class="op" id="2891505">;</span>&nbsp;<span class="ident" id="2891507"><a href="/math/big/nat.go.html#2889575">s</a></span><span class="op" id="2891508">[</span><span class="ident" id="2891509"><a href="/math/big/nat.go.html#2889496">i</a></span><span class="op" id="2891510">]</span>&nbsp;<span class="op" id="2891512">==</span>&nbsp;<span class="ident" id="2891515"><a href="/math/big/nat.go.html#2891487">zero</a></span><span class="op" id="2891519">;</span>&nbsp;<span class="op" id="2891521">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891526"><a href="/math/big/nat.go.html#2889496">i</a></span><span class="op" id="2891527">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2891532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2891535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2891539">return</span>&nbsp;<span class="builtintype" id="2891546">string</span><span class="op" id="2891552">(</span><span class="ident" id="2891553"><a href="/math/big/nat.go.html#2889575">s</a></span><span class="op" id="2891554">[</span><span class="ident" id="2891555"><a href="/math/big/nat.go.html#2889496">i</a></span><span class="op" id="2891556">:</span><span class="op" id="2891557">]</span><span class="op" id="2891558">)</span><br>
<span class="lineno">825</span><span class="op" id="2891560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2891563">//&nbsp;Convert&nbsp;words&nbsp;of&nbsp;q&nbsp;to&nbsp;base&nbsp;b&nbsp;digits&nbsp;in&nbsp;s.&nbsp;If&nbsp;q&nbsp;is&nbsp;large,&nbsp;it&nbsp;is&nbsp;recursively&nbsp;&#34;split&nbsp;in&nbsp;half&#34;</span><br>
<span class="lineno"></span><span class="comment" id="2891657">//&nbsp;by&nbsp;nat/nat&nbsp;division&nbsp;using&nbsp;tabulated&nbsp;divisors.&nbsp;Otherwise,&nbsp;it&nbsp;is&nbsp;converted&nbsp;iteratively&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="2891751">//&nbsp;repeated&nbsp;nat/Word&nbsp;division.</span><br>
<span class="lineno">830</span><span class="comment" id="2891782">//</span><br>
<span class="lineno"></span><span class="comment" id="2891785">//&nbsp;The&nbsp;iterative&nbsp;method&nbsp;processes&nbsp;n&nbsp;Words&nbsp;by&nbsp;n&nbsp;divW()&nbsp;calls,&nbsp;each&nbsp;of&nbsp;which&nbsp;visits&nbsp;every&nbsp;Word&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2891885">//&nbsp;incrementally&nbsp;shortened&nbsp;q&nbsp;for&nbsp;a&nbsp;total&nbsp;of&nbsp;n&nbsp;+&nbsp;(n-1)&nbsp;+&nbsp;(n-2)&nbsp;...&nbsp;+&nbsp;2&nbsp;+&nbsp;1,&nbsp;or&nbsp;n(n+1)/2&nbsp;divW()&#39;s.</span><br>
<span class="lineno"></span><span class="comment" id="2891982">//&nbsp;Recursive&nbsp;conversion&nbsp;divides&nbsp;q&nbsp;by&nbsp;its&nbsp;approximate&nbsp;square&nbsp;root,&nbsp;yielding&nbsp;two&nbsp;parts,&nbsp;each&nbsp;half</span><br>
<span class="lineno"></span><span class="comment" id="2892078">//&nbsp;the&nbsp;size&nbsp;of&nbsp;q.&nbsp;Using&nbsp;the&nbsp;iterative&nbsp;method&nbsp;on&nbsp;both&nbsp;halves&nbsp;means&nbsp;2&nbsp;*&nbsp;(n/2)(n/2&nbsp;+&nbsp;1)/2&nbsp;divW()&#39;s</span><br>
<span class="lineno">835</span><span class="comment" id="2892174">//&nbsp;plus&nbsp;the&nbsp;expensive&nbsp;long&nbsp;div().&nbsp;Asymptotically,&nbsp;the&nbsp;ratio&nbsp;is&nbsp;favorable&nbsp;at&nbsp;1/2&nbsp;the&nbsp;divW()&#39;s,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2892272">//&nbsp;is&nbsp;made&nbsp;better&nbsp;by&nbsp;splitting&nbsp;the&nbsp;subblocks&nbsp;recursively.&nbsp;Best&nbsp;is&nbsp;to&nbsp;split&nbsp;blocks&nbsp;until&nbsp;one&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="2892369">//&nbsp;split&nbsp;would&nbsp;take&nbsp;longer&nbsp;(because&nbsp;of&nbsp;the&nbsp;nat/nat&nbsp;div())&nbsp;than&nbsp;the&nbsp;twice&nbsp;as&nbsp;many&nbsp;divW()&#39;s&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2892466">//&nbsp;iterative&nbsp;approach.&nbsp;This&nbsp;threshold&nbsp;is&nbsp;represented&nbsp;by&nbsp;leafSize.&nbsp;Benchmarking&nbsp;of&nbsp;leafSize&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2892564">//&nbsp;range&nbsp;2..64&nbsp;shows&nbsp;that&nbsp;values&nbsp;of&nbsp;8&nbsp;and&nbsp;16&nbsp;work&nbsp;well,&nbsp;with&nbsp;a&nbsp;4x&nbsp;speedup&nbsp;at&nbsp;medium&nbsp;lengths&nbsp;and</span><br>
<span class="lineno">840</span><span class="comment" id="2892660">//&nbsp;~30x&nbsp;for&nbsp;20000&nbsp;digits.&nbsp;Use&nbsp;nat_test.go&#39;s&nbsp;BenchmarkLeafSize&nbsp;tests&nbsp;to&nbsp;optimize&nbsp;leafSize&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="2892753">//&nbsp;specific&nbsp;hardware.</span><br>
<span class="lineno"></span><span class="comment" id="2892775">//</span><br>
<span class="lineno"></span><span class="keyword" id="2892778">func</span>&nbsp;<span class="op" id="2892783">(</span><span class="ident" id="2892784">q</span>&nbsp;<span class="ident" id="2892786"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2892789">)</span>&nbsp;<span class="ident" id="2892791">convertWords</span><span class="op" id="2892803">(</span><span class="ident" id="2892804">s</span>&nbsp;<span class="op" id="2892806">[</span><span class="op" id="2892807">]</span><span class="builtintype" id="2892808">byte</span><span class="op" id="2892812">,</span>&nbsp;<span class="ident" id="2892814">charset</span>&nbsp;<span class="builtintype" id="2892822">string</span><span class="op" id="2892828">,</span>&nbsp;<span class="ident" id="2892830">b</span>&nbsp;<span class="ident" id="2892832"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2892836">,</span>&nbsp;<span class="ident" id="2892838">ndigits</span>&nbsp;<span class="builtintype" id="2892846">int</span><span class="op" id="2892849">,</span>&nbsp;<span class="ident" id="2892851">bb</span>&nbsp;<span class="ident" id="2892854"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2892858">,</span>&nbsp;<span class="ident" id="2892860">table</span>&nbsp;<span class="op" id="2892866">[</span><span class="op" id="2892867">]</span><span class="ident" id="2892868"><a href="/math/big/nat.go.html#2895237">divisor</a></span><span class="op" id="2892875">)</span>&nbsp;<span class="op" id="2892877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2892880">//&nbsp;split&nbsp;larger&nbsp;blocks&nbsp;recursively</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2892916">if</span>&nbsp;<span class="ident" id="2892919"><a href="/math/big/nat.go.html#2892860">table</a></span>&nbsp;<span class="op" id="2892925">!=</span>&nbsp;<span class="ident" id="2892928">nil</span>&nbsp;<span class="op" id="2892932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2892936">//&nbsp;len(q)&nbsp;&gt;&nbsp;leafSize&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2892963">var</span>&nbsp;<span class="ident" id="2892967">r</span>&nbsp;<span class="ident" id="2892969"><a href="/math/big/nat.go.html#2873877">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2892975">index</span>&nbsp;<span class="op" id="2892981">:=</span>&nbsp;<span class="builtinfunc" id="2892984">len</span><span class="op" id="2892987">(</span><span class="ident" id="2892988"><a href="/math/big/nat.go.html#2892860">table</a></span><span class="op" id="2892993">)</span>&nbsp;<span class="op" id="2892995">-</span>&nbsp;<span class="num" id="2892997">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893001">for</span>&nbsp;<span class="builtinfunc" id="2893005">len</span><span class="op" id="2893008">(</span><span class="ident" id="2893009"><a href="/math/big/nat.go.html#2892784">q</a></span><span class="op" id="2893010">)</span>&nbsp;<span class="op" id="2893012">&gt;</span>&nbsp;<span class="ident" id="2893014"><a href="/math/big/nat.go.html#2895149">leafSize</a></span>&nbsp;<span class="op" id="2893023">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2893028">//&nbsp;find&nbsp;divisor&nbsp;close&nbsp;to&nbsp;sqrt(q)&nbsp;if&nbsp;possible,&nbsp;but&nbsp;in&nbsp;any&nbsp;case&nbsp;&lt;&nbsp;q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893097">maxLength</span>&nbsp;<span class="op" id="2893107">:=</span>&nbsp;<span class="ident" id="2893110"><a href="/math/big/nat.go.html#2892784">q</a></span><span class="op" id="2893111">.</span><span class="ident" id="2893112">bitLen</span><span class="op" id="2893118">(</span><span class="op" id="2893119">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2893125">//&nbsp;~=&nbsp;log2&nbsp;q,&nbsp;or&nbsp;at&nbsp;of&nbsp;least&nbsp;largest&nbsp;possible&nbsp;q&nbsp;of&nbsp;this&nbsp;bit&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893195">minLength</span>&nbsp;<span class="op" id="2893205">:=</span>&nbsp;<span class="ident" id="2893208"><a href="/math/big/nat.go.html#2893097">maxLength</a></span>&nbsp;<span class="op" id="2893218">&gt;&gt;</span>&nbsp;<span class="num" id="2893221">1</span>&nbsp;<span class="comment" id="2893223">//&nbsp;~=&nbsp;log2&nbsp;sqrt(q)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893245">for</span>&nbsp;<span class="ident" id="2893249"><a href="/math/big/nat.go.html#2892975">index</a></span>&nbsp;<span class="op" id="2893255">&gt;</span>&nbsp;<span class="num" id="2893257">0</span>&nbsp;<span class="op" id="2893259">&amp;&amp;</span>&nbsp;<span class="ident" id="2893262"><a href="/math/big/nat.go.html#2892860">table</a></span><span class="op" id="2893267">[</span><span class="ident" id="2893268"><a href="/math/big/nat.go.html#2892975">index</a></span><span class="op" id="2893273">-</span><span class="num" id="2893274">1</span><span class="op" id="2893275">]</span><span class="op" id="2893276">.</span><span class="ident" id="2893277">nbits</span>&nbsp;<span class="op" id="2893283">&gt;</span>&nbsp;<span class="ident" id="2893285"><a href="/math/big/nat.go.html#2893195">minLength</a></span>&nbsp;<span class="op" id="2893295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893301"><a href="/math/big/nat.go.html#2892975">index</a></span><span class="op" id="2893306">--</span>&nbsp;<span class="comment" id="2893309">//&nbsp;desired</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2893323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893328">if</span>&nbsp;<span class="ident" id="2893331"><a href="/math/big/nat.go.html#2892860">table</a></span><span class="op" id="2893336">[</span><span class="ident" id="2893337"><a href="/math/big/nat.go.html#2892975">index</a></span><span class="op" id="2893342">]</span><span class="op" id="2893343">.</span><span class="ident" id="2893344">nbits</span>&nbsp;<span class="op" id="2893350">&gt;=</span>&nbsp;<span class="ident" id="2893353"><a href="/math/big/nat.go.html#2893097">maxLength</a></span>&nbsp;<span class="op" id="2893363">&amp;&amp;</span>&nbsp;<span class="ident" id="2893366"><a href="/math/big/nat.go.html#2892860">table</a></span><span class="op" id="2893371">[</span><span class="ident" id="2893372"><a href="/math/big/nat.go.html#2892975">index</a></span><span class="op" id="2893377">]</span><span class="op" id="2893378">.</span><span class="ident" id="2893379">bbb</span><span class="op" id="2893382">.</span><span class="ident" id="2893383">cmp</span><span class="op" id="2893386">(</span><span class="ident" id="2893387"><a href="/math/big/nat.go.html#2892784">q</a></span><span class="op" id="2893388">)</span>&nbsp;<span class="op" id="2893390">&gt;=</span>&nbsp;<span class="num" id="2893393">0</span>&nbsp;<span class="op" id="2893395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893401"><a href="/math/big/nat.go.html#2892975">index</a></span><span class="op" id="2893406">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893413">if</span>&nbsp;<span class="ident" id="2893416"><a href="/math/big/nat.go.html#2892975">index</a></span>&nbsp;<span class="op" id="2893422">&lt;</span>&nbsp;<span class="num" id="2893424">0</span>&nbsp;<span class="op" id="2893426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2893433">panic</span><span class="op" id="2893438">(</span><span class="string" id="2893439">&#34;internal&nbsp;inconsistency&#34;</span><span class="op" id="2893463">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2893469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2893474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2893480">//&nbsp;split&nbsp;q&nbsp;into&nbsp;the&nbsp;two&nbsp;digit&nbsp;number&nbsp;(q&#39;*bbb&nbsp;+&nbsp;r)&nbsp;to&nbsp;form&nbsp;independent&nbsp;subblocks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893563"><a href="/math/big/nat.go.html#2892784">q</a></span><span class="op" id="2893564">,</span>&nbsp;<span class="ident" id="2893566"><a href="/math/big/nat.go.html#2892967">r</a></span>&nbsp;<span class="op" id="2893568">=</span>&nbsp;<span class="ident" id="2893570"><a href="/math/big/nat.go.html#2892784">q</a></span><span class="op" id="2893571">.</span><span class="ident" id="2893572">div</span><span class="op" id="2893575">(</span><span class="ident" id="2893576"><a href="/math/big/nat.go.html#2892967">r</a></span><span class="op" id="2893577">,</span>&nbsp;<span class="ident" id="2893579"><a href="/math/big/nat.go.html#2892784">q</a></span><span class="op" id="2893580">,</span>&nbsp;<span class="ident" id="2893582"><a href="/math/big/nat.go.html#2892860">table</a></span><span class="op" id="2893587">[</span><span class="ident" id="2893588"><a href="/math/big/nat.go.html#2892975">index</a></span><span class="op" id="2893593">]</span><span class="op" id="2893594">.</span><span class="ident" id="2893595">bbb</span><span class="op" id="2893598">)</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2893604">//&nbsp;convert&nbsp;subblocks&nbsp;and&nbsp;collect&nbsp;results&nbsp;in&nbsp;s[:h]&nbsp;and&nbsp;s[h:]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893667">h</span>&nbsp;<span class="op" id="2893669">:=</span>&nbsp;<span class="builtinfunc" id="2893672">len</span><span class="op" id="2893675">(</span><span class="ident" id="2893676"><a href="/math/big/nat.go.html#2892804">s</a></span><span class="op" id="2893677">)</span>&nbsp;<span class="op" id="2893679">-</span>&nbsp;<span class="ident" id="2893681"><a href="/math/big/nat.go.html#2892860">table</a></span><span class="op" id="2893686">[</span><span class="ident" id="2893687"><a href="/math/big/nat.go.html#2892975">index</a></span><span class="op" id="2893692">]</span><span class="op" id="2893693">.</span><span class="ident" id="2893694">ndigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893705"><a href="/math/big/nat.go.html#2892967">r</a></span><span class="op" id="2893706">.</span><span class="ident" id="2893707">convertWords</span><span class="op" id="2893719">(</span><span class="ident" id="2893720"><a href="/math/big/nat.go.html#2892804">s</a></span><span class="op" id="2893721">[</span><span class="ident" id="2893722"><a href="/math/big/nat.go.html#2893667">h</a></span><span class="op" id="2893723">:</span><span class="op" id="2893724">]</span><span class="op" id="2893725">,</span>&nbsp;<span class="ident" id="2893727"><a href="/math/big/nat.go.html#2892814">charset</a></span><span class="op" id="2893734">,</span>&nbsp;<span class="ident" id="2893736"><a href="/math/big/nat.go.html#2892830">b</a></span><span class="op" id="2893737">,</span>&nbsp;<span class="ident" id="2893739"><a href="/math/big/nat.go.html#2892838">ndigits</a></span><span class="op" id="2893746">,</span>&nbsp;<span class="ident" id="2893748"><a href="/math/big/nat.go.html#2892851">bb</a></span><span class="op" id="2893750">,</span>&nbsp;<span class="ident" id="2893752"><a href="/math/big/nat.go.html#2892860">table</a></span><span class="op" id="2893757">[</span><span class="num" id="2893758">0</span><span class="op" id="2893759">:</span><span class="ident" id="2893760"><a href="/math/big/nat.go.html#2892975">index</a></span><span class="op" id="2893765">]</span><span class="op" id="2893766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893771"><a href="/math/big/nat.go.html#2892804">s</a></span>&nbsp;<span class="op" id="2893773">=</span>&nbsp;<span class="ident" id="2893775"><a href="/math/big/nat.go.html#2892804">s</a></span><span class="op" id="2893776">[</span><span class="op" id="2893777">:</span><span class="ident" id="2893778"><a href="/math/big/nat.go.html#2893667">h</a></span><span class="op" id="2893779">]</span>&nbsp;<span class="comment" id="2893781">//&nbsp;==&nbsp;q.convertWords(s,&nbsp;charset,&nbsp;b,&nbsp;ndigits,&nbsp;bb,&nbsp;table[0:index+1])</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2893850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2893853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2893857">//&nbsp;having&nbsp;split&nbsp;any&nbsp;large&nbsp;blocks&nbsp;now&nbsp;process&nbsp;the&nbsp;remaining&nbsp;(small)&nbsp;block&nbsp;iteratively</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893943">i</span>&nbsp;<span class="op" id="2893945">:=</span>&nbsp;<span class="builtinfunc" id="2893948">len</span><span class="op" id="2893951">(</span><span class="ident" id="2893952"><a href="/math/big/nat.go.html#2892804">s</a></span><span class="op" id="2893953">)</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893956">var</span>&nbsp;<span class="ident" id="2893960">r</span>&nbsp;<span class="ident" id="2893962"><a href="/math/big/arith.go.html#2842733">Word</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893968">if</span>&nbsp;<span class="ident" id="2893971"><a href="/math/big/nat.go.html#2892830">b</a></span>&nbsp;<span class="op" id="2893973">==</span>&nbsp;<span class="num" id="2893976">10</span>&nbsp;<span class="op" id="2893979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2893983">//&nbsp;hard-coding&nbsp;for&nbsp;10&nbsp;here&nbsp;speeds&nbsp;this&nbsp;up&nbsp;by&nbsp;1.25x&nbsp;(allows&nbsp;for&nbsp;/&nbsp;and&nbsp;%&nbsp;by&nbsp;constants)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2894070">for</span>&nbsp;<span class="builtinfunc" id="2894074">len</span><span class="op" id="2894077">(</span><span class="ident" id="2894078"><a href="/math/big/nat.go.html#2892784">q</a></span><span class="op" id="2894079">)</span>&nbsp;<span class="op" id="2894081">&gt;</span>&nbsp;<span class="num" id="2894083">0</span>&nbsp;<span class="op" id="2894085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2894090">//&nbsp;extract&nbsp;least&nbsp;significant,&nbsp;base&nbsp;bb&nbsp;&#34;digit&#34;</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894139"><a href="/math/big/nat.go.html#2892784">q</a></span><span class="op" id="2894140">,</span>&nbsp;<span class="ident" id="2894142"><a href="/math/big/nat.go.html#2893960">r</a></span>&nbsp;<span class="op" id="2894144">=</span>&nbsp;<span class="ident" id="2894146"><a href="/math/big/nat.go.html#2892784">q</a></span><span class="op" id="2894147">.</span><span class="ident" id="2894148">divW</span><span class="op" id="2894152">(</span><span class="ident" id="2894153"><a href="/math/big/nat.go.html#2892784">q</a></span><span class="op" id="2894154">,</span>&nbsp;<span class="ident" id="2894156"><a href="/math/big/nat.go.html#2892851">bb</a></span><span class="op" id="2894158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2894163">for</span>&nbsp;<span class="ident" id="2894167">j</span>&nbsp;<span class="op" id="2894169">:=</span>&nbsp;<span class="num" id="2894172">0</span><span class="op" id="2894173">;</span>&nbsp;<span class="ident" id="2894175"><a href="/math/big/nat.go.html#2894167">j</a></span>&nbsp;<span class="op" id="2894177">&lt;</span>&nbsp;<span class="ident" id="2894179"><a href="/math/big/nat.go.html#2892838">ndigits</a></span>&nbsp;<span class="op" id="2894187">&amp;&amp;</span>&nbsp;<span class="ident" id="2894190"><a href="/math/big/nat.go.html#2893943">i</a></span>&nbsp;<span class="op" id="2894192">&gt;</span>&nbsp;<span class="num" id="2894194">0</span><span class="op" id="2894195">;</span>&nbsp;<span class="ident" id="2894197"><a href="/math/big/nat.go.html#2894167">j</a></span><span class="op" id="2894198">++</span>&nbsp;<span class="op" id="2894201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894207"><a href="/math/big/nat.go.html#2893943">i</a></span><span class="op" id="2894208">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2894215">//&nbsp;avoid&nbsp;%&nbsp;computation&nbsp;since&nbsp;r%10&nbsp;==&nbsp;r&nbsp;-&nbsp;int(r/10)*10;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2894274">//&nbsp;this&nbsp;appears&nbsp;to&nbsp;be&nbsp;faster&nbsp;for&nbsp;BenchmarkString10000Base10</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2894338">//&nbsp;and&nbsp;smaller&nbsp;strings&nbsp;(but&nbsp;a&nbsp;bit&nbsp;slower&nbsp;for&nbsp;larger&nbsp;ones)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894400">t</span>&nbsp;<span class="op" id="2894402">:=</span>&nbsp;<span class="ident" id="2894405"><a href="/math/big/nat.go.html#2893960">r</a></span>&nbsp;<span class="op" id="2894407">/</span>&nbsp;<span class="num" id="2894409">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894416"><a href="/math/big/nat.go.html#2892804">s</a></span><span class="op" id="2894417">[</span><span class="ident" id="2894418"><a href="/math/big/nat.go.html#2893943">i</a></span><span class="op" id="2894419">]</span>&nbsp;<span class="op" id="2894421">=</span>&nbsp;<span class="ident" id="2894423"><a href="/math/big/nat.go.html#2892814">charset</a></span><span class="op" id="2894430">[</span><span class="ident" id="2894431"><a href="/math/big/nat.go.html#2893960">r</a></span><span class="op" id="2894432">-</span><span class="ident" id="2894433"><a href="/math/big/nat.go.html#2894400">t</a></span><span class="op" id="2894434">&lt;&lt;</span><span class="num" id="2894436">3</span><span class="op" id="2894437">-</span><span class="ident" id="2894438"><a href="/math/big/nat.go.html#2894400">t</a></span><span class="op" id="2894439">-</span><span class="ident" id="2894440"><a href="/math/big/nat.go.html#2894400">t</a></span><span class="op" id="2894441">]</span>&nbsp;<span class="comment" id="2894443">//&nbsp;TODO(gri)&nbsp;replace&nbsp;w/&nbsp;t*10&nbsp;once&nbsp;compiler&nbsp;produces&nbsp;better&nbsp;code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894511"><a href="/math/big/nat.go.html#2893960">r</a></span>&nbsp;<span class="op" id="2894513">=</span>&nbsp;<span class="ident" id="2894515"><a href="/math/big/nat.go.html#2894400">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2894520">}</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2894524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2894527">}</span>&nbsp;<span class="keyword" id="2894529">else</span>&nbsp;<span class="op" id="2894534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2894538">for</span>&nbsp;<span class="builtinfunc" id="2894542">len</span><span class="op" id="2894545">(</span><span class="ident" id="2894546"><a href="/math/big/nat.go.html#2892784">q</a></span><span class="op" id="2894547">)</span>&nbsp;<span class="op" id="2894549">&gt;</span>&nbsp;<span class="num" id="2894551">0</span>&nbsp;<span class="op" id="2894553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2894558">//&nbsp;extract&nbsp;least&nbsp;significant,&nbsp;base&nbsp;bb&nbsp;&#34;digit&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894607"><a href="/math/big/nat.go.html#2892784">q</a></span><span class="op" id="2894608">,</span>&nbsp;<span class="ident" id="2894610"><a href="/math/big/nat.go.html#2893960">r</a></span>&nbsp;<span class="op" id="2894612">=</span>&nbsp;<span class="ident" id="2894614"><a href="/math/big/nat.go.html#2892784">q</a></span><span class="op" id="2894615">.</span><span class="ident" id="2894616">divW</span><span class="op" id="2894620">(</span><span class="ident" id="2894621"><a href="/math/big/nat.go.html#2892784">q</a></span><span class="op" id="2894622">,</span>&nbsp;<span class="ident" id="2894624"><a href="/math/big/nat.go.html#2892851">bb</a></span><span class="op" id="2894626">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2894631">for</span>&nbsp;<span class="ident" id="2894635">j</span>&nbsp;<span class="op" id="2894637">:=</span>&nbsp;<span class="num" id="2894640">0</span><span class="op" id="2894641">;</span>&nbsp;<span class="ident" id="2894643"><a href="/math/big/nat.go.html#2894635">j</a></span>&nbsp;<span class="op" id="2894645">&lt;</span>&nbsp;<span class="ident" id="2894647"><a href="/math/big/nat.go.html#2892838">ndigits</a></span>&nbsp;<span class="op" id="2894655">&amp;&amp;</span>&nbsp;<span class="ident" id="2894658"><a href="/math/big/nat.go.html#2893943">i</a></span>&nbsp;<span class="op" id="2894660">&gt;</span>&nbsp;<span class="num" id="2894662">0</span><span class="op" id="2894663">;</span>&nbsp;<span class="ident" id="2894665"><a href="/math/big/nat.go.html#2894635">j</a></span><span class="op" id="2894666">++</span>&nbsp;<span class="op" id="2894669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894675"><a href="/math/big/nat.go.html#2893943">i</a></span><span class="op" id="2894676">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894683"><a href="/math/big/nat.go.html#2892804">s</a></span><span class="op" id="2894684">[</span><span class="ident" id="2894685"><a href="/math/big/nat.go.html#2893943">i</a></span><span class="op" id="2894686">]</span>&nbsp;<span class="op" id="2894688">=</span>&nbsp;<span class="ident" id="2894690"><a href="/math/big/nat.go.html#2892814">charset</a></span><span class="op" id="2894697">[</span><span class="ident" id="2894698"><a href="/math/big/nat.go.html#2893960">r</a></span><span class="op" id="2894699">%</span><span class="ident" id="2894700"><a href="/math/big/nat.go.html#2892830">b</a></span><span class="op" id="2894701">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894707"><a href="/math/big/nat.go.html#2893960">r</a></span>&nbsp;<span class="op" id="2894709">/=</span>&nbsp;<span class="ident" id="2894712"><a href="/math/big/nat.go.html#2892830">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2894717">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2894721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2894724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2894728">//&nbsp;prepend&nbsp;high-order&nbsp;zeroes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894758">zero</span>&nbsp;<span class="op" id="2894763">:=</span>&nbsp;<span class="ident" id="2894766"><a href="/math/big/nat.go.html#2892814">charset</a></span><span class="op" id="2894773">[</span><span class="num" id="2894774">0</span><span class="op" id="2894775">]</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2894778">for</span>&nbsp;<span class="ident" id="2894782"><a href="/math/big/nat.go.html#2893943">i</a></span>&nbsp;<span class="op" id="2894784">&gt;</span>&nbsp;<span class="num" id="2894786">0</span>&nbsp;<span class="op" id="2894788">{</span>&nbsp;<span class="comment" id="2894790">//&nbsp;while&nbsp;need&nbsp;more&nbsp;leading&nbsp;zeroes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894826"><a href="/math/big/nat.go.html#2893943">i</a></span><span class="op" id="2894827">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894832"><a href="/math/big/nat.go.html#2892804">s</a></span><span class="op" id="2894833">[</span><span class="ident" id="2894834"><a href="/math/big/nat.go.html#2893943">i</a></span><span class="op" id="2894835">]</span>&nbsp;<span class="op" id="2894837">=</span>&nbsp;<span class="ident" id="2894839"><a href="/math/big/nat.go.html#2894758">zero</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2894845">}</span><br>
<span class="lineno"></span><span class="op" id="2894847">}</span><br>
<span class="lineno">910</span><br>
<span class="lineno"></span><span class="comment" id="2894850">//&nbsp;Split&nbsp;blocks&nbsp;greater&nbsp;than&nbsp;leafSize&nbsp;Words&nbsp;(or&nbsp;set&nbsp;to&nbsp;0&nbsp;to&nbsp;disable&nbsp;recursive&nbsp;conversion)</span><br>
<span class="lineno"></span><span class="comment" id="2894940">//&nbsp;Benchmark&nbsp;and&nbsp;configure&nbsp;leafSize&nbsp;using:&nbsp;go&nbsp;test&nbsp;-bench=&#34;Leaf&#34;</span><br>
<span class="lineno"></span><span class="comment" id="2895005">//&nbsp;&nbsp;&nbsp;8&nbsp;and&nbsp;16&nbsp;effective&nbsp;on&nbsp;3.0&nbsp;GHz&nbsp;Xeon&nbsp;&#34;Clovertown&#34;&nbsp;CPU&nbsp;(128&nbsp;byte&nbsp;cache&nbsp;lines)</span><br>
<span class="lineno"></span><span class="comment" id="2895085">//&nbsp;&nbsp;&nbsp;8&nbsp;and&nbsp;16&nbsp;effective&nbsp;on&nbsp;2.66&nbsp;GHz&nbsp;Core&nbsp;2&nbsp;Duo&nbsp;&#34;Penryn&#34;&nbsp;CPU</span><br>
<span class="lineno">915</span><span class="keyword" id="2895145">var</span>&nbsp;<span class="ident" id="2895149">leafSize</span>&nbsp;<span class="builtintype" id="2895158">int</span>&nbsp;<span class="op" id="2895162">=</span>&nbsp;<span class="num" id="2895164">8</span>&nbsp;<span class="comment" id="2895166">//&nbsp;number&nbsp;of&nbsp;Word-size&nbsp;binary&nbsp;values&nbsp;treat&nbsp;as&nbsp;a&nbsp;monolithic&nbsp;block</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2895232">type</span>&nbsp;<span class="ident" id="2895237">divisor</span>&nbsp;<span class="keyword" id="2895245">struct</span>&nbsp;<span class="op" id="2895252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895255">bbb</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2895263"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="comment" id="2895267">//&nbsp;divisor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895279">nbits</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2895287">int</span>&nbsp;<span class="comment" id="2895291">//&nbsp;bit&nbsp;length&nbsp;of&nbsp;divisor&nbsp;(discounting&nbsp;leading&nbsp;zeroes)&nbsp;~=&nbsp;log2(bbb)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895359">ndigits</span>&nbsp;<span class="builtintype" id="2895367">int</span>&nbsp;<span class="comment" id="2895371">//&nbsp;digit&nbsp;length&nbsp;of&nbsp;divisor&nbsp;in&nbsp;terms&nbsp;of&nbsp;output&nbsp;base&nbsp;digits</span><br>
<span class="lineno"></span><span class="op" id="2895429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2895432">var</span>&nbsp;<span class="ident" id="2895436">cacheBase10</span>&nbsp;<span class="keyword" id="2895448">struct</span>&nbsp;<span class="op" id="2895455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895458"><a href="/math/big/nat.go.html#2873354">sync</a></span><span class="op" id="2895462">.</span><span class="ident" id="2895463">Mutex</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895470">table</span>&nbsp;<span class="op" id="2895476">[</span><span class="num" id="2895477">64</span><span class="op" id="2895479">]</span><span class="ident" id="2895480"><a href="/math/big/nat.go.html#2895237">divisor</a></span>&nbsp;<span class="comment" id="2895488">//&nbsp;cached&nbsp;divisors&nbsp;for&nbsp;base&nbsp;10</span><br>
<span class="lineno"></span><span class="op" id="2895519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2895522">//&nbsp;expWW&nbsp;computes&nbsp;x**y</span><br>
<span class="lineno"></span><span class="keyword" id="2895545">func</span>&nbsp;<span class="op" id="2895550">(</span><span class="ident" id="2895551">z</span>&nbsp;<span class="ident" id="2895553"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2895556">)</span>&nbsp;<span class="ident" id="2895558">expWW</span><span class="op" id="2895563">(</span><span class="ident" id="2895564">x</span><span class="op" id="2895565">,</span>&nbsp;<span class="ident" id="2895567">y</span>&nbsp;<span class="ident" id="2895569"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2895573">)</span>&nbsp;<span class="ident" id="2895575"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2895579">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2895582">return</span>&nbsp;<span class="ident" id="2895589"><a href="/math/big/nat.go.html#2895551">z</a></span><span class="op" id="2895590">.</span><span class="ident" id="2895591">expNN</span><span class="op" id="2895596">(</span><span class="ident" id="2895597"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2895600">(</span><span class="ident" id="2895601">nil</span><span class="op" id="2895604">)</span><span class="op" id="2895605">.</span><span class="ident" id="2895606">setWord</span><span class="op" id="2895613">(</span><span class="ident" id="2895614"><a href="/math/big/nat.go.html#2895564">x</a></span><span class="op" id="2895615">)</span><span class="op" id="2895616">,</span>&nbsp;<span class="ident" id="2895618"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2895621">(</span><span class="ident" id="2895622">nil</span><span class="op" id="2895625">)</span><span class="op" id="2895626">.</span><span class="ident" id="2895627">setWord</span><span class="op" id="2895634">(</span><span class="ident" id="2895635"><a href="/math/big/nat.go.html#2895567">y</a></span><span class="op" id="2895636">)</span><span class="op" id="2895637">,</span>&nbsp;<span class="ident" id="2895639">nil</span><span class="op" id="2895642">)</span><br>
<span class="lineno"></span><span class="op" id="2895644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2895647">//&nbsp;construct&nbsp;table&nbsp;of&nbsp;powers&nbsp;of&nbsp;bb*leafSize&nbsp;to&nbsp;use&nbsp;in&nbsp;subdivisions</span><br>
<span class="lineno"></span><span class="keyword" id="2895714">func</span>&nbsp;<span class="ident" id="2895719">divisors</span><span class="op" id="2895727">(</span><span class="ident" id="2895728">m</span>&nbsp;<span class="builtintype" id="2895730">int</span><span class="op" id="2895733">,</span>&nbsp;<span class="ident" id="2895735">b</span>&nbsp;<span class="ident" id="2895737"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2895741">,</span>&nbsp;<span class="ident" id="2895743">ndigits</span>&nbsp;<span class="builtintype" id="2895751">int</span><span class="op" id="2895754">,</span>&nbsp;<span class="ident" id="2895756">bb</span>&nbsp;<span class="ident" id="2895759"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2895763">)</span>&nbsp;<span class="op" id="2895765">[</span><span class="op" id="2895766">]</span><span class="ident" id="2895767"><a href="/math/big/nat.go.html#2895237">divisor</a></span>&nbsp;<span class="op" id="2895775">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2895778">//&nbsp;only&nbsp;compute&nbsp;table&nbsp;when&nbsp;recursive&nbsp;conversion&nbsp;is&nbsp;enabled&nbsp;and&nbsp;x&nbsp;is&nbsp;large</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2895853">if</span>&nbsp;<span class="ident" id="2895856"><a href="/math/big/nat.go.html#2895149">leafSize</a></span>&nbsp;<span class="op" id="2895865">==</span>&nbsp;<span class="num" id="2895868">0</span>&nbsp;<span class="op" id="2895870">||</span>&nbsp;<span class="ident" id="2895873"><a href="/math/big/nat.go.html#2895728">m</a></span>&nbsp;<span class="op" id="2895875">&lt;=</span>&nbsp;<span class="ident" id="2895878"><a href="/math/big/nat.go.html#2895149">leafSize</a></span>&nbsp;<span class="op" id="2895887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2895891">return</span>&nbsp;<span class="ident" id="2895898">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2895903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2895907">//&nbsp;determine&nbsp;k&nbsp;where&nbsp;(bb**leafSize)**(2**k)&nbsp;&gt;=&nbsp;sqrt(x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2895963">k</span>&nbsp;<span class="op" id="2895965">:=</span>&nbsp;<span class="num" id="2895968">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2895971">for</span>&nbsp;<span class="ident" id="2895975">words</span>&nbsp;<span class="op" id="2895981">:=</span>&nbsp;<span class="ident" id="2895984"><a href="/math/big/nat.go.html#2895149">leafSize</a></span><span class="op" id="2895992">;</span>&nbsp;<span class="ident" id="2895994"><a href="/math/big/nat.go.html#2895975">words</a></span>&nbsp;<span class="op" id="2896000">&lt;</span>&nbsp;<span class="ident" id="2896002"><a href="/math/big/nat.go.html#2895728">m</a></span><span class="op" id="2896003">&gt;&gt;</span><span class="num" id="2896005">1</span>&nbsp;<span class="op" id="2896007">&amp;&amp;</span>&nbsp;<span class="ident" id="2896010"><a href="/math/big/nat.go.html#2895963">k</a></span>&nbsp;<span class="op" id="2896012">&lt;</span>&nbsp;<span class="builtinfunc" id="2896014">len</span><span class="op" id="2896017">(</span><span class="ident" id="2896018"><a href="/math/big/nat.go.html#2895436">cacheBase10</a></span><span class="op" id="2896029">.</span><span class="ident" id="2896030">table</span><span class="op" id="2896035">)</span><span class="op" id="2896036">;</span>&nbsp;<span class="ident" id="2896038"><a href="/math/big/nat.go.html#2895975">words</a></span>&nbsp;<span class="op" id="2896044">&lt;&lt;=</span>&nbsp;<span class="num" id="2896048">1</span>&nbsp;<span class="op" id="2896050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896054"><a href="/math/big/nat.go.html#2895963">k</a></span><span class="op" id="2896055">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2896059">}</span><br>
<span class="lineno">945</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2896063">//&nbsp;reuse&nbsp;and&nbsp;extend&nbsp;existing&nbsp;table&nbsp;of&nbsp;divisors&nbsp;or&nbsp;create&nbsp;new&nbsp;table&nbsp;as&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896146">var</span>&nbsp;<span class="ident" id="2896150">table</span>&nbsp;<span class="op" id="2896156">[</span><span class="op" id="2896157">]</span><span class="ident" id="2896158"><a href="/math/big/nat.go.html#2895237">divisor</a></span>&nbsp;<span class="comment" id="2896166">//&nbsp;for&nbsp;b&nbsp;==&nbsp;10,&nbsp;table&nbsp;overlaps&nbsp;with&nbsp;cacheBase10.table</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896221">if</span>&nbsp;<span class="ident" id="2896224"><a href="/math/big/nat.go.html#2895735">b</a></span>&nbsp;<span class="op" id="2896226">==</span>&nbsp;<span class="num" id="2896229">10</span>&nbsp;<span class="op" id="2896232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896236"><a href="/math/big/nat.go.html#2895436">cacheBase10</a></span><span class="op" id="2896247">.</span><span class="ident" id="2896248">Lock</span><span class="op" id="2896252">(</span><span class="op" id="2896253">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896257"><a href="/math/big/nat.go.html#2896150">table</a></span>&nbsp;<span class="op" id="2896263">=</span>&nbsp;<span class="ident" id="2896265"><a href="/math/big/nat.go.html#2895436">cacheBase10</a></span><span class="op" id="2896276">.</span><span class="ident" id="2896277">table</span><span class="op" id="2896282">[</span><span class="num" id="2896283">0</span><span class="op" id="2896284">:</span><span class="ident" id="2896285"><a href="/math/big/nat.go.html#2895963">k</a></span><span class="op" id="2896286">]</span>&nbsp;<span class="comment" id="2896288">//&nbsp;reuse&nbsp;old&nbsp;table&nbsp;for&nbsp;this&nbsp;conversion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2896328">}</span>&nbsp;<span class="keyword" id="2896330">else</span>&nbsp;<span class="op" id="2896335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896339"><a href="/math/big/nat.go.html#2896150">table</a></span>&nbsp;<span class="op" id="2896345">=</span>&nbsp;<span class="builtinfunc" id="2896347">make</span><span class="op" id="2896351">(</span><span class="op" id="2896352">[</span><span class="op" id="2896353">]</span><span class="ident" id="2896354"><a href="/math/big/nat.go.html#2895237">divisor</a></span><span class="op" id="2896361">,</span>&nbsp;<span class="ident" id="2896363"><a href="/math/big/nat.go.html#2895963">k</a></span><span class="op" id="2896364">)</span>&nbsp;<span class="comment" id="2896366">//&nbsp;create&nbsp;new&nbsp;table&nbsp;for&nbsp;this&nbsp;conversion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2896407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2896411">//&nbsp;extend&nbsp;table</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896428">if</span>&nbsp;<span class="ident" id="2896431"><a href="/math/big/nat.go.html#2896150">table</a></span><span class="op" id="2896436">[</span><span class="ident" id="2896437"><a href="/math/big/nat.go.html#2895963">k</a></span><span class="op" id="2896438">-</span><span class="num" id="2896439">1</span><span class="op" id="2896440">]</span><span class="op" id="2896441">.</span><span class="ident" id="2896442">ndigits</span>&nbsp;<span class="op" id="2896450">==</span>&nbsp;<span class="num" id="2896453">0</span>&nbsp;<span class="op" id="2896455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2896459">//&nbsp;add&nbsp;new&nbsp;entries&nbsp;as&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896490">var</span>&nbsp;<span class="ident" id="2896494">larger</span>&nbsp;<span class="ident" id="2896501"><a href="/math/big/nat.go.html#2873877">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896507">for</span>&nbsp;<span class="ident" id="2896511">i</span>&nbsp;<span class="op" id="2896513">:=</span>&nbsp;<span class="num" id="2896516">0</span><span class="op" id="2896517">;</span>&nbsp;<span class="ident" id="2896519"><a href="/math/big/nat.go.html#2896511">i</a></span>&nbsp;<span class="op" id="2896521">&lt;</span>&nbsp;<span class="ident" id="2896523"><a href="/math/big/nat.go.html#2895963">k</a></span><span class="op" id="2896524">;</span>&nbsp;<span class="ident" id="2896526"><a href="/math/big/nat.go.html#2896511">i</a></span><span class="op" id="2896527">++</span>&nbsp;<span class="op" id="2896530">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896535">if</span>&nbsp;<span class="ident" id="2896538"><a href="/math/big/nat.go.html#2896150">table</a></span><span class="op" id="2896543">[</span><span class="ident" id="2896544"><a href="/math/big/nat.go.html#2896511">i</a></span><span class="op" id="2896545">]</span><span class="op" id="2896546">.</span><span class="ident" id="2896547">ndigits</span>&nbsp;<span class="op" id="2896555">==</span>&nbsp;<span class="num" id="2896558">0</span>&nbsp;<span class="op" id="2896560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896566">if</span>&nbsp;<span class="ident" id="2896569"><a href="/math/big/nat.go.html#2896511">i</a></span>&nbsp;<span class="op" id="2896571">==</span>&nbsp;<span class="num" id="2896574">0</span>&nbsp;<span class="op" id="2896576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896583"><a href="/math/big/nat.go.html#2896150">table</a></span><span class="op" id="2896588">[</span><span class="num" id="2896589">0</span><span class="op" id="2896590">]</span><span class="op" id="2896591">.</span><span class="ident" id="2896592">bbb</span>&nbsp;<span class="op" id="2896596">=</span>&nbsp;<span class="ident" id="2896598"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2896601">(</span><span class="ident" id="2896602">nil</span><span class="op" id="2896605">)</span><span class="op" id="2896606">.</span><span class="ident" id="2896607">expWW</span><span class="op" id="2896612">(</span><span class="ident" id="2896613"><a href="/math/big/nat.go.html#2895756">bb</a></span><span class="op" id="2896615">,</span>&nbsp;<span class="ident" id="2896617"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2896621">(</span><span class="ident" id="2896622"><a href="/math/big/nat.go.html#2895149">leafSize</a></span><span class="op" id="2896630">)</span><span class="op" id="2896631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896638"><a href="/math/big/nat.go.html#2896150">table</a></span><span class="op" id="2896643">[</span><span class="num" id="2896644">0</span><span class="op" id="2896645">]</span><span class="op" id="2896646">.</span><span class="ident" id="2896647">ndigits</span>&nbsp;<span class="op" id="2896655">=</span>&nbsp;<span class="ident" id="2896657"><a href="/math/big/nat.go.html#2895743">ndigits</a></span>&nbsp;<span class="op" id="2896665">*</span>&nbsp;<span class="ident" id="2896667"><a href="/math/big/nat.go.html#2895149">leafSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2896680">}</span>&nbsp;<span class="keyword" id="2896682">else</span>&nbsp;<span class="op" id="2896687">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896694"><a href="/math/big/nat.go.html#2896150">table</a></span><span class="op" id="2896699">[</span><span class="ident" id="2896700"><a href="/math/big/nat.go.html#2896511">i</a></span><span class="op" id="2896701">]</span><span class="op" id="2896702">.</span><span class="ident" id="2896703">bbb</span>&nbsp;<span class="op" id="2896707">=</span>&nbsp;<span class="ident" id="2896709"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2896712">(</span><span class="ident" id="2896713">nil</span><span class="op" id="2896716">)</span><span class="op" id="2896717">.</span><span class="ident" id="2896718">mul</span><span class="op" id="2896721">(</span><span class="ident" id="2896722"><a href="/math/big/nat.go.html#2896150">table</a></span><span class="op" id="2896727">[</span><span class="ident" id="2896728"><a href="/math/big/nat.go.html#2896511">i</a></span><span class="op" id="2896729">-</span><span class="num" id="2896730">1</span><span class="op" id="2896731">]</span><span class="op" id="2896732">.</span><span class="ident" id="2896733">bbb</span><span class="op" id="2896736">,</span>&nbsp;<span class="ident" id="2896738"><a href="/math/big/nat.go.html#2896150">table</a></span><span class="op" id="2896743">[</span><span class="ident" id="2896744"><a href="/math/big/nat.go.html#2896511">i</a></span><span class="op" id="2896745">-</span><span class="num" id="2896746">1</span><span class="op" id="2896747">]</span><span class="op" id="2896748">.</span><span class="ident" id="2896749">bbb</span><span class="op" id="2896752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896759"><a href="/math/big/nat.go.html#2896150">table</a></span><span class="op" id="2896764">[</span><span class="ident" id="2896765"><a href="/math/big/nat.go.html#2896511">i</a></span><span class="op" id="2896766">]</span><span class="op" id="2896767">.</span><span class="ident" id="2896768">ndigits</span>&nbsp;<span class="op" id="2896776">=</span>&nbsp;<span class="num" id="2896778">2</span>&nbsp;<span class="op" id="2896780">*</span>&nbsp;<span class="ident" id="2896782"><a href="/math/big/nat.go.html#2896150">table</a></span><span class="op" id="2896787">[</span><span class="ident" id="2896788"><a href="/math/big/nat.go.html#2896511">i</a></span><span class="op" id="2896789">-</span><span class="num" id="2896790">1</span><span class="op" id="2896791">]</span><span class="op" id="2896792">.</span><span class="ident" id="2896793">ndigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2896805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2896812">//&nbsp;optimization:&nbsp;exploit&nbsp;aggregated&nbsp;extra&nbsp;bits&nbsp;in&nbsp;macro&nbsp;blocks</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896879"><a href="/math/big/nat.go.html#2896494">larger</a></span>&nbsp;<span class="op" id="2896886">=</span>&nbsp;<span class="ident" id="2896888"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2896891">(</span><span class="ident" id="2896892">nil</span><span class="op" id="2896895">)</span><span class="op" id="2896896">.</span><span class="ident" id="2896897">set</span><span class="op" id="2896900">(</span><span class="ident" id="2896901"><a href="/math/big/nat.go.html#2896150">table</a></span><span class="op" id="2896906">[</span><span class="ident" id="2896907"><a href="/math/big/nat.go.html#2896511">i</a></span><span class="op" id="2896908">]</span><span class="op" id="2896909">.</span><span class="ident" id="2896910">bbb</span><span class="op" id="2896913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896919">for</span>&nbsp;<span class="ident" id="2896923"><a href="/math/big/arith_decl.go.html#2847129">mulAddVWW</a></span><span class="op" id="2896932">(</span><span class="ident" id="2896933"><a href="/math/big/nat.go.html#2896494">larger</a></span><span class="op" id="2896939">,</span>&nbsp;<span class="ident" id="2896941"><a href="/math/big/nat.go.html#2896494">larger</a></span><span class="op" id="2896947">,</span>&nbsp;<span class="ident" id="2896949"><a href="/math/big/nat.go.html#2895735">b</a></span><span class="op" id="2896950">,</span>&nbsp;<span class="num" id="2896952">0</span><span class="op" id="2896953">)</span>&nbsp;<span class="op" id="2896955">==</span>&nbsp;<span class="num" id="2896958">0</span>&nbsp;<span class="op" id="2896960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896967"><a href="/math/big/nat.go.html#2896150">table</a></span><span class="op" id="2896972">[</span><span class="ident" id="2896973"><a href="/math/big/nat.go.html#2896511">i</a></span><span class="op" id="2896974">]</span><span class="op" id="2896975">.</span><span class="ident" id="2896976">bbb</span>&nbsp;<span class="op" id="2896980">=</span>&nbsp;<span class="ident" id="2896982"><a href="/math/big/nat.go.html#2896150">table</a></span><span class="op" id="2896987">[</span><span class="ident" id="2896988"><a href="/math/big/nat.go.html#2896511">i</a></span><span class="op" id="2896989">]</span><span class="op" id="2896990">.</span><span class="ident" id="2896991">bbb</span><span class="op" id="2896994">.</span><span class="ident" id="2896995">set</span><span class="op" id="2896998">(</span><span class="ident" id="2896999"><a href="/math/big/nat.go.html#2896494">larger</a></span><span class="op" id="2897005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897012"><a href="/math/big/nat.go.html#2896150">table</a></span><span class="op" id="2897017">[</span><span class="ident" id="2897018"><a href="/math/big/nat.go.html#2896511">i</a></span><span class="op" id="2897019">]</span><span class="op" id="2897020">.</span><span class="ident" id="2897021">ndigits</span><span class="op" id="2897028">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2897035">}</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897042"><a href="/math/big/nat.go.html#2896150">table</a></span><span class="op" id="2897047">[</span><span class="ident" id="2897048"><a href="/math/big/nat.go.html#2896511">i</a></span><span class="op" id="2897049">]</span><span class="op" id="2897050">.</span><span class="ident" id="2897051">nbits</span>&nbsp;<span class="op" id="2897057">=</span>&nbsp;<span class="ident" id="2897059"><a href="/math/big/nat.go.html#2896150">table</a></span><span class="op" id="2897064">[</span><span class="ident" id="2897065"><a href="/math/big/nat.go.html#2896511">i</a></span><span class="op" id="2897066">]</span><span class="op" id="2897067">.</span><span class="ident" id="2897068">bbb</span><span class="op" id="2897071">.</span><span class="ident" id="2897072">bitLen</span><span class="op" id="2897078">(</span><span class="op" id="2897079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2897084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2897088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2897091">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2897095">if</span>&nbsp;<span class="ident" id="2897098"><a href="/math/big/nat.go.html#2895735">b</a></span>&nbsp;<span class="op" id="2897100">==</span>&nbsp;<span class="num" id="2897103">10</span>&nbsp;<span class="op" id="2897106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897110"><a href="/math/big/nat.go.html#2895436">cacheBase10</a></span><span class="op" id="2897121">.</span><span class="ident" id="2897122">Unlock</span><span class="op" id="2897128">(</span><span class="op" id="2897129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2897132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2897136">return</span>&nbsp;<span class="ident" id="2897143"><a href="/math/big/nat.go.html#2896150">table</a></span><br>
<span class="lineno"></span><span class="op" id="2897149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2897152">const</span>&nbsp;<span class="ident" id="2897158">deBruijn32</span>&nbsp;<span class="op" id="2897169">=</span>&nbsp;<span class="num" id="2897171">0x077CB531</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span><span class="keyword" id="2897183">var</span>&nbsp;<span class="ident" id="2897187">deBruijn32Lookup</span>&nbsp;<span class="op" id="2897204">=</span>&nbsp;<span class="op" id="2897206">[</span><span class="op" id="2897207">]</span><span class="builtintype" id="2897208">byte</span><span class="op" id="2897212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2897215">0</span><span class="op" id="2897216">,</span>&nbsp;<span class="num" id="2897218">1</span><span class="op" id="2897219">,</span>&nbsp;<span class="num" id="2897221">28</span><span class="op" id="2897223">,</span>&nbsp;<span class="num" id="2897225">2</span><span class="op" id="2897226">,</span>&nbsp;<span class="num" id="2897228">29</span><span class="op" id="2897230">,</span>&nbsp;<span class="num" id="2897232">14</span><span class="op" id="2897234">,</span>&nbsp;<span class="num" id="2897236">24</span><span class="op" id="2897238">,</span>&nbsp;<span class="num" id="2897240">3</span><span class="op" id="2897241">,</span>&nbsp;<span class="num" id="2897243">30</span><span class="op" id="2897245">,</span>&nbsp;<span class="num" id="2897247">22</span><span class="op" id="2897249">,</span>&nbsp;<span class="num" id="2897251">20</span><span class="op" id="2897253">,</span>&nbsp;<span class="num" id="2897255">15</span><span class="op" id="2897257">,</span>&nbsp;<span class="num" id="2897259">25</span><span class="op" id="2897261">,</span>&nbsp;<span class="num" id="2897263">17</span><span class="op" id="2897265">,</span>&nbsp;<span class="num" id="2897267">4</span><span class="op" id="2897268">,</span>&nbsp;<span class="num" id="2897270">8</span><span class="op" id="2897271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2897274">31</span><span class="op" id="2897276">,</span>&nbsp;<span class="num" id="2897278">27</span><span class="op" id="2897280">,</span>&nbsp;<span class="num" id="2897282">13</span><span class="op" id="2897284">,</span>&nbsp;<span class="num" id="2897286">23</span><span class="op" id="2897288">,</span>&nbsp;<span class="num" id="2897290">21</span><span class="op" id="2897292">,</span>&nbsp;<span class="num" id="2897294">19</span><span class="op" id="2897296">,</span>&nbsp;<span class="num" id="2897298">16</span><span class="op" id="2897300">,</span>&nbsp;<span class="num" id="2897302">7</span><span class="op" id="2897303">,</span>&nbsp;<span class="num" id="2897305">26</span><span class="op" id="2897307">,</span>&nbsp;<span class="num" id="2897309">12</span><span class="op" id="2897311">,</span>&nbsp;<span class="num" id="2897313">18</span><span class="op" id="2897315">,</span>&nbsp;<span class="num" id="2897317">6</span><span class="op" id="2897318">,</span>&nbsp;<span class="num" id="2897320">11</span><span class="op" id="2897322">,</span>&nbsp;<span class="num" id="2897324">5</span><span class="op" id="2897325">,</span>&nbsp;<span class="num" id="2897327">10</span><span class="op" id="2897329">,</span>&nbsp;<span class="num" id="2897331">9</span><span class="op" id="2897332">,</span><br>
<span class="lineno"></span><span class="op" id="2897334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">995</span><span class="keyword" id="2897337">const</span>&nbsp;<span class="ident" id="2897343">deBruijn64</span>&nbsp;<span class="op" id="2897354">=</span>&nbsp;<span class="num" id="2897356">0x03f79d71b4ca8b09</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2897376">var</span>&nbsp;<span class="ident" id="2897380">deBruijn64Lookup</span>&nbsp;<span class="op" id="2897397">=</span>&nbsp;<span class="op" id="2897399">[</span><span class="op" id="2897400">]</span><span class="builtintype" id="2897401">byte</span><span class="op" id="2897405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2897408">0</span><span class="op" id="2897409">,</span>&nbsp;<span class="num" id="2897411">1</span><span class="op" id="2897412">,</span>&nbsp;<span class="num" id="2897414">56</span><span class="op" id="2897416">,</span>&nbsp;<span class="num" id="2897418">2</span><span class="op" id="2897419">,</span>&nbsp;<span class="num" id="2897421">57</span><span class="op" id="2897423">,</span>&nbsp;<span class="num" id="2897425">49</span><span class="op" id="2897427">,</span>&nbsp;<span class="num" id="2897429">28</span><span class="op" id="2897431">,</span>&nbsp;<span class="num" id="2897433">3</span><span class="op" id="2897434">,</span>&nbsp;<span class="num" id="2897436">61</span><span class="op" id="2897438">,</span>&nbsp;<span class="num" id="2897440">58</span><span class="op" id="2897442">,</span>&nbsp;<span class="num" id="2897444">42</span><span class="op" id="2897446">,</span>&nbsp;<span class="num" id="2897448">50</span><span class="op" id="2897450">,</span>&nbsp;<span class="num" id="2897452">38</span><span class="op" id="2897454">,</span>&nbsp;<span class="num" id="2897456">29</span><span class="op" id="2897458">,</span>&nbsp;<span class="num" id="2897460">17</span><span class="op" id="2897462">,</span>&nbsp;<span class="num" id="2897464">4</span><span class="op" id="2897465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2897468">62</span><span class="op" id="2897470">,</span>&nbsp;<span class="num" id="2897472">47</span><span class="op" id="2897474">,</span>&nbsp;<span class="num" id="2897476">59</span><span class="op" id="2897478">,</span>&nbsp;<span class="num" id="2897480">36</span><span class="op" id="2897482">,</span>&nbsp;<span class="num" id="2897484">45</span><span class="op" id="2897486">,</span>&nbsp;<span class="num" id="2897488">43</span><span class="op" id="2897490">,</span>&nbsp;<span class="num" id="2897492">51</span><span class="op" id="2897494">,</span>&nbsp;<span class="num" id="2897496">22</span><span class="op" id="2897498">,</span>&nbsp;<span class="num" id="2897500">53</span><span class="op" id="2897502">,</span>&nbsp;<span class="num" id="2897504">39</span><span class="op" id="2897506">,</span>&nbsp;<span class="num" id="2897508">33</span><span class="op" id="2897510">,</span>&nbsp;<span class="num" id="2897512">30</span><span class="op" id="2897514">,</span>&nbsp;<span class="num" id="2897516">24</span><span class="op" id="2897518">,</span>&nbsp;<span class="num" id="2897520">18</span><span class="op" id="2897522">,</span>&nbsp;<span class="num" id="2897524">12</span><span class="op" id="2897526">,</span>&nbsp;<span class="num" id="2897528">5</span><span class="op" id="2897529">,</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2897532">63</span><span class="op" id="2897534">,</span>&nbsp;<span class="num" id="2897536">55</span><span class="op" id="2897538">,</span>&nbsp;<span class="num" id="2897540">48</span><span class="op" id="2897542">,</span>&nbsp;<span class="num" id="2897544">27</span><span class="op" id="2897546">,</span>&nbsp;<span class="num" id="2897548">60</span><span class="op" id="2897550">,</span>&nbsp;<span class="num" id="2897552">41</span><span class="op" id="2897554">,</span>&nbsp;<span class="num" id="2897556">37</span><span class="op" id="2897558">,</span>&nbsp;<span class="num" id="2897560">16</span><span class="op" id="2897562">,</span>&nbsp;<span class="num" id="2897564">46</span><span class="op" id="2897566">,</span>&nbsp;<span class="num" id="2897568">35</span><span class="op" id="2897570">,</span>&nbsp;<span class="num" id="2897572">44</span><span class="op" id="2897574">,</span>&nbsp;<span class="num" id="2897576">21</span><span class="op" id="2897578">,</span>&nbsp;<span class="num" id="2897580">52</span><span class="op" id="2897582">,</span>&nbsp;<span class="num" id="2897584">32</span><span class="op" id="2897586">,</span>&nbsp;<span class="num" id="2897588">23</span><span class="op" id="2897590">,</span>&nbsp;<span class="num" id="2897592">11</span><span class="op" id="2897594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2897597">54</span><span class="op" id="2897599">,</span>&nbsp;<span class="num" id="2897601">26</span><span class="op" id="2897603">,</span>&nbsp;<span class="num" id="2897605">40</span><span class="op" id="2897607">,</span>&nbsp;<span class="num" id="2897609">15</span><span class="op" id="2897611">,</span>&nbsp;<span class="num" id="2897613">34</span><span class="op" id="2897615">,</span>&nbsp;<span class="num" id="2897617">20</span><span class="op" id="2897619">,</span>&nbsp;<span class="num" id="2897621">31</span><span class="op" id="2897623">,</span>&nbsp;<span class="num" id="2897625">10</span><span class="op" id="2897627">,</span>&nbsp;<span class="num" id="2897629">25</span><span class="op" id="2897631">,</span>&nbsp;<span class="num" id="2897633">14</span><span class="op" id="2897635">,</span>&nbsp;<span class="num" id="2897637">19</span><span class="op" id="2897639">,</span>&nbsp;<span class="num" id="2897641">9</span><span class="op" id="2897642">,</span>&nbsp;<span class="num" id="2897644">13</span><span class="op" id="2897646">,</span>&nbsp;<span class="num" id="2897648">8</span><span class="op" id="2897649">,</span>&nbsp;<span class="num" id="2897651">7</span><span class="op" id="2897652">,</span>&nbsp;<span class="num" id="2897654">6</span><span class="op" id="2897655">,</span><br>
<span class="lineno"></span><span class="op" id="2897657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2897660">//&nbsp;trailingZeroBits&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;consecutive&nbsp;least&nbsp;significant&nbsp;zero</span><br>
<span class="lineno">1005</span><span class="comment" id="2897737">//&nbsp;bits&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="2897751">func</span>&nbsp;<span class="ident" id="2897756">trailingZeroBits</span><span class="op" id="2897772">(</span><span class="ident" id="2897773">x</span>&nbsp;<span class="ident" id="2897775"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2897779">)</span>&nbsp;<span class="builtintype" id="2897781">uint</span>&nbsp;<span class="op" id="2897786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2897789">//&nbsp;x&nbsp;&amp;&nbsp;-x&nbsp;leaves&nbsp;only&nbsp;the&nbsp;right-most&nbsp;bit&nbsp;set&nbsp;in&nbsp;the&nbsp;word.&nbsp;Let&nbsp;k&nbsp;be&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2897861">//&nbsp;index&nbsp;of&nbsp;that&nbsp;bit.&nbsp;Since&nbsp;only&nbsp;a&nbsp;single&nbsp;bit&nbsp;is&nbsp;set,&nbsp;the&nbsp;value&nbsp;is&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2897933">//&nbsp;to&nbsp;the&nbsp;power&nbsp;of&nbsp;k.&nbsp;Multiplying&nbsp;by&nbsp;a&nbsp;power&nbsp;of&nbsp;two&nbsp;is&nbsp;equivalent&nbsp;to</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2898003">//&nbsp;left&nbsp;shifting,&nbsp;in&nbsp;this&nbsp;case&nbsp;by&nbsp;k&nbsp;bits.&nbsp;&nbsp;The&nbsp;de&nbsp;Bruijn&nbsp;constant&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2898073">//&nbsp;such&nbsp;that&nbsp;all&nbsp;six&nbsp;bit,&nbsp;consecutive&nbsp;substrings&nbsp;are&nbsp;distinct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2898137">//&nbsp;Therefore,&nbsp;if&nbsp;we&nbsp;have&nbsp;a&nbsp;left&nbsp;shifted&nbsp;version&nbsp;of&nbsp;this&nbsp;constant&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2898210">//&nbsp;find&nbsp;by&nbsp;how&nbsp;many&nbsp;bits&nbsp;it&nbsp;was&nbsp;shifted&nbsp;by&nbsp;looking&nbsp;at&nbsp;which&nbsp;six&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2898279">//&nbsp;substring&nbsp;ended&nbsp;up&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;word.</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2898326">//&nbsp;(Knuth,&nbsp;volume&nbsp;4,&nbsp;section&nbsp;7.3.1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898363">switch</span>&nbsp;<span class="ident" id="2898370"><a href="/math/big/arith.go.html#2842878">_W</a></span>&nbsp;<span class="op" id="2898373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898376">case</span>&nbsp;<span class="num" id="2898381">32</span><span class="op" id="2898383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898387">return</span>&nbsp;<span class="builtintype" id="2898394">uint</span><span class="op" id="2898398">(</span><span class="ident" id="2898399"><a href="/math/big/nat.go.html#2897187">deBruijn32Lookup</a></span><span class="op" id="2898415">[</span><span class="op" id="2898416">(</span><span class="op" id="2898417">(</span><span class="ident" id="2898418"><a href="/math/big/nat.go.html#2897773">x</a></span><span class="op" id="2898419">&amp;</span><span class="op" id="2898420">-</span><span class="ident" id="2898421"><a href="/math/big/nat.go.html#2897773">x</a></span><span class="op" id="2898422">)</span><span class="op" id="2898423">*</span><span class="ident" id="2898424"><a href="/math/big/nat.go.html#2897158">deBruijn32</a></span><span class="op" id="2898434">)</span><span class="op" id="2898435">&gt;&gt;</span><span class="num" id="2898437">27</span><span class="op" id="2898439">]</span><span class="op" id="2898440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898443">case</span>&nbsp;<span class="num" id="2898448">64</span><span class="op" id="2898450">:</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898454">return</span>&nbsp;<span class="builtintype" id="2898461">uint</span><span class="op" id="2898465">(</span><span class="ident" id="2898466"><a href="/math/big/nat.go.html#2897380">deBruijn64Lookup</a></span><span class="op" id="2898482">[</span><span class="op" id="2898483">(</span><span class="op" id="2898484">(</span><span class="ident" id="2898485"><a href="/math/big/nat.go.html#2897773">x</a></span><span class="op" id="2898486">&amp;</span><span class="op" id="2898487">-</span><span class="ident" id="2898488"><a href="/math/big/nat.go.html#2897773">x</a></span><span class="op" id="2898489">)</span><span class="op" id="2898490">*</span><span class="op" id="2898491">(</span><span class="ident" id="2898492"><a href="/math/big/nat.go.html#2897343">deBruijn64</a></span><span class="op" id="2898502">&amp;</span><span class="ident" id="2898503"><a href="/math/big/arith.go.html#2842941">_M</a></span><span class="op" id="2898505">)</span><span class="op" id="2898506">)</span><span class="op" id="2898507">&gt;&gt;</span><span class="num" id="2898509">58</span><span class="op" id="2898511">]</span><span class="op" id="2898512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898515">default</span><span class="op" id="2898522">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2898526">panic</span><span class="op" id="2898531">(</span><span class="string" id="2898532">&#34;unknown&nbsp;word&nbsp;size&#34;</span><span class="op" id="2898551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898554">}</span><br>
<span class="lineno"></span><span class="op" id="2898556">}</span><br>
<span class="lineno">1025</span><br>
<span class="lineno"></span><span class="comment" id="2898559">//&nbsp;trailingZeroBits&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;consecutive&nbsp;least&nbsp;significant&nbsp;zero</span><br>
<span class="lineno"></span><span class="comment" id="2898636">//&nbsp;bits&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="2898650">func</span>&nbsp;<span class="op" id="2898655">(</span><span class="ident" id="2898656">x</span>&nbsp;<span class="ident" id="2898658"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2898661">)</span>&nbsp;<span class="ident" id="2898663">trailingZeroBits</span><span class="op" id="2898679">(</span><span class="op" id="2898680">)</span>&nbsp;<span class="builtintype" id="2898682">uint</span>&nbsp;<span class="op" id="2898687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898690">if</span>&nbsp;<span class="builtinfunc" id="2898693">len</span><span class="op" id="2898696">(</span><span class="ident" id="2898697"><a href="/math/big/nat.go.html#2898656">x</a></span><span class="op" id="2898698">)</span>&nbsp;<span class="op" id="2898700">==</span>&nbsp;<span class="num" id="2898703">0</span>&nbsp;<span class="op" id="2898705">{</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898709">return</span>&nbsp;<span class="num" id="2898716">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898722">var</span>&nbsp;<span class="ident" id="2898726">i</span>&nbsp;<span class="builtintype" id="2898728">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898734">for</span>&nbsp;<span class="ident" id="2898738"><a href="/math/big/nat.go.html#2898656">x</a></span><span class="op" id="2898739">[</span><span class="ident" id="2898740"><a href="/math/big/nat.go.html#2898726">i</a></span><span class="op" id="2898741">]</span>&nbsp;<span class="op" id="2898743">==</span>&nbsp;<span class="num" id="2898746">0</span>&nbsp;<span class="op" id="2898748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898752"><a href="/math/big/nat.go.html#2898726">i</a></span><span class="op" id="2898753">++</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2898760">//&nbsp;x[i]&nbsp;!=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898774">return</span>&nbsp;<span class="ident" id="2898781"><a href="/math/big/nat.go.html#2898726">i</a></span><span class="op" id="2898782">*</span><span class="ident" id="2898783"><a href="/math/big/arith.go.html#2842878">_W</a></span>&nbsp;<span class="op" id="2898786">+</span>&nbsp;<span class="ident" id="2898788"><a href="/math/big/nat.go.html#2897756">trailingZeroBits</a></span><span class="op" id="2898804">(</span><span class="ident" id="2898805"><a href="/math/big/nat.go.html#2898656">x</a></span><span class="op" id="2898806">[</span><span class="ident" id="2898807"><a href="/math/big/nat.go.html#2898726">i</a></span><span class="op" id="2898808">]</span><span class="op" id="2898809">)</span><br>
<span class="lineno"></span><span class="op" id="2898811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1040</span><span class="comment" id="2898814">//&nbsp;z&nbsp;=&nbsp;x&nbsp;&lt;&lt;&nbsp;s</span><br>
<span class="lineno"></span><span class="keyword" id="2898828">func</span>&nbsp;<span class="op" id="2898833">(</span><span class="ident" id="2898834">z</span>&nbsp;<span class="ident" id="2898836"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2898839">)</span>&nbsp;<span class="ident" id="2898841">shl</span><span class="op" id="2898844">(</span><span class="ident" id="2898845">x</span>&nbsp;<span class="ident" id="2898847"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2898850">,</span>&nbsp;<span class="ident" id="2898852">s</span>&nbsp;<span class="builtintype" id="2898854">uint</span><span class="op" id="2898858">)</span>&nbsp;<span class="ident" id="2898860"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2898864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898867">m</span>&nbsp;<span class="op" id="2898869">:=</span>&nbsp;<span class="builtinfunc" id="2898872">len</span><span class="op" id="2898875">(</span><span class="ident" id="2898876"><a href="/math/big/nat.go.html#2898845">x</a></span><span class="op" id="2898877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898880">if</span>&nbsp;<span class="ident" id="2898883"><a href="/math/big/nat.go.html#2898867">m</a></span>&nbsp;<span class="op" id="2898885">==</span>&nbsp;<span class="num" id="2898888">0</span>&nbsp;<span class="op" id="2898890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898894">return</span>&nbsp;<span class="ident" id="2898901"><a href="/math/big/nat.go.html#2898834">z</a></span><span class="op" id="2898902">.</span><span class="builtinfunc" id="2898903">make</span><span class="op" id="2898907">(</span><span class="num" id="2898908">0</span><span class="op" id="2898909">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2898915">//&nbsp;m&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898926">n</span>&nbsp;<span class="op" id="2898928">:=</span>&nbsp;<span class="ident" id="2898931"><a href="/math/big/nat.go.html#2898867">m</a></span>&nbsp;<span class="op" id="2898933">+</span>&nbsp;<span class="builtintype" id="2898935">int</span><span class="op" id="2898938">(</span><span class="ident" id="2898939"><a href="/math/big/nat.go.html#2898852">s</a></span><span class="op" id="2898940">/</span><span class="ident" id="2898941"><a href="/math/big/arith.go.html#2842878">_W</a></span><span class="op" id="2898943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898946"><a href="/math/big/nat.go.html#2898834">z</a></span>&nbsp;<span class="op" id="2898948">=</span>&nbsp;<span class="ident" id="2898950"><a href="/math/big/nat.go.html#2898834">z</a></span><span class="op" id="2898951">.</span><span class="builtinfunc" id="2898952">make</span><span class="op" id="2898956">(</span><span class="ident" id="2898957"><a href="/math/big/nat.go.html#2898926">n</a></span>&nbsp;<span class="op" id="2898959">+</span>&nbsp;<span class="num" id="2898961">1</span><span class="op" id="2898962">)</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898965"><a href="/math/big/nat.go.html#2898834">z</a></span><span class="op" id="2898966">[</span><span class="ident" id="2898967"><a href="/math/big/nat.go.html#2898926">n</a></span><span class="op" id="2898968">]</span>&nbsp;<span class="op" id="2898970">=</span>&nbsp;<span class="ident" id="2898972"><a href="/math/big/arith_decl.go.html#2847047">shlVU</a></span><span class="op" id="2898977">(</span><span class="ident" id="2898978"><a href="/math/big/nat.go.html#2898834">z</a></span><span class="op" id="2898979">[</span><span class="ident" id="2898980"><a href="/math/big/nat.go.html#2898926">n</a></span><span class="op" id="2898981">-</span><span class="ident" id="2898982"><a href="/math/big/nat.go.html#2898867">m</a></span><span class="op" id="2898983">:</span><span class="ident" id="2898984"><a href="/math/big/nat.go.html#2898926">n</a></span><span class="op" id="2898985">]</span><span class="op" id="2898986">,</span>&nbsp;<span class="ident" id="2898988"><a href="/math/big/nat.go.html#2898845">x</a></span><span class="op" id="2898989">,</span>&nbsp;<span class="ident" id="2898991"><a href="/math/big/nat.go.html#2898852">s</a></span><span class="op" id="2898992">%</span><span class="ident" id="2898993"><a href="/math/big/arith.go.html#2842878">_W</a></span><span class="op" id="2898995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898998"><a href="/math/big/nat.go.html#2898834">z</a></span><span class="op" id="2898999">[</span><span class="num" id="2899000">0</span>&nbsp;<span class="op" id="2899002">:</span>&nbsp;<span class="ident" id="2899004"><a href="/math/big/nat.go.html#2898926">n</a></span><span class="op" id="2899005">-</span><span class="ident" id="2899006"><a href="/math/big/nat.go.html#2898867">m</a></span><span class="op" id="2899007">]</span><span class="op" id="2899008">.</span><span class="ident" id="2899009">clear</span><span class="op" id="2899014">(</span><span class="op" id="2899015">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899019">return</span>&nbsp;<span class="ident" id="2899026"><a href="/math/big/nat.go.html#2898834">z</a></span><span class="op" id="2899027">.</span><span class="ident" id="2899028">norm</span><span class="op" id="2899032">(</span><span class="op" id="2899033">)</span><br>
<span class="lineno"></span><span class="op" id="2899035">}</span><br>
<span class="lineno">1055</span><br>
<span class="lineno"></span><span class="comment" id="2899038">//&nbsp;z&nbsp;=&nbsp;x&nbsp;&gt;&gt;&nbsp;s</span><br>
<span class="lineno"></span><span class="keyword" id="2899052">func</span>&nbsp;<span class="op" id="2899057">(</span><span class="ident" id="2899058">z</span>&nbsp;<span class="ident" id="2899060"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2899063">)</span>&nbsp;<span class="ident" id="2899065">shr</span><span class="op" id="2899068">(</span><span class="ident" id="2899069">x</span>&nbsp;<span class="ident" id="2899071"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2899074">,</span>&nbsp;<span class="ident" id="2899076">s</span>&nbsp;<span class="builtintype" id="2899078">uint</span><span class="op" id="2899082">)</span>&nbsp;<span class="ident" id="2899084"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2899088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899091">m</span>&nbsp;<span class="op" id="2899093">:=</span>&nbsp;<span class="builtinfunc" id="2899096">len</span><span class="op" id="2899099">(</span><span class="ident" id="2899100"><a href="/math/big/nat.go.html#2899069">x</a></span><span class="op" id="2899101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899104">n</span>&nbsp;<span class="op" id="2899106">:=</span>&nbsp;<span class="ident" id="2899109"><a href="/math/big/nat.go.html#2899091">m</a></span>&nbsp;<span class="op" id="2899111">-</span>&nbsp;<span class="builtintype" id="2899113">int</span><span class="op" id="2899116">(</span><span class="ident" id="2899117"><a href="/math/big/nat.go.html#2899076">s</a></span><span class="op" id="2899118">/</span><span class="ident" id="2899119"><a href="/math/big/arith.go.html#2842878">_W</a></span><span class="op" id="2899121">)</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899124">if</span>&nbsp;<span class="ident" id="2899127"><a href="/math/big/nat.go.html#2899104">n</a></span>&nbsp;<span class="op" id="2899129">&lt;=</span>&nbsp;<span class="num" id="2899132">0</span>&nbsp;<span class="op" id="2899134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899138">return</span>&nbsp;<span class="ident" id="2899145"><a href="/math/big/nat.go.html#2899058">z</a></span><span class="op" id="2899146">.</span><span class="builtinfunc" id="2899147">make</span><span class="op" id="2899151">(</span><span class="num" id="2899152">0</span><span class="op" id="2899153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2899159">//&nbsp;n&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899170"><a href="/math/big/nat.go.html#2899058">z</a></span>&nbsp;<span class="op" id="2899172">=</span>&nbsp;<span class="ident" id="2899174"><a href="/math/big/nat.go.html#2899058">z</a></span><span class="op" id="2899175">.</span><span class="builtinfunc" id="2899176">make</span><span class="op" id="2899180">(</span><span class="ident" id="2899181"><a href="/math/big/nat.go.html#2899104">n</a></span><span class="op" id="2899182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899185"><a href="/math/big/arith_decl.go.html#2847088">shrVU</a></span><span class="op" id="2899190">(</span><span class="ident" id="2899191"><a href="/math/big/nat.go.html#2899058">z</a></span><span class="op" id="2899192">,</span>&nbsp;<span class="ident" id="2899194"><a href="/math/big/nat.go.html#2899069">x</a></span><span class="op" id="2899195">[</span><span class="ident" id="2899196"><a href="/math/big/nat.go.html#2899091">m</a></span><span class="op" id="2899197">-</span><span class="ident" id="2899198"><a href="/math/big/nat.go.html#2899104">n</a></span><span class="op" id="2899199">:</span><span class="op" id="2899200">]</span><span class="op" id="2899201">,</span>&nbsp;<span class="ident" id="2899203"><a href="/math/big/nat.go.html#2899076">s</a></span><span class="op" id="2899204">%</span><span class="ident" id="2899205"><a href="/math/big/arith.go.html#2842878">_W</a></span><span class="op" id="2899207">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899211">return</span>&nbsp;<span class="ident" id="2899218"><a href="/math/big/nat.go.html#2899058">z</a></span><span class="op" id="2899219">.</span><span class="ident" id="2899220">norm</span><span class="op" id="2899224">(</span><span class="op" id="2899225">)</span><br>
<span class="lineno"></span><span class="op" id="2899227">}</span><br>
<span class="lineno">1070</span><br>
<span class="lineno"></span><span class="keyword" id="2899230">func</span>&nbsp;<span class="op" id="2899235">(</span><span class="ident" id="2899236">z</span>&nbsp;<span class="ident" id="2899238"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2899241">)</span>&nbsp;<span class="ident" id="2899243">setBit</span><span class="op" id="2899249">(</span><span class="ident" id="2899250">x</span>&nbsp;<span class="ident" id="2899252"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2899255">,</span>&nbsp;<span class="ident" id="2899257">i</span>&nbsp;<span class="builtintype" id="2899259">uint</span><span class="op" id="2899263">,</span>&nbsp;<span class="ident" id="2899265">b</span>&nbsp;<span class="builtintype" id="2899267">uint</span><span class="op" id="2899271">)</span>&nbsp;<span class="ident" id="2899273"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2899277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899280">j</span>&nbsp;<span class="op" id="2899282">:=</span>&nbsp;<span class="builtintype" id="2899285">int</span><span class="op" id="2899288">(</span><span class="ident" id="2899289"><a href="/math/big/nat.go.html#2899257">i</a></span>&nbsp;<span class="op" id="2899291">/</span>&nbsp;<span class="ident" id="2899293"><a href="/math/big/arith.go.html#2842878">_W</a></span><span class="op" id="2899295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899298">m</span>&nbsp;<span class="op" id="2899300">:=</span>&nbsp;<span class="ident" id="2899303"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2899307">(</span><span class="num" id="2899308">1</span><span class="op" id="2899309">)</span>&nbsp;<span class="op" id="2899311">&lt;&lt;</span>&nbsp;<span class="op" id="2899314">(</span><span class="ident" id="2899315"><a href="/math/big/nat.go.html#2899257">i</a></span>&nbsp;<span class="op" id="2899317">%</span>&nbsp;<span class="ident" id="2899319"><a href="/math/big/arith.go.html#2842878">_W</a></span><span class="op" id="2899321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899324">n</span>&nbsp;<span class="op" id="2899326">:=</span>&nbsp;<span class="builtinfunc" id="2899329">len</span><span class="op" id="2899332">(</span><span class="ident" id="2899333"><a href="/math/big/nat.go.html#2899250">x</a></span><span class="op" id="2899334">)</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899337">switch</span>&nbsp;<span class="ident" id="2899344"><a href="/math/big/nat.go.html#2899265">b</a></span>&nbsp;<span class="op" id="2899346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899349">case</span>&nbsp;<span class="num" id="2899354">0</span><span class="op" id="2899355">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899359"><a href="/math/big/nat.go.html#2899236">z</a></span>&nbsp;<span class="op" id="2899361">=</span>&nbsp;<span class="ident" id="2899363"><a href="/math/big/nat.go.html#2899236">z</a></span><span class="op" id="2899364">.</span><span class="builtinfunc" id="2899365">make</span><span class="op" id="2899369">(</span><span class="ident" id="2899370"><a href="/math/big/nat.go.html#2899324">n</a></span><span class="op" id="2899371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2899375">copy</span><span class="op" id="2899379">(</span><span class="ident" id="2899380"><a href="/math/big/nat.go.html#2899236">z</a></span><span class="op" id="2899381">,</span>&nbsp;<span class="ident" id="2899383"><a href="/math/big/nat.go.html#2899250">x</a></span><span class="op" id="2899384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899388">if</span>&nbsp;<span class="ident" id="2899391"><a href="/math/big/nat.go.html#2899280">j</a></span>&nbsp;<span class="op" id="2899393">&gt;=</span>&nbsp;<span class="ident" id="2899396"><a href="/math/big/nat.go.html#2899324">n</a></span>&nbsp;<span class="op" id="2899398">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2899403">//&nbsp;no&nbsp;need&nbsp;to&nbsp;grow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899425">return</span>&nbsp;<span class="ident" id="2899432"><a href="/math/big/nat.go.html#2899236">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899440"><a href="/math/big/nat.go.html#2899236">z</a></span><span class="op" id="2899441">[</span><span class="ident" id="2899442"><a href="/math/big/nat.go.html#2899280">j</a></span><span class="op" id="2899443">]</span>&nbsp;<span class="op" id="2899445">&amp;^=</span>&nbsp;<span class="ident" id="2899449"><a href="/math/big/nat.go.html#2899298">m</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899453">return</span>&nbsp;<span class="ident" id="2899460"><a href="/math/big/nat.go.html#2899236">z</a></span><span class="op" id="2899461">.</span><span class="ident" id="2899462">norm</span><span class="op" id="2899466">(</span><span class="op" id="2899467">)</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899470">case</span>&nbsp;<span class="num" id="2899475">1</span><span class="op" id="2899476">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899480">if</span>&nbsp;<span class="ident" id="2899483"><a href="/math/big/nat.go.html#2899280">j</a></span>&nbsp;<span class="op" id="2899485">&gt;=</span>&nbsp;<span class="ident" id="2899488"><a href="/math/big/nat.go.html#2899324">n</a></span>&nbsp;<span class="op" id="2899490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899495"><a href="/math/big/nat.go.html#2899236">z</a></span>&nbsp;<span class="op" id="2899497">=</span>&nbsp;<span class="ident" id="2899499"><a href="/math/big/nat.go.html#2899236">z</a></span><span class="op" id="2899500">.</span><span class="builtinfunc" id="2899501">make</span><span class="op" id="2899505">(</span><span class="ident" id="2899506"><a href="/math/big/nat.go.html#2899280">j</a></span>&nbsp;<span class="op" id="2899508">+</span>&nbsp;<span class="num" id="2899510">1</span><span class="op" id="2899511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899516"><a href="/math/big/nat.go.html#2899236">z</a></span><span class="op" id="2899517">[</span><span class="ident" id="2899518"><a href="/math/big/nat.go.html#2899324">n</a></span><span class="op" id="2899519">:</span><span class="op" id="2899520">]</span><span class="op" id="2899521">.</span><span class="ident" id="2899522">clear</span><span class="op" id="2899527">(</span><span class="op" id="2899528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899532">}</span>&nbsp;<span class="keyword" id="2899534">else</span>&nbsp;<span class="op" id="2899539">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899544"><a href="/math/big/nat.go.html#2899236">z</a></span>&nbsp;<span class="op" id="2899546">=</span>&nbsp;<span class="ident" id="2899548"><a href="/math/big/nat.go.html#2899236">z</a></span><span class="op" id="2899549">.</span><span class="builtinfunc" id="2899550">make</span><span class="op" id="2899554">(</span><span class="ident" id="2899555"><a href="/math/big/nat.go.html#2899324">n</a></span><span class="op" id="2899556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2899564">copy</span><span class="op" id="2899568">(</span><span class="ident" id="2899569"><a href="/math/big/nat.go.html#2899236">z</a></span><span class="op" id="2899570">,</span>&nbsp;<span class="ident" id="2899572"><a href="/math/big/nat.go.html#2899250">x</a></span><span class="op" id="2899573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899577"><a href="/math/big/nat.go.html#2899236">z</a></span><span class="op" id="2899578">[</span><span class="ident" id="2899579"><a href="/math/big/nat.go.html#2899280">j</a></span><span class="op" id="2899580">]</span>&nbsp;<span class="op" id="2899582">|=</span>&nbsp;<span class="ident" id="2899585"><a href="/math/big/nat.go.html#2899298">m</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2899589">//&nbsp;no&nbsp;need&nbsp;to&nbsp;normalize</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899615">return</span>&nbsp;<span class="ident" id="2899622"><a href="/math/big/nat.go.html#2899236">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2899628">panic</span><span class="op" id="2899633">(</span><span class="string" id="2899634">&#34;set&nbsp;bit&nbsp;is&nbsp;not&nbsp;0&nbsp;or&nbsp;1&#34;</span><span class="op" id="2899657">)</span><br>
<span class="lineno"></span><span class="op" id="2899659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1100</span><span class="keyword" id="2899662">func</span>&nbsp;<span class="op" id="2899667">(</span><span class="ident" id="2899668">z</span>&nbsp;<span class="ident" id="2899670"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2899673">)</span>&nbsp;<span class="ident" id="2899675">bit</span><span class="op" id="2899678">(</span><span class="ident" id="2899679">i</span>&nbsp;<span class="builtintype" id="2899681">uint</span><span class="op" id="2899685">)</span>&nbsp;<span class="builtintype" id="2899687">uint</span>&nbsp;<span class="op" id="2899692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899695">j</span>&nbsp;<span class="op" id="2899697">:=</span>&nbsp;<span class="builtintype" id="2899700">int</span><span class="op" id="2899703">(</span><span class="ident" id="2899704"><a href="/math/big/nat.go.html#2899679">i</a></span>&nbsp;<span class="op" id="2899706">/</span>&nbsp;<span class="ident" id="2899708"><a href="/math/big/arith.go.html#2842878">_W</a></span><span class="op" id="2899710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899713">if</span>&nbsp;<span class="ident" id="2899716"><a href="/math/big/nat.go.html#2899695">j</a></span>&nbsp;<span class="op" id="2899718">&gt;=</span>&nbsp;<span class="builtinfunc" id="2899721">len</span><span class="op" id="2899724">(</span><span class="ident" id="2899725"><a href="/math/big/nat.go.html#2899668">z</a></span><span class="op" id="2899726">)</span>&nbsp;<span class="op" id="2899728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899732">return</span>&nbsp;<span class="num" id="2899739">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899742">}</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899745">return</span>&nbsp;<span class="builtintype" id="2899752">uint</span><span class="op" id="2899756">(</span><span class="ident" id="2899757"><a href="/math/big/nat.go.html#2899668">z</a></span><span class="op" id="2899758">[</span><span class="ident" id="2899759"><a href="/math/big/nat.go.html#2899695">j</a></span><span class="op" id="2899760">]</span>&nbsp;<span class="op" id="2899762">&gt;&gt;</span>&nbsp;<span class="op" id="2899765">(</span><span class="ident" id="2899766"><a href="/math/big/nat.go.html#2899679">i</a></span>&nbsp;<span class="op" id="2899768">%</span>&nbsp;<span class="ident" id="2899770"><a href="/math/big/arith.go.html#2842878">_W</a></span><span class="op" id="2899772">)</span>&nbsp;<span class="op" id="2899774">&amp;</span>&nbsp;<span class="num" id="2899776">1</span><span class="op" id="2899777">)</span><br>
<span class="lineno"></span><span class="op" id="2899779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2899782">func</span>&nbsp;<span class="op" id="2899787">(</span><span class="ident" id="2899788">z</span>&nbsp;<span class="ident" id="2899790"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2899793">)</span>&nbsp;<span class="ident" id="2899795">and</span><span class="op" id="2899798">(</span><span class="ident" id="2899799">x</span><span class="op" id="2899800">,</span>&nbsp;<span class="ident" id="2899802">y</span>&nbsp;<span class="ident" id="2899804"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2899807">)</span>&nbsp;<span class="ident" id="2899809"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2899813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899816">m</span>&nbsp;<span class="op" id="2899818">:=</span>&nbsp;<span class="builtinfunc" id="2899821">len</span><span class="op" id="2899824">(</span><span class="ident" id="2899825"><a href="/math/big/nat.go.html#2899799">x</a></span><span class="op" id="2899826">)</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899829">n</span>&nbsp;<span class="op" id="2899831">:=</span>&nbsp;<span class="builtinfunc" id="2899834">len</span><span class="op" id="2899837">(</span><span class="ident" id="2899838"><a href="/math/big/nat.go.html#2899802">y</a></span><span class="op" id="2899839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899842">if</span>&nbsp;<span class="ident" id="2899845"><a href="/math/big/nat.go.html#2899816">m</a></span>&nbsp;<span class="op" id="2899847">&gt;</span>&nbsp;<span class="ident" id="2899849"><a href="/math/big/nat.go.html#2899829">n</a></span>&nbsp;<span class="op" id="2899851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899855"><a href="/math/big/nat.go.html#2899816">m</a></span>&nbsp;<span class="op" id="2899857">=</span>&nbsp;<span class="ident" id="2899859"><a href="/math/big/nat.go.html#2899829">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2899865">//&nbsp;m&nbsp;&lt;=&nbsp;n</span><br>
<span class="lineno">1115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899877"><a href="/math/big/nat.go.html#2899788">z</a></span>&nbsp;<span class="op" id="2899879">=</span>&nbsp;<span class="ident" id="2899881"><a href="/math/big/nat.go.html#2899788">z</a></span><span class="op" id="2899882">.</span><span class="builtinfunc" id="2899883">make</span><span class="op" id="2899887">(</span><span class="ident" id="2899888"><a href="/math/big/nat.go.html#2899816">m</a></span><span class="op" id="2899889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899892">for</span>&nbsp;<span class="ident" id="2899896">i</span>&nbsp;<span class="op" id="2899898">:=</span>&nbsp;<span class="num" id="2899901">0</span><span class="op" id="2899902">;</span>&nbsp;<span class="ident" id="2899904"><a href="/math/big/nat.go.html#2899896">i</a></span>&nbsp;<span class="op" id="2899906">&lt;</span>&nbsp;<span class="ident" id="2899908"><a href="/math/big/nat.go.html#2899816">m</a></span><span class="op" id="2899909">;</span>&nbsp;<span class="ident" id="2899911"><a href="/math/big/nat.go.html#2899896">i</a></span><span class="op" id="2899912">++</span>&nbsp;<span class="op" id="2899915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899919"><a href="/math/big/nat.go.html#2899788">z</a></span><span class="op" id="2899920">[</span><span class="ident" id="2899921"><a href="/math/big/nat.go.html#2899896">i</a></span><span class="op" id="2899922">]</span>&nbsp;<span class="op" id="2899924">=</span>&nbsp;<span class="ident" id="2899926"><a href="/math/big/nat.go.html#2899799">x</a></span><span class="op" id="2899927">[</span><span class="ident" id="2899928"><a href="/math/big/nat.go.html#2899896">i</a></span><span class="op" id="2899929">]</span>&nbsp;<span class="op" id="2899931">&amp;</span>&nbsp;<span class="ident" id="2899933"><a href="/math/big/nat.go.html#2899802">y</a></span><span class="op" id="2899934">[</span><span class="ident" id="2899935"><a href="/math/big/nat.go.html#2899896">i</a></span><span class="op" id="2899936">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899939">}</span><br>
<span class="lineno">1120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899943">return</span>&nbsp;<span class="ident" id="2899950"><a href="/math/big/nat.go.html#2899788">z</a></span><span class="op" id="2899951">.</span><span class="ident" id="2899952">norm</span><span class="op" id="2899956">(</span><span class="op" id="2899957">)</span><br>
<span class="lineno"></span><span class="op" id="2899959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2899962">func</span>&nbsp;<span class="op" id="2899967">(</span><span class="ident" id="2899968">z</span>&nbsp;<span class="ident" id="2899970"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2899973">)</span>&nbsp;<span class="ident" id="2899975">andNot</span><span class="op" id="2899981">(</span><span class="ident" id="2899982">x</span><span class="op" id="2899983">,</span>&nbsp;<span class="ident" id="2899985">y</span>&nbsp;<span class="ident" id="2899987"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2899990">)</span>&nbsp;<span class="ident" id="2899992"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2899996">{</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899999">m</span>&nbsp;<span class="op" id="2900001">:=</span>&nbsp;<span class="builtinfunc" id="2900004">len</span><span class="op" id="2900007">(</span><span class="ident" id="2900008"><a href="/math/big/nat.go.html#2899982">x</a></span><span class="op" id="2900009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900012">n</span>&nbsp;<span class="op" id="2900014">:=</span>&nbsp;<span class="builtinfunc" id="2900017">len</span><span class="op" id="2900020">(</span><span class="ident" id="2900021"><a href="/math/big/nat.go.html#2899985">y</a></span><span class="op" id="2900022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900025">if</span>&nbsp;<span class="ident" id="2900028"><a href="/math/big/nat.go.html#2900012">n</a></span>&nbsp;<span class="op" id="2900030">&gt;</span>&nbsp;<span class="ident" id="2900032"><a href="/math/big/nat.go.html#2899999">m</a></span>&nbsp;<span class="op" id="2900034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900038"><a href="/math/big/nat.go.html#2900012">n</a></span>&nbsp;<span class="op" id="2900040">=</span>&nbsp;<span class="ident" id="2900042"><a href="/math/big/nat.go.html#2899999">m</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2900045">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2900048">//&nbsp;m&nbsp;&gt;=&nbsp;n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900060"><a href="/math/big/nat.go.html#2899968">z</a></span>&nbsp;<span class="op" id="2900062">=</span>&nbsp;<span class="ident" id="2900064"><a href="/math/big/nat.go.html#2899968">z</a></span><span class="op" id="2900065">.</span><span class="builtinfunc" id="2900066">make</span><span class="op" id="2900070">(</span><span class="ident" id="2900071"><a href="/math/big/nat.go.html#2899999">m</a></span><span class="op" id="2900072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900075">for</span>&nbsp;<span class="ident" id="2900079">i</span>&nbsp;<span class="op" id="2900081">:=</span>&nbsp;<span class="num" id="2900084">0</span><span class="op" id="2900085">;</span>&nbsp;<span class="ident" id="2900087"><a href="/math/big/nat.go.html#2900079">i</a></span>&nbsp;<span class="op" id="2900089">&lt;</span>&nbsp;<span class="ident" id="2900091"><a href="/math/big/nat.go.html#2900012">n</a></span><span class="op" id="2900092">;</span>&nbsp;<span class="ident" id="2900094"><a href="/math/big/nat.go.html#2900079">i</a></span><span class="op" id="2900095">++</span>&nbsp;<span class="op" id="2900098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900102"><a href="/math/big/nat.go.html#2899968">z</a></span><span class="op" id="2900103">[</span><span class="ident" id="2900104"><a href="/math/big/nat.go.html#2900079">i</a></span><span class="op" id="2900105">]</span>&nbsp;<span class="op" id="2900107">=</span>&nbsp;<span class="ident" id="2900109"><a href="/math/big/nat.go.html#2899982">x</a></span><span class="op" id="2900110">[</span><span class="ident" id="2900111"><a href="/math/big/nat.go.html#2900079">i</a></span><span class="op" id="2900112">]</span>&nbsp;<span class="op" id="2900114">&amp;^</span>&nbsp;<span class="ident" id="2900117"><a href="/math/big/nat.go.html#2899985">y</a></span><span class="op" id="2900118">[</span><span class="ident" id="2900119"><a href="/math/big/nat.go.html#2900079">i</a></span><span class="op" id="2900120">]</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2900123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2900126">copy</span><span class="op" id="2900130">(</span><span class="ident" id="2900131"><a href="/math/big/nat.go.html#2899968">z</a></span><span class="op" id="2900132">[</span><span class="ident" id="2900133"><a href="/math/big/nat.go.html#2900012">n</a></span><span class="op" id="2900134">:</span><span class="ident" id="2900135"><a href="/math/big/nat.go.html#2899999">m</a></span><span class="op" id="2900136">]</span><span class="op" id="2900137">,</span>&nbsp;<span class="ident" id="2900139"><a href="/math/big/nat.go.html#2899982">x</a></span><span class="op" id="2900140">[</span><span class="ident" id="2900141"><a href="/math/big/nat.go.html#2900012">n</a></span><span class="op" id="2900142">:</span><span class="ident" id="2900143"><a href="/math/big/nat.go.html#2899999">m</a></span><span class="op" id="2900144">]</span><span class="op" id="2900145">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900149">return</span>&nbsp;<span class="ident" id="2900156"><a href="/math/big/nat.go.html#2899968">z</a></span><span class="op" id="2900157">.</span><span class="ident" id="2900158">norm</span><span class="op" id="2900162">(</span><span class="op" id="2900163">)</span><br>
<span class="lineno"></span><span class="op" id="2900165">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span><span class="keyword" id="2900168">func</span>&nbsp;<span class="op" id="2900173">(</span><span class="ident" id="2900174">z</span>&nbsp;<span class="ident" id="2900176"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2900179">)</span>&nbsp;<span class="ident" id="2900181">or</span><span class="op" id="2900183">(</span><span class="ident" id="2900184">x</span><span class="op" id="2900185">,</span>&nbsp;<span class="ident" id="2900187">y</span>&nbsp;<span class="ident" id="2900189"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2900192">)</span>&nbsp;<span class="ident" id="2900194"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2900198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900201">m</span>&nbsp;<span class="op" id="2900203">:=</span>&nbsp;<span class="builtinfunc" id="2900206">len</span><span class="op" id="2900209">(</span><span class="ident" id="2900210"><a href="/math/big/nat.go.html#2900184">x</a></span><span class="op" id="2900211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900214">n</span>&nbsp;<span class="op" id="2900216">:=</span>&nbsp;<span class="builtinfunc" id="2900219">len</span><span class="op" id="2900222">(</span><span class="ident" id="2900223"><a href="/math/big/nat.go.html#2900187">y</a></span><span class="op" id="2900224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900227">s</span>&nbsp;<span class="op" id="2900229">:=</span>&nbsp;<span class="ident" id="2900232"><a href="/math/big/nat.go.html#2900184">x</a></span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900235">if</span>&nbsp;<span class="ident" id="2900238"><a href="/math/big/nat.go.html#2900201">m</a></span>&nbsp;<span class="op" id="2900240">&lt;</span>&nbsp;<span class="ident" id="2900242"><a href="/math/big/nat.go.html#2900214">n</a></span>&nbsp;<span class="op" id="2900244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900248"><a href="/math/big/nat.go.html#2900214">n</a></span><span class="op" id="2900249">,</span>&nbsp;<span class="ident" id="2900251"><a href="/math/big/nat.go.html#2900201">m</a></span>&nbsp;<span class="op" id="2900253">=</span>&nbsp;<span class="ident" id="2900255"><a href="/math/big/nat.go.html#2900201">m</a></span><span class="op" id="2900256">,</span>&nbsp;<span class="ident" id="2900258"><a href="/math/big/nat.go.html#2900214">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900262"><a href="/math/big/nat.go.html#2900227">s</a></span>&nbsp;<span class="op" id="2900264">=</span>&nbsp;<span class="ident" id="2900266"><a href="/math/big/nat.go.html#2900187">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2900269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2900272">//&nbsp;m&nbsp;&gt;=&nbsp;n</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900284"><a href="/math/big/nat.go.html#2900174">z</a></span>&nbsp;<span class="op" id="2900286">=</span>&nbsp;<span class="ident" id="2900288"><a href="/math/big/nat.go.html#2900174">z</a></span><span class="op" id="2900289">.</span><span class="builtinfunc" id="2900290">make</span><span class="op" id="2900294">(</span><span class="ident" id="2900295"><a href="/math/big/nat.go.html#2900201">m</a></span><span class="op" id="2900296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900299">for</span>&nbsp;<span class="ident" id="2900303">i</span>&nbsp;<span class="op" id="2900305">:=</span>&nbsp;<span class="num" id="2900308">0</span><span class="op" id="2900309">;</span>&nbsp;<span class="ident" id="2900311"><a href="/math/big/nat.go.html#2900303">i</a></span>&nbsp;<span class="op" id="2900313">&lt;</span>&nbsp;<span class="ident" id="2900315"><a href="/math/big/nat.go.html#2900214">n</a></span><span class="op" id="2900316">;</span>&nbsp;<span class="ident" id="2900318"><a href="/math/big/nat.go.html#2900303">i</a></span><span class="op" id="2900319">++</span>&nbsp;<span class="op" id="2900322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900326"><a href="/math/big/nat.go.html#2900174">z</a></span><span class="op" id="2900327">[</span><span class="ident" id="2900328"><a href="/math/big/nat.go.html#2900303">i</a></span><span class="op" id="2900329">]</span>&nbsp;<span class="op" id="2900331">=</span>&nbsp;<span class="ident" id="2900333"><a href="/math/big/nat.go.html#2900184">x</a></span><span class="op" id="2900334">[</span><span class="ident" id="2900335"><a href="/math/big/nat.go.html#2900303">i</a></span><span class="op" id="2900336">]</span>&nbsp;<span class="op" id="2900338">|</span>&nbsp;<span class="ident" id="2900340"><a href="/math/big/nat.go.html#2900187">y</a></span><span class="op" id="2900341">[</span><span class="ident" id="2900342"><a href="/math/big/nat.go.html#2900303">i</a></span><span class="op" id="2900343">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2900346">}</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2900349">copy</span><span class="op" id="2900353">(</span><span class="ident" id="2900354"><a href="/math/big/nat.go.html#2900174">z</a></span><span class="op" id="2900355">[</span><span class="ident" id="2900356"><a href="/math/big/nat.go.html#2900214">n</a></span><span class="op" id="2900357">:</span><span class="ident" id="2900358"><a href="/math/big/nat.go.html#2900201">m</a></span><span class="op" id="2900359">]</span><span class="op" id="2900360">,</span>&nbsp;<span class="ident" id="2900362"><a href="/math/big/nat.go.html#2900227">s</a></span><span class="op" id="2900363">[</span><span class="ident" id="2900364"><a href="/math/big/nat.go.html#2900214">n</a></span><span class="op" id="2900365">:</span><span class="ident" id="2900366"><a href="/math/big/nat.go.html#2900201">m</a></span><span class="op" id="2900367">]</span><span class="op" id="2900368">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900372">return</span>&nbsp;<span class="ident" id="2900379"><a href="/math/big/nat.go.html#2900174">z</a></span><span class="op" id="2900380">.</span><span class="ident" id="2900381">norm</span><span class="op" id="2900385">(</span><span class="op" id="2900386">)</span><br>
<span class="lineno"></span><span class="op" id="2900388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1160</span><span class="keyword" id="2900391">func</span>&nbsp;<span class="op" id="2900396">(</span><span class="ident" id="2900397">z</span>&nbsp;<span class="ident" id="2900399"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2900402">)</span>&nbsp;<span class="ident" id="2900404">xor</span><span class="op" id="2900407">(</span><span class="ident" id="2900408">x</span><span class="op" id="2900409">,</span>&nbsp;<span class="ident" id="2900411">y</span>&nbsp;<span class="ident" id="2900413"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2900416">)</span>&nbsp;<span class="ident" id="2900418"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2900422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900425">m</span>&nbsp;<span class="op" id="2900427">:=</span>&nbsp;<span class="builtinfunc" id="2900430">len</span><span class="op" id="2900433">(</span><span class="ident" id="2900434"><a href="/math/big/nat.go.html#2900408">x</a></span><span class="op" id="2900435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900438">n</span>&nbsp;<span class="op" id="2900440">:=</span>&nbsp;<span class="builtinfunc" id="2900443">len</span><span class="op" id="2900446">(</span><span class="ident" id="2900447"><a href="/math/big/nat.go.html#2900411">y</a></span><span class="op" id="2900448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900451">s</span>&nbsp;<span class="op" id="2900453">:=</span>&nbsp;<span class="ident" id="2900456"><a href="/math/big/nat.go.html#2900408">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900459">if</span>&nbsp;<span class="ident" id="2900462"><a href="/math/big/nat.go.html#2900425">m</a></span>&nbsp;<span class="op" id="2900464">&lt;</span>&nbsp;<span class="ident" id="2900466"><a href="/math/big/nat.go.html#2900438">n</a></span>&nbsp;<span class="op" id="2900468">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900472"><a href="/math/big/nat.go.html#2900438">n</a></span><span class="op" id="2900473">,</span>&nbsp;<span class="ident" id="2900475"><a href="/math/big/nat.go.html#2900425">m</a></span>&nbsp;<span class="op" id="2900477">=</span>&nbsp;<span class="ident" id="2900479"><a href="/math/big/nat.go.html#2900425">m</a></span><span class="op" id="2900480">,</span>&nbsp;<span class="ident" id="2900482"><a href="/math/big/nat.go.html#2900438">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900486"><a href="/math/big/nat.go.html#2900451">s</a></span>&nbsp;<span class="op" id="2900488">=</span>&nbsp;<span class="ident" id="2900490"><a href="/math/big/nat.go.html#2900411">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2900493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2900496">//&nbsp;m&nbsp;&gt;=&nbsp;n</span><br>
<span class="lineno"></span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900508"><a href="/math/big/nat.go.html#2900397">z</a></span>&nbsp;<span class="op" id="2900510">=</span>&nbsp;<span class="ident" id="2900512"><a href="/math/big/nat.go.html#2900397">z</a></span><span class="op" id="2900513">.</span><span class="builtinfunc" id="2900514">make</span><span class="op" id="2900518">(</span><span class="ident" id="2900519"><a href="/math/big/nat.go.html#2900425">m</a></span><span class="op" id="2900520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900523">for</span>&nbsp;<span class="ident" id="2900527">i</span>&nbsp;<span class="op" id="2900529">:=</span>&nbsp;<span class="num" id="2900532">0</span><span class="op" id="2900533">;</span>&nbsp;<span class="ident" id="2900535"><a href="/math/big/nat.go.html#2900527">i</a></span>&nbsp;<span class="op" id="2900537">&lt;</span>&nbsp;<span class="ident" id="2900539"><a href="/math/big/nat.go.html#2900438">n</a></span><span class="op" id="2900540">;</span>&nbsp;<span class="ident" id="2900542"><a href="/math/big/nat.go.html#2900527">i</a></span><span class="op" id="2900543">++</span>&nbsp;<span class="op" id="2900546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900550"><a href="/math/big/nat.go.html#2900397">z</a></span><span class="op" id="2900551">[</span><span class="ident" id="2900552"><a href="/math/big/nat.go.html#2900527">i</a></span><span class="op" id="2900553">]</span>&nbsp;<span class="op" id="2900555">=</span>&nbsp;<span class="ident" id="2900557"><a href="/math/big/nat.go.html#2900408">x</a></span><span class="op" id="2900558">[</span><span class="ident" id="2900559"><a href="/math/big/nat.go.html#2900527">i</a></span><span class="op" id="2900560">]</span>&nbsp;<span class="op" id="2900562">^</span>&nbsp;<span class="ident" id="2900564"><a href="/math/big/nat.go.html#2900411">y</a></span><span class="op" id="2900565">[</span><span class="ident" id="2900566"><a href="/math/big/nat.go.html#2900527">i</a></span><span class="op" id="2900567">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2900570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2900573">copy</span><span class="op" id="2900577">(</span><span class="ident" id="2900578"><a href="/math/big/nat.go.html#2900397">z</a></span><span class="op" id="2900579">[</span><span class="ident" id="2900580"><a href="/math/big/nat.go.html#2900438">n</a></span><span class="op" id="2900581">:</span><span class="ident" id="2900582"><a href="/math/big/nat.go.html#2900425">m</a></span><span class="op" id="2900583">]</span><span class="op" id="2900584">,</span>&nbsp;<span class="ident" id="2900586"><a href="/math/big/nat.go.html#2900451">s</a></span><span class="op" id="2900587">[</span><span class="ident" id="2900588"><a href="/math/big/nat.go.html#2900438">n</a></span><span class="op" id="2900589">:</span><span class="ident" id="2900590"><a href="/math/big/nat.go.html#2900425">m</a></span><span class="op" id="2900591">]</span><span class="op" id="2900592">)</span><br>
<span class="lineno">1175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900596">return</span>&nbsp;<span class="ident" id="2900603"><a href="/math/big/nat.go.html#2900397">z</a></span><span class="op" id="2900604">.</span><span class="ident" id="2900605">norm</span><span class="op" id="2900609">(</span><span class="op" id="2900610">)</span><br>
<span class="lineno"></span><span class="op" id="2900612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2900615">//&nbsp;greaterThan&nbsp;returns&nbsp;true&nbsp;iff&nbsp;(x1&lt;&lt;_W&nbsp;+&nbsp;x2)&nbsp;&gt;&nbsp;(y1&lt;&lt;_W&nbsp;+&nbsp;y2)</span><br>
<span class="lineno">1180</span><span class="keyword" id="2900677">func</span>&nbsp;<span class="ident" id="2900682">greaterThan</span><span class="op" id="2900693">(</span><span class="ident" id="2900694">x1</span><span class="op" id="2900696">,</span>&nbsp;<span class="ident" id="2900698">x2</span><span class="op" id="2900700">,</span>&nbsp;<span class="ident" id="2900702">y1</span><span class="op" id="2900704">,</span>&nbsp;<span class="ident" id="2900706">y2</span>&nbsp;<span class="ident" id="2900709"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2900713">)</span>&nbsp;<span class="builtintype" id="2900715">bool</span>&nbsp;<span class="op" id="2900720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900723">return</span>&nbsp;<span class="ident" id="2900730"><a href="/math/big/nat.go.html#2900694">x1</a></span>&nbsp;<span class="op" id="2900733">&gt;</span>&nbsp;<span class="ident" id="2900735"><a href="/math/big/nat.go.html#2900702">y1</a></span>&nbsp;<span class="op" id="2900738">||</span>&nbsp;<span class="ident" id="2900741"><a href="/math/big/nat.go.html#2900694">x1</a></span>&nbsp;<span class="op" id="2900744">==</span>&nbsp;<span class="ident" id="2900747"><a href="/math/big/nat.go.html#2900702">y1</a></span>&nbsp;<span class="op" id="2900750">&amp;&amp;</span>&nbsp;<span class="ident" id="2900753"><a href="/math/big/nat.go.html#2900698">x2</a></span>&nbsp;<span class="op" id="2900756">&gt;</span>&nbsp;<span class="ident" id="2900758"><a href="/math/big/nat.go.html#2900706">y2</a></span><br>
<span class="lineno"></span><span class="op" id="2900761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2900764">//&nbsp;modW&nbsp;returns&nbsp;x&nbsp;%&nbsp;d.</span><br>
<span class="lineno">1185</span><span class="keyword" id="2900787">func</span>&nbsp;<span class="op" id="2900792">(</span><span class="ident" id="2900793">x</span>&nbsp;<span class="ident" id="2900795"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2900798">)</span>&nbsp;<span class="ident" id="2900800">modW</span><span class="op" id="2900804">(</span><span class="ident" id="2900805">d</span>&nbsp;<span class="ident" id="2900807"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2900811">)</span>&nbsp;<span class="op" id="2900813">(</span><span class="ident" id="2900814">r</span>&nbsp;<span class="ident" id="2900816"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2900820">)</span>&nbsp;<span class="op" id="2900822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2900825">//&nbsp;TODO(agl):&nbsp;we&nbsp;don&#39;t&nbsp;actually&nbsp;need&nbsp;to&nbsp;store&nbsp;the&nbsp;q&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900885">var</span>&nbsp;<span class="ident" id="2900889">q</span>&nbsp;<span class="ident" id="2900891"><a href="/math/big/nat.go.html#2873877">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2900896"><a href="/math/big/nat.go.html#2900889">q</a></span>&nbsp;<span class="op" id="2900898">=</span>&nbsp;<span class="ident" id="2900900"><a href="/math/big/nat.go.html#2900889">q</a></span><span class="op" id="2900901">.</span><span class="builtinfunc" id="2900902">make</span><span class="op" id="2900906">(</span><span class="builtinfunc" id="2900907">len</span><span class="op" id="2900910">(</span><span class="ident" id="2900911"><a href="/math/big/nat.go.html#2900793">x</a></span><span class="op" id="2900912">)</span><span class="op" id="2900913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900916">return</span>&nbsp;<span class="ident" id="2900923"><a href="/math/big/arith_decl.go.html#2847222">divWVW</a></span><span class="op" id="2900929">(</span><span class="ident" id="2900930"><a href="/math/big/nat.go.html#2900889">q</a></span><span class="op" id="2900931">,</span>&nbsp;<span class="num" id="2900933">0</span><span class="op" id="2900934">,</span>&nbsp;<span class="ident" id="2900936"><a href="/math/big/nat.go.html#2900793">x</a></span><span class="op" id="2900937">,</span>&nbsp;<span class="ident" id="2900939"><a href="/math/big/nat.go.html#2900805">d</a></span><span class="op" id="2900940">)</span><br>
<span class="lineno">1190</span><span class="op" id="2900942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2900945">//&nbsp;random&nbsp;creates&nbsp;a&nbsp;random&nbsp;integer&nbsp;in&nbsp;[0..limit),&nbsp;using&nbsp;the&nbsp;space&nbsp;in&nbsp;z&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2901019">//&nbsp;possible.&nbsp;n&nbsp;is&nbsp;the&nbsp;bit&nbsp;length&nbsp;of&nbsp;limit.</span><br>
<span class="lineno"></span><span class="keyword" id="2901062">func</span>&nbsp;<span class="op" id="2901067">(</span><span class="ident" id="2901068">z</span>&nbsp;<span class="ident" id="2901070"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2901073">)</span>&nbsp;<span class="ident" id="2901075">random</span><span class="op" id="2901081">(</span><span class="ident" id="2901082">rand</span>&nbsp;<span class="op" id="2901087">*</span><span class="ident" id="2901088"><a href="/math/big/nat.go.html#2873341">rand</a></span><span class="op" id="2901092">.</span><span class="ident" id="2901093">Rand</span><span class="op" id="2901097">,</span>&nbsp;<span class="ident" id="2901099">limit</span>&nbsp;<span class="ident" id="2901105"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2901108">,</span>&nbsp;<span class="ident" id="2901110">n</span>&nbsp;<span class="builtintype" id="2901112">int</span><span class="op" id="2901115">)</span>&nbsp;<span class="ident" id="2901117"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2901121">{</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901124">if</span>&nbsp;<span class="ident" id="2901127"><a href="/math/big/nat.go.html#2879855">alias</a></span><span class="op" id="2901132">(</span><span class="ident" id="2901133"><a href="/math/big/nat.go.html#2901068">z</a></span><span class="op" id="2901134">,</span>&nbsp;<span class="ident" id="2901136"><a href="/math/big/nat.go.html#2901099">limit</a></span><span class="op" id="2901141">)</span>&nbsp;<span class="op" id="2901143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2901147"><a href="/math/big/nat.go.html#2901068">z</a></span>&nbsp;<span class="op" id="2901149">=</span>&nbsp;<span class="ident" id="2901151">nil</span>&nbsp;<span class="comment" id="2901155">//&nbsp;z&nbsp;is&nbsp;an&nbsp;alias&nbsp;for&nbsp;limit&nbsp;-&nbsp;cannot&nbsp;reuse</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2901198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2901201"><a href="/math/big/nat.go.html#2901068">z</a></span>&nbsp;<span class="op" id="2901203">=</span>&nbsp;<span class="ident" id="2901205"><a href="/math/big/nat.go.html#2901068">z</a></span><span class="op" id="2901206">.</span><span class="builtinfunc" id="2901207">make</span><span class="op" id="2901211">(</span><span class="builtinfunc" id="2901212">len</span><span class="op" id="2901215">(</span><span class="ident" id="2901216"><a href="/math/big/nat.go.html#2901099">limit</a></span><span class="op" id="2901221">)</span><span class="op" id="2901222">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2901226">bitLengthOfMSW</span>&nbsp;<span class="op" id="2901241">:=</span>&nbsp;<span class="builtintype" id="2901244">uint</span><span class="op" id="2901248">(</span><span class="ident" id="2901249"><a href="/math/big/nat.go.html#2901110">n</a></span>&nbsp;<span class="op" id="2901251">%</span>&nbsp;<span class="ident" id="2901253"><a href="/math/big/arith.go.html#2842878">_W</a></span><span class="op" id="2901255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901258">if</span>&nbsp;<span class="ident" id="2901261"><a href="/math/big/nat.go.html#2901226">bitLengthOfMSW</a></span>&nbsp;<span class="op" id="2901276">==</span>&nbsp;<span class="num" id="2901279">0</span>&nbsp;<span class="op" id="2901281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2901285"><a href="/math/big/nat.go.html#2901226">bitLengthOfMSW</a></span>&nbsp;<span class="op" id="2901300">=</span>&nbsp;<span class="ident" id="2901302"><a href="/math/big/arith.go.html#2842878">_W</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2901306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2901309">mask</span>&nbsp;<span class="op" id="2901314">:=</span>&nbsp;<span class="ident" id="2901317"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2901321">(</span><span class="op" id="2901322">(</span><span class="num" id="2901323">1</span>&nbsp;<span class="op" id="2901325">&lt;&lt;</span>&nbsp;<span class="ident" id="2901328"><a href="/math/big/nat.go.html#2901226">bitLengthOfMSW</a></span><span class="op" id="2901342">)</span>&nbsp;<span class="op" id="2901344">-</span>&nbsp;<span class="num" id="2901346">1</span><span class="op" id="2901347">)</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901351">for</span>&nbsp;<span class="op" id="2901355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901359">switch</span>&nbsp;<span class="ident" id="2901366"><a href="/math/big/arith.go.html#2842878">_W</a></span>&nbsp;<span class="op" id="2901369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901373">case</span>&nbsp;<span class="num" id="2901378">32</span><span class="op" id="2901380">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901385">for</span>&nbsp;<span class="ident" id="2901389">i</span>&nbsp;<span class="op" id="2901391">:=</span>&nbsp;<span class="keyword" id="2901394">range</span>&nbsp;<span class="ident" id="2901400"><a href="/math/big/nat.go.html#2901068">z</a></span>&nbsp;<span class="op" id="2901402">{</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2901408"><a href="/math/big/nat.go.html#2901068">z</a></span><span class="op" id="2901409">[</span><span class="ident" id="2901410"><a href="/math/big/nat.go.html#2901389">i</a></span><span class="op" id="2901411">]</span>&nbsp;<span class="op" id="2901413">=</span>&nbsp;<span class="ident" id="2901415"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2901419">(</span><span class="ident" id="2901420"><a href="/math/big/nat.go.html#2901082">rand</a></span><span class="op" id="2901424">.</span><span class="ident" id="2901425">Uint32</span><span class="op" id="2901431">(</span><span class="op" id="2901432">)</span><span class="op" id="2901433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2901438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901442">case</span>&nbsp;<span class="num" id="2901447">64</span><span class="op" id="2901449">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901454">for</span>&nbsp;<span class="ident" id="2901458">i</span>&nbsp;<span class="op" id="2901460">:=</span>&nbsp;<span class="keyword" id="2901463">range</span>&nbsp;<span class="ident" id="2901469"><a href="/math/big/nat.go.html#2901068">z</a></span>&nbsp;<span class="op" id="2901471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2901477"><a href="/math/big/nat.go.html#2901068">z</a></span><span class="op" id="2901478">[</span><span class="ident" id="2901479"><a href="/math/big/nat.go.html#2901458">i</a></span><span class="op" id="2901480">]</span>&nbsp;<span class="op" id="2901482">=</span>&nbsp;<span class="ident" id="2901484"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2901488">(</span><span class="ident" id="2901489"><a href="/math/big/nat.go.html#2901082">rand</a></span><span class="op" id="2901493">.</span><span class="ident" id="2901494">Uint32</span><span class="op" id="2901500">(</span><span class="op" id="2901501">)</span><span class="op" id="2901502">)</span>&nbsp;<span class="op" id="2901504">|</span>&nbsp;<span class="ident" id="2901506"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2901510">(</span><span class="ident" id="2901511"><a href="/math/big/nat.go.html#2901082">rand</a></span><span class="op" id="2901515">.</span><span class="ident" id="2901516">Uint32</span><span class="op" id="2901522">(</span><span class="op" id="2901523">)</span><span class="op" id="2901524">)</span><span class="op" id="2901525">&lt;&lt;</span><span class="num" id="2901527">32</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2901533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901537">default</span><span class="op" id="2901544">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2901549">panic</span><span class="op" id="2901554">(</span><span class="string" id="2901555">&#34;unknown&nbsp;word&nbsp;size&#34;</span><span class="op" id="2901574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2901578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2901582"><a href="/math/big/nat.go.html#2901068">z</a></span><span class="op" id="2901583">[</span><span class="builtinfunc" id="2901584">len</span><span class="op" id="2901587">(</span><span class="ident" id="2901588"><a href="/math/big/nat.go.html#2901099">limit</a></span><span class="op" id="2901593">)</span><span class="op" id="2901594">-</span><span class="num" id="2901595">1</span><span class="op" id="2901596">]</span>&nbsp;<span class="op" id="2901598">&amp;=</span>&nbsp;<span class="ident" id="2901601"><a href="/math/big/nat.go.html#2901309">mask</a></span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901608">if</span>&nbsp;<span class="ident" id="2901611"><a href="/math/big/nat.go.html#2901068">z</a></span><span class="op" id="2901612">.</span><span class="ident" id="2901613">cmp</span><span class="op" id="2901616">(</span><span class="ident" id="2901617"><a href="/math/big/nat.go.html#2901099">limit</a></span><span class="op" id="2901622">)</span>&nbsp;<span class="op" id="2901624">&lt;</span>&nbsp;<span class="num" id="2901626">0</span>&nbsp;<span class="op" id="2901628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901633">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2901641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2901644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901648">return</span>&nbsp;<span class="ident" id="2901655"><a href="/math/big/nat.go.html#2901068">z</a></span><span class="op" id="2901656">.</span><span class="ident" id="2901657">norm</span><span class="op" id="2901661">(</span><span class="op" id="2901662">)</span><br>
<span class="lineno"></span><span class="op" id="2901664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2901667">//&nbsp;If&nbsp;m&nbsp;!=&nbsp;0&nbsp;(i.e.,&nbsp;len(m)&nbsp;!=&nbsp;0),&nbsp;expNN&nbsp;sets&nbsp;z&nbsp;to&nbsp;x**y&nbsp;mod&nbsp;m;</span><br>
<span class="lineno"></span><span class="comment" id="2901729">//&nbsp;otherwise&nbsp;it&nbsp;sets&nbsp;z&nbsp;to&nbsp;x**y.&nbsp;The&nbsp;result&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;z.</span><br>
<span class="lineno">1230</span><span class="keyword" id="2901791">func</span>&nbsp;<span class="op" id="2901796">(</span><span class="ident" id="2901797">z</span>&nbsp;<span class="ident" id="2901799"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2901802">)</span>&nbsp;<span class="ident" id="2901804">expNN</span><span class="op" id="2901809">(</span><span class="ident" id="2901810">x</span><span class="op" id="2901811">,</span>&nbsp;<span class="ident" id="2901813">y</span><span class="op" id="2901814">,</span>&nbsp;<span class="ident" id="2901816">m</span>&nbsp;<span class="ident" id="2901818"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2901821">)</span>&nbsp;<span class="ident" id="2901823"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2901827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901830">if</span>&nbsp;<span class="ident" id="2901833"><a href="/math/big/nat.go.html#2879855">alias</a></span><span class="op" id="2901838">(</span><span class="ident" id="2901839"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2901840">,</span>&nbsp;<span class="ident" id="2901842"><a href="/math/big/nat.go.html#2901810">x</a></span><span class="op" id="2901843">)</span>&nbsp;<span class="op" id="2901845">||</span>&nbsp;<span class="ident" id="2901848"><a href="/math/big/nat.go.html#2879855">alias</a></span><span class="op" id="2901853">(</span><span class="ident" id="2901854"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2901855">,</span>&nbsp;<span class="ident" id="2901857"><a href="/math/big/nat.go.html#2901813">y</a></span><span class="op" id="2901858">)</span>&nbsp;<span class="op" id="2901860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2901864">//&nbsp;We&nbsp;cannot&nbsp;allow&nbsp;in-place&nbsp;modification&nbsp;of&nbsp;x&nbsp;or&nbsp;y.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2901918"><a href="/math/big/nat.go.html#2901797">z</a></span>&nbsp;<span class="op" id="2901920">=</span>&nbsp;<span class="ident" id="2901922">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2901927">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2901931">//&nbsp;x**y&nbsp;mod&nbsp;1&nbsp;==&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901951">if</span>&nbsp;<span class="builtinfunc" id="2901954">len</span><span class="op" id="2901957">(</span><span class="ident" id="2901958"><a href="/math/big/nat.go.html#2901816">m</a></span><span class="op" id="2901959">)</span>&nbsp;<span class="op" id="2901961">==</span>&nbsp;<span class="num" id="2901964">1</span>&nbsp;<span class="op" id="2901966">&amp;&amp;</span>&nbsp;<span class="ident" id="2901969"><a href="/math/big/nat.go.html#2901816">m</a></span><span class="op" id="2901970">[</span><span class="num" id="2901971">0</span><span class="op" id="2901972">]</span>&nbsp;<span class="op" id="2901974">==</span>&nbsp;<span class="num" id="2901977">1</span>&nbsp;<span class="op" id="2901979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2901983">return</span>&nbsp;<span class="ident" id="2901990"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2901991">.</span><span class="ident" id="2901992">setWord</span><span class="op" id="2901999">(</span><span class="num" id="2902000">0</span><span class="op" id="2902001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2902004">}</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2902007">//&nbsp;m&nbsp;==&nbsp;0&nbsp;||&nbsp;m&nbsp;&gt;&nbsp;1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2902028">//&nbsp;x**0&nbsp;==&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902042">if</span>&nbsp;<span class="builtinfunc" id="2902045">len</span><span class="op" id="2902048">(</span><span class="ident" id="2902049"><a href="/math/big/nat.go.html#2901813">y</a></span><span class="op" id="2902050">)</span>&nbsp;<span class="op" id="2902052">==</span>&nbsp;<span class="num" id="2902055">0</span>&nbsp;<span class="op" id="2902057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902061">return</span>&nbsp;<span class="ident" id="2902068"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2902069">.</span><span class="ident" id="2902070">setWord</span><span class="op" id="2902077">(</span><span class="num" id="2902078">1</span><span class="op" id="2902079">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2902082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2902085">//&nbsp;y&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902096">if</span>&nbsp;<span class="builtinfunc" id="2902099">len</span><span class="op" id="2902102">(</span><span class="ident" id="2902103"><a href="/math/big/nat.go.html#2901816">m</a></span><span class="op" id="2902104">)</span>&nbsp;<span class="op" id="2902106">!=</span>&nbsp;<span class="num" id="2902109">0</span>&nbsp;<span class="op" id="2902111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2902115">//&nbsp;We&nbsp;likely&nbsp;end&nbsp;up&nbsp;being&nbsp;as&nbsp;long&nbsp;as&nbsp;the&nbsp;modulus.</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2902167"><a href="/math/big/nat.go.html#2901797">z</a></span>&nbsp;<span class="op" id="2902169">=</span>&nbsp;<span class="ident" id="2902171"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2902172">.</span><span class="builtinfunc" id="2902173">make</span><span class="op" id="2902177">(</span><span class="builtinfunc" id="2902178">len</span><span class="op" id="2902181">(</span><span class="ident" id="2902182"><a href="/math/big/nat.go.html#2901816">m</a></span><span class="op" id="2902183">)</span><span class="op" id="2902184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2902187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2902190"><a href="/math/big/nat.go.html#2901797">z</a></span>&nbsp;<span class="op" id="2902192">=</span>&nbsp;<span class="ident" id="2902194"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2902195">.</span><span class="ident" id="2902196">set</span><span class="op" id="2902199">(</span><span class="ident" id="2902200"><a href="/math/big/nat.go.html#2901810">x</a></span><span class="op" id="2902201">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2902205">//&nbsp;If&nbsp;the&nbsp;base&nbsp;is&nbsp;non-trivial&nbsp;and&nbsp;the&nbsp;exponent&nbsp;is&nbsp;large,&nbsp;we&nbsp;use</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2902270">//&nbsp;4-bit,&nbsp;windowed&nbsp;exponentiation.&nbsp;This&nbsp;involves&nbsp;precomputing&nbsp;14&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2902343">//&nbsp;(x^2...x^15)&nbsp;but&nbsp;then&nbsp;reduces&nbsp;the&nbsp;number&nbsp;of&nbsp;multiply-reduces&nbsp;by&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2902413">//&nbsp;third.&nbsp;Even&nbsp;for&nbsp;a&nbsp;32-bit&nbsp;exponent,&nbsp;this&nbsp;reduces&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2902479">//&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902495">if</span>&nbsp;<span class="builtinfunc" id="2902498">len</span><span class="op" id="2902501">(</span><span class="ident" id="2902502"><a href="/math/big/nat.go.html#2901810">x</a></span><span class="op" id="2902503">)</span>&nbsp;<span class="op" id="2902505">&gt;</span>&nbsp;<span class="num" id="2902507">1</span>&nbsp;<span class="op" id="2902509">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2902512">len</span><span class="op" id="2902515">(</span><span class="ident" id="2902516"><a href="/math/big/nat.go.html#2901813">y</a></span><span class="op" id="2902517">)</span>&nbsp;<span class="op" id="2902519">&gt;</span>&nbsp;<span class="num" id="2902521">1</span>&nbsp;<span class="op" id="2902523">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2902526">len</span><span class="op" id="2902529">(</span><span class="ident" id="2902530"><a href="/math/big/nat.go.html#2901816">m</a></span><span class="op" id="2902531">)</span>&nbsp;<span class="op" id="2902533">&gt;</span>&nbsp;<span class="num" id="2902535">0</span>&nbsp;<span class="op" id="2902537">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902541">return</span>&nbsp;<span class="ident" id="2902548"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2902549">.</span><span class="ident" id="2902550">expNNWindowed</span><span class="op" id="2902563">(</span><span class="ident" id="2902564"><a href="/math/big/nat.go.html#2901810">x</a></span><span class="op" id="2902565">,</span>&nbsp;<span class="ident" id="2902567"><a href="/math/big/nat.go.html#2901813">y</a></span><span class="op" id="2902568">,</span>&nbsp;<span class="ident" id="2902570"><a href="/math/big/nat.go.html#2901816">m</a></span><span class="op" id="2902571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2902574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2902578">v</span>&nbsp;<span class="op" id="2902580">:=</span>&nbsp;<span class="ident" id="2902583"><a href="/math/big/nat.go.html#2901813">y</a></span><span class="op" id="2902584">[</span><span class="builtinfunc" id="2902585">len</span><span class="op" id="2902588">(</span><span class="ident" id="2902589"><a href="/math/big/nat.go.html#2901813">y</a></span><span class="op" id="2902590">)</span><span class="op" id="2902591">-</span><span class="num" id="2902592">1</span><span class="op" id="2902593">]</span>&nbsp;<span class="comment" id="2902595">//&nbsp;v&nbsp;&gt;&nbsp;0&nbsp;because&nbsp;y&nbsp;is&nbsp;normalized&nbsp;and&nbsp;y&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2902639">shift</span>&nbsp;<span class="op" id="2902645">:=</span>&nbsp;<span class="ident" id="2902648"><a href="/math/big/arith.go.html#2844506">leadingZeros</a></span><span class="op" id="2902660">(</span><span class="ident" id="2902661"><a href="/math/big/nat.go.html#2902578">v</a></span><span class="op" id="2902662">)</span>&nbsp;<span class="op" id="2902664">+</span>&nbsp;<span class="num" id="2902666">1</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2902669"><a href="/math/big/nat.go.html#2902578">v</a></span>&nbsp;<span class="op" id="2902671">&lt;&lt;=</span>&nbsp;<span class="ident" id="2902675"><a href="/math/big/nat.go.html#2902639">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902682">var</span>&nbsp;<span class="ident" id="2902686">q</span>&nbsp;<span class="ident" id="2902688"><a href="/math/big/nat.go.html#2873877">nat</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2902694">const</span>&nbsp;<span class="ident" id="2902700">mask</span>&nbsp;<span class="op" id="2902705">=</span>&nbsp;<span class="num" id="2902707">1</span>&nbsp;<span class="op" id="2902709">&lt;&lt;</span>&nbsp;<span class="op" id="2902712">(</span><span class="ident" id="2902713"><a href="/math/big/arith.go.html#2842878">_W</a></span>&nbsp;<span class="op" id="2902716">-</span>&nbsp;<span class="num" id="2902718">1</span><span class="op" id="2902719">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2902723">//&nbsp;We&nbsp;walk&nbsp;through&nbsp;the&nbsp;bits&nbsp;of&nbsp;the&nbsp;exponent&nbsp;one&nbsp;by&nbsp;one.&nbsp;Each&nbsp;time&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2902793">//&nbsp;see&nbsp;a&nbsp;bit,&nbsp;we&nbsp;square,&nbsp;thus&nbsp;doubling&nbsp;the&nbsp;power.&nbsp;If&nbsp;the&nbsp;bit&nbsp;is&nbsp;a&nbsp;one,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2902865">//&nbsp;we&nbsp;also&nbsp;multiply&nbsp;by&nbsp;x,&nbsp;thus&nbsp;adding&nbsp;one&nbsp;to&nbsp;the&nbsp;power.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2902923">w</span>&nbsp;<span class="op" id="2902925">:=</span>&nbsp;<span class="ident" id="2902928"><a href="/math/big/arith.go.html#2842878">_W</a></span>&nbsp;<span class="op" id="2902931">-</span>&nbsp;<span class="builtintype" id="2902933">int</span><span class="op" id="2902936">(</span><span class="ident" id="2902937"><a href="/math/big/nat.go.html#2902639">shift</a></span><span class="op" id="2902942">)</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2902945">//&nbsp;zz&nbsp;and&nbsp;r&nbsp;are&nbsp;used&nbsp;to&nbsp;avoid&nbsp;allocating&nbsp;in&nbsp;mul&nbsp;and&nbsp;div&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2903005">//&nbsp;otherwise&nbsp;the&nbsp;arguments&nbsp;would&nbsp;alias.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903046">var</span>&nbsp;<span class="ident" id="2903050">zz</span><span class="op" id="2903052">,</span>&nbsp;<span class="ident" id="2903054">r</span>&nbsp;<span class="ident" id="2903056"><a href="/math/big/nat.go.html#2873877">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903061">for</span>&nbsp;<span class="ident" id="2903065">j</span>&nbsp;<span class="op" id="2903067">:=</span>&nbsp;<span class="num" id="2903070">0</span><span class="op" id="2903071">;</span>&nbsp;<span class="ident" id="2903073"><a href="/math/big/nat.go.html#2903065">j</a></span>&nbsp;<span class="op" id="2903075">&lt;</span>&nbsp;<span class="ident" id="2903077"><a href="/math/big/nat.go.html#2902923">w</a></span><span class="op" id="2903078">;</span>&nbsp;<span class="ident" id="2903080"><a href="/math/big/nat.go.html#2903065">j</a></span><span class="op" id="2903081">++</span>&nbsp;<span class="op" id="2903084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903088"><a href="/math/big/nat.go.html#2903050">zz</a></span>&nbsp;<span class="op" id="2903091">=</span>&nbsp;<span class="ident" id="2903093"><a href="/math/big/nat.go.html#2903050">zz</a></span><span class="op" id="2903095">.</span><span class="ident" id="2903096">mul</span><span class="op" id="2903099">(</span><span class="ident" id="2903100"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2903101">,</span>&nbsp;<span class="ident" id="2903103"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2903104">)</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903108"><a href="/math/big/nat.go.html#2903050">zz</a></span><span class="op" id="2903110">,</span>&nbsp;<span class="ident" id="2903112"><a href="/math/big/nat.go.html#2901797">z</a></span>&nbsp;<span class="op" id="2903114">=</span>&nbsp;<span class="ident" id="2903116"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2903117">,</span>&nbsp;<span class="ident" id="2903119"><a href="/math/big/nat.go.html#2903050">zz</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903125">if</span>&nbsp;<span class="ident" id="2903128"><a href="/math/big/nat.go.html#2902578">v</a></span><span class="op" id="2903129">&amp;</span><span class="ident" id="2903130"><a href="/math/big/nat.go.html#2902700">mask</a></span>&nbsp;<span class="op" id="2903135">!=</span>&nbsp;<span class="num" id="2903138">0</span>&nbsp;<span class="op" id="2903140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903145"><a href="/math/big/nat.go.html#2903050">zz</a></span>&nbsp;<span class="op" id="2903148">=</span>&nbsp;<span class="ident" id="2903150"><a href="/math/big/nat.go.html#2903050">zz</a></span><span class="op" id="2903152">.</span><span class="ident" id="2903153">mul</span><span class="op" id="2903156">(</span><span class="ident" id="2903157"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2903158">,</span>&nbsp;<span class="ident" id="2903160"><a href="/math/big/nat.go.html#2901810">x</a></span><span class="op" id="2903161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903166"><a href="/math/big/nat.go.html#2903050">zz</a></span><span class="op" id="2903168">,</span>&nbsp;<span class="ident" id="2903170"><a href="/math/big/nat.go.html#2901797">z</a></span>&nbsp;<span class="op" id="2903172">=</span>&nbsp;<span class="ident" id="2903174"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2903175">,</span>&nbsp;<span class="ident" id="2903177"><a href="/math/big/nat.go.html#2903050">zz</a></span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2903182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903187">if</span>&nbsp;<span class="builtinfunc" id="2903190">len</span><span class="op" id="2903193">(</span><span class="ident" id="2903194"><a href="/math/big/nat.go.html#2901816">m</a></span><span class="op" id="2903195">)</span>&nbsp;<span class="op" id="2903197">!=</span>&nbsp;<span class="num" id="2903200">0</span>&nbsp;<span class="op" id="2903202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903207"><a href="/math/big/nat.go.html#2903050">zz</a></span><span class="op" id="2903209">,</span>&nbsp;<span class="ident" id="2903211"><a href="/math/big/nat.go.html#2903054">r</a></span>&nbsp;<span class="op" id="2903213">=</span>&nbsp;<span class="ident" id="2903215"><a href="/math/big/nat.go.html#2903050">zz</a></span><span class="op" id="2903217">.</span><span class="ident" id="2903218">div</span><span class="op" id="2903221">(</span><span class="ident" id="2903222"><a href="/math/big/nat.go.html#2903054">r</a></span><span class="op" id="2903223">,</span>&nbsp;<span class="ident" id="2903225"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2903226">,</span>&nbsp;<span class="ident" id="2903228"><a href="/math/big/nat.go.html#2901816">m</a></span><span class="op" id="2903229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903234"><a href="/math/big/nat.go.html#2903050">zz</a></span><span class="op" id="2903236">,</span>&nbsp;<span class="ident" id="2903238"><a href="/math/big/nat.go.html#2903054">r</a></span><span class="op" id="2903239">,</span>&nbsp;<span class="ident" id="2903241"><a href="/math/big/nat.go.html#2902686">q</a></span><span class="op" id="2903242">,</span>&nbsp;<span class="ident" id="2903244"><a href="/math/big/nat.go.html#2901797">z</a></span>&nbsp;<span class="op" id="2903246">=</span>&nbsp;<span class="ident" id="2903248"><a href="/math/big/nat.go.html#2902686">q</a></span><span class="op" id="2903249">,</span>&nbsp;<span class="ident" id="2903251"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2903252">,</span>&nbsp;<span class="ident" id="2903254"><a href="/math/big/nat.go.html#2903050">zz</a></span><span class="op" id="2903256">,</span>&nbsp;<span class="ident" id="2903258"><a href="/math/big/nat.go.html#2903054">r</a></span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2903262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903267"><a href="/math/big/nat.go.html#2902578">v</a></span>&nbsp;<span class="op" id="2903269">&lt;&lt;=</span>&nbsp;<span class="num" id="2903273">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2903276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903280">for</span>&nbsp;<span class="ident" id="2903284">i</span>&nbsp;<span class="op" id="2903286">:=</span>&nbsp;<span class="builtinfunc" id="2903289">len</span><span class="op" id="2903292">(</span><span class="ident" id="2903293"><a href="/math/big/nat.go.html#2901813">y</a></span><span class="op" id="2903294">)</span>&nbsp;<span class="op" id="2903296">-</span>&nbsp;<span class="num" id="2903298">2</span><span class="op" id="2903299">;</span>&nbsp;<span class="ident" id="2903301"><a href="/math/big/nat.go.html#2903284">i</a></span>&nbsp;<span class="op" id="2903303">&gt;=</span>&nbsp;<span class="num" id="2903306">0</span><span class="op" id="2903307">;</span>&nbsp;<span class="ident" id="2903309"><a href="/math/big/nat.go.html#2903284">i</a></span><span class="op" id="2903310">--</span>&nbsp;<span class="op" id="2903313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903317"><a href="/math/big/nat.go.html#2902578">v</a></span>&nbsp;<span class="op" id="2903319">=</span>&nbsp;<span class="ident" id="2903321"><a href="/math/big/nat.go.html#2901813">y</a></span><span class="op" id="2903322">[</span><span class="ident" id="2903323"><a href="/math/big/nat.go.html#2903284">i</a></span><span class="op" id="2903324">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903329">for</span>&nbsp;<span class="ident" id="2903333">j</span>&nbsp;<span class="op" id="2903335">:=</span>&nbsp;<span class="num" id="2903338">0</span><span class="op" id="2903339">;</span>&nbsp;<span class="ident" id="2903341"><a href="/math/big/nat.go.html#2903333">j</a></span>&nbsp;<span class="op" id="2903343">&lt;</span>&nbsp;<span class="ident" id="2903345"><a href="/math/big/arith.go.html#2842878">_W</a></span><span class="op" id="2903347">;</span>&nbsp;<span class="ident" id="2903349"><a href="/math/big/nat.go.html#2903333">j</a></span><span class="op" id="2903350">++</span>&nbsp;<span class="op" id="2903353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903358"><a href="/math/big/nat.go.html#2903050">zz</a></span>&nbsp;<span class="op" id="2903361">=</span>&nbsp;<span class="ident" id="2903363"><a href="/math/big/nat.go.html#2903050">zz</a></span><span class="op" id="2903365">.</span><span class="ident" id="2903366">mul</span><span class="op" id="2903369">(</span><span class="ident" id="2903370"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2903371">,</span>&nbsp;<span class="ident" id="2903373"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2903374">)</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903379"><a href="/math/big/nat.go.html#2903050">zz</a></span><span class="op" id="2903381">,</span>&nbsp;<span class="ident" id="2903383"><a href="/math/big/nat.go.html#2901797">z</a></span>&nbsp;<span class="op" id="2903385">=</span>&nbsp;<span class="ident" id="2903387"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2903388">,</span>&nbsp;<span class="ident" id="2903390"><a href="/math/big/nat.go.html#2903050">zz</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903397">if</span>&nbsp;<span class="ident" id="2903400"><a href="/math/big/nat.go.html#2902578">v</a></span><span class="op" id="2903401">&amp;</span><span class="ident" id="2903402"><a href="/math/big/nat.go.html#2902700">mask</a></span>&nbsp;<span class="op" id="2903407">!=</span>&nbsp;<span class="num" id="2903410">0</span>&nbsp;<span class="op" id="2903412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903418"><a href="/math/big/nat.go.html#2903050">zz</a></span>&nbsp;<span class="op" id="2903421">=</span>&nbsp;<span class="ident" id="2903423"><a href="/math/big/nat.go.html#2903050">zz</a></span><span class="op" id="2903425">.</span><span class="ident" id="2903426">mul</span><span class="op" id="2903429">(</span><span class="ident" id="2903430"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2903431">,</span>&nbsp;<span class="ident" id="2903433"><a href="/math/big/nat.go.html#2901810">x</a></span><span class="op" id="2903434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903440"><a href="/math/big/nat.go.html#2903050">zz</a></span><span class="op" id="2903442">,</span>&nbsp;<span class="ident" id="2903444"><a href="/math/big/nat.go.html#2901797">z</a></span>&nbsp;<span class="op" id="2903446">=</span>&nbsp;<span class="ident" id="2903448"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2903449">,</span>&nbsp;<span class="ident" id="2903451"><a href="/math/big/nat.go.html#2903050">zz</a></span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2903457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903463">if</span>&nbsp;<span class="builtinfunc" id="2903466">len</span><span class="op" id="2903469">(</span><span class="ident" id="2903470"><a href="/math/big/nat.go.html#2901816">m</a></span><span class="op" id="2903471">)</span>&nbsp;<span class="op" id="2903473">!=</span>&nbsp;<span class="num" id="2903476">0</span>&nbsp;<span class="op" id="2903478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903484"><a href="/math/big/nat.go.html#2903050">zz</a></span><span class="op" id="2903486">,</span>&nbsp;<span class="ident" id="2903488"><a href="/math/big/nat.go.html#2903054">r</a></span>&nbsp;<span class="op" id="2903490">=</span>&nbsp;<span class="ident" id="2903492"><a href="/math/big/nat.go.html#2903050">zz</a></span><span class="op" id="2903494">.</span><span class="ident" id="2903495">div</span><span class="op" id="2903498">(</span><span class="ident" id="2903499"><a href="/math/big/nat.go.html#2903054">r</a></span><span class="op" id="2903500">,</span>&nbsp;<span class="ident" id="2903502"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2903503">,</span>&nbsp;<span class="ident" id="2903505"><a href="/math/big/nat.go.html#2901816">m</a></span><span class="op" id="2903506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903512"><a href="/math/big/nat.go.html#2903050">zz</a></span><span class="op" id="2903514">,</span>&nbsp;<span class="ident" id="2903516"><a href="/math/big/nat.go.html#2903054">r</a></span><span class="op" id="2903517">,</span>&nbsp;<span class="ident" id="2903519"><a href="/math/big/nat.go.html#2902686">q</a></span><span class="op" id="2903520">,</span>&nbsp;<span class="ident" id="2903522"><a href="/math/big/nat.go.html#2901797">z</a></span>&nbsp;<span class="op" id="2903524">=</span>&nbsp;<span class="ident" id="2903526"><a href="/math/big/nat.go.html#2902686">q</a></span><span class="op" id="2903527">,</span>&nbsp;<span class="ident" id="2903529"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2903530">,</span>&nbsp;<span class="ident" id="2903532"><a href="/math/big/nat.go.html#2903050">zz</a></span><span class="op" id="2903534">,</span>&nbsp;<span class="ident" id="2903536"><a href="/math/big/nat.go.html#2903054">r</a></span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2903541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903547"><a href="/math/big/nat.go.html#2902578">v</a></span>&nbsp;<span class="op" id="2903549">&lt;&lt;=</span>&nbsp;<span class="num" id="2903553">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2903557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2903560">}</span><br>
<span class="lineno">1315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903564">return</span>&nbsp;<span class="ident" id="2903571"><a href="/math/big/nat.go.html#2901797">z</a></span><span class="op" id="2903572">.</span><span class="ident" id="2903573">norm</span><span class="op" id="2903577">(</span><span class="op" id="2903578">)</span><br>
<span class="lineno"></span><span class="op" id="2903580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2903583">//&nbsp;expNNWindowed&nbsp;calculates&nbsp;x**y&nbsp;mod&nbsp;m&nbsp;using&nbsp;a&nbsp;fixed,&nbsp;4-bit&nbsp;window.</span><br>
<span class="lineno">1320</span><span class="keyword" id="2903651">func</span>&nbsp;<span class="op" id="2903656">(</span><span class="ident" id="2903657">z</span>&nbsp;<span class="ident" id="2903659"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2903662">)</span>&nbsp;<span class="ident" id="2903664">expNNWindowed</span><span class="op" id="2903677">(</span><span class="ident" id="2903678">x</span><span class="op" id="2903679">,</span>&nbsp;<span class="ident" id="2903681">y</span><span class="op" id="2903682">,</span>&nbsp;<span class="ident" id="2903684">m</span>&nbsp;<span class="ident" id="2903686"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2903689">)</span>&nbsp;<span class="ident" id="2903691"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2903695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2903698">//&nbsp;zz&nbsp;and&nbsp;r&nbsp;are&nbsp;used&nbsp;to&nbsp;avoid&nbsp;allocating&nbsp;in&nbsp;mul&nbsp;and&nbsp;div&nbsp;as&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2903768">//&nbsp;the&nbsp;arguments&nbsp;would&nbsp;alias.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903799">var</span>&nbsp;<span class="ident" id="2903803">zz</span><span class="op" id="2903805">,</span>&nbsp;<span class="ident" id="2903807">r</span>&nbsp;<span class="ident" id="2903809"><a href="/math/big/nat.go.html#2873877">nat</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903815">const</span>&nbsp;<span class="ident" id="2903821">n</span>&nbsp;<span class="op" id="2903823">=</span>&nbsp;<span class="num" id="2903825">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2903828">//&nbsp;powers[i]&nbsp;contains&nbsp;x^i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903856">var</span>&nbsp;<span class="ident" id="2903860">powers</span>&nbsp;<span class="op" id="2903867">[</span><span class="num" id="2903868">1</span>&nbsp;<span class="op" id="2903870">&lt;&lt;</span>&nbsp;<span class="ident" id="2903873"><a href="/math/big/nat.go.html#2903821">n</a></span><span class="op" id="2903874">]</span><span class="ident" id="2903875"><a href="/math/big/nat.go.html#2873877">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903880"><a href="/math/big/nat.go.html#2903860">powers</a></span><span class="op" id="2903886">[</span><span class="num" id="2903887">0</span><span class="op" id="2903888">]</span>&nbsp;<span class="op" id="2903890">=</span>&nbsp;<span class="ident" id="2903892"><a href="/math/big/nat.go.html#2873896">natOne</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903900"><a href="/math/big/nat.go.html#2903860">powers</a></span><span class="op" id="2903906">[</span><span class="num" id="2903907">1</span><span class="op" id="2903908">]</span>&nbsp;<span class="op" id="2903910">=</span>&nbsp;<span class="ident" id="2903912"><a href="/math/big/nat.go.html#2903678">x</a></span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2903915">for</span>&nbsp;<span class="ident" id="2903919">i</span>&nbsp;<span class="op" id="2903921">:=</span>&nbsp;<span class="num" id="2903924">2</span><span class="op" id="2903925">;</span>&nbsp;<span class="ident" id="2903927"><a href="/math/big/nat.go.html#2903919">i</a></span>&nbsp;<span class="op" id="2903929">&lt;</span>&nbsp;<span class="num" id="2903931">1</span><span class="op" id="2903932">&lt;&lt;</span><span class="ident" id="2903934"><a href="/math/big/nat.go.html#2903821">n</a></span><span class="op" id="2903935">;</span>&nbsp;<span class="ident" id="2903937"><a href="/math/big/nat.go.html#2903919">i</a></span>&nbsp;<span class="op" id="2903939">+=</span>&nbsp;<span class="num" id="2903942">2</span>&nbsp;<span class="op" id="2903944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2903948">p2</span><span class="op" id="2903950">,</span>&nbsp;<span class="ident" id="2903952">p</span><span class="op" id="2903953">,</span>&nbsp;<span class="ident" id="2903955">p1</span>&nbsp;<span class="op" id="2903958">:=</span>&nbsp;<span class="op" id="2903961">&amp;</span><span class="ident" id="2903962"><a href="/math/big/nat.go.html#2903860">powers</a></span><span class="op" id="2903968">[</span><span class="ident" id="2903969"><a href="/math/big/nat.go.html#2903919">i</a></span><span class="op" id="2903970">/</span><span class="num" id="2903971">2</span><span class="op" id="2903972">]</span><span class="op" id="2903973">,</span>&nbsp;<span class="op" id="2903975">&amp;</span><span class="ident" id="2903976"><a href="/math/big/nat.go.html#2903860">powers</a></span><span class="op" id="2903982">[</span><span class="ident" id="2903983"><a href="/math/big/nat.go.html#2903919">i</a></span><span class="op" id="2903984">]</span><span class="op" id="2903985">,</span>&nbsp;<span class="op" id="2903987">&amp;</span><span class="ident" id="2903988"><a href="/math/big/nat.go.html#2903860">powers</a></span><span class="op" id="2903994">[</span><span class="ident" id="2903995"><a href="/math/big/nat.go.html#2903919">i</a></span><span class="op" id="2903996">+</span><span class="num" id="2903997">1</span><span class="op" id="2903998">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2904002">*</span><span class="ident" id="2904003"><a href="/math/big/nat.go.html#2903952">p</a></span>&nbsp;<span class="op" id="2904005">=</span>&nbsp;<span class="ident" id="2904007"><a href="/math/big/nat.go.html#2903952">p</a></span><span class="op" id="2904008">.</span><span class="ident" id="2904009">mul</span><span class="op" id="2904012">(</span><span class="op" id="2904013">*</span><span class="ident" id="2904014"><a href="/math/big/nat.go.html#2903948">p2</a></span><span class="op" id="2904016">,</span>&nbsp;<span class="op" id="2904018">*</span><span class="ident" id="2904019"><a href="/math/big/nat.go.html#2903948">p2</a></span><span class="op" id="2904021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904025"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904027">,</span>&nbsp;<span class="ident" id="2904029"><a href="/math/big/nat.go.html#2903807">r</a></span>&nbsp;<span class="op" id="2904031">=</span>&nbsp;<span class="ident" id="2904033"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904035">.</span><span class="ident" id="2904036">div</span><span class="op" id="2904039">(</span><span class="ident" id="2904040"><a href="/math/big/nat.go.html#2903807">r</a></span><span class="op" id="2904041">,</span>&nbsp;<span class="op" id="2904043">*</span><span class="ident" id="2904044"><a href="/math/big/nat.go.html#2903952">p</a></span><span class="op" id="2904045">,</span>&nbsp;<span class="ident" id="2904047"><a href="/math/big/nat.go.html#2903684">m</a></span><span class="op" id="2904048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2904052">*</span><span class="ident" id="2904053"><a href="/math/big/nat.go.html#2903952">p</a></span><span class="op" id="2904054">,</span>&nbsp;<span class="ident" id="2904056"><a href="/math/big/nat.go.html#2903807">r</a></span>&nbsp;<span class="op" id="2904058">=</span>&nbsp;<span class="ident" id="2904060"><a href="/math/big/nat.go.html#2903807">r</a></span><span class="op" id="2904061">,</span>&nbsp;<span class="op" id="2904063">*</span><span class="ident" id="2904064"><a href="/math/big/nat.go.html#2903952">p</a></span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2904068">*</span><span class="ident" id="2904069"><a href="/math/big/nat.go.html#2903955">p1</a></span>&nbsp;<span class="op" id="2904072">=</span>&nbsp;<span class="ident" id="2904074"><a href="/math/big/nat.go.html#2903955">p1</a></span><span class="op" id="2904076">.</span><span class="ident" id="2904077">mul</span><span class="op" id="2904080">(</span><span class="op" id="2904081">*</span><span class="ident" id="2904082"><a href="/math/big/nat.go.html#2903952">p</a></span><span class="op" id="2904083">,</span>&nbsp;<span class="ident" id="2904085"><a href="/math/big/nat.go.html#2903678">x</a></span><span class="op" id="2904086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904090"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904092">,</span>&nbsp;<span class="ident" id="2904094"><a href="/math/big/nat.go.html#2903807">r</a></span>&nbsp;<span class="op" id="2904096">=</span>&nbsp;<span class="ident" id="2904098"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904100">.</span><span class="ident" id="2904101">div</span><span class="op" id="2904104">(</span><span class="ident" id="2904105"><a href="/math/big/nat.go.html#2903807">r</a></span><span class="op" id="2904106">,</span>&nbsp;<span class="op" id="2904108">*</span><span class="ident" id="2904109"><a href="/math/big/nat.go.html#2903955">p1</a></span><span class="op" id="2904111">,</span>&nbsp;<span class="ident" id="2904113"><a href="/math/big/nat.go.html#2903684">m</a></span><span class="op" id="2904114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2904118">*</span><span class="ident" id="2904119"><a href="/math/big/nat.go.html#2903955">p1</a></span><span class="op" id="2904121">,</span>&nbsp;<span class="ident" id="2904123"><a href="/math/big/nat.go.html#2903807">r</a></span>&nbsp;<span class="op" id="2904125">=</span>&nbsp;<span class="ident" id="2904127"><a href="/math/big/nat.go.html#2903807">r</a></span><span class="op" id="2904128">,</span>&nbsp;<span class="op" id="2904130">*</span><span class="ident" id="2904131"><a href="/math/big/nat.go.html#2903955">p1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2904135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904139"><a href="/math/big/nat.go.html#2903657">z</a></span>&nbsp;<span class="op" id="2904141">=</span>&nbsp;<span class="ident" id="2904143"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904144">.</span><span class="ident" id="2904145">setWord</span><span class="op" id="2904152">(</span><span class="num" id="2904153">1</span><span class="op" id="2904154">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2904158">for</span>&nbsp;<span class="ident" id="2904162">i</span>&nbsp;<span class="op" id="2904164">:=</span>&nbsp;<span class="builtinfunc" id="2904167">len</span><span class="op" id="2904170">(</span><span class="ident" id="2904171"><a href="/math/big/nat.go.html#2903681">y</a></span><span class="op" id="2904172">)</span>&nbsp;<span class="op" id="2904174">-</span>&nbsp;<span class="num" id="2904176">1</span><span class="op" id="2904177">;</span>&nbsp;<span class="ident" id="2904179"><a href="/math/big/nat.go.html#2904162">i</a></span>&nbsp;<span class="op" id="2904181">&gt;=</span>&nbsp;<span class="num" id="2904184">0</span><span class="op" id="2904185">;</span>&nbsp;<span class="ident" id="2904187"><a href="/math/big/nat.go.html#2904162">i</a></span><span class="op" id="2904188">--</span>&nbsp;<span class="op" id="2904191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904195">yi</span>&nbsp;<span class="op" id="2904198">:=</span>&nbsp;<span class="ident" id="2904201"><a href="/math/big/nat.go.html#2903681">y</a></span><span class="op" id="2904202">[</span><span class="ident" id="2904203"><a href="/math/big/nat.go.html#2904162">i</a></span><span class="op" id="2904204">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2904208">for</span>&nbsp;<span class="ident" id="2904212">j</span>&nbsp;<span class="op" id="2904214">:=</span>&nbsp;<span class="num" id="2904217">0</span><span class="op" id="2904218">;</span>&nbsp;<span class="ident" id="2904220"><a href="/math/big/nat.go.html#2904212">j</a></span>&nbsp;<span class="op" id="2904222">&lt;</span>&nbsp;<span class="ident" id="2904224"><a href="/math/big/arith.go.html#2842878">_W</a></span><span class="op" id="2904226">;</span>&nbsp;<span class="ident" id="2904228"><a href="/math/big/nat.go.html#2904212">j</a></span>&nbsp;<span class="op" id="2904230">+=</span>&nbsp;<span class="ident" id="2904233"><a href="/math/big/nat.go.html#2903821">n</a></span>&nbsp;<span class="op" id="2904235">{</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2904240">if</span>&nbsp;<span class="ident" id="2904243"><a href="/math/big/nat.go.html#2904162">i</a></span>&nbsp;<span class="op" id="2904245">!=</span>&nbsp;<span class="builtinfunc" id="2904248">len</span><span class="op" id="2904251">(</span><span class="ident" id="2904252"><a href="/math/big/nat.go.html#2903681">y</a></span><span class="op" id="2904253">)</span><span class="op" id="2904254">-</span><span class="num" id="2904255">1</span>&nbsp;<span class="op" id="2904257">||</span>&nbsp;<span class="ident" id="2904260"><a href="/math/big/nat.go.html#2904212">j</a></span>&nbsp;<span class="op" id="2904262">!=</span>&nbsp;<span class="num" id="2904265">0</span>&nbsp;<span class="op" id="2904267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2904273">//&nbsp;Unrolled&nbsp;loop&nbsp;for&nbsp;significant&nbsp;performance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2904322">//&nbsp;gain.&nbsp;&nbsp;Use&nbsp;go&nbsp;test&nbsp;-bench=&#34;.*&#34;&nbsp;in&nbsp;crypto/rsa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2904374">//&nbsp;to&nbsp;check&nbsp;performance&nbsp;before&nbsp;making&nbsp;changes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904425"><a href="/math/big/nat.go.html#2903803">zz</a></span>&nbsp;<span class="op" id="2904428">=</span>&nbsp;<span class="ident" id="2904430"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904432">.</span><span class="ident" id="2904433">mul</span><span class="op" id="2904436">(</span><span class="ident" id="2904437"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904438">,</span>&nbsp;<span class="ident" id="2904440"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904441">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904447"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904449">,</span>&nbsp;<span class="ident" id="2904451"><a href="/math/big/nat.go.html#2903657">z</a></span>&nbsp;<span class="op" id="2904453">=</span>&nbsp;<span class="ident" id="2904455"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904456">,</span>&nbsp;<span class="ident" id="2904458"><a href="/math/big/nat.go.html#2903803">zz</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904465"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904467">,</span>&nbsp;<span class="ident" id="2904469"><a href="/math/big/nat.go.html#2903807">r</a></span>&nbsp;<span class="op" id="2904471">=</span>&nbsp;<span class="ident" id="2904473"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904475">.</span><span class="ident" id="2904476">div</span><span class="op" id="2904479">(</span><span class="ident" id="2904480"><a href="/math/big/nat.go.html#2903807">r</a></span><span class="op" id="2904481">,</span>&nbsp;<span class="ident" id="2904483"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904484">,</span>&nbsp;<span class="ident" id="2904486"><a href="/math/big/nat.go.html#2903684">m</a></span><span class="op" id="2904487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904493"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904494">,</span>&nbsp;<span class="ident" id="2904496"><a href="/math/big/nat.go.html#2903807">r</a></span>&nbsp;<span class="op" id="2904498">=</span>&nbsp;<span class="ident" id="2904500"><a href="/math/big/nat.go.html#2903807">r</a></span><span class="op" id="2904501">,</span>&nbsp;<span class="ident" id="2904503"><a href="/math/big/nat.go.html#2903657">z</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904510"><a href="/math/big/nat.go.html#2903803">zz</a></span>&nbsp;<span class="op" id="2904513">=</span>&nbsp;<span class="ident" id="2904515"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904517">.</span><span class="ident" id="2904518">mul</span><span class="op" id="2904521">(</span><span class="ident" id="2904522"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904523">,</span>&nbsp;<span class="ident" id="2904525"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904526">)</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904532"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904534">,</span>&nbsp;<span class="ident" id="2904536"><a href="/math/big/nat.go.html#2903657">z</a></span>&nbsp;<span class="op" id="2904538">=</span>&nbsp;<span class="ident" id="2904540"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904541">,</span>&nbsp;<span class="ident" id="2904543"><a href="/math/big/nat.go.html#2903803">zz</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904550"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904552">,</span>&nbsp;<span class="ident" id="2904554"><a href="/math/big/nat.go.html#2903807">r</a></span>&nbsp;<span class="op" id="2904556">=</span>&nbsp;<span class="ident" id="2904558"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904560">.</span><span class="ident" id="2904561">div</span><span class="op" id="2904564">(</span><span class="ident" id="2904565"><a href="/math/big/nat.go.html#2903807">r</a></span><span class="op" id="2904566">,</span>&nbsp;<span class="ident" id="2904568"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904569">,</span>&nbsp;<span class="ident" id="2904571"><a href="/math/big/nat.go.html#2903684">m</a></span><span class="op" id="2904572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904578"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904579">,</span>&nbsp;<span class="ident" id="2904581"><a href="/math/big/nat.go.html#2903807">r</a></span>&nbsp;<span class="op" id="2904583">=</span>&nbsp;<span class="ident" id="2904585"><a href="/math/big/nat.go.html#2903807">r</a></span><span class="op" id="2904586">,</span>&nbsp;<span class="ident" id="2904588"><a href="/math/big/nat.go.html#2903657">z</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904595"><a href="/math/big/nat.go.html#2903803">zz</a></span>&nbsp;<span class="op" id="2904598">=</span>&nbsp;<span class="ident" id="2904600"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904602">.</span><span class="ident" id="2904603">mul</span><span class="op" id="2904606">(</span><span class="ident" id="2904607"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904608">,</span>&nbsp;<span class="ident" id="2904610"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904611">)</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904617"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904619">,</span>&nbsp;<span class="ident" id="2904621"><a href="/math/big/nat.go.html#2903657">z</a></span>&nbsp;<span class="op" id="2904623">=</span>&nbsp;<span class="ident" id="2904625"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904626">,</span>&nbsp;<span class="ident" id="2904628"><a href="/math/big/nat.go.html#2903803">zz</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904635"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904637">,</span>&nbsp;<span class="ident" id="2904639"><a href="/math/big/nat.go.html#2903807">r</a></span>&nbsp;<span class="op" id="2904641">=</span>&nbsp;<span class="ident" id="2904643"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904645">.</span><span class="ident" id="2904646">div</span><span class="op" id="2904649">(</span><span class="ident" id="2904650"><a href="/math/big/nat.go.html#2903807">r</a></span><span class="op" id="2904651">,</span>&nbsp;<span class="ident" id="2904653"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904654">,</span>&nbsp;<span class="ident" id="2904656"><a href="/math/big/nat.go.html#2903684">m</a></span><span class="op" id="2904657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904663"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904664">,</span>&nbsp;<span class="ident" id="2904666"><a href="/math/big/nat.go.html#2903807">r</a></span>&nbsp;<span class="op" id="2904668">=</span>&nbsp;<span class="ident" id="2904670"><a href="/math/big/nat.go.html#2903807">r</a></span><span class="op" id="2904671">,</span>&nbsp;<span class="ident" id="2904673"><a href="/math/big/nat.go.html#2903657">z</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904680"><a href="/math/big/nat.go.html#2903803">zz</a></span>&nbsp;<span class="op" id="2904683">=</span>&nbsp;<span class="ident" id="2904685"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904687">.</span><span class="ident" id="2904688">mul</span><span class="op" id="2904691">(</span><span class="ident" id="2904692"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904693">,</span>&nbsp;<span class="ident" id="2904695"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904696">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904702"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904704">,</span>&nbsp;<span class="ident" id="2904706"><a href="/math/big/nat.go.html#2903657">z</a></span>&nbsp;<span class="op" id="2904708">=</span>&nbsp;<span class="ident" id="2904710"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904711">,</span>&nbsp;<span class="ident" id="2904713"><a href="/math/big/nat.go.html#2903803">zz</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904720"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904722">,</span>&nbsp;<span class="ident" id="2904724"><a href="/math/big/nat.go.html#2903807">r</a></span>&nbsp;<span class="op" id="2904726">=</span>&nbsp;<span class="ident" id="2904728"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904730">.</span><span class="ident" id="2904731">div</span><span class="op" id="2904734">(</span><span class="ident" id="2904735"><a href="/math/big/nat.go.html#2903807">r</a></span><span class="op" id="2904736">,</span>&nbsp;<span class="ident" id="2904738"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904739">,</span>&nbsp;<span class="ident" id="2904741"><a href="/math/big/nat.go.html#2903684">m</a></span><span class="op" id="2904742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904748"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904749">,</span>&nbsp;<span class="ident" id="2904751"><a href="/math/big/nat.go.html#2903807">r</a></span>&nbsp;<span class="op" id="2904753">=</span>&nbsp;<span class="ident" id="2904755"><a href="/math/big/nat.go.html#2903807">r</a></span><span class="op" id="2904756">,</span>&nbsp;<span class="ident" id="2904758"><a href="/math/big/nat.go.html#2903657">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2904763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904769"><a href="/math/big/nat.go.html#2903803">zz</a></span>&nbsp;<span class="op" id="2904772">=</span>&nbsp;<span class="ident" id="2904774"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904776">.</span><span class="ident" id="2904777">mul</span><span class="op" id="2904780">(</span><span class="ident" id="2904781"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904782">,</span>&nbsp;<span class="ident" id="2904784"><a href="/math/big/nat.go.html#2903860">powers</a></span><span class="op" id="2904790">[</span><span class="ident" id="2904791"><a href="/math/big/nat.go.html#2904195">yi</a></span><span class="op" id="2904793">&gt;&gt;</span><span class="op" id="2904795">(</span><span class="ident" id="2904796"><a href="/math/big/arith.go.html#2842878">_W</a></span><span class="op" id="2904798">-</span><span class="ident" id="2904799"><a href="/math/big/nat.go.html#2903821">n</a></span><span class="op" id="2904800">)</span><span class="op" id="2904801">]</span><span class="op" id="2904802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904807"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904809">,</span>&nbsp;<span class="ident" id="2904811"><a href="/math/big/nat.go.html#2903657">z</a></span>&nbsp;<span class="op" id="2904813">=</span>&nbsp;<span class="ident" id="2904815"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904816">,</span>&nbsp;<span class="ident" id="2904818"><a href="/math/big/nat.go.html#2903803">zz</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904824"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904826">,</span>&nbsp;<span class="ident" id="2904828"><a href="/math/big/nat.go.html#2903807">r</a></span>&nbsp;<span class="op" id="2904830">=</span>&nbsp;<span class="ident" id="2904832"><a href="/math/big/nat.go.html#2903803">zz</a></span><span class="op" id="2904834">.</span><span class="ident" id="2904835">div</span><span class="op" id="2904838">(</span><span class="ident" id="2904839"><a href="/math/big/nat.go.html#2903807">r</a></span><span class="op" id="2904840">,</span>&nbsp;<span class="ident" id="2904842"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904843">,</span>&nbsp;<span class="ident" id="2904845"><a href="/math/big/nat.go.html#2903684">m</a></span><span class="op" id="2904846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904851"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904852">,</span>&nbsp;<span class="ident" id="2904854"><a href="/math/big/nat.go.html#2903807">r</a></span>&nbsp;<span class="op" id="2904856">=</span>&nbsp;<span class="ident" id="2904858"><a href="/math/big/nat.go.html#2903807">r</a></span><span class="op" id="2904859">,</span>&nbsp;<span class="ident" id="2904861"><a href="/math/big/nat.go.html#2903657">z</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2904867"><a href="/math/big/nat.go.html#2904195">yi</a></span>&nbsp;<span class="op" id="2904870">&lt;&lt;=</span>&nbsp;<span class="ident" id="2904874"><a href="/math/big/nat.go.html#2903821">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2904878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2904881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2904885">return</span>&nbsp;<span class="ident" id="2904892"><a href="/math/big/nat.go.html#2903657">z</a></span><span class="op" id="2904893">.</span><span class="ident" id="2904894">norm</span><span class="op" id="2904898">(</span><span class="op" id="2904899">)</span><br>
<span class="lineno">1380</span><span class="op" id="2904901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2904904">//&nbsp;probablyPrime&nbsp;performs&nbsp;reps&nbsp;Miller-Rabin&nbsp;tests&nbsp;to&nbsp;check&nbsp;whether&nbsp;n&nbsp;is&nbsp;prime.</span><br>
<span class="lineno"></span><span class="comment" id="2904983">//&nbsp;If&nbsp;it&nbsp;returns&nbsp;true,&nbsp;n&nbsp;is&nbsp;prime&nbsp;with&nbsp;probability&nbsp;1&nbsp;-&nbsp;1/4^reps.</span><br>
<span class="lineno"></span><span class="comment" id="2905048">//&nbsp;If&nbsp;it&nbsp;returns&nbsp;false,&nbsp;n&nbsp;is&nbsp;not&nbsp;prime.</span><br>
<span class="lineno">1385</span><span class="keyword" id="2905088">func</span>&nbsp;<span class="op" id="2905093">(</span><span class="ident" id="2905094">n</span>&nbsp;<span class="ident" id="2905096"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2905099">)</span>&nbsp;<span class="ident" id="2905101">probablyPrime</span><span class="op" id="2905114">(</span><span class="ident" id="2905115">reps</span>&nbsp;<span class="builtintype" id="2905120">int</span><span class="op" id="2905123">)</span>&nbsp;<span class="builtintype" id="2905125">bool</span>&nbsp;<span class="op" id="2905130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905133">if</span>&nbsp;<span class="builtinfunc" id="2905136">len</span><span class="op" id="2905139">(</span><span class="ident" id="2905140"><a href="/math/big/nat.go.html#2905094">n</a></span><span class="op" id="2905141">)</span>&nbsp;<span class="op" id="2905143">==</span>&nbsp;<span class="num" id="2905146">0</span>&nbsp;<span class="op" id="2905148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905152">return</span>&nbsp;<span class="ident" id="2905159">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2905166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905170">if</span>&nbsp;<span class="builtinfunc" id="2905173">len</span><span class="op" id="2905176">(</span><span class="ident" id="2905177"><a href="/math/big/nat.go.html#2905094">n</a></span><span class="op" id="2905178">)</span>&nbsp;<span class="op" id="2905180">==</span>&nbsp;<span class="num" id="2905183">1</span>&nbsp;<span class="op" id="2905185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905189">if</span>&nbsp;<span class="ident" id="2905192"><a href="/math/big/nat.go.html#2905094">n</a></span><span class="op" id="2905193">[</span><span class="num" id="2905194">0</span><span class="op" id="2905195">]</span>&nbsp;<span class="op" id="2905197">&lt;</span>&nbsp;<span class="num" id="2905199">2</span>&nbsp;<span class="op" id="2905201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905206">return</span>&nbsp;<span class="ident" id="2905213">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2905221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905226">if</span>&nbsp;<span class="ident" id="2905229"><a href="/math/big/nat.go.html#2905094">n</a></span><span class="op" id="2905230">[</span><span class="num" id="2905231">0</span><span class="op" id="2905232">]</span><span class="op" id="2905233">%</span><span class="num" id="2905234">2</span>&nbsp;<span class="op" id="2905236">==</span>&nbsp;<span class="num" id="2905239">0</span>&nbsp;<span class="op" id="2905241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905246">return</span>&nbsp;<span class="ident" id="2905253"><a href="/math/big/nat.go.html#2905094">n</a></span><span class="op" id="2905254">[</span><span class="num" id="2905255">0</span><span class="op" id="2905256">]</span>&nbsp;<span class="op" id="2905258">==</span>&nbsp;<span class="num" id="2905261">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2905265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2905270">//&nbsp;We&nbsp;have&nbsp;to&nbsp;exclude&nbsp;these&nbsp;cases&nbsp;because&nbsp;we&nbsp;reject&nbsp;all</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2905328">//&nbsp;multiples&nbsp;of&nbsp;these&nbsp;numbers&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905367">switch</span>&nbsp;<span class="ident" id="2905374"><a href="/math/big/nat.go.html#2905094">n</a></span><span class="op" id="2905375">[</span><span class="num" id="2905376">0</span><span class="op" id="2905377">]</span>&nbsp;<span class="op" id="2905379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905383">case</span>&nbsp;<span class="num" id="2905388">3</span><span class="op" id="2905389">,</span>&nbsp;<span class="num" id="2905391">5</span><span class="op" id="2905392">,</span>&nbsp;<span class="num" id="2905394">7</span><span class="op" id="2905395">,</span>&nbsp;<span class="num" id="2905397">11</span><span class="op" id="2905399">,</span>&nbsp;<span class="num" id="2905401">13</span><span class="op" id="2905403">,</span>&nbsp;<span class="num" id="2905405">17</span><span class="op" id="2905407">,</span>&nbsp;<span class="num" id="2905409">19</span><span class="op" id="2905411">,</span>&nbsp;<span class="num" id="2905413">23</span><span class="op" id="2905415">,</span>&nbsp;<span class="num" id="2905417">29</span><span class="op" id="2905419">,</span>&nbsp;<span class="num" id="2905421">31</span><span class="op" id="2905423">,</span>&nbsp;<span class="num" id="2905425">37</span><span class="op" id="2905427">,</span>&nbsp;<span class="num" id="2905429">41</span><span class="op" id="2905431">,</span>&nbsp;<span class="num" id="2905433">43</span><span class="op" id="2905435">,</span>&nbsp;<span class="num" id="2905437">47</span><span class="op" id="2905439">,</span>&nbsp;<span class="num" id="2905441">53</span><span class="op" id="2905443">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905448">return</span>&nbsp;<span class="ident" id="2905455">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2905462">}</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2905465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905469">const</span>&nbsp;<span class="ident" id="2905475">primesProduct32</span>&nbsp;<span class="op" id="2905491">=</span>&nbsp;<span class="num" id="2905493">0xC0CFD797</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2905512">//&nbsp;Π&nbsp;{p&nbsp;∈&nbsp;primes,&nbsp;2&nbsp;&lt;&nbsp;p&nbsp;&lt;=&nbsp;29}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905547">const</span>&nbsp;<span class="ident" id="2905553">primesProduct64</span>&nbsp;<span class="op" id="2905569">=</span>&nbsp;<span class="num" id="2905571">0xE221F97C30E94E1D</span>&nbsp;<span class="comment" id="2905590">//&nbsp;Π&nbsp;{p&nbsp;∈&nbsp;primes,&nbsp;2&nbsp;&lt;&nbsp;p&nbsp;&lt;=&nbsp;53}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905626">var</span>&nbsp;<span class="ident" id="2905630">r</span>&nbsp;<span class="ident" id="2905632"><a href="/math/big/arith.go.html#2842733">Word</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905638">switch</span>&nbsp;<span class="ident" id="2905645"><a href="/math/big/arith.go.html#2842878">_W</a></span>&nbsp;<span class="op" id="2905648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905651">case</span>&nbsp;<span class="num" id="2905656">32</span><span class="op" id="2905658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2905662"><a href="/math/big/nat.go.html#2905630">r</a></span>&nbsp;<span class="op" id="2905664">=</span>&nbsp;<span class="ident" id="2905666"><a href="/math/big/nat.go.html#2905094">n</a></span><span class="op" id="2905667">.</span><span class="ident" id="2905668">modW</span><span class="op" id="2905672">(</span><span class="ident" id="2905673"><a href="/math/big/nat.go.html#2905475">primesProduct32</a></span><span class="op" id="2905688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905691">case</span>&nbsp;<span class="num" id="2905696">64</span><span class="op" id="2905698">:</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2905702"><a href="/math/big/nat.go.html#2905630">r</a></span>&nbsp;<span class="op" id="2905704">=</span>&nbsp;<span class="ident" id="2905706"><a href="/math/big/nat.go.html#2905094">n</a></span><span class="op" id="2905707">.</span><span class="ident" id="2905708">modW</span><span class="op" id="2905712">(</span><span class="ident" id="2905713"><a href="/math/big/nat.go.html#2905553">primesProduct64</a></span>&nbsp;<span class="op" id="2905729">&amp;</span>&nbsp;<span class="ident" id="2905731"><a href="/math/big/arith.go.html#2842941">_M</a></span><span class="op" id="2905733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905736">default</span><span class="op" id="2905743">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2905747">panic</span><span class="op" id="2905752">(</span><span class="string" id="2905753">&#34;Unknown&nbsp;word&nbsp;size&#34;</span><span class="op" id="2905772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2905775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905779">if</span>&nbsp;<span class="ident" id="2905782"><a href="/math/big/nat.go.html#2905630">r</a></span><span class="op" id="2905783">%</span><span class="num" id="2905784">3</span>&nbsp;<span class="op" id="2905786">==</span>&nbsp;<span class="num" id="2905789">0</span>&nbsp;<span class="op" id="2905791">||</span>&nbsp;<span class="ident" id="2905794"><a href="/math/big/nat.go.html#2905630">r</a></span><span class="op" id="2905795">%</span><span class="num" id="2905796">5</span>&nbsp;<span class="op" id="2905798">==</span>&nbsp;<span class="num" id="2905801">0</span>&nbsp;<span class="op" id="2905803">||</span>&nbsp;<span class="ident" id="2905806"><a href="/math/big/nat.go.html#2905630">r</a></span><span class="op" id="2905807">%</span><span class="num" id="2905808">7</span>&nbsp;<span class="op" id="2905810">==</span>&nbsp;<span class="num" id="2905813">0</span>&nbsp;<span class="op" id="2905815">||</span>&nbsp;<span class="ident" id="2905818"><a href="/math/big/nat.go.html#2905630">r</a></span><span class="op" id="2905819">%</span><span class="num" id="2905820">11</span>&nbsp;<span class="op" id="2905823">==</span>&nbsp;<span class="num" id="2905826">0</span>&nbsp;<span class="op" id="2905828">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2905833"><a href="/math/big/nat.go.html#2905630">r</a></span><span class="op" id="2905834">%</span><span class="num" id="2905835">13</span>&nbsp;<span class="op" id="2905838">==</span>&nbsp;<span class="num" id="2905841">0</span>&nbsp;<span class="op" id="2905843">||</span>&nbsp;<span class="ident" id="2905846"><a href="/math/big/nat.go.html#2905630">r</a></span><span class="op" id="2905847">%</span><span class="num" id="2905848">17</span>&nbsp;<span class="op" id="2905851">==</span>&nbsp;<span class="num" id="2905854">0</span>&nbsp;<span class="op" id="2905856">||</span>&nbsp;<span class="ident" id="2905859"><a href="/math/big/nat.go.html#2905630">r</a></span><span class="op" id="2905860">%</span><span class="num" id="2905861">19</span>&nbsp;<span class="op" id="2905864">==</span>&nbsp;<span class="num" id="2905867">0</span>&nbsp;<span class="op" id="2905869">||</span>&nbsp;<span class="ident" id="2905872"><a href="/math/big/nat.go.html#2905630">r</a></span><span class="op" id="2905873">%</span><span class="num" id="2905874">23</span>&nbsp;<span class="op" id="2905877">==</span>&nbsp;<span class="num" id="2905880">0</span>&nbsp;<span class="op" id="2905882">||</span>&nbsp;<span class="ident" id="2905885"><a href="/math/big/nat.go.html#2905630">r</a></span><span class="op" id="2905886">%</span><span class="num" id="2905887">29</span>&nbsp;<span class="op" id="2905890">==</span>&nbsp;<span class="num" id="2905893">0</span>&nbsp;<span class="op" id="2905895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905899">return</span>&nbsp;<span class="ident" id="2905906">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2905913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2905917">if</span>&nbsp;<span class="ident" id="2905920"><a href="/math/big/arith.go.html#2842878">_W</a></span>&nbsp;<span class="op" id="2905923">==</span>&nbsp;<span class="num" id="2905926">64</span>&nbsp;<span class="op" id="2905929">&amp;&amp;</span>&nbsp;<span class="op" id="2905932">(</span><span class="ident" id="2905933"><a href="/math/big/nat.go.html#2905630">r</a></span><span class="op" id="2905934">%</span><span class="num" id="2905935">31</span>&nbsp;<span class="op" id="2905938">==</span>&nbsp;<span class="num" id="2905941">0</span>&nbsp;<span class="op" id="2905943">||</span>&nbsp;<span class="ident" id="2905946"><a href="/math/big/nat.go.html#2905630">r</a></span><span class="op" id="2905947">%</span><span class="num" id="2905948">37</span>&nbsp;<span class="op" id="2905951">==</span>&nbsp;<span class="num" id="2905954">0</span>&nbsp;<span class="op" id="2905956">||</span>&nbsp;<span class="ident" id="2905959"><a href="/math/big/nat.go.html#2905630">r</a></span><span class="op" id="2905960">%</span><span class="num" id="2905961">41</span>&nbsp;<span class="op" id="2905964">==</span>&nbsp;<span class="num" id="2905967">0</span>&nbsp;<span class="op" id="2905969">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2905974"><a href="/math/big/nat.go.html#2905630">r</a></span><span class="op" id="2905975">%</span><span class="num" id="2905976">43</span>&nbsp;<span class="op" id="2905979">==</span>&nbsp;<span class="num" id="2905982">0</span>&nbsp;<span class="op" id="2905984">||</span>&nbsp;<span class="ident" id="2905987"><a href="/math/big/nat.go.html#2905630">r</a></span><span class="op" id="2905988">%</span><span class="num" id="2905989">47</span>&nbsp;<span class="op" id="2905992">==</span>&nbsp;<span class="num" id="2905995">0</span>&nbsp;<span class="op" id="2905997">||</span>&nbsp;<span class="ident" id="2906000"><a href="/math/big/nat.go.html#2905630">r</a></span><span class="op" id="2906001">%</span><span class="num" id="2906002">53</span>&nbsp;<span class="op" id="2906005">==</span>&nbsp;<span class="num" id="2906008">0</span><span class="op" id="2906009">)</span>&nbsp;<span class="op" id="2906011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906015">return</span>&nbsp;<span class="ident" id="2906022">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2906029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906033">nm1</span>&nbsp;<span class="op" id="2906037">:=</span>&nbsp;<span class="ident" id="2906040"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2906043">(</span><span class="ident" id="2906044">nil</span><span class="op" id="2906047">)</span><span class="op" id="2906048">.</span><span class="ident" id="2906049">sub</span><span class="op" id="2906052">(</span><span class="ident" id="2906053"><a href="/math/big/nat.go.html#2905094">n</a></span><span class="op" id="2906054">,</span>&nbsp;<span class="ident" id="2906056"><a href="/math/big/nat.go.html#2873896">natOne</a></span><span class="op" id="2906062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2906065">//&nbsp;determine&nbsp;q,&nbsp;k&nbsp;such&nbsp;that&nbsp;nm1&nbsp;=&nbsp;q&nbsp;&lt;&lt;&nbsp;k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906107">k</span>&nbsp;<span class="op" id="2906109">:=</span>&nbsp;<span class="ident" id="2906112"><a href="/math/big/nat.go.html#2906033">nm1</a></span><span class="op" id="2906115">.</span><span class="ident" id="2906116">trailingZeroBits</span><span class="op" id="2906132">(</span><span class="op" id="2906133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906136">q</span>&nbsp;<span class="op" id="2906138">:=</span>&nbsp;<span class="ident" id="2906141"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2906144">(</span><span class="ident" id="2906145">nil</span><span class="op" id="2906148">)</span><span class="op" id="2906149">.</span><span class="ident" id="2906150">shr</span><span class="op" id="2906153">(</span><span class="ident" id="2906154"><a href="/math/big/nat.go.html#2906033">nm1</a></span><span class="op" id="2906157">,</span>&nbsp;<span class="ident" id="2906159"><a href="/math/big/nat.go.html#2906107">k</a></span><span class="op" id="2906160">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906164">nm3</span>&nbsp;<span class="op" id="2906168">:=</span>&nbsp;<span class="ident" id="2906171"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2906174">(</span><span class="ident" id="2906175">nil</span><span class="op" id="2906178">)</span><span class="op" id="2906179">.</span><span class="ident" id="2906180">sub</span><span class="op" id="2906183">(</span><span class="ident" id="2906184"><a href="/math/big/nat.go.html#2906033">nm1</a></span><span class="op" id="2906187">,</span>&nbsp;<span class="ident" id="2906189"><a href="/math/big/nat.go.html#2873913">natTwo</a></span><span class="op" id="2906195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906198">rand</span>&nbsp;<span class="op" id="2906203">:=</span>&nbsp;<span class="ident" id="2906206"><a href="/math/big/nat.go.html#2873341">rand</a></span><span class="op" id="2906210">.</span><span class="ident" id="2906211">New</span><span class="op" id="2906214">(</span><span class="ident" id="2906215"><a href="/math/big/nat.go.html#2873341">rand</a></span><span class="op" id="2906219">.</span><span class="ident" id="2906220">NewSource</span><span class="op" id="2906229">(</span><span class="ident" id="2906230">int64</span><span class="op" id="2906235">(</span><span class="ident" id="2906236"><a href="/math/big/nat.go.html#2905094">n</a></span><span class="op" id="2906237">[</span><span class="num" id="2906238">0</span><span class="op" id="2906239">]</span><span class="op" id="2906240">)</span><span class="op" id="2906241">)</span><span class="op" id="2906242">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906246">var</span>&nbsp;<span class="ident" id="2906250">x</span><span class="op" id="2906251">,</span>&nbsp;<span class="ident" id="2906253">y</span><span class="op" id="2906254">,</span>&nbsp;<span class="ident" id="2906256">quotient</span>&nbsp;<span class="ident" id="2906265"><a href="/math/big/nat.go.html#2873877">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906270">nm3Len</span>&nbsp;<span class="op" id="2906277">:=</span>&nbsp;<span class="ident" id="2906280"><a href="/math/big/nat.go.html#2906164">nm3</a></span><span class="op" id="2906283">.</span><span class="ident" id="2906284">bitLen</span><span class="op" id="2906290">(</span><span class="op" id="2906291">)</span><br>
<span class="lineno">1440</span><br>
<span class="lineno"></span><span class="ident" id="2906294">NextRandom</span><span class="op" id="2906304">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906307">for</span>&nbsp;<span class="ident" id="2906311">i</span>&nbsp;<span class="op" id="2906313">:=</span>&nbsp;<span class="num" id="2906316">0</span><span class="op" id="2906317">;</span>&nbsp;<span class="ident" id="2906319"><a href="/math/big/nat.go.html#2906311">i</a></span>&nbsp;<span class="op" id="2906321">&lt;</span>&nbsp;<span class="ident" id="2906323"><a href="/math/big/nat.go.html#2905115">reps</a></span><span class="op" id="2906327">;</span>&nbsp;<span class="ident" id="2906329"><a href="/math/big/nat.go.html#2906311">i</a></span><span class="op" id="2906330">++</span>&nbsp;<span class="op" id="2906333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906337"><a href="/math/big/nat.go.html#2906250">x</a></span>&nbsp;<span class="op" id="2906339">=</span>&nbsp;<span class="ident" id="2906341"><a href="/math/big/nat.go.html#2906250">x</a></span><span class="op" id="2906342">.</span><span class="ident" id="2906343">random</span><span class="op" id="2906349">(</span><span class="ident" id="2906350"><a href="/math/big/nat.go.html#2906198">rand</a></span><span class="op" id="2906354">,</span>&nbsp;<span class="ident" id="2906356"><a href="/math/big/nat.go.html#2906164">nm3</a></span><span class="op" id="2906359">,</span>&nbsp;<span class="ident" id="2906361"><a href="/math/big/nat.go.html#2906270">nm3Len</a></span><span class="op" id="2906367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906371"><a href="/math/big/nat.go.html#2906250">x</a></span>&nbsp;<span class="op" id="2906373">=</span>&nbsp;<span class="ident" id="2906375"><a href="/math/big/nat.go.html#2906250">x</a></span><span class="op" id="2906376">.</span><span class="ident" id="2906377">add</span><span class="op" id="2906380">(</span><span class="ident" id="2906381"><a href="/math/big/nat.go.html#2906250">x</a></span><span class="op" id="2906382">,</span>&nbsp;<span class="ident" id="2906384"><a href="/math/big/nat.go.html#2873913">natTwo</a></span><span class="op" id="2906390">)</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906394"><a href="/math/big/nat.go.html#2906253">y</a></span>&nbsp;<span class="op" id="2906396">=</span>&nbsp;<span class="ident" id="2906398"><a href="/math/big/nat.go.html#2906253">y</a></span><span class="op" id="2906399">.</span><span class="ident" id="2906400">expNN</span><span class="op" id="2906405">(</span><span class="ident" id="2906406"><a href="/math/big/nat.go.html#2906250">x</a></span><span class="op" id="2906407">,</span>&nbsp;<span class="ident" id="2906409"><a href="/math/big/nat.go.html#2906136">q</a></span><span class="op" id="2906410">,</span>&nbsp;<span class="ident" id="2906412"><a href="/math/big/nat.go.html#2905094">n</a></span><span class="op" id="2906413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906417">if</span>&nbsp;<span class="ident" id="2906420"><a href="/math/big/nat.go.html#2906253">y</a></span><span class="op" id="2906421">.</span><span class="ident" id="2906422">cmp</span><span class="op" id="2906425">(</span><span class="ident" id="2906426"><a href="/math/big/nat.go.html#2873896">natOne</a></span><span class="op" id="2906432">)</span>&nbsp;<span class="op" id="2906434">==</span>&nbsp;<span class="num" id="2906437">0</span>&nbsp;<span class="op" id="2906439">||</span>&nbsp;<span class="ident" id="2906442"><a href="/math/big/nat.go.html#2906253">y</a></span><span class="op" id="2906443">.</span><span class="ident" id="2906444">cmp</span><span class="op" id="2906447">(</span><span class="ident" id="2906448"><a href="/math/big/nat.go.html#2906033">nm1</a></span><span class="op" id="2906451">)</span>&nbsp;<span class="op" id="2906453">==</span>&nbsp;<span class="num" id="2906456">0</span>&nbsp;<span class="op" id="2906458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906463">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2906474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906478">for</span>&nbsp;<span class="ident" id="2906482">j</span>&nbsp;<span class="op" id="2906484">:=</span>&nbsp;<span class="builtintype" id="2906487">uint</span><span class="op" id="2906491">(</span><span class="num" id="2906492">1</span><span class="op" id="2906493">)</span><span class="op" id="2906494">;</span>&nbsp;<span class="ident" id="2906496"><a href="/math/big/nat.go.html#2906482">j</a></span>&nbsp;<span class="op" id="2906498">&lt;</span>&nbsp;<span class="ident" id="2906500"><a href="/math/big/nat.go.html#2906107">k</a></span><span class="op" id="2906501">;</span>&nbsp;<span class="ident" id="2906503"><a href="/math/big/nat.go.html#2906482">j</a></span><span class="op" id="2906504">++</span>&nbsp;<span class="op" id="2906507">{</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906512"><a href="/math/big/nat.go.html#2906253">y</a></span>&nbsp;<span class="op" id="2906514">=</span>&nbsp;<span class="ident" id="2906516"><a href="/math/big/nat.go.html#2906253">y</a></span><span class="op" id="2906517">.</span><span class="ident" id="2906518">mul</span><span class="op" id="2906521">(</span><span class="ident" id="2906522"><a href="/math/big/nat.go.html#2906253">y</a></span><span class="op" id="2906523">,</span>&nbsp;<span class="ident" id="2906525"><a href="/math/big/nat.go.html#2906253">y</a></span><span class="op" id="2906526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906531"><a href="/math/big/nat.go.html#2906256">quotient</a></span><span class="op" id="2906539">,</span>&nbsp;<span class="ident" id="2906541"><a href="/math/big/nat.go.html#2906253">y</a></span>&nbsp;<span class="op" id="2906543">=</span>&nbsp;<span class="ident" id="2906545"><a href="/math/big/nat.go.html#2906256">quotient</a></span><span class="op" id="2906553">.</span><span class="ident" id="2906554">div</span><span class="op" id="2906557">(</span><span class="ident" id="2906558"><a href="/math/big/nat.go.html#2906253">y</a></span><span class="op" id="2906559">,</span>&nbsp;<span class="ident" id="2906561"><a href="/math/big/nat.go.html#2906253">y</a></span><span class="op" id="2906562">,</span>&nbsp;<span class="ident" id="2906564"><a href="/math/big/nat.go.html#2905094">n</a></span><span class="op" id="2906565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906570">if</span>&nbsp;<span class="ident" id="2906573"><a href="/math/big/nat.go.html#2906253">y</a></span><span class="op" id="2906574">.</span><span class="ident" id="2906575">cmp</span><span class="op" id="2906578">(</span><span class="ident" id="2906579"><a href="/math/big/nat.go.html#2906033">nm1</a></span><span class="op" id="2906582">)</span>&nbsp;<span class="op" id="2906584">==</span>&nbsp;<span class="num" id="2906587">0</span>&nbsp;<span class="op" id="2906589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906595">continue</span>&nbsp;<span class="ident" id="2906604">NextRandom</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2906618">}</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906623">if</span>&nbsp;<span class="ident" id="2906626"><a href="/math/big/nat.go.html#2906253">y</a></span><span class="op" id="2906627">.</span><span class="ident" id="2906628">cmp</span><span class="op" id="2906631">(</span><span class="ident" id="2906632"><a href="/math/big/nat.go.html#2873896">natOne</a></span><span class="op" id="2906638">)</span>&nbsp;<span class="op" id="2906640">==</span>&nbsp;<span class="num" id="2906643">0</span>&nbsp;<span class="op" id="2906645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906651">return</span>&nbsp;<span class="ident" id="2906658">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2906667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2906671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906675">return</span>&nbsp;<span class="ident" id="2906682">false</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2906689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906693">return</span>&nbsp;<span class="ident" id="2906700">true</span><br>
<span class="lineno"></span><span class="op" id="2906705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span><span class="comment" id="2906708">//&nbsp;bytes&nbsp;writes&nbsp;the&nbsp;value&nbsp;of&nbsp;z&nbsp;into&nbsp;buf&nbsp;using&nbsp;big-endian&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="2906775">//&nbsp;len(buf)&nbsp;must&nbsp;be&nbsp;&gt;=&nbsp;len(z)*_S.&nbsp;The&nbsp;value&nbsp;of&nbsp;z&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2906842">//&nbsp;slice&nbsp;buf[i:].&nbsp;The&nbsp;number&nbsp;i&nbsp;of&nbsp;unused&nbsp;bytes&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2906909">//&nbsp;buf&nbsp;is&nbsp;returned&nbsp;as&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="2906939">func</span>&nbsp;<span class="op" id="2906944">(</span><span class="ident" id="2906945">z</span>&nbsp;<span class="ident" id="2906947"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2906950">)</span>&nbsp;<span class="ident" id="2906952">bytes</span><span class="op" id="2906957">(</span><span class="ident" id="2906958">buf</span>&nbsp;<span class="op" id="2906962">[</span><span class="op" id="2906963">]</span><span class="builtintype" id="2906964">byte</span><span class="op" id="2906968">)</span>&nbsp;<span class="op" id="2906970">(</span><span class="ident" id="2906971">i</span>&nbsp;<span class="builtintype" id="2906973">int</span><span class="op" id="2906976">)</span>&nbsp;<span class="op" id="2906978">{</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2906981"><a href="/math/big/nat.go.html#2906971">i</a></span>&nbsp;<span class="op" id="2906983">=</span>&nbsp;<span class="builtinfunc" id="2906985">len</span><span class="op" id="2906988">(</span><span class="ident" id="2906989"><a href="/math/big/nat.go.html#2906958">buf</a></span><span class="op" id="2906992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2906995">for</span>&nbsp;<span class="ident" id="2906999">_</span><span class="op" id="2907000">,</span>&nbsp;<span class="ident" id="2907002">d</span>&nbsp;<span class="op" id="2907004">:=</span>&nbsp;<span class="keyword" id="2907007">range</span>&nbsp;<span class="ident" id="2907013"><a href="/math/big/nat.go.html#2906945">z</a></span>&nbsp;<span class="op" id="2907015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2907019">for</span>&nbsp;<span class="ident" id="2907023">j</span>&nbsp;<span class="op" id="2907025">:=</span>&nbsp;<span class="num" id="2907028">0</span><span class="op" id="2907029">;</span>&nbsp;<span class="ident" id="2907031"><a href="/math/big/nat.go.html#2907023">j</a></span>&nbsp;<span class="op" id="2907033">&lt;</span>&nbsp;<span class="ident" id="2907035"><a href="/math/big/arith.go.html#2842857">_S</a></span><span class="op" id="2907037">;</span>&nbsp;<span class="ident" id="2907039"><a href="/math/big/nat.go.html#2907023">j</a></span><span class="op" id="2907040">++</span>&nbsp;<span class="op" id="2907043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907048"><a href="/math/big/nat.go.html#2906971">i</a></span><span class="op" id="2907049">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907055"><a href="/math/big/nat.go.html#2906958">buf</a></span><span class="op" id="2907058">[</span><span class="ident" id="2907059"><a href="/math/big/nat.go.html#2906971">i</a></span><span class="op" id="2907060">]</span>&nbsp;<span class="op" id="2907062">=</span>&nbsp;<span class="builtintype" id="2907064">byte</span><span class="op" id="2907068">(</span><span class="ident" id="2907069"><a href="/math/big/nat.go.html#2907002">d</a></span><span class="op" id="2907070">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907075"><a href="/math/big/nat.go.html#2907002">d</a></span>&nbsp;<span class="op" id="2907077">&gt;&gt;=</span>&nbsp;<span class="num" id="2907081">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2907085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2907088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2907092">for</span>&nbsp;<span class="ident" id="2907096"><a href="/math/big/nat.go.html#2906971">i</a></span>&nbsp;<span class="op" id="2907098">&lt;</span>&nbsp;<span class="builtinfunc" id="2907100">len</span><span class="op" id="2907103">(</span><span class="ident" id="2907104"><a href="/math/big/nat.go.html#2906958">buf</a></span><span class="op" id="2907107">)</span>&nbsp;<span class="op" id="2907109">&amp;&amp;</span>&nbsp;<span class="ident" id="2907112"><a href="/math/big/nat.go.html#2906958">buf</a></span><span class="op" id="2907115">[</span><span class="ident" id="2907116"><a href="/math/big/nat.go.html#2906971">i</a></span><span class="op" id="2907117">]</span>&nbsp;<span class="op" id="2907119">==</span>&nbsp;<span class="num" id="2907122">0</span>&nbsp;<span class="op" id="2907124">{</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907128"><a href="/math/big/nat.go.html#2906971">i</a></span><span class="op" id="2907129">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2907133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2907137">return</span><br>
<span class="lineno"></span><span class="op" id="2907144">}</span><br>
<span class="lineno">1485</span><br>
<span class="lineno"></span><span class="comment" id="2907147">//&nbsp;setBytes&nbsp;interprets&nbsp;buf&nbsp;as&nbsp;the&nbsp;bytes&nbsp;of&nbsp;a&nbsp;big-endian&nbsp;unsigned</span><br>
<span class="lineno"></span><span class="comment" id="2907212">//&nbsp;integer,&nbsp;sets&nbsp;z&nbsp;to&nbsp;that&nbsp;value,&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword" id="2907261">func</span>&nbsp;<span class="op" id="2907266">(</span><span class="ident" id="2907267">z</span>&nbsp;<span class="ident" id="2907269"><a href="/math/big/nat.go.html#2873877">nat</a></span><span class="op" id="2907272">)</span>&nbsp;<span class="ident" id="2907274">setBytes</span><span class="op" id="2907282">(</span><span class="ident" id="2907283">buf</span>&nbsp;<span class="op" id="2907287">[</span><span class="op" id="2907288">]</span><span class="builtintype" id="2907289">byte</span><span class="op" id="2907293">)</span>&nbsp;<span class="ident" id="2907295"><a href="/math/big/nat.go.html#2873877">nat</a></span>&nbsp;<span class="op" id="2907299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907302"><a href="/math/big/nat.go.html#2907267">z</a></span>&nbsp;<span class="op" id="2907304">=</span>&nbsp;<span class="ident" id="2907306"><a href="/math/big/nat.go.html#2907267">z</a></span><span class="op" id="2907307">.</span><span class="builtinfunc" id="2907308">make</span><span class="op" id="2907312">(</span><span class="op" id="2907313">(</span><span class="builtinfunc" id="2907314">len</span><span class="op" id="2907317">(</span><span class="ident" id="2907318"><a href="/math/big/nat.go.html#2907283">buf</a></span><span class="op" id="2907321">)</span>&nbsp;<span class="op" id="2907323">+</span>&nbsp;<span class="ident" id="2907325"><a href="/math/big/arith.go.html#2842857">_S</a></span>&nbsp;<span class="op" id="2907328">-</span>&nbsp;<span class="num" id="2907330">1</span><span class="op" id="2907331">)</span>&nbsp;<span class="op" id="2907333">/</span>&nbsp;<span class="ident" id="2907335"><a href="/math/big/arith.go.html#2842857">_S</a></span><span class="op" id="2907337">)</span><br>
<span class="lineno">1490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907341">k</span>&nbsp;<span class="op" id="2907343">:=</span>&nbsp;<span class="num" id="2907346">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907349">s</span>&nbsp;<span class="op" id="2907351">:=</span>&nbsp;<span class="builtintype" id="2907354">uint</span><span class="op" id="2907358">(</span><span class="num" id="2907359">0</span><span class="op" id="2907360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2907363">var</span>&nbsp;<span class="ident" id="2907367">d</span>&nbsp;<span class="ident" id="2907369"><a href="/math/big/arith.go.html#2842733">Word</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2907375">for</span>&nbsp;<span class="ident" id="2907379">i</span>&nbsp;<span class="op" id="2907381">:=</span>&nbsp;<span class="builtinfunc" id="2907384">len</span><span class="op" id="2907387">(</span><span class="ident" id="2907388"><a href="/math/big/nat.go.html#2907283">buf</a></span><span class="op" id="2907391">)</span><span class="op" id="2907392">;</span>&nbsp;<span class="ident" id="2907394"><a href="/math/big/nat.go.html#2907379">i</a></span>&nbsp;<span class="op" id="2907396">&gt;</span>&nbsp;<span class="num" id="2907398">0</span><span class="op" id="2907399">;</span>&nbsp;<span class="ident" id="2907401"><a href="/math/big/nat.go.html#2907379">i</a></span><span class="op" id="2907402">--</span>&nbsp;<span class="op" id="2907405">{</span><br>
<span class="lineno">1495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907409"><a href="/math/big/nat.go.html#2907367">d</a></span>&nbsp;<span class="op" id="2907411">|=</span>&nbsp;<span class="ident" id="2907414"><a href="/math/big/arith.go.html#2842733">Word</a></span><span class="op" id="2907418">(</span><span class="ident" id="2907419"><a href="/math/big/nat.go.html#2907283">buf</a></span><span class="op" id="2907422">[</span><span class="ident" id="2907423"><a href="/math/big/nat.go.html#2907379">i</a></span><span class="op" id="2907424">-</span><span class="num" id="2907425">1</span><span class="op" id="2907426">]</span><span class="op" id="2907427">)</span>&nbsp;<span class="op" id="2907429">&lt;&lt;</span>&nbsp;<span class="ident" id="2907432"><a href="/math/big/nat.go.html#2907349">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2907436">if</span>&nbsp;<span class="ident" id="2907439"><a href="/math/big/nat.go.html#2907349">s</a></span>&nbsp;<span class="op" id="2907441">+=</span>&nbsp;<span class="num" id="2907444">8</span><span class="op" id="2907445">;</span>&nbsp;<span class="ident" id="2907447"><a href="/math/big/nat.go.html#2907349">s</a></span>&nbsp;<span class="op" id="2907449">==</span>&nbsp;<span class="ident" id="2907452"><a href="/math/big/arith.go.html#2842857">_S</a></span><span class="op" id="2907454">*</span><span class="num" id="2907455">8</span>&nbsp;<span class="op" id="2907457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907462"><a href="/math/big/nat.go.html#2907267">z</a></span><span class="op" id="2907463">[</span><span class="ident" id="2907464"><a href="/math/big/nat.go.html#2907341">k</a></span><span class="op" id="2907465">]</span>&nbsp;<span class="op" id="2907467">=</span>&nbsp;<span class="ident" id="2907469"><a href="/math/big/nat.go.html#2907367">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907474"><a href="/math/big/nat.go.html#2907341">k</a></span><span class="op" id="2907475">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907481"><a href="/math/big/nat.go.html#2907349">s</a></span>&nbsp;<span class="op" id="2907483">=</span>&nbsp;<span class="num" id="2907485">0</span><br>
<span class="lineno">1500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907490"><a href="/math/big/nat.go.html#2907367">d</a></span>&nbsp;<span class="op" id="2907492">=</span>&nbsp;<span class="num" id="2907494">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2907498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2907501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2907504">if</span>&nbsp;<span class="ident" id="2907507"><a href="/math/big/nat.go.html#2907341">k</a></span>&nbsp;<span class="op" id="2907509">&lt;</span>&nbsp;<span class="builtinfunc" id="2907511">len</span><span class="op" id="2907514">(</span><span class="ident" id="2907515"><a href="/math/big/nat.go.html#2907267">z</a></span><span class="op" id="2907516">)</span>&nbsp;<span class="op" id="2907518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2907522"><a href="/math/big/nat.go.html#2907267">z</a></span><span class="op" id="2907523">[</span><span class="ident" id="2907524"><a href="/math/big/nat.go.html#2907341">k</a></span><span class="op" id="2907525">]</span>&nbsp;<span class="op" id="2907527">=</span>&nbsp;<span class="ident" id="2907529"><a href="/math/big/nat.go.html#2907367">d</a></span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2907532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2907536">return</span>&nbsp;<span class="ident" id="2907543"><a href="/math/big/nat.go.html#2907267">z</a></span><span class="op" id="2907544">.</span><span class="ident" id="2907545">norm</span><span class="op" id="2907549">(</span><span class="op" id="2907550">)</span><br>
<span class="lineno"></span><span class="op" id="2907552">}</span>
</div>
</body>
</html>
