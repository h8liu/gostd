<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6563089">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6563144">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6563198">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6563249">package</span>&nbsp;<span class="ident" id="6563257">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6563263">import</span>&nbsp;<span class="op" id="6563270">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6563273">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6563284">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6563290">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6563300">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6563303">//&nbsp;TODO(mattn):</span><br>
<span class="lineno"></span><span class="comment" id="6563319">//&nbsp;&nbsp;&nbsp;&nbsptest&nbsp;ProxyAuth</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6563338">var</span>&nbsp;<span class="ident" id="6563342">UseProxyTests</span>&nbsp;<span class="op" id="6563356">=</span>&nbsp;<span class="op" id="6563358">[</span><span class="op" id="6563359">]</span><span class="keyword" id="6563360">struct</span>&nbsp;<span class="op" id="6563367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563370">host</span>&nbsp;&nbsp;<span class="builtintype" id="6563376">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563384">match</span>&nbsp;<span class="builtintype" id="6563390">bool</span><br>
<span class="lineno"></span><span class="op" id="6563395">}</span><span class="op" id="6563396">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6563399">//&nbsp;Never&nbsp;proxy&nbsp;localhost:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563426">{</span><span class="string" id="6563427">&#34;localhost:80&#34;</span><span class="op" id="6563441">,</span>&nbsp;<span class="builtintype" id="6563443">false</span><span class="op" id="6563448">}</span><span class="op" id="6563449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563452">{</span><span class="string" id="6563453">&#34;127.0.0.1&#34;</span><span class="op" id="6563464">,</span>&nbsp;<span class="builtintype" id="6563466">false</span><span class="op" id="6563471">}</span><span class="op" id="6563472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563475">{</span><span class="string" id="6563476">&#34;127.0.0.2&#34;</span><span class="op" id="6563487">,</span>&nbsp;<span class="builtintype" id="6563489">false</span><span class="op" id="6563494">}</span><span class="op" id="6563495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563498">{</span><span class="string" id="6563499">&#34;[::1]&#34;</span><span class="op" id="6563506">,</span>&nbsp;<span class="builtintype" id="6563508">false</span><span class="op" id="6563513">}</span><span class="op" id="6563514">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563517">{</span><span class="string" id="6563518">&#34;[::2]&#34;</span><span class="op" id="6563525">,</span>&nbsp;<span class="builtintype" id="6563527">true</span><span class="op" id="6563531">}</span><span class="op" id="6563532">,</span>&nbsp;<span class="comment" id="6563534">//&nbsp;not&nbsp;a&nbsp;loopback&nbsp;address</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563562">{</span><span class="string" id="6563563">&#34;barbaz.net&#34;</span><span class="op" id="6563575">,</span>&nbsp;<span class="builtintype" id="6563577">false</span><span class="op" id="6563582">}</span><span class="op" id="6563583">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6563589">//&nbsp;match&nbsp;as&nbsp;.barbaz.net</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563614">{</span><span class="string" id="6563615">&#34;foobar.com&#34;</span><span class="op" id="6563627">,</span>&nbsp;<span class="builtintype" id="6563629">false</span><span class="op" id="6563634">}</span><span class="op" id="6563635">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6563641">//&nbsp;have&nbsp;a&nbsp;port&nbsp;but&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563667">{</span><span class="string" id="6563668">&#34;foofoobar.com&#34;</span><span class="op" id="6563683">,</span>&nbsp;<span class="builtintype" id="6563685">true</span><span class="op" id="6563689">}</span><span class="op" id="6563690">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6563694">//&nbsp;not&nbsp;match&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;foobar.com</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563732">{</span><span class="string" id="6563733">&#34;baz.com&#34;</span><span class="op" id="6563742">,</span>&nbsp;<span class="builtintype" id="6563744">true</span><span class="op" id="6563748">}</span><span class="op" id="6563749">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6563759">//&nbsp;not&nbsp;match&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;barbaz.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563797">{</span><span class="string" id="6563798">&#34;localhost.net&#34;</span><span class="op" id="6563813">,</span>&nbsp;<span class="builtintype" id="6563815">true</span><span class="op" id="6563819">}</span><span class="op" id="6563820">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6563824">//&nbsp;not&nbsp;match&nbsp;as&nbsp;suffix&nbsp;of&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563859">{</span><span class="string" id="6563860">&#34;local.localhost&#34;</span><span class="op" id="6563877">,</span>&nbsp;<span class="builtintype" id="6563879">true</span><span class="op" id="6563883">}</span><span class="op" id="6563884">,</span>&nbsp;<span class="comment" id="6563886">//&nbsp;not&nbsp;match&nbsp;as&nbsp;prefix&nbsp;as&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563921">{</span><span class="string" id="6563922">&#34;barbarbaz.net&#34;</span><span class="op" id="6563937">,</span>&nbsp;<span class="builtintype" id="6563939">true</span><span class="op" id="6563943">}</span><span class="op" id="6563944">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6563948">//&nbsp;not&nbsp;match&nbsp;because&nbsp;NO_PROXY&nbsp;have&nbsp;a&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563990">{</span><span class="string" id="6563991">&#34;www.foobar.com&#34;</span><span class="op" id="6564007">,</span>&nbsp;<span class="builtintype" id="6564009">false</span><span class="op" id="6564014">}</span><span class="op" id="6564015">,</span>&nbsp;<span class="comment" id="6564017">//&nbsp;match&nbsp;because&nbsp;NO_PROXY&nbsp;includes&nbsp;&#34;foobar.com&#34;</span><br>
<span class="lineno">35</span><span class="op" id="6564065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6564068">func</span>&nbsp;<span class="ident" id="6564073">TestUseProxy</span><span class="op" id="6564085">(</span><span class="ident" id="6564086">t</span>&nbsp;<span class="op" id="6564088">*</span><span class="ident" id="6564089">testing</span><span class="op" id="6564096">.</span><span class="ident" id="6564097">T</span><span class="op" id="6564098">)</span>&nbsp;<span class="op" id="6564100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564103">ResetProxyEnv</span><span class="op" id="6564116">(</span><span class="op" id="6564117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564120">os</span><span class="op" id="6564122">.</span><span class="ident" id="6564123">Setenv</span><span class="op" id="6564129">(</span><span class="string" id="6564130">&#34;NO_PROXY&#34;</span><span class="op" id="6564140">,</span>&nbsp;<span class="string" id="6564142">&#34;foobar.com,&nbsp;.barbaz.net&#34;</span><span class="op" id="6564167">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564170">for</span>&nbsp;<span class="ident" id="6564174">_</span><span class="op" id="6564175">,</span>&nbsp;<span class="ident" id="6564177">test</span>&nbsp;<span class="op" id="6564182">:=</span>&nbsp;<span class="keyword" id="6564185">range</span>&nbsp;<span class="ident" id="6564191">UseProxyTests</span>&nbsp;<span class="op" id="6564205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564209">if</span>&nbsp;<span class="ident" id="6564212">useProxy</span><span class="op" id="6564220">(</span><span class="ident" id="6564221">test</span><span class="op" id="6564225">.</span><span class="ident" id="6564226">host</span><span class="op" id="6564230">+</span><span class="string" id="6564231">&#34;:80&#34;</span><span class="op" id="6564236">)</span>&nbsp;<span class="op" id="6564238">!=</span>&nbsp;<span class="ident" id="6564241">test</span><span class="op" id="6564245">.</span><span class="ident" id="6564246">match</span>&nbsp;<span class="op" id="6564252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564257">t</span><span class="op" id="6564258">.</span><span class="ident" id="6564259">Errorf</span><span class="op" id="6564265">(</span><span class="string" id="6564266">&#34;useProxy(%v)&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6564294">,</span>&nbsp;<span class="ident" id="6564296">test</span><span class="op" id="6564300">.</span><span class="ident" id="6564301">host</span><span class="op" id="6564305">,</span>&nbsp;<span class="op" id="6564307">!</span><span class="ident" id="6564308">test</span><span class="op" id="6564312">.</span><span class="ident" id="6564313">match</span><span class="op" id="6564318">,</span>&nbsp;<span class="ident" id="6564320">test</span><span class="op" id="6564324">.</span><span class="ident" id="6564325">match</span><span class="op" id="6564330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564337">}</span><br>
<span class="lineno">45</span><span class="op" id="6564339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6564342">var</span>&nbsp;<span class="ident" id="6564346">cacheKeysTests</span>&nbsp;<span class="op" id="6564361">=</span>&nbsp;<span class="op" id="6564363">[</span><span class="op" id="6564364">]</span><span class="keyword" id="6564365">struct</span>&nbsp;<span class="op" id="6564372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564375">proxy</span>&nbsp;&nbsp;<span class="builtintype" id="6564382">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564390">scheme</span>&nbsp;<span class="builtintype" id="6564397">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564405">addr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6564412">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564420">key</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6564427">string</span><br>
<span class="lineno"></span><span class="op" id="6564434">}</span><span class="op" id="6564435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564438">{</span><span class="string" id="6564439">&#34;&#34;</span><span class="op" id="6564441">,</span>&nbsp;<span class="string" id="6564443">&#34;http&#34;</span><span class="op" id="6564449">,</span>&nbsp;<span class="string" id="6564451">&#34;foo.com&#34;</span><span class="op" id="6564460">,</span>&nbsp;<span class="string" id="6564462">&#34;|http|foo.com&#34;</span><span class="op" id="6564477">}</span><span class="op" id="6564478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564481">{</span><span class="string" id="6564482">&#34;&#34;</span><span class="op" id="6564484">,</span>&nbsp;<span class="string" id="6564486">&#34;https&#34;</span><span class="op" id="6564493">,</span>&nbsp;<span class="string" id="6564495">&#34;foo.com&#34;</span><span class="op" id="6564504">,</span>&nbsp;<span class="string" id="6564506">&#34;|https|foo.com&#34;</span><span class="op" id="6564522">}</span><span class="op" id="6564523">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564526">{</span><span class="string" id="6564527">&#34;http://foo.com&#34;</span><span class="op" id="6564543">,</span>&nbsp;<span class="string" id="6564545">&#34;http&#34;</span><span class="op" id="6564551">,</span>&nbsp;<span class="string" id="6564553">&#34;foo.com&#34;</span><span class="op" id="6564562">,</span>&nbsp;<span class="string" id="6564564">&#34;http://foo.com|http|&#34;</span><span class="op" id="6564586">}</span><span class="op" id="6564587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564590">{</span><span class="string" id="6564591">&#34;http://foo.com&#34;</span><span class="op" id="6564607">,</span>&nbsp;<span class="string" id="6564609">&#34;https&#34;</span><span class="op" id="6564616">,</span>&nbsp;<span class="string" id="6564618">&#34;foo.com&#34;</span><span class="op" id="6564627">,</span>&nbsp;<span class="string" id="6564629">&#34;http://foo.com|https|foo.com&#34;</span><span class="op" id="6564659">}</span><span class="op" id="6564660">,</span><br>
<span class="lineno"></span><span class="op" id="6564662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6564665">func</span>&nbsp;<span class="ident" id="6564670">TestCacheKeys</span><span class="op" id="6564683">(</span><span class="ident" id="6564684">t</span>&nbsp;<span class="op" id="6564686">*</span><span class="ident" id="6564687">testing</span><span class="op" id="6564694">.</span><span class="ident" id="6564695">T</span><span class="op" id="6564696">)</span>&nbsp;<span class="op" id="6564698">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564701">for</span>&nbsp;<span class="ident" id="6564705">_</span><span class="op" id="6564706">,</span>&nbsp;<span class="ident" id="6564708">tt</span>&nbsp;<span class="op" id="6564711">:=</span>&nbsp;<span class="keyword" id="6564714">range</span>&nbsp;<span class="ident" id="6564720">cacheKeysTests</span>&nbsp;<span class="op" id="6564735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564739">var</span>&nbsp;<span class="ident" id="6564743">proxy</span>&nbsp;<span class="op" id="6564749">*</span><span class="ident" id="6564750">url</span><span class="op" id="6564753">.</span><span class="ident" id="6564754">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564760">if</span>&nbsp;<span class="ident" id="6564763">tt</span><span class="op" id="6564765">.</span><span class="ident" id="6564766">proxy</span>&nbsp;<span class="op" id="6564772">!=</span>&nbsp;<span class="string" id="6564775">&#34;&#34;</span>&nbsp;<span class="op" id="6564778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564783">u</span><span class="op" id="6564784">,</span>&nbsp;<span class="ident" id="6564786">err</span>&nbsp;<span class="op" id="6564790">:=</span>&nbsp;<span class="ident" id="6564793">url</span><span class="op" id="6564796">.</span><span class="ident" id="6564797">Parse</span><span class="op" id="6564802">(</span><span class="ident" id="6564803">tt</span><span class="op" id="6564805">.</span><span class="ident" id="6564806">proxy</span><span class="op" id="6564811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564816">if</span>&nbsp;<span class="ident" id="6564819">err</span>&nbsp;<span class="op" id="6564823">!=</span>&nbsp;<span class="ident" id="6564826">nil</span>&nbsp;<span class="op" id="6564830">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564836">t</span><span class="op" id="6564837">.</span><span class="ident" id="6564838">Fatal</span><span class="op" id="6564843">(</span><span class="ident" id="6564844">err</span><span class="op" id="6564847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564857">proxy</span>&nbsp;<span class="op" id="6564863">=</span>&nbsp;<span class="ident" id="6564865">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564873">cm</span>&nbsp;<span class="op" id="6564876">:=</span>&nbsp;<span class="ident" id="6564879">connectMethod</span><span class="op" id="6564892">{</span><span class="ident" id="6564893">proxy</span><span class="op" id="6564898">,</span>&nbsp;<span class="ident" id="6564900">tt</span><span class="op" id="6564902">.</span><span class="ident" id="6564903">scheme</span><span class="op" id="6564909">,</span>&nbsp;<span class="ident" id="6564911">tt</span><span class="op" id="6564913">.</span><span class="ident" id="6564914">addr</span><span class="op" id="6564918">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564922">if</span>&nbsp;<span class="ident" id="6564925">got</span>&nbsp;<span class="op" id="6564929">:=</span>&nbsp;<span class="ident" id="6564932">cm</span><span class="op" id="6564934">.</span><span class="ident" id="6564935">key</span><span class="op" id="6564938">(</span><span class="op" id="6564939">)</span><span class="op" id="6564940">.</span><span class="ident" id="6564941">String</span><span class="op" id="6564947">(</span><span class="op" id="6564948">)</span><span class="op" id="6564949">;</span>&nbsp;<span class="ident" id="6564951">got</span>&nbsp;<span class="op" id="6564955">!=</span>&nbsp;<span class="ident" id="6564958">tt</span><span class="op" id="6564960">.</span><span class="ident" id="6564961">key</span>&nbsp;<span class="op" id="6564965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564970">t</span><span class="op" id="6564971">.</span><span class="ident" id="6564972">Fatalf</span><span class="op" id="6564978">(</span><span class="string" id="6564979">&#34;{%q,&nbsp;%q,&nbsp;%q}&nbsp;cache&nbsp;key&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6565017">,</span>&nbsp;<span class="ident" id="6565019">tt</span><span class="op" id="6565021">.</span><span class="ident" id="6565022">proxy</span><span class="op" id="6565027">,</span>&nbsp;<span class="ident" id="6565029">tt</span><span class="op" id="6565031">.</span><span class="ident" id="6565032">scheme</span><span class="op" id="6565038">,</span>&nbsp;<span class="ident" id="6565040">tt</span><span class="op" id="6565042">.</span><span class="ident" id="6565043">addr</span><span class="op" id="6565047">,</span>&nbsp;<span class="ident" id="6565049">got</span><span class="op" id="6565052">,</span>&nbsp;<span class="ident" id="6565054">tt</span><span class="op" id="6565056">.</span><span class="ident" id="6565057">key</span><span class="op" id="6565060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565067">}</span><br>
<span class="lineno"></span><span class="op" id="6565069">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="6565072">func</span>&nbsp;<span class="ident" id="6565077">ResetProxyEnv</span><span class="op" id="6565090">(</span><span class="op" id="6565091">)</span>&nbsp;<span class="op" id="6565093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6565096">for</span>&nbsp;<span class="ident" id="6565100">_</span><span class="op" id="6565101">,</span>&nbsp;<span class="ident" id="6565103">v</span>&nbsp;<span class="op" id="6565105">:=</span>&nbsp;<span class="keyword" id="6565108">range</span>&nbsp;<span class="op" id="6565114">[</span><span class="op" id="6565115">]</span><span class="builtintype" id="6565116">string</span><span class="op" id="6565122">{</span><span class="string" id="6565123">&#34;HTTP_PROXY&#34;</span><span class="op" id="6565135">,</span>&nbsp;<span class="string" id="6565137">&#34;http_proxy&#34;</span><span class="op" id="6565149">,</span>&nbsp;<span class="string" id="6565151">&#34;NO_PROXY&#34;</span><span class="op" id="6565161">,</span>&nbsp;<span class="string" id="6565163">&#34;no_proxy&#34;</span><span class="op" id="6565173">}</span>&nbsp;<span class="op" id="6565175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565179">os</span><span class="op" id="6565181">.</span><span class="ident" id="6565182">Setenv</span><span class="op" id="6565188">(</span><span class="ident" id="6565189">v</span><span class="op" id="6565190">,</span>&nbsp;<span class="string" id="6565192">&#34;&#34;</span><span class="op" id="6565194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565197">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565200">ResetCachedEnvironment</span><span class="op" id="6565222">(</span><span class="op" id="6565223">)</span><br>
<span class="lineno"></span><span class="op" id="6565225">}</span>
</div>
</body>
</html>
