<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1573592">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1573647">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1573701">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1573752">package</span>&nbsp;<span class="ident" id="1573760">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1573766">//&nbsp;Sleep&nbsp;pauses&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;for&nbsp;at&nbsp;least&nbsp;the&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="comment" id="1573833">//&nbsp;A&nbsp;negative&nbsp;or&nbsp;zero&nbsp;duration&nbsp;causes&nbsp;Sleep&nbsp;to&nbsp;return&nbsp;immediately.</span><br>
<span class="lineno"></span><span class="keyword" id="1573900">func</span>&nbsp;<span class="ident" id="1573905">Sleep</span><span class="op" id="1573910">(</span><span class="ident" id="1573911">d</span>&nbsp;<span class="ident" id="1573913"><a href="/time/time.go.html#1594177">Duration</a></span><span class="op" id="1573921">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1573924">//&nbsp;runtimeNano&nbsp;returns&nbsp;the&nbsp;current&nbsp;value&nbsp;of&nbsp;the&nbsp;runtime&nbsp;clock&nbsp;in&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="1574002">func</span>&nbsp;<span class="ident" id="1574007">runtimeNano</span><span class="op" id="1574018">(</span><span class="op" id="1574019">)</span>&nbsp;<span class="ident" id="1574021">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1574028">//&nbsp;Interface&nbsp;to&nbsp;timers&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno">15</span><span class="comment" id="1574083">//&nbsp;Must&nbsp;be&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/runtime.h:/^struct.Timer$</span><br>
<span class="lineno"></span><span class="keyword" id="1574144">type</span>&nbsp;<span class="ident" id="1574149">runtimeTimer</span>&nbsp;<span class="keyword" id="1574162">struct</span>&nbsp;<span class="op" id="1574169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1574172">i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1574179">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1574184">when</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1574191">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1574198">period</span>&nbsp;<span class="ident" id="1574205">int64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1574212">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1574219">func</span><span class="op" id="1574223">(</span><span class="keyword" id="1574224">interface</span><span class="op" id="1574233">{</span><span class="op" id="1574234">}</span><span class="op" id="1574235">,</span>&nbsp;<span class="builtintype" id="1574237">uintptr</span><span class="op" id="1574244">)</span>&nbsp;<span class="comment" id="1574246">//&nbsp;NOTE:&nbsp;must&nbsp;not&nbsp;be&nbsp;closure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1574276">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1574283">interface</span><span class="op" id="1574292">{</span><span class="op" id="1574293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1574296">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1574303">uintptr</span><br>
<span class="lineno"></span><span class="op" id="1574311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="1574314">//&nbsp;when&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;setting&nbsp;the&nbsp;&#39;when&#39;&nbsp;field&nbsp;of&nbsp;a&nbsp;runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="1574391">//&nbsp;It&nbsp;returns&nbsp;what&nbsp;the&nbsp;time&nbsp;will&nbsp;be,&nbsp;in&nbsp;nanoseconds,&nbsp;Duration&nbsp;d&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span><span class="comment" id="1574470">//&nbsp;If&nbsp;d&nbsp;is&nbsp;negative,&nbsp;it&nbsp;is&nbsp;ignored.&nbsp;&nbsp;If&nbsp;the&nbsp;returned&nbsp;value&nbsp;would&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="1574548">//&nbsp;zero&nbsp;because&nbsp;of&nbsp;an&nbsp;overflow,&nbsp;MaxInt64&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span><span class="keyword" id="1574602">func</span>&nbsp;<span class="ident" id="1574607">when</span><span class="op" id="1574611">(</span><span class="ident" id="1574612">d</span>&nbsp;<span class="ident" id="1574614"><a href="/time/time.go.html#1594177">Duration</a></span><span class="op" id="1574622">)</span>&nbsp;<span class="ident" id="1574624">int64</span>&nbsp;<span class="op" id="1574630">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1574633">if</span>&nbsp;<span class="ident" id="1574636"><a href="/time/sleep.go.html#1574612">d</a></span>&nbsp;<span class="op" id="1574638">&lt;=</span>&nbsp;<span class="num" id="1574641">0</span>&nbsp;<span class="op" id="1574643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1574647">return</span>&nbsp;<span class="ident" id="1574654"><a href="/time/sleep.go.html#1574007">runtimeNano</a></span><span class="op" id="1574665">(</span><span class="op" id="1574666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1574669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1574672">t</span>&nbsp;<span class="op" id="1574674">:=</span>&nbsp;<span class="ident" id="1574677"><a href="/time/sleep.go.html#1574007">runtimeNano</a></span><span class="op" id="1574688">(</span><span class="op" id="1574689">)</span>&nbsp;<span class="op" id="1574691">+</span>&nbsp;<span class="ident" id="1574693">int64</span><span class="op" id="1574698">(</span><span class="ident" id="1574699"><a href="/time/sleep.go.html#1574612">d</a></span><span class="op" id="1574700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1574703">if</span>&nbsp;<span class="ident" id="1574706"><a href="/time/sleep.go.html#1574672">t</a></span>&nbsp;<span class="op" id="1574708">&lt;</span>&nbsp;<span class="num" id="1574710">0</span>&nbsp;<span class="op" id="1574712">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1574716"><a href="/time/sleep.go.html#1574672">t</a></span>&nbsp;<span class="op" id="1574718">=</span>&nbsp;<span class="num" id="1574720">1</span><span class="op" id="1574721">&lt;&lt;</span><span class="num" id="1574723">63</span>&nbsp;<span class="op" id="1574726">-</span>&nbsp;<span class="num" id="1574728">1</span>&nbsp;<span class="comment" id="1574730">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1574748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1574751">return</span>&nbsp;<span class="ident" id="1574758"><a href="/time/sleep.go.html#1574672">t</a></span><br>
<span class="lineno"></span><span class="op" id="1574760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="1574763">func</span>&nbsp;<span class="ident" id="1574768">startTimer</span><span class="op" id="1574778">(</span><span class="op" id="1574779">*</span><span class="ident" id="1574780"><a href="/time/sleep.go.html#1574149">runtimeTimer</a></span><span class="op" id="1574792">)</span><br>
<span class="lineno"></span><span class="keyword" id="1574794">func</span>&nbsp;<span class="ident" id="1574799">stopTimer</span><span class="op" id="1574808">(</span><span class="op" id="1574809">*</span><span class="ident" id="1574810"><a href="/time/sleep.go.html#1574149">runtimeTimer</a></span><span class="op" id="1574822">)</span>&nbsp;<span class="builtintype" id="1574824">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1574830">//&nbsp;The&nbsp;Timer&nbsp;type&nbsp;represents&nbsp;a&nbsp;single&nbsp;event.</span><br>
<span class="lineno"></span><span class="comment" id="1574875">//&nbsp;When&nbsp;the&nbsp;Timer&nbsp;expires,&nbsp;the&nbsp;current&nbsp;time&nbsp;will&nbsp;be&nbsp;sent&nbsp;on&nbsp;C,</span><br>
<span class="lineno">45</span><span class="comment" id="1574938">//&nbsp;unless&nbsp;the&nbsp;Timer&nbsp;was&nbsp;created&nbsp;by&nbsp;AfterFunc.</span><br>
<span class="lineno"></span><span class="comment" id="1574984">//&nbsp;A&nbsp;Timer&nbsp;must&nbsp;be&nbsp;created&nbsp;with&nbsp;NewTimer&nbsp;or&nbsp;AfterFunc.</span><br>
<span class="lineno"></span><span class="keyword" id="1575039">type</span>&nbsp;<span class="ident" id="1575044">Timer</span>&nbsp;<span class="keyword" id="1575050">struct</span>&nbsp;<span class="op" id="1575057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1575060">C</span>&nbsp;<span class="op" id="1575062">&lt;-</span><span class="keyword" id="1575064">chan</span>&nbsp;<span class="ident" id="1575069"><a href="/time/time.go.html#1582052">Time</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1575075">r</span>&nbsp;<span class="ident" id="1575077"><a href="/time/sleep.go.html#1574149">runtimeTimer</a></span><br>
<span class="lineno">50</span><span class="op" id="1575090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1575093">//&nbsp;Stop&nbsp;prevents&nbsp;the&nbsp;Timer&nbsp;from&nbsp;firing.</span><br>
<span class="lineno"></span><span class="comment" id="1575133">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;call&nbsp;stops&nbsp;the&nbsp;timer,&nbsp;false&nbsp;if&nbsp;the&nbsp;timer&nbsp;has&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="1575212">//&nbsp;expired&nbsp;or&nbsp;been&nbsp;stopped.</span><br>
<span class="lineno">55</span><span class="comment" id="1575240">//&nbsp;Stop&nbsp;does&nbsp;not&nbsp;close&nbsp;the&nbsp;channel,&nbsp;to&nbsp;prevent&nbsp;a&nbsp;read&nbsp;from&nbsp;the&nbsp;channel&nbsp;succeeding</span><br>
<span class="lineno"></span><span class="comment" id="1575322">//&nbsp;incorrectly.</span><br>
<span class="lineno"></span><span class="keyword" id="1575338">func</span>&nbsp;<span class="op" id="1575343">(</span><span class="ident" id="1575344">t</span>&nbsp;<span class="op" id="1575346">*</span><span class="ident" id="1575347"><a href="/time/sleep.go.html#1575044">Timer</a></span><span class="op" id="1575352">)</span>&nbsp;<span class="ident" id="1575354">Stop</span><span class="op" id="1575358">(</span><span class="op" id="1575359">)</span>&nbsp;<span class="builtintype" id="1575361">bool</span>&nbsp;<span class="op" id="1575366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1575369">if</span>&nbsp;<span class="ident" id="1575372"><a href="/time/sleep.go.html#1575344">t</a></span><span class="op" id="1575373">.</span><span class="ident" id="1575374">r</span><span class="op" id="1575375">.</span><span class="ident" id="1575376">f</span>&nbsp;<span class="op" id="1575378">==</span>&nbsp;<span class="ident" id="1575381">nil</span>&nbsp;<span class="op" id="1575385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1575389">panic</span><span class="op" id="1575394">(</span><span class="string" id="1575395">&#34;time:&nbsp;Stop&nbsp;called&nbsp;on&nbsp;uninitialized&nbsp;Timer&#34;</span><span class="op" id="1575437">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1575440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1575443">return</span>&nbsp;<span class="ident" id="1575450"><a href="/time/sleep.go.html#1574799">stopTimer</a></span><span class="op" id="1575459">(</span><span class="op" id="1575460">&amp;</span><span class="ident" id="1575461"><a href="/time/sleep.go.html#1575344">t</a></span><span class="op" id="1575462">.</span><span class="ident" id="1575463">r</span><span class="op" id="1575464">)</span><br>
<span class="lineno"></span><span class="op" id="1575466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1575469">//&nbsp;NewTimer&nbsp;creates&nbsp;a&nbsp;new&nbsp;Timer&nbsp;that&nbsp;will&nbsp;send</span><br>
<span class="lineno">65</span><span class="comment" id="1575516">//&nbsp;the&nbsp;current&nbsp;time&nbsp;on&nbsp;its&nbsp;channel&nbsp;after&nbsp;at&nbsp;least&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="keyword" id="1575578">func</span>&nbsp;<span class="ident" id="1575583">NewTimer</span><span class="op" id="1575591">(</span><span class="ident" id="1575592">d</span>&nbsp;<span class="ident" id="1575594"><a href="/time/time.go.html#1594177">Duration</a></span><span class="op" id="1575602">)</span>&nbsp;<span class="op" id="1575604">*</span><span class="ident" id="1575605"><a href="/time/sleep.go.html#1575044">Timer</a></span>&nbsp;<span class="op" id="1575611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1575614">c</span>&nbsp;<span class="op" id="1575616">:=</span>&nbsp;<span class="builtinfunc" id="1575619">make</span><span class="op" id="1575623">(</span><span class="keyword" id="1575624">chan</span>&nbsp;<span class="ident" id="1575629"><a href="/time/time.go.html#1582052">Time</a></span><span class="op" id="1575633">,</span>&nbsp;<span class="num" id="1575635">1</span><span class="op" id="1575636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1575639">t</span>&nbsp;<span class="op" id="1575641">:=</span>&nbsp;<span class="op" id="1575644">&amp;</span><span class="ident" id="1575645"><a href="/time/sleep.go.html#1575044">Timer</a></span><span class="op" id="1575650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1575654">C</span><span class="op" id="1575655">:</span>&nbsp;<span class="ident" id="1575657"><a href="/time/sleep.go.html#1575614">c</a></span><span class="op" id="1575658">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1575662">r</span><span class="op" id="1575663">:</span>&nbsp;<span class="ident" id="1575665"><a href="/time/sleep.go.html#1574149">runtimeTimer</a></span><span class="op" id="1575677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1575682">when</span><span class="op" id="1575686">:</span>&nbsp;<span class="ident" id="1575688"><a href="/time/sleep.go.html#1574607">when</a></span><span class="op" id="1575692">(</span><span class="ident" id="1575693"><a href="/time/sleep.go.html#1575592">d</a></span><span class="op" id="1575694">)</span><span class="op" id="1575695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1575700">f</span><span class="op" id="1575701">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1575706"><a href="/time/sleep.go.html#1576134">sendTime</a></span><span class="op" id="1575714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1575719">arg</span><span class="op" id="1575722">:</span>&nbsp;&nbsp;<span class="ident" id="1575725"><a href="/time/sleep.go.html#1575614">c</a></span><span class="op" id="1575726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1575730">}</span><span class="op" id="1575731">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1575734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1575737"><a href="/time/sleep.go.html#1574768">startTimer</a></span><span class="op" id="1575747">(</span><span class="op" id="1575748">&amp;</span><span class="ident" id="1575749"><a href="/time/sleep.go.html#1575639">t</a></span><span class="op" id="1575750">.</span><span class="ident" id="1575751">r</span><span class="op" id="1575752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1575755">return</span>&nbsp;<span class="ident" id="1575762"><a href="/time/sleep.go.html#1575639">t</a></span><br>
<span class="lineno"></span><span class="op" id="1575764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="1575767">//&nbsp;Reset&nbsp;changes&nbsp;the&nbsp;timer&nbsp;to&nbsp;expire&nbsp;after&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="comment" id="1575822">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;timer&nbsp;had&nbsp;been&nbsp;active,&nbsp;false&nbsp;if&nbsp;the&nbsp;timer&nbsp;had</span><br>
<span class="lineno"></span><span class="comment" id="1575894">//&nbsp;expired&nbsp;or&nbsp;been&nbsp;stopped.</span><br>
<span class="lineno"></span><span class="keyword" id="1575922">func</span>&nbsp;<span class="op" id="1575927">(</span><span class="ident" id="1575928">t</span>&nbsp;<span class="op" id="1575930">*</span><span class="ident" id="1575931"><a href="/time/sleep.go.html#1575044">Timer</a></span><span class="op" id="1575936">)</span>&nbsp;<span class="ident" id="1575938">Reset</span><span class="op" id="1575943">(</span><span class="ident" id="1575944">d</span>&nbsp;<span class="ident" id="1575946"><a href="/time/time.go.html#1594177">Duration</a></span><span class="op" id="1575954">)</span>&nbsp;<span class="builtintype" id="1575956">bool</span>&nbsp;<span class="op" id="1575961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1575964">if</span>&nbsp;<span class="ident" id="1575967"><a href="/time/sleep.go.html#1575928">t</a></span><span class="op" id="1575968">.</span><span class="ident" id="1575969">r</span><span class="op" id="1575970">.</span><span class="ident" id="1575971">f</span>&nbsp;<span class="op" id="1575973">==</span>&nbsp;<span class="ident" id="1575976">nil</span>&nbsp;<span class="op" id="1575980">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1575984">panic</span><span class="op" id="1575989">(</span><span class="string" id="1575990">&#34;time:&nbsp;Reset&nbsp;called&nbsp;on&nbsp;uninitialized&nbsp;Timer&#34;</span><span class="op" id="1576033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1576036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1576039">w</span>&nbsp;<span class="op" id="1576041">:=</span>&nbsp;<span class="ident" id="1576044"><a href="/time/sleep.go.html#1574607">when</a></span><span class="op" id="1576048">(</span><span class="ident" id="1576049"><a href="/time/sleep.go.html#1575944">d</a></span><span class="op" id="1576050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1576053">active</span>&nbsp;<span class="op" id="1576060">:=</span>&nbsp;<span class="ident" id="1576063"><a href="/time/sleep.go.html#1574799">stopTimer</a></span><span class="op" id="1576072">(</span><span class="op" id="1576073">&amp;</span><span class="ident" id="1576074"><a href="/time/sleep.go.html#1575928">t</a></span><span class="op" id="1576075">.</span><span class="ident" id="1576076">r</span><span class="op" id="1576077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1576080"><a href="/time/sleep.go.html#1575928">t</a></span><span class="op" id="1576081">.</span><span class="ident" id="1576082">r</span><span class="op" id="1576083">.</span><span class="ident" id="1576084">when</span>&nbsp;<span class="op" id="1576089">=</span>&nbsp;<span class="ident" id="1576091"><a href="/time/sleep.go.html#1576039">w</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1576094"><a href="/time/sleep.go.html#1574768">startTimer</a></span><span class="op" id="1576104">(</span><span class="op" id="1576105">&amp;</span><span class="ident" id="1576106"><a href="/time/sleep.go.html#1575928">t</a></span><span class="op" id="1576107">.</span><span class="ident" id="1576108">r</span><span class="op" id="1576109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1576112">return</span>&nbsp;<span class="ident" id="1576119"><a href="/time/sleep.go.html#1576053">active</a></span><br>
<span class="lineno"></span><span class="op" id="1576126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1576129">func</span>&nbsp;<span class="ident" id="1576134">sendTime</span><span class="op" id="1576142">(</span><span class="ident" id="1576143">c</span>&nbsp;<span class="keyword" id="1576145">interface</span><span class="op" id="1576154">{</span><span class="op" id="1576155">}</span><span class="op" id="1576156">,</span>&nbsp;<span class="ident" id="1576158">seq</span>&nbsp;<span class="builtintype" id="1576162">uintptr</span><span class="op" id="1576169">)</span>&nbsp;<span class="op" id="1576171">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1576174">//&nbsp;Non-blocking&nbsp;send&nbsp;of&nbsp;time&nbsp;on&nbsp;c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1576210">//&nbsp;Used&nbsp;in&nbsp;NewTimer,&nbsp;it&nbsp;cannot&nbsp;block&nbsp;anyway&nbsp;(buffer).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1576265">//&nbsp;Used&nbsp;in&nbsp;NewTicker,&nbsp;dropping&nbsp;sends&nbsp;on&nbsp;the&nbsp;floor&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1576319">//&nbsp;the&nbsp;desired&nbsp;behavior&nbsp;when&nbsp;the&nbsp;reader&nbsp;gets&nbsp;behind,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1576373">//&nbsp;because&nbsp;the&nbsp;sends&nbsp;are&nbsp;periodic.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1576409">select</span>&nbsp;<span class="op" id="1576416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1576419">case</span>&nbsp;<span class="ident" id="1576424"><a href="/time/sleep.go.html#1576143">c</a></span><span class="op" id="1576425">.</span><span class="op" id="1576426">(</span><span class="keyword" id="1576427">chan</span>&nbsp;<span class="ident" id="1576432"><a href="/time/time.go.html#1582052">Time</a></span><span class="op" id="1576436">)</span>&nbsp;<span class="op" id="1576438">&lt;-</span>&nbsp;<span class="ident" id="1576441"><a href="/time/time.go.html#1603053">Now</a></span><span class="op" id="1576444">(</span><span class="op" id="1576445">)</span><span class="op" id="1576446">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1576449">default</span><span class="op" id="1576456">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1576459">}</span><br>
<span class="lineno"></span><span class="op" id="1576461">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="1576464">//&nbsp;After&nbsp;waits&nbsp;for&nbsp;the&nbsp;duration&nbsp;to&nbsp;elapse&nbsp;and&nbsp;then&nbsp;sends&nbsp;the&nbsp;current&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="1576538">//&nbsp;on&nbsp;the&nbsp;returned&nbsp;channel.</span><br>
<span class="lineno"></span><span class="comment" id="1576566">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;NewTimer(d).C.</span><br>
<span class="lineno"></span><span class="keyword" id="1576604">func</span>&nbsp;<span class="ident" id="1576609">After</span><span class="op" id="1576614">(</span><span class="ident" id="1576615">d</span>&nbsp;<span class="ident" id="1576617"><a href="/time/time.go.html#1594177">Duration</a></span><span class="op" id="1576625">)</span>&nbsp;<span class="op" id="1576627">&lt;-</span><span class="keyword" id="1576629">chan</span>&nbsp;<span class="ident" id="1576634"><a href="/time/time.go.html#1582052">Time</a></span>&nbsp;<span class="op" id="1576639">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1576642">return</span>&nbsp;<span class="ident" id="1576649"><a href="/time/sleep.go.html#1575583">NewTimer</a></span><span class="op" id="1576657">(</span><span class="ident" id="1576658"><a href="/time/sleep.go.html#1576615">d</a></span><span class="op" id="1576659">)</span><span class="op" id="1576660">.</span><span class="ident" id="1576661">C</span><br>
<span class="lineno"></span><span class="op" id="1576663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1576666">//&nbsp;AfterFunc&nbsp;waits&nbsp;for&nbsp;the&nbsp;duration&nbsp;to&nbsp;elapse&nbsp;and&nbsp;then&nbsp;calls&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="1576729">//&nbsp;in&nbsp;its&nbsp;own&nbsp;goroutine.&nbsp;It&nbsp;returns&nbsp;a&nbsp;Timer&nbsp;that&nbsp;can</span><br>
<span class="lineno">115</span><span class="comment" id="1576782">//&nbsp;be&nbsp;used&nbsp;to&nbsp;cancel&nbsp;the&nbsp;call&nbsp;using&nbsp;its&nbsp;Stop&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1576835">func</span>&nbsp;<span class="ident" id="1576840">AfterFunc</span><span class="op" id="1576849">(</span><span class="ident" id="1576850">d</span>&nbsp;<span class="ident" id="1576852"><a href="/time/time.go.html#1594177">Duration</a></span><span class="op" id="1576860">,</span>&nbsp;<span class="ident" id="1576862">f</span>&nbsp;<span class="keyword" id="1576864">func</span><span class="op" id="1576868">(</span><span class="op" id="1576869">)</span><span class="op" id="1576870">)</span>&nbsp;<span class="op" id="1576872">*</span><span class="ident" id="1576873"><a href="/time/sleep.go.html#1575044">Timer</a></span>&nbsp;<span class="op" id="1576879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1576882">t</span>&nbsp;<span class="op" id="1576884">:=</span>&nbsp;<span class="op" id="1576887">&amp;</span><span class="ident" id="1576888"><a href="/time/sleep.go.html#1575044">Timer</a></span><span class="op" id="1576893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1576897">r</span><span class="op" id="1576898">:</span>&nbsp;<span class="ident" id="1576900"><a href="/time/sleep.go.html#1574149">runtimeTimer</a></span><span class="op" id="1576912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1576917">when</span><span class="op" id="1576921">:</span>&nbsp;<span class="ident" id="1576923"><a href="/time/sleep.go.html#1574607">when</a></span><span class="op" id="1576927">(</span><span class="ident" id="1576928"><a href="/time/sleep.go.html#1576850">d</a></span><span class="op" id="1576929">)</span><span class="op" id="1576930">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1576935">f</span><span class="op" id="1576936">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1576941"><a href="/time/sleep.go.html#1577005">goFunc</a></span><span class="op" id="1576947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1576952">arg</span><span class="op" id="1576955">:</span>&nbsp;&nbsp;<span class="ident" id="1576958"><a href="/time/sleep.go.html#1576862">f</a></span><span class="op" id="1576959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1576963">}</span><span class="op" id="1576964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1576967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1576970"><a href="/time/sleep.go.html#1574768">startTimer</a></span><span class="op" id="1576980">(</span><span class="op" id="1576981">&amp;</span><span class="ident" id="1576982"><a href="/time/sleep.go.html#1576882">t</a></span><span class="op" id="1576983">.</span><span class="ident" id="1576984">r</span><span class="op" id="1576985">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1576988">return</span>&nbsp;<span class="ident" id="1576995"><a href="/time/sleep.go.html#1576882">t</a></span><br>
<span class="lineno"></span><span class="op" id="1576997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1577000">func</span>&nbsp;<span class="ident" id="1577005">goFunc</span><span class="op" id="1577011">(</span><span class="ident" id="1577012">arg</span>&nbsp;<span class="keyword" id="1577016">interface</span><span class="op" id="1577025">{</span><span class="op" id="1577026">}</span><span class="op" id="1577027">,</span>&nbsp;<span class="ident" id="1577029">seq</span>&nbsp;<span class="builtintype" id="1577033">uintptr</span><span class="op" id="1577040">)</span>&nbsp;<span class="op" id="1577042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1577045">go</span>&nbsp;<span class="ident" id="1577048"><a href="/time/sleep.go.html#1577012">arg</a></span><span class="op" id="1577051">.</span><span class="op" id="1577052">(</span><span class="keyword" id="1577053">func</span><span class="op" id="1577057">(</span><span class="op" id="1577058">)</span><span class="op" id="1577059">)</span><span class="op" id="1577060">(</span><span class="op" id="1577061">)</span><br>
<span class="lineno">130</span><span class="op" id="1577063">}</span>
</div>
</body>
</html>
