<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/asm8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/asm8/bare_func.go.html">bare_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_file.go.html">build_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_func.go.html">build_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_lib.go.html">build_lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_var.go.html">build_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/builder.go.html">builder.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/check_type.go.html">check_type.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_hex.go.html">data_hex.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_nums.go.html">data_nums.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_str.go.html">data_str.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/file.go.html">file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_decl.go.html">func_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_stmt.go.html">func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst.go.html">inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all.go.html">lex_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all_test.go.html">lex_all_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_comment.go.html">lex_comment.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_operand.go.html">lex_operand.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_string.go.html">lex_string.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lib.go.html">lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/package.go.html">package.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_arg.go.html">parse_arg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_file.go.html">parse_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func.go.html">parse_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_stmt.go.html">parse_func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_test.go.html">parse_func_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_inst.go.html">parse_inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_label.go.html">parse_label.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_reg.go.html">parse_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_sym.go.html">parse_sym.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var.go.html">parse_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var_stmt.go.html">parse_var_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parser.go.html">parser.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/single_file.go.html">single_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/stmt_lexer.go.html">stmt_lexer.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_scope.go.html">sym_scope.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_table.go.html">sym_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/symbol.go.html">symbol.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/token.go.html">token.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_decl.go.html">var_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_stmt.go.html">var_stmt.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="3653119">package</span>&nbsp;<span class="ident" id="3653127">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3653133">import</span>&nbsp;<span class="op" id="3653140">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3653143">&#34;lonnie.io/e8vm/lex8&#34;</span><br>
<span class="lineno">5</span><span class="op" id="3653165">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3653168">func</span>&nbsp;<span class="ident" id="3653173">parseOps</span><span class="op" id="3653181">(</span><span class="ident" id="3653182">p</span>&nbsp;<span class="op" id="3653184">*</span><span class="ident" id="3653185">parser</span><span class="op" id="3653191">)</span>&nbsp;<span class="op" id="3653193">(</span><span class="ident" id="3653194">ops</span>&nbsp;<span class="op" id="3653198">[</span><span class="op" id="3653199">]</span><span class="op" id="3653200">*</span><span class="ident" id="3653201">lex8</span><span class="op" id="3653205">.</span><span class="ident" id="3653206">Token</span><span class="op" id="3653211">)</span>&nbsp;<span class="op" id="3653213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653216">for</span>&nbsp;<span class="op" id="3653220">!</span><span class="ident" id="3653221">p</span><span class="op" id="3653222">.</span><span class="ident" id="3653223">acceptType</span><span class="op" id="3653233">(</span><span class="ident" id="3653234">Semi</span><span class="op" id="3653238">)</span>&nbsp;<span class="op" id="3653240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653244">t</span>&nbsp;<span class="op" id="3653246">:=</span>&nbsp;<span class="ident" id="3653249">p</span><span class="op" id="3653250">.</span><span class="ident" id="3653251">expect</span><span class="op" id="3653257">(</span><span class="ident" id="3653258">Operand</span><span class="op" id="3653265">)</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653269">if</span>&nbsp;<span class="ident" id="3653272">t</span>&nbsp;<span class="op" id="3653274">!=</span>&nbsp;<span class="ident" id="3653277">nil</span>&nbsp;<span class="op" id="3653281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653286">ops</span>&nbsp;<span class="op" id="3653290">=</span>&nbsp;<span class="builtinfunc" id="3653292">append</span><span class="op" id="3653298">(</span><span class="ident" id="3653299">ops</span><span class="op" id="3653302">,</span>&nbsp;<span class="ident" id="3653304">t</span><span class="op" id="3653305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653309">}</span>&nbsp;<span class="keyword" id="3653311">else</span>&nbsp;<span class="op" id="3653316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653321">ops</span>&nbsp;<span class="op" id="3653325">=</span>&nbsp;<span class="ident" id="3653327">nil</span>&nbsp;<span class="comment" id="3653331">//&nbsp;error&nbsp;now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653347">if</span>&nbsp;<span class="ident" id="3653350">p</span><span class="op" id="3653351">.</span><span class="ident" id="3653352">see</span><span class="op" id="3653355">(</span><span class="ident" id="3653356">lex8</span><span class="op" id="3653360">.</span><span class="ident" id="3653361">EOF</span><span class="op" id="3653364">)</span>&nbsp;<span class="op" id="3653366">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653372">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653386">p</span><span class="op" id="3653387">.</span><span class="ident" id="3653388">next</span><span class="op" id="3653392">(</span><span class="op" id="3653393">)</span>&nbsp;<span class="comment" id="3653395">//&nbsp;proceed&nbsp;anyway&nbsp;for&nbsp;other&nbsp;stuff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653434">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653438">p</span><span class="op" id="3653439">.</span><span class="ident" id="3653440">clearErr</span><span class="op" id="3653448">(</span><span class="op" id="3653449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653452">return</span>&nbsp;<span class="ident" id="3653459">ops</span><br>
<span class="lineno"></span><span class="op" id="3653463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3653466">func</span>&nbsp;<span class="ident" id="3653471">parseFuncStmt</span><span class="op" id="3653484">(</span><span class="ident" id="3653485">p</span>&nbsp;<span class="op" id="3653487">*</span><span class="ident" id="3653488">parser</span><span class="op" id="3653494">)</span>&nbsp;<span class="op" id="3653496">*</span><span class="ident" id="3653497">funcStmt</span>&nbsp;<span class="op" id="3653506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653509">ops</span>&nbsp;<span class="op" id="3653513">:=</span>&nbsp;<span class="ident" id="3653516">parseOps</span><span class="op" id="3653524">(</span><span class="ident" id="3653525">p</span><span class="op" id="3653526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653529">if</span>&nbsp;<span class="builtinfunc" id="3653532">len</span><span class="op" id="3653535">(</span><span class="ident" id="3653536">ops</span><span class="op" id="3653539">)</span>&nbsp;<span class="op" id="3653541">==</span>&nbsp;<span class="num" id="3653544">0</span>&nbsp;<span class="op" id="3653546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653550">return</span>&nbsp;<span class="ident" id="3653557">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653562">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653566">op0</span>&nbsp;<span class="op" id="3653570">:=</span>&nbsp;<span class="ident" id="3653573">ops</span><span class="op" id="3653576">[</span><span class="num" id="3653577">0</span><span class="op" id="3653578">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653581">lead</span>&nbsp;<span class="op" id="3653586">:=</span>&nbsp;<span class="ident" id="3653589">op0</span><span class="op" id="3653592">.</span><span class="ident" id="3653593">Lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653598">if</span>&nbsp;<span class="ident" id="3653601">lead</span>&nbsp;<span class="op" id="3653606">==</span>&nbsp;<span class="string" id="3653609">&#34;&#34;</span>&nbsp;<span class="op" id="3653612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3653616">panic</span><span class="op" id="3653621">(</span><span class="string" id="3653622">&#34;empty&nbsp;operand&#34;</span><span class="op" id="3653637">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653644">if</span>&nbsp;<span class="ident" id="3653647">parseLabel</span><span class="op" id="3653657">(</span><span class="ident" id="3653658">p</span><span class="op" id="3653659">,</span>&nbsp;<span class="ident" id="3653661">op0</span><span class="op" id="3653664">)</span>&nbsp;<span class="op" id="3653666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653670">if</span>&nbsp;<span class="builtinfunc" id="3653673">len</span><span class="op" id="3653676">(</span><span class="ident" id="3653677">ops</span><span class="op" id="3653680">)</span>&nbsp;<span class="op" id="3653682">&gt;</span>&nbsp;<span class="num" id="3653684">1</span>&nbsp;<span class="op" id="3653686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3653691">p</span><span class="op" id="3653692">.</span><span class="ident" id="3653693">err</span><span class="op" id="3653696">(</span><span class="ident" id="3653697">op0</span><span class="op" id="3653700">.</span><span class="ident" id="3653701">Pos</span><span class="op" id="3653704">,</span>&nbsp;<span class="string" id="3653706">&#34;label&nbsp;should&nbsp;take&nbsp;the&nbsp;entire&nbsp;line&#34;</span><span class="op" id="3653741">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653746">return</span>&nbsp;<span class="ident" id="3653753">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653763">return</span>&nbsp;<span class="op" id="3653770">&amp;</span><span class="ident" id="3653771">funcStmt</span><span class="op" id="3653779">{</span><span class="ident" id="3653780">label</span><span class="op" id="3653785">:</span>&nbsp;<span class="ident" id="3653787">lead</span><span class="op" id="3653791">,</span>&nbsp;<span class="ident" id="3653793">ops</span><span class="op" id="3653796">:</span>&nbsp;<span class="ident" id="3653798">ops</span><span class="op" id="3653801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3653804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3653808">return</span>&nbsp;<span class="op" id="3653815">&amp;</span><span class="ident" id="3653816">funcStmt</span><span class="op" id="3653824">{</span><span class="ident" id="3653825">inst</span><span class="op" id="3653829">:</span>&nbsp;<span class="ident" id="3653831">parseInst</span><span class="op" id="3653840">(</span><span class="ident" id="3653841">p</span><span class="op" id="3653842">,</span>&nbsp;<span class="ident" id="3653844">ops</span><span class="op" id="3653847">)</span><span class="op" id="3653848">,</span>&nbsp;<span class="ident" id="3653850">ops</span><span class="op" id="3653853">:</span>&nbsp;<span class="ident" id="3653855">ops</span><span class="op" id="3653858">}</span><br>
<span class="lineno"></span><span class="op" id="3653860">}</span>
</div>
</body>
</html>
