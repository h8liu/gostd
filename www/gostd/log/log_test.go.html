<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6788084">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6788139">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6788193">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6788244">package</span>&nbsp;<span class="ident" id="6788252">log</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6788257">//&nbsp;These&nbsp;tests&nbsp;are&nbsp;too&nbsp;simple.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6788289">import</span>&nbsp;<span class="op" id="6788296">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6788299">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6788308">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6788314">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6788324">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6788334">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6788337">const</span>&nbsp;<span class="op" id="6788343">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788346">Rdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6788360">=</span>&nbsp;<span class="string" id="6788362">`[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788408">Rtime</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6788422">=</span>&nbsp;<span class="string" id="6788424">`[0-9][0-9]:[0-9][0-9]:[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788460">Rmicroseconds</span>&nbsp;<span class="op" id="6788474">=</span>&nbsp;<span class="string" id="6788476">`\.[0-9][0-9][0-9][0-9][0-9][0-9]`</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788512">Rline</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6788526">=</span>&nbsp;<span class="string" id="6788528">`(54|56):`</span>&nbsp;<span class="comment" id="6788539">//&nbsp;must&nbsp;update&nbsp;if&nbsp;the&nbsp;calls&nbsp;to&nbsp;l.Printf&nbsp;/&nbsp;l.Print&nbsp;below&nbsp;move</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788601">Rlongfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6788615">=</span>&nbsp;<span class="string" id="6788617">`.*/[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="6788643">+</span>&nbsp;<span class="ident" id="6788645">Rline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788652">Rshortfile</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6788666">=</span>&nbsp;<span class="string" id="6788668">`[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="6788691">+</span>&nbsp;<span class="ident" id="6788693">Rline</span><br>
<span class="lineno"></span><span class="op" id="6788699">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="6788702">type</span>&nbsp;<span class="ident" id="6788707">tester</span>&nbsp;<span class="keyword" id="6788714">struct</span>&nbsp;<span class="op" id="6788721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788724">flag</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6788732">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788737">prefix</span>&nbsp;&nbsp;<span class="builtintype" id="6788745">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788753">pattern</span>&nbsp;<span class="builtintype" id="6788761">string</span>&nbsp;<span class="comment" id="6788768">//&nbsp;regexp&nbsp;that&nbsp;log&nbsp;output&nbsp;must&nbsp;match;&nbsp;we&nbsp;add&nbsp;^&nbsp;and&nbsp;expected_text$&nbsp;always</span><br>
<span class="lineno"></span><span class="op" id="6788841">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="6788844">var</span>&nbsp;<span class="ident" id="6788848">tests</span>&nbsp;<span class="op" id="6788854">=</span>&nbsp;<span class="op" id="6788856">[</span><span class="op" id="6788857">]</span><span class="ident" id="6788858">tester</span><span class="op" id="6788864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6788867">//&nbsp;individual&nbsp;pieces:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788890">{</span><span class="num" id="6788891">0</span><span class="op" id="6788892">,</span>&nbsp;<span class="string" id="6788894">&#34;&#34;</span><span class="op" id="6788896">,</span>&nbsp;<span class="string" id="6788898">&#34;&#34;</span><span class="op" id="6788900">}</span><span class="op" id="6788901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788904">{</span><span class="num" id="6788905">0</span><span class="op" id="6788906">,</span>&nbsp;<span class="string" id="6788908">&#34;XXX&#34;</span><span class="op" id="6788913">,</span>&nbsp;<span class="string" id="6788915">&#34;XXX&#34;</span><span class="op" id="6788920">}</span><span class="op" id="6788921">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788924">{</span><span class="ident" id="6788925">Ldate</span><span class="op" id="6788930">,</span>&nbsp;<span class="string" id="6788932">&#34;&#34;</span><span class="op" id="6788934">,</span>&nbsp;<span class="ident" id="6788936">Rdate</span>&nbsp;<span class="op" id="6788942">+</span>&nbsp;<span class="string" id="6788944">&#34;&nbsp;&#34;</span><span class="op" id="6788947">}</span><span class="op" id="6788948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788951">{</span><span class="ident" id="6788952">Ltime</span><span class="op" id="6788957">,</span>&nbsp;<span class="string" id="6788959">&#34;&#34;</span><span class="op" id="6788961">,</span>&nbsp;<span class="ident" id="6788963">Rtime</span>&nbsp;<span class="op" id="6788969">+</span>&nbsp;<span class="string" id="6788971">&#34;&nbsp;&#34;</span><span class="op" id="6788974">}</span><span class="op" id="6788975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788978">{</span><span class="ident" id="6788979">Ltime</span>&nbsp;<span class="op" id="6788985">|</span>&nbsp;<span class="ident" id="6788987">Lmicroseconds</span><span class="op" id="6789000">,</span>&nbsp;<span class="string" id="6789002">&#34;&#34;</span><span class="op" id="6789004">,</span>&nbsp;<span class="ident" id="6789006">Rtime</span>&nbsp;<span class="op" id="6789012">+</span>&nbsp;<span class="ident" id="6789014">Rmicroseconds</span>&nbsp;<span class="op" id="6789028">+</span>&nbsp;<span class="string" id="6789030">&#34;&nbsp;&#34;</span><span class="op" id="6789033">}</span><span class="op" id="6789034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6789037">{</span><span class="ident" id="6789038">Lmicroseconds</span><span class="op" id="6789051">,</span>&nbsp;<span class="string" id="6789053">&#34;&#34;</span><span class="op" id="6789055">,</span>&nbsp;<span class="ident" id="6789057">Rtime</span>&nbsp;<span class="op" id="6789063">+</span>&nbsp;<span class="ident" id="6789065">Rmicroseconds</span>&nbsp;<span class="op" id="6789079">+</span>&nbsp;<span class="string" id="6789081">&#34;&nbsp;&#34;</span><span class="op" id="6789084">}</span><span class="op" id="6789085">,</span>&nbsp;<span class="comment" id="6789087">//&nbsp;microsec&nbsp;implies&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6789113">{</span><span class="ident" id="6789114">Llongfile</span><span class="op" id="6789123">,</span>&nbsp;<span class="string" id="6789125">&#34;&#34;</span><span class="op" id="6789127">,</span>&nbsp;<span class="ident" id="6789129">Rlongfile</span>&nbsp;<span class="op" id="6789139">+</span>&nbsp;<span class="string" id="6789141">&#34;&nbsp;&#34;</span><span class="op" id="6789144">}</span><span class="op" id="6789145">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6789148">{</span><span class="ident" id="6789149">Lshortfile</span><span class="op" id="6789159">,</span>&nbsp;<span class="string" id="6789161">&#34;&#34;</span><span class="op" id="6789163">,</span>&nbsp;<span class="ident" id="6789165">Rshortfile</span>&nbsp;<span class="op" id="6789176">+</span>&nbsp;<span class="string" id="6789178">&#34;&nbsp;&#34;</span><span class="op" id="6789181">}</span><span class="op" id="6789182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6789185">{</span><span class="ident" id="6789186">Llongfile</span>&nbsp;<span class="op" id="6789196">|</span>&nbsp;<span class="ident" id="6789198">Lshortfile</span><span class="op" id="6789208">,</span>&nbsp;<span class="string" id="6789210">&#34;&#34;</span><span class="op" id="6789212">,</span>&nbsp;<span class="ident" id="6789214">Rshortfile</span>&nbsp;<span class="op" id="6789225">+</span>&nbsp;<span class="string" id="6789227">&#34;&nbsp;&#34;</span><span class="op" id="6789230">}</span><span class="op" id="6789231">,</span>&nbsp;<span class="comment" id="6789233">//&nbsp;shortfile&nbsp;overrides&nbsp;longfile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6789266">//&nbsp;everything&nbsp;at&nbsp;once:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6789290">{</span><span class="ident" id="6789291">Ldate</span>&nbsp;<span class="op" id="6789297">|</span>&nbsp;<span class="ident" id="6789299">Ltime</span>&nbsp;<span class="op" id="6789305">|</span>&nbsp;<span class="ident" id="6789307">Lmicroseconds</span>&nbsp;<span class="op" id="6789321">|</span>&nbsp;<span class="ident" id="6789323">Llongfile</span><span class="op" id="6789332">,</span>&nbsp;<span class="string" id="6789334">&#34;XXX&#34;</span><span class="op" id="6789339">,</span>&nbsp;<span class="string" id="6789341">&#34;XXX&#34;</span>&nbsp;<span class="op" id="6789347">+</span>&nbsp;<span class="ident" id="6789349">Rdate</span>&nbsp;<span class="op" id="6789355">+</span>&nbsp;<span class="string" id="6789357">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6789361">+</span>&nbsp;<span class="ident" id="6789363">Rtime</span>&nbsp;<span class="op" id="6789369">+</span>&nbsp;<span class="ident" id="6789371">Rmicroseconds</span>&nbsp;<span class="op" id="6789385">+</span>&nbsp;<span class="string" id="6789387">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6789391">+</span>&nbsp;<span class="ident" id="6789393">Rlongfile</span>&nbsp;<span class="op" id="6789403">+</span>&nbsp;<span class="string" id="6789405">&#34;&nbsp;&#34;</span><span class="op" id="6789408">}</span><span class="op" id="6789409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6789412">{</span><span class="ident" id="6789413">Ldate</span>&nbsp;<span class="op" id="6789419">|</span>&nbsp;<span class="ident" id="6789421">Ltime</span>&nbsp;<span class="op" id="6789427">|</span>&nbsp;<span class="ident" id="6789429">Lmicroseconds</span>&nbsp;<span class="op" id="6789443">|</span>&nbsp;<span class="ident" id="6789445">Lshortfile</span><span class="op" id="6789455">,</span>&nbsp;<span class="string" id="6789457">&#34;XXX&#34;</span><span class="op" id="6789462">,</span>&nbsp;<span class="string" id="6789464">&#34;XXX&#34;</span>&nbsp;<span class="op" id="6789470">+</span>&nbsp;<span class="ident" id="6789472">Rdate</span>&nbsp;<span class="op" id="6789478">+</span>&nbsp;<span class="string" id="6789480">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6789484">+</span>&nbsp;<span class="ident" id="6789486">Rtime</span>&nbsp;<span class="op" id="6789492">+</span>&nbsp;<span class="ident" id="6789494">Rmicroseconds</span>&nbsp;<span class="op" id="6789508">+</span>&nbsp;<span class="string" id="6789510">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6789514">+</span>&nbsp;<span class="ident" id="6789516">Rshortfile</span>&nbsp;<span class="op" id="6789527">+</span>&nbsp;<span class="string" id="6789529">&#34;&nbsp;&#34;</span><span class="op" id="6789532">}</span><span class="op" id="6789533">,</span><br>
<span class="lineno">45</span><span class="op" id="6789535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6789538">//&nbsp;Test&nbsp;using&nbsp;Println(&#34;hello&#34;,&nbsp;23,&nbsp;&#34;world&#34;)&nbsp;or&nbsp;using&nbsp;Printf(&#34;hello&nbsp;%d&nbsp;world&#34;,&nbsp;23)</span><br>
<span class="lineno"></span><span class="keyword" id="6789620">func</span>&nbsp;<span class="ident" id="6789625">testPrint</span><span class="op" id="6789634">(</span><span class="ident" id="6789635">t</span>&nbsp;<span class="op" id="6789637">*</span><span class="ident" id="6789638">testing</span><span class="op" id="6789645">.</span><span class="ident" id="6789646">T</span><span class="op" id="6789647">,</span>&nbsp;<span class="ident" id="6789649">flag</span>&nbsp;<span class="builtintype" id="6789654">int</span><span class="op" id="6789657">,</span>&nbsp;<span class="ident" id="6789659">prefix</span>&nbsp;<span class="builtintype" id="6789666">string</span><span class="op" id="6789672">,</span>&nbsp;<span class="ident" id="6789674">pattern</span>&nbsp;<span class="builtintype" id="6789682">string</span><span class="op" id="6789688">,</span>&nbsp;<span class="ident" id="6789690">useFormat</span>&nbsp;<span class="builtintype" id="6789700">bool</span><span class="op" id="6789704">)</span>&nbsp;<span class="op" id="6789706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789709">buf</span>&nbsp;<span class="op" id="6789713">:=</span>&nbsp;<span class="builtinfunc" id="6789716">new</span><span class="op" id="6789719">(</span><span class="ident" id="6789720">bytes</span><span class="op" id="6789725">.</span><span class="ident" id="6789726">Buffer</span><span class="op" id="6789732">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789735">SetOutput</span><span class="op" id="6789744">(</span><span class="ident" id="6789745">buf</span><span class="op" id="6789748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789751">SetFlags</span><span class="op" id="6789759">(</span><span class="ident" id="6789760">flag</span><span class="op" id="6789764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789767">SetPrefix</span><span class="op" id="6789776">(</span><span class="ident" id="6789777">prefix</span><span class="op" id="6789783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6789786">if</span>&nbsp;<span class="ident" id="6789789">useFormat</span>&nbsp;<span class="op" id="6789799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789803">Printf</span><span class="op" id="6789809">(</span><span class="string" id="6789810">&#34;hello&nbsp;%d&nbsp;world&#34;</span><span class="op" id="6789826">,</span>&nbsp;<span class="num" id="6789828">23</span><span class="op" id="6789830">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6789833">}</span>&nbsp;<span class="keyword" id="6789835">else</span>&nbsp;<span class="op" id="6789840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789844">Println</span><span class="op" id="6789851">(</span><span class="string" id="6789852">&#34;hello&#34;</span><span class="op" id="6789859">,</span>&nbsp;<span class="num" id="6789861">23</span><span class="op" id="6789863">,</span>&nbsp;<span class="string" id="6789865">&#34;world&#34;</span><span class="op" id="6789872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6789875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789878">line</span>&nbsp;<span class="op" id="6789883">:=</span>&nbsp;<span class="ident" id="6789886">buf</span><span class="op" id="6789889">.</span><span class="ident" id="6789890">String</span><span class="op" id="6789896">(</span><span class="op" id="6789897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789900">line</span>&nbsp;<span class="op" id="6789905">=</span>&nbsp;<span class="ident" id="6789907">line</span><span class="op" id="6789911">[</span><span class="num" id="6789912">0</span>&nbsp;<span class="op" id="6789914">:</span>&nbsp;<span class="builtinfunc" id="6789916">len</span><span class="op" id="6789919">(</span><span class="ident" id="6789920">line</span><span class="op" id="6789924">)</span><span class="op" id="6789925">-</span><span class="num" id="6789926">1</span><span class="op" id="6789927">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789930">pattern</span>&nbsp;<span class="op" id="6789938">=</span>&nbsp;<span class="string" id="6789940">&#34;^&#34;</span>&nbsp;<span class="op" id="6789944">+</span>&nbsp;<span class="ident" id="6789946">pattern</span>&nbsp;<span class="op" id="6789954">+</span>&nbsp;<span class="string" id="6789956">&#34;hello&nbsp;23&nbsp;world$&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789975">matched</span><span class="op" id="6789982">,</span>&nbsp;<span class="ident" id="6789984">err4</span>&nbsp;<span class="op" id="6789989">:=</span>&nbsp;<span class="ident" id="6789992">regexp</span><span class="op" id="6789998">.</span><span class="ident" id="6789999">MatchString</span><span class="op" id="6790010">(</span><span class="ident" id="6790011">pattern</span><span class="op" id="6790018">,</span>&nbsp;<span class="ident" id="6790020">line</span><span class="op" id="6790024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6790027">if</span>&nbsp;<span class="ident" id="6790030">err4</span>&nbsp;<span class="op" id="6790035">!=</span>&nbsp;<span class="ident" id="6790038">nil</span>&nbsp;<span class="op" id="6790042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6790046">t</span><span class="op" id="6790047">.</span><span class="ident" id="6790048">Fatal</span><span class="op" id="6790053">(</span><span class="string" id="6790054">&#34;pattern&nbsp;did&nbsp;not&nbsp;compile:&#34;</span><span class="op" id="6790080">,</span>&nbsp;<span class="ident" id="6790082">err4</span><span class="op" id="6790086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6790089">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6790092">if</span>&nbsp;<span class="op" id="6790095">!</span><span class="ident" id="6790096">matched</span>&nbsp;<span class="op" id="6790104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6790108">t</span><span class="op" id="6790109">.</span><span class="ident" id="6790110">Errorf</span><span class="op" id="6790116">(</span><span class="string" id="6790117">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="6790151">,</span>&nbsp;<span class="ident" id="6790153">pattern</span><span class="op" id="6790160">,</span>&nbsp;<span class="ident" id="6790162">line</span><span class="op" id="6790166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6790169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6790172">SetOutput</span><span class="op" id="6790181">(</span><span class="ident" id="6790182">os</span><span class="op" id="6790184">.</span><span class="ident" id="6790185">Stderr</span><span class="op" id="6790191">)</span><br>
<span class="lineno"></span><span class="op" id="6790193">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="6790196">func</span>&nbsp;<span class="ident" id="6790201">TestAll</span><span class="op" id="6790208">(</span><span class="ident" id="6790209">t</span>&nbsp;<span class="op" id="6790211">*</span><span class="ident" id="6790212">testing</span><span class="op" id="6790219">.</span><span class="ident" id="6790220">T</span><span class="op" id="6790221">)</span>&nbsp;<span class="op" id="6790223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6790226">for</span>&nbsp;<span class="ident" id="6790230">_</span><span class="op" id="6790231">,</span>&nbsp;<span class="ident" id="6790233">testcase</span>&nbsp;<span class="op" id="6790242">:=</span>&nbsp;<span class="keyword" id="6790245">range</span>&nbsp;<span class="ident" id="6790251">tests</span>&nbsp;<span class="op" id="6790257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6790261">testPrint</span><span class="op" id="6790270">(</span><span class="ident" id="6790271">t</span><span class="op" id="6790272">,</span>&nbsp;<span class="ident" id="6790274">testcase</span><span class="op" id="6790282">.</span><span class="ident" id="6790283">flag</span><span class="op" id="6790287">,</span>&nbsp;<span class="ident" id="6790289">testcase</span><span class="op" id="6790297">.</span><span class="ident" id="6790298">prefix</span><span class="op" id="6790304">,</span>&nbsp;<span class="ident" id="6790306">testcase</span><span class="op" id="6790314">.</span><span class="ident" id="6790315">pattern</span><span class="op" id="6790322">,</span>&nbsp;<span class="builtintype" id="6790324">false</span><span class="op" id="6790329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6790333">testPrint</span><span class="op" id="6790342">(</span><span class="ident" id="6790343">t</span><span class="op" id="6790344">,</span>&nbsp;<span class="ident" id="6790346">testcase</span><span class="op" id="6790354">.</span><span class="ident" id="6790355">flag</span><span class="op" id="6790359">,</span>&nbsp;<span class="ident" id="6790361">testcase</span><span class="op" id="6790369">.</span><span class="ident" id="6790370">prefix</span><span class="op" id="6790376">,</span>&nbsp;<span class="ident" id="6790378">testcase</span><span class="op" id="6790386">.</span><span class="ident" id="6790387">pattern</span><span class="op" id="6790394">,</span>&nbsp;<span class="builtintype" id="6790396">true</span><span class="op" id="6790400">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6790403">}</span><br>
<span class="lineno"></span><span class="op" id="6790405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6790408">func</span>&nbsp;<span class="ident" id="6790413">TestOutput</span><span class="op" id="6790423">(</span><span class="ident" id="6790424">t</span>&nbsp;<span class="op" id="6790426">*</span><span class="ident" id="6790427">testing</span><span class="op" id="6790434">.</span><span class="ident" id="6790435">T</span><span class="op" id="6790436">)</span>&nbsp;<span class="op" id="6790438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6790441">const</span>&nbsp;<span class="ident" id="6790447">testString</span>&nbsp;<span class="op" id="6790458">=</span>&nbsp;<span class="string" id="6790460">&#34;test&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6790468">var</span>&nbsp;<span class="ident" id="6790472">b</span>&nbsp;<span class="ident" id="6790474">bytes</span><span class="op" id="6790479">.</span><span class="ident" id="6790480">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6790488">l</span>&nbsp;<span class="op" id="6790490">:=</span>&nbsp;<span class="ident" id="6790493">New</span><span class="op" id="6790496">(</span><span class="op" id="6790497">&amp;</span><span class="ident" id="6790498">b</span><span class="op" id="6790499">,</span>&nbsp;<span class="string" id="6790501">&#34;&#34;</span><span class="op" id="6790503">,</span>&nbsp;<span class="num" id="6790505">0</span><span class="op" id="6790506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6790509">l</span><span class="op" id="6790510">.</span><span class="ident" id="6790511">Println</span><span class="op" id="6790518">(</span><span class="ident" id="6790519">testString</span><span class="op" id="6790529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6790532">if</span>&nbsp;<span class="ident" id="6790535">expect</span>&nbsp;<span class="op" id="6790542">:=</span>&nbsp;<span class="ident" id="6790545">testString</span>&nbsp;<span class="op" id="6790556">+</span>&nbsp;<span class="string" id="6790558">&#34;\n&#34;</span><span class="op" id="6790562">;</span>&nbsp;<span class="ident" id="6790564">b</span><span class="op" id="6790565">.</span><span class="ident" id="6790566">String</span><span class="op" id="6790572">(</span><span class="op" id="6790573">)</span>&nbsp;<span class="op" id="6790575">!=</span>&nbsp;<span class="ident" id="6790578">expect</span>&nbsp;<span class="op" id="6790585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6790589">t</span><span class="op" id="6790590">.</span><span class="ident" id="6790591">Errorf</span><span class="op" id="6790597">(</span><span class="string" id="6790598">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="6790632">,</span>&nbsp;<span class="ident" id="6790634">expect</span><span class="op" id="6790640">,</span>&nbsp;<span class="ident" id="6790642">b</span><span class="op" id="6790643">.</span><span class="ident" id="6790644">String</span><span class="op" id="6790650">(</span><span class="op" id="6790651">)</span><span class="op" id="6790652">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6790655">}</span><br>
<span class="lineno"></span><span class="op" id="6790657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6790660">func</span>&nbsp;<span class="ident" id="6790665">TestFlagAndPrefixSetting</span><span class="op" id="6790689">(</span><span class="ident" id="6790690">t</span>&nbsp;<span class="op" id="6790692">*</span><span class="ident" id="6790693">testing</span><span class="op" id="6790700">.</span><span class="ident" id="6790701">T</span><span class="op" id="6790702">)</span>&nbsp;<span class="op" id="6790704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6790707">var</span>&nbsp;<span class="ident" id="6790711">b</span>&nbsp;<span class="ident" id="6790713">bytes</span><span class="op" id="6790718">.</span><span class="ident" id="6790719">Buffer</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6790727">l</span>&nbsp;<span class="op" id="6790729">:=</span>&nbsp;<span class="ident" id="6790732">New</span><span class="op" id="6790735">(</span><span class="op" id="6790736">&amp;</span><span class="ident" id="6790737">b</span><span class="op" id="6790738">,</span>&nbsp;<span class="string" id="6790740">&#34;Test:&#34;</span><span class="op" id="6790747">,</span>&nbsp;<span class="ident" id="6790749">LstdFlags</span><span class="op" id="6790758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6790761">f</span>&nbsp;<span class="op" id="6790763">:=</span>&nbsp;<span class="ident" id="6790766">l</span><span class="op" id="6790767">.</span><span class="ident" id="6790768">Flags</span><span class="op" id="6790773">(</span><span class="op" id="6790774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6790777">if</span>&nbsp;<span class="ident" id="6790780">f</span>&nbsp;<span class="op" id="6790782">!=</span>&nbsp;<span class="ident" id="6790785">LstdFlags</span>&nbsp;<span class="op" id="6790795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6790799">t</span><span class="op" id="6790800">.</span><span class="ident" id="6790801">Errorf</span><span class="op" id="6790807">(</span><span class="string" id="6790808">&#34;Flags&nbsp;1:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="6790837">,</span>&nbsp;<span class="ident" id="6790839">LstdFlags</span><span class="op" id="6790848">,</span>&nbsp;<span class="ident" id="6790850">f</span><span class="op" id="6790851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6790854">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6790857">l</span><span class="op" id="6790858">.</span><span class="ident" id="6790859">SetFlags</span><span class="op" id="6790867">(</span><span class="ident" id="6790868">f</span>&nbsp;<span class="op" id="6790870">|</span>&nbsp;<span class="ident" id="6790872">Lmicroseconds</span><span class="op" id="6790885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6790888">f</span>&nbsp;<span class="op" id="6790890">=</span>&nbsp;<span class="ident" id="6790892">l</span><span class="op" id="6790893">.</span><span class="ident" id="6790894">Flags</span><span class="op" id="6790899">(</span><span class="op" id="6790900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6790903">if</span>&nbsp;<span class="ident" id="6790906">f</span>&nbsp;<span class="op" id="6790908">!=</span>&nbsp;<span class="ident" id="6790911">LstdFlags</span><span class="op" id="6790920">|</span><span class="ident" id="6790921">Lmicroseconds</span>&nbsp;<span class="op" id="6790935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6790939">t</span><span class="op" id="6790940">.</span><span class="ident" id="6790941">Errorf</span><span class="op" id="6790947">(</span><span class="string" id="6790948">&#34;Flags&nbsp;2:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="6790977">,</span>&nbsp;<span class="ident" id="6790979">LstdFlags</span><span class="op" id="6790988">|</span><span class="ident" id="6790989">Lmicroseconds</span><span class="op" id="6791002">,</span>&nbsp;<span class="ident" id="6791004">f</span><span class="op" id="6791005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6791008">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6791011">p</span>&nbsp;<span class="op" id="6791013">:=</span>&nbsp;<span class="ident" id="6791016">l</span><span class="op" id="6791017">.</span><span class="ident" id="6791018">Prefix</span><span class="op" id="6791024">(</span><span class="op" id="6791025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6791028">if</span>&nbsp;<span class="ident" id="6791031">p</span>&nbsp;<span class="op" id="6791033">!=</span>&nbsp;<span class="string" id="6791036">&#34;Test:&#34;</span>&nbsp;<span class="op" id="6791044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6791048">t</span><span class="op" id="6791049">.</span><span class="ident" id="6791050">Errorf</span><span class="op" id="6791056">(</span><span class="string" id="6791057">`Prefix:&nbsp;expected&nbsp;&#34;Test:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="6791090">,</span>&nbsp;<span class="ident" id="6791092">p</span><span class="op" id="6791093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6791096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6791099">l</span><span class="op" id="6791100">.</span><span class="ident" id="6791101">SetPrefix</span><span class="op" id="6791110">(</span><span class="string" id="6791111">&#34;Reality:&#34;</span><span class="op" id="6791121">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6791124">p</span>&nbsp;<span class="op" id="6791126">=</span>&nbsp;<span class="ident" id="6791128">l</span><span class="op" id="6791129">.</span><span class="ident" id="6791130">Prefix</span><span class="op" id="6791136">(</span><span class="op" id="6791137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6791140">if</span>&nbsp;<span class="ident" id="6791143">p</span>&nbsp;<span class="op" id="6791145">!=</span>&nbsp;<span class="string" id="6791148">&#34;Reality:&#34;</span>&nbsp;<span class="op" id="6791159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6791163">t</span><span class="op" id="6791164">.</span><span class="ident" id="6791165">Errorf</span><span class="op" id="6791171">(</span><span class="string" id="6791172">`Prefix:&nbsp;expected&nbsp;&#34;Reality:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="6791208">,</span>&nbsp;<span class="ident" id="6791210">p</span><span class="op" id="6791211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6791214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6791217">//&nbsp;Verify&nbsp;a&nbsp;log&nbsp;message&nbsp;looks&nbsp;right,&nbsp;with&nbsp;our&nbsp;prefix&nbsp;and&nbsp;microseconds&nbsp;present.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6791297">l</span><span class="op" id="6791298">.</span><span class="ident" id="6791299">Print</span><span class="op" id="6791304">(</span><span class="string" id="6791305">&#34;hello&#34;</span><span class="op" id="6791312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6791315">pattern</span>&nbsp;<span class="op" id="6791323">:=</span>&nbsp;<span class="string" id="6791326">&#34;^Reality:&#34;</span>&nbsp;<span class="op" id="6791338">+</span>&nbsp;<span class="ident" id="6791340">Rdate</span>&nbsp;<span class="op" id="6791346">+</span>&nbsp;<span class="string" id="6791348">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6791352">+</span>&nbsp;<span class="ident" id="6791354">Rtime</span>&nbsp;<span class="op" id="6791360">+</span>&nbsp;<span class="ident" id="6791362">Rmicroseconds</span>&nbsp;<span class="op" id="6791376">+</span>&nbsp;<span class="string" id="6791378">&#34;&nbsp;hello\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6791390">matched</span><span class="op" id="6791397">,</span>&nbsp;<span class="ident" id="6791399">err</span>&nbsp;<span class="op" id="6791403">:=</span>&nbsp;<span class="ident" id="6791406">regexp</span><span class="op" id="6791412">.</span><span class="ident" id="6791413">Match</span><span class="op" id="6791418">(</span><span class="ident" id="6791419">pattern</span><span class="op" id="6791426">,</span>&nbsp;<span class="ident" id="6791428">b</span><span class="op" id="6791429">.</span><span class="ident" id="6791430">Bytes</span><span class="op" id="6791435">(</span><span class="op" id="6791436">)</span><span class="op" id="6791437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6791440">if</span>&nbsp;<span class="ident" id="6791443">err</span>&nbsp;<span class="op" id="6791447">!=</span>&nbsp;<span class="ident" id="6791450">nil</span>&nbsp;<span class="op" id="6791454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6791458">t</span><span class="op" id="6791459">.</span><span class="ident" id="6791460">Fatalf</span><span class="op" id="6791466">(</span><span class="string" id="6791467">&#34;pattern&nbsp;%q&nbsp;did&nbsp;not&nbsp;compile:&nbsp;%s&#34;</span><span class="op" id="6791499">,</span>&nbsp;<span class="ident" id="6791501">pattern</span><span class="op" id="6791508">,</span>&nbsp;<span class="ident" id="6791510">err</span><span class="op" id="6791513">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6791516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6791519">if</span>&nbsp;<span class="op" id="6791522">!</span><span class="ident" id="6791523">matched</span>&nbsp;<span class="op" id="6791531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6791535">t</span><span class="op" id="6791536">.</span><span class="ident" id="6791537">Error</span><span class="op" id="6791542">(</span><span class="string" id="6791543">&#34;message&nbsp;did&nbsp;not&nbsp;match&nbsp;pattern&#34;</span><span class="op" id="6791574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6791577">}</span><br>
<span class="lineno"></span><span class="op" id="6791579">}</span>
</div>
</body>
</html>
