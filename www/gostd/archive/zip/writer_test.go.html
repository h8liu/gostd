<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>archive/zip</h2>
<ul>
<li><a href="/gostd/archive/zip/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/archive/zip/reader.go.html">reader.go</a></li>
<li><a href="/gostd/archive/zip/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/archive/zip/register.go.html">register.go</a></li>
<li><a href="/gostd/archive/zip/struct.go.html">struct.go</a></li>
<li><a href="/gostd/archive/zip/writer.go.html">writer.go</a></li>
<li><a href="/gostd/archive/zip/writer_test.go.html" class="current">writer_test.go</a></li>
<li><a href="/gostd/archive/zip/zip_test.go.html">zip_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6455885">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6455940">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6455994">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6456045">package</span>&nbsp;<span class="ident" id="6456053">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6456058">import</span>&nbsp;<span class="op" id="6456065">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6456068">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6456077">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6456083">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6456096">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6456109">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6456115">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6456125">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6456128">//&nbsp;TODO(adg):&nbsp;a&nbsp;more&nbsp;sophisticated&nbsp;test&nbsp;suite</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6456175">type</span>&nbsp;<span class="ident" id="6456180">WriteTest</span>&nbsp;<span class="keyword" id="6456190">struct</span>&nbsp;<span class="op" id="6456197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456200">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6456207">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456215">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6456222">[</span><span class="op" id="6456223">]</span><span class="builtintype" id="6456224">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456230">Method</span>&nbsp;<span class="builtintype" id="6456237">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456245">Mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6456252">os</span><span class="op" id="6456254">.</span><span class="ident" id="6456255">FileMode</span><br>
<span class="lineno"></span><span class="op" id="6456264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="6456267">var</span>&nbsp;<span class="ident" id="6456271">writeTests</span>&nbsp;<span class="op" id="6456282">=</span>&nbsp;<span class="op" id="6456284">[</span><span class="op" id="6456285">]</span><span class="ident" id="6456286">WriteTest</span><span class="op" id="6456295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6456298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456302">Name</span><span class="op" id="6456306">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6456310">&#34;foo&#34;</span><span class="op" id="6456315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456319">Data</span><span class="op" id="6456323">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6456327">[</span><span class="op" id="6456328">]</span><span class="builtintype" id="6456329">byte</span><span class="op" id="6456333">(</span><span class="string" id="6456334">&#34;Rabbits,&nbsp;guinea&nbsp;pigs,&nbsp;gophers,&nbsp;marsupial&nbsp;rats,&nbsp;and&nbsp;quolls.&#34;</span><span class="op" id="6456394">)</span><span class="op" id="6456395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456399">Method</span><span class="op" id="6456405">:</span>&nbsp;<span class="ident" id="6456407">Store</span><span class="op" id="6456412">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456416">Mode</span><span class="op" id="6456420">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6456424">0666</span><span class="op" id="6456428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6456431">}</span><span class="op" id="6456432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6456435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456439">Name</span><span class="op" id="6456443">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6456447">&#34;bar&#34;</span><span class="op" id="6456452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456456">Data</span><span class="op" id="6456460">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6456464">nil</span><span class="op" id="6456467">,</span>&nbsp;<span class="comment" id="6456469">//&nbsp;large&nbsp;data&nbsp;set&nbsp;in&nbsp;the&nbsp;test</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456501">Method</span><span class="op" id="6456507">:</span>&nbsp;<span class="ident" id="6456509">Deflate</span><span class="op" id="6456516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456520">Mode</span><span class="op" id="6456524">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6456528">0644</span><span class="op" id="6456532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6456535">}</span><span class="op" id="6456536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6456539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456543">Name</span><span class="op" id="6456547">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6456551">&#34;setuid&#34;</span><span class="op" id="6456559">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456563">Data</span><span class="op" id="6456567">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6456571">[</span><span class="op" id="6456572">]</span><span class="builtintype" id="6456573">byte</span><span class="op" id="6456577">(</span><span class="string" id="6456578">&#34;setuid&nbsp;file&#34;</span><span class="op" id="6456591">)</span><span class="op" id="6456592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456596">Method</span><span class="op" id="6456602">:</span>&nbsp;<span class="ident" id="6456604">Deflate</span><span class="op" id="6456611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456615">Mode</span><span class="op" id="6456619">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6456623">0755</span>&nbsp;<span class="op" id="6456628">|</span>&nbsp;<span class="ident" id="6456630">os</span><span class="op" id="6456632">.</span><span class="ident" id="6456633">ModeSetuid</span><span class="op" id="6456643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6456646">}</span><span class="op" id="6456647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6456650">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456654">Name</span><span class="op" id="6456658">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6456662">&#34;setgid&#34;</span><span class="op" id="6456670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456674">Data</span><span class="op" id="6456678">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6456682">[</span><span class="op" id="6456683">]</span><span class="builtintype" id="6456684">byte</span><span class="op" id="6456688">(</span><span class="string" id="6456689">&#34;setgid&nbsp;file&#34;</span><span class="op" id="6456702">)</span><span class="op" id="6456703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456707">Method</span><span class="op" id="6456713">:</span>&nbsp;<span class="ident" id="6456715">Deflate</span><span class="op" id="6456722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456726">Mode</span><span class="op" id="6456730">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6456734">0755</span>&nbsp;<span class="op" id="6456739">|</span>&nbsp;<span class="ident" id="6456741">os</span><span class="op" id="6456743">.</span><span class="ident" id="6456744">ModeSetgid</span><span class="op" id="6456754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6456757">}</span><span class="op" id="6456758">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6456761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456765">Name</span><span class="op" id="6456769">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6456773">&#34;symlink&#34;</span><span class="op" id="6456782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456786">Data</span><span class="op" id="6456790">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6456794">[</span><span class="op" id="6456795">]</span><span class="builtintype" id="6456796">byte</span><span class="op" id="6456800">(</span><span class="string" id="6456801">&#34;../link/target&#34;</span><span class="op" id="6456817">)</span><span class="op" id="6456818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456822">Method</span><span class="op" id="6456828">:</span>&nbsp;<span class="ident" id="6456830">Deflate</span><span class="op" id="6456837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456841">Mode</span><span class="op" id="6456845">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6456849">0755</span>&nbsp;<span class="op" id="6456854">|</span>&nbsp;<span class="ident" id="6456856">os</span><span class="op" id="6456858">.</span><span class="ident" id="6456859">ModeSymlink</span><span class="op" id="6456870">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6456873">}</span><span class="op" id="6456874">,</span><br>
<span class="lineno"></span><span class="op" id="6456876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6456879">func</span>&nbsp;<span class="ident" id="6456884">TestWriter</span><span class="op" id="6456894">(</span><span class="ident" id="6456895">t</span>&nbsp;<span class="op" id="6456897">*</span><span class="ident" id="6456898">testing</span><span class="op" id="6456905">.</span><span class="ident" id="6456906">T</span><span class="op" id="6456907">)</span>&nbsp;<span class="op" id="6456909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456912">largeData</span>&nbsp;<span class="op" id="6456922">:=</span>&nbsp;<span class="builtinfunc" id="6456925">make</span><span class="op" id="6456929">(</span><span class="op" id="6456930">[</span><span class="op" id="6456931">]</span><span class="builtintype" id="6456932">byte</span><span class="op" id="6456936">,</span>&nbsp;<span class="num" id="6456938">1</span><span class="op" id="6456939">&lt;&lt;</span><span class="num" id="6456941">17</span><span class="op" id="6456943">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6456946">for</span>&nbsp;<span class="ident" id="6456950">i</span>&nbsp;<span class="op" id="6456952">:=</span>&nbsp;<span class="keyword" id="6456955">range</span>&nbsp;<span class="ident" id="6456961">largeData</span>&nbsp;<span class="op" id="6456971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6456975">largeData</span><span class="op" id="6456984">[</span><span class="ident" id="6456985">i</span><span class="op" id="6456986">]</span>&nbsp;<span class="op" id="6456988">=</span>&nbsp;<span class="builtintype" id="6456990">byte</span><span class="op" id="6456994">(</span><span class="ident" id="6456995">rand</span><span class="op" id="6456999">.</span><span class="ident" id="6457000">Int</span><span class="op" id="6457003">(</span><span class="op" id="6457004">)</span><span class="op" id="6457005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6457008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457011">writeTests</span><span class="op" id="6457021">[</span><span class="num" id="6457022">1</span><span class="op" id="6457023">]</span><span class="op" id="6457024">.</span><span class="ident" id="6457025">Data</span>&nbsp;<span class="op" id="6457030">=</span>&nbsp;<span class="ident" id="6457032">largeData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6457043">defer</span>&nbsp;<span class="keyword" id="6457049">func</span><span class="op" id="6457053">(</span><span class="op" id="6457054">)</span>&nbsp;<span class="op" id="6457056">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457060">writeTests</span><span class="op" id="6457070">[</span><span class="num" id="6457071">1</span><span class="op" id="6457072">]</span><span class="op" id="6457073">.</span><span class="ident" id="6457074">Data</span>&nbsp;<span class="op" id="6457079">=</span>&nbsp;<span class="builtintype" id="6457081">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6457086">}</span><span class="op" id="6457087">(</span><span class="op" id="6457088">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6457092">//&nbsp;write&nbsp;a&nbsp;zip&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457113">buf</span>&nbsp;<span class="op" id="6457117">:=</span>&nbsp;<span class="builtinfunc" id="6457120">new</span><span class="op" id="6457123">(</span><span class="ident" id="6457124">bytes</span><span class="op" id="6457129">.</span><span class="ident" id="6457130">Buffer</span><span class="op" id="6457136">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457139">w</span>&nbsp;<span class="op" id="6457141">:=</span>&nbsp;<span class="ident" id="6457144">NewWriter</span><span class="op" id="6457153">(</span><span class="ident" id="6457154">buf</span><span class="op" id="6457157">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6457161">for</span>&nbsp;<span class="ident" id="6457165">_</span><span class="op" id="6457166">,</span>&nbsp;<span class="ident" id="6457168">wt</span>&nbsp;<span class="op" id="6457171">:=</span>&nbsp;<span class="keyword" id="6457174">range</span>&nbsp;<span class="ident" id="6457180">writeTests</span>&nbsp;<span class="op" id="6457191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457195">testCreate</span><span class="op" id="6457205">(</span><span class="ident" id="6457206">t</span><span class="op" id="6457207">,</span>&nbsp;<span class="ident" id="6457209">w</span><span class="op" id="6457210">,</span>&nbsp;<span class="op" id="6457212">&amp;</span><span class="ident" id="6457213">wt</span><span class="op" id="6457215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6457218">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6457222">if</span>&nbsp;<span class="ident" id="6457225">err</span>&nbsp;<span class="op" id="6457229">:=</span>&nbsp;<span class="ident" id="6457232">w</span><span class="op" id="6457233">.</span><span class="ident" id="6457234">Close</span><span class="op" id="6457239">(</span><span class="op" id="6457240">)</span><span class="op" id="6457241">;</span>&nbsp;<span class="ident" id="6457243">err</span>&nbsp;<span class="op" id="6457247">!=</span>&nbsp;<span class="builtintype" id="6457250">nil</span>&nbsp;<span class="op" id="6457254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457258">t</span><span class="op" id="6457259">.</span><span class="ident" id="6457260">Fatal</span><span class="op" id="6457265">(</span><span class="ident" id="6457266">err</span><span class="op" id="6457269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6457272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6457276">//&nbsp;read&nbsp;it&nbsp;back</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457293">r</span><span class="op" id="6457294">,</span>&nbsp;<span class="ident" id="6457296">err</span>&nbsp;<span class="op" id="6457300">:=</span>&nbsp;<span class="ident" id="6457303">NewReader</span><span class="op" id="6457312">(</span><span class="ident" id="6457313">bytes</span><span class="op" id="6457318">.</span><span class="ident" id="6457319">NewReader</span><span class="op" id="6457328">(</span><span class="ident" id="6457329">buf</span><span class="op" id="6457332">.</span><span class="ident" id="6457333">Bytes</span><span class="op" id="6457338">(</span><span class="op" id="6457339">)</span><span class="op" id="6457340">)</span><span class="op" id="6457341">,</span>&nbsp;<span class="ident" id="6457343">int64</span><span class="op" id="6457348">(</span><span class="ident" id="6457349">buf</span><span class="op" id="6457352">.</span><span class="ident" id="6457353">Len</span><span class="op" id="6457356">(</span><span class="op" id="6457357">)</span><span class="op" id="6457358">)</span><span class="op" id="6457359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6457362">if</span>&nbsp;<span class="ident" id="6457365">err</span>&nbsp;<span class="op" id="6457369">!=</span>&nbsp;<span class="builtintype" id="6457372">nil</span>&nbsp;<span class="op" id="6457376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457380">t</span><span class="op" id="6457381">.</span><span class="ident" id="6457382">Fatal</span><span class="op" id="6457387">(</span><span class="ident" id="6457388">err</span><span class="op" id="6457391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6457394">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6457397">for</span>&nbsp;<span class="ident" id="6457401">i</span><span class="op" id="6457402">,</span>&nbsp;<span class="ident" id="6457404">wt</span>&nbsp;<span class="op" id="6457407">:=</span>&nbsp;<span class="keyword" id="6457410">range</span>&nbsp;<span class="ident" id="6457416">writeTests</span>&nbsp;<span class="op" id="6457427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457431">testReadFile</span><span class="op" id="6457443">(</span><span class="ident" id="6457444">t</span><span class="op" id="6457445">,</span>&nbsp;<span class="ident" id="6457447">r</span><span class="op" id="6457448">.</span><span class="ident" id="6457449">File</span><span class="op" id="6457453">[</span><span class="ident" id="6457454">i</span><span class="op" id="6457455">]</span><span class="op" id="6457456">,</span>&nbsp;<span class="op" id="6457458">&amp;</span><span class="ident" id="6457459">wt</span><span class="op" id="6457461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6457464">}</span><br>
<span class="lineno"></span><span class="op" id="6457466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="6457469">func</span>&nbsp;<span class="ident" id="6457474">TestWriterFlush</span><span class="op" id="6457489">(</span><span class="ident" id="6457490">t</span>&nbsp;<span class="op" id="6457492">*</span><span class="ident" id="6457493">testing</span><span class="op" id="6457500">.</span><span class="ident" id="6457501">T</span><span class="op" id="6457502">)</span>&nbsp;<span class="op" id="6457504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6457507">var</span>&nbsp;<span class="ident" id="6457511">buf</span>&nbsp;<span class="ident" id="6457515">bytes</span><span class="op" id="6457520">.</span><span class="ident" id="6457521">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457529">w</span>&nbsp;<span class="op" id="6457531">:=</span>&nbsp;<span class="ident" id="6457534">NewWriter</span><span class="op" id="6457543">(</span><span class="keyword" id="6457544">struct</span><span class="op" id="6457550">{</span>&nbsp;<span class="ident" id="6457552">io</span><span class="op" id="6457554">.</span><span class="ident" id="6457555">Writer</span>&nbsp;<span class="op" id="6457562">}</span><span class="op" id="6457563">{</span><span class="op" id="6457564">&amp;</span><span class="ident" id="6457565">buf</span><span class="op" id="6457568">}</span><span class="op" id="6457569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457572">_</span><span class="op" id="6457573">,</span>&nbsp;<span class="ident" id="6457575">err</span>&nbsp;<span class="op" id="6457579">:=</span>&nbsp;<span class="ident" id="6457582">w</span><span class="op" id="6457583">.</span><span class="ident" id="6457584">Create</span><span class="op" id="6457590">(</span><span class="string" id="6457591">&#34;foo&#34;</span><span class="op" id="6457596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6457599">if</span>&nbsp;<span class="ident" id="6457602">err</span>&nbsp;<span class="op" id="6457606">!=</span>&nbsp;<span class="builtintype" id="6457609">nil</span>&nbsp;<span class="op" id="6457613">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457617">t</span><span class="op" id="6457618">.</span><span class="ident" id="6457619">Fatal</span><span class="op" id="6457624">(</span><span class="ident" id="6457625">err</span><span class="op" id="6457628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6457631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6457634">if</span>&nbsp;<span class="ident" id="6457637">buf</span><span class="op" id="6457640">.</span><span class="ident" id="6457641">Len</span><span class="op" id="6457644">(</span><span class="op" id="6457645">)</span>&nbsp;<span class="op" id="6457647">&gt;</span>&nbsp;<span class="num" id="6457649">0</span>&nbsp;<span class="op" id="6457651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457655">t</span><span class="op" id="6457656">.</span><span class="ident" id="6457657">Fatalf</span><span class="op" id="6457663">(</span><span class="string" id="6457664">&#34;Unexpected&nbsp;%d&nbsp;bytes&nbsp;already&nbsp;in&nbsp;buffer&#34;</span><span class="op" id="6457703">,</span>&nbsp;<span class="ident" id="6457705">buf</span><span class="op" id="6457708">.</span><span class="ident" id="6457709">Len</span><span class="op" id="6457712">(</span><span class="op" id="6457713">)</span><span class="op" id="6457714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6457717">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6457720">if</span>&nbsp;<span class="ident" id="6457723">err</span>&nbsp;<span class="op" id="6457727">:=</span>&nbsp;<span class="ident" id="6457730">w</span><span class="op" id="6457731">.</span><span class="ident" id="6457732">Flush</span><span class="op" id="6457737">(</span><span class="op" id="6457738">)</span><span class="op" id="6457739">;</span>&nbsp;<span class="ident" id="6457741">err</span>&nbsp;<span class="op" id="6457745">!=</span>&nbsp;<span class="builtintype" id="6457748">nil</span>&nbsp;<span class="op" id="6457752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457756">t</span><span class="op" id="6457757">.</span><span class="ident" id="6457758">Fatal</span><span class="op" id="6457763">(</span><span class="ident" id="6457764">err</span><span class="op" id="6457767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6457770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6457773">if</span>&nbsp;<span class="ident" id="6457776">buf</span><span class="op" id="6457779">.</span><span class="ident" id="6457780">Len</span><span class="op" id="6457783">(</span><span class="op" id="6457784">)</span>&nbsp;<span class="op" id="6457786">==</span>&nbsp;<span class="num" id="6457789">0</span>&nbsp;<span class="op" id="6457791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457795">t</span><span class="op" id="6457796">.</span><span class="ident" id="6457797">Fatal</span><span class="op" id="6457802">(</span><span class="string" id="6457803">&#34;No&nbsp;bytes&nbsp;written&nbsp;after&nbsp;Flush&#34;</span><span class="op" id="6457833">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6457836">}</span><br>
<span class="lineno"></span><span class="op" id="6457838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6457841">func</span>&nbsp;<span class="ident" id="6457846">testCreate</span><span class="op" id="6457856">(</span><span class="ident" id="6457857">t</span>&nbsp;<span class="op" id="6457859">*</span><span class="ident" id="6457860">testing</span><span class="op" id="6457867">.</span><span class="ident" id="6457868">T</span><span class="op" id="6457869">,</span>&nbsp;<span class="ident" id="6457871">w</span>&nbsp;<span class="op" id="6457873">*</span><span class="ident" id="6457874">Writer</span><span class="op" id="6457880">,</span>&nbsp;<span class="ident" id="6457882">wt</span>&nbsp;<span class="op" id="6457885">*</span><span class="ident" id="6457886">WriteTest</span><span class="op" id="6457895">)</span>&nbsp;<span class="op" id="6457897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457900">header</span>&nbsp;<span class="op" id="6457907">:=</span>&nbsp;<span class="op" id="6457910">&amp;</span><span class="ident" id="6457911">FileHeader</span><span class="op" id="6457921">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457925">Name</span><span class="op" id="6457929">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6457933">wt</span><span class="op" id="6457935">.</span><span class="ident" id="6457936">Name</span><span class="op" id="6457940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457944">Method</span><span class="op" id="6457950">:</span>&nbsp;<span class="ident" id="6457952">wt</span><span class="op" id="6457954">.</span><span class="ident" id="6457955">Method</span><span class="op" id="6457961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6457964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6457967">if</span>&nbsp;<span class="ident" id="6457970">wt</span><span class="op" id="6457972">.</span><span class="ident" id="6457973">Mode</span>&nbsp;<span class="op" id="6457978">!=</span>&nbsp;<span class="num" id="6457981">0</span>&nbsp;<span class="op" id="6457983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6457987">header</span><span class="op" id="6457993">.</span><span class="ident" id="6457994">SetMode</span><span class="op" id="6458001">(</span><span class="ident" id="6458002">wt</span><span class="op" id="6458004">.</span><span class="ident" id="6458005">Mode</span><span class="op" id="6458009">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6458012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458015">f</span><span class="op" id="6458016">,</span>&nbsp;<span class="ident" id="6458018">err</span>&nbsp;<span class="op" id="6458022">:=</span>&nbsp;<span class="ident" id="6458025">w</span><span class="op" id="6458026">.</span><span class="ident" id="6458027">CreateHeader</span><span class="op" id="6458039">(</span><span class="ident" id="6458040">header</span><span class="op" id="6458046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6458049">if</span>&nbsp;<span class="ident" id="6458052">err</span>&nbsp;<span class="op" id="6458056">!=</span>&nbsp;<span class="builtintype" id="6458059">nil</span>&nbsp;<span class="op" id="6458063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458067">t</span><span class="op" id="6458068">.</span><span class="ident" id="6458069">Fatal</span><span class="op" id="6458074">(</span><span class="ident" id="6458075">err</span><span class="op" id="6458078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6458081">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458084">_</span><span class="op" id="6458085">,</span>&nbsp;<span class="ident" id="6458087">err</span>&nbsp;<span class="op" id="6458091">=</span>&nbsp;<span class="ident" id="6458093">f</span><span class="op" id="6458094">.</span><span class="ident" id="6458095">Write</span><span class="op" id="6458100">(</span><span class="ident" id="6458101">wt</span><span class="op" id="6458103">.</span><span class="ident" id="6458104">Data</span><span class="op" id="6458108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6458111">if</span>&nbsp;<span class="ident" id="6458114">err</span>&nbsp;<span class="op" id="6458118">!=</span>&nbsp;<span class="builtintype" id="6458121">nil</span>&nbsp;<span class="op" id="6458125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458129">t</span><span class="op" id="6458130">.</span><span class="ident" id="6458131">Fatal</span><span class="op" id="6458136">(</span><span class="ident" id="6458137">err</span><span class="op" id="6458140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6458143">}</span><br>
<span class="lineno"></span><span class="op" id="6458145">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="6458148">func</span>&nbsp;<span class="ident" id="6458153">testReadFile</span><span class="op" id="6458165">(</span><span class="ident" id="6458166">t</span>&nbsp;<span class="op" id="6458168">*</span><span class="ident" id="6458169">testing</span><span class="op" id="6458176">.</span><span class="ident" id="6458177">T</span><span class="op" id="6458178">,</span>&nbsp;<span class="ident" id="6458180">f</span>&nbsp;<span class="op" id="6458182">*</span><span class="ident" id="6458183">File</span><span class="op" id="6458187">,</span>&nbsp;<span class="ident" id="6458189">wt</span>&nbsp;<span class="op" id="6458192">*</span><span class="ident" id="6458193">WriteTest</span><span class="op" id="6458202">)</span>&nbsp;<span class="op" id="6458204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6458207">if</span>&nbsp;<span class="ident" id="6458210">f</span><span class="op" id="6458211">.</span><span class="ident" id="6458212">Name</span>&nbsp;<span class="op" id="6458217">!=</span>&nbsp;<span class="ident" id="6458220">wt</span><span class="op" id="6458222">.</span><span class="ident" id="6458223">Name</span>&nbsp;<span class="op" id="6458228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458232">t</span><span class="op" id="6458233">.</span><span class="ident" id="6458234">Fatalf</span><span class="op" id="6458240">(</span><span class="string" id="6458241">&#34;File&nbsp;name:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6458269">,</span>&nbsp;<span class="ident" id="6458271">f</span><span class="op" id="6458272">.</span><span class="ident" id="6458273">Name</span><span class="op" id="6458277">,</span>&nbsp;<span class="ident" id="6458279">wt</span><span class="op" id="6458281">.</span><span class="ident" id="6458282">Name</span><span class="op" id="6458286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6458289">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458292">testFileMode</span><span class="op" id="6458304">(</span><span class="ident" id="6458305">t</span><span class="op" id="6458306">,</span>&nbsp;<span class="ident" id="6458308">wt</span><span class="op" id="6458310">.</span><span class="ident" id="6458311">Name</span><span class="op" id="6458315">,</span>&nbsp;<span class="ident" id="6458317">f</span><span class="op" id="6458318">,</span>&nbsp;<span class="ident" id="6458320">wt</span><span class="op" id="6458322">.</span><span class="ident" id="6458323">Mode</span><span class="op" id="6458327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458330">rc</span><span class="op" id="6458332">,</span>&nbsp;<span class="ident" id="6458334">err</span>&nbsp;<span class="op" id="6458338">:=</span>&nbsp;<span class="ident" id="6458341">f</span><span class="op" id="6458342">.</span><span class="ident" id="6458343">Open</span><span class="op" id="6458347">(</span><span class="op" id="6458348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6458351">if</span>&nbsp;<span class="ident" id="6458354">err</span>&nbsp;<span class="op" id="6458358">!=</span>&nbsp;<span class="builtintype" id="6458361">nil</span>&nbsp;<span class="op" id="6458365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458369">t</span><span class="op" id="6458370">.</span><span class="ident" id="6458371">Fatal</span><span class="op" id="6458376">(</span><span class="string" id="6458377">&#34;opening:&#34;</span><span class="op" id="6458387">,</span>&nbsp;<span class="ident" id="6458389">err</span><span class="op" id="6458392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6458395">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458398">b</span><span class="op" id="6458399">,</span>&nbsp;<span class="ident" id="6458401">err</span>&nbsp;<span class="op" id="6458405">:=</span>&nbsp;<span class="ident" id="6458408">ioutil</span><span class="op" id="6458414">.</span><span class="ident" id="6458415">ReadAll</span><span class="op" id="6458422">(</span><span class="ident" id="6458423">rc</span><span class="op" id="6458425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6458428">if</span>&nbsp;<span class="ident" id="6458431">err</span>&nbsp;<span class="op" id="6458435">!=</span>&nbsp;<span class="builtintype" id="6458438">nil</span>&nbsp;<span class="op" id="6458442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458446">t</span><span class="op" id="6458447">.</span><span class="ident" id="6458448">Fatal</span><span class="op" id="6458453">(</span><span class="string" id="6458454">&#34;reading:&#34;</span><span class="op" id="6458464">,</span>&nbsp;<span class="ident" id="6458466">err</span><span class="op" id="6458469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6458472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458475">err</span>&nbsp;<span class="op" id="6458479">=</span>&nbsp;<span class="ident" id="6458481">rc</span><span class="op" id="6458483">.</span><span class="ident" id="6458484">Close</span><span class="op" id="6458489">(</span><span class="op" id="6458490">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6458493">if</span>&nbsp;<span class="ident" id="6458496">err</span>&nbsp;<span class="op" id="6458500">!=</span>&nbsp;<span class="builtintype" id="6458503">nil</span>&nbsp;<span class="op" id="6458507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458511">t</span><span class="op" id="6458512">.</span><span class="ident" id="6458513">Fatal</span><span class="op" id="6458518">(</span><span class="string" id="6458519">&#34;closing:&#34;</span><span class="op" id="6458529">,</span>&nbsp;<span class="ident" id="6458531">err</span><span class="op" id="6458534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6458537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6458540">if</span>&nbsp;<span class="op" id="6458543">!</span><span class="ident" id="6458544">bytes</span><span class="op" id="6458549">.</span><span class="ident" id="6458550">Equal</span><span class="op" id="6458555">(</span><span class="ident" id="6458556">b</span><span class="op" id="6458557">,</span>&nbsp;<span class="ident" id="6458559">wt</span><span class="op" id="6458561">.</span><span class="ident" id="6458562">Data</span><span class="op" id="6458566">)</span>&nbsp;<span class="op" id="6458568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458572">t</span><span class="op" id="6458573">.</span><span class="ident" id="6458574">Errorf</span><span class="op" id="6458580">(</span><span class="string" id="6458581">&#34;File&nbsp;contents&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6458608">,</span>&nbsp;<span class="ident" id="6458610">b</span><span class="op" id="6458611">,</span>&nbsp;<span class="ident" id="6458613">wt</span><span class="op" id="6458615">.</span><span class="ident" id="6458616">Data</span><span class="op" id="6458620">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6458623">}</span><br>
<span class="lineno"></span><span class="op" id="6458625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6458628">func</span>&nbsp;<span class="ident" id="6458633">BenchmarkCompressedZipGarbage</span><span class="op" id="6458662">(</span><span class="ident" id="6458663">b</span>&nbsp;<span class="op" id="6458665">*</span><span class="ident" id="6458666">testing</span><span class="op" id="6458673">.</span><span class="ident" id="6458674">B</span><span class="op" id="6458675">)</span>&nbsp;<span class="op" id="6458677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458680">b</span><span class="op" id="6458681">.</span><span class="ident" id="6458682">ReportAllocs</span><span class="op" id="6458694">(</span><span class="op" id="6458695">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6458698">var</span>&nbsp;<span class="ident" id="6458702">buf</span>&nbsp;<span class="ident" id="6458706">bytes</span><span class="op" id="6458711">.</span><span class="ident" id="6458712">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458720">bigBuf</span>&nbsp;<span class="op" id="6458727">:=</span>&nbsp;<span class="ident" id="6458730">bytes</span><span class="op" id="6458735">.</span><span class="ident" id="6458736">Repeat</span><span class="op" id="6458742">(</span><span class="op" id="6458743">[</span><span class="op" id="6458744">]</span><span class="builtintype" id="6458745">byte</span><span class="op" id="6458749">(</span><span class="string" id="6458750">&#34;a&#34;</span><span class="op" id="6458753">)</span><span class="op" id="6458754">,</span>&nbsp;<span class="num" id="6458756">1</span><span class="op" id="6458757">&lt;&lt;</span><span class="num" id="6458759">20</span><span class="op" id="6458761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6458764">for</span>&nbsp;<span class="ident" id="6458768">i</span>&nbsp;<span class="op" id="6458770">:=</span>&nbsp;<span class="num" id="6458773">0</span><span class="op" id="6458774">;</span>&nbsp;<span class="ident" id="6458776">i</span>&nbsp;<span class="op" id="6458778">&lt;</span>&nbsp;<span class="ident" id="6458780">b</span><span class="op" id="6458781">.</span><span class="ident" id="6458782">N</span><span class="op" id="6458783">;</span>&nbsp;<span class="ident" id="6458785">i</span><span class="op" id="6458786">++</span>&nbsp;<span class="op" id="6458789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458793">buf</span><span class="op" id="6458796">.</span><span class="ident" id="6458797">Reset</span><span class="op" id="6458802">(</span><span class="op" id="6458803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458807">zw</span>&nbsp;<span class="op" id="6458810">:=</span>&nbsp;<span class="ident" id="6458813">NewWriter</span><span class="op" id="6458822">(</span><span class="op" id="6458823">&amp;</span><span class="ident" id="6458824">buf</span><span class="op" id="6458827">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6458831">for</span>&nbsp;<span class="ident" id="6458835">j</span>&nbsp;<span class="op" id="6458837">:=</span>&nbsp;<span class="num" id="6458840">0</span><span class="op" id="6458841">;</span>&nbsp;<span class="ident" id="6458843">j</span>&nbsp;<span class="op" id="6458845">&lt;</span>&nbsp;<span class="num" id="6458847">3</span><span class="op" id="6458848">;</span>&nbsp;<span class="ident" id="6458850">j</span><span class="op" id="6458851">++</span>&nbsp;<span class="op" id="6458854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458859">w</span><span class="op" id="6458860">,</span>&nbsp;<span class="ident" id="6458862">_</span>&nbsp;<span class="op" id="6458864">:=</span>&nbsp;<span class="ident" id="6458867">zw</span><span class="op" id="6458869">.</span><span class="ident" id="6458870">CreateHeader</span><span class="op" id="6458882">(</span><span class="op" id="6458883">&amp;</span><span class="ident" id="6458884">FileHeader</span><span class="op" id="6458894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458900">Name</span><span class="op" id="6458904">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6458908">&#34;foo&#34;</span><span class="op" id="6458913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458919">Method</span><span class="op" id="6458925">:</span>&nbsp;<span class="ident" id="6458927">Deflate</span><span class="op" id="6458934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6458939">}</span><span class="op" id="6458940">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458945">w</span><span class="op" id="6458946">.</span><span class="ident" id="6458947">Write</span><span class="op" id="6458952">(</span><span class="ident" id="6458953">bigBuf</span><span class="op" id="6458959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6458963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6458967">zw</span><span class="op" id="6458969">.</span><span class="ident" id="6458970">Close</span><span class="op" id="6458975">(</span><span class="op" id="6458976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6458979">}</span><br>
<span class="lineno"></span><span class="op" id="6458981">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
