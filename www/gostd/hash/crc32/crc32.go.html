<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>hash/crc32</h2>
<ul>
<li><a href="/gostd/hash/crc32/crc32.go.html" class="current">crc32.go</a></li>
<li><a href="/gostd/hash/crc32/crc32_amd64x.go.html">crc32_amd64x.go</a></li>
<li><a href="/gostd/hash/crc32/crc32_test.go.html">crc32_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4273339">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4273394">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4273448">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4273499">//&nbsp;Package&nbsp;crc32&nbsp;implements&nbsp;the&nbsp;32-bit&nbsp;cyclic&nbsp;redundancy&nbsp;check,&nbsp;or&nbsp;CRC-32,</span><br>
<span class="lineno"></span><span class="comment" id="4273574">//&nbsp;checksum.&nbsp;See&nbsp;http://en.wikipedia.org/wiki/Cyclic_redundancy_check&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="4273648">//&nbsp;information.</span><br>
<span class="lineno"></span><span class="keyword" id="4273664">package</span>&nbsp;<span class="ident" id="4273672">crc32</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4273679">import</span>&nbsp;<span class="op" id="4273686">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4273689">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4273697">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="4273704">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4273707">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;CRC-32&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4273750">const</span>&nbsp;<span class="ident" id="4273756">Size</span>&nbsp;<span class="op" id="4273761">=</span>&nbsp;<span class="num" id="4273763">4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4273766">//&nbsp;Predefined&nbsp;polynomials.</span><br>
<span class="lineno"></span><span class="keyword" id="4273793">const</span>&nbsp;<span class="op" id="4273799">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4273802">//&nbsp;IEEE&nbsp;is&nbsp;by&nbsp;far&nbsp;and&nbsp;away&nbsp;the&nbsp;most&nbsp;common&nbsp;CRC-32&nbsp;polynomial.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4273865">//&nbsp;Used&nbsp;by&nbsp;ethernet&nbsp;(IEEE&nbsp;802.3),&nbsp;v.42,&nbsp;fddi,&nbsp;gzip,&nbsp;zip,&nbsp;png,&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4273932">IEEE</span>&nbsp;<span class="op" id="4273937">=</span>&nbsp;<span class="num" id="4273939">0xedb88320</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4273952">//&nbsp;Castagnoli&#39;s&nbsp;polynomial,&nbsp;used&nbsp;in&nbsp;iSCSI.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4273996">//&nbsp;Has&nbsp;better&nbsp;error&nbsp;detection&nbsp;characteristics&nbsp;than&nbsp;IEEE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4274054">//&nbsp;http://dx.doi.org/10.1109/26.231911</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4274094">Castagnoli</span>&nbsp;<span class="op" id="4274105">=</span>&nbsp;<span class="num" id="4274107">0x82f63b78</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4274120">//&nbsp;Koopman&#39;s&nbsp;polynomial.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4274146">//&nbsp;Also&nbsp;has&nbsp;better&nbsp;error&nbsp;detection&nbsp;characteristics&nbsp;than&nbsp;IEEE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4274209">//&nbsp;http://dx.doi.org/10.1109/DSN.2002.1028931</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4274256">Koopman</span>&nbsp;<span class="op" id="4274264">=</span>&nbsp;<span class="num" id="4274266">0xeb31d82e</span><br>
<span class="lineno"></span><span class="op" id="4274277">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4274280">//&nbsp;Table&nbsp;is&nbsp;a&nbsp;256-word&nbsp;table&nbsp;representing&nbsp;the&nbsp;polynomial&nbsp;for&nbsp;efficient&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="4274363">type</span>&nbsp;<span class="ident" id="4274368">Table</span>&nbsp;<span class="op" id="4274374">[</span><span class="num" id="4274375">256</span><span class="op" id="4274378">]</span><span class="builtintype" id="4274379">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4274387">//&nbsp;castagnoliTable&nbsp;points&nbsp;to&nbsp;a&nbsp;lazily&nbsp;initialized&nbsp;Table&nbsp;for&nbsp;the&nbsp;Castagnoli</span><br>
<span class="lineno"></span><span class="comment" id="4274462">//&nbsp;polynomial.&nbsp;MakeTable&nbsp;will&nbsp;always&nbsp;return&nbsp;this&nbsp;value&nbsp;when&nbsp;asked&nbsp;to&nbsp;make&nbsp;a</span><br>
<span class="lineno">40</span><span class="comment" id="4274538">//&nbsp;Castagnoli&nbsp;table&nbsp;so&nbsp;we&nbsp;can&nbsp;compare&nbsp;against&nbsp;it&nbsp;to&nbsp;find&nbsp;when&nbsp;the&nbsp;caller&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4274614">//&nbsp;using&nbsp;this&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4274640">var</span>&nbsp;<span class="ident" id="4274644">castagnoliTable</span>&nbsp;<span class="op" id="4274660">*</span><span class="ident" id="4274661">Table</span><br>
<span class="lineno"></span><span class="keyword" id="4274667">var</span>&nbsp;<span class="ident" id="4274671">castagnoliOnce</span>&nbsp;<span class="ident" id="4274686">sync</span><span class="op" id="4274690">.</span><span class="ident" id="4274691">Once</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="4274697">func</span>&nbsp;<span class="ident" id="4274702">castagnoliInit</span><span class="op" id="4274716">(</span><span class="op" id="4274717">)</span>&nbsp;<span class="op" id="4274719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4274722">castagnoliTable</span>&nbsp;<span class="op" id="4274738">=</span>&nbsp;<span class="ident" id="4274740">makeTable</span><span class="op" id="4274749">(</span><span class="ident" id="4274750">Castagnoli</span><span class="op" id="4274760">)</span><br>
<span class="lineno"></span><span class="op" id="4274762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4274765">//&nbsp;IEEETable&nbsp;is&nbsp;the&nbsp;table&nbsp;for&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno">50</span><span class="keyword" id="4274816">var</span>&nbsp;<span class="ident" id="4274820">IEEETable</span>&nbsp;<span class="op" id="4274830">=</span>&nbsp;<span class="ident" id="4274832">makeTable</span><span class="op" id="4274841">(</span><span class="ident" id="4274842">IEEE</span><span class="op" id="4274846">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4274849">//&nbsp;MakeTable&nbsp;returns&nbsp;the&nbsp;Table&nbsp;constructed&nbsp;from&nbsp;the&nbsp;specified&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4274923">func</span>&nbsp;<span class="ident" id="4274928">MakeTable</span><span class="op" id="4274937">(</span><span class="ident" id="4274938">poly</span>&nbsp;<span class="builtintype" id="4274943">uint32</span><span class="op" id="4274949">)</span>&nbsp;<span class="op" id="4274951">*</span><span class="ident" id="4274952">Table</span>&nbsp;<span class="op" id="4274958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4274961">switch</span>&nbsp;<span class="ident" id="4274968">poly</span>&nbsp;<span class="op" id="4274973">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4274976">case</span>&nbsp;<span class="ident" id="4274981">IEEE</span><span class="op" id="4274985">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4274989">return</span>&nbsp;<span class="ident" id="4274996">IEEETable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4275007">case</span>&nbsp;<span class="ident" id="4275012">Castagnoli</span><span class="op" id="4275022">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4275026">castagnoliOnce</span><span class="op" id="4275040">.</span><span class="ident" id="4275041">Do</span><span class="op" id="4275043">(</span><span class="ident" id="4275044">castagnoliInit</span><span class="op" id="4275058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4275062">return</span>&nbsp;<span class="ident" id="4275069">castagnoliTable</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4275086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4275089">return</span>&nbsp;<span class="ident" id="4275096">makeTable</span><span class="op" id="4275105">(</span><span class="ident" id="4275106">poly</span><span class="op" id="4275110">)</span><br>
<span class="lineno"></span><span class="op" id="4275112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4275115">//&nbsp;makeTable&nbsp;returns&nbsp;the&nbsp;Table&nbsp;constructed&nbsp;from&nbsp;the&nbsp;specified&nbsp;polynomial.</span><br>
<span class="lineno">65</span><span class="keyword" id="4275189">func</span>&nbsp;<span class="ident" id="4275194">makeTable</span><span class="op" id="4275203">(</span><span class="ident" id="4275204">poly</span>&nbsp;<span class="builtintype" id="4275209">uint32</span><span class="op" id="4275215">)</span>&nbsp;<span class="op" id="4275217">*</span><span class="ident" id="4275218">Table</span>&nbsp;<span class="op" id="4275224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4275227">t</span>&nbsp;<span class="op" id="4275229">:=</span>&nbsp;<span class="builtinfunc" id="4275232">new</span><span class="op" id="4275235">(</span><span class="ident" id="4275236">Table</span><span class="op" id="4275241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4275244">for</span>&nbsp;<span class="ident" id="4275248">i</span>&nbsp;<span class="op" id="4275250">:=</span>&nbsp;<span class="num" id="4275253">0</span><span class="op" id="4275254">;</span>&nbsp;<span class="ident" id="4275256">i</span>&nbsp;<span class="op" id="4275258">&lt;</span>&nbsp;<span class="num" id="4275260">256</span><span class="op" id="4275263">;</span>&nbsp;<span class="ident" id="4275265">i</span><span class="op" id="4275266">++</span>&nbsp;<span class="op" id="4275269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4275273">crc</span>&nbsp;<span class="op" id="4275277">:=</span>&nbsp;<span class="builtintype" id="4275280">uint32</span><span class="op" id="4275286">(</span><span class="ident" id="4275287">i</span><span class="op" id="4275288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4275292">for</span>&nbsp;<span class="ident" id="4275296">j</span>&nbsp;<span class="op" id="4275298">:=</span>&nbsp;<span class="num" id="4275301">0</span><span class="op" id="4275302">;</span>&nbsp;<span class="ident" id="4275304">j</span>&nbsp;<span class="op" id="4275306">&lt;</span>&nbsp;<span class="num" id="4275308">8</span><span class="op" id="4275309">;</span>&nbsp;<span class="ident" id="4275311">j</span><span class="op" id="4275312">++</span>&nbsp;<span class="op" id="4275315">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4275320">if</span>&nbsp;<span class="ident" id="4275323">crc</span><span class="op" id="4275326">&amp;</span><span class="num" id="4275327">1</span>&nbsp;<span class="op" id="4275329">==</span>&nbsp;<span class="num" id="4275332">1</span>&nbsp;<span class="op" id="4275334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4275340">crc</span>&nbsp;<span class="op" id="4275344">=</span>&nbsp;<span class="op" id="4275346">(</span><span class="ident" id="4275347">crc</span>&nbsp;<span class="op" id="4275351">&gt;&gt;</span>&nbsp;<span class="num" id="4275354">1</span><span class="op" id="4275355">)</span>&nbsp;<span class="op" id="4275357">^</span>&nbsp;<span class="ident" id="4275359">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4275367">}</span>&nbsp;<span class="keyword" id="4275369">else</span>&nbsp;<span class="op" id="4275374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4275380">crc</span>&nbsp;<span class="op" id="4275384">&gt;&gt;=</span>&nbsp;<span class="num" id="4275388">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4275393">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4275397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4275401">t</span><span class="op" id="4275402">[</span><span class="ident" id="4275403">i</span><span class="op" id="4275404">]</span>&nbsp;<span class="op" id="4275406">=</span>&nbsp;<span class="ident" id="4275408">crc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4275413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4275416">return</span>&nbsp;<span class="ident" id="4275423">t</span><br>
<span class="lineno"></span><span class="op" id="4275425">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4275428">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4275487">type</span>&nbsp;<span class="ident" id="4275492">digest</span>&nbsp;<span class="keyword" id="4275499">struct</span>&nbsp;<span class="op" id="4275506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4275509">crc</span>&nbsp;<span class="builtintype" id="4275513">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4275521">tab</span>&nbsp;<span class="op" id="4275525">*</span><span class="ident" id="4275526">Table</span><br>
<span class="lineno">85</span><span class="op" id="4275532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4275535">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;new&nbsp;hash.Hash32&nbsp;computing&nbsp;the&nbsp;CRC-32&nbsp;checksum</span><br>
<span class="lineno"></span><span class="comment" id="4275598">//&nbsp;using&nbsp;the&nbsp;polynomial&nbsp;represented&nbsp;by&nbsp;the&nbsp;Table.</span><br>
<span class="lineno"></span><span class="keyword" id="4275648">func</span>&nbsp;<span class="ident" id="4275653">New</span><span class="op" id="4275656">(</span><span class="ident" id="4275657">tab</span>&nbsp;<span class="op" id="4275661">*</span><span class="ident" id="4275662">Table</span><span class="op" id="4275667">)</span>&nbsp;<span class="ident" id="4275669">hash</span><span class="op" id="4275673">.</span><span class="ident" id="4275674">Hash32</span>&nbsp;<span class="op" id="4275681">{</span>&nbsp;<span class="keyword" id="4275683">return</span>&nbsp;<span class="op" id="4275690">&amp;</span><span class="ident" id="4275691">digest</span><span class="op" id="4275697">{</span><span class="num" id="4275698">0</span><span class="op" id="4275699">,</span>&nbsp;<span class="ident" id="4275701">tab</span><span class="op" id="4275704">}</span>&nbsp;<span class="op" id="4275706">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4275709">//&nbsp;NewIEEE&nbsp;creates&nbsp;a&nbsp;new&nbsp;hash.Hash32&nbsp;computing&nbsp;the&nbsp;CRC-32&nbsp;checksum</span><br>
<span class="lineno"></span><span class="comment" id="4275776">//&nbsp;using&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4275806">func</span>&nbsp;<span class="ident" id="4275811">NewIEEE</span><span class="op" id="4275818">(</span><span class="op" id="4275819">)</span>&nbsp;<span class="ident" id="4275821">hash</span><span class="op" id="4275825">.</span><span class="ident" id="4275826">Hash32</span>&nbsp;<span class="op" id="4275833">{</span>&nbsp;<span class="keyword" id="4275835">return</span>&nbsp;<span class="ident" id="4275842">New</span><span class="op" id="4275845">(</span><span class="ident" id="4275846">IEEETable</span><span class="op" id="4275855">)</span>&nbsp;<span class="op" id="4275857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="4275860">func</span>&nbsp;<span class="op" id="4275865">(</span><span class="ident" id="4275866">d</span>&nbsp;<span class="op" id="4275868">*</span><span class="ident" id="4275869">digest</span><span class="op" id="4275875">)</span>&nbsp;<span class="ident" id="4275877">Size</span><span class="op" id="4275881">(</span><span class="op" id="4275882">)</span>&nbsp;<span class="builtintype" id="4275884">int</span>&nbsp;<span class="op" id="4275888">{</span>&nbsp;<span class="keyword" id="4275890">return</span>&nbsp;<span class="ident" id="4275897">Size</span>&nbsp;<span class="op" id="4275902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4275905">func</span>&nbsp;<span class="op" id="4275910">(</span><span class="ident" id="4275911">d</span>&nbsp;<span class="op" id="4275913">*</span><span class="ident" id="4275914">digest</span><span class="op" id="4275920">)</span>&nbsp;<span class="ident" id="4275922">BlockSize</span><span class="op" id="4275931">(</span><span class="op" id="4275932">)</span>&nbsp;<span class="builtintype" id="4275934">int</span>&nbsp;<span class="op" id="4275938">{</span>&nbsp;<span class="keyword" id="4275940">return</span>&nbsp;<span class="num" id="4275947">1</span>&nbsp;<span class="op" id="4275949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4275952">func</span>&nbsp;<span class="op" id="4275957">(</span><span class="ident" id="4275958">d</span>&nbsp;<span class="op" id="4275960">*</span><span class="ident" id="4275961">digest</span><span class="op" id="4275967">)</span>&nbsp;<span class="ident" id="4275969">Reset</span><span class="op" id="4275974">(</span><span class="op" id="4275975">)</span>&nbsp;<span class="op" id="4275977">{</span>&nbsp;<span class="ident" id="4275979">d</span><span class="op" id="4275980">.</span><span class="ident" id="4275981">crc</span>&nbsp;<span class="op" id="4275985">=</span>&nbsp;<span class="num" id="4275987">0</span>&nbsp;<span class="op" id="4275989">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4275992">func</span>&nbsp;<span class="ident" id="4275997">update</span><span class="op" id="4276003">(</span><span class="ident" id="4276004">crc</span>&nbsp;<span class="builtintype" id="4276008">uint32</span><span class="op" id="4276014">,</span>&nbsp;<span class="ident" id="4276016">tab</span>&nbsp;<span class="op" id="4276020">*</span><span class="ident" id="4276021">Table</span><span class="op" id="4276026">,</span>&nbsp;<span class="ident" id="4276028">p</span>&nbsp;<span class="op" id="4276030">[</span><span class="op" id="4276031">]</span><span class="builtintype" id="4276032">byte</span><span class="op" id="4276036">)</span>&nbsp;<span class="builtintype" id="4276038">uint32</span>&nbsp;<span class="op" id="4276045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4276048">crc</span>&nbsp;<span class="op" id="4276052">=</span>&nbsp;<span class="op" id="4276054">^</span><span class="ident" id="4276055">crc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4276060">for</span>&nbsp;<span class="ident" id="4276064">_</span><span class="op" id="4276065">,</span>&nbsp;<span class="ident" id="4276067">v</span>&nbsp;<span class="op" id="4276069">:=</span>&nbsp;<span class="keyword" id="4276072">range</span>&nbsp;<span class="ident" id="4276078">p</span>&nbsp;<span class="op" id="4276080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4276084">crc</span>&nbsp;<span class="op" id="4276088">=</span>&nbsp;<span class="ident" id="4276090">tab</span><span class="op" id="4276093">[</span><span class="builtintype" id="4276094">byte</span><span class="op" id="4276098">(</span><span class="ident" id="4276099">crc</span><span class="op" id="4276102">)</span><span class="op" id="4276103">^</span><span class="ident" id="4276104">v</span><span class="op" id="4276105">]</span>&nbsp;<span class="op" id="4276107">^</span>&nbsp;<span class="op" id="4276109">(</span><span class="ident" id="4276110">crc</span>&nbsp;<span class="op" id="4276114">&gt;&gt;</span>&nbsp;<span class="num" id="4276117">8</span><span class="op" id="4276118">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4276121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4276124">return</span>&nbsp;<span class="op" id="4276131">^</span><span class="ident" id="4276132">crc</span><br>
<span class="lineno"></span><span class="op" id="4276136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4276139">//&nbsp;Update&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;adding&nbsp;the&nbsp;bytes&nbsp;in&nbsp;p&nbsp;to&nbsp;the&nbsp;crc.</span><br>
<span class="lineno">110</span><span class="keyword" id="4276205">func</span>&nbsp;<span class="ident" id="4276210">Update</span><span class="op" id="4276216">(</span><span class="ident" id="4276217">crc</span>&nbsp;<span class="builtintype" id="4276221">uint32</span><span class="op" id="4276227">,</span>&nbsp;<span class="ident" id="4276229">tab</span>&nbsp;<span class="op" id="4276233">*</span><span class="ident" id="4276234">Table</span><span class="op" id="4276239">,</span>&nbsp;<span class="ident" id="4276241">p</span>&nbsp;<span class="op" id="4276243">[</span><span class="op" id="4276244">]</span><span class="builtintype" id="4276245">byte</span><span class="op" id="4276249">)</span>&nbsp;<span class="builtintype" id="4276251">uint32</span>&nbsp;<span class="op" id="4276258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4276261">if</span>&nbsp;<span class="ident" id="4276264">tab</span>&nbsp;<span class="op" id="4276268">==</span>&nbsp;<span class="ident" id="4276271">castagnoliTable</span>&nbsp;<span class="op" id="4276287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4276291">return</span>&nbsp;<span class="ident" id="4276298">updateCastagnoli</span><span class="op" id="4276314">(</span><span class="ident" id="4276315">crc</span><span class="op" id="4276318">,</span>&nbsp;<span class="ident" id="4276320">p</span><span class="op" id="4276321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4276324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4276327">return</span>&nbsp;<span class="ident" id="4276334">update</span><span class="op" id="4276340">(</span><span class="ident" id="4276341">crc</span><span class="op" id="4276344">,</span>&nbsp;<span class="ident" id="4276346">tab</span><span class="op" id="4276349">,</span>&nbsp;<span class="ident" id="4276351">p</span><span class="op" id="4276352">)</span><br>
<span class="lineno">115</span><span class="op" id="4276354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4276357">func</span>&nbsp;<span class="op" id="4276362">(</span><span class="ident" id="4276363">d</span>&nbsp;<span class="op" id="4276365">*</span><span class="ident" id="4276366">digest</span><span class="op" id="4276372">)</span>&nbsp;<span class="ident" id="4276374">Write</span><span class="op" id="4276379">(</span><span class="ident" id="4276380">p</span>&nbsp;<span class="op" id="4276382">[</span><span class="op" id="4276383">]</span><span class="builtintype" id="4276384">byte</span><span class="op" id="4276388">)</span>&nbsp;<span class="op" id="4276390">(</span><span class="ident" id="4276391">n</span>&nbsp;<span class="builtintype" id="4276393">int</span><span class="op" id="4276396">,</span>&nbsp;<span class="ident" id="4276398">err</span>&nbsp;<span class="builtintype" id="4276402">error</span><span class="op" id="4276407">)</span>&nbsp;<span class="op" id="4276409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4276412">d</span><span class="op" id="4276413">.</span><span class="ident" id="4276414">crc</span>&nbsp;<span class="op" id="4276418">=</span>&nbsp;<span class="ident" id="4276420">Update</span><span class="op" id="4276426">(</span><span class="ident" id="4276427">d</span><span class="op" id="4276428">.</span><span class="ident" id="4276429">crc</span><span class="op" id="4276432">,</span>&nbsp;<span class="ident" id="4276434">d</span><span class="op" id="4276435">.</span><span class="ident" id="4276436">tab</span><span class="op" id="4276439">,</span>&nbsp;<span class="ident" id="4276441">p</span><span class="op" id="4276442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4276445">return</span>&nbsp;<span class="builtinfunc" id="4276452">len</span><span class="op" id="4276455">(</span><span class="ident" id="4276456">p</span><span class="op" id="4276457">)</span><span class="op" id="4276458">,</span>&nbsp;<span class="builtintype" id="4276460">nil</span><br>
<span class="lineno">120</span><span class="op" id="4276464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4276467">func</span>&nbsp;<span class="op" id="4276472">(</span><span class="ident" id="4276473">d</span>&nbsp;<span class="op" id="4276475">*</span><span class="ident" id="4276476">digest</span><span class="op" id="4276482">)</span>&nbsp;<span class="ident" id="4276484">Sum32</span><span class="op" id="4276489">(</span><span class="op" id="4276490">)</span>&nbsp;<span class="builtintype" id="4276492">uint32</span>&nbsp;<span class="op" id="4276499">{</span>&nbsp;<span class="keyword" id="4276501">return</span>&nbsp;<span class="ident" id="4276508">d</span><span class="op" id="4276509">.</span><span class="ident" id="4276510">crc</span>&nbsp;<span class="op" id="4276514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4276517">func</span>&nbsp;<span class="op" id="4276522">(</span><span class="ident" id="4276523">d</span>&nbsp;<span class="op" id="4276525">*</span><span class="ident" id="4276526">digest</span><span class="op" id="4276532">)</span>&nbsp;<span class="ident" id="4276534">Sum</span><span class="op" id="4276537">(</span><span class="ident" id="4276538">in</span>&nbsp;<span class="op" id="4276541">[</span><span class="op" id="4276542">]</span><span class="builtintype" id="4276543">byte</span><span class="op" id="4276547">)</span>&nbsp;<span class="op" id="4276549">[</span><span class="op" id="4276550">]</span><span class="builtintype" id="4276551">byte</span>&nbsp;<span class="op" id="4276556">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4276559">s</span>&nbsp;<span class="op" id="4276561">:=</span>&nbsp;<span class="ident" id="4276564">d</span><span class="op" id="4276565">.</span><span class="ident" id="4276566">Sum32</span><span class="op" id="4276571">(</span><span class="op" id="4276572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4276575">return</span>&nbsp;<span class="builtinfunc" id="4276582">append</span><span class="op" id="4276588">(</span><span class="ident" id="4276589">in</span><span class="op" id="4276591">,</span>&nbsp;<span class="builtintype" id="4276593">byte</span><span class="op" id="4276597">(</span><span class="ident" id="4276598">s</span><span class="op" id="4276599">&gt;&gt;</span><span class="num" id="4276601">24</span><span class="op" id="4276603">)</span><span class="op" id="4276604">,</span>&nbsp;<span class="builtintype" id="4276606">byte</span><span class="op" id="4276610">(</span><span class="ident" id="4276611">s</span><span class="op" id="4276612">&gt;&gt;</span><span class="num" id="4276614">16</span><span class="op" id="4276616">)</span><span class="op" id="4276617">,</span>&nbsp;<span class="builtintype" id="4276619">byte</span><span class="op" id="4276623">(</span><span class="ident" id="4276624">s</span><span class="op" id="4276625">&gt;&gt;</span><span class="num" id="4276627">8</span><span class="op" id="4276628">)</span><span class="op" id="4276629">,</span>&nbsp;<span class="builtintype" id="4276631">byte</span><span class="op" id="4276635">(</span><span class="ident" id="4276636">s</span><span class="op" id="4276637">)</span><span class="op" id="4276638">)</span><br>
<span class="lineno"></span><span class="op" id="4276640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4276643">//&nbsp;Checksum&nbsp;returns&nbsp;the&nbsp;CRC-32&nbsp;checksum&nbsp;of&nbsp;data</span><br>
<span class="lineno">130</span><span class="comment" id="4276691">//&nbsp;using&nbsp;the&nbsp;polynomial&nbsp;represented&nbsp;by&nbsp;the&nbsp;Table.</span><br>
<span class="lineno"></span><span class="keyword" id="4276741">func</span>&nbsp;<span class="ident" id="4276746">Checksum</span><span class="op" id="4276754">(</span><span class="ident" id="4276755">data</span>&nbsp;<span class="op" id="4276760">[</span><span class="op" id="4276761">]</span><span class="builtintype" id="4276762">byte</span><span class="op" id="4276766">,</span>&nbsp;<span class="ident" id="4276768">tab</span>&nbsp;<span class="op" id="4276772">*</span><span class="ident" id="4276773">Table</span><span class="op" id="4276778">)</span>&nbsp;<span class="builtintype" id="4276780">uint32</span>&nbsp;<span class="op" id="4276787">{</span>&nbsp;<span class="keyword" id="4276789">return</span>&nbsp;<span class="ident" id="4276796">Update</span><span class="op" id="4276802">(</span><span class="num" id="4276803">0</span><span class="op" id="4276804">,</span>&nbsp;<span class="ident" id="4276806">tab</span><span class="op" id="4276809">,</span>&nbsp;<span class="ident" id="4276811">data</span><span class="op" id="4276815">)</span>&nbsp;<span class="op" id="4276817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4276820">//&nbsp;ChecksumIEEE&nbsp;returns&nbsp;the&nbsp;CRC-32&nbsp;checksum&nbsp;of&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="4276872">//&nbsp;using&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno">135</span><span class="keyword" id="4276902">func</span>&nbsp;<span class="ident" id="4276907">ChecksumIEEE</span><span class="op" id="4276919">(</span><span class="ident" id="4276920">data</span>&nbsp;<span class="op" id="4276925">[</span><span class="op" id="4276926">]</span><span class="builtintype" id="4276927">byte</span><span class="op" id="4276931">)</span>&nbsp;<span class="builtintype" id="4276933">uint32</span>&nbsp;<span class="op" id="4276940">{</span>&nbsp;<span class="keyword" id="4276942">return</span>&nbsp;<span class="ident" id="4276949">update</span><span class="op" id="4276955">(</span><span class="num" id="4276956">0</span><span class="op" id="4276957">,</span>&nbsp;<span class="ident" id="4276959">IEEETable</span><span class="op" id="4276968">,</span>&nbsp;<span class="ident" id="4276970">data</span><span class="op" id="4276974">)</span>&nbsp;<span class="op" id="4276976">}</span>
</div>
</body>
</html>
