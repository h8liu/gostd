<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6781300">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6781355">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6781409">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6781460">package</span>&nbsp;<span class="ident" id="6781468">dsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6781473">import</span>&nbsp;<span class="op" id="6781480">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6781483">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6781498">&#34;math/big&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6781510">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6781520">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6781523">func</span>&nbsp;<span class="ident" id="6781528">testSignAndVerify</span><span class="op" id="6781545">(</span><span class="ident" id="6781546">t</span>&nbsp;<span class="op" id="6781548">*</span><span class="ident" id="6781549">testing</span><span class="op" id="6781556">.</span><span class="ident" id="6781557">T</span><span class="op" id="6781558">,</span>&nbsp;<span class="ident" id="6781560">i</span>&nbsp;<span class="builtintype" id="6781562">int</span><span class="op" id="6781565">,</span>&nbsp;<span class="ident" id="6781567">priv</span>&nbsp;<span class="op" id="6781572">*</span><span class="ident" id="6781573">PrivateKey</span><span class="op" id="6781583">)</span>&nbsp;<span class="op" id="6781585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6781588">hashed</span>&nbsp;<span class="op" id="6781595">:=</span>&nbsp;<span class="op" id="6781598">[</span><span class="op" id="6781599">]</span><span class="builtintype" id="6781600">byte</span><span class="op" id="6781604">(</span><span class="string" id="6781605">&#34;testing&#34;</span><span class="op" id="6781614">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6781617">r</span><span class="op" id="6781618">,</span>&nbsp;<span class="ident" id="6781620">s</span><span class="op" id="6781621">,</span>&nbsp;<span class="ident" id="6781623">err</span>&nbsp;<span class="op" id="6781627">:=</span>&nbsp;<span class="ident" id="6781630">Sign</span><span class="op" id="6781634">(</span><span class="ident" id="6781635">rand</span><span class="op" id="6781639">.</span><span class="ident" id="6781640">Reader</span><span class="op" id="6781646">,</span>&nbsp;<span class="ident" id="6781648">priv</span><span class="op" id="6781652">,</span>&nbsp;<span class="ident" id="6781654">hashed</span><span class="op" id="6781660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6781663">if</span>&nbsp;<span class="ident" id="6781666">err</span>&nbsp;<span class="op" id="6781670">!=</span>&nbsp;<span class="ident" id="6781673">nil</span>&nbsp;<span class="op" id="6781677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6781681">t</span><span class="op" id="6781682">.</span><span class="ident" id="6781683">Errorf</span><span class="op" id="6781689">(</span><span class="string" id="6781690">&#34;%d:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="6781713">,</span>&nbsp;<span class="ident" id="6781715">i</span><span class="op" id="6781716">,</span>&nbsp;<span class="ident" id="6781718">err</span><span class="op" id="6781721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6781725">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6781733">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6781737">if</span>&nbsp;<span class="op" id="6781740">!</span><span class="ident" id="6781741">Verify</span><span class="op" id="6781747">(</span><span class="op" id="6781748">&amp;</span><span class="ident" id="6781749">priv</span><span class="op" id="6781753">.</span><span class="ident" id="6781754">PublicKey</span><span class="op" id="6781763">,</span>&nbsp;<span class="ident" id="6781765">hashed</span><span class="op" id="6781771">,</span>&nbsp;<span class="ident" id="6781773">r</span><span class="op" id="6781774">,</span>&nbsp;<span class="ident" id="6781776">s</span><span class="op" id="6781777">)</span>&nbsp;<span class="op" id="6781779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6781783">t</span><span class="op" id="6781784">.</span><span class="ident" id="6781785">Errorf</span><span class="op" id="6781791">(</span><span class="string" id="6781792">&#34;%d:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="6781811">,</span>&nbsp;<span class="ident" id="6781813">i</span><span class="op" id="6781814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6781817">}</span><br>
<span class="lineno"></span><span class="op" id="6781819">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6781822">func</span>&nbsp;<span class="ident" id="6781827">testParameterGeneration</span><span class="op" id="6781850">(</span><span class="ident" id="6781851">t</span>&nbsp;<span class="op" id="6781853">*</span><span class="ident" id="6781854">testing</span><span class="op" id="6781861">.</span><span class="ident" id="6781862">T</span><span class="op" id="6781863">,</span>&nbsp;<span class="ident" id="6781865">sizes</span>&nbsp;<span class="ident" id="6781871">ParameterSizes</span><span class="op" id="6781885">,</span>&nbsp;<span class="ident" id="6781887">L</span><span class="op" id="6781888">,</span>&nbsp;<span class="ident" id="6781890">N</span>&nbsp;<span class="builtintype" id="6781892">int</span><span class="op" id="6781895">)</span>&nbsp;<span class="op" id="6781897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6781900">var</span>&nbsp;<span class="ident" id="6781904">priv</span>&nbsp;<span class="ident" id="6781909">PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6781921">params</span>&nbsp;<span class="op" id="6781928">:=</span>&nbsp;<span class="op" id="6781931">&amp;</span><span class="ident" id="6781932">priv</span><span class="op" id="6781936">.</span><span class="ident" id="6781937">Parameters</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6781950">err</span>&nbsp;<span class="op" id="6781954">:=</span>&nbsp;<span class="ident" id="6781957">GenerateParameters</span><span class="op" id="6781975">(</span><span class="ident" id="6781976">params</span><span class="op" id="6781982">,</span>&nbsp;<span class="ident" id="6781984">rand</span><span class="op" id="6781988">.</span><span class="ident" id="6781989">Reader</span><span class="op" id="6781995">,</span>&nbsp;<span class="ident" id="6781997">sizes</span><span class="op" id="6782002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6782005">if</span>&nbsp;<span class="ident" id="6782008">err</span>&nbsp;<span class="op" id="6782012">!=</span>&nbsp;<span class="ident" id="6782015">nil</span>&nbsp;<span class="op" id="6782019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782023">t</span><span class="op" id="6782024">.</span><span class="ident" id="6782025">Errorf</span><span class="op" id="6782031">(</span><span class="string" id="6782032">&#34;%d:&nbsp;%s&#34;</span><span class="op" id="6782040">,</span>&nbsp;<span class="builtintype" id="6782042">int</span><span class="op" id="6782045">(</span><span class="ident" id="6782046">sizes</span><span class="op" id="6782051">)</span><span class="op" id="6782052">,</span>&nbsp;<span class="ident" id="6782054">err</span><span class="op" id="6782057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6782061">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782069">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6782073">if</span>&nbsp;<span class="ident" id="6782076">params</span><span class="op" id="6782082">.</span><span class="ident" id="6782083">P</span><span class="op" id="6782084">.</span><span class="ident" id="6782085">BitLen</span><span class="op" id="6782091">(</span><span class="op" id="6782092">)</span>&nbsp;<span class="op" id="6782094">!=</span>&nbsp;<span class="ident" id="6782097">L</span>&nbsp;<span class="op" id="6782099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782103">t</span><span class="op" id="6782104">.</span><span class="ident" id="6782105">Errorf</span><span class="op" id="6782111">(</span><span class="string" id="6782112">&#34;%d:&nbsp;params.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="6782146">,</span>&nbsp;<span class="builtintype" id="6782148">int</span><span class="op" id="6782151">(</span><span class="ident" id="6782152">sizes</span><span class="op" id="6782157">)</span><span class="op" id="6782158">,</span>&nbsp;<span class="ident" id="6782160">params</span><span class="op" id="6782166">.</span><span class="ident" id="6782167">P</span><span class="op" id="6782168">.</span><span class="ident" id="6782169">BitLen</span><span class="op" id="6782175">(</span><span class="op" id="6782176">)</span><span class="op" id="6782177">,</span>&nbsp;<span class="ident" id="6782179">L</span><span class="op" id="6782180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6782187">if</span>&nbsp;<span class="ident" id="6782190">params</span><span class="op" id="6782196">.</span><span class="ident" id="6782197">Q</span><span class="op" id="6782198">.</span><span class="ident" id="6782199">BitLen</span><span class="op" id="6782205">(</span><span class="op" id="6782206">)</span>&nbsp;<span class="op" id="6782208">!=</span>&nbsp;<span class="ident" id="6782211">N</span>&nbsp;<span class="op" id="6782213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782217">t</span><span class="op" id="6782218">.</span><span class="ident" id="6782219">Errorf</span><span class="op" id="6782225">(</span><span class="string" id="6782226">&#34;%d:&nbsp;q.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="6782255">,</span>&nbsp;<span class="builtintype" id="6782257">int</span><span class="op" id="6782260">(</span><span class="ident" id="6782261">sizes</span><span class="op" id="6782266">)</span><span class="op" id="6782267">,</span>&nbsp;<span class="ident" id="6782269">params</span><span class="op" id="6782275">.</span><span class="ident" id="6782276">Q</span><span class="op" id="6782277">.</span><span class="ident" id="6782278">BitLen</span><span class="op" id="6782284">(</span><span class="op" id="6782285">)</span><span class="op" id="6782286">,</span>&nbsp;<span class="ident" id="6782288">L</span><span class="op" id="6782289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782296">one</span>&nbsp;<span class="op" id="6782300">:=</span>&nbsp;<span class="builtinfunc" id="6782303">new</span><span class="op" id="6782306">(</span><span class="ident" id="6782307">big</span><span class="op" id="6782310">.</span><span class="ident" id="6782311">Int</span><span class="op" id="6782314">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782317">one</span><span class="op" id="6782320">.</span><span class="ident" id="6782321">SetInt64</span><span class="op" id="6782329">(</span><span class="num" id="6782330">1</span><span class="op" id="6782331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782334">pm1</span>&nbsp;<span class="op" id="6782338">:=</span>&nbsp;<span class="builtinfunc" id="6782341">new</span><span class="op" id="6782344">(</span><span class="ident" id="6782345">big</span><span class="op" id="6782348">.</span><span class="ident" id="6782349">Int</span><span class="op" id="6782352">)</span><span class="op" id="6782353">.</span><span class="ident" id="6782354">Sub</span><span class="op" id="6782357">(</span><span class="ident" id="6782358">params</span><span class="op" id="6782364">.</span><span class="ident" id="6782365">P</span><span class="op" id="6782366">,</span>&nbsp;<span class="ident" id="6782368">one</span><span class="op" id="6782371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782374">quo</span><span class="op" id="6782377">,</span>&nbsp;<span class="ident" id="6782379">rem</span>&nbsp;<span class="op" id="6782383">:=</span>&nbsp;<span class="builtinfunc" id="6782386">new</span><span class="op" id="6782389">(</span><span class="ident" id="6782390">big</span><span class="op" id="6782393">.</span><span class="ident" id="6782394">Int</span><span class="op" id="6782397">)</span><span class="op" id="6782398">.</span><span class="ident" id="6782399">DivMod</span><span class="op" id="6782405">(</span><span class="ident" id="6782406">pm1</span><span class="op" id="6782409">,</span>&nbsp;<span class="ident" id="6782411">params</span><span class="op" id="6782417">.</span><span class="ident" id="6782418">Q</span><span class="op" id="6782419">,</span>&nbsp;<span class="builtinfunc" id="6782421">new</span><span class="op" id="6782424">(</span><span class="ident" id="6782425">big</span><span class="op" id="6782428">.</span><span class="ident" id="6782429">Int</span><span class="op" id="6782432">)</span><span class="op" id="6782433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6782436">if</span>&nbsp;<span class="ident" id="6782439">rem</span><span class="op" id="6782442">.</span><span class="ident" id="6782443">Sign</span><span class="op" id="6782447">(</span><span class="op" id="6782448">)</span>&nbsp;<span class="op" id="6782450">!=</span>&nbsp;<span class="num" id="6782453">0</span>&nbsp;<span class="op" id="6782455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782459">t</span><span class="op" id="6782460">.</span><span class="ident" id="6782461">Errorf</span><span class="op" id="6782467">(</span><span class="string" id="6782468">&#34;%d:&nbsp;p-1&nbsp;mod&nbsp;q&nbsp;!=&nbsp;0&#34;</span><span class="op" id="6782488">,</span>&nbsp;<span class="builtintype" id="6782490">int</span><span class="op" id="6782493">(</span><span class="ident" id="6782494">sizes</span><span class="op" id="6782499">)</span><span class="op" id="6782500">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782506">x</span>&nbsp;<span class="op" id="6782508">:=</span>&nbsp;<span class="builtinfunc" id="6782511">new</span><span class="op" id="6782514">(</span><span class="ident" id="6782515">big</span><span class="op" id="6782518">.</span><span class="ident" id="6782519">Int</span><span class="op" id="6782522">)</span><span class="op" id="6782523">.</span><span class="ident" id="6782524">Exp</span><span class="op" id="6782527">(</span><span class="ident" id="6782528">params</span><span class="op" id="6782534">.</span><span class="ident" id="6782535">G</span><span class="op" id="6782536">,</span>&nbsp;<span class="ident" id="6782538">quo</span><span class="op" id="6782541">,</span>&nbsp;<span class="ident" id="6782543">params</span><span class="op" id="6782549">.</span><span class="ident" id="6782550">P</span><span class="op" id="6782551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6782554">if</span>&nbsp;<span class="ident" id="6782557">x</span><span class="op" id="6782558">.</span><span class="ident" id="6782559">Cmp</span><span class="op" id="6782562">(</span><span class="ident" id="6782563">one</span><span class="op" id="6782566">)</span>&nbsp;<span class="op" id="6782568">==</span>&nbsp;<span class="num" id="6782571">0</span>&nbsp;<span class="op" id="6782573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782577">t</span><span class="op" id="6782578">.</span><span class="ident" id="6782579">Errorf</span><span class="op" id="6782585">(</span><span class="string" id="6782586">&#34;%d:&nbsp;invalid&nbsp;generator&#34;</span><span class="op" id="6782609">,</span>&nbsp;<span class="builtintype" id="6782611">int</span><span class="op" id="6782614">(</span><span class="ident" id="6782615">sizes</span><span class="op" id="6782620">)</span><span class="op" id="6782621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782624">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782628">err</span>&nbsp;<span class="op" id="6782632">=</span>&nbsp;<span class="ident" id="6782634">GenerateKey</span><span class="op" id="6782645">(</span><span class="op" id="6782646">&amp;</span><span class="ident" id="6782647">priv</span><span class="op" id="6782651">,</span>&nbsp;<span class="ident" id="6782653">rand</span><span class="op" id="6782657">.</span><span class="ident" id="6782658">Reader</span><span class="op" id="6782664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6782667">if</span>&nbsp;<span class="ident" id="6782670">err</span>&nbsp;<span class="op" id="6782674">!=</span>&nbsp;<span class="ident" id="6782677">nil</span>&nbsp;<span class="op" id="6782681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782685">t</span><span class="op" id="6782686">.</span><span class="ident" id="6782687">Errorf</span><span class="op" id="6782693">(</span><span class="string" id="6782694">&#34;error&nbsp;generating&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6782720">,</span>&nbsp;<span class="ident" id="6782722">err</span><span class="op" id="6782725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6782729">return</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782741">testSignAndVerify</span><span class="op" id="6782758">(</span><span class="ident" id="6782759">t</span><span class="op" id="6782760">,</span>&nbsp;<span class="builtintype" id="6782762">int</span><span class="op" id="6782765">(</span><span class="ident" id="6782766">sizes</span><span class="op" id="6782771">)</span><span class="op" id="6782772">,</span>&nbsp;<span class="op" id="6782774">&amp;</span><span class="ident" id="6782775">priv</span><span class="op" id="6782779">)</span><br>
<span class="lineno"></span><span class="op" id="6782781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6782784">func</span>&nbsp;<span class="ident" id="6782789">TestParameterGeneration</span><span class="op" id="6782812">(</span><span class="ident" id="6782813">t</span>&nbsp;<span class="op" id="6782815">*</span><span class="ident" id="6782816">testing</span><span class="op" id="6782823">.</span><span class="ident" id="6782824">T</span><span class="op" id="6782825">)</span>&nbsp;<span class="op" id="6782827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6782830">if</span>&nbsp;<span class="ident" id="6782833">testing</span><span class="op" id="6782840">.</span><span class="ident" id="6782841">Short</span><span class="op" id="6782846">(</span><span class="op" id="6782847">)</span>&nbsp;<span class="op" id="6782849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782853">t</span><span class="op" id="6782854">.</span><span class="ident" id="6782855">Skip</span><span class="op" id="6782859">(</span><span class="string" id="6782860">&#34;skipping&nbsp;parameter&nbsp;generation&nbsp;test&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="6782910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782917">testParameterGeneration</span><span class="op" id="6782940">(</span><span class="ident" id="6782941">t</span><span class="op" id="6782942">,</span>&nbsp;<span class="ident" id="6782944">L1024N160</span><span class="op" id="6782953">,</span>&nbsp;<span class="num" id="6782955">1024</span><span class="op" id="6782959">,</span>&nbsp;<span class="num" id="6782961">160</span><span class="op" id="6782964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782967">testParameterGeneration</span><span class="op" id="6782990">(</span><span class="ident" id="6782991">t</span><span class="op" id="6782992">,</span>&nbsp;<span class="ident" id="6782994">L2048N224</span><span class="op" id="6783003">,</span>&nbsp;<span class="num" id="6783005">2048</span><span class="op" id="6783009">,</span>&nbsp;<span class="num" id="6783011">224</span><span class="op" id="6783014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783017">testParameterGeneration</span><span class="op" id="6783040">(</span><span class="ident" id="6783041">t</span><span class="op" id="6783042">,</span>&nbsp;<span class="ident" id="6783044">L2048N256</span><span class="op" id="6783053">,</span>&nbsp;<span class="num" id="6783055">2048</span><span class="op" id="6783059">,</span>&nbsp;<span class="num" id="6783061">256</span><span class="op" id="6783064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783067">testParameterGeneration</span><span class="op" id="6783090">(</span><span class="ident" id="6783091">t</span><span class="op" id="6783092">,</span>&nbsp;<span class="ident" id="6783094">L3072N256</span><span class="op" id="6783103">,</span>&nbsp;<span class="num" id="6783105">3072</span><span class="op" id="6783109">,</span>&nbsp;<span class="num" id="6783111">256</span><span class="op" id="6783114">)</span><br>
<span class="lineno"></span><span class="op" id="6783116">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="6783119">func</span>&nbsp;<span class="ident" id="6783124">TestSignAndVerify</span><span class="op" id="6783141">(</span><span class="ident" id="6783142">t</span>&nbsp;<span class="op" id="6783144">*</span><span class="ident" id="6783145">testing</span><span class="op" id="6783152">.</span><span class="ident" id="6783153">T</span><span class="op" id="6783154">)</span>&nbsp;<span class="op" id="6783156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6783159">var</span>&nbsp;<span class="ident" id="6783163">priv</span>&nbsp;<span class="ident" id="6783168">PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783180">priv</span><span class="op" id="6783184">.</span><span class="ident" id="6783185">P</span><span class="op" id="6783186">,</span>&nbsp;<span class="ident" id="6783188">_</span>&nbsp;<span class="op" id="6783190">=</span>&nbsp;<span class="builtinfunc" id="6783192">new</span><span class="op" id="6783195">(</span><span class="ident" id="6783196">big</span><span class="op" id="6783199">.</span><span class="ident" id="6783200">Int</span><span class="op" id="6783203">)</span><span class="op" id="6783204">.</span><span class="ident" id="6783205">SetString</span><span class="op" id="6783214">(</span><span class="string" id="6783215">&#34;A9B5B793FB4785793D246BAE77E8FF63CA52F442DA763C440259919FE1BC1D6065A9350637A04F75A2F039401D49F08E066C4D275A5A65DA5684BC563C14289D7AB8A67163BFBF79D85972619AD2CFF55AB0EE77A9002B0EF96293BDD0F42685EBB2C66C327079F6C98000FBCB79AACDE1BC6F9D5C7B1A97E3D9D54ED7951FEF&#34;</span><span class="op" id="6783473">,</span>&nbsp;<span class="num" id="6783475">16</span><span class="op" id="6783477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783480">priv</span><span class="op" id="6783484">.</span><span class="ident" id="6783485">Q</span><span class="op" id="6783486">,</span>&nbsp;<span class="ident" id="6783488">_</span>&nbsp;<span class="op" id="6783490">=</span>&nbsp;<span class="builtinfunc" id="6783492">new</span><span class="op" id="6783495">(</span><span class="ident" id="6783496">big</span><span class="op" id="6783499">.</span><span class="ident" id="6783500">Int</span><span class="op" id="6783503">)</span><span class="op" id="6783504">.</span><span class="ident" id="6783505">SetString</span><span class="op" id="6783514">(</span><span class="string" id="6783515">&#34;E1D3391245933D68A0714ED34BBCB7A1F422B9C1&#34;</span><span class="op" id="6783557">,</span>&nbsp;<span class="num" id="6783559">16</span><span class="op" id="6783561">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783564">priv</span><span class="op" id="6783568">.</span><span class="ident" id="6783569">G</span><span class="op" id="6783570">,</span>&nbsp;<span class="ident" id="6783572">_</span>&nbsp;<span class="op" id="6783574">=</span>&nbsp;<span class="builtinfunc" id="6783576">new</span><span class="op" id="6783579">(</span><span class="ident" id="6783580">big</span><span class="op" id="6783583">.</span><span class="ident" id="6783584">Int</span><span class="op" id="6783587">)</span><span class="op" id="6783588">.</span><span class="ident" id="6783589">SetString</span><span class="op" id="6783598">(</span><span class="string" id="6783599">&#34;634364FC25248933D01D1993ECABD0657CC0CB2CEED7ED2E3E8AECDFCDC4A25C3B15E9E3B163ACA2984B5539181F3EFF1A5E8903D71D5B95DA4F27202B77D2C44B430BB53741A8D59A8F86887525C9F2A6A5980A195EAA7F2FF910064301DEF89D3AA213E1FAC7768D89365318E370AF54A112EFBA9246D9158386BA1B4EEFDA&#34;</span><span class="op" id="6783857">,</span>&nbsp;<span class="num" id="6783859">16</span><span class="op" id="6783861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783864">priv</span><span class="op" id="6783868">.</span><span class="ident" id="6783869">Y</span><span class="op" id="6783870">,</span>&nbsp;<span class="ident" id="6783872">_</span>&nbsp;<span class="op" id="6783874">=</span>&nbsp;<span class="builtinfunc" id="6783876">new</span><span class="op" id="6783879">(</span><span class="ident" id="6783880">big</span><span class="op" id="6783883">.</span><span class="ident" id="6783884">Int</span><span class="op" id="6783887">)</span><span class="op" id="6783888">.</span><span class="ident" id="6783889">SetString</span><span class="op" id="6783898">(</span><span class="string" id="6783899">&#34;32969E5780CFE1C849A1C276D7AEB4F38A23B591739AA2FE197349AEEBD31366AEE5EB7E6C6DDB7C57D02432B30DB5AA66D9884299FAA72568944E4EEDC92EA3FBC6F39F53412FBCC563208F7C15B737AC8910DBC2D9C9B8C001E72FDC40EB694AB1F06A5A2DBD18D9E36C66F31F566742F11EC0A52E9F7B89355C02FB5D32D2&#34;</span><span class="op" id="6784157">,</span>&nbsp;<span class="num" id="6784159">16</span><span class="op" id="6784161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6784164">priv</span><span class="op" id="6784168">.</span><span class="ident" id="6784169">X</span><span class="op" id="6784170">,</span>&nbsp;<span class="ident" id="6784172">_</span>&nbsp;<span class="op" id="6784174">=</span>&nbsp;<span class="builtinfunc" id="6784176">new</span><span class="op" id="6784179">(</span><span class="ident" id="6784180">big</span><span class="op" id="6784183">.</span><span class="ident" id="6784184">Int</span><span class="op" id="6784187">)</span><span class="op" id="6784188">.</span><span class="ident" id="6784189">SetString</span><span class="op" id="6784198">(</span><span class="string" id="6784199">&#34;5078D4D29795CBE76D3AACFE48C9AF0BCDBEE91A&#34;</span><span class="op" id="6784241">,</span>&nbsp;<span class="num" id="6784243">16</span><span class="op" id="6784245">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6784249">testSignAndVerify</span><span class="op" id="6784266">(</span><span class="ident" id="6784267">t</span><span class="op" id="6784268">,</span>&nbsp;<span class="num" id="6784270">0</span><span class="op" id="6784271">,</span>&nbsp;<span class="op" id="6784273">&amp;</span><span class="ident" id="6784274">priv</span><span class="op" id="6784278">)</span><br>
<span class="lineno">85</span><span class="op" id="6784280">}</span>
</div>
</body>
</html>
