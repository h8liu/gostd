<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/md5</h2>
<ul>
<li><a href="/gostd/crypto/md5/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5.go.html" class="current">md5.go</a></li>
<li><a href="/gostd/crypto/md5/md5_test.go.html">md5_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5block.go.html">md5block.go</a></li>
<li><a href="/gostd/crypto/md5/md5block_decl.go.html">md5block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3894505">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3894560">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3894614">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3894665">//go:generate&nbsp;go&nbsp;run&nbsp;gen.go&nbsp;-full&nbsp;-output&nbsp;md5block.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3894720">//&nbsp;Package&nbsp;md5&nbsp;implements&nbsp;the&nbsp;MD5&nbsp;hash&nbsp;algorithm&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;1321.</span><br>
<span class="lineno"></span><span class="keyword" id="3894793">package</span>&nbsp;<span class="ident" id="3894801">md5</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3894806">import</span>&nbsp;<span class="op" id="3894813">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3894816">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3894826">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="3894833">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3894836">func</span>&nbsp;<span class="ident" id="3894841">init</span><span class="op" id="3894845">(</span><span class="op" id="3894846">)</span>&nbsp;<span class="op" id="3894848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894851">crypto</span><span class="op" id="3894857">.</span><span class="ident" id="3894858">RegisterHash</span><span class="op" id="3894870">(</span><span class="ident" id="3894871">crypto</span><span class="op" id="3894877">.</span><span class="ident" id="3894878">MD5</span><span class="op" id="3894881">,</span>&nbsp;<span class="ident" id="3894883">New</span><span class="op" id="3894886">)</span><br>
<span class="lineno"></span><span class="op" id="3894888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3894891">//&nbsp;The&nbsp;size&nbsp;of&nbsp;an&nbsp;MD5&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="3894932">const</span>&nbsp;<span class="ident" id="3894938">Size</span>&nbsp;<span class="op" id="3894943">=</span>&nbsp;<span class="num" id="3894945">16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3894949">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;MD5&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3894983">const</span>&nbsp;<span class="ident" id="3894989">BlockSize</span>&nbsp;<span class="op" id="3894999">=</span>&nbsp;<span class="num" id="3895001">64</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3895005">const</span>&nbsp;<span class="op" id="3895011">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895014">chunk</span>&nbsp;<span class="op" id="3895020">=</span>&nbsp;<span class="num" id="3895022">64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895026">init0</span>&nbsp;<span class="op" id="3895032">=</span>&nbsp;<span class="num" id="3895034">0x67452301</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895046">init1</span>&nbsp;<span class="op" id="3895052">=</span>&nbsp;<span class="num" id="3895054">0xEFCDAB89</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895066">init2</span>&nbsp;<span class="op" id="3895072">=</span>&nbsp;<span class="num" id="3895074">0x98BADCFE</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895086">init3</span>&nbsp;<span class="op" id="3895092">=</span>&nbsp;<span class="num" id="3895094">0x10325476</span><br>
<span class="lineno"></span><span class="op" id="3895105">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3895108">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="3895167">type</span>&nbsp;<span class="ident" id="3895172">digest</span>&nbsp;<span class="keyword" id="3895179">struct</span>&nbsp;<span class="op" id="3895186">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895189">s</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3895193">[</span><span class="num" id="3895194">4</span><span class="op" id="3895195">]</span><span class="builtintype" id="3895196">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895204">x</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3895208">[</span><span class="ident" id="3895209">chunk</span><span class="op" id="3895214">]</span><span class="builtintype" id="3895215">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895221">nx</span>&nbsp;&nbsp;<span class="builtintype" id="3895225">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3895230">len</span>&nbsp;<span class="ident" id="3895234">uint64</span><br>
<span class="lineno"></span><span class="op" id="3895241">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3895244">func</span>&nbsp;<span class="op" id="3895249">(</span><span class="ident" id="3895250">d</span>&nbsp;<span class="op" id="3895252">*</span><span class="ident" id="3895253">digest</span><span class="op" id="3895259">)</span>&nbsp;<span class="ident" id="3895261">Reset</span><span class="op" id="3895266">(</span><span class="op" id="3895267">)</span>&nbsp;<span class="op" id="3895269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895272">d</span><span class="op" id="3895273">.</span><span class="ident" id="3895274">s</span><span class="op" id="3895275">[</span><span class="num" id="3895276">0</span><span class="op" id="3895277">]</span>&nbsp;<span class="op" id="3895279">=</span>&nbsp;<span class="ident" id="3895281">init0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895288">d</span><span class="op" id="3895289">.</span><span class="ident" id="3895290">s</span><span class="op" id="3895291">[</span><span class="num" id="3895292">1</span><span class="op" id="3895293">]</span>&nbsp;<span class="op" id="3895295">=</span>&nbsp;<span class="ident" id="3895297">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895304">d</span><span class="op" id="3895305">.</span><span class="ident" id="3895306">s</span><span class="op" id="3895307">[</span><span class="num" id="3895308">2</span><span class="op" id="3895309">]</span>&nbsp;<span class="op" id="3895311">=</span>&nbsp;<span class="ident" id="3895313">init2</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895320">d</span><span class="op" id="3895321">.</span><span class="ident" id="3895322">s</span><span class="op" id="3895323">[</span><span class="num" id="3895324">3</span><span class="op" id="3895325">]</span>&nbsp;<span class="op" id="3895327">=</span>&nbsp;<span class="ident" id="3895329">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895336">d</span><span class="op" id="3895337">.</span><span class="ident" id="3895338">nx</span>&nbsp;<span class="op" id="3895341">=</span>&nbsp;<span class="num" id="3895343">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895346">d</span><span class="op" id="3895347">.</span><span class="builtinfunc" id="3895348">len</span>&nbsp;<span class="op" id="3895352">=</span>&nbsp;<span class="num" id="3895354">0</span><br>
<span class="lineno"></span><span class="op" id="3895356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="3895359">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;MD5&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="3895418">func</span>&nbsp;<span class="ident" id="3895423">New</span><span class="op" id="3895426">(</span><span class="op" id="3895427">)</span>&nbsp;<span class="ident" id="3895429">hash</span><span class="op" id="3895433">.</span><span class="ident" id="3895434">Hash</span>&nbsp;<span class="op" id="3895439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895442">d</span>&nbsp;<span class="op" id="3895444">:=</span>&nbsp;<span class="builtinfunc" id="3895447">new</span><span class="op" id="3895450">(</span><span class="ident" id="3895451">digest</span><span class="op" id="3895457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895460">d</span><span class="op" id="3895461">.</span><span class="ident" id="3895462">Reset</span><span class="op" id="3895467">(</span><span class="op" id="3895468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3895471">return</span>&nbsp;<span class="ident" id="3895478">d</span><br>
<span class="lineno">55</span><span class="op" id="3895480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3895483">func</span>&nbsp;<span class="op" id="3895488">(</span><span class="ident" id="3895489">d</span>&nbsp;<span class="op" id="3895491">*</span><span class="ident" id="3895492">digest</span><span class="op" id="3895498">)</span>&nbsp;<span class="ident" id="3895500">Size</span><span class="op" id="3895504">(</span><span class="op" id="3895505">)</span>&nbsp;<span class="builtintype" id="3895507">int</span>&nbsp;<span class="op" id="3895511">{</span>&nbsp;<span class="keyword" id="3895513">return</span>&nbsp;<span class="ident" id="3895520">Size</span>&nbsp;<span class="op" id="3895525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3895528">func</span>&nbsp;<span class="op" id="3895533">(</span><span class="ident" id="3895534">d</span>&nbsp;<span class="op" id="3895536">*</span><span class="ident" id="3895537">digest</span><span class="op" id="3895543">)</span>&nbsp;<span class="ident" id="3895545">BlockSize</span><span class="op" id="3895554">(</span><span class="op" id="3895555">)</span>&nbsp;<span class="builtintype" id="3895557">int</span>&nbsp;<span class="op" id="3895561">{</span>&nbsp;<span class="keyword" id="3895563">return</span>&nbsp;<span class="ident" id="3895570">BlockSize</span>&nbsp;<span class="op" id="3895580">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="3895583">func</span>&nbsp;<span class="op" id="3895588">(</span><span class="ident" id="3895589">d</span>&nbsp;<span class="op" id="3895591">*</span><span class="ident" id="3895592">digest</span><span class="op" id="3895598">)</span>&nbsp;<span class="ident" id="3895600">Write</span><span class="op" id="3895605">(</span><span class="ident" id="3895606">p</span>&nbsp;<span class="op" id="3895608">[</span><span class="op" id="3895609">]</span><span class="builtintype" id="3895610">byte</span><span class="op" id="3895614">)</span>&nbsp;<span class="op" id="3895616">(</span><span class="ident" id="3895617">nn</span>&nbsp;<span class="builtintype" id="3895620">int</span><span class="op" id="3895623">,</span>&nbsp;<span class="ident" id="3895625">err</span>&nbsp;<span class="builtintype" id="3895629">error</span><span class="op" id="3895634">)</span>&nbsp;<span class="op" id="3895636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895639">nn</span>&nbsp;<span class="op" id="3895642">=</span>&nbsp;<span class="builtinfunc" id="3895644">len</span><span class="op" id="3895647">(</span><span class="ident" id="3895648">p</span><span class="op" id="3895649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895652">d</span><span class="op" id="3895653">.</span><span class="builtinfunc" id="3895654">len</span>&nbsp;<span class="op" id="3895658">+=</span>&nbsp;<span class="ident" id="3895661">uint64</span><span class="op" id="3895667">(</span><span class="ident" id="3895668">nn</span><span class="op" id="3895670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3895673">if</span>&nbsp;<span class="ident" id="3895676">d</span><span class="op" id="3895677">.</span><span class="ident" id="3895678">nx</span>&nbsp;<span class="op" id="3895681">&gt;</span>&nbsp;<span class="num" id="3895683">0</span>&nbsp;<span class="op" id="3895685">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895689">n</span>&nbsp;<span class="op" id="3895691">:=</span>&nbsp;<span class="builtinfunc" id="3895694">len</span><span class="op" id="3895697">(</span><span class="ident" id="3895698">p</span><span class="op" id="3895699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3895703">if</span>&nbsp;<span class="ident" id="3895706">n</span>&nbsp;<span class="op" id="3895708">&gt;</span>&nbsp;<span class="ident" id="3895710">chunk</span><span class="op" id="3895715">-</span><span class="ident" id="3895716">d</span><span class="op" id="3895717">.</span><span class="ident" id="3895718">nx</span>&nbsp;<span class="op" id="3895721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895726">n</span>&nbsp;<span class="op" id="3895728">=</span>&nbsp;<span class="ident" id="3895730">chunk</span>&nbsp;<span class="op" id="3895736">-</span>&nbsp;<span class="ident" id="3895738">d</span><span class="op" id="3895739">.</span><span class="ident" id="3895740">nx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3895745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3895749">for</span>&nbsp;<span class="ident" id="3895753">i</span>&nbsp;<span class="op" id="3895755">:=</span>&nbsp;<span class="num" id="3895758">0</span><span class="op" id="3895759">;</span>&nbsp;<span class="ident" id="3895761">i</span>&nbsp;<span class="op" id="3895763">&lt;</span>&nbsp;<span class="ident" id="3895765">n</span><span class="op" id="3895766">;</span>&nbsp;<span class="ident" id="3895768">i</span><span class="op" id="3895769">++</span>&nbsp;<span class="op" id="3895772">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895777">d</span><span class="op" id="3895778">.</span><span class="ident" id="3895779">x</span><span class="op" id="3895780">[</span><span class="ident" id="3895781">d</span><span class="op" id="3895782">.</span><span class="ident" id="3895783">nx</span><span class="op" id="3895785">+</span><span class="ident" id="3895786">i</span><span class="op" id="3895787">]</span>&nbsp;<span class="op" id="3895789">=</span>&nbsp;<span class="ident" id="3895791">p</span><span class="op" id="3895792">[</span><span class="ident" id="3895793">i</span><span class="op" id="3895794">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3895798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895802">d</span><span class="op" id="3895803">.</span><span class="ident" id="3895804">nx</span>&nbsp;<span class="op" id="3895807">+=</span>&nbsp;<span class="ident" id="3895810">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3895814">if</span>&nbsp;<span class="ident" id="3895817">d</span><span class="op" id="3895818">.</span><span class="ident" id="3895819">nx</span>&nbsp;<span class="op" id="3895822">==</span>&nbsp;<span class="ident" id="3895825">chunk</span>&nbsp;<span class="op" id="3895831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895836">block</span><span class="op" id="3895841">(</span><span class="ident" id="3895842">d</span><span class="op" id="3895843">,</span>&nbsp;<span class="ident" id="3895845">d</span><span class="op" id="3895846">.</span><span class="ident" id="3895847">x</span><span class="op" id="3895848">[</span><span class="num" id="3895849">0</span><span class="op" id="3895850">:</span><span class="ident" id="3895851">chunk</span><span class="op" id="3895856">]</span><span class="op" id="3895857">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895862">d</span><span class="op" id="3895863">.</span><span class="ident" id="3895864">nx</span>&nbsp;<span class="op" id="3895867">=</span>&nbsp;<span class="num" id="3895869">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3895873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895877">p</span>&nbsp;<span class="op" id="3895879">=</span>&nbsp;<span class="ident" id="3895881">p</span><span class="op" id="3895882">[</span><span class="ident" id="3895883">n</span><span class="op" id="3895884">:</span><span class="op" id="3895885">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3895888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3895891">if</span>&nbsp;<span class="builtinfunc" id="3895894">len</span><span class="op" id="3895897">(</span><span class="ident" id="3895898">p</span><span class="op" id="3895899">)</span>&nbsp;<span class="op" id="3895901">&gt;=</span>&nbsp;<span class="ident" id="3895904">chunk</span>&nbsp;<span class="op" id="3895910">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895914">n</span>&nbsp;<span class="op" id="3895916">:=</span>&nbsp;<span class="builtinfunc" id="3895919">len</span><span class="op" id="3895922">(</span><span class="ident" id="3895923">p</span><span class="op" id="3895924">)</span>&nbsp;<span class="op" id="3895926">&amp;^</span>&nbsp;<span class="op" id="3895929">(</span><span class="ident" id="3895930">chunk</span>&nbsp;<span class="op" id="3895936">-</span>&nbsp;<span class="num" id="3895938">1</span><span class="op" id="3895939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895943">block</span><span class="op" id="3895948">(</span><span class="ident" id="3895949">d</span><span class="op" id="3895950">,</span>&nbsp;<span class="ident" id="3895952">p</span><span class="op" id="3895953">[</span><span class="op" id="3895954">:</span><span class="ident" id="3895955">n</span><span class="op" id="3895956">]</span><span class="op" id="3895957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895961">p</span>&nbsp;<span class="op" id="3895963">=</span>&nbsp;<span class="ident" id="3895965">p</span><span class="op" id="3895966">[</span><span class="ident" id="3895967">n</span><span class="op" id="3895968">:</span><span class="op" id="3895969">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3895972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3895975">if</span>&nbsp;<span class="builtinfunc" id="3895978">len</span><span class="op" id="3895981">(</span><span class="ident" id="3895982">p</span><span class="op" id="3895983">)</span>&nbsp;<span class="op" id="3895985">&gt;</span>&nbsp;<span class="num" id="3895987">0</span>&nbsp;<span class="op" id="3895989">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895993">d</span><span class="op" id="3895994">.</span><span class="ident" id="3895995">nx</span>&nbsp;<span class="op" id="3895998">=</span>&nbsp;<span class="builtinfunc" id="3896000">copy</span><span class="op" id="3896004">(</span><span class="ident" id="3896005">d</span><span class="op" id="3896006">.</span><span class="ident" id="3896007">x</span><span class="op" id="3896008">[</span><span class="op" id="3896009">:</span><span class="op" id="3896010">]</span><span class="op" id="3896011">,</span>&nbsp;<span class="ident" id="3896013">p</span><span class="op" id="3896014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3896017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896020">return</span><br>
<span class="lineno"></span><span class="op" id="3896027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="3896030">func</span>&nbsp;<span class="op" id="3896035">(</span><span class="ident" id="3896036">d0</span>&nbsp;<span class="op" id="3896039">*</span><span class="ident" id="3896040">digest</span><span class="op" id="3896046">)</span>&nbsp;<span class="ident" id="3896048">Sum</span><span class="op" id="3896051">(</span><span class="ident" id="3896052">in</span>&nbsp;<span class="op" id="3896055">[</span><span class="op" id="3896056">]</span><span class="builtintype" id="3896057">byte</span><span class="op" id="3896061">)</span>&nbsp;<span class="op" id="3896063">[</span><span class="op" id="3896064">]</span><span class="builtintype" id="3896065">byte</span>&nbsp;<span class="op" id="3896070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3896073">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896140">d</span>&nbsp;<span class="op" id="3896142">:=</span>&nbsp;<span class="op" id="3896145">*</span><span class="ident" id="3896146">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896150">hash</span>&nbsp;<span class="op" id="3896155">:=</span>&nbsp;<span class="ident" id="3896158">d</span><span class="op" id="3896159">.</span><span class="ident" id="3896160">checkSum</span><span class="op" id="3896168">(</span><span class="op" id="3896169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896172">return</span>&nbsp;<span class="builtinfunc" id="3896179">append</span><span class="op" id="3896185">(</span><span class="ident" id="3896186">in</span><span class="op" id="3896188">,</span>&nbsp;<span class="ident" id="3896190">hash</span><span class="op" id="3896194">[</span><span class="op" id="3896195">:</span><span class="op" id="3896196">]</span><span class="op" id="3896197">...</span><span class="op" id="3896200">)</span><br>
<span class="lineno">95</span><span class="op" id="3896202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3896205">func</span>&nbsp;<span class="op" id="3896210">(</span><span class="ident" id="3896211">d</span>&nbsp;<span class="op" id="3896213">*</span><span class="ident" id="3896214">digest</span><span class="op" id="3896220">)</span>&nbsp;<span class="ident" id="3896222">checkSum</span><span class="op" id="3896230">(</span><span class="op" id="3896231">)</span>&nbsp;<span class="op" id="3896233">[</span><span class="ident" id="3896234">Size</span><span class="op" id="3896238">]</span><span class="builtintype" id="3896239">byte</span>&nbsp;<span class="op" id="3896244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3896247">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3896307">len</span>&nbsp;<span class="op" id="3896311">:=</span>&nbsp;<span class="ident" id="3896314">d</span><span class="op" id="3896315">.</span><span class="builtinfunc" id="3896316">len</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896321">var</span>&nbsp;<span class="ident" id="3896325">tmp</span>&nbsp;<span class="op" id="3896329">[</span><span class="num" id="3896330">64</span><span class="op" id="3896332">]</span><span class="builtintype" id="3896333">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896339">tmp</span><span class="op" id="3896342">[</span><span class="num" id="3896343">0</span><span class="op" id="3896344">]</span>&nbsp;<span class="op" id="3896346">=</span>&nbsp;<span class="num" id="3896348">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896354">if</span>&nbsp;<span class="builtinfunc" id="3896357">len</span><span class="op" id="3896360">%</span><span class="num" id="3896361">64</span>&nbsp;<span class="op" id="3896364">&lt;</span>&nbsp;<span class="num" id="3896366">56</span>&nbsp;<span class="op" id="3896369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896373">d</span><span class="op" id="3896374">.</span><span class="ident" id="3896375">Write</span><span class="op" id="3896380">(</span><span class="ident" id="3896381">tmp</span><span class="op" id="3896384">[</span><span class="num" id="3896385">0</span>&nbsp;<span class="op" id="3896387">:</span>&nbsp;<span class="num" id="3896389">56</span><span class="op" id="3896391">-</span><span class="builtinfunc" id="3896392">len</span><span class="op" id="3896395">%</span><span class="num" id="3896396">64</span><span class="op" id="3896398">]</span><span class="op" id="3896399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3896402">}</span>&nbsp;<span class="keyword" id="3896404">else</span>&nbsp;<span class="op" id="3896409">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896413">d</span><span class="op" id="3896414">.</span><span class="ident" id="3896415">Write</span><span class="op" id="3896420">(</span><span class="ident" id="3896421">tmp</span><span class="op" id="3896424">[</span><span class="num" id="3896425">0</span>&nbsp;<span class="op" id="3896427">:</span>&nbsp;<span class="num" id="3896429">64</span><span class="op" id="3896431">+</span><span class="num" id="3896432">56</span><span class="op" id="3896434">-</span><span class="builtinfunc" id="3896435">len</span><span class="op" id="3896438">%</span><span class="num" id="3896439">64</span><span class="op" id="3896441">]</span><span class="op" id="3896442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3896445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3896449">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3896469">len</span>&nbsp;<span class="op" id="3896473">&lt;&lt;=</span>&nbsp;<span class="num" id="3896477">3</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896480">for</span>&nbsp;<span class="ident" id="3896484">i</span>&nbsp;<span class="op" id="3896486">:=</span>&nbsp;<span class="builtintype" id="3896489">uint</span><span class="op" id="3896493">(</span><span class="num" id="3896494">0</span><span class="op" id="3896495">)</span><span class="op" id="3896496">;</span>&nbsp;<span class="ident" id="3896498">i</span>&nbsp;<span class="op" id="3896500">&lt;</span>&nbsp;<span class="num" id="3896502">8</span><span class="op" id="3896503">;</span>&nbsp;<span class="ident" id="3896505">i</span><span class="op" id="3896506">++</span>&nbsp;<span class="op" id="3896509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896513">tmp</span><span class="op" id="3896516">[</span><span class="ident" id="3896517">i</span><span class="op" id="3896518">]</span>&nbsp;<span class="op" id="3896520">=</span>&nbsp;<span class="builtintype" id="3896522">byte</span><span class="op" id="3896526">(</span><span class="builtinfunc" id="3896527">len</span>&nbsp;<span class="op" id="3896531">&gt;&gt;</span>&nbsp;<span class="op" id="3896534">(</span><span class="num" id="3896535">8</span>&nbsp;<span class="op" id="3896537">*</span>&nbsp;<span class="ident" id="3896539">i</span><span class="op" id="3896540">)</span><span class="op" id="3896541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3896544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896547">d</span><span class="op" id="3896548">.</span><span class="ident" id="3896549">Write</span><span class="op" id="3896554">(</span><span class="ident" id="3896555">tmp</span><span class="op" id="3896558">[</span><span class="num" id="3896559">0</span><span class="op" id="3896560">:</span><span class="num" id="3896561">8</span><span class="op" id="3896562">]</span><span class="op" id="3896563">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896567">if</span>&nbsp;<span class="ident" id="3896570">d</span><span class="op" id="3896571">.</span><span class="ident" id="3896572">nx</span>&nbsp;<span class="op" id="3896575">!=</span>&nbsp;<span class="num" id="3896578">0</span>&nbsp;<span class="op" id="3896580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3896584">panic</span><span class="op" id="3896589">(</span><span class="string" id="3896590">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="3896601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3896604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896608">var</span>&nbsp;<span class="ident" id="3896612">digest</span>&nbsp;<span class="op" id="3896619">[</span><span class="ident" id="3896620">Size</span><span class="op" id="3896624">]</span><span class="builtintype" id="3896625">byte</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896631">for</span>&nbsp;<span class="ident" id="3896635">i</span><span class="op" id="3896636">,</span>&nbsp;<span class="ident" id="3896638">s</span>&nbsp;<span class="op" id="3896640">:=</span>&nbsp;<span class="keyword" id="3896643">range</span>&nbsp;<span class="ident" id="3896649">d</span><span class="op" id="3896650">.</span><span class="ident" id="3896651">s</span>&nbsp;<span class="op" id="3896653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896657">digest</span><span class="op" id="3896663">[</span><span class="ident" id="3896664">i</span><span class="op" id="3896665">*</span><span class="num" id="3896666">4</span><span class="op" id="3896667">]</span>&nbsp;<span class="op" id="3896669">=</span>&nbsp;<span class="builtintype" id="3896671">byte</span><span class="op" id="3896675">(</span><span class="ident" id="3896676">s</span><span class="op" id="3896677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896681">digest</span><span class="op" id="3896687">[</span><span class="ident" id="3896688">i</span><span class="op" id="3896689">*</span><span class="num" id="3896690">4</span><span class="op" id="3896691">+</span><span class="num" id="3896692">1</span><span class="op" id="3896693">]</span>&nbsp;<span class="op" id="3896695">=</span>&nbsp;<span class="builtintype" id="3896697">byte</span><span class="op" id="3896701">(</span><span class="ident" id="3896702">s</span>&nbsp;<span class="op" id="3896704">&gt;&gt;</span>&nbsp;<span class="num" id="3896707">8</span><span class="op" id="3896708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896712">digest</span><span class="op" id="3896718">[</span><span class="ident" id="3896719">i</span><span class="op" id="3896720">*</span><span class="num" id="3896721">4</span><span class="op" id="3896722">+</span><span class="num" id="3896723">2</span><span class="op" id="3896724">]</span>&nbsp;<span class="op" id="3896726">=</span>&nbsp;<span class="builtintype" id="3896728">byte</span><span class="op" id="3896732">(</span><span class="ident" id="3896733">s</span>&nbsp;<span class="op" id="3896735">&gt;&gt;</span>&nbsp;<span class="num" id="3896738">16</span><span class="op" id="3896740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896744">digest</span><span class="op" id="3896750">[</span><span class="ident" id="3896751">i</span><span class="op" id="3896752">*</span><span class="num" id="3896753">4</span><span class="op" id="3896754">+</span><span class="num" id="3896755">3</span><span class="op" id="3896756">]</span>&nbsp;<span class="op" id="3896758">=</span>&nbsp;<span class="builtintype" id="3896760">byte</span><span class="op" id="3896764">(</span><span class="ident" id="3896765">s</span>&nbsp;<span class="op" id="3896767">&gt;&gt;</span>&nbsp;<span class="num" id="3896770">24</span><span class="op" id="3896772">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3896775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896779">return</span>&nbsp;<span class="ident" id="3896786">digest</span><br>
<span class="lineno"></span><span class="op" id="3896793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="3896796">//&nbsp;Sum&nbsp;returns&nbsp;the&nbsp;MD5&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3896841">func</span>&nbsp;<span class="ident" id="3896846">Sum</span><span class="op" id="3896849">(</span><span class="ident" id="3896850">data</span>&nbsp;<span class="op" id="3896855">[</span><span class="op" id="3896856">]</span><span class="builtintype" id="3896857">byte</span><span class="op" id="3896861">)</span>&nbsp;<span class="op" id="3896863">[</span><span class="ident" id="3896864">Size</span><span class="op" id="3896868">]</span><span class="builtintype" id="3896869">byte</span>&nbsp;<span class="op" id="3896874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896877">var</span>&nbsp;<span class="ident" id="3896881">d</span>&nbsp;<span class="ident" id="3896883">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896891">d</span><span class="op" id="3896892">.</span><span class="ident" id="3896893">Reset</span><span class="op" id="3896898">(</span><span class="op" id="3896899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896902">d</span><span class="op" id="3896903">.</span><span class="ident" id="3896904">Write</span><span class="op" id="3896909">(</span><span class="ident" id="3896910">data</span><span class="op" id="3896914">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896917">return</span>&nbsp;<span class="ident" id="3896924">d</span><span class="op" id="3896925">.</span><span class="ident" id="3896926">checkSum</span><span class="op" id="3896934">(</span><span class="op" id="3896935">)</span><br>
<span class="lineno"></span><span class="op" id="3896937">}</span>
</div>
</body>
</html>
