<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7507185">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7507240">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7507294">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7507345">package</span>&nbsp;<span class="ident" id="7507353">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7507358">import</span>&nbsp;<span class="op" id="7507365">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7507368">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7507377">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7507383">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7507394">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7507404">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7507407">func</span>&nbsp;<span class="ident" id="7507412">TestReadLine</span><span class="op" id="7507424">(</span><span class="ident" id="7507425">t</span>&nbsp;<span class="op" id="7507427">*</span><span class="ident" id="7507428">testing</span><span class="op" id="7507435">.</span><span class="ident" id="7507436">T</span><span class="op" id="7507437">)</span>&nbsp;<span class="op" id="7507439">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7507442">//&nbsp;/etc/services&nbsp;file&nbsp;does&nbsp;not&nbsp;exist&nbsp;on&nbsp;android,&nbsp;plan9,&nbsp;windows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7507508">switch</span>&nbsp;<span class="ident" id="7507515">runtime</span><span class="op" id="7507522">.</span><span class="ident" id="7507523">GOOS</span>&nbsp;<span class="op" id="7507528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7507531">case</span>&nbsp;<span class="string" id="7507536">&#34;android&#34;</span><span class="op" id="7507545">,</span>&nbsp;<span class="string" id="7507547">&#34;plan9&#34;</span><span class="op" id="7507554">,</span>&nbsp;<span class="string" id="7507556">&#34;windows&#34;</span><span class="op" id="7507565">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7507569">t</span><span class="op" id="7507570">.</span><span class="ident" id="7507571">Skipf</span><span class="op" id="7507576">(</span><span class="string" id="7507577">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7507598">,</span>&nbsp;<span class="ident" id="7507600">runtime</span><span class="op" id="7507607">.</span><span class="ident" id="7507608">GOOS</span><span class="op" id="7507612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7507615">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7507618">filename</span>&nbsp;<span class="op" id="7507627">:=</span>&nbsp;<span class="string" id="7507630">&#34;/etc/services&#34;</span>&nbsp;<span class="comment" id="7507646">//&nbsp;a&nbsp;nice&nbsp;big&nbsp;file</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7507667">fd</span><span class="op" id="7507669">,</span>&nbsp;<span class="ident" id="7507671">err</span>&nbsp;<span class="op" id="7507675">:=</span>&nbsp;<span class="ident" id="7507678">os</span><span class="op" id="7507680">.</span><span class="ident" id="7507681">Open</span><span class="op" id="7507685">(</span><span class="ident" id="7507686">filename</span><span class="op" id="7507694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7507697">if</span>&nbsp;<span class="ident" id="7507700">err</span>&nbsp;<span class="op" id="7507704">!=</span>&nbsp;<span class="ident" id="7507707">nil</span>&nbsp;<span class="op" id="7507711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7507715">t</span><span class="op" id="7507716">.</span><span class="ident" id="7507717">Fatalf</span><span class="op" id="7507723">(</span><span class="string" id="7507724">&#34;open&nbsp;%s:&nbsp;%v&#34;</span><span class="op" id="7507737">,</span>&nbsp;<span class="ident" id="7507739">filename</span><span class="op" id="7507747">,</span>&nbsp;<span class="ident" id="7507749">err</span><span class="op" id="7507752">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7507755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7507758">defer</span>&nbsp;<span class="ident" id="7507764">fd</span><span class="op" id="7507766">.</span><span class="ident" id="7507767">Close</span><span class="op" id="7507772">(</span><span class="op" id="7507773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7507776">br</span>&nbsp;<span class="op" id="7507779">:=</span>&nbsp;<span class="ident" id="7507782">bufio</span><span class="op" id="7507787">.</span><span class="ident" id="7507788">NewReader</span><span class="op" id="7507797">(</span><span class="ident" id="7507798">fd</span><span class="op" id="7507800">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7507804">file</span><span class="op" id="7507808">,</span>&nbsp;<span class="ident" id="7507810">err</span>&nbsp;<span class="op" id="7507814">:=</span>&nbsp;<span class="ident" id="7507817">open</span><span class="op" id="7507821">(</span><span class="ident" id="7507822">filename</span><span class="op" id="7507830">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7507833">if</span>&nbsp;<span class="ident" id="7507836">file</span>&nbsp;<span class="op" id="7507841">==</span>&nbsp;<span class="ident" id="7507844">nil</span>&nbsp;<span class="op" id="7507848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7507852">t</span><span class="op" id="7507853">.</span><span class="ident" id="7507854">Fatalf</span><span class="op" id="7507860">(</span><span class="string" id="7507861">&#34;net.open(%s)&nbsp;=&nbsp;nil&#34;</span><span class="op" id="7507881">,</span>&nbsp;<span class="ident" id="7507883">filename</span><span class="op" id="7507891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7507894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7507897">defer</span>&nbsp;<span class="ident" id="7507903">file</span><span class="op" id="7507907">.</span><span class="builtinfunc" id="7507908">close</span><span class="op" id="7507913">(</span><span class="op" id="7507914">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7507918">lineno</span>&nbsp;<span class="op" id="7507925">:=</span>&nbsp;<span class="num" id="7507928">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7507931">byteno</span>&nbsp;<span class="op" id="7507938">:=</span>&nbsp;<span class="num" id="7507941">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7507944">for</span>&nbsp;<span class="op" id="7507948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7507952">bline</span><span class="op" id="7507957">,</span>&nbsp;<span class="ident" id="7507959">berr</span>&nbsp;<span class="op" id="7507964">:=</span>&nbsp;<span class="ident" id="7507967">br</span><span class="op" id="7507969">.</span><span class="ident" id="7507970">ReadString</span><span class="op" id="7507980">(</span><span class="string" id="7507981">&#39;\n&#39;</span><span class="op" id="7507985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7507989">if</span>&nbsp;<span class="ident" id="7507992">n</span>&nbsp;<span class="op" id="7507994">:=</span>&nbsp;<span class="builtinfunc" id="7507997">len</span><span class="op" id="7508000">(</span><span class="ident" id="7508001">bline</span><span class="op" id="7508006">)</span><span class="op" id="7508007">;</span>&nbsp;<span class="ident" id="7508009">n</span>&nbsp;<span class="op" id="7508011">&gt;</span>&nbsp;<span class="num" id="7508013">0</span>&nbsp;<span class="op" id="7508015">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7508020">bline</span>&nbsp;<span class="op" id="7508026">=</span>&nbsp;<span class="ident" id="7508028">bline</span><span class="op" id="7508033">[</span><span class="num" id="7508034">0</span>&nbsp;<span class="op" id="7508036">:</span>&nbsp;<span class="ident" id="7508038">n</span><span class="op" id="7508039">-</span><span class="num" id="7508040">1</span><span class="op" id="7508041">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7508045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7508049">line</span><span class="op" id="7508053">,</span>&nbsp;<span class="ident" id="7508055">ok</span>&nbsp;<span class="op" id="7508058">:=</span>&nbsp;<span class="ident" id="7508061">file</span><span class="op" id="7508065">.</span><span class="ident" id="7508066">readLine</span><span class="op" id="7508074">(</span><span class="op" id="7508075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7508079">if</span>&nbsp;<span class="op" id="7508082">(</span><span class="ident" id="7508083">berr</span>&nbsp;<span class="op" id="7508088">!=</span>&nbsp;<span class="ident" id="7508091">nil</span><span class="op" id="7508094">)</span>&nbsp;<span class="op" id="7508096">!=</span>&nbsp;<span class="op" id="7508099">!</span><span class="ident" id="7508100">ok</span>&nbsp;<span class="op" id="7508103">||</span>&nbsp;<span class="ident" id="7508106">bline</span>&nbsp;<span class="op" id="7508112">!=</span>&nbsp;<span class="ident" id="7508115">line</span>&nbsp;<span class="op" id="7508120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7508125">t</span><span class="op" id="7508126">.</span><span class="ident" id="7508127">Fatalf</span><span class="op" id="7508133">(</span><span class="string" id="7508134">&#34;%s:%d&nbsp;(#%d)\nbufio&nbsp;=&gt;&nbsp;%q,&nbsp;%v\nnet&nbsp;=&gt;&nbsp;%q,&nbsp;%v&#34;</span><span class="op" id="7508179">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7508185">filename</span><span class="op" id="7508193">,</span>&nbsp;<span class="ident" id="7508195">lineno</span><span class="op" id="7508201">,</span>&nbsp;<span class="ident" id="7508203">byteno</span><span class="op" id="7508209">,</span>&nbsp;<span class="ident" id="7508211">bline</span><span class="op" id="7508216">,</span>&nbsp;<span class="ident" id="7508218">berr</span><span class="op" id="7508222">,</span>&nbsp;<span class="ident" id="7508224">line</span><span class="op" id="7508228">,</span>&nbsp;<span class="ident" id="7508230">ok</span><span class="op" id="7508232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7508236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7508240">if</span>&nbsp;<span class="op" id="7508243">!</span><span class="ident" id="7508244">ok</span>&nbsp;<span class="op" id="7508247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7508252">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7508260">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7508264">lineno</span><span class="op" id="7508270">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7508275">byteno</span>&nbsp;<span class="op" id="7508282">+=</span>&nbsp;<span class="builtinfunc" id="7508285">len</span><span class="op" id="7508288">(</span><span class="ident" id="7508289">line</span><span class="op" id="7508293">)</span>&nbsp;<span class="op" id="7508295">+</span>&nbsp;<span class="num" id="7508297">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7508300">}</span><br>
<span class="lineno"></span><span class="op" id="7508302">}</span>
</div>
</body>
</html>
