<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4221586">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4221641">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4221695">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4221746">//&nbsp;Package&nbsp;sha512&nbsp;implements&nbsp;the&nbsp;SHA384&nbsp;and&nbsp;SHA512&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4221824">//&nbsp;in&nbsp;FIPS&nbsp;180-2.</span><br>
<span class="lineno"></span><span class="keyword" id="4221842">package</span>&nbsp;<span class="ident" id="4221850">sha512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4221858">import</span>&nbsp;<span class="op" id="4221865">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4221868">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4221878">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4221885">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4221888">func</span>&nbsp;<span class="ident" id="4221893">init</span><span class="op" id="4221897">(</span><span class="op" id="4221898">)</span>&nbsp;<span class="op" id="4221900">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221903">crypto</span><span class="op" id="4221909">.</span><span class="ident" id="4221910">RegisterHash</span><span class="op" id="4221922">(</span><span class="ident" id="4221923">crypto</span><span class="op" id="4221929">.</span><span class="ident" id="4221930">SHA384</span><span class="op" id="4221936">,</span>&nbsp;<span class="ident" id="4221938">New384</span><span class="op" id="4221944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221947">crypto</span><span class="op" id="4221953">.</span><span class="ident" id="4221954">RegisterHash</span><span class="op" id="4221966">(</span><span class="ident" id="4221967">crypto</span><span class="op" id="4221973">.</span><span class="ident" id="4221974">SHA512</span><span class="op" id="4221980">,</span>&nbsp;<span class="ident" id="4221982">New</span><span class="op" id="4221985">)</span><br>
<span class="lineno"></span><span class="op" id="4221987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4221990">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA512&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4222033">const</span>&nbsp;<span class="ident" id="4222039">Size</span>&nbsp;<span class="op" id="4222044">=</span>&nbsp;<span class="num" id="4222046">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4222050">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA384&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4222093">const</span>&nbsp;<span class="ident" id="4222099">Size384</span>&nbsp;<span class="op" id="4222107">=</span>&nbsp;<span class="num" id="4222109">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4222113">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA512&nbsp;and&nbsp;SHA384&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4222161">const</span>&nbsp;<span class="ident" id="4222167">BlockSize</span>&nbsp;<span class="op" id="4222177">=</span>&nbsp;<span class="num" id="4222179">128</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4222184">const</span>&nbsp;<span class="op" id="4222190">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222193">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4222203">=</span>&nbsp;<span class="num" id="4222205">128</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222210">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4222220">=</span>&nbsp;<span class="num" id="4222222">0x6a09e667f3bcc908</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222242">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4222252">=</span>&nbsp;<span class="num" id="4222254">0xbb67ae8584caa73b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222274">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4222284">=</span>&nbsp;<span class="num" id="4222286">0x3c6ef372fe94f82b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222306">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4222316">=</span>&nbsp;<span class="num" id="4222318">0xa54ff53a5f1d36f1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222338">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4222348">=</span>&nbsp;<span class="num" id="4222350">0x510e527fade682d1</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222370">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4222380">=</span>&nbsp;<span class="num" id="4222382">0x9b05688c2b3e6c1f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222402">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4222412">=</span>&nbsp;<span class="num" id="4222414">0x1f83d9abfb41bd6b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222434">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4222444">=</span>&nbsp;<span class="num" id="4222446">0x5be0cd19137e2179</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222466">init0_384</span>&nbsp;<span class="op" id="4222476">=</span>&nbsp;<span class="num" id="4222478">0xcbbb9d5dc1059ed8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222498">init1_384</span>&nbsp;<span class="op" id="4222508">=</span>&nbsp;<span class="num" id="4222510">0x629a292a367cd507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222530">init2_384</span>&nbsp;<span class="op" id="4222540">=</span>&nbsp;<span class="num" id="4222542">0x9159015a3070dd17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222562">init3_384</span>&nbsp;<span class="op" id="4222572">=</span>&nbsp;<span class="num" id="4222574">0x152fecd8f70e5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222594">init4_384</span>&nbsp;<span class="op" id="4222604">=</span>&nbsp;<span class="num" id="4222606">0x67332667ffc00b31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222626">init5_384</span>&nbsp;<span class="op" id="4222636">=</span>&nbsp;<span class="num" id="4222638">0x8eb44a8768581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222658">init6_384</span>&nbsp;<span class="op" id="4222668">=</span>&nbsp;<span class="num" id="4222670">0xdb0c2e0d64f98fa7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222690">init7_384</span>&nbsp;<span class="op" id="4222700">=</span>&nbsp;<span class="num" id="4222702">0x47b5481dbefa4fa4</span><br>
<span class="lineno"></span><span class="op" id="4222721">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4222724">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4222783">type</span>&nbsp;<span class="ident" id="4222788">digest</span>&nbsp;<span class="keyword" id="4222795">struct</span>&nbsp;<span class="op" id="4222802">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222805">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4222811">[</span><span class="num" id="4222812">8</span><span class="op" id="4222813">]</span><span class="ident" id="4222814">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222822">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4222828">[</span><span class="ident" id="4222829">chunk</span><span class="op" id="4222834">]</span><span class="builtintype" id="4222835">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222841">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4222847">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4222852">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4222858">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222866">is384</span>&nbsp;<span class="builtintype" id="4222872">bool</span>&nbsp;<span class="comment" id="4222877">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-384</span><br>
<span class="lineno">55</span><span class="op" id="4222911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4222914">func</span>&nbsp;<span class="op" id="4222919">(</span><span class="ident" id="4222920">d</span>&nbsp;<span class="op" id="4222922">*</span><span class="ident" id="4222923">digest</span><span class="op" id="4222929">)</span>&nbsp;<span class="ident" id="4222931">Reset</span><span class="op" id="4222936">(</span><span class="op" id="4222937">)</span>&nbsp;<span class="op" id="4222939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222942">if</span>&nbsp;<span class="op" id="4222945">!</span><span class="ident" id="4222946">d</span><span class="op" id="4222947">.</span><span class="ident" id="4222948">is384</span>&nbsp;<span class="op" id="4222954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222958">d</span><span class="op" id="4222959">.</span><span class="ident" id="4222960">h</span><span class="op" id="4222961">[</span><span class="num" id="4222962">0</span><span class="op" id="4222963">]</span>&nbsp;<span class="op" id="4222965">=</span>&nbsp;<span class="ident" id="4222967">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222975">d</span><span class="op" id="4222976">.</span><span class="ident" id="4222977">h</span><span class="op" id="4222978">[</span><span class="num" id="4222979">1</span><span class="op" id="4222980">]</span>&nbsp;<span class="op" id="4222982">=</span>&nbsp;<span class="ident" id="4222984">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222992">d</span><span class="op" id="4222993">.</span><span class="ident" id="4222994">h</span><span class="op" id="4222995">[</span><span class="num" id="4222996">2</span><span class="op" id="4222997">]</span>&nbsp;<span class="op" id="4222999">=</span>&nbsp;<span class="ident" id="4223001">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223009">d</span><span class="op" id="4223010">.</span><span class="ident" id="4223011">h</span><span class="op" id="4223012">[</span><span class="num" id="4223013">3</span><span class="op" id="4223014">]</span>&nbsp;<span class="op" id="4223016">=</span>&nbsp;<span class="ident" id="4223018">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223026">d</span><span class="op" id="4223027">.</span><span class="ident" id="4223028">h</span><span class="op" id="4223029">[</span><span class="num" id="4223030">4</span><span class="op" id="4223031">]</span>&nbsp;<span class="op" id="4223033">=</span>&nbsp;<span class="ident" id="4223035">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223043">d</span><span class="op" id="4223044">.</span><span class="ident" id="4223045">h</span><span class="op" id="4223046">[</span><span class="num" id="4223047">5</span><span class="op" id="4223048">]</span>&nbsp;<span class="op" id="4223050">=</span>&nbsp;<span class="ident" id="4223052">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223060">d</span><span class="op" id="4223061">.</span><span class="ident" id="4223062">h</span><span class="op" id="4223063">[</span><span class="num" id="4223064">6</span><span class="op" id="4223065">]</span>&nbsp;<span class="op" id="4223067">=</span>&nbsp;<span class="ident" id="4223069">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223077">d</span><span class="op" id="4223078">.</span><span class="ident" id="4223079">h</span><span class="op" id="4223080">[</span><span class="num" id="4223081">7</span><span class="op" id="4223082">]</span>&nbsp;<span class="op" id="4223084">=</span>&nbsp;<span class="ident" id="4223086">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223093">}</span>&nbsp;<span class="keyword" id="4223095">else</span>&nbsp;<span class="op" id="4223100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223104">d</span><span class="op" id="4223105">.</span><span class="ident" id="4223106">h</span><span class="op" id="4223107">[</span><span class="num" id="4223108">0</span><span class="op" id="4223109">]</span>&nbsp;<span class="op" id="4223111">=</span>&nbsp;<span class="ident" id="4223113">init0_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223125">d</span><span class="op" id="4223126">.</span><span class="ident" id="4223127">h</span><span class="op" id="4223128">[</span><span class="num" id="4223129">1</span><span class="op" id="4223130">]</span>&nbsp;<span class="op" id="4223132">=</span>&nbsp;<span class="ident" id="4223134">init1_384</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223146">d</span><span class="op" id="4223147">.</span><span class="ident" id="4223148">h</span><span class="op" id="4223149">[</span><span class="num" id="4223150">2</span><span class="op" id="4223151">]</span>&nbsp;<span class="op" id="4223153">=</span>&nbsp;<span class="ident" id="4223155">init2_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223167">d</span><span class="op" id="4223168">.</span><span class="ident" id="4223169">h</span><span class="op" id="4223170">[</span><span class="num" id="4223171">3</span><span class="op" id="4223172">]</span>&nbsp;<span class="op" id="4223174">=</span>&nbsp;<span class="ident" id="4223176">init3_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223188">d</span><span class="op" id="4223189">.</span><span class="ident" id="4223190">h</span><span class="op" id="4223191">[</span><span class="num" id="4223192">4</span><span class="op" id="4223193">]</span>&nbsp;<span class="op" id="4223195">=</span>&nbsp;<span class="ident" id="4223197">init4_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223209">d</span><span class="op" id="4223210">.</span><span class="ident" id="4223211">h</span><span class="op" id="4223212">[</span><span class="num" id="4223213">5</span><span class="op" id="4223214">]</span>&nbsp;<span class="op" id="4223216">=</span>&nbsp;<span class="ident" id="4223218">init5_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223230">d</span><span class="op" id="4223231">.</span><span class="ident" id="4223232">h</span><span class="op" id="4223233">[</span><span class="num" id="4223234">6</span><span class="op" id="4223235">]</span>&nbsp;<span class="op" id="4223237">=</span>&nbsp;<span class="ident" id="4223239">init6_384</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223251">d</span><span class="op" id="4223252">.</span><span class="ident" id="4223253">h</span><span class="op" id="4223254">[</span><span class="num" id="4223255">7</span><span class="op" id="4223256">]</span>&nbsp;<span class="op" id="4223258">=</span>&nbsp;<span class="ident" id="4223260">init7_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223274">d</span><span class="op" id="4223275">.</span><span class="ident" id="4223276">nx</span>&nbsp;<span class="op" id="4223279">=</span>&nbsp;<span class="num" id="4223281">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223284">d</span><span class="op" id="4223285">.</span><span class="builtinfunc" id="4223286">len</span>&nbsp;<span class="op" id="4223290">=</span>&nbsp;<span class="num" id="4223292">0</span><br>
<span class="lineno"></span><span class="op" id="4223294">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4223297">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA512&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4223359">func</span>&nbsp;<span class="ident" id="4223364">New</span><span class="op" id="4223367">(</span><span class="op" id="4223368">)</span>&nbsp;<span class="ident" id="4223370">hash</span><span class="op" id="4223374">.</span><span class="ident" id="4223375">Hash</span>&nbsp;<span class="op" id="4223380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223383">d</span>&nbsp;<span class="op" id="4223385">:=</span>&nbsp;<span class="builtinfunc" id="4223388">new</span><span class="op" id="4223391">(</span><span class="ident" id="4223392">digest</span><span class="op" id="4223398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223401">d</span><span class="op" id="4223402">.</span><span class="ident" id="4223403">Reset</span><span class="op" id="4223408">(</span><span class="op" id="4223409">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223412">return</span>&nbsp;<span class="ident" id="4223419">d</span><br>
<span class="lineno"></span><span class="op" id="4223421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4223424">//&nbsp;New384&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA384&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4223489">func</span>&nbsp;<span class="ident" id="4223494">New384</span><span class="op" id="4223500">(</span><span class="op" id="4223501">)</span>&nbsp;<span class="ident" id="4223503">hash</span><span class="op" id="4223507">.</span><span class="ident" id="4223508">Hash</span>&nbsp;<span class="op" id="4223513">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223516">d</span>&nbsp;<span class="op" id="4223518">:=</span>&nbsp;<span class="builtinfunc" id="4223521">new</span><span class="op" id="4223524">(</span><span class="ident" id="4223525">digest</span><span class="op" id="4223531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223534">d</span><span class="op" id="4223535">.</span><span class="ident" id="4223536">is384</span>&nbsp;<span class="op" id="4223542">=</span>&nbsp;<span class="builtintype" id="4223544">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223550">d</span><span class="op" id="4223551">.</span><span class="ident" id="4223552">Reset</span><span class="op" id="4223557">(</span><span class="op" id="4223558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223561">return</span>&nbsp;<span class="ident" id="4223568">d</span><br>
<span class="lineno"></span><span class="op" id="4223570">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4223573">func</span>&nbsp;<span class="op" id="4223578">(</span><span class="ident" id="4223579">d</span>&nbsp;<span class="op" id="4223581">*</span><span class="ident" id="4223582">digest</span><span class="op" id="4223588">)</span>&nbsp;<span class="ident" id="4223590">Size</span><span class="op" id="4223594">(</span><span class="op" id="4223595">)</span>&nbsp;<span class="builtintype" id="4223597">int</span>&nbsp;<span class="op" id="4223601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223604">if</span>&nbsp;<span class="op" id="4223607">!</span><span class="ident" id="4223608">d</span><span class="op" id="4223609">.</span><span class="ident" id="4223610">is384</span>&nbsp;<span class="op" id="4223616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223620">return</span>&nbsp;<span class="ident" id="4223627">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223633">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223636">return</span>&nbsp;<span class="ident" id="4223643">Size384</span><br>
<span class="lineno"></span><span class="op" id="4223651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4223654">func</span>&nbsp;<span class="op" id="4223659">(</span><span class="ident" id="4223660">d</span>&nbsp;<span class="op" id="4223662">*</span><span class="ident" id="4223663">digest</span><span class="op" id="4223669">)</span>&nbsp;<span class="ident" id="4223671">BlockSize</span><span class="op" id="4223680">(</span><span class="op" id="4223681">)</span>&nbsp;<span class="builtintype" id="4223683">int</span>&nbsp;<span class="op" id="4223687">{</span>&nbsp;<span class="keyword" id="4223689">return</span>&nbsp;<span class="ident" id="4223696">BlockSize</span>&nbsp;<span class="op" id="4223706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4223709">func</span>&nbsp;<span class="op" id="4223714">(</span><span class="ident" id="4223715">d</span>&nbsp;<span class="op" id="4223717">*</span><span class="ident" id="4223718">digest</span><span class="op" id="4223724">)</span>&nbsp;<span class="ident" id="4223726">Write</span><span class="op" id="4223731">(</span><span class="ident" id="4223732">p</span>&nbsp;<span class="op" id="4223734">[</span><span class="op" id="4223735">]</span><span class="builtintype" id="4223736">byte</span><span class="op" id="4223740">)</span>&nbsp;<span class="op" id="4223742">(</span><span class="ident" id="4223743">nn</span>&nbsp;<span class="builtintype" id="4223746">int</span><span class="op" id="4223749">,</span>&nbsp;<span class="ident" id="4223751">err</span>&nbsp;<span class="builtintype" id="4223755">error</span><span class="op" id="4223760">)</span>&nbsp;<span class="op" id="4223762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223765">nn</span>&nbsp;<span class="op" id="4223768">=</span>&nbsp;<span class="builtinfunc" id="4223770">len</span><span class="op" id="4223773">(</span><span class="ident" id="4223774">p</span><span class="op" id="4223775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223778">d</span><span class="op" id="4223779">.</span><span class="builtinfunc" id="4223780">len</span>&nbsp;<span class="op" id="4223784">+=</span>&nbsp;<span class="ident" id="4223787">uint64</span><span class="op" id="4223793">(</span><span class="ident" id="4223794">nn</span><span class="op" id="4223796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223799">if</span>&nbsp;<span class="ident" id="4223802">d</span><span class="op" id="4223803">.</span><span class="ident" id="4223804">nx</span>&nbsp;<span class="op" id="4223807">&gt;</span>&nbsp;<span class="num" id="4223809">0</span>&nbsp;<span class="op" id="4223811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223815">n</span>&nbsp;<span class="op" id="4223817">:=</span>&nbsp;<span class="builtinfunc" id="4223820">copy</span><span class="op" id="4223824">(</span><span class="ident" id="4223825">d</span><span class="op" id="4223826">.</span><span class="ident" id="4223827">x</span><span class="op" id="4223828">[</span><span class="ident" id="4223829">d</span><span class="op" id="4223830">.</span><span class="ident" id="4223831">nx</span><span class="op" id="4223833">:</span><span class="op" id="4223834">]</span><span class="op" id="4223835">,</span>&nbsp;<span class="ident" id="4223837">p</span><span class="op" id="4223838">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223842">d</span><span class="op" id="4223843">.</span><span class="ident" id="4223844">nx</span>&nbsp;<span class="op" id="4223847">+=</span>&nbsp;<span class="ident" id="4223850">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223854">if</span>&nbsp;<span class="ident" id="4223857">d</span><span class="op" id="4223858">.</span><span class="ident" id="4223859">nx</span>&nbsp;<span class="op" id="4223862">==</span>&nbsp;<span class="ident" id="4223865">chunk</span>&nbsp;<span class="op" id="4223871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223876">block</span><span class="op" id="4223881">(</span><span class="ident" id="4223882">d</span><span class="op" id="4223883">,</span>&nbsp;<span class="ident" id="4223885">d</span><span class="op" id="4223886">.</span><span class="ident" id="4223887">x</span><span class="op" id="4223888">[</span><span class="op" id="4223889">:</span><span class="op" id="4223890">]</span><span class="op" id="4223891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223896">d</span><span class="op" id="4223897">.</span><span class="ident" id="4223898">nx</span>&nbsp;<span class="op" id="4223901">=</span>&nbsp;<span class="num" id="4223903">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223907">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223911">p</span>&nbsp;<span class="op" id="4223913">=</span>&nbsp;<span class="ident" id="4223915">p</span><span class="op" id="4223916">[</span><span class="ident" id="4223917">n</span><span class="op" id="4223918">:</span><span class="op" id="4223919">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223925">if</span>&nbsp;<span class="builtinfunc" id="4223928">len</span><span class="op" id="4223931">(</span><span class="ident" id="4223932">p</span><span class="op" id="4223933">)</span>&nbsp;<span class="op" id="4223935">&gt;=</span>&nbsp;<span class="ident" id="4223938">chunk</span>&nbsp;<span class="op" id="4223944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223948">n</span>&nbsp;<span class="op" id="4223950">:=</span>&nbsp;<span class="builtinfunc" id="4223953">len</span><span class="op" id="4223956">(</span><span class="ident" id="4223957">p</span><span class="op" id="4223958">)</span>&nbsp;<span class="op" id="4223960">&amp;^</span>&nbsp;<span class="op" id="4223963">(</span><span class="ident" id="4223964">chunk</span>&nbsp;<span class="op" id="4223970">-</span>&nbsp;<span class="num" id="4223972">1</span><span class="op" id="4223973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223977">block</span><span class="op" id="4223982">(</span><span class="ident" id="4223983">d</span><span class="op" id="4223984">,</span>&nbsp;<span class="ident" id="4223986">p</span><span class="op" id="4223987">[</span><span class="op" id="4223988">:</span><span class="ident" id="4223989">n</span><span class="op" id="4223990">]</span><span class="op" id="4223991">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223995">p</span>&nbsp;<span class="op" id="4223997">=</span>&nbsp;<span class="ident" id="4223999">p</span><span class="op" id="4224000">[</span><span class="ident" id="4224001">n</span><span class="op" id="4224002">:</span><span class="op" id="4224003">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224009">if</span>&nbsp;<span class="builtinfunc" id="4224012">len</span><span class="op" id="4224015">(</span><span class="ident" id="4224016">p</span><span class="op" id="4224017">)</span>&nbsp;<span class="op" id="4224019">&gt;</span>&nbsp;<span class="num" id="4224021">0</span>&nbsp;<span class="op" id="4224023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224027">d</span><span class="op" id="4224028">.</span><span class="ident" id="4224029">nx</span>&nbsp;<span class="op" id="4224032">=</span>&nbsp;<span class="builtinfunc" id="4224034">copy</span><span class="op" id="4224038">(</span><span class="ident" id="4224039">d</span><span class="op" id="4224040">.</span><span class="ident" id="4224041">x</span><span class="op" id="4224042">[</span><span class="op" id="4224043">:</span><span class="op" id="4224044">]</span><span class="op" id="4224045">,</span>&nbsp;<span class="ident" id="4224047">p</span><span class="op" id="4224048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224051">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224054">return</span><br>
<span class="lineno"></span><span class="op" id="4224061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4224064">func</span>&nbsp;<span class="op" id="4224069">(</span><span class="ident" id="4224070">d0</span>&nbsp;<span class="op" id="4224073">*</span><span class="ident" id="4224074">digest</span><span class="op" id="4224080">)</span>&nbsp;<span class="ident" id="4224082">Sum</span><span class="op" id="4224085">(</span><span class="ident" id="4224086">in</span>&nbsp;<span class="op" id="4224089">[</span><span class="op" id="4224090">]</span><span class="builtintype" id="4224091">byte</span><span class="op" id="4224095">)</span>&nbsp;<span class="op" id="4224097">[</span><span class="op" id="4224098">]</span><span class="builtintype" id="4224099">byte</span>&nbsp;<span class="op" id="4224104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4224107">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224174">d</span>&nbsp;<span class="op" id="4224176">:=</span>&nbsp;<span class="builtinfunc" id="4224179">new</span><span class="op" id="4224182">(</span><span class="ident" id="4224183">digest</span><span class="op" id="4224189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224192">*</span><span class="ident" id="4224193">d</span>&nbsp;<span class="op" id="4224195">=</span>&nbsp;<span class="op" id="4224197">*</span><span class="ident" id="4224198">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224202">hash</span>&nbsp;<span class="op" id="4224207">:=</span>&nbsp;<span class="ident" id="4224210">d</span><span class="op" id="4224211">.</span><span class="ident" id="4224212">checkSum</span><span class="op" id="4224220">(</span><span class="op" id="4224221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224224">if</span>&nbsp;<span class="ident" id="4224227">d</span><span class="op" id="4224228">.</span><span class="ident" id="4224229">is384</span>&nbsp;<span class="op" id="4224235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224239">return</span>&nbsp;<span class="builtinfunc" id="4224246">append</span><span class="op" id="4224252">(</span><span class="ident" id="4224253">in</span><span class="op" id="4224255">,</span>&nbsp;<span class="ident" id="4224257">hash</span><span class="op" id="4224261">[</span><span class="op" id="4224262">:</span><span class="ident" id="4224263">Size384</span><span class="op" id="4224270">]</span><span class="op" id="4224271">...</span><span class="op" id="4224274">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224280">return</span>&nbsp;<span class="builtinfunc" id="4224287">append</span><span class="op" id="4224293">(</span><span class="ident" id="4224294">in</span><span class="op" id="4224296">,</span>&nbsp;<span class="ident" id="4224298">hash</span><span class="op" id="4224302">[</span><span class="op" id="4224303">:</span><span class="op" id="4224304">]</span><span class="op" id="4224305">...</span><span class="op" id="4224308">)</span><br>
<span class="lineno"></span><span class="op" id="4224310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4224313">func</span>&nbsp;<span class="op" id="4224318">(</span><span class="ident" id="4224319">d</span>&nbsp;<span class="op" id="4224321">*</span><span class="ident" id="4224322">digest</span><span class="op" id="4224328">)</span>&nbsp;<span class="ident" id="4224330">checkSum</span><span class="op" id="4224338">(</span><span class="op" id="4224339">)</span>&nbsp;<span class="op" id="4224341">[</span><span class="ident" id="4224342">Size</span><span class="op" id="4224346">]</span><span class="builtintype" id="4224347">byte</span>&nbsp;<span class="op" id="4224352">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4224355">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;112&nbsp;bytes&nbsp;mod&nbsp;128.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4224417">len</span>&nbsp;<span class="op" id="4224421">:=</span>&nbsp;<span class="ident" id="4224424">d</span><span class="op" id="4224425">.</span><span class="builtinfunc" id="4224426">len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224431">var</span>&nbsp;<span class="ident" id="4224435">tmp</span>&nbsp;<span class="op" id="4224439">[</span><span class="num" id="4224440">128</span><span class="op" id="4224443">]</span><span class="builtintype" id="4224444">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224450">tmp</span><span class="op" id="4224453">[</span><span class="num" id="4224454">0</span><span class="op" id="4224455">]</span>&nbsp;<span class="op" id="4224457">=</span>&nbsp;<span class="num" id="4224459">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224465">if</span>&nbsp;<span class="builtinfunc" id="4224468">len</span><span class="op" id="4224471">%</span><span class="num" id="4224472">128</span>&nbsp;<span class="op" id="4224476">&lt;</span>&nbsp;<span class="num" id="4224478">112</span>&nbsp;<span class="op" id="4224482">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224486">d</span><span class="op" id="4224487">.</span><span class="ident" id="4224488">Write</span><span class="op" id="4224493">(</span><span class="ident" id="4224494">tmp</span><span class="op" id="4224497">[</span><span class="num" id="4224498">0</span>&nbsp;<span class="op" id="4224500">:</span>&nbsp;<span class="num" id="4224502">112</span><span class="op" id="4224505">-</span><span class="builtinfunc" id="4224506">len</span><span class="op" id="4224509">%</span><span class="num" id="4224510">128</span><span class="op" id="4224513">]</span><span class="op" id="4224514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224517">}</span>&nbsp;<span class="keyword" id="4224519">else</span>&nbsp;<span class="op" id="4224524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224528">d</span><span class="op" id="4224529">.</span><span class="ident" id="4224530">Write</span><span class="op" id="4224535">(</span><span class="ident" id="4224536">tmp</span><span class="op" id="4224539">[</span><span class="num" id="4224540">0</span>&nbsp;<span class="op" id="4224542">:</span>&nbsp;<span class="num" id="4224544">128</span><span class="op" id="4224547">+</span><span class="num" id="4224548">112</span><span class="op" id="4224551">-</span><span class="builtinfunc" id="4224552">len</span><span class="op" id="4224555">%</span><span class="num" id="4224556">128</span><span class="op" id="4224559">]</span><span class="op" id="4224560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4224567">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4224587">len</span>&nbsp;<span class="op" id="4224591">&lt;&lt;=</span>&nbsp;<span class="num" id="4224595">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224598">for</span>&nbsp;<span class="ident" id="4224602">i</span>&nbsp;<span class="op" id="4224604">:=</span>&nbsp;<span class="builtintype" id="4224607">uint</span><span class="op" id="4224611">(</span><span class="num" id="4224612">0</span><span class="op" id="4224613">)</span><span class="op" id="4224614">;</span>&nbsp;<span class="ident" id="4224616">i</span>&nbsp;<span class="op" id="4224618">&lt;</span>&nbsp;<span class="num" id="4224620">16</span><span class="op" id="4224622">;</span>&nbsp;<span class="ident" id="4224624">i</span><span class="op" id="4224625">++</span>&nbsp;<span class="op" id="4224628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224632">tmp</span><span class="op" id="4224635">[</span><span class="ident" id="4224636">i</span><span class="op" id="4224637">]</span>&nbsp;<span class="op" id="4224639">=</span>&nbsp;<span class="builtintype" id="4224641">byte</span><span class="op" id="4224645">(</span><span class="builtinfunc" id="4224646">len</span>&nbsp;<span class="op" id="4224650">&gt;&gt;</span>&nbsp;<span class="op" id="4224653">(</span><span class="num" id="4224654">120</span>&nbsp;<span class="op" id="4224658">-</span>&nbsp;<span class="num" id="4224660">8</span><span class="op" id="4224661">*</span><span class="ident" id="4224662">i</span><span class="op" id="4224663">)</span><span class="op" id="4224664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224667">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224670">d</span><span class="op" id="4224671">.</span><span class="ident" id="4224672">Write</span><span class="op" id="4224677">(</span><span class="ident" id="4224678">tmp</span><span class="op" id="4224681">[</span><span class="num" id="4224682">0</span><span class="op" id="4224683">:</span><span class="num" id="4224684">16</span><span class="op" id="4224686">]</span><span class="op" id="4224687">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224691">if</span>&nbsp;<span class="ident" id="4224694">d</span><span class="op" id="4224695">.</span><span class="ident" id="4224696">nx</span>&nbsp;<span class="op" id="4224699">!=</span>&nbsp;<span class="num" id="4224702">0</span>&nbsp;<span class="op" id="4224704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4224708">panic</span><span class="op" id="4224713">(</span><span class="string" id="4224714">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4224725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224728">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224732">h</span>&nbsp;<span class="op" id="4224734">:=</span>&nbsp;<span class="ident" id="4224737">d</span><span class="op" id="4224738">.</span><span class="ident" id="4224739">h</span><span class="op" id="4224740">[</span><span class="op" id="4224741">:</span><span class="op" id="4224742">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224745">if</span>&nbsp;<span class="ident" id="4224748">d</span><span class="op" id="4224749">.</span><span class="ident" id="4224750">is384</span>&nbsp;<span class="op" id="4224756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224760">h</span>&nbsp;<span class="op" id="4224762">=</span>&nbsp;<span class="ident" id="4224764">d</span><span class="op" id="4224765">.</span><span class="ident" id="4224766">h</span><span class="op" id="4224767">[</span><span class="op" id="4224768">:</span><span class="num" id="4224769">6</span><span class="op" id="4224770">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224773">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224777">var</span>&nbsp;<span class="ident" id="4224781">digest</span>&nbsp;<span class="op" id="4224788">[</span><span class="ident" id="4224789">Size</span><span class="op" id="4224793">]</span><span class="builtintype" id="4224794">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224800">for</span>&nbsp;<span class="ident" id="4224804">i</span><span class="op" id="4224805">,</span>&nbsp;<span class="ident" id="4224807">s</span>&nbsp;<span class="op" id="4224809">:=</span>&nbsp;<span class="keyword" id="4224812">range</span>&nbsp;<span class="ident" id="4224818">h</span>&nbsp;<span class="op" id="4224820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224824">digest</span><span class="op" id="4224830">[</span><span class="ident" id="4224831">i</span><span class="op" id="4224832">*</span><span class="num" id="4224833">8</span><span class="op" id="4224834">]</span>&nbsp;<span class="op" id="4224836">=</span>&nbsp;<span class="builtintype" id="4224838">byte</span><span class="op" id="4224842">(</span><span class="ident" id="4224843">s</span>&nbsp;<span class="op" id="4224845">&gt;&gt;</span>&nbsp;<span class="num" id="4224848">56</span><span class="op" id="4224850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224854">digest</span><span class="op" id="4224860">[</span><span class="ident" id="4224861">i</span><span class="op" id="4224862">*</span><span class="num" id="4224863">8</span><span class="op" id="4224864">+</span><span class="num" id="4224865">1</span><span class="op" id="4224866">]</span>&nbsp;<span class="op" id="4224868">=</span>&nbsp;<span class="builtintype" id="4224870">byte</span><span class="op" id="4224874">(</span><span class="ident" id="4224875">s</span>&nbsp;<span class="op" id="4224877">&gt;&gt;</span>&nbsp;<span class="num" id="4224880">48</span><span class="op" id="4224882">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224886">digest</span><span class="op" id="4224892">[</span><span class="ident" id="4224893">i</span><span class="op" id="4224894">*</span><span class="num" id="4224895">8</span><span class="op" id="4224896">+</span><span class="num" id="4224897">2</span><span class="op" id="4224898">]</span>&nbsp;<span class="op" id="4224900">=</span>&nbsp;<span class="builtintype" id="4224902">byte</span><span class="op" id="4224906">(</span><span class="ident" id="4224907">s</span>&nbsp;<span class="op" id="4224909">&gt;&gt;</span>&nbsp;<span class="num" id="4224912">40</span><span class="op" id="4224914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224918">digest</span><span class="op" id="4224924">[</span><span class="ident" id="4224925">i</span><span class="op" id="4224926">*</span><span class="num" id="4224927">8</span><span class="op" id="4224928">+</span><span class="num" id="4224929">3</span><span class="op" id="4224930">]</span>&nbsp;<span class="op" id="4224932">=</span>&nbsp;<span class="builtintype" id="4224934">byte</span><span class="op" id="4224938">(</span><span class="ident" id="4224939">s</span>&nbsp;<span class="op" id="4224941">&gt;&gt;</span>&nbsp;<span class="num" id="4224944">32</span><span class="op" id="4224946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224950">digest</span><span class="op" id="4224956">[</span><span class="ident" id="4224957">i</span><span class="op" id="4224958">*</span><span class="num" id="4224959">8</span><span class="op" id="4224960">+</span><span class="num" id="4224961">4</span><span class="op" id="4224962">]</span>&nbsp;<span class="op" id="4224964">=</span>&nbsp;<span class="builtintype" id="4224966">byte</span><span class="op" id="4224970">(</span><span class="ident" id="4224971">s</span>&nbsp;<span class="op" id="4224973">&gt;&gt;</span>&nbsp;<span class="num" id="4224976">24</span><span class="op" id="4224978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224982">digest</span><span class="op" id="4224988">[</span><span class="ident" id="4224989">i</span><span class="op" id="4224990">*</span><span class="num" id="4224991">8</span><span class="op" id="4224992">+</span><span class="num" id="4224993">5</span><span class="op" id="4224994">]</span>&nbsp;<span class="op" id="4224996">=</span>&nbsp;<span class="builtintype" id="4224998">byte</span><span class="op" id="4225002">(</span><span class="ident" id="4225003">s</span>&nbsp;<span class="op" id="4225005">&gt;&gt;</span>&nbsp;<span class="num" id="4225008">16</span><span class="op" id="4225010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225014">digest</span><span class="op" id="4225020">[</span><span class="ident" id="4225021">i</span><span class="op" id="4225022">*</span><span class="num" id="4225023">8</span><span class="op" id="4225024">+</span><span class="num" id="4225025">6</span><span class="op" id="4225026">]</span>&nbsp;<span class="op" id="4225028">=</span>&nbsp;<span class="builtintype" id="4225030">byte</span><span class="op" id="4225034">(</span><span class="ident" id="4225035">s</span>&nbsp;<span class="op" id="4225037">&gt;&gt;</span>&nbsp;<span class="num" id="4225040">8</span><span class="op" id="4225041">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225045">digest</span><span class="op" id="4225051">[</span><span class="ident" id="4225052">i</span><span class="op" id="4225053">*</span><span class="num" id="4225054">8</span><span class="op" id="4225055">+</span><span class="num" id="4225056">7</span><span class="op" id="4225057">]</span>&nbsp;<span class="op" id="4225059">=</span>&nbsp;<span class="builtintype" id="4225061">byte</span><span class="op" id="4225065">(</span><span class="ident" id="4225066">s</span><span class="op" id="4225067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4225070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225074">return</span>&nbsp;<span class="ident" id="4225081">digest</span><br>
<span class="lineno"></span><span class="op" id="4225088">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4225091">//&nbsp;Sum512&nbsp;returns&nbsp;the&nbsp;SHA512&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4225142">func</span>&nbsp;<span class="ident" id="4225147">Sum512</span><span class="op" id="4225153">(</span><span class="ident" id="4225154">data</span>&nbsp;<span class="op" id="4225159">[</span><span class="op" id="4225160">]</span><span class="builtintype" id="4225161">byte</span><span class="op" id="4225165">)</span>&nbsp;<span class="op" id="4225167">[</span><span class="ident" id="4225168">Size</span><span class="op" id="4225172">]</span><span class="builtintype" id="4225173">byte</span>&nbsp;<span class="op" id="4225178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225181">var</span>&nbsp;<span class="ident" id="4225185">d</span>&nbsp;<span class="ident" id="4225187">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225195">d</span><span class="op" id="4225196">.</span><span class="ident" id="4225197">Reset</span><span class="op" id="4225202">(</span><span class="op" id="4225203">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225206">d</span><span class="op" id="4225207">.</span><span class="ident" id="4225208">Write</span><span class="op" id="4225213">(</span><span class="ident" id="4225214">data</span><span class="op" id="4225218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225221">return</span>&nbsp;<span class="ident" id="4225228">d</span><span class="op" id="4225229">.</span><span class="ident" id="4225230">checkSum</span><span class="op" id="4225238">(</span><span class="op" id="4225239">)</span><br>
<span class="lineno"></span><span class="op" id="4225241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4225244">//&nbsp;Sum384&nbsp;returns&nbsp;the&nbsp;SHA384&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">190</span><span class="keyword" id="4225295">func</span>&nbsp;<span class="ident" id="4225300">Sum384</span><span class="op" id="4225306">(</span><span class="ident" id="4225307">data</span>&nbsp;<span class="op" id="4225312">[</span><span class="op" id="4225313">]</span><span class="builtintype" id="4225314">byte</span><span class="op" id="4225318">)</span>&nbsp;<span class="op" id="4225320">(</span><span class="ident" id="4225321">sum384</span>&nbsp;<span class="op" id="4225328">[</span><span class="ident" id="4225329">Size384</span><span class="op" id="4225336">]</span><span class="builtintype" id="4225337">byte</span><span class="op" id="4225341">)</span>&nbsp;<span class="op" id="4225343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225346">var</span>&nbsp;<span class="ident" id="4225350">d</span>&nbsp;<span class="ident" id="4225352">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225360">d</span><span class="op" id="4225361">.</span><span class="ident" id="4225362">is384</span>&nbsp;<span class="op" id="4225368">=</span>&nbsp;<span class="builtintype" id="4225370">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225376">d</span><span class="op" id="4225377">.</span><span class="ident" id="4225378">Reset</span><span class="op" id="4225383">(</span><span class="op" id="4225384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225387">d</span><span class="op" id="4225388">.</span><span class="ident" id="4225389">Write</span><span class="op" id="4225394">(</span><span class="ident" id="4225395">data</span><span class="op" id="4225399">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225402">sum</span>&nbsp;<span class="op" id="4225406">:=</span>&nbsp;<span class="ident" id="4225409">d</span><span class="op" id="4225410">.</span><span class="ident" id="4225411">checkSum</span><span class="op" id="4225419">(</span><span class="op" id="4225420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4225423">copy</span><span class="op" id="4225427">(</span><span class="ident" id="4225428">sum384</span><span class="op" id="4225434">[</span><span class="op" id="4225435">:</span><span class="op" id="4225436">]</span><span class="op" id="4225437">,</span>&nbsp;<span class="ident" id="4225439">sum</span><span class="op" id="4225442">[</span><span class="op" id="4225443">:</span><span class="ident" id="4225444">Size384</span><span class="op" id="4225451">]</span><span class="op" id="4225452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225455">return</span><br>
<span class="lineno"></span><span class="op" id="4225462">}</span>
</div>
</body>
</html>
