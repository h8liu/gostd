<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/cipher</h2>
<ul>
<li><a href="/gostd/crypto/cipher/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc.go.html">cbc.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc_aes_test.go.html">cbc_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb.go.html">cfb.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb_test.go.html">cfb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher_test.go.html">cipher_test.go</a></li>
<li><a href="/gostd/crypto/cipher/common_test.go.html">common_test.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr.go.html">ctr.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr_aes_test.go.html">ctr_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm.go.html">gcm.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm_test.go.html">gcm_test.go</a></li>
<li><a href="/gostd/crypto/cipher/io.go.html">io.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb.go.html">ofb.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb_test.go.html">ofb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/xor.go.html">xor.go</a></li>
<li><a href="/gostd/crypto/cipher/xor_test.go.html">xor_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3912930">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3912985">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3913039">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3913090">//&nbsp;Counter&nbsp;(CTR)&nbsp;mode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3913114">//&nbsp;CTR&nbsp;converts&nbsp;a&nbsp;block&nbsp;cipher&nbsp;into&nbsp;a&nbsp;stream&nbsp;cipher&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3913169">//&nbsp;repeatedly&nbsp;encrypting&nbsp;an&nbsp;incrementing&nbsp;counter&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3913222">//&nbsp;xoring&nbsp;the&nbsp;resulting&nbsp;stream&nbsp;of&nbsp;data&nbsp;with&nbsp;the&nbsp;input.</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="3913278">//&nbsp;See&nbsp;NIST&nbsp;SP&nbsp;800-38A,&nbsp;pp&nbsp;13-15</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3913312">package</span>&nbsp;<span class="ident" id="3913320">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3913328">type</span>&nbsp;<span class="ident" id="3913333">ctr</span>&nbsp;<span class="keyword" id="3913337">struct</span>&nbsp;<span class="op" id="3913344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913347">b</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913355">Block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913362">ctr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3913370">[</span><span class="op" id="3913371">]</span><span class="builtintype" id="3913372">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913378">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3913386">[</span><span class="op" id="3913387">]</span><span class="builtintype" id="3913388">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913394">outUsed</span>&nbsp;<span class="builtintype" id="3913402">int</span><br>
<span class="lineno">20</span><span class="op" id="3913406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3913409">const</span>&nbsp;<span class="ident" id="3913415">streamBufferSize</span>&nbsp;<span class="op" id="3913432">=</span>&nbsp;<span class="num" id="3913434">512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3913439">//&nbsp;NewCTR&nbsp;returns&nbsp;a&nbsp;Stream&nbsp;which&nbsp;encrypts/decrypts&nbsp;using&nbsp;the&nbsp;given&nbsp;Block&nbsp;in</span><br>
<span class="lineno">25</span><span class="comment" id="3913515">//&nbsp;counter&nbsp;mode.&nbsp;The&nbsp;length&nbsp;of&nbsp;iv&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;Block&#39;s&nbsp;block&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="3913593">func</span>&nbsp;<span class="ident" id="3913598">NewCTR</span><span class="op" id="3913604">(</span><span class="ident" id="3913605">block</span>&nbsp;<span class="ident" id="3913611">Block</span><span class="op" id="3913616">,</span>&nbsp;<span class="ident" id="3913618">iv</span>&nbsp;<span class="op" id="3913621">[</span><span class="op" id="3913622">]</span><span class="builtintype" id="3913623">byte</span><span class="op" id="3913627">)</span>&nbsp;<span class="ident" id="3913629">Stream</span>&nbsp;<span class="op" id="3913636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913639">if</span>&nbsp;<span class="builtinfunc" id="3913642">len</span><span class="op" id="3913645">(</span><span class="ident" id="3913646">iv</span><span class="op" id="3913648">)</span>&nbsp;<span class="op" id="3913650">!=</span>&nbsp;<span class="ident" id="3913653">block</span><span class="op" id="3913658">.</span><span class="ident" id="3913659">BlockSize</span><span class="op" id="3913668">(</span><span class="op" id="3913669">)</span>&nbsp;<span class="op" id="3913671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3913675">panic</span><span class="op" id="3913680">(</span><span class="string" id="3913681">&#34;cipher.NewCTR:&nbsp;IV&nbsp;length&nbsp;must&nbsp;equal&nbsp;block&nbsp;size&#34;</span><span class="op" id="3913729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3913732">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913735">bufSize</span>&nbsp;<span class="op" id="3913743">:=</span>&nbsp;<span class="ident" id="3913746">streamBufferSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913764">if</span>&nbsp;<span class="ident" id="3913767">bufSize</span>&nbsp;<span class="op" id="3913775">&lt;</span>&nbsp;<span class="ident" id="3913777">block</span><span class="op" id="3913782">.</span><span class="ident" id="3913783">BlockSize</span><span class="op" id="3913792">(</span><span class="op" id="3913793">)</span>&nbsp;<span class="op" id="3913795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913799">bufSize</span>&nbsp;<span class="op" id="3913807">=</span>&nbsp;<span class="ident" id="3913809">block</span><span class="op" id="3913814">.</span><span class="ident" id="3913815">BlockSize</span><span class="op" id="3913824">(</span><span class="op" id="3913825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3913828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913831">return</span>&nbsp;<span class="op" id="3913838">&amp;</span><span class="ident" id="3913839">ctr</span><span class="op" id="3913842">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913846">b</span><span class="op" id="3913847">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913855">block</span><span class="op" id="3913860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913864">ctr</span><span class="op" id="3913867">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913873">dup</span><span class="op" id="3913876">(</span><span class="ident" id="3913877">iv</span><span class="op" id="3913879">)</span><span class="op" id="3913880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913884">out</span><span class="op" id="3913887">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3913893">make</span><span class="op" id="3913897">(</span><span class="op" id="3913898">[</span><span class="op" id="3913899">]</span><span class="builtintype" id="3913900">byte</span><span class="op" id="3913904">,</span>&nbsp;<span class="num" id="3913906">0</span><span class="op" id="3913907">,</span>&nbsp;<span class="ident" id="3913909">bufSize</span><span class="op" id="3913916">)</span><span class="op" id="3913917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913921">outUsed</span><span class="op" id="3913928">:</span>&nbsp;<span class="num" id="3913930">0</span><span class="op" id="3913931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3913934">}</span><br>
<span class="lineno">40</span><span class="op" id="3913936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3913939">func</span>&nbsp;<span class="op" id="3913944">(</span><span class="ident" id="3913945">x</span>&nbsp;<span class="op" id="3913947">*</span><span class="ident" id="3913948">ctr</span><span class="op" id="3913951">)</span>&nbsp;<span class="ident" id="3913953">refill</span><span class="op" id="3913959">(</span><span class="op" id="3913960">)</span>&nbsp;<span class="op" id="3913962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913965">remain</span>&nbsp;<span class="op" id="3913972">:=</span>&nbsp;<span class="builtinfunc" id="3913975">len</span><span class="op" id="3913978">(</span><span class="ident" id="3913979">x</span><span class="op" id="3913980">.</span><span class="ident" id="3913981">out</span><span class="op" id="3913984">)</span>&nbsp;<span class="op" id="3913986">-</span>&nbsp;<span class="ident" id="3913988">x</span><span class="op" id="3913989">.</span><span class="ident" id="3913990">outUsed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913999">if</span>&nbsp;<span class="ident" id="3914002">remain</span>&nbsp;<span class="op" id="3914009">&gt;</span>&nbsp;<span class="ident" id="3914011">x</span><span class="op" id="3914012">.</span><span class="ident" id="3914013">outUsed</span>&nbsp;<span class="op" id="3914021">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914025">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3914033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3914036">copy</span><span class="op" id="3914040">(</span><span class="ident" id="3914041">x</span><span class="op" id="3914042">.</span><span class="ident" id="3914043">out</span><span class="op" id="3914046">,</span>&nbsp;<span class="ident" id="3914048">x</span><span class="op" id="3914049">.</span><span class="ident" id="3914050">out</span><span class="op" id="3914053">[</span><span class="ident" id="3914054">x</span><span class="op" id="3914055">.</span><span class="ident" id="3914056">outUsed</span><span class="op" id="3914063">:</span><span class="op" id="3914064">]</span><span class="op" id="3914065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914068">x</span><span class="op" id="3914069">.</span><span class="ident" id="3914070">out</span>&nbsp;<span class="op" id="3914074">=</span>&nbsp;<span class="ident" id="3914076">x</span><span class="op" id="3914077">.</span><span class="ident" id="3914078">out</span><span class="op" id="3914081">[</span><span class="op" id="3914082">:</span><span class="builtinfunc" id="3914083">cap</span><span class="op" id="3914086">(</span><span class="ident" id="3914087">x</span><span class="op" id="3914088">.</span><span class="ident" id="3914089">out</span><span class="op" id="3914092">)</span><span class="op" id="3914093">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914096">bs</span>&nbsp;<span class="op" id="3914099">:=</span>&nbsp;<span class="ident" id="3914102">x</span><span class="op" id="3914103">.</span><span class="ident" id="3914104">b</span><span class="op" id="3914105">.</span><span class="ident" id="3914106">BlockSize</span><span class="op" id="3914115">(</span><span class="op" id="3914116">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914119">for</span>&nbsp;<span class="ident" id="3914123">remain</span>&nbsp;<span class="op" id="3914130">&lt;</span>&nbsp;<span class="builtinfunc" id="3914132">len</span><span class="op" id="3914135">(</span><span class="ident" id="3914136">x</span><span class="op" id="3914137">.</span><span class="ident" id="3914138">out</span><span class="op" id="3914141">)</span><span class="op" id="3914142">-</span><span class="ident" id="3914143">bs</span>&nbsp;<span class="op" id="3914146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914150">x</span><span class="op" id="3914151">.</span><span class="ident" id="3914152">b</span><span class="op" id="3914153">.</span><span class="ident" id="3914154">Encrypt</span><span class="op" id="3914161">(</span><span class="ident" id="3914162">x</span><span class="op" id="3914163">.</span><span class="ident" id="3914164">out</span><span class="op" id="3914167">[</span><span class="ident" id="3914168">remain</span><span class="op" id="3914174">:</span><span class="op" id="3914175">]</span><span class="op" id="3914176">,</span>&nbsp;<span class="ident" id="3914178">x</span><span class="op" id="3914179">.</span><span class="ident" id="3914180">ctr</span><span class="op" id="3914183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914187">remain</span>&nbsp;<span class="op" id="3914194">+=</span>&nbsp;<span class="ident" id="3914197">bs</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3914203">//&nbsp;Increment&nbsp;counter</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914226">for</span>&nbsp;<span class="ident" id="3914230">i</span>&nbsp;<span class="op" id="3914232">:=</span>&nbsp;<span class="builtinfunc" id="3914235">len</span><span class="op" id="3914238">(</span><span class="ident" id="3914239">x</span><span class="op" id="3914240">.</span><span class="ident" id="3914241">ctr</span><span class="op" id="3914244">)</span>&nbsp;<span class="op" id="3914246">-</span>&nbsp;<span class="num" id="3914248">1</span><span class="op" id="3914249">;</span>&nbsp;<span class="ident" id="3914251">i</span>&nbsp;<span class="op" id="3914253">&gt;=</span>&nbsp;<span class="num" id="3914256">0</span><span class="op" id="3914257">;</span>&nbsp;<span class="ident" id="3914259">i</span><span class="op" id="3914260">--</span>&nbsp;<span class="op" id="3914263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914268">x</span><span class="op" id="3914269">.</span><span class="ident" id="3914270">ctr</span><span class="op" id="3914273">[</span><span class="ident" id="3914274">i</span><span class="op" id="3914275">]</span><span class="op" id="3914276">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914282">if</span>&nbsp;<span class="ident" id="3914285">x</span><span class="op" id="3914286">.</span><span class="ident" id="3914287">ctr</span><span class="op" id="3914290">[</span><span class="ident" id="3914291">i</span><span class="op" id="3914292">]</span>&nbsp;<span class="op" id="3914294">!=</span>&nbsp;<span class="num" id="3914297">0</span>&nbsp;<span class="op" id="3914299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914305">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3914314">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3914318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3914321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914324">x</span><span class="op" id="3914325">.</span><span class="ident" id="3914326">out</span>&nbsp;<span class="op" id="3914330">=</span>&nbsp;<span class="ident" id="3914332">x</span><span class="op" id="3914333">.</span><span class="ident" id="3914334">out</span><span class="op" id="3914337">[</span><span class="op" id="3914338">:</span><span class="ident" id="3914339">remain</span><span class="op" id="3914345">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914348">x</span><span class="op" id="3914349">.</span><span class="ident" id="3914350">outUsed</span>&nbsp;<span class="op" id="3914358">=</span>&nbsp;<span class="num" id="3914360">0</span><br>
<span class="lineno"></span><span class="op" id="3914362">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3914365">func</span>&nbsp;<span class="op" id="3914370">(</span><span class="ident" id="3914371">x</span>&nbsp;<span class="op" id="3914373">*</span><span class="ident" id="3914374">ctr</span><span class="op" id="3914377">)</span>&nbsp;<span class="ident" id="3914379">XORKeyStream</span><span class="op" id="3914391">(</span><span class="ident" id="3914392">dst</span><span class="op" id="3914395">,</span>&nbsp;<span class="ident" id="3914397">src</span>&nbsp;<span class="op" id="3914401">[</span><span class="op" id="3914402">]</span><span class="builtintype" id="3914403">byte</span><span class="op" id="3914407">)</span>&nbsp;<span class="op" id="3914409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914412">for</span>&nbsp;<span class="builtinfunc" id="3914416">len</span><span class="op" id="3914419">(</span><span class="ident" id="3914420">src</span><span class="op" id="3914423">)</span>&nbsp;<span class="op" id="3914425">&gt;</span>&nbsp;<span class="num" id="3914427">0</span>&nbsp;<span class="op" id="3914429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914433">if</span>&nbsp;<span class="ident" id="3914436">x</span><span class="op" id="3914437">.</span><span class="ident" id="3914438">outUsed</span>&nbsp;<span class="op" id="3914446">&gt;=</span>&nbsp;<span class="builtinfunc" id="3914449">len</span><span class="op" id="3914452">(</span><span class="ident" id="3914453">x</span><span class="op" id="3914454">.</span><span class="ident" id="3914455">out</span><span class="op" id="3914458">)</span><span class="op" id="3914459">-</span><span class="ident" id="3914460">x</span><span class="op" id="3914461">.</span><span class="ident" id="3914462">b</span><span class="op" id="3914463">.</span><span class="ident" id="3914464">BlockSize</span><span class="op" id="3914473">(</span><span class="op" id="3914474">)</span>&nbsp;<span class="op" id="3914476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914481">x</span><span class="op" id="3914482">.</span><span class="ident" id="3914483">refill</span><span class="op" id="3914489">(</span><span class="op" id="3914490">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3914494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914498">n</span>&nbsp;<span class="op" id="3914500">:=</span>&nbsp;<span class="ident" id="3914503">xorBytes</span><span class="op" id="3914511">(</span><span class="ident" id="3914512">dst</span><span class="op" id="3914515">,</span>&nbsp;<span class="ident" id="3914517">src</span><span class="op" id="3914520">,</span>&nbsp;<span class="ident" id="3914522">x</span><span class="op" id="3914523">.</span><span class="ident" id="3914524">out</span><span class="op" id="3914527">[</span><span class="ident" id="3914528">x</span><span class="op" id="3914529">.</span><span class="ident" id="3914530">outUsed</span><span class="op" id="3914537">:</span><span class="op" id="3914538">]</span><span class="op" id="3914539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914543">dst</span>&nbsp;<span class="op" id="3914547">=</span>&nbsp;<span class="ident" id="3914549">dst</span><span class="op" id="3914552">[</span><span class="ident" id="3914553">n</span><span class="op" id="3914554">:</span><span class="op" id="3914555">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914559">src</span>&nbsp;<span class="op" id="3914563">=</span>&nbsp;<span class="ident" id="3914565">src</span><span class="op" id="3914568">[</span><span class="ident" id="3914569">n</span><span class="op" id="3914570">:</span><span class="op" id="3914571">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914575">x</span><span class="op" id="3914576">.</span><span class="ident" id="3914577">outUsed</span>&nbsp;<span class="op" id="3914585">+=</span>&nbsp;<span class="ident" id="3914588">n</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3914591">}</span><br>
<span class="lineno"></span><span class="op" id="3914593">}</span>
</div>
</body>
</html>
