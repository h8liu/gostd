<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6574872">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6574928">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6574982">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6575033">package</span>&nbsp;<span class="ident" id="6575041">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6575047">import</span>&nbsp;<span class="op" id="6575054">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6575057">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6575066">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6575076">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6575083">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6575089">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6575102">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6575113">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6575124">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6575134">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6575137">type</span>&nbsp;<span class="ident" id="6575142">reqWriteTest</span>&nbsp;<span class="keyword" id="6575155">struct</span>&nbsp;<span class="op" id="6575162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6575165">Req</span>&nbsp;&nbsp;<span class="ident" id="6575170">Request</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6575179">Body</span>&nbsp;<span class="keyword" id="6575184">interface</span><span class="op" id="6575193">{</span><span class="op" id="6575194">}</span>&nbsp;<span class="comment" id="6575196">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6575262">//&nbsp;Any&nbsp;of&nbsp;these&nbsp;three&nbsp;may&nbsp;be&nbsp;empty&nbsp;to&nbsp;skip&nbsp;that&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6575317">WantWrite</span>&nbsp;<span class="builtintype" id="6575327">string</span>&nbsp;<span class="comment" id="6575334">//&nbsp;Request.Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6575352">WantProxy</span>&nbsp;<span class="builtintype" id="6575362">string</span>&nbsp;<span class="comment" id="6575369">//&nbsp;Request.WriteProxy</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6575393">WantError</span>&nbsp;<span class="builtintype" id="6575403">error</span>&nbsp;<span class="comment" id="6575409">//&nbsp;wanted&nbsp;error&nbsp;from&nbsp;Request.Write</span><br>
<span class="lineno"></span><span class="op" id="6575444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6575447">var</span>&nbsp;<span class="ident" id="6575451">reqWriteTests</span>&nbsp;<span class="op" id="6575465">=</span>&nbsp;<span class="op" id="6575467">[</span><span class="op" id="6575468">]</span><span class="ident" id="6575469">reqWriteTest</span><span class="op" id="6575481">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6575484">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;no&nbsp;body;&nbsp;no&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6575536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6575540">Req</span><span class="op" id="6575543">:</span>&nbsp;<span class="ident" id="6575545">Request</span><span class="op" id="6575552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6575557">Method</span><span class="op" id="6575563">:</span>&nbsp;<span class="string" id="6575565">&#34;GET&#34;</span><span class="op" id="6575570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6575575">URL</span><span class="op" id="6575578">:</span>&nbsp;<span class="op" id="6575580">&amp;</span><span class="ident" id="6575581">url</span><span class="op" id="6575584">.</span><span class="ident" id="6575585">URL</span><span class="op" id="6575588">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6575594">Scheme</span><span class="op" id="6575600">:</span>&nbsp;<span class="string" id="6575602">&#34;http&#34;</span><span class="op" id="6575608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6575614">Host</span><span class="op" id="6575618">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6575622">&#34;www.techcrunch.com&#34;</span><span class="op" id="6575642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6575648">Path</span><span class="op" id="6575652">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6575656">&#34;/&#34;</span><span class="op" id="6575659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6575664">}</span><span class="op" id="6575665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6575670">Proto</span><span class="op" id="6575675">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6575682">&#34;HTTP/1.1&#34;</span><span class="op" id="6575692">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6575697">ProtoMajor</span><span class="op" id="6575707">:</span>&nbsp;<span class="num" id="6575709">1</span><span class="op" id="6575710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6575715">ProtoMinor</span><span class="op" id="6575725">:</span>&nbsp;<span class="num" id="6575727">1</span><span class="op" id="6575728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6575733">Header</span><span class="op" id="6575739">:</span>&nbsp;<span class="ident" id="6575741">Header</span><span class="op" id="6575747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6575753">&#34;Accept&#34;</span><span class="op" id="6575761">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6575773">{</span><span class="string" id="6575774">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#34;</span><span class="op" id="6575839">}</span><span class="op" id="6575840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6575846">&#34;Accept-Charset&#34;</span><span class="op" id="6575862">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6575866">{</span><span class="string" id="6575867">&#34;ISO-8859-1,utf-8;q=0.7,*;q=0.7&#34;</span><span class="op" id="6575899">}</span><span class="op" id="6575900">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6575906">&#34;Accept-Encoding&#34;</span><span class="op" id="6575923">:</span>&nbsp;&nbsp;<span class="op" id="6575926">{</span><span class="string" id="6575927">&#34;gzip,deflate&#34;</span><span class="op" id="6575941">}</span><span class="op" id="6575942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6575948">&#34;Accept-Language&#34;</span><span class="op" id="6575965">:</span>&nbsp;&nbsp;<span class="op" id="6575968">{</span><span class="string" id="6575969">&#34;en-us,en;q=0.5&#34;</span><span class="op" id="6575985">}</span><span class="op" id="6575986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6575992">&#34;Keep-Alive&#34;</span><span class="op" id="6576004">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6576012">{</span><span class="string" id="6576013">&#34;300&#34;</span><span class="op" id="6576018">}</span><span class="op" id="6576019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576025">&#34;Proxy-Connection&#34;</span><span class="op" id="6576043">:</span>&nbsp;<span class="op" id="6576045">{</span><span class="string" id="6576046">&#34;keep-alive&#34;</span><span class="op" id="6576058">}</span><span class="op" id="6576059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576065">&#34;User-Agent&#34;</span><span class="op" id="6576077">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6576085">{</span><span class="string" id="6576086">&#34;Fake&#34;</span><span class="op" id="6576092">}</span><span class="op" id="6576093">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6576098">}</span><span class="op" id="6576099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6576104">Body</span><span class="op" id="6576108">:</span>&nbsp;&nbsp;<span class="ident" id="6576111">nil</span><span class="op" id="6576114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6576119">Close</span><span class="op" id="6576124">:</span>&nbsp;<span class="builtintype" id="6576126">false</span><span class="op" id="6576131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6576136">Host</span><span class="op" id="6576140">:</span>&nbsp;&nbsp;<span class="string" id="6576143">&#34;www.techcrunch.com&#34;</span><span class="op" id="6576163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6576168">Form</span><span class="op" id="6576172">:</span>&nbsp;&nbsp;<span class="keyword" id="6576175">map</span><span class="op" id="6576178">[</span><span class="builtintype" id="6576179">string</span><span class="op" id="6576185">]</span><span class="op" id="6576186">[</span><span class="op" id="6576187">]</span><span class="builtintype" id="6576188">string</span><span class="op" id="6576194">{</span><span class="op" id="6576195">}</span><span class="op" id="6576196">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6576200">}</span><span class="op" id="6576201">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6576206">WantWrite</span><span class="op" id="6576215">:</span>&nbsp;<span class="string" id="6576217">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6576238">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576243">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="6576274">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576279">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="6576302">+</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576307">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="6576385">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576390">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="6576443">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576448">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="6576484">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576489">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="6576527">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576532">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="6576554">+</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576559">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="6576597">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6576602">WantProxy</span><span class="op" id="6576611">:</span>&nbsp;<span class="string" id="6576613">&#34;GET&nbsp;http://www.techcrunch.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6576659">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576664">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="6576695">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576700">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="6576723">+</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576728">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="6576806">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576811">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="6576864">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576869">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="6576905">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576910">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="6576948">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576953">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="6576975">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6576980">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="6577018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6577021">}</span><span class="op" id="6577022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6577025">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6577077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577081">Req</span><span class="op" id="6577084">:</span>&nbsp;<span class="ident" id="6577086">Request</span><span class="op" id="6577093">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577098">Method</span><span class="op" id="6577104">:</span>&nbsp;<span class="string" id="6577106">&#34;GET&#34;</span><span class="op" id="6577111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577116">URL</span><span class="op" id="6577119">:</span>&nbsp;<span class="op" id="6577121">&amp;</span><span class="ident" id="6577122">url</span><span class="op" id="6577125">.</span><span class="ident" id="6577126">URL</span><span class="op" id="6577129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577135">Scheme</span><span class="op" id="6577141">:</span>&nbsp;<span class="string" id="6577143">&#34;http&#34;</span><span class="op" id="6577149">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577155">Host</span><span class="op" id="6577159">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6577163">&#34;www.google.com&#34;</span><span class="op" id="6577179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577185">Path</span><span class="op" id="6577189">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6577193">&#34;/search&#34;</span><span class="op" id="6577202">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6577207">}</span><span class="op" id="6577208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577213">ProtoMajor</span><span class="op" id="6577223">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6577231">1</span><span class="op" id="6577232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577237">ProtoMinor</span><span class="op" id="6577247">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6577255">1</span><span class="op" id="6577256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577261">Header</span><span class="op" id="6577267">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6577279">Header</span><span class="op" id="6577285">{</span><span class="op" id="6577286">}</span><span class="op" id="6577287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577292">TransferEncoding</span><span class="op" id="6577308">:</span>&nbsp;<span class="op" id="6577310">[</span><span class="op" id="6577311">]</span><span class="builtintype" id="6577312">string</span><span class="op" id="6577318">{</span><span class="string" id="6577319">&#34;chunked&#34;</span><span class="op" id="6577328">}</span><span class="op" id="6577329">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6577333">}</span><span class="op" id="6577334">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577339">Body</span><span class="op" id="6577343">:</span>&nbsp;<span class="op" id="6577345">[</span><span class="op" id="6577346">]</span><span class="builtintype" id="6577347">byte</span><span class="op" id="6577351">(</span><span class="string" id="6577352">&#34;abcdef&#34;</span><span class="op" id="6577360">)</span><span class="op" id="6577361">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577366">WantWrite</span><span class="op" id="6577375">:</span>&nbsp;<span class="string" id="6577377">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6577404">+</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6577409">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="6577436">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6577441">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6577479">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6577484">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="6577521">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577526">chunk</span><span class="op" id="6577531">(</span><span class="string" id="6577532">&#34;abcdef&#34;</span><span class="op" id="6577540">)</span>&nbsp;<span class="op" id="6577542">+</span>&nbsp;<span class="ident" id="6577544">chunk</span><span class="op" id="6577549">(</span><span class="string" id="6577550">&#34;&#34;</span><span class="op" id="6577552">)</span><span class="op" id="6577553">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577558">WantProxy</span><span class="op" id="6577567">:</span>&nbsp;<span class="string" id="6577569">&#34;GET&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6577617">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6577622">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="6577649">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6577654">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6577692">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6577697">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="6577734">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577739">chunk</span><span class="op" id="6577744">(</span><span class="string" id="6577745">&#34;abcdef&#34;</span><span class="op" id="6577753">)</span>&nbsp;<span class="op" id="6577755">+</span>&nbsp;<span class="ident" id="6577757">chunk</span><span class="op" id="6577762">(</span><span class="string" id="6577763">&#34;&#34;</span><span class="op" id="6577765">)</span><span class="op" id="6577766">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6577769">}</span><span class="op" id="6577770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6577773">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6577830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577834">Req</span><span class="op" id="6577837">:</span>&nbsp;<span class="ident" id="6577839">Request</span><span class="op" id="6577846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577851">Method</span><span class="op" id="6577857">:</span>&nbsp;<span class="string" id="6577859">&#34;POST&#34;</span><span class="op" id="6577865">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577870">URL</span><span class="op" id="6577873">:</span>&nbsp;<span class="op" id="6577875">&amp;</span><span class="ident" id="6577876">url</span><span class="op" id="6577879">.</span><span class="ident" id="6577880">URL</span><span class="op" id="6577883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577889">Scheme</span><span class="op" id="6577895">:</span>&nbsp;<span class="string" id="6577897">&#34;http&#34;</span><span class="op" id="6577903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577909">Host</span><span class="op" id="6577913">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6577917">&#34;www.google.com&#34;</span><span class="op" id="6577933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577939">Path</span><span class="op" id="6577943">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6577947">&#34;/search&#34;</span><span class="op" id="6577956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6577961">}</span><span class="op" id="6577962">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577967">ProtoMajor</span><span class="op" id="6577977">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6577985">1</span><span class="op" id="6577986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6577991">ProtoMinor</span><span class="op" id="6578001">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6578009">1</span><span class="op" id="6578010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578015">Header</span><span class="op" id="6578021">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578033">Header</span><span class="op" id="6578039">{</span><span class="op" id="6578040">}</span><span class="op" id="6578041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578046">Close</span><span class="op" id="6578051">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6578064">true</span><span class="op" id="6578068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578073">TransferEncoding</span><span class="op" id="6578089">:</span>&nbsp;<span class="op" id="6578091">[</span><span class="op" id="6578092">]</span><span class="builtintype" id="6578093">string</span><span class="op" id="6578099">{</span><span class="string" id="6578100">&#34;chunked&#34;</span><span class="op" id="6578109">}</span><span class="op" id="6578110">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6578114">}</span><span class="op" id="6578115">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578120">Body</span><span class="op" id="6578124">:</span>&nbsp;<span class="op" id="6578126">[</span><span class="op" id="6578127">]</span><span class="builtintype" id="6578128">byte</span><span class="op" id="6578132">(</span><span class="string" id="6578133">&#34;abcdef&#34;</span><span class="op" id="6578141">)</span><span class="op" id="6578142">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578147">WantWrite</span><span class="op" id="6578156">:</span>&nbsp;<span class="string" id="6578158">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6578186">+</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6578191">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="6578218">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6578223">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6578261">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6578266">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="6578290">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6578295">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="6578332">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578337">chunk</span><span class="op" id="6578342">(</span><span class="string" id="6578343">&#34;abcdef&#34;</span><span class="op" id="6578351">)</span>&nbsp;<span class="op" id="6578353">+</span>&nbsp;<span class="ident" id="6578355">chunk</span><span class="op" id="6578360">(</span><span class="string" id="6578361">&#34;&#34;</span><span class="op" id="6578363">)</span><span class="op" id="6578364">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578369">WantProxy</span><span class="op" id="6578378">:</span>&nbsp;<span class="string" id="6578380">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6578429">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6578434">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="6578461">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6578466">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6578504">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6578509">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="6578533">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6578538">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="6578575">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578580">chunk</span><span class="op" id="6578585">(</span><span class="string" id="6578586">&#34;abcdef&#34;</span><span class="op" id="6578594">)</span>&nbsp;<span class="op" id="6578596">+</span>&nbsp;<span class="ident" id="6578598">chunk</span><span class="op" id="6578603">(</span><span class="string" id="6578604">&#34;&#34;</span><span class="op" id="6578606">)</span><span class="op" id="6578607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6578610">}</span><span class="op" id="6578611">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6578615">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length,&nbsp;no&nbsp;chunking</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6578666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578670">Req</span><span class="op" id="6578673">:</span>&nbsp;<span class="ident" id="6578675">Request</span><span class="op" id="6578682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578687">Method</span><span class="op" id="6578693">:</span>&nbsp;<span class="string" id="6578695">&#34;POST&#34;</span><span class="op" id="6578701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578706">URL</span><span class="op" id="6578709">:</span>&nbsp;<span class="op" id="6578711">&amp;</span><span class="ident" id="6578712">url</span><span class="op" id="6578715">.</span><span class="ident" id="6578716">URL</span><span class="op" id="6578719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578725">Scheme</span><span class="op" id="6578731">:</span>&nbsp;<span class="string" id="6578733">&#34;http&#34;</span><span class="op" id="6578739">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578745">Host</span><span class="op" id="6578749">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6578753">&#34;www.google.com&#34;</span><span class="op" id="6578769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578775">Path</span><span class="op" id="6578779">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6578783">&#34;/search&#34;</span><span class="op" id="6578792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6578797">}</span><span class="op" id="6578798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578803">ProtoMajor</span><span class="op" id="6578813">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6578818">1</span><span class="op" id="6578819">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578824">ProtoMinor</span><span class="op" id="6578834">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6578839">1</span><span class="op" id="6578840">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578845">Header</span><span class="op" id="6578851">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6578860">Header</span><span class="op" id="6578866">{</span><span class="op" id="6578867">}</span><span class="op" id="6578868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578873">Close</span><span class="op" id="6578878">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6578888">true</span><span class="op" id="6578892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578897">ContentLength</span><span class="op" id="6578910">:</span>&nbsp;<span class="num" id="6578912">6</span><span class="op" id="6578913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6578917">}</span><span class="op" id="6578918">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578923">Body</span><span class="op" id="6578927">:</span>&nbsp;<span class="op" id="6578929">[</span><span class="op" id="6578930">]</span><span class="builtintype" id="6578931">byte</span><span class="op" id="6578935">(</span><span class="string" id="6578936">&#34;abcdef&#34;</span><span class="op" id="6578944">)</span><span class="op" id="6578945">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6578950">WantWrite</span><span class="op" id="6578959">:</span>&nbsp;<span class="string" id="6578961">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6578989">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6578994">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="6579021">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579026">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6579064">+</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579069">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="6579093">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579098">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="6579122">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579127">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6579134">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579139">&#34;abcdef&#34;</span><span class="op" id="6579147">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6579152">WantProxy</span><span class="op" id="6579161">:</span>&nbsp;<span class="string" id="6579163">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6579212">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579217">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="6579244">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579249">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6579287">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579292">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="6579316">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579321">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="6579345">+</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579350">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6579357">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579362">&#34;abcdef&#34;</span><span class="op" id="6579370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6579373">}</span><span class="op" id="6579374">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6579378">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length&nbsp;in&nbsp;headers</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6579427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6579431">Req</span><span class="op" id="6579434">:</span>&nbsp;<span class="ident" id="6579436">Request</span><span class="op" id="6579443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6579448">Method</span><span class="op" id="6579454">:</span>&nbsp;<span class="string" id="6579456">&#34;POST&#34;</span><span class="op" id="6579462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6579467">URL</span><span class="op" id="6579470">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6579475">mustParseURL</span><span class="op" id="6579487">(</span><span class="string" id="6579488">&#34;http://example.com/&#34;</span><span class="op" id="6579509">)</span><span class="op" id="6579510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6579515">Host</span><span class="op" id="6579519">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6579523">&#34;example.com&#34;</span><span class="op" id="6579536">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6579541">Header</span><span class="op" id="6579547">:</span>&nbsp;<span class="ident" id="6579549">Header</span><span class="op" id="6579555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579561">&#34;Content-Length&#34;</span><span class="op" id="6579577">:</span>&nbsp;<span class="op" id="6579579">[</span><span class="op" id="6579580">]</span><span class="builtintype" id="6579581">string</span><span class="op" id="6579587">{</span><span class="string" id="6579588">&#34;10&#34;</span><span class="op" id="6579592">}</span><span class="op" id="6579593">,</span>&nbsp;<span class="comment" id="6579595">//&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6579609">}</span><span class="op" id="6579610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6579615">ContentLength</span><span class="op" id="6579628">:</span>&nbsp;<span class="num" id="6579630">6</span><span class="op" id="6579631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6579635">}</span><span class="op" id="6579636">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6579641">Body</span><span class="op" id="6579645">:</span>&nbsp;<span class="op" id="6579647">[</span><span class="op" id="6579648">]</span><span class="builtintype" id="6579649">byte</span><span class="op" id="6579653">(</span><span class="string" id="6579654">&#34;abcdef&#34;</span><span class="op" id="6579662">)</span><span class="op" id="6579663">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6579668">WantWrite</span><span class="op" id="6579677">:</span>&nbsp;<span class="string" id="6579679">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6579701">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579706">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="6579730">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579735">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6579773">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579778">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="6579802">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579807">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6579814">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579819">&#34;abcdef&#34;</span><span class="op" id="6579827">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6579832">WantProxy</span><span class="op" id="6579841">:</span>&nbsp;<span class="string" id="6579843">&#34;POST&nbsp;http://example.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6579883">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579888">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="6579912">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579917">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6579955">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579960">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="6579984">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6579989">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6579996">+</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6580001">&#34;abcdef&#34;</span><span class="op" id="6580009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6580012">}</span><span class="op" id="6580013">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6580017">//&nbsp;default&nbsp;to&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6580041">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6580045">Req</span><span class="op" id="6580048">:</span>&nbsp;<span class="ident" id="6580050">Request</span><span class="op" id="6580057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6580062">Method</span><span class="op" id="6580068">:</span>&nbsp;<span class="string" id="6580070">&#34;GET&#34;</span><span class="op" id="6580075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6580080">URL</span><span class="op" id="6580083">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6580088">mustParseURL</span><span class="op" id="6580100">(</span><span class="string" id="6580101">&#34;/search&#34;</span><span class="op" id="6580110">)</span><span class="op" id="6580111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6580116">Host</span><span class="op" id="6580120">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6580124">&#34;www.google.com&#34;</span><span class="op" id="6580140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6580144">}</span><span class="op" id="6580145">,</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6580150">WantWrite</span><span class="op" id="6580159">:</span>&nbsp;<span class="string" id="6580161">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6580188">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6580193">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="6580220">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6580225">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6580263">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6580268">&#34;\r\n&#34;</span><span class="op" id="6580274">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6580277">}</span><span class="op" id="6580278">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6580282">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;0&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6580336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6580340">Req</span><span class="op" id="6580343">:</span>&nbsp;<span class="ident" id="6580345">Request</span><span class="op" id="6580352">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6580357">Method</span><span class="op" id="6580363">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6580372">&#34;POST&#34;</span><span class="op" id="6580378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6580383">URL</span><span class="op" id="6580386">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6580398">mustParseURL</span><span class="op" id="6580410">(</span><span class="string" id="6580411">&#34;/&#34;</span><span class="op" id="6580414">)</span><span class="op" id="6580415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6580420">Host</span><span class="op" id="6580424">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6580435">&#34;example.com&#34;</span><span class="op" id="6580448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6580453">ProtoMajor</span><span class="op" id="6580463">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6580468">1</span><span class="op" id="6580469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6580474">ProtoMinor</span><span class="op" id="6580484">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6580489">1</span><span class="op" id="6580490">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6580495">ContentLength</span><span class="op" id="6580508">:</span>&nbsp;<span class="num" id="6580510">0</span><span class="op" id="6580511">,</span>&nbsp;<span class="comment" id="6580513">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6580538">}</span><span class="op" id="6580539">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6580544">Body</span><span class="op" id="6580548">:</span>&nbsp;<span class="keyword" id="6580550">func</span><span class="op" id="6580554">(</span><span class="op" id="6580555">)</span>&nbsp;<span class="ident" id="6580557">io</span><span class="op" id="6580559">.</span><span class="ident" id="6580560">ReadCloser</span>&nbsp;<span class="op" id="6580571">{</span>&nbsp;<span class="keyword" id="6580573">return</span>&nbsp;<span class="ident" id="6580580">ioutil</span><span class="op" id="6580586">.</span><span class="ident" id="6580587">NopCloser</span><span class="op" id="6580596">(</span><span class="ident" id="6580597">io</span><span class="op" id="6580599">.</span><span class="ident" id="6580600">LimitReader</span><span class="op" id="6580611">(</span><span class="ident" id="6580612">strings</span><span class="op" id="6580619">.</span><span class="ident" id="6580620">NewReader</span><span class="op" id="6580629">(</span><span class="string" id="6580630">&#34;xx&#34;</span><span class="op" id="6580634">)</span><span class="op" id="6580635">,</span>&nbsp;<span class="num" id="6580637">0</span><span class="op" id="6580638">)</span><span class="op" id="6580639">)</span>&nbsp;<span class="op" id="6580641">}</span><span class="op" id="6580642">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6580647">//&nbsp;RFC&nbsp;2616&nbsp;Section&nbsp;14.13&nbsp;says&nbsp;Content-Length&nbsp;should&nbsp;be&nbsp;specified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6580715">//&nbsp;unless&nbsp;body&nbsp;is&nbsp;prohibited&nbsp;by&nbsp;the&nbsp;request&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6580769">//&nbsp;Also,&nbsp;nginx&nbsp;expects&nbsp;it&nbsp;for&nbsp;POST&nbsp;and&nbsp;PUT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6580815">WantWrite</span><span class="op" id="6580824">:</span>&nbsp;<span class="string" id="6580826">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6580848">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6580853">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="6580877">+</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6580882">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6580920">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6580925">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="6580949">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6580954">&#34;\r\n&#34;</span><span class="op" id="6580960">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6580965">WantProxy</span><span class="op" id="6580974">:</span>&nbsp;<span class="string" id="6580976">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6580998">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6581003">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="6581027">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6581032">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6581070">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6581075">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="6581099">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6581104">&#34;\r\n&#34;</span><span class="op" id="6581110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6581113">}</span><span class="op" id="6581114">,</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6581118">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;1&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6581172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6581176">Req</span><span class="op" id="6581179">:</span>&nbsp;<span class="ident" id="6581181">Request</span><span class="op" id="6581188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6581193">Method</span><span class="op" id="6581199">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6581208">&#34;POST&#34;</span><span class="op" id="6581214">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6581219">URL</span><span class="op" id="6581222">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6581234">mustParseURL</span><span class="op" id="6581246">(</span><span class="string" id="6581247">&#34;/&#34;</span><span class="op" id="6581250">)</span><span class="op" id="6581251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6581256">Host</span><span class="op" id="6581260">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6581271">&#34;example.com&#34;</span><span class="op" id="6581284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6581289">ProtoMajor</span><span class="op" id="6581299">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6581304">1</span><span class="op" id="6581305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6581310">ProtoMinor</span><span class="op" id="6581320">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6581325">1</span><span class="op" id="6581326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6581331">ContentLength</span><span class="op" id="6581344">:</span>&nbsp;<span class="num" id="6581346">0</span><span class="op" id="6581347">,</span>&nbsp;<span class="comment" id="6581349">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6581374">}</span><span class="op" id="6581375">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6581380">Body</span><span class="op" id="6581384">:</span>&nbsp;<span class="keyword" id="6581386">func</span><span class="op" id="6581390">(</span><span class="op" id="6581391">)</span>&nbsp;<span class="ident" id="6581393">io</span><span class="op" id="6581395">.</span><span class="ident" id="6581396">ReadCloser</span>&nbsp;<span class="op" id="6581407">{</span>&nbsp;<span class="keyword" id="6581409">return</span>&nbsp;<span class="ident" id="6581416">ioutil</span><span class="op" id="6581422">.</span><span class="ident" id="6581423">NopCloser</span><span class="op" id="6581432">(</span><span class="ident" id="6581433">io</span><span class="op" id="6581435">.</span><span class="ident" id="6581436">LimitReader</span><span class="op" id="6581447">(</span><span class="ident" id="6581448">strings</span><span class="op" id="6581455">.</span><span class="ident" id="6581456">NewReader</span><span class="op" id="6581465">(</span><span class="string" id="6581466">&#34;xx&#34;</span><span class="op" id="6581470">)</span><span class="op" id="6581471">,</span>&nbsp;<span class="num" id="6581473">1</span><span class="op" id="6581474">)</span><span class="op" id="6581475">)</span>&nbsp;<span class="op" id="6581477">}</span><span class="op" id="6581478">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6581483">WantWrite</span><span class="op" id="6581492">:</span>&nbsp;<span class="string" id="6581494">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6581516">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6581521">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="6581545">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6581550">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6581588">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6581593">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="6581630">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6581635">chunk</span><span class="op" id="6581640">(</span><span class="string" id="6581641">&#34;x&#34;</span><span class="op" id="6581644">)</span>&nbsp;<span class="op" id="6581646">+</span>&nbsp;<span class="ident" id="6581648">chunk</span><span class="op" id="6581653">(</span><span class="string" id="6581654">&#34;&#34;</span><span class="op" id="6581656">)</span><span class="op" id="6581657">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6581662">WantProxy</span><span class="op" id="6581671">:</span>&nbsp;<span class="string" id="6581673">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6581695">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6581700">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="6581724">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6581729">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6581767">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6581772">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="6581809">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6581814">chunk</span><span class="op" id="6581819">(</span><span class="string" id="6581820">&#34;x&#34;</span><span class="op" id="6581823">)</span>&nbsp;<span class="op" id="6581825">+</span>&nbsp;<span class="ident" id="6581827">chunk</span><span class="op" id="6581832">(</span><span class="string" id="6581833">&#34;&#34;</span><span class="op" id="6581835">)</span><span class="op" id="6581836">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6581839">}</span><span class="op" id="6581840">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6581844">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;10&nbsp;but&nbsp;a&nbsp;5&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6581902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6581906">Req</span><span class="op" id="6581909">:</span>&nbsp;<span class="ident" id="6581911">Request</span><span class="op" id="6581918">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6581923">Method</span><span class="op" id="6581929">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6581938">&#34;POST&#34;</span><span class="op" id="6581944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6581949">URL</span><span class="op" id="6581952">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6581964">mustParseURL</span><span class="op" id="6581976">(</span><span class="string" id="6581977">&#34;/&#34;</span><span class="op" id="6581980">)</span><span class="op" id="6581981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6581986">Host</span><span class="op" id="6581990">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6582001">&#34;example.com&#34;</span><span class="op" id="6582014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582019">ProtoMajor</span><span class="op" id="6582029">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6582034">1</span><span class="op" id="6582035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582040">ProtoMinor</span><span class="op" id="6582050">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6582055">1</span><span class="op" id="6582056">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582061">ContentLength</span><span class="op" id="6582074">:</span>&nbsp;<span class="num" id="6582076">10</span><span class="op" id="6582078">,</span>&nbsp;<span class="comment" id="6582080">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;send&nbsp;only&nbsp;5&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6582122">}</span><span class="op" id="6582123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582127">Body</span><span class="op" id="6582131">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6582138">[</span><span class="op" id="6582139">]</span><span class="builtintype" id="6582140">byte</span><span class="op" id="6582144">(</span><span class="string" id="6582145">&#34;12345&#34;</span><span class="op" id="6582152">)</span><span class="op" id="6582153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582157">WantError</span><span class="op" id="6582166">:</span>&nbsp;<span class="ident" id="6582168">errors</span><span class="op" id="6582174">.</span><span class="ident" id="6582175">New</span><span class="op" id="6582178">(</span><span class="string" id="6582179">&#34;http:&nbsp;ContentLength=10&nbsp;with&nbsp;Body&nbsp;length&nbsp;5&#34;</span><span class="op" id="6582222">)</span><span class="op" id="6582223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6582226">}</span><span class="op" id="6582227">,</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6582231">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;4&nbsp;but&nbsp;an&nbsp;8&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6582289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582293">Req</span><span class="op" id="6582296">:</span>&nbsp;<span class="ident" id="6582298">Request</span><span class="op" id="6582305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582310">Method</span><span class="op" id="6582316">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6582325">&#34;POST&#34;</span><span class="op" id="6582331">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582336">URL</span><span class="op" id="6582339">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6582351">mustParseURL</span><span class="op" id="6582363">(</span><span class="string" id="6582364">&#34;/&#34;</span><span class="op" id="6582367">)</span><span class="op" id="6582368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582373">Host</span><span class="op" id="6582377">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6582388">&#34;example.com&#34;</span><span class="op" id="6582401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582406">ProtoMajor</span><span class="op" id="6582416">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6582421">1</span><span class="op" id="6582422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582427">ProtoMinor</span><span class="op" id="6582437">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6582442">1</span><span class="op" id="6582443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582448">ContentLength</span><span class="op" id="6582461">:</span>&nbsp;<span class="num" id="6582463">4</span><span class="op" id="6582464">,</span>&nbsp;<span class="comment" id="6582466">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;try&nbsp;to&nbsp;send&nbsp;8&nbsp;bytes</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6582510">}</span><span class="op" id="6582511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582515">Body</span><span class="op" id="6582519">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6582526">[</span><span class="op" id="6582527">]</span><span class="builtintype" id="6582528">byte</span><span class="op" id="6582532">(</span><span class="string" id="6582533">&#34;12345678&#34;</span><span class="op" id="6582543">)</span><span class="op" id="6582544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582548">WantError</span><span class="op" id="6582557">:</span>&nbsp;<span class="ident" id="6582559">errors</span><span class="op" id="6582565">.</span><span class="ident" id="6582566">New</span><span class="op" id="6582569">(</span><span class="string" id="6582570">&#34;http:&nbsp;ContentLength=4&nbsp;with&nbsp;Body&nbsp;length&nbsp;8&#34;</span><span class="op" id="6582612">)</span><span class="op" id="6582613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6582616">}</span><span class="op" id="6582617">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6582621">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;5&nbsp;ContentLength&nbsp;and&nbsp;nil&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6582670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582674">Req</span><span class="op" id="6582677">:</span>&nbsp;<span class="ident" id="6582679">Request</span><span class="op" id="6582686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582691">Method</span><span class="op" id="6582697">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6582706">&#34;POST&#34;</span><span class="op" id="6582712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582717">URL</span><span class="op" id="6582720">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6582732">mustParseURL</span><span class="op" id="6582744">(</span><span class="string" id="6582745">&#34;/&#34;</span><span class="op" id="6582748">)</span><span class="op" id="6582749">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582754">Host</span><span class="op" id="6582758">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6582769">&#34;example.com&#34;</span><span class="op" id="6582782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582787">ProtoMajor</span><span class="op" id="6582797">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6582802">1</span><span class="op" id="6582803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582808">ProtoMinor</span><span class="op" id="6582818">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6582823">1</span><span class="op" id="6582824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582829">ContentLength</span><span class="op" id="6582842">:</span>&nbsp;<span class="num" id="6582844">5</span><span class="op" id="6582845">,</span>&nbsp;<span class="comment" id="6582847">//&nbsp;but&nbsp;we&#39;ll&nbsp;omit&nbsp;the&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6582876">}</span><span class="op" id="6582877">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6582881">WantError</span><span class="op" id="6582890">:</span>&nbsp;<span class="ident" id="6582892">errors</span><span class="op" id="6582898">.</span><span class="ident" id="6582899">New</span><span class="op" id="6582902">(</span><span class="string" id="6582903">&#34;http:&nbsp;Request.ContentLength=5&nbsp;with&nbsp;nil&nbsp;Body&#34;</span><span class="op" id="6582948">)</span><span class="op" id="6582949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6582952">}</span><span class="op" id="6582953">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6582957">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;with&nbsp;1&nbsp;byte&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6583037">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583041">Req</span><span class="op" id="6583044">:</span>&nbsp;<span class="ident" id="6583046">Request</span><span class="op" id="6583053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583058">Method</span><span class="op" id="6583064">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6583073">&#34;POST&#34;</span><span class="op" id="6583079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583084">URL</span><span class="op" id="6583087">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583099">mustParseURL</span><span class="op" id="6583111">(</span><span class="string" id="6583112">&#34;/&#34;</span><span class="op" id="6583115">)</span><span class="op" id="6583116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583121">Host</span><span class="op" id="6583125">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6583136">&#34;example.com&#34;</span><span class="op" id="6583149">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583154">ProtoMajor</span><span class="op" id="6583164">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6583169">1</span><span class="op" id="6583170">,</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583175">ProtoMinor</span><span class="op" id="6583185">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6583190">1</span><span class="op" id="6583191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583196">ContentLength</span><span class="op" id="6583209">:</span>&nbsp;<span class="num" id="6583211">0</span><span class="op" id="6583212">,</span>&nbsp;<span class="comment" id="6583214">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6583239">}</span><span class="op" id="6583240">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583245">Body</span><span class="op" id="6583249">:</span>&nbsp;<span class="keyword" id="6583251">func</span><span class="op" id="6583255">(</span><span class="op" id="6583256">)</span>&nbsp;<span class="ident" id="6583258">io</span><span class="op" id="6583260">.</span><span class="ident" id="6583261">ReadCloser</span>&nbsp;<span class="op" id="6583272">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583277">err</span>&nbsp;<span class="op" id="6583281">:=</span>&nbsp;<span class="ident" id="6583284">errors</span><span class="op" id="6583290">.</span><span class="ident" id="6583291">New</span><span class="op" id="6583294">(</span><span class="string" id="6583295">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="6583316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583321">errReader</span>&nbsp;<span class="op" id="6583331">:=</span>&nbsp;<span class="op" id="6583334">&amp;</span><span class="ident" id="6583335">errorReader</span><span class="op" id="6583346">{</span><span class="ident" id="6583347">err</span><span class="op" id="6583350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6583355">return</span>&nbsp;<span class="ident" id="6583362">ioutil</span><span class="op" id="6583368">.</span><span class="ident" id="6583369">NopCloser</span><span class="op" id="6583378">(</span><span class="ident" id="6583379">io</span><span class="op" id="6583381">.</span><span class="ident" id="6583382">MultiReader</span><span class="op" id="6583393">(</span><span class="ident" id="6583394">strings</span><span class="op" id="6583401">.</span><span class="ident" id="6583402">NewReader</span><span class="op" id="6583411">(</span><span class="string" id="6583412">&#34;x&#34;</span><span class="op" id="6583415">)</span><span class="op" id="6583416">,</span>&nbsp;<span class="ident" id="6583418">errReader</span><span class="op" id="6583427">)</span><span class="op" id="6583428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6583432">}</span><span class="op" id="6583433">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583438">WantError</span><span class="op" id="6583447">:</span>&nbsp;<span class="ident" id="6583449">errors</span><span class="op" id="6583455">.</span><span class="ident" id="6583456">New</span><span class="op" id="6583459">(</span><span class="string" id="6583460">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="6583481">)</span><span class="op" id="6583482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6583485">}</span><span class="op" id="6583486">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6583490">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;without&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6583566">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583570">Req</span><span class="op" id="6583573">:</span>&nbsp;<span class="ident" id="6583575">Request</span><span class="op" id="6583582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583587">Method</span><span class="op" id="6583593">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6583602">&#34;POST&#34;</span><span class="op" id="6583608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583613">URL</span><span class="op" id="6583616">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583628">mustParseURL</span><span class="op" id="6583640">(</span><span class="string" id="6583641">&#34;/&#34;</span><span class="op" id="6583644">)</span><span class="op" id="6583645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583650">Host</span><span class="op" id="6583654">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6583665">&#34;example.com&#34;</span><span class="op" id="6583678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583683">ProtoMajor</span><span class="op" id="6583693">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6583698">1</span><span class="op" id="6583699">,</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583704">ProtoMinor</span><span class="op" id="6583714">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6583719">1</span><span class="op" id="6583720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583725">ContentLength</span><span class="op" id="6583738">:</span>&nbsp;<span class="num" id="6583740">0</span><span class="op" id="6583741">,</span>&nbsp;<span class="comment" id="6583743">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6583768">}</span><span class="op" id="6583769">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583774">Body</span><span class="op" id="6583778">:</span>&nbsp;<span class="keyword" id="6583780">func</span><span class="op" id="6583784">(</span><span class="op" id="6583785">)</span>&nbsp;<span class="ident" id="6583787">io</span><span class="op" id="6583789">.</span><span class="ident" id="6583790">ReadCloser</span>&nbsp;<span class="op" id="6583801">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583806">err</span>&nbsp;<span class="op" id="6583810">:=</span>&nbsp;<span class="ident" id="6583813">errors</span><span class="op" id="6583819">.</span><span class="ident" id="6583820">New</span><span class="op" id="6583823">(</span><span class="string" id="6583824">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="6583845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583850">errReader</span>&nbsp;<span class="op" id="6583860">:=</span>&nbsp;<span class="op" id="6583863">&amp;</span><span class="ident" id="6583864">errorReader</span><span class="op" id="6583875">{</span><span class="ident" id="6583876">err</span><span class="op" id="6583879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6583884">return</span>&nbsp;<span class="ident" id="6583891">ioutil</span><span class="op" id="6583897">.</span><span class="ident" id="6583898">NopCloser</span><span class="op" id="6583907">(</span><span class="ident" id="6583908">errReader</span><span class="op" id="6583917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6583921">}</span><span class="op" id="6583922">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6583927">WantError</span><span class="op" id="6583936">:</span>&nbsp;<span class="ident" id="6583938">errors</span><span class="op" id="6583944">.</span><span class="ident" id="6583945">New</span><span class="op" id="6583948">(</span><span class="string" id="6583949">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="6583970">)</span><span class="op" id="6583971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6583974">}</span><span class="op" id="6583975">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6583979">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6584062">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6584096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584100">Req</span><span class="op" id="6584103">:</span>&nbsp;<span class="ident" id="6584105">Request</span><span class="op" id="6584112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584117">Method</span><span class="op" id="6584123">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6584129">&#34;GET&#34;</span><span class="op" id="6584134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584139">URL</span><span class="op" id="6584142">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6584151">mustParseURL</span><span class="op" id="6584163">(</span><span class="string" id="6584164">&#34;/foo&#34;</span><span class="op" id="6584170">)</span><span class="op" id="6584171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584176">ProtoMajor</span><span class="op" id="6584186">:</span>&nbsp;<span class="num" id="6584188">1</span><span class="op" id="6584189">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584194">ProtoMinor</span><span class="op" id="6584204">:</span>&nbsp;<span class="num" id="6584206">0</span><span class="op" id="6584207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584212">Header</span><span class="op" id="6584218">:</span>&nbsp;<span class="ident" id="6584220">Header</span><span class="op" id="6584226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6584232">&#34;X-Foo&#34;</span><span class="op" id="6584239">:</span>&nbsp;<span class="op" id="6584241">[</span><span class="op" id="6584242">]</span><span class="builtintype" id="6584243">string</span><span class="op" id="6584249">{</span><span class="string" id="6584250">&#34;X-Bar&#34;</span><span class="op" id="6584257">}</span><span class="op" id="6584258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6584263">}</span><span class="op" id="6584264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6584268">}</span><span class="op" id="6584269">,</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584274">WantWrite</span><span class="op" id="6584283">:</span>&nbsp;<span class="string" id="6584285">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6584309">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6584314">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="6584327">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6584332">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6584370">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6584375">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="6584397">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6584400">}</span><span class="op" id="6584401">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6584405">//&nbsp;If&nbsp;no&nbsp;Request.Host&nbsp;and&nbsp;no&nbsp;Request.URL.Host,&nbsp;we&nbsp;send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6584461">//&nbsp;an&nbsp;empty&nbsp;Host&nbsp;header,&nbsp;and&nbsp;don&#39;t&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6584501">//&nbsp;Request.Header[&#34;Host&#34;].&nbsp;This&nbsp;is&nbsp;just&nbsp;testing&nbsp;that</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6584555">//&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;Go&nbsp;1.0&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6584592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584596">Req</span><span class="op" id="6584599">:</span>&nbsp;<span class="ident" id="6584601">Request</span><span class="op" id="6584608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584613">Method</span><span class="op" id="6584619">:</span>&nbsp;<span class="string" id="6584621">&#34;GET&#34;</span><span class="op" id="6584626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584631">Host</span><span class="op" id="6584635">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6584639">&#34;&#34;</span><span class="op" id="6584641">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584646">URL</span><span class="op" id="6584649">:</span>&nbsp;<span class="op" id="6584651">&amp;</span><span class="ident" id="6584652">url</span><span class="op" id="6584655">.</span><span class="ident" id="6584656">URL</span><span class="op" id="6584659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584665">Scheme</span><span class="op" id="6584671">:</span>&nbsp;<span class="string" id="6584673">&#34;http&#34;</span><span class="op" id="6584679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584685">Host</span><span class="op" id="6584689">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6584693">&#34;&#34;</span><span class="op" id="6584695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584701">Path</span><span class="op" id="6584705">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6584709">&#34;/search&#34;</span><span class="op" id="6584718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6584723">}</span><span class="op" id="6584724">,</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584729">ProtoMajor</span><span class="op" id="6584739">:</span>&nbsp;<span class="num" id="6584741">1</span><span class="op" id="6584742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584747">ProtoMinor</span><span class="op" id="6584757">:</span>&nbsp;<span class="num" id="6584759">1</span><span class="op" id="6584760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584765">Header</span><span class="op" id="6584771">:</span>&nbsp;<span class="ident" id="6584773">Header</span><span class="op" id="6584779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6584785">&#34;Host&#34;</span><span class="op" id="6584791">:</span>&nbsp;<span class="op" id="6584793">[</span><span class="op" id="6584794">]</span><span class="builtintype" id="6584795">string</span><span class="op" id="6584801">{</span><span class="string" id="6584802">&#34;bad.example.com&#34;</span><span class="op" id="6584819">}</span><span class="op" id="6584820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6584825">}</span><span class="op" id="6584826">,</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6584830">}</span><span class="op" id="6584831">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584836">WantWrite</span><span class="op" id="6584845">:</span>&nbsp;<span class="string" id="6584847">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6584874">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6584879">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="6584892">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6584897">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="6584938">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6584941">}</span><span class="op" id="6584942">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6584946">//&nbsp;Opaque&nbsp;test&nbsp;#1&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6584992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6584996">Req</span><span class="op" id="6584999">:</span>&nbsp;<span class="ident" id="6585001">Request</span><span class="op" id="6585008">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585013">Method</span><span class="op" id="6585019">:</span>&nbsp;<span class="string" id="6585021">&#34;GET&#34;</span><span class="op" id="6585026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585031">URL</span><span class="op" id="6585034">:</span>&nbsp;<span class="op" id="6585036">&amp;</span><span class="ident" id="6585037">url</span><span class="op" id="6585040">.</span><span class="ident" id="6585041">URL</span><span class="op" id="6585044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585050">Scheme</span><span class="op" id="6585056">:</span>&nbsp;<span class="string" id="6585058">&#34;http&#34;</span><span class="op" id="6585064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585070">Host</span><span class="op" id="6585074">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6585078">&#34;www.google.com&#34;</span><span class="op" id="6585094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585100">Opaque</span><span class="op" id="6585106">:</span>&nbsp;<span class="string" id="6585108">&#34;/%2F/%2F/&#34;</span><span class="op" id="6585119">,</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6585124">}</span><span class="op" id="6585125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585130">ProtoMajor</span><span class="op" id="6585140">:</span>&nbsp;<span class="num" id="6585142">1</span><span class="op" id="6585143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585148">ProtoMinor</span><span class="op" id="6585158">:</span>&nbsp;<span class="num" id="6585160">1</span><span class="op" id="6585161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585166">Header</span><span class="op" id="6585172">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6585178">Header</span><span class="op" id="6585184">{</span><span class="op" id="6585185">}</span><span class="op" id="6585186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6585190">}</span><span class="op" id="6585191">,</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585196">WantWrite</span><span class="op" id="6585205">:</span>&nbsp;<span class="string" id="6585207">&#34;GET&nbsp;/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6585236">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6585241">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="6585268">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6585273">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="6585314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6585317">}</span><span class="op" id="6585318">,</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6585322">//&nbsp;Opaque&nbsp;test&nbsp;#2&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6585368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585372">Req</span><span class="op" id="6585375">:</span>&nbsp;<span class="ident" id="6585377">Request</span><span class="op" id="6585384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585389">Method</span><span class="op" id="6585395">:</span>&nbsp;<span class="string" id="6585397">&#34;GET&#34;</span><span class="op" id="6585402">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585407">URL</span><span class="op" id="6585410">:</span>&nbsp;<span class="op" id="6585412">&amp;</span><span class="ident" id="6585413">url</span><span class="op" id="6585416">.</span><span class="ident" id="6585417">URL</span><span class="op" id="6585420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585426">Scheme</span><span class="op" id="6585432">:</span>&nbsp;<span class="string" id="6585434">&#34;http&#34;</span><span class="op" id="6585440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585446">Host</span><span class="op" id="6585450">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6585454">&#34;x.google.com&#34;</span><span class="op" id="6585468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585474">Opaque</span><span class="op" id="6585480">:</span>&nbsp;<span class="string" id="6585482">&#34;//y.google.com/%2F/%2F/&#34;</span><span class="op" id="6585507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6585512">}</span><span class="op" id="6585513">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585518">ProtoMajor</span><span class="op" id="6585528">:</span>&nbsp;<span class="num" id="6585530">1</span><span class="op" id="6585531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585536">ProtoMinor</span><span class="op" id="6585546">:</span>&nbsp;<span class="num" id="6585548">1</span><span class="op" id="6585549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585554">Header</span><span class="op" id="6585560">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6585566">Header</span><span class="op" id="6585572">{</span><span class="op" id="6585573">}</span><span class="op" id="6585574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6585578">}</span><span class="op" id="6585579">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585584">WantWrite</span><span class="op" id="6585593">:</span>&nbsp;<span class="string" id="6585595">&#34;GET&nbsp;http://y.google.com/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6585643">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6585648">&#34;Host:&nbsp;x.google.com\r\n&#34;</span>&nbsp;<span class="op" id="6585673">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6585678">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="6585719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6585722">}</span><span class="op" id="6585723">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6585727">//&nbsp;Testing&nbsp;custom&nbsp;case&nbsp;in&nbsp;header&nbsp;keys.&nbsp;Issue&nbsp;5022.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6585779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585783">Req</span><span class="op" id="6585786">:</span>&nbsp;<span class="ident" id="6585788">Request</span><span class="op" id="6585795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585800">Method</span><span class="op" id="6585806">:</span>&nbsp;<span class="string" id="6585808">&#34;GET&#34;</span><span class="op" id="6585813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585818">URL</span><span class="op" id="6585821">:</span>&nbsp;<span class="op" id="6585823">&amp;</span><span class="ident" id="6585824">url</span><span class="op" id="6585827">.</span><span class="ident" id="6585828">URL</span><span class="op" id="6585831">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585837">Scheme</span><span class="op" id="6585843">:</span>&nbsp;<span class="string" id="6585845">&#34;http&#34;</span><span class="op" id="6585851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585857">Host</span><span class="op" id="6585861">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6585865">&#34;www.google.com&#34;</span><span class="op" id="6585881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585887">Path</span><span class="op" id="6585891">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6585895">&#34;/&#34;</span><span class="op" id="6585898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6585903">}</span><span class="op" id="6585904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585909">Proto</span><span class="op" id="6585914">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6585921">&#34;HTTP/1.1&#34;</span><span class="op" id="6585931">,</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585936">ProtoMajor</span><span class="op" id="6585946">:</span>&nbsp;<span class="num" id="6585948">1</span><span class="op" id="6585949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585954">ProtoMinor</span><span class="op" id="6585964">:</span>&nbsp;<span class="num" id="6585966">1</span><span class="op" id="6585967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585972">Header</span><span class="op" id="6585978">:</span>&nbsp;<span class="ident" id="6585980">Header</span><span class="op" id="6585986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6585992">&#34;ALL-CAPS&#34;</span><span class="op" id="6586002">:</span>&nbsp;<span class="op" id="6586004">{</span><span class="string" id="6586005">&#34;x&#34;</span><span class="op" id="6586008">}</span><span class="op" id="6586009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6586014">}</span><span class="op" id="6586015">,</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6586019">}</span><span class="op" id="6586020">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586025">WantWrite</span><span class="op" id="6586034">:</span>&nbsp;<span class="string" id="6586036">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6586057">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6586062">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="6586089">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6586094">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6586132">+</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6586137">&#34;ALL-CAPS:&nbsp;x\r\n&#34;</span>&nbsp;<span class="op" id="6586155">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6586160">&#34;\r\n&#34;</span><span class="op" id="6586166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6586169">}</span><span class="op" id="6586170">,</span><br>
<span class="lineno"></span><span class="op" id="6586172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="6586175">func</span>&nbsp;<span class="ident" id="6586180">TestRequestWrite</span><span class="op" id="6586196">(</span><span class="ident" id="6586197">t</span>&nbsp;<span class="op" id="6586199">*</span><span class="ident" id="6586200">testing</span><span class="op" id="6586207">.</span><span class="ident" id="6586208">T</span><span class="op" id="6586209">)</span>&nbsp;<span class="op" id="6586211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586214">for</span>&nbsp;<span class="ident" id="6586218">i</span>&nbsp;<span class="op" id="6586220">:=</span>&nbsp;<span class="keyword" id="6586223">range</span>&nbsp;<span class="ident" id="6586229">reqWriteTests</span>&nbsp;<span class="op" id="6586243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586247">tt</span>&nbsp;<span class="op" id="6586250">:=</span>&nbsp;<span class="op" id="6586253">&amp;</span><span class="ident" id="6586254">reqWriteTests</span><span class="op" id="6586267">[</span><span class="ident" id="6586268">i</span><span class="op" id="6586269">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586274">setBody</span>&nbsp;<span class="op" id="6586282">:=</span>&nbsp;<span class="keyword" id="6586285">func</span><span class="op" id="6586289">(</span><span class="op" id="6586290">)</span>&nbsp;<span class="op" id="6586292">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586297">if</span>&nbsp;<span class="ident" id="6586300">tt</span><span class="op" id="6586302">.</span><span class="ident" id="6586303">Body</span>&nbsp;<span class="op" id="6586308">==</span>&nbsp;<span class="ident" id="6586311">nil</span>&nbsp;<span class="op" id="6586315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586321">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6586331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586336">switch</span>&nbsp;<span class="ident" id="6586343">b</span>&nbsp;<span class="op" id="6586345">:=</span>&nbsp;<span class="ident" id="6586348">tt</span><span class="op" id="6586350">.</span><span class="ident" id="6586351">Body</span><span class="op" id="6586355">.</span><span class="op" id="6586356">(</span><span class="keyword" id="6586357">type</span><span class="op" id="6586361">)</span>&nbsp;<span class="op" id="6586363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586368">case</span>&nbsp;<span class="op" id="6586373">[</span><span class="op" id="6586374">]</span><span class="builtintype" id="6586375">byte</span><span class="op" id="6586379">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586385">tt</span><span class="op" id="6586387">.</span><span class="ident" id="6586388">Req</span><span class="op" id="6586391">.</span><span class="ident" id="6586392">Body</span>&nbsp;<span class="op" id="6586397">=</span>&nbsp;<span class="ident" id="6586399">ioutil</span><span class="op" id="6586405">.</span><span class="ident" id="6586406">NopCloser</span><span class="op" id="6586415">(</span><span class="ident" id="6586416">bytes</span><span class="op" id="6586421">.</span><span class="ident" id="6586422">NewReader</span><span class="op" id="6586431">(</span><span class="ident" id="6586432">b</span><span class="op" id="6586433">)</span><span class="op" id="6586434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586439">case</span>&nbsp;<span class="keyword" id="6586444">func</span><span class="op" id="6586448">(</span><span class="op" id="6586449">)</span>&nbsp;<span class="ident" id="6586451">io</span><span class="op" id="6586453">.</span><span class="ident" id="6586454">ReadCloser</span><span class="op" id="6586464">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586470">tt</span><span class="op" id="6586472">.</span><span class="ident" id="6586473">Req</span><span class="op" id="6586476">.</span><span class="ident" id="6586477">Body</span>&nbsp;<span class="op" id="6586482">=</span>&nbsp;<span class="ident" id="6586484">b</span><span class="op" id="6586485">(</span><span class="op" id="6586486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6586491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6586495">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586499">setBody</span><span class="op" id="6586506">(</span><span class="op" id="6586507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586511">if</span>&nbsp;<span class="ident" id="6586514">tt</span><span class="op" id="6586516">.</span><span class="ident" id="6586517">Req</span><span class="op" id="6586520">.</span><span class="ident" id="6586521">Header</span>&nbsp;<span class="op" id="6586528">==</span>&nbsp;<span class="ident" id="6586531">nil</span>&nbsp;<span class="op" id="6586535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586540">tt</span><span class="op" id="6586542">.</span><span class="ident" id="6586543">Req</span><span class="op" id="6586546">.</span><span class="ident" id="6586547">Header</span>&nbsp;<span class="op" id="6586554">=</span>&nbsp;<span class="builtinfunc" id="6586556">make</span><span class="op" id="6586560">(</span><span class="ident" id="6586561">Header</span><span class="op" id="6586567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6586571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586576">var</span>&nbsp;<span class="ident" id="6586580">braw</span>&nbsp;<span class="ident" id="6586585">bytes</span><span class="op" id="6586590">.</span><span class="ident" id="6586591">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586600">err</span>&nbsp;<span class="op" id="6586604">:=</span>&nbsp;<span class="ident" id="6586607">tt</span><span class="op" id="6586609">.</span><span class="ident" id="6586610">Req</span><span class="op" id="6586613">.</span><span class="ident" id="6586614">Write</span><span class="op" id="6586619">(</span><span class="op" id="6586620">&amp;</span><span class="ident" id="6586621">braw</span><span class="op" id="6586625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586629">if</span>&nbsp;<span class="ident" id="6586632">g</span><span class="op" id="6586633">,</span>&nbsp;<span class="ident" id="6586635">e</span>&nbsp;<span class="op" id="6586637">:=</span>&nbsp;<span class="ident" id="6586640">fmt</span><span class="op" id="6586643">.</span><span class="ident" id="6586644">Sprintf</span><span class="op" id="6586651">(</span><span class="string" id="6586652">&#34;%v&#34;</span><span class="op" id="6586656">,</span>&nbsp;<span class="ident" id="6586658">err</span><span class="op" id="6586661">)</span><span class="op" id="6586662">,</span>&nbsp;<span class="ident" id="6586664">fmt</span><span class="op" id="6586667">.</span><span class="ident" id="6586668">Sprintf</span><span class="op" id="6586675">(</span><span class="string" id="6586676">&#34;%v&#34;</span><span class="op" id="6586680">,</span>&nbsp;<span class="ident" id="6586682">tt</span><span class="op" id="6586684">.</span><span class="ident" id="6586685">WantError</span><span class="op" id="6586694">)</span><span class="op" id="6586695">;</span>&nbsp;<span class="ident" id="6586697">g</span>&nbsp;<span class="op" id="6586699">!=</span>&nbsp;<span class="ident" id="6586702">e</span>&nbsp;<span class="op" id="6586704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586709">t</span><span class="op" id="6586710">.</span><span class="ident" id="6586711">Errorf</span><span class="op" id="6586717">(</span><span class="string" id="6586718">&#34;writing&nbsp;#%d,&nbsp;err&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6586750">,</span>&nbsp;<span class="ident" id="6586752">i</span><span class="op" id="6586753">,</span>&nbsp;<span class="ident" id="6586755">g</span><span class="op" id="6586756">,</span>&nbsp;<span class="ident" id="6586758">e</span><span class="op" id="6586759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586764">continue</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6586775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586779">if</span>&nbsp;<span class="ident" id="6586782">err</span>&nbsp;<span class="op" id="6586786">!=</span>&nbsp;<span class="ident" id="6586789">nil</span>&nbsp;<span class="op" id="6586793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586798">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6586809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586814">if</span>&nbsp;<span class="ident" id="6586817">tt</span><span class="op" id="6586819">.</span><span class="ident" id="6586820">WantWrite</span>&nbsp;<span class="op" id="6586830">!=</span>&nbsp;<span class="string" id="6586833">&#34;&#34;</span>&nbsp;<span class="op" id="6586836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586841">sraw</span>&nbsp;<span class="op" id="6586846">:=</span>&nbsp;<span class="ident" id="6586849">braw</span><span class="op" id="6586853">.</span><span class="ident" id="6586854">String</span><span class="op" id="6586860">(</span><span class="op" id="6586861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586866">if</span>&nbsp;<span class="ident" id="6586869">sraw</span>&nbsp;<span class="op" id="6586874">!=</span>&nbsp;<span class="ident" id="6586877">tt</span><span class="op" id="6586879">.</span><span class="ident" id="6586880">WantWrite</span>&nbsp;<span class="op" id="6586890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586896">t</span><span class="op" id="6586897">.</span><span class="ident" id="6586898">Errorf</span><span class="op" id="6586904">(</span><span class="string" id="6586905">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="6586942">,</span>&nbsp;<span class="ident" id="6586944">i</span><span class="op" id="6586945">,</span>&nbsp;<span class="ident" id="6586947">tt</span><span class="op" id="6586949">.</span><span class="ident" id="6586950">WantWrite</span><span class="op" id="6586959">,</span>&nbsp;<span class="ident" id="6586961">sraw</span><span class="op" id="6586965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586971">continue</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6586983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6586987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586992">if</span>&nbsp;<span class="ident" id="6586995">tt</span><span class="op" id="6586997">.</span><span class="ident" id="6586998">WantProxy</span>&nbsp;<span class="op" id="6587008">!=</span>&nbsp;<span class="string" id="6587011">&#34;&#34;</span>&nbsp;<span class="op" id="6587014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6587019">setBody</span><span class="op" id="6587026">(</span><span class="op" id="6587027">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6587032">var</span>&nbsp;<span class="ident" id="6587036">praw</span>&nbsp;<span class="ident" id="6587041">bytes</span><span class="op" id="6587046">.</span><span class="ident" id="6587047">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6587057">err</span>&nbsp;<span class="op" id="6587061">=</span>&nbsp;<span class="ident" id="6587063">tt</span><span class="op" id="6587065">.</span><span class="ident" id="6587066">Req</span><span class="op" id="6587069">.</span><span class="ident" id="6587070">WriteProxy</span><span class="op" id="6587080">(</span><span class="op" id="6587081">&amp;</span><span class="ident" id="6587082">praw</span><span class="op" id="6587086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6587091">if</span>&nbsp;<span class="ident" id="6587094">err</span>&nbsp;<span class="op" id="6587098">!=</span>&nbsp;<span class="ident" id="6587101">nil</span>&nbsp;<span class="op" id="6587105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6587111">t</span><span class="op" id="6587112">.</span><span class="ident" id="6587113">Errorf</span><span class="op" id="6587119">(</span><span class="string" id="6587120">&#34;WriteProxy&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="6587140">,</span>&nbsp;<span class="ident" id="6587142">i</span><span class="op" id="6587143">,</span>&nbsp;<span class="ident" id="6587145">err</span><span class="op" id="6587148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6587154">continue</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6587166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6587171">sraw</span>&nbsp;<span class="op" id="6587176">:=</span>&nbsp;<span class="ident" id="6587179">praw</span><span class="op" id="6587183">.</span><span class="ident" id="6587184">String</span><span class="op" id="6587190">(</span><span class="op" id="6587191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6587196">if</span>&nbsp;<span class="ident" id="6587199">sraw</span>&nbsp;<span class="op" id="6587204">!=</span>&nbsp;<span class="ident" id="6587207">tt</span><span class="op" id="6587209">.</span><span class="ident" id="6587210">WantProxy</span>&nbsp;<span class="op" id="6587220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6587226">t</span><span class="op" id="6587227">.</span><span class="ident" id="6587228">Errorf</span><span class="op" id="6587234">(</span><span class="string" id="6587235">&#34;Test&nbsp;Proxy&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="6587278">,</span>&nbsp;<span class="ident" id="6587280">i</span><span class="op" id="6587281">,</span>&nbsp;<span class="ident" id="6587283">tt</span><span class="op" id="6587285">.</span><span class="ident" id="6587286">WantProxy</span><span class="op" id="6587295">,</span>&nbsp;<span class="ident" id="6587297">sraw</span><span class="op" id="6587301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6587307">continue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6587319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6587323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6587326">}</span><br>
<span class="lineno"></span><span class="op" id="6587328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="6587331">type</span>&nbsp;<span class="ident" id="6587336">closeChecker</span>&nbsp;<span class="keyword" id="6587349">struct</span>&nbsp;<span class="op" id="6587356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6587359">io</span><span class="op" id="6587361">.</span><span class="ident" id="6587362">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6587370">closed</span>&nbsp;<span class="builtintype" id="6587377">bool</span><br>
<span class="lineno"></span><span class="op" id="6587382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="keyword" id="6587385">func</span>&nbsp;<span class="op" id="6587390">(</span><span class="ident" id="6587391">rc</span>&nbsp;<span class="op" id="6587394">*</span><span class="ident" id="6587395">closeChecker</span><span class="op" id="6587407">)</span>&nbsp;<span class="ident" id="6587409">Close</span><span class="op" id="6587414">(</span><span class="op" id="6587415">)</span>&nbsp;<span class="builtintype" id="6587417">error</span>&nbsp;<span class="op" id="6587423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6587426">rc</span><span class="op" id="6587428">.</span><span class="ident" id="6587429">closed</span>&nbsp;<span class="op" id="6587436">=</span>&nbsp;<span class="builtintype" id="6587438">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6587444">return</span>&nbsp;<span class="ident" id="6587451">nil</span><br>
<span class="lineno"></span><span class="op" id="6587455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="6587458">//&nbsp;TestRequestWriteClosesBody&nbsp;tests&nbsp;that&nbsp;Request.Write&nbsp;does&nbsp;close&nbsp;its&nbsp;request.Body.</span><br>
<span class="lineno"></span><span class="comment" id="6587542">//&nbsp;It&nbsp;also&nbsp;indirectly&nbsp;tests&nbsp;NewRequest&nbsp;and&nbsp;that&nbsp;it&nbsp;doesn&#39;t&nbsp;wrap&nbsp;an&nbsp;existing&nbsp;Closer</span><br>
<span class="lineno"></span><span class="comment" id="6587625">//&nbsp;inside&nbsp;a&nbsp;NopCloser,&nbsp;and&nbsp;that&nbsp;it&nbsp;serializes&nbsp;it&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="keyword" id="6587685">func</span>&nbsp;<span class="ident" id="6587690">TestRequestWriteClosesBody</span><span class="op" id="6587716">(</span><span class="ident" id="6587717">t</span>&nbsp;<span class="op" id="6587719">*</span><span class="ident" id="6587720">testing</span><span class="op" id="6587727">.</span><span class="ident" id="6587728">T</span><span class="op" id="6587729">)</span>&nbsp;<span class="op" id="6587731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6587734">rc</span>&nbsp;<span class="op" id="6587737">:=</span>&nbsp;<span class="op" id="6587740">&amp;</span><span class="ident" id="6587741">closeChecker</span><span class="op" id="6587753">{</span><span class="ident" id="6587754">Reader</span><span class="op" id="6587760">:</span>&nbsp;<span class="ident" id="6587762">strings</span><span class="op" id="6587769">.</span><span class="ident" id="6587770">NewReader</span><span class="op" id="6587779">(</span><span class="string" id="6587780">&#34;my&nbsp;body&#34;</span><span class="op" id="6587789">)</span><span class="op" id="6587790">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6587793">req</span><span class="op" id="6587796">,</span>&nbsp;<span class="ident" id="6587798">_</span>&nbsp;<span class="op" id="6587800">:=</span>&nbsp;<span class="ident" id="6587803">NewRequest</span><span class="op" id="6587813">(</span><span class="string" id="6587814">&#34;POST&#34;</span><span class="op" id="6587820">,</span>&nbsp;<span class="string" id="6587822">&#34;http://foo.com/&#34;</span><span class="op" id="6587839">,</span>&nbsp;<span class="ident" id="6587841">rc</span><span class="op" id="6587843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6587846">if</span>&nbsp;<span class="ident" id="6587849">req</span><span class="op" id="6587852">.</span><span class="ident" id="6587853">ContentLength</span>&nbsp;<span class="op" id="6587867">!=</span>&nbsp;<span class="num" id="6587870">0</span>&nbsp;<span class="op" id="6587872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6587876">t</span><span class="op" id="6587877">.</span><span class="ident" id="6587878">Errorf</span><span class="op" id="6587884">(</span><span class="string" id="6587885">&#34;got&nbsp;req.ContentLength&nbsp;%d,&nbsp;want&nbsp;0&#34;</span><span class="op" id="6587919">,</span>&nbsp;<span class="ident" id="6587921">req</span><span class="op" id="6587924">.</span><span class="ident" id="6587925">ContentLength</span><span class="op" id="6587938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6587941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6587944">buf</span>&nbsp;<span class="op" id="6587948">:=</span>&nbsp;<span class="builtinfunc" id="6587951">new</span><span class="op" id="6587954">(</span><span class="ident" id="6587955">bytes</span><span class="op" id="6587960">.</span><span class="ident" id="6587961">Buffer</span><span class="op" id="6587967">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6587970">req</span><span class="op" id="6587973">.</span><span class="ident" id="6587974">Write</span><span class="op" id="6587979">(</span><span class="ident" id="6587980">buf</span><span class="op" id="6587983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6587986">if</span>&nbsp;<span class="op" id="6587989">!</span><span class="ident" id="6587990">rc</span><span class="op" id="6587992">.</span><span class="ident" id="6587993">closed</span>&nbsp;<span class="op" id="6588000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6588004">t</span><span class="op" id="6588005">.</span><span class="ident" id="6588006">Error</span><span class="op" id="6588011">(</span><span class="string" id="6588012">&#34;body&nbsp;not&nbsp;closed&nbsp;after&nbsp;write&#34;</span><span class="op" id="6588041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6588044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6588047">expected</span>&nbsp;<span class="op" id="6588056">:=</span>&nbsp;<span class="string" id="6588059">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="6588081">+</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6588085">&#34;Host:&nbsp;foo.com\r\n&#34;</span>&nbsp;<span class="op" id="6588105">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6588109">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="6588147">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6588151">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="6588188">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6588192">//&nbsp;TODO:&nbsp;currently&nbsp;we&nbsp;don&#39;t&nbsp;buffer&nbsp;before&nbsp;chunking,&nbsp;so&nbsp;we&nbsp;get&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6588258">//&nbsp;single&nbsp;&#34;m&#34;&nbsp;chunk&nbsp;before&nbsp;the&nbsp;other&nbsp;chunks,&nbsp;as&nbsp;this&nbsp;was&nbsp;the&nbsp;1-byte</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6588328">//&nbsp;read&nbsp;from&nbsp;our&nbsp;MultiReader&nbsp;where&nbsp;we&nbsp;stiched&nbsp;the&nbsp;Body&nbsp;back&nbsp;together</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6588399">//&nbsp;after&nbsp;sniffing&nbsp;whether&nbsp;the&nbsp;Body&nbsp;was&nbsp;0&nbsp;bytes&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6588456">chunk</span><span class="op" id="6588461">(</span><span class="string" id="6588462">&#34;m&#34;</span><span class="op" id="6588465">)</span>&nbsp;<span class="op" id="6588467">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6588471">chunk</span><span class="op" id="6588476">(</span><span class="string" id="6588477">&#34;y&nbsp;body&#34;</span><span class="op" id="6588485">)</span>&nbsp;<span class="op" id="6588487">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6588491">chunk</span><span class="op" id="6588496">(</span><span class="string" id="6588497">&#34;&#34;</span><span class="op" id="6588499">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6588502">if</span>&nbsp;<span class="ident" id="6588505">buf</span><span class="op" id="6588508">.</span><span class="ident" id="6588509">String</span><span class="op" id="6588515">(</span><span class="op" id="6588516">)</span>&nbsp;<span class="op" id="6588518">!=</span>&nbsp;<span class="ident" id="6588521">expected</span>&nbsp;<span class="op" id="6588530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6588534">t</span><span class="op" id="6588535">.</span><span class="ident" id="6588536">Errorf</span><span class="op" id="6588542">(</span><span class="string" id="6588543">&#34;write:\n&nbsp;got:&nbsp;%s\nwant:&nbsp;%s&#34;</span><span class="op" id="6588571">,</span>&nbsp;<span class="ident" id="6588573">buf</span><span class="op" id="6588576">.</span><span class="ident" id="6588577">String</span><span class="op" id="6588583">(</span><span class="op" id="6588584">)</span><span class="op" id="6588585">,</span>&nbsp;<span class="ident" id="6588587">expected</span><span class="op" id="6588595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6588598">}</span><br>
<span class="lineno"></span><span class="op" id="6588600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="keyword" id="6588603">func</span>&nbsp;<span class="ident" id="6588608">chunk</span><span class="op" id="6588613">(</span><span class="ident" id="6588614">s</span>&nbsp;<span class="builtintype" id="6588616">string</span><span class="op" id="6588622">)</span>&nbsp;<span class="builtintype" id="6588624">string</span>&nbsp;<span class="op" id="6588631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6588634">return</span>&nbsp;<span class="ident" id="6588641">fmt</span><span class="op" id="6588644">.</span><span class="ident" id="6588645">Sprintf</span><span class="op" id="6588652">(</span><span class="string" id="6588653">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="6588667">,</span>&nbsp;<span class="builtinfunc" id="6588669">len</span><span class="op" id="6588672">(</span><span class="ident" id="6588673">s</span><span class="op" id="6588674">)</span><span class="op" id="6588675">,</span>&nbsp;<span class="ident" id="6588677">s</span><span class="op" id="6588678">)</span><br>
<span class="lineno"></span><span class="op" id="6588680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6588683">func</span>&nbsp;<span class="ident" id="6588688">mustParseURL</span><span class="op" id="6588700">(</span><span class="ident" id="6588701">s</span>&nbsp;<span class="builtintype" id="6588703">string</span><span class="op" id="6588709">)</span>&nbsp;<span class="op" id="6588711">*</span><span class="ident" id="6588712">url</span><span class="op" id="6588715">.</span><span class="ident" id="6588716">URL</span>&nbsp;<span class="op" id="6588720">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6588723">u</span><span class="op" id="6588724">,</span>&nbsp;<span class="ident" id="6588726">err</span>&nbsp;<span class="op" id="6588730">:=</span>&nbsp;<span class="ident" id="6588733">url</span><span class="op" id="6588736">.</span><span class="ident" id="6588737">Parse</span><span class="op" id="6588742">(</span><span class="ident" id="6588743">s</span><span class="op" id="6588744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6588747">if</span>&nbsp;<span class="ident" id="6588750">err</span>&nbsp;<span class="op" id="6588754">!=</span>&nbsp;<span class="ident" id="6588757">nil</span>&nbsp;<span class="op" id="6588761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6588765">panic</span><span class="op" id="6588770">(</span><span class="ident" id="6588771">fmt</span><span class="op" id="6588774">.</span><span class="ident" id="6588775">Sprintf</span><span class="op" id="6588782">(</span><span class="string" id="6588783">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="6588809">,</span>&nbsp;<span class="ident" id="6588811">s</span><span class="op" id="6588812">,</span>&nbsp;<span class="ident" id="6588814">err</span><span class="op" id="6588817">)</span><span class="op" id="6588818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6588821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6588824">return</span>&nbsp;<span class="ident" id="6588831">u</span><br>
<span class="lineno">565</span><span class="op" id="6588833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6588836">type</span>&nbsp;<span class="ident" id="6588841">writerFunc</span>&nbsp;<span class="keyword" id="6588852">func</span><span class="op" id="6588856">(</span><span class="op" id="6588857">[</span><span class="op" id="6588858">]</span><span class="builtintype" id="6588859">byte</span><span class="op" id="6588863">)</span>&nbsp;<span class="op" id="6588865">(</span><span class="builtintype" id="6588866">int</span><span class="op" id="6588869">,</span>&nbsp;<span class="builtintype" id="6588871">error</span><span class="op" id="6588876">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6588879">func</span>&nbsp;<span class="op" id="6588884">(</span><span class="ident" id="6588885">f</span>&nbsp;<span class="ident" id="6588887">writerFunc</span><span class="op" id="6588897">)</span>&nbsp;<span class="ident" id="6588899">Write</span><span class="op" id="6588904">(</span><span class="ident" id="6588905">p</span>&nbsp;<span class="op" id="6588907">[</span><span class="op" id="6588908">]</span><span class="builtintype" id="6588909">byte</span><span class="op" id="6588913">)</span>&nbsp;<span class="op" id="6588915">(</span><span class="builtintype" id="6588916">int</span><span class="op" id="6588919">,</span>&nbsp;<span class="builtintype" id="6588921">error</span><span class="op" id="6588926">)</span>&nbsp;<span class="op" id="6588928">{</span>&nbsp;<span class="keyword" id="6588930">return</span>&nbsp;<span class="ident" id="6588937">f</span><span class="op" id="6588938">(</span><span class="ident" id="6588939">p</span><span class="op" id="6588940">)</span>&nbsp;<span class="op" id="6588942">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="6588945">//&nbsp;TestRequestWriteError&nbsp;tests&nbsp;the&nbsp;Write&nbsp;err&nbsp;!=&nbsp;nil&nbsp;checks&nbsp;in&nbsp;(*Request).write.</span><br>
<span class="lineno"></span><span class="keyword" id="6589025">func</span>&nbsp;<span class="ident" id="6589030">TestRequestWriteError</span><span class="op" id="6589051">(</span><span class="ident" id="6589052">t</span>&nbsp;<span class="op" id="6589054">*</span><span class="ident" id="6589055">testing</span><span class="op" id="6589062">.</span><span class="ident" id="6589063">T</span><span class="op" id="6589064">)</span>&nbsp;<span class="op" id="6589066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589069">failAfter</span><span class="op" id="6589078">,</span>&nbsp;<span class="ident" id="6589080">writeCount</span>&nbsp;<span class="op" id="6589091">:=</span>&nbsp;<span class="num" id="6589094">0</span><span class="op" id="6589095">,</span>&nbsp;<span class="num" id="6589097">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589100">errFail</span>&nbsp;<span class="op" id="6589108">:=</span>&nbsp;<span class="ident" id="6589111">errors</span><span class="op" id="6589117">.</span><span class="ident" id="6589118">New</span><span class="op" id="6589121">(</span><span class="string" id="6589122">&#34;fake&nbsp;write&nbsp;failure&#34;</span><span class="op" id="6589142">)</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6589146">//&nbsp;w&nbsp;is&nbsp;the&nbsp;buffered&nbsp;io.Writer&nbsp;to&nbsp;write&nbsp;the&nbsp;request&nbsp;to.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6589207">//&nbsp;fails&nbsp;exactly&nbsp;once&nbsp;on&nbsp;its&nbsp;Nth&nbsp;Write&nbsp;call,&nbsp;as&nbsp;controlled&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6589270">//&nbsp;failAfter.&nbsp;It&nbsp;also&nbsp;tracks&nbsp;the&nbsp;number&nbsp;of&nbsp;calls&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6589323">//&nbsp;writeCount.</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589339">w</span>&nbsp;<span class="op" id="6589341">:=</span>&nbsp;<span class="keyword" id="6589344">struct</span>&nbsp;<span class="op" id="6589351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589355">io</span><span class="op" id="6589357">.</span><span class="ident" id="6589358">ByteWriter</span>&nbsp;<span class="comment" id="6589369">//&nbsp;to&nbsp;avoid&nbsp;being&nbsp;wrapped&nbsp;by&nbsp;a&nbsp;bufio.Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589415">io</span><span class="op" id="6589417">.</span><span class="ident" id="6589418">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6589426">}</span><span class="op" id="6589427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589431">nil</span><span class="op" id="6589434">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589438">writerFunc</span><span class="op" id="6589448">(</span><span class="keyword" id="6589449">func</span><span class="op" id="6589453">(</span><span class="ident" id="6589454">p</span>&nbsp;<span class="op" id="6589456">[</span><span class="op" id="6589457">]</span><span class="builtintype" id="6589458">byte</span><span class="op" id="6589462">)</span>&nbsp;<span class="op" id="6589464">(</span><span class="ident" id="6589465">n</span>&nbsp;<span class="builtintype" id="6589467">int</span><span class="op" id="6589470">,</span>&nbsp;<span class="ident" id="6589472">err</span>&nbsp;<span class="builtintype" id="6589476">error</span><span class="op" id="6589481">)</span>&nbsp;<span class="op" id="6589483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589488">writeCount</span><span class="op" id="6589498">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6589504">if</span>&nbsp;<span class="ident" id="6589507">failAfter</span>&nbsp;<span class="op" id="6589517">==</span>&nbsp;<span class="num" id="6589520">0</span>&nbsp;<span class="op" id="6589522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589528">err</span>&nbsp;<span class="op" id="6589532">=</span>&nbsp;<span class="ident" id="6589534">errFail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6589545">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589550">failAfter</span><span class="op" id="6589559">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6589565">return</span>&nbsp;<span class="builtinfunc" id="6589572">len</span><span class="op" id="6589575">(</span><span class="ident" id="6589576">p</span><span class="op" id="6589577">)</span><span class="op" id="6589578">,</span>&nbsp;<span class="ident" id="6589580">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6589586">}</span><span class="op" id="6589587">)</span><span class="op" id="6589588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6589591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589595">req</span><span class="op" id="6589598">,</span>&nbsp;<span class="ident" id="6589600">_</span>&nbsp;<span class="op" id="6589602">:=</span>&nbsp;<span class="ident" id="6589605">NewRequest</span><span class="op" id="6589615">(</span><span class="string" id="6589616">&#34;GET&#34;</span><span class="op" id="6589621">,</span>&nbsp;<span class="string" id="6589623">&#34;http://example.com/&#34;</span><span class="op" id="6589644">,</span>&nbsp;<span class="ident" id="6589646">nil</span><span class="op" id="6589649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6589652">const</span>&nbsp;<span class="ident" id="6589658">writeCalls</span>&nbsp;<span class="op" id="6589669">=</span>&nbsp;<span class="num" id="6589671">4</span>&nbsp;<span class="comment" id="6589673">//&nbsp;number&nbsp;of&nbsp;Write&nbsp;calls&nbsp;in&nbsp;current&nbsp;implementation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589725">sawGood</span>&nbsp;<span class="op" id="6589733">:=</span>&nbsp;<span class="builtintype" id="6589736">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6589743">for</span>&nbsp;<span class="ident" id="6589747">n</span>&nbsp;<span class="op" id="6589749">:=</span>&nbsp;<span class="num" id="6589752">0</span><span class="op" id="6589753">;</span>&nbsp;<span class="ident" id="6589755">n</span>&nbsp;<span class="op" id="6589757">&lt;=</span>&nbsp;<span class="ident" id="6589760">writeCalls</span><span class="op" id="6589770">+</span><span class="num" id="6589771">2</span><span class="op" id="6589772">;</span>&nbsp;<span class="ident" id="6589774">n</span><span class="op" id="6589775">++</span>&nbsp;<span class="op" id="6589778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589782">failAfter</span>&nbsp;<span class="op" id="6589792">=</span>&nbsp;<span class="ident" id="6589794">n</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589798">writeCount</span>&nbsp;<span class="op" id="6589809">=</span>&nbsp;<span class="num" id="6589811">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589815">err</span>&nbsp;<span class="op" id="6589819">:=</span>&nbsp;<span class="ident" id="6589822">req</span><span class="op" id="6589825">.</span><span class="ident" id="6589826">Write</span><span class="op" id="6589831">(</span><span class="ident" id="6589832">w</span><span class="op" id="6589833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6589837">var</span>&nbsp;<span class="ident" id="6589841">wantErr</span>&nbsp;<span class="builtintype" id="6589849">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6589857">if</span>&nbsp;<span class="ident" id="6589860">n</span>&nbsp;<span class="op" id="6589862">&lt;</span>&nbsp;<span class="ident" id="6589864">writeCalls</span>&nbsp;<span class="op" id="6589875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589880">wantErr</span>&nbsp;<span class="op" id="6589888">=</span>&nbsp;<span class="ident" id="6589890">errFail</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6589900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6589904">if</span>&nbsp;<span class="ident" id="6589907">err</span>&nbsp;<span class="op" id="6589911">!=</span>&nbsp;<span class="ident" id="6589914">wantErr</span>&nbsp;<span class="op" id="6589922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6589927">t</span><span class="op" id="6589928">.</span><span class="ident" id="6589929">Errorf</span><span class="op" id="6589935">(</span><span class="string" id="6589936">&#34;for&nbsp;fail-after&nbsp;%d&nbsp;Writes,&nbsp;err&nbsp;=&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6589981">,</span>&nbsp;<span class="ident" id="6589983">n</span><span class="op" id="6589984">,</span>&nbsp;<span class="ident" id="6589986">err</span><span class="op" id="6589989">,</span>&nbsp;<span class="ident" id="6589991">wantErr</span><span class="op" id="6589998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6590003">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6590014">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6590018">if</span>&nbsp;<span class="ident" id="6590021">err</span>&nbsp;<span class="op" id="6590025">==</span>&nbsp;<span class="ident" id="6590028">nil</span>&nbsp;<span class="op" id="6590032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6590037">sawGood</span>&nbsp;<span class="op" id="6590045">=</span>&nbsp;<span class="builtintype" id="6590047">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6590055">if</span>&nbsp;<span class="ident" id="6590058">writeCount</span>&nbsp;<span class="op" id="6590069">!=</span>&nbsp;<span class="ident" id="6590072">writeCalls</span>&nbsp;<span class="op" id="6590083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6590089">t</span><span class="op" id="6590090">.</span><span class="ident" id="6590091">Fatalf</span><span class="op" id="6590097">(</span><span class="string" id="6590098">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="6590139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6590144">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6590148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6590152">if</span>&nbsp;<span class="ident" id="6590155">writeCount</span>&nbsp;<span class="op" id="6590166">&gt;</span>&nbsp;<span class="ident" id="6590168">writeCalls</span>&nbsp;<span class="op" id="6590179">||</span>&nbsp;<span class="ident" id="6590182">writeCount</span>&nbsp;<span class="op" id="6590193">&gt;</span>&nbsp;<span class="ident" id="6590195">n</span><span class="op" id="6590196">+</span><span class="num" id="6590197">1</span>&nbsp;<span class="op" id="6590199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6590204">t</span><span class="op" id="6590205">.</span><span class="ident" id="6590206">Errorf</span><span class="op" id="6590212">(</span><span class="string" id="6590213">&#34;for&nbsp;fail-after&nbsp;%d,&nbsp;saw&nbsp;unexpectedly&nbsp;high&nbsp;(%d)&nbsp;write&nbsp;calls&#34;</span><span class="op" id="6590272">,</span>&nbsp;<span class="ident" id="6590274">n</span><span class="op" id="6590275">,</span>&nbsp;<span class="ident" id="6590277">writeCount</span><span class="op" id="6590287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6590291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6590294">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6590297">if</span>&nbsp;<span class="op" id="6590300">!</span><span class="ident" id="6590301">sawGood</span>&nbsp;<span class="op" id="6590309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6590313">t</span><span class="op" id="6590314">.</span><span class="ident" id="6590315">Fatalf</span><span class="op" id="6590321">(</span><span class="string" id="6590322">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="6590363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6590366">}</span><br>
<span class="lineno"></span><span class="op" id="6590368">}</span>
</div>
</body>
</html>
