<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/printer</h2>
<ul>
<li><a href="/gostd/go/printer/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/printer/nodes.go.html">nodes.go</a></li>
<li><a href="/gostd/go/printer/performance_test.go.html">performance_test.go</a></li>
<li><a href="/gostd/go/printer/printer.go.html">printer.go</a></li>
<li><a href="/gostd/go/printer/printer_test.go.html">printer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1959385">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1959440">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1959494">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1959545">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;printing&nbsp;of&nbsp;AST&nbsp;nodes;&nbsp;specifically</span><br>
<span class="lineno"></span><span class="comment" id="1959605">//&nbsp;expressions,&nbsp;statements,&nbsp;declarations,&nbsp;and&nbsp;files.&nbsp;It&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="1959666">//&nbsp;the&nbsp;print&nbsp;functionality&nbsp;implemented&nbsp;in&nbsp;printer.go.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1959721">package</span>&nbsp;<span class="ident" id="1959729">printer</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="1959738">import</span>&nbsp;<span class="op" id="1959745">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1959748">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1959757">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1959767">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1959779">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="1959794">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1959797">//&nbsp;Formatting&nbsp;issues:</span><br>
<span class="lineno"></span><span class="comment" id="1959819">//&nbsp;-&nbsp;better&nbsp;comment&nbsp;formatting&nbsp;for&nbsp;/*-style&nbsp;comments&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;(e.g.&nbsp;a&nbsp;declaration)</span><br>
<span class="lineno">20</span><span class="comment" id="1959914">//&nbsp;&nbsp;&nbsp;when&nbsp;the&nbsp;comment&nbsp;spans&nbsp;multiple&nbsp;lines;&nbsp;if&nbsp;such&nbsp;a&nbsp;comment&nbsp;is&nbsp;just&nbsp;two&nbsp;lines,&nbsp;formatting&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1960009">//&nbsp;&nbsp;&nbsp;not&nbsp;idempotent</span><br>
<span class="lineno"></span><span class="comment" id="1960029">//&nbsp;-&nbsp;formatting&nbsp;of&nbsp;expression&nbsp;lists</span><br>
<span class="lineno"></span><span class="comment" id="1960065">//&nbsp;-&nbsp;should&nbsp;use&nbsp;blank&nbsp;instead&nbsp;of&nbsp;tab&nbsp;to&nbsp;separate&nbsp;one-line&nbsp;function&nbsp;bodies&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="1960144">//&nbsp;&nbsp;&nbsp;the&nbsp;function&nbsp;header&nbsp;unless&nbsp;there&nbsp;is&nbsp;a&nbsp;group&nbsp;of&nbsp;consecutive&nbsp;one-liners</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1960220">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="1960300">//&nbsp;Common&nbsp;AST&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1960322">//&nbsp;Print&nbsp;as&nbsp;many&nbsp;newlines&nbsp;as&nbsp;necessary&nbsp;(but&nbsp;at&nbsp;least&nbsp;min&nbsp;newlines)&nbsp;to&nbsp;get&nbsp;to</span><br>
<span class="lineno">30</span><span class="comment" id="1960399">//&nbsp;the&nbsp;current&nbsp;line.&nbsp;ws&nbsp;is&nbsp;printed&nbsp;before&nbsp;the&nbsp;first&nbsp;line&nbsp;break.&nbsp;If&nbsp;newSection</span><br>
<span class="lineno"></span><span class="comment" id="1960477">//&nbsp;is&nbsp;set,&nbsp;the&nbsp;first&nbsp;line&nbsp;break&nbsp;is&nbsp;printed&nbsp;as&nbsp;formfeed.&nbsp;Returns&nbsp;true&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="1960553">//&nbsp;line&nbsp;break&nbsp;was&nbsp;printed;&nbsp;returns&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="1960605">//</span><br>
<span class="lineno"></span><span class="comment" id="1960608">//&nbsp;TODO(gri):&nbsp;linebreak&nbsp;may&nbsp;add&nbsp;too&nbsp;many&nbsp;lines&nbsp;if&nbsp;the&nbsp;next&nbsp;statement&nbsp;at&nbsp;&#34;line&#34;</span><br>
<span class="lineno">35</span><span class="comment" id="1960687">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;preceded&nbsp;by&nbsp;comments&nbsp;because&nbsp;the&nbsp;computation&nbsp;of&nbsp;n&nbsp;assumes</span><br>
<span class="lineno"></span><span class="comment" id="1960762">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;current&nbsp;position&nbsp;before&nbsp;the&nbsp;comment&nbsp;and&nbsp;the&nbsp;target&nbsp;position</span><br>
<span class="lineno"></span><span class="comment" id="1960840">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;after&nbsp;the&nbsp;comment.&nbsp;Thus,&nbsp;after&nbsp;interspersing&nbsp;such&nbsp;comments,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1960918">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space&nbsp;taken&nbsp;up&nbsp;by&nbsp;them&nbsp;is&nbsp;not&nbsp;considered&nbsp;to&nbsp;reduce&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1960997">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linebreaks.&nbsp;At&nbsp;the&nbsp;moment&nbsp;there&nbsp;is&nbsp;no&nbsp;easy&nbsp;way&nbsp;to&nbsp;know&nbsp;about</span><br>
<span class="lineno">40</span><span class="comment" id="1961072">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;future&nbsp;(not&nbsp;yet&nbsp;interspersed)&nbsp;comments&nbsp;in&nbsp;this&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="1961143">//</span><br>
<span class="lineno"></span><span class="keyword" id="1961146">func</span>&nbsp;<span class="op" id="1961151">(</span><span class="ident" id="1961152">p</span>&nbsp;<span class="op" id="1961154">*</span><span class="ident" id="1961155">printer</span><span class="op" id="1961162">)</span>&nbsp;<span class="ident" id="1961164">linebreak</span><span class="op" id="1961173">(</span><span class="ident" id="1961174">line</span><span class="op" id="1961178">,</span>&nbsp;<span class="ident" id="1961180">min</span>&nbsp;<span class="builtintype" id="1961184">int</span><span class="op" id="1961187">,</span>&nbsp;<span class="ident" id="1961189">ws</span>&nbsp;<span class="ident" id="1961192">whiteSpace</span><span class="op" id="1961202">,</span>&nbsp;<span class="ident" id="1961204">newSection</span>&nbsp;<span class="builtintype" id="1961215">bool</span><span class="op" id="1961219">)</span>&nbsp;<span class="op" id="1961221">(</span><span class="ident" id="1961222">printedBreak</span>&nbsp;<span class="builtintype" id="1961235">bool</span><span class="op" id="1961239">)</span>&nbsp;<span class="op" id="1961241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1961244">n</span>&nbsp;<span class="op" id="1961246">:=</span>&nbsp;<span class="ident" id="1961249">nlimit</span><span class="op" id="1961255">(</span><span class="ident" id="1961256">line</span>&nbsp;<span class="op" id="1961261">-</span>&nbsp;<span class="ident" id="1961263">p</span><span class="op" id="1961264">.</span><span class="ident" id="1961265">pos</span><span class="op" id="1961268">.</span><span class="ident" id="1961269">Line</span><span class="op" id="1961273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1961276">if</span>&nbsp;<span class="ident" id="1961279">n</span>&nbsp;<span class="op" id="1961281">&lt;</span>&nbsp;<span class="ident" id="1961283">min</span>&nbsp;<span class="op" id="1961287">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1961291">n</span>&nbsp;<span class="op" id="1961293">=</span>&nbsp;<span class="ident" id="1961295">min</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1961300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1961303">if</span>&nbsp;<span class="ident" id="1961306">n</span>&nbsp;<span class="op" id="1961308">&gt;</span>&nbsp;<span class="num" id="1961310">0</span>&nbsp;<span class="op" id="1961312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1961316">p</span><span class="op" id="1961317">.</span><span class="builtinfunc" id="1961318">print</span><span class="op" id="1961323">(</span><span class="ident" id="1961324">ws</span><span class="op" id="1961326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1961330">if</span>&nbsp;<span class="ident" id="1961333">newSection</span>&nbsp;<span class="op" id="1961344">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1961349">p</span><span class="op" id="1961350">.</span><span class="builtinfunc" id="1961351">print</span><span class="op" id="1961356">(</span><span class="ident" id="1961357">formfeed</span><span class="op" id="1961365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1961370">n</span><span class="op" id="1961371">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1961376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1961380">for</span>&nbsp;<span class="op" id="1961384">;</span>&nbsp;<span class="ident" id="1961386">n</span>&nbsp;<span class="op" id="1961388">&gt;</span>&nbsp;<span class="num" id="1961390">0</span><span class="op" id="1961391">;</span>&nbsp;<span class="ident" id="1961393">n</span><span class="op" id="1961394">--</span>&nbsp;<span class="op" id="1961397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1961402">p</span><span class="op" id="1961403">.</span><span class="builtinfunc" id="1961404">print</span><span class="op" id="1961409">(</span><span class="ident" id="1961410">newline</span><span class="op" id="1961417">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1961421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1961425">printedBreak</span>&nbsp;<span class="op" id="1961438">=</span>&nbsp;<span class="builtintype" id="1961440">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1961446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1961449">return</span><br>
<span class="lineno"></span><span class="op" id="1961456">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="1961459">//&nbsp;setComment&nbsp;sets&nbsp;g&nbsp;as&nbsp;the&nbsp;next&nbsp;comment&nbsp;if&nbsp;g&nbsp;!=&nbsp;nil&nbsp;and&nbsp;if&nbsp;node&nbsp;comments</span><br>
<span class="lineno"></span><span class="comment" id="1961533">//&nbsp;are&nbsp;enabled&nbsp;-&nbsp;this&nbsp;mode&nbsp;is&nbsp;used&nbsp;when&nbsp;printing&nbsp;source&nbsp;code&nbsp;fragments&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="1961609">//&nbsp;as&nbsp;exports&nbsp;only.&nbsp;It&nbsp;assumes&nbsp;that&nbsp;there&nbsp;is&nbsp;no&nbsp;pending&nbsp;comment&nbsp;in&nbsp;p.comments</span><br>
<span class="lineno"></span><span class="comment" id="1961687">//&nbsp;and&nbsp;at&nbsp;most&nbsp;one&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache.</span><br>
<span class="lineno">65</span><span class="keyword" id="1961746">func</span>&nbsp;<span class="op" id="1961751">(</span><span class="ident" id="1961752">p</span>&nbsp;<span class="op" id="1961754">*</span><span class="ident" id="1961755">printer</span><span class="op" id="1961762">)</span>&nbsp;<span class="ident" id="1961764">setComment</span><span class="op" id="1961774">(</span><span class="ident" id="1961775">g</span>&nbsp;<span class="op" id="1961777">*</span><span class="ident" id="1961778">ast</span><span class="op" id="1961781">.</span><span class="ident" id="1961782">CommentGroup</span><span class="op" id="1961794">)</span>&nbsp;<span class="op" id="1961796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1961799">if</span>&nbsp;<span class="ident" id="1961802">g</span>&nbsp;<span class="op" id="1961804">==</span>&nbsp;<span class="ident" id="1961807">nil</span>&nbsp;<span class="op" id="1961811">||</span>&nbsp;<span class="op" id="1961814">!</span><span class="ident" id="1961815">p</span><span class="op" id="1961816">.</span><span class="ident" id="1961817">useNodeComments</span>&nbsp;<span class="op" id="1961833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1961837">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1961845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1961848">if</span>&nbsp;<span class="ident" id="1961851">p</span><span class="op" id="1961852">.</span><span class="ident" id="1961853">comments</span>&nbsp;<span class="op" id="1961862">==</span>&nbsp;<span class="ident" id="1961865">nil</span>&nbsp;<span class="op" id="1961869">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1961873">//&nbsp;initialize&nbsp;p.comments&nbsp;lazily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1961907">p</span><span class="op" id="1961908">.</span><span class="ident" id="1961909">comments</span>&nbsp;<span class="op" id="1961918">=</span>&nbsp;<span class="builtinfunc" id="1961920">make</span><span class="op" id="1961924">(</span><span class="op" id="1961925">[</span><span class="op" id="1961926">]</span><span class="op" id="1961927">*</span><span class="ident" id="1961928">ast</span><span class="op" id="1961931">.</span><span class="ident" id="1961932">CommentGroup</span><span class="op" id="1961944">,</span>&nbsp;<span class="num" id="1961946">1</span><span class="op" id="1961947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1961950">}</span>&nbsp;<span class="keyword" id="1961952">else</span>&nbsp;<span class="keyword" id="1961957">if</span>&nbsp;<span class="ident" id="1961960">p</span><span class="op" id="1961961">.</span><span class="ident" id="1961962">cindex</span>&nbsp;<span class="op" id="1961969">&lt;</span>&nbsp;<span class="builtinfunc" id="1961971">len</span><span class="op" id="1961974">(</span><span class="ident" id="1961975">p</span><span class="op" id="1961976">.</span><span class="ident" id="1961977">comments</span><span class="op" id="1961985">)</span>&nbsp;<span class="op" id="1961987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1961991">//&nbsp;for&nbsp;some&nbsp;reason&nbsp;there&nbsp;are&nbsp;pending&nbsp;comments;&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1962045">//&nbsp;should&nbsp;never&nbsp;happen&nbsp;-&nbsp;handle&nbsp;gracefully&nbsp;and&nbsp;flush</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1962100">//&nbsp;all&nbsp;comments&nbsp;up&nbsp;to&nbsp;g,&nbsp;ignore&nbsp;anything&nbsp;after&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1962154">p</span><span class="op" id="1962155">.</span><span class="ident" id="1962156">flush</span><span class="op" id="1962161">(</span><span class="ident" id="1962162">p</span><span class="op" id="1962163">.</span><span class="ident" id="1962164">posFor</span><span class="op" id="1962170">(</span><span class="ident" id="1962171">g</span><span class="op" id="1962172">.</span><span class="ident" id="1962173">List</span><span class="op" id="1962177">[</span><span class="num" id="1962178">0</span><span class="op" id="1962179">]</span><span class="op" id="1962180">.</span><span class="ident" id="1962181">Pos</span><span class="op" id="1962184">(</span><span class="op" id="1962185">)</span><span class="op" id="1962186">)</span><span class="op" id="1962187">,</span>&nbsp;<span class="ident" id="1962189">token</span><span class="op" id="1962194">.</span><span class="ident" id="1962195">ILLEGAL</span><span class="op" id="1962202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1962206">p</span><span class="op" id="1962207">.</span><span class="ident" id="1962208">comments</span>&nbsp;<span class="op" id="1962217">=</span>&nbsp;<span class="ident" id="1962219">p</span><span class="op" id="1962220">.</span><span class="ident" id="1962221">comments</span><span class="op" id="1962229">[</span><span class="num" id="1962230">0</span><span class="op" id="1962231">:</span><span class="num" id="1962232">1</span><span class="op" id="1962233">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1962237">//&nbsp;in&nbsp;debug&nbsp;mode,&nbsp;report&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1962270">p</span><span class="op" id="1962271">.</span><span class="ident" id="1962272">internalError</span><span class="op" id="1962285">(</span><span class="string" id="1962286">&#34;setComment&nbsp;found&nbsp;pending&nbsp;comments&#34;</span><span class="op" id="1962321">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1962324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1962327">p</span><span class="op" id="1962328">.</span><span class="ident" id="1962329">comments</span><span class="op" id="1962337">[</span><span class="num" id="1962338">0</span><span class="op" id="1962339">]</span>&nbsp;<span class="op" id="1962341">=</span>&nbsp;<span class="ident" id="1962343">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1962346">p</span><span class="op" id="1962347">.</span><span class="ident" id="1962348">cindex</span>&nbsp;<span class="op" id="1962355">=</span>&nbsp;<span class="num" id="1962357">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1962360">//&nbsp;don&#39;t&nbsp;overwrite&nbsp;any&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1962423">//&nbsp;(there&nbsp;may&nbsp;be&nbsp;a&nbsp;pending&nbsp;comment&nbsp;when&nbsp;a&nbsp;line&nbsp;comment&nbsp;is</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1962482">//&nbsp;immediately&nbsp;followed&nbsp;by&nbsp;a&nbsp;lead&nbsp;comment&nbsp;with&nbsp;no&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1962539">//&nbsp;tokens&nbsp;between)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1962559">if</span>&nbsp;<span class="ident" id="1962562">p</span><span class="op" id="1962563">.</span><span class="ident" id="1962564">commentOffset</span>&nbsp;<span class="op" id="1962578">==</span>&nbsp;<span class="ident" id="1962581">infinity</span>&nbsp;<span class="op" id="1962590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1962594">p</span><span class="op" id="1962595">.</span><span class="ident" id="1962596">nextComment</span><span class="op" id="1962607">(</span><span class="op" id="1962608">)</span>&nbsp;<span class="comment" id="1962610">//&nbsp;get&nbsp;comment&nbsp;ready&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1962640">}</span><br>
<span class="lineno">90</span><span class="op" id="1962642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1962645">type</span>&nbsp;<span class="ident" id="1962650">exprListMode</span>&nbsp;<span class="builtintype" id="1962663">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1962669">const</span>&nbsp;<span class="op" id="1962675">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1962678">commaTerm</span>&nbsp;<span class="ident" id="1962688">exprListMode</span>&nbsp;<span class="op" id="1962701">=</span>&nbsp;<span class="num" id="1962703">1</span>&nbsp;<span class="op" id="1962705">&lt;&lt;</span>&nbsp;<span class="ident" id="1962708">iota</span>&nbsp;<span class="comment" id="1962713">//&nbsp;list&nbsp;is&nbsp;optionally&nbsp;terminated&nbsp;by&nbsp;a&nbsp;comma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1962758">noIndent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1962793">//&nbsp;no&nbsp;extra&nbsp;indentation&nbsp;in&nbsp;multi-line&nbsp;lists</span><br>
<span class="lineno"></span><span class="op" id="1962837">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1962840">//&nbsp;If&nbsp;indent&nbsp;is&nbsp;set,&nbsp;a&nbsp;multi-line&nbsp;identifier&nbsp;list&nbsp;is&nbsp;indented&nbsp;after&nbsp;the</span><br>
<span class="lineno">100</span><span class="comment" id="1962912">//&nbsp;first&nbsp;linebreak&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="1962944">func</span>&nbsp;<span class="op" id="1962949">(</span><span class="ident" id="1962950">p</span>&nbsp;<span class="op" id="1962952">*</span><span class="ident" id="1962953">printer</span><span class="op" id="1962960">)</span>&nbsp;<span class="ident" id="1962962">identList</span><span class="op" id="1962971">(</span><span class="ident" id="1962972">list</span>&nbsp;<span class="op" id="1962977">[</span><span class="op" id="1962978">]</span><span class="op" id="1962979">*</span><span class="ident" id="1962980">ast</span><span class="op" id="1962983">.</span><span class="ident" id="1962984">Ident</span><span class="op" id="1962989">,</span>&nbsp;<span class="ident" id="1962991">indent</span>&nbsp;<span class="builtintype" id="1962998">bool</span><span class="op" id="1963002">)</span>&nbsp;<span class="op" id="1963004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1963007">//&nbsp;convert&nbsp;into&nbsp;an&nbsp;expression&nbsp;list&nbsp;so&nbsp;we&nbsp;can&nbsp;re-use&nbsp;exprList&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1963080">xlist</span>&nbsp;<span class="op" id="1963086">:=</span>&nbsp;<span class="builtinfunc" id="1963089">make</span><span class="op" id="1963093">(</span><span class="op" id="1963094">[</span><span class="op" id="1963095">]</span><span class="ident" id="1963096">ast</span><span class="op" id="1963099">.</span><span class="ident" id="1963100">Expr</span><span class="op" id="1963104">,</span>&nbsp;<span class="builtinfunc" id="1963106">len</span><span class="op" id="1963109">(</span><span class="ident" id="1963110">list</span><span class="op" id="1963114">)</span><span class="op" id="1963115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1963118">for</span>&nbsp;<span class="ident" id="1963122">i</span><span class="op" id="1963123">,</span>&nbsp;<span class="ident" id="1963125">x</span>&nbsp;<span class="op" id="1963127">:=</span>&nbsp;<span class="keyword" id="1963130">range</span>&nbsp;<span class="ident" id="1963136">list</span>&nbsp;<span class="op" id="1963141">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1963145">xlist</span><span class="op" id="1963150">[</span><span class="ident" id="1963151">i</span><span class="op" id="1963152">]</span>&nbsp;<span class="op" id="1963154">=</span>&nbsp;<span class="ident" id="1963156">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1963159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1963162">var</span>&nbsp;<span class="ident" id="1963166">mode</span>&nbsp;<span class="ident" id="1963171">exprListMode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1963185">if</span>&nbsp;<span class="op" id="1963188">!</span><span class="ident" id="1963189">indent</span>&nbsp;<span class="op" id="1963196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1963200">mode</span>&nbsp;<span class="op" id="1963205">=</span>&nbsp;<span class="ident" id="1963207">noIndent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1963217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1963220">p</span><span class="op" id="1963221">.</span><span class="ident" id="1963222">exprList</span><span class="op" id="1963230">(</span><span class="ident" id="1963231">token</span><span class="op" id="1963236">.</span><span class="ident" id="1963237">NoPos</span><span class="op" id="1963242">,</span>&nbsp;<span class="ident" id="1963244">xlist</span><span class="op" id="1963249">,</span>&nbsp;<span class="num" id="1963251">1</span><span class="op" id="1963252">,</span>&nbsp;<span class="ident" id="1963254">mode</span><span class="op" id="1963258">,</span>&nbsp;<span class="ident" id="1963260">token</span><span class="op" id="1963265">.</span><span class="ident" id="1963266">NoPos</span><span class="op" id="1963271">)</span><br>
<span class="lineno"></span><span class="op" id="1963273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1963276">//&nbsp;Print&nbsp;a&nbsp;list&nbsp;of&nbsp;expressions.&nbsp;If&nbsp;the&nbsp;list&nbsp;spans&nbsp;multiple</span><br>
<span class="lineno">115</span><span class="comment" id="1963335">//&nbsp;source&nbsp;lines,&nbsp;the&nbsp;original&nbsp;line&nbsp;breaks&nbsp;are&nbsp;respected&nbsp;between</span><br>
<span class="lineno"></span><span class="comment" id="1963399">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="comment" id="1963415">//</span><br>
<span class="lineno"></span><span class="comment" id="1963418">//&nbsp;TODO(gri)&nbsp;Consider&nbsp;rewriting&nbsp;this&nbsp;to&nbsp;be&nbsp;independent&nbsp;of&nbsp;[]ast.Expr</span><br>
<span class="lineno"></span><span class="comment" id="1963487">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;use&nbsp;the&nbsp;algorithm&nbsp;for&nbsp;any&nbsp;kind&nbsp;of&nbsp;list</span><br>
<span class="lineno">120</span><span class="comment" id="1963554">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(e.g.,&nbsp;pass&nbsp;list&nbsp;via&nbsp;a&nbsp;channel&nbsp;over&nbsp;which&nbsp;to&nbsp;range).</span><br>
<span class="lineno"></span><span class="keyword" id="1963620">func</span>&nbsp;<span class="op" id="1963625">(</span><span class="ident" id="1963626">p</span>&nbsp;<span class="op" id="1963628">*</span><span class="ident" id="1963629">printer</span><span class="op" id="1963636">)</span>&nbsp;<span class="ident" id="1963638">exprList</span><span class="op" id="1963646">(</span><span class="ident" id="1963647">prev0</span>&nbsp;<span class="ident" id="1963653">token</span><span class="op" id="1963658">.</span><span class="ident" id="1963659">Pos</span><span class="op" id="1963662">,</span>&nbsp;<span class="ident" id="1963664">list</span>&nbsp;<span class="op" id="1963669">[</span><span class="op" id="1963670">]</span><span class="ident" id="1963671">ast</span><span class="op" id="1963674">.</span><span class="ident" id="1963675">Expr</span><span class="op" id="1963679">,</span>&nbsp;<span class="ident" id="1963681">depth</span>&nbsp;<span class="builtintype" id="1963687">int</span><span class="op" id="1963690">,</span>&nbsp;<span class="ident" id="1963692">mode</span>&nbsp;<span class="ident" id="1963697">exprListMode</span><span class="op" id="1963709">,</span>&nbsp;<span class="ident" id="1963711">next0</span>&nbsp;<span class="ident" id="1963717">token</span><span class="op" id="1963722">.</span><span class="ident" id="1963723">Pos</span><span class="op" id="1963726">)</span>&nbsp;<span class="op" id="1963728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1963731">if</span>&nbsp;<span class="builtinfunc" id="1963734">len</span><span class="op" id="1963737">(</span><span class="ident" id="1963738">list</span><span class="op" id="1963742">)</span>&nbsp;<span class="op" id="1963744">==</span>&nbsp;<span class="num" id="1963747">0</span>&nbsp;<span class="op" id="1963749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1963753">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1963761">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1963765">prev</span>&nbsp;<span class="op" id="1963770">:=</span>&nbsp;<span class="ident" id="1963773">p</span><span class="op" id="1963774">.</span><span class="ident" id="1963775">posFor</span><span class="op" id="1963781">(</span><span class="ident" id="1963782">prev0</span><span class="op" id="1963787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1963790">next</span>&nbsp;<span class="op" id="1963795">:=</span>&nbsp;<span class="ident" id="1963798">p</span><span class="op" id="1963799">.</span><span class="ident" id="1963800">posFor</span><span class="op" id="1963806">(</span><span class="ident" id="1963807">next0</span><span class="op" id="1963812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1963815">line</span>&nbsp;<span class="op" id="1963820">:=</span>&nbsp;<span class="ident" id="1963823">p</span><span class="op" id="1963824">.</span><span class="ident" id="1963825">lineFor</span><span class="op" id="1963832">(</span><span class="ident" id="1963833">list</span><span class="op" id="1963837">[</span><span class="num" id="1963838">0</span><span class="op" id="1963839">]</span><span class="op" id="1963840">.</span><span class="ident" id="1963841">Pos</span><span class="op" id="1963844">(</span><span class="op" id="1963845">)</span><span class="op" id="1963846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1963849">endLine</span>&nbsp;<span class="op" id="1963857">:=</span>&nbsp;<span class="ident" id="1963860">p</span><span class="op" id="1963861">.</span><span class="ident" id="1963862">lineFor</span><span class="op" id="1963869">(</span><span class="ident" id="1963870">list</span><span class="op" id="1963874">[</span><span class="builtinfunc" id="1963875">len</span><span class="op" id="1963878">(</span><span class="ident" id="1963879">list</span><span class="op" id="1963883">)</span><span class="op" id="1963884">-</span><span class="num" id="1963885">1</span><span class="op" id="1963886">]</span><span class="op" id="1963887">.</span><span class="ident" id="1963888">End</span><span class="op" id="1963891">(</span><span class="op" id="1963892">)</span><span class="op" id="1963893">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1963897">if</span>&nbsp;<span class="ident" id="1963900">prev</span><span class="op" id="1963904">.</span><span class="ident" id="1963905">IsValid</span><span class="op" id="1963912">(</span><span class="op" id="1963913">)</span>&nbsp;<span class="op" id="1963915">&amp;&amp;</span>&nbsp;<span class="ident" id="1963918">prev</span><span class="op" id="1963922">.</span><span class="ident" id="1963923">Line</span>&nbsp;<span class="op" id="1963928">==</span>&nbsp;<span class="ident" id="1963931">line</span>&nbsp;<span class="op" id="1963936">&amp;&amp;</span>&nbsp;<span class="ident" id="1963939">line</span>&nbsp;<span class="op" id="1963944">==</span>&nbsp;<span class="ident" id="1963947">endLine</span>&nbsp;<span class="op" id="1963955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1963959">//&nbsp;all&nbsp;list&nbsp;entries&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1963998">for</span>&nbsp;<span class="ident" id="1964002">i</span><span class="op" id="1964003">,</span>&nbsp;<span class="ident" id="1964005">x</span>&nbsp;<span class="op" id="1964007">:=</span>&nbsp;<span class="keyword" id="1964010">range</span>&nbsp;<span class="ident" id="1964016">list</span>&nbsp;<span class="op" id="1964021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964026">if</span>&nbsp;<span class="ident" id="1964029">i</span>&nbsp;<span class="op" id="1964031">&gt;</span>&nbsp;<span class="num" id="1964033">0</span>&nbsp;<span class="op" id="1964035">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1964041">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1964098">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1964150">p</span><span class="op" id="1964151">.</span><span class="builtinfunc" id="1964152">print</span><span class="op" id="1964157">(</span><span class="ident" id="1964158">x</span><span class="op" id="1964159">.</span><span class="ident" id="1964160">Pos</span><span class="op" id="1964163">(</span><span class="op" id="1964164">)</span><span class="op" id="1964165">,</span>&nbsp;<span class="ident" id="1964167">token</span><span class="op" id="1964172">.</span><span class="ident" id="1964173">COMMA</span><span class="op" id="1964178">,</span>&nbsp;<span class="ident" id="1964180">blank</span><span class="op" id="1964185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1964190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1964195">p</span><span class="op" id="1964196">.</span><span class="ident" id="1964197">expr0</span><span class="op" id="1964202">(</span><span class="ident" id="1964203">x</span><span class="op" id="1964204">,</span>&nbsp;<span class="ident" id="1964206">depth</span><span class="op" id="1964211">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1964215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964219">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1964227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1964231">//&nbsp;list&nbsp;entries&nbsp;span&nbsp;multiple&nbsp;lines;</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1964269">//&nbsp;use&nbsp;source&nbsp;code&nbsp;positions&nbsp;to&nbsp;guide&nbsp;line&nbsp;breaks</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1964321">//&nbsp;don&#39;t&nbsp;add&nbsp;extra&nbsp;indentation&nbsp;if&nbsp;noIndent&nbsp;is&nbsp;set;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1964373">//&nbsp;i.e.,&nbsp;pretend&nbsp;that&nbsp;the&nbsp;first&nbsp;line&nbsp;is&nbsp;already&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1964431">ws</span>&nbsp;<span class="op" id="1964434">:=</span>&nbsp;<span class="ident" id="1964437">ignore</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964445">if</span>&nbsp;<span class="ident" id="1964448">mode</span><span class="op" id="1964452">&amp;</span><span class="ident" id="1964453">noIndent</span>&nbsp;<span class="op" id="1964462">==</span>&nbsp;<span class="num" id="1964465">0</span>&nbsp;<span class="op" id="1964467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1964471">ws</span>&nbsp;<span class="op" id="1964474">=</span>&nbsp;<span class="ident" id="1964476">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1964484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1964488">//&nbsp;the&nbsp;first&nbsp;linebreak&nbsp;is&nbsp;always&nbsp;a&nbsp;formfeed&nbsp;since&nbsp;this&nbsp;section&nbsp;must&nbsp;not</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1964561">//&nbsp;depend&nbsp;on&nbsp;any&nbsp;previous&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1964599">prevBreak</span>&nbsp;<span class="op" id="1964609">:=</span>&nbsp;<span class="op" id="1964612">-</span><span class="num" id="1964613">1</span>&nbsp;<span class="comment" id="1964615">//&nbsp;index&nbsp;of&nbsp;last&nbsp;expression&nbsp;that&nbsp;was&nbsp;followed&nbsp;by&nbsp;a&nbsp;linebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964677">if</span>&nbsp;<span class="ident" id="1964680">prev</span><span class="op" id="1964684">.</span><span class="ident" id="1964685">IsValid</span><span class="op" id="1964692">(</span><span class="op" id="1964693">)</span>&nbsp;<span class="op" id="1964695">&amp;&amp;</span>&nbsp;<span class="ident" id="1964698">prev</span><span class="op" id="1964702">.</span><span class="ident" id="1964703">Line</span>&nbsp;<span class="op" id="1964708">&lt;</span>&nbsp;<span class="ident" id="1964710">line</span>&nbsp;<span class="op" id="1964715">&amp;&amp;</span>&nbsp;<span class="ident" id="1964718">p</span><span class="op" id="1964719">.</span><span class="ident" id="1964720">linebreak</span><span class="op" id="1964729">(</span><span class="ident" id="1964730">line</span><span class="op" id="1964734">,</span>&nbsp;<span class="num" id="1964736">0</span><span class="op" id="1964737">,</span>&nbsp;<span class="ident" id="1964739">ws</span><span class="op" id="1964741">,</span>&nbsp;<span class="builtintype" id="1964743">true</span><span class="op" id="1964747">)</span>&nbsp;<span class="op" id="1964749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1964753">ws</span>&nbsp;<span class="op" id="1964756">=</span>&nbsp;<span class="ident" id="1964758">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1964767">prevBreak</span>&nbsp;<span class="op" id="1964777">=</span>&nbsp;<span class="num" id="1964779">0</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1964782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1964786">//&nbsp;initialize&nbsp;expression/key&nbsp;size:&nbsp;a&nbsp;zero&nbsp;value&nbsp;indicates&nbsp;expr/key&nbsp;doesn&#39;t&nbsp;fit&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1964883">size</span>&nbsp;<span class="op" id="1964888">:=</span>&nbsp;<span class="num" id="1964891">0</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1964895">//&nbsp;print&nbsp;all&nbsp;list&nbsp;elements</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1964923">prevLine</span>&nbsp;<span class="op" id="1964932">:=</span>&nbsp;<span class="ident" id="1964935">prev</span><span class="op" id="1964939">.</span><span class="ident" id="1964940">Line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1964946">for</span>&nbsp;<span class="ident" id="1964950">i</span><span class="op" id="1964951">,</span>&nbsp;<span class="ident" id="1964953">x</span>&nbsp;<span class="op" id="1964955">:=</span>&nbsp;<span class="keyword" id="1964958">range</span>&nbsp;<span class="ident" id="1964964">list</span>&nbsp;<span class="op" id="1964969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1964973">line</span>&nbsp;<span class="op" id="1964978">=</span>&nbsp;<span class="ident" id="1964980">p</span><span class="op" id="1964981">.</span><span class="ident" id="1964982">lineFor</span><span class="op" id="1964989">(</span><span class="ident" id="1964990">x</span><span class="op" id="1964991">.</span><span class="ident" id="1964992">Pos</span><span class="op" id="1964995">(</span><span class="op" id="1964996">)</span><span class="op" id="1964997">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965002">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;next&nbsp;linebreak,&nbsp;if&nbsp;any,&nbsp;needs&nbsp;to&nbsp;use&nbsp;formfeed:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965071">//&nbsp;in&nbsp;general,&nbsp;use&nbsp;the&nbsp;entire&nbsp;node&nbsp;size&nbsp;to&nbsp;make&nbsp;the&nbsp;decision;&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965139">//&nbsp;key:value&nbsp;expressions,&nbsp;use&nbsp;the&nbsp;key&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965184">//&nbsp;TODO(gri)&nbsp;for&nbsp;a&nbsp;better&nbsp;result,&nbsp;should&nbsp;probably&nbsp;incorporate&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965253">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;key&nbsp;and&nbsp;the&nbsp;node&nbsp;size&nbsp;into&nbsp;the&nbsp;decision&nbsp;process</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965320">useFF</span>&nbsp;<span class="op" id="1965326">:=</span>&nbsp;<span class="builtintype" id="1965329">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965337">//&nbsp;determine&nbsp;element&nbsp;size:&nbsp;all&nbsp;bets&nbsp;are&nbsp;off&nbsp;if&nbsp;we&nbsp;don&#39;t&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965400">//&nbsp;position&nbsp;information&nbsp;for&nbsp;the&nbsp;previous&nbsp;and&nbsp;next&nbsp;token&nbsp;(likely</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965466">//&nbsp;generated&nbsp;code&nbsp;-&nbsp;simply&nbsp;ignore&nbsp;the&nbsp;size&nbsp;in&nbsp;this&nbsp;case&nbsp;by&nbsp;setting</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965535">//&nbsp;it&nbsp;to&nbsp;0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965549">prevSize</span>&nbsp;<span class="op" id="1965558">:=</span>&nbsp;<span class="ident" id="1965561">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965568">const</span>&nbsp;<span class="ident" id="1965574">infinity</span>&nbsp;<span class="op" id="1965583">=</span>&nbsp;<span class="num" id="1965585">1e6</span>&nbsp;<span class="comment" id="1965589">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;source&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965622">size</span>&nbsp;<span class="op" id="1965627">=</span>&nbsp;<span class="ident" id="1965629">p</span><span class="op" id="1965630">.</span><span class="ident" id="1965631">nodeSize</span><span class="op" id="1965639">(</span><span class="ident" id="1965640">x</span><span class="op" id="1965641">,</span>&nbsp;<span class="ident" id="1965643">infinity</span><span class="op" id="1965651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965655">pair</span><span class="op" id="1965659">,</span>&nbsp;<span class="ident" id="1965661">isPair</span>&nbsp;<span class="op" id="1965668">:=</span>&nbsp;<span class="ident" id="1965671">x</span><span class="op" id="1965672">.</span><span class="op" id="1965673">(</span><span class="op" id="1965674">*</span><span class="ident" id="1965675">ast</span><span class="op" id="1965678">.</span><span class="ident" id="1965679">KeyValueExpr</span><span class="op" id="1965691">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965695">if</span>&nbsp;<span class="ident" id="1965698">size</span>&nbsp;<span class="op" id="1965703">&lt;=</span>&nbsp;<span class="ident" id="1965706">infinity</span>&nbsp;<span class="op" id="1965715">&amp;&amp;</span>&nbsp;<span class="ident" id="1965718">prev</span><span class="op" id="1965722">.</span><span class="ident" id="1965723">IsValid</span><span class="op" id="1965730">(</span><span class="op" id="1965731">)</span>&nbsp;<span class="op" id="1965733">&amp;&amp;</span>&nbsp;<span class="ident" id="1965736">next</span><span class="op" id="1965740">.</span><span class="ident" id="1965741">IsValid</span><span class="op" id="1965748">(</span><span class="op" id="1965749">)</span>&nbsp;<span class="op" id="1965751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965756">//&nbsp;x&nbsp;fits&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965786">if</span>&nbsp;<span class="ident" id="1965789">isPair</span>&nbsp;<span class="op" id="1965796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965802">size</span>&nbsp;<span class="op" id="1965807">=</span>&nbsp;<span class="ident" id="1965809">p</span><span class="op" id="1965810">.</span><span class="ident" id="1965811">nodeSize</span><span class="op" id="1965819">(</span><span class="ident" id="1965820">pair</span><span class="op" id="1965824">.</span><span class="ident" id="1965825">Key</span><span class="op" id="1965828">,</span>&nbsp;<span class="ident" id="1965830">infinity</span><span class="op" id="1965838">)</span>&nbsp;<span class="comment" id="1965840">//&nbsp;size&nbsp;&lt;=&nbsp;infinity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965863">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965867">}</span>&nbsp;<span class="keyword" id="1965869">else</span>&nbsp;<span class="op" id="1965874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965879">//&nbsp;size&nbsp;too&nbsp;large&nbsp;or&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;good&nbsp;layout&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965941">size</span>&nbsp;<span class="op" id="1965946">=</span>&nbsp;<span class="num" id="1965948">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965957">//&nbsp;if&nbsp;the&nbsp;previous&nbsp;line&nbsp;and&nbsp;the&nbsp;current&nbsp;line&nbsp;had&nbsp;single-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1966016">//&nbsp;line-expressions&nbsp;and&nbsp;the&nbsp;key&nbsp;sizes&nbsp;are&nbsp;small&nbsp;or&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1966073">//&nbsp;the&nbsp;ratio&nbsp;between&nbsp;the&nbsp;key&nbsp;sizes&nbsp;does&nbsp;not&nbsp;exceed&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1966128">//&nbsp;threshold,&nbsp;align&nbsp;columns&nbsp;and&nbsp;do&nbsp;not&nbsp;use&nbsp;formfeed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966182">if</span>&nbsp;<span class="ident" id="1966185">prevSize</span>&nbsp;<span class="op" id="1966194">&gt;</span>&nbsp;<span class="num" id="1966196">0</span>&nbsp;<span class="op" id="1966198">&amp;&amp;</span>&nbsp;<span class="ident" id="1966201">size</span>&nbsp;<span class="op" id="1966206">&gt;</span>&nbsp;<span class="num" id="1966208">0</span>&nbsp;<span class="op" id="1966210">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966215">const</span>&nbsp;<span class="ident" id="1966221">smallSize</span>&nbsp;<span class="op" id="1966231">=</span>&nbsp;<span class="num" id="1966233">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966239">if</span>&nbsp;<span class="ident" id="1966242">prevSize</span>&nbsp;<span class="op" id="1966251">&lt;=</span>&nbsp;<span class="ident" id="1966254">smallSize</span>&nbsp;<span class="op" id="1966264">&amp;&amp;</span>&nbsp;<span class="ident" id="1966267">size</span>&nbsp;<span class="op" id="1966272">&lt;=</span>&nbsp;<span class="ident" id="1966275">smallSize</span>&nbsp;<span class="op" id="1966285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966291">useFF</span>&nbsp;<span class="op" id="1966297">=</span>&nbsp;<span class="builtintype" id="1966299">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1966308">}</span>&nbsp;<span class="keyword" id="1966310">else</span>&nbsp;<span class="op" id="1966315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966321">const</span>&nbsp;<span class="ident" id="1966327">r</span>&nbsp;<span class="op" id="1966329">=</span>&nbsp;<span class="num" id="1966331">4</span>&nbsp;<span class="comment" id="1966333">//&nbsp;threshold</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966350">ratio</span>&nbsp;<span class="op" id="1966356">:=</span>&nbsp;<span class="builtintype" id="1966359">float64</span><span class="op" id="1966366">(</span><span class="ident" id="1966367">size</span><span class="op" id="1966371">)</span>&nbsp;<span class="op" id="1966373">/</span>&nbsp;<span class="builtintype" id="1966375">float64</span><span class="op" id="1966382">(</span><span class="ident" id="1966383">prevSize</span><span class="op" id="1966391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966397">useFF</span>&nbsp;<span class="op" id="1966403">=</span>&nbsp;<span class="ident" id="1966405">ratio</span>&nbsp;<span class="op" id="1966411">&lt;=</span>&nbsp;<span class="num" id="1966414">1.0</span><span class="op" id="1966417">/</span><span class="ident" id="1966418">r</span>&nbsp;<span class="op" id="1966420">||</span>&nbsp;<span class="ident" id="1966423">r</span>&nbsp;<span class="op" id="1966425">&lt;=</span>&nbsp;<span class="ident" id="1966428">ratio</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1966437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1966441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966446">needsLinebreak</span>&nbsp;<span class="op" id="1966461">:=</span>&nbsp;<span class="num" id="1966464">0</span>&nbsp;<span class="op" id="1966466">&lt;</span>&nbsp;<span class="ident" id="1966468">prevLine</span>&nbsp;<span class="op" id="1966477">&amp;&amp;</span>&nbsp;<span class="ident" id="1966480">prevLine</span>&nbsp;<span class="op" id="1966489">&lt;</span>&nbsp;<span class="ident" id="1966491">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966498">if</span>&nbsp;<span class="ident" id="1966501">i</span>&nbsp;<span class="op" id="1966503">&gt;</span>&nbsp;<span class="num" id="1966505">0</span>&nbsp;<span class="op" id="1966507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1966512">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1966568">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1966624">//&nbsp;only&nbsp;if&nbsp;the&nbsp;expression&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966673">if</span>&nbsp;<span class="op" id="1966676">!</span><span class="ident" id="1966677">needsLinebreak</span>&nbsp;<span class="op" id="1966692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966698">p</span><span class="op" id="1966699">.</span><span class="builtinfunc" id="1966700">print</span><span class="op" id="1966705">(</span><span class="ident" id="1966706">x</span><span class="op" id="1966707">.</span><span class="ident" id="1966708">Pos</span><span class="op" id="1966711">(</span><span class="op" id="1966712">)</span><span class="op" id="1966713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1966718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966723">p</span><span class="op" id="1966724">.</span><span class="builtinfunc" id="1966725">print</span><span class="op" id="1966730">(</span><span class="ident" id="1966731">token</span><span class="op" id="1966736">.</span><span class="ident" id="1966737">COMMA</span><span class="op" id="1966742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1966747">needsBlank</span>&nbsp;<span class="op" id="1966758">:=</span>&nbsp;<span class="builtintype" id="1966761">true</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966769">if</span>&nbsp;<span class="ident" id="1966772">needsLinebreak</span>&nbsp;<span class="op" id="1966787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1966793">//&nbsp;lines&nbsp;are&nbsp;broken&nbsp;using&nbsp;newlines&nbsp;so&nbsp;comments&nbsp;remain&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1966859">//&nbsp;unless&nbsp;forceFF&nbsp;is&nbsp;set&nbsp;or&nbsp;there&nbsp;are&nbsp;multiple&nbsp;expressions&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1966925">//&nbsp;the&nbsp;same&nbsp;line&nbsp;in&nbsp;which&nbsp;case&nbsp;formfeed&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1966977">if</span>&nbsp;<span class="ident" id="1966980">p</span><span class="op" id="1966981">.</span><span class="ident" id="1966982">linebreak</span><span class="op" id="1966991">(</span><span class="ident" id="1966992">line</span><span class="op" id="1966996">,</span>&nbsp;<span class="num" id="1966998">0</span><span class="op" id="1966999">,</span>&nbsp;<span class="ident" id="1967001">ws</span><span class="op" id="1967003">,</span>&nbsp;<span class="ident" id="1967005">useFF</span>&nbsp;<span class="op" id="1967011">||</span>&nbsp;<span class="ident" id="1967014">prevBreak</span><span class="op" id="1967023">+</span><span class="num" id="1967024">1</span>&nbsp;<span class="op" id="1967026">&lt;</span>&nbsp;<span class="ident" id="1967028">i</span><span class="op" id="1967029">)</span>&nbsp;<span class="op" id="1967031">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967038">ws</span>&nbsp;<span class="op" id="1967041">=</span>&nbsp;<span class="ident" id="1967043">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967055">prevBreak</span>&nbsp;<span class="op" id="1967065">=</span>&nbsp;<span class="ident" id="1967067">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967074">needsBlank</span>&nbsp;<span class="op" id="1967085">=</span>&nbsp;<span class="builtintype" id="1967087">false</span>&nbsp;<span class="comment" id="1967093">//&nbsp;we&nbsp;got&nbsp;a&nbsp;line&nbsp;break&nbsp;instead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967133">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967138">if</span>&nbsp;<span class="ident" id="1967141">needsBlank</span>&nbsp;<span class="op" id="1967152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967158">p</span><span class="op" id="1967159">.</span><span class="builtinfunc" id="1967160">print</span><span class="op" id="1967165">(</span><span class="ident" id="1967166">blank</span><span class="op" id="1967171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967185">if</span>&nbsp;<span class="builtinfunc" id="1967188">len</span><span class="op" id="1967191">(</span><span class="ident" id="1967192">list</span><span class="op" id="1967196">)</span>&nbsp;<span class="op" id="1967198">&gt;</span>&nbsp;<span class="num" id="1967200">1</span>&nbsp;<span class="op" id="1967202">&amp;&amp;</span>&nbsp;<span class="ident" id="1967205">isPair</span>&nbsp;<span class="op" id="1967212">&amp;&amp;</span>&nbsp;<span class="ident" id="1967215">size</span>&nbsp;<span class="op" id="1967220">&gt;</span>&nbsp;<span class="num" id="1967222">0</span>&nbsp;<span class="op" id="1967224">&amp;&amp;</span>&nbsp;<span class="ident" id="1967227">needsLinebreak</span>&nbsp;<span class="op" id="1967242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1967247">//&nbsp;we&nbsp;have&nbsp;a&nbsp;key:value&nbsp;expression&nbsp;that&nbsp;fits&nbsp;onto&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1967308">//&nbsp;and&nbsp;it&#39;s&nbsp;not&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;prior&nbsp;expression:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1967369">//&nbsp;use&nbsp;a&nbsp;column&nbsp;for&nbsp;the&nbsp;key&nbsp;such&nbsp;that&nbsp;consecutive&nbsp;entries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1967430">//&nbsp;can&nbsp;align&nbsp;if&nbsp;possible</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1967458">//&nbsp;(needsLinebreak&nbsp;is&nbsp;set&nbsp;if&nbsp;we&nbsp;started&nbsp;a&nbsp;new&nbsp;line&nbsp;before)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967520">p</span><span class="op" id="1967521">.</span><span class="ident" id="1967522">expr</span><span class="op" id="1967526">(</span><span class="ident" id="1967527">pair</span><span class="op" id="1967531">.</span><span class="ident" id="1967532">Key</span><span class="op" id="1967535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967540">p</span><span class="op" id="1967541">.</span><span class="builtinfunc" id="1967542">print</span><span class="op" id="1967547">(</span><span class="ident" id="1967548">pair</span><span class="op" id="1967552">.</span><span class="ident" id="1967553">Colon</span><span class="op" id="1967558">,</span>&nbsp;<span class="ident" id="1967560">token</span><span class="op" id="1967565">.</span><span class="ident" id="1967566">COLON</span><span class="op" id="1967571">,</span>&nbsp;<span class="ident" id="1967573">vtab</span><span class="op" id="1967577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967582">p</span><span class="op" id="1967583">.</span><span class="ident" id="1967584">expr</span><span class="op" id="1967588">(</span><span class="ident" id="1967589">pair</span><span class="op" id="1967593">.</span><span class="ident" id="1967594">Value</span><span class="op" id="1967599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967603">}</span>&nbsp;<span class="keyword" id="1967605">else</span>&nbsp;<span class="op" id="1967610">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967615">p</span><span class="op" id="1967616">.</span><span class="ident" id="1967617">expr0</span><span class="op" id="1967622">(</span><span class="ident" id="1967623">x</span><span class="op" id="1967624">,</span>&nbsp;<span class="ident" id="1967626">depth</span><span class="op" id="1967631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967640">prevLine</span>&nbsp;<span class="op" id="1967649">=</span>&nbsp;<span class="ident" id="1967651">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967657">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967661">if</span>&nbsp;<span class="ident" id="1967664">mode</span><span class="op" id="1967668">&amp;</span><span class="ident" id="1967669">commaTerm</span>&nbsp;<span class="op" id="1967679">!=</span>&nbsp;<span class="num" id="1967682">0</span>&nbsp;<span class="op" id="1967684">&amp;&amp;</span>&nbsp;<span class="ident" id="1967687">next</span><span class="op" id="1967691">.</span><span class="ident" id="1967692">IsValid</span><span class="op" id="1967699">(</span><span class="op" id="1967700">)</span>&nbsp;<span class="op" id="1967702">&amp;&amp;</span>&nbsp;<span class="ident" id="1967705">p</span><span class="op" id="1967706">.</span><span class="ident" id="1967707">pos</span><span class="op" id="1967710">.</span><span class="ident" id="1967711">Line</span>&nbsp;<span class="op" id="1967716">&lt;</span>&nbsp;<span class="ident" id="1967718">next</span><span class="op" id="1967722">.</span><span class="ident" id="1967723">Line</span>&nbsp;<span class="op" id="1967728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1967732">//&nbsp;print&nbsp;a&nbsp;terminating&nbsp;comma&nbsp;if&nbsp;the&nbsp;next&nbsp;token&nbsp;is&nbsp;on&nbsp;a&nbsp;new&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967798">p</span><span class="op" id="1967799">.</span><span class="builtinfunc" id="1967800">print</span><span class="op" id="1967805">(</span><span class="ident" id="1967806">token</span><span class="op" id="1967811">.</span><span class="ident" id="1967812">COMMA</span><span class="op" id="1967817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967821">if</span>&nbsp;<span class="ident" id="1967824">ws</span>&nbsp;<span class="op" id="1967827">==</span>&nbsp;<span class="ident" id="1967830">ignore</span>&nbsp;<span class="op" id="1967837">&amp;&amp;</span>&nbsp;<span class="ident" id="1967840">mode</span><span class="op" id="1967844">&amp;</span><span class="ident" id="1967845">noIndent</span>&nbsp;<span class="op" id="1967854">==</span>&nbsp;<span class="num" id="1967857">0</span>&nbsp;<span class="op" id="1967859">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1967864">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967894">p</span><span class="op" id="1967895">.</span><span class="builtinfunc" id="1967896">print</span><span class="op" id="1967901">(</span><span class="ident" id="1967902">unindent</span><span class="op" id="1967910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1967918">p</span><span class="op" id="1967919">.</span><span class="builtinfunc" id="1967920">print</span><span class="op" id="1967925">(</span><span class="ident" id="1967926">formfeed</span><span class="op" id="1967934">)</span>&nbsp;<span class="comment" id="1967936">//&nbsp;terminating&nbsp;comma&nbsp;needs&nbsp;a&nbsp;line&nbsp;break&nbsp;to&nbsp;look&nbsp;good</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1967991">return</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1967999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968003">if</span>&nbsp;<span class="ident" id="1968006">ws</span>&nbsp;<span class="op" id="1968009">==</span>&nbsp;<span class="ident" id="1968012">ignore</span>&nbsp;<span class="op" id="1968019">&amp;&amp;</span>&nbsp;<span class="ident" id="1968022">mode</span><span class="op" id="1968026">&amp;</span><span class="ident" id="1968027">noIndent</span>&nbsp;<span class="op" id="1968036">==</span>&nbsp;<span class="num" id="1968039">0</span>&nbsp;<span class="op" id="1968041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1968045">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968074">p</span><span class="op" id="1968075">.</span><span class="builtinfunc" id="1968076">print</span><span class="op" id="1968081">(</span><span class="ident" id="1968082">unindent</span><span class="op" id="1968090">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1968093">}</span><br>
<span class="lineno"></span><span class="op" id="1968095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1968098">func</span>&nbsp;<span class="op" id="1968103">(</span><span class="ident" id="1968104">p</span>&nbsp;<span class="op" id="1968106">*</span><span class="ident" id="1968107">printer</span><span class="op" id="1968114">)</span>&nbsp;<span class="ident" id="1968116">parameters</span><span class="op" id="1968126">(</span><span class="ident" id="1968127">fields</span>&nbsp;<span class="op" id="1968134">*</span><span class="ident" id="1968135">ast</span><span class="op" id="1968138">.</span><span class="ident" id="1968139">FieldList</span><span class="op" id="1968148">)</span>&nbsp;<span class="op" id="1968150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968153">p</span><span class="op" id="1968154">.</span><span class="builtinfunc" id="1968155">print</span><span class="op" id="1968160">(</span><span class="ident" id="1968161">fields</span><span class="op" id="1968167">.</span><span class="ident" id="1968168">Opening</span><span class="op" id="1968175">,</span>&nbsp;<span class="ident" id="1968177">token</span><span class="op" id="1968182">.</span><span class="ident" id="1968183">LPAREN</span><span class="op" id="1968189">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968192">if</span>&nbsp;<span class="builtinfunc" id="1968195">len</span><span class="op" id="1968198">(</span><span class="ident" id="1968199">fields</span><span class="op" id="1968205">.</span><span class="ident" id="1968206">List</span><span class="op" id="1968210">)</span>&nbsp;<span class="op" id="1968212">&gt;</span>&nbsp;<span class="num" id="1968214">0</span>&nbsp;<span class="op" id="1968216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968220">prevLine</span>&nbsp;<span class="op" id="1968229">:=</span>&nbsp;<span class="ident" id="1968232">p</span><span class="op" id="1968233">.</span><span class="ident" id="1968234">lineFor</span><span class="op" id="1968241">(</span><span class="ident" id="1968242">fields</span><span class="op" id="1968248">.</span><span class="ident" id="1968249">Opening</span><span class="op" id="1968256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968260">ws</span>&nbsp;<span class="op" id="1968263">:=</span>&nbsp;<span class="ident" id="1968266">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968275">for</span>&nbsp;<span class="ident" id="1968279">i</span><span class="op" id="1968280">,</span>&nbsp;<span class="ident" id="1968282">par</span>&nbsp;<span class="op" id="1968286">:=</span>&nbsp;<span class="keyword" id="1968289">range</span>&nbsp;<span class="ident" id="1968295">fields</span><span class="op" id="1968301">.</span><span class="ident" id="1968302">List</span>&nbsp;<span class="op" id="1968307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1968312">//&nbsp;determine&nbsp;par&nbsp;begin&nbsp;and&nbsp;end&nbsp;line&nbsp;(may&nbsp;be&nbsp;different</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1968369">//&nbsp;if&nbsp;there&nbsp;are&nbsp;multiple&nbsp;parameter&nbsp;names&nbsp;for&nbsp;this&nbsp;par</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1968426">//&nbsp;or&nbsp;the&nbsp;type&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968467">var</span>&nbsp;<span class="ident" id="1968471">parLineBeg</span>&nbsp;<span class="builtintype" id="1968482">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968489">if</span>&nbsp;<span class="builtinfunc" id="1968492">len</span><span class="op" id="1968495">(</span><span class="ident" id="1968496">par</span><span class="op" id="1968499">.</span><span class="ident" id="1968500">Names</span><span class="op" id="1968505">)</span>&nbsp;<span class="op" id="1968507">&gt;</span>&nbsp;<span class="num" id="1968509">0</span>&nbsp;<span class="op" id="1968511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968517">parLineBeg</span>&nbsp;<span class="op" id="1968528">=</span>&nbsp;<span class="ident" id="1968530">p</span><span class="op" id="1968531">.</span><span class="ident" id="1968532">lineFor</span><span class="op" id="1968539">(</span><span class="ident" id="1968540">par</span><span class="op" id="1968543">.</span><span class="ident" id="1968544">Names</span><span class="op" id="1968549">[</span><span class="num" id="1968550">0</span><span class="op" id="1968551">]</span><span class="op" id="1968552">.</span><span class="ident" id="1968553">Pos</span><span class="op" id="1968556">(</span><span class="op" id="1968557">)</span><span class="op" id="1968558">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1968563">}</span>&nbsp;<span class="keyword" id="1968565">else</span>&nbsp;<span class="op" id="1968570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968576">parLineBeg</span>&nbsp;<span class="op" id="1968587">=</span>&nbsp;<span class="ident" id="1968589">p</span><span class="op" id="1968590">.</span><span class="ident" id="1968591">lineFor</span><span class="op" id="1968598">(</span><span class="ident" id="1968599">par</span><span class="op" id="1968602">.</span><span class="ident" id="1968603">Type</span><span class="op" id="1968607">.</span><span class="ident" id="1968608">Pos</span><span class="op" id="1968611">(</span><span class="op" id="1968612">)</span><span class="op" id="1968613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1968618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968623">var</span>&nbsp;<span class="ident" id="1968627">parLineEnd</span>&nbsp;<span class="op" id="1968638">=</span>&nbsp;<span class="ident" id="1968640">p</span><span class="op" id="1968641">.</span><span class="ident" id="1968642">lineFor</span><span class="op" id="1968649">(</span><span class="ident" id="1968650">par</span><span class="op" id="1968653">.</span><span class="ident" id="1968654">Type</span><span class="op" id="1968658">.</span><span class="ident" id="1968659">End</span><span class="op" id="1968662">(</span><span class="op" id="1968663">)</span><span class="op" id="1968664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1968669">//&nbsp;separating&nbsp;&#34;,&#34;&nbsp;if&nbsp;needed</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968700">needsLinebreak</span>&nbsp;<span class="op" id="1968715">:=</span>&nbsp;<span class="num" id="1968718">0</span>&nbsp;<span class="op" id="1968720">&lt;</span>&nbsp;<span class="ident" id="1968722">prevLine</span>&nbsp;<span class="op" id="1968731">&amp;&amp;</span>&nbsp;<span class="ident" id="1968734">prevLine</span>&nbsp;<span class="op" id="1968743">&lt;</span>&nbsp;<span class="ident" id="1968745">parLineBeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968759">if</span>&nbsp;<span class="ident" id="1968762">i</span>&nbsp;<span class="op" id="1968764">&gt;</span>&nbsp;<span class="num" id="1968766">0</span>&nbsp;<span class="op" id="1968768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1968774">//&nbsp;use&nbsp;position&nbsp;of&nbsp;parameter&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1968830">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comma&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1968885">//&nbsp;only&nbsp;if&nbsp;the&nbsp;next&nbsp;parameter&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1968939">if</span>&nbsp;<span class="op" id="1968942">!</span><span class="ident" id="1968943">needsLinebreak</span>&nbsp;<span class="op" id="1968958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968965">p</span><span class="op" id="1968966">.</span><span class="builtinfunc" id="1968967">print</span><span class="op" id="1968972">(</span><span class="ident" id="1968973">par</span><span class="op" id="1968976">.</span><span class="ident" id="1968977">Pos</span><span class="op" id="1968980">(</span><span class="op" id="1968981">)</span><span class="op" id="1968982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1968988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1968994">p</span><span class="op" id="1968995">.</span><span class="builtinfunc" id="1968996">print</span><span class="op" id="1969001">(</span><span class="ident" id="1969002">token</span><span class="op" id="1969007">.</span><span class="ident" id="1969008">COMMA</span><span class="op" id="1969013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1969018">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969023">//&nbsp;separator&nbsp;if&nbsp;needed&nbsp;(linebreak&nbsp;or&nbsp;blank)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1969070">if</span>&nbsp;<span class="ident" id="1969073">needsLinebreak</span>&nbsp;<span class="op" id="1969088">&amp;&amp;</span>&nbsp;<span class="ident" id="1969091">p</span><span class="op" id="1969092">.</span><span class="ident" id="1969093">linebreak</span><span class="op" id="1969102">(</span><span class="ident" id="1969103">parLineBeg</span><span class="op" id="1969113">,</span>&nbsp;<span class="num" id="1969115">0</span><span class="op" id="1969116">,</span>&nbsp;<span class="ident" id="1969118">ws</span><span class="op" id="1969120">,</span>&nbsp;<span class="builtintype" id="1969122">true</span><span class="op" id="1969126">)</span>&nbsp;<span class="op" id="1969128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969134">//&nbsp;break&nbsp;line&nbsp;if&nbsp;the&nbsp;opening&nbsp;&#34;(&#34;&nbsp;or&nbsp;previous&nbsp;parameter&nbsp;ended&nbsp;on&nbsp;a&nbsp;different&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969219">ws</span>&nbsp;<span class="op" id="1969222">=</span>&nbsp;<span class="ident" id="1969224">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1969234">}</span>&nbsp;<span class="keyword" id="1969236">else</span>&nbsp;<span class="keyword" id="1969241">if</span>&nbsp;<span class="ident" id="1969244">i</span>&nbsp;<span class="op" id="1969246">&gt;</span>&nbsp;<span class="num" id="1969248">0</span>&nbsp;<span class="op" id="1969250">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969256">p</span><span class="op" id="1969257">.</span><span class="builtinfunc" id="1969258">print</span><span class="op" id="1969263">(</span><span class="ident" id="1969264">blank</span><span class="op" id="1969269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1969274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969279">//&nbsp;parameter&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1969301">if</span>&nbsp;<span class="builtinfunc" id="1969304">len</span><span class="op" id="1969307">(</span><span class="ident" id="1969308">par</span><span class="op" id="1969311">.</span><span class="ident" id="1969312">Names</span><span class="op" id="1969317">)</span>&nbsp;<span class="op" id="1969319">&gt;</span>&nbsp;<span class="num" id="1969321">0</span>&nbsp;<span class="op" id="1969323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969329">//&nbsp;Very&nbsp;subtle:&nbsp;If&nbsp;we&nbsp;indented&nbsp;before&nbsp;(ws&nbsp;==&nbsp;ignore),&nbsp;identList</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969397">//&nbsp;won&#39;t&nbsp;indent&nbsp;again.&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;(ws&nbsp;==&nbsp;indent),&nbsp;identList&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969468">//&nbsp;indent&nbsp;if&nbsp;the&nbsp;identList&nbsp;spans&nbsp;multiple&nbsp;lines,&nbsp;and&nbsp;it&nbsp;will&nbsp;outdent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969541">//&nbsp;again&nbsp;at&nbsp;the&nbsp;end&nbsp;(and&nbsp;still&nbsp;ws&nbsp;==&nbsp;indent).&nbsp;Thus,&nbsp;a&nbsp;subsequent&nbsp;indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969617">//&nbsp;by&nbsp;a&nbsp;linebreak&nbsp;call&nbsp;after&nbsp;a&nbsp;type,&nbsp;or&nbsp;in&nbsp;the&nbsp;next&nbsp;multi-line&nbsp;identList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969694">//&nbsp;will&nbsp;do&nbsp;the&nbsp;right&nbsp;thing.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969726">p</span><span class="op" id="1969727">.</span><span class="ident" id="1969728">identList</span><span class="op" id="1969737">(</span><span class="ident" id="1969738">par</span><span class="op" id="1969741">.</span><span class="ident" id="1969742">Names</span><span class="op" id="1969747">,</span>&nbsp;<span class="ident" id="1969749">ws</span>&nbsp;<span class="op" id="1969752">==</span>&nbsp;<span class="ident" id="1969755">indent</span><span class="op" id="1969761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969767">p</span><span class="op" id="1969768">.</span><span class="builtinfunc" id="1969769">print</span><span class="op" id="1969774">(</span><span class="ident" id="1969775">blank</span><span class="op" id="1969780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1969785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969790">//&nbsp;parameter&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969811">p</span><span class="op" id="1969812">.</span><span class="ident" id="1969813">expr</span><span class="op" id="1969817">(</span><span class="ident" id="1969818">stripParensAlways</span><span class="op" id="1969835">(</span><span class="ident" id="1969836">par</span><span class="op" id="1969839">.</span><span class="ident" id="1969840">Type</span><span class="op" id="1969844">)</span><span class="op" id="1969845">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1969850">prevLine</span>&nbsp;<span class="op" id="1969859">=</span>&nbsp;<span class="ident" id="1969861">parLineEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1969874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969878">//&nbsp;if&nbsp;the&nbsp;closing&nbsp;&#34;)&#34;&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line&nbsp;from&nbsp;the&nbsp;last&nbsp;parameter,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1969949">//&nbsp;print&nbsp;an&nbsp;additional&nbsp;&#34;,&#34;&nbsp;and&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1969993">if</span>&nbsp;<span class="ident" id="1969996">closing</span>&nbsp;<span class="op" id="1970004">:=</span>&nbsp;<span class="ident" id="1970007">p</span><span class="op" id="1970008">.</span><span class="ident" id="1970009">lineFor</span><span class="op" id="1970016">(</span><span class="ident" id="1970017">fields</span><span class="op" id="1970023">.</span><span class="ident" id="1970024">Closing</span><span class="op" id="1970031">)</span><span class="op" id="1970032">;</span>&nbsp;<span class="num" id="1970034">0</span>&nbsp;<span class="op" id="1970036">&lt;</span>&nbsp;<span class="ident" id="1970038">prevLine</span>&nbsp;<span class="op" id="1970047">&amp;&amp;</span>&nbsp;<span class="ident" id="1970050">prevLine</span>&nbsp;<span class="op" id="1970059">&lt;</span>&nbsp;<span class="ident" id="1970061">closing</span>&nbsp;<span class="op" id="1970069">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1970074">p</span><span class="op" id="1970075">.</span><span class="builtinfunc" id="1970076">print</span><span class="op" id="1970081">(</span><span class="ident" id="1970082">token</span><span class="op" id="1970087">.</span><span class="ident" id="1970088">COMMA</span><span class="op" id="1970093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1970098">p</span><span class="op" id="1970099">.</span><span class="ident" id="1970100">linebreak</span><span class="op" id="1970109">(</span><span class="ident" id="1970110">closing</span><span class="op" id="1970117">,</span>&nbsp;<span class="num" id="1970119">0</span><span class="op" id="1970120">,</span>&nbsp;<span class="ident" id="1970122">ignore</span><span class="op" id="1970128">,</span>&nbsp;<span class="builtintype" id="1970130">true</span><span class="op" id="1970134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1970138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1970142">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970171">if</span>&nbsp;<span class="ident" id="1970174">ws</span>&nbsp;<span class="op" id="1970177">==</span>&nbsp;<span class="ident" id="1970180">ignore</span>&nbsp;<span class="op" id="1970187">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1970192">p</span><span class="op" id="1970193">.</span><span class="builtinfunc" id="1970194">print</span><span class="op" id="1970199">(</span><span class="ident" id="1970200">unindent</span><span class="op" id="1970208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1970212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1970215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1970218">p</span><span class="op" id="1970219">.</span><span class="builtinfunc" id="1970220">print</span><span class="op" id="1970225">(</span><span class="ident" id="1970226">fields</span><span class="op" id="1970232">.</span><span class="ident" id="1970233">Closing</span><span class="op" id="1970240">,</span>&nbsp;<span class="ident" id="1970242">token</span><span class="op" id="1970247">.</span><span class="ident" id="1970248">RPAREN</span><span class="op" id="1970254">)</span><br>
<span class="lineno"></span><span class="op" id="1970256">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="1970259">func</span>&nbsp;<span class="op" id="1970264">(</span><span class="ident" id="1970265">p</span>&nbsp;<span class="op" id="1970267">*</span><span class="ident" id="1970268">printer</span><span class="op" id="1970275">)</span>&nbsp;<span class="ident" id="1970277">signature</span><span class="op" id="1970286">(</span><span class="ident" id="1970287">params</span><span class="op" id="1970293">,</span>&nbsp;<span class="ident" id="1970295">result</span>&nbsp;<span class="op" id="1970302">*</span><span class="ident" id="1970303">ast</span><span class="op" id="1970306">.</span><span class="ident" id="1970307">FieldList</span><span class="op" id="1970316">)</span>&nbsp;<span class="op" id="1970318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970321">if</span>&nbsp;<span class="ident" id="1970324">params</span>&nbsp;<span class="op" id="1970331">!=</span>&nbsp;<span class="ident" id="1970334">nil</span>&nbsp;<span class="op" id="1970338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1970342">p</span><span class="op" id="1970343">.</span><span class="ident" id="1970344">parameters</span><span class="op" id="1970354">(</span><span class="ident" id="1970355">params</span><span class="op" id="1970361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1970364">}</span>&nbsp;<span class="keyword" id="1970366">else</span>&nbsp;<span class="op" id="1970371">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1970375">p</span><span class="op" id="1970376">.</span><span class="builtinfunc" id="1970377">print</span><span class="op" id="1970382">(</span><span class="ident" id="1970383">token</span><span class="op" id="1970388">.</span><span class="ident" id="1970389">LPAREN</span><span class="op" id="1970395">,</span>&nbsp;<span class="ident" id="1970397">token</span><span class="op" id="1970402">.</span><span class="ident" id="1970403">RPAREN</span><span class="op" id="1970409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1970412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1970415">n</span>&nbsp;<span class="op" id="1970417">:=</span>&nbsp;<span class="ident" id="1970420">result</span><span class="op" id="1970426">.</span><span class="ident" id="1970427">NumFields</span><span class="op" id="1970436">(</span><span class="op" id="1970437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970440">if</span>&nbsp;<span class="ident" id="1970443">n</span>&nbsp;<span class="op" id="1970445">&gt;</span>&nbsp;<span class="num" id="1970447">0</span>&nbsp;<span class="op" id="1970449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1970453">//&nbsp;result&nbsp;!=&nbsp;nil</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1970472">p</span><span class="op" id="1970473">.</span><span class="builtinfunc" id="1970474">print</span><span class="op" id="1970479">(</span><span class="ident" id="1970480">blank</span><span class="op" id="1970485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970489">if</span>&nbsp;<span class="ident" id="1970492">n</span>&nbsp;<span class="op" id="1970494">==</span>&nbsp;<span class="num" id="1970497">1</span>&nbsp;<span class="op" id="1970499">&amp;&amp;</span>&nbsp;<span class="ident" id="1970502">result</span><span class="op" id="1970508">.</span><span class="ident" id="1970509">List</span><span class="op" id="1970513">[</span><span class="num" id="1970514">0</span><span class="op" id="1970515">]</span><span class="op" id="1970516">.</span><span class="ident" id="1970517">Names</span>&nbsp;<span class="op" id="1970523">==</span>&nbsp;<span class="ident" id="1970526">nil</span>&nbsp;<span class="op" id="1970530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1970535">//&nbsp;single&nbsp;anonymous&nbsp;result;&nbsp;no&nbsp;()&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1970574">p</span><span class="op" id="1970575">.</span><span class="ident" id="1970576">expr</span><span class="op" id="1970580">(</span><span class="ident" id="1970581">stripParensAlways</span><span class="op" id="1970598">(</span><span class="ident" id="1970599">result</span><span class="op" id="1970605">.</span><span class="ident" id="1970606">List</span><span class="op" id="1970610">[</span><span class="num" id="1970611">0</span><span class="op" id="1970612">]</span><span class="op" id="1970613">.</span><span class="ident" id="1970614">Type</span><span class="op" id="1970618">)</span><span class="op" id="1970619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970624">return</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1970633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1970637">p</span><span class="op" id="1970638">.</span><span class="ident" id="1970639">parameters</span><span class="op" id="1970649">(</span><span class="ident" id="1970650">result</span><span class="op" id="1970656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1970659">}</span><br>
<span class="lineno"></span><span class="op" id="1970661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="1970664">func</span>&nbsp;<span class="ident" id="1970669">identListSize</span><span class="op" id="1970682">(</span><span class="ident" id="1970683">list</span>&nbsp;<span class="op" id="1970688">[</span><span class="op" id="1970689">]</span><span class="op" id="1970690">*</span><span class="ident" id="1970691">ast</span><span class="op" id="1970694">.</span><span class="ident" id="1970695">Ident</span><span class="op" id="1970700">,</span>&nbsp;<span class="ident" id="1970702">maxSize</span>&nbsp;<span class="builtintype" id="1970710">int</span><span class="op" id="1970713">)</span>&nbsp;<span class="op" id="1970715">(</span><span class="ident" id="1970716">size</span>&nbsp;<span class="builtintype" id="1970721">int</span><span class="op" id="1970724">)</span>&nbsp;<span class="op" id="1970726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970729">for</span>&nbsp;<span class="ident" id="1970733">i</span><span class="op" id="1970734">,</span>&nbsp;<span class="ident" id="1970736">x</span>&nbsp;<span class="op" id="1970738">:=</span>&nbsp;<span class="keyword" id="1970741">range</span>&nbsp;<span class="ident" id="1970747">list</span>&nbsp;<span class="op" id="1970752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970756">if</span>&nbsp;<span class="ident" id="1970759">i</span>&nbsp;<span class="op" id="1970761">&gt;</span>&nbsp;<span class="num" id="1970763">0</span>&nbsp;<span class="op" id="1970765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1970770">size</span>&nbsp;<span class="op" id="1970775">+=</span>&nbsp;<span class="builtinfunc" id="1970778">len</span><span class="op" id="1970781">(</span><span class="string" id="1970782">&#34;,&nbsp;&#34;</span><span class="op" id="1970786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1970790">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1970794">size</span>&nbsp;<span class="op" id="1970799">+=</span>&nbsp;<span class="ident" id="1970802">utf8</span><span class="op" id="1970806">.</span><span class="ident" id="1970807">RuneCountInString</span><span class="op" id="1970824">(</span><span class="ident" id="1970825">x</span><span class="op" id="1970826">.</span><span class="ident" id="1970827">Name</span><span class="op" id="1970831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970835">if</span>&nbsp;<span class="ident" id="1970838">size</span>&nbsp;<span class="op" id="1970843">&gt;=</span>&nbsp;<span class="ident" id="1970846">maxSize</span>&nbsp;<span class="op" id="1970854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970859">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1970867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1970870">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970873">return</span><br>
<span class="lineno"></span><span class="op" id="1970880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1970883">func</span>&nbsp;<span class="op" id="1970888">(</span><span class="ident" id="1970889">p</span>&nbsp;<span class="op" id="1970891">*</span><span class="ident" id="1970892">printer</span><span class="op" id="1970899">)</span>&nbsp;<span class="ident" id="1970901">isOneLineFieldList</span><span class="op" id="1970919">(</span><span class="ident" id="1970920">list</span>&nbsp;<span class="op" id="1970925">[</span><span class="op" id="1970926">]</span><span class="op" id="1970927">*</span><span class="ident" id="1970928">ast</span><span class="op" id="1970931">.</span><span class="ident" id="1970932">Field</span><span class="op" id="1970937">)</span>&nbsp;<span class="builtintype" id="1970939">bool</span>&nbsp;<span class="op" id="1970944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970947">if</span>&nbsp;<span class="builtinfunc" id="1970950">len</span><span class="op" id="1970953">(</span><span class="ident" id="1970954">list</span><span class="op" id="1970958">)</span>&nbsp;<span class="op" id="1970960">!=</span>&nbsp;<span class="num" id="1970963">1</span>&nbsp;<span class="op" id="1970965">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1970969">return</span>&nbsp;<span class="builtintype" id="1970976">false</span>&nbsp;<span class="comment" id="1970982">//&nbsp;allow&nbsp;only&nbsp;one&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1971007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1971010">f</span>&nbsp;<span class="op" id="1971012">:=</span>&nbsp;<span class="ident" id="1971015">list</span><span class="op" id="1971019">[</span><span class="num" id="1971020">0</span><span class="op" id="1971021">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971024">if</span>&nbsp;<span class="ident" id="1971027">f</span><span class="op" id="1971028">.</span><span class="ident" id="1971029">Tag</span>&nbsp;<span class="op" id="1971033">!=</span>&nbsp;<span class="ident" id="1971036">nil</span>&nbsp;<span class="op" id="1971040">||</span>&nbsp;<span class="ident" id="1971043">f</span><span class="op" id="1971044">.</span><span class="ident" id="1971045">Comment</span>&nbsp;<span class="op" id="1971053">!=</span>&nbsp;<span class="ident" id="1971056">nil</span>&nbsp;<span class="op" id="1971060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971064">return</span>&nbsp;<span class="builtintype" id="1971071">false</span>&nbsp;<span class="comment" id="1971077">//&nbsp;don&#39;t&nbsp;allow&nbsp;tags&nbsp;or&nbsp;comments</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1971110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1971113">//&nbsp;only&nbsp;name(s)&nbsp;and&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971139">const</span>&nbsp;<span class="ident" id="1971145">maxSize</span>&nbsp;<span class="op" id="1971153">=</span>&nbsp;<span class="num" id="1971155">30</span>&nbsp;<span class="comment" id="1971158">//&nbsp;adjust&nbsp;as&nbsp;appropriate,&nbsp;this&nbsp;is&nbsp;an&nbsp;approximate&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1971214">namesSize</span>&nbsp;<span class="op" id="1971224">:=</span>&nbsp;<span class="ident" id="1971227">identListSize</span><span class="op" id="1971240">(</span><span class="ident" id="1971241">f</span><span class="op" id="1971242">.</span><span class="ident" id="1971243">Names</span><span class="op" id="1971248">,</span>&nbsp;<span class="ident" id="1971250">maxSize</span><span class="op" id="1971257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971260">if</span>&nbsp;<span class="ident" id="1971263">namesSize</span>&nbsp;<span class="op" id="1971273">&gt;</span>&nbsp;<span class="num" id="1971275">0</span>&nbsp;<span class="op" id="1971277">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1971281">namesSize</span>&nbsp;<span class="op" id="1971291">=</span>&nbsp;<span class="num" id="1971293">1</span>&nbsp;<span class="comment" id="1971295">//&nbsp;blank&nbsp;between&nbsp;names&nbsp;and&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1971329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1971332">typeSize</span>&nbsp;<span class="op" id="1971341">:=</span>&nbsp;<span class="ident" id="1971344">p</span><span class="op" id="1971345">.</span><span class="ident" id="1971346">nodeSize</span><span class="op" id="1971354">(</span><span class="ident" id="1971355">f</span><span class="op" id="1971356">.</span><span class="ident" id="1971357">Type</span><span class="op" id="1971361">,</span>&nbsp;<span class="ident" id="1971363">maxSize</span><span class="op" id="1971370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971373">return</span>&nbsp;<span class="ident" id="1971380">namesSize</span><span class="op" id="1971389">+</span><span class="ident" id="1971390">typeSize</span>&nbsp;<span class="op" id="1971399">&lt;=</span>&nbsp;<span class="ident" id="1971402">maxSize</span><br>
<span class="lineno"></span><span class="op" id="1971410">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="keyword" id="1971413">func</span>&nbsp;<span class="op" id="1971418">(</span><span class="ident" id="1971419">p</span>&nbsp;<span class="op" id="1971421">*</span><span class="ident" id="1971422">printer</span><span class="op" id="1971429">)</span>&nbsp;<span class="ident" id="1971431">setLineComment</span><span class="op" id="1971445">(</span><span class="ident" id="1971446">text</span>&nbsp;<span class="builtintype" id="1971451">string</span><span class="op" id="1971457">)</span>&nbsp;<span class="op" id="1971459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1971462">p</span><span class="op" id="1971463">.</span><span class="ident" id="1971464">setComment</span><span class="op" id="1971474">(</span><span class="op" id="1971475">&amp;</span><span class="ident" id="1971476">ast</span><span class="op" id="1971479">.</span><span class="ident" id="1971480">CommentGroup</span><span class="op" id="1971492">{</span><span class="ident" id="1971493">List</span><span class="op" id="1971497">:</span>&nbsp;<span class="op" id="1971499">[</span><span class="op" id="1971500">]</span><span class="op" id="1971501">*</span><span class="ident" id="1971502">ast</span><span class="op" id="1971505">.</span><span class="ident" id="1971506">Comment</span><span class="op" id="1971513">{</span><span class="op" id="1971514">{</span><span class="ident" id="1971515">Slash</span><span class="op" id="1971520">:</span>&nbsp;<span class="ident" id="1971522">token</span><span class="op" id="1971527">.</span><span class="ident" id="1971528">NoPos</span><span class="op" id="1971533">,</span>&nbsp;<span class="ident" id="1971535">Text</span><span class="op" id="1971539">:</span>&nbsp;<span class="ident" id="1971541">text</span><span class="op" id="1971545">}</span><span class="op" id="1971546">}</span><span class="op" id="1971547">}</span><span class="op" id="1971548">)</span><br>
<span class="lineno"></span><span class="op" id="1971550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="1971553">func</span>&nbsp;<span class="op" id="1971558">(</span><span class="ident" id="1971559">p</span>&nbsp;<span class="op" id="1971561">*</span><span class="ident" id="1971562">printer</span><span class="op" id="1971569">)</span>&nbsp;<span class="ident" id="1971571">fieldList</span><span class="op" id="1971580">(</span><span class="ident" id="1971581">fields</span>&nbsp;<span class="op" id="1971588">*</span><span class="ident" id="1971589">ast</span><span class="op" id="1971592">.</span><span class="ident" id="1971593">FieldList</span><span class="op" id="1971602">,</span>&nbsp;<span class="ident" id="1971604">isStruct</span><span class="op" id="1971612">,</span>&nbsp;<span class="ident" id="1971614">isIncomplete</span>&nbsp;<span class="builtintype" id="1971627">bool</span><span class="op" id="1971631">)</span>&nbsp;<span class="op" id="1971633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1971636">lbrace</span>&nbsp;<span class="op" id="1971643">:=</span>&nbsp;<span class="ident" id="1971646">fields</span><span class="op" id="1971652">.</span><span class="ident" id="1971653">Opening</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1971662">list</span>&nbsp;<span class="op" id="1971667">:=</span>&nbsp;<span class="ident" id="1971670">fields</span><span class="op" id="1971676">.</span><span class="ident" id="1971677">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1971683">rbrace</span>&nbsp;<span class="op" id="1971690">:=</span>&nbsp;<span class="ident" id="1971693">fields</span><span class="op" id="1971699">.</span><span class="ident" id="1971700">Closing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1971709">hasComments</span>&nbsp;<span class="op" id="1971721">:=</span>&nbsp;<span class="ident" id="1971724">isIncomplete</span>&nbsp;<span class="op" id="1971737">||</span>&nbsp;<span class="ident" id="1971740">p</span><span class="op" id="1971741">.</span><span class="ident" id="1971742">commentBefore</span><span class="op" id="1971755">(</span><span class="ident" id="1971756">p</span><span class="op" id="1971757">.</span><span class="ident" id="1971758">posFor</span><span class="op" id="1971764">(</span><span class="ident" id="1971765">rbrace</span><span class="op" id="1971771">)</span><span class="op" id="1971772">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1971775">srcIsOneLine</span>&nbsp;<span class="op" id="1971788">:=</span>&nbsp;<span class="ident" id="1971791">lbrace</span><span class="op" id="1971797">.</span><span class="ident" id="1971798">IsValid</span><span class="op" id="1971805">(</span><span class="op" id="1971806">)</span>&nbsp;<span class="op" id="1971808">&amp;&amp;</span>&nbsp;<span class="ident" id="1971811">rbrace</span><span class="op" id="1971817">.</span><span class="ident" id="1971818">IsValid</span><span class="op" id="1971825">(</span><span class="op" id="1971826">)</span>&nbsp;<span class="op" id="1971828">&amp;&amp;</span>&nbsp;<span class="ident" id="1971831">p</span><span class="op" id="1971832">.</span><span class="ident" id="1971833">lineFor</span><span class="op" id="1971840">(</span><span class="ident" id="1971841">lbrace</span><span class="op" id="1971847">)</span>&nbsp;<span class="op" id="1971849">==</span>&nbsp;<span class="ident" id="1971852">p</span><span class="op" id="1971853">.</span><span class="ident" id="1971854">lineFor</span><span class="op" id="1971861">(</span><span class="ident" id="1971862">rbrace</span><span class="op" id="1971868">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971872">if</span>&nbsp;<span class="op" id="1971875">!</span><span class="ident" id="1971876">hasComments</span>&nbsp;<span class="op" id="1971888">&amp;&amp;</span>&nbsp;<span class="ident" id="1971891">srcIsOneLine</span>&nbsp;<span class="op" id="1971904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1971908">//&nbsp;possibly&nbsp;a&nbsp;one-line&nbsp;struct/interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1971950">if</span>&nbsp;<span class="builtinfunc" id="1971953">len</span><span class="op" id="1971956">(</span><span class="ident" id="1971957">list</span><span class="op" id="1971961">)</span>&nbsp;<span class="op" id="1971963">==</span>&nbsp;<span class="num" id="1971966">0</span>&nbsp;<span class="op" id="1971968">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1971973">//&nbsp;no&nbsp;blank&nbsp;between&nbsp;keyword&nbsp;and&nbsp;{}&nbsp;in&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972024">p</span><span class="op" id="1972025">.</span><span class="builtinfunc" id="1972026">print</span><span class="op" id="1972031">(</span><span class="ident" id="1972032">lbrace</span><span class="op" id="1972038">,</span>&nbsp;<span class="ident" id="1972040">token</span><span class="op" id="1972045">.</span><span class="ident" id="1972046">LBRACE</span><span class="op" id="1972052">,</span>&nbsp;<span class="ident" id="1972054">rbrace</span><span class="op" id="1972060">,</span>&nbsp;<span class="ident" id="1972062">token</span><span class="op" id="1972067">.</span><span class="ident" id="1972068">RBRACE</span><span class="op" id="1972074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972079">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972088">}</span>&nbsp;<span class="keyword" id="1972090">else</span>&nbsp;<span class="keyword" id="1972095">if</span>&nbsp;<span class="ident" id="1972098">isStruct</span>&nbsp;<span class="op" id="1972107">&amp;&amp;</span>&nbsp;<span class="ident" id="1972110">p</span><span class="op" id="1972111">.</span><span class="ident" id="1972112">isOneLineFieldList</span><span class="op" id="1972130">(</span><span class="ident" id="1972131">list</span><span class="op" id="1972135">)</span>&nbsp;<span class="op" id="1972137">{</span>&nbsp;<span class="comment" id="1972139">//&nbsp;for&nbsp;now&nbsp;ignore&nbsp;interfaces</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1972171">//&nbsp;small&nbsp;enough&nbsp;-&nbsp;print&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1972210">//&nbsp;(don&#39;t&nbsp;use&nbsp;identList&nbsp;and&nbsp;ignore&nbsp;source&nbsp;line&nbsp;breaks)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972268">p</span><span class="op" id="1972269">.</span><span class="builtinfunc" id="1972270">print</span><span class="op" id="1972275">(</span><span class="ident" id="1972276">lbrace</span><span class="op" id="1972282">,</span>&nbsp;<span class="ident" id="1972284">token</span><span class="op" id="1972289">.</span><span class="ident" id="1972290">LBRACE</span><span class="op" id="1972296">,</span>&nbsp;<span class="ident" id="1972298">blank</span><span class="op" id="1972303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972308">f</span>&nbsp;<span class="op" id="1972310">:=</span>&nbsp;<span class="ident" id="1972313">list</span><span class="op" id="1972317">[</span><span class="num" id="1972318">0</span><span class="op" id="1972319">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972324">for</span>&nbsp;<span class="ident" id="1972328">i</span><span class="op" id="1972329">,</span>&nbsp;<span class="ident" id="1972331">x</span>&nbsp;<span class="op" id="1972333">:=</span>&nbsp;<span class="keyword" id="1972336">range</span>&nbsp;<span class="ident" id="1972342">f</span><span class="op" id="1972343">.</span><span class="ident" id="1972344">Names</span>&nbsp;<span class="op" id="1972350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972356">if</span>&nbsp;<span class="ident" id="1972359">i</span>&nbsp;<span class="op" id="1972361">&gt;</span>&nbsp;<span class="num" id="1972363">0</span>&nbsp;<span class="op" id="1972365">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1972372">//&nbsp;no&nbsp;comments&nbsp;so&nbsp;no&nbsp;need&nbsp;for&nbsp;comma&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972422">p</span><span class="op" id="1972423">.</span><span class="builtinfunc" id="1972424">print</span><span class="op" id="1972429">(</span><span class="ident" id="1972430">token</span><span class="op" id="1972435">.</span><span class="ident" id="1972436">COMMA</span><span class="op" id="1972441">,</span>&nbsp;<span class="ident" id="1972443">blank</span><span class="op" id="1972448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972460">p</span><span class="op" id="1972461">.</span><span class="ident" id="1972462">expr</span><span class="op" id="1972466">(</span><span class="ident" id="1972467">x</span><span class="op" id="1972468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972473">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972478">if</span>&nbsp;<span class="builtinfunc" id="1972481">len</span><span class="op" id="1972484">(</span><span class="ident" id="1972485">f</span><span class="op" id="1972486">.</span><span class="ident" id="1972487">Names</span><span class="op" id="1972492">)</span>&nbsp;<span class="op" id="1972494">&gt;</span>&nbsp;<span class="num" id="1972496">0</span>&nbsp;<span class="op" id="1972498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972504">p</span><span class="op" id="1972505">.</span><span class="builtinfunc" id="1972506">print</span><span class="op" id="1972511">(</span><span class="ident" id="1972512">blank</span><span class="op" id="1972517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972527">p</span><span class="op" id="1972528">.</span><span class="ident" id="1972529">expr</span><span class="op" id="1972533">(</span><span class="ident" id="1972534">f</span><span class="op" id="1972535">.</span><span class="ident" id="1972536">Type</span><span class="op" id="1972540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972545">p</span><span class="op" id="1972546">.</span><span class="builtinfunc" id="1972547">print</span><span class="op" id="1972552">(</span><span class="ident" id="1972553">blank</span><span class="op" id="1972558">,</span>&nbsp;<span class="ident" id="1972560">rbrace</span><span class="op" id="1972566">,</span>&nbsp;<span class="ident" id="1972568">token</span><span class="op" id="1972573">.</span><span class="ident" id="1972574">RBRACE</span><span class="op" id="1972580">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972585">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1972600">//&nbsp;hasComments&nbsp;||&nbsp;!srcIsOneLine</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972634">p</span><span class="op" id="1972635">.</span><span class="builtinfunc" id="1972636">print</span><span class="op" id="1972641">(</span><span class="ident" id="1972642">blank</span><span class="op" id="1972647">,</span>&nbsp;<span class="ident" id="1972649">lbrace</span><span class="op" id="1972655">,</span>&nbsp;<span class="ident" id="1972657">token</span><span class="op" id="1972662">.</span><span class="ident" id="1972663">LBRACE</span><span class="op" id="1972669">,</span>&nbsp;<span class="ident" id="1972671">indent</span><span class="op" id="1972677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972680">if</span>&nbsp;<span class="ident" id="1972683">hasComments</span>&nbsp;<span class="op" id="1972695">||</span>&nbsp;<span class="builtinfunc" id="1972698">len</span><span class="op" id="1972701">(</span><span class="ident" id="1972702">list</span><span class="op" id="1972706">)</span>&nbsp;<span class="op" id="1972708">&gt;</span>&nbsp;<span class="num" id="1972710">0</span>&nbsp;<span class="op" id="1972712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972716">p</span><span class="op" id="1972717">.</span><span class="builtinfunc" id="1972718">print</span><span class="op" id="1972723">(</span><span class="ident" id="1972724">formfeed</span><span class="op" id="1972732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972739">if</span>&nbsp;<span class="ident" id="1972742">isStruct</span>&nbsp;<span class="op" id="1972751">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972756">sep</span>&nbsp;<span class="op" id="1972760">:=</span>&nbsp;<span class="ident" id="1972763">vtab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972770">if</span>&nbsp;<span class="builtinfunc" id="1972773">len</span><span class="op" id="1972776">(</span><span class="ident" id="1972777">list</span><span class="op" id="1972781">)</span>&nbsp;<span class="op" id="1972783">==</span>&nbsp;<span class="num" id="1972786">1</span>&nbsp;<span class="op" id="1972788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972793">sep</span>&nbsp;<span class="op" id="1972797">=</span>&nbsp;<span class="ident" id="1972799">blank</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972811">var</span>&nbsp;<span class="ident" id="1972815">line</span>&nbsp;<span class="builtintype" id="1972820">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972826">for</span>&nbsp;<span class="ident" id="1972830">i</span><span class="op" id="1972831">,</span>&nbsp;<span class="ident" id="1972833">f</span>&nbsp;<span class="op" id="1972835">:=</span>&nbsp;<span class="keyword" id="1972838">range</span>&nbsp;<span class="ident" id="1972844">list</span>&nbsp;<span class="op" id="1972849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972854">if</span>&nbsp;<span class="ident" id="1972857">i</span>&nbsp;<span class="op" id="1972859">&gt;</span>&nbsp;<span class="num" id="1972861">0</span>&nbsp;<span class="op" id="1972863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972869">p</span><span class="op" id="1972870">.</span><span class="ident" id="1972871">linebreak</span><span class="op" id="1972880">(</span><span class="ident" id="1972881">p</span><span class="op" id="1972882">.</span><span class="ident" id="1972883">lineFor</span><span class="op" id="1972890">(</span><span class="ident" id="1972891">f</span><span class="op" id="1972892">.</span><span class="ident" id="1972893">Pos</span><span class="op" id="1972896">(</span><span class="op" id="1972897">)</span><span class="op" id="1972898">)</span><span class="op" id="1972899">,</span>&nbsp;<span class="num" id="1972901">1</span><span class="op" id="1972902">,</span>&nbsp;<span class="ident" id="1972904">ignore</span><span class="op" id="1972910">,</span>&nbsp;<span class="ident" id="1972912">p</span><span class="op" id="1972913">.</span><span class="ident" id="1972914">linesFrom</span><span class="op" id="1972923">(</span><span class="ident" id="1972924">line</span><span class="op" id="1972928">)</span>&nbsp;<span class="op" id="1972930">&gt;</span>&nbsp;<span class="num" id="1972932">0</span><span class="op" id="1972933">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972943">extraTabs</span>&nbsp;<span class="op" id="1972953">:=</span>&nbsp;<span class="num" id="1972956">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972961">p</span><span class="op" id="1972962">.</span><span class="ident" id="1972963">setComment</span><span class="op" id="1972973">(</span><span class="ident" id="1972974">f</span><span class="op" id="1972975">.</span><span class="ident" id="1972976">Doc</span><span class="op" id="1972979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972984">p</span><span class="op" id="1972985">.</span><span class="ident" id="1972986">recordLine</span><span class="op" id="1972996">(</span><span class="op" id="1972997">&amp;</span><span class="ident" id="1972998">line</span><span class="op" id="1973002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973007">if</span>&nbsp;<span class="builtinfunc" id="1973010">len</span><span class="op" id="1973013">(</span><span class="ident" id="1973014">f</span><span class="op" id="1973015">.</span><span class="ident" id="1973016">Names</span><span class="op" id="1973021">)</span>&nbsp;<span class="op" id="1973023">&gt;</span>&nbsp;<span class="num" id="1973025">0</span>&nbsp;<span class="op" id="1973027">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1973033">//&nbsp;named&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973053">p</span><span class="op" id="1973054">.</span><span class="ident" id="1973055">identList</span><span class="op" id="1973064">(</span><span class="ident" id="1973065">f</span><span class="op" id="1973066">.</span><span class="ident" id="1973067">Names</span><span class="op" id="1973072">,</span>&nbsp;<span class="builtintype" id="1973074">false</span><span class="op" id="1973079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973085">p</span><span class="op" id="1973086">.</span><span class="builtinfunc" id="1973087">print</span><span class="op" id="1973092">(</span><span class="ident" id="1973093">sep</span><span class="op" id="1973096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973102">p</span><span class="op" id="1973103">.</span><span class="ident" id="1973104">expr</span><span class="op" id="1973108">(</span><span class="ident" id="1973109">f</span><span class="op" id="1973110">.</span><span class="ident" id="1973111">Type</span><span class="op" id="1973115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973121">extraTabs</span>&nbsp;<span class="op" id="1973131">=</span>&nbsp;<span class="num" id="1973133">1</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973138">}</span>&nbsp;<span class="keyword" id="1973140">else</span>&nbsp;<span class="op" id="1973145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1973151">//&nbsp;anonymous&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973174">p</span><span class="op" id="1973175">.</span><span class="ident" id="1973176">expr</span><span class="op" id="1973180">(</span><span class="ident" id="1973181">f</span><span class="op" id="1973182">.</span><span class="ident" id="1973183">Type</span><span class="op" id="1973187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973193">extraTabs</span>&nbsp;<span class="op" id="1973203">=</span>&nbsp;<span class="num" id="1973205">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973210">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973215">if</span>&nbsp;<span class="ident" id="1973218">f</span><span class="op" id="1973219">.</span><span class="ident" id="1973220">Tag</span>&nbsp;<span class="op" id="1973224">!=</span>&nbsp;<span class="ident" id="1973227">nil</span>&nbsp;<span class="op" id="1973231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973237">if</span>&nbsp;<span class="builtinfunc" id="1973240">len</span><span class="op" id="1973243">(</span><span class="ident" id="1973244">f</span><span class="op" id="1973245">.</span><span class="ident" id="1973246">Names</span><span class="op" id="1973251">)</span>&nbsp;<span class="op" id="1973253">&gt;</span>&nbsp;<span class="num" id="1973255">0</span>&nbsp;<span class="op" id="1973257">&amp;&amp;</span>&nbsp;<span class="ident" id="1973260">sep</span>&nbsp;<span class="op" id="1973264">==</span>&nbsp;<span class="ident" id="1973267">vtab</span>&nbsp;<span class="op" id="1973272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973279">p</span><span class="op" id="1973280">.</span><span class="builtinfunc" id="1973281">print</span><span class="op" id="1973286">(</span><span class="ident" id="1973287">sep</span><span class="op" id="1973290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973302">p</span><span class="op" id="1973303">.</span><span class="builtinfunc" id="1973304">print</span><span class="op" id="1973309">(</span><span class="ident" id="1973310">sep</span><span class="op" id="1973313">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973319">p</span><span class="op" id="1973320">.</span><span class="ident" id="1973321">expr</span><span class="op" id="1973325">(</span><span class="ident" id="1973326">f</span><span class="op" id="1973327">.</span><span class="ident" id="1973328">Tag</span><span class="op" id="1973331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973337">extraTabs</span>&nbsp;<span class="op" id="1973347">=</span>&nbsp;<span class="num" id="1973349">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973359">if</span>&nbsp;<span class="ident" id="1973362">f</span><span class="op" id="1973363">.</span><span class="ident" id="1973364">Comment</span>&nbsp;<span class="op" id="1973372">!=</span>&nbsp;<span class="ident" id="1973375">nil</span>&nbsp;<span class="op" id="1973379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973385">for</span>&nbsp;<span class="op" id="1973389">;</span>&nbsp;<span class="ident" id="1973391">extraTabs</span>&nbsp;<span class="op" id="1973401">&gt;</span>&nbsp;<span class="num" id="1973403">0</span><span class="op" id="1973404">;</span>&nbsp;<span class="ident" id="1973406">extraTabs</span><span class="op" id="1973415">--</span>&nbsp;<span class="op" id="1973418">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973425">p</span><span class="op" id="1973426">.</span><span class="builtinfunc" id="1973427">print</span><span class="op" id="1973432">(</span><span class="ident" id="1973433">sep</span><span class="op" id="1973436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973448">p</span><span class="op" id="1973449">.</span><span class="ident" id="1973450">setComment</span><span class="op" id="1973460">(</span><span class="ident" id="1973461">f</span><span class="op" id="1973462">.</span><span class="ident" id="1973463">Comment</span><span class="op" id="1973470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973479">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973483">if</span>&nbsp;<span class="ident" id="1973486">isIncomplete</span>&nbsp;<span class="op" id="1973499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973504">if</span>&nbsp;<span class="builtinfunc" id="1973507">len</span><span class="op" id="1973510">(</span><span class="ident" id="1973511">list</span><span class="op" id="1973515">)</span>&nbsp;<span class="op" id="1973517">&gt;</span>&nbsp;<span class="num" id="1973519">0</span>&nbsp;<span class="op" id="1973521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973527">p</span><span class="op" id="1973528">.</span><span class="builtinfunc" id="1973529">print</span><span class="op" id="1973534">(</span><span class="ident" id="1973535">formfeed</span><span class="op" id="1973543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973553">p</span><span class="op" id="1973554">.</span><span class="ident" id="1973555">flush</span><span class="op" id="1973560">(</span><span class="ident" id="1973561">p</span><span class="op" id="1973562">.</span><span class="ident" id="1973563">posFor</span><span class="op" id="1973569">(</span><span class="ident" id="1973570">rbrace</span><span class="op" id="1973576">)</span><span class="op" id="1973577">,</span>&nbsp;<span class="ident" id="1973579">token</span><span class="op" id="1973584">.</span><span class="ident" id="1973585">RBRACE</span><span class="op" id="1973591">)</span>&nbsp;<span class="comment" id="1973593">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973645">p</span><span class="op" id="1973646">.</span><span class="ident" id="1973647">setLineComment</span><span class="op" id="1973661">(</span><span class="string" id="1973662">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;fields&#34;</span><span class="op" id="1973705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973713">}</span>&nbsp;<span class="keyword" id="1973715">else</span>&nbsp;<span class="op" id="1973720">{</span>&nbsp;<span class="comment" id="1973722">//&nbsp;interface</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973738">var</span>&nbsp;<span class="ident" id="1973742">line</span>&nbsp;<span class="builtintype" id="1973747">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973753">for</span>&nbsp;<span class="ident" id="1973757">i</span><span class="op" id="1973758">,</span>&nbsp;<span class="ident" id="1973760">f</span>&nbsp;<span class="op" id="1973762">:=</span>&nbsp;<span class="keyword" id="1973765">range</span>&nbsp;<span class="ident" id="1973771">list</span>&nbsp;<span class="op" id="1973776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973781">if</span>&nbsp;<span class="ident" id="1973784">i</span>&nbsp;<span class="op" id="1973786">&gt;</span>&nbsp;<span class="num" id="1973788">0</span>&nbsp;<span class="op" id="1973790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973796">p</span><span class="op" id="1973797">.</span><span class="ident" id="1973798">linebreak</span><span class="op" id="1973807">(</span><span class="ident" id="1973808">p</span><span class="op" id="1973809">.</span><span class="ident" id="1973810">lineFor</span><span class="op" id="1973817">(</span><span class="ident" id="1973818">f</span><span class="op" id="1973819">.</span><span class="ident" id="1973820">Pos</span><span class="op" id="1973823">(</span><span class="op" id="1973824">)</span><span class="op" id="1973825">)</span><span class="op" id="1973826">,</span>&nbsp;<span class="num" id="1973828">1</span><span class="op" id="1973829">,</span>&nbsp;<span class="ident" id="1973831">ignore</span><span class="op" id="1973837">,</span>&nbsp;<span class="ident" id="1973839">p</span><span class="op" id="1973840">.</span><span class="ident" id="1973841">linesFrom</span><span class="op" id="1973850">(</span><span class="ident" id="1973851">line</span><span class="op" id="1973855">)</span>&nbsp;<span class="op" id="1973857">&gt;</span>&nbsp;<span class="num" id="1973859">0</span><span class="op" id="1973860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973865">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973870">p</span><span class="op" id="1973871">.</span><span class="ident" id="1973872">setComment</span><span class="op" id="1973882">(</span><span class="ident" id="1973883">f</span><span class="op" id="1973884">.</span><span class="ident" id="1973885">Doc</span><span class="op" id="1973888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973893">p</span><span class="op" id="1973894">.</span><span class="ident" id="1973895">recordLine</span><span class="op" id="1973905">(</span><span class="op" id="1973906">&amp;</span><span class="ident" id="1973907">line</span><span class="op" id="1973911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973916">if</span>&nbsp;<span class="ident" id="1973919">ftyp</span><span class="op" id="1973923">,</span>&nbsp;<span class="ident" id="1973925">isFtyp</span>&nbsp;<span class="op" id="1973932">:=</span>&nbsp;<span class="ident" id="1973935">f</span><span class="op" id="1973936">.</span><span class="ident" id="1973937">Type</span><span class="op" id="1973941">.</span><span class="op" id="1973942">(</span><span class="op" id="1973943">*</span><span class="ident" id="1973944">ast</span><span class="op" id="1973947">.</span><span class="ident" id="1973948">FuncType</span><span class="op" id="1973956">)</span><span class="op" id="1973957">;</span>&nbsp;<span class="ident" id="1973959">isFtyp</span>&nbsp;<span class="op" id="1973966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1973972">//&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1973986">p</span><span class="op" id="1973987">.</span><span class="ident" id="1973988">expr</span><span class="op" id="1973992">(</span><span class="ident" id="1973993">f</span><span class="op" id="1973994">.</span><span class="ident" id="1973995">Names</span><span class="op" id="1974000">[</span><span class="num" id="1974001">0</span><span class="op" id="1974002">]</span><span class="op" id="1974003">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974009">p</span><span class="op" id="1974010">.</span><span class="ident" id="1974011">signature</span><span class="op" id="1974020">(</span><span class="ident" id="1974021">ftyp</span><span class="op" id="1974025">.</span><span class="ident" id="1974026">Params</span><span class="op" id="1974032">,</span>&nbsp;<span class="ident" id="1974034">ftyp</span><span class="op" id="1974038">.</span><span class="ident" id="1974039">Results</span><span class="op" id="1974046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1974051">}</span>&nbsp;<span class="keyword" id="1974053">else</span>&nbsp;<span class="op" id="1974058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1974064">//&nbsp;embedded&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974090">p</span><span class="op" id="1974091">.</span><span class="ident" id="1974092">expr</span><span class="op" id="1974096">(</span><span class="ident" id="1974097">f</span><span class="op" id="1974098">.</span><span class="ident" id="1974099">Type</span><span class="op" id="1974103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1974108">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974113">p</span><span class="op" id="1974114">.</span><span class="ident" id="1974115">setComment</span><span class="op" id="1974125">(</span><span class="ident" id="1974126">f</span><span class="op" id="1974127">.</span><span class="ident" id="1974128">Comment</span><span class="op" id="1974135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1974139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974143">if</span>&nbsp;<span class="ident" id="1974146">isIncomplete</span>&nbsp;<span class="op" id="1974159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974164">if</span>&nbsp;<span class="builtinfunc" id="1974167">len</span><span class="op" id="1974170">(</span><span class="ident" id="1974171">list</span><span class="op" id="1974175">)</span>&nbsp;<span class="op" id="1974177">&gt;</span>&nbsp;<span class="num" id="1974179">0</span>&nbsp;<span class="op" id="1974181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974187">p</span><span class="op" id="1974188">.</span><span class="builtinfunc" id="1974189">print</span><span class="op" id="1974194">(</span><span class="ident" id="1974195">formfeed</span><span class="op" id="1974203">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1974208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974213">p</span><span class="op" id="1974214">.</span><span class="ident" id="1974215">flush</span><span class="op" id="1974220">(</span><span class="ident" id="1974221">p</span><span class="op" id="1974222">.</span><span class="ident" id="1974223">posFor</span><span class="op" id="1974229">(</span><span class="ident" id="1974230">rbrace</span><span class="op" id="1974236">)</span><span class="op" id="1974237">,</span>&nbsp;<span class="ident" id="1974239">token</span><span class="op" id="1974244">.</span><span class="ident" id="1974245">RBRACE</span><span class="op" id="1974251">)</span>&nbsp;<span class="comment" id="1974253">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974305">p</span><span class="op" id="1974306">.</span><span class="ident" id="1974307">setLineComment</span><span class="op" id="1974321">(</span><span class="string" id="1974322">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;methods&#34;</span><span class="op" id="1974366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1974370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1974374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974377">p</span><span class="op" id="1974378">.</span><span class="builtinfunc" id="1974379">print</span><span class="op" id="1974384">(</span><span class="ident" id="1974385">unindent</span><span class="op" id="1974393">,</span>&nbsp;<span class="ident" id="1974395">formfeed</span><span class="op" id="1974403">,</span>&nbsp;<span class="ident" id="1974405">rbrace</span><span class="op" id="1974411">,</span>&nbsp;<span class="ident" id="1974413">token</span><span class="op" id="1974418">.</span><span class="ident" id="1974419">RBRACE</span><span class="op" id="1974425">)</span><br>
<span class="lineno"></span><span class="op" id="1974427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1974430">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">505</span><span class="comment" id="1974510">//&nbsp;Expressions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1974526">func</span>&nbsp;<span class="ident" id="1974531">walkBinary</span><span class="op" id="1974541">(</span><span class="ident" id="1974542">e</span>&nbsp;<span class="op" id="1974544">*</span><span class="ident" id="1974545">ast</span><span class="op" id="1974548">.</span><span class="ident" id="1974549">BinaryExpr</span><span class="op" id="1974559">)</span>&nbsp;<span class="op" id="1974561">(</span><span class="ident" id="1974562">has4</span><span class="op" id="1974566">,</span>&nbsp;<span class="ident" id="1974568">has5</span>&nbsp;<span class="builtintype" id="1974573">bool</span><span class="op" id="1974577">,</span>&nbsp;<span class="ident" id="1974579">maxProblem</span>&nbsp;<span class="builtintype" id="1974590">int</span><span class="op" id="1974593">)</span>&nbsp;<span class="op" id="1974595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974598">switch</span>&nbsp;<span class="ident" id="1974605">e</span><span class="op" id="1974606">.</span><span class="ident" id="1974607">Op</span><span class="op" id="1974609">.</span><span class="ident" id="1974610">Precedence</span><span class="op" id="1974620">(</span><span class="op" id="1974621">)</span>&nbsp;<span class="op" id="1974623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974626">case</span>&nbsp;<span class="num" id="1974631">4</span><span class="op" id="1974632">:</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974636">has4</span>&nbsp;<span class="op" id="1974641">=</span>&nbsp;<span class="builtintype" id="1974643">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974649">case</span>&nbsp;<span class="num" id="1974654">5</span><span class="op" id="1974655">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974659">has5</span>&nbsp;<span class="op" id="1974664">=</span>&nbsp;<span class="builtintype" id="1974666">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1974672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974676">switch</span>&nbsp;<span class="ident" id="1974683">l</span>&nbsp;<span class="op" id="1974685">:=</span>&nbsp;<span class="ident" id="1974688">e</span><span class="op" id="1974689">.</span><span class="ident" id="1974690">X</span><span class="op" id="1974691">.</span><span class="op" id="1974692">(</span><span class="keyword" id="1974693">type</span><span class="op" id="1974697">)</span>&nbsp;<span class="op" id="1974699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974702">case</span>&nbsp;<span class="op" id="1974707">*</span><span class="ident" id="1974708">ast</span><span class="op" id="1974711">.</span><span class="ident" id="1974712">BinaryExpr</span><span class="op" id="1974722">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974726">if</span>&nbsp;<span class="ident" id="1974729">l</span><span class="op" id="1974730">.</span><span class="ident" id="1974731">Op</span><span class="op" id="1974733">.</span><span class="ident" id="1974734">Precedence</span><span class="op" id="1974744">(</span><span class="op" id="1974745">)</span>&nbsp;<span class="op" id="1974747">&lt;</span>&nbsp;<span class="ident" id="1974749">e</span><span class="op" id="1974750">.</span><span class="ident" id="1974751">Op</span><span class="op" id="1974753">.</span><span class="ident" id="1974754">Precedence</span><span class="op" id="1974764">(</span><span class="op" id="1974765">)</span>&nbsp;<span class="op" id="1974767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1974772">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1974803">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974859">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1974867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974871">h4</span><span class="op" id="1974873">,</span>&nbsp;<span class="ident" id="1974875">h5</span><span class="op" id="1974877">,</span>&nbsp;<span class="ident" id="1974879">mp</span>&nbsp;<span class="op" id="1974882">:=</span>&nbsp;<span class="ident" id="1974885">walkBinary</span><span class="op" id="1974895">(</span><span class="ident" id="1974896">l</span><span class="op" id="1974897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974901">has4</span>&nbsp;<span class="op" id="1974906">=</span>&nbsp;<span class="ident" id="1974908">has4</span>&nbsp;<span class="op" id="1974913">||</span>&nbsp;<span class="ident" id="1974916">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974921">has5</span>&nbsp;<span class="op" id="1974926">=</span>&nbsp;<span class="ident" id="1974928">has5</span>&nbsp;<span class="op" id="1974933">||</span>&nbsp;<span class="ident" id="1974936">h5</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974941">if</span>&nbsp;<span class="ident" id="1974944">maxProblem</span>&nbsp;<span class="op" id="1974955">&lt;</span>&nbsp;<span class="ident" id="1974957">mp</span>&nbsp;<span class="op" id="1974960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1974965">maxProblem</span>&nbsp;<span class="op" id="1974976">=</span>&nbsp;<span class="ident" id="1974978">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1974983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1974986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1974990">switch</span>&nbsp;<span class="ident" id="1974997">r</span>&nbsp;<span class="op" id="1974999">:=</span>&nbsp;<span class="ident" id="1975002">e</span><span class="op" id="1975003">.</span><span class="ident" id="1975004">Y</span><span class="op" id="1975005">.</span><span class="op" id="1975006">(</span><span class="keyword" id="1975007">type</span><span class="op" id="1975011">)</span>&nbsp;<span class="op" id="1975013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975016">case</span>&nbsp;<span class="op" id="1975021">*</span><span class="ident" id="1975022">ast</span><span class="op" id="1975025">.</span><span class="ident" id="1975026">BinaryExpr</span><span class="op" id="1975036">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975040">if</span>&nbsp;<span class="ident" id="1975043">r</span><span class="op" id="1975044">.</span><span class="ident" id="1975045">Op</span><span class="op" id="1975047">.</span><span class="ident" id="1975048">Precedence</span><span class="op" id="1975058">(</span><span class="op" id="1975059">)</span>&nbsp;<span class="op" id="1975061">&lt;=</span>&nbsp;<span class="ident" id="1975064">e</span><span class="op" id="1975065">.</span><span class="ident" id="1975066">Op</span><span class="op" id="1975068">.</span><span class="ident" id="1975069">Precedence</span><span class="op" id="1975079">(</span><span class="op" id="1975080">)</span>&nbsp;<span class="op" id="1975082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1975087">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1975118">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975174">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1975182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975186">h4</span><span class="op" id="1975188">,</span>&nbsp;<span class="ident" id="1975190">h5</span><span class="op" id="1975192">,</span>&nbsp;<span class="ident" id="1975194">mp</span>&nbsp;<span class="op" id="1975197">:=</span>&nbsp;<span class="ident" id="1975200">walkBinary</span><span class="op" id="1975210">(</span><span class="ident" id="1975211">r</span><span class="op" id="1975212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975216">has4</span>&nbsp;<span class="op" id="1975221">=</span>&nbsp;<span class="ident" id="1975223">has4</span>&nbsp;<span class="op" id="1975228">||</span>&nbsp;<span class="ident" id="1975231">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975236">has5</span>&nbsp;<span class="op" id="1975241">=</span>&nbsp;<span class="ident" id="1975243">has5</span>&nbsp;<span class="op" id="1975248">||</span>&nbsp;<span class="ident" id="1975251">h5</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975256">if</span>&nbsp;<span class="ident" id="1975259">maxProblem</span>&nbsp;<span class="op" id="1975270">&lt;</span>&nbsp;<span class="ident" id="1975272">mp</span>&nbsp;<span class="op" id="1975275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975280">maxProblem</span>&nbsp;<span class="op" id="1975291">=</span>&nbsp;<span class="ident" id="1975293">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1975298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975302">case</span>&nbsp;<span class="op" id="1975307">*</span><span class="ident" id="1975308">ast</span><span class="op" id="1975311">.</span><span class="ident" id="1975312">StarExpr</span><span class="op" id="1975320">:</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975324">if</span>&nbsp;<span class="ident" id="1975327">e</span><span class="op" id="1975328">.</span><span class="ident" id="1975329">Op</span>&nbsp;<span class="op" id="1975332">==</span>&nbsp;<span class="ident" id="1975335">token</span><span class="op" id="1975340">.</span><span class="ident" id="1975341">QUO</span>&nbsp;<span class="op" id="1975345">{</span>&nbsp;<span class="comment" id="1975347">//&nbsp;`*/`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975358">maxProblem</span>&nbsp;<span class="op" id="1975369">=</span>&nbsp;<span class="num" id="1975371">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1975375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975379">case</span>&nbsp;<span class="op" id="1975384">*</span><span class="ident" id="1975385">ast</span><span class="op" id="1975388">.</span><span class="ident" id="1975389">UnaryExpr</span><span class="op" id="1975398">:</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975402">switch</span>&nbsp;<span class="ident" id="1975409">e</span><span class="op" id="1975410">.</span><span class="ident" id="1975411">Op</span><span class="op" id="1975413">.</span><span class="ident" id="1975414">String</span><span class="op" id="1975420">(</span><span class="op" id="1975421">)</span>&nbsp;<span class="op" id="1975423">+</span>&nbsp;<span class="ident" id="1975425">r</span><span class="op" id="1975426">.</span><span class="ident" id="1975427">Op</span><span class="op" id="1975429">.</span><span class="ident" id="1975430">String</span><span class="op" id="1975436">(</span><span class="op" id="1975437">)</span>&nbsp;<span class="op" id="1975439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975443">case</span>&nbsp;<span class="string" id="1975448">&#34;/*&#34;</span><span class="op" id="1975452">,</span>&nbsp;<span class="string" id="1975454">&#34;&amp;&amp;&#34;</span><span class="op" id="1975458">,</span>&nbsp;<span class="string" id="1975460">&#34;&amp;^&#34;</span><span class="op" id="1975464">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975469">maxProblem</span>&nbsp;<span class="op" id="1975480">=</span>&nbsp;<span class="num" id="1975482">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975486">case</span>&nbsp;<span class="string" id="1975491">&#34;++&#34;</span><span class="op" id="1975495">,</span>&nbsp;<span class="string" id="1975497">&#34;--&#34;</span><span class="op" id="1975501">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975506">if</span>&nbsp;<span class="ident" id="1975509">maxProblem</span>&nbsp;<span class="op" id="1975520">&lt;</span>&nbsp;<span class="num" id="1975522">4</span>&nbsp;<span class="op" id="1975524">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975530">maxProblem</span>&nbsp;<span class="op" id="1975541">=</span>&nbsp;<span class="num" id="1975543">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1975548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1975552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1975555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975558">return</span><br>
<span class="lineno">560</span><span class="op" id="1975565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1975568">func</span>&nbsp;<span class="ident" id="1975573">cutoff</span><span class="op" id="1975579">(</span><span class="ident" id="1975580">e</span>&nbsp;<span class="op" id="1975582">*</span><span class="ident" id="1975583">ast</span><span class="op" id="1975586">.</span><span class="ident" id="1975587">BinaryExpr</span><span class="op" id="1975597">,</span>&nbsp;<span class="ident" id="1975599">depth</span>&nbsp;<span class="builtintype" id="1975605">int</span><span class="op" id="1975608">)</span>&nbsp;<span class="builtintype" id="1975610">int</span>&nbsp;<span class="op" id="1975614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975617">has4</span><span class="op" id="1975621">,</span>&nbsp;<span class="ident" id="1975623">has5</span><span class="op" id="1975627">,</span>&nbsp;<span class="ident" id="1975629">maxProblem</span>&nbsp;<span class="op" id="1975640">:=</span>&nbsp;<span class="ident" id="1975643">walkBinary</span><span class="op" id="1975653">(</span><span class="ident" id="1975654">e</span><span class="op" id="1975655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975658">if</span>&nbsp;<span class="ident" id="1975661">maxProblem</span>&nbsp;<span class="op" id="1975672">&gt;</span>&nbsp;<span class="num" id="1975674">0</span>&nbsp;<span class="op" id="1975676">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975680">return</span>&nbsp;<span class="ident" id="1975687">maxProblem</span>&nbsp;<span class="op" id="1975698">+</span>&nbsp;<span class="num" id="1975700">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1975703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975706">if</span>&nbsp;<span class="ident" id="1975709">has4</span>&nbsp;<span class="op" id="1975714">&amp;&amp;</span>&nbsp;<span class="ident" id="1975717">has5</span>&nbsp;<span class="op" id="1975722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975726">if</span>&nbsp;<span class="ident" id="1975729">depth</span>&nbsp;<span class="op" id="1975735">==</span>&nbsp;<span class="num" id="1975738">1</span>&nbsp;<span class="op" id="1975740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975745">return</span>&nbsp;<span class="num" id="1975752">5</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1975756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975760">return</span>&nbsp;<span class="num" id="1975767">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1975770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975773">if</span>&nbsp;<span class="ident" id="1975776">depth</span>&nbsp;<span class="op" id="1975782">==</span>&nbsp;<span class="num" id="1975785">1</span>&nbsp;<span class="op" id="1975787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975791">return</span>&nbsp;<span class="num" id="1975798">6</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1975801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975804">return</span>&nbsp;<span class="num" id="1975811">4</span><br>
<span class="lineno"></span><span class="op" id="1975813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1975816">func</span>&nbsp;<span class="ident" id="1975821">diffPrec</span><span class="op" id="1975829">(</span><span class="ident" id="1975830">expr</span>&nbsp;<span class="ident" id="1975835">ast</span><span class="op" id="1975838">.</span><span class="ident" id="1975839">Expr</span><span class="op" id="1975843">,</span>&nbsp;<span class="ident" id="1975845">prec</span>&nbsp;<span class="builtintype" id="1975850">int</span><span class="op" id="1975853">)</span>&nbsp;<span class="builtintype" id="1975855">int</span>&nbsp;<span class="op" id="1975859">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975862">x</span><span class="op" id="1975863">,</span>&nbsp;<span class="ident" id="1975865">ok</span>&nbsp;<span class="op" id="1975868">:=</span>&nbsp;<span class="ident" id="1975871">expr</span><span class="op" id="1975875">.</span><span class="op" id="1975876">(</span><span class="op" id="1975877">*</span><span class="ident" id="1975878">ast</span><span class="op" id="1975881">.</span><span class="ident" id="1975882">BinaryExpr</span><span class="op" id="1975892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975895">if</span>&nbsp;<span class="op" id="1975898">!</span><span class="ident" id="1975899">ok</span>&nbsp;<span class="op" id="1975902">||</span>&nbsp;<span class="ident" id="1975905">prec</span>&nbsp;<span class="op" id="1975910">!=</span>&nbsp;<span class="ident" id="1975913">x</span><span class="op" id="1975914">.</span><span class="ident" id="1975915">Op</span><span class="op" id="1975917">.</span><span class="ident" id="1975918">Precedence</span><span class="op" id="1975928">(</span><span class="op" id="1975929">)</span>&nbsp;<span class="op" id="1975931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975935">return</span>&nbsp;<span class="num" id="1975942">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1975945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1975948">return</span>&nbsp;<span class="num" id="1975955">0</span><br>
<span class="lineno">585</span><span class="op" id="1975957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1975960">func</span>&nbsp;<span class="ident" id="1975965">reduceDepth</span><span class="op" id="1975976">(</span><span class="ident" id="1975977">depth</span>&nbsp;<span class="builtintype" id="1975983">int</span><span class="op" id="1975986">)</span>&nbsp;<span class="builtintype" id="1975988">int</span>&nbsp;<span class="op" id="1975992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1975995">depth</span><span class="op" id="1976000">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1976004">if</span>&nbsp;<span class="ident" id="1976007">depth</span>&nbsp;<span class="op" id="1976013">&lt;</span>&nbsp;<span class="num" id="1976015">1</span>&nbsp;<span class="op" id="1976017">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1976021">depth</span>&nbsp;<span class="op" id="1976027">=</span>&nbsp;<span class="num" id="1976029">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1976032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1976035">return</span>&nbsp;<span class="ident" id="1976042">depth</span><br>
<span class="lineno"></span><span class="op" id="1976048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="1976051">//&nbsp;Format&nbsp;the&nbsp;binary&nbsp;expression:&nbsp;decide&nbsp;the&nbsp;cutoff&nbsp;and&nbsp;then&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="1976119">//&nbsp;Let&#39;s&nbsp;call&nbsp;depth&nbsp;==&nbsp;1&nbsp;Normal&nbsp;mode,&nbsp;and&nbsp;depth&nbsp;&gt;&nbsp;1&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="1976185">//&nbsp;(Algorithm&nbsp;suggestion&nbsp;by&nbsp;Russ&nbsp;Cox.)</span><br>
<span class="lineno"></span><span class="comment" id="1976224">//</span><br>
<span class="lineno"></span><span class="comment" id="1976227">//&nbsp;The&nbsp;precedences&nbsp;are:</span><br>
<span class="lineno">600</span><span class="comment" id="1976251">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;/&nbsp;&nbsp;%&nbsp;&nbsp;&lt;&lt;&nbsp;&nbsp;&gt;&gt;&nbsp;&nbsp;&amp;&nbsp;&nbsp;&amp;^</span><br>
<span class="lineno"></span><span class="comment" id="1976291">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;-&nbsp;&nbsp;|&nbsp;&nbsp;^</span><br>
<span class="lineno"></span><span class="comment" id="1976319">//&nbsp;&nbsp;&nbsp;&nbsp3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&nbsp;&nbsp;!=&nbsp;&nbsp;&lt;&nbsp;&nbsp;&lt;=&nbsp;&nbsp;&gt;&nbsp;&nbsp;&gt;=</span><br>
<span class="lineno"></span><span class="comment" id="1976357">//&nbsp;&nbsp;&nbsp;&nbsp2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;</span><br>
<span class="lineno"></span><span class="comment" id="1976377">//&nbsp;&nbsp;&nbsp;&nbsp1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||</span><br>
<span class="lineno">605</span><span class="comment" id="1976397">//</span><br>
<span class="lineno"></span><span class="comment" id="1976400">//&nbsp;The&nbsp;only&nbsp;decision&nbsp;is&nbsp;whether&nbsp;there&nbsp;will&nbsp;be&nbsp;spaces&nbsp;around&nbsp;levels&nbsp;4&nbsp;and&nbsp;5.</span><br>
<span class="lineno"></span><span class="comment" id="1976476">//&nbsp;There&nbsp;are&nbsp;never&nbsp;spaces&nbsp;at&nbsp;level&nbsp;6&nbsp;(unary),&nbsp;and&nbsp;always&nbsp;spaces&nbsp;at&nbsp;levels&nbsp;3&nbsp;and&nbsp;below.</span><br>
<span class="lineno"></span><span class="comment" id="1976563">//</span><br>
<span class="lineno"></span><span class="comment" id="1976566">//&nbsp;To&nbsp;choose&nbsp;the&nbsp;cutoff,&nbsp;look&nbsp;at&nbsp;the&nbsp;whole&nbsp;expression&nbsp;but&nbsp;excluding&nbsp;primary</span><br>
<span class="lineno">610</span><span class="comment" id="1976642">//&nbsp;expressions&nbsp;(function&nbsp;calls,&nbsp;parenthesized&nbsp;exprs),&nbsp;and&nbsp;apply&nbsp;these&nbsp;rules:</span><br>
<span class="lineno"></span><span class="comment" id="1976719">//</span><br>
<span class="lineno"></span><span class="comment" id="1976722">//&nbsp;&nbsp;&nbsp;&nbsp1)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;binary&nbsp;operator&nbsp;with&nbsp;a&nbsp;right&nbsp;side&nbsp;unary&nbsp;operand</span><br>
<span class="lineno"></span><span class="comment" id="1976790">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;that&nbsp;would&nbsp;clash&nbsp;without&nbsp;a&nbsp;space,&nbsp;the&nbsp;cutoff&nbsp;must&nbsp;be&nbsp;(in&nbsp;order):</span><br>
<span class="lineno"></span><span class="comment" id="1976861">//</span><br>
<span class="lineno">615</span><span class="comment" id="1976864">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp/*&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="1976873">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="1976882">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&amp;^&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="1976891">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp++&nbsp;&nbsp;&nbsp;&nbsp5</span><br>
<span class="lineno"></span><span class="comment" id="1976900">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp--&nbsp;&nbsp;&nbsp;&nbsp5</span><br>
<span class="lineno">620</span><span class="comment" id="1976909">//</span><br>
<span class="lineno"></span><span class="comment" id="1976912">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Comparison&nbsp;operators&nbsp;always&nbsp;have&nbsp;spaces&nbsp;around&nbsp;them.)</span><br>
<span class="lineno"></span><span class="comment" id="1976978">//</span><br>
<span class="lineno"></span><span class="comment" id="1976981">//&nbsp;&nbsp;&nbsp;&nbsp2)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;mix&nbsp;of&nbsp;level&nbsp;5&nbsp;and&nbsp;level&nbsp;4&nbsp;operators,&nbsp;then&nbsp;the&nbsp;cutoff</span><br>
<span class="lineno"></span><span class="comment" id="1977055">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;is&nbsp;5&nbsp;(use&nbsp;spaces&nbsp;to&nbsp;distinguish&nbsp;precedence)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno">625</span><span class="comment" id="1977120">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="1977168">//</span><br>
<span class="lineno"></span><span class="comment" id="1977171">//&nbsp;&nbsp;&nbsp;&nbsp3)&nbsp;If&nbsp;there&nbsp;are&nbsp;no&nbsp;level&nbsp;4&nbsp;operators&nbsp;or&nbsp;no&nbsp;level&nbsp;5&nbsp;operators,&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1977245">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;cutoff&nbsp;is&nbsp;6&nbsp;(always&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno"></span><span class="comment" id="1977298">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno">630</span><span class="comment" id="1977346">//</span><br>
<span class="lineno"></span><span class="keyword" id="1977349">func</span>&nbsp;<span class="op" id="1977354">(</span><span class="ident" id="1977355">p</span>&nbsp;<span class="op" id="1977357">*</span><span class="ident" id="1977358">printer</span><span class="op" id="1977365">)</span>&nbsp;<span class="ident" id="1977367">binaryExpr</span><span class="op" id="1977377">(</span><span class="ident" id="1977378">x</span>&nbsp;<span class="op" id="1977380">*</span><span class="ident" id="1977381">ast</span><span class="op" id="1977384">.</span><span class="ident" id="1977385">BinaryExpr</span><span class="op" id="1977395">,</span>&nbsp;<span class="ident" id="1977397">prec1</span><span class="op" id="1977402">,</span>&nbsp;<span class="ident" id="1977404">cutoff</span><span class="op" id="1977410">,</span>&nbsp;<span class="ident" id="1977412">depth</span>&nbsp;<span class="builtintype" id="1977418">int</span><span class="op" id="1977421">)</span>&nbsp;<span class="op" id="1977423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1977426">prec</span>&nbsp;<span class="op" id="1977431">:=</span>&nbsp;<span class="ident" id="1977434">x</span><span class="op" id="1977435">.</span><span class="ident" id="1977436">Op</span><span class="op" id="1977438">.</span><span class="ident" id="1977439">Precedence</span><span class="op" id="1977449">(</span><span class="op" id="1977450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1977453">if</span>&nbsp;<span class="ident" id="1977456">prec</span>&nbsp;<span class="op" id="1977461">&lt;</span>&nbsp;<span class="ident" id="1977463">prec1</span>&nbsp;<span class="op" id="1977469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1977473">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1977497">//&nbsp;Note:&nbsp;The&nbsp;parser&nbsp;inserts&nbsp;an&nbsp;ast.ParenExpr&nbsp;node;&nbsp;thus&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1977565">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can&nbsp;only&nbsp;occur&nbsp;if&nbsp;the&nbsp;AST&nbsp;is&nbsp;created&nbsp;in&nbsp;a&nbsp;different&nbsp;way.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1977633">p</span><span class="op" id="1977634">.</span><span class="builtinfunc" id="1977635">print</span><span class="op" id="1977640">(</span><span class="ident" id="1977641">token</span><span class="op" id="1977646">.</span><span class="ident" id="1977647">LPAREN</span><span class="op" id="1977653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1977657">p</span><span class="op" id="1977658">.</span><span class="ident" id="1977659">expr0</span><span class="op" id="1977664">(</span><span class="ident" id="1977665">x</span><span class="op" id="1977666">,</span>&nbsp;<span class="ident" id="1977668">reduceDepth</span><span class="op" id="1977679">(</span><span class="ident" id="1977680">depth</span><span class="op" id="1977685">)</span><span class="op" id="1977686">)</span>&nbsp;<span class="comment" id="1977688">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1977729">p</span><span class="op" id="1977730">.</span><span class="builtinfunc" id="1977731">print</span><span class="op" id="1977736">(</span><span class="ident" id="1977737">token</span><span class="op" id="1977742">.</span><span class="ident" id="1977743">RPAREN</span><span class="op" id="1977749">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1977753">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1977761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1977765">printBlank</span>&nbsp;<span class="op" id="1977776">:=</span>&nbsp;<span class="ident" id="1977779">prec</span>&nbsp;<span class="op" id="1977784">&lt;</span>&nbsp;<span class="ident" id="1977786">cutoff</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1977795">ws</span>&nbsp;<span class="op" id="1977798">:=</span>&nbsp;<span class="ident" id="1977801">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1977809">p</span><span class="op" id="1977810">.</span><span class="ident" id="1977811">expr1</span><span class="op" id="1977816">(</span><span class="ident" id="1977817">x</span><span class="op" id="1977818">.</span><span class="ident" id="1977819">X</span><span class="op" id="1977820">,</span>&nbsp;<span class="ident" id="1977822">prec</span><span class="op" id="1977826">,</span>&nbsp;<span class="ident" id="1977828">depth</span><span class="op" id="1977833">+</span><span class="ident" id="1977834">diffPrec</span><span class="op" id="1977842">(</span><span class="ident" id="1977843">x</span><span class="op" id="1977844">.</span><span class="ident" id="1977845">X</span><span class="op" id="1977846">,</span>&nbsp;<span class="ident" id="1977848">prec</span><span class="op" id="1977852">)</span><span class="op" id="1977853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1977856">if</span>&nbsp;<span class="ident" id="1977859">printBlank</span>&nbsp;<span class="op" id="1977870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1977874">p</span><span class="op" id="1977875">.</span><span class="builtinfunc" id="1977876">print</span><span class="op" id="1977881">(</span><span class="ident" id="1977882">blank</span><span class="op" id="1977887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1977890">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1977893">xline</span>&nbsp;<span class="op" id="1977899">:=</span>&nbsp;<span class="ident" id="1977902">p</span><span class="op" id="1977903">.</span><span class="ident" id="1977904">pos</span><span class="op" id="1977907">.</span><span class="ident" id="1977908">Line</span>&nbsp;<span class="comment" id="1977913">//&nbsp;before&nbsp;the&nbsp;operator&nbsp;(it&nbsp;may&nbsp;be&nbsp;on&nbsp;the&nbsp;next&nbsp;line!)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1977967">yline</span>&nbsp;<span class="op" id="1977973">:=</span>&nbsp;<span class="ident" id="1977976">p</span><span class="op" id="1977977">.</span><span class="ident" id="1977978">lineFor</span><span class="op" id="1977985">(</span><span class="ident" id="1977986">x</span><span class="op" id="1977987">.</span><span class="ident" id="1977988">Y</span><span class="op" id="1977989">.</span><span class="ident" id="1977990">Pos</span><span class="op" id="1977993">(</span><span class="op" id="1977994">)</span><span class="op" id="1977995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1977998">p</span><span class="op" id="1977999">.</span><span class="builtinfunc" id="1978000">print</span><span class="op" id="1978005">(</span><span class="ident" id="1978006">x</span><span class="op" id="1978007">.</span><span class="ident" id="1978008">OpPos</span><span class="op" id="1978013">,</span>&nbsp;<span class="ident" id="1978015">x</span><span class="op" id="1978016">.</span><span class="ident" id="1978017">Op</span><span class="op" id="1978019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1978022">if</span>&nbsp;<span class="ident" id="1978025">xline</span>&nbsp;<span class="op" id="1978031">!=</span>&nbsp;<span class="ident" id="1978034">yline</span>&nbsp;<span class="op" id="1978040">&amp;&amp;</span>&nbsp;<span class="ident" id="1978043">xline</span>&nbsp;<span class="op" id="1978049">&gt;</span>&nbsp;<span class="num" id="1978051">0</span>&nbsp;<span class="op" id="1978053">&amp;&amp;</span>&nbsp;<span class="ident" id="1978056">yline</span>&nbsp;<span class="op" id="1978062">&gt;</span>&nbsp;<span class="num" id="1978064">0</span>&nbsp;<span class="op" id="1978066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1978070">//&nbsp;at&nbsp;least&nbsp;one&nbsp;line&nbsp;break,&nbsp;but&nbsp;respect&nbsp;an&nbsp;extra&nbsp;empty&nbsp;line</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1978132">//&nbsp;in&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1978151">if</span>&nbsp;<span class="ident" id="1978154">p</span><span class="op" id="1978155">.</span><span class="ident" id="1978156">linebreak</span><span class="op" id="1978165">(</span><span class="ident" id="1978166">yline</span><span class="op" id="1978171">,</span>&nbsp;<span class="num" id="1978173">1</span><span class="op" id="1978174">,</span>&nbsp;<span class="ident" id="1978176">ws</span><span class="op" id="1978178">,</span>&nbsp;<span class="builtintype" id="1978180">true</span><span class="op" id="1978184">)</span>&nbsp;<span class="op" id="1978186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1978191">ws</span>&nbsp;<span class="op" id="1978194">=</span>&nbsp;<span class="ident" id="1978196">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1978206">printBlank</span>&nbsp;<span class="op" id="1978217">=</span>&nbsp;<span class="builtintype" id="1978219">false</span>&nbsp;<span class="comment" id="1978225">//&nbsp;no&nbsp;blank&nbsp;after&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1978256">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1978259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1978262">if</span>&nbsp;<span class="ident" id="1978265">printBlank</span>&nbsp;<span class="op" id="1978276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1978280">p</span><span class="op" id="1978281">.</span><span class="builtinfunc" id="1978282">print</span><span class="op" id="1978287">(</span><span class="ident" id="1978288">blank</span><span class="op" id="1978293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1978296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1978299">p</span><span class="op" id="1978300">.</span><span class="ident" id="1978301">expr1</span><span class="op" id="1978306">(</span><span class="ident" id="1978307">x</span><span class="op" id="1978308">.</span><span class="ident" id="1978309">Y</span><span class="op" id="1978310">,</span>&nbsp;<span class="ident" id="1978312">prec</span><span class="op" id="1978316">+</span><span class="num" id="1978317">1</span><span class="op" id="1978318">,</span>&nbsp;<span class="ident" id="1978320">depth</span><span class="op" id="1978325">+</span><span class="num" id="1978326">1</span><span class="op" id="1978327">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1978330">if</span>&nbsp;<span class="ident" id="1978333">ws</span>&nbsp;<span class="op" id="1978336">==</span>&nbsp;<span class="ident" id="1978339">ignore</span>&nbsp;<span class="op" id="1978346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1978350">p</span><span class="op" id="1978351">.</span><span class="builtinfunc" id="1978352">print</span><span class="op" id="1978357">(</span><span class="ident" id="1978358">unindent</span><span class="op" id="1978366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1978369">}</span><br>
<span class="lineno"></span><span class="op" id="1978371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="keyword" id="1978374">func</span>&nbsp;<span class="ident" id="1978379">isBinary</span><span class="op" id="1978387">(</span><span class="ident" id="1978388">expr</span>&nbsp;<span class="ident" id="1978393">ast</span><span class="op" id="1978396">.</span><span class="ident" id="1978397">Expr</span><span class="op" id="1978401">)</span>&nbsp;<span class="builtintype" id="1978403">bool</span>&nbsp;<span class="op" id="1978408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1978411">_</span><span class="op" id="1978412">,</span>&nbsp;<span class="ident" id="1978414">ok</span>&nbsp;<span class="op" id="1978417">:=</span>&nbsp;<span class="ident" id="1978420">expr</span><span class="op" id="1978424">.</span><span class="op" id="1978425">(</span><span class="op" id="1978426">*</span><span class="ident" id="1978427">ast</span><span class="op" id="1978430">.</span><span class="ident" id="1978431">BinaryExpr</span><span class="op" id="1978441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1978444">return</span>&nbsp;<span class="ident" id="1978451">ok</span><br>
<span class="lineno"></span><span class="op" id="1978454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="1978457">func</span>&nbsp;<span class="op" id="1978462">(</span><span class="ident" id="1978463">p</span>&nbsp;<span class="op" id="1978465">*</span><span class="ident" id="1978466">printer</span><span class="op" id="1978473">)</span>&nbsp;<span class="ident" id="1978475">expr1</span><span class="op" id="1978480">(</span><span class="ident" id="1978481">expr</span>&nbsp;<span class="ident" id="1978486">ast</span><span class="op" id="1978489">.</span><span class="ident" id="1978490">Expr</span><span class="op" id="1978494">,</span>&nbsp;<span class="ident" id="1978496">prec1</span><span class="op" id="1978501">,</span>&nbsp;<span class="ident" id="1978503">depth</span>&nbsp;<span class="builtintype" id="1978509">int</span><span class="op" id="1978512">)</span>&nbsp;<span class="op" id="1978514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1978517">p</span><span class="op" id="1978518">.</span><span class="builtinfunc" id="1978519">print</span><span class="op" id="1978524">(</span><span class="ident" id="1978525">expr</span><span class="op" id="1978529">.</span><span class="ident" id="1978530">Pos</span><span class="op" id="1978533">(</span><span class="op" id="1978534">)</span><span class="op" id="1978535">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1978539">switch</span>&nbsp;<span class="ident" id="1978546">x</span>&nbsp;<span class="op" id="1978548">:=</span>&nbsp;<span class="ident" id="1978551">expr</span><span class="op" id="1978555">.</span><span class="op" id="1978556">(</span><span class="keyword" id="1978557">type</span><span class="op" id="1978561">)</span>&nbsp;<span class="op" id="1978563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1978566">case</span>&nbsp;<span class="op" id="1978571">*</span><span class="ident" id="1978572">ast</span><span class="op" id="1978575">.</span><span class="ident" id="1978576">BadExpr</span><span class="op" id="1978583">:</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1978587">p</span><span class="op" id="1978588">.</span><span class="builtinfunc" id="1978589">print</span><span class="op" id="1978594">(</span><span class="string" id="1978595">&#34;BadExpr&#34;</span><span class="op" id="1978604">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1978608">case</span>&nbsp;<span class="op" id="1978613">*</span><span class="ident" id="1978614">ast</span><span class="op" id="1978617">.</span><span class="ident" id="1978618">Ident</span><span class="op" id="1978623">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1978627">p</span><span class="op" id="1978628">.</span><span class="builtinfunc" id="1978629">print</span><span class="op" id="1978634">(</span><span class="ident" id="1978635">x</span><span class="op" id="1978636">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1978640">case</span>&nbsp;<span class="op" id="1978645">*</span><span class="ident" id="1978646">ast</span><span class="op" id="1978649">.</span><span class="ident" id="1978650">BinaryExpr</span><span class="op" id="1978660">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1978664">if</span>&nbsp;<span class="ident" id="1978667">depth</span>&nbsp;<span class="op" id="1978673">&lt;</span>&nbsp;<span class="num" id="1978675">1</span>&nbsp;<span class="op" id="1978677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1978682">p</span><span class="op" id="1978683">.</span><span class="ident" id="1978684">internalError</span><span class="op" id="1978697">(</span><span class="string" id="1978698">&#34;depth&nbsp;&lt;&nbsp;1:&#34;</span><span class="op" id="1978710">,</span>&nbsp;<span class="ident" id="1978712">depth</span><span class="op" id="1978717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1978722">depth</span>&nbsp;<span class="op" id="1978728">=</span>&nbsp;<span class="num" id="1978730">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1978734">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1978738">p</span><span class="op" id="1978739">.</span><span class="ident" id="1978740">binaryExpr</span><span class="op" id="1978750">(</span><span class="ident" id="1978751">x</span><span class="op" id="1978752">,</span>&nbsp;<span class="ident" id="1978754">prec1</span><span class="op" id="1978759">,</span>&nbsp;<span class="ident" id="1978761">cutoff</span><span class="op" id="1978767">(</span><span class="ident" id="1978768">x</span><span class="op" id="1978769">,</span>&nbsp;<span class="ident" id="1978771">depth</span><span class="op" id="1978776">)</span><span class="op" id="1978777">,</span>&nbsp;<span class="ident" id="1978779">depth</span><span class="op" id="1978784">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1978788">case</span>&nbsp;<span class="op" id="1978793">*</span><span class="ident" id="1978794">ast</span><span class="op" id="1978797">.</span><span class="ident" id="1978798">KeyValueExpr</span><span class="op" id="1978810">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1978814">p</span><span class="op" id="1978815">.</span><span class="ident" id="1978816">expr</span><span class="op" id="1978820">(</span><span class="ident" id="1978821">x</span><span class="op" id="1978822">.</span><span class="ident" id="1978823">Key</span><span class="op" id="1978826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1978830">p</span><span class="op" id="1978831">.</span><span class="builtinfunc" id="1978832">print</span><span class="op" id="1978837">(</span><span class="ident" id="1978838">x</span><span class="op" id="1978839">.</span><span class="ident" id="1978840">Colon</span><span class="op" id="1978845">,</span>&nbsp;<span class="ident" id="1978847">token</span><span class="op" id="1978852">.</span><span class="ident" id="1978853">COLON</span><span class="op" id="1978858">,</span>&nbsp;<span class="ident" id="1978860">blank</span><span class="op" id="1978865">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1978869">p</span><span class="op" id="1978870">.</span><span class="ident" id="1978871">expr</span><span class="op" id="1978875">(</span><span class="ident" id="1978876">x</span><span class="op" id="1978877">.</span><span class="ident" id="1978878">Value</span><span class="op" id="1978883">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1978887">case</span>&nbsp;<span class="op" id="1978892">*</span><span class="ident" id="1978893">ast</span><span class="op" id="1978896">.</span><span class="ident" id="1978897">StarExpr</span><span class="op" id="1978905">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1978909">const</span>&nbsp;<span class="ident" id="1978915">prec</span>&nbsp;<span class="op" id="1978920">=</span>&nbsp;<span class="ident" id="1978922">token</span><span class="op" id="1978927">.</span><span class="ident" id="1978928">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1978940">if</span>&nbsp;<span class="ident" id="1978943">prec</span>&nbsp;<span class="op" id="1978948">&lt;</span>&nbsp;<span class="ident" id="1978950">prec1</span>&nbsp;<span class="op" id="1978956">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1978961">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1978986">p</span><span class="op" id="1978987">.</span><span class="builtinfunc" id="1978988">print</span><span class="op" id="1978993">(</span><span class="ident" id="1978994">token</span><span class="op" id="1978999">.</span><span class="ident" id="1979000">LPAREN</span><span class="op" id="1979006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979011">p</span><span class="op" id="1979012">.</span><span class="builtinfunc" id="1979013">print</span><span class="op" id="1979018">(</span><span class="ident" id="1979019">token</span><span class="op" id="1979024">.</span><span class="ident" id="1979025">MUL</span><span class="op" id="1979028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979033">p</span><span class="op" id="1979034">.</span><span class="ident" id="1979035">expr</span><span class="op" id="1979039">(</span><span class="ident" id="1979040">x</span><span class="op" id="1979041">.</span><span class="ident" id="1979042">X</span><span class="op" id="1979043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979048">p</span><span class="op" id="1979049">.</span><span class="builtinfunc" id="1979050">print</span><span class="op" id="1979055">(</span><span class="ident" id="1979056">token</span><span class="op" id="1979061">.</span><span class="ident" id="1979062">RPAREN</span><span class="op" id="1979068">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1979072">}</span>&nbsp;<span class="keyword" id="1979074">else</span>&nbsp;<span class="op" id="1979079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1979084">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979112">p</span><span class="op" id="1979113">.</span><span class="builtinfunc" id="1979114">print</span><span class="op" id="1979119">(</span><span class="ident" id="1979120">token</span><span class="op" id="1979125">.</span><span class="ident" id="1979126">MUL</span><span class="op" id="1979129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979134">p</span><span class="op" id="1979135">.</span><span class="ident" id="1979136">expr</span><span class="op" id="1979140">(</span><span class="ident" id="1979141">x</span><span class="op" id="1979142">.</span><span class="ident" id="1979143">X</span><span class="op" id="1979144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1979148">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1979152">case</span>&nbsp;<span class="op" id="1979157">*</span><span class="ident" id="1979158">ast</span><span class="op" id="1979161">.</span><span class="ident" id="1979162">UnaryExpr</span><span class="op" id="1979171">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1979175">const</span>&nbsp;<span class="ident" id="1979181">prec</span>&nbsp;<span class="op" id="1979186">=</span>&nbsp;<span class="ident" id="1979188">token</span><span class="op" id="1979193">.</span><span class="ident" id="1979194">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1979206">if</span>&nbsp;<span class="ident" id="1979209">prec</span>&nbsp;<span class="op" id="1979214">&lt;</span>&nbsp;<span class="ident" id="1979216">prec1</span>&nbsp;<span class="op" id="1979222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1979227">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979252">p</span><span class="op" id="1979253">.</span><span class="builtinfunc" id="1979254">print</span><span class="op" id="1979259">(</span><span class="ident" id="1979260">token</span><span class="op" id="1979265">.</span><span class="ident" id="1979266">LPAREN</span><span class="op" id="1979272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979277">p</span><span class="op" id="1979278">.</span><span class="ident" id="1979279">expr</span><span class="op" id="1979283">(</span><span class="ident" id="1979284">x</span><span class="op" id="1979285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979290">p</span><span class="op" id="1979291">.</span><span class="builtinfunc" id="1979292">print</span><span class="op" id="1979297">(</span><span class="ident" id="1979298">token</span><span class="op" id="1979303">.</span><span class="ident" id="1979304">RPAREN</span><span class="op" id="1979310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1979314">}</span>&nbsp;<span class="keyword" id="1979316">else</span>&nbsp;<span class="op" id="1979321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1979326">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979354">p</span><span class="op" id="1979355">.</span><span class="builtinfunc" id="1979356">print</span><span class="op" id="1979361">(</span><span class="ident" id="1979362">x</span><span class="op" id="1979363">.</span><span class="ident" id="1979364">Op</span><span class="op" id="1979366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1979371">if</span>&nbsp;<span class="ident" id="1979374">x</span><span class="op" id="1979375">.</span><span class="ident" id="1979376">Op</span>&nbsp;<span class="op" id="1979379">==</span>&nbsp;<span class="ident" id="1979382">token</span><span class="op" id="1979387">.</span><span class="ident" id="1979388">RANGE</span>&nbsp;<span class="op" id="1979394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1979400">//&nbsp;TODO(gri)&nbsp;Remove&nbsp;this&nbsp;code&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;reached.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979459">p</span><span class="op" id="1979460">.</span><span class="builtinfunc" id="1979461">print</span><span class="op" id="1979466">(</span><span class="ident" id="1979467">blank</span><span class="op" id="1979472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1979477">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979482">p</span><span class="op" id="1979483">.</span><span class="ident" id="1979484">expr1</span><span class="op" id="1979489">(</span><span class="ident" id="1979490">x</span><span class="op" id="1979491">.</span><span class="ident" id="1979492">X</span><span class="op" id="1979493">,</span>&nbsp;<span class="ident" id="1979495">prec</span><span class="op" id="1979499">,</span>&nbsp;<span class="ident" id="1979501">depth</span><span class="op" id="1979506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1979510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1979514">case</span>&nbsp;<span class="op" id="1979519">*</span><span class="ident" id="1979520">ast</span><span class="op" id="1979523">.</span><span class="ident" id="1979524">BasicLit</span><span class="op" id="1979532">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979536">p</span><span class="op" id="1979537">.</span><span class="builtinfunc" id="1979538">print</span><span class="op" id="1979543">(</span><span class="ident" id="1979544">x</span><span class="op" id="1979545">)</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1979549">case</span>&nbsp;<span class="op" id="1979554">*</span><span class="ident" id="1979555">ast</span><span class="op" id="1979558">.</span><span class="ident" id="1979559">FuncLit</span><span class="op" id="1979566">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979570">p</span><span class="op" id="1979571">.</span><span class="ident" id="1979572">expr</span><span class="op" id="1979576">(</span><span class="ident" id="1979577">x</span><span class="op" id="1979578">.</span><span class="ident" id="1979579">Type</span><span class="op" id="1979583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979587">p</span><span class="op" id="1979588">.</span><span class="ident" id="1979589">adjBlock</span><span class="op" id="1979597">(</span><span class="ident" id="1979598">p</span><span class="op" id="1979599">.</span><span class="ident" id="1979600">distanceFrom</span><span class="op" id="1979612">(</span><span class="ident" id="1979613">x</span><span class="op" id="1979614">.</span><span class="ident" id="1979615">Type</span><span class="op" id="1979619">.</span><span class="ident" id="1979620">Pos</span><span class="op" id="1979623">(</span><span class="op" id="1979624">)</span><span class="op" id="1979625">)</span><span class="op" id="1979626">,</span>&nbsp;<span class="ident" id="1979628">blank</span><span class="op" id="1979633">,</span>&nbsp;<span class="ident" id="1979635">x</span><span class="op" id="1979636">.</span><span class="ident" id="1979637">Body</span><span class="op" id="1979641">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1979645">case</span>&nbsp;<span class="op" id="1979650">*</span><span class="ident" id="1979651">ast</span><span class="op" id="1979654">.</span><span class="ident" id="1979655">ParenExpr</span><span class="op" id="1979664">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1979668">if</span>&nbsp;<span class="ident" id="1979671">_</span><span class="op" id="1979672">,</span>&nbsp;<span class="ident" id="1979674">hasParens</span>&nbsp;<span class="op" id="1979684">:=</span>&nbsp;<span class="ident" id="1979687">x</span><span class="op" id="1979688">.</span><span class="ident" id="1979689">X</span><span class="op" id="1979690">.</span><span class="op" id="1979691">(</span><span class="op" id="1979692">*</span><span class="ident" id="1979693">ast</span><span class="op" id="1979696">.</span><span class="ident" id="1979697">ParenExpr</span><span class="op" id="1979706">)</span><span class="op" id="1979707">;</span>&nbsp;<span class="ident" id="1979709">hasParens</span>&nbsp;<span class="op" id="1979719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1979724">//&nbsp;don&#39;t&nbsp;print&nbsp;parentheses&nbsp;around&nbsp;an&nbsp;already&nbsp;parenthesized&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1979797">//&nbsp;TODO(gri)&nbsp;consider&nbsp;making&nbsp;this&nbsp;more&nbsp;general&nbsp;and&nbsp;incorporate&nbsp;precedence&nbsp;levels</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979881">p</span><span class="op" id="1979882">.</span><span class="ident" id="1979883">expr0</span><span class="op" id="1979888">(</span><span class="ident" id="1979889">x</span><span class="op" id="1979890">.</span><span class="ident" id="1979891">X</span><span class="op" id="1979892">,</span>&nbsp;<span class="ident" id="1979894">depth</span><span class="op" id="1979899">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1979903">}</span>&nbsp;<span class="keyword" id="1979905">else</span>&nbsp;<span class="op" id="1979910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979915">p</span><span class="op" id="1979916">.</span><span class="builtinfunc" id="1979917">print</span><span class="op" id="1979922">(</span><span class="ident" id="1979923">token</span><span class="op" id="1979928">.</span><span class="ident" id="1979929">LPAREN</span><span class="op" id="1979935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1979940">p</span><span class="op" id="1979941">.</span><span class="ident" id="1979942">expr0</span><span class="op" id="1979947">(</span><span class="ident" id="1979948">x</span><span class="op" id="1979949">.</span><span class="ident" id="1979950">X</span><span class="op" id="1979951">,</span>&nbsp;<span class="ident" id="1979953">reduceDepth</span><span class="op" id="1979964">(</span><span class="ident" id="1979965">depth</span><span class="op" id="1979970">)</span><span class="op" id="1979971">)</span>&nbsp;<span class="comment" id="1979973">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980015">p</span><span class="op" id="1980016">.</span><span class="builtinfunc" id="1980017">print</span><span class="op" id="1980022">(</span><span class="ident" id="1980023">x</span><span class="op" id="1980024">.</span><span class="ident" id="1980025">Rparen</span><span class="op" id="1980031">,</span>&nbsp;<span class="ident" id="1980033">token</span><span class="op" id="1980038">.</span><span class="ident" id="1980039">RPAREN</span><span class="op" id="1980045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1980049">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980053">case</span>&nbsp;<span class="op" id="1980058">*</span><span class="ident" id="1980059">ast</span><span class="op" id="1980062">.</span><span class="ident" id="1980063">SelectorExpr</span><span class="op" id="1980075">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980079">p</span><span class="op" id="1980080">.</span><span class="ident" id="1980081">expr1</span><span class="op" id="1980086">(</span><span class="ident" id="1980087">x</span><span class="op" id="1980088">.</span><span class="ident" id="1980089">X</span><span class="op" id="1980090">,</span>&nbsp;<span class="ident" id="1980092">token</span><span class="op" id="1980097">.</span><span class="ident" id="1980098">HighestPrec</span><span class="op" id="1980109">,</span>&nbsp;<span class="ident" id="1980111">depth</span><span class="op" id="1980116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980120">p</span><span class="op" id="1980121">.</span><span class="builtinfunc" id="1980122">print</span><span class="op" id="1980127">(</span><span class="ident" id="1980128">token</span><span class="op" id="1980133">.</span><span class="ident" id="1980134">PERIOD</span><span class="op" id="1980140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980144">if</span>&nbsp;<span class="ident" id="1980147">line</span>&nbsp;<span class="op" id="1980152">:=</span>&nbsp;<span class="ident" id="1980155">p</span><span class="op" id="1980156">.</span><span class="ident" id="1980157">lineFor</span><span class="op" id="1980164">(</span><span class="ident" id="1980165">x</span><span class="op" id="1980166">.</span><span class="ident" id="1980167">Sel</span><span class="op" id="1980170">.</span><span class="ident" id="1980171">Pos</span><span class="op" id="1980174">(</span><span class="op" id="1980175">)</span><span class="op" id="1980176">)</span><span class="op" id="1980177">;</span>&nbsp;<span class="ident" id="1980179">p</span><span class="op" id="1980180">.</span><span class="ident" id="1980181">pos</span><span class="op" id="1980184">.</span><span class="ident" id="1980185">IsValid</span><span class="op" id="1980192">(</span><span class="op" id="1980193">)</span>&nbsp;<span class="op" id="1980195">&amp;&amp;</span>&nbsp;<span class="ident" id="1980198">p</span><span class="op" id="1980199">.</span><span class="ident" id="1980200">pos</span><span class="op" id="1980203">.</span><span class="ident" id="1980204">Line</span>&nbsp;<span class="op" id="1980209">&lt;</span>&nbsp;<span class="ident" id="1980211">line</span>&nbsp;<span class="op" id="1980216">{</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980221">p</span><span class="op" id="1980222">.</span><span class="builtinfunc" id="1980223">print</span><span class="op" id="1980228">(</span><span class="ident" id="1980229">indent</span><span class="op" id="1980235">,</span>&nbsp;<span class="ident" id="1980237">newline</span><span class="op" id="1980244">,</span>&nbsp;<span class="ident" id="1980246">x</span><span class="op" id="1980247">.</span><span class="ident" id="1980248">Sel</span><span class="op" id="1980251">.</span><span class="ident" id="1980252">Pos</span><span class="op" id="1980255">(</span><span class="op" id="1980256">)</span><span class="op" id="1980257">,</span>&nbsp;<span class="ident" id="1980259">x</span><span class="op" id="1980260">.</span><span class="ident" id="1980261">Sel</span><span class="op" id="1980264">,</span>&nbsp;<span class="ident" id="1980266">unindent</span><span class="op" id="1980274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1980278">}</span>&nbsp;<span class="keyword" id="1980280">else</span>&nbsp;<span class="op" id="1980285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980290">p</span><span class="op" id="1980291">.</span><span class="builtinfunc" id="1980292">print</span><span class="op" id="1980297">(</span><span class="ident" id="1980298">x</span><span class="op" id="1980299">.</span><span class="ident" id="1980300">Sel</span><span class="op" id="1980303">.</span><span class="ident" id="1980304">Pos</span><span class="op" id="1980307">(</span><span class="op" id="1980308">)</span><span class="op" id="1980309">,</span>&nbsp;<span class="ident" id="1980311">x</span><span class="op" id="1980312">.</span><span class="ident" id="1980313">Sel</span><span class="op" id="1980316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1980320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980324">case</span>&nbsp;<span class="op" id="1980329">*</span><span class="ident" id="1980330">ast</span><span class="op" id="1980333">.</span><span class="ident" id="1980334">TypeAssertExpr</span><span class="op" id="1980348">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980352">p</span><span class="op" id="1980353">.</span><span class="ident" id="1980354">expr1</span><span class="op" id="1980359">(</span><span class="ident" id="1980360">x</span><span class="op" id="1980361">.</span><span class="ident" id="1980362">X</span><span class="op" id="1980363">,</span>&nbsp;<span class="ident" id="1980365">token</span><span class="op" id="1980370">.</span><span class="ident" id="1980371">HighestPrec</span><span class="op" id="1980382">,</span>&nbsp;<span class="ident" id="1980384">depth</span><span class="op" id="1980389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980393">p</span><span class="op" id="1980394">.</span><span class="builtinfunc" id="1980395">print</span><span class="op" id="1980400">(</span><span class="ident" id="1980401">token</span><span class="op" id="1980406">.</span><span class="ident" id="1980407">PERIOD</span><span class="op" id="1980413">,</span>&nbsp;<span class="ident" id="1980415">x</span><span class="op" id="1980416">.</span><span class="ident" id="1980417">Lparen</span><span class="op" id="1980423">,</span>&nbsp;<span class="ident" id="1980425">token</span><span class="op" id="1980430">.</span><span class="ident" id="1980431">LPAREN</span><span class="op" id="1980437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980441">if</span>&nbsp;<span class="ident" id="1980444">x</span><span class="op" id="1980445">.</span><span class="ident" id="1980446">Type</span>&nbsp;<span class="op" id="1980451">!=</span>&nbsp;<span class="ident" id="1980454">nil</span>&nbsp;<span class="op" id="1980458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980463">p</span><span class="op" id="1980464">.</span><span class="ident" id="1980465">expr</span><span class="op" id="1980469">(</span><span class="ident" id="1980470">x</span><span class="op" id="1980471">.</span><span class="ident" id="1980472">Type</span><span class="op" id="1980476">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1980480">}</span>&nbsp;<span class="keyword" id="1980482">else</span>&nbsp;<span class="op" id="1980487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980492">p</span><span class="op" id="1980493">.</span><span class="builtinfunc" id="1980494">print</span><span class="op" id="1980499">(</span><span class="ident" id="1980500">token</span><span class="op" id="1980505">.</span><span class="ident" id="1980506">TYPE</span><span class="op" id="1980510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1980514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980518">p</span><span class="op" id="1980519">.</span><span class="builtinfunc" id="1980520">print</span><span class="op" id="1980525">(</span><span class="ident" id="1980526">x</span><span class="op" id="1980527">.</span><span class="ident" id="1980528">Rparen</span><span class="op" id="1980534">,</span>&nbsp;<span class="ident" id="1980536">token</span><span class="op" id="1980541">.</span><span class="ident" id="1980542">RPAREN</span><span class="op" id="1980548">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980552">case</span>&nbsp;<span class="op" id="1980557">*</span><span class="ident" id="1980558">ast</span><span class="op" id="1980561">.</span><span class="ident" id="1980562">IndexExpr</span><span class="op" id="1980571">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1980575">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980651">p</span><span class="op" id="1980652">.</span><span class="ident" id="1980653">expr1</span><span class="op" id="1980658">(</span><span class="ident" id="1980659">x</span><span class="op" id="1980660">.</span><span class="ident" id="1980661">X</span><span class="op" id="1980662">,</span>&nbsp;<span class="ident" id="1980664">token</span><span class="op" id="1980669">.</span><span class="ident" id="1980670">HighestPrec</span><span class="op" id="1980681">,</span>&nbsp;<span class="num" id="1980683">1</span><span class="op" id="1980684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980688">p</span><span class="op" id="1980689">.</span><span class="builtinfunc" id="1980690">print</span><span class="op" id="1980695">(</span><span class="ident" id="1980696">x</span><span class="op" id="1980697">.</span><span class="ident" id="1980698">Lbrack</span><span class="op" id="1980704">,</span>&nbsp;<span class="ident" id="1980706">token</span><span class="op" id="1980711">.</span><span class="ident" id="1980712">LBRACK</span><span class="op" id="1980718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980722">p</span><span class="op" id="1980723">.</span><span class="ident" id="1980724">expr0</span><span class="op" id="1980729">(</span><span class="ident" id="1980730">x</span><span class="op" id="1980731">.</span><span class="ident" id="1980732">Index</span><span class="op" id="1980737">,</span>&nbsp;<span class="ident" id="1980739">depth</span><span class="op" id="1980744">+</span><span class="num" id="1980745">1</span><span class="op" id="1980746">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980750">p</span><span class="op" id="1980751">.</span><span class="builtinfunc" id="1980752">print</span><span class="op" id="1980757">(</span><span class="ident" id="1980758">x</span><span class="op" id="1980759">.</span><span class="ident" id="1980760">Rbrack</span><span class="op" id="1980766">,</span>&nbsp;<span class="ident" id="1980768">token</span><span class="op" id="1980773">.</span><span class="ident" id="1980774">RBRACK</span><span class="op" id="1980780">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980784">case</span>&nbsp;<span class="op" id="1980789">*</span><span class="ident" id="1980790">ast</span><span class="op" id="1980793">.</span><span class="ident" id="1980794">SliceExpr</span><span class="op" id="1980803">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1980807">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980883">p</span><span class="op" id="1980884">.</span><span class="ident" id="1980885">expr1</span><span class="op" id="1980890">(</span><span class="ident" id="1980891">x</span><span class="op" id="1980892">.</span><span class="ident" id="1980893">X</span><span class="op" id="1980894">,</span>&nbsp;<span class="ident" id="1980896">token</span><span class="op" id="1980901">.</span><span class="ident" id="1980902">HighestPrec</span><span class="op" id="1980913">,</span>&nbsp;<span class="num" id="1980915">1</span><span class="op" id="1980916">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980920">p</span><span class="op" id="1980921">.</span><span class="builtinfunc" id="1980922">print</span><span class="op" id="1980927">(</span><span class="ident" id="1980928">x</span><span class="op" id="1980929">.</span><span class="ident" id="1980930">Lbrack</span><span class="op" id="1980936">,</span>&nbsp;<span class="ident" id="1980938">token</span><span class="op" id="1980943">.</span><span class="ident" id="1980944">LBRACK</span><span class="op" id="1980950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1980954">indices</span>&nbsp;<span class="op" id="1980962">:=</span>&nbsp;<span class="op" id="1980965">[</span><span class="op" id="1980966">]</span><span class="ident" id="1980967">ast</span><span class="op" id="1980970">.</span><span class="ident" id="1980971">Expr</span><span class="op" id="1980975">{</span><span class="ident" id="1980976">x</span><span class="op" id="1980977">.</span><span class="ident" id="1980978">Low</span><span class="op" id="1980981">,</span>&nbsp;<span class="ident" id="1980983">x</span><span class="op" id="1980984">.</span><span class="ident" id="1980985">High</span><span class="op" id="1980989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1980993">if</span>&nbsp;<span class="ident" id="1980996">x</span><span class="op" id="1980997">.</span><span class="ident" id="1980998">Max</span>&nbsp;<span class="op" id="1981002">!=</span>&nbsp;<span class="ident" id="1981005">nil</span>&nbsp;<span class="op" id="1981009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981014">indices</span>&nbsp;<span class="op" id="1981022">=</span>&nbsp;<span class="builtinfunc" id="1981024">append</span><span class="op" id="1981030">(</span><span class="ident" id="1981031">indices</span><span class="op" id="1981038">,</span>&nbsp;<span class="ident" id="1981040">x</span><span class="op" id="1981041">.</span><span class="ident" id="1981042">Max</span><span class="op" id="1981045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1981049">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1981053">for</span>&nbsp;<span class="ident" id="1981057">i</span><span class="op" id="1981058">,</span>&nbsp;<span class="ident" id="1981060">y</span>&nbsp;<span class="op" id="1981062">:=</span>&nbsp;<span class="keyword" id="1981065">range</span>&nbsp;<span class="ident" id="1981071">indices</span>&nbsp;<span class="op" id="1981079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1981084">if</span>&nbsp;<span class="ident" id="1981087">i</span>&nbsp;<span class="op" id="1981089">&gt;</span>&nbsp;<span class="num" id="1981091">0</span>&nbsp;<span class="op" id="1981093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1981099">//&nbsp;blanks&nbsp;around&nbsp;&#34;:&#34;&nbsp;if&nbsp;both&nbsp;sides&nbsp;exist&nbsp;and&nbsp;either&nbsp;side&nbsp;is&nbsp;a&nbsp;binary&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1981183">//&nbsp;TODO(gri)&nbsp;once&nbsp;we&nbsp;have&nbsp;committed&nbsp;a&nbsp;variant&nbsp;of&nbsp;a[i:j:k]&nbsp;we&nbsp;may&nbsp;want&nbsp;to&nbsp;fine-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1981266">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tune&nbsp;the&nbsp;formatting&nbsp;here</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981308">x</span>&nbsp;<span class="op" id="1981310">:=</span>&nbsp;<span class="ident" id="1981313">indices</span><span class="op" id="1981320">[</span><span class="ident" id="1981321">i</span><span class="op" id="1981322">-</span><span class="num" id="1981323">1</span><span class="op" id="1981324">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1981330">if</span>&nbsp;<span class="ident" id="1981333">depth</span>&nbsp;<span class="op" id="1981339">&lt;=</span>&nbsp;<span class="num" id="1981342">1</span>&nbsp;<span class="op" id="1981344">&amp;&amp;</span>&nbsp;<span class="ident" id="1981347">x</span>&nbsp;<span class="op" id="1981349">!=</span>&nbsp;<span class="ident" id="1981352">nil</span>&nbsp;<span class="op" id="1981356">&amp;&amp;</span>&nbsp;<span class="ident" id="1981359">y</span>&nbsp;<span class="op" id="1981361">!=</span>&nbsp;<span class="ident" id="1981364">nil</span>&nbsp;<span class="op" id="1981368">&amp;&amp;</span>&nbsp;<span class="op" id="1981371">(</span><span class="ident" id="1981372">isBinary</span><span class="op" id="1981380">(</span><span class="ident" id="1981381">x</span><span class="op" id="1981382">)</span>&nbsp;<span class="op" id="1981384">||</span>&nbsp;<span class="ident" id="1981387">isBinary</span><span class="op" id="1981395">(</span><span class="ident" id="1981396">y</span><span class="op" id="1981397">)</span><span class="op" id="1981398">)</span>&nbsp;<span class="op" id="1981400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981407">p</span><span class="op" id="1981408">.</span><span class="builtinfunc" id="1981409">print</span><span class="op" id="1981414">(</span><span class="ident" id="1981415">blank</span><span class="op" id="1981420">,</span>&nbsp;<span class="ident" id="1981422">token</span><span class="op" id="1981427">.</span><span class="ident" id="1981428">COLON</span><span class="op" id="1981433">,</span>&nbsp;<span class="ident" id="1981435">blank</span><span class="op" id="1981440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1981446">}</span>&nbsp;<span class="keyword" id="1981448">else</span>&nbsp;<span class="op" id="1981453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981460">p</span><span class="op" id="1981461">.</span><span class="builtinfunc" id="1981462">print</span><span class="op" id="1981467">(</span><span class="ident" id="1981468">token</span><span class="op" id="1981473">.</span><span class="ident" id="1981474">COLON</span><span class="op" id="1981479">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1981485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1981490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1981495">if</span>&nbsp;<span class="ident" id="1981498">y</span>&nbsp;<span class="op" id="1981500">!=</span>&nbsp;<span class="ident" id="1981503">nil</span>&nbsp;<span class="op" id="1981507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981513">p</span><span class="op" id="1981514">.</span><span class="ident" id="1981515">expr0</span><span class="op" id="1981520">(</span><span class="ident" id="1981521">y</span><span class="op" id="1981522">,</span>&nbsp;<span class="ident" id="1981524">depth</span><span class="op" id="1981529">+</span><span class="num" id="1981530">1</span><span class="op" id="1981531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1981536">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1981540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981544">p</span><span class="op" id="1981545">.</span><span class="builtinfunc" id="1981546">print</span><span class="op" id="1981551">(</span><span class="ident" id="1981552">x</span><span class="op" id="1981553">.</span><span class="ident" id="1981554">Rbrack</span><span class="op" id="1981560">,</span>&nbsp;<span class="ident" id="1981562">token</span><span class="op" id="1981567">.</span><span class="ident" id="1981568">RBRACK</span><span class="op" id="1981574">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1981578">case</span>&nbsp;<span class="op" id="1981583">*</span><span class="ident" id="1981584">ast</span><span class="op" id="1981587">.</span><span class="ident" id="1981588">CallExpr</span><span class="op" id="1981596">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1981600">if</span>&nbsp;<span class="builtinfunc" id="1981603">len</span><span class="op" id="1981606">(</span><span class="ident" id="1981607">x</span><span class="op" id="1981608">.</span><span class="ident" id="1981609">Args</span><span class="op" id="1981613">)</span>&nbsp;<span class="op" id="1981615">&gt;</span>&nbsp;<span class="num" id="1981617">1</span>&nbsp;<span class="op" id="1981619">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981624">depth</span><span class="op" id="1981629">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1981634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1981638">if</span>&nbsp;<span class="ident" id="1981641">_</span><span class="op" id="1981642">,</span>&nbsp;<span class="ident" id="1981644">ok</span>&nbsp;<span class="op" id="1981647">:=</span>&nbsp;<span class="ident" id="1981650">x</span><span class="op" id="1981651">.</span><span class="ident" id="1981652">Fun</span><span class="op" id="1981655">.</span><span class="op" id="1981656">(</span><span class="op" id="1981657">*</span><span class="ident" id="1981658">ast</span><span class="op" id="1981661">.</span><span class="ident" id="1981662">FuncType</span><span class="op" id="1981670">)</span><span class="op" id="1981671">;</span>&nbsp;<span class="ident" id="1981673">ok</span>&nbsp;<span class="op" id="1981676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1981681">//&nbsp;conversions&nbsp;to&nbsp;literal&nbsp;function&nbsp;types&nbsp;require&nbsp;parentheses&nbsp;around&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981761">p</span><span class="op" id="1981762">.</span><span class="builtinfunc" id="1981763">print</span><span class="op" id="1981768">(</span><span class="ident" id="1981769">token</span><span class="op" id="1981774">.</span><span class="ident" id="1981775">LPAREN</span><span class="op" id="1981781">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981786">p</span><span class="op" id="1981787">.</span><span class="ident" id="1981788">expr1</span><span class="op" id="1981793">(</span><span class="ident" id="1981794">x</span><span class="op" id="1981795">.</span><span class="ident" id="1981796">Fun</span><span class="op" id="1981799">,</span>&nbsp;<span class="ident" id="1981801">token</span><span class="op" id="1981806">.</span><span class="ident" id="1981807">HighestPrec</span><span class="op" id="1981818">,</span>&nbsp;<span class="ident" id="1981820">depth</span><span class="op" id="1981825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981830">p</span><span class="op" id="1981831">.</span><span class="builtinfunc" id="1981832">print</span><span class="op" id="1981837">(</span><span class="ident" id="1981838">token</span><span class="op" id="1981843">.</span><span class="ident" id="1981844">RPAREN</span><span class="op" id="1981850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1981854">}</span>&nbsp;<span class="keyword" id="1981856">else</span>&nbsp;<span class="op" id="1981861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981866">p</span><span class="op" id="1981867">.</span><span class="ident" id="1981868">expr1</span><span class="op" id="1981873">(</span><span class="ident" id="1981874">x</span><span class="op" id="1981875">.</span><span class="ident" id="1981876">Fun</span><span class="op" id="1981879">,</span>&nbsp;<span class="ident" id="1981881">token</span><span class="op" id="1981886">.</span><span class="ident" id="1981887">HighestPrec</span><span class="op" id="1981898">,</span>&nbsp;<span class="ident" id="1981900">depth</span><span class="op" id="1981905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1981909">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981913">p</span><span class="op" id="1981914">.</span><span class="builtinfunc" id="1981915">print</span><span class="op" id="1981920">(</span><span class="ident" id="1981921">x</span><span class="op" id="1981922">.</span><span class="ident" id="1981923">Lparen</span><span class="op" id="1981929">,</span>&nbsp;<span class="ident" id="1981931">token</span><span class="op" id="1981936">.</span><span class="ident" id="1981937">LPAREN</span><span class="op" id="1981943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1981947">if</span>&nbsp;<span class="ident" id="1981950">x</span><span class="op" id="1981951">.</span><span class="ident" id="1981952">Ellipsis</span><span class="op" id="1981960">.</span><span class="ident" id="1981961">IsValid</span><span class="op" id="1981968">(</span><span class="op" id="1981969">)</span>&nbsp;<span class="op" id="1981971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1981976">p</span><span class="op" id="1981977">.</span><span class="ident" id="1981978">exprList</span><span class="op" id="1981986">(</span><span class="ident" id="1981987">x</span><span class="op" id="1981988">.</span><span class="ident" id="1981989">Lparen</span><span class="op" id="1981995">,</span>&nbsp;<span class="ident" id="1981997">x</span><span class="op" id="1981998">.</span><span class="ident" id="1981999">Args</span><span class="op" id="1982003">,</span>&nbsp;<span class="ident" id="1982005">depth</span><span class="op" id="1982010">,</span>&nbsp;<span class="num" id="1982012">0</span><span class="op" id="1982013">,</span>&nbsp;<span class="ident" id="1982015">x</span><span class="op" id="1982016">.</span><span class="ident" id="1982017">Ellipsis</span><span class="op" id="1982025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982030">p</span><span class="op" id="1982031">.</span><span class="builtinfunc" id="1982032">print</span><span class="op" id="1982037">(</span><span class="ident" id="1982038">x</span><span class="op" id="1982039">.</span><span class="ident" id="1982040">Ellipsis</span><span class="op" id="1982048">,</span>&nbsp;<span class="ident" id="1982050">token</span><span class="op" id="1982055">.</span><span class="ident" id="1982056">ELLIPSIS</span><span class="op" id="1982064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1982069">if</span>&nbsp;<span class="ident" id="1982072">x</span><span class="op" id="1982073">.</span><span class="ident" id="1982074">Rparen</span><span class="op" id="1982080">.</span><span class="ident" id="1982081">IsValid</span><span class="op" id="1982088">(</span><span class="op" id="1982089">)</span>&nbsp;<span class="op" id="1982091">&amp;&amp;</span>&nbsp;<span class="ident" id="1982094">p</span><span class="op" id="1982095">.</span><span class="ident" id="1982096">lineFor</span><span class="op" id="1982103">(</span><span class="ident" id="1982104">x</span><span class="op" id="1982105">.</span><span class="ident" id="1982106">Ellipsis</span><span class="op" id="1982114">)</span>&nbsp;<span class="op" id="1982116">&lt;</span>&nbsp;<span class="ident" id="1982118">p</span><span class="op" id="1982119">.</span><span class="ident" id="1982120">lineFor</span><span class="op" id="1982127">(</span><span class="ident" id="1982128">x</span><span class="op" id="1982129">.</span><span class="ident" id="1982130">Rparen</span><span class="op" id="1982136">)</span>&nbsp;<span class="op" id="1982138">{</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982144">p</span><span class="op" id="1982145">.</span><span class="builtinfunc" id="1982146">print</span><span class="op" id="1982151">(</span><span class="ident" id="1982152">token</span><span class="op" id="1982157">.</span><span class="ident" id="1982158">COMMA</span><span class="op" id="1982163">,</span>&nbsp;<span class="ident" id="1982165">formfeed</span><span class="op" id="1982173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1982178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1982182">}</span>&nbsp;<span class="keyword" id="1982184">else</span>&nbsp;<span class="op" id="1982189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982194">p</span><span class="op" id="1982195">.</span><span class="ident" id="1982196">exprList</span><span class="op" id="1982204">(</span><span class="ident" id="1982205">x</span><span class="op" id="1982206">.</span><span class="ident" id="1982207">Lparen</span><span class="op" id="1982213">,</span>&nbsp;<span class="ident" id="1982215">x</span><span class="op" id="1982216">.</span><span class="ident" id="1982217">Args</span><span class="op" id="1982221">,</span>&nbsp;<span class="ident" id="1982223">depth</span><span class="op" id="1982228">,</span>&nbsp;<span class="ident" id="1982230">commaTerm</span><span class="op" id="1982239">,</span>&nbsp;<span class="ident" id="1982241">x</span><span class="op" id="1982242">.</span><span class="ident" id="1982243">Rparen</span><span class="op" id="1982249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1982253">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982257">p</span><span class="op" id="1982258">.</span><span class="builtinfunc" id="1982259">print</span><span class="op" id="1982264">(</span><span class="ident" id="1982265">x</span><span class="op" id="1982266">.</span><span class="ident" id="1982267">Rparen</span><span class="op" id="1982273">,</span>&nbsp;<span class="ident" id="1982275">token</span><span class="op" id="1982280">.</span><span class="ident" id="1982281">RPAREN</span><span class="op" id="1982287">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1982291">case</span>&nbsp;<span class="op" id="1982296">*</span><span class="ident" id="1982297">ast</span><span class="op" id="1982300">.</span><span class="ident" id="1982301">CompositeLit</span><span class="op" id="1982313">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1982317">//&nbsp;composite&nbsp;literal&nbsp;elements&nbsp;that&nbsp;are&nbsp;composite&nbsp;literals&nbsp;themselves&nbsp;may&nbsp;have&nbsp;the&nbsp;type&nbsp;omitted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1982414">if</span>&nbsp;<span class="ident" id="1982417">x</span><span class="op" id="1982418">.</span><span class="ident" id="1982419">Type</span>&nbsp;<span class="op" id="1982424">!=</span>&nbsp;<span class="ident" id="1982427">nil</span>&nbsp;<span class="op" id="1982431">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982436">p</span><span class="op" id="1982437">.</span><span class="ident" id="1982438">expr1</span><span class="op" id="1982443">(</span><span class="ident" id="1982444">x</span><span class="op" id="1982445">.</span><span class="ident" id="1982446">Type</span><span class="op" id="1982450">,</span>&nbsp;<span class="ident" id="1982452">token</span><span class="op" id="1982457">.</span><span class="ident" id="1982458">HighestPrec</span><span class="op" id="1982469">,</span>&nbsp;<span class="ident" id="1982471">depth</span><span class="op" id="1982476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1982480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982484">p</span><span class="op" id="1982485">.</span><span class="builtinfunc" id="1982486">print</span><span class="op" id="1982491">(</span><span class="ident" id="1982492">x</span><span class="op" id="1982493">.</span><span class="ident" id="1982494">Lbrace</span><span class="op" id="1982500">,</span>&nbsp;<span class="ident" id="1982502">token</span><span class="op" id="1982507">.</span><span class="ident" id="1982508">LBRACE</span><span class="op" id="1982514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982518">p</span><span class="op" id="1982519">.</span><span class="ident" id="1982520">exprList</span><span class="op" id="1982528">(</span><span class="ident" id="1982529">x</span><span class="op" id="1982530">.</span><span class="ident" id="1982531">Lbrace</span><span class="op" id="1982537">,</span>&nbsp;<span class="ident" id="1982539">x</span><span class="op" id="1982540">.</span><span class="ident" id="1982541">Elts</span><span class="op" id="1982545">,</span>&nbsp;<span class="num" id="1982547">1</span><span class="op" id="1982548">,</span>&nbsp;<span class="ident" id="1982550">commaTerm</span><span class="op" id="1982559">,</span>&nbsp;<span class="ident" id="1982561">x</span><span class="op" id="1982562">.</span><span class="ident" id="1982563">Rbrace</span><span class="op" id="1982569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1982573">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;line&nbsp;break&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1982638">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;as&nbsp;it&nbsp;might&nbsp;break&nbsp;the&nbsp;code&nbsp;if&nbsp;there</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1982702">//&nbsp;is&nbsp;no&nbsp;trailing&nbsp;&#39;,&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982726">mode</span>&nbsp;<span class="op" id="1982731">:=</span>&nbsp;<span class="ident" id="1982734">noExtraLinebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1982753">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;blank&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1982813">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;unless&nbsp;the&nbsp;literal&nbsp;is&nbsp;empty</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1982869">if</span>&nbsp;<span class="builtinfunc" id="1982872">len</span><span class="op" id="1982875">(</span><span class="ident" id="1982876">x</span><span class="op" id="1982877">.</span><span class="ident" id="1982878">Elts</span><span class="op" id="1982882">)</span>&nbsp;<span class="op" id="1982884">&gt;</span>&nbsp;<span class="num" id="1982886">0</span>&nbsp;<span class="op" id="1982888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982893">mode</span>&nbsp;<span class="op" id="1982898">|=</span>&nbsp;<span class="ident" id="1982901">noExtraBlank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1982916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982920">p</span><span class="op" id="1982921">.</span><span class="builtinfunc" id="1982922">print</span><span class="op" id="1982927">(</span><span class="ident" id="1982928">mode</span><span class="op" id="1982932">,</span>&nbsp;<span class="ident" id="1982934">x</span><span class="op" id="1982935">.</span><span class="ident" id="1982936">Rbrace</span><span class="op" id="1982942">,</span>&nbsp;<span class="ident" id="1982944">token</span><span class="op" id="1982949">.</span><span class="ident" id="1982950">RBRACE</span><span class="op" id="1982956">,</span>&nbsp;<span class="ident" id="1982958">mode</span><span class="op" id="1982962">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1982966">case</span>&nbsp;<span class="op" id="1982971">*</span><span class="ident" id="1982972">ast</span><span class="op" id="1982975">.</span><span class="ident" id="1982976">Ellipsis</span><span class="op" id="1982984">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1982988">p</span><span class="op" id="1982989">.</span><span class="builtinfunc" id="1982990">print</span><span class="op" id="1982995">(</span><span class="ident" id="1982996">token</span><span class="op" id="1983001">.</span><span class="ident" id="1983002">ELLIPSIS</span><span class="op" id="1983010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1983014">if</span>&nbsp;<span class="ident" id="1983017">x</span><span class="op" id="1983018">.</span><span class="ident" id="1983019">Elt</span>&nbsp;<span class="op" id="1983023">!=</span>&nbsp;<span class="ident" id="1983026">nil</span>&nbsp;<span class="op" id="1983030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983035">p</span><span class="op" id="1983036">.</span><span class="ident" id="1983037">expr</span><span class="op" id="1983041">(</span><span class="ident" id="1983042">x</span><span class="op" id="1983043">.</span><span class="ident" id="1983044">Elt</span><span class="op" id="1983047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983051">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1983055">case</span>&nbsp;<span class="op" id="1983060">*</span><span class="ident" id="1983061">ast</span><span class="op" id="1983064">.</span><span class="ident" id="1983065">ArrayType</span><span class="op" id="1983074">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983078">p</span><span class="op" id="1983079">.</span><span class="builtinfunc" id="1983080">print</span><span class="op" id="1983085">(</span><span class="ident" id="1983086">token</span><span class="op" id="1983091">.</span><span class="ident" id="1983092">LBRACK</span><span class="op" id="1983098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1983102">if</span>&nbsp;<span class="ident" id="1983105">x</span><span class="op" id="1983106">.</span><span class="ident" id="1983107">Len</span>&nbsp;<span class="op" id="1983111">!=</span>&nbsp;<span class="ident" id="1983114">nil</span>&nbsp;<span class="op" id="1983118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983123">p</span><span class="op" id="1983124">.</span><span class="ident" id="1983125">expr</span><span class="op" id="1983129">(</span><span class="ident" id="1983130">x</span><span class="op" id="1983131">.</span><span class="ident" id="1983132">Len</span><span class="op" id="1983135">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983143">p</span><span class="op" id="1983144">.</span><span class="builtinfunc" id="1983145">print</span><span class="op" id="1983150">(</span><span class="ident" id="1983151">token</span><span class="op" id="1983156">.</span><span class="ident" id="1983157">RBRACK</span><span class="op" id="1983163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983167">p</span><span class="op" id="1983168">.</span><span class="ident" id="1983169">expr</span><span class="op" id="1983173">(</span><span class="ident" id="1983174">x</span><span class="op" id="1983175">.</span><span class="ident" id="1983176">Elt</span><span class="op" id="1983179">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1983183">case</span>&nbsp;<span class="op" id="1983188">*</span><span class="ident" id="1983189">ast</span><span class="op" id="1983192">.</span><span class="ident" id="1983193">StructType</span><span class="op" id="1983203">:</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983207">p</span><span class="op" id="1983208">.</span><span class="builtinfunc" id="1983209">print</span><span class="op" id="1983214">(</span><span class="ident" id="1983215">token</span><span class="op" id="1983220">.</span><span class="ident" id="1983221">STRUCT</span><span class="op" id="1983227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983231">p</span><span class="op" id="1983232">.</span><span class="ident" id="1983233">fieldList</span><span class="op" id="1983242">(</span><span class="ident" id="1983243">x</span><span class="op" id="1983244">.</span><span class="ident" id="1983245">Fields</span><span class="op" id="1983251">,</span>&nbsp;<span class="builtintype" id="1983253">true</span><span class="op" id="1983257">,</span>&nbsp;<span class="ident" id="1983259">x</span><span class="op" id="1983260">.</span><span class="ident" id="1983261">Incomplete</span><span class="op" id="1983271">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1983275">case</span>&nbsp;<span class="op" id="1983280">*</span><span class="ident" id="1983281">ast</span><span class="op" id="1983284">.</span><span class="ident" id="1983285">FuncType</span><span class="op" id="1983293">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983297">p</span><span class="op" id="1983298">.</span><span class="builtinfunc" id="1983299">print</span><span class="op" id="1983304">(</span><span class="ident" id="1983305">token</span><span class="op" id="1983310">.</span><span class="ident" id="1983311">FUNC</span><span class="op" id="1983315">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983319">p</span><span class="op" id="1983320">.</span><span class="ident" id="1983321">signature</span><span class="op" id="1983330">(</span><span class="ident" id="1983331">x</span><span class="op" id="1983332">.</span><span class="ident" id="1983333">Params</span><span class="op" id="1983339">,</span>&nbsp;<span class="ident" id="1983341">x</span><span class="op" id="1983342">.</span><span class="ident" id="1983343">Results</span><span class="op" id="1983350">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1983354">case</span>&nbsp;<span class="op" id="1983359">*</span><span class="ident" id="1983360">ast</span><span class="op" id="1983363">.</span><span class="ident" id="1983364">InterfaceType</span><span class="op" id="1983377">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983381">p</span><span class="op" id="1983382">.</span><span class="builtinfunc" id="1983383">print</span><span class="op" id="1983388">(</span><span class="ident" id="1983389">token</span><span class="op" id="1983394">.</span><span class="ident" id="1983395">INTERFACE</span><span class="op" id="1983404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983408">p</span><span class="op" id="1983409">.</span><span class="ident" id="1983410">fieldList</span><span class="op" id="1983419">(</span><span class="ident" id="1983420">x</span><span class="op" id="1983421">.</span><span class="ident" id="1983422">Methods</span><span class="op" id="1983429">,</span>&nbsp;<span class="builtintype" id="1983431">false</span><span class="op" id="1983436">,</span>&nbsp;<span class="ident" id="1983438">x</span><span class="op" id="1983439">.</span><span class="ident" id="1983440">Incomplete</span><span class="op" id="1983450">)</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1983454">case</span>&nbsp;<span class="op" id="1983459">*</span><span class="ident" id="1983460">ast</span><span class="op" id="1983463">.</span><span class="ident" id="1983464">MapType</span><span class="op" id="1983471">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983475">p</span><span class="op" id="1983476">.</span><span class="builtinfunc" id="1983477">print</span><span class="op" id="1983482">(</span><span class="ident" id="1983483">token</span><span class="op" id="1983488">.</span><span class="ident" id="1983489">MAP</span><span class="op" id="1983492">,</span>&nbsp;<span class="ident" id="1983494">token</span><span class="op" id="1983499">.</span><span class="ident" id="1983500">LBRACK</span><span class="op" id="1983506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983510">p</span><span class="op" id="1983511">.</span><span class="ident" id="1983512">expr</span><span class="op" id="1983516">(</span><span class="ident" id="1983517">x</span><span class="op" id="1983518">.</span><span class="ident" id="1983519">Key</span><span class="op" id="1983522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983526">p</span><span class="op" id="1983527">.</span><span class="builtinfunc" id="1983528">print</span><span class="op" id="1983533">(</span><span class="ident" id="1983534">token</span><span class="op" id="1983539">.</span><span class="ident" id="1983540">RBRACK</span><span class="op" id="1983546">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983550">p</span><span class="op" id="1983551">.</span><span class="ident" id="1983552">expr</span><span class="op" id="1983556">(</span><span class="ident" id="1983557">x</span><span class="op" id="1983558">.</span><span class="ident" id="1983559">Value</span><span class="op" id="1983564">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1983568">case</span>&nbsp;<span class="op" id="1983573">*</span><span class="ident" id="1983574">ast</span><span class="op" id="1983577">.</span><span class="ident" id="1983578">ChanType</span><span class="op" id="1983586">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1983590">switch</span>&nbsp;<span class="ident" id="1983597">x</span><span class="op" id="1983598">.</span><span class="ident" id="1983599">Dir</span>&nbsp;<span class="op" id="1983603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1983607">case</span>&nbsp;<span class="ident" id="1983612">ast</span><span class="op" id="1983615">.</span><span class="ident" id="1983616">SEND</span>&nbsp;<span class="op" id="1983621">|</span>&nbsp;<span class="ident" id="1983623">ast</span><span class="op" id="1983626">.</span><span class="ident" id="1983627">RECV</span><span class="op" id="1983631">:</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983636">p</span><span class="op" id="1983637">.</span><span class="builtinfunc" id="1983638">print</span><span class="op" id="1983643">(</span><span class="ident" id="1983644">token</span><span class="op" id="1983649">.</span><span class="ident" id="1983650">CHAN</span><span class="op" id="1983654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1983658">case</span>&nbsp;<span class="ident" id="1983663">ast</span><span class="op" id="1983666">.</span><span class="ident" id="1983667">RECV</span><span class="op" id="1983671">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983676">p</span><span class="op" id="1983677">.</span><span class="builtinfunc" id="1983678">print</span><span class="op" id="1983683">(</span><span class="ident" id="1983684">token</span><span class="op" id="1983689">.</span><span class="ident" id="1983690">ARROW</span><span class="op" id="1983695">,</span>&nbsp;<span class="ident" id="1983697">token</span><span class="op" id="1983702">.</span><span class="ident" id="1983703">CHAN</span><span class="op" id="1983707">)</span>&nbsp;<span class="comment" id="1983709">//&nbsp;x.Arrow&nbsp;and&nbsp;x.Pos()&nbsp;are&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1983747">case</span>&nbsp;<span class="ident" id="1983752">ast</span><span class="op" id="1983755">.</span><span class="ident" id="1983756">SEND</span><span class="op" id="1983760">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983765">p</span><span class="op" id="1983766">.</span><span class="builtinfunc" id="1983767">print</span><span class="op" id="1983772">(</span><span class="ident" id="1983773">token</span><span class="op" id="1983778">.</span><span class="ident" id="1983779">CHAN</span><span class="op" id="1983783">,</span>&nbsp;<span class="ident" id="1983785">x</span><span class="op" id="1983786">.</span><span class="ident" id="1983787">Arrow</span><span class="op" id="1983792">,</span>&nbsp;<span class="ident" id="1983794">token</span><span class="op" id="1983799">.</span><span class="ident" id="1983800">ARROW</span><span class="op" id="1983805">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983813">p</span><span class="op" id="1983814">.</span><span class="builtinfunc" id="1983815">print</span><span class="op" id="1983820">(</span><span class="ident" id="1983821">blank</span><span class="op" id="1983826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983830">p</span><span class="op" id="1983831">.</span><span class="ident" id="1983832">expr</span><span class="op" id="1983836">(</span><span class="ident" id="1983837">x</span><span class="op" id="1983838">.</span><span class="ident" id="1983839">Value</span><span class="op" id="1983844">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1983848">default</span><span class="op" id="1983855">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1983859">panic</span><span class="op" id="1983864">(</span><span class="string" id="1983865">&#34;unreachable&#34;</span><span class="op" id="1983878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1983881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1983885">return</span><br>
<span class="lineno"></span><span class="op" id="1983892">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span><span class="keyword" id="1983895">func</span>&nbsp;<span class="op" id="1983900">(</span><span class="ident" id="1983901">p</span>&nbsp;<span class="op" id="1983903">*</span><span class="ident" id="1983904">printer</span><span class="op" id="1983911">)</span>&nbsp;<span class="ident" id="1983913">expr0</span><span class="op" id="1983918">(</span><span class="ident" id="1983919">x</span>&nbsp;<span class="ident" id="1983921">ast</span><span class="op" id="1983924">.</span><span class="ident" id="1983925">Expr</span><span class="op" id="1983929">,</span>&nbsp;<span class="ident" id="1983931">depth</span>&nbsp;<span class="builtintype" id="1983937">int</span><span class="op" id="1983940">)</span>&nbsp;<span class="op" id="1983942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1983945">p</span><span class="op" id="1983946">.</span><span class="ident" id="1983947">expr1</span><span class="op" id="1983952">(</span><span class="ident" id="1983953">x</span><span class="op" id="1983954">,</span>&nbsp;<span class="ident" id="1983956">token</span><span class="op" id="1983961">.</span><span class="ident" id="1983962">LowestPrec</span><span class="op" id="1983972">,</span>&nbsp;<span class="ident" id="1983974">depth</span><span class="op" id="1983979">)</span><br>
<span class="lineno"></span><span class="op" id="1983981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span><span class="keyword" id="1983984">func</span>&nbsp;<span class="op" id="1983989">(</span><span class="ident" id="1983990">p</span>&nbsp;<span class="op" id="1983992">*</span><span class="ident" id="1983993">printer</span><span class="op" id="1984000">)</span>&nbsp;<span class="ident" id="1984002">expr</span><span class="op" id="1984006">(</span><span class="ident" id="1984007">x</span>&nbsp;<span class="ident" id="1984009">ast</span><span class="op" id="1984012">.</span><span class="ident" id="1984013">Expr</span><span class="op" id="1984017">)</span>&nbsp;<span class="op" id="1984019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1984022">const</span>&nbsp;<span class="ident" id="1984028">depth</span>&nbsp;<span class="op" id="1984034">=</span>&nbsp;<span class="num" id="1984036">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984039">p</span><span class="op" id="1984040">.</span><span class="ident" id="1984041">expr1</span><span class="op" id="1984046">(</span><span class="ident" id="1984047">x</span><span class="op" id="1984048">,</span>&nbsp;<span class="ident" id="1984050">token</span><span class="op" id="1984055">.</span><span class="ident" id="1984056">LowestPrec</span><span class="op" id="1984066">,</span>&nbsp;<span class="ident" id="1984068">depth</span><span class="op" id="1984073">)</span><br>
<span class="lineno"></span><span class="op" id="1984075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="1984078">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="1984158">//&nbsp;Statements</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1984173">//&nbsp;Print&nbsp;the&nbsp;statement&nbsp;list&nbsp;indented,&nbsp;but&nbsp;without&nbsp;a&nbsp;newline&nbsp;after&nbsp;the&nbsp;last&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="1984259">//&nbsp;Extra&nbsp;line&nbsp;breaks&nbsp;between&nbsp;statements&nbsp;in&nbsp;the&nbsp;source&nbsp;are&nbsp;respected&nbsp;but&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">905</span><span class="comment" id="1984343">//&nbsp;empty&nbsp;line&nbsp;is&nbsp;printed&nbsp;between&nbsp;statements.</span><br>
<span class="lineno"></span><span class="keyword" id="1984388">func</span>&nbsp;<span class="op" id="1984393">(</span><span class="ident" id="1984394">p</span>&nbsp;<span class="op" id="1984396">*</span><span class="ident" id="1984397">printer</span><span class="op" id="1984404">)</span>&nbsp;<span class="ident" id="1984406">stmtList</span><span class="op" id="1984414">(</span><span class="ident" id="1984415">list</span>&nbsp;<span class="op" id="1984420">[</span><span class="op" id="1984421">]</span><span class="ident" id="1984422">ast</span><span class="op" id="1984425">.</span><span class="ident" id="1984426">Stmt</span><span class="op" id="1984430">,</span>&nbsp;<span class="ident" id="1984432">nindent</span>&nbsp;<span class="builtintype" id="1984440">int</span><span class="op" id="1984443">,</span>&nbsp;<span class="ident" id="1984445">nextIsRBrace</span>&nbsp;<span class="builtintype" id="1984458">bool</span><span class="op" id="1984462">)</span>&nbsp;<span class="op" id="1984464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1984467">if</span>&nbsp;<span class="ident" id="1984470">nindent</span>&nbsp;<span class="op" id="1984478">&gt;</span>&nbsp;<span class="num" id="1984480">0</span>&nbsp;<span class="op" id="1984482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984486">p</span><span class="op" id="1984487">.</span><span class="builtinfunc" id="1984488">print</span><span class="op" id="1984493">(</span><span class="ident" id="1984494">indent</span><span class="op" id="1984500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1984503">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1984506">var</span>&nbsp;<span class="ident" id="1984510">line</span>&nbsp;<span class="builtintype" id="1984515">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984520">i</span>&nbsp;<span class="op" id="1984522">:=</span>&nbsp;<span class="num" id="1984525">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1984528">for</span>&nbsp;<span class="ident" id="1984532">_</span><span class="op" id="1984533">,</span>&nbsp;<span class="ident" id="1984535">s</span>&nbsp;<span class="op" id="1984537">:=</span>&nbsp;<span class="keyword" id="1984540">range</span>&nbsp;<span class="ident" id="1984546">list</span>&nbsp;<span class="op" id="1984551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1984555">//&nbsp;ignore&nbsp;empty&nbsp;statements&nbsp;(was&nbsp;issue&nbsp;3466)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1984601">if</span>&nbsp;<span class="ident" id="1984604">_</span><span class="op" id="1984605">,</span>&nbsp;<span class="ident" id="1984607">isEmpty</span>&nbsp;<span class="op" id="1984615">:=</span>&nbsp;<span class="ident" id="1984618">s</span><span class="op" id="1984619">.</span><span class="op" id="1984620">(</span><span class="op" id="1984621">*</span><span class="ident" id="1984622">ast</span><span class="op" id="1984625">.</span><span class="ident" id="1984626">EmptyStmt</span><span class="op" id="1984635">)</span><span class="op" id="1984636">;</span>&nbsp;<span class="op" id="1984638">!</span><span class="ident" id="1984639">isEmpty</span>&nbsp;<span class="op" id="1984647">{</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1984652">//&nbsp;nindent&nbsp;==&nbsp;0&nbsp;only&nbsp;for&nbsp;lists&nbsp;of&nbsp;switch/select&nbsp;case&nbsp;clauses;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1984717">//&nbsp;in&nbsp;those&nbsp;cases&nbsp;each&nbsp;clause&nbsp;is&nbsp;a&nbsp;new&nbsp;section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1984767">if</span>&nbsp;<span class="builtinfunc" id="1984770">len</span><span class="op" id="1984773">(</span><span class="ident" id="1984774">p</span><span class="op" id="1984775">.</span><span class="ident" id="1984776">output</span><span class="op" id="1984782">)</span>&nbsp;<span class="op" id="1984784">&gt;</span>&nbsp;<span class="num" id="1984786">0</span>&nbsp;<span class="op" id="1984788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1984794">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1984868">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984926">p</span><span class="op" id="1984927">.</span><span class="ident" id="1984928">linebreak</span><span class="op" id="1984937">(</span><span class="ident" id="1984938">p</span><span class="op" id="1984939">.</span><span class="ident" id="1984940">lineFor</span><span class="op" id="1984947">(</span><span class="ident" id="1984948">s</span><span class="op" id="1984949">.</span><span class="ident" id="1984950">Pos</span><span class="op" id="1984953">(</span><span class="op" id="1984954">)</span><span class="op" id="1984955">)</span><span class="op" id="1984956">,</span>&nbsp;<span class="num" id="1984958">1</span><span class="op" id="1984959">,</span>&nbsp;<span class="ident" id="1984961">ignore</span><span class="op" id="1984967">,</span>&nbsp;<span class="ident" id="1984969">i</span>&nbsp;<span class="op" id="1984971">==</span>&nbsp;<span class="num" id="1984974">0</span>&nbsp;<span class="op" id="1984976">||</span>&nbsp;<span class="ident" id="1984979">nindent</span>&nbsp;<span class="op" id="1984987">==</span>&nbsp;<span class="num" id="1984990">0</span>&nbsp;<span class="op" id="1984992">||</span>&nbsp;<span class="ident" id="1984995">p</span><span class="op" id="1984996">.</span><span class="ident" id="1984997">linesFrom</span><span class="op" id="1985006">(</span><span class="ident" id="1985007">line</span><span class="op" id="1985011">)</span>&nbsp;<span class="op" id="1985013">&gt;</span>&nbsp;<span class="num" id="1985015">0</span><span class="op" id="1985016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985026">p</span><span class="op" id="1985027">.</span><span class="ident" id="1985028">recordLine</span><span class="op" id="1985038">(</span><span class="op" id="1985039">&amp;</span><span class="ident" id="1985040">line</span><span class="op" id="1985044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985049">p</span><span class="op" id="1985050">.</span><span class="ident" id="1985051">stmt</span><span class="op" id="1985055">(</span><span class="ident" id="1985056">s</span><span class="op" id="1985057">,</span>&nbsp;<span class="ident" id="1985059">nextIsRBrace</span>&nbsp;<span class="op" id="1985072">&amp;&amp;</span>&nbsp;<span class="ident" id="1985075">i</span>&nbsp;<span class="op" id="1985077">==</span>&nbsp;<span class="builtinfunc" id="1985080">len</span><span class="op" id="1985083">(</span><span class="ident" id="1985084">list</span><span class="op" id="1985088">)</span><span class="op" id="1985089">-</span><span class="num" id="1985090">1</span><span class="op" id="1985091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1985096">//&nbsp;labeled&nbsp;statements&nbsp;put&nbsp;labels&nbsp;on&nbsp;a&nbsp;separate&nbsp;line,&nbsp;but&nbsp;here</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1985161">//&nbsp;we&nbsp;only&nbsp;care&nbsp;about&nbsp;the&nbsp;start&nbsp;line&nbsp;of&nbsp;the&nbsp;actual&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1985225">//&nbsp;without&nbsp;label&nbsp;-&nbsp;correct&nbsp;line&nbsp;for&nbsp;each&nbsp;label</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985275">for</span>&nbsp;<span class="ident" id="1985279">t</span>&nbsp;<span class="op" id="1985281">:=</span>&nbsp;<span class="ident" id="1985284">s</span><span class="op" id="1985285">;</span>&nbsp;<span class="op" id="1985287">;</span>&nbsp;<span class="op" id="1985289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985295">lt</span><span class="op" id="1985297">,</span>&nbsp;<span class="ident" id="1985299">_</span>&nbsp;<span class="op" id="1985301">:=</span>&nbsp;<span class="ident" id="1985304">t</span><span class="op" id="1985305">.</span><span class="op" id="1985306">(</span><span class="op" id="1985307">*</span><span class="ident" id="1985308">ast</span><span class="op" id="1985311">.</span><span class="ident" id="1985312">LabeledStmt</span><span class="op" id="1985323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985329">if</span>&nbsp;<span class="ident" id="1985332">lt</span>&nbsp;<span class="op" id="1985335">==</span>&nbsp;<span class="ident" id="1985338">nil</span>&nbsp;<span class="op" id="1985342">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985349">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985365">line</span><span class="op" id="1985369">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985376">t</span>&nbsp;<span class="op" id="1985378">=</span>&nbsp;<span class="ident" id="1985380">lt</span><span class="op" id="1985382">.</span><span class="ident" id="1985383">Stmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985391">}</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985396">i</span><span class="op" id="1985397">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985408">if</span>&nbsp;<span class="ident" id="1985411">nindent</span>&nbsp;<span class="op" id="1985419">&gt;</span>&nbsp;<span class="num" id="1985421">0</span>&nbsp;<span class="op" id="1985423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985427">p</span><span class="op" id="1985428">.</span><span class="builtinfunc" id="1985429">print</span><span class="op" id="1985434">(</span><span class="ident" id="1985435">unindent</span><span class="op" id="1985443">)</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985446">}</span><br>
<span class="lineno"></span><span class="op" id="1985448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1985451">//&nbsp;block&nbsp;prints&nbsp;an&nbsp;*ast.BlockStmt;&nbsp;it&nbsp;always&nbsp;spans&nbsp;at&nbsp;least&nbsp;two&nbsp;lines.</span><br>
<span class="lineno"></span><span class="keyword" id="1985522">func</span>&nbsp;<span class="op" id="1985527">(</span><span class="ident" id="1985528">p</span>&nbsp;<span class="op" id="1985530">*</span><span class="ident" id="1985531">printer</span><span class="op" id="1985538">)</span>&nbsp;<span class="ident" id="1985540">block</span><span class="op" id="1985545">(</span><span class="ident" id="1985546">b</span>&nbsp;<span class="op" id="1985548">*</span><span class="ident" id="1985549">ast</span><span class="op" id="1985552">.</span><span class="ident" id="1985553">BlockStmt</span><span class="op" id="1985562">,</span>&nbsp;<span class="ident" id="1985564">nindent</span>&nbsp;<span class="builtintype" id="1985572">int</span><span class="op" id="1985575">)</span>&nbsp;<span class="op" id="1985577">{</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985580">p</span><span class="op" id="1985581">.</span><span class="builtinfunc" id="1985582">print</span><span class="op" id="1985587">(</span><span class="ident" id="1985588">b</span><span class="op" id="1985589">.</span><span class="ident" id="1985590">Lbrace</span><span class="op" id="1985596">,</span>&nbsp;<span class="ident" id="1985598">token</span><span class="op" id="1985603">.</span><span class="ident" id="1985604">LBRACE</span><span class="op" id="1985610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985613">p</span><span class="op" id="1985614">.</span><span class="ident" id="1985615">stmtList</span><span class="op" id="1985623">(</span><span class="ident" id="1985624">b</span><span class="op" id="1985625">.</span><span class="ident" id="1985626">List</span><span class="op" id="1985630">,</span>&nbsp;<span class="ident" id="1985632">nindent</span><span class="op" id="1985639">,</span>&nbsp;<span class="builtintype" id="1985641">true</span><span class="op" id="1985645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985648">p</span><span class="op" id="1985649">.</span><span class="ident" id="1985650">linebreak</span><span class="op" id="1985659">(</span><span class="ident" id="1985660">p</span><span class="op" id="1985661">.</span><span class="ident" id="1985662">lineFor</span><span class="op" id="1985669">(</span><span class="ident" id="1985670">b</span><span class="op" id="1985671">.</span><span class="ident" id="1985672">Rbrace</span><span class="op" id="1985678">)</span><span class="op" id="1985679">,</span>&nbsp;<span class="num" id="1985681">1</span><span class="op" id="1985682">,</span>&nbsp;<span class="ident" id="1985684">ignore</span><span class="op" id="1985690">,</span>&nbsp;<span class="builtintype" id="1985692">true</span><span class="op" id="1985696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985699">p</span><span class="op" id="1985700">.</span><span class="builtinfunc" id="1985701">print</span><span class="op" id="1985706">(</span><span class="ident" id="1985707">b</span><span class="op" id="1985708">.</span><span class="ident" id="1985709">Rbrace</span><span class="op" id="1985715">,</span>&nbsp;<span class="ident" id="1985717">token</span><span class="op" id="1985722">.</span><span class="ident" id="1985723">RBRACE</span><span class="op" id="1985729">)</span><br>
<span class="lineno"></span><span class="op" id="1985731">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span><span class="keyword" id="1985734">func</span>&nbsp;<span class="ident" id="1985739">isTypeName</span><span class="op" id="1985749">(</span><span class="ident" id="1985750">x</span>&nbsp;<span class="ident" id="1985752">ast</span><span class="op" id="1985755">.</span><span class="ident" id="1985756">Expr</span><span class="op" id="1985760">)</span>&nbsp;<span class="builtintype" id="1985762">bool</span>&nbsp;<span class="op" id="1985767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985770">switch</span>&nbsp;<span class="ident" id="1985777">t</span>&nbsp;<span class="op" id="1985779">:=</span>&nbsp;<span class="ident" id="1985782">x</span><span class="op" id="1985783">.</span><span class="op" id="1985784">(</span><span class="keyword" id="1985785">type</span><span class="op" id="1985789">)</span>&nbsp;<span class="op" id="1985791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985794">case</span>&nbsp;<span class="op" id="1985799">*</span><span class="ident" id="1985800">ast</span><span class="op" id="1985803">.</span><span class="ident" id="1985804">Ident</span><span class="op" id="1985809">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985813">return</span>&nbsp;<span class="builtintype" id="1985820">true</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985826">case</span>&nbsp;<span class="op" id="1985831">*</span><span class="ident" id="1985832">ast</span><span class="op" id="1985835">.</span><span class="ident" id="1985836">SelectorExpr</span><span class="op" id="1985848">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985852">return</span>&nbsp;<span class="ident" id="1985859">isTypeName</span><span class="op" id="1985869">(</span><span class="ident" id="1985870">t</span><span class="op" id="1985871">.</span><span class="ident" id="1985872">X</span><span class="op" id="1985873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1985876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985879">return</span>&nbsp;<span class="builtintype" id="1985886">false</span><br>
<span class="lineno"></span><span class="op" id="1985892">}</span><br>
<span class="lineno">960</span><br>
<span class="lineno"></span><span class="keyword" id="1985895">func</span>&nbsp;<span class="ident" id="1985900">stripParens</span><span class="op" id="1985911">(</span><span class="ident" id="1985912">x</span>&nbsp;<span class="ident" id="1985914">ast</span><span class="op" id="1985917">.</span><span class="ident" id="1985918">Expr</span><span class="op" id="1985922">)</span>&nbsp;<span class="ident" id="1985924">ast</span><span class="op" id="1985927">.</span><span class="ident" id="1985928">Expr</span>&nbsp;<span class="op" id="1985933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1985936">if</span>&nbsp;<span class="ident" id="1985939">px</span><span class="op" id="1985941">,</span>&nbsp;<span class="ident" id="1985943">strip</span>&nbsp;<span class="op" id="1985949">:=</span>&nbsp;<span class="ident" id="1985952">x</span><span class="op" id="1985953">.</span><span class="op" id="1985954">(</span><span class="op" id="1985955">*</span><span class="ident" id="1985956">ast</span><span class="op" id="1985959">.</span><span class="ident" id="1985960">ParenExpr</span><span class="op" id="1985969">)</span><span class="op" id="1985970">;</span>&nbsp;<span class="ident" id="1985972">strip</span>&nbsp;<span class="op" id="1985978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1985982">//&nbsp;parentheses&nbsp;must&nbsp;not&nbsp;be&nbsp;stripped&nbsp;if&nbsp;there&nbsp;are&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1986037">//&nbsp;unparenthesized&nbsp;composite&nbsp;literals&nbsp;starting&nbsp;with</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1986091">//&nbsp;a&nbsp;type&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986108">ast</span><span class="op" id="1986111">.</span><span class="ident" id="1986112">Inspect</span><span class="op" id="1986119">(</span><span class="ident" id="1986120">px</span><span class="op" id="1986122">.</span><span class="ident" id="1986123">X</span><span class="op" id="1986124">,</span>&nbsp;<span class="keyword" id="1986126">func</span><span class="op" id="1986130">(</span><span class="ident" id="1986131">node</span>&nbsp;<span class="ident" id="1986136">ast</span><span class="op" id="1986139">.</span><span class="ident" id="1986140">Node</span><span class="op" id="1986144">)</span>&nbsp;<span class="builtintype" id="1986146">bool</span>&nbsp;<span class="op" id="1986151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986156">switch</span>&nbsp;<span class="ident" id="1986163">x</span>&nbsp;<span class="op" id="1986165">:=</span>&nbsp;<span class="ident" id="1986168">node</span><span class="op" id="1986172">.</span><span class="op" id="1986173">(</span><span class="keyword" id="1986174">type</span><span class="op" id="1986178">)</span>&nbsp;<span class="op" id="1986180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986185">case</span>&nbsp;<span class="op" id="1986190">*</span><span class="ident" id="1986191">ast</span><span class="op" id="1986194">.</span><span class="ident" id="1986195">ParenExpr</span><span class="op" id="1986204">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1986210">//&nbsp;parentheses&nbsp;protect&nbsp;enclosed&nbsp;composite&nbsp;literals</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986265">return</span>&nbsp;<span class="builtintype" id="1986272">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986281">case</span>&nbsp;<span class="op" id="1986286">*</span><span class="ident" id="1986287">ast</span><span class="op" id="1986290">.</span><span class="ident" id="1986291">CompositeLit</span><span class="op" id="1986303">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986309">if</span>&nbsp;<span class="ident" id="1986312">isTypeName</span><span class="op" id="1986322">(</span><span class="ident" id="1986323">x</span><span class="op" id="1986324">.</span><span class="ident" id="1986325">Type</span><span class="op" id="1986329">)</span>&nbsp;<span class="op" id="1986331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986338">strip</span>&nbsp;<span class="op" id="1986344">=</span>&nbsp;<span class="builtintype" id="1986346">false</span>&nbsp;<span class="comment" id="1986352">//&nbsp;do&nbsp;not&nbsp;strip&nbsp;parentheses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986384">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986390">return</span>&nbsp;<span class="builtintype" id="1986397">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1986411">//&nbsp;in&nbsp;all&nbsp;other&nbsp;cases,&nbsp;keep&nbsp;inspecting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986453">return</span>&nbsp;<span class="builtintype" id="1986460">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986467">}</span><span class="op" id="1986468">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986472">if</span>&nbsp;<span class="ident" id="1986475">strip</span>&nbsp;<span class="op" id="1986481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986486">return</span>&nbsp;<span class="ident" id="1986493">stripParens</span><span class="op" id="1986504">(</span><span class="ident" id="1986505">px</span><span class="op" id="1986507">.</span><span class="ident" id="1986508">X</span><span class="op" id="1986509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986519">return</span>&nbsp;<span class="ident" id="1986526">x</span><br>
<span class="lineno">985</span><span class="op" id="1986528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1986531">func</span>&nbsp;<span class="ident" id="1986536">stripParensAlways</span><span class="op" id="1986553">(</span><span class="ident" id="1986554">x</span>&nbsp;<span class="ident" id="1986556">ast</span><span class="op" id="1986559">.</span><span class="ident" id="1986560">Expr</span><span class="op" id="1986564">)</span>&nbsp;<span class="ident" id="1986566">ast</span><span class="op" id="1986569">.</span><span class="ident" id="1986570">Expr</span>&nbsp;<span class="op" id="1986575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986578">if</span>&nbsp;<span class="ident" id="1986581">x</span><span class="op" id="1986582">,</span>&nbsp;<span class="ident" id="1986584">ok</span>&nbsp;<span class="op" id="1986587">:=</span>&nbsp;<span class="ident" id="1986590">x</span><span class="op" id="1986591">.</span><span class="op" id="1986592">(</span><span class="op" id="1986593">*</span><span class="ident" id="1986594">ast</span><span class="op" id="1986597">.</span><span class="ident" id="1986598">ParenExpr</span><span class="op" id="1986607">)</span><span class="op" id="1986608">;</span>&nbsp;<span class="ident" id="1986610">ok</span>&nbsp;<span class="op" id="1986613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986617">return</span>&nbsp;<span class="ident" id="1986624">stripParensAlways</span><span class="op" id="1986641">(</span><span class="ident" id="1986642">x</span><span class="op" id="1986643">.</span><span class="ident" id="1986644">X</span><span class="op" id="1986645">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986651">return</span>&nbsp;<span class="ident" id="1986658">x</span><br>
<span class="lineno"></span><span class="op" id="1986660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1986663">func</span>&nbsp;<span class="op" id="1986668">(</span><span class="ident" id="1986669">p</span>&nbsp;<span class="op" id="1986671">*</span><span class="ident" id="1986672">printer</span><span class="op" id="1986679">)</span>&nbsp;<span class="ident" id="1986681">controlClause</span><span class="op" id="1986694">(</span><span class="ident" id="1986695">isForStmt</span>&nbsp;<span class="builtintype" id="1986705">bool</span><span class="op" id="1986709">,</span>&nbsp;<span class="ident" id="1986711">init</span>&nbsp;<span class="ident" id="1986716">ast</span><span class="op" id="1986719">.</span><span class="ident" id="1986720">Stmt</span><span class="op" id="1986724">,</span>&nbsp;<span class="ident" id="1986726">expr</span>&nbsp;<span class="ident" id="1986731">ast</span><span class="op" id="1986734">.</span><span class="ident" id="1986735">Expr</span><span class="op" id="1986739">,</span>&nbsp;<span class="ident" id="1986741">post</span>&nbsp;<span class="ident" id="1986746">ast</span><span class="op" id="1986749">.</span><span class="ident" id="1986750">Stmt</span><span class="op" id="1986754">)</span>&nbsp;<span class="op" id="1986756">{</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986759">p</span><span class="op" id="1986760">.</span><span class="builtinfunc" id="1986761">print</span><span class="op" id="1986766">(</span><span class="ident" id="1986767">blank</span><span class="op" id="1986772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986775">needsBlank</span>&nbsp;<span class="op" id="1986786">:=</span>&nbsp;<span class="builtintype" id="1986789">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986796">if</span>&nbsp;<span class="ident" id="1986799">init</span>&nbsp;<span class="op" id="1986804">==</span>&nbsp;<span class="ident" id="1986807">nil</span>&nbsp;<span class="op" id="1986811">&amp;&amp;</span>&nbsp;<span class="ident" id="1986814">post</span>&nbsp;<span class="op" id="1986819">==</span>&nbsp;<span class="ident" id="1986822">nil</span>&nbsp;<span class="op" id="1986826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1986830">//&nbsp;no&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1986858">if</span>&nbsp;<span class="ident" id="1986861">expr</span>&nbsp;<span class="op" id="1986866">!=</span>&nbsp;<span class="ident" id="1986869">nil</span>&nbsp;<span class="op" id="1986873">{</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986878">p</span><span class="op" id="1986879">.</span><span class="ident" id="1986880">expr</span><span class="op" id="1986884">(</span><span class="ident" id="1986885">stripParens</span><span class="op" id="1986896">(</span><span class="ident" id="1986897">expr</span><span class="op" id="1986901">)</span><span class="op" id="1986902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986907">needsBlank</span>&nbsp;<span class="op" id="1986918">=</span>&nbsp;<span class="builtintype" id="1986920">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1986930">}</span>&nbsp;<span class="keyword" id="1986932">else</span>&nbsp;<span class="op" id="1986937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1986941">//&nbsp;all&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1986970">//&nbsp;(they&nbsp;are&nbsp;not&nbsp;separators,&nbsp;print&nbsp;them&nbsp;explicitly)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987024">if</span>&nbsp;<span class="ident" id="1987027">init</span>&nbsp;<span class="op" id="1987032">!=</span>&nbsp;<span class="ident" id="1987035">nil</span>&nbsp;<span class="op" id="1987039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987044">p</span><span class="op" id="1987045">.</span><span class="ident" id="1987046">stmt</span><span class="op" id="1987050">(</span><span class="ident" id="1987051">init</span><span class="op" id="1987055">,</span>&nbsp;<span class="builtintype" id="1987057">false</span><span class="op" id="1987062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1987066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987070">p</span><span class="op" id="1987071">.</span><span class="builtinfunc" id="1987072">print</span><span class="op" id="1987077">(</span><span class="ident" id="1987078">token</span><span class="op" id="1987083">.</span><span class="ident" id="1987084">SEMICOLON</span><span class="op" id="1987093">,</span>&nbsp;<span class="ident" id="1987095">blank</span><span class="op" id="1987100">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987104">if</span>&nbsp;<span class="ident" id="1987107">expr</span>&nbsp;<span class="op" id="1987112">!=</span>&nbsp;<span class="ident" id="1987115">nil</span>&nbsp;<span class="op" id="1987119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987124">p</span><span class="op" id="1987125">.</span><span class="ident" id="1987126">expr</span><span class="op" id="1987130">(</span><span class="ident" id="1987131">stripParens</span><span class="op" id="1987142">(</span><span class="ident" id="1987143">expr</span><span class="op" id="1987147">)</span><span class="op" id="1987148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987153">needsBlank</span>&nbsp;<span class="op" id="1987164">=</span>&nbsp;<span class="builtintype" id="1987166">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1987173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987177">if</span>&nbsp;<span class="ident" id="1987180">isForStmt</span>&nbsp;<span class="op" id="1987190">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987195">p</span><span class="op" id="1987196">.</span><span class="builtinfunc" id="1987197">print</span><span class="op" id="1987202">(</span><span class="ident" id="1987203">token</span><span class="op" id="1987208">.</span><span class="ident" id="1987209">SEMICOLON</span><span class="op" id="1987218">,</span>&nbsp;<span class="ident" id="1987220">blank</span><span class="op" id="1987225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987230">needsBlank</span>&nbsp;<span class="op" id="1987241">=</span>&nbsp;<span class="builtintype" id="1987243">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987252">if</span>&nbsp;<span class="ident" id="1987255">post</span>&nbsp;<span class="op" id="1987260">!=</span>&nbsp;<span class="ident" id="1987263">nil</span>&nbsp;<span class="op" id="1987267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987273">p</span><span class="op" id="1987274">.</span><span class="ident" id="1987275">stmt</span><span class="op" id="1987279">(</span><span class="ident" id="1987280">post</span><span class="op" id="1987284">,</span>&nbsp;<span class="builtintype" id="1987286">false</span><span class="op" id="1987291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987297">needsBlank</span>&nbsp;<span class="op" id="1987308">=</span>&nbsp;<span class="builtintype" id="1987310">true</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1987318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1987322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1987325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987328">if</span>&nbsp;<span class="ident" id="1987331">needsBlank</span>&nbsp;<span class="op" id="1987342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987346">p</span><span class="op" id="1987347">.</span><span class="builtinfunc" id="1987348">print</span><span class="op" id="1987353">(</span><span class="ident" id="1987354">blank</span><span class="op" id="1987359">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1987362">}</span><br>
<span class="lineno"></span><span class="op" id="1987364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1987367">//&nbsp;indentList&nbsp;reports&nbsp;whether&nbsp;an&nbsp;expression&nbsp;list&nbsp;would&nbsp;look&nbsp;better&nbsp;if&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="1987440">//&nbsp;were&nbsp;indented&nbsp;wholesale&nbsp;(starting&nbsp;with&nbsp;the&nbsp;very&nbsp;first&nbsp;element,&nbsp;rather</span><br>
<span class="lineno">1030</span><span class="comment" id="1987513">//&nbsp;than&nbsp;starting&nbsp;at&nbsp;the&nbsp;first&nbsp;line&nbsp;break).</span><br>
<span class="lineno"></span><span class="comment" id="1987556">//</span><br>
<span class="lineno"></span><span class="keyword" id="1987559">func</span>&nbsp;<span class="op" id="1987564">(</span><span class="ident" id="1987565">p</span>&nbsp;<span class="op" id="1987567">*</span><span class="ident" id="1987568">printer</span><span class="op" id="1987575">)</span>&nbsp;<span class="ident" id="1987577">indentList</span><span class="op" id="1987587">(</span><span class="ident" id="1987588">list</span>&nbsp;<span class="op" id="1987593">[</span><span class="op" id="1987594">]</span><span class="ident" id="1987595">ast</span><span class="op" id="1987598">.</span><span class="ident" id="1987599">Expr</span><span class="op" id="1987603">)</span>&nbsp;<span class="builtintype" id="1987605">bool</span>&nbsp;<span class="op" id="1987610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1987613">//&nbsp;Heuristic:&nbsp;indentList&nbsp;returns&nbsp;true&nbsp;if&nbsp;there&nbsp;are&nbsp;more&nbsp;than&nbsp;one&nbsp;multi-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1987686">//&nbsp;line&nbsp;element&nbsp;in&nbsp;the&nbsp;list,&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;any&nbsp;element&nbsp;that&nbsp;is&nbsp;not</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1987755">//&nbsp;starting&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ends.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987811">if</span>&nbsp;<span class="builtinfunc" id="1987814">len</span><span class="op" id="1987817">(</span><span class="ident" id="1987818">list</span><span class="op" id="1987822">)</span>&nbsp;<span class="op" id="1987824">&gt;=</span>&nbsp;<span class="num" id="1987827">2</span>&nbsp;<span class="op" id="1987829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987833">var</span>&nbsp;<span class="ident" id="1987837">b</span>&nbsp;<span class="op" id="1987839">=</span>&nbsp;<span class="ident" id="1987841">p</span><span class="op" id="1987842">.</span><span class="ident" id="1987843">lineFor</span><span class="op" id="1987850">(</span><span class="ident" id="1987851">list</span><span class="op" id="1987855">[</span><span class="num" id="1987856">0</span><span class="op" id="1987857">]</span><span class="op" id="1987858">.</span><span class="ident" id="1987859">Pos</span><span class="op" id="1987862">(</span><span class="op" id="1987863">)</span><span class="op" id="1987864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987868">var</span>&nbsp;<span class="ident" id="1987872">e</span>&nbsp;<span class="op" id="1987874">=</span>&nbsp;<span class="ident" id="1987876">p</span><span class="op" id="1987877">.</span><span class="ident" id="1987878">lineFor</span><span class="op" id="1987885">(</span><span class="ident" id="1987886">list</span><span class="op" id="1987890">[</span><span class="builtinfunc" id="1987891">len</span><span class="op" id="1987894">(</span><span class="ident" id="1987895">list</span><span class="op" id="1987899">)</span><span class="op" id="1987900">-</span><span class="num" id="1987901">1</span><span class="op" id="1987902">]</span><span class="op" id="1987903">.</span><span class="ident" id="1987904">End</span><span class="op" id="1987907">(</span><span class="op" id="1987908">)</span><span class="op" id="1987909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987913">if</span>&nbsp;<span class="num" id="1987916">0</span>&nbsp;<span class="op" id="1987918">&lt;</span>&nbsp;<span class="ident" id="1987920">b</span>&nbsp;<span class="op" id="1987922">&amp;&amp;</span>&nbsp;<span class="ident" id="1987925">b</span>&nbsp;<span class="op" id="1987927">&lt;</span>&nbsp;<span class="ident" id="1987929">e</span>&nbsp;<span class="op" id="1987931">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1987936">//&nbsp;list&nbsp;spans&nbsp;multiple&nbsp;lines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987968">n</span>&nbsp;<span class="op" id="1987970">:=</span>&nbsp;<span class="num" id="1987973">0</span>&nbsp;<span class="comment" id="1987975">//&nbsp;multi-line&nbsp;element&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988006">line</span>&nbsp;<span class="op" id="1988011">:=</span>&nbsp;<span class="ident" id="1988014">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988019">for</span>&nbsp;<span class="ident" id="1988023">_</span><span class="op" id="1988024">,</span>&nbsp;<span class="ident" id="1988026">x</span>&nbsp;<span class="op" id="1988028">:=</span>&nbsp;<span class="keyword" id="1988031">range</span>&nbsp;<span class="ident" id="1988037">list</span>&nbsp;<span class="op" id="1988042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988048">xb</span>&nbsp;<span class="op" id="1988051">:=</span>&nbsp;<span class="ident" id="1988054">p</span><span class="op" id="1988055">.</span><span class="ident" id="1988056">lineFor</span><span class="op" id="1988063">(</span><span class="ident" id="1988064">x</span><span class="op" id="1988065">.</span><span class="ident" id="1988066">Pos</span><span class="op" id="1988069">(</span><span class="op" id="1988070">)</span><span class="op" id="1988071">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988077">xe</span>&nbsp;<span class="op" id="1988080">:=</span>&nbsp;<span class="ident" id="1988083">p</span><span class="op" id="1988084">.</span><span class="ident" id="1988085">lineFor</span><span class="op" id="1988092">(</span><span class="ident" id="1988093">x</span><span class="op" id="1988094">.</span><span class="ident" id="1988095">End</span><span class="op" id="1988098">(</span><span class="op" id="1988099">)</span><span class="op" id="1988100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988106">if</span>&nbsp;<span class="ident" id="1988109">line</span>&nbsp;<span class="op" id="1988114">&lt;</span>&nbsp;<span class="ident" id="1988116">xb</span>&nbsp;<span class="op" id="1988119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1988126">//&nbsp;x&nbsp;is&nbsp;not&nbsp;starting&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1988164">//&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ended</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988203">return</span>&nbsp;<span class="builtintype" id="1988210">true</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988225">if</span>&nbsp;<span class="ident" id="1988228">xb</span>&nbsp;<span class="op" id="1988231">&lt;</span>&nbsp;<span class="ident" id="1988233">xe</span>&nbsp;<span class="op" id="1988236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1988243">//&nbsp;x&nbsp;is&nbsp;a&nbsp;multi-line&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988277">n</span><span class="op" id="1988278">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988285">}</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988291">line</span>&nbsp;<span class="op" id="1988296">=</span>&nbsp;<span class="ident" id="1988298">xe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988309">return</span>&nbsp;<span class="ident" id="1988316">n</span>&nbsp;<span class="op" id="1988318">&gt;</span>&nbsp;<span class="num" id="1988320">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988327">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988330">return</span>&nbsp;<span class="builtintype" id="1988337">false</span><br>
<span class="lineno"></span><span class="op" id="1988343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1988346">func</span>&nbsp;<span class="op" id="1988351">(</span><span class="ident" id="1988352">p</span>&nbsp;<span class="op" id="1988354">*</span><span class="ident" id="1988355">printer</span><span class="op" id="1988362">)</span>&nbsp;<span class="ident" id="1988364">stmt</span><span class="op" id="1988368">(</span><span class="ident" id="1988369">stmt</span>&nbsp;<span class="ident" id="1988374">ast</span><span class="op" id="1988377">.</span><span class="ident" id="1988378">Stmt</span><span class="op" id="1988382">,</span>&nbsp;<span class="ident" id="1988384">nextIsRBrace</span>&nbsp;<span class="builtintype" id="1988397">bool</span><span class="op" id="1988401">)</span>&nbsp;<span class="op" id="1988403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988406">p</span><span class="op" id="1988407">.</span><span class="builtinfunc" id="1988408">print</span><span class="op" id="1988413">(</span><span class="ident" id="1988414">stmt</span><span class="op" id="1988418">.</span><span class="ident" id="1988419">Pos</span><span class="op" id="1988422">(</span><span class="op" id="1988423">)</span><span class="op" id="1988424">)</span><br>
<span class="lineno">1065</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988428">switch</span>&nbsp;<span class="ident" id="1988435">s</span>&nbsp;<span class="op" id="1988437">:=</span>&nbsp;<span class="ident" id="1988440">stmt</span><span class="op" id="1988444">.</span><span class="op" id="1988445">(</span><span class="keyword" id="1988446">type</span><span class="op" id="1988450">)</span>&nbsp;<span class="op" id="1988452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988455">case</span>&nbsp;<span class="op" id="1988460">*</span><span class="ident" id="1988461">ast</span><span class="op" id="1988464">.</span><span class="ident" id="1988465">BadStmt</span><span class="op" id="1988472">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988476">p</span><span class="op" id="1988477">.</span><span class="builtinfunc" id="1988478">print</span><span class="op" id="1988483">(</span><span class="string" id="1988484">&#34;BadStmt&#34;</span><span class="op" id="1988493">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988497">case</span>&nbsp;<span class="op" id="1988502">*</span><span class="ident" id="1988503">ast</span><span class="op" id="1988506">.</span><span class="ident" id="1988507">DeclStmt</span><span class="op" id="1988515">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988519">p</span><span class="op" id="1988520">.</span><span class="ident" id="1988521">decl</span><span class="op" id="1988525">(</span><span class="ident" id="1988526">s</span><span class="op" id="1988527">.</span><span class="ident" id="1988528">Decl</span><span class="op" id="1988532">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988536">case</span>&nbsp;<span class="op" id="1988541">*</span><span class="ident" id="1988542">ast</span><span class="op" id="1988545">.</span><span class="ident" id="1988546">EmptyStmt</span><span class="op" id="1988555">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1988559">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno">1075</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988578">case</span>&nbsp;<span class="op" id="1988583">*</span><span class="ident" id="1988584">ast</span><span class="op" id="1988587">.</span><span class="ident" id="1988588">LabeledStmt</span><span class="op" id="1988599">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1988603">//&nbsp;a&nbsp;&#34;correcting&#34;&nbsp;unindent&nbsp;immediately&nbsp;following&nbsp;a&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1988667">//&nbsp;is&nbsp;applied&nbsp;before&nbsp;the&nbsp;line&nbsp;break&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1988728">//&nbsp;between&nbsp;(see&nbsp;writeWhitespace)</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988763">p</span><span class="op" id="1988764">.</span><span class="builtinfunc" id="1988765">print</span><span class="op" id="1988770">(</span><span class="ident" id="1988771">unindent</span><span class="op" id="1988779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988783">p</span><span class="op" id="1988784">.</span><span class="ident" id="1988785">expr</span><span class="op" id="1988789">(</span><span class="ident" id="1988790">s</span><span class="op" id="1988791">.</span><span class="ident" id="1988792">Label</span><span class="op" id="1988797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988801">p</span><span class="op" id="1988802">.</span><span class="builtinfunc" id="1988803">print</span><span class="op" id="1988808">(</span><span class="ident" id="1988809">s</span><span class="op" id="1988810">.</span><span class="ident" id="1988811">Colon</span><span class="op" id="1988816">,</span>&nbsp;<span class="ident" id="1988818">token</span><span class="op" id="1988823">.</span><span class="ident" id="1988824">COLON</span><span class="op" id="1988829">,</span>&nbsp;<span class="ident" id="1988831">indent</span><span class="op" id="1988837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988841">if</span>&nbsp;<span class="ident" id="1988844">e</span><span class="op" id="1988845">,</span>&nbsp;<span class="ident" id="1988847">isEmpty</span>&nbsp;<span class="op" id="1988855">:=</span>&nbsp;<span class="ident" id="1988858">s</span><span class="op" id="1988859">.</span><span class="ident" id="1988860">Stmt</span><span class="op" id="1988864">.</span><span class="op" id="1988865">(</span><span class="op" id="1988866">*</span><span class="ident" id="1988867">ast</span><span class="op" id="1988870">.</span><span class="ident" id="1988871">EmptyStmt</span><span class="op" id="1988880">)</span><span class="op" id="1988881">;</span>&nbsp;<span class="ident" id="1988883">isEmpty</span>&nbsp;<span class="op" id="1988891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988896">if</span>&nbsp;<span class="op" id="1988899">!</span><span class="ident" id="1988900">nextIsRBrace</span>&nbsp;<span class="op" id="1988913">{</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988919">p</span><span class="op" id="1988920">.</span><span class="builtinfunc" id="1988921">print</span><span class="op" id="1988926">(</span><span class="ident" id="1988927">newline</span><span class="op" id="1988934">,</span>&nbsp;<span class="ident" id="1988936">e</span><span class="op" id="1988937">.</span><span class="ident" id="1988938">Pos</span><span class="op" id="1988941">(</span><span class="op" id="1988942">)</span><span class="op" id="1988943">,</span>&nbsp;<span class="ident" id="1988945">token</span><span class="op" id="1988950">.</span><span class="ident" id="1988951">SEMICOLON</span><span class="op" id="1988960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988966">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988979">}</span>&nbsp;<span class="keyword" id="1988981">else</span>&nbsp;<span class="op" id="1988986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988991">p</span><span class="op" id="1988992">.</span><span class="ident" id="1988993">linebreak</span><span class="op" id="1989002">(</span><span class="ident" id="1989003">p</span><span class="op" id="1989004">.</span><span class="ident" id="1989005">lineFor</span><span class="op" id="1989012">(</span><span class="ident" id="1989013">s</span><span class="op" id="1989014">.</span><span class="ident" id="1989015">Stmt</span><span class="op" id="1989019">.</span><span class="ident" id="1989020">Pos</span><span class="op" id="1989023">(</span><span class="op" id="1989024">)</span><span class="op" id="1989025">)</span><span class="op" id="1989026">,</span>&nbsp;<span class="num" id="1989028">1</span><span class="op" id="1989029">,</span>&nbsp;<span class="ident" id="1989031">ignore</span><span class="op" id="1989037">,</span>&nbsp;<span class="builtintype" id="1989039">true</span><span class="op" id="1989043">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989051">p</span><span class="op" id="1989052">.</span><span class="ident" id="1989053">stmt</span><span class="op" id="1989057">(</span><span class="ident" id="1989058">s</span><span class="op" id="1989059">.</span><span class="ident" id="1989060">Stmt</span><span class="op" id="1989064">,</span>&nbsp;<span class="ident" id="1989066">nextIsRBrace</span><span class="op" id="1989078">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989082">case</span>&nbsp;<span class="op" id="1989087">*</span><span class="ident" id="1989088">ast</span><span class="op" id="1989091">.</span><span class="ident" id="1989092">ExprStmt</span><span class="op" id="1989100">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989104">const</span>&nbsp;<span class="ident" id="1989110">depth</span>&nbsp;<span class="op" id="1989116">=</span>&nbsp;<span class="num" id="1989118">1</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989122">p</span><span class="op" id="1989123">.</span><span class="ident" id="1989124">expr0</span><span class="op" id="1989129">(</span><span class="ident" id="1989130">s</span><span class="op" id="1989131">.</span><span class="ident" id="1989132">X</span><span class="op" id="1989133">,</span>&nbsp;<span class="ident" id="1989135">depth</span><span class="op" id="1989140">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989144">case</span>&nbsp;<span class="op" id="1989149">*</span><span class="ident" id="1989150">ast</span><span class="op" id="1989153">.</span><span class="ident" id="1989154">SendStmt</span><span class="op" id="1989162">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989166">const</span>&nbsp;<span class="ident" id="1989172">depth</span>&nbsp;<span class="op" id="1989178">=</span>&nbsp;<span class="num" id="1989180">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989184">p</span><span class="op" id="1989185">.</span><span class="ident" id="1989186">expr0</span><span class="op" id="1989191">(</span><span class="ident" id="1989192">s</span><span class="op" id="1989193">.</span><span class="ident" id="1989194">Chan</span><span class="op" id="1989198">,</span>&nbsp;<span class="ident" id="1989200">depth</span><span class="op" id="1989205">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989209">p</span><span class="op" id="1989210">.</span><span class="builtinfunc" id="1989211">print</span><span class="op" id="1989216">(</span><span class="ident" id="1989217">blank</span><span class="op" id="1989222">,</span>&nbsp;<span class="ident" id="1989224">s</span><span class="op" id="1989225">.</span><span class="ident" id="1989226">Arrow</span><span class="op" id="1989231">,</span>&nbsp;<span class="ident" id="1989233">token</span><span class="op" id="1989238">.</span><span class="ident" id="1989239">ARROW</span><span class="op" id="1989244">,</span>&nbsp;<span class="ident" id="1989246">blank</span><span class="op" id="1989251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989255">p</span><span class="op" id="1989256">.</span><span class="ident" id="1989257">expr0</span><span class="op" id="1989262">(</span><span class="ident" id="1989263">s</span><span class="op" id="1989264">.</span><span class="ident" id="1989265">Value</span><span class="op" id="1989270">,</span>&nbsp;<span class="ident" id="1989272">depth</span><span class="op" id="1989277">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989281">case</span>&nbsp;<span class="op" id="1989286">*</span><span class="ident" id="1989287">ast</span><span class="op" id="1989290">.</span><span class="ident" id="1989291">IncDecStmt</span><span class="op" id="1989301">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989305">const</span>&nbsp;<span class="ident" id="1989311">depth</span>&nbsp;<span class="op" id="1989317">=</span>&nbsp;<span class="num" id="1989319">1</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989323">p</span><span class="op" id="1989324">.</span><span class="ident" id="1989325">expr0</span><span class="op" id="1989330">(</span><span class="ident" id="1989331">s</span><span class="op" id="1989332">.</span><span class="ident" id="1989333">X</span><span class="op" id="1989334">,</span>&nbsp;<span class="ident" id="1989336">depth</span><span class="op" id="1989341">+</span><span class="num" id="1989342">1</span><span class="op" id="1989343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989347">p</span><span class="op" id="1989348">.</span><span class="builtinfunc" id="1989349">print</span><span class="op" id="1989354">(</span><span class="ident" id="1989355">s</span><span class="op" id="1989356">.</span><span class="ident" id="1989357">TokPos</span><span class="op" id="1989363">,</span>&nbsp;<span class="ident" id="1989365">s</span><span class="op" id="1989366">.</span><span class="ident" id="1989367">Tok</span><span class="op" id="1989370">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989374">case</span>&nbsp;<span class="op" id="1989379">*</span><span class="ident" id="1989380">ast</span><span class="op" id="1989383">.</span><span class="ident" id="1989384">AssignStmt</span><span class="op" id="1989394">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989398">var</span>&nbsp;<span class="ident" id="1989402">depth</span>&nbsp;<span class="op" id="1989408">=</span>&nbsp;<span class="num" id="1989410">1</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989414">if</span>&nbsp;<span class="builtinfunc" id="1989417">len</span><span class="op" id="1989420">(</span><span class="ident" id="1989421">s</span><span class="op" id="1989422">.</span><span class="ident" id="1989423">Lhs</span><span class="op" id="1989426">)</span>&nbsp;<span class="op" id="1989428">&gt;</span>&nbsp;<span class="num" id="1989430">1</span>&nbsp;<span class="op" id="1989432">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1989435">len</span><span class="op" id="1989438">(</span><span class="ident" id="1989439">s</span><span class="op" id="1989440">.</span><span class="ident" id="1989441">Rhs</span><span class="op" id="1989444">)</span>&nbsp;<span class="op" id="1989446">&gt;</span>&nbsp;<span class="num" id="1989448">1</span>&nbsp;<span class="op" id="1989450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989455">depth</span><span class="op" id="1989460">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989469">p</span><span class="op" id="1989470">.</span><span class="ident" id="1989471">exprList</span><span class="op" id="1989479">(</span><span class="ident" id="1989480">s</span><span class="op" id="1989481">.</span><span class="ident" id="1989482">Pos</span><span class="op" id="1989485">(</span><span class="op" id="1989486">)</span><span class="op" id="1989487">,</span>&nbsp;<span class="ident" id="1989489">s</span><span class="op" id="1989490">.</span><span class="ident" id="1989491">Lhs</span><span class="op" id="1989494">,</span>&nbsp;<span class="ident" id="1989496">depth</span><span class="op" id="1989501">,</span>&nbsp;<span class="num" id="1989503">0</span><span class="op" id="1989504">,</span>&nbsp;<span class="ident" id="1989506">s</span><span class="op" id="1989507">.</span><span class="ident" id="1989508">TokPos</span><span class="op" id="1989514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989518">p</span><span class="op" id="1989519">.</span><span class="builtinfunc" id="1989520">print</span><span class="op" id="1989525">(</span><span class="ident" id="1989526">blank</span><span class="op" id="1989531">,</span>&nbsp;<span class="ident" id="1989533">s</span><span class="op" id="1989534">.</span><span class="ident" id="1989535">TokPos</span><span class="op" id="1989541">,</span>&nbsp;<span class="ident" id="1989543">s</span><span class="op" id="1989544">.</span><span class="ident" id="1989545">Tok</span><span class="op" id="1989548">,</span>&nbsp;<span class="ident" id="1989550">blank</span><span class="op" id="1989555">)</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989559">p</span><span class="op" id="1989560">.</span><span class="ident" id="1989561">exprList</span><span class="op" id="1989569">(</span><span class="ident" id="1989570">s</span><span class="op" id="1989571">.</span><span class="ident" id="1989572">TokPos</span><span class="op" id="1989578">,</span>&nbsp;<span class="ident" id="1989580">s</span><span class="op" id="1989581">.</span><span class="ident" id="1989582">Rhs</span><span class="op" id="1989585">,</span>&nbsp;<span class="ident" id="1989587">depth</span><span class="op" id="1989592">,</span>&nbsp;<span class="num" id="1989594">0</span><span class="op" id="1989595">,</span>&nbsp;<span class="ident" id="1989597">token</span><span class="op" id="1989602">.</span><span class="ident" id="1989603">NoPos</span><span class="op" id="1989608">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989612">case</span>&nbsp;<span class="op" id="1989617">*</span><span class="ident" id="1989618">ast</span><span class="op" id="1989621">.</span><span class="ident" id="1989622">GoStmt</span><span class="op" id="1989628">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989632">p</span><span class="op" id="1989633">.</span><span class="builtinfunc" id="1989634">print</span><span class="op" id="1989639">(</span><span class="ident" id="1989640">token</span><span class="op" id="1989645">.</span><span class="ident" id="1989646">GO</span><span class="op" id="1989648">,</span>&nbsp;<span class="ident" id="1989650">blank</span><span class="op" id="1989655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989659">p</span><span class="op" id="1989660">.</span><span class="ident" id="1989661">expr</span><span class="op" id="1989665">(</span><span class="ident" id="1989666">s</span><span class="op" id="1989667">.</span><span class="ident" id="1989668">Call</span><span class="op" id="1989672">)</span><br>
<span class="lineno">1120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989676">case</span>&nbsp;<span class="op" id="1989681">*</span><span class="ident" id="1989682">ast</span><span class="op" id="1989685">.</span><span class="ident" id="1989686">DeferStmt</span><span class="op" id="1989695">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989699">p</span><span class="op" id="1989700">.</span><span class="builtinfunc" id="1989701">print</span><span class="op" id="1989706">(</span><span class="ident" id="1989707">token</span><span class="op" id="1989712">.</span><span class="ident" id="1989713">DEFER</span><span class="op" id="1989718">,</span>&nbsp;<span class="ident" id="1989720">blank</span><span class="op" id="1989725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989729">p</span><span class="op" id="1989730">.</span><span class="ident" id="1989731">expr</span><span class="op" id="1989735">(</span><span class="ident" id="1989736">s</span><span class="op" id="1989737">.</span><span class="ident" id="1989738">Call</span><span class="op" id="1989742">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989746">case</span>&nbsp;<span class="op" id="1989751">*</span><span class="ident" id="1989752">ast</span><span class="op" id="1989755">.</span><span class="ident" id="1989756">ReturnStmt</span><span class="op" id="1989766">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989770">p</span><span class="op" id="1989771">.</span><span class="builtinfunc" id="1989772">print</span><span class="op" id="1989777">(</span><span class="ident" id="1989778">token</span><span class="op" id="1989783">.</span><span class="ident" id="1989784">RETURN</span><span class="op" id="1989790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989794">if</span>&nbsp;<span class="ident" id="1989797">s</span><span class="op" id="1989798">.</span><span class="ident" id="1989799">Results</span>&nbsp;<span class="op" id="1989807">!=</span>&nbsp;<span class="ident" id="1989810">nil</span>&nbsp;<span class="op" id="1989814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989819">p</span><span class="op" id="1989820">.</span><span class="builtinfunc" id="1989821">print</span><span class="op" id="1989826">(</span><span class="ident" id="1989827">blank</span><span class="op" id="1989832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1989837">//&nbsp;Use&nbsp;indentList&nbsp;heuristic&nbsp;to&nbsp;make&nbsp;corner&nbsp;cases&nbsp;look</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1989894">//&nbsp;better&nbsp;(issue&nbsp;1207).&nbsp;A&nbsp;more&nbsp;systematic&nbsp;approach&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1989954">//&nbsp;always&nbsp;indent,&nbsp;but&nbsp;this&nbsp;would&nbsp;cause&nbsp;significant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1990008">//&nbsp;reformatting&nbsp;of&nbsp;the&nbsp;code&nbsp;base&nbsp;and&nbsp;not&nbsp;necessarily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1990064">//&nbsp;lead&nbsp;to&nbsp;more&nbsp;nicely&nbsp;formatted&nbsp;code&nbsp;in&nbsp;general.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990117">if</span>&nbsp;<span class="ident" id="1990120">p</span><span class="op" id="1990121">.</span><span class="ident" id="1990122">indentList</span><span class="op" id="1990132">(</span><span class="ident" id="1990133">s</span><span class="op" id="1990134">.</span><span class="ident" id="1990135">Results</span><span class="op" id="1990142">)</span>&nbsp;<span class="op" id="1990144">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990150">p</span><span class="op" id="1990151">.</span><span class="builtinfunc" id="1990152">print</span><span class="op" id="1990157">(</span><span class="ident" id="1990158">indent</span><span class="op" id="1990164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990170">p</span><span class="op" id="1990171">.</span><span class="ident" id="1990172">exprList</span><span class="op" id="1990180">(</span><span class="ident" id="1990181">s</span><span class="op" id="1990182">.</span><span class="ident" id="1990183">Pos</span><span class="op" id="1990186">(</span><span class="op" id="1990187">)</span><span class="op" id="1990188">,</span>&nbsp;<span class="ident" id="1990190">s</span><span class="op" id="1990191">.</span><span class="ident" id="1990192">Results</span><span class="op" id="1990199">,</span>&nbsp;<span class="num" id="1990201">1</span><span class="op" id="1990202">,</span>&nbsp;<span class="ident" id="1990204">noIndent</span><span class="op" id="1990212">,</span>&nbsp;<span class="ident" id="1990214">token</span><span class="op" id="1990219">.</span><span class="ident" id="1990220">NoPos</span><span class="op" id="1990225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990231">p</span><span class="op" id="1990232">.</span><span class="builtinfunc" id="1990233">print</span><span class="op" id="1990238">(</span><span class="ident" id="1990239">unindent</span><span class="op" id="1990247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990252">}</span>&nbsp;<span class="keyword" id="1990254">else</span>&nbsp;<span class="op" id="1990259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990265">p</span><span class="op" id="1990266">.</span><span class="ident" id="1990267">exprList</span><span class="op" id="1990275">(</span><span class="ident" id="1990276">s</span><span class="op" id="1990277">.</span><span class="ident" id="1990278">Pos</span><span class="op" id="1990281">(</span><span class="op" id="1990282">)</span><span class="op" id="1990283">,</span>&nbsp;<span class="ident" id="1990285">s</span><span class="op" id="1990286">.</span><span class="ident" id="1990287">Results</span><span class="op" id="1990294">,</span>&nbsp;<span class="num" id="1990296">1</span><span class="op" id="1990297">,</span>&nbsp;<span class="num" id="1990299">0</span><span class="op" id="1990300">,</span>&nbsp;<span class="ident" id="1990302">token</span><span class="op" id="1990307">.</span><span class="ident" id="1990308">NoPos</span><span class="op" id="1990313">)</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990326">case</span>&nbsp;<span class="op" id="1990331">*</span><span class="ident" id="1990332">ast</span><span class="op" id="1990335">.</span><span class="ident" id="1990336">BranchStmt</span><span class="op" id="1990346">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990350">p</span><span class="op" id="1990351">.</span><span class="builtinfunc" id="1990352">print</span><span class="op" id="1990357">(</span><span class="ident" id="1990358">s</span><span class="op" id="1990359">.</span><span class="ident" id="1990360">Tok</span><span class="op" id="1990363">)</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990367">if</span>&nbsp;<span class="ident" id="1990370">s</span><span class="op" id="1990371">.</span><span class="ident" id="1990372">Label</span>&nbsp;<span class="op" id="1990378">!=</span>&nbsp;<span class="ident" id="1990381">nil</span>&nbsp;<span class="op" id="1990385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990390">p</span><span class="op" id="1990391">.</span><span class="builtinfunc" id="1990392">print</span><span class="op" id="1990397">(</span><span class="ident" id="1990398">blank</span><span class="op" id="1990403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990408">p</span><span class="op" id="1990409">.</span><span class="ident" id="1990410">expr</span><span class="op" id="1990414">(</span><span class="ident" id="1990415">s</span><span class="op" id="1990416">.</span><span class="ident" id="1990417">Label</span><span class="op" id="1990422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990430">case</span>&nbsp;<span class="op" id="1990435">*</span><span class="ident" id="1990436">ast</span><span class="op" id="1990439">.</span><span class="ident" id="1990440">BlockStmt</span><span class="op" id="1990449">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990453">p</span><span class="op" id="1990454">.</span><span class="ident" id="1990455">block</span><span class="op" id="1990460">(</span><span class="ident" id="1990461">s</span><span class="op" id="1990462">,</span>&nbsp;<span class="num" id="1990464">1</span><span class="op" id="1990465">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990469">case</span>&nbsp;<span class="op" id="1990474">*</span><span class="ident" id="1990475">ast</span><span class="op" id="1990478">.</span><span class="ident" id="1990479">IfStmt</span><span class="op" id="1990485">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990489">p</span><span class="op" id="1990490">.</span><span class="builtinfunc" id="1990491">print</span><span class="op" id="1990496">(</span><span class="ident" id="1990497">token</span><span class="op" id="1990502">.</span><span class="ident" id="1990503">IF</span><span class="op" id="1990505">)</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990509">p</span><span class="op" id="1990510">.</span><span class="ident" id="1990511">controlClause</span><span class="op" id="1990524">(</span><span class="builtintype" id="1990525">false</span><span class="op" id="1990530">,</span>&nbsp;<span class="ident" id="1990532">s</span><span class="op" id="1990533">.</span><span class="ident" id="1990534">Init</span><span class="op" id="1990538">,</span>&nbsp;<span class="ident" id="1990540">s</span><span class="op" id="1990541">.</span><span class="ident" id="1990542">Cond</span><span class="op" id="1990546">,</span>&nbsp;<span class="ident" id="1990548">nil</span><span class="op" id="1990551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990555">p</span><span class="op" id="1990556">.</span><span class="ident" id="1990557">block</span><span class="op" id="1990562">(</span><span class="ident" id="1990563">s</span><span class="op" id="1990564">.</span><span class="ident" id="1990565">Body</span><span class="op" id="1990569">,</span>&nbsp;<span class="num" id="1990571">1</span><span class="op" id="1990572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990576">if</span>&nbsp;<span class="ident" id="1990579">s</span><span class="op" id="1990580">.</span><span class="ident" id="1990581">Else</span>&nbsp;<span class="op" id="1990586">!=</span>&nbsp;<span class="ident" id="1990589">nil</span>&nbsp;<span class="op" id="1990593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990598">p</span><span class="op" id="1990599">.</span><span class="builtinfunc" id="1990600">print</span><span class="op" id="1990605">(</span><span class="ident" id="1990606">blank</span><span class="op" id="1990611">,</span>&nbsp;<span class="ident" id="1990613">token</span><span class="op" id="1990618">.</span><span class="ident" id="1990619">ELSE</span><span class="op" id="1990623">,</span>&nbsp;<span class="ident" id="1990625">blank</span><span class="op" id="1990630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990635">switch</span>&nbsp;<span class="ident" id="1990642">s</span><span class="op" id="1990643">.</span><span class="ident" id="1990644">Else</span><span class="op" id="1990648">.</span><span class="op" id="1990649">(</span><span class="keyword" id="1990650">type</span><span class="op" id="1990654">)</span>&nbsp;<span class="op" id="1990656">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990661">case</span>&nbsp;<span class="op" id="1990666">*</span><span class="ident" id="1990667">ast</span><span class="op" id="1990670">.</span><span class="ident" id="1990671">BlockStmt</span><span class="op" id="1990680">,</span>&nbsp;<span class="op" id="1990682">*</span><span class="ident" id="1990683">ast</span><span class="op" id="1990686">.</span><span class="ident" id="1990687">IfStmt</span><span class="op" id="1990693">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990699">p</span><span class="op" id="1990700">.</span><span class="ident" id="1990701">stmt</span><span class="op" id="1990705">(</span><span class="ident" id="1990706">s</span><span class="op" id="1990707">.</span><span class="ident" id="1990708">Else</span><span class="op" id="1990712">,</span>&nbsp;<span class="ident" id="1990714">nextIsRBrace</span><span class="op" id="1990726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990731">default</span><span class="op" id="1990738">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990744">p</span><span class="op" id="1990745">.</span><span class="builtinfunc" id="1990746">print</span><span class="op" id="1990751">(</span><span class="ident" id="1990752">token</span><span class="op" id="1990757">.</span><span class="ident" id="1990758">LBRACE</span><span class="op" id="1990764">,</span>&nbsp;<span class="ident" id="1990766">indent</span><span class="op" id="1990772">,</span>&nbsp;<span class="ident" id="1990774">formfeed</span><span class="op" id="1990782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990788">p</span><span class="op" id="1990789">.</span><span class="ident" id="1990790">stmt</span><span class="op" id="1990794">(</span><span class="ident" id="1990795">s</span><span class="op" id="1990796">.</span><span class="ident" id="1990797">Else</span><span class="op" id="1990801">,</span>&nbsp;<span class="builtintype" id="1990803">true</span><span class="op" id="1990807">)</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990813">p</span><span class="op" id="1990814">.</span><span class="builtinfunc" id="1990815">print</span><span class="op" id="1990820">(</span><span class="ident" id="1990821">unindent</span><span class="op" id="1990829">,</span>&nbsp;<span class="ident" id="1990831">formfeed</span><span class="op" id="1990839">,</span>&nbsp;<span class="ident" id="1990841">token</span><span class="op" id="1990846">.</span><span class="ident" id="1990847">RBRACE</span><span class="op" id="1990853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990866">case</span>&nbsp;<span class="op" id="1990871">*</span><span class="ident" id="1990872">ast</span><span class="op" id="1990875">.</span><span class="ident" id="1990876">CaseClause</span><span class="op" id="1990886">:</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990890">if</span>&nbsp;<span class="ident" id="1990893">s</span><span class="op" id="1990894">.</span><span class="ident" id="1990895">List</span>&nbsp;<span class="op" id="1990900">!=</span>&nbsp;<span class="ident" id="1990903">nil</span>&nbsp;<span class="op" id="1990907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990912">p</span><span class="op" id="1990913">.</span><span class="builtinfunc" id="1990914">print</span><span class="op" id="1990919">(</span><span class="ident" id="1990920">token</span><span class="op" id="1990925">.</span><span class="ident" id="1990926">CASE</span><span class="op" id="1990930">,</span>&nbsp;<span class="ident" id="1990932">blank</span><span class="op" id="1990937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990942">p</span><span class="op" id="1990943">.</span><span class="ident" id="1990944">exprList</span><span class="op" id="1990952">(</span><span class="ident" id="1990953">s</span><span class="op" id="1990954">.</span><span class="ident" id="1990955">Pos</span><span class="op" id="1990958">(</span><span class="op" id="1990959">)</span><span class="op" id="1990960">,</span>&nbsp;<span class="ident" id="1990962">s</span><span class="op" id="1990963">.</span><span class="ident" id="1990964">List</span><span class="op" id="1990968">,</span>&nbsp;<span class="num" id="1990970">1</span><span class="op" id="1990971">,</span>&nbsp;<span class="num" id="1990973">0</span><span class="op" id="1990974">,</span>&nbsp;<span class="ident" id="1990976">s</span><span class="op" id="1990977">.</span><span class="ident" id="1990978">Colon</span><span class="op" id="1990983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990987">}</span>&nbsp;<span class="keyword" id="1990989">else</span>&nbsp;<span class="op" id="1990994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990999">p</span><span class="op" id="1991000">.</span><span class="builtinfunc" id="1991001">print</span><span class="op" id="1991006">(</span><span class="ident" id="1991007">token</span><span class="op" id="1991012">.</span><span class="ident" id="1991013">DEFAULT</span><span class="op" id="1991020">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991028">p</span><span class="op" id="1991029">.</span><span class="builtinfunc" id="1991030">print</span><span class="op" id="1991035">(</span><span class="ident" id="1991036">s</span><span class="op" id="1991037">.</span><span class="ident" id="1991038">Colon</span><span class="op" id="1991043">,</span>&nbsp;<span class="ident" id="1991045">token</span><span class="op" id="1991050">.</span><span class="ident" id="1991051">COLON</span><span class="op" id="1991056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991060">p</span><span class="op" id="1991061">.</span><span class="ident" id="1991062">stmtList</span><span class="op" id="1991070">(</span><span class="ident" id="1991071">s</span><span class="op" id="1991072">.</span><span class="ident" id="1991073">Body</span><span class="op" id="1991077">,</span>&nbsp;<span class="num" id="1991079">1</span><span class="op" id="1991080">,</span>&nbsp;<span class="ident" id="1991082">nextIsRBrace</span><span class="op" id="1991094">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1991098">case</span>&nbsp;<span class="op" id="1991103">*</span><span class="ident" id="1991104">ast</span><span class="op" id="1991107">.</span><span class="ident" id="1991108">SwitchStmt</span><span class="op" id="1991118">:</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991122">p</span><span class="op" id="1991123">.</span><span class="builtinfunc" id="1991124">print</span><span class="op" id="1991129">(</span><span class="ident" id="1991130">token</span><span class="op" id="1991135">.</span><span class="ident" id="1991136">SWITCH</span><span class="op" id="1991142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991146">p</span><span class="op" id="1991147">.</span><span class="ident" id="1991148">controlClause</span><span class="op" id="1991161">(</span><span class="builtintype" id="1991162">false</span><span class="op" id="1991167">,</span>&nbsp;<span class="ident" id="1991169">s</span><span class="op" id="1991170">.</span><span class="ident" id="1991171">Init</span><span class="op" id="1991175">,</span>&nbsp;<span class="ident" id="1991177">s</span><span class="op" id="1991178">.</span><span class="ident" id="1991179">Tag</span><span class="op" id="1991182">,</span>&nbsp;<span class="ident" id="1991184">nil</span><span class="op" id="1991187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991191">p</span><span class="op" id="1991192">.</span><span class="ident" id="1991193">block</span><span class="op" id="1991198">(</span><span class="ident" id="1991199">s</span><span class="op" id="1991200">.</span><span class="ident" id="1991201">Body</span><span class="op" id="1991205">,</span>&nbsp;<span class="num" id="1991207">0</span><span class="op" id="1991208">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1991212">case</span>&nbsp;<span class="op" id="1991217">*</span><span class="ident" id="1991218">ast</span><span class="op" id="1991221">.</span><span class="ident" id="1991222">TypeSwitchStmt</span><span class="op" id="1991236">:</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991240">p</span><span class="op" id="1991241">.</span><span class="builtinfunc" id="1991242">print</span><span class="op" id="1991247">(</span><span class="ident" id="1991248">token</span><span class="op" id="1991253">.</span><span class="ident" id="1991254">SWITCH</span><span class="op" id="1991260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1991264">if</span>&nbsp;<span class="ident" id="1991267">s</span><span class="op" id="1991268">.</span><span class="ident" id="1991269">Init</span>&nbsp;<span class="op" id="1991274">!=</span>&nbsp;<span class="ident" id="1991277">nil</span>&nbsp;<span class="op" id="1991281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991286">p</span><span class="op" id="1991287">.</span><span class="builtinfunc" id="1991288">print</span><span class="op" id="1991293">(</span><span class="ident" id="1991294">blank</span><span class="op" id="1991299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991304">p</span><span class="op" id="1991305">.</span><span class="ident" id="1991306">stmt</span><span class="op" id="1991310">(</span><span class="ident" id="1991311">s</span><span class="op" id="1991312">.</span><span class="ident" id="1991313">Init</span><span class="op" id="1991317">,</span>&nbsp;<span class="builtintype" id="1991319">false</span><span class="op" id="1991324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991329">p</span><span class="op" id="1991330">.</span><span class="builtinfunc" id="1991331">print</span><span class="op" id="1991336">(</span><span class="ident" id="1991337">token</span><span class="op" id="1991342">.</span><span class="ident" id="1991343">SEMICOLON</span><span class="op" id="1991352">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991360">p</span><span class="op" id="1991361">.</span><span class="builtinfunc" id="1991362">print</span><span class="op" id="1991367">(</span><span class="ident" id="1991368">blank</span><span class="op" id="1991373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991377">p</span><span class="op" id="1991378">.</span><span class="ident" id="1991379">stmt</span><span class="op" id="1991383">(</span><span class="ident" id="1991384">s</span><span class="op" id="1991385">.</span><span class="ident" id="1991386">Assign</span><span class="op" id="1991392">,</span>&nbsp;<span class="builtintype" id="1991394">false</span><span class="op" id="1991399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991403">p</span><span class="op" id="1991404">.</span><span class="builtinfunc" id="1991405">print</span><span class="op" id="1991410">(</span><span class="ident" id="1991411">blank</span><span class="op" id="1991416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991420">p</span><span class="op" id="1991421">.</span><span class="ident" id="1991422">block</span><span class="op" id="1991427">(</span><span class="ident" id="1991428">s</span><span class="op" id="1991429">.</span><span class="ident" id="1991430">Body</span><span class="op" id="1991434">,</span>&nbsp;<span class="num" id="1991436">0</span><span class="op" id="1991437">)</span><br>
<span class="lineno">1195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1991441">case</span>&nbsp;<span class="op" id="1991446">*</span><span class="ident" id="1991447">ast</span><span class="op" id="1991450">.</span><span class="ident" id="1991451">CommClause</span><span class="op" id="1991461">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1991465">if</span>&nbsp;<span class="ident" id="1991468">s</span><span class="op" id="1991469">.</span><span class="ident" id="1991470">Comm</span>&nbsp;<span class="op" id="1991475">!=</span>&nbsp;<span class="ident" id="1991478">nil</span>&nbsp;<span class="op" id="1991482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991487">p</span><span class="op" id="1991488">.</span><span class="builtinfunc" id="1991489">print</span><span class="op" id="1991494">(</span><span class="ident" id="1991495">token</span><span class="op" id="1991500">.</span><span class="ident" id="1991501">CASE</span><span class="op" id="1991505">,</span>&nbsp;<span class="ident" id="1991507">blank</span><span class="op" id="1991512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991517">p</span><span class="op" id="1991518">.</span><span class="ident" id="1991519">stmt</span><span class="op" id="1991523">(</span><span class="ident" id="1991524">s</span><span class="op" id="1991525">.</span><span class="ident" id="1991526">Comm</span><span class="op" id="1991530">,</span>&nbsp;<span class="builtintype" id="1991532">false</span><span class="op" id="1991537">)</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991541">}</span>&nbsp;<span class="keyword" id="1991543">else</span>&nbsp;<span class="op" id="1991548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991553">p</span><span class="op" id="1991554">.</span><span class="builtinfunc" id="1991555">print</span><span class="op" id="1991560">(</span><span class="ident" id="1991561">token</span><span class="op" id="1991566">.</span><span class="ident" id="1991567">DEFAULT</span><span class="op" id="1991574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991582">p</span><span class="op" id="1991583">.</span><span class="builtinfunc" id="1991584">print</span><span class="op" id="1991589">(</span><span class="ident" id="1991590">s</span><span class="op" id="1991591">.</span><span class="ident" id="1991592">Colon</span><span class="op" id="1991597">,</span>&nbsp;<span class="ident" id="1991599">token</span><span class="op" id="1991604">.</span><span class="ident" id="1991605">COLON</span><span class="op" id="1991610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991614">p</span><span class="op" id="1991615">.</span><span class="ident" id="1991616">stmtList</span><span class="op" id="1991624">(</span><span class="ident" id="1991625">s</span><span class="op" id="1991626">.</span><span class="ident" id="1991627">Body</span><span class="op" id="1991631">,</span>&nbsp;<span class="num" id="1991633">1</span><span class="op" id="1991634">,</span>&nbsp;<span class="ident" id="1991636">nextIsRBrace</span><span class="op" id="1991648">)</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1991652">case</span>&nbsp;<span class="op" id="1991657">*</span><span class="ident" id="1991658">ast</span><span class="op" id="1991661">.</span><span class="ident" id="1991662">SelectStmt</span><span class="op" id="1991672">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991676">p</span><span class="op" id="1991677">.</span><span class="builtinfunc" id="1991678">print</span><span class="op" id="1991683">(</span><span class="ident" id="1991684">token</span><span class="op" id="1991689">.</span><span class="ident" id="1991690">SELECT</span><span class="op" id="1991696">,</span>&nbsp;<span class="ident" id="1991698">blank</span><span class="op" id="1991703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991707">body</span>&nbsp;<span class="op" id="1991712">:=</span>&nbsp;<span class="ident" id="1991715">s</span><span class="op" id="1991716">.</span><span class="ident" id="1991717">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1991724">if</span>&nbsp;<span class="builtinfunc" id="1991727">len</span><span class="op" id="1991730">(</span><span class="ident" id="1991731">body</span><span class="op" id="1991735">.</span><span class="ident" id="1991736">List</span><span class="op" id="1991740">)</span>&nbsp;<span class="op" id="1991742">==</span>&nbsp;<span class="num" id="1991745">0</span>&nbsp;<span class="op" id="1991747">&amp;&amp;</span>&nbsp;<span class="op" id="1991750">!</span><span class="ident" id="1991751">p</span><span class="op" id="1991752">.</span><span class="ident" id="1991753">commentBefore</span><span class="op" id="1991766">(</span><span class="ident" id="1991767">p</span><span class="op" id="1991768">.</span><span class="ident" id="1991769">posFor</span><span class="op" id="1991775">(</span><span class="ident" id="1991776">body</span><span class="op" id="1991780">.</span><span class="ident" id="1991781">Rbrace</span><span class="op" id="1991787">)</span><span class="op" id="1991788">)</span>&nbsp;<span class="op" id="1991790">{</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1991795">//&nbsp;print&nbsp;empty&nbsp;select&nbsp;statement&nbsp;w/o&nbsp;comments&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991855">p</span><span class="op" id="1991856">.</span><span class="builtinfunc" id="1991857">print</span><span class="op" id="1991862">(</span><span class="ident" id="1991863">body</span><span class="op" id="1991867">.</span><span class="ident" id="1991868">Lbrace</span><span class="op" id="1991874">,</span>&nbsp;<span class="ident" id="1991876">token</span><span class="op" id="1991881">.</span><span class="ident" id="1991882">LBRACE</span><span class="op" id="1991888">,</span>&nbsp;<span class="ident" id="1991890">body</span><span class="op" id="1991894">.</span><span class="ident" id="1991895">Rbrace</span><span class="op" id="1991901">,</span>&nbsp;<span class="ident" id="1991903">token</span><span class="op" id="1991908">.</span><span class="ident" id="1991909">RBRACE</span><span class="op" id="1991915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991919">}</span>&nbsp;<span class="keyword" id="1991921">else</span>&nbsp;<span class="op" id="1991926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991931">p</span><span class="op" id="1991932">.</span><span class="ident" id="1991933">block</span><span class="op" id="1991938">(</span><span class="ident" id="1991939">body</span><span class="op" id="1991943">,</span>&nbsp;<span class="num" id="1991945">0</span><span class="op" id="1991946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1991950">}</span><br>
<span class="lineno">1215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1991954">case</span>&nbsp;<span class="op" id="1991959">*</span><span class="ident" id="1991960">ast</span><span class="op" id="1991963">.</span><span class="ident" id="1991964">ForStmt</span><span class="op" id="1991971">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991975">p</span><span class="op" id="1991976">.</span><span class="builtinfunc" id="1991977">print</span><span class="op" id="1991982">(</span><span class="ident" id="1991983">token</span><span class="op" id="1991988">.</span><span class="ident" id="1991989">FOR</span><span class="op" id="1991992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1991996">p</span><span class="op" id="1991997">.</span><span class="ident" id="1991998">controlClause</span><span class="op" id="1992011">(</span><span class="builtintype" id="1992012">true</span><span class="op" id="1992016">,</span>&nbsp;<span class="ident" id="1992018">s</span><span class="op" id="1992019">.</span><span class="ident" id="1992020">Init</span><span class="op" id="1992024">,</span>&nbsp;<span class="ident" id="1992026">s</span><span class="op" id="1992027">.</span><span class="ident" id="1992028">Cond</span><span class="op" id="1992032">,</span>&nbsp;<span class="ident" id="1992034">s</span><span class="op" id="1992035">.</span><span class="ident" id="1992036">Post</span><span class="op" id="1992040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1992044">p</span><span class="op" id="1992045">.</span><span class="ident" id="1992046">block</span><span class="op" id="1992051">(</span><span class="ident" id="1992052">s</span><span class="op" id="1992053">.</span><span class="ident" id="1992054">Body</span><span class="op" id="1992058">,</span>&nbsp;<span class="num" id="1992060">1</span><span class="op" id="1992061">)</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1992065">case</span>&nbsp;<span class="op" id="1992070">*</span><span class="ident" id="1992071">ast</span><span class="op" id="1992074">.</span><span class="ident" id="1992075">RangeStmt</span><span class="op" id="1992084">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1992088">p</span><span class="op" id="1992089">.</span><span class="builtinfunc" id="1992090">print</span><span class="op" id="1992095">(</span><span class="ident" id="1992096">token</span><span class="op" id="1992101">.</span><span class="ident" id="1992102">FOR</span><span class="op" id="1992105">,</span>&nbsp;<span class="ident" id="1992107">blank</span><span class="op" id="1992112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1992116">if</span>&nbsp;<span class="ident" id="1992119">s</span><span class="op" id="1992120">.</span><span class="ident" id="1992121">Key</span>&nbsp;<span class="op" id="1992125">!=</span>&nbsp;<span class="ident" id="1992128">nil</span>&nbsp;<span class="op" id="1992132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1992137">p</span><span class="op" id="1992138">.</span><span class="ident" id="1992139">expr</span><span class="op" id="1992143">(</span><span class="ident" id="1992144">s</span><span class="op" id="1992145">.</span><span class="ident" id="1992146">Key</span><span class="op" id="1992149">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1992154">if</span>&nbsp;<span class="ident" id="1992157">s</span><span class="op" id="1992158">.</span><span class="ident" id="1992159">Value</span>&nbsp;<span class="op" id="1992165">!=</span>&nbsp;<span class="ident" id="1992168">nil</span>&nbsp;<span class="op" id="1992172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1992178">//&nbsp;use&nbsp;position&nbsp;of&nbsp;value&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1992230">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1992282">p</span><span class="op" id="1992283">.</span><span class="builtinfunc" id="1992284">print</span><span class="op" id="1992289">(</span><span class="ident" id="1992290">s</span><span class="op" id="1992291">.</span><span class="ident" id="1992292">Value</span><span class="op" id="1992297">.</span><span class="ident" id="1992298">Pos</span><span class="op" id="1992301">(</span><span class="op" id="1992302">)</span><span class="op" id="1992303">,</span>&nbsp;<span class="ident" id="1992305">token</span><span class="op" id="1992310">.</span><span class="ident" id="1992311">COMMA</span><span class="op" id="1992316">,</span>&nbsp;<span class="ident" id="1992318">blank</span><span class="op" id="1992323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1992329">p</span><span class="op" id="1992330">.</span><span class="ident" id="1992331">expr</span><span class="op" id="1992335">(</span><span class="ident" id="1992336">s</span><span class="op" id="1992337">.</span><span class="ident" id="1992338">Value</span><span class="op" id="1992343">)</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1992353">p</span><span class="op" id="1992354">.</span><span class="builtinfunc" id="1992355">print</span><span class="op" id="1992360">(</span><span class="ident" id="1992361">blank</span><span class="op" id="1992366">,</span>&nbsp;<span class="ident" id="1992368">s</span><span class="op" id="1992369">.</span><span class="ident" id="1992370">TokPos</span><span class="op" id="1992376">,</span>&nbsp;<span class="ident" id="1992378">s</span><span class="op" id="1992379">.</span><span class="ident" id="1992380">Tok</span><span class="op" id="1992383">,</span>&nbsp;<span class="ident" id="1992385">blank</span><span class="op" id="1992390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1992398">p</span><span class="op" id="1992399">.</span><span class="builtinfunc" id="1992400">print</span><span class="op" id="1992405">(</span><span class="ident" id="1992406">token</span><span class="op" id="1992411">.</span><span class="ident" id="1992412">RANGE</span><span class="op" id="1992417">,</span>&nbsp;<span class="ident" id="1992419">blank</span><span class="op" id="1992424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1992428">p</span><span class="op" id="1992429">.</span><span class="ident" id="1992430">expr</span><span class="op" id="1992434">(</span><span class="ident" id="1992435">stripParens</span><span class="op" id="1992446">(</span><span class="ident" id="1992447">s</span><span class="op" id="1992448">.</span><span class="ident" id="1992449">X</span><span class="op" id="1992450">)</span><span class="op" id="1992451">)</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1992455">p</span><span class="op" id="1992456">.</span><span class="builtinfunc" id="1992457">print</span><span class="op" id="1992462">(</span><span class="ident" id="1992463">blank</span><span class="op" id="1992468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1992472">p</span><span class="op" id="1992473">.</span><span class="ident" id="1992474">block</span><span class="op" id="1992479">(</span><span class="ident" id="1992480">s</span><span class="op" id="1992481">.</span><span class="ident" id="1992482">Body</span><span class="op" id="1992486">,</span>&nbsp;<span class="num" id="1992488">1</span><span class="op" id="1992489">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1992493">default</span><span class="op" id="1992500">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1992504">panic</span><span class="op" id="1992509">(</span><span class="string" id="1992510">&#34;unreachable&#34;</span><span class="op" id="1992523">)</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1992526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1992530">return</span><br>
<span class="lineno"></span><span class="op" id="1992537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1245</span><span class="comment" id="1992540">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="1992620">//&nbsp;Declarations</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1992637">//&nbsp;The&nbsp;keepTypeColumn&nbsp;function&nbsp;determines&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;of&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1992713">//&nbsp;consecutive&nbsp;const&nbsp;or&nbsp;var&nbsp;declarations&nbsp;must&nbsp;be&nbsp;kept,&nbsp;or&nbsp;if&nbsp;initialization</span><br>
<span class="lineno">1250</span><span class="comment" id="1992789">//&nbsp;values&nbsp;(V)&nbsp;can&nbsp;be&nbsp;placed&nbsp;in&nbsp;the&nbsp;type&nbsp;column&nbsp;(T)&nbsp;instead.&nbsp;The&nbsp;i&#39;th&nbsp;entry</span><br>
<span class="lineno"></span><span class="comment" id="1992864">//&nbsp;in&nbsp;the&nbsp;result&nbsp;slice&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;in&nbsp;spec[i]&nbsp;must&nbsp;be&nbsp;kept.</span><br>
<span class="lineno"></span><span class="comment" id="1992939">//</span><br>
<span class="lineno"></span><span class="comment" id="1992942">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;declaration:</span><br>
<span class="lineno"></span><span class="comment" id="1992975">//</span><br>
<span class="lineno">1255</span><span class="comment" id="1992978">//&nbsp;&nbsp;&nbsp;&nbspconst&nbsp;(</span><br>
<span class="lineno"></span><span class="comment" id="1992989">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspfoobar&nbsp;int&nbsp;=&nbsp;42&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="1993020">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7&nbsp;&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="1993051">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspfoo</span><br>
<span class="lineno"></span><span class="comment" id="1993059">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bar&nbsp;=&nbsp;991</span><br>
<span class="lineno">1260</span><span class="comment" id="1993085">//&nbsp;&nbsp;&nbsp;&nbsp)</span><br>
<span class="lineno"></span><span class="comment" id="1993090">//</span><br>
<span class="lineno"></span><span class="comment" id="1993093">//&nbsp;leads&nbsp;to&nbsp;the&nbsp;type/values&nbsp;matrix&nbsp;below.&nbsp;A&nbsp;run&nbsp;of&nbsp;value&nbsp;columns&nbsp;(V)&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="1993166">//&nbsp;be&nbsp;moved&nbsp;into&nbsp;the&nbsp;type&nbsp;column&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;type&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="1993241">//&nbsp;in&nbsp;that&nbsp;column&nbsp;(we&nbsp;only&nbsp;move&nbsp;entire&nbsp;columns&nbsp;so&nbsp;that&nbsp;they&nbsp;align&nbsp;properly).</span><br>
<span class="lineno">1265</span><span class="comment" id="1993318">//</span><br>
<span class="lineno"></span><span class="comment" id="1993321">//&nbsp;&nbsp;&nbsp;&nbspmatrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatted&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result</span><br>
<span class="lineno"></span><span class="comment" id="1993359">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix</span><br>
<span class="lineno"></span><span class="comment" id="1993388">//&nbsp;&nbsp;&nbsp;&nbspT&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;a&nbsp;T&nbsp;and&nbsp;so&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="1993458">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno">1270</span><span class="comment" id="1993519">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="1993556">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;is&nbsp;moved&nbsp;into&nbsp;T&nbsp;column</span><br>
<span class="lineno"></span><span class="comment" id="1993622">//</span><br>
<span class="lineno"></span><span class="keyword" id="1993625">func</span>&nbsp;<span class="ident" id="1993630">keepTypeColumn</span><span class="op" id="1993644">(</span><span class="ident" id="1993645">specs</span>&nbsp;<span class="op" id="1993651">[</span><span class="op" id="1993652">]</span><span class="ident" id="1993653">ast</span><span class="op" id="1993656">.</span><span class="ident" id="1993657">Spec</span><span class="op" id="1993661">)</span>&nbsp;<span class="op" id="1993663">[</span><span class="op" id="1993664">]</span><span class="builtintype" id="1993665">bool</span>&nbsp;<span class="op" id="1993670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993673">m</span>&nbsp;<span class="op" id="1993675">:=</span>&nbsp;<span class="builtinfunc" id="1993678">make</span><span class="op" id="1993682">(</span><span class="op" id="1993683">[</span><span class="op" id="1993684">]</span><span class="builtintype" id="1993685">bool</span><span class="op" id="1993689">,</span>&nbsp;<span class="builtinfunc" id="1993691">len</span><span class="op" id="1993694">(</span><span class="ident" id="1993695">specs</span><span class="op" id="1993700">)</span><span class="op" id="1993701">)</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993705">populate</span>&nbsp;<span class="op" id="1993714">:=</span>&nbsp;<span class="keyword" id="1993717">func</span><span class="op" id="1993721">(</span><span class="ident" id="1993722">i</span><span class="op" id="1993723">,</span>&nbsp;<span class="ident" id="1993725">j</span>&nbsp;<span class="builtintype" id="1993727">int</span><span class="op" id="1993730">,</span>&nbsp;<span class="ident" id="1993732">keepType</span>&nbsp;<span class="builtintype" id="1993741">bool</span><span class="op" id="1993745">)</span>&nbsp;<span class="op" id="1993747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1993751">if</span>&nbsp;<span class="ident" id="1993754">keepType</span>&nbsp;<span class="op" id="1993763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1993768">for</span>&nbsp;<span class="op" id="1993772">;</span>&nbsp;<span class="ident" id="1993774">i</span>&nbsp;<span class="op" id="1993776">&lt;</span>&nbsp;<span class="ident" id="1993778">j</span><span class="op" id="1993779">;</span>&nbsp;<span class="ident" id="1993781">i</span><span class="op" id="1993782">++</span>&nbsp;<span class="op" id="1993785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993791">m</span><span class="op" id="1993792">[</span><span class="ident" id="1993793">i</span><span class="op" id="1993794">]</span>&nbsp;<span class="op" id="1993796">=</span>&nbsp;<span class="builtintype" id="1993798">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1993806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1993810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1993813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993817">i0</span>&nbsp;<span class="op" id="1993820">:=</span>&nbsp;<span class="op" id="1993823">-</span><span class="num" id="1993824">1</span>&nbsp;<span class="comment" id="1993826">//&nbsp;if&nbsp;i0&nbsp;&gt;=&nbsp;0&nbsp;we&nbsp;are&nbsp;in&nbsp;a&nbsp;run&nbsp;and&nbsp;i0&nbsp;is&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;run</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1993888">var</span>&nbsp;<span class="ident" id="1993892">keepType</span>&nbsp;<span class="builtintype" id="1993901">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1993907">for</span>&nbsp;<span class="ident" id="1993911">i</span><span class="op" id="1993912">,</span>&nbsp;<span class="ident" id="1993914">s</span>&nbsp;<span class="op" id="1993916">:=</span>&nbsp;<span class="keyword" id="1993919">range</span>&nbsp;<span class="ident" id="1993925">specs</span>&nbsp;<span class="op" id="1993931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1993935">t</span>&nbsp;<span class="op" id="1993937">:=</span>&nbsp;<span class="ident" id="1993940">s</span><span class="op" id="1993941">.</span><span class="op" id="1993942">(</span><span class="op" id="1993943">*</span><span class="ident" id="1993944">ast</span><span class="op" id="1993947">.</span><span class="ident" id="1993948">ValueSpec</span><span class="op" id="1993957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1993961">if</span>&nbsp;<span class="ident" id="1993964">t</span><span class="op" id="1993965">.</span><span class="ident" id="1993966">Values</span>&nbsp;<span class="op" id="1993973">!=</span>&nbsp;<span class="ident" id="1993976">nil</span>&nbsp;<span class="op" id="1993980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1993985">if</span>&nbsp;<span class="ident" id="1993988">i0</span>&nbsp;<span class="op" id="1993991">&lt;</span>&nbsp;<span class="num" id="1993993">0</span>&nbsp;<span class="op" id="1993995">{</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1994001">//&nbsp;start&nbsp;of&nbsp;a&nbsp;run&nbsp;of&nbsp;ValueSpecs&nbsp;with&nbsp;non-nil&nbsp;Values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994057">i0</span>&nbsp;<span class="op" id="1994060">=</span>&nbsp;<span class="ident" id="1994062">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994068">keepType</span>&nbsp;<span class="op" id="1994077">=</span>&nbsp;<span class="builtintype" id="1994079">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994092">}</span>&nbsp;<span class="keyword" id="1994094">else</span>&nbsp;<span class="op" id="1994099">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994104">if</span>&nbsp;<span class="ident" id="1994107">i0</span>&nbsp;<span class="op" id="1994110">&gt;=</span>&nbsp;<span class="num" id="1994113">0</span>&nbsp;<span class="op" id="1994115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1994121">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994141">populate</span><span class="op" id="1994149">(</span><span class="ident" id="1994150">i0</span><span class="op" id="1994152">,</span>&nbsp;<span class="ident" id="1994154">i</span><span class="op" id="1994155">,</span>&nbsp;<span class="ident" id="1994157">keepType</span><span class="op" id="1994165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994171">i0</span>&nbsp;<span class="op" id="1994174">=</span>&nbsp;<span class="op" id="1994176">-</span><span class="num" id="1994177">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994182">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994190">if</span>&nbsp;<span class="ident" id="1994193">t</span><span class="op" id="1994194">.</span><span class="ident" id="1994195">Type</span>&nbsp;<span class="op" id="1994200">!=</span>&nbsp;<span class="ident" id="1994203">nil</span>&nbsp;<span class="op" id="1994207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994212">keepType</span>&nbsp;<span class="op" id="1994221">=</span>&nbsp;<span class="builtintype" id="1994223">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994233">}</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994236">if</span>&nbsp;<span class="ident" id="1994239">i0</span>&nbsp;<span class="op" id="1994242">&gt;=</span>&nbsp;<span class="num" id="1994245">0</span>&nbsp;<span class="op" id="1994247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1994251">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994269">populate</span><span class="op" id="1994277">(</span><span class="ident" id="1994278">i0</span><span class="op" id="1994280">,</span>&nbsp;<span class="builtinfunc" id="1994282">len</span><span class="op" id="1994285">(</span><span class="ident" id="1994286">specs</span><span class="op" id="1994291">)</span><span class="op" id="1994292">,</span>&nbsp;<span class="ident" id="1994294">keepType</span><span class="op" id="1994302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994309">return</span>&nbsp;<span class="ident" id="1994316">m</span><br>
<span class="lineno"></span><span class="op" id="1994318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1994321">func</span>&nbsp;<span class="op" id="1994326">(</span><span class="ident" id="1994327">p</span>&nbsp;<span class="op" id="1994329">*</span><span class="ident" id="1994330">printer</span><span class="op" id="1994337">)</span>&nbsp;<span class="ident" id="1994339">valueSpec</span><span class="op" id="1994348">(</span><span class="ident" id="1994349">s</span>&nbsp;<span class="op" id="1994351">*</span><span class="ident" id="1994352">ast</span><span class="op" id="1994355">.</span><span class="ident" id="1994356">ValueSpec</span><span class="op" id="1994365">,</span>&nbsp;<span class="ident" id="1994367">keepType</span>&nbsp;<span class="builtintype" id="1994376">bool</span><span class="op" id="1994380">)</span>&nbsp;<span class="op" id="1994382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994385">p</span><span class="op" id="1994386">.</span><span class="ident" id="1994387">setComment</span><span class="op" id="1994397">(</span><span class="ident" id="1994398">s</span><span class="op" id="1994399">.</span><span class="ident" id="1994400">Doc</span><span class="op" id="1994403">)</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994406">p</span><span class="op" id="1994407">.</span><span class="ident" id="1994408">identList</span><span class="op" id="1994417">(</span><span class="ident" id="1994418">s</span><span class="op" id="1994419">.</span><span class="ident" id="1994420">Names</span><span class="op" id="1994425">,</span>&nbsp;<span class="builtintype" id="1994427">false</span><span class="op" id="1994432">)</span>&nbsp;<span class="comment" id="1994434">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994453">extraTabs</span>&nbsp;<span class="op" id="1994463">:=</span>&nbsp;<span class="num" id="1994466">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994469">if</span>&nbsp;<span class="ident" id="1994472">s</span><span class="op" id="1994473">.</span><span class="ident" id="1994474">Type</span>&nbsp;<span class="op" id="1994479">!=</span>&nbsp;<span class="ident" id="1994482">nil</span>&nbsp;<span class="op" id="1994486">||</span>&nbsp;<span class="ident" id="1994489">keepType</span>&nbsp;<span class="op" id="1994498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994502">p</span><span class="op" id="1994503">.</span><span class="builtinfunc" id="1994504">print</span><span class="op" id="1994509">(</span><span class="ident" id="1994510">vtab</span><span class="op" id="1994514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994518">extraTabs</span><span class="op" id="1994527">--</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994534">if</span>&nbsp;<span class="ident" id="1994537">s</span><span class="op" id="1994538">.</span><span class="ident" id="1994539">Type</span>&nbsp;<span class="op" id="1994544">!=</span>&nbsp;<span class="ident" id="1994547">nil</span>&nbsp;<span class="op" id="1994551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994555">p</span><span class="op" id="1994556">.</span><span class="ident" id="1994557">expr</span><span class="op" id="1994561">(</span><span class="ident" id="1994562">s</span><span class="op" id="1994563">.</span><span class="ident" id="1994564">Type</span><span class="op" id="1994568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994574">if</span>&nbsp;<span class="ident" id="1994577">s</span><span class="op" id="1994578">.</span><span class="ident" id="1994579">Values</span>&nbsp;<span class="op" id="1994586">!=</span>&nbsp;<span class="ident" id="1994589">nil</span>&nbsp;<span class="op" id="1994593">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994597">p</span><span class="op" id="1994598">.</span><span class="builtinfunc" id="1994599">print</span><span class="op" id="1994604">(</span><span class="ident" id="1994605">vtab</span><span class="op" id="1994609">,</span>&nbsp;<span class="ident" id="1994611">token</span><span class="op" id="1994616">.</span><span class="ident" id="1994617">ASSIGN</span><span class="op" id="1994623">,</span>&nbsp;<span class="ident" id="1994625">blank</span><span class="op" id="1994630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994634">p</span><span class="op" id="1994635">.</span><span class="ident" id="1994636">exprList</span><span class="op" id="1994644">(</span><span class="ident" id="1994645">token</span><span class="op" id="1994650">.</span><span class="ident" id="1994651">NoPos</span><span class="op" id="1994656">,</span>&nbsp;<span class="ident" id="1994658">s</span><span class="op" id="1994659">.</span><span class="ident" id="1994660">Values</span><span class="op" id="1994666">,</span>&nbsp;<span class="num" id="1994668">1</span><span class="op" id="1994669">,</span>&nbsp;<span class="num" id="1994671">0</span><span class="op" id="1994672">,</span>&nbsp;<span class="ident" id="1994674">token</span><span class="op" id="1994679">.</span><span class="ident" id="1994680">NoPos</span><span class="op" id="1994685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994689">extraTabs</span><span class="op" id="1994698">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994705">if</span>&nbsp;<span class="ident" id="1994708">s</span><span class="op" id="1994709">.</span><span class="ident" id="1994710">Comment</span>&nbsp;<span class="op" id="1994718">!=</span>&nbsp;<span class="ident" id="1994721">nil</span>&nbsp;<span class="op" id="1994725">{</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994729">for</span>&nbsp;<span class="op" id="1994733">;</span>&nbsp;<span class="ident" id="1994735">extraTabs</span>&nbsp;<span class="op" id="1994745">&gt;</span>&nbsp;<span class="num" id="1994747">0</span><span class="op" id="1994748">;</span>&nbsp;<span class="ident" id="1994750">extraTabs</span><span class="op" id="1994759">--</span>&nbsp;<span class="op" id="1994762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994767">p</span><span class="op" id="1994768">.</span><span class="builtinfunc" id="1994769">print</span><span class="op" id="1994774">(</span><span class="ident" id="1994775">vtab</span><span class="op" id="1994779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994787">p</span><span class="op" id="1994788">.</span><span class="ident" id="1994789">setComment</span><span class="op" id="1994799">(</span><span class="ident" id="1994800">s</span><span class="op" id="1994801">.</span><span class="ident" id="1994802">Comment</span><span class="op" id="1994809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994812">}</span><br>
<span class="lineno">1335</span><span class="op" id="1994814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1994817">//&nbsp;The&nbsp;parameter&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;specs&nbsp;in&nbsp;the&nbsp;group.&nbsp;If&nbsp;doIndent&nbsp;is&nbsp;set,</span><br>
<span class="lineno"></span><span class="comment" id="1994893">//&nbsp;multi-line&nbsp;identifier&nbsp;lists&nbsp;in&nbsp;the&nbsp;spec&nbsp;are&nbsp;indented&nbsp;when&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="1994964">//&nbsp;linebreak&nbsp;is&nbsp;encountered.</span><br>
<span class="lineno">1340</span><span class="comment" id="1994993">//</span><br>
<span class="lineno"></span><span class="keyword" id="1994996">func</span>&nbsp;<span class="op" id="1995001">(</span><span class="ident" id="1995002">p</span>&nbsp;<span class="op" id="1995004">*</span><span class="ident" id="1995005">printer</span><span class="op" id="1995012">)</span>&nbsp;<span class="ident" id="1995014">spec</span><span class="op" id="1995018">(</span><span class="ident" id="1995019">spec</span>&nbsp;<span class="ident" id="1995024">ast</span><span class="op" id="1995027">.</span><span class="ident" id="1995028">Spec</span><span class="op" id="1995032">,</span>&nbsp;<span class="ident" id="1995034">n</span>&nbsp;<span class="builtintype" id="1995036">int</span><span class="op" id="1995039">,</span>&nbsp;<span class="ident" id="1995041">doIndent</span>&nbsp;<span class="builtintype" id="1995050">bool</span><span class="op" id="1995054">)</span>&nbsp;<span class="op" id="1995056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995059">switch</span>&nbsp;<span class="ident" id="1995066">s</span>&nbsp;<span class="op" id="1995068">:=</span>&nbsp;<span class="ident" id="1995071">spec</span><span class="op" id="1995075">.</span><span class="op" id="1995076">(</span><span class="keyword" id="1995077">type</span><span class="op" id="1995081">)</span>&nbsp;<span class="op" id="1995083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995086">case</span>&nbsp;<span class="op" id="1995091">*</span><span class="ident" id="1995092">ast</span><span class="op" id="1995095">.</span><span class="ident" id="1995096">ImportSpec</span><span class="op" id="1995106">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995110">p</span><span class="op" id="1995111">.</span><span class="ident" id="1995112">setComment</span><span class="op" id="1995122">(</span><span class="ident" id="1995123">s</span><span class="op" id="1995124">.</span><span class="ident" id="1995125">Doc</span><span class="op" id="1995128">)</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995132">if</span>&nbsp;<span class="ident" id="1995135">s</span><span class="op" id="1995136">.</span><span class="ident" id="1995137">Name</span>&nbsp;<span class="op" id="1995142">!=</span>&nbsp;<span class="ident" id="1995145">nil</span>&nbsp;<span class="op" id="1995149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995154">p</span><span class="op" id="1995155">.</span><span class="ident" id="1995156">expr</span><span class="op" id="1995160">(</span><span class="ident" id="1995161">s</span><span class="op" id="1995162">.</span><span class="ident" id="1995163">Name</span><span class="op" id="1995167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995172">p</span><span class="op" id="1995173">.</span><span class="builtinfunc" id="1995174">print</span><span class="op" id="1995179">(</span><span class="ident" id="1995180">blank</span><span class="op" id="1995185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995193">p</span><span class="op" id="1995194">.</span><span class="ident" id="1995195">expr</span><span class="op" id="1995199">(</span><span class="ident" id="1995200">s</span><span class="op" id="1995201">.</span><span class="ident" id="1995202">Path</span><span class="op" id="1995206">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995210">p</span><span class="op" id="1995211">.</span><span class="ident" id="1995212">setComment</span><span class="op" id="1995222">(</span><span class="ident" id="1995223">s</span><span class="op" id="1995224">.</span><span class="ident" id="1995225">Comment</span><span class="op" id="1995232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995236">p</span><span class="op" id="1995237">.</span><span class="builtinfunc" id="1995238">print</span><span class="op" id="1995243">(</span><span class="ident" id="1995244">s</span><span class="op" id="1995245">.</span><span class="ident" id="1995246">EndPos</span><span class="op" id="1995252">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995256">case</span>&nbsp;<span class="op" id="1995261">*</span><span class="ident" id="1995262">ast</span><span class="op" id="1995265">.</span><span class="ident" id="1995266">ValueSpec</span><span class="op" id="1995275">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995279">if</span>&nbsp;<span class="ident" id="1995282">n</span>&nbsp;<span class="op" id="1995284">!=</span>&nbsp;<span class="num" id="1995287">1</span>&nbsp;<span class="op" id="1995289">{</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995294">p</span><span class="op" id="1995295">.</span><span class="ident" id="1995296">internalError</span><span class="op" id="1995309">(</span><span class="string" id="1995310">&#34;expected&nbsp;n&nbsp;=&nbsp;1;&nbsp;got&#34;</span><span class="op" id="1995331">,</span>&nbsp;<span class="ident" id="1995333">n</span><span class="op" id="1995334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995342">p</span><span class="op" id="1995343">.</span><span class="ident" id="1995344">setComment</span><span class="op" id="1995354">(</span><span class="ident" id="1995355">s</span><span class="op" id="1995356">.</span><span class="ident" id="1995357">Doc</span><span class="op" id="1995360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995364">p</span><span class="op" id="1995365">.</span><span class="ident" id="1995366">identList</span><span class="op" id="1995375">(</span><span class="ident" id="1995376">s</span><span class="op" id="1995377">.</span><span class="ident" id="1995378">Names</span><span class="op" id="1995383">,</span>&nbsp;<span class="ident" id="1995385">doIndent</span><span class="op" id="1995393">)</span>&nbsp;<span class="comment" id="1995395">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995415">if</span>&nbsp;<span class="ident" id="1995418">s</span><span class="op" id="1995419">.</span><span class="ident" id="1995420">Type</span>&nbsp;<span class="op" id="1995425">!=</span>&nbsp;<span class="ident" id="1995428">nil</span>&nbsp;<span class="op" id="1995432">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995437">p</span><span class="op" id="1995438">.</span><span class="builtinfunc" id="1995439">print</span><span class="op" id="1995444">(</span><span class="ident" id="1995445">blank</span><span class="op" id="1995450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995455">p</span><span class="op" id="1995456">.</span><span class="ident" id="1995457">expr</span><span class="op" id="1995461">(</span><span class="ident" id="1995462">s</span><span class="op" id="1995463">.</span><span class="ident" id="1995464">Type</span><span class="op" id="1995468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995476">if</span>&nbsp;<span class="ident" id="1995479">s</span><span class="op" id="1995480">.</span><span class="ident" id="1995481">Values</span>&nbsp;<span class="op" id="1995488">!=</span>&nbsp;<span class="ident" id="1995491">nil</span>&nbsp;<span class="op" id="1995495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995500">p</span><span class="op" id="1995501">.</span><span class="builtinfunc" id="1995502">print</span><span class="op" id="1995507">(</span><span class="ident" id="1995508">blank</span><span class="op" id="1995513">,</span>&nbsp;<span class="ident" id="1995515">token</span><span class="op" id="1995520">.</span><span class="ident" id="1995521">ASSIGN</span><span class="op" id="1995527">,</span>&nbsp;<span class="ident" id="1995529">blank</span><span class="op" id="1995534">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995539">p</span><span class="op" id="1995540">.</span><span class="ident" id="1995541">exprList</span><span class="op" id="1995549">(</span><span class="ident" id="1995550">token</span><span class="op" id="1995555">.</span><span class="ident" id="1995556">NoPos</span><span class="op" id="1995561">,</span>&nbsp;<span class="ident" id="1995563">s</span><span class="op" id="1995564">.</span><span class="ident" id="1995565">Values</span><span class="op" id="1995571">,</span>&nbsp;<span class="num" id="1995573">1</span><span class="op" id="1995574">,</span>&nbsp;<span class="num" id="1995576">0</span><span class="op" id="1995577">,</span>&nbsp;<span class="ident" id="1995579">token</span><span class="op" id="1995584">.</span><span class="ident" id="1995585">NoPos</span><span class="op" id="1995590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995598">p</span><span class="op" id="1995599">.</span><span class="ident" id="1995600">setComment</span><span class="op" id="1995610">(</span><span class="ident" id="1995611">s</span><span class="op" id="1995612">.</span><span class="ident" id="1995613">Comment</span><span class="op" id="1995620">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995624">case</span>&nbsp;<span class="op" id="1995629">*</span><span class="ident" id="1995630">ast</span><span class="op" id="1995633">.</span><span class="ident" id="1995634">TypeSpec</span><span class="op" id="1995642">:</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995646">p</span><span class="op" id="1995647">.</span><span class="ident" id="1995648">setComment</span><span class="op" id="1995658">(</span><span class="ident" id="1995659">s</span><span class="op" id="1995660">.</span><span class="ident" id="1995661">Doc</span><span class="op" id="1995664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995668">p</span><span class="op" id="1995669">.</span><span class="ident" id="1995670">expr</span><span class="op" id="1995674">(</span><span class="ident" id="1995675">s</span><span class="op" id="1995676">.</span><span class="ident" id="1995677">Name</span><span class="op" id="1995681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995685">if</span>&nbsp;<span class="ident" id="1995688">n</span>&nbsp;<span class="op" id="1995690">==</span>&nbsp;<span class="num" id="1995693">1</span>&nbsp;<span class="op" id="1995695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995700">p</span><span class="op" id="1995701">.</span><span class="builtinfunc" id="1995702">print</span><span class="op" id="1995707">(</span><span class="ident" id="1995708">blank</span><span class="op" id="1995713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995717">}</span>&nbsp;<span class="keyword" id="1995719">else</span>&nbsp;<span class="op" id="1995724">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995729">p</span><span class="op" id="1995730">.</span><span class="builtinfunc" id="1995731">print</span><span class="op" id="1995736">(</span><span class="ident" id="1995737">vtab</span><span class="op" id="1995741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995749">p</span><span class="op" id="1995750">.</span><span class="ident" id="1995751">expr</span><span class="op" id="1995755">(</span><span class="ident" id="1995756">s</span><span class="op" id="1995757">.</span><span class="ident" id="1995758">Type</span><span class="op" id="1995762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995766">p</span><span class="op" id="1995767">.</span><span class="ident" id="1995768">setComment</span><span class="op" id="1995778">(</span><span class="ident" id="1995779">s</span><span class="op" id="1995780">.</span><span class="ident" id="1995781">Comment</span><span class="op" id="1995788">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995792">default</span><span class="op" id="1995799">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1995803">panic</span><span class="op" id="1995808">(</span><span class="string" id="1995809">&#34;unreachable&#34;</span><span class="op" id="1995822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995825">}</span><br>
<span class="lineno"></span><span class="op" id="1995827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1385</span><span class="keyword" id="1995830">func</span>&nbsp;<span class="op" id="1995835">(</span><span class="ident" id="1995836">p</span>&nbsp;<span class="op" id="1995838">*</span><span class="ident" id="1995839">printer</span><span class="op" id="1995846">)</span>&nbsp;<span class="ident" id="1995848">genDecl</span><span class="op" id="1995855">(</span><span class="ident" id="1995856">d</span>&nbsp;<span class="op" id="1995858">*</span><span class="ident" id="1995859">ast</span><span class="op" id="1995862">.</span><span class="ident" id="1995863">GenDecl</span><span class="op" id="1995870">)</span>&nbsp;<span class="op" id="1995872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995875">p</span><span class="op" id="1995876">.</span><span class="ident" id="1995877">setComment</span><span class="op" id="1995887">(</span><span class="ident" id="1995888">d</span><span class="op" id="1995889">.</span><span class="ident" id="1995890">Doc</span><span class="op" id="1995893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995896">p</span><span class="op" id="1995897">.</span><span class="builtinfunc" id="1995898">print</span><span class="op" id="1995903">(</span><span class="ident" id="1995904">d</span><span class="op" id="1995905">.</span><span class="ident" id="1995906">Pos</span><span class="op" id="1995909">(</span><span class="op" id="1995910">)</span><span class="op" id="1995911">,</span>&nbsp;<span class="ident" id="1995913">d</span><span class="op" id="1995914">.</span><span class="ident" id="1995915">Tok</span><span class="op" id="1995918">,</span>&nbsp;<span class="ident" id="1995920">blank</span><span class="op" id="1995925">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995929">if</span>&nbsp;<span class="ident" id="1995932">d</span><span class="op" id="1995933">.</span><span class="ident" id="1995934">Lparen</span><span class="op" id="1995940">.</span><span class="ident" id="1995941">IsValid</span><span class="op" id="1995948">(</span><span class="op" id="1995949">)</span>&nbsp;<span class="op" id="1995951">{</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1995955">//&nbsp;group&nbsp;of&nbsp;parenthesized&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995996">p</span><span class="op" id="1995997">.</span><span class="builtinfunc" id="1995998">print</span><span class="op" id="1996003">(</span><span class="ident" id="1996004">d</span><span class="op" id="1996005">.</span><span class="ident" id="1996006">Lparen</span><span class="op" id="1996012">,</span>&nbsp;<span class="ident" id="1996014">token</span><span class="op" id="1996019">.</span><span class="ident" id="1996020">LPAREN</span><span class="op" id="1996026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996030">if</span>&nbsp;<span class="ident" id="1996033">n</span>&nbsp;<span class="op" id="1996035">:=</span>&nbsp;<span class="builtinfunc" id="1996038">len</span><span class="op" id="1996041">(</span><span class="ident" id="1996042">d</span><span class="op" id="1996043">.</span><span class="ident" id="1996044">Specs</span><span class="op" id="1996049">)</span><span class="op" id="1996050">;</span>&nbsp;<span class="ident" id="1996052">n</span>&nbsp;<span class="op" id="1996054">&gt;</span>&nbsp;<span class="num" id="1996056">0</span>&nbsp;<span class="op" id="1996058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996063">p</span><span class="op" id="1996064">.</span><span class="builtinfunc" id="1996065">print</span><span class="op" id="1996070">(</span><span class="ident" id="1996071">indent</span><span class="op" id="1996077">,</span>&nbsp;<span class="ident" id="1996079">formfeed</span><span class="op" id="1996087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996092">if</span>&nbsp;<span class="ident" id="1996095">n</span>&nbsp;<span class="op" id="1996097">&gt;</span>&nbsp;<span class="num" id="1996099">1</span>&nbsp;<span class="op" id="1996101">&amp;&amp;</span>&nbsp;<span class="op" id="1996104">(</span><span class="ident" id="1996105">d</span><span class="op" id="1996106">.</span><span class="ident" id="1996107">Tok</span>&nbsp;<span class="op" id="1996111">==</span>&nbsp;<span class="ident" id="1996114">token</span><span class="op" id="1996119">.</span><span class="ident" id="1996120">CONST</span>&nbsp;<span class="op" id="1996126">||</span>&nbsp;<span class="ident" id="1996129">d</span><span class="op" id="1996130">.</span><span class="ident" id="1996131">Tok</span>&nbsp;<span class="op" id="1996135">==</span>&nbsp;<span class="ident" id="1996138">token</span><span class="op" id="1996143">.</span><span class="ident" id="1996144">VAR</span><span class="op" id="1996147">)</span>&nbsp;<span class="op" id="1996149">{</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1996155">//&nbsp;two&nbsp;or&nbsp;more&nbsp;grouped&nbsp;const/var&nbsp;declarations:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1996206">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996255">keepType</span>&nbsp;<span class="op" id="1996264">:=</span>&nbsp;<span class="ident" id="1996267">keepTypeColumn</span><span class="op" id="1996281">(</span><span class="ident" id="1996282">d</span><span class="op" id="1996283">.</span><span class="ident" id="1996284">Specs</span><span class="op" id="1996289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996295">var</span>&nbsp;<span class="ident" id="1996299">line</span>&nbsp;<span class="builtintype" id="1996304">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996312">for</span>&nbsp;<span class="ident" id="1996316">i</span><span class="op" id="1996317">,</span>&nbsp;<span class="ident" id="1996319">s</span>&nbsp;<span class="op" id="1996321">:=</span>&nbsp;<span class="keyword" id="1996324">range</span>&nbsp;<span class="ident" id="1996330">d</span><span class="op" id="1996331">.</span><span class="ident" id="1996332">Specs</span>&nbsp;<span class="op" id="1996338">{</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996345">if</span>&nbsp;<span class="ident" id="1996348">i</span>&nbsp;<span class="op" id="1996350">&gt;</span>&nbsp;<span class="num" id="1996352">0</span>&nbsp;<span class="op" id="1996354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996362">p</span><span class="op" id="1996363">.</span><span class="ident" id="1996364">linebreak</span><span class="op" id="1996373">(</span><span class="ident" id="1996374">p</span><span class="op" id="1996375">.</span><span class="ident" id="1996376">lineFor</span><span class="op" id="1996383">(</span><span class="ident" id="1996384">s</span><span class="op" id="1996385">.</span><span class="ident" id="1996386">Pos</span><span class="op" id="1996389">(</span><span class="op" id="1996390">)</span><span class="op" id="1996391">)</span><span class="op" id="1996392">,</span>&nbsp;<span class="num" id="1996394">1</span><span class="op" id="1996395">,</span>&nbsp;<span class="ident" id="1996397">ignore</span><span class="op" id="1996403">,</span>&nbsp;<span class="ident" id="1996405">p</span><span class="op" id="1996406">.</span><span class="ident" id="1996407">linesFrom</span><span class="op" id="1996416">(</span><span class="ident" id="1996417">line</span><span class="op" id="1996421">)</span>&nbsp;<span class="op" id="1996423">&gt;</span>&nbsp;<span class="num" id="1996425">0</span><span class="op" id="1996426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1996433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996440">p</span><span class="op" id="1996441">.</span><span class="ident" id="1996442">recordLine</span><span class="op" id="1996452">(</span><span class="op" id="1996453">&amp;</span><span class="ident" id="1996454">line</span><span class="op" id="1996458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996465">p</span><span class="op" id="1996466">.</span><span class="ident" id="1996467">valueSpec</span><span class="op" id="1996476">(</span><span class="ident" id="1996477">s</span><span class="op" id="1996478">.</span><span class="op" id="1996479">(</span><span class="op" id="1996480">*</span><span class="ident" id="1996481">ast</span><span class="op" id="1996484">.</span><span class="ident" id="1996485">ValueSpec</span><span class="op" id="1996494">)</span><span class="op" id="1996495">,</span>&nbsp;<span class="ident" id="1996497">keepType</span><span class="op" id="1996505">[</span><span class="ident" id="1996506">i</span><span class="op" id="1996507">]</span><span class="op" id="1996508">)</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1996514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1996519">}</span>&nbsp;<span class="keyword" id="1996521">else</span>&nbsp;<span class="op" id="1996526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996532">var</span>&nbsp;<span class="ident" id="1996536">line</span>&nbsp;<span class="builtintype" id="1996541">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996549">for</span>&nbsp;<span class="ident" id="1996553">i</span><span class="op" id="1996554">,</span>&nbsp;<span class="ident" id="1996556">s</span>&nbsp;<span class="op" id="1996558">:=</span>&nbsp;<span class="keyword" id="1996561">range</span>&nbsp;<span class="ident" id="1996567">d</span><span class="op" id="1996568">.</span><span class="ident" id="1996569">Specs</span>&nbsp;<span class="op" id="1996575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996582">if</span>&nbsp;<span class="ident" id="1996585">i</span>&nbsp;<span class="op" id="1996587">&gt;</span>&nbsp;<span class="num" id="1996589">0</span>&nbsp;<span class="op" id="1996591">{</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996599">p</span><span class="op" id="1996600">.</span><span class="ident" id="1996601">linebreak</span><span class="op" id="1996610">(</span><span class="ident" id="1996611">p</span><span class="op" id="1996612">.</span><span class="ident" id="1996613">lineFor</span><span class="op" id="1996620">(</span><span class="ident" id="1996621">s</span><span class="op" id="1996622">.</span><span class="ident" id="1996623">Pos</span><span class="op" id="1996626">(</span><span class="op" id="1996627">)</span><span class="op" id="1996628">)</span><span class="op" id="1996629">,</span>&nbsp;<span class="num" id="1996631">1</span><span class="op" id="1996632">,</span>&nbsp;<span class="ident" id="1996634">ignore</span><span class="op" id="1996640">,</span>&nbsp;<span class="ident" id="1996642">p</span><span class="op" id="1996643">.</span><span class="ident" id="1996644">linesFrom</span><span class="op" id="1996653">(</span><span class="ident" id="1996654">line</span><span class="op" id="1996658">)</span>&nbsp;<span class="op" id="1996660">&gt;</span>&nbsp;<span class="num" id="1996662">0</span><span class="op" id="1996663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1996670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996677">p</span><span class="op" id="1996678">.</span><span class="ident" id="1996679">recordLine</span><span class="op" id="1996689">(</span><span class="op" id="1996690">&amp;</span><span class="ident" id="1996691">line</span><span class="op" id="1996695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996702">p</span><span class="op" id="1996703">.</span><span class="ident" id="1996704">spec</span><span class="op" id="1996708">(</span><span class="ident" id="1996709">s</span><span class="op" id="1996710">,</span>&nbsp;<span class="ident" id="1996712">n</span><span class="op" id="1996713">,</span>&nbsp;<span class="builtintype" id="1996715">false</span><span class="op" id="1996720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1996726">}</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1996731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996736">p</span><span class="op" id="1996737">.</span><span class="builtinfunc" id="1996738">print</span><span class="op" id="1996743">(</span><span class="ident" id="1996744">unindent</span><span class="op" id="1996752">,</span>&nbsp;<span class="ident" id="1996754">formfeed</span><span class="op" id="1996762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1996766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996770">p</span><span class="op" id="1996771">.</span><span class="builtinfunc" id="1996772">print</span><span class="op" id="1996777">(</span><span class="ident" id="1996778">d</span><span class="op" id="1996779">.</span><span class="ident" id="1996780">Rparen</span><span class="op" id="1996786">,</span>&nbsp;<span class="ident" id="1996788">token</span><span class="op" id="1996793">.</span><span class="ident" id="1996794">RPAREN</span><span class="op" id="1996800">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1996804">}</span>&nbsp;<span class="keyword" id="1996806">else</span>&nbsp;<span class="op" id="1996811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1996815">//&nbsp;single&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996839">p</span><span class="op" id="1996840">.</span><span class="ident" id="1996841">spec</span><span class="op" id="1996845">(</span><span class="ident" id="1996846">d</span><span class="op" id="1996847">.</span><span class="ident" id="1996848">Specs</span><span class="op" id="1996853">[</span><span class="num" id="1996854">0</span><span class="op" id="1996855">]</span><span class="op" id="1996856">,</span>&nbsp;<span class="num" id="1996858">1</span><span class="op" id="1996859">,</span>&nbsp;<span class="builtintype" id="1996861">true</span><span class="op" id="1996865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1996868">}</span><br>
<span class="lineno"></span><span class="op" id="1996870">}</span><br>
<span class="lineno">1425</span><br>
<span class="lineno"></span><span class="comment" id="1996873">//&nbsp;nodeSize&nbsp;determines&nbsp;the&nbsp;size&nbsp;of&nbsp;n&nbsp;in&nbsp;chars&nbsp;after&nbsp;formatting.</span><br>
<span class="lineno"></span><span class="comment" id="1996937">//&nbsp;The&nbsp;result&nbsp;is&nbsp;&lt;=&nbsp;maxSize&nbsp;if&nbsp;the&nbsp;node&nbsp;fits&nbsp;on&nbsp;one&nbsp;line&nbsp;with&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="1997002">//&nbsp;most&nbsp;maxSize&nbsp;chars&nbsp;and&nbsp;the&nbsp;formatted&nbsp;output&nbsp;doesn&#39;t&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="1997065">//&nbsp;any&nbsp;control&nbsp;chars.&nbsp;Otherwise,&nbsp;the&nbsp;result&nbsp;is&nbsp;&gt;&nbsp;maxSize.</span><br>
<span class="lineno">1430</span><span class="comment" id="1997123">//</span><br>
<span class="lineno"></span><span class="keyword" id="1997126">func</span>&nbsp;<span class="op" id="1997131">(</span><span class="ident" id="1997132">p</span>&nbsp;<span class="op" id="1997134">*</span><span class="ident" id="1997135">printer</span><span class="op" id="1997142">)</span>&nbsp;<span class="ident" id="1997144">nodeSize</span><span class="op" id="1997152">(</span><span class="ident" id="1997153">n</span>&nbsp;<span class="ident" id="1997155">ast</span><span class="op" id="1997158">.</span><span class="ident" id="1997159">Node</span><span class="op" id="1997163">,</span>&nbsp;<span class="ident" id="1997165">maxSize</span>&nbsp;<span class="builtintype" id="1997173">int</span><span class="op" id="1997176">)</span>&nbsp;<span class="op" id="1997178">(</span><span class="ident" id="1997179">size</span>&nbsp;<span class="builtintype" id="1997184">int</span><span class="op" id="1997187">)</span>&nbsp;<span class="op" id="1997189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997192">//&nbsp;nodeSize&nbsp;invokes&nbsp;the&nbsp;printer,&nbsp;which&nbsp;may&nbsp;invoke&nbsp;nodeSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997252">//&nbsp;recursively.&nbsp;For&nbsp;deep&nbsp;composite&nbsp;literal&nbsp;nests,&nbsp;this&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997312">//&nbsp;lead&nbsp;to&nbsp;an&nbsp;exponential&nbsp;algorithm.&nbsp;Remember&nbsp;previous</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997368">//&nbsp;results&nbsp;to&nbsp;prune&nbsp;the&nbsp;recursion&nbsp;(was&nbsp;issue&nbsp;1628).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997421">if</span>&nbsp;<span class="ident" id="1997424">size</span><span class="op" id="1997428">,</span>&nbsp;<span class="ident" id="1997430">found</span>&nbsp;<span class="op" id="1997436">:=</span>&nbsp;<span class="ident" id="1997439">p</span><span class="op" id="1997440">.</span><span class="ident" id="1997441">nodeSizes</span><span class="op" id="1997450">[</span><span class="ident" id="1997451">n</span><span class="op" id="1997452">]</span><span class="op" id="1997453">;</span>&nbsp;<span class="ident" id="1997455">found</span>&nbsp;<span class="op" id="1997461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997465">return</span>&nbsp;<span class="ident" id="1997472">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1997478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997482">size</span>&nbsp;<span class="op" id="1997487">=</span>&nbsp;<span class="ident" id="1997489">maxSize</span>&nbsp;<span class="op" id="1997497">+</span>&nbsp;<span class="num" id="1997499">1</span>&nbsp;<span class="comment" id="1997501">//&nbsp;assume&nbsp;n&nbsp;doesn&#39;t&nbsp;fit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997526">p</span><span class="op" id="1997527">.</span><span class="ident" id="1997528">nodeSizes</span><span class="op" id="1997537">[</span><span class="ident" id="1997538">n</span><span class="op" id="1997539">]</span>&nbsp;<span class="op" id="1997541">=</span>&nbsp;<span class="ident" id="1997543">size</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997550">//&nbsp;nodeSize&nbsp;computation&nbsp;must&nbsp;be&nbsp;independent&nbsp;of&nbsp;particular</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997609">//&nbsp;style&nbsp;so&nbsp;that&nbsp;we&nbsp;always&nbsp;get&nbsp;the&nbsp;same&nbsp;decision;&nbsp;print</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1997666">//&nbsp;in&nbsp;RawFormat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997683">cfg</span>&nbsp;<span class="op" id="1997687">:=</span>&nbsp;<span class="ident" id="1997690">Config</span><span class="op" id="1997696">{</span><span class="ident" id="1997697">Mode</span><span class="op" id="1997701">:</span>&nbsp;<span class="ident" id="1997703">RawFormat</span><span class="op" id="1997712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997715">var</span>&nbsp;<span class="ident" id="1997719">buf</span>&nbsp;<span class="ident" id="1997723">bytes</span><span class="op" id="1997728">.</span><span class="ident" id="1997729">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997737">if</span>&nbsp;<span class="ident" id="1997740">err</span>&nbsp;<span class="op" id="1997744">:=</span>&nbsp;<span class="ident" id="1997747">cfg</span><span class="op" id="1997750">.</span><span class="ident" id="1997751">fprint</span><span class="op" id="1997757">(</span><span class="op" id="1997758">&amp;</span><span class="ident" id="1997759">buf</span><span class="op" id="1997762">,</span>&nbsp;<span class="ident" id="1997764">p</span><span class="op" id="1997765">.</span><span class="ident" id="1997766">fset</span><span class="op" id="1997770">,</span>&nbsp;<span class="ident" id="1997772">n</span><span class="op" id="1997773">,</span>&nbsp;<span class="ident" id="1997775">p</span><span class="op" id="1997776">.</span><span class="ident" id="1997777">nodeSizes</span><span class="op" id="1997786">)</span><span class="op" id="1997787">;</span>&nbsp;<span class="ident" id="1997789">err</span>&nbsp;<span class="op" id="1997793">!=</span>&nbsp;<span class="ident" id="1997796">nil</span>&nbsp;<span class="op" id="1997800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997804">return</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1997812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997815">if</span>&nbsp;<span class="ident" id="1997818">buf</span><span class="op" id="1997821">.</span><span class="ident" id="1997822">Len</span><span class="op" id="1997825">(</span><span class="op" id="1997826">)</span>&nbsp;<span class="op" id="1997828">&lt;=</span>&nbsp;<span class="ident" id="1997831">maxSize</span>&nbsp;<span class="op" id="1997839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997843">for</span>&nbsp;<span class="ident" id="1997847">_</span><span class="op" id="1997848">,</span>&nbsp;<span class="ident" id="1997850">ch</span>&nbsp;<span class="op" id="1997853">:=</span>&nbsp;<span class="keyword" id="1997856">range</span>&nbsp;<span class="ident" id="1997862">buf</span><span class="op" id="1997865">.</span><span class="ident" id="1997866">Bytes</span><span class="op" id="1997871">(</span><span class="op" id="1997872">)</span>&nbsp;<span class="op" id="1997874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997879">if</span>&nbsp;<span class="ident" id="1997882">ch</span>&nbsp;<span class="op" id="1997885">&lt;</span>&nbsp;<span class="string" id="1997887">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="1997891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997897">return</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1997907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1997911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997915">size</span>&nbsp;<span class="op" id="1997920">=</span>&nbsp;<span class="ident" id="1997922">buf</span><span class="op" id="1997925">.</span><span class="ident" id="1997926">Len</span><span class="op" id="1997929">(</span><span class="op" id="1997930">)</span>&nbsp;<span class="comment" id="1997932">//&nbsp;n&nbsp;fits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1997944">p</span><span class="op" id="1997945">.</span><span class="ident" id="1997946">nodeSizes</span><span class="op" id="1997955">[</span><span class="ident" id="1997956">n</span><span class="op" id="1997957">]</span>&nbsp;<span class="op" id="1997959">=</span>&nbsp;<span class="ident" id="1997961">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1997967">}</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1997970">return</span><br>
<span class="lineno"></span><span class="op" id="1997977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1997980">//&nbsp;bodySize&nbsp;is&nbsp;like&nbsp;nodeSize&nbsp;but&nbsp;it&nbsp;is&nbsp;specialized&nbsp;for&nbsp;*ast.BlockStmt&#39;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1998053">func</span>&nbsp;<span class="op" id="1998058">(</span><span class="ident" id="1998059">p</span>&nbsp;<span class="op" id="1998061">*</span><span class="ident" id="1998062">printer</span><span class="op" id="1998069">)</span>&nbsp;<span class="ident" id="1998071">bodySize</span><span class="op" id="1998079">(</span><span class="ident" id="1998080">b</span>&nbsp;<span class="op" id="1998082">*</span><span class="ident" id="1998083">ast</span><span class="op" id="1998086">.</span><span class="ident" id="1998087">BlockStmt</span><span class="op" id="1998096">,</span>&nbsp;<span class="ident" id="1998098">maxSize</span>&nbsp;<span class="builtintype" id="1998106">int</span><span class="op" id="1998109">)</span>&nbsp;<span class="builtintype" id="1998111">int</span>&nbsp;<span class="op" id="1998115">{</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998118">pos1</span>&nbsp;<span class="op" id="1998123">:=</span>&nbsp;<span class="ident" id="1998126">b</span><span class="op" id="1998127">.</span><span class="ident" id="1998128">Pos</span><span class="op" id="1998131">(</span><span class="op" id="1998132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998135">pos2</span>&nbsp;<span class="op" id="1998140">:=</span>&nbsp;<span class="ident" id="1998143">b</span><span class="op" id="1998144">.</span><span class="ident" id="1998145">Rbrace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998153">if</span>&nbsp;<span class="ident" id="1998156">pos1</span><span class="op" id="1998160">.</span><span class="ident" id="1998161">IsValid</span><span class="op" id="1998168">(</span><span class="op" id="1998169">)</span>&nbsp;<span class="op" id="1998171">&amp;&amp;</span>&nbsp;<span class="ident" id="1998174">pos2</span><span class="op" id="1998178">.</span><span class="ident" id="1998179">IsValid</span><span class="op" id="1998186">(</span><span class="op" id="1998187">)</span>&nbsp;<span class="op" id="1998189">&amp;&amp;</span>&nbsp;<span class="ident" id="1998192">p</span><span class="op" id="1998193">.</span><span class="ident" id="1998194">lineFor</span><span class="op" id="1998201">(</span><span class="ident" id="1998202">pos1</span><span class="op" id="1998206">)</span>&nbsp;<span class="op" id="1998208">!=</span>&nbsp;<span class="ident" id="1998211">p</span><span class="op" id="1998212">.</span><span class="ident" id="1998213">lineFor</span><span class="op" id="1998220">(</span><span class="ident" id="1998221">pos2</span><span class="op" id="1998225">)</span>&nbsp;<span class="op" id="1998227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998231">//&nbsp;opening&nbsp;and&nbsp;closing&nbsp;brace&nbsp;are&nbsp;on&nbsp;different&nbsp;lines&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998313">return</span>&nbsp;<span class="ident" id="1998320">maxSize</span>&nbsp;<span class="op" id="1998328">+</span>&nbsp;<span class="num" id="1998330">1</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1998333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998336">if</span>&nbsp;<span class="builtinfunc" id="1998339">len</span><span class="op" id="1998342">(</span><span class="ident" id="1998343">b</span><span class="op" id="1998344">.</span><span class="ident" id="1998345">List</span><span class="op" id="1998349">)</span>&nbsp;<span class="op" id="1998351">&gt;</span>&nbsp;<span class="num" id="1998353">5</span>&nbsp;<span class="op" id="1998355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998359">//&nbsp;too&nbsp;many&nbsp;statements&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998412">return</span>&nbsp;<span class="ident" id="1998419">maxSize</span>&nbsp;<span class="op" id="1998427">+</span>&nbsp;<span class="num" id="1998429">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1998432">}</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1998435">//&nbsp;otherwise,&nbsp;estimate&nbsp;body&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998469">bodySize</span>&nbsp;<span class="op" id="1998478">:=</span>&nbsp;<span class="ident" id="1998481">p</span><span class="op" id="1998482">.</span><span class="ident" id="1998483">commentSizeBefore</span><span class="op" id="1998500">(</span><span class="ident" id="1998501">p</span><span class="op" id="1998502">.</span><span class="ident" id="1998503">posFor</span><span class="op" id="1998509">(</span><span class="ident" id="1998510">pos2</span><span class="op" id="1998514">)</span><span class="op" id="1998515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998518">for</span>&nbsp;<span class="ident" id="1998522">i</span><span class="op" id="1998523">,</span>&nbsp;<span class="ident" id="1998525">s</span>&nbsp;<span class="op" id="1998527">:=</span>&nbsp;<span class="keyword" id="1998530">range</span>&nbsp;<span class="ident" id="1998536">b</span><span class="op" id="1998537">.</span><span class="ident" id="1998538">List</span>&nbsp;<span class="op" id="1998543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998547">if</span>&nbsp;<span class="ident" id="1998550">bodySize</span>&nbsp;<span class="op" id="1998559">&gt;</span>&nbsp;<span class="ident" id="1998561">maxSize</span>&nbsp;<span class="op" id="1998569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998574">break</span>&nbsp;<span class="comment" id="1998580">//&nbsp;no&nbsp;need&nbsp;to&nbsp;continue</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1998605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998609">if</span>&nbsp;<span class="ident" id="1998612">i</span>&nbsp;<span class="op" id="1998614">&gt;</span>&nbsp;<span class="num" id="1998616">0</span>&nbsp;<span class="op" id="1998618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998623">bodySize</span>&nbsp;<span class="op" id="1998632">+=</span>&nbsp;<span class="num" id="1998635">2</span>&nbsp;<span class="comment" id="1998637">//&nbsp;space&nbsp;for&nbsp;a&nbsp;semicolon&nbsp;and&nbsp;blank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1998674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1998678">bodySize</span>&nbsp;<span class="op" id="1998687">+=</span>&nbsp;<span class="ident" id="1998690">p</span><span class="op" id="1998691">.</span><span class="ident" id="1998692">nodeSize</span><span class="op" id="1998700">(</span><span class="ident" id="1998701">s</span><span class="op" id="1998702">,</span>&nbsp;<span class="ident" id="1998704">maxSize</span><span class="op" id="1998711">)</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1998714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1998717">return</span>&nbsp;<span class="ident" id="1998724">bodySize</span><br>
<span class="lineno"></span><span class="op" id="1998733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1998736">//&nbsp;adjBlock&nbsp;prints&nbsp;an&nbsp;&#34;adjacent&#34;&nbsp;block&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;or&nbsp;function&nbsp;body)&nbsp;following</span><br>
<span class="lineno">1490</span><span class="comment" id="1998821">//&nbsp;a&nbsp;header&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;control&nbsp;clause&nbsp;or&nbsp;function&nbsp;signature)&nbsp;of&nbsp;given&nbsp;headerSize.</span><br>
<span class="lineno"></span><span class="comment" id="1998910">//&nbsp;If&nbsp;the&nbsp;header&#39;s&nbsp;and&nbsp;block&#39;s&nbsp;size&nbsp;are&nbsp;&#34;small&nbsp;enough&#34;&nbsp;and&nbsp;the&nbsp;block&nbsp;is&nbsp;&#34;simple&nbsp;enough&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="1998999">//&nbsp;the&nbsp;block&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;without&nbsp;line&nbsp;breaks,&nbsp;spaced&nbsp;from&nbsp;the&nbsp;header</span><br>
<span class="lineno"></span><span class="comment" id="1999088">//&nbsp;by&nbsp;sep.&nbsp;Otherwise&nbsp;the&nbsp;block&#39;s&nbsp;opening&nbsp;&#34;{&#34;&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;followed&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1999177">//&nbsp;lines&nbsp;for&nbsp;the&nbsp;block&#39;s&nbsp;statements&nbsp;and&nbsp;its&nbsp;closing&nbsp;&#34;}&#34;.</span><br>
<span class="lineno">1495</span><span class="comment" id="1999234">//</span><br>
<span class="lineno"></span><span class="keyword" id="1999237">func</span>&nbsp;<span class="op" id="1999242">(</span><span class="ident" id="1999243">p</span>&nbsp;<span class="op" id="1999245">*</span><span class="ident" id="1999246">printer</span><span class="op" id="1999253">)</span>&nbsp;<span class="ident" id="1999255">adjBlock</span><span class="op" id="1999263">(</span><span class="ident" id="1999264">headerSize</span>&nbsp;<span class="builtintype" id="1999275">int</span><span class="op" id="1999278">,</span>&nbsp;<span class="ident" id="1999280">sep</span>&nbsp;<span class="ident" id="1999284">whiteSpace</span><span class="op" id="1999294">,</span>&nbsp;<span class="ident" id="1999296">b</span>&nbsp;<span class="op" id="1999298">*</span><span class="ident" id="1999299">ast</span><span class="op" id="1999302">.</span><span class="ident" id="1999303">BlockStmt</span><span class="op" id="1999312">)</span>&nbsp;<span class="op" id="1999314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999317">if</span>&nbsp;<span class="ident" id="1999320">b</span>&nbsp;<span class="op" id="1999322">==</span>&nbsp;<span class="ident" id="1999325">nil</span>&nbsp;<span class="op" id="1999329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999333">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999341">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999345">const</span>&nbsp;<span class="ident" id="1999351">maxSize</span>&nbsp;<span class="op" id="1999359">=</span>&nbsp;<span class="num" id="1999361">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999366">if</span>&nbsp;<span class="ident" id="1999369">headerSize</span><span class="op" id="1999379">+</span><span class="ident" id="1999380">p</span><span class="op" id="1999381">.</span><span class="ident" id="1999382">bodySize</span><span class="op" id="1999390">(</span><span class="ident" id="1999391">b</span><span class="op" id="1999392">,</span>&nbsp;<span class="ident" id="1999394">maxSize</span><span class="op" id="1999401">)</span>&nbsp;<span class="op" id="1999403">&lt;=</span>&nbsp;<span class="ident" id="1999406">maxSize</span>&nbsp;<span class="op" id="1999414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999418">p</span><span class="op" id="1999419">.</span><span class="builtinfunc" id="1999420">print</span><span class="op" id="1999425">(</span><span class="ident" id="1999426">sep</span><span class="op" id="1999429">,</span>&nbsp;<span class="ident" id="1999431">b</span><span class="op" id="1999432">.</span><span class="ident" id="1999433">Lbrace</span><span class="op" id="1999439">,</span>&nbsp;<span class="ident" id="1999441">token</span><span class="op" id="1999446">.</span><span class="ident" id="1999447">LBRACE</span><span class="op" id="1999453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999457">if</span>&nbsp;<span class="builtinfunc" id="1999460">len</span><span class="op" id="1999463">(</span><span class="ident" id="1999464">b</span><span class="op" id="1999465">.</span><span class="ident" id="1999466">List</span><span class="op" id="1999470">)</span>&nbsp;<span class="op" id="1999472">&gt;</span>&nbsp;<span class="num" id="1999474">0</span>&nbsp;<span class="op" id="1999476">{</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999481">p</span><span class="op" id="1999482">.</span><span class="builtinfunc" id="1999483">print</span><span class="op" id="1999488">(</span><span class="ident" id="1999489">blank</span><span class="op" id="1999494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999499">for</span>&nbsp;<span class="ident" id="1999503">i</span><span class="op" id="1999504">,</span>&nbsp;<span class="ident" id="1999506">s</span>&nbsp;<span class="op" id="1999508">:=</span>&nbsp;<span class="keyword" id="1999511">range</span>&nbsp;<span class="ident" id="1999517">b</span><span class="op" id="1999518">.</span><span class="ident" id="1999519">List</span>&nbsp;<span class="op" id="1999524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999530">if</span>&nbsp;<span class="ident" id="1999533">i</span>&nbsp;<span class="op" id="1999535">&gt;</span>&nbsp;<span class="num" id="1999537">0</span>&nbsp;<span class="op" id="1999539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999546">p</span><span class="op" id="1999547">.</span><span class="builtinfunc" id="1999548">print</span><span class="op" id="1999553">(</span><span class="ident" id="1999554">token</span><span class="op" id="1999559">.</span><span class="ident" id="1999560">SEMICOLON</span><span class="op" id="1999569">,</span>&nbsp;<span class="ident" id="1999571">blank</span><span class="op" id="1999576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999582">}</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999588">p</span><span class="op" id="1999589">.</span><span class="ident" id="1999590">stmt</span><span class="op" id="1999594">(</span><span class="ident" id="1999595">s</span><span class="op" id="1999596">,</span>&nbsp;<span class="ident" id="1999598">i</span>&nbsp;<span class="op" id="1999600">==</span>&nbsp;<span class="builtinfunc" id="1999603">len</span><span class="op" id="1999606">(</span><span class="ident" id="1999607">b</span><span class="op" id="1999608">.</span><span class="ident" id="1999609">List</span><span class="op" id="1999613">)</span><span class="op" id="1999614">-</span><span class="num" id="1999615">1</span><span class="op" id="1999616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999626">p</span><span class="op" id="1999627">.</span><span class="builtinfunc" id="1999628">print</span><span class="op" id="1999633">(</span><span class="ident" id="1999634">blank</span><span class="op" id="1999639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999647">p</span><span class="op" id="1999648">.</span><span class="builtinfunc" id="1999649">print</span><span class="op" id="1999654">(</span><span class="ident" id="1999655">noExtraLinebreak</span><span class="op" id="1999671">,</span>&nbsp;<span class="ident" id="1999673">b</span><span class="op" id="1999674">.</span><span class="ident" id="1999675">Rbrace</span><span class="op" id="1999681">,</span>&nbsp;<span class="ident" id="1999683">token</span><span class="op" id="1999688">.</span><span class="ident" id="1999689">RBRACE</span><span class="op" id="1999695">,</span>&nbsp;<span class="ident" id="1999697">noExtraLinebreak</span><span class="op" id="1999713">)</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999717">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1999729">if</span>&nbsp;<span class="ident" id="1999732">sep</span>&nbsp;<span class="op" id="1999736">!=</span>&nbsp;<span class="ident" id="1999739">ignore</span>&nbsp;<span class="op" id="1999746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999750">p</span><span class="op" id="1999751">.</span><span class="builtinfunc" id="1999752">print</span><span class="op" id="1999757">(</span><span class="ident" id="1999758">blank</span><span class="op" id="1999763">)</span>&nbsp;<span class="comment" id="1999765">//&nbsp;always&nbsp;use&nbsp;blank</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1999786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1999789">p</span><span class="op" id="1999790">.</span><span class="ident" id="1999791">block</span><span class="op" id="1999796">(</span><span class="ident" id="1999797">b</span><span class="op" id="1999798">,</span>&nbsp;<span class="num" id="1999800">1</span><span class="op" id="1999801">)</span><br>
<span class="lineno"></span><span class="op" id="1999803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1999806">//&nbsp;distanceFrom&nbsp;returns&nbsp;the&nbsp;column&nbsp;difference&nbsp;between&nbsp;from&nbsp;and&nbsp;p.pos&nbsp;(the&nbsp;current</span><br>
<span class="lineno">1525</span><span class="comment" id="1999888">//&nbsp;estimated&nbsp;position)&nbsp;if&nbsp;both&nbsp;are&nbsp;on&nbsp;the&nbsp;same&nbsp;line;&nbsp;if&nbsp;they&nbsp;are&nbsp;on&nbsp;different&nbsp;lines</span><br>
<span class="lineno"></span><span class="comment" id="1999972">//&nbsp;(or&nbsp;unknown)&nbsp;the&nbsp;result&nbsp;is&nbsp;infinity.</span><br>
<span class="lineno"></span><span class="keyword" id="2000012">func</span>&nbsp;<span class="op" id="2000017">(</span><span class="ident" id="2000018">p</span>&nbsp;<span class="op" id="2000020">*</span><span class="ident" id="2000021">printer</span><span class="op" id="2000028">)</span>&nbsp;<span class="ident" id="2000030">distanceFrom</span><span class="op" id="2000042">(</span><span class="ident" id="2000043">from</span>&nbsp;<span class="ident" id="2000048">token</span><span class="op" id="2000053">.</span><span class="ident" id="2000054">Pos</span><span class="op" id="2000057">)</span>&nbsp;<span class="builtintype" id="2000059">int</span>&nbsp;<span class="op" id="2000063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000066">if</span>&nbsp;<span class="ident" id="2000069">from</span><span class="op" id="2000073">.</span><span class="ident" id="2000074">IsValid</span><span class="op" id="2000081">(</span><span class="op" id="2000082">)</span>&nbsp;<span class="op" id="2000084">&amp;&amp;</span>&nbsp;<span class="ident" id="2000087">p</span><span class="op" id="2000088">.</span><span class="ident" id="2000089">pos</span><span class="op" id="2000092">.</span><span class="ident" id="2000093">IsValid</span><span class="op" id="2000100">(</span><span class="op" id="2000101">)</span>&nbsp;<span class="op" id="2000103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000107">if</span>&nbsp;<span class="ident" id="2000110">f</span>&nbsp;<span class="op" id="2000112">:=</span>&nbsp;<span class="ident" id="2000115">p</span><span class="op" id="2000116">.</span><span class="ident" id="2000117">posFor</span><span class="op" id="2000123">(</span><span class="ident" id="2000124">from</span><span class="op" id="2000128">)</span><span class="op" id="2000129">;</span>&nbsp;<span class="ident" id="2000131">f</span><span class="op" id="2000132">.</span><span class="ident" id="2000133">Line</span>&nbsp;<span class="op" id="2000138">==</span>&nbsp;<span class="ident" id="2000141">p</span><span class="op" id="2000142">.</span><span class="ident" id="2000143">pos</span><span class="op" id="2000146">.</span><span class="ident" id="2000147">Line</span>&nbsp;<span class="op" id="2000152">{</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000157">return</span>&nbsp;<span class="ident" id="2000164">p</span><span class="op" id="2000165">.</span><span class="ident" id="2000166">pos</span><span class="op" id="2000169">.</span><span class="ident" id="2000170">Column</span>&nbsp;<span class="op" id="2000177">-</span>&nbsp;<span class="ident" id="2000179">f</span><span class="op" id="2000180">.</span><span class="ident" id="2000181">Column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2000190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2000193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000196">return</span>&nbsp;<span class="ident" id="2000203">infinity</span><br>
<span class="lineno"></span><span class="op" id="2000212">}</span><br>
<span class="lineno">1535</span><br>
<span class="lineno"></span><span class="keyword" id="2000215">func</span>&nbsp;<span class="op" id="2000220">(</span><span class="ident" id="2000221">p</span>&nbsp;<span class="op" id="2000223">*</span><span class="ident" id="2000224">printer</span><span class="op" id="2000231">)</span>&nbsp;<span class="ident" id="2000233">funcDecl</span><span class="op" id="2000241">(</span><span class="ident" id="2000242">d</span>&nbsp;<span class="op" id="2000244">*</span><span class="ident" id="2000245">ast</span><span class="op" id="2000248">.</span><span class="ident" id="2000249">FuncDecl</span><span class="op" id="2000257">)</span>&nbsp;<span class="op" id="2000259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000262">p</span><span class="op" id="2000263">.</span><span class="ident" id="2000264">setComment</span><span class="op" id="2000274">(</span><span class="ident" id="2000275">d</span><span class="op" id="2000276">.</span><span class="ident" id="2000277">Doc</span><span class="op" id="2000280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000283">p</span><span class="op" id="2000284">.</span><span class="builtinfunc" id="2000285">print</span><span class="op" id="2000290">(</span><span class="ident" id="2000291">d</span><span class="op" id="2000292">.</span><span class="ident" id="2000293">Pos</span><span class="op" id="2000296">(</span><span class="op" id="2000297">)</span><span class="op" id="2000298">,</span>&nbsp;<span class="ident" id="2000300">token</span><span class="op" id="2000305">.</span><span class="ident" id="2000306">FUNC</span><span class="op" id="2000310">,</span>&nbsp;<span class="ident" id="2000312">blank</span><span class="op" id="2000317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000320">if</span>&nbsp;<span class="ident" id="2000323">d</span><span class="op" id="2000324">.</span><span class="ident" id="2000325">Recv</span>&nbsp;<span class="op" id="2000330">!=</span>&nbsp;<span class="ident" id="2000333">nil</span>&nbsp;<span class="op" id="2000337">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000341">p</span><span class="op" id="2000342">.</span><span class="ident" id="2000343">parameters</span><span class="op" id="2000353">(</span><span class="ident" id="2000354">d</span><span class="op" id="2000355">.</span><span class="ident" id="2000356">Recv</span><span class="op" id="2000360">)</span>&nbsp;<span class="comment" id="2000362">//&nbsp;method:&nbsp;print&nbsp;receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000390">p</span><span class="op" id="2000391">.</span><span class="builtinfunc" id="2000392">print</span><span class="op" id="2000397">(</span><span class="ident" id="2000398">blank</span><span class="op" id="2000403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2000406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000409">p</span><span class="op" id="2000410">.</span><span class="ident" id="2000411">expr</span><span class="op" id="2000415">(</span><span class="ident" id="2000416">d</span><span class="op" id="2000417">.</span><span class="ident" id="2000418">Name</span><span class="op" id="2000422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000425">p</span><span class="op" id="2000426">.</span><span class="ident" id="2000427">signature</span><span class="op" id="2000436">(</span><span class="ident" id="2000437">d</span><span class="op" id="2000438">.</span><span class="ident" id="2000439">Type</span><span class="op" id="2000443">.</span><span class="ident" id="2000444">Params</span><span class="op" id="2000450">,</span>&nbsp;<span class="ident" id="2000452">d</span><span class="op" id="2000453">.</span><span class="ident" id="2000454">Type</span><span class="op" id="2000458">.</span><span class="ident" id="2000459">Results</span><span class="op" id="2000466">)</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000469">p</span><span class="op" id="2000470">.</span><span class="ident" id="2000471">adjBlock</span><span class="op" id="2000479">(</span><span class="ident" id="2000480">p</span><span class="op" id="2000481">.</span><span class="ident" id="2000482">distanceFrom</span><span class="op" id="2000494">(</span><span class="ident" id="2000495">d</span><span class="op" id="2000496">.</span><span class="ident" id="2000497">Pos</span><span class="op" id="2000500">(</span><span class="op" id="2000501">)</span><span class="op" id="2000502">)</span><span class="op" id="2000503">,</span>&nbsp;<span class="ident" id="2000505">vtab</span><span class="op" id="2000509">,</span>&nbsp;<span class="ident" id="2000511">d</span><span class="op" id="2000512">.</span><span class="ident" id="2000513">Body</span><span class="op" id="2000517">)</span><br>
<span class="lineno"></span><span class="op" id="2000519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2000522">func</span>&nbsp;<span class="op" id="2000527">(</span><span class="ident" id="2000528">p</span>&nbsp;<span class="op" id="2000530">*</span><span class="ident" id="2000531">printer</span><span class="op" id="2000538">)</span>&nbsp;<span class="ident" id="2000540">decl</span><span class="op" id="2000544">(</span><span class="ident" id="2000545">decl</span>&nbsp;<span class="ident" id="2000550">ast</span><span class="op" id="2000553">.</span><span class="ident" id="2000554">Decl</span><span class="op" id="2000558">)</span>&nbsp;<span class="op" id="2000560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000563">switch</span>&nbsp;<span class="ident" id="2000570">d</span>&nbsp;<span class="op" id="2000572">:=</span>&nbsp;<span class="ident" id="2000575">decl</span><span class="op" id="2000579">.</span><span class="op" id="2000580">(</span><span class="keyword" id="2000581">type</span><span class="op" id="2000585">)</span>&nbsp;<span class="op" id="2000587">{</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000590">case</span>&nbsp;<span class="op" id="2000595">*</span><span class="ident" id="2000596">ast</span><span class="op" id="2000599">.</span><span class="ident" id="2000600">BadDecl</span><span class="op" id="2000607">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000611">p</span><span class="op" id="2000612">.</span><span class="builtinfunc" id="2000613">print</span><span class="op" id="2000618">(</span><span class="ident" id="2000619">d</span><span class="op" id="2000620">.</span><span class="ident" id="2000621">Pos</span><span class="op" id="2000624">(</span><span class="op" id="2000625">)</span><span class="op" id="2000626">,</span>&nbsp;<span class="string" id="2000628">&#34;BadDecl&#34;</span><span class="op" id="2000637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000640">case</span>&nbsp;<span class="op" id="2000645">*</span><span class="ident" id="2000646">ast</span><span class="op" id="2000649">.</span><span class="ident" id="2000650">GenDecl</span><span class="op" id="2000657">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000661">p</span><span class="op" id="2000662">.</span><span class="ident" id="2000663">genDecl</span><span class="op" id="2000670">(</span><span class="ident" id="2000671">d</span><span class="op" id="2000672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000675">case</span>&nbsp;<span class="op" id="2000680">*</span><span class="ident" id="2000681">ast</span><span class="op" id="2000684">.</span><span class="ident" id="2000685">FuncDecl</span><span class="op" id="2000693">:</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000697">p</span><span class="op" id="2000698">.</span><span class="ident" id="2000699">funcDecl</span><span class="op" id="2000707">(</span><span class="ident" id="2000708">d</span><span class="op" id="2000709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000712">default</span><span class="op" id="2000719">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2000723">panic</span><span class="op" id="2000728">(</span><span class="string" id="2000729">&#34;unreachable&#34;</span><span class="op" id="2000742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2000745">}</span><br>
<span class="lineno"></span><span class="op" id="2000747">}</span><br>
<span class="lineno">1560</span><br>
<span class="lineno"></span><span class="comment" id="2000750">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="2000830">//&nbsp;Files</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2000840">func</span>&nbsp;<span class="ident" id="2000845">declToken</span><span class="op" id="2000854">(</span><span class="ident" id="2000855">decl</span>&nbsp;<span class="ident" id="2000860">ast</span><span class="op" id="2000863">.</span><span class="ident" id="2000864">Decl</span><span class="op" id="2000868">)</span>&nbsp;<span class="op" id="2000870">(</span><span class="ident" id="2000871">tok</span>&nbsp;<span class="ident" id="2000875">token</span><span class="op" id="2000880">.</span><span class="ident" id="2000881">Token</span><span class="op" id="2000886">)</span>&nbsp;<span class="op" id="2000888">{</span><br>
<span class="lineno">1565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000891">tok</span>&nbsp;<span class="op" id="2000895">=</span>&nbsp;<span class="ident" id="2000897">token</span><span class="op" id="2000902">.</span><span class="ident" id="2000903">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000912">switch</span>&nbsp;<span class="ident" id="2000919">d</span>&nbsp;<span class="op" id="2000921">:=</span>&nbsp;<span class="ident" id="2000924">decl</span><span class="op" id="2000928">.</span><span class="op" id="2000929">(</span><span class="keyword" id="2000930">type</span><span class="op" id="2000934">)</span>&nbsp;<span class="op" id="2000936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000939">case</span>&nbsp;<span class="op" id="2000944">*</span><span class="ident" id="2000945">ast</span><span class="op" id="2000948">.</span><span class="ident" id="2000949">GenDecl</span><span class="op" id="2000956">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000960">tok</span>&nbsp;<span class="op" id="2000964">=</span>&nbsp;<span class="ident" id="2000966">d</span><span class="op" id="2000967">.</span><span class="ident" id="2000968">Tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2000973">case</span>&nbsp;<span class="op" id="2000978">*</span><span class="ident" id="2000979">ast</span><span class="op" id="2000982">.</span><span class="ident" id="2000983">FuncDecl</span><span class="op" id="2000991">:</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2000995">tok</span>&nbsp;<span class="op" id="2000999">=</span>&nbsp;<span class="ident" id="2001001">token</span><span class="op" id="2001006">.</span><span class="ident" id="2001007">FUNC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2001013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001016">return</span><br>
<span class="lineno"></span><span class="op" id="2001023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1575</span><span class="keyword" id="2001026">func</span>&nbsp;<span class="op" id="2001031">(</span><span class="ident" id="2001032">p</span>&nbsp;<span class="op" id="2001034">*</span><span class="ident" id="2001035">printer</span><span class="op" id="2001042">)</span>&nbsp;<span class="ident" id="2001044">declList</span><span class="op" id="2001052">(</span><span class="ident" id="2001053">list</span>&nbsp;<span class="op" id="2001058">[</span><span class="op" id="2001059">]</span><span class="ident" id="2001060">ast</span><span class="op" id="2001063">.</span><span class="ident" id="2001064">Decl</span><span class="op" id="2001068">)</span>&nbsp;<span class="op" id="2001070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001073">tok</span>&nbsp;<span class="op" id="2001077">:=</span>&nbsp;<span class="ident" id="2001080">token</span><span class="op" id="2001085">.</span><span class="ident" id="2001086">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001095">for</span>&nbsp;<span class="ident" id="2001099">_</span><span class="op" id="2001100">,</span>&nbsp;<span class="ident" id="2001102">d</span>&nbsp;<span class="op" id="2001104">:=</span>&nbsp;<span class="keyword" id="2001107">range</span>&nbsp;<span class="ident" id="2001113">list</span>&nbsp;<span class="op" id="2001118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001122">prev</span>&nbsp;<span class="op" id="2001127">:=</span>&nbsp;<span class="ident" id="2001130">tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001136">tok</span>&nbsp;<span class="op" id="2001140">=</span>&nbsp;<span class="ident" id="2001142">declToken</span><span class="op" id="2001151">(</span><span class="ident" id="2001152">d</span><span class="op" id="2001153">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001157">//&nbsp;If&nbsp;the&nbsp;declaration&nbsp;token&nbsp;changed&nbsp;(e.g.,&nbsp;from&nbsp;CONST&nbsp;to&nbsp;TYPE)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001222">//&nbsp;or&nbsp;the&nbsp;next&nbsp;declaration&nbsp;has&nbsp;documentation&nbsp;associated&nbsp;with&nbsp;it,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001289">//&nbsp;print&nbsp;an&nbsp;empty&nbsp;line&nbsp;between&nbsp;top-level&nbsp;declarations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001346">//&nbsp;(because&nbsp;p.linebreak&nbsp;is&nbsp;called&nbsp;with&nbsp;the&nbsp;position&nbsp;of&nbsp;d,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001412">//&nbsp;is&nbsp;past&nbsp;any&nbsp;documentation,&nbsp;the&nbsp;minimum&nbsp;requirement&nbsp;is&nbsp;satisfied</span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001481">//&nbsp;even&nbsp;w/o&nbsp;the&nbsp;extra&nbsp;getDoc(d)&nbsp;nil-check&nbsp;-&nbsp;leave&nbsp;it&nbsp;in&nbsp;case&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001548">//&nbsp;linebreak&nbsp;logic&nbsp;improves&nbsp;-&nbsp;there&#39;s&nbsp;already&nbsp;a&nbsp;TODO).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001605">if</span>&nbsp;<span class="builtinfunc" id="2001608">len</span><span class="op" id="2001611">(</span><span class="ident" id="2001612">p</span><span class="op" id="2001613">.</span><span class="ident" id="2001614">output</span><span class="op" id="2001620">)</span>&nbsp;<span class="op" id="2001622">&gt;</span>&nbsp;<span class="num" id="2001624">0</span>&nbsp;<span class="op" id="2001626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001631">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2001704">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001761">min</span>&nbsp;<span class="op" id="2001765">:=</span>&nbsp;<span class="num" id="2001768">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2001773">if</span>&nbsp;<span class="ident" id="2001776">prev</span>&nbsp;<span class="op" id="2001781">!=</span>&nbsp;<span class="ident" id="2001784">tok</span>&nbsp;<span class="op" id="2001788">||</span>&nbsp;<span class="ident" id="2001791">getDoc</span><span class="op" id="2001797">(</span><span class="ident" id="2001798">d</span><span class="op" id="2001799">)</span>&nbsp;<span class="op" id="2001801">!=</span>&nbsp;<span class="ident" id="2001804">nil</span>&nbsp;<span class="op" id="2001808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001814">min</span>&nbsp;<span class="op" id="2001818">=</span>&nbsp;<span class="num" id="2001820">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2001825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001830">p</span><span class="op" id="2001831">.</span><span class="ident" id="2001832">linebreak</span><span class="op" id="2001841">(</span><span class="ident" id="2001842">p</span><span class="op" id="2001843">.</span><span class="ident" id="2001844">lineFor</span><span class="op" id="2001851">(</span><span class="ident" id="2001852">d</span><span class="op" id="2001853">.</span><span class="ident" id="2001854">Pos</span><span class="op" id="2001857">(</span><span class="op" id="2001858">)</span><span class="op" id="2001859">)</span><span class="op" id="2001860">,</span>&nbsp;<span class="ident" id="2001862">min</span><span class="op" id="2001865">,</span>&nbsp;<span class="ident" id="2001867">ignore</span><span class="op" id="2001873">,</span>&nbsp;<span class="builtintype" id="2001875">false</span><span class="op" id="2001880">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2001884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001888">p</span><span class="op" id="2001889">.</span><span class="ident" id="2001890">decl</span><span class="op" id="2001894">(</span><span class="ident" id="2001895">d</span><span class="op" id="2001896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2001899">}</span><br>
<span class="lineno"></span><span class="op" id="2001901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1600</span><span class="keyword" id="2001904">func</span>&nbsp;<span class="op" id="2001909">(</span><span class="ident" id="2001910">p</span>&nbsp;<span class="op" id="2001912">*</span><span class="ident" id="2001913">printer</span><span class="op" id="2001920">)</span>&nbsp;<span class="ident" id="2001922">file</span><span class="op" id="2001926">(</span><span class="ident" id="2001927">src</span>&nbsp;<span class="op" id="2001931">*</span><span class="ident" id="2001932">ast</span><span class="op" id="2001935">.</span><span class="ident" id="2001936">File</span><span class="op" id="2001940">)</span>&nbsp;<span class="op" id="2001942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001945">p</span><span class="op" id="2001946">.</span><span class="ident" id="2001947">setComment</span><span class="op" id="2001957">(</span><span class="ident" id="2001958">src</span><span class="op" id="2001961">.</span><span class="ident" id="2001962">Doc</span><span class="op" id="2001965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2001968">p</span><span class="op" id="2001969">.</span><span class="builtinfunc" id="2001970">print</span><span class="op" id="2001975">(</span><span class="ident" id="2001976">src</span><span class="op" id="2001979">.</span><span class="ident" id="2001980">Pos</span><span class="op" id="2001983">(</span><span class="op" id="2001984">)</span><span class="op" id="2001985">,</span>&nbsp;<span class="ident" id="2001987">token</span><span class="op" id="2001992">.</span><span class="ident" id="2001993">PACKAGE</span><span class="op" id="2002000">,</span>&nbsp;<span class="ident" id="2002002">blank</span><span class="op" id="2002007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2002010">p</span><span class="op" id="2002011">.</span><span class="ident" id="2002012">expr</span><span class="op" id="2002016">(</span><span class="ident" id="2002017">src</span><span class="op" id="2002020">.</span><span class="ident" id="2002021">Name</span><span class="op" id="2002025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2002028">p</span><span class="op" id="2002029">.</span><span class="ident" id="2002030">declList</span><span class="op" id="2002038">(</span><span class="ident" id="2002039">src</span><span class="op" id="2002042">.</span><span class="ident" id="2002043">Decls</span><span class="op" id="2002048">)</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2002051">p</span><span class="op" id="2002052">.</span><span class="builtinfunc" id="2002053">print</span><span class="op" id="2002058">(</span><span class="ident" id="2002059">newline</span><span class="op" id="2002066">)</span><br>
<span class="lineno"></span><span class="op" id="2002068">}</span>
</div>
</body>
</html>
