<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2702874">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2702930">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2702984">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2703035">//&nbsp;+build&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2703075">package</span>&nbsp;<span class="ident" id="2703083">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2703088">import</span>&nbsp;<span class="op" id="2703095">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2703098">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2703104">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2703115">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="2703122">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2703125">func</span>&nbsp;<span class="ident" id="2703130">setKeepAlivePeriod</span><span class="op" id="2703148">(</span><span class="ident" id="2703149">fd</span>&nbsp;<span class="op" id="2703152">*</span><span class="ident" id="2703153"><a href="/net/fd_unix.go.html#2575420">netFD</a></span><span class="op" id="2703158">,</span>&nbsp;<span class="ident" id="2703160">d</span>&nbsp;<span class="ident" id="2703162"><a href="/net/tcpsockopt_unix.go.html#2703115">time</a></span><span class="op" id="2703166">.</span><span class="ident" id="2703167">Duration</span><span class="op" id="2703175">)</span>&nbsp;<span class="builtintype" id="2703177">error</span>&nbsp;<span class="op" id="2703183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703186">if</span>&nbsp;<span class="ident" id="2703189">err</span>&nbsp;<span class="op" id="2703193">:=</span>&nbsp;<span class="ident" id="2703196"><a href="/net/tcpsockopt_unix.go.html#2703149">fd</a></span><span class="op" id="2703198">.</span><span class="ident" id="2703199">incref</span><span class="op" id="2703205">(</span><span class="op" id="2703206">)</span><span class="op" id="2703207">;</span>&nbsp;<span class="ident" id="2703209"><a href="/net/tcpsockopt_unix.go.html#2703189">err</a></span>&nbsp;<span class="op" id="2703213">!=</span>&nbsp;<span class="ident" id="2703216">nil</span>&nbsp;<span class="op" id="2703220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703224">return</span>&nbsp;<span class="ident" id="2703231"><a href="/net/tcpsockopt_unix.go.html#2703189">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2703236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703239">defer</span>&nbsp;<span class="ident" id="2703245"><a href="/net/tcpsockopt_unix.go.html#2703149">fd</a></span><span class="op" id="2703247">.</span><span class="ident" id="2703248">decref</span><span class="op" id="2703254">(</span><span class="op" id="2703255">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703258">//&nbsp;The&nbsp;kernel&nbsp;expects&nbsp;seconds&nbsp;so&nbsp;round&nbsp;to&nbsp;next&nbsp;highest&nbsp;second.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703322"><a href="/net/tcpsockopt_unix.go.html#2703160">d</a></span>&nbsp;<span class="op" id="2703324">+=</span>&nbsp;<span class="op" id="2703327">(</span><span class="ident" id="2703328"><a href="/net/tcpsockopt_unix.go.html#2703115">time</a></span><span class="op" id="2703332">.</span><span class="ident" id="2703333">Second</span>&nbsp;<span class="op" id="2703340">-</span>&nbsp;<span class="ident" id="2703342"><a href="/net/tcpsockopt_unix.go.html#2703115">time</a></span><span class="op" id="2703346">.</span><span class="ident" id="2703347">Nanosecond</span><span class="op" id="2703357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703360">secs</span>&nbsp;<span class="op" id="2703365">:=</span>&nbsp;<span class="builtintype" id="2703368">int</span><span class="op" id="2703371">(</span><span class="ident" id="2703372"><a href="/net/tcpsockopt_unix.go.html#2703160">d</a></span><span class="op" id="2703373">.</span><span class="ident" id="2703374">Seconds</span><span class="op" id="2703381">(</span><span class="op" id="2703382">)</span><span class="op" id="2703383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703386">if</span>&nbsp;<span class="ident" id="2703389">err</span>&nbsp;<span class="op" id="2703393">:=</span>&nbsp;<span class="ident" id="2703396"><a href="/net/tcpsockopt_unix.go.html#2703104">syscall</a></span><span class="op" id="2703403">.</span><span class="ident" id="2703404">SetsockoptInt</span><span class="op" id="2703417">(</span><span class="ident" id="2703418"><a href="/net/tcpsockopt_unix.go.html#2703149">fd</a></span><span class="op" id="2703420">.</span><span class="ident" id="2703421">sysfd</span><span class="op" id="2703426">,</span>&nbsp;<span class="ident" id="2703428"><a href="/net/tcpsockopt_unix.go.html#2703104">syscall</a></span><span class="op" id="2703435">.</span><span class="ident" id="2703436">IPPROTO_TCP</span><span class="op" id="2703447">,</span>&nbsp;<span class="ident" id="2703449"><a href="/net/tcpsockopt_unix.go.html#2703104">syscall</a></span><span class="op" id="2703456">.</span><span class="ident" id="2703457">TCP_KEEPINTVL</span><span class="op" id="2703470">,</span>&nbsp;<span class="ident" id="2703472"><a href="/net/tcpsockopt_unix.go.html#2703360">secs</a></span><span class="op" id="2703476">)</span><span class="op" id="2703477">;</span>&nbsp;<span class="ident" id="2703479"><a href="/net/tcpsockopt_unix.go.html#2703389">err</a></span>&nbsp;<span class="op" id="2703483">!=</span>&nbsp;<span class="ident" id="2703486">nil</span>&nbsp;<span class="op" id="2703490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703494">return</span>&nbsp;<span class="ident" id="2703501"><a href="/net/tcpsockopt_unix.go.html#2703098">os</a></span><span class="op" id="2703503">.</span><span class="ident" id="2703504">NewSyscallError</span><span class="op" id="2703519">(</span><span class="string" id="2703520">&#34;setsockopt&#34;</span><span class="op" id="2703532">,</span>&nbsp;<span class="ident" id="2703534"><a href="/net/tcpsockopt_unix.go.html#2703389">err</a></span><span class="op" id="2703537">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2703540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703543">return</span>&nbsp;<span class="ident" id="2703550"><a href="/net/tcpsockopt_unix.go.html#2703098">os</a></span><span class="op" id="2703552">.</span><span class="ident" id="2703553">NewSyscallError</span><span class="op" id="2703568">(</span><span class="string" id="2703569">&#34;setsockopt&#34;</span><span class="op" id="2703581">,</span>&nbsp;<span class="ident" id="2703583"><a href="/net/tcpsockopt_unix.go.html#2703104">syscall</a></span><span class="op" id="2703590">.</span><span class="ident" id="2703591">SetsockoptInt</span><span class="op" id="2703604">(</span><span class="ident" id="2703605"><a href="/net/tcpsockopt_unix.go.html#2703149">fd</a></span><span class="op" id="2703607">.</span><span class="ident" id="2703608">sysfd</span><span class="op" id="2703613">,</span>&nbsp;<span class="ident" id="2703615"><a href="/net/tcpsockopt_unix.go.html#2703104">syscall</a></span><span class="op" id="2703622">.</span><span class="ident" id="2703623">IPPROTO_TCP</span><span class="op" id="2703634">,</span>&nbsp;<span class="ident" id="2703636"><a href="/net/tcpsockopt_unix.go.html#2703104">syscall</a></span><span class="op" id="2703643">.</span><span class="ident" id="2703644">TCP_KEEPIDLE</span><span class="op" id="2703656">,</span>&nbsp;<span class="ident" id="2703658"><a href="/net/tcpsockopt_unix.go.html#2703360">secs</a></span><span class="op" id="2703662">)</span><span class="op" id="2703663">)</span><br>
<span class="lineno"></span><span class="op" id="2703665">}</span>
</div>
</body>
</html>
