<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime/multipart</h2>
<ul>
<li><a href="/gostd/mime/multipart/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/mime/multipart/formdata.go.html">formdata.go</a></li>
<li><a href="/gostd/mime/multipart/formdata_test.go.html">formdata_test.go</a></li>
<li><a href="/gostd/mime/multipart/multipart.go.html">multipart.go</a></li>
<li><a href="/gostd/mime/multipart/multipart_test.go.html">multipart_test.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable.go.html">quotedprintable.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable_test.go.html">quotedprintable_test.go</a></li>
<li><a href="/gostd/mime/multipart/writer.go.html">writer.go</a></li>
<li><a href="/gostd/mime/multipart/writer_test.go.html" class="current">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7773129">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7773184">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7773238">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7773289">package</span>&nbsp;<span class="ident" id="7773297">multipart</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7773308">import</span>&nbsp;<span class="op" id="7773315">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7773318">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7773327">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7773340">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7773351">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7773361">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7773364">func</span>&nbsp;<span class="ident" id="7773369">TestWriter</span><span class="op" id="7773379">(</span><span class="ident" id="7773380">t</span>&nbsp;<span class="op" id="7773382">*</span><span class="ident" id="7773383"><a href="/gostd/mime/multipart/writer_test.go.html#7773351">testing</a></span><span class="op" id="7773390">.</span><span class="ident" id="7773391"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7773392">)</span>&nbsp;<span class="op" id="7773394">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773397">fileContents</span>&nbsp;<span class="op" id="7773410">:=</span>&nbsp;<span class="op" id="7773413">[</span><span class="op" id="7773414">]</span><span class="builtintype" id="7773415">byte</span><span class="op" id="7773419">(</span><span class="string" id="7773420">&#34;my&nbsp;file&nbsp;contents&#34;</span><span class="op" id="7773438">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7773442">var</span>&nbsp;<span class="ident" id="7773446">b</span>&nbsp;<span class="ident" id="7773448"><a href="/gostd/mime/multipart/writer_test.go.html#7773318">bytes</a></span><span class="op" id="7773453">.</span><span class="ident" id="7773454"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773462">w</span>&nbsp;<span class="op" id="7773464">:=</span>&nbsp;<span class="ident" id="7773467"><a href="/gostd/mime/multipart/writer.go.html#4324179">NewWriter</a></span><span class="op" id="7773476">(</span><span class="op" id="7773477">&amp;</span><span class="ident" id="7773478"><a href="/gostd/mime/multipart/writer_test.go.html#7773446">b</a></span><span class="op" id="7773479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7773482">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773486">part</span><span class="op" id="7773490">,</span>&nbsp;<span class="ident" id="7773492">err</span>&nbsp;<span class="op" id="7773496">:=</span>&nbsp;<span class="ident" id="7773499"><a href="/gostd/mime/multipart/writer_test.go.html#7773462">w</a></span><span class="op" id="7773500">.</span><span class="ident" id="7773501"><a href="/gostd/mime/multipart/writer.go.html#4326804">CreateFormFile</a></span><span class="op" id="7773515">(</span><span class="string" id="7773516">&#34;myfile&#34;</span><span class="op" id="7773524">,</span>&nbsp;<span class="string" id="7773526">&#34;my-file.txt&#34;</span><span class="op" id="7773539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7773543">if</span>&nbsp;<span class="ident" id="7773546"><a href="/gostd/mime/multipart/writer_test.go.html#7773492">err</a></span>&nbsp;<span class="op" id="7773550">!=</span>&nbsp;<span class="builtintype" id="7773553">nil</span>&nbsp;<span class="op" id="7773557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773562"><a href="/gostd/mime/multipart/writer_test.go.html#7773380">t</a></span><span class="op" id="7773563">.</span><span class="ident" id="7773564"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7773570">(</span><span class="string" id="7773571">&#34;CreateFormFile:&nbsp;%v&#34;</span><span class="op" id="7773591">,</span>&nbsp;<span class="ident" id="7773593"><a href="/gostd/mime/multipart/writer_test.go.html#7773492">err</a></span><span class="op" id="7773596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7773600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773604"><a href="/gostd/mime/multipart/writer_test.go.html#7773486">part</a></span><span class="op" id="7773608">.</span><span class="ident" id="7773609"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="7773614">(</span><span class="ident" id="7773615"><a href="/gostd/mime/multipart/writer_test.go.html#7773397">fileContents</a></span><span class="op" id="7773627">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773631"><a href="/gostd/mime/multipart/writer_test.go.html#7773492">err</a></span>&nbsp;<span class="op" id="7773635">=</span>&nbsp;<span class="ident" id="7773637"><a href="/gostd/mime/multipart/writer_test.go.html#7773462">w</a></span><span class="op" id="7773638">.</span><span class="ident" id="7773639"><a href="/gostd/mime/multipart/writer.go.html#4327508">WriteField</a></span><span class="op" id="7773649">(</span><span class="string" id="7773650">&#34;key&#34;</span><span class="op" id="7773655">,</span>&nbsp;<span class="string" id="7773657">&#34;val&#34;</span><span class="op" id="7773662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7773666">if</span>&nbsp;<span class="ident" id="7773669"><a href="/gostd/mime/multipart/writer_test.go.html#7773492">err</a></span>&nbsp;<span class="op" id="7773673">!=</span>&nbsp;<span class="builtintype" id="7773676">nil</span>&nbsp;<span class="op" id="7773680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773685"><a href="/gostd/mime/multipart/writer_test.go.html#7773380">t</a></span><span class="op" id="7773686">.</span><span class="ident" id="7773687"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7773693">(</span><span class="string" id="7773694">&#34;WriteField:&nbsp;%v&#34;</span><span class="op" id="7773710">,</span>&nbsp;<span class="ident" id="7773712"><a href="/gostd/mime/multipart/writer_test.go.html#7773492">err</a></span><span class="op" id="7773715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7773719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773723"><a href="/gostd/mime/multipart/writer_test.go.html#7773486">part</a></span><span class="op" id="7773727">.</span><span class="ident" id="7773728"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="7773733">(</span><span class="op" id="7773734">[</span><span class="op" id="7773735">]</span><span class="builtintype" id="7773736">byte</span><span class="op" id="7773740">(</span><span class="string" id="7773741">&#34;val&#34;</span><span class="op" id="7773746">)</span><span class="op" id="7773747">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773751"><a href="/gostd/mime/multipart/writer_test.go.html#7773492">err</a></span>&nbsp;<span class="op" id="7773755">=</span>&nbsp;<span class="ident" id="7773757"><a href="/gostd/mime/multipart/writer_test.go.html#7773462">w</a></span><span class="op" id="7773758">.</span><span class="ident" id="7773759"><a href="/gostd/mime/multipart/writer.go.html#4327790">Close</a></span><span class="op" id="7773764">(</span><span class="op" id="7773765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7773769">if</span>&nbsp;<span class="ident" id="7773772"><a href="/gostd/mime/multipart/writer_test.go.html#7773492">err</a></span>&nbsp;<span class="op" id="7773776">!=</span>&nbsp;<span class="builtintype" id="7773779">nil</span>&nbsp;<span class="op" id="7773783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773788"><a href="/gostd/mime/multipart/writer_test.go.html#7773380">t</a></span><span class="op" id="7773789">.</span><span class="ident" id="7773790"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7773796">(</span><span class="string" id="7773797">&#34;Close:&nbsp;%v&#34;</span><span class="op" id="7773808">,</span>&nbsp;<span class="ident" id="7773810"><a href="/gostd/mime/multipart/writer_test.go.html#7773492">err</a></span><span class="op" id="7773813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7773817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773821">s</span>&nbsp;<span class="op" id="7773823">:=</span>&nbsp;<span class="ident" id="7773826"><a href="/gostd/mime/multipart/writer_test.go.html#7773446">b</a></span><span class="op" id="7773827">.</span><span class="ident" id="7773828"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="7773834">(</span><span class="op" id="7773835">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7773839">if</span>&nbsp;<span class="builtinfunc" id="7773842">len</span><span class="op" id="7773845">(</span><span class="ident" id="7773846"><a href="/gostd/mime/multipart/writer_test.go.html#7773821">s</a></span><span class="op" id="7773847">)</span>&nbsp;<span class="op" id="7773849">==</span>&nbsp;<span class="num" id="7773852">0</span>&nbsp;<span class="op" id="7773854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773859"><a href="/gostd/mime/multipart/writer_test.go.html#7773380">t</a></span><span class="op" id="7773860">.</span><span class="ident" id="7773861"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7773866">(</span><span class="string" id="7773867">&#34;String:&nbsp;unexpected&nbsp;empty&nbsp;result&#34;</span><span class="op" id="7773900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7773904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7773908">if</span>&nbsp;<span class="ident" id="7773911"><a href="/gostd/mime/multipart/writer_test.go.html#7773821">s</a></span><span class="op" id="7773912">[</span><span class="num" id="7773913">0</span><span class="op" id="7773914">]</span>&nbsp;<span class="op" id="7773916">==</span>&nbsp;<span class="string" id="7773919">&#39;\r&#39;</span>&nbsp;<span class="op" id="7773924">||</span>&nbsp;<span class="ident" id="7773927"><a href="/gostd/mime/multipart/writer_test.go.html#7773821">s</a></span><span class="op" id="7773928">[</span><span class="num" id="7773929">0</span><span class="op" id="7773930">]</span>&nbsp;<span class="op" id="7773932">==</span>&nbsp;<span class="string" id="7773935">&#39;\n&#39;</span>&nbsp;<span class="op" id="7773940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773945"><a href="/gostd/mime/multipart/writer_test.go.html#7773380">t</a></span><span class="op" id="7773946">.</span><span class="ident" id="7773947"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7773952">(</span><span class="string" id="7773953">&#34;String:&nbsp;unexpected&nbsp;newline&#34;</span><span class="op" id="7773981">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7773985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7773988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773992">r</span>&nbsp;<span class="op" id="7773994">:=</span>&nbsp;<span class="ident" id="7773997"><a href="/gostd/mime/multipart/multipart.go.html#4313338">NewReader</a></span><span class="op" id="7774006">(</span><span class="op" id="7774007">&amp;</span><span class="ident" id="7774008"><a href="/gostd/mime/multipart/writer_test.go.html#7773446">b</a></span><span class="op" id="7774009">,</span>&nbsp;<span class="ident" id="7774011"><a href="/gostd/mime/multipart/writer_test.go.html#7773462">w</a></span><span class="op" id="7774012">.</span><span class="ident" id="7774013"><a href="/gostd/mime/multipart/writer.go.html#4324340">Boundary</a></span><span class="op" id="7774021">(</span><span class="op" id="7774022">)</span><span class="op" id="7774023">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774027">part</span><span class="op" id="7774031">,</span>&nbsp;<span class="ident" id="7774033">err</span>&nbsp;<span class="op" id="7774037">:=</span>&nbsp;<span class="ident" id="7774040"><a href="/gostd/mime/multipart/writer_test.go.html#7773992">r</a></span><span class="op" id="7774041">.</span><span class="ident" id="7774042"><a href="/gostd/mime/multipart/multipart.go.html#4317068">NextPart</a></span><span class="op" id="7774050">(</span><span class="op" id="7774051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774054">if</span>&nbsp;<span class="ident" id="7774057"><a href="/gostd/mime/multipart/writer_test.go.html#7774033">err</a></span>&nbsp;<span class="op" id="7774061">!=</span>&nbsp;<span class="builtintype" id="7774064">nil</span>&nbsp;<span class="op" id="7774068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774072"><a href="/gostd/mime/multipart/writer_test.go.html#7773380">t</a></span><span class="op" id="7774073">.</span><span class="ident" id="7774074"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7774080">(</span><span class="string" id="7774081">&#34;part&nbsp;1:&nbsp;%v&#34;</span><span class="op" id="7774093">,</span>&nbsp;<span class="ident" id="7774095"><a href="/gostd/mime/multipart/writer_test.go.html#7774033">err</a></span><span class="op" id="7774098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774104">if</span>&nbsp;<span class="ident" id="7774107">g</span><span class="op" id="7774108">,</span>&nbsp;<span class="ident" id="7774110">e</span>&nbsp;<span class="op" id="7774112">:=</span>&nbsp;<span class="ident" id="7774115"><a href="/gostd/mime/multipart/writer_test.go.html#7774027">part</a></span><span class="op" id="7774119">.</span><span class="ident" id="7774120"><a href="/gostd/mime/multipart/multipart.go.html#4312343">FormName</a></span><span class="op" id="7774128">(</span><span class="op" id="7774129">)</span><span class="op" id="7774130">,</span>&nbsp;<span class="string" id="7774132">&#34;myfile&#34;</span><span class="op" id="7774140">;</span>&nbsp;<span class="ident" id="7774142"><a href="/gostd/mime/multipart/writer_test.go.html#7774107">g</a></span>&nbsp;<span class="op" id="7774144">!=</span>&nbsp;<span class="ident" id="7774147"><a href="/gostd/mime/multipart/writer_test.go.html#7774110">e</a></span>&nbsp;<span class="op" id="7774149">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774153"><a href="/gostd/mime/multipart/writer_test.go.html#7773380">t</a></span><span class="op" id="7774154">.</span><span class="ident" id="7774155"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7774161">(</span><span class="string" id="7774162">&#34;part&nbsp;1:&nbsp;want&nbsp;form&nbsp;name&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7774197">,</span>&nbsp;<span class="ident" id="7774199"><a href="/gostd/mime/multipart/writer_test.go.html#7774110">e</a></span><span class="op" id="7774200">,</span>&nbsp;<span class="ident" id="7774202"><a href="/gostd/mime/multipart/writer_test.go.html#7774107">g</a></span><span class="op" id="7774203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774209">slurp</span><span class="op" id="7774214">,</span>&nbsp;<span class="ident" id="7774216"><a href="/gostd/mime/multipart/writer_test.go.html#7774033">err</a></span>&nbsp;<span class="op" id="7774220">:=</span>&nbsp;<span class="ident" id="7774223"><a href="/gostd/mime/multipart/writer_test.go.html#7773327">ioutil</a></span><span class="op" id="7774229">.</span><span class="ident" id="7774230"><a href="/gostd/io/ioutil/ioutil.go.html#3765117">ReadAll</a></span><span class="op" id="7774237">(</span><span class="ident" id="7774238"><a href="/gostd/mime/multipart/writer_test.go.html#7774027">part</a></span><span class="op" id="7774242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774245">if</span>&nbsp;<span class="ident" id="7774248"><a href="/gostd/mime/multipart/writer_test.go.html#7774033">err</a></span>&nbsp;<span class="op" id="7774252">!=</span>&nbsp;<span class="builtintype" id="7774255">nil</span>&nbsp;<span class="op" id="7774259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774263"><a href="/gostd/mime/multipart/writer_test.go.html#7773380">t</a></span><span class="op" id="7774264">.</span><span class="ident" id="7774265"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7774271">(</span><span class="string" id="7774272">&#34;part&nbsp;1:&nbsp;ReadAll:&nbsp;%v&#34;</span><span class="op" id="7774293">,</span>&nbsp;<span class="ident" id="7774295"><a href="/gostd/mime/multipart/writer_test.go.html#7774033">err</a></span><span class="op" id="7774298">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774304">if</span>&nbsp;<span class="ident" id="7774307">e</span><span class="op" id="7774308">,</span>&nbsp;<span class="ident" id="7774310">g</span>&nbsp;<span class="op" id="7774312">:=</span>&nbsp;<span class="builtintype" id="7774315">string</span><span class="op" id="7774321">(</span><span class="ident" id="7774322"><a href="/gostd/mime/multipart/writer_test.go.html#7773397">fileContents</a></span><span class="op" id="7774334">)</span><span class="op" id="7774335">,</span>&nbsp;<span class="builtintype" id="7774337">string</span><span class="op" id="7774343">(</span><span class="ident" id="7774344"><a href="/gostd/mime/multipart/writer_test.go.html#7774209">slurp</a></span><span class="op" id="7774349">)</span><span class="op" id="7774350">;</span>&nbsp;<span class="ident" id="7774352"><a href="/gostd/mime/multipart/writer_test.go.html#7774307">e</a></span>&nbsp;<span class="op" id="7774354">!=</span>&nbsp;<span class="ident" id="7774357"><a href="/gostd/mime/multipart/writer_test.go.html#7774310">g</a></span>&nbsp;<span class="op" id="7774359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774363"><a href="/gostd/mime/multipart/writer_test.go.html#7773380">t</a></span><span class="op" id="7774364">.</span><span class="ident" id="7774365"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7774371">(</span><span class="string" id="7774372">&#34;part&nbsp;1:&nbsp;want&nbsp;contents&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7774406">,</span>&nbsp;<span class="ident" id="7774408"><a href="/gostd/mime/multipart/writer_test.go.html#7774307">e</a></span><span class="op" id="7774409">,</span>&nbsp;<span class="ident" id="7774411"><a href="/gostd/mime/multipart/writer_test.go.html#7774310">g</a></span><span class="op" id="7774412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774419"><a href="/gostd/mime/multipart/writer_test.go.html#7774027">part</a></span><span class="op" id="7774423">,</span>&nbsp;<span class="ident" id="7774425"><a href="/gostd/mime/multipart/writer_test.go.html#7774033">err</a></span>&nbsp;<span class="op" id="7774429">=</span>&nbsp;<span class="ident" id="7774431"><a href="/gostd/mime/multipart/writer_test.go.html#7773992">r</a></span><span class="op" id="7774432">.</span><span class="ident" id="7774433"><a href="/gostd/mime/multipart/multipart.go.html#4317068">NextPart</a></span><span class="op" id="7774441">(</span><span class="op" id="7774442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774445">if</span>&nbsp;<span class="ident" id="7774448"><a href="/gostd/mime/multipart/writer_test.go.html#7774033">err</a></span>&nbsp;<span class="op" id="7774452">!=</span>&nbsp;<span class="builtintype" id="7774455">nil</span>&nbsp;<span class="op" id="7774459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774463"><a href="/gostd/mime/multipart/writer_test.go.html#7773380">t</a></span><span class="op" id="7774464">.</span><span class="ident" id="7774465"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7774471">(</span><span class="string" id="7774472">&#34;part&nbsp;2:&nbsp;%v&#34;</span><span class="op" id="7774484">,</span>&nbsp;<span class="ident" id="7774486"><a href="/gostd/mime/multipart/writer_test.go.html#7774033">err</a></span><span class="op" id="7774489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774495">if</span>&nbsp;<span class="ident" id="7774498">g</span><span class="op" id="7774499">,</span>&nbsp;<span class="ident" id="7774501">e</span>&nbsp;<span class="op" id="7774503">:=</span>&nbsp;<span class="ident" id="7774506"><a href="/gostd/mime/multipart/writer_test.go.html#7774027">part</a></span><span class="op" id="7774510">.</span><span class="ident" id="7774511"><a href="/gostd/mime/multipart/multipart.go.html#4312343">FormName</a></span><span class="op" id="7774519">(</span><span class="op" id="7774520">)</span><span class="op" id="7774521">,</span>&nbsp;<span class="string" id="7774523">&#34;key&#34;</span><span class="op" id="7774528">;</span>&nbsp;<span class="ident" id="7774530"><a href="/gostd/mime/multipart/writer_test.go.html#7774498">g</a></span>&nbsp;<span class="op" id="7774532">!=</span>&nbsp;<span class="ident" id="7774535"><a href="/gostd/mime/multipart/writer_test.go.html#7774501">e</a></span>&nbsp;<span class="op" id="7774537">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774541"><a href="/gostd/mime/multipart/writer_test.go.html#7773380">t</a></span><span class="op" id="7774542">.</span><span class="ident" id="7774543"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7774549">(</span><span class="string" id="7774550">&#34;part&nbsp;2:&nbsp;want&nbsp;form&nbsp;name&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7774585">,</span>&nbsp;<span class="ident" id="7774587"><a href="/gostd/mime/multipart/writer_test.go.html#7774501">e</a></span><span class="op" id="7774588">,</span>&nbsp;<span class="ident" id="7774590"><a href="/gostd/mime/multipart/writer_test.go.html#7774498">g</a></span><span class="op" id="7774591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774597"><a href="/gostd/mime/multipart/writer_test.go.html#7774209">slurp</a></span><span class="op" id="7774602">,</span>&nbsp;<span class="ident" id="7774604"><a href="/gostd/mime/multipart/writer_test.go.html#7774033">err</a></span>&nbsp;<span class="op" id="7774608">=</span>&nbsp;<span class="ident" id="7774610"><a href="/gostd/mime/multipart/writer_test.go.html#7773327">ioutil</a></span><span class="op" id="7774616">.</span><span class="ident" id="7774617"><a href="/gostd/io/ioutil/ioutil.go.html#3765117">ReadAll</a></span><span class="op" id="7774624">(</span><span class="ident" id="7774625"><a href="/gostd/mime/multipart/writer_test.go.html#7774027">part</a></span><span class="op" id="7774629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774632">if</span>&nbsp;<span class="ident" id="7774635"><a href="/gostd/mime/multipart/writer_test.go.html#7774033">err</a></span>&nbsp;<span class="op" id="7774639">!=</span>&nbsp;<span class="builtintype" id="7774642">nil</span>&nbsp;<span class="op" id="7774646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774650"><a href="/gostd/mime/multipart/writer_test.go.html#7773380">t</a></span><span class="op" id="7774651">.</span><span class="ident" id="7774652"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7774658">(</span><span class="string" id="7774659">&#34;part&nbsp;2:&nbsp;ReadAll:&nbsp;%v&#34;</span><span class="op" id="7774680">,</span>&nbsp;<span class="ident" id="7774682"><a href="/gostd/mime/multipart/writer_test.go.html#7774033">err</a></span><span class="op" id="7774685">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774691">if</span>&nbsp;<span class="ident" id="7774694">e</span><span class="op" id="7774695">,</span>&nbsp;<span class="ident" id="7774697">g</span>&nbsp;<span class="op" id="7774699">:=</span>&nbsp;<span class="string" id="7774702">&#34;val&#34;</span><span class="op" id="7774707">,</span>&nbsp;<span class="builtintype" id="7774709">string</span><span class="op" id="7774715">(</span><span class="ident" id="7774716"><a href="/gostd/mime/multipart/writer_test.go.html#7774209">slurp</a></span><span class="op" id="7774721">)</span><span class="op" id="7774722">;</span>&nbsp;<span class="ident" id="7774724"><a href="/gostd/mime/multipart/writer_test.go.html#7774694">e</a></span>&nbsp;<span class="op" id="7774726">!=</span>&nbsp;<span class="ident" id="7774729"><a href="/gostd/mime/multipart/writer_test.go.html#7774697">g</a></span>&nbsp;<span class="op" id="7774731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774735"><a href="/gostd/mime/multipart/writer_test.go.html#7773380">t</a></span><span class="op" id="7774736">.</span><span class="ident" id="7774737"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7774743">(</span><span class="string" id="7774744">&#34;part&nbsp;2:&nbsp;want&nbsp;contents&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7774778">,</span>&nbsp;<span class="ident" id="7774780"><a href="/gostd/mime/multipart/writer_test.go.html#7774694">e</a></span><span class="op" id="7774781">,</span>&nbsp;<span class="ident" id="7774783"><a href="/gostd/mime/multipart/writer_test.go.html#7774697">g</a></span><span class="op" id="7774784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774791"><a href="/gostd/mime/multipart/writer_test.go.html#7774027">part</a></span><span class="op" id="7774795">,</span>&nbsp;<span class="ident" id="7774797"><a href="/gostd/mime/multipart/writer_test.go.html#7774033">err</a></span>&nbsp;<span class="op" id="7774801">=</span>&nbsp;<span class="ident" id="7774803"><a href="/gostd/mime/multipart/writer_test.go.html#7773992">r</a></span><span class="op" id="7774804">.</span><span class="ident" id="7774805"><a href="/gostd/mime/multipart/multipart.go.html#4317068">NextPart</a></span><span class="op" id="7774813">(</span><span class="op" id="7774814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774817">if</span>&nbsp;<span class="ident" id="7774820"><a href="/gostd/mime/multipart/writer_test.go.html#7774027">part</a></span>&nbsp;<span class="op" id="7774825">!=</span>&nbsp;<span class="builtintype" id="7774828">nil</span>&nbsp;<span class="op" id="7774832">||</span>&nbsp;<span class="ident" id="7774835"><a href="/gostd/mime/multipart/writer_test.go.html#7774033">err</a></span>&nbsp;<span class="op" id="7774839">==</span>&nbsp;<span class="builtintype" id="7774842">nil</span>&nbsp;<span class="op" id="7774846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774850"><a href="/gostd/mime/multipart/writer_test.go.html#7773380">t</a></span><span class="op" id="7774851">.</span><span class="ident" id="7774852"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7774858">(</span><span class="string" id="7774859">&#34;expected&nbsp;end&nbsp;of&nbsp;parts;&nbsp;got&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="7774894">,</span>&nbsp;<span class="ident" id="7774896"><a href="/gostd/mime/multipart/writer_test.go.html#7774027">part</a></span><span class="op" id="7774900">,</span>&nbsp;<span class="ident" id="7774902"><a href="/gostd/mime/multipart/writer_test.go.html#7774033">err</a></span><span class="op" id="7774905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774908">}</span><br>
<span class="lineno"></span><span class="op" id="7774910">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="keyword" id="7774913">func</span>&nbsp;<span class="ident" id="7774918">TestWriterSetBoundary</span><span class="op" id="7774939">(</span><span class="ident" id="7774940">t</span>&nbsp;<span class="op" id="7774942">*</span><span class="ident" id="7774943"><a href="/gostd/mime/multipart/writer_test.go.html#7773351">testing</a></span><span class="op" id="7774950">.</span><span class="ident" id="7774951"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7774952">)</span>&nbsp;<span class="op" id="7774954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774957">var</span>&nbsp;<span class="ident" id="7774961">b</span>&nbsp;<span class="ident" id="7774963"><a href="/gostd/mime/multipart/writer_test.go.html#7773318">bytes</a></span><span class="op" id="7774968">.</span><span class="ident" id="7774969"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774977">w</span>&nbsp;<span class="op" id="7774979">:=</span>&nbsp;<span class="ident" id="7774982"><a href="/gostd/mime/multipart/writer.go.html#4324179">NewWriter</a></span><span class="op" id="7774991">(</span><span class="op" id="7774992">&amp;</span><span class="ident" id="7774993"><a href="/gostd/mime/multipart/writer_test.go.html#7774961">b</a></span><span class="op" id="7774994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774997">tests</span>&nbsp;<span class="op" id="7775003">:=</span>&nbsp;<span class="op" id="7775006">[</span><span class="op" id="7775007">]</span><span class="keyword" id="7775008">struct</span>&nbsp;<span class="op" id="7775015">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775019">b</span>&nbsp;&nbsp;<span class="builtintype" id="7775022">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775031">ok</span>&nbsp;<span class="builtintype" id="7775034">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775040">}</span><span class="op" id="7775041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775045">{</span><span class="string" id="7775046">&#34;abc&#34;</span><span class="op" id="7775051">,</span>&nbsp;<span class="builtintype" id="7775053">true</span><span class="op" id="7775057">}</span><span class="op" id="7775058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775062">{</span><span class="string" id="7775063">&#34;&#34;</span><span class="op" id="7775065">,</span>&nbsp;<span class="builtintype" id="7775067">false</span><span class="op" id="7775072">}</span><span class="op" id="7775073">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775077">{</span><span class="string" id="7775078">&#34;ung√ºltig&#34;</span><span class="op" id="7775089">,</span>&nbsp;<span class="builtintype" id="7775091">false</span><span class="op" id="7775096">}</span><span class="op" id="7775097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775101">{</span><span class="string" id="7775102">&#34;!&#34;</span><span class="op" id="7775105">,</span>&nbsp;<span class="builtintype" id="7775107">false</span><span class="op" id="7775112">}</span><span class="op" id="7775113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775117">{</span><span class="ident" id="7775118"><a href="/gostd/mime/multipart/writer_test.go.html#7773340">strings</a></span><span class="op" id="7775125">.</span><span class="ident" id="7775126"><a href="/gostd/strings/strings.go.html#2976882">Repeat</a></span><span class="op" id="7775132">(</span><span class="string" id="7775133">&#34;x&#34;</span><span class="op" id="7775136">,</span>&nbsp;<span class="num" id="7775138">69</span><span class="op" id="7775140">)</span><span class="op" id="7775141">,</span>&nbsp;<span class="builtintype" id="7775143">true</span><span class="op" id="7775147">}</span><span class="op" id="7775148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775152">{</span><span class="ident" id="7775153"><a href="/gostd/mime/multipart/writer_test.go.html#7773340">strings</a></span><span class="op" id="7775160">.</span><span class="ident" id="7775161"><a href="/gostd/strings/strings.go.html#2976882">Repeat</a></span><span class="op" id="7775167">(</span><span class="string" id="7775168">&#34;x&#34;</span><span class="op" id="7775171">,</span>&nbsp;<span class="num" id="7775173">70</span><span class="op" id="7775175">)</span><span class="op" id="7775176">,</span>&nbsp;<span class="builtintype" id="7775178">false</span><span class="op" id="7775183">}</span><span class="op" id="7775184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775188">{</span><span class="string" id="7775189">&#34;bad!ascii!&#34;</span><span class="op" id="7775201">,</span>&nbsp;<span class="builtintype" id="7775203">false</span><span class="op" id="7775208">}</span><span class="op" id="7775209">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775213">{</span><span class="string" id="7775214">&#34;my-separator&#34;</span><span class="op" id="7775228">,</span>&nbsp;<span class="builtintype" id="7775230">true</span><span class="op" id="7775234">}</span><span class="op" id="7775235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7775241">for</span>&nbsp;<span class="ident" id="7775245">i</span><span class="op" id="7775246">,</span>&nbsp;<span class="ident" id="7775248">tt</span>&nbsp;<span class="op" id="7775251">:=</span>&nbsp;<span class="keyword" id="7775254">range</span>&nbsp;<span class="ident" id="7775260"><a href="/gostd/mime/multipart/writer_test.go.html#7774997">tests</a></span>&nbsp;<span class="op" id="7775266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775270">err</span>&nbsp;<span class="op" id="7775274">:=</span>&nbsp;<span class="ident" id="7775277"><a href="/gostd/mime/multipart/writer_test.go.html#7774977">w</a></span><span class="op" id="7775278">.</span><span class="ident" id="7775279"><a href="/gostd/mime/multipart/writer.go.html#4324648">SetBoundary</a></span><span class="op" id="7775290">(</span><span class="ident" id="7775291"><a href="/gostd/mime/multipart/writer_test.go.html#7775248">tt</a></span><span class="op" id="7775293">.</span><span class="ident" id="7775294"><a href="/gostd/mime/multipart/writer_test.go.html#7775019">b</a></span><span class="op" id="7775295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775299">got</span>&nbsp;<span class="op" id="7775303">:=</span>&nbsp;<span class="ident" id="7775306"><a href="/gostd/mime/multipart/writer_test.go.html#7775270">err</a></span>&nbsp;<span class="op" id="7775310">==</span>&nbsp;<span class="builtintype" id="7775313">nil</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7775319">if</span>&nbsp;<span class="ident" id="7775322"><a href="/gostd/mime/multipart/writer_test.go.html#7775299">got</a></span>&nbsp;<span class="op" id="7775326">!=</span>&nbsp;<span class="ident" id="7775329"><a href="/gostd/mime/multipart/writer_test.go.html#7775248">tt</a></span><span class="op" id="7775331">.</span><span class="ident" id="7775332"><a href="/gostd/mime/multipart/writer_test.go.html#7775031">ok</a></span>&nbsp;<span class="op" id="7775335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775340"><a href="/gostd/mime/multipart/writer_test.go.html#7774940">t</a></span><span class="op" id="7775341">.</span><span class="ident" id="7775342"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7775348">(</span><span class="string" id="7775349">&#34;%d.&nbsp;boundary&nbsp;%q&nbsp;=&nbsp;%v&nbsp;(%v);&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7775385">,</span>&nbsp;<span class="ident" id="7775387"><a href="/gostd/mime/multipart/writer_test.go.html#7775245">i</a></span><span class="op" id="7775388">,</span>&nbsp;<span class="ident" id="7775390"><a href="/gostd/mime/multipart/writer_test.go.html#7775248">tt</a></span><span class="op" id="7775392">.</span><span class="ident" id="7775393"><a href="/gostd/mime/multipart/writer_test.go.html#7775019">b</a></span><span class="op" id="7775394">,</span>&nbsp;<span class="ident" id="7775396"><a href="/gostd/mime/multipart/writer_test.go.html#7775299">got</a></span><span class="op" id="7775399">,</span>&nbsp;<span class="ident" id="7775401"><a href="/gostd/mime/multipart/writer_test.go.html#7775270">err</a></span><span class="op" id="7775404">,</span>&nbsp;<span class="ident" id="7775406"><a href="/gostd/mime/multipart/writer_test.go.html#7775248">tt</a></span><span class="op" id="7775408">.</span><span class="ident" id="7775409"><a href="/gostd/mime/multipart/writer_test.go.html#7775031">ok</a></span><span class="op" id="7775411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775415">}</span>&nbsp;<span class="keyword" id="7775417">else</span>&nbsp;<span class="keyword" id="7775422">if</span>&nbsp;<span class="ident" id="7775425"><a href="/gostd/mime/multipart/writer_test.go.html#7775248">tt</a></span><span class="op" id="7775427">.</span><span class="ident" id="7775428"><a href="/gostd/mime/multipart/writer_test.go.html#7775031">ok</a></span>&nbsp;<span class="op" id="7775431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775436">got</span>&nbsp;<span class="op" id="7775440">:=</span>&nbsp;<span class="ident" id="7775443"><a href="/gostd/mime/multipart/writer_test.go.html#7774977">w</a></span><span class="op" id="7775444">.</span><span class="ident" id="7775445"><a href="/gostd/mime/multipart/writer.go.html#4324340">Boundary</a></span><span class="op" id="7775453">(</span><span class="op" id="7775454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7775459">if</span>&nbsp;<span class="ident" id="7775462"><a href="/gostd/mime/multipart/writer_test.go.html#7775436">got</a></span>&nbsp;<span class="op" id="7775466">!=</span>&nbsp;<span class="ident" id="7775469"><a href="/gostd/mime/multipart/writer_test.go.html#7775248">tt</a></span><span class="op" id="7775471">.</span><span class="ident" id="7775472"><a href="/gostd/mime/multipart/writer_test.go.html#7775019">b</a></span>&nbsp;<span class="op" id="7775474">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775480"><a href="/gostd/mime/multipart/writer_test.go.html#7774940">t</a></span><span class="op" id="7775481">.</span><span class="ident" id="7775482"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7775488">(</span><span class="string" id="7775489">&#34;boundary&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7775513">,</span>&nbsp;<span class="ident" id="7775515"><a href="/gostd/mime/multipart/writer_test.go.html#7775436">got</a></span><span class="op" id="7775518">,</span>&nbsp;<span class="ident" id="7775520"><a href="/gostd/mime/multipart/writer_test.go.html#7775248">tt</a></span><span class="op" id="7775522">.</span><span class="ident" id="7775523"><a href="/gostd/mime/multipart/writer_test.go.html#7775019">b</a></span><span class="op" id="7775524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775539"><a href="/gostd/mime/multipart/writer_test.go.html#7774977">w</a></span><span class="op" id="7775540">.</span><span class="ident" id="7775541"><a href="/gostd/mime/multipart/writer.go.html#4327790">Close</a></span><span class="op" id="7775546">(</span><span class="op" id="7775547">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7775550">if</span>&nbsp;<span class="ident" id="7775553">got</span>&nbsp;<span class="op" id="7775557">:=</span>&nbsp;<span class="ident" id="7775560"><a href="/gostd/mime/multipart/writer_test.go.html#7774961">b</a></span><span class="op" id="7775561">.</span><span class="ident" id="7775562"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="7775568">(</span><span class="op" id="7775569">)</span><span class="op" id="7775570">;</span>&nbsp;<span class="op" id="7775572">!</span><span class="ident" id="7775573"><a href="/gostd/mime/multipart/writer_test.go.html#7773340">strings</a></span><span class="op" id="7775580">.</span><span class="ident" id="7775581"><a href="/gostd/strings/strings.go.html#2968416">Contains</a></span><span class="op" id="7775589">(</span><span class="ident" id="7775590"><a href="/gostd/mime/multipart/writer_test.go.html#7775553">got</a></span><span class="op" id="7775593">,</span>&nbsp;<span class="string" id="7775595">&#34;\r\n--my-separator--\r\n&#34;</span><span class="op" id="7775621">)</span>&nbsp;<span class="op" id="7775623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775627"><a href="/gostd/mime/multipart/writer_test.go.html#7774940">t</a></span><span class="op" id="7775628">.</span><span class="ident" id="7775629"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7775635">(</span><span class="string" id="7775636">&#34;expected&nbsp;my-separator&nbsp;in&nbsp;output.&nbsp;got:&nbsp;%q&#34;</span><span class="op" id="7775678">,</span>&nbsp;<span class="ident" id="7775680"><a href="/gostd/mime/multipart/writer_test.go.html#7775553">got</a></span><span class="op" id="7775683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775686">}</span><br>
<span class="lineno"></span><span class="op" id="7775688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="7775691">func</span>&nbsp;<span class="ident" id="7775696">TestWriterBoundaryGoroutines</span><span class="op" id="7775724">(</span><span class="ident" id="7775725">t</span>&nbsp;<span class="op" id="7775727">*</span><span class="ident" id="7775728"><a href="/gostd/mime/multipart/writer_test.go.html#7773351">testing</a></span><span class="op" id="7775735">.</span><span class="ident" id="7775736"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7775737">)</span>&nbsp;<span class="op" id="7775739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7775742">//&nbsp;Verify&nbsp;there&#39;s&nbsp;no&nbsp;data&nbsp;race&nbsp;accessing&nbsp;any&nbsp;lazy&nbsp;boundary&nbsp;if&nbsp;it&#39;s&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7775818">//&nbsp;different&nbsp;goroutines.&nbsp;This&nbsp;was&nbsp;previously&nbsp;broken&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7775874">//&nbsp;https://codereview.appspot.com/95760043/&nbsp;and&nbsp;reverted&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7775935">//&nbsp;https://codereview.appspot.com/117600043/</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775981">w</span>&nbsp;<span class="op" id="7775983">:=</span>&nbsp;<span class="ident" id="7775986"><a href="/gostd/mime/multipart/writer.go.html#4324179">NewWriter</a></span><span class="op" id="7775995">(</span><span class="ident" id="7775996"><a href="/gostd/mime/multipart/writer_test.go.html#7773327">ioutil</a></span><span class="op" id="7776002">.</span><span class="ident" id="7776003"><a href="/gostd/io/ioutil/ioutil.go.html#3768458">Discard</a></span><span class="op" id="7776010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7776013">done</span>&nbsp;<span class="op" id="7776018">:=</span>&nbsp;<span class="builtinfunc" id="7776021">make</span><span class="op" id="7776025">(</span><span class="keyword" id="7776026">chan</span>&nbsp;<span class="builtintype" id="7776031">int</span><span class="op" id="7776034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7776037">go</span>&nbsp;<span class="keyword" id="7776040">func</span><span class="op" id="7776044">(</span><span class="op" id="7776045">)</span>&nbsp;<span class="op" id="7776047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7776051"><a href="/gostd/mime/multipart/writer_test.go.html#7775981">w</a></span><span class="op" id="7776052">.</span><span class="ident" id="7776053"><a href="/gostd/mime/multipart/writer.go.html#4327213">CreateFormField</a></span><span class="op" id="7776068">(</span><span class="string" id="7776069">&#34;foo&#34;</span><span class="op" id="7776074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7776078"><a href="/gostd/mime/multipart/writer_test.go.html#7776013">done</a></span>&nbsp;<span class="op" id="7776083">&lt;-</span>&nbsp;<span class="num" id="7776086">1</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7776089">}</span><span class="op" id="7776090">(</span><span class="op" id="7776091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7776094"><a href="/gostd/mime/multipart/writer_test.go.html#7775981">w</a></span><span class="op" id="7776095">.</span><span class="ident" id="7776096"><a href="/gostd/mime/multipart/writer.go.html#4324340">Boundary</a></span><span class="op" id="7776104">(</span><span class="op" id="7776105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7776108">&lt;-</span><span class="ident" id="7776110"><a href="/gostd/mime/multipart/writer_test.go.html#7776013">done</a></span><br>
<span class="lineno"></span><span class="op" id="7776115">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
