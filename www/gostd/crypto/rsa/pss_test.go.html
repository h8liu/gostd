<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7849297">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7849352">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7849406">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7849457">package</span>&nbsp;<span class="ident" id="7849465">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7849470">import</span>&nbsp;<span class="op" id="7849477">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7849480">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7849489">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7849498">&#34;compress/bzip2&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7849516">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7849526">_</span>&nbsp;<span class="string" id="7849528">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7849542">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7849557">&#34;crypto/sha1&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7849572">_</span>&nbsp;<span class="string" id="7849574">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7849591">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7849607">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7849619">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7849625">&#34;strconv&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7849636">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7849647">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7849657">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7849660">func</span>&nbsp;<span class="ident" id="7849665">TestEMSAPSS</span><span class="op" id="7849676">(</span><span class="ident" id="7849677">t</span>&nbsp;<span class="op" id="7849679">*</span><span class="ident" id="7849680">testing</span><span class="op" id="7849687">.</span><span class="ident" id="7849688">T</span><span class="op" id="7849689">)</span>&nbsp;<span class="op" id="7849691">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7849694">//&nbsp;Test&nbsp;vector&nbsp;in&nbsp;file&nbsp;pss-int.txt&nbsp;from:&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7849797">msg</span>&nbsp;<span class="op" id="7849801">:=</span>&nbsp;<span class="op" id="7849804">[</span><span class="op" id="7849805">]</span><span class="builtintype" id="7849806">byte</span><span class="op" id="7849810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7849814">0x85</span><span class="op" id="7849818">,</span>&nbsp;<span class="num" id="7849820">0x9e</span><span class="op" id="7849824">,</span>&nbsp;<span class="num" id="7849826">0xef</span><span class="op" id="7849830">,</span>&nbsp;<span class="num" id="7849832">0x2f</span><span class="op" id="7849836">,</span>&nbsp;<span class="num" id="7849838">0xd7</span><span class="op" id="7849842">,</span>&nbsp;<span class="num" id="7849844">0x8a</span><span class="op" id="7849848">,</span>&nbsp;<span class="num" id="7849850">0xca</span><span class="op" id="7849854">,</span>&nbsp;<span class="num" id="7849856">0x00</span><span class="op" id="7849860">,</span>&nbsp;<span class="num" id="7849862">0x30</span><span class="op" id="7849866">,</span>&nbsp;<span class="num" id="7849868">0x8b</span><span class="op" id="7849872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7849876">0xdc</span><span class="op" id="7849880">,</span>&nbsp;<span class="num" id="7849882">0x47</span><span class="op" id="7849886">,</span>&nbsp;<span class="num" id="7849888">0x11</span><span class="op" id="7849892">,</span>&nbsp;<span class="num" id="7849894">0x93</span><span class="op" id="7849898">,</span>&nbsp;<span class="num" id="7849900">0xbf</span><span class="op" id="7849904">,</span>&nbsp;<span class="num" id="7849906">0x55</span><span class="op" id="7849910">,</span>&nbsp;<span class="num" id="7849912">0xbf</span><span class="op" id="7849916">,</span>&nbsp;<span class="num" id="7849918">0x9d</span><span class="op" id="7849922">,</span>&nbsp;<span class="num" id="7849924">0x78</span><span class="op" id="7849928">,</span>&nbsp;<span class="num" id="7849930">0xdb</span><span class="op" id="7849934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7849938">0x8f</span><span class="op" id="7849942">,</span>&nbsp;<span class="num" id="7849944">0x8a</span><span class="op" id="7849948">,</span>&nbsp;<span class="num" id="7849950">0x67</span><span class="op" id="7849954">,</span>&nbsp;<span class="num" id="7849956">0x2b</span><span class="op" id="7849960">,</span>&nbsp;<span class="num" id="7849962">0x48</span><span class="op" id="7849966">,</span>&nbsp;<span class="num" id="7849968">0x46</span><span class="op" id="7849972">,</span>&nbsp;<span class="num" id="7849974">0x34</span><span class="op" id="7849978">,</span>&nbsp;<span class="num" id="7849980">0xf3</span><span class="op" id="7849984">,</span>&nbsp;<span class="num" id="7849986">0xc9</span><span class="op" id="7849990">,</span>&nbsp;<span class="num" id="7849992">0xc2</span><span class="op" id="7849996">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7850000">0x6e</span><span class="op" id="7850004">,</span>&nbsp;<span class="num" id="7850006">0x64</span><span class="op" id="7850010">,</span>&nbsp;<span class="num" id="7850012">0x78</span><span class="op" id="7850016">,</span>&nbsp;<span class="num" id="7850018">0xae</span><span class="op" id="7850022">,</span>&nbsp;<span class="num" id="7850024">0x10</span><span class="op" id="7850028">,</span>&nbsp;<span class="num" id="7850030">0x26</span><span class="op" id="7850034">,</span>&nbsp;<span class="num" id="7850036">0x0f</span><span class="op" id="7850040">,</span>&nbsp;<span class="num" id="7850042">0xe0</span><span class="op" id="7850046">,</span>&nbsp;<span class="num" id="7850048">0xdd</span><span class="op" id="7850052">,</span>&nbsp;<span class="num" id="7850054">0x8c</span><span class="op" id="7850058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7850062">0x08</span><span class="op" id="7850066">,</span>&nbsp;<span class="num" id="7850068">0x2e</span><span class="op" id="7850072">,</span>&nbsp;<span class="num" id="7850074">0x53</span><span class="op" id="7850078">,</span>&nbsp;<span class="num" id="7850080">0xa5</span><span class="op" id="7850084">,</span>&nbsp;<span class="num" id="7850086">0x29</span><span class="op" id="7850090">,</span>&nbsp;<span class="num" id="7850092">0x3a</span><span class="op" id="7850096">,</span>&nbsp;<span class="num" id="7850098">0xf2</span><span class="op" id="7850102">,</span>&nbsp;<span class="num" id="7850104">0x17</span><span class="op" id="7850108">,</span>&nbsp;<span class="num" id="7850110">0x3c</span><span class="op" id="7850114">,</span>&nbsp;<span class="num" id="7850116">0xd5</span><span class="op" id="7850120">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7850124">0x0c</span><span class="op" id="7850128">,</span>&nbsp;<span class="num" id="7850130">0x6d</span><span class="op" id="7850134">,</span>&nbsp;<span class="num" id="7850136">0x5d</span><span class="op" id="7850140">,</span>&nbsp;<span class="num" id="7850142">0x35</span><span class="op" id="7850146">,</span>&nbsp;<span class="num" id="7850148">0x4f</span><span class="op" id="7850152">,</span>&nbsp;<span class="num" id="7850154">0xeb</span><span class="op" id="7850158">,</span>&nbsp;<span class="num" id="7850160">0xf7</span><span class="op" id="7850164">,</span>&nbsp;<span class="num" id="7850166">0x8b</span><span class="op" id="7850170">,</span>&nbsp;<span class="num" id="7850172">0x26</span><span class="op" id="7850176">,</span>&nbsp;<span class="num" id="7850178">0x02</span><span class="op" id="7850182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7850186">0x1c</span><span class="op" id="7850190">,</span>&nbsp;<span class="num" id="7850192">0x25</span><span class="op" id="7850196">,</span>&nbsp;<span class="num" id="7850198">0xc0</span><span class="op" id="7850202">,</span>&nbsp;<span class="num" id="7850204">0x27</span><span class="op" id="7850208">,</span>&nbsp;<span class="num" id="7850210">0x12</span><span class="op" id="7850214">,</span>&nbsp;<span class="num" id="7850216">0xe7</span><span class="op" id="7850220">,</span>&nbsp;<span class="num" id="7850222">0x8c</span><span class="op" id="7850226">,</span>&nbsp;<span class="num" id="7850228">0xd4</span><span class="op" id="7850232">,</span>&nbsp;<span class="num" id="7850234">0x69</span><span class="op" id="7850238">,</span>&nbsp;<span class="num" id="7850240">0x4c</span><span class="op" id="7850244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7850248">0x9f</span><span class="op" id="7850252">,</span>&nbsp;<span class="num" id="7850254">0x46</span><span class="op" id="7850258">,</span>&nbsp;<span class="num" id="7850260">0x97</span><span class="op" id="7850264">,</span>&nbsp;<span class="num" id="7850266">0x77</span><span class="op" id="7850270">,</span>&nbsp;<span class="num" id="7850272">0xe4</span><span class="op" id="7850276">,</span>&nbsp;<span class="num" id="7850278">0x51</span><span class="op" id="7850282">,</span>&nbsp;<span class="num" id="7850284">0xe7</span><span class="op" id="7850288">,</span>&nbsp;<span class="num" id="7850290">0xf8</span><span class="op" id="7850294">,</span>&nbsp;<span class="num" id="7850296">0xe9</span><span class="op" id="7850300">,</span>&nbsp;<span class="num" id="7850302">0xe0</span><span class="op" id="7850306">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7850310">0x4c</span><span class="op" id="7850314">,</span>&nbsp;<span class="num" id="7850316">0xd3</span><span class="op" id="7850320">,</span>&nbsp;<span class="num" id="7850322">0x73</span><span class="op" id="7850326">,</span>&nbsp;<span class="num" id="7850328">0x9c</span><span class="op" id="7850332">,</span>&nbsp;<span class="num" id="7850334">0x6b</span><span class="op" id="7850338">,</span>&nbsp;<span class="num" id="7850340">0xbf</span><span class="op" id="7850344">,</span>&nbsp;<span class="num" id="7850346">0xed</span><span class="op" id="7850350">,</span>&nbsp;<span class="num" id="7850352">0xae</span><span class="op" id="7850356">,</span>&nbsp;<span class="num" id="7850358">0x48</span><span class="op" id="7850362">,</span>&nbsp;<span class="num" id="7850364">0x7f</span><span class="op" id="7850368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7850372">0xb5</span><span class="op" id="7850376">,</span>&nbsp;<span class="num" id="7850378">0x56</span><span class="op" id="7850382">,</span>&nbsp;<span class="num" id="7850384">0x44</span><span class="op" id="7850388">,</span>&nbsp;<span class="num" id="7850390">0xe9</span><span class="op" id="7850394">,</span>&nbsp;<span class="num" id="7850396">0xca</span><span class="op" id="7850400">,</span>&nbsp;<span class="num" id="7850402">0x74</span><span class="op" id="7850406">,</span>&nbsp;<span class="num" id="7850408">0xff</span><span class="op" id="7850412">,</span>&nbsp;<span class="num" id="7850414">0x77</span><span class="op" id="7850418">,</span>&nbsp;<span class="num" id="7850420">0xa5</span><span class="op" id="7850424">,</span>&nbsp;<span class="num" id="7850426">0x3c</span><span class="op" id="7850430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7850434">0xb7</span><span class="op" id="7850438">,</span>&nbsp;<span class="num" id="7850440">0x29</span><span class="op" id="7850444">,</span>&nbsp;<span class="num" id="7850446">0x80</span><span class="op" id="7850450">,</span>&nbsp;<span class="num" id="7850452">0x2f</span><span class="op" id="7850456">,</span>&nbsp;<span class="num" id="7850458">0x6e</span><span class="op" id="7850462">,</span>&nbsp;<span class="num" id="7850464">0xd4</span><span class="op" id="7850468">,</span>&nbsp;<span class="num" id="7850470">0xa5</span><span class="op" id="7850474">,</span>&nbsp;<span class="num" id="7850476">0xff</span><span class="op" id="7850480">,</span>&nbsp;<span class="num" id="7850482">0xa8</span><span class="op" id="7850486">,</span>&nbsp;<span class="num" id="7850488">0xba</span><span class="op" id="7850492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7850496">0x15</span><span class="op" id="7850500">,</span>&nbsp;<span class="num" id="7850502">0x98</span><span class="op" id="7850506">,</span>&nbsp;<span class="num" id="7850508">0x90</span><span class="op" id="7850512">,</span>&nbsp;<span class="num" id="7850514">0xfc</span><span class="op" id="7850518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7850521">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7850524">salt</span>&nbsp;<span class="op" id="7850529">:=</span>&nbsp;<span class="op" id="7850532">[</span><span class="op" id="7850533">]</span><span class="builtintype" id="7850534">byte</span><span class="op" id="7850538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7850542">0xe3</span><span class="op" id="7850546">,</span>&nbsp;<span class="num" id="7850548">0xb5</span><span class="op" id="7850552">,</span>&nbsp;<span class="num" id="7850554">0xd5</span><span class="op" id="7850558">,</span>&nbsp;<span class="num" id="7850560">0xd0</span><span class="op" id="7850564">,</span>&nbsp;<span class="num" id="7850566">0x02</span><span class="op" id="7850570">,</span>&nbsp;<span class="num" id="7850572">0xc1</span><span class="op" id="7850576">,</span>&nbsp;<span class="num" id="7850578">0xbc</span><span class="op" id="7850582">,</span>&nbsp;<span class="num" id="7850584">0xe5</span><span class="op" id="7850588">,</span>&nbsp;<span class="num" id="7850590">0x0c</span><span class="op" id="7850594">,</span>&nbsp;<span class="num" id="7850596">0x2b</span><span class="op" id="7850600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7850604">0x65</span><span class="op" id="7850608">,</span>&nbsp;<span class="num" id="7850610">0xef</span><span class="op" id="7850614">,</span>&nbsp;<span class="num" id="7850616">0x88</span><span class="op" id="7850620">,</span>&nbsp;<span class="num" id="7850622">0xa1</span><span class="op" id="7850626">,</span>&nbsp;<span class="num" id="7850628">0x88</span><span class="op" id="7850632">,</span>&nbsp;<span class="num" id="7850634">0xd8</span><span class="op" id="7850638">,</span>&nbsp;<span class="num" id="7850640">0x3b</span><span class="op" id="7850644">,</span>&nbsp;<span class="num" id="7850646">0xce</span><span class="op" id="7850650">,</span>&nbsp;<span class="num" id="7850652">0x7e</span><span class="op" id="7850656">,</span>&nbsp;<span class="num" id="7850658">0x61</span><span class="op" id="7850662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7850665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7850668">expected</span>&nbsp;<span class="op" id="7850677">:=</span>&nbsp;<span class="op" id="7850680">[</span><span class="op" id="7850681">]</span><span class="builtintype" id="7850682">byte</span><span class="op" id="7850686">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7850690">0x66</span><span class="op" id="7850694">,</span>&nbsp;<span class="num" id="7850696">0xe4</span><span class="op" id="7850700">,</span>&nbsp;<span class="num" id="7850702">0x67</span><span class="op" id="7850706">,</span>&nbsp;<span class="num" id="7850708">0x2e</span><span class="op" id="7850712">,</span>&nbsp;<span class="num" id="7850714">0x83</span><span class="op" id="7850718">,</span>&nbsp;<span class="num" id="7850720">0x6a</span><span class="op" id="7850724">,</span>&nbsp;<span class="num" id="7850726">0xd1</span><span class="op" id="7850730">,</span>&nbsp;<span class="num" id="7850732">0x21</span><span class="op" id="7850736">,</span>&nbsp;<span class="num" id="7850738">0xba</span><span class="op" id="7850742">,</span>&nbsp;<span class="num" id="7850744">0x24</span><span class="op" id="7850748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7850752">0x4b</span><span class="op" id="7850756">,</span>&nbsp;<span class="num" id="7850758">0xed</span><span class="op" id="7850762">,</span>&nbsp;<span class="num" id="7850764">0x65</span><span class="op" id="7850768">,</span>&nbsp;<span class="num" id="7850770">0x76</span><span class="op" id="7850774">,</span>&nbsp;<span class="num" id="7850776">0xb8</span><span class="op" id="7850780">,</span>&nbsp;<span class="num" id="7850782">0x67</span><span class="op" id="7850786">,</span>&nbsp;<span class="num" id="7850788">0xd9</span><span class="op" id="7850792">,</span>&nbsp;<span class="num" id="7850794">0xa4</span><span class="op" id="7850798">,</span>&nbsp;<span class="num" id="7850800">0x47</span><span class="op" id="7850804">,</span>&nbsp;<span class="num" id="7850806">0xc2</span><span class="op" id="7850810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7850814">0x8a</span><span class="op" id="7850818">,</span>&nbsp;<span class="num" id="7850820">0x6e</span><span class="op" id="7850824">,</span>&nbsp;<span class="num" id="7850826">0x66</span><span class="op" id="7850830">,</span>&nbsp;<span class="num" id="7850832">0xa5</span><span class="op" id="7850836">,</span>&nbsp;<span class="num" id="7850838">0xb8</span><span class="op" id="7850842">,</span>&nbsp;<span class="num" id="7850844">0x7d</span><span class="op" id="7850848">,</span>&nbsp;<span class="num" id="7850850">0xee</span><span class="op" id="7850854">,</span>&nbsp;<span class="num" id="7850856">0x7f</span><span class="op" id="7850860">,</span>&nbsp;<span class="num" id="7850862">0xbc</span><span class="op" id="7850866">,</span>&nbsp;<span class="num" id="7850868">0x7e</span><span class="op" id="7850872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7850876">0x65</span><span class="op" id="7850880">,</span>&nbsp;<span class="num" id="7850882">0xaf</span><span class="op" id="7850886">,</span>&nbsp;<span class="num" id="7850888">0x50</span><span class="op" id="7850892">,</span>&nbsp;<span class="num" id="7850894">0x57</span><span class="op" id="7850898">,</span>&nbsp;<span class="num" id="7850900">0xf8</span><span class="op" id="7850904">,</span>&nbsp;<span class="num" id="7850906">0x6f</span><span class="op" id="7850910">,</span>&nbsp;<span class="num" id="7850912">0xae</span><span class="op" id="7850916">,</span>&nbsp;<span class="num" id="7850918">0x89</span><span class="op" id="7850922">,</span>&nbsp;<span class="num" id="7850924">0x84</span><span class="op" id="7850928">,</span>&nbsp;<span class="num" id="7850930">0xd9</span><span class="op" id="7850934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7850938">0xba</span><span class="op" id="7850942">,</span>&nbsp;<span class="num" id="7850944">0x7f</span><span class="op" id="7850948">,</span>&nbsp;<span class="num" id="7850950">0x96</span><span class="op" id="7850954">,</span>&nbsp;<span class="num" id="7850956">0x9a</span><span class="op" id="7850960">,</span>&nbsp;<span class="num" id="7850962">0xd6</span><span class="op" id="7850966">,</span>&nbsp;<span class="num" id="7850968">0xfe</span><span class="op" id="7850972">,</span>&nbsp;<span class="num" id="7850974">0x02</span><span class="op" id="7850978">,</span>&nbsp;<span class="num" id="7850980">0xa4</span><span class="op" id="7850984">,</span>&nbsp;<span class="num" id="7850986">0xd7</span><span class="op" id="7850990">,</span>&nbsp;<span class="num" id="7850992">0x5f</span><span class="op" id="7850996">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7851000">0x74</span><span class="op" id="7851004">,</span>&nbsp;<span class="num" id="7851006">0x45</span><span class="op" id="7851010">,</span>&nbsp;<span class="num" id="7851012">0xfe</span><span class="op" id="7851016">,</span>&nbsp;<span class="num" id="7851018">0xfd</span><span class="op" id="7851022">,</span>&nbsp;<span class="num" id="7851024">0xd8</span><span class="op" id="7851028">,</span>&nbsp;<span class="num" id="7851030">0x5b</span><span class="op" id="7851034">,</span>&nbsp;<span class="num" id="7851036">0x6d</span><span class="op" id="7851040">,</span>&nbsp;<span class="num" id="7851042">0x3a</span><span class="op" id="7851046">,</span>&nbsp;<span class="num" id="7851048">0x47</span><span class="op" id="7851052">,</span>&nbsp;<span class="num" id="7851054">0x7c</span><span class="op" id="7851058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7851062">0x28</span><span class="op" id="7851066">,</span>&nbsp;<span class="num" id="7851068">0xd2</span><span class="op" id="7851072">,</span>&nbsp;<span class="num" id="7851074">0x4b</span><span class="op" id="7851078">,</span>&nbsp;<span class="num" id="7851080">0xa1</span><span class="op" id="7851084">,</span>&nbsp;<span class="num" id="7851086">0xe3</span><span class="op" id="7851090">,</span>&nbsp;<span class="num" id="7851092">0x75</span><span class="op" id="7851096">,</span>&nbsp;<span class="num" id="7851098">0x6f</span><span class="op" id="7851102">,</span>&nbsp;<span class="num" id="7851104">0x79</span><span class="op" id="7851108">,</span>&nbsp;<span class="num" id="7851110">0x2d</span><span class="op" id="7851114">,</span>&nbsp;<span class="num" id="7851116">0xd1</span><span class="op" id="7851120">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7851124">0xdc</span><span class="op" id="7851128">,</span>&nbsp;<span class="num" id="7851130">0xe8</span><span class="op" id="7851134">,</span>&nbsp;<span class="num" id="7851136">0xca</span><span class="op" id="7851140">,</span>&nbsp;<span class="num" id="7851142">0x94</span><span class="op" id="7851146">,</span>&nbsp;<span class="num" id="7851148">0x44</span><span class="op" id="7851152">,</span>&nbsp;<span class="num" id="7851154">0x0e</span><span class="op" id="7851158">,</span>&nbsp;<span class="num" id="7851160">0xcb</span><span class="op" id="7851164">,</span>&nbsp;<span class="num" id="7851166">0x52</span><span class="op" id="7851170">,</span>&nbsp;<span class="num" id="7851172">0x79</span><span class="op" id="7851176">,</span>&nbsp;<span class="num" id="7851178">0xec</span><span class="op" id="7851182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7851186">0xd3</span><span class="op" id="7851190">,</span>&nbsp;<span class="num" id="7851192">0x18</span><span class="op" id="7851196">,</span>&nbsp;<span class="num" id="7851198">0x3a</span><span class="op" id="7851202">,</span>&nbsp;<span class="num" id="7851204">0x31</span><span class="op" id="7851208">,</span>&nbsp;<span class="num" id="7851210">0x1f</span><span class="op" id="7851214">,</span>&nbsp;<span class="num" id="7851216">0xc8</span><span class="op" id="7851220">,</span>&nbsp;<span class="num" id="7851222">0x96</span><span class="op" id="7851226">,</span>&nbsp;<span class="num" id="7851228">0xda</span><span class="op" id="7851232">,</span>&nbsp;<span class="num" id="7851234">0x1c</span><span class="op" id="7851238">,</span>&nbsp;<span class="num" id="7851240">0xb3</span><span class="op" id="7851244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7851248">0x93</span><span class="op" id="7851252">,</span>&nbsp;<span class="num" id="7851254">0x11</span><span class="op" id="7851258">,</span>&nbsp;<span class="num" id="7851260">0xaf</span><span class="op" id="7851264">,</span>&nbsp;<span class="num" id="7851266">0x37</span><span class="op" id="7851270">,</span>&nbsp;<span class="num" id="7851272">0xea</span><span class="op" id="7851276">,</span>&nbsp;<span class="num" id="7851278">0x4a</span><span class="op" id="7851282">,</span>&nbsp;<span class="num" id="7851284">0x75</span><span class="op" id="7851288">,</span>&nbsp;<span class="num" id="7851290">0xe2</span><span class="op" id="7851294">,</span>&nbsp;<span class="num" id="7851296">0x4b</span><span class="op" id="7851300">,</span>&nbsp;<span class="num" id="7851302">0xdb</span><span class="op" id="7851306">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7851310">0xfd</span><span class="op" id="7851314">,</span>&nbsp;<span class="num" id="7851316">0x5c</span><span class="op" id="7851320">,</span>&nbsp;<span class="num" id="7851322">0x1d</span><span class="op" id="7851326">,</span>&nbsp;<span class="num" id="7851328">0xa0</span><span class="op" id="7851332">,</span>&nbsp;<span class="num" id="7851334">0xde</span><span class="op" id="7851338">,</span>&nbsp;<span class="num" id="7851340">0x7c</span><span class="op" id="7851344">,</span>&nbsp;<span class="num" id="7851346">0xec</span><span class="op" id="7851350">,</span>&nbsp;<span class="num" id="7851352">0xdf</span><span class="op" id="7851356">,</span>&nbsp;<span class="num" id="7851358">0x1a</span><span class="op" id="7851362">,</span>&nbsp;<span class="num" id="7851364">0x89</span><span class="op" id="7851368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7851372">0x6f</span><span class="op" id="7851376">,</span>&nbsp;<span class="num" id="7851378">0x9d</span><span class="op" id="7851382">,</span>&nbsp;<span class="num" id="7851384">0x8b</span><span class="op" id="7851388">,</span>&nbsp;<span class="num" id="7851390">0xc8</span><span class="op" id="7851394">,</span>&nbsp;<span class="num" id="7851396">0x16</span><span class="op" id="7851400">,</span>&nbsp;<span class="num" id="7851402">0xd9</span><span class="op" id="7851406">,</span>&nbsp;<span class="num" id="7851408">0x7c</span><span class="op" id="7851412">,</span>&nbsp;<span class="num" id="7851414">0xd7</span><span class="op" id="7851418">,</span>&nbsp;<span class="num" id="7851420">0xa2</span><span class="op" id="7851424">,</span>&nbsp;<span class="num" id="7851426">0xc4</span><span class="op" id="7851430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7851434">0x3b</span><span class="op" id="7851438">,</span>&nbsp;<span class="num" id="7851440">0xad</span><span class="op" id="7851444">,</span>&nbsp;<span class="num" id="7851446">0x54</span><span class="op" id="7851450">,</span>&nbsp;<span class="num" id="7851452">0x6f</span><span class="op" id="7851456">,</span>&nbsp;<span class="num" id="7851458">0xbe</span><span class="op" id="7851462">,</span>&nbsp;<span class="num" id="7851464">0x8c</span><span class="op" id="7851468">,</span>&nbsp;<span class="num" id="7851470">0xfe</span><span class="op" id="7851474">,</span>&nbsp;<span class="num" id="7851476">0xbc</span><span class="op" id="7851480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7851483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7851487">hash</span>&nbsp;<span class="op" id="7851492">:=</span>&nbsp;<span class="ident" id="7851495">sha1</span><span class="op" id="7851499">.</span><span class="ident" id="7851500">New</span><span class="op" id="7851503">(</span><span class="op" id="7851504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7851507">hash</span><span class="op" id="7851511">.</span><span class="ident" id="7851512">Write</span><span class="op" id="7851517">(</span><span class="ident" id="7851518">msg</span><span class="op" id="7851521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7851524">hashed</span>&nbsp;<span class="op" id="7851531">:=</span>&nbsp;<span class="ident" id="7851534">hash</span><span class="op" id="7851538">.</span><span class="ident" id="7851539">Sum</span><span class="op" id="7851542">(</span><span class="ident" id="7851543">nil</span><span class="op" id="7851546">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7851550">encoded</span><span class="op" id="7851557">,</span>&nbsp;<span class="ident" id="7851559">err</span>&nbsp;<span class="op" id="7851563">:=</span>&nbsp;<span class="ident" id="7851566">emsaPSSEncode</span><span class="op" id="7851579">(</span><span class="ident" id="7851580">hashed</span><span class="op" id="7851586">,</span>&nbsp;<span class="num" id="7851588">1023</span><span class="op" id="7851592">,</span>&nbsp;<span class="ident" id="7851594">salt</span><span class="op" id="7851598">,</span>&nbsp;<span class="ident" id="7851600">sha1</span><span class="op" id="7851604">.</span><span class="ident" id="7851605">New</span><span class="op" id="7851608">(</span><span class="op" id="7851609">)</span><span class="op" id="7851610">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7851613">if</span>&nbsp;<span class="ident" id="7851616">err</span>&nbsp;<span class="op" id="7851620">!=</span>&nbsp;<span class="ident" id="7851623">nil</span>&nbsp;<span class="op" id="7851627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7851631">t</span><span class="op" id="7851632">.</span><span class="ident" id="7851633">Errorf</span><span class="op" id="7851639">(</span><span class="string" id="7851640">&#34;Error&nbsp;from&nbsp;emsaPSSEncode:&nbsp;%s\n&#34;</span><span class="op" id="7851672">,</span>&nbsp;<span class="ident" id="7851674">err</span><span class="op" id="7851677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7851680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7851683">if</span>&nbsp;<span class="op" id="7851686">!</span><span class="ident" id="7851687">bytes</span><span class="op" id="7851692">.</span><span class="ident" id="7851693">Equal</span><span class="op" id="7851698">(</span><span class="ident" id="7851699">encoded</span><span class="op" id="7851706">,</span>&nbsp;<span class="ident" id="7851708">expected</span><span class="op" id="7851716">)</span>&nbsp;<span class="op" id="7851718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7851722">t</span><span class="op" id="7851723">.</span><span class="ident" id="7851724">Errorf</span><span class="op" id="7851730">(</span><span class="string" id="7851731">&#34;Bad&nbsp;encoding.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7851762">,</span>&nbsp;<span class="ident" id="7851764">encoded</span><span class="op" id="7851771">,</span>&nbsp;<span class="ident" id="7851773">expected</span><span class="op" id="7851781">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7851784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7851788">if</span>&nbsp;<span class="ident" id="7851791">err</span>&nbsp;<span class="op" id="7851795">=</span>&nbsp;<span class="ident" id="7851797">emsaPSSVerify</span><span class="op" id="7851810">(</span><span class="ident" id="7851811">hashed</span><span class="op" id="7851817">,</span>&nbsp;<span class="ident" id="7851819">encoded</span><span class="op" id="7851826">,</span>&nbsp;<span class="num" id="7851828">1023</span><span class="op" id="7851832">,</span>&nbsp;<span class="builtinfunc" id="7851834">len</span><span class="op" id="7851837">(</span><span class="ident" id="7851838">salt</span><span class="op" id="7851842">)</span><span class="op" id="7851843">,</span>&nbsp;<span class="ident" id="7851845">sha1</span><span class="op" id="7851849">.</span><span class="ident" id="7851850">New</span><span class="op" id="7851853">(</span><span class="op" id="7851854">)</span><span class="op" id="7851855">)</span><span class="op" id="7851856">;</span>&nbsp;<span class="ident" id="7851858">err</span>&nbsp;<span class="op" id="7851862">!=</span>&nbsp;<span class="ident" id="7851865">nil</span>&nbsp;<span class="op" id="7851869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7851873">t</span><span class="op" id="7851874">.</span><span class="ident" id="7851875">Errorf</span><span class="op" id="7851881">(</span><span class="string" id="7851882">&#34;Bad&nbsp;verification:&nbsp;%s&#34;</span><span class="op" id="7851904">,</span>&nbsp;<span class="ident" id="7851906">err</span><span class="op" id="7851909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7851912">}</span><br>
<span class="lineno">75</span><span class="op" id="7851914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7851917">//&nbsp;TestPSSGolden&nbsp;tests&nbsp;all&nbsp;the&nbsp;test&nbsp;vectors&nbsp;in&nbsp;pss-vect.txt&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="7851982">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span><span class="keyword" id="7852046">func</span>&nbsp;<span class="ident" id="7852051">TestPSSGolden</span><span class="op" id="7852064">(</span><span class="ident" id="7852065">t</span>&nbsp;<span class="op" id="7852067">*</span><span class="ident" id="7852068">testing</span><span class="op" id="7852075">.</span><span class="ident" id="7852076">T</span><span class="op" id="7852077">)</span>&nbsp;<span class="op" id="7852079">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7852082">inFile</span><span class="op" id="7852088">,</span>&nbsp;<span class="ident" id="7852090">err</span>&nbsp;<span class="op" id="7852094">:=</span>&nbsp;<span class="ident" id="7852097">os</span><span class="op" id="7852099">.</span><span class="ident" id="7852100">Open</span><span class="op" id="7852104">(</span><span class="string" id="7852105">&#34;testdata/pss-vect.txt.bz2&#34;</span><span class="op" id="7852132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7852135">if</span>&nbsp;<span class="ident" id="7852138">err</span>&nbsp;<span class="op" id="7852142">!=</span>&nbsp;<span class="ident" id="7852145">nil</span>&nbsp;<span class="op" id="7852149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7852153">t</span><span class="op" id="7852154">.</span><span class="ident" id="7852155">Fatalf</span><span class="op" id="7852161">(</span><span class="string" id="7852162">&#34;Failed&nbsp;to&nbsp;open&nbsp;input&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="7852193">,</span>&nbsp;<span class="ident" id="7852195">err</span><span class="op" id="7852198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7852201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7852204">defer</span>&nbsp;<span class="ident" id="7852210">inFile</span><span class="op" id="7852216">.</span><span class="ident" id="7852217">Close</span><span class="op" id="7852222">(</span><span class="op" id="7852223">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7852227">//&nbsp;The&nbsp;pss-vect.txt&nbsp;file&nbsp;contains&nbsp;RSA&nbsp;keys&nbsp;and&nbsp;then&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7852292">//&nbsp;signatures.&nbsp;A&nbsp;goroutine&nbsp;is&nbsp;used&nbsp;to&nbsp;preprocess&nbsp;the&nbsp;input&nbsp;by&nbsp;merging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7852363">//&nbsp;lines,&nbsp;removing&nbsp;spaces&nbsp;in&nbsp;hex&nbsp;values&nbsp;and&nbsp;identifying&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7852433">//&nbsp;new&nbsp;keys&nbsp;and&nbsp;signature&nbsp;blocks.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7852468">const</span>&nbsp;<span class="ident" id="7852474">newKeyMarker</span>&nbsp;<span class="op" id="7852487">=</span>&nbsp;<span class="string" id="7852489">&#34;START&nbsp;NEW&nbsp;KEY&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7852506">const</span>&nbsp;<span class="ident" id="7852512">newSignatureMarker</span>&nbsp;<span class="op" id="7852531">=</span>&nbsp;<span class="string" id="7852533">&#34;START&nbsp;NEW&nbsp;SIGNATURE&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7852557">values</span>&nbsp;<span class="op" id="7852564">:=</span>&nbsp;<span class="builtinfunc" id="7852567">make</span><span class="op" id="7852571">(</span><span class="keyword" id="7852572">chan</span>&nbsp;<span class="builtintype" id="7852577">string</span><span class="op" id="7852583">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7852587">go</span>&nbsp;<span class="keyword" id="7852590">func</span><span class="op" id="7852594">(</span><span class="op" id="7852595">)</span>&nbsp;<span class="op" id="7852597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7852601">defer</span>&nbsp;<span class="builtinfunc" id="7852607">close</span><span class="op" id="7852612">(</span><span class="ident" id="7852613">values</span><span class="op" id="7852619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7852623">scanner</span>&nbsp;<span class="op" id="7852631">:=</span>&nbsp;<span class="ident" id="7852634">bufio</span><span class="op" id="7852639">.</span><span class="ident" id="7852640">NewScanner</span><span class="op" id="7852650">(</span><span class="ident" id="7852651">bzip2</span><span class="op" id="7852656">.</span><span class="ident" id="7852657">NewReader</span><span class="op" id="7852666">(</span><span class="ident" id="7852667">inFile</span><span class="op" id="7852673">)</span><span class="op" id="7852674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7852678">var</span>&nbsp;<span class="ident" id="7852682">partialValue</span>&nbsp;<span class="builtintype" id="7852695">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7852704">lastWasValue</span>&nbsp;<span class="op" id="7852717">:=</span>&nbsp;<span class="builtintype" id="7852720">true</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7852728">for</span>&nbsp;<span class="ident" id="7852732">scanner</span><span class="op" id="7852739">.</span><span class="ident" id="7852740">Scan</span><span class="op" id="7852744">(</span><span class="op" id="7852745">)</span>&nbsp;<span class="op" id="7852747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7852752">line</span>&nbsp;<span class="op" id="7852757">:=</span>&nbsp;<span class="ident" id="7852760">scanner</span><span class="op" id="7852767">.</span><span class="ident" id="7852768">Text</span><span class="op" id="7852772">(</span><span class="op" id="7852773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7852778">switch</span>&nbsp;<span class="op" id="7852785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7852790">case</span>&nbsp;<span class="builtinfunc" id="7852795">len</span><span class="op" id="7852798">(</span><span class="ident" id="7852799">line</span><span class="op" id="7852803">)</span>&nbsp;<span class="op" id="7852805">==</span>&nbsp;<span class="num" id="7852808">0</span><span class="op" id="7852809">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7852815">if</span>&nbsp;<span class="builtinfunc" id="7852818">len</span><span class="op" id="7852821">(</span><span class="ident" id="7852822">partialValue</span><span class="op" id="7852834">)</span>&nbsp;<span class="op" id="7852836">&gt;</span>&nbsp;<span class="num" id="7852838">0</span>&nbsp;<span class="op" id="7852840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7852847">values</span>&nbsp;<span class="op" id="7852854">&lt;-</span>&nbsp;<span class="ident" id="7852857">strings</span><span class="op" id="7852864">.</span><span class="ident" id="7852865">Replace</span><span class="op" id="7852872">(</span><span class="ident" id="7852873">partialValue</span><span class="op" id="7852885">,</span>&nbsp;<span class="string" id="7852887">&#34;&nbsp;&#34;</span><span class="op" id="7852890">,</span>&nbsp;<span class="string" id="7852892">&#34;&#34;</span><span class="op" id="7852894">,</span>&nbsp;<span class="op" id="7852896">-</span><span class="num" id="7852897">1</span><span class="op" id="7852898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7852905">partialValue</span>&nbsp;<span class="op" id="7852918">=</span>&nbsp;<span class="string" id="7852920">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7852928">lastWasValue</span>&nbsp;<span class="op" id="7852941">=</span>&nbsp;<span class="builtintype" id="7852943">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7852952">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7852958">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7852970">case</span>&nbsp;<span class="ident" id="7852975">strings</span><span class="op" id="7852982">.</span><span class="ident" id="7852983">HasPrefix</span><span class="op" id="7852992">(</span><span class="ident" id="7852993">line</span><span class="op" id="7852997">,</span>&nbsp;<span class="string" id="7852999">&#34;#&nbsp;======&#34;</span><span class="op" id="7853009">)</span>&nbsp;<span class="op" id="7853011">&amp;&amp;</span>&nbsp;<span class="ident" id="7853014">lastWasValue</span><span class="op" id="7853026">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853032">values</span>&nbsp;<span class="op" id="7853039">&lt;-</span>&nbsp;<span class="ident" id="7853042">newKeyMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853059">lastWasValue</span>&nbsp;<span class="op" id="7853072">=</span>&nbsp;<span class="builtintype" id="7853074">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7853083">case</span>&nbsp;<span class="ident" id="7853088">strings</span><span class="op" id="7853095">.</span><span class="ident" id="7853096">HasPrefix</span><span class="op" id="7853105">(</span><span class="ident" id="7853106">line</span><span class="op" id="7853110">,</span>&nbsp;<span class="string" id="7853112">&#34;#&nbsp;------&#34;</span><span class="op" id="7853122">)</span>&nbsp;<span class="op" id="7853124">&amp;&amp;</span>&nbsp;<span class="ident" id="7853127">lastWasValue</span><span class="op" id="7853139">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853145">values</span>&nbsp;<span class="op" id="7853152">&lt;-</span>&nbsp;<span class="ident" id="7853155">newSignatureMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853178">lastWasValue</span>&nbsp;<span class="op" id="7853191">=</span>&nbsp;<span class="builtintype" id="7853193">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7853202">case</span>&nbsp;<span class="ident" id="7853207">strings</span><span class="op" id="7853214">.</span><span class="ident" id="7853215">HasPrefix</span><span class="op" id="7853224">(</span><span class="ident" id="7853225">line</span><span class="op" id="7853229">,</span>&nbsp;<span class="string" id="7853231">&#34;#&#34;</span><span class="op" id="7853234">)</span><span class="op" id="7853235">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7853241">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7853253">default</span><span class="op" id="7853260">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853266">partialValue</span>&nbsp;<span class="op" id="7853279">+=</span>&nbsp;<span class="ident" id="7853282">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7853290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7853294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7853298">if</span>&nbsp;<span class="ident" id="7853301">err</span>&nbsp;<span class="op" id="7853305">:=</span>&nbsp;<span class="ident" id="7853308">scanner</span><span class="op" id="7853315">.</span><span class="ident" id="7853316">Err</span><span class="op" id="7853319">(</span><span class="op" id="7853320">)</span><span class="op" id="7853321">;</span>&nbsp;<span class="ident" id="7853323">err</span>&nbsp;<span class="op" id="7853327">!=</span>&nbsp;<span class="ident" id="7853330">nil</span>&nbsp;<span class="op" id="7853334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7853339">panic</span><span class="op" id="7853344">(</span><span class="ident" id="7853345">err</span><span class="op" id="7853348">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7853352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7853355">}</span><span class="op" id="7853356">(</span><span class="op" id="7853357">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7853361">var</span>&nbsp;<span class="ident" id="7853365">key</span>&nbsp;<span class="op" id="7853369">*</span><span class="ident" id="7853370">PublicKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7853381">var</span>&nbsp;<span class="ident" id="7853385">hashed</span>&nbsp;<span class="op" id="7853392">[</span><span class="op" id="7853393">]</span><span class="builtintype" id="7853394">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853400">hash</span>&nbsp;<span class="op" id="7853405">:=</span>&nbsp;<span class="ident" id="7853408">crypto</span><span class="op" id="7853414">.</span><span class="ident" id="7853415">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853421">h</span>&nbsp;<span class="op" id="7853423">:=</span>&nbsp;<span class="ident" id="7853426">hash</span><span class="op" id="7853430">.</span><span class="ident" id="7853431">New</span><span class="op" id="7853434">(</span><span class="op" id="7853435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853438">opts</span>&nbsp;<span class="op" id="7853443">:=</span>&nbsp;<span class="op" id="7853446">&amp;</span><span class="ident" id="7853447">PSSOptions</span><span class="op" id="7853457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853461">SaltLength</span><span class="op" id="7853471">:</span>&nbsp;<span class="ident" id="7853473">PSSSaltLengthEqualsHash</span><span class="op" id="7853496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7853499">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7853503">for</span>&nbsp;<span class="ident" id="7853507">marker</span>&nbsp;<span class="op" id="7853514">:=</span>&nbsp;<span class="keyword" id="7853517">range</span>&nbsp;<span class="ident" id="7853523">values</span>&nbsp;<span class="op" id="7853530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7853534">switch</span>&nbsp;<span class="ident" id="7853541">marker</span>&nbsp;<span class="op" id="7853548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7853552">case</span>&nbsp;<span class="ident" id="7853557">newKeyMarker</span><span class="op" id="7853569">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853574">key</span>&nbsp;<span class="op" id="7853578">=</span>&nbsp;<span class="builtinfunc" id="7853580">new</span><span class="op" id="7853583">(</span><span class="ident" id="7853584">PublicKey</span><span class="op" id="7853593">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853598">nHex</span><span class="op" id="7853602">,</span>&nbsp;<span class="ident" id="7853604">ok</span>&nbsp;<span class="op" id="7853607">:=</span>&nbsp;<span class="op" id="7853610">&lt;-</span><span class="ident" id="7853612">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7853622">if</span>&nbsp;<span class="op" id="7853625">!</span><span class="ident" id="7853626">ok</span>&nbsp;<span class="op" id="7853629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7853635">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7853647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853652">key</span><span class="op" id="7853655">.</span><span class="ident" id="7853656">N</span>&nbsp;<span class="op" id="7853658">=</span>&nbsp;<span class="ident" id="7853660">bigFromHex</span><span class="op" id="7853670">(</span><span class="ident" id="7853671">nHex</span><span class="op" id="7853675">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853680">key</span><span class="op" id="7853683">.</span><span class="ident" id="7853684">E</span>&nbsp;<span class="op" id="7853686">=</span>&nbsp;<span class="ident" id="7853688">intFromHex</span><span class="op" id="7853698">(</span><span class="op" id="7853699">&lt;-</span><span class="ident" id="7853701">values</span><span class="op" id="7853707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7853712">//&nbsp;We&nbsp;don&#39;t&nbsp;care&nbsp;for&nbsp;d,&nbsp;p,&nbsp;q,&nbsp;dP,&nbsp;dQ&nbsp;or&nbsp;qInv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7853761">for</span>&nbsp;<span class="ident" id="7853765">i</span>&nbsp;<span class="op" id="7853767">:=</span>&nbsp;<span class="num" id="7853770">0</span><span class="op" id="7853771">;</span>&nbsp;<span class="ident" id="7853773">i</span>&nbsp;<span class="op" id="7853775">&lt;</span>&nbsp;<span class="num" id="7853777">6</span><span class="op" id="7853778">;</span>&nbsp;<span class="ident" id="7853780">i</span><span class="op" id="7853781">++</span>&nbsp;<span class="op" id="7853784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7853790">&lt;-</span><span class="ident" id="7853792">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7853802">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7853806">case</span>&nbsp;<span class="ident" id="7853811">newSignatureMarker</span><span class="op" id="7853829">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853834">msg</span>&nbsp;<span class="op" id="7853838">:=</span>&nbsp;<span class="ident" id="7853841">fromHex</span><span class="op" id="7853848">(</span><span class="op" id="7853849">&lt;-</span><span class="ident" id="7853851">values</span><span class="op" id="7853857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7853862">&lt;-</span><span class="ident" id="7853864">values</span>&nbsp;<span class="comment" id="7853871">//&nbsp;skip&nbsp;salt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853887">sig</span>&nbsp;<span class="op" id="7853891">:=</span>&nbsp;<span class="ident" id="7853894">fromHex</span><span class="op" id="7853901">(</span><span class="op" id="7853902">&lt;-</span><span class="ident" id="7853904">values</span><span class="op" id="7853910">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853916">h</span><span class="op" id="7853917">.</span><span class="ident" id="7853918">Reset</span><span class="op" id="7853923">(</span><span class="op" id="7853924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853929">h</span><span class="op" id="7853930">.</span><span class="ident" id="7853931">Write</span><span class="op" id="7853936">(</span><span class="ident" id="7853937">msg</span><span class="op" id="7853940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7853945">hashed</span>&nbsp;<span class="op" id="7853952">=</span>&nbsp;<span class="ident" id="7853954">h</span><span class="op" id="7853955">.</span><span class="ident" id="7853956">Sum</span><span class="op" id="7853959">(</span><span class="ident" id="7853960">hashed</span><span class="op" id="7853966">[</span><span class="op" id="7853967">:</span><span class="num" id="7853968">0</span><span class="op" id="7853969">]</span><span class="op" id="7853970">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7853976">if</span>&nbsp;<span class="ident" id="7853979">err</span>&nbsp;<span class="op" id="7853983">:=</span>&nbsp;<span class="ident" id="7853986">VerifyPSS</span><span class="op" id="7853995">(</span><span class="ident" id="7853996">key</span><span class="op" id="7853999">,</span>&nbsp;<span class="ident" id="7854001">hash</span><span class="op" id="7854005">,</span>&nbsp;<span class="ident" id="7854007">hashed</span><span class="op" id="7854013">,</span>&nbsp;<span class="ident" id="7854015">sig</span><span class="op" id="7854018">,</span>&nbsp;<span class="ident" id="7854020">opts</span><span class="op" id="7854024">)</span><span class="op" id="7854025">;</span>&nbsp;<span class="ident" id="7854027">err</span>&nbsp;<span class="op" id="7854031">!=</span>&nbsp;<span class="ident" id="7854034">nil</span>&nbsp;<span class="op" id="7854038">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854044">t</span><span class="op" id="7854045">.</span><span class="ident" id="7854046">Error</span><span class="op" id="7854051">(</span><span class="ident" id="7854052">err</span><span class="op" id="7854055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7854060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7854064">default</span><span class="op" id="7854071">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854076">t</span><span class="op" id="7854077">.</span><span class="ident" id="7854078">Fatalf</span><span class="op" id="7854084">(</span><span class="string" id="7854085">&#34;unknown&nbsp;marker:&nbsp;&#34;</span>&nbsp;<span class="op" id="7854104">+</span>&nbsp;<span class="ident" id="7854106">marker</span><span class="op" id="7854112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7854116">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7854119">}</span><br>
<span class="lineno"></span><span class="op" id="7854121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7854124">//&nbsp;TestPSSOpenSSL&nbsp;ensures&nbsp;that&nbsp;we&nbsp;can&nbsp;verify&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;from&nbsp;OpenSSL&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="7854203">//&nbsp;the&nbsp;default&nbsp;options.&nbsp;OpenSSL&nbsp;sets&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;be&nbsp;maximal.</span><br>
<span class="lineno">170</span><span class="keyword" id="7854271">func</span>&nbsp;<span class="ident" id="7854276">TestPSSOpenSSL</span><span class="op" id="7854290">(</span><span class="ident" id="7854291">t</span>&nbsp;<span class="op" id="7854293">*</span><span class="ident" id="7854294">testing</span><span class="op" id="7854301">.</span><span class="ident" id="7854302">T</span><span class="op" id="7854303">)</span>&nbsp;<span class="op" id="7854305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854308">hash</span>&nbsp;<span class="op" id="7854313">:=</span>&nbsp;<span class="ident" id="7854316">crypto</span><span class="op" id="7854322">.</span><span class="ident" id="7854323">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854331">h</span>&nbsp;<span class="op" id="7854333">:=</span>&nbsp;<span class="ident" id="7854336">hash</span><span class="op" id="7854340">.</span><span class="ident" id="7854341">New</span><span class="op" id="7854344">(</span><span class="op" id="7854345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854348">h</span><span class="op" id="7854349">.</span><span class="ident" id="7854350">Write</span><span class="op" id="7854355">(</span><span class="op" id="7854356">[</span><span class="op" id="7854357">]</span><span class="builtintype" id="7854358">byte</span><span class="op" id="7854362">(</span><span class="string" id="7854363">&#34;testing&#34;</span><span class="op" id="7854372">)</span><span class="op" id="7854373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854376">hashed</span>&nbsp;<span class="op" id="7854383">:=</span>&nbsp;<span class="ident" id="7854386">h</span><span class="op" id="7854387">.</span><span class="ident" id="7854388">Sum</span><span class="op" id="7854391">(</span><span class="ident" id="7854392">nil</span><span class="op" id="7854395">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7854399">//&nbsp;Generated&nbsp;with&nbsp;`echo&nbsp;-n&nbsp;testing&nbsp;|&nbsp;openssl&nbsp;dgst&nbsp;-sign&nbsp;key.pem&nbsp;-sigopt&nbsp;rsa_padding_mode:pss&nbsp;-sha256&nbsp;&gt;&nbsp;sig`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854508">sig</span>&nbsp;<span class="op" id="7854512">:=</span>&nbsp;<span class="op" id="7854515">[</span><span class="op" id="7854516">]</span><span class="builtintype" id="7854517">byte</span><span class="op" id="7854521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7854525">0x95</span><span class="op" id="7854529">,</span>&nbsp;<span class="num" id="7854531">0x59</span><span class="op" id="7854535">,</span>&nbsp;<span class="num" id="7854537">0x6f</span><span class="op" id="7854541">,</span>&nbsp;<span class="num" id="7854543">0xd3</span><span class="op" id="7854547">,</span>&nbsp;<span class="num" id="7854549">0x10</span><span class="op" id="7854553">,</span>&nbsp;<span class="num" id="7854555">0xa2</span><span class="op" id="7854559">,</span>&nbsp;<span class="num" id="7854561">0xe7</span><span class="op" id="7854565">,</span>&nbsp;<span class="num" id="7854567">0xa2</span><span class="op" id="7854571">,</span>&nbsp;<span class="num" id="7854573">0x92</span><span class="op" id="7854577">,</span>&nbsp;<span class="num" id="7854579">0x9d</span><span class="op" id="7854583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7854587">0x4a</span><span class="op" id="7854591">,</span>&nbsp;<span class="num" id="7854593">0x07</span><span class="op" id="7854597">,</span>&nbsp;<span class="num" id="7854599">0x2e</span><span class="op" id="7854603">,</span>&nbsp;<span class="num" id="7854605">0x2b</span><span class="op" id="7854609">,</span>&nbsp;<span class="num" id="7854611">0x27</span><span class="op" id="7854615">,</span>&nbsp;<span class="num" id="7854617">0xcc</span><span class="op" id="7854621">,</span>&nbsp;<span class="num" id="7854623">0x06</span><span class="op" id="7854627">,</span>&nbsp;<span class="num" id="7854629">0xc2</span><span class="op" id="7854633">,</span>&nbsp;<span class="num" id="7854635">0x87</span><span class="op" id="7854639">,</span>&nbsp;<span class="num" id="7854641">0x2c</span><span class="op" id="7854645">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7854649">0x52</span><span class="op" id="7854653">,</span>&nbsp;<span class="num" id="7854655">0xf0</span><span class="op" id="7854659">,</span>&nbsp;<span class="num" id="7854661">0x4a</span><span class="op" id="7854665">,</span>&nbsp;<span class="num" id="7854667">0xcc</span><span class="op" id="7854671">,</span>&nbsp;<span class="num" id="7854673">0x05</span><span class="op" id="7854677">,</span>&nbsp;<span class="num" id="7854679">0x94</span><span class="op" id="7854683">,</span>&nbsp;<span class="num" id="7854685">0xf2</span><span class="op" id="7854689">,</span>&nbsp;<span class="num" id="7854691">0xc3</span><span class="op" id="7854695">,</span>&nbsp;<span class="num" id="7854697">0x2e</span><span class="op" id="7854701">,</span>&nbsp;<span class="num" id="7854703">0x20</span><span class="op" id="7854707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7854711">0xd7</span><span class="op" id="7854715">,</span>&nbsp;<span class="num" id="7854717">0x3e</span><span class="op" id="7854721">,</span>&nbsp;<span class="num" id="7854723">0x66</span><span class="op" id="7854727">,</span>&nbsp;<span class="num" id="7854729">0x62</span><span class="op" id="7854733">,</span>&nbsp;<span class="num" id="7854735">0xb5</span><span class="op" id="7854739">,</span>&nbsp;<span class="num" id="7854741">0x95</span><span class="op" id="7854745">,</span>&nbsp;<span class="num" id="7854747">0x2b</span><span class="op" id="7854751">,</span>&nbsp;<span class="num" id="7854753">0xa3</span><span class="op" id="7854757">,</span>&nbsp;<span class="num" id="7854759">0x93</span><span class="op" id="7854763">,</span>&nbsp;<span class="num" id="7854765">0x9a</span><span class="op" id="7854769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7854773">0x66</span><span class="op" id="7854777">,</span>&nbsp;<span class="num" id="7854779">0x64</span><span class="op" id="7854783">,</span>&nbsp;<span class="num" id="7854785">0x25</span><span class="op" id="7854789">,</span>&nbsp;<span class="num" id="7854791">0xe0</span><span class="op" id="7854795">,</span>&nbsp;<span class="num" id="7854797">0x74</span><span class="op" id="7854801">,</span>&nbsp;<span class="num" id="7854803">0x66</span><span class="op" id="7854807">,</span>&nbsp;<span class="num" id="7854809">0x8c</span><span class="op" id="7854813">,</span>&nbsp;<span class="num" id="7854815">0x3e</span><span class="op" id="7854819">,</span>&nbsp;<span class="num" id="7854821">0x92</span><span class="op" id="7854825">,</span>&nbsp;<span class="num" id="7854827">0xeb</span><span class="op" id="7854831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7854835">0xc6</span><span class="op" id="7854839">,</span>&nbsp;<span class="num" id="7854841">0xe6</span><span class="op" id="7854845">,</span>&nbsp;<span class="num" id="7854847">0xc0</span><span class="op" id="7854851">,</span>&nbsp;<span class="num" id="7854853">0x44</span><span class="op" id="7854857">,</span>&nbsp;<span class="num" id="7854859">0xf3</span><span class="op" id="7854863">,</span>&nbsp;<span class="num" id="7854865">0xb4</span><span class="op" id="7854869">,</span>&nbsp;<span class="num" id="7854871">0xb4</span><span class="op" id="7854875">,</span>&nbsp;<span class="num" id="7854877">0x2e</span><span class="op" id="7854881">,</span>&nbsp;<span class="num" id="7854883">0x8c</span><span class="op" id="7854887">,</span>&nbsp;<span class="num" id="7854889">0x66</span><span class="op" id="7854893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7854897">0x0a</span><span class="op" id="7854901">,</span>&nbsp;<span class="num" id="7854903">0x37</span><span class="op" id="7854907">,</span>&nbsp;<span class="num" id="7854909">0x9c</span><span class="op" id="7854913">,</span>&nbsp;<span class="num" id="7854915">0x69</span><span class="op" id="7854919">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7854922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7854926">if</span>&nbsp;<span class="ident" id="7854929">err</span>&nbsp;<span class="op" id="7854933">:=</span>&nbsp;<span class="ident" id="7854936">VerifyPSS</span><span class="op" id="7854945">(</span><span class="op" id="7854946">&amp;</span><span class="ident" id="7854947">rsaPrivateKey</span><span class="op" id="7854960">.</span><span class="ident" id="7854961">PublicKey</span><span class="op" id="7854970">,</span>&nbsp;<span class="ident" id="7854972">hash</span><span class="op" id="7854976">,</span>&nbsp;<span class="ident" id="7854978">hashed</span><span class="op" id="7854984">,</span>&nbsp;<span class="ident" id="7854986">sig</span><span class="op" id="7854989">,</span>&nbsp;<span class="ident" id="7854991">nil</span><span class="op" id="7854994">)</span><span class="op" id="7854995">;</span>&nbsp;<span class="ident" id="7854997">err</span>&nbsp;<span class="op" id="7855001">!=</span>&nbsp;<span class="ident" id="7855004">nil</span>&nbsp;<span class="op" id="7855008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855012">t</span><span class="op" id="7855013">.</span><span class="ident" id="7855014">Error</span><span class="op" id="7855019">(</span><span class="ident" id="7855020">err</span><span class="op" id="7855023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855026">}</span><br>
<span class="lineno">190</span><span class="op" id="7855028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7855031">func</span>&nbsp;<span class="ident" id="7855036">TestPSSSigning</span><span class="op" id="7855050">(</span><span class="ident" id="7855051">t</span>&nbsp;<span class="op" id="7855053">*</span><span class="ident" id="7855054">testing</span><span class="op" id="7855061">.</span><span class="ident" id="7855062">T</span><span class="op" id="7855063">)</span>&nbsp;<span class="op" id="7855065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855068">var</span>&nbsp;<span class="ident" id="7855072">saltLengthCombinations</span>&nbsp;<span class="op" id="7855095">=</span>&nbsp;<span class="op" id="7855097">[</span><span class="op" id="7855098">]</span><span class="keyword" id="7855099">struct</span>&nbsp;<span class="op" id="7855106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855110">signSaltLength</span><span class="op" id="7855124">,</span>&nbsp;<span class="ident" id="7855126">verifySaltLength</span>&nbsp;<span class="builtintype" id="7855143">int</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855149">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7855182">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855188">}</span><span class="op" id="7855189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855193">{</span><span class="ident" id="7855194">PSSSaltLengthAuto</span><span class="op" id="7855211">,</span>&nbsp;<span class="ident" id="7855213">PSSSaltLengthAuto</span><span class="op" id="7855230">,</span>&nbsp;<span class="builtintype" id="7855232">true</span><span class="op" id="7855236">}</span><span class="op" id="7855237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855241">{</span><span class="ident" id="7855242">PSSSaltLengthEqualsHash</span><span class="op" id="7855265">,</span>&nbsp;<span class="ident" id="7855267">PSSSaltLengthAuto</span><span class="op" id="7855284">,</span>&nbsp;<span class="builtintype" id="7855286">true</span><span class="op" id="7855290">}</span><span class="op" id="7855291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855295">{</span><span class="ident" id="7855296">PSSSaltLengthEqualsHash</span><span class="op" id="7855319">,</span>&nbsp;<span class="ident" id="7855321">PSSSaltLengthEqualsHash</span><span class="op" id="7855344">,</span>&nbsp;<span class="builtintype" id="7855346">true</span><span class="op" id="7855350">}</span><span class="op" id="7855351">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855355">{</span><span class="ident" id="7855356">PSSSaltLengthEqualsHash</span><span class="op" id="7855379">,</span>&nbsp;<span class="num" id="7855381">8</span><span class="op" id="7855382">,</span>&nbsp;<span class="builtintype" id="7855384">false</span><span class="op" id="7855389">}</span><span class="op" id="7855390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855394">{</span><span class="ident" id="7855395">PSSSaltLengthAuto</span><span class="op" id="7855412">,</span>&nbsp;<span class="ident" id="7855414">PSSSaltLengthEqualsHash</span><span class="op" id="7855437">,</span>&nbsp;<span class="builtintype" id="7855439">false</span><span class="op" id="7855444">}</span><span class="op" id="7855445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855449">{</span><span class="num" id="7855450">8</span><span class="op" id="7855451">,</span>&nbsp;<span class="num" id="7855453">8</span><span class="op" id="7855454">,</span>&nbsp;<span class="builtintype" id="7855456">true</span><span class="op" id="7855460">}</span><span class="op" id="7855461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855468">hash</span>&nbsp;<span class="op" id="7855473">:=</span>&nbsp;<span class="ident" id="7855476">crypto</span><span class="op" id="7855482">.</span><span class="ident" id="7855483">MD5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855488">h</span>&nbsp;<span class="op" id="7855490">:=</span>&nbsp;<span class="ident" id="7855493">hash</span><span class="op" id="7855497">.</span><span class="ident" id="7855498">New</span><span class="op" id="7855501">(</span><span class="op" id="7855502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855505">h</span><span class="op" id="7855506">.</span><span class="ident" id="7855507">Write</span><span class="op" id="7855512">(</span><span class="op" id="7855513">[</span><span class="op" id="7855514">]</span><span class="builtintype" id="7855515">byte</span><span class="op" id="7855519">(</span><span class="string" id="7855520">&#34;testing&#34;</span><span class="op" id="7855529">)</span><span class="op" id="7855530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855533">hashed</span>&nbsp;<span class="op" id="7855540">:=</span>&nbsp;<span class="ident" id="7855543">h</span><span class="op" id="7855544">.</span><span class="ident" id="7855545">Sum</span><span class="op" id="7855548">(</span><span class="ident" id="7855549">nil</span><span class="op" id="7855552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855555">var</span>&nbsp;<span class="ident" id="7855559">opts</span>&nbsp;<span class="ident" id="7855564">PSSOptions</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855577">for</span>&nbsp;<span class="ident" id="7855581">i</span><span class="op" id="7855582">,</span>&nbsp;<span class="ident" id="7855584">test</span>&nbsp;<span class="op" id="7855589">:=</span>&nbsp;<span class="keyword" id="7855592">range</span>&nbsp;<span class="ident" id="7855598">saltLengthCombinations</span>&nbsp;<span class="op" id="7855621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855625">opts</span><span class="op" id="7855629">.</span><span class="ident" id="7855630">SaltLength</span>&nbsp;<span class="op" id="7855641">=</span>&nbsp;<span class="ident" id="7855643">test</span><span class="op" id="7855647">.</span><span class="ident" id="7855648">signSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855665">sig</span><span class="op" id="7855668">,</span>&nbsp;<span class="ident" id="7855670">err</span>&nbsp;<span class="op" id="7855674">:=</span>&nbsp;<span class="ident" id="7855677">SignPSS</span><span class="op" id="7855684">(</span><span class="ident" id="7855685">rand</span><span class="op" id="7855689">.</span><span class="ident" id="7855690">Reader</span><span class="op" id="7855696">,</span>&nbsp;<span class="ident" id="7855698">rsaPrivateKey</span><span class="op" id="7855711">,</span>&nbsp;<span class="ident" id="7855713">hash</span><span class="op" id="7855717">,</span>&nbsp;<span class="ident" id="7855719">hashed</span><span class="op" id="7855725">,</span>&nbsp;<span class="op" id="7855727">&amp;</span><span class="ident" id="7855728">opts</span><span class="op" id="7855732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855736">if</span>&nbsp;<span class="ident" id="7855739">err</span>&nbsp;<span class="op" id="7855743">!=</span>&nbsp;<span class="ident" id="7855746">nil</span>&nbsp;<span class="op" id="7855750">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855755">t</span><span class="op" id="7855756">.</span><span class="ident" id="7855757">Errorf</span><span class="op" id="7855763">(</span><span class="string" id="7855764">&#34;#%d:&nbsp;error&nbsp;while&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7855794">,</span>&nbsp;<span class="ident" id="7855796">i</span><span class="op" id="7855797">,</span>&nbsp;<span class="ident" id="7855799">err</span><span class="op" id="7855802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855807">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855823">opts</span><span class="op" id="7855827">.</span><span class="ident" id="7855828">SaltLength</span>&nbsp;<span class="op" id="7855839">=</span>&nbsp;<span class="ident" id="7855841">test</span><span class="op" id="7855845">.</span><span class="ident" id="7855846">verifySaltLength</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855865">err</span>&nbsp;<span class="op" id="7855869">=</span>&nbsp;<span class="ident" id="7855871">VerifyPSS</span><span class="op" id="7855880">(</span><span class="op" id="7855881">&amp;</span><span class="ident" id="7855882">rsaPrivateKey</span><span class="op" id="7855895">.</span><span class="ident" id="7855896">PublicKey</span><span class="op" id="7855905">,</span>&nbsp;<span class="ident" id="7855907">hash</span><span class="op" id="7855911">,</span>&nbsp;<span class="ident" id="7855913">hashed</span><span class="op" id="7855919">,</span>&nbsp;<span class="ident" id="7855921">sig</span><span class="op" id="7855924">,</span>&nbsp;<span class="op" id="7855926">&amp;</span><span class="ident" id="7855927">opts</span><span class="op" id="7855931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855935">if</span>&nbsp;<span class="op" id="7855938">(</span><span class="ident" id="7855939">err</span>&nbsp;<span class="op" id="7855943">==</span>&nbsp;<span class="ident" id="7855946">nil</span><span class="op" id="7855949">)</span>&nbsp;<span class="op" id="7855951">!=</span>&nbsp;<span class="ident" id="7855954">test</span><span class="op" id="7855958">.</span><span class="ident" id="7855959">good</span>&nbsp;<span class="op" id="7855964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855969">t</span><span class="op" id="7855970">.</span><span class="ident" id="7855971">Errorf</span><span class="op" id="7855977">(</span><span class="string" id="7855978">&#34;#%d:&nbsp;bad&nbsp;result,&nbsp;wanted:&nbsp;%t,&nbsp;got:&nbsp;%s&#34;</span><span class="op" id="7856016">,</span>&nbsp;<span class="ident" id="7856018">i</span><span class="op" id="7856019">,</span>&nbsp;<span class="ident" id="7856021">test</span><span class="op" id="7856025">.</span><span class="ident" id="7856026">good</span><span class="op" id="7856030">,</span>&nbsp;<span class="ident" id="7856032">err</span><span class="op" id="7856035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7856039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7856042">}</span><br>
<span class="lineno">225</span><span class="op" id="7856044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7856047">func</span>&nbsp;<span class="ident" id="7856052">bigFromHex</span><span class="op" id="7856062">(</span><span class="ident" id="7856063">hex</span>&nbsp;<span class="builtintype" id="7856067">string</span><span class="op" id="7856073">)</span>&nbsp;<span class="op" id="7856075">*</span><span class="ident" id="7856076">big</span><span class="op" id="7856079">.</span><span class="ident" id="7856080">Int</span>&nbsp;<span class="op" id="7856084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856087">n</span><span class="op" id="7856088">,</span>&nbsp;<span class="ident" id="7856090">ok</span>&nbsp;<span class="op" id="7856093">:=</span>&nbsp;<span class="builtinfunc" id="7856096">new</span><span class="op" id="7856099">(</span><span class="ident" id="7856100">big</span><span class="op" id="7856103">.</span><span class="ident" id="7856104">Int</span><span class="op" id="7856107">)</span><span class="op" id="7856108">.</span><span class="ident" id="7856109">SetString</span><span class="op" id="7856118">(</span><span class="ident" id="7856119">hex</span><span class="op" id="7856122">,</span>&nbsp;<span class="num" id="7856124">16</span><span class="op" id="7856126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856129">if</span>&nbsp;<span class="op" id="7856132">!</span><span class="ident" id="7856133">ok</span>&nbsp;<span class="op" id="7856136">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7856140">panic</span><span class="op" id="7856145">(</span><span class="string" id="7856146">&#34;bad&nbsp;hex:&nbsp;&#34;</span>&nbsp;<span class="op" id="7856158">+</span>&nbsp;<span class="ident" id="7856160">hex</span><span class="op" id="7856163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7856166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856169">return</span>&nbsp;<span class="ident" id="7856176">n</span><br>
<span class="lineno"></span><span class="op" id="7856178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="7856181">func</span>&nbsp;<span class="ident" id="7856186">intFromHex</span><span class="op" id="7856196">(</span><span class="ident" id="7856197">hex</span>&nbsp;<span class="builtintype" id="7856201">string</span><span class="op" id="7856207">)</span>&nbsp;<span class="builtintype" id="7856209">int</span>&nbsp;<span class="op" id="7856213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856216">i</span><span class="op" id="7856217">,</span>&nbsp;<span class="ident" id="7856219">err</span>&nbsp;<span class="op" id="7856223">:=</span>&nbsp;<span class="ident" id="7856226">strconv</span><span class="op" id="7856233">.</span><span class="ident" id="7856234">ParseInt</span><span class="op" id="7856242">(</span><span class="ident" id="7856243">hex</span><span class="op" id="7856246">,</span>&nbsp;<span class="num" id="7856248">16</span><span class="op" id="7856250">,</span>&nbsp;<span class="num" id="7856252">32</span><span class="op" id="7856254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856257">if</span>&nbsp;<span class="ident" id="7856260">err</span>&nbsp;<span class="op" id="7856264">!=</span>&nbsp;<span class="ident" id="7856267">nil</span>&nbsp;<span class="op" id="7856271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7856275">panic</span><span class="op" id="7856280">(</span><span class="ident" id="7856281">err</span><span class="op" id="7856284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7856287">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856290">return</span>&nbsp;<span class="builtintype" id="7856297">int</span><span class="op" id="7856300">(</span><span class="ident" id="7856301">i</span><span class="op" id="7856302">)</span><br>
<span class="lineno"></span><span class="op" id="7856304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7856307">func</span>&nbsp;<span class="ident" id="7856312">fromHex</span><span class="op" id="7856319">(</span><span class="ident" id="7856320">hexStr</span>&nbsp;<span class="builtintype" id="7856327">string</span><span class="op" id="7856333">)</span>&nbsp;<span class="op" id="7856335">[</span><span class="op" id="7856336">]</span><span class="builtintype" id="7856337">byte</span>&nbsp;<span class="op" id="7856342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856345">s</span><span class="op" id="7856346">,</span>&nbsp;<span class="ident" id="7856348">err</span>&nbsp;<span class="op" id="7856352">:=</span>&nbsp;<span class="ident" id="7856355">hex</span><span class="op" id="7856358">.</span><span class="ident" id="7856359">DecodeString</span><span class="op" id="7856371">(</span><span class="ident" id="7856372">hexStr</span><span class="op" id="7856378">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856381">if</span>&nbsp;<span class="ident" id="7856384">err</span>&nbsp;<span class="op" id="7856388">!=</span>&nbsp;<span class="ident" id="7856391">nil</span>&nbsp;<span class="op" id="7856395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7856399">panic</span><span class="op" id="7856404">(</span><span class="ident" id="7856405">err</span><span class="op" id="7856408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7856411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856414">return</span>&nbsp;<span class="ident" id="7856421">s</span><br>
<span class="lineno"></span><span class="op" id="7856423">}</span>
</div>
</body>
</html>
