<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html" class="current">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3552547">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3552602">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3552656">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3552707">package</span>&nbsp;<span class="ident" id="3552715">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3552725">import</span>&nbsp;<span class="op" id="3552732">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3552735">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3552742">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3552748">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3552761">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3552778">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3552786">&#34;text/template&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3552803">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="3552825">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3552828">//&nbsp;Template&nbsp;is&nbsp;a&nbsp;specialized&nbsp;Template&nbsp;from&nbsp;&#34;text/template&#34;&nbsp;that&nbsp;produces&nbsp;a&nbsp;safe</span><br>
<span class="lineno"></span><span class="comment" id="3552908">//&nbsp;HTML&nbsp;document&nbsp;fragment.</span><br>
<span class="lineno"></span><span class="keyword" id="3552935">type</span>&nbsp;<span class="ident" id="3552940">Template</span>&nbsp;<span class="keyword" id="3552949">struct</span>&nbsp;<span class="op" id="3552956">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3552959">//&nbsp;Sticky&nbsp;error&nbsp;if&nbsp;escaping&nbsp;fails.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3552995">escapeErr</span>&nbsp;<span class="builtintype" id="3553005">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3553012">//&nbsp;We&nbsp;could&nbsp;embed&nbsp;the&nbsp;text/template&nbsp;field,&nbsp;but&nbsp;it&#39;s&nbsp;safer&nbsp;not&nbsp;to&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3553086">//&nbsp;we&nbsp;need&nbsp;to&nbsp;keep&nbsp;our&nbsp;version&nbsp;of&nbsp;the&nbsp;name&nbsp;space&nbsp;and&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3553155">//&nbsp;template&#39;s&nbsp;in&nbsp;sync.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3553179">text</span>&nbsp;<span class="op" id="3553184">*</span><span class="ident" id="3553185">template</span><span class="op" id="3553193">.</span><span class="ident" id="3553194">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3553204">//&nbsp;The&nbsp;underlying&nbsp;template&#39;s&nbsp;parse&nbsp;tree,&nbsp;updated&nbsp;to&nbsp;be&nbsp;HTML-safe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3553271">Tree</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3553282">*</span><span class="ident" id="3553283">parse</span><span class="op" id="3553288">.</span><span class="ident" id="3553289">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3553295">*</span><span class="ident" id="3553296">nameSpace</span>&nbsp;<span class="comment" id="3553306">//&nbsp;common&nbsp;to&nbsp;all&nbsp;associated&nbsp;templates</span><br>
<span class="lineno"></span><span class="op" id="3553344">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="3553347">//&nbsp;escapeOK&nbsp;is&nbsp;a&nbsp;sentinel&nbsp;value&nbsp;used&nbsp;to&nbsp;indicate&nbsp;valid&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="keyword" id="3553412">var</span>&nbsp;<span class="ident" id="3553416">escapeOK</span>&nbsp;<span class="op" id="3553425">=</span>&nbsp;<span class="ident" id="3553427">fmt</span><span class="op" id="3553430">.</span><span class="ident" id="3553431">Errorf</span><span class="op" id="3553437">(</span><span class="string" id="3553438">&#34;template&nbsp;escaped&nbsp;correctly&#34;</span><span class="op" id="3553466">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3553469">//&nbsp;nameSpace&nbsp;is&nbsp;the&nbsp;data&nbsp;structure&nbsp;shared&nbsp;by&nbsp;all&nbsp;templates&nbsp;in&nbsp;an&nbsp;association.</span><br>
<span class="lineno">35</span><span class="keyword" id="3553547">type</span>&nbsp;<span class="ident" id="3553552">nameSpace</span>&nbsp;<span class="keyword" id="3553562">struct</span>&nbsp;<span class="op" id="3553569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3553572">mu</span>&nbsp;&nbsp;<span class="ident" id="3553576">sync</span><span class="op" id="3553580">.</span><span class="ident" id="3553581">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3553588">set</span>&nbsp;<span class="keyword" id="3553592">map</span><span class="op" id="3553595">[</span><span class="builtintype" id="3553596">string</span><span class="op" id="3553602">]</span><span class="op" id="3553603">*</span><span class="ident" id="3553604">Template</span><br>
<span class="lineno"></span><span class="op" id="3553613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="3553616">//&nbsp;Templates&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;the&nbsp;templates&nbsp;associated&nbsp;with&nbsp;t,&nbsp;including&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="3553693">//&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="3553704">func</span>&nbsp;<span class="op" id="3553709">(</span><span class="ident" id="3553710">t</span>&nbsp;<span class="op" id="3553712">*</span><span class="ident" id="3553713">Template</span><span class="op" id="3553721">)</span>&nbsp;<span class="ident" id="3553723">Templates</span><span class="op" id="3553732">(</span><span class="op" id="3553733">)</span>&nbsp;<span class="op" id="3553735">[</span><span class="op" id="3553736">]</span><span class="op" id="3553737">*</span><span class="ident" id="3553738">Template</span>&nbsp;<span class="op" id="3553747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3553750">ns</span>&nbsp;<span class="op" id="3553753">:=</span>&nbsp;<span class="ident" id="3553756">t</span><span class="op" id="3553757">.</span><span class="ident" id="3553758">nameSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3553769">ns</span><span class="op" id="3553771">.</span><span class="ident" id="3553772">mu</span><span class="op" id="3553774">.</span><span class="ident" id="3553775">Lock</span><span class="op" id="3553779">(</span><span class="op" id="3553780">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3553783">defer</span>&nbsp;<span class="ident" id="3553789">ns</span><span class="op" id="3553791">.</span><span class="ident" id="3553792">mu</span><span class="op" id="3553794">.</span><span class="ident" id="3553795">Unlock</span><span class="op" id="3553801">(</span><span class="op" id="3553802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3553805">//&nbsp;Return&nbsp;a&nbsp;slice&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3553852">m</span>&nbsp;<span class="op" id="3553854">:=</span>&nbsp;<span class="builtinfunc" id="3553857">make</span><span class="op" id="3553861">(</span><span class="op" id="3553862">[</span><span class="op" id="3553863">]</span><span class="op" id="3553864">*</span><span class="ident" id="3553865">Template</span><span class="op" id="3553873">,</span>&nbsp;<span class="num" id="3553875">0</span><span class="op" id="3553876">,</span>&nbsp;<span class="builtinfunc" id="3553878">len</span><span class="op" id="3553881">(</span><span class="ident" id="3553882">ns</span><span class="op" id="3553884">.</span><span class="ident" id="3553885">set</span><span class="op" id="3553888">)</span><span class="op" id="3553889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3553892">for</span>&nbsp;<span class="ident" id="3553896">_</span><span class="op" id="3553897">,</span>&nbsp;<span class="ident" id="3553899">v</span>&nbsp;<span class="op" id="3553901">:=</span>&nbsp;<span class="keyword" id="3553904">range</span>&nbsp;<span class="ident" id="3553910">ns</span><span class="op" id="3553912">.</span><span class="ident" id="3553913">set</span>&nbsp;<span class="op" id="3553917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3553921">m</span>&nbsp;<span class="op" id="3553923">=</span>&nbsp;<span class="builtinfunc" id="3553925">append</span><span class="op" id="3553931">(</span><span class="ident" id="3553932">m</span><span class="op" id="3553933">,</span>&nbsp;<span class="ident" id="3553935">v</span><span class="op" id="3553936">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3553939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3553942">return</span>&nbsp;<span class="ident" id="3553949">m</span><br>
<span class="lineno"></span><span class="op" id="3553951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3553954">//&nbsp;escape&nbsp;escapes&nbsp;all&nbsp;associated&nbsp;templates.</span><br>
<span class="lineno">55</span><span class="keyword" id="3553998">func</span>&nbsp;<span class="op" id="3554003">(</span><span class="ident" id="3554004">t</span>&nbsp;<span class="op" id="3554006">*</span><span class="ident" id="3554007">Template</span><span class="op" id="3554015">)</span>&nbsp;<span class="ident" id="3554017">escape</span><span class="op" id="3554023">(</span><span class="op" id="3554024">)</span>&nbsp;<span class="builtintype" id="3554026">error</span>&nbsp;<span class="op" id="3554032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3554035">t</span><span class="op" id="3554036">.</span><span class="ident" id="3554037">nameSpace</span><span class="op" id="3554046">.</span><span class="ident" id="3554047">mu</span><span class="op" id="3554049">.</span><span class="ident" id="3554050">Lock</span><span class="op" id="3554054">(</span><span class="op" id="3554055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3554058">defer</span>&nbsp;<span class="ident" id="3554064">t</span><span class="op" id="3554065">.</span><span class="ident" id="3554066">nameSpace</span><span class="op" id="3554075">.</span><span class="ident" id="3554076">mu</span><span class="op" id="3554078">.</span><span class="ident" id="3554079">Unlock</span><span class="op" id="3554085">(</span><span class="op" id="3554086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3554089">if</span>&nbsp;<span class="ident" id="3554092">t</span><span class="op" id="3554093">.</span><span class="ident" id="3554094">escapeErr</span>&nbsp;<span class="op" id="3554104">==</span>&nbsp;<span class="ident" id="3554107">nil</span>&nbsp;<span class="op" id="3554111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3554115">if</span>&nbsp;<span class="ident" id="3554118">err</span>&nbsp;<span class="op" id="3554122">:=</span>&nbsp;<span class="ident" id="3554125">escapeTemplate</span><span class="op" id="3554139">(</span><span class="ident" id="3554140">t</span><span class="op" id="3554141">,</span>&nbsp;<span class="ident" id="3554143">t</span><span class="op" id="3554144">.</span><span class="ident" id="3554145">text</span><span class="op" id="3554149">.</span><span class="ident" id="3554150">Root</span><span class="op" id="3554154">,</span>&nbsp;<span class="ident" id="3554156">t</span><span class="op" id="3554157">.</span><span class="ident" id="3554158">Name</span><span class="op" id="3554162">(</span><span class="op" id="3554163">)</span><span class="op" id="3554164">)</span><span class="op" id="3554165">;</span>&nbsp;<span class="ident" id="3554167">err</span>&nbsp;<span class="op" id="3554171">!=</span>&nbsp;<span class="ident" id="3554174">nil</span>&nbsp;<span class="op" id="3554178">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3554183">return</span>&nbsp;<span class="ident" id="3554190">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3554196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3554199">}</span>&nbsp;<span class="keyword" id="3554201">else</span>&nbsp;<span class="keyword" id="3554206">if</span>&nbsp;<span class="ident" id="3554209">t</span><span class="op" id="3554210">.</span><span class="ident" id="3554211">escapeErr</span>&nbsp;<span class="op" id="3554221">!=</span>&nbsp;<span class="ident" id="3554224">escapeOK</span>&nbsp;<span class="op" id="3554233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3554237">return</span>&nbsp;<span class="ident" id="3554244">t</span><span class="op" id="3554245">.</span><span class="ident" id="3554246">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3554257">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3554260">return</span>&nbsp;<span class="ident" id="3554267">nil</span><br>
<span class="lineno"></span><span class="op" id="3554271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3554274">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="3554341">//&nbsp;writing&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">70</span><span class="comment" id="3554370">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="3554438">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3554511">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="3554533">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="3554583">func</span>&nbsp;<span class="op" id="3554588">(</span><span class="ident" id="3554589">t</span>&nbsp;<span class="op" id="3554591">*</span><span class="ident" id="3554592">Template</span><span class="op" id="3554600">)</span>&nbsp;<span class="ident" id="3554602">Execute</span><span class="op" id="3554609">(</span><span class="ident" id="3554610">wr</span>&nbsp;<span class="ident" id="3554613">io</span><span class="op" id="3554615">.</span><span class="ident" id="3554616">Writer</span><span class="op" id="3554622">,</span>&nbsp;<span class="ident" id="3554624">data</span>&nbsp;<span class="keyword" id="3554629">interface</span><span class="op" id="3554638">{</span><span class="op" id="3554639">}</span><span class="op" id="3554640">)</span>&nbsp;<span class="builtintype" id="3554642">error</span>&nbsp;<span class="op" id="3554648">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3554651">if</span>&nbsp;<span class="ident" id="3554654">err</span>&nbsp;<span class="op" id="3554658">:=</span>&nbsp;<span class="ident" id="3554661">t</span><span class="op" id="3554662">.</span><span class="ident" id="3554663">escape</span><span class="op" id="3554669">(</span><span class="op" id="3554670">)</span><span class="op" id="3554671">;</span>&nbsp;<span class="ident" id="3554673">err</span>&nbsp;<span class="op" id="3554677">!=</span>&nbsp;<span class="ident" id="3554680">nil</span>&nbsp;<span class="op" id="3554684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3554688">return</span>&nbsp;<span class="ident" id="3554695">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3554700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3554703">return</span>&nbsp;<span class="ident" id="3554710">t</span><span class="op" id="3554711">.</span><span class="ident" id="3554712">text</span><span class="op" id="3554716">.</span><span class="ident" id="3554717">Execute</span><span class="op" id="3554724">(</span><span class="ident" id="3554725">wr</span><span class="op" id="3554727">,</span>&nbsp;<span class="ident" id="3554729">data</span><span class="op" id="3554733">)</span><br>
<span class="lineno"></span><span class="op" id="3554735">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="3554738">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="3554815">//&nbsp;name&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="3554881">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="3554949">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno">85</span><span class="comment" id="3555022">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="3555044">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="3555094">func</span>&nbsp;<span class="op" id="3555099">(</span><span class="ident" id="3555100">t</span>&nbsp;<span class="op" id="3555102">*</span><span class="ident" id="3555103">Template</span><span class="op" id="3555111">)</span>&nbsp;<span class="ident" id="3555113">ExecuteTemplate</span><span class="op" id="3555128">(</span><span class="ident" id="3555129">wr</span>&nbsp;<span class="ident" id="3555132">io</span><span class="op" id="3555134">.</span><span class="ident" id="3555135">Writer</span><span class="op" id="3555141">,</span>&nbsp;<span class="ident" id="3555143">name</span>&nbsp;<span class="builtintype" id="3555148">string</span><span class="op" id="3555154">,</span>&nbsp;<span class="ident" id="3555156">data</span>&nbsp;<span class="keyword" id="3555161">interface</span><span class="op" id="3555170">{</span><span class="op" id="3555171">}</span><span class="op" id="3555172">)</span>&nbsp;<span class="builtintype" id="3555174">error</span>&nbsp;<span class="op" id="3555180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3555183">tmpl</span><span class="op" id="3555187">,</span>&nbsp;<span class="ident" id="3555189">err</span>&nbsp;<span class="op" id="3555193">:=</span>&nbsp;<span class="ident" id="3555196">t</span><span class="op" id="3555197">.</span><span class="ident" id="3555198">lookupAndEscapeTemplate</span><span class="op" id="3555221">(</span><span class="ident" id="3555222">name</span><span class="op" id="3555226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3555229">if</span>&nbsp;<span class="ident" id="3555232">err</span>&nbsp;<span class="op" id="3555236">!=</span>&nbsp;<span class="ident" id="3555239">nil</span>&nbsp;<span class="op" id="3555243">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3555247">return</span>&nbsp;<span class="ident" id="3555254">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3555259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3555262">return</span>&nbsp;<span class="ident" id="3555269">tmpl</span><span class="op" id="3555273">.</span><span class="ident" id="3555274">text</span><span class="op" id="3555278">.</span><span class="ident" id="3555279">Execute</span><span class="op" id="3555286">(</span><span class="ident" id="3555287">wr</span><span class="op" id="3555289">,</span>&nbsp;<span class="ident" id="3555291">data</span><span class="op" id="3555295">)</span><br>
<span class="lineno"></span><span class="op" id="3555297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="3555300">//&nbsp;lookupAndEscapeTemplate&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="3555376">//&nbsp;is&nbsp;escaped,&nbsp;or&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be.&nbsp;It&nbsp;returns&nbsp;the&nbsp;named</span><br>
<span class="lineno"></span><span class="comment" id="3555449">//&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="3555462">func</span>&nbsp;<span class="op" id="3555467">(</span><span class="ident" id="3555468">t</span>&nbsp;<span class="op" id="3555470">*</span><span class="ident" id="3555471">Template</span><span class="op" id="3555479">)</span>&nbsp;<span class="ident" id="3555481">lookupAndEscapeTemplate</span><span class="op" id="3555504">(</span><span class="ident" id="3555505">name</span>&nbsp;<span class="builtintype" id="3555510">string</span><span class="op" id="3555516">)</span>&nbsp;<span class="op" id="3555518">(</span><span class="ident" id="3555519">tmpl</span>&nbsp;<span class="op" id="3555524">*</span><span class="ident" id="3555525">Template</span><span class="op" id="3555533">,</span>&nbsp;<span class="ident" id="3555535">err</span>&nbsp;<span class="builtintype" id="3555539">error</span><span class="op" id="3555544">)</span>&nbsp;<span class="op" id="3555546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3555549">t</span><span class="op" id="3555550">.</span><span class="ident" id="3555551">nameSpace</span><span class="op" id="3555560">.</span><span class="ident" id="3555561">mu</span><span class="op" id="3555563">.</span><span class="ident" id="3555564">Lock</span><span class="op" id="3555568">(</span><span class="op" id="3555569">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3555572">defer</span>&nbsp;<span class="ident" id="3555578">t</span><span class="op" id="3555579">.</span><span class="ident" id="3555580">nameSpace</span><span class="op" id="3555589">.</span><span class="ident" id="3555590">mu</span><span class="op" id="3555592">.</span><span class="ident" id="3555593">Unlock</span><span class="op" id="3555599">(</span><span class="op" id="3555600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3555603">tmpl</span>&nbsp;<span class="op" id="3555608">=</span>&nbsp;<span class="ident" id="3555610">t</span><span class="op" id="3555611">.</span><span class="ident" id="3555612">set</span><span class="op" id="3555615">[</span><span class="ident" id="3555616">name</span><span class="op" id="3555620">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3555623">if</span>&nbsp;<span class="ident" id="3555626">tmpl</span>&nbsp;<span class="op" id="3555631">==</span>&nbsp;<span class="ident" id="3555634">nil</span>&nbsp;<span class="op" id="3555638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3555642">return</span>&nbsp;<span class="ident" id="3555649">nil</span><span class="op" id="3555652">,</span>&nbsp;<span class="ident" id="3555654">fmt</span><span class="op" id="3555657">.</span><span class="ident" id="3555658">Errorf</span><span class="op" id="3555664">(</span><span class="string" id="3555665">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;undefined&#34;</span><span class="op" id="3555697">,</span>&nbsp;<span class="ident" id="3555699">name</span><span class="op" id="3555703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3555706">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3555709">if</span>&nbsp;<span class="ident" id="3555712">tmpl</span><span class="op" id="3555716">.</span><span class="ident" id="3555717">escapeErr</span>&nbsp;<span class="op" id="3555727">!=</span>&nbsp;<span class="ident" id="3555730">nil</span>&nbsp;<span class="op" id="3555734">&amp;&amp;</span>&nbsp;<span class="ident" id="3555737">tmpl</span><span class="op" id="3555741">.</span><span class="ident" id="3555742">escapeErr</span>&nbsp;<span class="op" id="3555752">!=</span>&nbsp;<span class="ident" id="3555755">escapeOK</span>&nbsp;<span class="op" id="3555764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3555768">return</span>&nbsp;<span class="ident" id="3555775">nil</span><span class="op" id="3555778">,</span>&nbsp;<span class="ident" id="3555780">tmpl</span><span class="op" id="3555784">.</span><span class="ident" id="3555785">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3555796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3555799">if</span>&nbsp;<span class="ident" id="3555802">tmpl</span><span class="op" id="3555806">.</span><span class="ident" id="3555807">text</span><span class="op" id="3555811">.</span><span class="ident" id="3555812">Tree</span>&nbsp;<span class="op" id="3555817">==</span>&nbsp;<span class="ident" id="3555820">nil</span>&nbsp;<span class="op" id="3555824">||</span>&nbsp;<span class="ident" id="3555827">tmpl</span><span class="op" id="3555831">.</span><span class="ident" id="3555832">text</span><span class="op" id="3555836">.</span><span class="ident" id="3555837">Root</span>&nbsp;<span class="op" id="3555842">==</span>&nbsp;<span class="ident" id="3555845">nil</span>&nbsp;<span class="op" id="3555849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3555853">return</span>&nbsp;<span class="ident" id="3555860">nil</span><span class="op" id="3555863">,</span>&nbsp;<span class="ident" id="3555865">fmt</span><span class="op" id="3555868">.</span><span class="ident" id="3555869">Errorf</span><span class="op" id="3555875">(</span><span class="string" id="3555876">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;template&#34;</span><span class="op" id="3555921">,</span>&nbsp;<span class="ident" id="3555923">name</span><span class="op" id="3555927">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3555930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3555933">if</span>&nbsp;<span class="ident" id="3555936">t</span><span class="op" id="3555937">.</span><span class="ident" id="3555938">text</span><span class="op" id="3555942">.</span><span class="ident" id="3555943">Lookup</span><span class="op" id="3555949">(</span><span class="ident" id="3555950">name</span><span class="op" id="3555954">)</span>&nbsp;<span class="op" id="3555956">==</span>&nbsp;<span class="ident" id="3555959">nil</span>&nbsp;<span class="op" id="3555963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3555967">panic</span><span class="op" id="3555972">(</span><span class="string" id="3555973">&#34;html/template&nbsp;internal&nbsp;error:&nbsp;template&nbsp;escaping&nbsp;out&nbsp;of&nbsp;sync&#34;</span><span class="op" id="3556034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3556037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3556040">if</span>&nbsp;<span class="ident" id="3556043">tmpl</span><span class="op" id="3556047">.</span><span class="ident" id="3556048">escapeErr</span>&nbsp;<span class="op" id="3556058">==</span>&nbsp;<span class="ident" id="3556061">nil</span>&nbsp;<span class="op" id="3556065">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3556069">err</span>&nbsp;<span class="op" id="3556073">=</span>&nbsp;<span class="ident" id="3556075">escapeTemplate</span><span class="op" id="3556089">(</span><span class="ident" id="3556090">tmpl</span><span class="op" id="3556094">,</span>&nbsp;<span class="ident" id="3556096">tmpl</span><span class="op" id="3556100">.</span><span class="ident" id="3556101">text</span><span class="op" id="3556105">.</span><span class="ident" id="3556106">Root</span><span class="op" id="3556110">,</span>&nbsp;<span class="ident" id="3556112">name</span><span class="op" id="3556116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3556119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3556122">return</span>&nbsp;<span class="ident" id="3556129">tmpl</span><span class="op" id="3556133">,</span>&nbsp;<span class="ident" id="3556135">err</span><br>
<span class="lineno"></span><span class="op" id="3556139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="3556142">//&nbsp;Parse&nbsp;parses&nbsp;a&nbsp;string&nbsp;into&nbsp;a&nbsp;template.&nbsp;Nested&nbsp;template&nbsp;definitions</span><br>
<span class="lineno"></span><span class="comment" id="3556212">//&nbsp;will&nbsp;be&nbsp;associated&nbsp;with&nbsp;the&nbsp;top-level&nbsp;template&nbsp;t.&nbsp;Parse&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3556278">//&nbsp;called&nbsp;multiple&nbsp;times&nbsp;to&nbsp;parse&nbsp;definitions&nbsp;of&nbsp;templates&nbsp;to&nbsp;associate</span><br>
<span class="lineno"></span><span class="comment" id="3556350">//&nbsp;with&nbsp;t.&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;if&nbsp;a&nbsp;resulting&nbsp;template&nbsp;is&nbsp;non-empty&nbsp;(contains</span><br>
<span class="lineno"></span><span class="comment" id="3556423">//&nbsp;content&nbsp;other&nbsp;than&nbsp;template&nbsp;definitions)&nbsp;and&nbsp;would&nbsp;replace&nbsp;a</span><br>
<span class="lineno">125</span><span class="comment" id="3556487">//&nbsp;non-empty&nbsp;template&nbsp;with&nbsp;the&nbsp;same&nbsp;name.&nbsp;&nbsp;(In&nbsp;multiple&nbsp;calls&nbsp;to&nbsp;Parse</span><br>
<span class="lineno"></span><span class="comment" id="3556558">//&nbsp;with&nbsp;the&nbsp;same&nbsp;receiver&nbsp;template,&nbsp;only&nbsp;one&nbsp;call&nbsp;can&nbsp;contain&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="3556625">//&nbsp;other&nbsp;than&nbsp;space,&nbsp;comments,&nbsp;and&nbsp;template&nbsp;definitions.)</span><br>
<span class="lineno"></span><span class="keyword" id="3556683">func</span>&nbsp;<span class="op" id="3556688">(</span><span class="ident" id="3556689">t</span>&nbsp;<span class="op" id="3556691">*</span><span class="ident" id="3556692">Template</span><span class="op" id="3556700">)</span>&nbsp;<span class="ident" id="3556702">Parse</span><span class="op" id="3556707">(</span><span class="ident" id="3556708">src</span>&nbsp;<span class="builtintype" id="3556712">string</span><span class="op" id="3556718">)</span>&nbsp;<span class="op" id="3556720">(</span><span class="op" id="3556721">*</span><span class="ident" id="3556722">Template</span><span class="op" id="3556730">,</span>&nbsp;<span class="builtintype" id="3556732">error</span><span class="op" id="3556737">)</span>&nbsp;<span class="op" id="3556739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3556742">t</span><span class="op" id="3556743">.</span><span class="ident" id="3556744">nameSpace</span><span class="op" id="3556753">.</span><span class="ident" id="3556754">mu</span><span class="op" id="3556756">.</span><span class="ident" id="3556757">Lock</span><span class="op" id="3556761">(</span><span class="op" id="3556762">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3556765">t</span><span class="op" id="3556766">.</span><span class="ident" id="3556767">escapeErr</span>&nbsp;<span class="op" id="3556777">=</span>&nbsp;<span class="ident" id="3556779">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3556784">t</span><span class="op" id="3556785">.</span><span class="ident" id="3556786">nameSpace</span><span class="op" id="3556795">.</span><span class="ident" id="3556796">mu</span><span class="op" id="3556798">.</span><span class="ident" id="3556799">Unlock</span><span class="op" id="3556805">(</span><span class="op" id="3556806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3556809">ret</span><span class="op" id="3556812">,</span>&nbsp;<span class="ident" id="3556814">err</span>&nbsp;<span class="op" id="3556818">:=</span>&nbsp;<span class="ident" id="3556821">t</span><span class="op" id="3556822">.</span><span class="ident" id="3556823">text</span><span class="op" id="3556827">.</span><span class="ident" id="3556828">Parse</span><span class="op" id="3556833">(</span><span class="ident" id="3556834">src</span><span class="op" id="3556837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3556840">if</span>&nbsp;<span class="ident" id="3556843">err</span>&nbsp;<span class="op" id="3556847">!=</span>&nbsp;<span class="ident" id="3556850">nil</span>&nbsp;<span class="op" id="3556854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3556858">return</span>&nbsp;<span class="ident" id="3556865">nil</span><span class="op" id="3556868">,</span>&nbsp;<span class="ident" id="3556870">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3556875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3556878">//&nbsp;In&nbsp;general,&nbsp;all&nbsp;the&nbsp;named&nbsp;templates&nbsp;might&nbsp;have&nbsp;changed&nbsp;underfoot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3556948">//&nbsp;Regardless,&nbsp;some&nbsp;new&nbsp;ones&nbsp;may&nbsp;have&nbsp;been&nbsp;defined.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3557001">//&nbsp;The&nbsp;template.Template&nbsp;set&nbsp;has&nbsp;been&nbsp;updated;&nbsp;update&nbsp;ours.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3557062">t</span><span class="op" id="3557063">.</span><span class="ident" id="3557064">nameSpace</span><span class="op" id="3557073">.</span><span class="ident" id="3557074">mu</span><span class="op" id="3557076">.</span><span class="ident" id="3557077">Lock</span><span class="op" id="3557081">(</span><span class="op" id="3557082">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3557085">defer</span>&nbsp;<span class="ident" id="3557091">t</span><span class="op" id="3557092">.</span><span class="ident" id="3557093">nameSpace</span><span class="op" id="3557102">.</span><span class="ident" id="3557103">mu</span><span class="op" id="3557105">.</span><span class="ident" id="3557106">Unlock</span><span class="op" id="3557112">(</span><span class="op" id="3557113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3557116">for</span>&nbsp;<span class="ident" id="3557120">_</span><span class="op" id="3557121">,</span>&nbsp;<span class="ident" id="3557123">v</span>&nbsp;<span class="op" id="3557125">:=</span>&nbsp;<span class="keyword" id="3557128">range</span>&nbsp;<span class="ident" id="3557134">ret</span><span class="op" id="3557137">.</span><span class="ident" id="3557138">Templates</span><span class="op" id="3557147">(</span><span class="op" id="3557148">)</span>&nbsp;<span class="op" id="3557150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3557154">name</span>&nbsp;<span class="op" id="3557159">:=</span>&nbsp;<span class="ident" id="3557162">v</span><span class="op" id="3557163">.</span><span class="ident" id="3557164">Name</span><span class="op" id="3557168">(</span><span class="op" id="3557169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3557173">tmpl</span>&nbsp;<span class="op" id="3557178">:=</span>&nbsp;<span class="ident" id="3557181">t</span><span class="op" id="3557182">.</span><span class="ident" id="3557183">set</span><span class="op" id="3557186">[</span><span class="ident" id="3557187">name</span><span class="op" id="3557191">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3557195">if</span>&nbsp;<span class="ident" id="3557198">tmpl</span>&nbsp;<span class="op" id="3557203">==</span>&nbsp;<span class="ident" id="3557206">nil</span>&nbsp;<span class="op" id="3557210">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3557215">tmpl</span>&nbsp;<span class="op" id="3557220">=</span>&nbsp;<span class="ident" id="3557222">t</span><span class="op" id="3557223">.</span><span class="builtinfunc" id="3557224">new</span><span class="op" id="3557227">(</span><span class="ident" id="3557228">name</span><span class="op" id="3557232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3557236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3557240">//&nbsp;Restore&nbsp;our&nbsp;record&nbsp;of&nbsp;this&nbsp;text/template&nbsp;to&nbsp;its&nbsp;unescaped&nbsp;original&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3557319">tmpl</span><span class="op" id="3557323">.</span><span class="ident" id="3557324">escapeErr</span>&nbsp;<span class="op" id="3557334">=</span>&nbsp;<span class="ident" id="3557336">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3557342">tmpl</span><span class="op" id="3557346">.</span><span class="ident" id="3557347">text</span>&nbsp;<span class="op" id="3557352">=</span>&nbsp;<span class="ident" id="3557354">v</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3557358">tmpl</span><span class="op" id="3557362">.</span><span class="ident" id="3557363">Tree</span>&nbsp;<span class="op" id="3557368">=</span>&nbsp;<span class="ident" id="3557370">v</span><span class="op" id="3557371">.</span><span class="ident" id="3557372">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3557378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3557381">return</span>&nbsp;<span class="ident" id="3557388">t</span><span class="op" id="3557389">,</span>&nbsp;<span class="ident" id="3557391">nil</span><br>
<span class="lineno"></span><span class="op" id="3557395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="3557398">//&nbsp;AddParseTree&nbsp;creates&nbsp;a&nbsp;new&nbsp;template&nbsp;with&nbsp;the&nbsp;name&nbsp;and&nbsp;parse&nbsp;tree</span><br>
<span class="lineno"></span><span class="comment" id="3557466">//&nbsp;and&nbsp;associates&nbsp;it&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="3557495">//</span><br>
<span class="lineno"></span><span class="comment" id="3557498">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="3557553">func</span>&nbsp;<span class="op" id="3557558">(</span><span class="ident" id="3557559">t</span>&nbsp;<span class="op" id="3557561">*</span><span class="ident" id="3557562">Template</span><span class="op" id="3557570">)</span>&nbsp;<span class="ident" id="3557572">AddParseTree</span><span class="op" id="3557584">(</span><span class="ident" id="3557585">name</span>&nbsp;<span class="builtintype" id="3557590">string</span><span class="op" id="3557596">,</span>&nbsp;<span class="ident" id="3557598">tree</span>&nbsp;<span class="op" id="3557603">*</span><span class="ident" id="3557604">parse</span><span class="op" id="3557609">.</span><span class="ident" id="3557610">Tree</span><span class="op" id="3557614">)</span>&nbsp;<span class="op" id="3557616">(</span><span class="op" id="3557617">*</span><span class="ident" id="3557618">Template</span><span class="op" id="3557626">,</span>&nbsp;<span class="builtintype" id="3557628">error</span><span class="op" id="3557633">)</span>&nbsp;<span class="op" id="3557635">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3557638">t</span><span class="op" id="3557639">.</span><span class="ident" id="3557640">nameSpace</span><span class="op" id="3557649">.</span><span class="ident" id="3557650">mu</span><span class="op" id="3557652">.</span><span class="ident" id="3557653">Lock</span><span class="op" id="3557657">(</span><span class="op" id="3557658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3557661">defer</span>&nbsp;<span class="ident" id="3557667">t</span><span class="op" id="3557668">.</span><span class="ident" id="3557669">nameSpace</span><span class="op" id="3557678">.</span><span class="ident" id="3557679">mu</span><span class="op" id="3557681">.</span><span class="ident" id="3557682">Unlock</span><span class="op" id="3557688">(</span><span class="op" id="3557689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3557692">if</span>&nbsp;<span class="ident" id="3557695">t</span><span class="op" id="3557696">.</span><span class="ident" id="3557697">escapeErr</span>&nbsp;<span class="op" id="3557707">!=</span>&nbsp;<span class="ident" id="3557710">nil</span>&nbsp;<span class="op" id="3557714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3557718">return</span>&nbsp;<span class="ident" id="3557725">nil</span><span class="op" id="3557728">,</span>&nbsp;<span class="ident" id="3557730">fmt</span><span class="op" id="3557733">.</span><span class="ident" id="3557734">Errorf</span><span class="op" id="3557740">(</span><span class="string" id="3557741">&#34;html/template:&nbsp;cannot&nbsp;AddParseTree&nbsp;to&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="3557805">,</span>&nbsp;<span class="ident" id="3557807">t</span><span class="op" id="3557808">.</span><span class="ident" id="3557809">Name</span><span class="op" id="3557813">(</span><span class="op" id="3557814">)</span><span class="op" id="3557815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3557818">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3557821">text</span><span class="op" id="3557825">,</span>&nbsp;<span class="ident" id="3557827">err</span>&nbsp;<span class="op" id="3557831">:=</span>&nbsp;<span class="ident" id="3557834">t</span><span class="op" id="3557835">.</span><span class="ident" id="3557836">text</span><span class="op" id="3557840">.</span><span class="ident" id="3557841">AddParseTree</span><span class="op" id="3557853">(</span><span class="ident" id="3557854">name</span><span class="op" id="3557858">,</span>&nbsp;<span class="ident" id="3557860">tree</span><span class="op" id="3557864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3557867">if</span>&nbsp;<span class="ident" id="3557870">err</span>&nbsp;<span class="op" id="3557874">!=</span>&nbsp;<span class="ident" id="3557877">nil</span>&nbsp;<span class="op" id="3557881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3557885">return</span>&nbsp;<span class="ident" id="3557892">nil</span><span class="op" id="3557895">,</span>&nbsp;<span class="ident" id="3557897">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3557902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3557905">ret</span>&nbsp;<span class="op" id="3557909">:=</span>&nbsp;<span class="op" id="3557912">&amp;</span><span class="ident" id="3557913">Template</span><span class="op" id="3557921">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3557925">nil</span><span class="op" id="3557928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3557932">text</span><span class="op" id="3557936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3557940">text</span><span class="op" id="3557944">.</span><span class="ident" id="3557945">Tree</span><span class="op" id="3557949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3557953">t</span><span class="op" id="3557954">.</span><span class="ident" id="3557955">nameSpace</span><span class="op" id="3557964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3557967">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3557970">t</span><span class="op" id="3557971">.</span><span class="ident" id="3557972">set</span><span class="op" id="3557975">[</span><span class="ident" id="3557976">name</span><span class="op" id="3557980">]</span>&nbsp;<span class="op" id="3557982">=</span>&nbsp;<span class="ident" id="3557984">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3557989">return</span>&nbsp;<span class="ident" id="3557996">ret</span><span class="op" id="3557999">,</span>&nbsp;<span class="ident" id="3558001">nil</span><br>
<span class="lineno"></span><span class="op" id="3558005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3558008">//&nbsp;Clone&nbsp;returns&nbsp;a&nbsp;duplicate&nbsp;of&nbsp;the&nbsp;template,&nbsp;including&nbsp;all&nbsp;associated</span><br>
<span class="lineno">180</span><span class="comment" id="3558079">//&nbsp;templates.&nbsp;The&nbsp;actual&nbsp;representation&nbsp;is&nbsp;not&nbsp;copied,&nbsp;but&nbsp;the&nbsp;name&nbsp;space&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3558156">//&nbsp;associated&nbsp;templates&nbsp;is,&nbsp;so&nbsp;further&nbsp;calls&nbsp;to&nbsp;Parse&nbsp;in&nbsp;the&nbsp;copy&nbsp;will&nbsp;add</span><br>
<span class="lineno"></span><span class="comment" id="3558231">//&nbsp;templates&nbsp;to&nbsp;the&nbsp;copy&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;original.&nbsp;Clone&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;prepare</span><br>
<span class="lineno"></span><span class="comment" id="3558310">//&nbsp;common&nbsp;templates&nbsp;and&nbsp;use&nbsp;them&nbsp;with&nbsp;variant&nbsp;definitions&nbsp;for&nbsp;other&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="3558388">//&nbsp;by&nbsp;adding&nbsp;the&nbsp;variants&nbsp;after&nbsp;the&nbsp;clone&nbsp;is&nbsp;made.</span><br>
<span class="lineno">185</span><span class="comment" id="3558439">//</span><br>
<span class="lineno"></span><span class="comment" id="3558442">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="3558497">func</span>&nbsp;<span class="op" id="3558502">(</span><span class="ident" id="3558503">t</span>&nbsp;<span class="op" id="3558505">*</span><span class="ident" id="3558506">Template</span><span class="op" id="3558514">)</span>&nbsp;<span class="ident" id="3558516">Clone</span><span class="op" id="3558521">(</span><span class="op" id="3558522">)</span>&nbsp;<span class="op" id="3558524">(</span><span class="op" id="3558525">*</span><span class="ident" id="3558526">Template</span><span class="op" id="3558534">,</span>&nbsp;<span class="builtintype" id="3558536">error</span><span class="op" id="3558541">)</span>&nbsp;<span class="op" id="3558543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3558546">t</span><span class="op" id="3558547">.</span><span class="ident" id="3558548">nameSpace</span><span class="op" id="3558557">.</span><span class="ident" id="3558558">mu</span><span class="op" id="3558560">.</span><span class="ident" id="3558561">Lock</span><span class="op" id="3558565">(</span><span class="op" id="3558566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3558569">defer</span>&nbsp;<span class="ident" id="3558575">t</span><span class="op" id="3558576">.</span><span class="ident" id="3558577">nameSpace</span><span class="op" id="3558586">.</span><span class="ident" id="3558587">mu</span><span class="op" id="3558589">.</span><span class="ident" id="3558590">Unlock</span><span class="op" id="3558596">(</span><span class="op" id="3558597">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3558600">if</span>&nbsp;<span class="ident" id="3558603">t</span><span class="op" id="3558604">.</span><span class="ident" id="3558605">escapeErr</span>&nbsp;<span class="op" id="3558615">!=</span>&nbsp;<span class="ident" id="3558618">nil</span>&nbsp;<span class="op" id="3558622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3558626">return</span>&nbsp;<span class="ident" id="3558633">nil</span><span class="op" id="3558636">,</span>&nbsp;<span class="ident" id="3558638">fmt</span><span class="op" id="3558641">.</span><span class="ident" id="3558642">Errorf</span><span class="op" id="3558648">(</span><span class="string" id="3558649">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="3558703">,</span>&nbsp;<span class="ident" id="3558705">t</span><span class="op" id="3558706">.</span><span class="ident" id="3558707">Name</span><span class="op" id="3558711">(</span><span class="op" id="3558712">)</span><span class="op" id="3558713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3558716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3558719">textClone</span><span class="op" id="3558728">,</span>&nbsp;<span class="ident" id="3558730">err</span>&nbsp;<span class="op" id="3558734">:=</span>&nbsp;<span class="ident" id="3558737">t</span><span class="op" id="3558738">.</span><span class="ident" id="3558739">text</span><span class="op" id="3558743">.</span><span class="ident" id="3558744">Clone</span><span class="op" id="3558749">(</span><span class="op" id="3558750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3558753">if</span>&nbsp;<span class="ident" id="3558756">err</span>&nbsp;<span class="op" id="3558760">!=</span>&nbsp;<span class="ident" id="3558763">nil</span>&nbsp;<span class="op" id="3558767">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3558771">return</span>&nbsp;<span class="ident" id="3558778">nil</span><span class="op" id="3558781">,</span>&nbsp;<span class="ident" id="3558783">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3558788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3558791">ret</span>&nbsp;<span class="op" id="3558795">:=</span>&nbsp;<span class="op" id="3558798">&amp;</span><span class="ident" id="3558799">Template</span><span class="op" id="3558807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3558811">nil</span><span class="op" id="3558814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3558818">textClone</span><span class="op" id="3558827">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3558831">textClone</span><span class="op" id="3558840">.</span><span class="ident" id="3558841">Tree</span><span class="op" id="3558845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3558849">&amp;</span><span class="ident" id="3558850">nameSpace</span><span class="op" id="3558859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3558864">set</span><span class="op" id="3558867">:</span>&nbsp;<span class="builtinfunc" id="3558869">make</span><span class="op" id="3558873">(</span><span class="keyword" id="3558874">map</span><span class="op" id="3558877">[</span><span class="builtintype" id="3558878">string</span><span class="op" id="3558884">]</span><span class="op" id="3558885">*</span><span class="ident" id="3558886">Template</span><span class="op" id="3558894">)</span><span class="op" id="3558895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3558899">}</span><span class="op" id="3558900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3558903">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3558906">for</span>&nbsp;<span class="ident" id="3558910">_</span><span class="op" id="3558911">,</span>&nbsp;<span class="ident" id="3558913">x</span>&nbsp;<span class="op" id="3558915">:=</span>&nbsp;<span class="keyword" id="3558918">range</span>&nbsp;<span class="ident" id="3558924">textClone</span><span class="op" id="3558933">.</span><span class="ident" id="3558934">Templates</span><span class="op" id="3558943">(</span><span class="op" id="3558944">)</span>&nbsp;<span class="op" id="3558946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3558950">name</span>&nbsp;<span class="op" id="3558955">:=</span>&nbsp;<span class="ident" id="3558958">x</span><span class="op" id="3558959">.</span><span class="ident" id="3558960">Name</span><span class="op" id="3558964">(</span><span class="op" id="3558965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3558969">src</span>&nbsp;<span class="op" id="3558973">:=</span>&nbsp;<span class="ident" id="3558976">t</span><span class="op" id="3558977">.</span><span class="ident" id="3558978">set</span><span class="op" id="3558981">[</span><span class="ident" id="3558982">name</span><span class="op" id="3558986">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3558990">if</span>&nbsp;<span class="ident" id="3558993">src</span>&nbsp;<span class="op" id="3558997">==</span>&nbsp;<span class="ident" id="3559000">nil</span>&nbsp;<span class="op" id="3559004">||</span>&nbsp;<span class="ident" id="3559007">src</span><span class="op" id="3559010">.</span><span class="ident" id="3559011">escapeErr</span>&nbsp;<span class="op" id="3559021">!=</span>&nbsp;<span class="ident" id="3559024">nil</span>&nbsp;<span class="op" id="3559028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3559033">return</span>&nbsp;<span class="ident" id="3559040">nil</span><span class="op" id="3559043">,</span>&nbsp;<span class="ident" id="3559045">fmt</span><span class="op" id="3559048">.</span><span class="ident" id="3559049">Errorf</span><span class="op" id="3559055">(</span><span class="string" id="3559056">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="3559110">,</span>&nbsp;<span class="ident" id="3559112">t</span><span class="op" id="3559113">.</span><span class="ident" id="3559114">Name</span><span class="op" id="3559118">(</span><span class="op" id="3559119">)</span><span class="op" id="3559120">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3559124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559128">x</span><span class="op" id="3559129">.</span><span class="ident" id="3559130">Tree</span>&nbsp;<span class="op" id="3559135">=</span>&nbsp;<span class="ident" id="3559137">x</span><span class="op" id="3559138">.</span><span class="ident" id="3559139">Tree</span><span class="op" id="3559143">.</span><span class="ident" id="3559144">Copy</span><span class="op" id="3559148">(</span><span class="op" id="3559149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559153">ret</span><span class="op" id="3559156">.</span><span class="ident" id="3559157">set</span><span class="op" id="3559160">[</span><span class="ident" id="3559161">name</span><span class="op" id="3559165">]</span>&nbsp;<span class="op" id="3559167">=</span>&nbsp;<span class="op" id="3559169">&amp;</span><span class="ident" id="3559170">Template</span><span class="op" id="3559178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559183">nil</span><span class="op" id="3559186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559191">x</span><span class="op" id="3559192">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559197">x</span><span class="op" id="3559198">.</span><span class="ident" id="3559199">Tree</span><span class="op" id="3559203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559208">ret</span><span class="op" id="3559211">.</span><span class="ident" id="3559212">nameSpace</span><span class="op" id="3559221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3559225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3559228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3559231">return</span>&nbsp;<span class="ident" id="3559238">ret</span><span class="op" id="3559241">,</span>&nbsp;<span class="ident" id="3559243">nil</span><br>
<span class="lineno">220</span><span class="op" id="3559247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3559250">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3559308">func</span>&nbsp;<span class="ident" id="3559313">New</span><span class="op" id="3559316">(</span><span class="ident" id="3559317">name</span>&nbsp;<span class="builtintype" id="3559322">string</span><span class="op" id="3559328">)</span>&nbsp;<span class="op" id="3559330">*</span><span class="ident" id="3559331">Template</span>&nbsp;<span class="op" id="3559340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559343">tmpl</span>&nbsp;<span class="op" id="3559348">:=</span>&nbsp;<span class="op" id="3559351">&amp;</span><span class="ident" id="3559352">Template</span><span class="op" id="3559360">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559364">nil</span><span class="op" id="3559367">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559371">template</span><span class="op" id="3559379">.</span><span class="ident" id="3559380">New</span><span class="op" id="3559383">(</span><span class="ident" id="3559384">name</span><span class="op" id="3559388">)</span><span class="op" id="3559389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559393">nil</span><span class="op" id="3559396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3559400">&amp;</span><span class="ident" id="3559401">nameSpace</span><span class="op" id="3559410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559415">set</span><span class="op" id="3559418">:</span>&nbsp;<span class="builtinfunc" id="3559420">make</span><span class="op" id="3559424">(</span><span class="keyword" id="3559425">map</span><span class="op" id="3559428">[</span><span class="builtintype" id="3559429">string</span><span class="op" id="3559435">]</span><span class="op" id="3559436">*</span><span class="ident" id="3559437">Template</span><span class="op" id="3559445">)</span><span class="op" id="3559446">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3559450">}</span><span class="op" id="3559451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3559454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559457">tmpl</span><span class="op" id="3559461">.</span><span class="ident" id="3559462">set</span><span class="op" id="3559465">[</span><span class="ident" id="3559466">name</span><span class="op" id="3559470">]</span>&nbsp;<span class="op" id="3559472">=</span>&nbsp;<span class="ident" id="3559474">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3559480">return</span>&nbsp;<span class="ident" id="3559487">tmpl</span><br>
<span class="lineno"></span><span class="op" id="3559492">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="3559495">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="3559562">//&nbsp;and&nbsp;with&nbsp;the&nbsp;same&nbsp;delimiters.&nbsp;The&nbsp;association,&nbsp;which&nbsp;is&nbsp;transitive,</span><br>
<span class="lineno"></span><span class="comment" id="3559633">//&nbsp;allows&nbsp;one&nbsp;template&nbsp;to&nbsp;invoke&nbsp;another&nbsp;with&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="3559702">func</span>&nbsp;<span class="op" id="3559707">(</span><span class="ident" id="3559708">t</span>&nbsp;<span class="op" id="3559710">*</span><span class="ident" id="3559711">Template</span><span class="op" id="3559719">)</span>&nbsp;<span class="ident" id="3559721">New</span><span class="op" id="3559724">(</span><span class="ident" id="3559725">name</span>&nbsp;<span class="builtintype" id="3559730">string</span><span class="op" id="3559736">)</span>&nbsp;<span class="op" id="3559738">*</span><span class="ident" id="3559739">Template</span>&nbsp;<span class="op" id="3559748">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559751">t</span><span class="op" id="3559752">.</span><span class="ident" id="3559753">nameSpace</span><span class="op" id="3559762">.</span><span class="ident" id="3559763">mu</span><span class="op" id="3559765">.</span><span class="ident" id="3559766">Lock</span><span class="op" id="3559770">(</span><span class="op" id="3559771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3559774">defer</span>&nbsp;<span class="ident" id="3559780">t</span><span class="op" id="3559781">.</span><span class="ident" id="3559782">nameSpace</span><span class="op" id="3559791">.</span><span class="ident" id="3559792">mu</span><span class="op" id="3559794">.</span><span class="ident" id="3559795">Unlock</span><span class="op" id="3559801">(</span><span class="op" id="3559802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3559805">return</span>&nbsp;<span class="ident" id="3559812">t</span><span class="op" id="3559813">.</span><span class="builtinfunc" id="3559814">new</span><span class="op" id="3559817">(</span><span class="ident" id="3559818">name</span><span class="op" id="3559822">)</span><br>
<span class="lineno"></span><span class="op" id="3559824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="3559827">//&nbsp;new&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;New,&nbsp;without&nbsp;the&nbsp;lock.</span><br>
<span class="lineno"></span><span class="keyword" id="3559882">func</span>&nbsp;<span class="op" id="3559887">(</span><span class="ident" id="3559888">t</span>&nbsp;<span class="op" id="3559890">*</span><span class="ident" id="3559891">Template</span><span class="op" id="3559899">)</span>&nbsp;<span class="builtinfunc" id="3559901">new</span><span class="op" id="3559904">(</span><span class="ident" id="3559905">name</span>&nbsp;<span class="builtintype" id="3559910">string</span><span class="op" id="3559916">)</span>&nbsp;<span class="op" id="3559918">*</span><span class="ident" id="3559919">Template</span>&nbsp;<span class="op" id="3559928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559931">tmpl</span>&nbsp;<span class="op" id="3559936">:=</span>&nbsp;<span class="op" id="3559939">&amp;</span><span class="ident" id="3559940">Template</span><span class="op" id="3559948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559952">nil</span><span class="op" id="3559955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559959">t</span><span class="op" id="3559960">.</span><span class="ident" id="3559961">text</span><span class="op" id="3559965">.</span><span class="ident" id="3559966">New</span><span class="op" id="3559969">(</span><span class="ident" id="3559970">name</span><span class="op" id="3559974">)</span><span class="op" id="3559975">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559979">nil</span><span class="op" id="3559982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559986">t</span><span class="op" id="3559987">.</span><span class="ident" id="3559988">nameSpace</span><span class="op" id="3559997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3560000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3560003">tmpl</span><span class="op" id="3560007">.</span><span class="ident" id="3560008">set</span><span class="op" id="3560011">[</span><span class="ident" id="3560012">name</span><span class="op" id="3560016">]</span>&nbsp;<span class="op" id="3560018">=</span>&nbsp;<span class="ident" id="3560020">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3560026">return</span>&nbsp;<span class="ident" id="3560033">tmpl</span><br>
<span class="lineno">255</span><span class="op" id="3560038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3560041">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="3560083">func</span>&nbsp;<span class="op" id="3560088">(</span><span class="ident" id="3560089">t</span>&nbsp;<span class="op" id="3560091">*</span><span class="ident" id="3560092">Template</span><span class="op" id="3560100">)</span>&nbsp;<span class="ident" id="3560102">Name</span><span class="op" id="3560106">(</span><span class="op" id="3560107">)</span>&nbsp;<span class="builtintype" id="3560109">string</span>&nbsp;<span class="op" id="3560116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3560119">return</span>&nbsp;<span class="ident" id="3560126">t</span><span class="op" id="3560127">.</span><span class="ident" id="3560128">text</span><span class="op" id="3560132">.</span><span class="ident" id="3560133">Name</span><span class="op" id="3560137">(</span><span class="op" id="3560138">)</span><br>
<span class="lineno">260</span><span class="op" id="3560140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3560143">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3560212">//&nbsp;functions.&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two</span><br>
<span class="lineno"></span><span class="comment" id="3560287">//&nbsp;return&nbsp;values&nbsp;of&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the</span><br>
<span class="lineno">265</span><span class="comment" id="3560361">//&nbsp;second&nbsp;(error)&nbsp;argument&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution</span><br>
<span class="lineno"></span><span class="comment" id="3560437">//&nbsp;terminates&nbsp;and&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.&nbsp;FuncMap&nbsp;has&nbsp;the&nbsp;same&nbsp;base&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="3560514">//&nbsp;as&nbsp;FuncMap&nbsp;in&nbsp;&#34;text/template&#34;,&nbsp;copied&nbsp;here&nbsp;so&nbsp;clients&nbsp;need&nbsp;not&nbsp;import</span><br>
<span class="lineno"></span><span class="comment" id="3560587">//&nbsp;&#34;text/template&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3560607">type</span>&nbsp;<span class="ident" id="3560612">FuncMap</span>&nbsp;<span class="keyword" id="3560620">map</span><span class="op" id="3560623">[</span><span class="builtintype" id="3560624">string</span><span class="op" id="3560630">]</span><span class="keyword" id="3560631">interface</span><span class="op" id="3560640">{</span><span class="op" id="3560641">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="3560644">//&nbsp;Funcs&nbsp;adds&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;argument&nbsp;map&nbsp;to&nbsp;the&nbsp;template&#39;s&nbsp;function&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="3560723">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;a&nbsp;value&nbsp;in&nbsp;the&nbsp;map&nbsp;is&nbsp;not&nbsp;a&nbsp;function&nbsp;with&nbsp;appropriate&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="3560800">//&nbsp;type.&nbsp;However,&nbsp;it&nbsp;is&nbsp;legal&nbsp;to&nbsp;overwrite&nbsp;elements&nbsp;of&nbsp;the&nbsp;map.&nbsp;The&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="3560875">//&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">275</span><span class="keyword" id="3560926">func</span>&nbsp;<span class="op" id="3560931">(</span><span class="ident" id="3560932">t</span>&nbsp;<span class="op" id="3560934">*</span><span class="ident" id="3560935">Template</span><span class="op" id="3560943">)</span>&nbsp;<span class="ident" id="3560945">Funcs</span><span class="op" id="3560950">(</span><span class="ident" id="3560951">funcMap</span>&nbsp;<span class="ident" id="3560959">FuncMap</span><span class="op" id="3560966">)</span>&nbsp;<span class="op" id="3560968">*</span><span class="ident" id="3560969">Template</span>&nbsp;<span class="op" id="3560978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3560981">t</span><span class="op" id="3560982">.</span><span class="ident" id="3560983">text</span><span class="op" id="3560987">.</span><span class="ident" id="3560988">Funcs</span><span class="op" id="3560993">(</span><span class="ident" id="3560994">template</span><span class="op" id="3561002">.</span><span class="ident" id="3561003">FuncMap</span><span class="op" id="3561010">(</span><span class="ident" id="3561011">funcMap</span><span class="op" id="3561018">)</span><span class="op" id="3561019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3561022">return</span>&nbsp;<span class="ident" id="3561029">t</span><br>
<span class="lineno"></span><span class="op" id="3561031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="comment" id="3561034">//&nbsp;Delims&nbsp;sets&nbsp;the&nbsp;action&nbsp;delimiters&nbsp;to&nbsp;the&nbsp;specified&nbsp;strings,&nbsp;to&nbsp;be&nbsp;used&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3561111">//&nbsp;subsequent&nbsp;calls&nbsp;to&nbsp;Parse,&nbsp;ParseFiles,&nbsp;or&nbsp;ParseGlob.&nbsp;Nested&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="3561183">//&nbsp;definitions&nbsp;will&nbsp;inherit&nbsp;the&nbsp;settings.&nbsp;An&nbsp;empty&nbsp;delimiter&nbsp;stands&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3561259">//&nbsp;corresponding&nbsp;default:&nbsp;{{&nbsp;or&nbsp;}}.</span><br>
<span class="lineno"></span><span class="comment" id="3561295">//&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">285</span><span class="keyword" id="3561357">func</span>&nbsp;<span class="op" id="3561362">(</span><span class="ident" id="3561363">t</span>&nbsp;<span class="op" id="3561365">*</span><span class="ident" id="3561366">Template</span><span class="op" id="3561374">)</span>&nbsp;<span class="ident" id="3561376">Delims</span><span class="op" id="3561382">(</span><span class="ident" id="3561383">left</span><span class="op" id="3561387">,</span>&nbsp;<span class="ident" id="3561389">right</span>&nbsp;<span class="builtintype" id="3561395">string</span><span class="op" id="3561401">)</span>&nbsp;<span class="op" id="3561403">*</span><span class="ident" id="3561404">Template</span>&nbsp;<span class="op" id="3561413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3561416">t</span><span class="op" id="3561417">.</span><span class="ident" id="3561418">text</span><span class="op" id="3561422">.</span><span class="ident" id="3561423">Delims</span><span class="op" id="3561429">(</span><span class="ident" id="3561430">left</span><span class="op" id="3561434">,</span>&nbsp;<span class="ident" id="3561436">right</span><span class="op" id="3561441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3561444">return</span>&nbsp;<span class="ident" id="3561451">t</span><br>
<span class="lineno"></span><span class="op" id="3561453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="comment" id="3561456">//&nbsp;Lookup&nbsp;returns&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;that&nbsp;is&nbsp;associated&nbsp;with&nbsp;t,</span><br>
<span class="lineno"></span><span class="comment" id="3561534">//&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="3561574">func</span>&nbsp;<span class="op" id="3561579">(</span><span class="ident" id="3561580">t</span>&nbsp;<span class="op" id="3561582">*</span><span class="ident" id="3561583">Template</span><span class="op" id="3561591">)</span>&nbsp;<span class="ident" id="3561593">Lookup</span><span class="op" id="3561599">(</span><span class="ident" id="3561600">name</span>&nbsp;<span class="builtintype" id="3561605">string</span><span class="op" id="3561611">)</span>&nbsp;<span class="op" id="3561613">*</span><span class="ident" id="3561614">Template</span>&nbsp;<span class="op" id="3561623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3561626">t</span><span class="op" id="3561627">.</span><span class="ident" id="3561628">nameSpace</span><span class="op" id="3561637">.</span><span class="ident" id="3561638">mu</span><span class="op" id="3561640">.</span><span class="ident" id="3561641">Lock</span><span class="op" id="3561645">(</span><span class="op" id="3561646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3561649">defer</span>&nbsp;<span class="ident" id="3561655">t</span><span class="op" id="3561656">.</span><span class="ident" id="3561657">nameSpace</span><span class="op" id="3561666">.</span><span class="ident" id="3561667">mu</span><span class="op" id="3561669">.</span><span class="ident" id="3561670">Unlock</span><span class="op" id="3561676">(</span><span class="op" id="3561677">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3561680">return</span>&nbsp;<span class="ident" id="3561687">t</span><span class="op" id="3561688">.</span><span class="ident" id="3561689">set</span><span class="op" id="3561692">[</span><span class="ident" id="3561693">name</span><span class="op" id="3561697">]</span><br>
<span class="lineno"></span><span class="op" id="3561699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3561702">//&nbsp;Must&nbsp;is&nbsp;a&nbsp;helper&nbsp;that&nbsp;wraps&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;function&nbsp;returning&nbsp;(*Template,&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="3561783">//&nbsp;and&nbsp;panics&nbsp;if&nbsp;the&nbsp;error&nbsp;is&nbsp;non-nil.&nbsp;It&nbsp;is&nbsp;intended&nbsp;for&nbsp;use&nbsp;in&nbsp;variable&nbsp;initializations</span><br>
<span class="lineno">300</span><span class="comment" id="3561873">//&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3561884">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;t&nbsp;=&nbsp;template.Must(template.New(&#34;name&#34;).Parse(&#34;html&#34;))</span><br>
<span class="lineno"></span><span class="keyword" id="3561945">func</span>&nbsp;<span class="ident" id="3561950">Must</span><span class="op" id="3561954">(</span><span class="ident" id="3561955">t</span>&nbsp;<span class="op" id="3561957">*</span><span class="ident" id="3561958">Template</span><span class="op" id="3561966">,</span>&nbsp;<span class="ident" id="3561968">err</span>&nbsp;<span class="builtintype" id="3561972">error</span><span class="op" id="3561977">)</span>&nbsp;<span class="op" id="3561979">*</span><span class="ident" id="3561980">Template</span>&nbsp;<span class="op" id="3561989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3561992">if</span>&nbsp;<span class="ident" id="3561995">err</span>&nbsp;<span class="op" id="3561999">!=</span>&nbsp;<span class="ident" id="3562002">nil</span>&nbsp;<span class="op" id="3562006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3562010">panic</span><span class="op" id="3562015">(</span><span class="ident" id="3562016">err</span><span class="op" id="3562019">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3562022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3562025">return</span>&nbsp;<span class="ident" id="3562032">t</span><br>
<span class="lineno"></span><span class="op" id="3562034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3562037">//&nbsp;ParseFiles&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from</span><br>
<span class="lineno">310</span><span class="comment" id="3562115">//&nbsp;the&nbsp;named&nbsp;files.&nbsp;The&nbsp;returned&nbsp;template&#39;s&nbsp;name&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3562194">//&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the&nbsp;first&nbsp;file.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="3562267">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;*Template&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3562339">func</span>&nbsp;<span class="ident" id="3562344">ParseFiles</span><span class="op" id="3562354">(</span><span class="ident" id="3562355">filenames</span>&nbsp;<span class="op" id="3562365">...</span><span class="builtintype" id="3562368">string</span><span class="op" id="3562374">)</span>&nbsp;<span class="op" id="3562376">(</span><span class="op" id="3562377">*</span><span class="ident" id="3562378">Template</span><span class="op" id="3562386">,</span>&nbsp;<span class="builtintype" id="3562388">error</span><span class="op" id="3562393">)</span>&nbsp;<span class="op" id="3562395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3562398">return</span>&nbsp;<span class="ident" id="3562405">parseFiles</span><span class="op" id="3562415">(</span><span class="ident" id="3562416">nil</span><span class="op" id="3562419">,</span>&nbsp;<span class="ident" id="3562421">filenames</span><span class="op" id="3562430">...</span><span class="op" id="3562433">)</span><br>
<span class="lineno">315</span><span class="op" id="3562435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3562438">//&nbsp;ParseFiles&nbsp;parses&nbsp;the&nbsp;named&nbsp;files&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="3562519">//&nbsp;t.&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;template&nbsp;is&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="3562593">//&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;t.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno">320</span><span class="keyword" id="3562648">func</span>&nbsp;<span class="op" id="3562653">(</span><span class="ident" id="3562654">t</span>&nbsp;<span class="op" id="3562656">*</span><span class="ident" id="3562657">Template</span><span class="op" id="3562665">)</span>&nbsp;<span class="ident" id="3562667">ParseFiles</span><span class="op" id="3562677">(</span><span class="ident" id="3562678">filenames</span>&nbsp;<span class="op" id="3562688">...</span><span class="builtintype" id="3562691">string</span><span class="op" id="3562697">)</span>&nbsp;<span class="op" id="3562699">(</span><span class="op" id="3562700">*</span><span class="ident" id="3562701">Template</span><span class="op" id="3562709">,</span>&nbsp;<span class="builtintype" id="3562711">error</span><span class="op" id="3562716">)</span>&nbsp;<span class="op" id="3562718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3562721">return</span>&nbsp;<span class="ident" id="3562728">parseFiles</span><span class="op" id="3562738">(</span><span class="ident" id="3562739">t</span><span class="op" id="3562740">,</span>&nbsp;<span class="ident" id="3562742">filenames</span><span class="op" id="3562751">...</span><span class="op" id="3562754">)</span><br>
<span class="lineno"></span><span class="op" id="3562756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3562759">//&nbsp;parseFiles&nbsp;is&nbsp;the&nbsp;helper&nbsp;for&nbsp;the&nbsp;method&nbsp;and&nbsp;function.&nbsp;If&nbsp;the&nbsp;argument</span><br>
<span class="lineno">325</span><span class="comment" id="3562832">//&nbsp;template&nbsp;is&nbsp;nil,&nbsp;it&nbsp;is&nbsp;created&nbsp;from&nbsp;the&nbsp;first&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="3562887">func</span>&nbsp;<span class="ident" id="3562892">parseFiles</span><span class="op" id="3562902">(</span><span class="ident" id="3562903">t</span>&nbsp;<span class="op" id="3562905">*</span><span class="ident" id="3562906">Template</span><span class="op" id="3562914">,</span>&nbsp;<span class="ident" id="3562916">filenames</span>&nbsp;<span class="op" id="3562926">...</span><span class="builtintype" id="3562929">string</span><span class="op" id="3562935">)</span>&nbsp;<span class="op" id="3562937">(</span><span class="op" id="3562938">*</span><span class="ident" id="3562939">Template</span><span class="op" id="3562947">,</span>&nbsp;<span class="builtintype" id="3562949">error</span><span class="op" id="3562954">)</span>&nbsp;<span class="op" id="3562956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3562959">if</span>&nbsp;<span class="builtinfunc" id="3562962">len</span><span class="op" id="3562965">(</span><span class="ident" id="3562966">filenames</span><span class="op" id="3562975">)</span>&nbsp;<span class="op" id="3562977">==</span>&nbsp;<span class="num" id="3562980">0</span>&nbsp;<span class="op" id="3562982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3562986">//&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem,&nbsp;but&nbsp;be&nbsp;consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3563032">return</span>&nbsp;<span class="ident" id="3563039">nil</span><span class="op" id="3563042">,</span>&nbsp;<span class="ident" id="3563044">fmt</span><span class="op" id="3563047">.</span><span class="ident" id="3563048">Errorf</span><span class="op" id="3563054">(</span><span class="string" id="3563055">&#34;html/template:&nbsp;no&nbsp;files&nbsp;named&nbsp;in&nbsp;call&nbsp;to&nbsp;ParseFiles&#34;</span><span class="op" id="3563108">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3563111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3563114">for</span>&nbsp;<span class="ident" id="3563118">_</span><span class="op" id="3563119">,</span>&nbsp;<span class="ident" id="3563121">filename</span>&nbsp;<span class="op" id="3563130">:=</span>&nbsp;<span class="keyword" id="3563133">range</span>&nbsp;<span class="ident" id="3563139">filenames</span>&nbsp;<span class="op" id="3563149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3563153">b</span><span class="op" id="3563154">,</span>&nbsp;<span class="ident" id="3563156">err</span>&nbsp;<span class="op" id="3563160">:=</span>&nbsp;<span class="ident" id="3563163">ioutil</span><span class="op" id="3563169">.</span><span class="ident" id="3563170">ReadFile</span><span class="op" id="3563178">(</span><span class="ident" id="3563179">filename</span><span class="op" id="3563187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3563191">if</span>&nbsp;<span class="ident" id="3563194">err</span>&nbsp;<span class="op" id="3563198">!=</span>&nbsp;<span class="ident" id="3563201">nil</span>&nbsp;<span class="op" id="3563205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3563210">return</span>&nbsp;<span class="ident" id="3563217">nil</span><span class="op" id="3563220">,</span>&nbsp;<span class="ident" id="3563222">err</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3563228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3563232">s</span>&nbsp;<span class="op" id="3563234">:=</span>&nbsp;<span class="builtintype" id="3563237">string</span><span class="op" id="3563243">(</span><span class="ident" id="3563244">b</span><span class="op" id="3563245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3563249">name</span>&nbsp;<span class="op" id="3563254">:=</span>&nbsp;<span class="ident" id="3563257">filepath</span><span class="op" id="3563265">.</span><span class="ident" id="3563266">Base</span><span class="op" id="3563270">(</span><span class="ident" id="3563271">filename</span><span class="op" id="3563279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3563283">//&nbsp;First&nbsp;template&nbsp;becomes&nbsp;return&nbsp;value&nbsp;if&nbsp;not&nbsp;already&nbsp;defined,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3563348">//&nbsp;and&nbsp;we&nbsp;use&nbsp;that&nbsp;one&nbsp;for&nbsp;subsequent&nbsp;New&nbsp;calls&nbsp;to&nbsp;associate</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3563411">//&nbsp;all&nbsp;the&nbsp;templates&nbsp;together.&nbsp;Also,&nbsp;if&nbsp;this&nbsp;file&nbsp;has&nbsp;the&nbsp;same&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3563481">//&nbsp;as&nbsp;t,&nbsp;this&nbsp;file&nbsp;becomes&nbsp;the&nbsp;contents&nbsp;of&nbsp;t,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3563532">//&nbsp;&nbsp;t,&nbsp;err&nbsp;:=&nbsp;New(name).Funcs(xxx).ParseFiles(name)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3563586">//&nbsp;works.&nbsp;Otherwise&nbsp;we&nbsp;create&nbsp;a&nbsp;new&nbsp;template&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3563652">var</span>&nbsp;<span class="ident" id="3563656">tmpl</span>&nbsp;<span class="op" id="3563661">*</span><span class="ident" id="3563662">Template</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3563673">if</span>&nbsp;<span class="ident" id="3563676">t</span>&nbsp;<span class="op" id="3563678">==</span>&nbsp;<span class="ident" id="3563681">nil</span>&nbsp;<span class="op" id="3563685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3563690">t</span>&nbsp;<span class="op" id="3563692">=</span>&nbsp;<span class="ident" id="3563694">New</span><span class="op" id="3563697">(</span><span class="ident" id="3563698">name</span><span class="op" id="3563702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3563706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3563710">if</span>&nbsp;<span class="ident" id="3563713">name</span>&nbsp;<span class="op" id="3563718">==</span>&nbsp;<span class="ident" id="3563721">t</span><span class="op" id="3563722">.</span><span class="ident" id="3563723">Name</span><span class="op" id="3563727">(</span><span class="op" id="3563728">)</span>&nbsp;<span class="op" id="3563730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3563735">tmpl</span>&nbsp;<span class="op" id="3563740">=</span>&nbsp;<span class="ident" id="3563742">t</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3563746">}</span>&nbsp;<span class="keyword" id="3563748">else</span>&nbsp;<span class="op" id="3563753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3563758">tmpl</span>&nbsp;<span class="op" id="3563763">=</span>&nbsp;<span class="ident" id="3563765">t</span><span class="op" id="3563766">.</span><span class="ident" id="3563767">New</span><span class="op" id="3563770">(</span><span class="ident" id="3563771">name</span><span class="op" id="3563775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3563779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3563783">_</span><span class="op" id="3563784">,</span>&nbsp;<span class="ident" id="3563786">err</span>&nbsp;<span class="op" id="3563790">=</span>&nbsp;<span class="ident" id="3563792">tmpl</span><span class="op" id="3563796">.</span><span class="ident" id="3563797">Parse</span><span class="op" id="3563802">(</span><span class="ident" id="3563803">s</span><span class="op" id="3563804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3563808">if</span>&nbsp;<span class="ident" id="3563811">err</span>&nbsp;<span class="op" id="3563815">!=</span>&nbsp;<span class="ident" id="3563818">nil</span>&nbsp;<span class="op" id="3563822">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3563827">return</span>&nbsp;<span class="ident" id="3563834">nil</span><span class="op" id="3563837">,</span>&nbsp;<span class="ident" id="3563839">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3563845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3563848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3563851">return</span>&nbsp;<span class="ident" id="3563858">t</span><span class="op" id="3563859">,</span>&nbsp;<span class="ident" id="3563861">nil</span><br>
<span class="lineno"></span><span class="op" id="3563865">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="3563868">//&nbsp;ParseGlob&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3563949">//&nbsp;files&nbsp;identified&nbsp;by&nbsp;the&nbsp;pattern,&nbsp;which&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3564025">//&nbsp;returned&nbsp;template&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3564101">//&nbsp;first&nbsp;file&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.&nbsp;ParseGlob&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling</span><br>
<span class="lineno">365</span><span class="comment" id="3564174">//&nbsp;ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.</span><br>
<span class="lineno"></span><span class="keyword" id="3564235">func</span>&nbsp;<span class="ident" id="3564240">ParseGlob</span><span class="op" id="3564249">(</span><span class="ident" id="3564250">pattern</span>&nbsp;<span class="builtintype" id="3564258">string</span><span class="op" id="3564264">)</span>&nbsp;<span class="op" id="3564266">(</span><span class="op" id="3564267">*</span><span class="ident" id="3564268">Template</span><span class="op" id="3564276">,</span>&nbsp;<span class="builtintype" id="3564278">error</span><span class="op" id="3564283">)</span>&nbsp;<span class="op" id="3564285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3564288">return</span>&nbsp;<span class="ident" id="3564295">parseGlob</span><span class="op" id="3564304">(</span><span class="ident" id="3564305">nil</span><span class="op" id="3564308">,</span>&nbsp;<span class="ident" id="3564310">pattern</span><span class="op" id="3564317">)</span><br>
<span class="lineno"></span><span class="op" id="3564319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="comment" id="3564322">//&nbsp;ParseGlob&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;in&nbsp;the&nbsp;files&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3564398">//&nbsp;pattern&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with&nbsp;t.&nbsp;The&nbsp;pattern&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3564471">//&nbsp;processed&nbsp;by&nbsp;filepath.Glob&nbsp;and&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;ParseGlob&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3564548">//&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;t.ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3564624">//&nbsp;pattern.</span><br>
<span class="lineno">375</span><span class="keyword" id="3564636">func</span>&nbsp;<span class="op" id="3564641">(</span><span class="ident" id="3564642">t</span>&nbsp;<span class="op" id="3564644">*</span><span class="ident" id="3564645">Template</span><span class="op" id="3564653">)</span>&nbsp;<span class="ident" id="3564655">ParseGlob</span><span class="op" id="3564664">(</span><span class="ident" id="3564665">pattern</span>&nbsp;<span class="builtintype" id="3564673">string</span><span class="op" id="3564679">)</span>&nbsp;<span class="op" id="3564681">(</span><span class="op" id="3564682">*</span><span class="ident" id="3564683">Template</span><span class="op" id="3564691">,</span>&nbsp;<span class="builtintype" id="3564693">error</span><span class="op" id="3564698">)</span>&nbsp;<span class="op" id="3564700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3564703">return</span>&nbsp;<span class="ident" id="3564710">parseGlob</span><span class="op" id="3564719">(</span><span class="ident" id="3564720">t</span><span class="op" id="3564721">,</span>&nbsp;<span class="ident" id="3564723">pattern</span><span class="op" id="3564730">)</span><br>
<span class="lineno"></span><span class="op" id="3564732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3564735">//&nbsp;parseGlob&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;function&nbsp;and&nbsp;method&nbsp;ParseGlob.</span><br>
<span class="lineno">380</span><span class="keyword" id="3564808">func</span>&nbsp;<span class="ident" id="3564813">parseGlob</span><span class="op" id="3564822">(</span><span class="ident" id="3564823">t</span>&nbsp;<span class="op" id="3564825">*</span><span class="ident" id="3564826">Template</span><span class="op" id="3564834">,</span>&nbsp;<span class="ident" id="3564836">pattern</span>&nbsp;<span class="builtintype" id="3564844">string</span><span class="op" id="3564850">)</span>&nbsp;<span class="op" id="3564852">(</span><span class="op" id="3564853">*</span><span class="ident" id="3564854">Template</span><span class="op" id="3564862">,</span>&nbsp;<span class="builtintype" id="3564864">error</span><span class="op" id="3564869">)</span>&nbsp;<span class="op" id="3564871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3564874">filenames</span><span class="op" id="3564883">,</span>&nbsp;<span class="ident" id="3564885">err</span>&nbsp;<span class="op" id="3564889">:=</span>&nbsp;<span class="ident" id="3564892">filepath</span><span class="op" id="3564900">.</span><span class="ident" id="3564901">Glob</span><span class="op" id="3564905">(</span><span class="ident" id="3564906">pattern</span><span class="op" id="3564913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3564916">if</span>&nbsp;<span class="ident" id="3564919">err</span>&nbsp;<span class="op" id="3564923">!=</span>&nbsp;<span class="ident" id="3564926">nil</span>&nbsp;<span class="op" id="3564930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3564934">return</span>&nbsp;<span class="ident" id="3564941">nil</span><span class="op" id="3564944">,</span>&nbsp;<span class="ident" id="3564946">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3564951">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3564954">if</span>&nbsp;<span class="builtinfunc" id="3564957">len</span><span class="op" id="3564960">(</span><span class="ident" id="3564961">filenames</span><span class="op" id="3564970">)</span>&nbsp;<span class="op" id="3564972">==</span>&nbsp;<span class="num" id="3564975">0</span>&nbsp;<span class="op" id="3564977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3564981">return</span>&nbsp;<span class="ident" id="3564988">nil</span><span class="op" id="3564991">,</span>&nbsp;<span class="ident" id="3564993">fmt</span><span class="op" id="3564996">.</span><span class="ident" id="3564997">Errorf</span><span class="op" id="3565003">(</span><span class="string" id="3565004">&#34;html/template:&nbsp;pattern&nbsp;matches&nbsp;no&nbsp;files:&nbsp;%#q&#34;</span><span class="op" id="3565050">,</span>&nbsp;<span class="ident" id="3565052">pattern</span><span class="op" id="3565059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3565062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3565065">return</span>&nbsp;<span class="ident" id="3565072">parseFiles</span><span class="op" id="3565082">(</span><span class="ident" id="3565083">t</span><span class="op" id="3565084">,</span>&nbsp;<span class="ident" id="3565086">filenames</span><span class="op" id="3565095">...</span><span class="op" id="3565098">)</span><br>
<span class="lineno"></span><span class="op" id="3565100">}</span>
</div>
</body>
</html>
