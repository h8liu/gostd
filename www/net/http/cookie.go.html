<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3750976">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3751031">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3751085">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3751136">package</span>&nbsp;<span class="ident" id="3751144">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3751150">import</span>&nbsp;<span class="op" id="3751157">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3751160">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3751169">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3751176">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3751183">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3751190">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3751201">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3751212">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="3751219">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3751222">//&nbsp;This&nbsp;implementation&nbsp;is&nbsp;done&nbsp;according&nbsp;to&nbsp;RFC&nbsp;6265:</span><br>
<span class="lineno"></span><span class="comment" id="3751276">//</span><br>
<span class="lineno"></span><span class="comment" id="3751279">//&nbsp;&nbsp;&nbsp;&nbsp;http://tools.ietf.org/html/rfc6265</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3751321">//&nbsp;A&nbsp;Cookie&nbsp;represents&nbsp;an&nbsp;HTTP&nbsp;cookie&nbsp;as&nbsp;sent&nbsp;in&nbsp;the&nbsp;Set-Cookie&nbsp;header&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3751398">//&nbsp;HTTP&nbsp;response&nbsp;or&nbsp;the&nbsp;Cookie&nbsp;header&nbsp;of&nbsp;an&nbsp;HTTP&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="3751456">type</span>&nbsp;<span class="ident" id="3751461">Cookie</span>&nbsp;<span class="keyword" id="3751468">struct</span>&nbsp;<span class="op" id="3751475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3751478">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3751489">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3751497">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3751508">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3751516">Path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3751527">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3751535">Domain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3751546">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3751554">Expires</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3751565"><a href="/net/http/cookie.go.html#3751212">time</a></span><span class="op" id="3751569">.</span><span class="ident" id="3751570">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3751576">RawExpires</span>&nbsp;<span class="builtintype" id="3751587">string</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3751596">//&nbsp;MaxAge=0&nbsp;means&nbsp;no&nbsp;&#39;Max-Age&#39;&nbsp;attribute&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3751649">//&nbsp;MaxAge&lt;0&nbsp;means&nbsp;delete&nbsp;cookie&nbsp;now,&nbsp;equivalently&nbsp;&#39;Max-Age:&nbsp;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3751713">//&nbsp;MaxAge&gt;0&nbsp;means&nbsp;Max-Age&nbsp;attribute&nbsp;present&nbsp;and&nbsp;given&nbsp;in&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3751779">MaxAge</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3751788">int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3751793">Secure</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3751802">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3751808">HttpOnly</span>&nbsp;<span class="builtintype" id="3751817">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3751823">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3751832">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3751840">Unparsed</span>&nbsp;<span class="op" id="3751849">[</span><span class="op" id="3751850">]</span><span class="builtintype" id="3751851">string</span>&nbsp;<span class="comment" id="3751858">//&nbsp;Raw&nbsp;text&nbsp;of&nbsp;unparsed&nbsp;attribute-value&nbsp;pairs</span><br>
<span class="lineno"></span><span class="op" id="3751904">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3751907">//&nbsp;readSetCookies&nbsp;parses&nbsp;all&nbsp;&#34;Set-Cookie&#34;&nbsp;values&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="3751961">//&nbsp;the&nbsp;header&nbsp;h&nbsp;and&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="keyword" id="3752022">func</span>&nbsp;<span class="ident" id="3752027">readSetCookies</span><span class="op" id="3752041">(</span><span class="ident" id="3752042">h</span>&nbsp;<span class="ident" id="3752044"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3752050">)</span>&nbsp;<span class="op" id="3752052">[</span><span class="op" id="3752053">]</span><span class="op" id="3752054">*</span><span class="ident" id="3752055"><a href="/net/http/cookie.go.html#3751461">Cookie</a></span>&nbsp;<span class="op" id="3752062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752065">cookies</span>&nbsp;<span class="op" id="3752073">:=</span>&nbsp;<span class="op" id="3752076">[</span><span class="op" id="3752077">]</span><span class="op" id="3752078">*</span><span class="ident" id="3752079"><a href="/net/http/cookie.go.html#3751461">Cookie</a></span><span class="op" id="3752085">{</span><span class="op" id="3752086">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752089">for</span>&nbsp;<span class="ident" id="3752093">_</span><span class="op" id="3752094">,</span>&nbsp;<span class="ident" id="3752096">line</span>&nbsp;<span class="op" id="3752101">:=</span>&nbsp;<span class="keyword" id="3752104">range</span>&nbsp;<span class="ident" id="3752110"><a href="/net/http/cookie.go.html#3752042">h</a></span><span class="op" id="3752111">[</span><span class="string" id="3752112">&#34;Set-Cookie&#34;</span><span class="op" id="3752124">]</span>&nbsp;<span class="op" id="3752126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752130">parts</span>&nbsp;<span class="op" id="3752136">:=</span>&nbsp;<span class="ident" id="3752139"><a href="/net/http/cookie.go.html#3751201">strings</a></span><span class="op" id="3752146">.</span><span class="ident" id="3752147">Split</span><span class="op" id="3752152">(</span><span class="ident" id="3752153"><a href="/net/http/cookie.go.html#3751201">strings</a></span><span class="op" id="3752160">.</span><span class="ident" id="3752161">TrimSpace</span><span class="op" id="3752170">(</span><span class="ident" id="3752171"><a href="/net/http/cookie.go.html#3752096">line</a></span><span class="op" id="3752175">)</span><span class="op" id="3752176">,</span>&nbsp;<span class="string" id="3752178">&#34;;&#34;</span><span class="op" id="3752181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752185">if</span>&nbsp;<span class="builtinfunc" id="3752188">len</span><span class="op" id="3752191">(</span><span class="ident" id="3752192"><a href="/net/http/cookie.go.html#3752130">parts</a></span><span class="op" id="3752197">)</span>&nbsp;<span class="op" id="3752199">==</span>&nbsp;<span class="num" id="3752202">1</span>&nbsp;<span class="op" id="3752204">&amp;&amp;</span>&nbsp;<span class="ident" id="3752207"><a href="/net/http/cookie.go.html#3752130">parts</a></span><span class="op" id="3752212">[</span><span class="num" id="3752213">0</span><span class="op" id="3752214">]</span>&nbsp;<span class="op" id="3752216">==</span>&nbsp;<span class="string" id="3752219">&#34;&#34;</span>&nbsp;<span class="op" id="3752222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752227">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3752238">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752242"><a href="/net/http/cookie.go.html#3752130">parts</a></span><span class="op" id="3752247">[</span><span class="num" id="3752248">0</span><span class="op" id="3752249">]</span>&nbsp;<span class="op" id="3752251">=</span>&nbsp;<span class="ident" id="3752253"><a href="/net/http/cookie.go.html#3751201">strings</a></span><span class="op" id="3752260">.</span><span class="ident" id="3752261">TrimSpace</span><span class="op" id="3752270">(</span><span class="ident" id="3752271"><a href="/net/http/cookie.go.html#3752130">parts</a></span><span class="op" id="3752276">[</span><span class="num" id="3752277">0</span><span class="op" id="3752278">]</span><span class="op" id="3752279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752283">j</span>&nbsp;<span class="op" id="3752285">:=</span>&nbsp;<span class="ident" id="3752288"><a href="/net/http/cookie.go.html#3751201">strings</a></span><span class="op" id="3752295">.</span><span class="ident" id="3752296">Index</span><span class="op" id="3752301">(</span><span class="ident" id="3752302"><a href="/net/http/cookie.go.html#3752130">parts</a></span><span class="op" id="3752307">[</span><span class="num" id="3752308">0</span><span class="op" id="3752309">]</span><span class="op" id="3752310">,</span>&nbsp;<span class="string" id="3752312">&#34;=&#34;</span><span class="op" id="3752315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752319">if</span>&nbsp;<span class="ident" id="3752322"><a href="/net/http/cookie.go.html#3752283">j</a></span>&nbsp;<span class="op" id="3752324">&lt;</span>&nbsp;<span class="num" id="3752326">0</span>&nbsp;<span class="op" id="3752328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752333">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3752344">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752348">name</span><span class="op" id="3752352">,</span>&nbsp;<span class="ident" id="3752354">value</span>&nbsp;<span class="op" id="3752360">:=</span>&nbsp;<span class="ident" id="3752363"><a href="/net/http/cookie.go.html#3752130">parts</a></span><span class="op" id="3752368">[</span><span class="num" id="3752369">0</span><span class="op" id="3752370">]</span><span class="op" id="3752371">[</span><span class="op" id="3752372">:</span><span class="ident" id="3752373"><a href="/net/http/cookie.go.html#3752283">j</a></span><span class="op" id="3752374">]</span><span class="op" id="3752375">,</span>&nbsp;<span class="ident" id="3752377"><a href="/net/http/cookie.go.html#3752130">parts</a></span><span class="op" id="3752382">[</span><span class="num" id="3752383">0</span><span class="op" id="3752384">]</span><span class="op" id="3752385">[</span><span class="ident" id="3752386"><a href="/net/http/cookie.go.html#3752283">j</a></span><span class="op" id="3752387">+</span><span class="num" id="3752388">1</span><span class="op" id="3752389">:</span><span class="op" id="3752390">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752394">if</span>&nbsp;<span class="op" id="3752397">!</span><span class="ident" id="3752398"><a href="/net/http/cookie.go.html#3759748">isCookieNameValid</a></span><span class="op" id="3752415">(</span><span class="ident" id="3752416"><a href="/net/http/cookie.go.html#3752348">name</a></span><span class="op" id="3752420">)</span>&nbsp;<span class="op" id="3752422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752427">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3752438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752442"><a href="/net/http/cookie.go.html#3752354">value</a></span><span class="op" id="3752447">,</span>&nbsp;<span class="ident" id="3752449">success</span>&nbsp;<span class="op" id="3752457">:=</span>&nbsp;<span class="ident" id="3752460"><a href="/net/http/cookie.go.html#3759409">parseCookieValue</a></span><span class="op" id="3752476">(</span><span class="ident" id="3752477"><a href="/net/http/cookie.go.html#3752354">value</a></span><span class="op" id="3752482">,</span>&nbsp;<span class="ident" id="3752484">true</span><span class="op" id="3752488">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752492">if</span>&nbsp;<span class="op" id="3752495">!</span><span class="ident" id="3752496"><a href="/net/http/cookie.go.html#3752449">success</a></span>&nbsp;<span class="op" id="3752504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752509">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3752520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752524">c</span>&nbsp;<span class="op" id="3752526">:=</span>&nbsp;<span class="op" id="3752529">&amp;</span><span class="ident" id="3752530"><a href="/net/http/cookie.go.html#3751461">Cookie</a></span><span class="op" id="3752536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752541">Name</span><span class="op" id="3752545">:</span>&nbsp;&nbsp;<span class="ident" id="3752548"><a href="/net/http/cookie.go.html#3752348">name</a></span><span class="op" id="3752552">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752557">Value</span><span class="op" id="3752562">:</span>&nbsp;<span class="ident" id="3752564"><a href="/net/http/cookie.go.html#3752354">value</a></span><span class="op" id="3752569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752574">Raw</span><span class="op" id="3752577">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3752581"><a href="/net/http/cookie.go.html#3752096">line</a></span><span class="op" id="3752585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3752589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752593">for</span>&nbsp;<span class="ident" id="3752597">i</span>&nbsp;<span class="op" id="3752599">:=</span>&nbsp;<span class="num" id="3752602">1</span><span class="op" id="3752603">;</span>&nbsp;<span class="ident" id="3752605"><a href="/net/http/cookie.go.html#3752597">i</a></span>&nbsp;<span class="op" id="3752607">&lt;</span>&nbsp;<span class="builtinfunc" id="3752609">len</span><span class="op" id="3752612">(</span><span class="ident" id="3752613"><a href="/net/http/cookie.go.html#3752130">parts</a></span><span class="op" id="3752618">)</span><span class="op" id="3752619">;</span>&nbsp;<span class="ident" id="3752621"><a href="/net/http/cookie.go.html#3752597">i</a></span><span class="op" id="3752622">++</span>&nbsp;<span class="op" id="3752625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752630"><a href="/net/http/cookie.go.html#3752130">parts</a></span><span class="op" id="3752635">[</span><span class="ident" id="3752636"><a href="/net/http/cookie.go.html#3752597">i</a></span><span class="op" id="3752637">]</span>&nbsp;<span class="op" id="3752639">=</span>&nbsp;<span class="ident" id="3752641"><a href="/net/http/cookie.go.html#3751201">strings</a></span><span class="op" id="3752648">.</span><span class="ident" id="3752649">TrimSpace</span><span class="op" id="3752658">(</span><span class="ident" id="3752659"><a href="/net/http/cookie.go.html#3752130">parts</a></span><span class="op" id="3752664">[</span><span class="ident" id="3752665"><a href="/net/http/cookie.go.html#3752597">i</a></span><span class="op" id="3752666">]</span><span class="op" id="3752667">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752672">if</span>&nbsp;<span class="builtinfunc" id="3752675">len</span><span class="op" id="3752678">(</span><span class="ident" id="3752679"><a href="/net/http/cookie.go.html#3752130">parts</a></span><span class="op" id="3752684">[</span><span class="ident" id="3752685"><a href="/net/http/cookie.go.html#3752597">i</a></span><span class="op" id="3752686">]</span><span class="op" id="3752687">)</span>&nbsp;<span class="op" id="3752689">==</span>&nbsp;<span class="num" id="3752692">0</span>&nbsp;<span class="op" id="3752694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752700">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3752712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752718">attr</span><span class="op" id="3752722">,</span>&nbsp;<span class="ident" id="3752724">val</span>&nbsp;<span class="op" id="3752728">:=</span>&nbsp;<span class="ident" id="3752731"><a href="/net/http/cookie.go.html#3752130">parts</a></span><span class="op" id="3752736">[</span><span class="ident" id="3752737"><a href="/net/http/cookie.go.html#3752597">i</a></span><span class="op" id="3752738">]</span><span class="op" id="3752739">,</span>&nbsp;<span class="string" id="3752741">&#34;&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752747">if</span>&nbsp;<span class="ident" id="3752750">j</span>&nbsp;<span class="op" id="3752752">:=</span>&nbsp;<span class="ident" id="3752755"><a href="/net/http/cookie.go.html#3751201">strings</a></span><span class="op" id="3752762">.</span><span class="ident" id="3752763">Index</span><span class="op" id="3752768">(</span><span class="ident" id="3752769"><a href="/net/http/cookie.go.html#3752718">attr</a></span><span class="op" id="3752773">,</span>&nbsp;<span class="string" id="3752775">&#34;=&#34;</span><span class="op" id="3752778">)</span><span class="op" id="3752779">;</span>&nbsp;<span class="ident" id="3752781"><a href="/net/http/cookie.go.html#3752750">j</a></span>&nbsp;<span class="op" id="3752783">&gt;=</span>&nbsp;<span class="num" id="3752786">0</span>&nbsp;<span class="op" id="3752788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752794"><a href="/net/http/cookie.go.html#3752718">attr</a></span><span class="op" id="3752798">,</span>&nbsp;<span class="ident" id="3752800"><a href="/net/http/cookie.go.html#3752724">val</a></span>&nbsp;<span class="op" id="3752804">=</span>&nbsp;<span class="ident" id="3752806"><a href="/net/http/cookie.go.html#3752718">attr</a></span><span class="op" id="3752810">[</span><span class="op" id="3752811">:</span><span class="ident" id="3752812"><a href="/net/http/cookie.go.html#3752750">j</a></span><span class="op" id="3752813">]</span><span class="op" id="3752814">,</span>&nbsp;<span class="ident" id="3752816"><a href="/net/http/cookie.go.html#3752718">attr</a></span><span class="op" id="3752820">[</span><span class="ident" id="3752821"><a href="/net/http/cookie.go.html#3752750">j</a></span><span class="op" id="3752822">+</span><span class="num" id="3752823">1</span><span class="op" id="3752824">:</span><span class="op" id="3752825">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3752830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752835">lowerAttr</span>&nbsp;<span class="op" id="3752845">:=</span>&nbsp;<span class="ident" id="3752848"><a href="/net/http/cookie.go.html#3751201">strings</a></span><span class="op" id="3752855">.</span><span class="ident" id="3752856">ToLower</span><span class="op" id="3752863">(</span><span class="ident" id="3752864"><a href="/net/http/cookie.go.html#3752718">attr</a></span><span class="op" id="3752868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752873"><a href="/net/http/cookie.go.html#3752724">val</a></span><span class="op" id="3752876">,</span>&nbsp;<span class="ident" id="3752878"><a href="/net/http/cookie.go.html#3752449">success</a></span>&nbsp;<span class="op" id="3752886">=</span>&nbsp;<span class="ident" id="3752888"><a href="/net/http/cookie.go.html#3759409">parseCookieValue</a></span><span class="op" id="3752904">(</span><span class="ident" id="3752905"><a href="/net/http/cookie.go.html#3752724">val</a></span><span class="op" id="3752908">,</span>&nbsp;<span class="ident" id="3752910">false</span><span class="op" id="3752915">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752920">if</span>&nbsp;<span class="op" id="3752923">!</span><span class="ident" id="3752924"><a href="/net/http/cookie.go.html#3752449">success</a></span>&nbsp;<span class="op" id="3752932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752938"><a href="/net/http/cookie.go.html#3752524">c</a></span><span class="op" id="3752939">.</span><span class="ident" id="3752940">Unparsed</span>&nbsp;<span class="op" id="3752949">=</span>&nbsp;<span class="builtinfunc" id="3752951">append</span><span class="op" id="3752957">(</span><span class="ident" id="3752958"><a href="/net/http/cookie.go.html#3752524">c</a></span><span class="op" id="3752959">.</span><span class="ident" id="3752960">Unparsed</span><span class="op" id="3752968">,</span>&nbsp;<span class="ident" id="3752970"><a href="/net/http/cookie.go.html#3752130">parts</a></span><span class="op" id="3752975">[</span><span class="ident" id="3752976"><a href="/net/http/cookie.go.html#3752597">i</a></span><span class="op" id="3752977">]</span><span class="op" id="3752978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752984">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3752996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753001">switch</span>&nbsp;<span class="ident" id="3753008"><a href="/net/http/cookie.go.html#3752835">lowerAttr</a></span>&nbsp;<span class="op" id="3753018">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753023">case</span>&nbsp;<span class="string" id="3753028">&#34;secure&#34;</span><span class="op" id="3753036">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753042"><a href="/net/http/cookie.go.html#3752524">c</a></span><span class="op" id="3753043">.</span><span class="ident" id="3753044">Secure</span>&nbsp;<span class="op" id="3753051">=</span>&nbsp;<span class="ident" id="3753053">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753062">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753074">case</span>&nbsp;<span class="string" id="3753079">&#34;httponly&#34;</span><span class="op" id="3753089">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753095"><a href="/net/http/cookie.go.html#3752524">c</a></span><span class="op" id="3753096">.</span><span class="ident" id="3753097">HttpOnly</span>&nbsp;<span class="op" id="3753106">=</span>&nbsp;<span class="ident" id="3753108">true</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753117">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753129">case</span>&nbsp;<span class="string" id="3753134">&#34;domain&#34;</span><span class="op" id="3753142">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753148"><a href="/net/http/cookie.go.html#3752524">c</a></span><span class="op" id="3753149">.</span><span class="ident" id="3753150">Domain</span>&nbsp;<span class="op" id="3753157">=</span>&nbsp;<span class="ident" id="3753159"><a href="/net/http/cookie.go.html#3752724">val</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753167">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753179">case</span>&nbsp;<span class="string" id="3753184">&#34;max-age&#34;</span><span class="op" id="3753193">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753199">secs</span><span class="op" id="3753203">,</span>&nbsp;<span class="ident" id="3753205">err</span>&nbsp;<span class="op" id="3753209">:=</span>&nbsp;<span class="ident" id="3753212"><a href="/net/http/cookie.go.html#3751190">strconv</a></span><span class="op" id="3753219">.</span><span class="ident" id="3753220">Atoi</span><span class="op" id="3753224">(</span><span class="ident" id="3753225"><a href="/net/http/cookie.go.html#3752724">val</a></span><span class="op" id="3753228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753234">if</span>&nbsp;<span class="ident" id="3753237"><a href="/net/http/cookie.go.html#3753205">err</a></span>&nbsp;<span class="op" id="3753241">!=</span>&nbsp;<span class="ident" id="3753244">nil</span>&nbsp;<span class="op" id="3753248">||</span>&nbsp;<span class="ident" id="3753251"><a href="/net/http/cookie.go.html#3753199">secs</a></span>&nbsp;<span class="op" id="3753256">!=</span>&nbsp;<span class="num" id="3753259">0</span>&nbsp;<span class="op" id="3753261">&amp;&amp;</span>&nbsp;<span class="ident" id="3753264"><a href="/net/http/cookie.go.html#3752724">val</a></span><span class="op" id="3753267">[</span><span class="num" id="3753268">0</span><span class="op" id="3753269">]</span>&nbsp;<span class="op" id="3753271">==</span>&nbsp;<span class="string" id="3753274">&#39;0&#39;</span>&nbsp;<span class="op" id="3753278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753285">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3753295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753301">if</span>&nbsp;<span class="ident" id="3753304"><a href="/net/http/cookie.go.html#3753199">secs</a></span>&nbsp;<span class="op" id="3753309">&lt;=</span>&nbsp;<span class="num" id="3753312">0</span>&nbsp;<span class="op" id="3753314">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753321"><a href="/net/http/cookie.go.html#3752524">c</a></span><span class="op" id="3753322">.</span><span class="ident" id="3753323">MaxAge</span>&nbsp;<span class="op" id="3753330">=</span>&nbsp;<span class="op" id="3753332">-</span><span class="num" id="3753333">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3753339">}</span>&nbsp;<span class="keyword" id="3753341">else</span>&nbsp;<span class="op" id="3753346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753353"><a href="/net/http/cookie.go.html#3752524">c</a></span><span class="op" id="3753354">.</span><span class="ident" id="3753355">MaxAge</span>&nbsp;<span class="op" id="3753362">=</span>&nbsp;<span class="ident" id="3753364"><a href="/net/http/cookie.go.html#3753199">secs</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3753373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753379">continue</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753391">case</span>&nbsp;<span class="string" id="3753396">&#34;expires&#34;</span><span class="op" id="3753405">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753411"><a href="/net/http/cookie.go.html#3752524">c</a></span><span class="op" id="3753412">.</span><span class="ident" id="3753413">RawExpires</span>&nbsp;<span class="op" id="3753424">=</span>&nbsp;<span class="ident" id="3753426"><a href="/net/http/cookie.go.html#3752724">val</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753434">exptime</span><span class="op" id="3753441">,</span>&nbsp;<span class="ident" id="3753443">err</span>&nbsp;<span class="op" id="3753447">:=</span>&nbsp;<span class="ident" id="3753450"><a href="/net/http/cookie.go.html#3751212">time</a></span><span class="op" id="3753454">.</span><span class="ident" id="3753455">Parse</span><span class="op" id="3753460">(</span><span class="ident" id="3753461"><a href="/net/http/cookie.go.html#3751212">time</a></span><span class="op" id="3753465">.</span><span class="ident" id="3753466">RFC1123</span><span class="op" id="3753473">,</span>&nbsp;<span class="ident" id="3753475"><a href="/net/http/cookie.go.html#3752724">val</a></span><span class="op" id="3753478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753484">if</span>&nbsp;<span class="ident" id="3753487"><a href="/net/http/cookie.go.html#3753443">err</a></span>&nbsp;<span class="op" id="3753491">!=</span>&nbsp;<span class="ident" id="3753494">nil</span>&nbsp;<span class="op" id="3753498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753505"><a href="/net/http/cookie.go.html#3753434">exptime</a></span><span class="op" id="3753512">,</span>&nbsp;<span class="ident" id="3753514"><a href="/net/http/cookie.go.html#3753443">err</a></span>&nbsp;<span class="op" id="3753518">=</span>&nbsp;<span class="ident" id="3753520"><a href="/net/http/cookie.go.html#3751212">time</a></span><span class="op" id="3753524">.</span><span class="ident" id="3753525">Parse</span><span class="op" id="3753530">(</span><span class="string" id="3753531">&#34;Mon,&nbsp;02-Jan-2006&nbsp;15:04:05&nbsp;MST&#34;</span><span class="op" id="3753562">,</span>&nbsp;<span class="ident" id="3753564"><a href="/net/http/cookie.go.html#3752724">val</a></span><span class="op" id="3753567">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753574">if</span>&nbsp;<span class="ident" id="3753577"><a href="/net/http/cookie.go.html#3753443">err</a></span>&nbsp;<span class="op" id="3753581">!=</span>&nbsp;<span class="ident" id="3753584">nil</span>&nbsp;<span class="op" id="3753588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753596"><a href="/net/http/cookie.go.html#3752524">c</a></span><span class="op" id="3753597">.</span><span class="ident" id="3753598">Expires</span>&nbsp;<span class="op" id="3753606">=</span>&nbsp;<span class="ident" id="3753608"><a href="/net/http/cookie.go.html#3751212">time</a></span><span class="op" id="3753612">.</span><span class="ident" id="3753613">Time</span><span class="op" id="3753617">{</span><span class="op" id="3753618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753626">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3753637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3753643">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753649"><a href="/net/http/cookie.go.html#3752524">c</a></span><span class="op" id="3753650">.</span><span class="ident" id="3753651">Expires</span>&nbsp;<span class="op" id="3753659">=</span>&nbsp;<span class="ident" id="3753661"><a href="/net/http/cookie.go.html#3753434">exptime</a></span><span class="op" id="3753668">.</span><span class="ident" id="3753669">UTC</span><span class="op" id="3753672">(</span><span class="op" id="3753673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753679">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753691">case</span>&nbsp;<span class="string" id="3753696">&#34;path&#34;</span><span class="op" id="3753702">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753708"><a href="/net/http/cookie.go.html#3752524">c</a></span><span class="op" id="3753709">.</span><span class="ident" id="3753710">Path</span>&nbsp;<span class="op" id="3753715">=</span>&nbsp;<span class="ident" id="3753717"><a href="/net/http/cookie.go.html#3752724">val</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753725">continue</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3753737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753742"><a href="/net/http/cookie.go.html#3752524">c</a></span><span class="op" id="3753743">.</span><span class="ident" id="3753744">Unparsed</span>&nbsp;<span class="op" id="3753753">=</span>&nbsp;<span class="builtinfunc" id="3753755">append</span><span class="op" id="3753761">(</span><span class="ident" id="3753762"><a href="/net/http/cookie.go.html#3752524">c</a></span><span class="op" id="3753763">.</span><span class="ident" id="3753764">Unparsed</span><span class="op" id="3753772">,</span>&nbsp;<span class="ident" id="3753774"><a href="/net/http/cookie.go.html#3752130">parts</a></span><span class="op" id="3753779">[</span><span class="ident" id="3753780"><a href="/net/http/cookie.go.html#3752597">i</a></span><span class="op" id="3753781">]</span><span class="op" id="3753782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3753786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753790"><a href="/net/http/cookie.go.html#3752065">cookies</a></span>&nbsp;<span class="op" id="3753798">=</span>&nbsp;<span class="builtinfunc" id="3753800">append</span><span class="op" id="3753806">(</span><span class="ident" id="3753807"><a href="/net/http/cookie.go.html#3752065">cookies</a></span><span class="op" id="3753814">,</span>&nbsp;<span class="ident" id="3753816"><a href="/net/http/cookie.go.html#3752524">c</a></span><span class="op" id="3753817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3753820">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753823">return</span>&nbsp;<span class="ident" id="3753830"><a href="/net/http/cookie.go.html#3752065">cookies</a></span><br>
<span class="lineno"></span><span class="op" id="3753838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3753841">//&nbsp;SetCookie&nbsp;adds&nbsp;a&nbsp;Set-Cookie&nbsp;header&nbsp;to&nbsp;the&nbsp;provided&nbsp;ResponseWriter&#39;s&nbsp;headers.</span><br>
<span class="lineno"></span><span class="keyword" id="3753921">func</span>&nbsp;<span class="ident" id="3753926">SetCookie</span><span class="op" id="3753935">(</span><span class="ident" id="3753936">w</span>&nbsp;<span class="ident" id="3753938"><a href="/net/http/server.go.html#3826033">ResponseWriter</a></span><span class="op" id="3753952">,</span>&nbsp;<span class="ident" id="3753954">cookie</span>&nbsp;<span class="op" id="3753961">*</span><span class="ident" id="3753962"><a href="/net/http/cookie.go.html#3751461">Cookie</a></span><span class="op" id="3753968">)</span>&nbsp;<span class="op" id="3753970">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753973"><a href="/net/http/cookie.go.html#3753936">w</a></span><span class="op" id="3753974">.</span><span class="ident" id="3753975">Header</span><span class="op" id="3753981">(</span><span class="op" id="3753982">)</span><span class="op" id="3753983">.</span><span class="ident" id="3753984">Add</span><span class="op" id="3753987">(</span><span class="string" id="3753988">&#34;Set-Cookie&#34;</span><span class="op" id="3754000">,</span>&nbsp;<span class="ident" id="3754002"><a href="/net/http/cookie.go.html#3753954">cookie</a></span><span class="op" id="3754008">.</span><span class="ident" id="3754009">String</span><span class="op" id="3754015">(</span><span class="op" id="3754016">)</span><span class="op" id="3754017">)</span><br>
<span class="lineno"></span><span class="op" id="3754019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3754022">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;serialization&nbsp;of&nbsp;the&nbsp;cookie&nbsp;for&nbsp;use&nbsp;in&nbsp;a&nbsp;Cookie</span><br>
<span class="lineno"></span><span class="comment" id="3754092">//&nbsp;header&nbsp;(if&nbsp;only&nbsp;Name&nbsp;and&nbsp;Value&nbsp;are&nbsp;set)&nbsp;or&nbsp;a&nbsp;Set-Cookie&nbsp;response</span><br>
<span class="lineno">135</span><span class="comment" id="3754160">//&nbsp;header&nbsp;(if&nbsp;other&nbsp;fields&nbsp;are&nbsp;set).</span><br>
<span class="lineno"></span><span class="keyword" id="3754197">func</span>&nbsp;<span class="op" id="3754202">(</span><span class="ident" id="3754203">c</span>&nbsp;<span class="op" id="3754205">*</span><span class="ident" id="3754206"><a href="/net/http/cookie.go.html#3751461">Cookie</a></span><span class="op" id="3754212">)</span>&nbsp;<span class="ident" id="3754214">String</span><span class="op" id="3754220">(</span><span class="op" id="3754221">)</span>&nbsp;<span class="builtintype" id="3754223">string</span>&nbsp;<span class="op" id="3754230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754233">var</span>&nbsp;<span class="ident" id="3754237">b</span>&nbsp;<span class="ident" id="3754239"><a href="/net/http/cookie.go.html#3751160">bytes</a></span><span class="op" id="3754244">.</span><span class="ident" id="3754245">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754253"><a href="/net/http/cookie.go.html#3751169">fmt</a></span><span class="op" id="3754256">.</span><span class="ident" id="3754257">Fprintf</span><span class="op" id="3754264">(</span><span class="op" id="3754265">&amp;</span><span class="ident" id="3754266"><a href="/net/http/cookie.go.html#3754237">b</a></span><span class="op" id="3754267">,</span>&nbsp;<span class="string" id="3754269">&#34;%s=%s&#34;</span><span class="op" id="3754276">,</span>&nbsp;<span class="ident" id="3754278"><a href="/net/http/cookie.go.html#3757693">sanitizeCookieName</a></span><span class="op" id="3754296">(</span><span class="ident" id="3754297"><a href="/net/http/cookie.go.html#3754203">c</a></span><span class="op" id="3754298">.</span><span class="ident" id="3754299">Name</span><span class="op" id="3754303">)</span><span class="op" id="3754304">,</span>&nbsp;<span class="ident" id="3754306"><a href="/net/http/cookie.go.html#3758319">sanitizeCookieValue</a></span><span class="op" id="3754325">(</span><span class="ident" id="3754326"><a href="/net/http/cookie.go.html#3754203">c</a></span><span class="op" id="3754327">.</span><span class="ident" id="3754328">Value</span><span class="op" id="3754333">)</span><span class="op" id="3754334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754337">if</span>&nbsp;<span class="builtinfunc" id="3754340">len</span><span class="op" id="3754343">(</span><span class="ident" id="3754344"><a href="/net/http/cookie.go.html#3754203">c</a></span><span class="op" id="3754345">.</span><span class="ident" id="3754346">Path</span><span class="op" id="3754350">)</span>&nbsp;<span class="op" id="3754352">&gt;</span>&nbsp;<span class="num" id="3754354">0</span>&nbsp;<span class="op" id="3754356">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754360"><a href="/net/http/cookie.go.html#3751169">fmt</a></span><span class="op" id="3754363">.</span><span class="ident" id="3754364">Fprintf</span><span class="op" id="3754371">(</span><span class="op" id="3754372">&amp;</span><span class="ident" id="3754373"><a href="/net/http/cookie.go.html#3754237">b</a></span><span class="op" id="3754374">,</span>&nbsp;<span class="string" id="3754376">&#34;;&nbsp;Path=%s&#34;</span><span class="op" id="3754387">,</span>&nbsp;<span class="ident" id="3754389"><a href="/net/http/cookie.go.html#3758778">sanitizeCookiePath</a></span><span class="op" id="3754407">(</span><span class="ident" id="3754408"><a href="/net/http/cookie.go.html#3754203">c</a></span><span class="op" id="3754409">.</span><span class="ident" id="3754410">Path</span><span class="op" id="3754414">)</span><span class="op" id="3754415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754421">if</span>&nbsp;<span class="builtinfunc" id="3754424">len</span><span class="op" id="3754427">(</span><span class="ident" id="3754428"><a href="/net/http/cookie.go.html#3754203">c</a></span><span class="op" id="3754429">.</span><span class="ident" id="3754430">Domain</span><span class="op" id="3754436">)</span>&nbsp;<span class="op" id="3754438">&gt;</span>&nbsp;<span class="num" id="3754440">0</span>&nbsp;<span class="op" id="3754442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754446">if</span>&nbsp;<span class="ident" id="3754449"><a href="/net/http/cookie.go.html#3756329">validCookieDomain</a></span><span class="op" id="3754466">(</span><span class="ident" id="3754467"><a href="/net/http/cookie.go.html#3754203">c</a></span><span class="op" id="3754468">.</span><span class="ident" id="3754469">Domain</span><span class="op" id="3754475">)</span>&nbsp;<span class="op" id="3754477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3754482">//&nbsp;A&nbsp;c.Domain&nbsp;containing&nbsp;illegal&nbsp;characters&nbsp;is&nbsp;not</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3754536">//&nbsp;sanitized&nbsp;but&nbsp;simply&nbsp;dropped&nbsp;which&nbsp;turns&nbsp;the&nbsp;cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3754594">//&nbsp;into&nbsp;a&nbsp;host-only&nbsp;cookie.&nbsp;A&nbsp;leading&nbsp;dot&nbsp;is&nbsp;okay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3754647">//&nbsp;but&nbsp;won&#39;t&nbsp;be&nbsp;sent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754672">d</span>&nbsp;<span class="op" id="3754674">:=</span>&nbsp;<span class="ident" id="3754677"><a href="/net/http/cookie.go.html#3754203">c</a></span><span class="op" id="3754678">.</span><span class="ident" id="3754679">Domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754689">if</span>&nbsp;<span class="ident" id="3754692"><a href="/net/http/cookie.go.html#3754672">d</a></span><span class="op" id="3754693">[</span><span class="num" id="3754694">0</span><span class="op" id="3754695">]</span>&nbsp;<span class="op" id="3754697">==</span>&nbsp;<span class="string" id="3754700">&#39;.&#39;</span>&nbsp;<span class="op" id="3754704">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754710"><a href="/net/http/cookie.go.html#3754672">d</a></span>&nbsp;<span class="op" id="3754712">=</span>&nbsp;<span class="ident" id="3754714"><a href="/net/http/cookie.go.html#3754672">d</a></span><span class="op" id="3754715">[</span><span class="num" id="3754716">1</span><span class="op" id="3754717">:</span><span class="op" id="3754718">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754728"><a href="/net/http/cookie.go.html#3751169">fmt</a></span><span class="op" id="3754731">.</span><span class="ident" id="3754732">Fprintf</span><span class="op" id="3754739">(</span><span class="op" id="3754740">&amp;</span><span class="ident" id="3754741"><a href="/net/http/cookie.go.html#3754237">b</a></span><span class="op" id="3754742">,</span>&nbsp;<span class="string" id="3754744">&#34;;&nbsp;Domain=%s&#34;</span><span class="op" id="3754757">,</span>&nbsp;<span class="ident" id="3754759"><a href="/net/http/cookie.go.html#3754672">d</a></span><span class="op" id="3754760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754764">}</span>&nbsp;<span class="keyword" id="3754766">else</span>&nbsp;<span class="op" id="3754771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754776"><a href="/net/http/cookie.go.html#3751176">log</a></span><span class="op" id="3754779">.</span><span class="ident" id="3754780">Printf</span><span class="op" id="3754786">(</span><span class="string" id="3754787">&#34;net/http:&nbsp;invalid&nbsp;Cookie.Domain&nbsp;%q;&nbsp;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="3754850">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754856"><a href="/net/http/cookie.go.html#3754203">c</a></span><span class="op" id="3754857">.</span><span class="ident" id="3754858">Domain</span><span class="op" id="3754864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754874">if</span>&nbsp;<span class="ident" id="3754877"><a href="/net/http/cookie.go.html#3754203">c</a></span><span class="op" id="3754878">.</span><span class="ident" id="3754879">Expires</span><span class="op" id="3754886">.</span><span class="ident" id="3754887">Unix</span><span class="op" id="3754891">(</span><span class="op" id="3754892">)</span>&nbsp;<span class="op" id="3754894">&gt;</span>&nbsp;<span class="num" id="3754896">0</span>&nbsp;<span class="op" id="3754898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754902"><a href="/net/http/cookie.go.html#3751169">fmt</a></span><span class="op" id="3754905">.</span><span class="ident" id="3754906">Fprintf</span><span class="op" id="3754913">(</span><span class="op" id="3754914">&amp;</span><span class="ident" id="3754915"><a href="/net/http/cookie.go.html#3754237">b</a></span><span class="op" id="3754916">,</span>&nbsp;<span class="string" id="3754918">&#34;;&nbsp;Expires=%s&#34;</span><span class="op" id="3754932">,</span>&nbsp;<span class="ident" id="3754934"><a href="/net/http/cookie.go.html#3754203">c</a></span><span class="op" id="3754935">.</span><span class="ident" id="3754936">Expires</span><span class="op" id="3754943">.</span><span class="ident" id="3754944">UTC</span><span class="op" id="3754947">(</span><span class="op" id="3754948">)</span><span class="op" id="3754949">.</span><span class="ident" id="3754950">Format</span><span class="op" id="3754956">(</span><span class="ident" id="3754957"><a href="/net/http/cookie.go.html#3751212">time</a></span><span class="op" id="3754961">.</span><span class="ident" id="3754962">RFC1123</span><span class="op" id="3754969">)</span><span class="op" id="3754970">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754976">if</span>&nbsp;<span class="ident" id="3754979"><a href="/net/http/cookie.go.html#3754203">c</a></span><span class="op" id="3754980">.</span><span class="ident" id="3754981">MaxAge</span>&nbsp;<span class="op" id="3754988">&gt;</span>&nbsp;<span class="num" id="3754990">0</span>&nbsp;<span class="op" id="3754992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754996"><a href="/net/http/cookie.go.html#3751169">fmt</a></span><span class="op" id="3754999">.</span><span class="ident" id="3755000">Fprintf</span><span class="op" id="3755007">(</span><span class="op" id="3755008">&amp;</span><span class="ident" id="3755009"><a href="/net/http/cookie.go.html#3754237">b</a></span><span class="op" id="3755010">,</span>&nbsp;<span class="string" id="3755012">&#34;;&nbsp;Max-Age=%d&#34;</span><span class="op" id="3755026">,</span>&nbsp;<span class="ident" id="3755028"><a href="/net/http/cookie.go.html#3754203">c</a></span><span class="op" id="3755029">.</span><span class="ident" id="3755030">MaxAge</span><span class="op" id="3755036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3755039">}</span>&nbsp;<span class="keyword" id="3755041">else</span>&nbsp;<span class="keyword" id="3755046">if</span>&nbsp;<span class="ident" id="3755049"><a href="/net/http/cookie.go.html#3754203">c</a></span><span class="op" id="3755050">.</span><span class="ident" id="3755051">MaxAge</span>&nbsp;<span class="op" id="3755058">&lt;</span>&nbsp;<span class="num" id="3755060">0</span>&nbsp;<span class="op" id="3755062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755066"><a href="/net/http/cookie.go.html#3751169">fmt</a></span><span class="op" id="3755069">.</span><span class="ident" id="3755070">Fprintf</span><span class="op" id="3755077">(</span><span class="op" id="3755078">&amp;</span><span class="ident" id="3755079"><a href="/net/http/cookie.go.html#3754237">b</a></span><span class="op" id="3755080">,</span>&nbsp;<span class="string" id="3755082">&#34;;&nbsp;Max-Age=0&#34;</span><span class="op" id="3755095">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3755098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755101">if</span>&nbsp;<span class="ident" id="3755104"><a href="/net/http/cookie.go.html#3754203">c</a></span><span class="op" id="3755105">.</span><span class="ident" id="3755106">HttpOnly</span>&nbsp;<span class="op" id="3755115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755119"><a href="/net/http/cookie.go.html#3751169">fmt</a></span><span class="op" id="3755122">.</span><span class="ident" id="3755123">Fprintf</span><span class="op" id="3755130">(</span><span class="op" id="3755131">&amp;</span><span class="ident" id="3755132"><a href="/net/http/cookie.go.html#3754237">b</a></span><span class="op" id="3755133">,</span>&nbsp;<span class="string" id="3755135">&#34;;&nbsp;HttpOnly&#34;</span><span class="op" id="3755147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3755150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755153">if</span>&nbsp;<span class="ident" id="3755156"><a href="/net/http/cookie.go.html#3754203">c</a></span><span class="op" id="3755157">.</span><span class="ident" id="3755158">Secure</span>&nbsp;<span class="op" id="3755165">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755169"><a href="/net/http/cookie.go.html#3751169">fmt</a></span><span class="op" id="3755172">.</span><span class="ident" id="3755173">Fprintf</span><span class="op" id="3755180">(</span><span class="op" id="3755181">&amp;</span><span class="ident" id="3755182"><a href="/net/http/cookie.go.html#3754237">b</a></span><span class="op" id="3755183">,</span>&nbsp;<span class="string" id="3755185">&#34;;&nbsp;Secure&#34;</span><span class="op" id="3755195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3755198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755201">return</span>&nbsp;<span class="ident" id="3755208"><a href="/net/http/cookie.go.html#3754237">b</a></span><span class="op" id="3755209">.</span><span class="ident" id="3755210">String</span><span class="op" id="3755216">(</span><span class="op" id="3755217">)</span><br>
<span class="lineno"></span><span class="op" id="3755219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="3755222">//&nbsp;readCookies&nbsp;parses&nbsp;all&nbsp;&#34;Cookie&#34;&nbsp;values&nbsp;from&nbsp;the&nbsp;header&nbsp;h&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3755286">//&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="comment" id="3755330">//</span><br>
<span class="lineno"></span><span class="comment" id="3755333">//&nbsp;if&nbsp;filter&nbsp;isn&#39;t&nbsp;empty,&nbsp;only&nbsp;cookies&nbsp;of&nbsp;that&nbsp;name&nbsp;are&nbsp;returned</span><br>
<span class="lineno"></span><span class="keyword" id="3755398">func</span>&nbsp;<span class="ident" id="3755403">readCookies</span><span class="op" id="3755414">(</span><span class="ident" id="3755415">h</span>&nbsp;<span class="ident" id="3755417"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3755423">,</span>&nbsp;<span class="ident" id="3755425">filter</span>&nbsp;<span class="builtintype" id="3755432">string</span><span class="op" id="3755438">)</span>&nbsp;<span class="op" id="3755440">[</span><span class="op" id="3755441">]</span><span class="op" id="3755442">*</span><span class="ident" id="3755443"><a href="/net/http/cookie.go.html#3751461">Cookie</a></span>&nbsp;<span class="op" id="3755450">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755453">cookies</span>&nbsp;<span class="op" id="3755461">:=</span>&nbsp;<span class="op" id="3755464">[</span><span class="op" id="3755465">]</span><span class="op" id="3755466">*</span><span class="ident" id="3755467"><a href="/net/http/cookie.go.html#3751461">Cookie</a></span><span class="op" id="3755473">{</span><span class="op" id="3755474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755477">lines</span><span class="op" id="3755482">,</span>&nbsp;<span class="ident" id="3755484">ok</span>&nbsp;<span class="op" id="3755487">:=</span>&nbsp;<span class="ident" id="3755490"><a href="/net/http/cookie.go.html#3755415">h</a></span><span class="op" id="3755491">[</span><span class="string" id="3755492">&#34;Cookie&#34;</span><span class="op" id="3755500">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755503">if</span>&nbsp;<span class="op" id="3755506">!</span><span class="ident" id="3755507"><a href="/net/http/cookie.go.html#3755484">ok</a></span>&nbsp;<span class="op" id="3755510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755514">return</span>&nbsp;<span class="ident" id="3755521"><a href="/net/http/cookie.go.html#3755453">cookies</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3755530">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755534">for</span>&nbsp;<span class="ident" id="3755538">_</span><span class="op" id="3755539">,</span>&nbsp;<span class="ident" id="3755541">line</span>&nbsp;<span class="op" id="3755546">:=</span>&nbsp;<span class="keyword" id="3755549">range</span>&nbsp;<span class="ident" id="3755555"><a href="/net/http/cookie.go.html#3755477">lines</a></span>&nbsp;<span class="op" id="3755561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755565">parts</span>&nbsp;<span class="op" id="3755571">:=</span>&nbsp;<span class="ident" id="3755574"><a href="/net/http/cookie.go.html#3751201">strings</a></span><span class="op" id="3755581">.</span><span class="ident" id="3755582">Split</span><span class="op" id="3755587">(</span><span class="ident" id="3755588"><a href="/net/http/cookie.go.html#3751201">strings</a></span><span class="op" id="3755595">.</span><span class="ident" id="3755596">TrimSpace</span><span class="op" id="3755605">(</span><span class="ident" id="3755606"><a href="/net/http/cookie.go.html#3755541">line</a></span><span class="op" id="3755610">)</span><span class="op" id="3755611">,</span>&nbsp;<span class="string" id="3755613">&#34;;&#34;</span><span class="op" id="3755616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755620">if</span>&nbsp;<span class="builtinfunc" id="3755623">len</span><span class="op" id="3755626">(</span><span class="ident" id="3755627"><a href="/net/http/cookie.go.html#3755565">parts</a></span><span class="op" id="3755632">)</span>&nbsp;<span class="op" id="3755634">==</span>&nbsp;<span class="num" id="3755637">1</span>&nbsp;<span class="op" id="3755639">&amp;&amp;</span>&nbsp;<span class="ident" id="3755642"><a href="/net/http/cookie.go.html#3755565">parts</a></span><span class="op" id="3755647">[</span><span class="num" id="3755648">0</span><span class="op" id="3755649">]</span>&nbsp;<span class="op" id="3755651">==</span>&nbsp;<span class="string" id="3755654">&#34;&#34;</span>&nbsp;<span class="op" id="3755657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755662">continue</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3755673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755677">//&nbsp;Per-line&nbsp;attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755702">parsedPairs</span>&nbsp;<span class="op" id="3755714">:=</span>&nbsp;<span class="num" id="3755717">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755721">for</span>&nbsp;<span class="ident" id="3755725">i</span>&nbsp;<span class="op" id="3755727">:=</span>&nbsp;<span class="num" id="3755730">0</span><span class="op" id="3755731">;</span>&nbsp;<span class="ident" id="3755733"><a href="/net/http/cookie.go.html#3755725">i</a></span>&nbsp;<span class="op" id="3755735">&lt;</span>&nbsp;<span class="builtinfunc" id="3755737">len</span><span class="op" id="3755740">(</span><span class="ident" id="3755741"><a href="/net/http/cookie.go.html#3755565">parts</a></span><span class="op" id="3755746">)</span><span class="op" id="3755747">;</span>&nbsp;<span class="ident" id="3755749"><a href="/net/http/cookie.go.html#3755725">i</a></span><span class="op" id="3755750">++</span>&nbsp;<span class="op" id="3755753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755758"><a href="/net/http/cookie.go.html#3755565">parts</a></span><span class="op" id="3755763">[</span><span class="ident" id="3755764"><a href="/net/http/cookie.go.html#3755725">i</a></span><span class="op" id="3755765">]</span>&nbsp;<span class="op" id="3755767">=</span>&nbsp;<span class="ident" id="3755769"><a href="/net/http/cookie.go.html#3751201">strings</a></span><span class="op" id="3755776">.</span><span class="ident" id="3755777">TrimSpace</span><span class="op" id="3755786">(</span><span class="ident" id="3755787"><a href="/net/http/cookie.go.html#3755565">parts</a></span><span class="op" id="3755792">[</span><span class="ident" id="3755793"><a href="/net/http/cookie.go.html#3755725">i</a></span><span class="op" id="3755794">]</span><span class="op" id="3755795">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755800">if</span>&nbsp;<span class="builtinfunc" id="3755803">len</span><span class="op" id="3755806">(</span><span class="ident" id="3755807"><a href="/net/http/cookie.go.html#3755565">parts</a></span><span class="op" id="3755812">[</span><span class="ident" id="3755813"><a href="/net/http/cookie.go.html#3755725">i</a></span><span class="op" id="3755814">]</span><span class="op" id="3755815">)</span>&nbsp;<span class="op" id="3755817">==</span>&nbsp;<span class="num" id="3755820">0</span>&nbsp;<span class="op" id="3755822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755828">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3755840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755845">name</span><span class="op" id="3755849">,</span>&nbsp;<span class="ident" id="3755851">val</span>&nbsp;<span class="op" id="3755855">:=</span>&nbsp;<span class="ident" id="3755858"><a href="/net/http/cookie.go.html#3755565">parts</a></span><span class="op" id="3755863">[</span><span class="ident" id="3755864"><a href="/net/http/cookie.go.html#3755725">i</a></span><span class="op" id="3755865">]</span><span class="op" id="3755866">,</span>&nbsp;<span class="string" id="3755868">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755874">if</span>&nbsp;<span class="ident" id="3755877">j</span>&nbsp;<span class="op" id="3755879">:=</span>&nbsp;<span class="ident" id="3755882"><a href="/net/http/cookie.go.html#3751201">strings</a></span><span class="op" id="3755889">.</span><span class="ident" id="3755890">Index</span><span class="op" id="3755895">(</span><span class="ident" id="3755896"><a href="/net/http/cookie.go.html#3755845">name</a></span><span class="op" id="3755900">,</span>&nbsp;<span class="string" id="3755902">&#34;=&#34;</span><span class="op" id="3755905">)</span><span class="op" id="3755906">;</span>&nbsp;<span class="ident" id="3755908"><a href="/net/http/cookie.go.html#3755877">j</a></span>&nbsp;<span class="op" id="3755910">&gt;=</span>&nbsp;<span class="num" id="3755913">0</span>&nbsp;<span class="op" id="3755915">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755921"><a href="/net/http/cookie.go.html#3755845">name</a></span><span class="op" id="3755925">,</span>&nbsp;<span class="ident" id="3755927"><a href="/net/http/cookie.go.html#3755851">val</a></span>&nbsp;<span class="op" id="3755931">=</span>&nbsp;<span class="ident" id="3755933"><a href="/net/http/cookie.go.html#3755845">name</a></span><span class="op" id="3755937">[</span><span class="op" id="3755938">:</span><span class="ident" id="3755939"><a href="/net/http/cookie.go.html#3755877">j</a></span><span class="op" id="3755940">]</span><span class="op" id="3755941">,</span>&nbsp;<span class="ident" id="3755943"><a href="/net/http/cookie.go.html#3755845">name</a></span><span class="op" id="3755947">[</span><span class="ident" id="3755948"><a href="/net/http/cookie.go.html#3755877">j</a></span><span class="op" id="3755949">+</span><span class="num" id="3755950">1</span><span class="op" id="3755951">:</span><span class="op" id="3755952">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3755957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755962">if</span>&nbsp;<span class="op" id="3755965">!</span><span class="ident" id="3755966"><a href="/net/http/cookie.go.html#3759748">isCookieNameValid</a></span><span class="op" id="3755983">(</span><span class="ident" id="3755984"><a href="/net/http/cookie.go.html#3755845">name</a></span><span class="op" id="3755988">)</span>&nbsp;<span class="op" id="3755990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755996">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756008">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3756013">if</span>&nbsp;<span class="ident" id="3756016"><a href="/net/http/cookie.go.html#3755425">filter</a></span>&nbsp;<span class="op" id="3756023">!=</span>&nbsp;<span class="string" id="3756026">&#34;&#34;</span>&nbsp;<span class="op" id="3756029">&amp;&amp;</span>&nbsp;<span class="ident" id="3756032"><a href="/net/http/cookie.go.html#3755425">filter</a></span>&nbsp;<span class="op" id="3756039">!=</span>&nbsp;<span class="ident" id="3756042"><a href="/net/http/cookie.go.html#3755845">name</a></span>&nbsp;<span class="op" id="3756047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3756053">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756070"><a href="/net/http/cookie.go.html#3755851">val</a></span><span class="op" id="3756073">,</span>&nbsp;<span class="ident" id="3756075">success</span>&nbsp;<span class="op" id="3756083">:=</span>&nbsp;<span class="ident" id="3756086"><a href="/net/http/cookie.go.html#3759409">parseCookieValue</a></span><span class="op" id="3756102">(</span><span class="ident" id="3756103"><a href="/net/http/cookie.go.html#3755851">val</a></span><span class="op" id="3756106">,</span>&nbsp;<span class="ident" id="3756108">true</span><span class="op" id="3756112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3756117">if</span>&nbsp;<span class="op" id="3756120">!</span><span class="ident" id="3756121"><a href="/net/http/cookie.go.html#3756075">success</a></span>&nbsp;<span class="op" id="3756129">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3756135">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756152"><a href="/net/http/cookie.go.html#3755453">cookies</a></span>&nbsp;<span class="op" id="3756160">=</span>&nbsp;<span class="builtinfunc" id="3756162">append</span><span class="op" id="3756168">(</span><span class="ident" id="3756169"><a href="/net/http/cookie.go.html#3755453">cookies</a></span><span class="op" id="3756176">,</span>&nbsp;<span class="op" id="3756178">&amp;</span><span class="ident" id="3756179"><a href="/net/http/cookie.go.html#3751461">Cookie</a></span><span class="op" id="3756185">{</span><span class="ident" id="3756186">Name</span><span class="op" id="3756190">:</span>&nbsp;<span class="ident" id="3756192"><a href="/net/http/cookie.go.html#3755845">name</a></span><span class="op" id="3756196">,</span>&nbsp;<span class="ident" id="3756198">Value</span><span class="op" id="3756203">:</span>&nbsp;<span class="ident" id="3756205"><a href="/net/http/cookie.go.html#3755851">val</a></span><span class="op" id="3756208">}</span><span class="op" id="3756209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756214"><a href="/net/http/cookie.go.html#3755702">parsedPairs</a></span><span class="op" id="3756225">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756230">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3756236">return</span>&nbsp;<span class="ident" id="3756243"><a href="/net/http/cookie.go.html#3755453">cookies</a></span><br>
<span class="lineno"></span><span class="op" id="3756251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3756254">//&nbsp;validCookieDomain&nbsp;returns&nbsp;wheter&nbsp;v&nbsp;is&nbsp;a&nbsp;valid&nbsp;cookie&nbsp;domain-value.</span><br>
<span class="lineno">220</span><span class="keyword" id="3756324">func</span>&nbsp;<span class="ident" id="3756329">validCookieDomain</span><span class="op" id="3756346">(</span><span class="ident" id="3756347">v</span>&nbsp;<span class="builtintype" id="3756349">string</span><span class="op" id="3756355">)</span>&nbsp;<span class="builtintype" id="3756357">bool</span>&nbsp;<span class="op" id="3756362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3756365">if</span>&nbsp;<span class="ident" id="3756368"><a href="/net/http/cookie.go.html#3756680">isCookieDomainName</a></span><span class="op" id="3756386">(</span><span class="ident" id="3756387"><a href="/net/http/cookie.go.html#3756347">v</a></span><span class="op" id="3756388">)</span>&nbsp;<span class="op" id="3756390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3756394">return</span>&nbsp;<span class="ident" id="3756401">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3756410">if</span>&nbsp;<span class="ident" id="3756413"><a href="/net/http/cookie.go.html#3751183">net</a></span><span class="op" id="3756416">.</span><span class="ident" id="3756417">ParseIP</span><span class="op" id="3756424">(</span><span class="ident" id="3756425"><a href="/net/http/cookie.go.html#3756347">v</a></span><span class="op" id="3756426">)</span>&nbsp;<span class="op" id="3756428">!=</span>&nbsp;<span class="ident" id="3756431">nil</span>&nbsp;<span class="op" id="3756435">&amp;&amp;</span>&nbsp;<span class="op" id="3756438">!</span><span class="ident" id="3756439"><a href="/net/http/cookie.go.html#3751201">strings</a></span><span class="op" id="3756446">.</span><span class="ident" id="3756447">Contains</span><span class="op" id="3756455">(</span><span class="ident" id="3756456"><a href="/net/http/cookie.go.html#3756347">v</a></span><span class="op" id="3756457">,</span>&nbsp;<span class="string" id="3756459">&#34;:&#34;</span><span class="op" id="3756462">)</span>&nbsp;<span class="op" id="3756464">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3756468">return</span>&nbsp;<span class="ident" id="3756475">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3756484">return</span>&nbsp;<span class="ident" id="3756491">false</span><br>
<span class="lineno"></span><span class="op" id="3756497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="comment" id="3756500">//&nbsp;isCookieDomainName&nbsp;returns&nbsp;whether&nbsp;s&nbsp;is&nbsp;a&nbsp;valid&nbsp;domain&nbsp;name&nbsp;or&nbsp;a&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="3756574">//&nbsp;domain&nbsp;name&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot&nbsp;&#39;.&#39;.&nbsp;&nbsp;It&nbsp;is&nbsp;almost&nbsp;a&nbsp;direct&nbsp;copy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3756644">//&nbsp;package&nbsp;net&#39;s&nbsp;isDomainName.</span><br>
<span class="lineno"></span><span class="keyword" id="3756675">func</span>&nbsp;<span class="ident" id="3756680">isCookieDomainName</span><span class="op" id="3756698">(</span><span class="ident" id="3756699">s</span>&nbsp;<span class="builtintype" id="3756701">string</span><span class="op" id="3756707">)</span>&nbsp;<span class="builtintype" id="3756709">bool</span>&nbsp;<span class="op" id="3756714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3756717">if</span>&nbsp;<span class="builtinfunc" id="3756720">len</span><span class="op" id="3756723">(</span><span class="ident" id="3756724"><a href="/net/http/cookie.go.html#3756699">s</a></span><span class="op" id="3756725">)</span>&nbsp;<span class="op" id="3756727">==</span>&nbsp;<span class="num" id="3756730">0</span>&nbsp;<span class="op" id="3756732">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3756736">return</span>&nbsp;<span class="ident" id="3756743">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3756753">if</span>&nbsp;<span class="builtinfunc" id="3756756">len</span><span class="op" id="3756759">(</span><span class="ident" id="3756760"><a href="/net/http/cookie.go.html#3756699">s</a></span><span class="op" id="3756761">)</span>&nbsp;<span class="op" id="3756763">&gt;</span>&nbsp;<span class="num" id="3756765">255</span>&nbsp;<span class="op" id="3756769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3756773">return</span>&nbsp;<span class="ident" id="3756780">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756787">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3756791">if</span>&nbsp;<span class="ident" id="3756794"><a href="/net/http/cookie.go.html#3756699">s</a></span><span class="op" id="3756795">[</span><span class="num" id="3756796">0</span><span class="op" id="3756797">]</span>&nbsp;<span class="op" id="3756799">==</span>&nbsp;<span class="string" id="3756802">&#39;.&#39;</span>&nbsp;<span class="op" id="3756806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3756810">//&nbsp;A&nbsp;cookie&nbsp;a&nbsp;domain&nbsp;attribute&nbsp;may&nbsp;start&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756873"><a href="/net/http/cookie.go.html#3756699">s</a></span>&nbsp;<span class="op" id="3756875">=</span>&nbsp;<span class="ident" id="3756877"><a href="/net/http/cookie.go.html#3756699">s</a></span><span class="op" id="3756878">[</span><span class="num" id="3756879">1</span><span class="op" id="3756880">:</span><span class="op" id="3756881">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756884">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756887">last</span>&nbsp;<span class="op" id="3756892">:=</span>&nbsp;<span class="builtintype" id="3756895">byte</span><span class="op" id="3756899">(</span><span class="string" id="3756900">&#39;.&#39;</span><span class="op" id="3756903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756906">ok</span>&nbsp;<span class="op" id="3756909">:=</span>&nbsp;<span class="ident" id="3756912">false</span>&nbsp;<span class="comment" id="3756918">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756951">partlen</span>&nbsp;<span class="op" id="3756959">:=</span>&nbsp;<span class="num" id="3756962">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3756965">for</span>&nbsp;<span class="ident" id="3756969">i</span>&nbsp;<span class="op" id="3756971">:=</span>&nbsp;<span class="num" id="3756974">0</span><span class="op" id="3756975">;</span>&nbsp;<span class="ident" id="3756977"><a href="/net/http/cookie.go.html#3756969">i</a></span>&nbsp;<span class="op" id="3756979">&lt;</span>&nbsp;<span class="builtinfunc" id="3756981">len</span><span class="op" id="3756984">(</span><span class="ident" id="3756985"><a href="/net/http/cookie.go.html#3756699">s</a></span><span class="op" id="3756986">)</span><span class="op" id="3756987">;</span>&nbsp;<span class="ident" id="3756989"><a href="/net/http/cookie.go.html#3756969">i</a></span><span class="op" id="3756990">++</span>&nbsp;<span class="op" id="3756993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756997">c</span>&nbsp;<span class="op" id="3756999">:=</span>&nbsp;<span class="ident" id="3757002"><a href="/net/http/cookie.go.html#3756699">s</a></span><span class="op" id="3757003">[</span><span class="ident" id="3757004"><a href="/net/http/cookie.go.html#3756969">i</a></span><span class="op" id="3757005">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757009">switch</span>&nbsp;<span class="op" id="3757016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757020">default</span><span class="op" id="3757027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757032">return</span>&nbsp;<span class="ident" id="3757039">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757047">case</span>&nbsp;<span class="string" id="3757052">&#39;a&#39;</span>&nbsp;<span class="op" id="3757056">&lt;=</span>&nbsp;<span class="ident" id="3757059"><a href="/net/http/cookie.go.html#3756997">c</a></span>&nbsp;<span class="op" id="3757061">&amp;&amp;</span>&nbsp;<span class="ident" id="3757064"><a href="/net/http/cookie.go.html#3756997">c</a></span>&nbsp;<span class="op" id="3757066">&lt;=</span>&nbsp;<span class="string" id="3757069">&#39;z&#39;</span>&nbsp;<span class="op" id="3757073">||</span>&nbsp;<span class="string" id="3757076">&#39;A&#39;</span>&nbsp;<span class="op" id="3757080">&lt;=</span>&nbsp;<span class="ident" id="3757083"><a href="/net/http/cookie.go.html#3756997">c</a></span>&nbsp;<span class="op" id="3757085">&amp;&amp;</span>&nbsp;<span class="ident" id="3757088"><a href="/net/http/cookie.go.html#3756997">c</a></span>&nbsp;<span class="op" id="3757090">&lt;=</span>&nbsp;<span class="string" id="3757093">&#39;Z&#39;</span><span class="op" id="3757096">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3757101">//&nbsp;No&nbsp;&#39;_&#39;&nbsp;allowed&nbsp;here&nbsp;(in&nbsp;contrast&nbsp;to&nbsp;package&nbsp;net).</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757157"><a href="/net/http/cookie.go.html#3756906">ok</a></span>&nbsp;<span class="op" id="3757160">=</span>&nbsp;<span class="ident" id="3757162">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757170"><a href="/net/http/cookie.go.html#3756951">partlen</a></span><span class="op" id="3757177">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757182">case</span>&nbsp;<span class="string" id="3757187">&#39;0&#39;</span>&nbsp;<span class="op" id="3757191">&lt;=</span>&nbsp;<span class="ident" id="3757194"><a href="/net/http/cookie.go.html#3756997">c</a></span>&nbsp;<span class="op" id="3757196">&amp;&amp;</span>&nbsp;<span class="ident" id="3757199"><a href="/net/http/cookie.go.html#3756997">c</a></span>&nbsp;<span class="op" id="3757201">&lt;=</span>&nbsp;<span class="string" id="3757204">&#39;9&#39;</span><span class="op" id="3757207">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3757212">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757223"><a href="/net/http/cookie.go.html#3756951">partlen</a></span><span class="op" id="3757230">++</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757235">case</span>&nbsp;<span class="ident" id="3757240"><a href="/net/http/cookie.go.html#3756997">c</a></span>&nbsp;<span class="op" id="3757242">==</span>&nbsp;<span class="string" id="3757245">&#39;-&#39;</span><span class="op" id="3757248">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3757253">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757291">if</span>&nbsp;<span class="ident" id="3757294"><a href="/net/http/cookie.go.html#3756887">last</a></span>&nbsp;<span class="op" id="3757299">==</span>&nbsp;<span class="string" id="3757302">&#39;.&#39;</span>&nbsp;<span class="op" id="3757306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757312">return</span>&nbsp;<span class="ident" id="3757319">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3757328">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757333"><a href="/net/http/cookie.go.html#3756951">partlen</a></span><span class="op" id="3757340">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757345">case</span>&nbsp;<span class="ident" id="3757350"><a href="/net/http/cookie.go.html#3756997">c</a></span>&nbsp;<span class="op" id="3757352">==</span>&nbsp;<span class="string" id="3757355">&#39;.&#39;</span><span class="op" id="3757358">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3757363">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757406">if</span>&nbsp;<span class="ident" id="3757409"><a href="/net/http/cookie.go.html#3756887">last</a></span>&nbsp;<span class="op" id="3757414">==</span>&nbsp;<span class="string" id="3757417">&#39;.&#39;</span>&nbsp;<span class="op" id="3757421">||</span>&nbsp;<span class="ident" id="3757424"><a href="/net/http/cookie.go.html#3756887">last</a></span>&nbsp;<span class="op" id="3757429">==</span>&nbsp;<span class="string" id="3757432">&#39;-&#39;</span>&nbsp;<span class="op" id="3757436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757442">return</span>&nbsp;<span class="ident" id="3757449">false</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3757458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757463">if</span>&nbsp;<span class="ident" id="3757466"><a href="/net/http/cookie.go.html#3756951">partlen</a></span>&nbsp;<span class="op" id="3757474">&gt;</span>&nbsp;<span class="num" id="3757476">63</span>&nbsp;<span class="op" id="3757479">||</span>&nbsp;<span class="ident" id="3757482"><a href="/net/http/cookie.go.html#3756951">partlen</a></span>&nbsp;<span class="op" id="3757490">==</span>&nbsp;<span class="num" id="3757493">0</span>&nbsp;<span class="op" id="3757495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757501">return</span>&nbsp;<span class="ident" id="3757508">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3757517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757522"><a href="/net/http/cookie.go.html#3756951">partlen</a></span>&nbsp;<span class="op" id="3757530">=</span>&nbsp;<span class="num" id="3757532">0</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3757536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757540"><a href="/net/http/cookie.go.html#3756887">last</a></span>&nbsp;<span class="op" id="3757545">=</span>&nbsp;<span class="ident" id="3757547"><a href="/net/http/cookie.go.html#3756997">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3757550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757553">if</span>&nbsp;<span class="ident" id="3757556"><a href="/net/http/cookie.go.html#3756887">last</a></span>&nbsp;<span class="op" id="3757561">==</span>&nbsp;<span class="string" id="3757564">&#39;-&#39;</span>&nbsp;<span class="op" id="3757568">||</span>&nbsp;<span class="ident" id="3757571"><a href="/net/http/cookie.go.html#3756951">partlen</a></span>&nbsp;<span class="op" id="3757579">&gt;</span>&nbsp;<span class="num" id="3757581">63</span>&nbsp;<span class="op" id="3757584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757588">return</span>&nbsp;<span class="ident" id="3757595">false</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3757602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757606">return</span>&nbsp;<span class="ident" id="3757613"><a href="/net/http/cookie.go.html#3756906">ok</a></span><br>
<span class="lineno"></span><span class="op" id="3757616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="3757619">var</span>&nbsp;<span class="ident" id="3757623">cookieNameSanitizer</span>&nbsp;<span class="op" id="3757643">=</span>&nbsp;<span class="ident" id="3757645"><a href="/net/http/cookie.go.html#3751201">strings</a></span><span class="op" id="3757652">.</span><span class="ident" id="3757653">NewReplacer</span><span class="op" id="3757664">(</span><span class="string" id="3757665">&#34;\n&#34;</span><span class="op" id="3757669">,</span>&nbsp;<span class="string" id="3757671">&#34;-&#34;</span><span class="op" id="3757674">,</span>&nbsp;<span class="string" id="3757676">&#34;\r&#34;</span><span class="op" id="3757680">,</span>&nbsp;<span class="string" id="3757682">&#34;-&#34;</span><span class="op" id="3757685">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3757688">func</span>&nbsp;<span class="ident" id="3757693">sanitizeCookieName</span><span class="op" id="3757711">(</span><span class="ident" id="3757712">n</span>&nbsp;<span class="builtintype" id="3757714">string</span><span class="op" id="3757720">)</span>&nbsp;<span class="builtintype" id="3757722">string</span>&nbsp;<span class="op" id="3757729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757732">return</span>&nbsp;<span class="ident" id="3757739"><a href="/net/http/cookie.go.html#3757623">cookieNameSanitizer</a></span><span class="op" id="3757758">.</span><span class="ident" id="3757759">Replace</span><span class="op" id="3757766">(</span><span class="ident" id="3757767"><a href="/net/http/cookie.go.html#3757712">n</a></span><span class="op" id="3757768">)</span><br>
<span class="lineno"></span><span class="op" id="3757770">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="3757773">//&nbsp;http://tools.ietf.org/html/rfc6265#section-4.1.1</span><br>
<span class="lineno"></span><span class="comment" id="3757825">//&nbsp;cookie-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;*cookie-octet&nbsp;/&nbsp;(&nbsp;DQUOTE&nbsp;*cookie-octet&nbsp;DQUOTE&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="3757896">//&nbsp;cookie-octet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;%x21&nbsp;/&nbsp;%x23-2B&nbsp;/&nbsp;%x2D-3A&nbsp;/&nbsp;%x3C-5B&nbsp;/&nbsp;%x5D-7E</span><br>
<span class="lineno"></span><span class="comment" id="3757964">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;US-ASCII&nbsp;characters&nbsp;excluding&nbsp;CTLs,</span><br>
<span class="lineno">295</span><span class="comment" id="3758015">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;whitespace&nbsp;DQUOTE,&nbsp;comma,&nbsp;semicolon,</span><br>
<span class="lineno"></span><span class="comment" id="3758067">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;and&nbsp;backslash</span><br>
<span class="lineno"></span><span class="comment" id="3758096">//&nbsp;We&nbsp;loosen&nbsp;this&nbsp;as&nbsp;spaces&nbsp;and&nbsp;commas&nbsp;are&nbsp;common&nbsp;in&nbsp;cookie&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="3758163">//&nbsp;but&nbsp;we&nbsp;produce&nbsp;a&nbsp;quoted&nbsp;cookie-value&nbsp;in&nbsp;when&nbsp;value&nbsp;starts&nbsp;or&nbsp;ends</span><br>
<span class="lineno"></span><span class="comment" id="3758232">//&nbsp;with&nbsp;a&nbsp;comma&nbsp;or&nbsp;space.</span><br>
<span class="lineno">300</span><span class="comment" id="3758258">//&nbsp;See&nbsp;http://golang.org/issue/7243&nbsp;for&nbsp;the&nbsp;discussion.</span><br>
<span class="lineno"></span><span class="keyword" id="3758314">func</span>&nbsp;<span class="ident" id="3758319">sanitizeCookieValue</span><span class="op" id="3758338">(</span><span class="ident" id="3758339">v</span>&nbsp;<span class="builtintype" id="3758341">string</span><span class="op" id="3758347">)</span>&nbsp;<span class="builtintype" id="3758349">string</span>&nbsp;<span class="op" id="3758356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758359"><a href="/net/http/cookie.go.html#3758339">v</a></span>&nbsp;<span class="op" id="3758361">=</span>&nbsp;<span class="ident" id="3758363"><a href="/net/http/cookie.go.html#3758971">sanitizeOrWarn</a></span><span class="op" id="3758377">(</span><span class="string" id="3758378">&#34;Cookie.Value&#34;</span><span class="op" id="3758392">,</span>&nbsp;<span class="ident" id="3758394"><a href="/net/http/cookie.go.html#3758572">validCookieValueByte</a></span><span class="op" id="3758414">,</span>&nbsp;<span class="ident" id="3758416"><a href="/net/http/cookie.go.html#3758339">v</a></span><span class="op" id="3758417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758420">if</span>&nbsp;<span class="builtinfunc" id="3758423">len</span><span class="op" id="3758426">(</span><span class="ident" id="3758427"><a href="/net/http/cookie.go.html#3758339">v</a></span><span class="op" id="3758428">)</span>&nbsp;<span class="op" id="3758430">==</span>&nbsp;<span class="num" id="3758433">0</span>&nbsp;<span class="op" id="3758435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758439">return</span>&nbsp;<span class="ident" id="3758446"><a href="/net/http/cookie.go.html#3758339">v</a></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3758449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758452">if</span>&nbsp;<span class="ident" id="3758455"><a href="/net/http/cookie.go.html#3758339">v</a></span><span class="op" id="3758456">[</span><span class="num" id="3758457">0</span><span class="op" id="3758458">]</span>&nbsp;<span class="op" id="3758460">==</span>&nbsp;<span class="string" id="3758463">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3758467">||</span>&nbsp;<span class="ident" id="3758470"><a href="/net/http/cookie.go.html#3758339">v</a></span><span class="op" id="3758471">[</span><span class="num" id="3758472">0</span><span class="op" id="3758473">]</span>&nbsp;<span class="op" id="3758475">==</span>&nbsp;<span class="string" id="3758478">&#39;,&#39;</span>&nbsp;<span class="op" id="3758482">||</span>&nbsp;<span class="ident" id="3758485"><a href="/net/http/cookie.go.html#3758339">v</a></span><span class="op" id="3758486">[</span><span class="builtinfunc" id="3758487">len</span><span class="op" id="3758490">(</span><span class="ident" id="3758491"><a href="/net/http/cookie.go.html#3758339">v</a></span><span class="op" id="3758492">)</span><span class="op" id="3758493">-</span><span class="num" id="3758494">1</span><span class="op" id="3758495">]</span>&nbsp;<span class="op" id="3758497">==</span>&nbsp;<span class="string" id="3758500">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3758504">||</span>&nbsp;<span class="ident" id="3758507"><a href="/net/http/cookie.go.html#3758339">v</a></span><span class="op" id="3758508">[</span><span class="builtinfunc" id="3758509">len</span><span class="op" id="3758512">(</span><span class="ident" id="3758513"><a href="/net/http/cookie.go.html#3758339">v</a></span><span class="op" id="3758514">)</span><span class="op" id="3758515">-</span><span class="num" id="3758516">1</span><span class="op" id="3758517">]</span>&nbsp;<span class="op" id="3758519">==</span>&nbsp;<span class="string" id="3758522">&#39;,&#39;</span>&nbsp;<span class="op" id="3758526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758530">return</span>&nbsp;<span class="string" id="3758537">`&#34;`</span>&nbsp;<span class="op" id="3758541">+</span>&nbsp;<span class="ident" id="3758543"><a href="/net/http/cookie.go.html#3758339">v</a></span>&nbsp;<span class="op" id="3758545">+</span>&nbsp;<span class="string" id="3758547">`&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3758552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758555">return</span>&nbsp;<span class="ident" id="3758562"><a href="/net/http/cookie.go.html#3758339">v</a></span><br>
<span class="lineno">310</span><span class="op" id="3758564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3758567">func</span>&nbsp;<span class="ident" id="3758572">validCookieValueByte</span><span class="op" id="3758592">(</span><span class="ident" id="3758593">b</span>&nbsp;<span class="builtintype" id="3758595">byte</span><span class="op" id="3758599">)</span>&nbsp;<span class="builtintype" id="3758601">bool</span>&nbsp;<span class="op" id="3758606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758609">return</span>&nbsp;<span class="num" id="3758616">0x20</span>&nbsp;<span class="op" id="3758621">&lt;=</span>&nbsp;<span class="ident" id="3758624"><a href="/net/http/cookie.go.html#3758593">b</a></span>&nbsp;<span class="op" id="3758626">&amp;&amp;</span>&nbsp;<span class="ident" id="3758629"><a href="/net/http/cookie.go.html#3758593">b</a></span>&nbsp;<span class="op" id="3758631">&lt;</span>&nbsp;<span class="num" id="3758633">0x7f</span>&nbsp;<span class="op" id="3758638">&amp;&amp;</span>&nbsp;<span class="ident" id="3758641"><a href="/net/http/cookie.go.html#3758593">b</a></span>&nbsp;<span class="op" id="3758643">!=</span>&nbsp;<span class="string" id="3758646">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3758650">&amp;&amp;</span>&nbsp;<span class="ident" id="3758653"><a href="/net/http/cookie.go.html#3758593">b</a></span>&nbsp;<span class="op" id="3758655">!=</span>&nbsp;<span class="string" id="3758658">&#39;;&#39;</span>&nbsp;<span class="op" id="3758662">&amp;&amp;</span>&nbsp;<span class="ident" id="3758665"><a href="/net/http/cookie.go.html#3758593">b</a></span>&nbsp;<span class="op" id="3758667">!=</span>&nbsp;<span class="string" id="3758670">&#39;\\&#39;</span><br>
<span class="lineno"></span><span class="op" id="3758675">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="3758678">//&nbsp;path-av&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&#34;Path=&#34;&nbsp;path-value</span><br>
<span class="lineno"></span><span class="comment" id="3758720">//&nbsp;path-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;any&nbsp;CHAR&nbsp;except&nbsp;CTLs&nbsp;or&nbsp;&#34;;&#34;&gt;</span><br>
<span class="lineno"></span><span class="keyword" id="3758773">func</span>&nbsp;<span class="ident" id="3758778">sanitizeCookiePath</span><span class="op" id="3758796">(</span><span class="ident" id="3758797">v</span>&nbsp;<span class="builtintype" id="3758799">string</span><span class="op" id="3758805">)</span>&nbsp;<span class="builtintype" id="3758807">string</span>&nbsp;<span class="op" id="3758814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758817">return</span>&nbsp;<span class="ident" id="3758824"><a href="/net/http/cookie.go.html#3758971">sanitizeOrWarn</a></span><span class="op" id="3758838">(</span><span class="string" id="3758839">&#34;Cookie.Path&#34;</span><span class="op" id="3758852">,</span>&nbsp;<span class="ident" id="3758854"><a href="/net/http/cookie.go.html#3758886">validCookiePathByte</a></span><span class="op" id="3758873">,</span>&nbsp;<span class="ident" id="3758875"><a href="/net/http/cookie.go.html#3758797">v</a></span><span class="op" id="3758876">)</span><br>
<span class="lineno">320</span><span class="op" id="3758878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3758881">func</span>&nbsp;<span class="ident" id="3758886">validCookiePathByte</span><span class="op" id="3758905">(</span><span class="ident" id="3758906">b</span>&nbsp;<span class="builtintype" id="3758908">byte</span><span class="op" id="3758912">)</span>&nbsp;<span class="builtintype" id="3758914">bool</span>&nbsp;<span class="op" id="3758919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758922">return</span>&nbsp;<span class="num" id="3758929">0x20</span>&nbsp;<span class="op" id="3758934">&lt;=</span>&nbsp;<span class="ident" id="3758937"><a href="/net/http/cookie.go.html#3758906">b</a></span>&nbsp;<span class="op" id="3758939">&amp;&amp;</span>&nbsp;<span class="ident" id="3758942"><a href="/net/http/cookie.go.html#3758906">b</a></span>&nbsp;<span class="op" id="3758944">&lt;</span>&nbsp;<span class="num" id="3758946">0x7f</span>&nbsp;<span class="op" id="3758951">&amp;&amp;</span>&nbsp;<span class="ident" id="3758954"><a href="/net/http/cookie.go.html#3758906">b</a></span>&nbsp;<span class="op" id="3758956">!=</span>&nbsp;<span class="string" id="3758959">&#39;;&#39;</span><br>
<span class="lineno"></span><span class="op" id="3758963">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="3758966">func</span>&nbsp;<span class="ident" id="3758971">sanitizeOrWarn</span><span class="op" id="3758985">(</span><span class="ident" id="3758986">fieldName</span>&nbsp;<span class="builtintype" id="3758996">string</span><span class="op" id="3759002">,</span>&nbsp;<span class="ident" id="3759004">valid</span>&nbsp;<span class="keyword" id="3759010">func</span><span class="op" id="3759014">(</span><span class="builtintype" id="3759015">byte</span><span class="op" id="3759019">)</span>&nbsp;<span class="builtintype" id="3759021">bool</span><span class="op" id="3759025">,</span>&nbsp;<span class="ident" id="3759027">v</span>&nbsp;<span class="builtintype" id="3759029">string</span><span class="op" id="3759035">)</span>&nbsp;<span class="builtintype" id="3759037">string</span>&nbsp;<span class="op" id="3759044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759047">ok</span>&nbsp;<span class="op" id="3759050">:=</span>&nbsp;<span class="ident" id="3759053">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759059">for</span>&nbsp;<span class="ident" id="3759063">i</span>&nbsp;<span class="op" id="3759065">:=</span>&nbsp;<span class="num" id="3759068">0</span><span class="op" id="3759069">;</span>&nbsp;<span class="ident" id="3759071"><a href="/net/http/cookie.go.html#3759063">i</a></span>&nbsp;<span class="op" id="3759073">&lt;</span>&nbsp;<span class="builtinfunc" id="3759075">len</span><span class="op" id="3759078">(</span><span class="ident" id="3759079"><a href="/net/http/cookie.go.html#3759027">v</a></span><span class="op" id="3759080">)</span><span class="op" id="3759081">;</span>&nbsp;<span class="ident" id="3759083"><a href="/net/http/cookie.go.html#3759063">i</a></span><span class="op" id="3759084">++</span>&nbsp;<span class="op" id="3759087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759091">if</span>&nbsp;<span class="ident" id="3759094"><a href="/net/http/cookie.go.html#3759004">valid</a></span><span class="op" id="3759099">(</span><span class="ident" id="3759100"><a href="/net/http/cookie.go.html#3759027">v</a></span><span class="op" id="3759101">[</span><span class="ident" id="3759102"><a href="/net/http/cookie.go.html#3759063">i</a></span><span class="op" id="3759103">]</span><span class="op" id="3759104">)</span>&nbsp;<span class="op" id="3759106">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759111">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759126"><a href="/net/http/cookie.go.html#3751176">log</a></span><span class="op" id="3759129">.</span><span class="ident" id="3759130">Printf</span><span class="op" id="3759136">(</span><span class="string" id="3759137">&#34;net/http:&nbsp;invalid&nbsp;byte&nbsp;%q&nbsp;in&nbsp;%s;&nbsp;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="3759194">,</span>&nbsp;<span class="ident" id="3759196"><a href="/net/http/cookie.go.html#3759027">v</a></span><span class="op" id="3759197">[</span><span class="ident" id="3759198"><a href="/net/http/cookie.go.html#3759063">i</a></span><span class="op" id="3759199">]</span><span class="op" id="3759200">,</span>&nbsp;<span class="ident" id="3759202"><a href="/net/http/cookie.go.html#3758986">fieldName</a></span><span class="op" id="3759211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759215"><a href="/net/http/cookie.go.html#3759047">ok</a></span>&nbsp;<span class="op" id="3759218">=</span>&nbsp;<span class="ident" id="3759220">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759228">break</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759238">if</span>&nbsp;<span class="ident" id="3759241"><a href="/net/http/cookie.go.html#3759047">ok</a></span>&nbsp;<span class="op" id="3759244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759248">return</span>&nbsp;<span class="ident" id="3759255"><a href="/net/http/cookie.go.html#3759027">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759261">buf</span>&nbsp;<span class="op" id="3759265">:=</span>&nbsp;<span class="builtinfunc" id="3759268">make</span><span class="op" id="3759272">(</span><span class="op" id="3759273">[</span><span class="op" id="3759274">]</span><span class="builtintype" id="3759275">byte</span><span class="op" id="3759279">,</span>&nbsp;<span class="num" id="3759281">0</span><span class="op" id="3759282">,</span>&nbsp;<span class="builtinfunc" id="3759284">len</span><span class="op" id="3759287">(</span><span class="ident" id="3759288"><a href="/net/http/cookie.go.html#3759027">v</a></span><span class="op" id="3759289">)</span><span class="op" id="3759290">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759293">for</span>&nbsp;<span class="ident" id="3759297">i</span>&nbsp;<span class="op" id="3759299">:=</span>&nbsp;<span class="num" id="3759302">0</span><span class="op" id="3759303">;</span>&nbsp;<span class="ident" id="3759305"><a href="/net/http/cookie.go.html#3759297">i</a></span>&nbsp;<span class="op" id="3759307">&lt;</span>&nbsp;<span class="builtinfunc" id="3759309">len</span><span class="op" id="3759312">(</span><span class="ident" id="3759313"><a href="/net/http/cookie.go.html#3759027">v</a></span><span class="op" id="3759314">)</span><span class="op" id="3759315">;</span>&nbsp;<span class="ident" id="3759317"><a href="/net/http/cookie.go.html#3759297">i</a></span><span class="op" id="3759318">++</span>&nbsp;<span class="op" id="3759321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759325">if</span>&nbsp;<span class="ident" id="3759328">b</span>&nbsp;<span class="op" id="3759330">:=</span>&nbsp;<span class="ident" id="3759333"><a href="/net/http/cookie.go.html#3759027">v</a></span><span class="op" id="3759334">[</span><span class="ident" id="3759335"><a href="/net/http/cookie.go.html#3759297">i</a></span><span class="op" id="3759336">]</span><span class="op" id="3759337">;</span>&nbsp;<span class="ident" id="3759339"><a href="/net/http/cookie.go.html#3759004">valid</a></span><span class="op" id="3759344">(</span><span class="ident" id="3759345"><a href="/net/http/cookie.go.html#3759328">b</a></span><span class="op" id="3759346">)</span>&nbsp;<span class="op" id="3759348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759353"><a href="/net/http/cookie.go.html#3759261">buf</a></span>&nbsp;<span class="op" id="3759357">=</span>&nbsp;<span class="builtinfunc" id="3759359">append</span><span class="op" id="3759365">(</span><span class="ident" id="3759366"><a href="/net/http/cookie.go.html#3759261">buf</a></span><span class="op" id="3759369">,</span>&nbsp;<span class="ident" id="3759371"><a href="/net/http/cookie.go.html#3759328">b</a></span><span class="op" id="3759372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759379">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759382">return</span>&nbsp;<span class="builtintype" id="3759389">string</span><span class="op" id="3759395">(</span><span class="ident" id="3759396"><a href="/net/http/cookie.go.html#3759261">buf</a></span><span class="op" id="3759399">)</span><br>
<span class="lineno"></span><span class="op" id="3759401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3759404">func</span>&nbsp;<span class="ident" id="3759409">parseCookieValue</span><span class="op" id="3759425">(</span><span class="ident" id="3759426">raw</span>&nbsp;<span class="builtintype" id="3759430">string</span><span class="op" id="3759436">,</span>&nbsp;<span class="ident" id="3759438">allowDoubleQuote</span>&nbsp;<span class="builtintype" id="3759455">bool</span><span class="op" id="3759459">)</span>&nbsp;<span class="op" id="3759461">(</span><span class="builtintype" id="3759462">string</span><span class="op" id="3759468">,</span>&nbsp;<span class="builtintype" id="3759470">bool</span><span class="op" id="3759474">)</span>&nbsp;<span class="op" id="3759476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3759479">//&nbsp;Strip&nbsp;the&nbsp;quotes,&nbsp;if&nbsp;present.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759513">if</span>&nbsp;<span class="ident" id="3759516"><a href="/net/http/cookie.go.html#3759438">allowDoubleQuote</a></span>&nbsp;<span class="op" id="3759533">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3759536">len</span><span class="op" id="3759539">(</span><span class="ident" id="3759540"><a href="/net/http/cookie.go.html#3759426">raw</a></span><span class="op" id="3759543">)</span>&nbsp;<span class="op" id="3759545">&gt;</span>&nbsp;<span class="num" id="3759547">1</span>&nbsp;<span class="op" id="3759549">&amp;&amp;</span>&nbsp;<span class="ident" id="3759552"><a href="/net/http/cookie.go.html#3759426">raw</a></span><span class="op" id="3759555">[</span><span class="num" id="3759556">0</span><span class="op" id="3759557">]</span>&nbsp;<span class="op" id="3759559">==</span>&nbsp;<span class="string" id="3759562">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3759566">&amp;&amp;</span>&nbsp;<span class="ident" id="3759569"><a href="/net/http/cookie.go.html#3759426">raw</a></span><span class="op" id="3759572">[</span><span class="builtinfunc" id="3759573">len</span><span class="op" id="3759576">(</span><span class="ident" id="3759577"><a href="/net/http/cookie.go.html#3759426">raw</a></span><span class="op" id="3759580">)</span><span class="op" id="3759581">-</span><span class="num" id="3759582">1</span><span class="op" id="3759583">]</span>&nbsp;<span class="op" id="3759585">==</span>&nbsp;<span class="string" id="3759588">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3759592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759596"><a href="/net/http/cookie.go.html#3759426">raw</a></span>&nbsp;<span class="op" id="3759600">=</span>&nbsp;<span class="ident" id="3759602"><a href="/net/http/cookie.go.html#3759426">raw</a></span><span class="op" id="3759605">[</span><span class="num" id="3759606">1</span>&nbsp;<span class="op" id="3759608">:</span>&nbsp;<span class="builtinfunc" id="3759610">len</span><span class="op" id="3759613">(</span><span class="ident" id="3759614"><a href="/net/http/cookie.go.html#3759426">raw</a></span><span class="op" id="3759617">)</span><span class="op" id="3759618">-</span><span class="num" id="3759619">1</span><span class="op" id="3759620">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759626">for</span>&nbsp;<span class="ident" id="3759630">i</span>&nbsp;<span class="op" id="3759632">:=</span>&nbsp;<span class="num" id="3759635">0</span><span class="op" id="3759636">;</span>&nbsp;<span class="ident" id="3759638"><a href="/net/http/cookie.go.html#3759630">i</a></span>&nbsp;<span class="op" id="3759640">&lt;</span>&nbsp;<span class="builtinfunc" id="3759642">len</span><span class="op" id="3759645">(</span><span class="ident" id="3759646"><a href="/net/http/cookie.go.html#3759426">raw</a></span><span class="op" id="3759649">)</span><span class="op" id="3759650">;</span>&nbsp;<span class="ident" id="3759652"><a href="/net/http/cookie.go.html#3759630">i</a></span><span class="op" id="3759653">++</span>&nbsp;<span class="op" id="3759656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759660">if</span>&nbsp;<span class="op" id="3759663">!</span><span class="ident" id="3759664"><a href="/net/http/cookie.go.html#3758572">validCookieValueByte</a></span><span class="op" id="3759684">(</span><span class="ident" id="3759685"><a href="/net/http/cookie.go.html#3759426">raw</a></span><span class="op" id="3759688">[</span><span class="ident" id="3759689"><a href="/net/http/cookie.go.html#3759630">i</a></span><span class="op" id="3759690">]</span><span class="op" id="3759691">)</span>&nbsp;<span class="op" id="3759693">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759698">return</span>&nbsp;<span class="string" id="3759705">&#34;&#34;</span><span class="op" id="3759707">,</span>&nbsp;<span class="ident" id="3759709">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759723">return</span>&nbsp;<span class="ident" id="3759730"><a href="/net/http/cookie.go.html#3759426">raw</a></span><span class="op" id="3759733">,</span>&nbsp;<span class="ident" id="3759735">true</span><br>
<span class="lineno"></span><span class="op" id="3759740">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="3759743">func</span>&nbsp;<span class="ident" id="3759748">isCookieNameValid</span><span class="op" id="3759765">(</span><span class="ident" id="3759766">raw</span>&nbsp;<span class="builtintype" id="3759770">string</span><span class="op" id="3759776">)</span>&nbsp;<span class="builtintype" id="3759778">bool</span>&nbsp;<span class="op" id="3759783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759786">return</span>&nbsp;<span class="ident" id="3759793"><a href="/net/http/cookie.go.html#3751201">strings</a></span><span class="op" id="3759800">.</span><span class="ident" id="3759801">IndexFunc</span><span class="op" id="3759810">(</span><span class="ident" id="3759811"><a href="/net/http/cookie.go.html#3759766">raw</a></span><span class="op" id="3759814">,</span>&nbsp;<span class="ident" id="3759816"><a href="/net/http/lex.go.html#3789213">isNotToken</a></span><span class="op" id="3759826">)</span>&nbsp;<span class="op" id="3759828">&lt;</span>&nbsp;<span class="num" id="3759830">0</span><br>
<span class="lineno"></span><span class="op" id="3759832">}</span>
</div>
</body>
</html>
