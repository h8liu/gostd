<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html" class="current">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6147615">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6147670">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6147724">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6147775">package</span>&nbsp;<span class="ident" id="6147783">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6147790">import</span>&nbsp;<span class="string" id="6147797">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6147805">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="6147865">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="6147935">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="6147993">//</span><br>
<span class="lineno"></span><span class="comment" id="6147996">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="6148044">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="6148108">//</span><br>
<span class="lineno"></span><span class="comment" id="6148111">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="6148172">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6148242">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="6148317">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6148384">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="6148457">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6148529">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="6148543">//</span><br>
<span class="lineno"></span><span class="comment" id="6148546">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="6148612">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="6148678">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="6148691">//</span><br>
<span class="lineno"></span><span class="comment" id="6148694">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="6148718">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6148748">//&nbsp;Complex&nbsp;square&nbsp;root</span><br>
<span class="lineno"></span><span class="comment" id="6148771">//</span><br>
<span class="lineno"></span><span class="comment" id="6148774">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6148790">//</span><br>
<span class="lineno">35</span><span class="comment" id="6148793">//&nbsp;If&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,&nbsp;&nbsp;r&nbsp;=&nbsp;|z|,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6148826">//</span><br>
<span class="lineno"></span><span class="comment" id="6148829">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/2</span><br>
<span class="lineno"></span><span class="comment" id="6148858">//&nbsp;Re&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;[&nbsp;(r&nbsp;+&nbsp;x)/2&nbsp;]&nbsp;&nbsp;&nbsp;,</span><br>
<span class="lineno"></span><span class="comment" id="6148888">//</span><br>
<span class="lineno">40</span><span class="comment" id="6148891">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/2</span><br>
<span class="lineno"></span><span class="comment" id="6148920">//&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;[&nbsp;(r&nbsp;-&nbsp;x)/2&nbsp;]&nbsp;&nbsp;&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="6148950">//</span><br>
<span class="lineno"></span><span class="comment" id="6148953">//&nbsp;Cancellation&nbsp;error&nbsp;in&nbsp;r-x&nbsp;or&nbsp;r+x&nbsp;is&nbsp;avoided&nbsp;by&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6149013">//&nbsp;identity&nbsp;&nbsp;2&nbsp;Re&nbsp;w&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;y.</span><br>
<span class="lineno">45</span><span class="comment" id="6149045">//</span><br>
<span class="lineno"></span><span class="comment" id="6149048">//&nbsp;Note&nbsp;that&nbsp;-w&nbsp;is&nbsp;also&nbsp;a&nbsp;square&nbsp;root&nbsp;of&nbsp;z.&nbsp;&nbsp;The&nbsp;root&nbsp;chosen</span><br>
<span class="lineno"></span><span class="comment" id="6149109">//&nbsp;is&nbsp;always&nbsp;in&nbsp;the&nbsp;right&nbsp;half&nbsp;plane&nbsp;and&nbsp;Im&nbsp;w&nbsp;has&nbsp;the&nbsp;same&nbsp;sign&nbsp;as&nbsp;y.</span><br>
<span class="lineno"></span><span class="comment" id="6149179">//</span><br>
<span class="lineno"></span><span class="comment" id="6149182">//&nbsp;ACCURACY:</span><br>
<span class="lineno">50</span><span class="comment" id="6149195">//</span><br>
<span class="lineno"></span><span class="comment" id="6149198">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6149238">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="6149296">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.6e-18</span><br>
<span class="lineno"></span><span class="comment" id="6149356">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;1,000,000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.9e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.1e-17</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="6149417">//&nbsp;Sqrt&nbsp;returns&nbsp;the&nbsp;square&nbsp;root&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="6149455">//&nbsp;The&nbsp;result&nbsp;r&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;real(r)&nbsp;â‰¥&nbsp;0&nbsp;and&nbsp;imag(r)&nbsp;has&nbsp;the&nbsp;same&nbsp;sign&nbsp;as&nbsp;imag(x).</span><br>
<span class="lineno"></span><span class="keyword" id="6149545">func</span>&nbsp;<span class="ident" id="6149550">Sqrt</span><span class="op" id="6149554">(</span><span class="ident" id="6149555">x</span>&nbsp;<span class="builtintype" id="6149557">complex128</span><span class="op" id="6149567">)</span>&nbsp;<span class="builtintype" id="6149569">complex128</span>&nbsp;<span class="op" id="6149580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149583">if</span>&nbsp;<span class="builtinfunc" id="6149586">imag</span><span class="op" id="6149590">(</span><span class="ident" id="6149591">x</span><span class="op" id="6149592">)</span>&nbsp;<span class="op" id="6149594">==</span>&nbsp;<span class="num" id="6149597">0</span>&nbsp;<span class="op" id="6149599">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149603">if</span>&nbsp;<span class="builtinfunc" id="6149606">real</span><span class="op" id="6149610">(</span><span class="ident" id="6149611">x</span><span class="op" id="6149612">)</span>&nbsp;<span class="op" id="6149614">==</span>&nbsp;<span class="num" id="6149617">0</span>&nbsp;<span class="op" id="6149619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149624">return</span>&nbsp;<span class="builtinfunc" id="6149631">complex</span><span class="op" id="6149638">(</span><span class="num" id="6149639">0</span><span class="op" id="6149640">,</span>&nbsp;<span class="num" id="6149642">0</span><span class="op" id="6149643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6149647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149651">if</span>&nbsp;<span class="builtinfunc" id="6149654">real</span><span class="op" id="6149658">(</span><span class="ident" id="6149659">x</span><span class="op" id="6149660">)</span>&nbsp;<span class="op" id="6149662">&lt;</span>&nbsp;<span class="num" id="6149664">0</span>&nbsp;<span class="op" id="6149666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149671">return</span>&nbsp;<span class="builtinfunc" id="6149678">complex</span><span class="op" id="6149685">(</span><span class="num" id="6149686">0</span><span class="op" id="6149687">,</span>&nbsp;<span class="ident" id="6149689">math</span><span class="op" id="6149693">.</span><span class="ident" id="6149694">Sqrt</span><span class="op" id="6149698">(</span><span class="op" id="6149699">-</span><span class="builtinfunc" id="6149700">real</span><span class="op" id="6149704">(</span><span class="ident" id="6149705">x</span><span class="op" id="6149706">)</span><span class="op" id="6149707">)</span><span class="op" id="6149708">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6149712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149716">return</span>&nbsp;<span class="builtinfunc" id="6149723">complex</span><span class="op" id="6149730">(</span><span class="ident" id="6149731">math</span><span class="op" id="6149735">.</span><span class="ident" id="6149736">Sqrt</span><span class="op" id="6149740">(</span><span class="builtinfunc" id="6149741">real</span><span class="op" id="6149745">(</span><span class="ident" id="6149746">x</span><span class="op" id="6149747">)</span><span class="op" id="6149748">)</span><span class="op" id="6149749">,</span>&nbsp;<span class="num" id="6149751">0</span><span class="op" id="6149752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6149755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149758">if</span>&nbsp;<span class="builtinfunc" id="6149761">real</span><span class="op" id="6149765">(</span><span class="ident" id="6149766">x</span><span class="op" id="6149767">)</span>&nbsp;<span class="op" id="6149769">==</span>&nbsp;<span class="num" id="6149772">0</span>&nbsp;<span class="op" id="6149774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149778">if</span>&nbsp;<span class="builtinfunc" id="6149781">imag</span><span class="op" id="6149785">(</span><span class="ident" id="6149786">x</span><span class="op" id="6149787">)</span>&nbsp;<span class="op" id="6149789">&lt;</span>&nbsp;<span class="num" id="6149791">0</span>&nbsp;<span class="op" id="6149793">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149798">r</span>&nbsp;<span class="op" id="6149800">:=</span>&nbsp;<span class="ident" id="6149803">math</span><span class="op" id="6149807">.</span><span class="ident" id="6149808">Sqrt</span><span class="op" id="6149812">(</span><span class="op" id="6149813">-</span><span class="num" id="6149814">0.5</span>&nbsp;<span class="op" id="6149818">*</span>&nbsp;<span class="builtinfunc" id="6149820">imag</span><span class="op" id="6149824">(</span><span class="ident" id="6149825">x</span><span class="op" id="6149826">)</span><span class="op" id="6149827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149832">return</span>&nbsp;<span class="builtinfunc" id="6149839">complex</span><span class="op" id="6149846">(</span><span class="ident" id="6149847">r</span><span class="op" id="6149848">,</span>&nbsp;<span class="op" id="6149850">-</span><span class="ident" id="6149851">r</span><span class="op" id="6149852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6149856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149860">r</span>&nbsp;<span class="op" id="6149862">:=</span>&nbsp;<span class="ident" id="6149865">math</span><span class="op" id="6149869">.</span><span class="ident" id="6149870">Sqrt</span><span class="op" id="6149874">(</span><span class="num" id="6149875">0.5</span>&nbsp;<span class="op" id="6149879">*</span>&nbsp;<span class="builtinfunc" id="6149881">imag</span><span class="op" id="6149885">(</span><span class="ident" id="6149886">x</span><span class="op" id="6149887">)</span><span class="op" id="6149888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149892">return</span>&nbsp;<span class="builtinfunc" id="6149899">complex</span><span class="op" id="6149906">(</span><span class="ident" id="6149907">r</span><span class="op" id="6149908">,</span>&nbsp;<span class="ident" id="6149910">r</span><span class="op" id="6149911">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6149914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149917">a</span>&nbsp;<span class="op" id="6149919">:=</span>&nbsp;<span class="builtinfunc" id="6149922">real</span><span class="op" id="6149926">(</span><span class="ident" id="6149927">x</span><span class="op" id="6149928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149931">b</span>&nbsp;<span class="op" id="6149933">:=</span>&nbsp;<span class="builtinfunc" id="6149936">imag</span><span class="op" id="6149940">(</span><span class="ident" id="6149941">x</span><span class="op" id="6149942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149945">var</span>&nbsp;<span class="ident" id="6149949">scale</span>&nbsp;<span class="builtintype" id="6149955">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6149964">//&nbsp;Rescale&nbsp;to&nbsp;avoid&nbsp;internal&nbsp;overflow&nbsp;or&nbsp;underflow.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150017">if</span>&nbsp;<span class="ident" id="6150020">math</span><span class="op" id="6150024">.</span><span class="ident" id="6150025">Abs</span><span class="op" id="6150028">(</span><span class="ident" id="6150029">a</span><span class="op" id="6150030">)</span>&nbsp;<span class="op" id="6150032">&gt;</span>&nbsp;<span class="num" id="6150034">4</span>&nbsp;<span class="op" id="6150036">||</span>&nbsp;<span class="ident" id="6150039">math</span><span class="op" id="6150043">.</span><span class="ident" id="6150044">Abs</span><span class="op" id="6150047">(</span><span class="ident" id="6150048">b</span><span class="op" id="6150049">)</span>&nbsp;<span class="op" id="6150051">&gt;</span>&nbsp;<span class="num" id="6150053">4</span>&nbsp;<span class="op" id="6150055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150059">a</span>&nbsp;<span class="op" id="6150061">*=</span>&nbsp;<span class="num" id="6150064">0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150071">b</span>&nbsp;<span class="op" id="6150073">*=</span>&nbsp;<span class="num" id="6150076">0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150083">scale</span>&nbsp;<span class="op" id="6150089">=</span>&nbsp;<span class="num" id="6150091">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150094">}</span>&nbsp;<span class="keyword" id="6150096">else</span>&nbsp;<span class="op" id="6150101">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150105">a</span>&nbsp;<span class="op" id="6150107">*=</span>&nbsp;<span class="num" id="6150110">1.8014398509481984e16</span>&nbsp;<span class="comment" id="6150132">//&nbsp;2**54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150143">b</span>&nbsp;<span class="op" id="6150145">*=</span>&nbsp;<span class="num" id="6150148">1.8014398509481984e16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150172">scale</span>&nbsp;<span class="op" id="6150178">=</span>&nbsp;<span class="num" id="6150180">7.450580596923828125e-9</span>&nbsp;<span class="comment" id="6150204">//&nbsp;2**-27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150218">r</span>&nbsp;<span class="op" id="6150220">:=</span>&nbsp;<span class="ident" id="6150223">math</span><span class="op" id="6150227">.</span><span class="ident" id="6150228">Hypot</span><span class="op" id="6150233">(</span><span class="ident" id="6150234">a</span><span class="op" id="6150235">,</span>&nbsp;<span class="ident" id="6150237">b</span><span class="op" id="6150238">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150241">var</span>&nbsp;<span class="ident" id="6150245">t</span>&nbsp;<span class="builtintype" id="6150247">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150256">if</span>&nbsp;<span class="ident" id="6150259">a</span>&nbsp;<span class="op" id="6150261">&gt;</span>&nbsp;<span class="num" id="6150263">0</span>&nbsp;<span class="op" id="6150265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150269">t</span>&nbsp;<span class="op" id="6150271">=</span>&nbsp;<span class="ident" id="6150273">math</span><span class="op" id="6150277">.</span><span class="ident" id="6150278">Sqrt</span><span class="op" id="6150282">(</span><span class="num" id="6150283">0.5</span><span class="op" id="6150286">*</span><span class="ident" id="6150287">r</span>&nbsp;<span class="op" id="6150289">+</span>&nbsp;<span class="num" id="6150291">0.5</span><span class="op" id="6150294">*</span><span class="ident" id="6150295">a</span><span class="op" id="6150296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150300">r</span>&nbsp;<span class="op" id="6150302">=</span>&nbsp;<span class="ident" id="6150304">scale</span>&nbsp;<span class="op" id="6150310">*</span>&nbsp;<span class="ident" id="6150312">math</span><span class="op" id="6150316">.</span><span class="ident" id="6150317">Abs</span><span class="op" id="6150320">(</span><span class="op" id="6150321">(</span><span class="num" id="6150322">0.5</span><span class="op" id="6150325">*</span><span class="ident" id="6150326">b</span><span class="op" id="6150327">)</span><span class="op" id="6150328">/</span><span class="ident" id="6150329">t</span><span class="op" id="6150330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150334">t</span>&nbsp;<span class="op" id="6150336">*=</span>&nbsp;<span class="ident" id="6150339">scale</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150346">}</span>&nbsp;<span class="keyword" id="6150348">else</span>&nbsp;<span class="op" id="6150353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150357">r</span>&nbsp;<span class="op" id="6150359">=</span>&nbsp;<span class="ident" id="6150361">math</span><span class="op" id="6150365">.</span><span class="ident" id="6150366">Sqrt</span><span class="op" id="6150370">(</span><span class="num" id="6150371">0.5</span><span class="op" id="6150374">*</span><span class="ident" id="6150375">r</span>&nbsp;<span class="op" id="6150377">-</span>&nbsp;<span class="num" id="6150379">0.5</span><span class="op" id="6150382">*</span><span class="ident" id="6150383">a</span><span class="op" id="6150384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150388">t</span>&nbsp;<span class="op" id="6150390">=</span>&nbsp;<span class="ident" id="6150392">scale</span>&nbsp;<span class="op" id="6150398">*</span>&nbsp;<span class="ident" id="6150400">math</span><span class="op" id="6150404">.</span><span class="ident" id="6150405">Abs</span><span class="op" id="6150408">(</span><span class="op" id="6150409">(</span><span class="num" id="6150410">0.5</span><span class="op" id="6150413">*</span><span class="ident" id="6150414">b</span><span class="op" id="6150415">)</span><span class="op" id="6150416">/</span><span class="ident" id="6150417">r</span><span class="op" id="6150418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150422">r</span>&nbsp;<span class="op" id="6150424">*=</span>&nbsp;<span class="ident" id="6150427">scale</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150434">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150437">if</span>&nbsp;<span class="ident" id="6150440">b</span>&nbsp;<span class="op" id="6150442">&lt;</span>&nbsp;<span class="num" id="6150444">0</span>&nbsp;<span class="op" id="6150446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150450">return</span>&nbsp;<span class="builtinfunc" id="6150457">complex</span><span class="op" id="6150464">(</span><span class="ident" id="6150465">t</span><span class="op" id="6150466">,</span>&nbsp;<span class="op" id="6150468">-</span><span class="ident" id="6150469">r</span><span class="op" id="6150470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150476">return</span>&nbsp;<span class="builtinfunc" id="6150483">complex</span><span class="op" id="6150490">(</span><span class="ident" id="6150491">t</span><span class="op" id="6150492">,</span>&nbsp;<span class="ident" id="6150494">r</span><span class="op" id="6150495">)</span><br>
<span class="lineno"></span><span class="op" id="6150497">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
