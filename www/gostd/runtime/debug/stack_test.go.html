<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7769989">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7770044">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7770098">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7770149">package</span>&nbsp;<span class="ident" id="7770157">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7770164">import</span>&nbsp;<span class="op" id="7770171">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7770174">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7770185">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7770195">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7770198">type</span>&nbsp;<span class="ident" id="7770203">T</span>&nbsp;<span class="builtintype" id="7770205">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7770210">func</span>&nbsp;<span class="op" id="7770215">(</span><span class="ident" id="7770216">t</span>&nbsp;<span class="op" id="7770218">*</span><span class="ident" id="7770219">T</span><span class="op" id="7770220">)</span>&nbsp;<span class="ident" id="7770222">ptrmethod</span><span class="op" id="7770231">(</span><span class="op" id="7770232">)</span>&nbsp;<span class="op" id="7770234">[</span><span class="op" id="7770235">]</span><span class="builtintype" id="7770236">byte</span>&nbsp;<span class="op" id="7770241">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7770244">return</span>&nbsp;<span class="ident" id="7770251">Stack</span><span class="op" id="7770256">(</span><span class="op" id="7770257">)</span><br>
<span class="lineno"></span><span class="op" id="7770259">}</span><br>
<span class="lineno"></span><span class="keyword" id="7770261">func</span>&nbsp;<span class="op" id="7770266">(</span><span class="ident" id="7770267">t</span>&nbsp;<span class="ident" id="7770269">T</span><span class="op" id="7770270">)</span>&nbsp;<span class="ident" id="7770272">method</span><span class="op" id="7770278">(</span><span class="op" id="7770279">)</span>&nbsp;<span class="op" id="7770281">[</span><span class="op" id="7770282">]</span><span class="builtintype" id="7770283">byte</span>&nbsp;<span class="op" id="7770288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7770291">return</span>&nbsp;<span class="ident" id="7770298">t</span><span class="op" id="7770299">.</span><span class="ident" id="7770300">ptrmethod</span><span class="op" id="7770309">(</span><span class="op" id="7770310">)</span><br>
<span class="lineno"></span><span class="op" id="7770312">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="7770315">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspThe&nbsp;traceback&nbsp;should&nbsp;look&nbsp;something&nbsp;like&nbsp;this,&nbsp;modulo&nbsp;line&nbsp;numbers&nbsp;and&nbsp;hex&nbsp;constants.<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspDon&#39;t&nbsp;worry&nbsp;much&nbsp;about&nbsp;the&nbsp;base&nbsp;levels,&nbsp;but&nbsp;check&nbsp;the&nbsp;ones&nbsp;in&nbsp;our&nbsp;own&nbsp;package.<br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp/Users/r/go/src/runtime/debug/stack_test.go:15&nbsp;(0x13878)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp(*T).ptrmethod:&nbsp;return&nbsp;Stack()<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp/Users/r/go/src/runtime/debug/stack_test.go:18&nbsp;(0x138dd)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspT.method:&nbsp;return&nbsp;t.ptrmethod()<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp/Users/r/go/src/runtime/debug/stack_test.go:23&nbsp;(0x13920)<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspTestStack:&nbsp;b&nbsp;:=&nbsp;T(0).method()<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp/Users/r/go/src/testing/testing.go:132&nbsp;(0x14a7a)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsptRunner:&nbsp;test.F(t)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp/Users/r/go/src/runtime/proc.c:145&nbsp;(0xc970)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp???:&nbsp;runtime·unlock(&amp;runtime·sched);<br>
<span class="lineno">35</span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="7770928">func</span>&nbsp;<span class="ident" id="7770933">TestStack</span><span class="op" id="7770942">(</span><span class="ident" id="7770943">t</span>&nbsp;<span class="op" id="7770945">*</span><span class="ident" id="7770946">testing</span><span class="op" id="7770953">.</span><span class="ident" id="7770954">T</span><span class="op" id="7770955">)</span>&nbsp;<span class="op" id="7770957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7770960">b</span>&nbsp;<span class="op" id="7770962">:=</span>&nbsp;<span class="ident" id="7770965">T</span><span class="op" id="7770966">(</span><span class="num" id="7770967">0</span><span class="op" id="7770968">)</span><span class="op" id="7770969">.</span><span class="ident" id="7770970">method</span><span class="op" id="7770976">(</span><span class="op" id="7770977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7770980">lines</span>&nbsp;<span class="op" id="7770986">:=</span>&nbsp;<span class="ident" id="7770989">strings</span><span class="op" id="7770996">.</span><span class="ident" id="7770997">Split</span><span class="op" id="7771002">(</span><span class="builtintype" id="7771003">string</span><span class="op" id="7771009">(</span><span class="ident" id="7771010">b</span><span class="op" id="7771011">)</span><span class="op" id="7771012">,</span>&nbsp;<span class="string" id="7771014">&#34;\n&#34;</span><span class="op" id="7771018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7771021">if</span>&nbsp;<span class="builtinfunc" id="7771024">len</span><span class="op" id="7771027">(</span><span class="ident" id="7771028">lines</span><span class="op" id="7771033">)</span>&nbsp;<span class="op" id="7771035">&lt;</span>&nbsp;<span class="num" id="7771037">6</span>&nbsp;<span class="op" id="7771039">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7771043">t</span><span class="op" id="7771044">.</span><span class="ident" id="7771045">Fatal</span><span class="op" id="7771050">(</span><span class="string" id="7771051">&#34;too&nbsp;few&nbsp;lines&#34;</span><span class="op" id="7771066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7771069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7771072">n</span>&nbsp;<span class="op" id="7771074">:=</span>&nbsp;<span class="num" id="7771077">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7771080">frame</span>&nbsp;<span class="op" id="7771086">:=</span>&nbsp;<span class="keyword" id="7771089">func</span><span class="op" id="7771093">(</span><span class="ident" id="7771094">line</span><span class="op" id="7771098">,</span>&nbsp;<span class="ident" id="7771100">code</span>&nbsp;<span class="builtintype" id="7771105">string</span><span class="op" id="7771111">)</span>&nbsp;<span class="op" id="7771113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7771117">check</span><span class="op" id="7771122">(</span><span class="ident" id="7771123">t</span><span class="op" id="7771124">,</span>&nbsp;<span class="ident" id="7771126">lines</span><span class="op" id="7771131">[</span><span class="ident" id="7771132">n</span><span class="op" id="7771133">]</span><span class="op" id="7771134">,</span>&nbsp;<span class="ident" id="7771136">line</span><span class="op" id="7771140">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7771144">n</span><span class="op" id="7771145">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7771150">//&nbsp;The&nbsp;source&nbsp;might&nbsp;not&nbsp;be&nbsp;available&nbsp;while&nbsp;running&nbsp;the&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7771213">if</span>&nbsp;<span class="ident" id="7771216">strings</span><span class="op" id="7771223">.</span><span class="ident" id="7771224">HasPrefix</span><span class="op" id="7771233">(</span><span class="ident" id="7771234">lines</span><span class="op" id="7771239">[</span><span class="ident" id="7771240">n</span><span class="op" id="7771241">]</span><span class="op" id="7771242">,</span>&nbsp;<span class="string" id="7771244">&#34;\t&#34;</span><span class="op" id="7771248">)</span>&nbsp;<span class="op" id="7771250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7771255">check</span><span class="op" id="7771260">(</span><span class="ident" id="7771261">t</span><span class="op" id="7771262">,</span>&nbsp;<span class="ident" id="7771264">lines</span><span class="op" id="7771269">[</span><span class="ident" id="7771270">n</span><span class="op" id="7771271">]</span><span class="op" id="7771272">,</span>&nbsp;<span class="ident" id="7771274">code</span><span class="op" id="7771278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7771283">n</span><span class="op" id="7771284">++</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7771289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7771292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7771295">frame</span><span class="op" id="7771300">(</span><span class="string" id="7771301">&#34;src/runtime/debug/stack_test.go&#34;</span><span class="op" id="7771334">,</span>&nbsp;<span class="string" id="7771336">&#34;\t(*T).ptrmethod:&nbsp;return&nbsp;Stack()&#34;</span><span class="op" id="7771370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7771373">frame</span><span class="op" id="7771378">(</span><span class="string" id="7771379">&#34;src/runtime/debug/stack_test.go&#34;</span><span class="op" id="7771412">,</span>&nbsp;<span class="string" id="7771414">&#34;\tT.method:&nbsp;return&nbsp;t.ptrmethod()&#34;</span><span class="op" id="7771448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7771451">frame</span><span class="op" id="7771456">(</span><span class="string" id="7771457">&#34;src/runtime/debug/stack_test.go&#34;</span><span class="op" id="7771490">,</span>&nbsp;<span class="string" id="7771492">&#34;\tTestStack:&nbsp;b&nbsp;:=&nbsp;T(0).method()&#34;</span><span class="op" id="7771525">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7771528">frame</span><span class="op" id="7771533">(</span><span class="string" id="7771534">&#34;src/testing/testing.go&#34;</span><span class="op" id="7771558">,</span>&nbsp;<span class="string" id="7771560">&#34;&#34;</span><span class="op" id="7771562">)</span><br>
<span class="lineno"></span><span class="op" id="7771564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7771567">func</span>&nbsp;<span class="ident" id="7771572">check</span><span class="op" id="7771577">(</span><span class="ident" id="7771578">t</span>&nbsp;<span class="op" id="7771580">*</span><span class="ident" id="7771581">testing</span><span class="op" id="7771588">.</span><span class="ident" id="7771589">T</span><span class="op" id="7771590">,</span>&nbsp;<span class="ident" id="7771592">line</span><span class="op" id="7771596">,</span>&nbsp;<span class="ident" id="7771598">has</span>&nbsp;<span class="builtintype" id="7771602">string</span><span class="op" id="7771608">)</span>&nbsp;<span class="op" id="7771610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7771613">if</span>&nbsp;<span class="ident" id="7771616">strings</span><span class="op" id="7771623">.</span><span class="ident" id="7771624">Index</span><span class="op" id="7771629">(</span><span class="ident" id="7771630">line</span><span class="op" id="7771634">,</span>&nbsp;<span class="ident" id="7771636">has</span><span class="op" id="7771639">)</span>&nbsp;<span class="op" id="7771641">&lt;</span>&nbsp;<span class="num" id="7771643">0</span>&nbsp;<span class="op" id="7771645">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7771649">t</span><span class="op" id="7771650">.</span><span class="ident" id="7771651">Errorf</span><span class="op" id="7771657">(</span><span class="string" id="7771658">&#34;expected&nbsp;%q&nbsp;in&nbsp;%q&#34;</span><span class="op" id="7771677">,</span>&nbsp;<span class="ident" id="7771679">has</span><span class="op" id="7771682">,</span>&nbsp;<span class="ident" id="7771684">line</span><span class="op" id="7771688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7771691">}</span><br>
<span class="lineno"></span><span class="op" id="7771693">}</span>
</div>
</body>
</html>
