<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template/parse</h2>
<ul>
<li><a href="/gostd/text/template/parse/lex.go.html">lex.go</a></li>
<li><a href="/gostd/text/template/parse/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/text/template/parse/node.go.html" class="current">node.go</a></li>
<li><a href="/gostd/text/template/parse/parse.go.html">parse.go</a></li>
<li><a href="/gostd/text/template/parse/parse_test.go.html">parse_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3276047">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3276102">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3276156">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3276207">//&nbsp;Parse&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3276224">package</span>&nbsp;<span class="ident" id="3276232">parse</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3276239">import</span>&nbsp;<span class="op" id="3276246">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3276249">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3276258">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3276265">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3276276">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3276286">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3276289">var</span>&nbsp;<span class="ident" id="3276293">textFormat</span>&nbsp;<span class="op" id="3276304">=</span>&nbsp;<span class="string" id="3276306">&#34;%s&#34;</span>&nbsp;<span class="comment" id="3276311">//&nbsp;Changed&nbsp;to&nbsp;&#34;%q&#34;&nbsp;in&nbsp;tests&nbsp;for&nbsp;better&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3276367">//&nbsp;A&nbsp;Node&nbsp;is&nbsp;an&nbsp;element&nbsp;in&nbsp;the&nbsp;parse&nbsp;tree.&nbsp;The&nbsp;interface&nbsp;is&nbsp;trivial.</span><br>
<span class="lineno"></span><span class="comment" id="3276436">//&nbsp;The&nbsp;interface&nbsp;contains&nbsp;an&nbsp;unexported&nbsp;method&nbsp;so&nbsp;that&nbsp;only</span><br>
<span class="lineno">20</span><span class="comment" id="3276496">//&nbsp;types&nbsp;local&nbsp;to&nbsp;this&nbsp;package&nbsp;can&nbsp;satisfy&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3276543">type</span>&nbsp;<span class="ident" id="3276548">Node</span>&nbsp;<span class="keyword" id="3276553">interface</span>&nbsp;<span class="op" id="3276563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3276566">Type</span><span class="op" id="3276570">(</span><span class="op" id="3276571">)</span>&nbsp;<span class="ident" id="3276573">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3276583">String</span><span class="op" id="3276589">(</span><span class="op" id="3276590">)</span>&nbsp;<span class="builtintype" id="3276592">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3276600">//&nbsp;Copy&nbsp;does&nbsp;a&nbsp;deep&nbsp;copy&nbsp;of&nbsp;the&nbsp;Node&nbsp;and&nbsp;all&nbsp;its&nbsp;components.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3276662">//&nbsp;To&nbsp;avoid&nbsp;type&nbsp;assertions,&nbsp;some&nbsp;XxxNodes&nbsp;also&nbsp;have&nbsp;specialized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3276728">//&nbsp;CopyXxx&nbsp;methods&nbsp;that&nbsp;return&nbsp;*XxxNode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3276770">Copy</span><span class="op" id="3276774">(</span><span class="op" id="3276775">)</span>&nbsp;<span class="ident" id="3276777">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3276783">Position</span><span class="op" id="3276791">(</span><span class="op" id="3276792">)</span>&nbsp;<span class="ident" id="3276794">Pos</span>&nbsp;<span class="comment" id="3276798">//&nbsp;byte&nbsp;position&nbsp;of&nbsp;start&nbsp;of&nbsp;node&nbsp;in&nbsp;full&nbsp;original&nbsp;input&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3276863">//&nbsp;tree&nbsp;returns&nbsp;the&nbsp;containing&nbsp;*Tree.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3276902">//&nbsp;It&nbsp;is&nbsp;unexported&nbsp;so&nbsp;all&nbsp;implementations&nbsp;of&nbsp;Node&nbsp;are&nbsp;in&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3276975">tree</span><span class="op" id="3276979">(</span><span class="op" id="3276980">)</span>&nbsp;<span class="op" id="3276982">*</span><span class="ident" id="3276983">Tree</span><br>
<span class="lineno"></span><span class="op" id="3276988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3276991">//&nbsp;NodeType&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;parse&nbsp;tree&nbsp;node.</span><br>
<span class="lineno">35</span><span class="keyword" id="3277045">type</span>&nbsp;<span class="ident" id="3277050">NodeType</span>&nbsp;<span class="builtintype" id="3277059">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3277064">//&nbsp;Pos&nbsp;represents&nbsp;a&nbsp;byte&nbsp;position&nbsp;in&nbsp;the&nbsp;original&nbsp;input&nbsp;text&nbsp;from&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="3277136">//&nbsp;this&nbsp;template&nbsp;was&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="3277165">type</span>&nbsp;<span class="ident" id="3277170">Pos</span>&nbsp;<span class="builtintype" id="3277174">int</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3277179">func</span>&nbsp;<span class="op" id="3277184">(</span><span class="ident" id="3277185">p</span>&nbsp;<span class="ident" id="3277187">Pos</span><span class="op" id="3277190">)</span>&nbsp;<span class="ident" id="3277192">Position</span><span class="op" id="3277200">(</span><span class="op" id="3277201">)</span>&nbsp;<span class="ident" id="3277203">Pos</span>&nbsp;<span class="op" id="3277207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3277210">return</span>&nbsp;<span class="ident" id="3277217">p</span><br>
<span class="lineno"></span><span class="op" id="3277219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="3277222">//&nbsp;Type&nbsp;returns&nbsp;itself&nbsp;and&nbsp;provides&nbsp;an&nbsp;easy&nbsp;default&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="3277289">//&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;Node.&nbsp;Embedded&nbsp;in&nbsp;all&nbsp;non-trivial&nbsp;Nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="3277352">func</span>&nbsp;<span class="op" id="3277357">(</span><span class="ident" id="3277358">t</span>&nbsp;<span class="ident" id="3277360">NodeType</span><span class="op" id="3277368">)</span>&nbsp;<span class="ident" id="3277370">Type</span><span class="op" id="3277374">(</span><span class="op" id="3277375">)</span>&nbsp;<span class="ident" id="3277377">NodeType</span>&nbsp;<span class="op" id="3277386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3277389">return</span>&nbsp;<span class="ident" id="3277396">t</span><br>
<span class="lineno"></span><span class="op" id="3277398">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="3277401">const</span>&nbsp;<span class="op" id="3277407">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277410">NodeText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3277425">NodeType</span>&nbsp;<span class="op" id="3277434">=</span>&nbsp;<span class="ident" id="3277436">iota</span>&nbsp;<span class="comment" id="3277441">//&nbsp;Plain&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277457">NodeAction</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3277488">//&nbsp;A&nbsp;non-control&nbsp;action&nbsp;such&nbsp;as&nbsp;a&nbsp;field&nbsp;evaluation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277541">NodeBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3277572">//&nbsp;A&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277596">NodeChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3277627">//&nbsp;A&nbsp;sequence&nbsp;of&nbsp;field&nbsp;accesses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277661">NodeCommand</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3277692">//&nbsp;An&nbsp;element&nbsp;of&nbsp;a&nbsp;pipeline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277722">NodeDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3277753">//&nbsp;The&nbsp;cursor,&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277774">nodeElse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3277805">//&nbsp;An&nbsp;else&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277844">nodeEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3277875">//&nbsp;An&nbsp;end&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277913">NodeField</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3277944">//&nbsp;A&nbsp;field&nbsp;or&nbsp;method&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277972">NodeIdentifier</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3278003">//&nbsp;An&nbsp;identifier;&nbsp;always&nbsp;a&nbsp;function&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278046">NodeIf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3278077">//&nbsp;An&nbsp;if&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278095">NodeList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3278126">//&nbsp;A&nbsp;list&nbsp;of&nbsp;Nodes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278147">NodeNil</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3278178">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278207">NodeNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3278238">//&nbsp;A&nbsp;numerical&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278264">NodePipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3278295">//&nbsp;A&nbsp;pipeline&nbsp;of&nbsp;commands.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278323">NodeRange</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3278354">//&nbsp;A&nbsp;range&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278374">NodeString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3278405">//&nbsp;A&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278428">NodeTemplate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3278459">//&nbsp;A&nbsp;template&nbsp;invocation&nbsp;action.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278493">NodeVariable</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3278524">//&nbsp;A&nbsp;$&nbsp;variable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278542">NodeWith</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3278573">//&nbsp;A&nbsp;with&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="3278591">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3278594">//&nbsp;Nodes.</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="3278605">//&nbsp;ListNode&nbsp;holds&nbsp;a&nbsp;sequence&nbsp;of&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="3278644">type</span>&nbsp;<span class="ident" id="3278649">ListNode</span>&nbsp;<span class="keyword" id="3278658">struct</span>&nbsp;<span class="op" id="3278665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278668">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278678">Pos</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278683">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3278689">*</span><span class="ident" id="3278690">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278696">Nodes</span>&nbsp;<span class="op" id="3278702">[</span><span class="op" id="3278703">]</span><span class="ident" id="3278704">Node</span>&nbsp;<span class="comment" id="3278709">//&nbsp;The&nbsp;element&nbsp;nodes&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3278748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3278751">func</span>&nbsp;<span class="op" id="3278756">(</span><span class="ident" id="3278757">t</span>&nbsp;<span class="op" id="3278759">*</span><span class="ident" id="3278760">Tree</span><span class="op" id="3278764">)</span>&nbsp;<span class="ident" id="3278766">newList</span><span class="op" id="3278773">(</span><span class="ident" id="3278774">pos</span>&nbsp;<span class="ident" id="3278778">Pos</span><span class="op" id="3278781">)</span>&nbsp;<span class="op" id="3278783">*</span><span class="ident" id="3278784">ListNode</span>&nbsp;<span class="op" id="3278793">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3278796">return</span>&nbsp;<span class="op" id="3278803">&amp;</span><span class="ident" id="3278804">ListNode</span><span class="op" id="3278812">{</span><span class="ident" id="3278813">tr</span><span class="op" id="3278815">:</span>&nbsp;<span class="ident" id="3278817">t</span><span class="op" id="3278818">,</span>&nbsp;<span class="ident" id="3278820">NodeType</span><span class="op" id="3278828">:</span>&nbsp;<span class="ident" id="3278830">NodeList</span><span class="op" id="3278838">,</span>&nbsp;<span class="ident" id="3278840">Pos</span><span class="op" id="3278843">:</span>&nbsp;<span class="ident" id="3278845">pos</span><span class="op" id="3278848">}</span><br>
<span class="lineno"></span><span class="op" id="3278850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3278853">func</span>&nbsp;<span class="op" id="3278858">(</span><span class="ident" id="3278859">l</span>&nbsp;<span class="op" id="3278861">*</span><span class="ident" id="3278862">ListNode</span><span class="op" id="3278870">)</span>&nbsp;<span class="builtinfunc" id="3278872">append</span><span class="op" id="3278878">(</span><span class="ident" id="3278879">n</span>&nbsp;<span class="ident" id="3278881">Node</span><span class="op" id="3278885">)</span>&nbsp;<span class="op" id="3278887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278890">l</span><span class="op" id="3278891">.</span><span class="ident" id="3278892">Nodes</span>&nbsp;<span class="op" id="3278898">=</span>&nbsp;<span class="builtinfunc" id="3278900">append</span><span class="op" id="3278906">(</span><span class="ident" id="3278907">l</span><span class="op" id="3278908">.</span><span class="ident" id="3278909">Nodes</span><span class="op" id="3278914">,</span>&nbsp;<span class="ident" id="3278916">n</span><span class="op" id="3278917">)</span><br>
<span class="lineno">90</span><span class="op" id="3278919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3278922">func</span>&nbsp;<span class="op" id="3278927">(</span><span class="ident" id="3278928">l</span>&nbsp;<span class="op" id="3278930">*</span><span class="ident" id="3278931">ListNode</span><span class="op" id="3278939">)</span>&nbsp;<span class="ident" id="3278941">tree</span><span class="op" id="3278945">(</span><span class="op" id="3278946">)</span>&nbsp;<span class="op" id="3278948">*</span><span class="ident" id="3278949">Tree</span>&nbsp;<span class="op" id="3278954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3278957">return</span>&nbsp;<span class="ident" id="3278964">l</span><span class="op" id="3278965">.</span><span class="ident" id="3278966">tr</span><br>
<span class="lineno"></span><span class="op" id="3278969">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="3278972">func</span>&nbsp;<span class="op" id="3278977">(</span><span class="ident" id="3278978">l</span>&nbsp;<span class="op" id="3278980">*</span><span class="ident" id="3278981">ListNode</span><span class="op" id="3278989">)</span>&nbsp;<span class="ident" id="3278991">String</span><span class="op" id="3278997">(</span><span class="op" id="3278998">)</span>&nbsp;<span class="builtintype" id="3279000">string</span>&nbsp;<span class="op" id="3279007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279010">b</span>&nbsp;<span class="op" id="3279012">:=</span>&nbsp;<span class="builtinfunc" id="3279015">new</span><span class="op" id="3279018">(</span><span class="ident" id="3279019">bytes</span><span class="op" id="3279024">.</span><span class="ident" id="3279025">Buffer</span><span class="op" id="3279031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279034">for</span>&nbsp;<span class="ident" id="3279038">_</span><span class="op" id="3279039">,</span>&nbsp;<span class="ident" id="3279041">n</span>&nbsp;<span class="op" id="3279043">:=</span>&nbsp;<span class="keyword" id="3279046">range</span>&nbsp;<span class="ident" id="3279052">l</span><span class="op" id="3279053">.</span><span class="ident" id="3279054">Nodes</span>&nbsp;<span class="op" id="3279060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279064">fmt</span><span class="op" id="3279067">.</span><span class="ident" id="3279068">Fprint</span><span class="op" id="3279074">(</span><span class="ident" id="3279075">b</span><span class="op" id="3279076">,</span>&nbsp;<span class="ident" id="3279078">n</span><span class="op" id="3279079">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3279082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279085">return</span>&nbsp;<span class="ident" id="3279092">b</span><span class="op" id="3279093">.</span><span class="ident" id="3279094">String</span><span class="op" id="3279100">(</span><span class="op" id="3279101">)</span><br>
<span class="lineno"></span><span class="op" id="3279103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3279106">func</span>&nbsp;<span class="op" id="3279111">(</span><span class="ident" id="3279112">l</span>&nbsp;<span class="op" id="3279114">*</span><span class="ident" id="3279115">ListNode</span><span class="op" id="3279123">)</span>&nbsp;<span class="ident" id="3279125">CopyList</span><span class="op" id="3279133">(</span><span class="op" id="3279134">)</span>&nbsp;<span class="op" id="3279136">*</span><span class="ident" id="3279137">ListNode</span>&nbsp;<span class="op" id="3279146">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279149">if</span>&nbsp;<span class="ident" id="3279152">l</span>&nbsp;<span class="op" id="3279154">==</span>&nbsp;<span class="ident" id="3279157">nil</span>&nbsp;<span class="op" id="3279161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279165">return</span>&nbsp;<span class="ident" id="3279172">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3279175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279178">n</span>&nbsp;<span class="op" id="3279180">:=</span>&nbsp;<span class="ident" id="3279183">l</span><span class="op" id="3279184">.</span><span class="ident" id="3279185">tr</span><span class="op" id="3279187">.</span><span class="ident" id="3279188">newList</span><span class="op" id="3279195">(</span><span class="ident" id="3279196">l</span><span class="op" id="3279197">.</span><span class="ident" id="3279198">Pos</span><span class="op" id="3279201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279204">for</span>&nbsp;<span class="ident" id="3279208">_</span><span class="op" id="3279209">,</span>&nbsp;<span class="ident" id="3279211">elem</span>&nbsp;<span class="op" id="3279216">:=</span>&nbsp;<span class="keyword" id="3279219">range</span>&nbsp;<span class="ident" id="3279225">l</span><span class="op" id="3279226">.</span><span class="ident" id="3279227">Nodes</span>&nbsp;<span class="op" id="3279233">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279237">n</span><span class="op" id="3279238">.</span><span class="builtinfunc" id="3279239">append</span><span class="op" id="3279245">(</span><span class="ident" id="3279246">elem</span><span class="op" id="3279250">.</span><span class="ident" id="3279251">Copy</span><span class="op" id="3279255">(</span><span class="op" id="3279256">)</span><span class="op" id="3279257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3279260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279263">return</span>&nbsp;<span class="ident" id="3279270">n</span><br>
<span class="lineno"></span><span class="op" id="3279272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="3279275">func</span>&nbsp;<span class="op" id="3279280">(</span><span class="ident" id="3279281">l</span>&nbsp;<span class="op" id="3279283">*</span><span class="ident" id="3279284">ListNode</span><span class="op" id="3279292">)</span>&nbsp;<span class="ident" id="3279294">Copy</span><span class="op" id="3279298">(</span><span class="op" id="3279299">)</span>&nbsp;<span class="ident" id="3279301">Node</span>&nbsp;<span class="op" id="3279306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279309">return</span>&nbsp;<span class="ident" id="3279316">l</span><span class="op" id="3279317">.</span><span class="ident" id="3279318">CopyList</span><span class="op" id="3279326">(</span><span class="op" id="3279327">)</span><br>
<span class="lineno"></span><span class="op" id="3279329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3279332">//&nbsp;TextNode&nbsp;holds&nbsp;plain&nbsp;text.</span><br>
<span class="lineno">120</span><span class="keyword" id="3279362">type</span>&nbsp;<span class="ident" id="3279367">TextNode</span>&nbsp;<span class="keyword" id="3279376">struct</span>&nbsp;<span class="op" id="3279383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279386">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279396">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279401">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3279406">*</span><span class="ident" id="3279407">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279413">Text</span>&nbsp;<span class="op" id="3279418">[</span><span class="op" id="3279419">]</span><span class="builtintype" id="3279420">byte</span>&nbsp;<span class="comment" id="3279425">//&nbsp;The&nbsp;text;&nbsp;may&nbsp;span&nbsp;newlines.</span><br>
<span class="lineno">125</span><span class="op" id="3279457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3279460">func</span>&nbsp;<span class="op" id="3279465">(</span><span class="ident" id="3279466">t</span>&nbsp;<span class="op" id="3279468">*</span><span class="ident" id="3279469">Tree</span><span class="op" id="3279473">)</span>&nbsp;<span class="ident" id="3279475">newText</span><span class="op" id="3279482">(</span><span class="ident" id="3279483">pos</span>&nbsp;<span class="ident" id="3279487">Pos</span><span class="op" id="3279490">,</span>&nbsp;<span class="ident" id="3279492">text</span>&nbsp;<span class="builtintype" id="3279497">string</span><span class="op" id="3279503">)</span>&nbsp;<span class="op" id="3279505">*</span><span class="ident" id="3279506">TextNode</span>&nbsp;<span class="op" id="3279515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279518">return</span>&nbsp;<span class="op" id="3279525">&amp;</span><span class="ident" id="3279526">TextNode</span><span class="op" id="3279534">{</span><span class="ident" id="3279535">tr</span><span class="op" id="3279537">:</span>&nbsp;<span class="ident" id="3279539">t</span><span class="op" id="3279540">,</span>&nbsp;<span class="ident" id="3279542">NodeType</span><span class="op" id="3279550">:</span>&nbsp;<span class="ident" id="3279552">NodeText</span><span class="op" id="3279560">,</span>&nbsp;<span class="ident" id="3279562">Pos</span><span class="op" id="3279565">:</span>&nbsp;<span class="ident" id="3279567">pos</span><span class="op" id="3279570">,</span>&nbsp;<span class="ident" id="3279572">Text</span><span class="op" id="3279576">:</span>&nbsp;<span class="op" id="3279578">[</span><span class="op" id="3279579">]</span><span class="builtintype" id="3279580">byte</span><span class="op" id="3279584">(</span><span class="ident" id="3279585">text</span><span class="op" id="3279589">)</span><span class="op" id="3279590">}</span><br>
<span class="lineno"></span><span class="op" id="3279592">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="3279595">func</span>&nbsp;<span class="op" id="3279600">(</span><span class="ident" id="3279601">t</span>&nbsp;<span class="op" id="3279603">*</span><span class="ident" id="3279604">TextNode</span><span class="op" id="3279612">)</span>&nbsp;<span class="ident" id="3279614">String</span><span class="op" id="3279620">(</span><span class="op" id="3279621">)</span>&nbsp;<span class="builtintype" id="3279623">string</span>&nbsp;<span class="op" id="3279630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279633">return</span>&nbsp;<span class="ident" id="3279640">fmt</span><span class="op" id="3279643">.</span><span class="ident" id="3279644">Sprintf</span><span class="op" id="3279651">(</span><span class="ident" id="3279652">textFormat</span><span class="op" id="3279662">,</span>&nbsp;<span class="ident" id="3279664">t</span><span class="op" id="3279665">.</span><span class="ident" id="3279666">Text</span><span class="op" id="3279670">)</span><br>
<span class="lineno"></span><span class="op" id="3279672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3279675">func</span>&nbsp;<span class="op" id="3279680">(</span><span class="ident" id="3279681">t</span>&nbsp;<span class="op" id="3279683">*</span><span class="ident" id="3279684">TextNode</span><span class="op" id="3279692">)</span>&nbsp;<span class="ident" id="3279694">tree</span><span class="op" id="3279698">(</span><span class="op" id="3279699">)</span>&nbsp;<span class="op" id="3279701">*</span><span class="ident" id="3279702">Tree</span>&nbsp;<span class="op" id="3279707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279710">return</span>&nbsp;<span class="ident" id="3279717">t</span><span class="op" id="3279718">.</span><span class="ident" id="3279719">tr</span><br>
<span class="lineno"></span><span class="op" id="3279722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3279725">func</span>&nbsp;<span class="op" id="3279730">(</span><span class="ident" id="3279731">t</span>&nbsp;<span class="op" id="3279733">*</span><span class="ident" id="3279734">TextNode</span><span class="op" id="3279742">)</span>&nbsp;<span class="ident" id="3279744">Copy</span><span class="op" id="3279748">(</span><span class="op" id="3279749">)</span>&nbsp;<span class="ident" id="3279751">Node</span>&nbsp;<span class="op" id="3279756">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279759">return</span>&nbsp;<span class="op" id="3279766">&amp;</span><span class="ident" id="3279767">TextNode</span><span class="op" id="3279775">{</span><span class="ident" id="3279776">tr</span><span class="op" id="3279778">:</span>&nbsp;<span class="ident" id="3279780">t</span><span class="op" id="3279781">.</span><span class="ident" id="3279782">tr</span><span class="op" id="3279784">,</span>&nbsp;<span class="ident" id="3279786">NodeType</span><span class="op" id="3279794">:</span>&nbsp;<span class="ident" id="3279796">NodeText</span><span class="op" id="3279804">,</span>&nbsp;<span class="ident" id="3279806">Pos</span><span class="op" id="3279809">:</span>&nbsp;<span class="ident" id="3279811">t</span><span class="op" id="3279812">.</span><span class="ident" id="3279813">Pos</span><span class="op" id="3279816">,</span>&nbsp;<span class="ident" id="3279818">Text</span><span class="op" id="3279822">:</span>&nbsp;<span class="builtinfunc" id="3279824">append</span><span class="op" id="3279830">(</span><span class="op" id="3279831">[</span><span class="op" id="3279832">]</span><span class="builtintype" id="3279833">byte</span><span class="op" id="3279837">{</span><span class="op" id="3279838">}</span><span class="op" id="3279839">,</span>&nbsp;<span class="ident" id="3279841">t</span><span class="op" id="3279842">.</span><span class="ident" id="3279843">Text</span><span class="op" id="3279847">...</span><span class="op" id="3279850">)</span><span class="op" id="3279851">}</span><br>
<span class="lineno"></span><span class="op" id="3279853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3279856">//&nbsp;PipeNode&nbsp;holds&nbsp;a&nbsp;pipeline&nbsp;with&nbsp;optional&nbsp;declaration</span><br>
<span class="lineno"></span><span class="keyword" id="3279911">type</span>&nbsp;<span class="ident" id="3279916">PipeNode</span>&nbsp;<span class="keyword" id="3279925">struct</span>&nbsp;<span class="op" id="3279932">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279935">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279945">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279950">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3279955">*</span><span class="ident" id="3279956">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279962">Line</span>&nbsp;<span class="builtintype" id="3279967">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3279983">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280053">Decl</span>&nbsp;<span class="op" id="3280058">[</span><span class="op" id="3280059">]</span><span class="op" id="3280060">*</span><span class="ident" id="3280061">VariableNode</span>&nbsp;<span class="comment" id="3280074">//&nbsp;Variable&nbsp;declarations&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280118">Cmds</span>&nbsp;<span class="op" id="3280123">[</span><span class="op" id="3280124">]</span><span class="op" id="3280125">*</span><span class="ident" id="3280126">CommandNode</span>&nbsp;&nbsp;<span class="comment" id="3280139">//&nbsp;The&nbsp;commands&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3280173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3280176">func</span>&nbsp;<span class="op" id="3280181">(</span><span class="ident" id="3280182">t</span>&nbsp;<span class="op" id="3280184">*</span><span class="ident" id="3280185">Tree</span><span class="op" id="3280189">)</span>&nbsp;<span class="ident" id="3280191">newPipeline</span><span class="op" id="3280202">(</span><span class="ident" id="3280203">pos</span>&nbsp;<span class="ident" id="3280207">Pos</span><span class="op" id="3280210">,</span>&nbsp;<span class="ident" id="3280212">line</span>&nbsp;<span class="builtintype" id="3280217">int</span><span class="op" id="3280220">,</span>&nbsp;<span class="ident" id="3280222">decl</span>&nbsp;<span class="op" id="3280227">[</span><span class="op" id="3280228">]</span><span class="op" id="3280229">*</span><span class="ident" id="3280230">VariableNode</span><span class="op" id="3280242">)</span>&nbsp;<span class="op" id="3280244">*</span><span class="ident" id="3280245">PipeNode</span>&nbsp;<span class="op" id="3280254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280257">return</span>&nbsp;<span class="op" id="3280264">&amp;</span><span class="ident" id="3280265">PipeNode</span><span class="op" id="3280273">{</span><span class="ident" id="3280274">tr</span><span class="op" id="3280276">:</span>&nbsp;<span class="ident" id="3280278">t</span><span class="op" id="3280279">,</span>&nbsp;<span class="ident" id="3280281">NodeType</span><span class="op" id="3280289">:</span>&nbsp;<span class="ident" id="3280291">NodePipe</span><span class="op" id="3280299">,</span>&nbsp;<span class="ident" id="3280301">Pos</span><span class="op" id="3280304">:</span>&nbsp;<span class="ident" id="3280306">pos</span><span class="op" id="3280309">,</span>&nbsp;<span class="ident" id="3280311">Line</span><span class="op" id="3280315">:</span>&nbsp;<span class="ident" id="3280317">line</span><span class="op" id="3280321">,</span>&nbsp;<span class="ident" id="3280323">Decl</span><span class="op" id="3280327">:</span>&nbsp;<span class="ident" id="3280329">decl</span><span class="op" id="3280333">}</span><br>
<span class="lineno">155</span><span class="op" id="3280335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3280338">func</span>&nbsp;<span class="op" id="3280343">(</span><span class="ident" id="3280344">p</span>&nbsp;<span class="op" id="3280346">*</span><span class="ident" id="3280347">PipeNode</span><span class="op" id="3280355">)</span>&nbsp;<span class="builtinfunc" id="3280357">append</span><span class="op" id="3280363">(</span><span class="ident" id="3280364">command</span>&nbsp;<span class="op" id="3280372">*</span><span class="ident" id="3280373">CommandNode</span><span class="op" id="3280384">)</span>&nbsp;<span class="op" id="3280386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280389">p</span><span class="op" id="3280390">.</span><span class="ident" id="3280391">Cmds</span>&nbsp;<span class="op" id="3280396">=</span>&nbsp;<span class="builtinfunc" id="3280398">append</span><span class="op" id="3280404">(</span><span class="ident" id="3280405">p</span><span class="op" id="3280406">.</span><span class="ident" id="3280407">Cmds</span><span class="op" id="3280411">,</span>&nbsp;<span class="ident" id="3280413">command</span><span class="op" id="3280420">)</span><br>
<span class="lineno"></span><span class="op" id="3280422">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="3280425">func</span>&nbsp;<span class="op" id="3280430">(</span><span class="ident" id="3280431">p</span>&nbsp;<span class="op" id="3280433">*</span><span class="ident" id="3280434">PipeNode</span><span class="op" id="3280442">)</span>&nbsp;<span class="ident" id="3280444">String</span><span class="op" id="3280450">(</span><span class="op" id="3280451">)</span>&nbsp;<span class="builtintype" id="3280453">string</span>&nbsp;<span class="op" id="3280460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280463">s</span>&nbsp;<span class="op" id="3280465">:=</span>&nbsp;<span class="string" id="3280468">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280472">if</span>&nbsp;<span class="builtinfunc" id="3280475">len</span><span class="op" id="3280478">(</span><span class="ident" id="3280479">p</span><span class="op" id="3280480">.</span><span class="ident" id="3280481">Decl</span><span class="op" id="3280485">)</span>&nbsp;<span class="op" id="3280487">&gt;</span>&nbsp;<span class="num" id="3280489">0</span>&nbsp;<span class="op" id="3280491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280495">for</span>&nbsp;<span class="ident" id="3280499">i</span><span class="op" id="3280500">,</span>&nbsp;<span class="ident" id="3280502">v</span>&nbsp;<span class="op" id="3280504">:=</span>&nbsp;<span class="keyword" id="3280507">range</span>&nbsp;<span class="ident" id="3280513">p</span><span class="op" id="3280514">.</span><span class="ident" id="3280515">Decl</span>&nbsp;<span class="op" id="3280520">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280525">if</span>&nbsp;<span class="ident" id="3280528">i</span>&nbsp;<span class="op" id="3280530">&gt;</span>&nbsp;<span class="num" id="3280532">0</span>&nbsp;<span class="op" id="3280534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280540">s</span>&nbsp;<span class="op" id="3280542">+=</span>&nbsp;<span class="string" id="3280545">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3280553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280558">s</span>&nbsp;<span class="op" id="3280560">+=</span>&nbsp;<span class="ident" id="3280563">v</span><span class="op" id="3280564">.</span><span class="ident" id="3280565">String</span><span class="op" id="3280571">(</span><span class="op" id="3280572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3280576">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280580">s</span>&nbsp;<span class="op" id="3280582">+=</span>&nbsp;<span class="string" id="3280585">&#34;&nbsp;:=&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3280593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280596">for</span>&nbsp;<span class="ident" id="3280600">i</span><span class="op" id="3280601">,</span>&nbsp;<span class="ident" id="3280603">c</span>&nbsp;<span class="op" id="3280605">:=</span>&nbsp;<span class="keyword" id="3280608">range</span>&nbsp;<span class="ident" id="3280614">p</span><span class="op" id="3280615">.</span><span class="ident" id="3280616">Cmds</span>&nbsp;<span class="op" id="3280621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280625">if</span>&nbsp;<span class="ident" id="3280628">i</span>&nbsp;<span class="op" id="3280630">&gt;</span>&nbsp;<span class="num" id="3280632">0</span>&nbsp;<span class="op" id="3280634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280639">s</span>&nbsp;<span class="op" id="3280641">+=</span>&nbsp;<span class="string" id="3280644">&#34;&nbsp;|&nbsp;&#34;</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3280652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280656">s</span>&nbsp;<span class="op" id="3280658">+=</span>&nbsp;<span class="ident" id="3280661">c</span><span class="op" id="3280662">.</span><span class="ident" id="3280663">String</span><span class="op" id="3280669">(</span><span class="op" id="3280670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3280673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280676">return</span>&nbsp;<span class="ident" id="3280683">s</span><br>
<span class="lineno"></span><span class="op" id="3280685">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="3280688">func</span>&nbsp;<span class="op" id="3280693">(</span><span class="ident" id="3280694">p</span>&nbsp;<span class="op" id="3280696">*</span><span class="ident" id="3280697">PipeNode</span><span class="op" id="3280705">)</span>&nbsp;<span class="ident" id="3280707">tree</span><span class="op" id="3280711">(</span><span class="op" id="3280712">)</span>&nbsp;<span class="op" id="3280714">*</span><span class="ident" id="3280715">Tree</span>&nbsp;<span class="op" id="3280720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280723">return</span>&nbsp;<span class="ident" id="3280730">p</span><span class="op" id="3280731">.</span><span class="ident" id="3280732">tr</span><br>
<span class="lineno"></span><span class="op" id="3280735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3280738">func</span>&nbsp;<span class="op" id="3280743">(</span><span class="ident" id="3280744">p</span>&nbsp;<span class="op" id="3280746">*</span><span class="ident" id="3280747">PipeNode</span><span class="op" id="3280755">)</span>&nbsp;<span class="ident" id="3280757">CopyPipe</span><span class="op" id="3280765">(</span><span class="op" id="3280766">)</span>&nbsp;<span class="op" id="3280768">*</span><span class="ident" id="3280769">PipeNode</span>&nbsp;<span class="op" id="3280778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280781">if</span>&nbsp;<span class="ident" id="3280784">p</span>&nbsp;<span class="op" id="3280786">==</span>&nbsp;<span class="ident" id="3280789">nil</span>&nbsp;<span class="op" id="3280793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280797">return</span>&nbsp;<span class="ident" id="3280804">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3280807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280810">var</span>&nbsp;<span class="ident" id="3280814">decl</span>&nbsp;<span class="op" id="3280819">[</span><span class="op" id="3280820">]</span><span class="op" id="3280821">*</span><span class="ident" id="3280822">VariableNode</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280836">for</span>&nbsp;<span class="ident" id="3280840">_</span><span class="op" id="3280841">,</span>&nbsp;<span class="ident" id="3280843">d</span>&nbsp;<span class="op" id="3280845">:=</span>&nbsp;<span class="keyword" id="3280848">range</span>&nbsp;<span class="ident" id="3280854">p</span><span class="op" id="3280855">.</span><span class="ident" id="3280856">Decl</span>&nbsp;<span class="op" id="3280861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280865">decl</span>&nbsp;<span class="op" id="3280870">=</span>&nbsp;<span class="builtinfunc" id="3280872">append</span><span class="op" id="3280878">(</span><span class="ident" id="3280879">decl</span><span class="op" id="3280883">,</span>&nbsp;<span class="ident" id="3280885">d</span><span class="op" id="3280886">.</span><span class="ident" id="3280887">Copy</span><span class="op" id="3280891">(</span><span class="op" id="3280892">)</span><span class="op" id="3280893">.</span><span class="op" id="3280894">(</span><span class="op" id="3280895">*</span><span class="ident" id="3280896">VariableNode</span><span class="op" id="3280908">)</span><span class="op" id="3280909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3280912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280915">n</span>&nbsp;<span class="op" id="3280917">:=</span>&nbsp;<span class="ident" id="3280920">p</span><span class="op" id="3280921">.</span><span class="ident" id="3280922">tr</span><span class="op" id="3280924">.</span><span class="ident" id="3280925">newPipeline</span><span class="op" id="3280936">(</span><span class="ident" id="3280937">p</span><span class="op" id="3280938">.</span><span class="ident" id="3280939">Pos</span><span class="op" id="3280942">,</span>&nbsp;<span class="ident" id="3280944">p</span><span class="op" id="3280945">.</span><span class="ident" id="3280946">Line</span><span class="op" id="3280950">,</span>&nbsp;<span class="ident" id="3280952">decl</span><span class="op" id="3280956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280959">for</span>&nbsp;<span class="ident" id="3280963">_</span><span class="op" id="3280964">,</span>&nbsp;<span class="ident" id="3280966">c</span>&nbsp;<span class="op" id="3280968">:=</span>&nbsp;<span class="keyword" id="3280971">range</span>&nbsp;<span class="ident" id="3280977">p</span><span class="op" id="3280978">.</span><span class="ident" id="3280979">Cmds</span>&nbsp;<span class="op" id="3280984">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280988">n</span><span class="op" id="3280989">.</span><span class="builtinfunc" id="3280990">append</span><span class="op" id="3280996">(</span><span class="ident" id="3280997">c</span><span class="op" id="3280998">.</span><span class="ident" id="3280999">Copy</span><span class="op" id="3281003">(</span><span class="op" id="3281004">)</span><span class="op" id="3281005">.</span><span class="op" id="3281006">(</span><span class="op" id="3281007">*</span><span class="ident" id="3281008">CommandNode</span><span class="op" id="3281019">)</span><span class="op" id="3281020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3281023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281026">return</span>&nbsp;<span class="ident" id="3281033">n</span><br>
<span class="lineno"></span><span class="op" id="3281035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="3281038">func</span>&nbsp;<span class="op" id="3281043">(</span><span class="ident" id="3281044">p</span>&nbsp;<span class="op" id="3281046">*</span><span class="ident" id="3281047">PipeNode</span><span class="op" id="3281055">)</span>&nbsp;<span class="ident" id="3281057">Copy</span><span class="op" id="3281061">(</span><span class="op" id="3281062">)</span>&nbsp;<span class="ident" id="3281064">Node</span>&nbsp;<span class="op" id="3281069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281072">return</span>&nbsp;<span class="ident" id="3281079">p</span><span class="op" id="3281080">.</span><span class="ident" id="3281081">CopyPipe</span><span class="op" id="3281089">(</span><span class="op" id="3281090">)</span><br>
<span class="lineno"></span><span class="op" id="3281092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3281095">//&nbsp;ActionNode&nbsp;holds&nbsp;an&nbsp;action&nbsp;(something&nbsp;bounded&nbsp;by&nbsp;delimiters).</span><br>
<span class="lineno">205</span><span class="comment" id="3281160">//&nbsp;Control&nbsp;actions&nbsp;have&nbsp;their&nbsp;own&nbsp;nodes;&nbsp;ActionNode&nbsp;represents&nbsp;simple</span><br>
<span class="lineno"></span><span class="comment" id="3281230">//&nbsp;ones&nbsp;such&nbsp;as&nbsp;field&nbsp;evaluations&nbsp;and&nbsp;parenthesized&nbsp;pipelines.</span><br>
<span class="lineno"></span><span class="keyword" id="3281293">type</span>&nbsp;<span class="ident" id="3281298">ActionNode</span>&nbsp;<span class="keyword" id="3281309">struct</span>&nbsp;<span class="op" id="3281316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281319">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281329">Pos</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281334">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3281339">*</span><span class="ident" id="3281340">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281346">Line</span>&nbsp;<span class="builtintype" id="3281351">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3281361">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281431">Pipe</span>&nbsp;<span class="op" id="3281436">*</span><span class="ident" id="3281437">PipeNode</span>&nbsp;<span class="comment" id="3281446">//&nbsp;The&nbsp;pipeline&nbsp;in&nbsp;the&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="3281477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="3281480">func</span>&nbsp;<span class="op" id="3281485">(</span><span class="ident" id="3281486">t</span>&nbsp;<span class="op" id="3281488">*</span><span class="ident" id="3281489">Tree</span><span class="op" id="3281493">)</span>&nbsp;<span class="ident" id="3281495">newAction</span><span class="op" id="3281504">(</span><span class="ident" id="3281505">pos</span>&nbsp;<span class="ident" id="3281509">Pos</span><span class="op" id="3281512">,</span>&nbsp;<span class="ident" id="3281514">line</span>&nbsp;<span class="builtintype" id="3281519">int</span><span class="op" id="3281522">,</span>&nbsp;<span class="ident" id="3281524">pipe</span>&nbsp;<span class="op" id="3281529">*</span><span class="ident" id="3281530">PipeNode</span><span class="op" id="3281538">)</span>&nbsp;<span class="op" id="3281540">*</span><span class="ident" id="3281541">ActionNode</span>&nbsp;<span class="op" id="3281552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281555">return</span>&nbsp;<span class="op" id="3281562">&amp;</span><span class="ident" id="3281563">ActionNode</span><span class="op" id="3281573">{</span><span class="ident" id="3281574">tr</span><span class="op" id="3281576">:</span>&nbsp;<span class="ident" id="3281578">t</span><span class="op" id="3281579">,</span>&nbsp;<span class="ident" id="3281581">NodeType</span><span class="op" id="3281589">:</span>&nbsp;<span class="ident" id="3281591">NodeAction</span><span class="op" id="3281601">,</span>&nbsp;<span class="ident" id="3281603">Pos</span><span class="op" id="3281606">:</span>&nbsp;<span class="ident" id="3281608">pos</span><span class="op" id="3281611">,</span>&nbsp;<span class="ident" id="3281613">Line</span><span class="op" id="3281617">:</span>&nbsp;<span class="ident" id="3281619">line</span><span class="op" id="3281623">,</span>&nbsp;<span class="ident" id="3281625">Pipe</span><span class="op" id="3281629">:</span>&nbsp;<span class="ident" id="3281631">pipe</span><span class="op" id="3281635">}</span><br>
<span class="lineno"></span><span class="op" id="3281637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3281640">func</span>&nbsp;<span class="op" id="3281645">(</span><span class="ident" id="3281646">a</span>&nbsp;<span class="op" id="3281648">*</span><span class="ident" id="3281649">ActionNode</span><span class="op" id="3281659">)</span>&nbsp;<span class="ident" id="3281661">String</span><span class="op" id="3281667">(</span><span class="op" id="3281668">)</span>&nbsp;<span class="builtintype" id="3281670">string</span>&nbsp;<span class="op" id="3281677">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281680">return</span>&nbsp;<span class="ident" id="3281687">fmt</span><span class="op" id="3281690">.</span><span class="ident" id="3281691">Sprintf</span><span class="op" id="3281698">(</span><span class="string" id="3281699">&#34;{{%s}}&#34;</span><span class="op" id="3281707">,</span>&nbsp;<span class="ident" id="3281709">a</span><span class="op" id="3281710">.</span><span class="ident" id="3281711">Pipe</span><span class="op" id="3281715">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="3281718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3281721">func</span>&nbsp;<span class="op" id="3281726">(</span><span class="ident" id="3281727">a</span>&nbsp;<span class="op" id="3281729">*</span><span class="ident" id="3281730">ActionNode</span><span class="op" id="3281740">)</span>&nbsp;<span class="ident" id="3281742">tree</span><span class="op" id="3281746">(</span><span class="op" id="3281747">)</span>&nbsp;<span class="op" id="3281749">*</span><span class="ident" id="3281750">Tree</span>&nbsp;<span class="op" id="3281755">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281758">return</span>&nbsp;<span class="ident" id="3281765">a</span><span class="op" id="3281766">.</span><span class="ident" id="3281767">tr</span><br>
<span class="lineno"></span><span class="op" id="3281770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3281773">func</span>&nbsp;<span class="op" id="3281778">(</span><span class="ident" id="3281779">a</span>&nbsp;<span class="op" id="3281781">*</span><span class="ident" id="3281782">ActionNode</span><span class="op" id="3281792">)</span>&nbsp;<span class="ident" id="3281794">Copy</span><span class="op" id="3281798">(</span><span class="op" id="3281799">)</span>&nbsp;<span class="ident" id="3281801">Node</span>&nbsp;<span class="op" id="3281806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281809">return</span>&nbsp;<span class="ident" id="3281816">a</span><span class="op" id="3281817">.</span><span class="ident" id="3281818">tr</span><span class="op" id="3281820">.</span><span class="ident" id="3281821">newAction</span><span class="op" id="3281830">(</span><span class="ident" id="3281831">a</span><span class="op" id="3281832">.</span><span class="ident" id="3281833">Pos</span><span class="op" id="3281836">,</span>&nbsp;<span class="ident" id="3281838">a</span><span class="op" id="3281839">.</span><span class="ident" id="3281840">Line</span><span class="op" id="3281844">,</span>&nbsp;<span class="ident" id="3281846">a</span><span class="op" id="3281847">.</span><span class="ident" id="3281848">Pipe</span><span class="op" id="3281852">.</span><span class="ident" id="3281853">CopyPipe</span><span class="op" id="3281861">(</span><span class="op" id="3281862">)</span><span class="op" id="3281863">)</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="op" id="3281866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3281869">//&nbsp;CommandNode&nbsp;holds&nbsp;a&nbsp;command&nbsp;(a&nbsp;pipeline&nbsp;inside&nbsp;an&nbsp;evaluating&nbsp;action).</span><br>
<span class="lineno"></span><span class="keyword" id="3281942">type</span>&nbsp;<span class="ident" id="3281947">CommandNode</span>&nbsp;<span class="keyword" id="3281959">struct</span>&nbsp;<span class="op" id="3281966">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281969">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281979">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281984">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3281989">*</span><span class="ident" id="3281990">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281996">Args</span>&nbsp;<span class="op" id="3282001">[</span><span class="op" id="3282002">]</span><span class="ident" id="3282003">Node</span>&nbsp;<span class="comment" id="3282008">//&nbsp;Arguments&nbsp;in&nbsp;lexical&nbsp;order:&nbsp;Identifier,&nbsp;field,&nbsp;or&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="3282071">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="3282074">func</span>&nbsp;<span class="op" id="3282079">(</span><span class="ident" id="3282080">t</span>&nbsp;<span class="op" id="3282082">*</span><span class="ident" id="3282083">Tree</span><span class="op" id="3282087">)</span>&nbsp;<span class="ident" id="3282089">newCommand</span><span class="op" id="3282099">(</span><span class="ident" id="3282100">pos</span>&nbsp;<span class="ident" id="3282104">Pos</span><span class="op" id="3282107">)</span>&nbsp;<span class="op" id="3282109">*</span><span class="ident" id="3282110">CommandNode</span>&nbsp;<span class="op" id="3282122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282125">return</span>&nbsp;<span class="op" id="3282132">&amp;</span><span class="ident" id="3282133">CommandNode</span><span class="op" id="3282144">{</span><span class="ident" id="3282145">tr</span><span class="op" id="3282147">:</span>&nbsp;<span class="ident" id="3282149">t</span><span class="op" id="3282150">,</span>&nbsp;<span class="ident" id="3282152">NodeType</span><span class="op" id="3282160">:</span>&nbsp;<span class="ident" id="3282162">NodeCommand</span><span class="op" id="3282173">,</span>&nbsp;<span class="ident" id="3282175">Pos</span><span class="op" id="3282178">:</span>&nbsp;<span class="ident" id="3282180">pos</span><span class="op" id="3282183">}</span><br>
<span class="lineno"></span><span class="op" id="3282185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="keyword" id="3282188">func</span>&nbsp;<span class="op" id="3282193">(</span><span class="ident" id="3282194">c</span>&nbsp;<span class="op" id="3282196">*</span><span class="ident" id="3282197">CommandNode</span><span class="op" id="3282208">)</span>&nbsp;<span class="builtinfunc" id="3282210">append</span><span class="op" id="3282216">(</span><span class="ident" id="3282217">arg</span>&nbsp;<span class="ident" id="3282221">Node</span><span class="op" id="3282225">)</span>&nbsp;<span class="op" id="3282227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282230">c</span><span class="op" id="3282231">.</span><span class="ident" id="3282232">Args</span>&nbsp;<span class="op" id="3282237">=</span>&nbsp;<span class="builtinfunc" id="3282239">append</span><span class="op" id="3282245">(</span><span class="ident" id="3282246">c</span><span class="op" id="3282247">.</span><span class="ident" id="3282248">Args</span><span class="op" id="3282252">,</span>&nbsp;<span class="ident" id="3282254">arg</span><span class="op" id="3282257">)</span><br>
<span class="lineno"></span><span class="op" id="3282259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3282262">func</span>&nbsp;<span class="op" id="3282267">(</span><span class="ident" id="3282268">c</span>&nbsp;<span class="op" id="3282270">*</span><span class="ident" id="3282271">CommandNode</span><span class="op" id="3282282">)</span>&nbsp;<span class="ident" id="3282284">String</span><span class="op" id="3282290">(</span><span class="op" id="3282291">)</span>&nbsp;<span class="builtintype" id="3282293">string</span>&nbsp;<span class="op" id="3282300">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282303">s</span>&nbsp;<span class="op" id="3282305">:=</span>&nbsp;<span class="string" id="3282308">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282312">for</span>&nbsp;<span class="ident" id="3282316">i</span><span class="op" id="3282317">,</span>&nbsp;<span class="ident" id="3282319">arg</span>&nbsp;<span class="op" id="3282323">:=</span>&nbsp;<span class="keyword" id="3282326">range</span>&nbsp;<span class="ident" id="3282332">c</span><span class="op" id="3282333">.</span><span class="ident" id="3282334">Args</span>&nbsp;<span class="op" id="3282339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282343">if</span>&nbsp;<span class="ident" id="3282346">i</span>&nbsp;<span class="op" id="3282348">&gt;</span>&nbsp;<span class="num" id="3282350">0</span>&nbsp;<span class="op" id="3282352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282357">s</span>&nbsp;<span class="op" id="3282359">+=</span>&nbsp;<span class="string" id="3282362">&#34;&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3282368">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282372">if</span>&nbsp;<span class="ident" id="3282375">arg</span><span class="op" id="3282378">,</span>&nbsp;<span class="ident" id="3282380">ok</span>&nbsp;<span class="op" id="3282383">:=</span>&nbsp;<span class="ident" id="3282386">arg</span><span class="op" id="3282389">.</span><span class="op" id="3282390">(</span><span class="op" id="3282391">*</span><span class="ident" id="3282392">PipeNode</span><span class="op" id="3282400">)</span><span class="op" id="3282401">;</span>&nbsp;<span class="ident" id="3282403">ok</span>&nbsp;<span class="op" id="3282406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282411">s</span>&nbsp;<span class="op" id="3282413">+=</span>&nbsp;<span class="string" id="3282416">&#34;(&#34;</span>&nbsp;<span class="op" id="3282420">+</span>&nbsp;<span class="ident" id="3282422">arg</span><span class="op" id="3282425">.</span><span class="ident" id="3282426">String</span><span class="op" id="3282432">(</span><span class="op" id="3282433">)</span>&nbsp;<span class="op" id="3282435">+</span>&nbsp;<span class="string" id="3282437">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282444">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3282455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282459">s</span>&nbsp;<span class="op" id="3282461">+=</span>&nbsp;<span class="ident" id="3282464">arg</span><span class="op" id="3282467">.</span><span class="ident" id="3282468">String</span><span class="op" id="3282474">(</span><span class="op" id="3282475">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3282478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282481">return</span>&nbsp;<span class="ident" id="3282488">s</span><br>
<span class="lineno"></span><span class="op" id="3282490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3282493">func</span>&nbsp;<span class="op" id="3282498">(</span><span class="ident" id="3282499">c</span>&nbsp;<span class="op" id="3282501">*</span><span class="ident" id="3282502">CommandNode</span><span class="op" id="3282513">)</span>&nbsp;<span class="ident" id="3282515">tree</span><span class="op" id="3282519">(</span><span class="op" id="3282520">)</span>&nbsp;<span class="op" id="3282522">*</span><span class="ident" id="3282523">Tree</span>&nbsp;<span class="op" id="3282528">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282531">return</span>&nbsp;<span class="ident" id="3282538">c</span><span class="op" id="3282539">.</span><span class="ident" id="3282540">tr</span><br>
<span class="lineno"></span><span class="op" id="3282543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3282546">func</span>&nbsp;<span class="op" id="3282551">(</span><span class="ident" id="3282552">c</span>&nbsp;<span class="op" id="3282554">*</span><span class="ident" id="3282555">CommandNode</span><span class="op" id="3282566">)</span>&nbsp;<span class="ident" id="3282568">Copy</span><span class="op" id="3282572">(</span><span class="op" id="3282573">)</span>&nbsp;<span class="ident" id="3282575">Node</span>&nbsp;<span class="op" id="3282580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282583">if</span>&nbsp;<span class="ident" id="3282586">c</span>&nbsp;<span class="op" id="3282588">==</span>&nbsp;<span class="ident" id="3282591">nil</span>&nbsp;<span class="op" id="3282595">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282599">return</span>&nbsp;<span class="ident" id="3282606">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3282609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282612">n</span>&nbsp;<span class="op" id="3282614">:=</span>&nbsp;<span class="ident" id="3282617">c</span><span class="op" id="3282618">.</span><span class="ident" id="3282619">tr</span><span class="op" id="3282621">.</span><span class="ident" id="3282622">newCommand</span><span class="op" id="3282632">(</span><span class="ident" id="3282633">c</span><span class="op" id="3282634">.</span><span class="ident" id="3282635">Pos</span><span class="op" id="3282638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282641">for</span>&nbsp;<span class="ident" id="3282645">_</span><span class="op" id="3282646">,</span>&nbsp;<span class="ident" id="3282648">c</span>&nbsp;<span class="op" id="3282650">:=</span>&nbsp;<span class="keyword" id="3282653">range</span>&nbsp;<span class="ident" id="3282659">c</span><span class="op" id="3282660">.</span><span class="ident" id="3282661">Args</span>&nbsp;<span class="op" id="3282666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282670">n</span><span class="op" id="3282671">.</span><span class="builtinfunc" id="3282672">append</span><span class="op" id="3282678">(</span><span class="ident" id="3282679">c</span><span class="op" id="3282680">.</span><span class="ident" id="3282681">Copy</span><span class="op" id="3282685">(</span><span class="op" id="3282686">)</span><span class="op" id="3282687">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3282690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282693">return</span>&nbsp;<span class="ident" id="3282700">n</span><br>
<span class="lineno"></span><span class="op" id="3282702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3282705">//&nbsp;IdentifierNode&nbsp;holds&nbsp;an&nbsp;identifier.</span><br>
<span class="lineno">280</span><span class="keyword" id="3282744">type</span>&nbsp;<span class="ident" id="3282749">IdentifierNode</span>&nbsp;<span class="keyword" id="3282764">struct</span>&nbsp;<span class="op" id="3282771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282774">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282784">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282789">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3282795">*</span><span class="ident" id="3282796">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282802">Ident</span>&nbsp;<span class="builtintype" id="3282808">string</span>&nbsp;<span class="comment" id="3282815">//&nbsp;The&nbsp;identifier&#39;s&nbsp;name.</span><br>
<span class="lineno">285</span><span class="op" id="3282841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3282844">//&nbsp;NewIdentifier&nbsp;returns&nbsp;a&nbsp;new&nbsp;IdentifierNode&nbsp;with&nbsp;the&nbsp;given&nbsp;identifier&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3282922">func</span>&nbsp;<span class="ident" id="3282927">NewIdentifier</span><span class="op" id="3282940">(</span><span class="ident" id="3282941">ident</span>&nbsp;<span class="builtintype" id="3282947">string</span><span class="op" id="3282953">)</span>&nbsp;<span class="op" id="3282955">*</span><span class="ident" id="3282956">IdentifierNode</span>&nbsp;<span class="op" id="3282971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282974">return</span>&nbsp;<span class="op" id="3282981">&amp;</span><span class="ident" id="3282982">IdentifierNode</span><span class="op" id="3282996">{</span><span class="ident" id="3282997">NodeType</span><span class="op" id="3283005">:</span>&nbsp;<span class="ident" id="3283007">NodeIdentifier</span><span class="op" id="3283021">,</span>&nbsp;<span class="ident" id="3283023">Ident</span><span class="op" id="3283028">:</span>&nbsp;<span class="ident" id="3283030">ident</span><span class="op" id="3283035">}</span><br>
<span class="lineno">290</span><span class="op" id="3283037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3283040">//&nbsp;SetPos&nbsp;sets&nbsp;the&nbsp;position.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="3283136">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="3283164">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno">295</span><span class="keyword" id="3283186">func</span>&nbsp;<span class="op" id="3283191">(</span><span class="ident" id="3283192">i</span>&nbsp;<span class="op" id="3283194">*</span><span class="ident" id="3283195">IdentifierNode</span><span class="op" id="3283209">)</span>&nbsp;<span class="ident" id="3283211">SetPos</span><span class="op" id="3283217">(</span><span class="ident" id="3283218">pos</span>&nbsp;<span class="ident" id="3283222">Pos</span><span class="op" id="3283225">)</span>&nbsp;<span class="op" id="3283227">*</span><span class="ident" id="3283228">IdentifierNode</span>&nbsp;<span class="op" id="3283243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3283246">i</span><span class="op" id="3283247">.</span><span class="ident" id="3283248">Pos</span>&nbsp;<span class="op" id="3283252">=</span>&nbsp;<span class="ident" id="3283254">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3283259">return</span>&nbsp;<span class="ident" id="3283266">i</span><br>
<span class="lineno"></span><span class="op" id="3283268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="3283271">//&nbsp;SetTree&nbsp;sets&nbsp;the&nbsp;parent&nbsp;tree&nbsp;for&nbsp;the&nbsp;node.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="3283384">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="3283412">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno"></span><span class="keyword" id="3283434">func</span>&nbsp;<span class="op" id="3283439">(</span><span class="ident" id="3283440">i</span>&nbsp;<span class="op" id="3283442">*</span><span class="ident" id="3283443">IdentifierNode</span><span class="op" id="3283457">)</span>&nbsp;<span class="ident" id="3283459">SetTree</span><span class="op" id="3283466">(</span><span class="ident" id="3283467">t</span>&nbsp;<span class="op" id="3283469">*</span><span class="ident" id="3283470">Tree</span><span class="op" id="3283474">)</span>&nbsp;<span class="op" id="3283476">*</span><span class="ident" id="3283477">IdentifierNode</span>&nbsp;<span class="op" id="3283492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3283495">i</span><span class="op" id="3283496">.</span><span class="ident" id="3283497">tr</span>&nbsp;<span class="op" id="3283500">=</span>&nbsp;<span class="ident" id="3283502">t</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3283505">return</span>&nbsp;<span class="ident" id="3283512">i</span><br>
<span class="lineno"></span><span class="op" id="3283514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3283517">func</span>&nbsp;<span class="op" id="3283522">(</span><span class="ident" id="3283523">i</span>&nbsp;<span class="op" id="3283525">*</span><span class="ident" id="3283526">IdentifierNode</span><span class="op" id="3283540">)</span>&nbsp;<span class="ident" id="3283542">String</span><span class="op" id="3283548">(</span><span class="op" id="3283549">)</span>&nbsp;<span class="builtintype" id="3283551">string</span>&nbsp;<span class="op" id="3283558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3283561">return</span>&nbsp;<span class="ident" id="3283568">i</span><span class="op" id="3283569">.</span><span class="ident" id="3283570">Ident</span><br>
<span class="lineno">310</span><span class="op" id="3283576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3283579">func</span>&nbsp;<span class="op" id="3283584">(</span><span class="ident" id="3283585">i</span>&nbsp;<span class="op" id="3283587">*</span><span class="ident" id="3283588">IdentifierNode</span><span class="op" id="3283602">)</span>&nbsp;<span class="ident" id="3283604">tree</span><span class="op" id="3283608">(</span><span class="op" id="3283609">)</span>&nbsp;<span class="op" id="3283611">*</span><span class="ident" id="3283612">Tree</span>&nbsp;<span class="op" id="3283617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3283620">return</span>&nbsp;<span class="ident" id="3283627">i</span><span class="op" id="3283628">.</span><span class="ident" id="3283629">tr</span><br>
<span class="lineno"></span><span class="op" id="3283632">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="3283635">func</span>&nbsp;<span class="op" id="3283640">(</span><span class="ident" id="3283641">i</span>&nbsp;<span class="op" id="3283643">*</span><span class="ident" id="3283644">IdentifierNode</span><span class="op" id="3283658">)</span>&nbsp;<span class="ident" id="3283660">Copy</span><span class="op" id="3283664">(</span><span class="op" id="3283665">)</span>&nbsp;<span class="ident" id="3283667">Node</span>&nbsp;<span class="op" id="3283672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3283675">return</span>&nbsp;<span class="ident" id="3283682">NewIdentifier</span><span class="op" id="3283695">(</span><span class="ident" id="3283696">i</span><span class="op" id="3283697">.</span><span class="ident" id="3283698">Ident</span><span class="op" id="3283703">)</span><span class="op" id="3283704">.</span><span class="ident" id="3283705">SetTree</span><span class="op" id="3283712">(</span><span class="ident" id="3283713">i</span><span class="op" id="3283714">.</span><span class="ident" id="3283715">tr</span><span class="op" id="3283717">)</span><span class="op" id="3283718">.</span><span class="ident" id="3283719">SetPos</span><span class="op" id="3283725">(</span><span class="ident" id="3283726">i</span><span class="op" id="3283727">.</span><span class="ident" id="3283728">Pos</span><span class="op" id="3283731">)</span><br>
<span class="lineno"></span><span class="op" id="3283733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="3283736">//&nbsp;VariableNode&nbsp;holds&nbsp;a&nbsp;list&nbsp;of&nbsp;variable&nbsp;names,&nbsp;possibly&nbsp;with&nbsp;chained&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="3283812">//&nbsp;accesses.&nbsp;The&nbsp;dollar&nbsp;sign&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;(first)&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3283870">type</span>&nbsp;<span class="ident" id="3283875">VariableNode</span>&nbsp;<span class="keyword" id="3283888">struct</span>&nbsp;<span class="op" id="3283895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3283898">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3283908">Pos</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3283913">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3283919">*</span><span class="ident" id="3283920">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3283926">Ident</span>&nbsp;<span class="op" id="3283932">[</span><span class="op" id="3283933">]</span><span class="builtintype" id="3283934">string</span>&nbsp;<span class="comment" id="3283941">//&nbsp;Variable&nbsp;name&nbsp;and&nbsp;fields&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3283987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3283990">func</span>&nbsp;<span class="op" id="3283995">(</span><span class="ident" id="3283996">t</span>&nbsp;<span class="op" id="3283998">*</span><span class="ident" id="3283999">Tree</span><span class="op" id="3284003">)</span>&nbsp;<span class="ident" id="3284005">newVariable</span><span class="op" id="3284016">(</span><span class="ident" id="3284017">pos</span>&nbsp;<span class="ident" id="3284021">Pos</span><span class="op" id="3284024">,</span>&nbsp;<span class="ident" id="3284026">ident</span>&nbsp;<span class="builtintype" id="3284032">string</span><span class="op" id="3284038">)</span>&nbsp;<span class="op" id="3284040">*</span><span class="ident" id="3284041">VariableNode</span>&nbsp;<span class="op" id="3284054">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3284057">return</span>&nbsp;<span class="op" id="3284064">&amp;</span><span class="ident" id="3284065">VariableNode</span><span class="op" id="3284077">{</span><span class="ident" id="3284078">tr</span><span class="op" id="3284080">:</span>&nbsp;<span class="ident" id="3284082">t</span><span class="op" id="3284083">,</span>&nbsp;<span class="ident" id="3284085">NodeType</span><span class="op" id="3284093">:</span>&nbsp;<span class="ident" id="3284095">NodeVariable</span><span class="op" id="3284107">,</span>&nbsp;<span class="ident" id="3284109">Pos</span><span class="op" id="3284112">:</span>&nbsp;<span class="ident" id="3284114">pos</span><span class="op" id="3284117">,</span>&nbsp;<span class="ident" id="3284119">Ident</span><span class="op" id="3284124">:</span>&nbsp;<span class="ident" id="3284126">strings</span><span class="op" id="3284133">.</span><span class="ident" id="3284134">Split</span><span class="op" id="3284139">(</span><span class="ident" id="3284140">ident</span><span class="op" id="3284145">,</span>&nbsp;<span class="string" id="3284147">&#34;.&#34;</span><span class="op" id="3284150">)</span><span class="op" id="3284151">}</span><br>
<span class="lineno"></span><span class="op" id="3284153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3284156">func</span>&nbsp;<span class="op" id="3284161">(</span><span class="ident" id="3284162">v</span>&nbsp;<span class="op" id="3284164">*</span><span class="ident" id="3284165">VariableNode</span><span class="op" id="3284177">)</span>&nbsp;<span class="ident" id="3284179">String</span><span class="op" id="3284185">(</span><span class="op" id="3284186">)</span>&nbsp;<span class="builtintype" id="3284188">string</span>&nbsp;<span class="op" id="3284195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3284198">s</span>&nbsp;<span class="op" id="3284200">:=</span>&nbsp;<span class="string" id="3284203">&#34;&#34;</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3284207">for</span>&nbsp;<span class="ident" id="3284211">i</span><span class="op" id="3284212">,</span>&nbsp;<span class="ident" id="3284214">id</span>&nbsp;<span class="op" id="3284217">:=</span>&nbsp;<span class="keyword" id="3284220">range</span>&nbsp;<span class="ident" id="3284226">v</span><span class="op" id="3284227">.</span><span class="ident" id="3284228">Ident</span>&nbsp;<span class="op" id="3284234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3284238">if</span>&nbsp;<span class="ident" id="3284241">i</span>&nbsp;<span class="op" id="3284243">&gt;</span>&nbsp;<span class="num" id="3284245">0</span>&nbsp;<span class="op" id="3284247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3284252">s</span>&nbsp;<span class="op" id="3284254">+=</span>&nbsp;<span class="string" id="3284257">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3284263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3284267">s</span>&nbsp;<span class="op" id="3284269">+=</span>&nbsp;<span class="ident" id="3284272">id</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3284276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3284279">return</span>&nbsp;<span class="ident" id="3284286">s</span><br>
<span class="lineno"></span><span class="op" id="3284288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3284291">func</span>&nbsp;<span class="op" id="3284296">(</span><span class="ident" id="3284297">v</span>&nbsp;<span class="op" id="3284299">*</span><span class="ident" id="3284300">VariableNode</span><span class="op" id="3284312">)</span>&nbsp;<span class="ident" id="3284314">tree</span><span class="op" id="3284318">(</span><span class="op" id="3284319">)</span>&nbsp;<span class="op" id="3284321">*</span><span class="ident" id="3284322">Tree</span>&nbsp;<span class="op" id="3284327">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3284330">return</span>&nbsp;<span class="ident" id="3284337">v</span><span class="op" id="3284338">.</span><span class="ident" id="3284339">tr</span><br>
<span class="lineno"></span><span class="op" id="3284342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3284345">func</span>&nbsp;<span class="op" id="3284350">(</span><span class="ident" id="3284351">v</span>&nbsp;<span class="op" id="3284353">*</span><span class="ident" id="3284354">VariableNode</span><span class="op" id="3284366">)</span>&nbsp;<span class="ident" id="3284368">Copy</span><span class="op" id="3284372">(</span><span class="op" id="3284373">)</span>&nbsp;<span class="ident" id="3284375">Node</span>&nbsp;<span class="op" id="3284380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3284383">return</span>&nbsp;<span class="op" id="3284390">&amp;</span><span class="ident" id="3284391">VariableNode</span><span class="op" id="3284403">{</span><span class="ident" id="3284404">tr</span><span class="op" id="3284406">:</span>&nbsp;<span class="ident" id="3284408">v</span><span class="op" id="3284409">.</span><span class="ident" id="3284410">tr</span><span class="op" id="3284412">,</span>&nbsp;<span class="ident" id="3284414">NodeType</span><span class="op" id="3284422">:</span>&nbsp;<span class="ident" id="3284424">NodeVariable</span><span class="op" id="3284436">,</span>&nbsp;<span class="ident" id="3284438">Pos</span><span class="op" id="3284441">:</span>&nbsp;<span class="ident" id="3284443">v</span><span class="op" id="3284444">.</span><span class="ident" id="3284445">Pos</span><span class="op" id="3284448">,</span>&nbsp;<span class="ident" id="3284450">Ident</span><span class="op" id="3284455">:</span>&nbsp;<span class="builtinfunc" id="3284457">append</span><span class="op" id="3284463">(</span><span class="op" id="3284464">[</span><span class="op" id="3284465">]</span><span class="builtintype" id="3284466">string</span><span class="op" id="3284472">{</span><span class="op" id="3284473">}</span><span class="op" id="3284474">,</span>&nbsp;<span class="ident" id="3284476">v</span><span class="op" id="3284477">.</span><span class="ident" id="3284478">Ident</span><span class="op" id="3284483">...</span><span class="op" id="3284486">)</span><span class="op" id="3284487">}</span><br>
<span class="lineno">350</span><span class="op" id="3284489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3284492">//&nbsp;DotNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;.&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="3284537">type</span>&nbsp;<span class="ident" id="3284542">DotNode</span>&nbsp;<span class="keyword" id="3284550">struct</span>&nbsp;<span class="op" id="3284557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3284560">NodeType</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3284570">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3284575">tr</span>&nbsp;<span class="op" id="3284578">*</span><span class="ident" id="3284579">Tree</span><br>
<span class="lineno"></span><span class="op" id="3284584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3284587">func</span>&nbsp;<span class="op" id="3284592">(</span><span class="ident" id="3284593">t</span>&nbsp;<span class="op" id="3284595">*</span><span class="ident" id="3284596">Tree</span><span class="op" id="3284600">)</span>&nbsp;<span class="ident" id="3284602">newDot</span><span class="op" id="3284608">(</span><span class="ident" id="3284609">pos</span>&nbsp;<span class="ident" id="3284613">Pos</span><span class="op" id="3284616">)</span>&nbsp;<span class="op" id="3284618">*</span><span class="ident" id="3284619">DotNode</span>&nbsp;<span class="op" id="3284627">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3284630">return</span>&nbsp;<span class="op" id="3284637">&amp;</span><span class="ident" id="3284638">DotNode</span><span class="op" id="3284645">{</span><span class="ident" id="3284646">tr</span><span class="op" id="3284648">:</span>&nbsp;<span class="ident" id="3284650">t</span><span class="op" id="3284651">,</span>&nbsp;<span class="ident" id="3284653">NodeType</span><span class="op" id="3284661">:</span>&nbsp;<span class="ident" id="3284663">NodeDot</span><span class="op" id="3284670">,</span>&nbsp;<span class="ident" id="3284672">Pos</span><span class="op" id="3284675">:</span>&nbsp;<span class="ident" id="3284677">pos</span><span class="op" id="3284680">}</span><br>
<span class="lineno"></span><span class="op" id="3284682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3284685">func</span>&nbsp;<span class="op" id="3284690">(</span><span class="ident" id="3284691">d</span>&nbsp;<span class="op" id="3284693">*</span><span class="ident" id="3284694">DotNode</span><span class="op" id="3284701">)</span>&nbsp;<span class="ident" id="3284703">Type</span><span class="op" id="3284707">(</span><span class="op" id="3284708">)</span>&nbsp;<span class="ident" id="3284710">NodeType</span>&nbsp;<span class="op" id="3284719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3284722">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3284786">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3284854">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3284878">return</span>&nbsp;<span class="ident" id="3284885">NodeDot</span><br>
<span class="lineno"></span><span class="op" id="3284893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="3284896">func</span>&nbsp;<span class="op" id="3284901">(</span><span class="ident" id="3284902">d</span>&nbsp;<span class="op" id="3284904">*</span><span class="ident" id="3284905">DotNode</span><span class="op" id="3284912">)</span>&nbsp;<span class="ident" id="3284914">String</span><span class="op" id="3284920">(</span><span class="op" id="3284921">)</span>&nbsp;<span class="builtintype" id="3284923">string</span>&nbsp;<span class="op" id="3284930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3284933">return</span>&nbsp;<span class="string" id="3284940">&#34;.&#34;</span><br>
<span class="lineno"></span><span class="op" id="3284944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3284947">func</span>&nbsp;<span class="op" id="3284952">(</span><span class="ident" id="3284953">d</span>&nbsp;<span class="op" id="3284955">*</span><span class="ident" id="3284956">DotNode</span><span class="op" id="3284963">)</span>&nbsp;<span class="ident" id="3284965">tree</span><span class="op" id="3284969">(</span><span class="op" id="3284970">)</span>&nbsp;<span class="op" id="3284972">*</span><span class="ident" id="3284973">Tree</span>&nbsp;<span class="op" id="3284978">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3284981">return</span>&nbsp;<span class="ident" id="3284988">d</span><span class="op" id="3284989">.</span><span class="ident" id="3284990">tr</span><br>
<span class="lineno"></span><span class="op" id="3284993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3284996">func</span>&nbsp;<span class="op" id="3285001">(</span><span class="ident" id="3285002">d</span>&nbsp;<span class="op" id="3285004">*</span><span class="ident" id="3285005">DotNode</span><span class="op" id="3285012">)</span>&nbsp;<span class="ident" id="3285014">Copy</span><span class="op" id="3285018">(</span><span class="op" id="3285019">)</span>&nbsp;<span class="ident" id="3285021">Node</span>&nbsp;<span class="op" id="3285026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3285029">return</span>&nbsp;<span class="ident" id="3285036">d</span><span class="op" id="3285037">.</span><span class="ident" id="3285038">tr</span><span class="op" id="3285040">.</span><span class="ident" id="3285041">newDot</span><span class="op" id="3285047">(</span><span class="ident" id="3285048">d</span><span class="op" id="3285049">.</span><span class="ident" id="3285050">Pos</span><span class="op" id="3285053">)</span><br>
<span class="lineno">380</span><span class="op" id="3285055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3285058">//&nbsp;NilNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;nil&#39;&nbsp;representing&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="3285142">type</span>&nbsp;<span class="ident" id="3285147">NilNode</span>&nbsp;<span class="keyword" id="3285155">struct</span>&nbsp;<span class="op" id="3285162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3285165">NodeType</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3285175">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3285180">tr</span>&nbsp;<span class="op" id="3285183">*</span><span class="ident" id="3285184">Tree</span><br>
<span class="lineno"></span><span class="op" id="3285189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3285192">func</span>&nbsp;<span class="op" id="3285197">(</span><span class="ident" id="3285198">t</span>&nbsp;<span class="op" id="3285200">*</span><span class="ident" id="3285201">Tree</span><span class="op" id="3285205">)</span>&nbsp;<span class="ident" id="3285207">newNil</span><span class="op" id="3285213">(</span><span class="ident" id="3285214">pos</span>&nbsp;<span class="ident" id="3285218">Pos</span><span class="op" id="3285221">)</span>&nbsp;<span class="op" id="3285223">*</span><span class="ident" id="3285224">NilNode</span>&nbsp;<span class="op" id="3285232">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3285235">return</span>&nbsp;<span class="op" id="3285242">&amp;</span><span class="ident" id="3285243">NilNode</span><span class="op" id="3285250">{</span><span class="ident" id="3285251">tr</span><span class="op" id="3285253">:</span>&nbsp;<span class="ident" id="3285255">t</span><span class="op" id="3285256">,</span>&nbsp;<span class="ident" id="3285258">NodeType</span><span class="op" id="3285266">:</span>&nbsp;<span class="ident" id="3285268">NodeNil</span><span class="op" id="3285275">,</span>&nbsp;<span class="ident" id="3285277">Pos</span><span class="op" id="3285280">:</span>&nbsp;<span class="ident" id="3285282">pos</span><span class="op" id="3285285">}</span><br>
<span class="lineno"></span><span class="op" id="3285287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3285290">func</span>&nbsp;<span class="op" id="3285295">(</span><span class="ident" id="3285296">n</span>&nbsp;<span class="op" id="3285298">*</span><span class="ident" id="3285299">NilNode</span><span class="op" id="3285306">)</span>&nbsp;<span class="ident" id="3285308">Type</span><span class="op" id="3285312">(</span><span class="op" id="3285313">)</span>&nbsp;<span class="ident" id="3285315">NodeType</span>&nbsp;<span class="op" id="3285324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3285327">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3285391">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3285459">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3285483">return</span>&nbsp;<span class="ident" id="3285490">NodeNil</span><br>
<span class="lineno"></span><span class="op" id="3285498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="keyword" id="3285501">func</span>&nbsp;<span class="op" id="3285506">(</span><span class="ident" id="3285507">n</span>&nbsp;<span class="op" id="3285509">*</span><span class="ident" id="3285510">NilNode</span><span class="op" id="3285517">)</span>&nbsp;<span class="ident" id="3285519">String</span><span class="op" id="3285525">(</span><span class="op" id="3285526">)</span>&nbsp;<span class="builtintype" id="3285528">string</span>&nbsp;<span class="op" id="3285535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3285538">return</span>&nbsp;<span class="string" id="3285545">&#34;nil&#34;</span><br>
<span class="lineno"></span><span class="op" id="3285551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3285554">func</span>&nbsp;<span class="op" id="3285559">(</span><span class="ident" id="3285560">n</span>&nbsp;<span class="op" id="3285562">*</span><span class="ident" id="3285563">NilNode</span><span class="op" id="3285570">)</span>&nbsp;<span class="ident" id="3285572">tree</span><span class="op" id="3285576">(</span><span class="op" id="3285577">)</span>&nbsp;<span class="op" id="3285579">*</span><span class="ident" id="3285580">Tree</span>&nbsp;<span class="op" id="3285585">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3285588">return</span>&nbsp;<span class="ident" id="3285595">n</span><span class="op" id="3285596">.</span><span class="ident" id="3285597">tr</span><br>
<span class="lineno"></span><span class="op" id="3285600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3285603">func</span>&nbsp;<span class="op" id="3285608">(</span><span class="ident" id="3285609">n</span>&nbsp;<span class="op" id="3285611">*</span><span class="ident" id="3285612">NilNode</span><span class="op" id="3285619">)</span>&nbsp;<span class="ident" id="3285621">Copy</span><span class="op" id="3285625">(</span><span class="op" id="3285626">)</span>&nbsp;<span class="ident" id="3285628">Node</span>&nbsp;<span class="op" id="3285633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3285636">return</span>&nbsp;<span class="ident" id="3285643">n</span><span class="op" id="3285644">.</span><span class="ident" id="3285645">tr</span><span class="op" id="3285647">.</span><span class="ident" id="3285648">newNil</span><span class="op" id="3285654">(</span><span class="ident" id="3285655">n</span><span class="op" id="3285656">.</span><span class="ident" id="3285657">Pos</span><span class="op" id="3285660">)</span><br>
<span class="lineno">410</span><span class="op" id="3285662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3285665">//&nbsp;FieldNode&nbsp;holds&nbsp;a&nbsp;field&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3285724">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3285762">//&nbsp;The&nbsp;period&nbsp;is&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">415</span><span class="keyword" id="3285804">type</span>&nbsp;<span class="ident" id="3285809">FieldNode</span>&nbsp;<span class="keyword" id="3285819">struct</span>&nbsp;<span class="op" id="3285826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3285829">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3285839">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3285844">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3285850">*</span><span class="ident" id="3285851">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3285857">Ident</span>&nbsp;<span class="op" id="3285863">[</span><span class="op" id="3285864">]</span><span class="builtintype" id="3285865">string</span>&nbsp;<span class="comment" id="3285872">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">420</span><span class="op" id="3285909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3285912">func</span>&nbsp;<span class="op" id="3285917">(</span><span class="ident" id="3285918">t</span>&nbsp;<span class="op" id="3285920">*</span><span class="ident" id="3285921">Tree</span><span class="op" id="3285925">)</span>&nbsp;<span class="ident" id="3285927">newField</span><span class="op" id="3285935">(</span><span class="ident" id="3285936">pos</span>&nbsp;<span class="ident" id="3285940">Pos</span><span class="op" id="3285943">,</span>&nbsp;<span class="ident" id="3285945">ident</span>&nbsp;<span class="builtintype" id="3285951">string</span><span class="op" id="3285957">)</span>&nbsp;<span class="op" id="3285959">*</span><span class="ident" id="3285960">FieldNode</span>&nbsp;<span class="op" id="3285970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3285973">return</span>&nbsp;<span class="op" id="3285980">&amp;</span><span class="ident" id="3285981">FieldNode</span><span class="op" id="3285990">{</span><span class="ident" id="3285991">tr</span><span class="op" id="3285993">:</span>&nbsp;<span class="ident" id="3285995">t</span><span class="op" id="3285996">,</span>&nbsp;<span class="ident" id="3285998">NodeType</span><span class="op" id="3286006">:</span>&nbsp;<span class="ident" id="3286008">NodeField</span><span class="op" id="3286017">,</span>&nbsp;<span class="ident" id="3286019">Pos</span><span class="op" id="3286022">:</span>&nbsp;<span class="ident" id="3286024">pos</span><span class="op" id="3286027">,</span>&nbsp;<span class="ident" id="3286029">Ident</span><span class="op" id="3286034">:</span>&nbsp;<span class="ident" id="3286036">strings</span><span class="op" id="3286043">.</span><span class="ident" id="3286044">Split</span><span class="op" id="3286049">(</span><span class="ident" id="3286050">ident</span><span class="op" id="3286055">[</span><span class="num" id="3286056">1</span><span class="op" id="3286057">:</span><span class="op" id="3286058">]</span><span class="op" id="3286059">,</span>&nbsp;<span class="string" id="3286061">&#34;.&#34;</span><span class="op" id="3286064">)</span><span class="op" id="3286065">}</span>&nbsp;<span class="comment" id="3286067">//&nbsp;[1:]&nbsp;to&nbsp;drop&nbsp;leading&nbsp;period</span><br>
<span class="lineno"></span><span class="op" id="3286098">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="3286101">func</span>&nbsp;<span class="op" id="3286106">(</span><span class="ident" id="3286107">f</span>&nbsp;<span class="op" id="3286109">*</span><span class="ident" id="3286110">FieldNode</span><span class="op" id="3286119">)</span>&nbsp;<span class="ident" id="3286121">String</span><span class="op" id="3286127">(</span><span class="op" id="3286128">)</span>&nbsp;<span class="builtintype" id="3286130">string</span>&nbsp;<span class="op" id="3286137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3286140">s</span>&nbsp;<span class="op" id="3286142">:=</span>&nbsp;<span class="string" id="3286145">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3286149">for</span>&nbsp;<span class="ident" id="3286153">_</span><span class="op" id="3286154">,</span>&nbsp;<span class="ident" id="3286156">id</span>&nbsp;<span class="op" id="3286159">:=</span>&nbsp;<span class="keyword" id="3286162">range</span>&nbsp;<span class="ident" id="3286168">f</span><span class="op" id="3286169">.</span><span class="ident" id="3286170">Ident</span>&nbsp;<span class="op" id="3286176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3286180">s</span>&nbsp;<span class="op" id="3286182">+=</span>&nbsp;<span class="string" id="3286185">&#34;.&#34;</span>&nbsp;<span class="op" id="3286189">+</span>&nbsp;<span class="ident" id="3286191">id</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3286195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3286198">return</span>&nbsp;<span class="ident" id="3286205">s</span><br>
<span class="lineno"></span><span class="op" id="3286207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3286210">func</span>&nbsp;<span class="op" id="3286215">(</span><span class="ident" id="3286216">f</span>&nbsp;<span class="op" id="3286218">*</span><span class="ident" id="3286219">FieldNode</span><span class="op" id="3286228">)</span>&nbsp;<span class="ident" id="3286230">tree</span><span class="op" id="3286234">(</span><span class="op" id="3286235">)</span>&nbsp;<span class="op" id="3286237">*</span><span class="ident" id="3286238">Tree</span>&nbsp;<span class="op" id="3286243">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3286246">return</span>&nbsp;<span class="ident" id="3286253">f</span><span class="op" id="3286254">.</span><span class="ident" id="3286255">tr</span><br>
<span class="lineno"></span><span class="op" id="3286258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3286261">func</span>&nbsp;<span class="op" id="3286266">(</span><span class="ident" id="3286267">f</span>&nbsp;<span class="op" id="3286269">*</span><span class="ident" id="3286270">FieldNode</span><span class="op" id="3286279">)</span>&nbsp;<span class="ident" id="3286281">Copy</span><span class="op" id="3286285">(</span><span class="op" id="3286286">)</span>&nbsp;<span class="ident" id="3286288">Node</span>&nbsp;<span class="op" id="3286293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3286296">return</span>&nbsp;<span class="op" id="3286303">&amp;</span><span class="ident" id="3286304">FieldNode</span><span class="op" id="3286313">{</span><span class="ident" id="3286314">tr</span><span class="op" id="3286316">:</span>&nbsp;<span class="ident" id="3286318">f</span><span class="op" id="3286319">.</span><span class="ident" id="3286320">tr</span><span class="op" id="3286322">,</span>&nbsp;<span class="ident" id="3286324">NodeType</span><span class="op" id="3286332">:</span>&nbsp;<span class="ident" id="3286334">NodeField</span><span class="op" id="3286343">,</span>&nbsp;<span class="ident" id="3286345">Pos</span><span class="op" id="3286348">:</span>&nbsp;<span class="ident" id="3286350">f</span><span class="op" id="3286351">.</span><span class="ident" id="3286352">Pos</span><span class="op" id="3286355">,</span>&nbsp;<span class="ident" id="3286357">Ident</span><span class="op" id="3286362">:</span>&nbsp;<span class="builtinfunc" id="3286364">append</span><span class="op" id="3286370">(</span><span class="op" id="3286371">[</span><span class="op" id="3286372">]</span><span class="builtintype" id="3286373">string</span><span class="op" id="3286379">{</span><span class="op" id="3286380">}</span><span class="op" id="3286381">,</span>&nbsp;<span class="ident" id="3286383">f</span><span class="op" id="3286384">.</span><span class="ident" id="3286385">Ident</span><span class="op" id="3286390">...</span><span class="op" id="3286393">)</span><span class="op" id="3286394">}</span><br>
<span class="lineno">440</span><span class="op" id="3286396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3286399">//&nbsp;ChainNode&nbsp;holds&nbsp;a&nbsp;term&nbsp;followed&nbsp;by&nbsp;a&nbsp;chain&nbsp;of&nbsp;field&nbsp;accesses&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3286495">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3286533">//&nbsp;The&nbsp;periods&nbsp;are&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">445</span><span class="keyword" id="3286577">type</span>&nbsp;<span class="ident" id="3286582">ChainNode</span>&nbsp;<span class="keyword" id="3286592">struct</span>&nbsp;<span class="op" id="3286599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3286602">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3286612">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3286617">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3286623">*</span><span class="ident" id="3286624">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3286630">Node</span>&nbsp;&nbsp;<span class="ident" id="3286636">Node</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3286642">Field</span>&nbsp;<span class="op" id="3286648">[</span><span class="op" id="3286649">]</span><span class="builtintype" id="3286650">string</span>&nbsp;<span class="comment" id="3286657">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3286694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3286697">func</span>&nbsp;<span class="op" id="3286702">(</span><span class="ident" id="3286703">t</span>&nbsp;<span class="op" id="3286705">*</span><span class="ident" id="3286706">Tree</span><span class="op" id="3286710">)</span>&nbsp;<span class="ident" id="3286712">newChain</span><span class="op" id="3286720">(</span><span class="ident" id="3286721">pos</span>&nbsp;<span class="ident" id="3286725">Pos</span><span class="op" id="3286728">,</span>&nbsp;<span class="ident" id="3286730">node</span>&nbsp;<span class="ident" id="3286735">Node</span><span class="op" id="3286739">)</span>&nbsp;<span class="op" id="3286741">*</span><span class="ident" id="3286742">ChainNode</span>&nbsp;<span class="op" id="3286752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3286755">return</span>&nbsp;<span class="op" id="3286762">&amp;</span><span class="ident" id="3286763">ChainNode</span><span class="op" id="3286772">{</span><span class="ident" id="3286773">tr</span><span class="op" id="3286775">:</span>&nbsp;<span class="ident" id="3286777">t</span><span class="op" id="3286778">,</span>&nbsp;<span class="ident" id="3286780">NodeType</span><span class="op" id="3286788">:</span>&nbsp;<span class="ident" id="3286790">NodeChain</span><span class="op" id="3286799">,</span>&nbsp;<span class="ident" id="3286801">Pos</span><span class="op" id="3286804">:</span>&nbsp;<span class="ident" id="3286806">pos</span><span class="op" id="3286809">,</span>&nbsp;<span class="ident" id="3286811">Node</span><span class="op" id="3286815">:</span>&nbsp;<span class="ident" id="3286817">node</span><span class="op" id="3286821">}</span><br>
<span class="lineno">455</span><span class="op" id="3286823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3286826">//&nbsp;Add&nbsp;adds&nbsp;the&nbsp;named&nbsp;field&nbsp;(which&nbsp;should&nbsp;start&nbsp;with&nbsp;a&nbsp;period)&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="3286914">func</span>&nbsp;<span class="op" id="3286919">(</span><span class="ident" id="3286920">c</span>&nbsp;<span class="op" id="3286922">*</span><span class="ident" id="3286923">ChainNode</span><span class="op" id="3286932">)</span>&nbsp;<span class="ident" id="3286934">Add</span><span class="op" id="3286937">(</span><span class="ident" id="3286938">field</span>&nbsp;<span class="builtintype" id="3286944">string</span><span class="op" id="3286950">)</span>&nbsp;<span class="op" id="3286952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3286955">if</span>&nbsp;<span class="builtinfunc" id="3286958">len</span><span class="op" id="3286961">(</span><span class="ident" id="3286962">field</span><span class="op" id="3286967">)</span>&nbsp;<span class="op" id="3286969">==</span>&nbsp;<span class="num" id="3286972">0</span>&nbsp;<span class="op" id="3286974">||</span>&nbsp;<span class="ident" id="3286977">field</span><span class="op" id="3286982">[</span><span class="num" id="3286983">0</span><span class="op" id="3286984">]</span>&nbsp;<span class="op" id="3286986">!=</span>&nbsp;<span class="string" id="3286989">&#39;.&#39;</span>&nbsp;<span class="op" id="3286993">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3286997">panic</span><span class="op" id="3287002">(</span><span class="string" id="3287003">&#34;no&nbsp;dot&nbsp;in&nbsp;field&#34;</span><span class="op" id="3287020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3287023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3287026">field</span>&nbsp;<span class="op" id="3287032">=</span>&nbsp;<span class="ident" id="3287034">field</span><span class="op" id="3287039">[</span><span class="num" id="3287040">1</span><span class="op" id="3287041">:</span><span class="op" id="3287042">]</span>&nbsp;<span class="comment" id="3287044">//&nbsp;Remove&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3287068">if</span>&nbsp;<span class="ident" id="3287071">field</span>&nbsp;<span class="op" id="3287077">==</span>&nbsp;<span class="string" id="3287080">&#34;&#34;</span>&nbsp;<span class="op" id="3287083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3287087">panic</span><span class="op" id="3287092">(</span><span class="string" id="3287093">&#34;empty&nbsp;field&#34;</span><span class="op" id="3287106">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3287109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3287112">c</span><span class="op" id="3287113">.</span><span class="ident" id="3287114">Field</span>&nbsp;<span class="op" id="3287120">=</span>&nbsp;<span class="builtinfunc" id="3287122">append</span><span class="op" id="3287128">(</span><span class="ident" id="3287129">c</span><span class="op" id="3287130">.</span><span class="ident" id="3287131">Field</span><span class="op" id="3287136">,</span>&nbsp;<span class="ident" id="3287138">field</span><span class="op" id="3287143">)</span><br>
<span class="lineno"></span><span class="op" id="3287145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3287148">func</span>&nbsp;<span class="op" id="3287153">(</span><span class="ident" id="3287154">c</span>&nbsp;<span class="op" id="3287156">*</span><span class="ident" id="3287157">ChainNode</span><span class="op" id="3287166">)</span>&nbsp;<span class="ident" id="3287168">String</span><span class="op" id="3287174">(</span><span class="op" id="3287175">)</span>&nbsp;<span class="builtintype" id="3287177">string</span>&nbsp;<span class="op" id="3287184">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3287187">s</span>&nbsp;<span class="op" id="3287189">:=</span>&nbsp;<span class="ident" id="3287192">c</span><span class="op" id="3287193">.</span><span class="ident" id="3287194">Node</span><span class="op" id="3287198">.</span><span class="ident" id="3287199">String</span><span class="op" id="3287205">(</span><span class="op" id="3287206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3287209">if</span>&nbsp;<span class="ident" id="3287212">_</span><span class="op" id="3287213">,</span>&nbsp;<span class="ident" id="3287215">ok</span>&nbsp;<span class="op" id="3287218">:=</span>&nbsp;<span class="ident" id="3287221">c</span><span class="op" id="3287222">.</span><span class="ident" id="3287223">Node</span><span class="op" id="3287227">.</span><span class="op" id="3287228">(</span><span class="op" id="3287229">*</span><span class="ident" id="3287230">PipeNode</span><span class="op" id="3287238">)</span><span class="op" id="3287239">;</span>&nbsp;<span class="ident" id="3287241">ok</span>&nbsp;<span class="op" id="3287244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3287248">s</span>&nbsp;<span class="op" id="3287250">=</span>&nbsp;<span class="string" id="3287252">&#34;(&#34;</span>&nbsp;<span class="op" id="3287256">+</span>&nbsp;<span class="ident" id="3287258">s</span>&nbsp;<span class="op" id="3287260">+</span>&nbsp;<span class="string" id="3287262">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3287267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3287270">for</span>&nbsp;<span class="ident" id="3287274">_</span><span class="op" id="3287275">,</span>&nbsp;<span class="ident" id="3287277">field</span>&nbsp;<span class="op" id="3287283">:=</span>&nbsp;<span class="keyword" id="3287286">range</span>&nbsp;<span class="ident" id="3287292">c</span><span class="op" id="3287293">.</span><span class="ident" id="3287294">Field</span>&nbsp;<span class="op" id="3287300">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3287304">s</span>&nbsp;<span class="op" id="3287306">+=</span>&nbsp;<span class="string" id="3287309">&#34;.&#34;</span>&nbsp;<span class="op" id="3287313">+</span>&nbsp;<span class="ident" id="3287315">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3287322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3287325">return</span>&nbsp;<span class="ident" id="3287332">s</span><br>
<span class="lineno"></span><span class="op" id="3287334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="keyword" id="3287337">func</span>&nbsp;<span class="op" id="3287342">(</span><span class="ident" id="3287343">c</span>&nbsp;<span class="op" id="3287345">*</span><span class="ident" id="3287346">ChainNode</span><span class="op" id="3287355">)</span>&nbsp;<span class="ident" id="3287357">tree</span><span class="op" id="3287361">(</span><span class="op" id="3287362">)</span>&nbsp;<span class="op" id="3287364">*</span><span class="ident" id="3287365">Tree</span>&nbsp;<span class="op" id="3287370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3287373">return</span>&nbsp;<span class="ident" id="3287380">c</span><span class="op" id="3287381">.</span><span class="ident" id="3287382">tr</span><br>
<span class="lineno"></span><span class="op" id="3287385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3287388">func</span>&nbsp;<span class="op" id="3287393">(</span><span class="ident" id="3287394">c</span>&nbsp;<span class="op" id="3287396">*</span><span class="ident" id="3287397">ChainNode</span><span class="op" id="3287406">)</span>&nbsp;<span class="ident" id="3287408">Copy</span><span class="op" id="3287412">(</span><span class="op" id="3287413">)</span>&nbsp;<span class="ident" id="3287415">Node</span>&nbsp;<span class="op" id="3287420">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3287423">return</span>&nbsp;<span class="op" id="3287430">&amp;</span><span class="ident" id="3287431">ChainNode</span><span class="op" id="3287440">{</span><span class="ident" id="3287441">tr</span><span class="op" id="3287443">:</span>&nbsp;<span class="ident" id="3287445">c</span><span class="op" id="3287446">.</span><span class="ident" id="3287447">tr</span><span class="op" id="3287449">,</span>&nbsp;<span class="ident" id="3287451">NodeType</span><span class="op" id="3287459">:</span>&nbsp;<span class="ident" id="3287461">NodeChain</span><span class="op" id="3287470">,</span>&nbsp;<span class="ident" id="3287472">Pos</span><span class="op" id="3287475">:</span>&nbsp;<span class="ident" id="3287477">c</span><span class="op" id="3287478">.</span><span class="ident" id="3287479">Pos</span><span class="op" id="3287482">,</span>&nbsp;<span class="ident" id="3287484">Node</span><span class="op" id="3287488">:</span>&nbsp;<span class="ident" id="3287490">c</span><span class="op" id="3287491">.</span><span class="ident" id="3287492">Node</span><span class="op" id="3287496">,</span>&nbsp;<span class="ident" id="3287498">Field</span><span class="op" id="3287503">:</span>&nbsp;<span class="builtinfunc" id="3287505">append</span><span class="op" id="3287511">(</span><span class="op" id="3287512">[</span><span class="op" id="3287513">]</span><span class="builtintype" id="3287514">string</span><span class="op" id="3287520">{</span><span class="op" id="3287521">}</span><span class="op" id="3287522">,</span>&nbsp;<span class="ident" id="3287524">c</span><span class="op" id="3287525">.</span><span class="ident" id="3287526">Field</span><span class="op" id="3287531">...</span><span class="op" id="3287534">)</span><span class="op" id="3287535">}</span><br>
<span class="lineno"></span><span class="op" id="3287537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3287540">//&nbsp;BoolNode&nbsp;holds&nbsp;a&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="3287578">type</span>&nbsp;<span class="ident" id="3287583">BoolNode</span>&nbsp;<span class="keyword" id="3287592">struct</span>&nbsp;<span class="op" id="3287599">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3287602">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3287612">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3287617">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3287622">*</span><span class="ident" id="3287623">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3287629">True</span>&nbsp;<span class="builtintype" id="3287634">bool</span>&nbsp;<span class="comment" id="3287639">//&nbsp;The&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="3287677">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="3287680">func</span>&nbsp;<span class="op" id="3287685">(</span><span class="ident" id="3287686">t</span>&nbsp;<span class="op" id="3287688">*</span><span class="ident" id="3287689">Tree</span><span class="op" id="3287693">)</span>&nbsp;<span class="ident" id="3287695">newBool</span><span class="op" id="3287702">(</span><span class="ident" id="3287703">pos</span>&nbsp;<span class="ident" id="3287707">Pos</span><span class="op" id="3287710">,</span>&nbsp;<span class="builtintype" id="3287712">true</span>&nbsp;<span class="builtintype" id="3287717">bool</span><span class="op" id="3287721">)</span>&nbsp;<span class="op" id="3287723">*</span><span class="ident" id="3287724">BoolNode</span>&nbsp;<span class="op" id="3287733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3287736">return</span>&nbsp;<span class="op" id="3287743">&amp;</span><span class="ident" id="3287744">BoolNode</span><span class="op" id="3287752">{</span><span class="ident" id="3287753">tr</span><span class="op" id="3287755">:</span>&nbsp;<span class="ident" id="3287757">t</span><span class="op" id="3287758">,</span>&nbsp;<span class="ident" id="3287760">NodeType</span><span class="op" id="3287768">:</span>&nbsp;<span class="ident" id="3287770">NodeBool</span><span class="op" id="3287778">,</span>&nbsp;<span class="ident" id="3287780">Pos</span><span class="op" id="3287783">:</span>&nbsp;<span class="ident" id="3287785">pos</span><span class="op" id="3287788">,</span>&nbsp;<span class="ident" id="3287790">True</span><span class="op" id="3287794">:</span>&nbsp;<span class="builtintype" id="3287796">true</span><span class="op" id="3287800">}</span><br>
<span class="lineno"></span><span class="op" id="3287802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="3287805">func</span>&nbsp;<span class="op" id="3287810">(</span><span class="ident" id="3287811">b</span>&nbsp;<span class="op" id="3287813">*</span><span class="ident" id="3287814">BoolNode</span><span class="op" id="3287822">)</span>&nbsp;<span class="ident" id="3287824">String</span><span class="op" id="3287830">(</span><span class="op" id="3287831">)</span>&nbsp;<span class="builtintype" id="3287833">string</span>&nbsp;<span class="op" id="3287840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3287843">if</span>&nbsp;<span class="ident" id="3287846">b</span><span class="op" id="3287847">.</span><span class="ident" id="3287848">True</span>&nbsp;<span class="op" id="3287853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3287857">return</span>&nbsp;<span class="string" id="3287864">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3287872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3287875">return</span>&nbsp;<span class="string" id="3287882">&#34;false&#34;</span><br>
<span class="lineno">505</span><span class="op" id="3287890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3287893">func</span>&nbsp;<span class="op" id="3287898">(</span><span class="ident" id="3287899">b</span>&nbsp;<span class="op" id="3287901">*</span><span class="ident" id="3287902">BoolNode</span><span class="op" id="3287910">)</span>&nbsp;<span class="ident" id="3287912">tree</span><span class="op" id="3287916">(</span><span class="op" id="3287917">)</span>&nbsp;<span class="op" id="3287919">*</span><span class="ident" id="3287920">Tree</span>&nbsp;<span class="op" id="3287925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3287928">return</span>&nbsp;<span class="ident" id="3287935">b</span><span class="op" id="3287936">.</span><span class="ident" id="3287937">tr</span><br>
<span class="lineno"></span><span class="op" id="3287940">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="3287943">func</span>&nbsp;<span class="op" id="3287948">(</span><span class="ident" id="3287949">b</span>&nbsp;<span class="op" id="3287951">*</span><span class="ident" id="3287952">BoolNode</span><span class="op" id="3287960">)</span>&nbsp;<span class="ident" id="3287962">Copy</span><span class="op" id="3287966">(</span><span class="op" id="3287967">)</span>&nbsp;<span class="ident" id="3287969">Node</span>&nbsp;<span class="op" id="3287974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3287977">return</span>&nbsp;<span class="ident" id="3287984">b</span><span class="op" id="3287985">.</span><span class="ident" id="3287986">tr</span><span class="op" id="3287988">.</span><span class="ident" id="3287989">newBool</span><span class="op" id="3287996">(</span><span class="ident" id="3287997">b</span><span class="op" id="3287998">.</span><span class="ident" id="3287999">Pos</span><span class="op" id="3288002">,</span>&nbsp;<span class="ident" id="3288004">b</span><span class="op" id="3288005">.</span><span class="ident" id="3288006">True</span><span class="op" id="3288010">)</span><br>
<span class="lineno"></span><span class="op" id="3288012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="3288015">//&nbsp;NumberNode&nbsp;holds&nbsp;a&nbsp;number:&nbsp;signed&nbsp;or&nbsp;unsigned&nbsp;integer,&nbsp;float,&nbsp;or&nbsp;complex.</span><br>
<span class="lineno"></span><span class="comment" id="3288092">//&nbsp;The&nbsp;value&nbsp;is&nbsp;parsed&nbsp;and&nbsp;stored&nbsp;under&nbsp;all&nbsp;the&nbsp;types&nbsp;that&nbsp;can&nbsp;represent&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="3288176">//&nbsp;This&nbsp;simulates&nbsp;in&nbsp;a&nbsp;small&nbsp;amount&nbsp;of&nbsp;code&nbsp;the&nbsp;behavior&nbsp;of&nbsp;Go&#39;s&nbsp;ideal&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3288258">type</span>&nbsp;<span class="ident" id="3288263">NumberNode</span>&nbsp;<span class="keyword" id="3288274">struct</span>&nbsp;<span class="op" id="3288281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288284">NodeType</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288294">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288299">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3288310">*</span><span class="ident" id="3288311">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288317">IsInt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3288328">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3288339">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288373">IsUint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3288384">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3288395">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;unsigned&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288438">IsFloat</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3288449">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3288460">//&nbsp;Number&nbsp;has&nbsp;a&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288499">IsComplex</span>&nbsp;&nbsp;<span class="builtintype" id="3288510">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3288521">//&nbsp;Number&nbsp;is&nbsp;complex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288544">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3288555">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3288566">//&nbsp;The&nbsp;signed&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288596">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3288607">uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3288618">//&nbsp;The&nbsp;unsigned&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288650">Float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3288661">float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3288672">//&nbsp;The&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288702">Complex128</span>&nbsp;<span class="builtintype" id="3288713">complex128</span>&nbsp;<span class="comment" id="3288724">//&nbsp;The&nbsp;complex&nbsp;value.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288747">Text</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3288758">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3288769">//&nbsp;The&nbsp;original&nbsp;textual&nbsp;representation&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="op" id="3288824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3288827">func</span>&nbsp;<span class="op" id="3288832">(</span><span class="ident" id="3288833">t</span>&nbsp;<span class="op" id="3288835">*</span><span class="ident" id="3288836">Tree</span><span class="op" id="3288840">)</span>&nbsp;<span class="ident" id="3288842">newNumber</span><span class="op" id="3288851">(</span><span class="ident" id="3288852">pos</span>&nbsp;<span class="ident" id="3288856">Pos</span><span class="op" id="3288859">,</span>&nbsp;<span class="ident" id="3288861">text</span>&nbsp;<span class="builtintype" id="3288866">string</span><span class="op" id="3288872">,</span>&nbsp;<span class="ident" id="3288874">typ</span>&nbsp;<span class="ident" id="3288878">itemType</span><span class="op" id="3288886">)</span>&nbsp;<span class="op" id="3288888">(</span><span class="op" id="3288889">*</span><span class="ident" id="3288890">NumberNode</span><span class="op" id="3288900">,</span>&nbsp;<span class="builtintype" id="3288902">error</span><span class="op" id="3288907">)</span>&nbsp;<span class="op" id="3288909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288912">n</span>&nbsp;<span class="op" id="3288914">:=</span>&nbsp;<span class="op" id="3288917">&amp;</span><span class="ident" id="3288918">NumberNode</span><span class="op" id="3288928">{</span><span class="ident" id="3288929">tr</span><span class="op" id="3288931">:</span>&nbsp;<span class="ident" id="3288933">t</span><span class="op" id="3288934">,</span>&nbsp;<span class="ident" id="3288936">NodeType</span><span class="op" id="3288944">:</span>&nbsp;<span class="ident" id="3288946">NodeNumber</span><span class="op" id="3288956">,</span>&nbsp;<span class="ident" id="3288958">Pos</span><span class="op" id="3288961">:</span>&nbsp;<span class="ident" id="3288963">pos</span><span class="op" id="3288966">,</span>&nbsp;<span class="ident" id="3288968">Text</span><span class="op" id="3288972">:</span>&nbsp;<span class="ident" id="3288974">text</span><span class="op" id="3288978">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3288981">switch</span>&nbsp;<span class="ident" id="3288988">typ</span>&nbsp;<span class="op" id="3288992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3288995">case</span>&nbsp;<span class="ident" id="3289000">itemCharConstant</span><span class="op" id="3289016">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3289020">rune</span><span class="op" id="3289024">,</span>&nbsp;<span class="ident" id="3289026">_</span><span class="op" id="3289027">,</span>&nbsp;<span class="ident" id="3289029">tail</span><span class="op" id="3289033">,</span>&nbsp;<span class="ident" id="3289035">err</span>&nbsp;<span class="op" id="3289039">:=</span>&nbsp;<span class="ident" id="3289042">strconv</span><span class="op" id="3289049">.</span><span class="ident" id="3289050">UnquoteChar</span><span class="op" id="3289061">(</span><span class="ident" id="3289062">text</span><span class="op" id="3289066">[</span><span class="num" id="3289067">1</span><span class="op" id="3289068">:</span><span class="op" id="3289069">]</span><span class="op" id="3289070">,</span>&nbsp;<span class="ident" id="3289072">text</span><span class="op" id="3289076">[</span><span class="num" id="3289077">0</span><span class="op" id="3289078">]</span><span class="op" id="3289079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289083">if</span>&nbsp;<span class="ident" id="3289086">err</span>&nbsp;<span class="op" id="3289090">!=</span>&nbsp;<span class="ident" id="3289093">nil</span>&nbsp;<span class="op" id="3289097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289102">return</span>&nbsp;<span class="ident" id="3289109">nil</span><span class="op" id="3289112">,</span>&nbsp;<span class="ident" id="3289114">err</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3289120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289124">if</span>&nbsp;<span class="ident" id="3289127">tail</span>&nbsp;<span class="op" id="3289132">!=</span>&nbsp;<span class="string" id="3289135">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="3289139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289144">return</span>&nbsp;<span class="ident" id="3289151">nil</span><span class="op" id="3289154">,</span>&nbsp;<span class="ident" id="3289156">fmt</span><span class="op" id="3289159">.</span><span class="ident" id="3289160">Errorf</span><span class="op" id="3289166">(</span><span class="string" id="3289167">&#34;malformed&nbsp;character&nbsp;constant:&nbsp;%s&#34;</span><span class="op" id="3289201">,</span>&nbsp;<span class="ident" id="3289203">text</span><span class="op" id="3289207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3289211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289215">n</span><span class="op" id="3289216">.</span><span class="ident" id="3289217">Int64</span>&nbsp;<span class="op" id="3289223">=</span>&nbsp;<span class="ident" id="3289225">int64</span><span class="op" id="3289230">(</span><span class="builtintype" id="3289231">rune</span><span class="op" id="3289235">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289239">n</span><span class="op" id="3289240">.</span><span class="ident" id="3289241">IsInt</span>&nbsp;<span class="op" id="3289247">=</span>&nbsp;<span class="builtintype" id="3289249">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289256">n</span><span class="op" id="3289257">.</span><span class="ident" id="3289258">Uint64</span>&nbsp;<span class="op" id="3289265">=</span>&nbsp;<span class="ident" id="3289267">uint64</span><span class="op" id="3289273">(</span><span class="builtintype" id="3289274">rune</span><span class="op" id="3289278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289282">n</span><span class="op" id="3289283">.</span><span class="ident" id="3289284">IsUint</span>&nbsp;<span class="op" id="3289291">=</span>&nbsp;<span class="builtintype" id="3289293">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289300">n</span><span class="op" id="3289301">.</span><span class="ident" id="3289302">Float64</span>&nbsp;<span class="op" id="3289310">=</span>&nbsp;<span class="builtintype" id="3289312">float64</span><span class="op" id="3289319">(</span><span class="builtintype" id="3289320">rune</span><span class="op" id="3289324">)</span>&nbsp;<span class="comment" id="3289326">//&nbsp;odd&nbsp;but&nbsp;those&nbsp;are&nbsp;the&nbsp;rules.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289360">n</span><span class="op" id="3289361">.</span><span class="ident" id="3289362">IsFloat</span>&nbsp;<span class="op" id="3289370">=</span>&nbsp;<span class="builtintype" id="3289372">true</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289379">return</span>&nbsp;<span class="ident" id="3289386">n</span><span class="op" id="3289387">,</span>&nbsp;<span class="ident" id="3289389">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289394">case</span>&nbsp;<span class="ident" id="3289399">itemComplex</span><span class="op" id="3289410">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3289414">//&nbsp;fmt.Sscan&nbsp;can&nbsp;parse&nbsp;the&nbsp;pair,&nbsp;so&nbsp;let&nbsp;it&nbsp;do&nbsp;the&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289472">if</span>&nbsp;<span class="ident" id="3289475">_</span><span class="op" id="3289476">,</span>&nbsp;<span class="ident" id="3289478">err</span>&nbsp;<span class="op" id="3289482">:=</span>&nbsp;<span class="ident" id="3289485">fmt</span><span class="op" id="3289488">.</span><span class="ident" id="3289489">Sscan</span><span class="op" id="3289494">(</span><span class="ident" id="3289495">text</span><span class="op" id="3289499">,</span>&nbsp;<span class="op" id="3289501">&amp;</span><span class="ident" id="3289502">n</span><span class="op" id="3289503">.</span><span class="ident" id="3289504">Complex128</span><span class="op" id="3289514">)</span><span class="op" id="3289515">;</span>&nbsp;<span class="ident" id="3289517">err</span>&nbsp;<span class="op" id="3289521">!=</span>&nbsp;<span class="ident" id="3289524">nil</span>&nbsp;<span class="op" id="3289528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289533">return</span>&nbsp;<span class="ident" id="3289540">nil</span><span class="op" id="3289543">,</span>&nbsp;<span class="ident" id="3289545">err</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3289551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289555">n</span><span class="op" id="3289556">.</span><span class="ident" id="3289557">IsComplex</span>&nbsp;<span class="op" id="3289567">=</span>&nbsp;<span class="builtintype" id="3289569">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289576">n</span><span class="op" id="3289577">.</span><span class="ident" id="3289578">simplifyComplex</span><span class="op" id="3289593">(</span><span class="op" id="3289594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289598">return</span>&nbsp;<span class="ident" id="3289605">n</span><span class="op" id="3289606">,</span>&nbsp;<span class="ident" id="3289608">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3289613">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3289616">//&nbsp;Imaginary&nbsp;constants&nbsp;can&nbsp;only&nbsp;be&nbsp;complex&nbsp;unless&nbsp;they&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289682">if</span>&nbsp;<span class="builtinfunc" id="3289685">len</span><span class="op" id="3289688">(</span><span class="ident" id="3289689">text</span><span class="op" id="3289693">)</span>&nbsp;<span class="op" id="3289695">&gt;</span>&nbsp;<span class="num" id="3289697">0</span>&nbsp;<span class="op" id="3289699">&amp;&amp;</span>&nbsp;<span class="ident" id="3289702">text</span><span class="op" id="3289706">[</span><span class="builtinfunc" id="3289707">len</span><span class="op" id="3289710">(</span><span class="ident" id="3289711">text</span><span class="op" id="3289715">)</span><span class="op" id="3289716">-</span><span class="num" id="3289717">1</span><span class="op" id="3289718">]</span>&nbsp;<span class="op" id="3289720">==</span>&nbsp;<span class="string" id="3289723">&#39;i&#39;</span>&nbsp;<span class="op" id="3289727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289731">f</span><span class="op" id="3289732">,</span>&nbsp;<span class="ident" id="3289734">err</span>&nbsp;<span class="op" id="3289738">:=</span>&nbsp;<span class="ident" id="3289741">strconv</span><span class="op" id="3289748">.</span><span class="ident" id="3289749">ParseFloat</span><span class="op" id="3289759">(</span><span class="ident" id="3289760">text</span><span class="op" id="3289764">[</span><span class="op" id="3289765">:</span><span class="builtinfunc" id="3289766">len</span><span class="op" id="3289769">(</span><span class="ident" id="3289770">text</span><span class="op" id="3289774">)</span><span class="op" id="3289775">-</span><span class="num" id="3289776">1</span><span class="op" id="3289777">]</span><span class="op" id="3289778">,</span>&nbsp;<span class="num" id="3289780">64</span><span class="op" id="3289782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289786">if</span>&nbsp;<span class="ident" id="3289789">err</span>&nbsp;<span class="op" id="3289793">==</span>&nbsp;<span class="ident" id="3289796">nil</span>&nbsp;<span class="op" id="3289800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289805">n</span><span class="op" id="3289806">.</span><span class="ident" id="3289807">IsComplex</span>&nbsp;<span class="op" id="3289817">=</span>&nbsp;<span class="builtintype" id="3289819">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289827">n</span><span class="op" id="3289828">.</span><span class="ident" id="3289829">Complex128</span>&nbsp;<span class="op" id="3289840">=</span>&nbsp;<span class="builtinfunc" id="3289842">complex</span><span class="op" id="3289849">(</span><span class="num" id="3289850">0</span><span class="op" id="3289851">,</span>&nbsp;<span class="ident" id="3289853">f</span><span class="op" id="3289854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289859">n</span><span class="op" id="3289860">.</span><span class="ident" id="3289861">simplifyComplex</span><span class="op" id="3289876">(</span><span class="op" id="3289877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289882">return</span>&nbsp;<span class="ident" id="3289889">n</span><span class="op" id="3289890">,</span>&nbsp;<span class="ident" id="3289892">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3289898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3289901">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3289904">//&nbsp;Do&nbsp;integer&nbsp;test&nbsp;first&nbsp;so&nbsp;we&nbsp;get&nbsp;0x123&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289951">u</span><span class="op" id="3289952">,</span>&nbsp;<span class="ident" id="3289954">err</span>&nbsp;<span class="op" id="3289958">:=</span>&nbsp;<span class="ident" id="3289961">strconv</span><span class="op" id="3289968">.</span><span class="ident" id="3289969">ParseUint</span><span class="op" id="3289978">(</span><span class="ident" id="3289979">text</span><span class="op" id="3289983">,</span>&nbsp;<span class="num" id="3289985">0</span><span class="op" id="3289986">,</span>&nbsp;<span class="num" id="3289988">64</span><span class="op" id="3289990">)</span>&nbsp;<span class="comment" id="3289992">//&nbsp;will&nbsp;fail&nbsp;for&nbsp;-0;&nbsp;fixed&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3290027">if</span>&nbsp;<span class="ident" id="3290030">err</span>&nbsp;<span class="op" id="3290034">==</span>&nbsp;<span class="ident" id="3290037">nil</span>&nbsp;<span class="op" id="3290041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290045">n</span><span class="op" id="3290046">.</span><span class="ident" id="3290047">IsUint</span>&nbsp;<span class="op" id="3290054">=</span>&nbsp;<span class="builtintype" id="3290056">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290063">n</span><span class="op" id="3290064">.</span><span class="ident" id="3290065">Uint64</span>&nbsp;<span class="op" id="3290072">=</span>&nbsp;<span class="ident" id="3290074">u</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3290077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290080">i</span><span class="op" id="3290081">,</span>&nbsp;<span class="ident" id="3290083">err</span>&nbsp;<span class="op" id="3290087">:=</span>&nbsp;<span class="ident" id="3290090">strconv</span><span class="op" id="3290097">.</span><span class="ident" id="3290098">ParseInt</span><span class="op" id="3290106">(</span><span class="ident" id="3290107">text</span><span class="op" id="3290111">,</span>&nbsp;<span class="num" id="3290113">0</span><span class="op" id="3290114">,</span>&nbsp;<span class="num" id="3290116">64</span><span class="op" id="3290118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3290121">if</span>&nbsp;<span class="ident" id="3290124">err</span>&nbsp;<span class="op" id="3290128">==</span>&nbsp;<span class="ident" id="3290131">nil</span>&nbsp;<span class="op" id="3290135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290139">n</span><span class="op" id="3290140">.</span><span class="ident" id="3290141">IsInt</span>&nbsp;<span class="op" id="3290147">=</span>&nbsp;<span class="builtintype" id="3290149">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290156">n</span><span class="op" id="3290157">.</span><span class="ident" id="3290158">Int64</span>&nbsp;<span class="op" id="3290164">=</span>&nbsp;<span class="ident" id="3290166">i</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3290170">if</span>&nbsp;<span class="ident" id="3290173">i</span>&nbsp;<span class="op" id="3290175">==</span>&nbsp;<span class="num" id="3290178">0</span>&nbsp;<span class="op" id="3290180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290185">n</span><span class="op" id="3290186">.</span><span class="ident" id="3290187">IsUint</span>&nbsp;<span class="op" id="3290194">=</span>&nbsp;<span class="builtintype" id="3290196">true</span>&nbsp;<span class="comment" id="3290201">//&nbsp;in&nbsp;case&nbsp;of&nbsp;-0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290222">n</span><span class="op" id="3290223">.</span><span class="ident" id="3290224">Uint64</span>&nbsp;<span class="op" id="3290231">=</span>&nbsp;<span class="ident" id="3290233">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3290237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3290240">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3290243">//&nbsp;If&nbsp;an&nbsp;integer&nbsp;extraction&nbsp;succeeded,&nbsp;promote&nbsp;the&nbsp;float.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3290302">if</span>&nbsp;<span class="ident" id="3290305">n</span><span class="op" id="3290306">.</span><span class="ident" id="3290307">IsInt</span>&nbsp;<span class="op" id="3290313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290317">n</span><span class="op" id="3290318">.</span><span class="ident" id="3290319">IsFloat</span>&nbsp;<span class="op" id="3290327">=</span>&nbsp;<span class="builtintype" id="3290329">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290336">n</span><span class="op" id="3290337">.</span><span class="ident" id="3290338">Float64</span>&nbsp;<span class="op" id="3290346">=</span>&nbsp;<span class="builtintype" id="3290348">float64</span><span class="op" id="3290355">(</span><span class="ident" id="3290356">n</span><span class="op" id="3290357">.</span><span class="ident" id="3290358">Int64</span><span class="op" id="3290363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3290366">}</span>&nbsp;<span class="keyword" id="3290368">else</span>&nbsp;<span class="keyword" id="3290373">if</span>&nbsp;<span class="ident" id="3290376">n</span><span class="op" id="3290377">.</span><span class="ident" id="3290378">IsUint</span>&nbsp;<span class="op" id="3290385">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290389">n</span><span class="op" id="3290390">.</span><span class="ident" id="3290391">IsFloat</span>&nbsp;<span class="op" id="3290399">=</span>&nbsp;<span class="builtintype" id="3290401">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290408">n</span><span class="op" id="3290409">.</span><span class="ident" id="3290410">Float64</span>&nbsp;<span class="op" id="3290418">=</span>&nbsp;<span class="builtintype" id="3290420">float64</span><span class="op" id="3290427">(</span><span class="ident" id="3290428">n</span><span class="op" id="3290429">.</span><span class="ident" id="3290430">Uint64</span><span class="op" id="3290436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3290439">}</span>&nbsp;<span class="keyword" id="3290441">else</span>&nbsp;<span class="op" id="3290446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290450">f</span><span class="op" id="3290451">,</span>&nbsp;<span class="ident" id="3290453">err</span>&nbsp;<span class="op" id="3290457">:=</span>&nbsp;<span class="ident" id="3290460">strconv</span><span class="op" id="3290467">.</span><span class="ident" id="3290468">ParseFloat</span><span class="op" id="3290478">(</span><span class="ident" id="3290479">text</span><span class="op" id="3290483">,</span>&nbsp;<span class="num" id="3290485">64</span><span class="op" id="3290487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3290491">if</span>&nbsp;<span class="ident" id="3290494">err</span>&nbsp;<span class="op" id="3290498">==</span>&nbsp;<span class="ident" id="3290501">nil</span>&nbsp;<span class="op" id="3290505">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290510">n</span><span class="op" id="3290511">.</span><span class="ident" id="3290512">IsFloat</span>&nbsp;<span class="op" id="3290520">=</span>&nbsp;<span class="builtintype" id="3290522">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290530">n</span><span class="op" id="3290531">.</span><span class="ident" id="3290532">Float64</span>&nbsp;<span class="op" id="3290540">=</span>&nbsp;<span class="ident" id="3290542">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3290547">//&nbsp;If&nbsp;a&nbsp;floating-point&nbsp;extraction&nbsp;succeeded,&nbsp;extract&nbsp;the&nbsp;int&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3290622">if</span>&nbsp;<span class="op" id="3290625">!</span><span class="ident" id="3290626">n</span><span class="op" id="3290627">.</span><span class="ident" id="3290628">IsInt</span>&nbsp;<span class="op" id="3290634">&amp;&amp;</span>&nbsp;<span class="builtintype" id="3290637">float64</span><span class="op" id="3290644">(</span><span class="ident" id="3290645">int64</span><span class="op" id="3290650">(</span><span class="ident" id="3290651">f</span><span class="op" id="3290652">)</span><span class="op" id="3290653">)</span>&nbsp;<span class="op" id="3290655">==</span>&nbsp;<span class="ident" id="3290658">f</span>&nbsp;<span class="op" id="3290660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290666">n</span><span class="op" id="3290667">.</span><span class="ident" id="3290668">IsInt</span>&nbsp;<span class="op" id="3290674">=</span>&nbsp;<span class="builtintype" id="3290676">true</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290685">n</span><span class="op" id="3290686">.</span><span class="ident" id="3290687">Int64</span>&nbsp;<span class="op" id="3290693">=</span>&nbsp;<span class="ident" id="3290695">int64</span><span class="op" id="3290700">(</span><span class="ident" id="3290701">f</span><span class="op" id="3290702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3290707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3290712">if</span>&nbsp;<span class="op" id="3290715">!</span><span class="ident" id="3290716">n</span><span class="op" id="3290717">.</span><span class="ident" id="3290718">IsUint</span>&nbsp;<span class="op" id="3290725">&amp;&amp;</span>&nbsp;<span class="builtintype" id="3290728">float64</span><span class="op" id="3290735">(</span><span class="ident" id="3290736">uint64</span><span class="op" id="3290742">(</span><span class="ident" id="3290743">f</span><span class="op" id="3290744">)</span><span class="op" id="3290745">)</span>&nbsp;<span class="op" id="3290747">==</span>&nbsp;<span class="ident" id="3290750">f</span>&nbsp;<span class="op" id="3290752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290758">n</span><span class="op" id="3290759">.</span><span class="ident" id="3290760">IsUint</span>&nbsp;<span class="op" id="3290767">=</span>&nbsp;<span class="builtintype" id="3290769">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290778">n</span><span class="op" id="3290779">.</span><span class="ident" id="3290780">Uint64</span>&nbsp;<span class="op" id="3290787">=</span>&nbsp;<span class="ident" id="3290789">uint64</span><span class="op" id="3290795">(</span><span class="ident" id="3290796">f</span><span class="op" id="3290797">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3290802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3290806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3290809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3290812">if</span>&nbsp;<span class="op" id="3290815">!</span><span class="ident" id="3290816">n</span><span class="op" id="3290817">.</span><span class="ident" id="3290818">IsInt</span>&nbsp;<span class="op" id="3290824">&amp;&amp;</span>&nbsp;<span class="op" id="3290827">!</span><span class="ident" id="3290828">n</span><span class="op" id="3290829">.</span><span class="ident" id="3290830">IsUint</span>&nbsp;<span class="op" id="3290837">&amp;&amp;</span>&nbsp;<span class="op" id="3290840">!</span><span class="ident" id="3290841">n</span><span class="op" id="3290842">.</span><span class="ident" id="3290843">IsFloat</span>&nbsp;<span class="op" id="3290851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3290855">return</span>&nbsp;<span class="ident" id="3290862">nil</span><span class="op" id="3290865">,</span>&nbsp;<span class="ident" id="3290867">fmt</span><span class="op" id="3290870">.</span><span class="ident" id="3290871">Errorf</span><span class="op" id="3290877">(</span><span class="string" id="3290878">&#34;illegal&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="3290905">,</span>&nbsp;<span class="ident" id="3290907">text</span><span class="op" id="3290911">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3290914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3290917">return</span>&nbsp;<span class="ident" id="3290924">n</span><span class="op" id="3290925">,</span>&nbsp;<span class="ident" id="3290927">nil</span><br>
<span class="lineno"></span><span class="op" id="3290931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3290934">//&nbsp;simplifyComplex&nbsp;pulls&nbsp;out&nbsp;any&nbsp;other&nbsp;types&nbsp;that&nbsp;are&nbsp;represented&nbsp;by&nbsp;the&nbsp;complex&nbsp;number.</span><br>
<span class="lineno">615</span><span class="comment" id="3291023">//&nbsp;These&nbsp;all&nbsp;require&nbsp;that&nbsp;the&nbsp;imaginary&nbsp;part&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span><span class="keyword" id="3291077">func</span>&nbsp;<span class="op" id="3291082">(</span><span class="ident" id="3291083">n</span>&nbsp;<span class="op" id="3291085">*</span><span class="ident" id="3291086">NumberNode</span><span class="op" id="3291096">)</span>&nbsp;<span class="ident" id="3291098">simplifyComplex</span><span class="op" id="3291113">(</span><span class="op" id="3291114">)</span>&nbsp;<span class="op" id="3291116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3291119">n</span><span class="op" id="3291120">.</span><span class="ident" id="3291121">IsFloat</span>&nbsp;<span class="op" id="3291129">=</span>&nbsp;<span class="builtinfunc" id="3291131">imag</span><span class="op" id="3291135">(</span><span class="ident" id="3291136">n</span><span class="op" id="3291137">.</span><span class="ident" id="3291138">Complex128</span><span class="op" id="3291148">)</span>&nbsp;<span class="op" id="3291150">==</span>&nbsp;<span class="num" id="3291153">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3291156">if</span>&nbsp;<span class="ident" id="3291159">n</span><span class="op" id="3291160">.</span><span class="ident" id="3291161">IsFloat</span>&nbsp;<span class="op" id="3291169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3291173">n</span><span class="op" id="3291174">.</span><span class="ident" id="3291175">Float64</span>&nbsp;<span class="op" id="3291183">=</span>&nbsp;<span class="builtinfunc" id="3291185">real</span><span class="op" id="3291189">(</span><span class="ident" id="3291190">n</span><span class="op" id="3291191">.</span><span class="ident" id="3291192">Complex128</span><span class="op" id="3291202">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3291206">n</span><span class="op" id="3291207">.</span><span class="ident" id="3291208">IsInt</span>&nbsp;<span class="op" id="3291214">=</span>&nbsp;<span class="builtintype" id="3291216">float64</span><span class="op" id="3291223">(</span><span class="ident" id="3291224">int64</span><span class="op" id="3291229">(</span><span class="ident" id="3291230">n</span><span class="op" id="3291231">.</span><span class="ident" id="3291232">Float64</span><span class="op" id="3291239">)</span><span class="op" id="3291240">)</span>&nbsp;<span class="op" id="3291242">==</span>&nbsp;<span class="ident" id="3291245">n</span><span class="op" id="3291246">.</span><span class="ident" id="3291247">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3291257">if</span>&nbsp;<span class="ident" id="3291260">n</span><span class="op" id="3291261">.</span><span class="ident" id="3291262">IsInt</span>&nbsp;<span class="op" id="3291268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3291273">n</span><span class="op" id="3291274">.</span><span class="ident" id="3291275">Int64</span>&nbsp;<span class="op" id="3291281">=</span>&nbsp;<span class="ident" id="3291283">int64</span><span class="op" id="3291288">(</span><span class="ident" id="3291289">n</span><span class="op" id="3291290">.</span><span class="ident" id="3291291">Float64</span><span class="op" id="3291298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3291302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3291306">n</span><span class="op" id="3291307">.</span><span class="ident" id="3291308">IsUint</span>&nbsp;<span class="op" id="3291315">=</span>&nbsp;<span class="builtintype" id="3291317">float64</span><span class="op" id="3291324">(</span><span class="ident" id="3291325">uint64</span><span class="op" id="3291331">(</span><span class="ident" id="3291332">n</span><span class="op" id="3291333">.</span><span class="ident" id="3291334">Float64</span><span class="op" id="3291341">)</span><span class="op" id="3291342">)</span>&nbsp;<span class="op" id="3291344">==</span>&nbsp;<span class="ident" id="3291347">n</span><span class="op" id="3291348">.</span><span class="ident" id="3291349">Float64</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3291359">if</span>&nbsp;<span class="ident" id="3291362">n</span><span class="op" id="3291363">.</span><span class="ident" id="3291364">IsUint</span>&nbsp;<span class="op" id="3291371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3291376">n</span><span class="op" id="3291377">.</span><span class="ident" id="3291378">Uint64</span>&nbsp;<span class="op" id="3291385">=</span>&nbsp;<span class="ident" id="3291387">uint64</span><span class="op" id="3291393">(</span><span class="ident" id="3291394">n</span><span class="op" id="3291395">.</span><span class="ident" id="3291396">Float64</span><span class="op" id="3291403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3291407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3291410">}</span><br>
<span class="lineno"></span><span class="op" id="3291412">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="3291415">func</span>&nbsp;<span class="op" id="3291420">(</span><span class="ident" id="3291421">n</span>&nbsp;<span class="op" id="3291423">*</span><span class="ident" id="3291424">NumberNode</span><span class="op" id="3291434">)</span>&nbsp;<span class="ident" id="3291436">String</span><span class="op" id="3291442">(</span><span class="op" id="3291443">)</span>&nbsp;<span class="builtintype" id="3291445">string</span>&nbsp;<span class="op" id="3291452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3291455">return</span>&nbsp;<span class="ident" id="3291462">n</span><span class="op" id="3291463">.</span><span class="ident" id="3291464">Text</span><br>
<span class="lineno"></span><span class="op" id="3291469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span><span class="keyword" id="3291472">func</span>&nbsp;<span class="op" id="3291477">(</span><span class="ident" id="3291478">n</span>&nbsp;<span class="op" id="3291480">*</span><span class="ident" id="3291481">NumberNode</span><span class="op" id="3291491">)</span>&nbsp;<span class="ident" id="3291493">tree</span><span class="op" id="3291497">(</span><span class="op" id="3291498">)</span>&nbsp;<span class="op" id="3291500">*</span><span class="ident" id="3291501">Tree</span>&nbsp;<span class="op" id="3291506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3291509">return</span>&nbsp;<span class="ident" id="3291516">n</span><span class="op" id="3291517">.</span><span class="ident" id="3291518">tr</span><br>
<span class="lineno"></span><span class="op" id="3291521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3291524">func</span>&nbsp;<span class="op" id="3291529">(</span><span class="ident" id="3291530">n</span>&nbsp;<span class="op" id="3291532">*</span><span class="ident" id="3291533">NumberNode</span><span class="op" id="3291543">)</span>&nbsp;<span class="ident" id="3291545">Copy</span><span class="op" id="3291549">(</span><span class="op" id="3291550">)</span>&nbsp;<span class="ident" id="3291552">Node</span>&nbsp;<span class="op" id="3291557">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3291560">nn</span>&nbsp;<span class="op" id="3291563">:=</span>&nbsp;<span class="builtinfunc" id="3291566">new</span><span class="op" id="3291569">(</span><span class="ident" id="3291570">NumberNode</span><span class="op" id="3291580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3291583">*</span><span class="ident" id="3291584">nn</span>&nbsp;<span class="op" id="3291587">=</span>&nbsp;<span class="op" id="3291589">*</span><span class="ident" id="3291590">n</span>&nbsp;<span class="comment" id="3291592">//&nbsp;Easy,&nbsp;fast,&nbsp;correct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3291617">return</span>&nbsp;<span class="ident" id="3291624">nn</span><br>
<span class="lineno"></span><span class="op" id="3291627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span><span class="comment" id="3291630">//&nbsp;StringNode&nbsp;holds&nbsp;a&nbsp;string&nbsp;constant.&nbsp;The&nbsp;value&nbsp;has&nbsp;been&nbsp;&#34;unquoted&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3291700">type</span>&nbsp;<span class="ident" id="3291705">StringNode</span>&nbsp;<span class="keyword" id="3291716">struct</span>&nbsp;<span class="op" id="3291723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3291726">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3291736">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3291741">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3291748">*</span><span class="ident" id="3291749">Tree</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3291755">Quoted</span>&nbsp;<span class="builtintype" id="3291762">string</span>&nbsp;<span class="comment" id="3291769">//&nbsp;The&nbsp;original&nbsp;text&nbsp;of&nbsp;the&nbsp;string,&nbsp;with&nbsp;quotes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3291819">Text</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3291826">string</span>&nbsp;<span class="comment" id="3291833">//&nbsp;The&nbsp;string,&nbsp;after&nbsp;quote&nbsp;processing.</span><br>
<span class="lineno"></span><span class="op" id="3291872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3291875">func</span>&nbsp;<span class="op" id="3291880">(</span><span class="ident" id="3291881">t</span>&nbsp;<span class="op" id="3291883">*</span><span class="ident" id="3291884">Tree</span><span class="op" id="3291888">)</span>&nbsp;<span class="ident" id="3291890">newString</span><span class="op" id="3291899">(</span><span class="ident" id="3291900">pos</span>&nbsp;<span class="ident" id="3291904">Pos</span><span class="op" id="3291907">,</span>&nbsp;<span class="ident" id="3291909">orig</span><span class="op" id="3291913">,</span>&nbsp;<span class="ident" id="3291915">text</span>&nbsp;<span class="builtintype" id="3291920">string</span><span class="op" id="3291926">)</span>&nbsp;<span class="op" id="3291928">*</span><span class="ident" id="3291929">StringNode</span>&nbsp;<span class="op" id="3291940">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3291943">return</span>&nbsp;<span class="op" id="3291950">&amp;</span><span class="ident" id="3291951">StringNode</span><span class="op" id="3291961">{</span><span class="ident" id="3291962">tr</span><span class="op" id="3291964">:</span>&nbsp;<span class="ident" id="3291966">t</span><span class="op" id="3291967">,</span>&nbsp;<span class="ident" id="3291969">NodeType</span><span class="op" id="3291977">:</span>&nbsp;<span class="ident" id="3291979">NodeString</span><span class="op" id="3291989">,</span>&nbsp;<span class="ident" id="3291991">Pos</span><span class="op" id="3291994">:</span>&nbsp;<span class="ident" id="3291996">pos</span><span class="op" id="3291999">,</span>&nbsp;<span class="ident" id="3292001">Quoted</span><span class="op" id="3292007">:</span>&nbsp;<span class="ident" id="3292009">orig</span><span class="op" id="3292013">,</span>&nbsp;<span class="ident" id="3292015">Text</span><span class="op" id="3292019">:</span>&nbsp;<span class="ident" id="3292021">text</span><span class="op" id="3292025">}</span><br>
<span class="lineno"></span><span class="op" id="3292027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3292030">func</span>&nbsp;<span class="op" id="3292035">(</span><span class="ident" id="3292036">s</span>&nbsp;<span class="op" id="3292038">*</span><span class="ident" id="3292039">StringNode</span><span class="op" id="3292049">)</span>&nbsp;<span class="ident" id="3292051">String</span><span class="op" id="3292057">(</span><span class="op" id="3292058">)</span>&nbsp;<span class="builtintype" id="3292060">string</span>&nbsp;<span class="op" id="3292067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292070">return</span>&nbsp;<span class="ident" id="3292077">s</span><span class="op" id="3292078">.</span><span class="ident" id="3292079">Quoted</span><br>
<span class="lineno">660</span><span class="op" id="3292086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3292089">func</span>&nbsp;<span class="op" id="3292094">(</span><span class="ident" id="3292095">s</span>&nbsp;<span class="op" id="3292097">*</span><span class="ident" id="3292098">StringNode</span><span class="op" id="3292108">)</span>&nbsp;<span class="ident" id="3292110">tree</span><span class="op" id="3292114">(</span><span class="op" id="3292115">)</span>&nbsp;<span class="op" id="3292117">*</span><span class="ident" id="3292118">Tree</span>&nbsp;<span class="op" id="3292123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292126">return</span>&nbsp;<span class="ident" id="3292133">s</span><span class="op" id="3292134">.</span><span class="ident" id="3292135">tr</span><br>
<span class="lineno"></span><span class="op" id="3292138">}</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span><span class="keyword" id="3292141">func</span>&nbsp;<span class="op" id="3292146">(</span><span class="ident" id="3292147">s</span>&nbsp;<span class="op" id="3292149">*</span><span class="ident" id="3292150">StringNode</span><span class="op" id="3292160">)</span>&nbsp;<span class="ident" id="3292162">Copy</span><span class="op" id="3292166">(</span><span class="op" id="3292167">)</span>&nbsp;<span class="ident" id="3292169">Node</span>&nbsp;<span class="op" id="3292174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292177">return</span>&nbsp;<span class="ident" id="3292184">s</span><span class="op" id="3292185">.</span><span class="ident" id="3292186">tr</span><span class="op" id="3292188">.</span><span class="ident" id="3292189">newString</span><span class="op" id="3292198">(</span><span class="ident" id="3292199">s</span><span class="op" id="3292200">.</span><span class="ident" id="3292201">Pos</span><span class="op" id="3292204">,</span>&nbsp;<span class="ident" id="3292206">s</span><span class="op" id="3292207">.</span><span class="ident" id="3292208">Quoted</span><span class="op" id="3292214">,</span>&nbsp;<span class="ident" id="3292216">s</span><span class="op" id="3292217">.</span><span class="ident" id="3292218">Text</span><span class="op" id="3292222">)</span><br>
<span class="lineno"></span><span class="op" id="3292224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="3292227">//&nbsp;endNode&nbsp;represents&nbsp;an&nbsp;{{end}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="comment" id="3292268">//&nbsp;It&nbsp;does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span><span class="keyword" id="3292315">type</span>&nbsp;<span class="ident" id="3292320">endNode</span>&nbsp;<span class="keyword" id="3292328">struct</span>&nbsp;<span class="op" id="3292335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3292338">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3292348">Pos</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3292353">tr</span>&nbsp;<span class="op" id="3292356">*</span><span class="ident" id="3292357">Tree</span><br>
<span class="lineno"></span><span class="op" id="3292362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3292365">func</span>&nbsp;<span class="op" id="3292370">(</span><span class="ident" id="3292371">t</span>&nbsp;<span class="op" id="3292373">*</span><span class="ident" id="3292374">Tree</span><span class="op" id="3292378">)</span>&nbsp;<span class="ident" id="3292380">newEnd</span><span class="op" id="3292386">(</span><span class="ident" id="3292387">pos</span>&nbsp;<span class="ident" id="3292391">Pos</span><span class="op" id="3292394">)</span>&nbsp;<span class="op" id="3292396">*</span><span class="ident" id="3292397">endNode</span>&nbsp;<span class="op" id="3292405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292408">return</span>&nbsp;<span class="op" id="3292415">&amp;</span><span class="ident" id="3292416">endNode</span><span class="op" id="3292423">{</span><span class="ident" id="3292424">tr</span><span class="op" id="3292426">:</span>&nbsp;<span class="ident" id="3292428">t</span><span class="op" id="3292429">,</span>&nbsp;<span class="ident" id="3292431">NodeType</span><span class="op" id="3292439">:</span>&nbsp;<span class="ident" id="3292441">nodeEnd</span><span class="op" id="3292448">,</span>&nbsp;<span class="ident" id="3292450">Pos</span><span class="op" id="3292453">:</span>&nbsp;<span class="ident" id="3292455">pos</span><span class="op" id="3292458">}</span><br>
<span class="lineno">680</span><span class="op" id="3292460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3292463">func</span>&nbsp;<span class="op" id="3292468">(</span><span class="ident" id="3292469">e</span>&nbsp;<span class="op" id="3292471">*</span><span class="ident" id="3292472">endNode</span><span class="op" id="3292479">)</span>&nbsp;<span class="ident" id="3292481">String</span><span class="op" id="3292487">(</span><span class="op" id="3292488">)</span>&nbsp;<span class="builtintype" id="3292490">string</span>&nbsp;<span class="op" id="3292497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292500">return</span>&nbsp;<span class="string" id="3292507">&#34;{{end}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="3292517">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="3292520">func</span>&nbsp;<span class="op" id="3292525">(</span><span class="ident" id="3292526">e</span>&nbsp;<span class="op" id="3292528">*</span><span class="ident" id="3292529">endNode</span><span class="op" id="3292536">)</span>&nbsp;<span class="ident" id="3292538">tree</span><span class="op" id="3292542">(</span><span class="op" id="3292543">)</span>&nbsp;<span class="op" id="3292545">*</span><span class="ident" id="3292546">Tree</span>&nbsp;<span class="op" id="3292551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292554">return</span>&nbsp;<span class="ident" id="3292561">e</span><span class="op" id="3292562">.</span><span class="ident" id="3292563">tr</span><br>
<span class="lineno"></span><span class="op" id="3292566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="3292569">func</span>&nbsp;<span class="op" id="3292574">(</span><span class="ident" id="3292575">e</span>&nbsp;<span class="op" id="3292577">*</span><span class="ident" id="3292578">endNode</span><span class="op" id="3292585">)</span>&nbsp;<span class="ident" id="3292587">Copy</span><span class="op" id="3292591">(</span><span class="op" id="3292592">)</span>&nbsp;<span class="ident" id="3292594">Node</span>&nbsp;<span class="op" id="3292599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292602">return</span>&nbsp;<span class="ident" id="3292609">e</span><span class="op" id="3292610">.</span><span class="ident" id="3292611">tr</span><span class="op" id="3292613">.</span><span class="ident" id="3292614">newEnd</span><span class="op" id="3292620">(</span><span class="ident" id="3292621">e</span><span class="op" id="3292622">.</span><span class="ident" id="3292623">Pos</span><span class="op" id="3292626">)</span><br>
<span class="lineno"></span><span class="op" id="3292628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3292631">//&nbsp;elseNode&nbsp;represents&nbsp;an&nbsp;{{else}}&nbsp;action.&nbsp;Does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;tree.</span><br>
<span class="lineno">695</span><span class="keyword" id="3292709">type</span>&nbsp;<span class="ident" id="3292714">elseNode</span>&nbsp;<span class="keyword" id="3292723">struct</span>&nbsp;<span class="op" id="3292730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3292733">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3292743">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3292748">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3292753">*</span><span class="ident" id="3292754">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3292760">Line</span>&nbsp;<span class="builtintype" id="3292765">int</span>&nbsp;<span class="comment" id="3292769">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno">700</span><span class="op" id="3292838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3292841">func</span>&nbsp;<span class="op" id="3292846">(</span><span class="ident" id="3292847">t</span>&nbsp;<span class="op" id="3292849">*</span><span class="ident" id="3292850">Tree</span><span class="op" id="3292854">)</span>&nbsp;<span class="ident" id="3292856">newElse</span><span class="op" id="3292863">(</span><span class="ident" id="3292864">pos</span>&nbsp;<span class="ident" id="3292868">Pos</span><span class="op" id="3292871">,</span>&nbsp;<span class="ident" id="3292873">line</span>&nbsp;<span class="builtintype" id="3292878">int</span><span class="op" id="3292881">)</span>&nbsp;<span class="op" id="3292883">*</span><span class="ident" id="3292884">elseNode</span>&nbsp;<span class="op" id="3292893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292896">return</span>&nbsp;<span class="op" id="3292903">&amp;</span><span class="ident" id="3292904">elseNode</span><span class="op" id="3292912">{</span><span class="ident" id="3292913">tr</span><span class="op" id="3292915">:</span>&nbsp;<span class="ident" id="3292917">t</span><span class="op" id="3292918">,</span>&nbsp;<span class="ident" id="3292920">NodeType</span><span class="op" id="3292928">:</span>&nbsp;<span class="ident" id="3292930">nodeElse</span><span class="op" id="3292938">,</span>&nbsp;<span class="ident" id="3292940">Pos</span><span class="op" id="3292943">:</span>&nbsp;<span class="ident" id="3292945">pos</span><span class="op" id="3292948">,</span>&nbsp;<span class="ident" id="3292950">Line</span><span class="op" id="3292954">:</span>&nbsp;<span class="ident" id="3292956">line</span><span class="op" id="3292960">}</span><br>
<span class="lineno"></span><span class="op" id="3292962">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="3292965">func</span>&nbsp;<span class="op" id="3292970">(</span><span class="ident" id="3292971">e</span>&nbsp;<span class="op" id="3292973">*</span><span class="ident" id="3292974">elseNode</span><span class="op" id="3292982">)</span>&nbsp;<span class="ident" id="3292984">Type</span><span class="op" id="3292988">(</span><span class="op" id="3292989">)</span>&nbsp;<span class="ident" id="3292991">NodeType</span>&nbsp;<span class="op" id="3293000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293003">return</span>&nbsp;<span class="ident" id="3293010">nodeElse</span><br>
<span class="lineno"></span><span class="op" id="3293019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="3293022">func</span>&nbsp;<span class="op" id="3293027">(</span><span class="ident" id="3293028">e</span>&nbsp;<span class="op" id="3293030">*</span><span class="ident" id="3293031">elseNode</span><span class="op" id="3293039">)</span>&nbsp;<span class="ident" id="3293041">String</span><span class="op" id="3293047">(</span><span class="op" id="3293048">)</span>&nbsp;<span class="builtintype" id="3293050">string</span>&nbsp;<span class="op" id="3293057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293060">return</span>&nbsp;<span class="string" id="3293067">&#34;{{else}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="3293078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3293081">func</span>&nbsp;<span class="op" id="3293086">(</span><span class="ident" id="3293087">e</span>&nbsp;<span class="op" id="3293089">*</span><span class="ident" id="3293090">elseNode</span><span class="op" id="3293098">)</span>&nbsp;<span class="ident" id="3293100">tree</span><span class="op" id="3293104">(</span><span class="op" id="3293105">)</span>&nbsp;<span class="op" id="3293107">*</span><span class="ident" id="3293108">Tree</span>&nbsp;<span class="op" id="3293113">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293116">return</span>&nbsp;<span class="ident" id="3293123">e</span><span class="op" id="3293124">.</span><span class="ident" id="3293125">tr</span><br>
<span class="lineno"></span><span class="op" id="3293128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3293131">func</span>&nbsp;<span class="op" id="3293136">(</span><span class="ident" id="3293137">e</span>&nbsp;<span class="op" id="3293139">*</span><span class="ident" id="3293140">elseNode</span><span class="op" id="3293148">)</span>&nbsp;<span class="ident" id="3293150">Copy</span><span class="op" id="3293154">(</span><span class="op" id="3293155">)</span>&nbsp;<span class="ident" id="3293157">Node</span>&nbsp;<span class="op" id="3293162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293165">return</span>&nbsp;<span class="ident" id="3293172">e</span><span class="op" id="3293173">.</span><span class="ident" id="3293174">tr</span><span class="op" id="3293176">.</span><span class="ident" id="3293177">newElse</span><span class="op" id="3293184">(</span><span class="ident" id="3293185">e</span><span class="op" id="3293186">.</span><span class="ident" id="3293187">Pos</span><span class="op" id="3293190">,</span>&nbsp;<span class="ident" id="3293192">e</span><span class="op" id="3293193">.</span><span class="ident" id="3293194">Line</span><span class="op" id="3293198">)</span><br>
<span class="lineno">720</span><span class="op" id="3293200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3293203">//&nbsp;BranchNode&nbsp;is&nbsp;the&nbsp;common&nbsp;representation&nbsp;of&nbsp;if,&nbsp;range,&nbsp;and&nbsp;with.</span><br>
<span class="lineno"></span><span class="keyword" id="3293270">type</span>&nbsp;<span class="ident" id="3293275">BranchNode</span>&nbsp;<span class="keyword" id="3293286">struct</span>&nbsp;<span class="op" id="3293293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3293296">NodeType</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3293306">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3293311">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3293320">*</span><span class="ident" id="3293321">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3293327">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3293336">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3293346">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3293416">Pipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3293425">*</span><span class="ident" id="3293426">PipeNode</span>&nbsp;<span class="comment" id="3293435">//&nbsp;The&nbsp;pipeline&nbsp;to&nbsp;be&nbsp;evaluated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3293469">List</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3293478">*</span><span class="ident" id="3293479">ListNode</span>&nbsp;<span class="comment" id="3293488">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;non-empty.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3293535">ElseList</span>&nbsp;<span class="op" id="3293544">*</span><span class="ident" id="3293545">ListNode</span>&nbsp;<span class="comment" id="3293554">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;empty&nbsp;(nil&nbsp;if&nbsp;absent).</span><br>
<span class="lineno"></span><span class="op" id="3293612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3293615">func</span>&nbsp;<span class="op" id="3293620">(</span><span class="ident" id="3293621">b</span>&nbsp;<span class="op" id="3293623">*</span><span class="ident" id="3293624">BranchNode</span><span class="op" id="3293634">)</span>&nbsp;<span class="ident" id="3293636">String</span><span class="op" id="3293642">(</span><span class="op" id="3293643">)</span>&nbsp;<span class="builtintype" id="3293645">string</span>&nbsp;<span class="op" id="3293652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3293655">name</span>&nbsp;<span class="op" id="3293660">:=</span>&nbsp;<span class="string" id="3293663">&#34;&#34;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293667">switch</span>&nbsp;<span class="ident" id="3293674">b</span><span class="op" id="3293675">.</span><span class="ident" id="3293676">NodeType</span>&nbsp;<span class="op" id="3293685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293688">case</span>&nbsp;<span class="ident" id="3293693">NodeIf</span><span class="op" id="3293699">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3293703">name</span>&nbsp;<span class="op" id="3293708">=</span>&nbsp;<span class="string" id="3293710">&#34;if&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293716">case</span>&nbsp;<span class="ident" id="3293721">NodeRange</span><span class="op" id="3293730">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3293734">name</span>&nbsp;<span class="op" id="3293739">=</span>&nbsp;<span class="string" id="3293741">&#34;range&#34;</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293750">case</span>&nbsp;<span class="ident" id="3293755">NodeWith</span><span class="op" id="3293763">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3293767">name</span>&nbsp;<span class="op" id="3293772">=</span>&nbsp;<span class="string" id="3293774">&#34;with&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293782">default</span><span class="op" id="3293789">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3293793">panic</span><span class="op" id="3293798">(</span><span class="string" id="3293799">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="3293820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3293823">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293826">if</span>&nbsp;<span class="ident" id="3293829">b</span><span class="op" id="3293830">.</span><span class="ident" id="3293831">ElseList</span>&nbsp;<span class="op" id="3293840">!=</span>&nbsp;<span class="ident" id="3293843">nil</span>&nbsp;<span class="op" id="3293847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293851">return</span>&nbsp;<span class="ident" id="3293858">fmt</span><span class="op" id="3293861">.</span><span class="ident" id="3293862">Sprintf</span><span class="op" id="3293869">(</span><span class="string" id="3293870">&#34;{{%s&nbsp;%s}}%s{{else}}%s{{end}}&#34;</span><span class="op" id="3293900">,</span>&nbsp;<span class="ident" id="3293902">name</span><span class="op" id="3293906">,</span>&nbsp;<span class="ident" id="3293908">b</span><span class="op" id="3293909">.</span><span class="ident" id="3293910">Pipe</span><span class="op" id="3293914">,</span>&nbsp;<span class="ident" id="3293916">b</span><span class="op" id="3293917">.</span><span class="ident" id="3293918">List</span><span class="op" id="3293922">,</span>&nbsp;<span class="ident" id="3293924">b</span><span class="op" id="3293925">.</span><span class="ident" id="3293926">ElseList</span><span class="op" id="3293934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3293937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293940">return</span>&nbsp;<span class="ident" id="3293947">fmt</span><span class="op" id="3293950">.</span><span class="ident" id="3293951">Sprintf</span><span class="op" id="3293958">(</span><span class="string" id="3293959">&#34;{{%s&nbsp;%s}}%s{{end}}&#34;</span><span class="op" id="3293979">,</span>&nbsp;<span class="ident" id="3293981">name</span><span class="op" id="3293985">,</span>&nbsp;<span class="ident" id="3293987">b</span><span class="op" id="3293988">.</span><span class="ident" id="3293989">Pipe</span><span class="op" id="3293993">,</span>&nbsp;<span class="ident" id="3293995">b</span><span class="op" id="3293996">.</span><span class="ident" id="3293997">List</span><span class="op" id="3294001">)</span><br>
<span class="lineno"></span><span class="op" id="3294003">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="keyword" id="3294006">func</span>&nbsp;<span class="op" id="3294011">(</span><span class="ident" id="3294012">b</span>&nbsp;<span class="op" id="3294014">*</span><span class="ident" id="3294015">BranchNode</span><span class="op" id="3294025">)</span>&nbsp;<span class="ident" id="3294027">tree</span><span class="op" id="3294031">(</span><span class="op" id="3294032">)</span>&nbsp;<span class="op" id="3294034">*</span><span class="ident" id="3294035">Tree</span>&nbsp;<span class="op" id="3294040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294043">return</span>&nbsp;<span class="ident" id="3294050">b</span><span class="op" id="3294051">.</span><span class="ident" id="3294052">tr</span><br>
<span class="lineno"></span><span class="op" id="3294055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span><span class="keyword" id="3294058">func</span>&nbsp;<span class="op" id="3294063">(</span><span class="ident" id="3294064">b</span>&nbsp;<span class="op" id="3294066">*</span><span class="ident" id="3294067">BranchNode</span><span class="op" id="3294077">)</span>&nbsp;<span class="ident" id="3294079">Copy</span><span class="op" id="3294083">(</span><span class="op" id="3294084">)</span>&nbsp;<span class="ident" id="3294086">Node</span>&nbsp;<span class="op" id="3294091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294094">switch</span>&nbsp;<span class="ident" id="3294101">b</span><span class="op" id="3294102">.</span><span class="ident" id="3294103">NodeType</span>&nbsp;<span class="op" id="3294112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294115">case</span>&nbsp;<span class="ident" id="3294120">NodeIf</span><span class="op" id="3294126">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294130">return</span>&nbsp;<span class="ident" id="3294137">b</span><span class="op" id="3294138">.</span><span class="ident" id="3294139">tr</span><span class="op" id="3294141">.</span><span class="ident" id="3294142">newIf</span><span class="op" id="3294147">(</span><span class="ident" id="3294148">b</span><span class="op" id="3294149">.</span><span class="ident" id="3294150">Pos</span><span class="op" id="3294153">,</span>&nbsp;<span class="ident" id="3294155">b</span><span class="op" id="3294156">.</span><span class="ident" id="3294157">Line</span><span class="op" id="3294161">,</span>&nbsp;<span class="ident" id="3294163">b</span><span class="op" id="3294164">.</span><span class="ident" id="3294165">Pipe</span><span class="op" id="3294169">,</span>&nbsp;<span class="ident" id="3294171">b</span><span class="op" id="3294172">.</span><span class="ident" id="3294173">List</span><span class="op" id="3294177">,</span>&nbsp;<span class="ident" id="3294179">b</span><span class="op" id="3294180">.</span><span class="ident" id="3294181">ElseList</span><span class="op" id="3294189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294192">case</span>&nbsp;<span class="ident" id="3294197">NodeRange</span><span class="op" id="3294206">:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294210">return</span>&nbsp;<span class="ident" id="3294217">b</span><span class="op" id="3294218">.</span><span class="ident" id="3294219">tr</span><span class="op" id="3294221">.</span><span class="ident" id="3294222">newRange</span><span class="op" id="3294230">(</span><span class="ident" id="3294231">b</span><span class="op" id="3294232">.</span><span class="ident" id="3294233">Pos</span><span class="op" id="3294236">,</span>&nbsp;<span class="ident" id="3294238">b</span><span class="op" id="3294239">.</span><span class="ident" id="3294240">Line</span><span class="op" id="3294244">,</span>&nbsp;<span class="ident" id="3294246">b</span><span class="op" id="3294247">.</span><span class="ident" id="3294248">Pipe</span><span class="op" id="3294252">,</span>&nbsp;<span class="ident" id="3294254">b</span><span class="op" id="3294255">.</span><span class="ident" id="3294256">List</span><span class="op" id="3294260">,</span>&nbsp;<span class="ident" id="3294262">b</span><span class="op" id="3294263">.</span><span class="ident" id="3294264">ElseList</span><span class="op" id="3294272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294275">case</span>&nbsp;<span class="ident" id="3294280">NodeWith</span><span class="op" id="3294288">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294292">return</span>&nbsp;<span class="ident" id="3294299">b</span><span class="op" id="3294300">.</span><span class="ident" id="3294301">tr</span><span class="op" id="3294303">.</span><span class="ident" id="3294304">newWith</span><span class="op" id="3294311">(</span><span class="ident" id="3294312">b</span><span class="op" id="3294313">.</span><span class="ident" id="3294314">Pos</span><span class="op" id="3294317">,</span>&nbsp;<span class="ident" id="3294319">b</span><span class="op" id="3294320">.</span><span class="ident" id="3294321">Line</span><span class="op" id="3294325">,</span>&nbsp;<span class="ident" id="3294327">b</span><span class="op" id="3294328">.</span><span class="ident" id="3294329">Pipe</span><span class="op" id="3294333">,</span>&nbsp;<span class="ident" id="3294335">b</span><span class="op" id="3294336">.</span><span class="ident" id="3294337">List</span><span class="op" id="3294341">,</span>&nbsp;<span class="ident" id="3294343">b</span><span class="op" id="3294344">.</span><span class="ident" id="3294345">ElseList</span><span class="op" id="3294353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294356">default</span><span class="op" id="3294363">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3294367">panic</span><span class="op" id="3294372">(</span><span class="string" id="3294373">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="3294394">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3294397">}</span><br>
<span class="lineno"></span><span class="op" id="3294399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3294402">//&nbsp;IfNode&nbsp;represents&nbsp;an&nbsp;{{if}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="3294458">type</span>&nbsp;<span class="ident" id="3294463">IfNode</span>&nbsp;<span class="keyword" id="3294470">struct</span>&nbsp;<span class="op" id="3294477">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3294480">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="3294491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3294494">func</span>&nbsp;<span class="op" id="3294499">(</span><span class="ident" id="3294500">t</span>&nbsp;<span class="op" id="3294502">*</span><span class="ident" id="3294503">Tree</span><span class="op" id="3294507">)</span>&nbsp;<span class="ident" id="3294509">newIf</span><span class="op" id="3294514">(</span><span class="ident" id="3294515">pos</span>&nbsp;<span class="ident" id="3294519">Pos</span><span class="op" id="3294522">,</span>&nbsp;<span class="ident" id="3294524">line</span>&nbsp;<span class="builtintype" id="3294529">int</span><span class="op" id="3294532">,</span>&nbsp;<span class="ident" id="3294534">pipe</span>&nbsp;<span class="op" id="3294539">*</span><span class="ident" id="3294540">PipeNode</span><span class="op" id="3294548">,</span>&nbsp;<span class="ident" id="3294550">list</span><span class="op" id="3294554">,</span>&nbsp;<span class="ident" id="3294556">elseList</span>&nbsp;<span class="op" id="3294565">*</span><span class="ident" id="3294566">ListNode</span><span class="op" id="3294574">)</span>&nbsp;<span class="op" id="3294576">*</span><span class="ident" id="3294577">IfNode</span>&nbsp;<span class="op" id="3294584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294587">return</span>&nbsp;<span class="op" id="3294594">&amp;</span><span class="ident" id="3294595">IfNode</span><span class="op" id="3294601">{</span><span class="ident" id="3294602">BranchNode</span><span class="op" id="3294612">{</span><span class="ident" id="3294613">tr</span><span class="op" id="3294615">:</span>&nbsp;<span class="ident" id="3294617">t</span><span class="op" id="3294618">,</span>&nbsp;<span class="ident" id="3294620">NodeType</span><span class="op" id="3294628">:</span>&nbsp;<span class="ident" id="3294630">NodeIf</span><span class="op" id="3294636">,</span>&nbsp;<span class="ident" id="3294638">Pos</span><span class="op" id="3294641">:</span>&nbsp;<span class="ident" id="3294643">pos</span><span class="op" id="3294646">,</span>&nbsp;<span class="ident" id="3294648">Line</span><span class="op" id="3294652">:</span>&nbsp;<span class="ident" id="3294654">line</span><span class="op" id="3294658">,</span>&nbsp;<span class="ident" id="3294660">Pipe</span><span class="op" id="3294664">:</span>&nbsp;<span class="ident" id="3294666">pipe</span><span class="op" id="3294670">,</span>&nbsp;<span class="ident" id="3294672">List</span><span class="op" id="3294676">:</span>&nbsp;<span class="ident" id="3294678">list</span><span class="op" id="3294682">,</span>&nbsp;<span class="ident" id="3294684">ElseList</span><span class="op" id="3294692">:</span>&nbsp;<span class="ident" id="3294694">elseList</span><span class="op" id="3294702">}</span><span class="op" id="3294703">}</span><br>
<span class="lineno">775</span><span class="op" id="3294705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3294708">func</span>&nbsp;<span class="op" id="3294713">(</span><span class="ident" id="3294714">i</span>&nbsp;<span class="op" id="3294716">*</span><span class="ident" id="3294717">IfNode</span><span class="op" id="3294723">)</span>&nbsp;<span class="ident" id="3294725">Copy</span><span class="op" id="3294729">(</span><span class="op" id="3294730">)</span>&nbsp;<span class="ident" id="3294732">Node</span>&nbsp;<span class="op" id="3294737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294740">return</span>&nbsp;<span class="ident" id="3294747">i</span><span class="op" id="3294748">.</span><span class="ident" id="3294749">tr</span><span class="op" id="3294751">.</span><span class="ident" id="3294752">newIf</span><span class="op" id="3294757">(</span><span class="ident" id="3294758">i</span><span class="op" id="3294759">.</span><span class="ident" id="3294760">Pos</span><span class="op" id="3294763">,</span>&nbsp;<span class="ident" id="3294765">i</span><span class="op" id="3294766">.</span><span class="ident" id="3294767">Line</span><span class="op" id="3294771">,</span>&nbsp;<span class="ident" id="3294773">i</span><span class="op" id="3294774">.</span><span class="ident" id="3294775">Pipe</span><span class="op" id="3294779">.</span><span class="ident" id="3294780">CopyPipe</span><span class="op" id="3294788">(</span><span class="op" id="3294789">)</span><span class="op" id="3294790">,</span>&nbsp;<span class="ident" id="3294792">i</span><span class="op" id="3294793">.</span><span class="ident" id="3294794">List</span><span class="op" id="3294798">.</span><span class="ident" id="3294799">CopyList</span><span class="op" id="3294807">(</span><span class="op" id="3294808">)</span><span class="op" id="3294809">,</span>&nbsp;<span class="ident" id="3294811">i</span><span class="op" id="3294812">.</span><span class="ident" id="3294813">ElseList</span><span class="op" id="3294821">.</span><span class="ident" id="3294822">CopyList</span><span class="op" id="3294830">(</span><span class="op" id="3294831">)</span><span class="op" id="3294832">)</span><br>
<span class="lineno"></span><span class="op" id="3294834">}</span><br>
<span class="lineno">780</span><br>
<span class="lineno"></span><span class="comment" id="3294837">//&nbsp;RangeNode&nbsp;represents&nbsp;a&nbsp;{{range}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="3294898">type</span>&nbsp;<span class="ident" id="3294903">RangeNode</span>&nbsp;<span class="keyword" id="3294913">struct</span>&nbsp;<span class="op" id="3294920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3294923">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="3294934">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="keyword" id="3294937">func</span>&nbsp;<span class="op" id="3294942">(</span><span class="ident" id="3294943">t</span>&nbsp;<span class="op" id="3294945">*</span><span class="ident" id="3294946">Tree</span><span class="op" id="3294950">)</span>&nbsp;<span class="ident" id="3294952">newRange</span><span class="op" id="3294960">(</span><span class="ident" id="3294961">pos</span>&nbsp;<span class="ident" id="3294965">Pos</span><span class="op" id="3294968">,</span>&nbsp;<span class="ident" id="3294970">line</span>&nbsp;<span class="builtintype" id="3294975">int</span><span class="op" id="3294978">,</span>&nbsp;<span class="ident" id="3294980">pipe</span>&nbsp;<span class="op" id="3294985">*</span><span class="ident" id="3294986">PipeNode</span><span class="op" id="3294994">,</span>&nbsp;<span class="ident" id="3294996">list</span><span class="op" id="3295000">,</span>&nbsp;<span class="ident" id="3295002">elseList</span>&nbsp;<span class="op" id="3295011">*</span><span class="ident" id="3295012">ListNode</span><span class="op" id="3295020">)</span>&nbsp;<span class="op" id="3295022">*</span><span class="ident" id="3295023">RangeNode</span>&nbsp;<span class="op" id="3295033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3295036">return</span>&nbsp;<span class="op" id="3295043">&amp;</span><span class="ident" id="3295044">RangeNode</span><span class="op" id="3295053">{</span><span class="ident" id="3295054">BranchNode</span><span class="op" id="3295064">{</span><span class="ident" id="3295065">tr</span><span class="op" id="3295067">:</span>&nbsp;<span class="ident" id="3295069">t</span><span class="op" id="3295070">,</span>&nbsp;<span class="ident" id="3295072">NodeType</span><span class="op" id="3295080">:</span>&nbsp;<span class="ident" id="3295082">NodeRange</span><span class="op" id="3295091">,</span>&nbsp;<span class="ident" id="3295093">Pos</span><span class="op" id="3295096">:</span>&nbsp;<span class="ident" id="3295098">pos</span><span class="op" id="3295101">,</span>&nbsp;<span class="ident" id="3295103">Line</span><span class="op" id="3295107">:</span>&nbsp;<span class="ident" id="3295109">line</span><span class="op" id="3295113">,</span>&nbsp;<span class="ident" id="3295115">Pipe</span><span class="op" id="3295119">:</span>&nbsp;<span class="ident" id="3295121">pipe</span><span class="op" id="3295125">,</span>&nbsp;<span class="ident" id="3295127">List</span><span class="op" id="3295131">:</span>&nbsp;<span class="ident" id="3295133">list</span><span class="op" id="3295137">,</span>&nbsp;<span class="ident" id="3295139">ElseList</span><span class="op" id="3295147">:</span>&nbsp;<span class="ident" id="3295149">elseList</span><span class="op" id="3295157">}</span><span class="op" id="3295158">}</span><br>
<span class="lineno"></span><span class="op" id="3295160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span><span class="keyword" id="3295163">func</span>&nbsp;<span class="op" id="3295168">(</span><span class="ident" id="3295169">r</span>&nbsp;<span class="op" id="3295171">*</span><span class="ident" id="3295172">RangeNode</span><span class="op" id="3295181">)</span>&nbsp;<span class="ident" id="3295183">Copy</span><span class="op" id="3295187">(</span><span class="op" id="3295188">)</span>&nbsp;<span class="ident" id="3295190">Node</span>&nbsp;<span class="op" id="3295195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3295198">return</span>&nbsp;<span class="ident" id="3295205">r</span><span class="op" id="3295206">.</span><span class="ident" id="3295207">tr</span><span class="op" id="3295209">.</span><span class="ident" id="3295210">newRange</span><span class="op" id="3295218">(</span><span class="ident" id="3295219">r</span><span class="op" id="3295220">.</span><span class="ident" id="3295221">Pos</span><span class="op" id="3295224">,</span>&nbsp;<span class="ident" id="3295226">r</span><span class="op" id="3295227">.</span><span class="ident" id="3295228">Line</span><span class="op" id="3295232">,</span>&nbsp;<span class="ident" id="3295234">r</span><span class="op" id="3295235">.</span><span class="ident" id="3295236">Pipe</span><span class="op" id="3295240">.</span><span class="ident" id="3295241">CopyPipe</span><span class="op" id="3295249">(</span><span class="op" id="3295250">)</span><span class="op" id="3295251">,</span>&nbsp;<span class="ident" id="3295253">r</span><span class="op" id="3295254">.</span><span class="ident" id="3295255">List</span><span class="op" id="3295259">.</span><span class="ident" id="3295260">CopyList</span><span class="op" id="3295268">(</span><span class="op" id="3295269">)</span><span class="op" id="3295270">,</span>&nbsp;<span class="ident" id="3295272">r</span><span class="op" id="3295273">.</span><span class="ident" id="3295274">ElseList</span><span class="op" id="3295282">.</span><span class="ident" id="3295283">CopyList</span><span class="op" id="3295291">(</span><span class="op" id="3295292">)</span><span class="op" id="3295293">)</span><br>
<span class="lineno"></span><span class="op" id="3295295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3295298">//&nbsp;WithNode&nbsp;represents&nbsp;a&nbsp;{{with}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno">795</span><span class="keyword" id="3295357">type</span>&nbsp;<span class="ident" id="3295362">WithNode</span>&nbsp;<span class="keyword" id="3295371">struct</span>&nbsp;<span class="op" id="3295378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295381">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="3295392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3295395">func</span>&nbsp;<span class="op" id="3295400">(</span><span class="ident" id="3295401">t</span>&nbsp;<span class="op" id="3295403">*</span><span class="ident" id="3295404">Tree</span><span class="op" id="3295408">)</span>&nbsp;<span class="ident" id="3295410">newWith</span><span class="op" id="3295417">(</span><span class="ident" id="3295418">pos</span>&nbsp;<span class="ident" id="3295422">Pos</span><span class="op" id="3295425">,</span>&nbsp;<span class="ident" id="3295427">line</span>&nbsp;<span class="builtintype" id="3295432">int</span><span class="op" id="3295435">,</span>&nbsp;<span class="ident" id="3295437">pipe</span>&nbsp;<span class="op" id="3295442">*</span><span class="ident" id="3295443">PipeNode</span><span class="op" id="3295451">,</span>&nbsp;<span class="ident" id="3295453">list</span><span class="op" id="3295457">,</span>&nbsp;<span class="ident" id="3295459">elseList</span>&nbsp;<span class="op" id="3295468">*</span><span class="ident" id="3295469">ListNode</span><span class="op" id="3295477">)</span>&nbsp;<span class="op" id="3295479">*</span><span class="ident" id="3295480">WithNode</span>&nbsp;<span class="op" id="3295489">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3295492">return</span>&nbsp;<span class="op" id="3295499">&amp;</span><span class="ident" id="3295500">WithNode</span><span class="op" id="3295508">{</span><span class="ident" id="3295509">BranchNode</span><span class="op" id="3295519">{</span><span class="ident" id="3295520">tr</span><span class="op" id="3295522">:</span>&nbsp;<span class="ident" id="3295524">t</span><span class="op" id="3295525">,</span>&nbsp;<span class="ident" id="3295527">NodeType</span><span class="op" id="3295535">:</span>&nbsp;<span class="ident" id="3295537">NodeWith</span><span class="op" id="3295545">,</span>&nbsp;<span class="ident" id="3295547">Pos</span><span class="op" id="3295550">:</span>&nbsp;<span class="ident" id="3295552">pos</span><span class="op" id="3295555">,</span>&nbsp;<span class="ident" id="3295557">Line</span><span class="op" id="3295561">:</span>&nbsp;<span class="ident" id="3295563">line</span><span class="op" id="3295567">,</span>&nbsp;<span class="ident" id="3295569">Pipe</span><span class="op" id="3295573">:</span>&nbsp;<span class="ident" id="3295575">pipe</span><span class="op" id="3295579">,</span>&nbsp;<span class="ident" id="3295581">List</span><span class="op" id="3295585">:</span>&nbsp;<span class="ident" id="3295587">list</span><span class="op" id="3295591">,</span>&nbsp;<span class="ident" id="3295593">ElseList</span><span class="op" id="3295601">:</span>&nbsp;<span class="ident" id="3295603">elseList</span><span class="op" id="3295611">}</span><span class="op" id="3295612">}</span><br>
<span class="lineno"></span><span class="op" id="3295614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3295617">func</span>&nbsp;<span class="op" id="3295622">(</span><span class="ident" id="3295623">w</span>&nbsp;<span class="op" id="3295625">*</span><span class="ident" id="3295626">WithNode</span><span class="op" id="3295634">)</span>&nbsp;<span class="ident" id="3295636">Copy</span><span class="op" id="3295640">(</span><span class="op" id="3295641">)</span>&nbsp;<span class="ident" id="3295643">Node</span>&nbsp;<span class="op" id="3295648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3295651">return</span>&nbsp;<span class="ident" id="3295658">w</span><span class="op" id="3295659">.</span><span class="ident" id="3295660">tr</span><span class="op" id="3295662">.</span><span class="ident" id="3295663">newWith</span><span class="op" id="3295670">(</span><span class="ident" id="3295671">w</span><span class="op" id="3295672">.</span><span class="ident" id="3295673">Pos</span><span class="op" id="3295676">,</span>&nbsp;<span class="ident" id="3295678">w</span><span class="op" id="3295679">.</span><span class="ident" id="3295680">Line</span><span class="op" id="3295684">,</span>&nbsp;<span class="ident" id="3295686">w</span><span class="op" id="3295687">.</span><span class="ident" id="3295688">Pipe</span><span class="op" id="3295692">.</span><span class="ident" id="3295693">CopyPipe</span><span class="op" id="3295701">(</span><span class="op" id="3295702">)</span><span class="op" id="3295703">,</span>&nbsp;<span class="ident" id="3295705">w</span><span class="op" id="3295706">.</span><span class="ident" id="3295707">List</span><span class="op" id="3295711">.</span><span class="ident" id="3295712">CopyList</span><span class="op" id="3295720">(</span><span class="op" id="3295721">)</span><span class="op" id="3295722">,</span>&nbsp;<span class="ident" id="3295724">w</span><span class="op" id="3295725">.</span><span class="ident" id="3295726">ElseList</span><span class="op" id="3295734">.</span><span class="ident" id="3295735">CopyList</span><span class="op" id="3295743">(</span><span class="op" id="3295744">)</span><span class="op" id="3295745">)</span><br>
<span class="lineno">805</span><span class="op" id="3295747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3295750">//&nbsp;TemplateNode&nbsp;represents&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="3295800">type</span>&nbsp;<span class="ident" id="3295805">TemplateNode</span>&nbsp;<span class="keyword" id="3295818">struct</span>&nbsp;<span class="op" id="3295825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295828">NodeType</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295838">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295843">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3295848">*</span><span class="ident" id="3295849">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295855">Line</span>&nbsp;<span class="builtintype" id="3295860">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3295870">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295940">Name</span>&nbsp;<span class="builtintype" id="3295945">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3295955">//&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;template&nbsp;(unquoted).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295996">Pipe</span>&nbsp;<span class="op" id="3296001">*</span><span class="ident" id="3296002">PipeNode</span>&nbsp;<span class="comment" id="3296011">//&nbsp;The&nbsp;command&nbsp;to&nbsp;evaluate&nbsp;as&nbsp;dot&nbsp;for&nbsp;the&nbsp;template.</span><br>
<span class="lineno">815</span><span class="op" id="3296063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3296066">func</span>&nbsp;<span class="op" id="3296071">(</span><span class="ident" id="3296072">t</span>&nbsp;<span class="op" id="3296074">*</span><span class="ident" id="3296075">Tree</span><span class="op" id="3296079">)</span>&nbsp;<span class="ident" id="3296081">newTemplate</span><span class="op" id="3296092">(</span><span class="ident" id="3296093">pos</span>&nbsp;<span class="ident" id="3296097">Pos</span><span class="op" id="3296100">,</span>&nbsp;<span class="ident" id="3296102">line</span>&nbsp;<span class="builtintype" id="3296107">int</span><span class="op" id="3296110">,</span>&nbsp;<span class="ident" id="3296112">name</span>&nbsp;<span class="builtintype" id="3296117">string</span><span class="op" id="3296123">,</span>&nbsp;<span class="ident" id="3296125">pipe</span>&nbsp;<span class="op" id="3296130">*</span><span class="ident" id="3296131">PipeNode</span><span class="op" id="3296139">)</span>&nbsp;<span class="op" id="3296141">*</span><span class="ident" id="3296142">TemplateNode</span>&nbsp;<span class="op" id="3296155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3296158">return</span>&nbsp;<span class="op" id="3296165">&amp;</span><span class="ident" id="3296166">TemplateNode</span><span class="op" id="3296178">{</span><span class="ident" id="3296179">tr</span><span class="op" id="3296181">:</span>&nbsp;<span class="ident" id="3296183">t</span><span class="op" id="3296184">,</span>&nbsp;<span class="ident" id="3296186">NodeType</span><span class="op" id="3296194">:</span>&nbsp;<span class="ident" id="3296196">NodeTemplate</span><span class="op" id="3296208">,</span>&nbsp;<span class="ident" id="3296210">Pos</span><span class="op" id="3296213">:</span>&nbsp;<span class="ident" id="3296215">pos</span><span class="op" id="3296218">,</span>&nbsp;<span class="ident" id="3296220">Line</span><span class="op" id="3296224">:</span>&nbsp;<span class="ident" id="3296226">line</span><span class="op" id="3296230">,</span>&nbsp;<span class="ident" id="3296232">Name</span><span class="op" id="3296236">:</span>&nbsp;<span class="ident" id="3296238">name</span><span class="op" id="3296242">,</span>&nbsp;<span class="ident" id="3296244">Pipe</span><span class="op" id="3296248">:</span>&nbsp;<span class="ident" id="3296250">pipe</span><span class="op" id="3296254">}</span><br>
<span class="lineno"></span><span class="op" id="3296256">}</span><br>
<span class="lineno">820</span><br>
<span class="lineno"></span><span class="keyword" id="3296259">func</span>&nbsp;<span class="op" id="3296264">(</span><span class="ident" id="3296265">t</span>&nbsp;<span class="op" id="3296267">*</span><span class="ident" id="3296268">TemplateNode</span><span class="op" id="3296280">)</span>&nbsp;<span class="ident" id="3296282">String</span><span class="op" id="3296288">(</span><span class="op" id="3296289">)</span>&nbsp;<span class="builtintype" id="3296291">string</span>&nbsp;<span class="op" id="3296298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3296301">if</span>&nbsp;<span class="ident" id="3296304">t</span><span class="op" id="3296305">.</span><span class="ident" id="3296306">Pipe</span>&nbsp;<span class="op" id="3296311">==</span>&nbsp;<span class="ident" id="3296314">nil</span>&nbsp;<span class="op" id="3296318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3296322">return</span>&nbsp;<span class="ident" id="3296329">fmt</span><span class="op" id="3296332">.</span><span class="ident" id="3296333">Sprintf</span><span class="op" id="3296340">(</span><span class="string" id="3296341">&#34;{{template&nbsp;%q}}&#34;</span><span class="op" id="3296358">,</span>&nbsp;<span class="ident" id="3296360">t</span><span class="op" id="3296361">.</span><span class="ident" id="3296362">Name</span><span class="op" id="3296366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3296369">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3296372">return</span>&nbsp;<span class="ident" id="3296379">fmt</span><span class="op" id="3296382">.</span><span class="ident" id="3296383">Sprintf</span><span class="op" id="3296390">(</span><span class="string" id="3296391">&#34;{{template&nbsp;%q&nbsp;%s}}&#34;</span><span class="op" id="3296411">,</span>&nbsp;<span class="ident" id="3296413">t</span><span class="op" id="3296414">.</span><span class="ident" id="3296415">Name</span><span class="op" id="3296419">,</span>&nbsp;<span class="ident" id="3296421">t</span><span class="op" id="3296422">.</span><span class="ident" id="3296423">Pipe</span><span class="op" id="3296427">)</span><br>
<span class="lineno"></span><span class="op" id="3296429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3296432">func</span>&nbsp;<span class="op" id="3296437">(</span><span class="ident" id="3296438">t</span>&nbsp;<span class="op" id="3296440">*</span><span class="ident" id="3296441">TemplateNode</span><span class="op" id="3296453">)</span>&nbsp;<span class="ident" id="3296455">tree</span><span class="op" id="3296459">(</span><span class="op" id="3296460">)</span>&nbsp;<span class="op" id="3296462">*</span><span class="ident" id="3296463">Tree</span>&nbsp;<span class="op" id="3296468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3296471">return</span>&nbsp;<span class="ident" id="3296478">t</span><span class="op" id="3296479">.</span><span class="ident" id="3296480">tr</span><br>
<span class="lineno">830</span><span class="op" id="3296483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3296486">func</span>&nbsp;<span class="op" id="3296491">(</span><span class="ident" id="3296492">t</span>&nbsp;<span class="op" id="3296494">*</span><span class="ident" id="3296495">TemplateNode</span><span class="op" id="3296507">)</span>&nbsp;<span class="ident" id="3296509">Copy</span><span class="op" id="3296513">(</span><span class="op" id="3296514">)</span>&nbsp;<span class="ident" id="3296516">Node</span>&nbsp;<span class="op" id="3296521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3296524">return</span>&nbsp;<span class="ident" id="3296531">t</span><span class="op" id="3296532">.</span><span class="ident" id="3296533">tr</span><span class="op" id="3296535">.</span><span class="ident" id="3296536">newTemplate</span><span class="op" id="3296547">(</span><span class="ident" id="3296548">t</span><span class="op" id="3296549">.</span><span class="ident" id="3296550">Pos</span><span class="op" id="3296553">,</span>&nbsp;<span class="ident" id="3296555">t</span><span class="op" id="3296556">.</span><span class="ident" id="3296557">Line</span><span class="op" id="3296561">,</span>&nbsp;<span class="ident" id="3296563">t</span><span class="op" id="3296564">.</span><span class="ident" id="3296565">Name</span><span class="op" id="3296569">,</span>&nbsp;<span class="ident" id="3296571">t</span><span class="op" id="3296572">.</span><span class="ident" id="3296573">Pipe</span><span class="op" id="3296577">.</span><span class="ident" id="3296578">CopyPipe</span><span class="op" id="3296586">(</span><span class="op" id="3296587">)</span><span class="op" id="3296588">)</span><br>
<span class="lineno"></span><span class="op" id="3296590">}</span>
</div>
</body>
</html>
