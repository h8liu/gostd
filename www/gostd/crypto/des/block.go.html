<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4281678">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4281733">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4281787">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4281838">package</span>&nbsp;<span class="ident" id="4281846">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4281851">import</span>&nbsp;<span class="op" id="4281858">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4281861">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span><span class="op" id="4281879">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4281882">func</span>&nbsp;<span class="ident" id="4281887">cryptBlock</span><span class="op" id="4281897">(</span><span class="ident" id="4281898">subkeys</span>&nbsp;<span class="op" id="4281906">[</span><span class="op" id="4281907">]</span><span class="ident" id="4281908">uint64</span><span class="op" id="4281914">,</span>&nbsp;<span class="ident" id="4281916">dst</span><span class="op" id="4281919">,</span>&nbsp;<span class="ident" id="4281921">src</span>&nbsp;<span class="op" id="4281925">[</span><span class="op" id="4281926">]</span><span class="builtintype" id="4281927">byte</span><span class="op" id="4281931">,</span>&nbsp;<span class="ident" id="4281933">decrypt</span>&nbsp;<span class="builtintype" id="4281941">bool</span><span class="op" id="4281945">)</span>&nbsp;<span class="op" id="4281947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281950">b</span>&nbsp;<span class="op" id="4281952">:=</span>&nbsp;<span class="ident" id="4281955">binary</span><span class="op" id="4281961">.</span><span class="ident" id="4281962">BigEndian</span><span class="op" id="4281971">.</span><span class="ident" id="4281972">Uint64</span><span class="op" id="4281978">(</span><span class="ident" id="4281979">src</span><span class="op" id="4281982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281985">b</span>&nbsp;<span class="op" id="4281987">=</span>&nbsp;<span class="ident" id="4281989">permuteInitialBlock</span><span class="op" id="4282008">(</span><span class="ident" id="4282009">b</span><span class="op" id="4282010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282013">left</span><span class="op" id="4282017">,</span>&nbsp;<span class="ident" id="4282019">right</span>&nbsp;<span class="op" id="4282025">:=</span>&nbsp;<span class="builtintype" id="4282028">uint32</span><span class="op" id="4282034">(</span><span class="ident" id="4282035">b</span><span class="op" id="4282036">&gt;&gt;</span><span class="num" id="4282038">32</span><span class="op" id="4282040">)</span><span class="op" id="4282041">,</span>&nbsp;<span class="builtintype" id="4282043">uint32</span><span class="op" id="4282049">(</span><span class="ident" id="4282050">b</span><span class="op" id="4282051">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282055">var</span>&nbsp;<span class="ident" id="4282059">subkey</span>&nbsp;<span class="ident" id="4282066">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282074">for</span>&nbsp;<span class="ident" id="4282078">i</span>&nbsp;<span class="op" id="4282080">:=</span>&nbsp;<span class="num" id="4282083">0</span><span class="op" id="4282084">;</span>&nbsp;<span class="ident" id="4282086">i</span>&nbsp;<span class="op" id="4282088">&lt;</span>&nbsp;<span class="num" id="4282090">16</span><span class="op" id="4282092">;</span>&nbsp;<span class="ident" id="4282094">i</span><span class="op" id="4282095">++</span>&nbsp;<span class="op" id="4282098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282102">if</span>&nbsp;<span class="ident" id="4282105">decrypt</span>&nbsp;<span class="op" id="4282113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282118">subkey</span>&nbsp;<span class="op" id="4282125">=</span>&nbsp;<span class="ident" id="4282127">subkeys</span><span class="op" id="4282134">[</span><span class="num" id="4282135">15</span><span class="op" id="4282137">-</span><span class="ident" id="4282138">i</span><span class="op" id="4282139">]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4282143">}</span>&nbsp;<span class="keyword" id="4282145">else</span>&nbsp;<span class="op" id="4282150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282155">subkey</span>&nbsp;<span class="op" id="4282162">=</span>&nbsp;<span class="ident" id="4282164">subkeys</span><span class="op" id="4282171">[</span><span class="ident" id="4282172">i</span><span class="op" id="4282173">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4282177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282182">left</span><span class="op" id="4282186">,</span>&nbsp;<span class="ident" id="4282188">right</span>&nbsp;<span class="op" id="4282194">=</span>&nbsp;<span class="ident" id="4282196">right</span><span class="op" id="4282201">,</span>&nbsp;<span class="ident" id="4282203">left</span><span class="op" id="4282207">^</span><span class="ident" id="4282208">feistel</span><span class="op" id="4282215">(</span><span class="ident" id="4282216">right</span><span class="op" id="4282221">,</span>&nbsp;<span class="ident" id="4282223">subkey</span><span class="op" id="4282229">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4282232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4282235">//&nbsp;switch&nbsp;left&nbsp;&amp;&nbsp;right&nbsp;and&nbsp;perform&nbsp;final&nbsp;permutation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282289">preOutput</span>&nbsp;<span class="op" id="4282299">:=</span>&nbsp;<span class="op" id="4282302">(</span><span class="ident" id="4282303">uint64</span><span class="op" id="4282309">(</span><span class="ident" id="4282310">right</span><span class="op" id="4282315">)</span>&nbsp;<span class="op" id="4282317">&lt;&lt;</span>&nbsp;<span class="num" id="4282320">32</span><span class="op" id="4282322">)</span>&nbsp;<span class="op" id="4282324">|</span>&nbsp;<span class="ident" id="4282326">uint64</span><span class="op" id="4282332">(</span><span class="ident" id="4282333">left</span><span class="op" id="4282337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282340">binary</span><span class="op" id="4282346">.</span><span class="ident" id="4282347">BigEndian</span><span class="op" id="4282356">.</span><span class="ident" id="4282357">PutUint64</span><span class="op" id="4282366">(</span><span class="ident" id="4282367">dst</span><span class="op" id="4282370">,</span>&nbsp;<span class="ident" id="4282372">permuteFinalBlock</span><span class="op" id="4282389">(</span><span class="ident" id="4282390">preOutput</span><span class="op" id="4282399">)</span><span class="op" id="4282400">)</span><br>
<span class="lineno"></span><span class="op" id="4282402">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4282405">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="4282464">func</span>&nbsp;<span class="ident" id="4282469">encryptBlock</span><span class="op" id="4282481">(</span><span class="ident" id="4282482">subkeys</span>&nbsp;<span class="op" id="4282490">[</span><span class="op" id="4282491">]</span><span class="ident" id="4282492">uint64</span><span class="op" id="4282498">,</span>&nbsp;<span class="ident" id="4282500">dst</span><span class="op" id="4282503">,</span>&nbsp;<span class="ident" id="4282505">src</span>&nbsp;<span class="op" id="4282509">[</span><span class="op" id="4282510">]</span><span class="builtintype" id="4282511">byte</span><span class="op" id="4282515">)</span>&nbsp;<span class="op" id="4282517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282520">cryptBlock</span><span class="op" id="4282530">(</span><span class="ident" id="4282531">subkeys</span><span class="op" id="4282538">,</span>&nbsp;<span class="ident" id="4282540">dst</span><span class="op" id="4282543">,</span>&nbsp;<span class="ident" id="4282545">src</span><span class="op" id="4282548">,</span>&nbsp;<span class="builtintype" id="4282550">false</span><span class="op" id="4282555">)</span><br>
<span class="lineno"></span><span class="op" id="4282557">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4282560">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="4282619">func</span>&nbsp;<span class="ident" id="4282624">decryptBlock</span><span class="op" id="4282636">(</span><span class="ident" id="4282637">subkeys</span>&nbsp;<span class="op" id="4282645">[</span><span class="op" id="4282646">]</span><span class="ident" id="4282647">uint64</span><span class="op" id="4282653">,</span>&nbsp;<span class="ident" id="4282655">dst</span><span class="op" id="4282658">,</span>&nbsp;<span class="ident" id="4282660">src</span>&nbsp;<span class="op" id="4282664">[</span><span class="op" id="4282665">]</span><span class="builtintype" id="4282666">byte</span><span class="op" id="4282670">)</span>&nbsp;<span class="op" id="4282672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282675">cryptBlock</span><span class="op" id="4282685">(</span><span class="ident" id="4282686">subkeys</span><span class="op" id="4282693">,</span>&nbsp;<span class="ident" id="4282695">dst</span><span class="op" id="4282698">,</span>&nbsp;<span class="ident" id="4282700">src</span><span class="op" id="4282703">,</span>&nbsp;<span class="builtintype" id="4282705">true</span><span class="op" id="4282709">)</span><br>
<span class="lineno"></span><span class="op" id="4282711">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4282714">//&nbsp;DES&nbsp;Feistel&nbsp;function</span><br>
<span class="lineno"></span><span class="keyword" id="4282738">func</span>&nbsp;<span class="ident" id="4282743">feistel</span><span class="op" id="4282750">(</span><span class="ident" id="4282751">right</span>&nbsp;<span class="builtintype" id="4282757">uint32</span><span class="op" id="4282763">,</span>&nbsp;<span class="ident" id="4282765">key</span>&nbsp;<span class="ident" id="4282769">uint64</span><span class="op" id="4282775">)</span>&nbsp;<span class="op" id="4282777">(</span><span class="ident" id="4282778">result</span>&nbsp;<span class="builtintype" id="4282785">uint32</span><span class="op" id="4282791">)</span>&nbsp;<span class="op" id="4282793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282796">sBoxLocations</span>&nbsp;<span class="op" id="4282810">:=</span>&nbsp;<span class="ident" id="4282813">key</span>&nbsp;<span class="op" id="4282817">^</span>&nbsp;<span class="ident" id="4282819">expandBlock</span><span class="op" id="4282830">(</span><span class="ident" id="4282831">right</span><span class="op" id="4282836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282839">var</span>&nbsp;<span class="ident" id="4282843">sBoxResult</span>&nbsp;<span class="builtintype" id="4282854">uint32</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282862">for</span>&nbsp;<span class="ident" id="4282866">i</span>&nbsp;<span class="op" id="4282868">:=</span>&nbsp;<span class="builtintype" id="4282871">uint8</span><span class="op" id="4282876">(</span><span class="num" id="4282877">0</span><span class="op" id="4282878">)</span><span class="op" id="4282879">;</span>&nbsp;<span class="ident" id="4282881">i</span>&nbsp;<span class="op" id="4282883">&lt;</span>&nbsp;<span class="num" id="4282885">8</span><span class="op" id="4282886">;</span>&nbsp;<span class="ident" id="4282888">i</span><span class="op" id="4282889">++</span>&nbsp;<span class="op" id="4282892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282896">sBoxLocation</span>&nbsp;<span class="op" id="4282909">:=</span>&nbsp;<span class="builtintype" id="4282912">uint8</span><span class="op" id="4282917">(</span><span class="ident" id="4282918">sBoxLocations</span><span class="op" id="4282931">&gt;&gt;</span><span class="num" id="4282933">42</span><span class="op" id="4282935">)</span>&nbsp;<span class="op" id="4282937">&amp;</span>&nbsp;<span class="num" id="4282939">0x3f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282946">sBoxLocations</span>&nbsp;<span class="op" id="4282960">&lt;&lt;=</span>&nbsp;<span class="num" id="4282964">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4282968">//&nbsp;row&nbsp;determined&nbsp;by&nbsp;1st&nbsp;and&nbsp;6th&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283007">//&nbsp;column&nbsp;is&nbsp;middle&nbsp;four&nbsp;bits</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283039">row</span>&nbsp;<span class="op" id="4283043">:=</span>&nbsp;<span class="op" id="4283046">(</span><span class="ident" id="4283047">sBoxLocation</span>&nbsp;<span class="op" id="4283060">&amp;</span>&nbsp;<span class="num" id="4283062">0x1</span><span class="op" id="4283065">)</span>&nbsp;<span class="op" id="4283067">|</span>&nbsp;<span class="op" id="4283069">(</span><span class="op" id="4283070">(</span><span class="ident" id="4283071">sBoxLocation</span>&nbsp;<span class="op" id="4283084">&amp;</span>&nbsp;<span class="num" id="4283086">0x20</span><span class="op" id="4283090">)</span>&nbsp;<span class="op" id="4283092">&gt;&gt;</span>&nbsp;<span class="num" id="4283095">4</span><span class="op" id="4283096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283100">column</span>&nbsp;<span class="op" id="4283107">:=</span>&nbsp;<span class="op" id="4283110">(</span><span class="ident" id="4283111">sBoxLocation</span>&nbsp;<span class="op" id="4283124">&gt;&gt;</span>&nbsp;<span class="num" id="4283127">1</span><span class="op" id="4283128">)</span>&nbsp;<span class="op" id="4283130">&amp;</span>&nbsp;<span class="num" id="4283132">0xf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283138">sBoxResult</span>&nbsp;<span class="op" id="4283149">^=</span>&nbsp;<span class="ident" id="4283152">feistelBox</span><span class="op" id="4283162">[</span><span class="ident" id="4283163">i</span><span class="op" id="4283164">]</span><span class="op" id="4283165">[</span><span class="num" id="4283166">16</span><span class="op" id="4283168">*</span><span class="ident" id="4283169">row</span><span class="op" id="4283172">+</span><span class="ident" id="4283173">column</span><span class="op" id="4283179">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4283182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283185">return</span>&nbsp;<span class="ident" id="4283192">sBoxResult</span><br>
<span class="lineno">55</span><span class="op" id="4283203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4283206">//&nbsp;feistelBox[s][16*i+j]&nbsp;contains&nbsp;the&nbsp;output&nbsp;of&nbsp;permutationFunction</span><br>
<span class="lineno"></span><span class="comment" id="4283274">//&nbsp;for&nbsp;sBoxes[s][i][j]&nbsp;&lt;&lt;&nbsp;4*(7-s)</span><br>
<span class="lineno"></span><span class="keyword" id="4283308">var</span>&nbsp;<span class="ident" id="4283312">feistelBox</span>&nbsp;<span class="op" id="4283323">[</span><span class="num" id="4283324">8</span><span class="op" id="4283325">]</span><span class="op" id="4283326">[</span><span class="num" id="4283327">64</span><span class="op" id="4283329">]</span><span class="builtintype" id="4283330">uint32</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="4283338">//&nbsp;general&nbsp;purpose&nbsp;function&nbsp;to&nbsp;perform&nbsp;DES&nbsp;block&nbsp;permutations</span><br>
<span class="lineno"></span><span class="keyword" id="4283400">func</span>&nbsp;<span class="ident" id="4283405">permuteBlock</span><span class="op" id="4283417">(</span><span class="ident" id="4283418">src</span>&nbsp;<span class="ident" id="4283422">uint64</span><span class="op" id="4283428">,</span>&nbsp;<span class="ident" id="4283430">permutation</span>&nbsp;<span class="op" id="4283442">[</span><span class="op" id="4283443">]</span><span class="builtintype" id="4283444">uint8</span><span class="op" id="4283449">)</span>&nbsp;<span class="op" id="4283451">(</span><span class="ident" id="4283452">block</span>&nbsp;<span class="ident" id="4283458">uint64</span><span class="op" id="4283464">)</span>&nbsp;<span class="op" id="4283466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283469">for</span>&nbsp;<span class="ident" id="4283473">position</span><span class="op" id="4283481">,</span>&nbsp;<span class="ident" id="4283483">n</span>&nbsp;<span class="op" id="4283485">:=</span>&nbsp;<span class="keyword" id="4283488">range</span>&nbsp;<span class="ident" id="4283494">permutation</span>&nbsp;<span class="op" id="4283506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283510">bit</span>&nbsp;<span class="op" id="4283514">:=</span>&nbsp;<span class="op" id="4283517">(</span><span class="ident" id="4283518">src</span>&nbsp;<span class="op" id="4283522">&gt;&gt;</span>&nbsp;<span class="ident" id="4283525">n</span><span class="op" id="4283526">)</span>&nbsp;<span class="op" id="4283528">&amp;</span>&nbsp;<span class="num" id="4283530">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283534">block</span>&nbsp;<span class="op" id="4283540">|=</span>&nbsp;<span class="ident" id="4283543">bit</span>&nbsp;<span class="op" id="4283547">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4283550">uint</span><span class="op" id="4283554">(</span><span class="op" id="4283555">(</span><span class="builtinfunc" id="4283556">len</span><span class="op" id="4283559">(</span><span class="ident" id="4283560">permutation</span><span class="op" id="4283571">)</span><span class="op" id="4283572">-</span><span class="num" id="4283573">1</span><span class="op" id="4283574">)</span><span class="op" id="4283575">-</span><span class="ident" id="4283576">position</span><span class="op" id="4283584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4283587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283590">return</span><br>
<span class="lineno"></span><span class="op" id="4283597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="4283600">func</span>&nbsp;<span class="ident" id="4283605">init</span><span class="op" id="4283609">(</span><span class="op" id="4283610">)</span>&nbsp;<span class="op" id="4283612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283615">for</span>&nbsp;<span class="ident" id="4283619">s</span>&nbsp;<span class="op" id="4283621">:=</span>&nbsp;<span class="keyword" id="4283624">range</span>&nbsp;<span class="ident" id="4283630">sBoxes</span>&nbsp;<span class="op" id="4283637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283641">for</span>&nbsp;<span class="ident" id="4283645">i</span>&nbsp;<span class="op" id="4283647">:=</span>&nbsp;<span class="num" id="4283650">0</span><span class="op" id="4283651">;</span>&nbsp;<span class="ident" id="4283653">i</span>&nbsp;<span class="op" id="4283655">&lt;</span>&nbsp;<span class="num" id="4283657">4</span><span class="op" id="4283658">;</span>&nbsp;<span class="ident" id="4283660">i</span><span class="op" id="4283661">++</span>&nbsp;<span class="op" id="4283664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283669">for</span>&nbsp;<span class="ident" id="4283673">j</span>&nbsp;<span class="op" id="4283675">:=</span>&nbsp;<span class="num" id="4283678">0</span><span class="op" id="4283679">;</span>&nbsp;<span class="ident" id="4283681">j</span>&nbsp;<span class="op" id="4283683">&lt;</span>&nbsp;<span class="num" id="4283685">16</span><span class="op" id="4283687">;</span>&nbsp;<span class="ident" id="4283689">j</span><span class="op" id="4283690">++</span>&nbsp;<span class="op" id="4283693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283699">f</span>&nbsp;<span class="op" id="4283701">:=</span>&nbsp;<span class="ident" id="4283704">uint64</span><span class="op" id="4283710">(</span><span class="ident" id="4283711">sBoxes</span><span class="op" id="4283717">[</span><span class="ident" id="4283718">s</span><span class="op" id="4283719">]</span><span class="op" id="4283720">[</span><span class="ident" id="4283721">i</span><span class="op" id="4283722">]</span><span class="op" id="4283723">[</span><span class="ident" id="4283724">j</span><span class="op" id="4283725">]</span><span class="op" id="4283726">)</span>&nbsp;<span class="op" id="4283728">&lt;&lt;</span>&nbsp;<span class="op" id="4283731">(</span><span class="num" id="4283732">4</span>&nbsp;<span class="op" id="4283734">*</span>&nbsp;<span class="op" id="4283736">(</span><span class="num" id="4283737">7</span>&nbsp;<span class="op" id="4283739">-</span>&nbsp;<span class="builtintype" id="4283741">uint</span><span class="op" id="4283745">(</span><span class="ident" id="4283746">s</span><span class="op" id="4283747">)</span><span class="op" id="4283748">)</span><span class="op" id="4283749">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283755">f</span>&nbsp;<span class="op" id="4283757">=</span>&nbsp;<span class="ident" id="4283759">permuteBlock</span><span class="op" id="4283771">(</span><span class="ident" id="4283772">uint64</span><span class="op" id="4283778">(</span><span class="ident" id="4283779">f</span><span class="op" id="4283780">)</span><span class="op" id="4283781">,</span>&nbsp;<span class="ident" id="4283783">permutationFunction</span><span class="op" id="4283802">[</span><span class="op" id="4283803">:</span><span class="op" id="4283804">]</span><span class="op" id="4283805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283811">feistelBox</span><span class="op" id="4283821">[</span><span class="ident" id="4283822">s</span><span class="op" id="4283823">]</span><span class="op" id="4283824">[</span><span class="num" id="4283825">16</span><span class="op" id="4283827">*</span><span class="ident" id="4283828">i</span><span class="op" id="4283829">+</span><span class="ident" id="4283830">j</span><span class="op" id="4283831">]</span>&nbsp;<span class="op" id="4283833">=</span>&nbsp;<span class="builtintype" id="4283835">uint32</span><span class="op" id="4283841">(</span><span class="ident" id="4283842">f</span><span class="op" id="4283843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4283848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4283852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4283855">}</span><br>
<span class="lineno">80</span><span class="op" id="4283857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4283860">//&nbsp;expandBlock&nbsp;expands&nbsp;an&nbsp;input&nbsp;block&nbsp;of&nbsp;32&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="4283910">//&nbsp;producing&nbsp;an&nbsp;output&nbsp;block&nbsp;of&nbsp;48&nbsp;bits.</span><br>
<span class="lineno"></span><span class="keyword" id="4283951">func</span>&nbsp;<span class="ident" id="4283956">expandBlock</span><span class="op" id="4283967">(</span><span class="ident" id="4283968">src</span>&nbsp;<span class="builtintype" id="4283972">uint32</span><span class="op" id="4283978">)</span>&nbsp;<span class="op" id="4283980">(</span><span class="ident" id="4283981">block</span>&nbsp;<span class="ident" id="4283987">uint64</span><span class="op" id="4283993">)</span>&nbsp;<span class="op" id="4283995">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283998">//&nbsp;rotate&nbsp;the&nbsp;5&nbsp;highest&nbsp;bits&nbsp;to&nbsp;the&nbsp;right.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284042">src</span>&nbsp;<span class="op" id="4284046">=</span>&nbsp;<span class="op" id="4284048">(</span><span class="ident" id="4284049">src</span>&nbsp;<span class="op" id="4284053">&lt;&lt;</span>&nbsp;<span class="num" id="4284056">5</span><span class="op" id="4284057">)</span>&nbsp;<span class="op" id="4284059">|</span>&nbsp;<span class="op" id="4284061">(</span><span class="ident" id="4284062">src</span>&nbsp;<span class="op" id="4284066">&gt;&gt;</span>&nbsp;<span class="num" id="4284069">27</span><span class="op" id="4284071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4284074">for</span>&nbsp;<span class="ident" id="4284078">i</span>&nbsp;<span class="op" id="4284080">:=</span>&nbsp;<span class="num" id="4284083">0</span><span class="op" id="4284084">;</span>&nbsp;<span class="ident" id="4284086">i</span>&nbsp;<span class="op" id="4284088">&lt;</span>&nbsp;<span class="num" id="4284090">8</span><span class="op" id="4284091">;</span>&nbsp;<span class="ident" id="4284093">i</span><span class="op" id="4284094">++</span>&nbsp;<span class="op" id="4284097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284101">block</span>&nbsp;<span class="op" id="4284107">&lt;&lt;=</span>&nbsp;<span class="num" id="4284111">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284115">//&nbsp;take&nbsp;the&nbsp;6&nbsp;bits&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284149">block</span>&nbsp;<span class="op" id="4284155">|=</span>&nbsp;<span class="ident" id="4284158">uint64</span><span class="op" id="4284164">(</span><span class="ident" id="4284165">src</span><span class="op" id="4284168">)</span>&nbsp;<span class="op" id="4284170">&amp;</span>&nbsp;<span class="op" id="4284172">(</span><span class="num" id="4284173">1</span><span class="op" id="4284174">&lt;&lt;</span><span class="num" id="4284176">6</span>&nbsp;<span class="op" id="4284178">-</span>&nbsp;<span class="num" id="4284180">1</span><span class="op" id="4284181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284185">//&nbsp;advance&nbsp;by&nbsp;4&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284209">src</span>&nbsp;<span class="op" id="4284213">=</span>&nbsp;<span class="op" id="4284215">(</span><span class="ident" id="4284216">src</span>&nbsp;<span class="op" id="4284220">&lt;&lt;</span>&nbsp;<span class="num" id="4284223">4</span><span class="op" id="4284224">)</span>&nbsp;<span class="op" id="4284226">|</span>&nbsp;<span class="op" id="4284228">(</span><span class="ident" id="4284229">src</span>&nbsp;<span class="op" id="4284233">&gt;&gt;</span>&nbsp;<span class="num" id="4284236">28</span><span class="op" id="4284238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4284241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4284244">return</span><br>
<span class="lineno">95</span><span class="op" id="4284251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4284254">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4284318">//&nbsp;by&nbsp;initialPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="4284344">func</span>&nbsp;<span class="ident" id="4284349">permuteInitialBlock</span><span class="op" id="4284368">(</span><span class="ident" id="4284369">block</span>&nbsp;<span class="ident" id="4284375">uint64</span><span class="op" id="4284381">)</span>&nbsp;<span class="ident" id="4284383">uint64</span>&nbsp;<span class="op" id="4284390">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284393">//&nbsp;block&nbsp;=&nbsp;b7&nbsp;b6&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b1&nbsp;b0&nbsp;(8&nbsp;bytes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284439">b1</span>&nbsp;<span class="op" id="4284442">:=</span>&nbsp;<span class="ident" id="4284445">block</span>&nbsp;<span class="op" id="4284451">&gt;&gt;</span>&nbsp;<span class="num" id="4284454">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284458">b2</span>&nbsp;<span class="op" id="4284461">:=</span>&nbsp;<span class="ident" id="4284464">block</span>&nbsp;<span class="op" id="4284470">&lt;&lt;</span>&nbsp;<span class="num" id="4284473">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284477">block</span>&nbsp;<span class="op" id="4284483">^=</span>&nbsp;<span class="ident" id="4284486">b1</span>&nbsp;<span class="op" id="4284489">^</span>&nbsp;<span class="ident" id="4284491">b2</span>&nbsp;<span class="op" id="4284494">^</span>&nbsp;<span class="ident" id="4284496">b1</span><span class="op" id="4284498">&lt;&lt;</span><span class="num" id="4284500">48</span>&nbsp;<span class="op" id="4284503">^</span>&nbsp;<span class="ident" id="4284505">b2</span><span class="op" id="4284507">&gt;&gt;</span><span class="num" id="4284509">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284514">//&nbsp;block&nbsp;=&nbsp;b1&nbsp;b0&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b7&nbsp;b6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284550">b1</span>&nbsp;<span class="op" id="4284553">=</span>&nbsp;<span class="ident" id="4284555">block</span>&nbsp;<span class="op" id="4284561">&gt;&gt;</span>&nbsp;<span class="num" id="4284564">32</span>&nbsp;<span class="op" id="4284567">&amp;</span>&nbsp;<span class="num" id="4284569">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284579">b2</span>&nbsp;<span class="op" id="4284582">=</span>&nbsp;<span class="op" id="4284584">(</span><span class="ident" id="4284585">block</span>&nbsp;<span class="op" id="4284591">&amp;</span>&nbsp;<span class="num" id="4284593">0xff00ff00</span><span class="op" id="4284603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284606">block</span>&nbsp;<span class="op" id="4284612">^=</span>&nbsp;<span class="ident" id="4284615">b1</span><span class="op" id="4284617">&lt;&lt;</span><span class="num" id="4284619">32</span>&nbsp;<span class="op" id="4284622">^</span>&nbsp;<span class="ident" id="4284624">b2</span>&nbsp;<span class="op" id="4284627">^</span>&nbsp;<span class="ident" id="4284629">b1</span><span class="op" id="4284631">&lt;&lt;</span><span class="num" id="4284633">8</span>&nbsp;<span class="op" id="4284635">^</span>&nbsp;<span class="ident" id="4284637">b2</span><span class="op" id="4284639">&lt;&lt;</span><span class="num" id="4284641">24</span>&nbsp;<span class="comment" id="4284644">//&nbsp;exchange&nbsp;b0&nbsp;b4&nbsp;with&nbsp;b3&nbsp;b7</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284675">//&nbsp;block&nbsp;is&nbsp;now&nbsp;b1&nbsp;b3&nbsp;b5&nbsp;b7&nbsp;b0&nbsp;b2&nbsp;b4&nbsp;b7,&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284734">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284762">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284790">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284818">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;56</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284846">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284874">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20&nbsp;19&nbsp;18&nbsp;17&nbsp;16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284902">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284930">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;48</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284959">//&nbsp;exchange&nbsp;4,5,6,7&nbsp;with&nbsp;32,33,34,35&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285002">b1</span>&nbsp;<span class="op" id="4285005">=</span>&nbsp;<span class="ident" id="4285007">block</span>&nbsp;<span class="op" id="4285013">&amp;</span>&nbsp;<span class="num" id="4285015">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285035">b2</span>&nbsp;<span class="op" id="4285038">=</span>&nbsp;<span class="ident" id="4285040">block</span>&nbsp;<span class="op" id="4285046">&amp;</span>&nbsp;<span class="num" id="4285048">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285068">block</span>&nbsp;<span class="op" id="4285074">^=</span>&nbsp;<span class="ident" id="4285077">b1</span>&nbsp;<span class="op" id="4285080">^</span>&nbsp;<span class="ident" id="4285082">b2</span>&nbsp;<span class="op" id="4285085">^</span>&nbsp;<span class="ident" id="4285087">b1</span><span class="op" id="4285089">&gt;&gt;</span><span class="num" id="4285091">12</span>&nbsp;<span class="op" id="4285094">^</span>&nbsp;<span class="ident" id="4285096">b2</span><span class="op" id="4285098">&lt;&lt;</span><span class="num" id="4285100">12</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285105">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285135">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285139">//&nbsp;&nbsp;&nbsp;[+8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[+40]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285164">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285168">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285184">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285200">//&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285216">//&nbsp;19&nbsp;18&nbsp;17&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;[+32]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285242">//&nbsp;exchange&nbsp;0,1,4,5&nbsp;with&nbsp;18,19,22,23</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285280">b1</span>&nbsp;<span class="op" id="4285283">=</span>&nbsp;<span class="ident" id="4285285">block</span>&nbsp;<span class="op" id="4285291">&amp;</span>&nbsp;<span class="num" id="4285293">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285313">b2</span>&nbsp;<span class="op" id="4285316">=</span>&nbsp;<span class="ident" id="4285318">block</span>&nbsp;<span class="op" id="4285324">&amp;</span>&nbsp;<span class="num" id="4285326">0x00cc00cc00cc00cc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285346">block</span>&nbsp;<span class="op" id="4285352">^=</span>&nbsp;<span class="ident" id="4285355">b1</span>&nbsp;<span class="op" id="4285358">^</span>&nbsp;<span class="ident" id="4285360">b2</span>&nbsp;<span class="op" id="4285363">^</span>&nbsp;<span class="ident" id="4285365">b1</span><span class="op" id="4285367">&gt;&gt;</span><span class="num" id="4285369">6</span>&nbsp;<span class="op" id="4285371">^</span>&nbsp;<span class="ident" id="4285373">b2</span><span class="op" id="4285375">&lt;&lt;</span><span class="num" id="4285377">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285381">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285411">//&nbsp;15&nbsp;14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285421">//&nbsp;13&nbsp;12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285431">//&nbsp;11&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285441">//&nbsp;&nbsp;9&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285451">//&nbsp;&nbsp;7&nbsp;&nbsp;6</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285461">//&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285471">//&nbsp;&nbsp;3&nbsp;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285481">//&nbsp;&nbsp;1&nbsp;&nbsp;0&nbsp;[+16]&nbsp;[+32]&nbsp;[+64]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285510">//&nbsp;exchange&nbsp;0,2,4,6&nbsp;with&nbsp;9,11,13,15:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285548">b1</span>&nbsp;<span class="op" id="4285551">=</span>&nbsp;<span class="ident" id="4285553">block</span>&nbsp;<span class="op" id="4285559">&amp;</span>&nbsp;<span class="num" id="4285561">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285581">block</span>&nbsp;<span class="op" id="4285587">^=</span>&nbsp;<span class="ident" id="4285590">b1</span>&nbsp;<span class="op" id="4285593">^</span>&nbsp;<span class="ident" id="4285595">b1</span><span class="op" id="4285597">&gt;&gt;</span><span class="num" id="4285599">33</span>&nbsp;<span class="op" id="4285602">^</span>&nbsp;<span class="ident" id="4285604">b1</span><span class="op" id="4285606">&lt;&lt;</span><span class="num" id="4285608">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285613">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285643">//&nbsp;6&nbsp;14&nbsp;22&nbsp;30&nbsp;38&nbsp;46&nbsp;54&nbsp;62</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285670">//&nbsp;4&nbsp;12&nbsp;20&nbsp;28&nbsp;36&nbsp;44&nbsp;52&nbsp;60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285697">//&nbsp;2&nbsp;10&nbsp;18&nbsp;26&nbsp;34&nbsp;42&nbsp;50&nbsp;58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285724">//&nbsp;0&nbsp;&nbsp;8&nbsp;16&nbsp;24&nbsp;32&nbsp;40&nbsp;48&nbsp;56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285751">//&nbsp;7&nbsp;15&nbsp;23&nbsp;31&nbsp;39&nbsp;47&nbsp;55&nbsp;63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285778">//&nbsp;5&nbsp;13&nbsp;21&nbsp;29&nbsp;37&nbsp;45&nbsp;53&nbsp;61</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285805">//&nbsp;3&nbsp;11&nbsp;19&nbsp;27&nbsp;35&nbsp;43&nbsp;51&nbsp;59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285832">//&nbsp;1&nbsp;&nbsp;9&nbsp;17&nbsp;25&nbsp;33&nbsp;41&nbsp;49&nbsp;57</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4285859">return</span>&nbsp;<span class="ident" id="4285866">block</span><br>
<span class="lineno"></span><span class="op" id="4285872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="4285875">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4285939">//&nbsp;by&nbsp;finalPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="4285963">func</span>&nbsp;<span class="ident" id="4285968">permuteFinalBlock</span><span class="op" id="4285985">(</span><span class="ident" id="4285986">block</span>&nbsp;<span class="ident" id="4285992">uint64</span><span class="op" id="4285998">)</span>&nbsp;<span class="ident" id="4286000">uint64</span>&nbsp;<span class="op" id="4286007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4286010">//&nbsp;Perform&nbsp;the&nbsp;same&nbsp;bit&nbsp;exchanges&nbsp;as&nbsp;permuteInitialBlock</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4286068">//&nbsp;but&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286094">b1</span>&nbsp;<span class="op" id="4286097">:=</span>&nbsp;<span class="ident" id="4286100">block</span>&nbsp;<span class="op" id="4286106">&amp;</span>&nbsp;<span class="num" id="4286108">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286128">block</span>&nbsp;<span class="op" id="4286134">^=</span>&nbsp;<span class="ident" id="4286137">b1</span>&nbsp;<span class="op" id="4286140">^</span>&nbsp;<span class="ident" id="4286142">b1</span><span class="op" id="4286144">&gt;&gt;</span><span class="num" id="4286146">33</span>&nbsp;<span class="op" id="4286149">^</span>&nbsp;<span class="ident" id="4286151">b1</span><span class="op" id="4286153">&lt;&lt;</span><span class="num" id="4286155">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286160">b1</span>&nbsp;<span class="op" id="4286163">=</span>&nbsp;<span class="ident" id="4286165">block</span>&nbsp;<span class="op" id="4286171">&amp;</span>&nbsp;<span class="num" id="4286173">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286193">b2</span>&nbsp;<span class="op" id="4286196">:=</span>&nbsp;<span class="ident" id="4286199">block</span>&nbsp;<span class="op" id="4286205">&amp;</span>&nbsp;<span class="num" id="4286207">0x00cc00cc00cc00cc</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286227">block</span>&nbsp;<span class="op" id="4286233">^=</span>&nbsp;<span class="ident" id="4286236">b1</span>&nbsp;<span class="op" id="4286239">^</span>&nbsp;<span class="ident" id="4286241">b2</span>&nbsp;<span class="op" id="4286244">^</span>&nbsp;<span class="ident" id="4286246">b1</span><span class="op" id="4286248">&gt;&gt;</span><span class="num" id="4286250">6</span>&nbsp;<span class="op" id="4286252">^</span>&nbsp;<span class="ident" id="4286254">b2</span><span class="op" id="4286256">&lt;&lt;</span><span class="num" id="4286258">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286262">b1</span>&nbsp;<span class="op" id="4286265">=</span>&nbsp;<span class="ident" id="4286267">block</span>&nbsp;<span class="op" id="4286273">&amp;</span>&nbsp;<span class="num" id="4286275">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286295">b2</span>&nbsp;<span class="op" id="4286298">=</span>&nbsp;<span class="ident" id="4286300">block</span>&nbsp;<span class="op" id="4286306">&amp;</span>&nbsp;<span class="num" id="4286308">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286328">block</span>&nbsp;<span class="op" id="4286334">^=</span>&nbsp;<span class="ident" id="4286337">b1</span>&nbsp;<span class="op" id="4286340">^</span>&nbsp;<span class="ident" id="4286342">b2</span>&nbsp;<span class="op" id="4286345">^</span>&nbsp;<span class="ident" id="4286347">b1</span><span class="op" id="4286349">&gt;&gt;</span><span class="num" id="4286351">12</span>&nbsp;<span class="op" id="4286354">^</span>&nbsp;<span class="ident" id="4286356">b2</span><span class="op" id="4286358">&lt;&lt;</span><span class="num" id="4286360">12</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286365">b1</span>&nbsp;<span class="op" id="4286368">=</span>&nbsp;<span class="ident" id="4286370">block</span>&nbsp;<span class="op" id="4286376">&gt;&gt;</span>&nbsp;<span class="num" id="4286379">32</span>&nbsp;<span class="op" id="4286382">&amp;</span>&nbsp;<span class="num" id="4286384">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286394">b2</span>&nbsp;<span class="op" id="4286397">=</span>&nbsp;<span class="op" id="4286399">(</span><span class="ident" id="4286400">block</span>&nbsp;<span class="op" id="4286406">&amp;</span>&nbsp;<span class="num" id="4286408">0xff00ff00</span><span class="op" id="4286418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286421">block</span>&nbsp;<span class="op" id="4286427">^=</span>&nbsp;<span class="ident" id="4286430">b1</span><span class="op" id="4286432">&lt;&lt;</span><span class="num" id="4286434">32</span>&nbsp;<span class="op" id="4286437">^</span>&nbsp;<span class="ident" id="4286439">b2</span>&nbsp;<span class="op" id="4286442">^</span>&nbsp;<span class="ident" id="4286444">b1</span><span class="op" id="4286446">&lt;&lt;</span><span class="num" id="4286448">8</span>&nbsp;<span class="op" id="4286450">^</span>&nbsp;<span class="ident" id="4286452">b2</span><span class="op" id="4286454">&lt;&lt;</span><span class="num" id="4286456">24</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286461">b1</span>&nbsp;<span class="op" id="4286464">=</span>&nbsp;<span class="ident" id="4286466">block</span>&nbsp;<span class="op" id="4286472">&gt;&gt;</span>&nbsp;<span class="num" id="4286475">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286479">b2</span>&nbsp;<span class="op" id="4286482">=</span>&nbsp;<span class="ident" id="4286484">block</span>&nbsp;<span class="op" id="4286490">&lt;&lt;</span>&nbsp;<span class="num" id="4286493">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286497">block</span>&nbsp;<span class="op" id="4286503">^=</span>&nbsp;<span class="ident" id="4286506">b1</span>&nbsp;<span class="op" id="4286509">^</span>&nbsp;<span class="ident" id="4286511">b2</span>&nbsp;<span class="op" id="4286514">^</span>&nbsp;<span class="ident" id="4286516">b1</span><span class="op" id="4286518">&lt;&lt;</span><span class="num" id="4286520">48</span>&nbsp;<span class="op" id="4286523">^</span>&nbsp;<span class="ident" id="4286525">b2</span><span class="op" id="4286527">&gt;&gt;</span><span class="num" id="4286529">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4286533">return</span>&nbsp;<span class="ident" id="4286540">block</span><br>
<span class="lineno"></span><span class="op" id="4286546">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4286549">//&nbsp;creates&nbsp;16&nbsp;28-bit&nbsp;blocks&nbsp;rotated&nbsp;according</span><br>
<span class="lineno"></span><span class="comment" id="4286595">//&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span><span class="keyword" id="4286623">func</span>&nbsp;<span class="ident" id="4286628">ksRotate</span><span class="op" id="4286636">(</span><span class="ident" id="4286637">in</span>&nbsp;<span class="builtintype" id="4286640">uint32</span><span class="op" id="4286646">)</span>&nbsp;<span class="op" id="4286648">(</span><span class="ident" id="4286649">out</span>&nbsp;<span class="op" id="4286653">[</span><span class="op" id="4286654">]</span><span class="builtintype" id="4286655">uint32</span><span class="op" id="4286661">)</span>&nbsp;<span class="op" id="4286663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286666">out</span>&nbsp;<span class="op" id="4286670">=</span>&nbsp;<span class="builtinfunc" id="4286672">make</span><span class="op" id="4286676">(</span><span class="op" id="4286677">[</span><span class="op" id="4286678">]</span><span class="builtintype" id="4286679">uint32</span><span class="op" id="4286685">,</span>&nbsp;<span class="num" id="4286687">16</span><span class="op" id="4286689">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286692">last</span>&nbsp;<span class="op" id="4286697">:=</span>&nbsp;<span class="ident" id="4286700">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4286704">for</span>&nbsp;<span class="ident" id="4286708">i</span>&nbsp;<span class="op" id="4286710">:=</span>&nbsp;<span class="num" id="4286713">0</span><span class="op" id="4286714">;</span>&nbsp;<span class="ident" id="4286716">i</span>&nbsp;<span class="op" id="4286718">&lt;</span>&nbsp;<span class="num" id="4286720">16</span><span class="op" id="4286722">;</span>&nbsp;<span class="ident" id="4286724">i</span><span class="op" id="4286725">++</span>&nbsp;<span class="op" id="4286728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4286732">//&nbsp;28-bit&nbsp;circular&nbsp;left&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286764">left</span>&nbsp;<span class="op" id="4286769">:=</span>&nbsp;<span class="op" id="4286772">(</span><span class="ident" id="4286773">last</span>&nbsp;<span class="op" id="4286778">&lt;&lt;</span>&nbsp;<span class="op" id="4286781">(</span><span class="num" id="4286782">4</span>&nbsp;<span class="op" id="4286784">+</span>&nbsp;<span class="ident" id="4286786">ksRotations</span><span class="op" id="4286797">[</span><span class="ident" id="4286798">i</span><span class="op" id="4286799">]</span><span class="op" id="4286800">)</span><span class="op" id="4286801">)</span>&nbsp;<span class="op" id="4286803">&gt;&gt;</span>&nbsp;<span class="num" id="4286806">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286810">right</span>&nbsp;<span class="op" id="4286816">:=</span>&nbsp;<span class="op" id="4286819">(</span><span class="ident" id="4286820">last</span>&nbsp;<span class="op" id="4286825">&lt;&lt;</span>&nbsp;<span class="num" id="4286828">4</span><span class="op" id="4286829">)</span>&nbsp;<span class="op" id="4286831">&gt;&gt;</span>&nbsp;<span class="op" id="4286834">(</span><span class="num" id="4286835">32</span>&nbsp;<span class="op" id="4286838">-</span>&nbsp;<span class="ident" id="4286840">ksRotations</span><span class="op" id="4286851">[</span><span class="ident" id="4286852">i</span><span class="op" id="4286853">]</span><span class="op" id="4286854">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286858">out</span><span class="op" id="4286861">[</span><span class="ident" id="4286862">i</span><span class="op" id="4286863">]</span>&nbsp;<span class="op" id="4286865">=</span>&nbsp;<span class="ident" id="4286867">left</span>&nbsp;<span class="op" id="4286872">|</span>&nbsp;<span class="ident" id="4286874">right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286882">last</span>&nbsp;<span class="op" id="4286887">=</span>&nbsp;<span class="ident" id="4286889">out</span><span class="op" id="4286892">[</span><span class="ident" id="4286893">i</span><span class="op" id="4286894">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4286897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4286900">return</span><br>
<span class="lineno"></span><span class="op" id="4286907">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="4286910">//&nbsp;creates&nbsp;16&nbsp;56-bit&nbsp;subkeys&nbsp;from&nbsp;the&nbsp;original&nbsp;key</span><br>
<span class="lineno"></span><span class="keyword" id="4286961">func</span>&nbsp;<span class="op" id="4286966">(</span><span class="ident" id="4286967">c</span>&nbsp;<span class="op" id="4286969">*</span><span class="ident" id="4286970">desCipher</span><span class="op" id="4286979">)</span>&nbsp;<span class="ident" id="4286981">generateSubkeys</span><span class="op" id="4286996">(</span><span class="ident" id="4286997">keyBytes</span>&nbsp;<span class="op" id="4287006">[</span><span class="op" id="4287007">]</span><span class="builtintype" id="4287008">byte</span><span class="op" id="4287012">)</span>&nbsp;<span class="op" id="4287014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4287017">//&nbsp;apply&nbsp;PC1&nbsp;permutation&nbsp;to&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287050">key</span>&nbsp;<span class="op" id="4287054">:=</span>&nbsp;<span class="ident" id="4287057">binary</span><span class="op" id="4287063">.</span><span class="ident" id="4287064">BigEndian</span><span class="op" id="4287073">.</span><span class="ident" id="4287074">Uint64</span><span class="op" id="4287080">(</span><span class="ident" id="4287081">keyBytes</span><span class="op" id="4287089">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287092">permutedKey</span>&nbsp;<span class="op" id="4287104">:=</span>&nbsp;<span class="ident" id="4287107">permuteBlock</span><span class="op" id="4287119">(</span><span class="ident" id="4287120">key</span><span class="op" id="4287123">,</span>&nbsp;<span class="ident" id="4287125">permutedChoice1</span><span class="op" id="4287140">[</span><span class="op" id="4287141">:</span><span class="op" id="4287142">]</span><span class="op" id="4287143">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4287147">//&nbsp;rotate&nbsp;halves&nbsp;of&nbsp;permuted&nbsp;key&nbsp;according&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287216">leftRotations</span>&nbsp;<span class="op" id="4287230">:=</span>&nbsp;<span class="ident" id="4287233">ksRotate</span><span class="op" id="4287241">(</span><span class="builtintype" id="4287242">uint32</span><span class="op" id="4287248">(</span><span class="ident" id="4287249">permutedKey</span>&nbsp;<span class="op" id="4287261">&gt;&gt;</span>&nbsp;<span class="num" id="4287264">28</span><span class="op" id="4287266">)</span><span class="op" id="4287267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287270">rightRotations</span>&nbsp;<span class="op" id="4287285">:=</span>&nbsp;<span class="ident" id="4287288">ksRotate</span><span class="op" id="4287296">(</span><span class="builtintype" id="4287297">uint32</span><span class="op" id="4287303">(</span><span class="ident" id="4287304">permutedKey</span><span class="op" id="4287315">&lt;&lt;</span><span class="num" id="4287317">4</span><span class="op" id="4287318">)</span>&nbsp;<span class="op" id="4287320">&gt;&gt;</span>&nbsp;<span class="num" id="4287323">4</span><span class="op" id="4287324">)</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4287328">//&nbsp;generate&nbsp;subkeys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4287349">for</span>&nbsp;<span class="ident" id="4287353">i</span>&nbsp;<span class="op" id="4287355">:=</span>&nbsp;<span class="num" id="4287358">0</span><span class="op" id="4287359">;</span>&nbsp;<span class="ident" id="4287361">i</span>&nbsp;<span class="op" id="4287363">&lt;</span>&nbsp;<span class="num" id="4287365">16</span><span class="op" id="4287367">;</span>&nbsp;<span class="ident" id="4287369">i</span><span class="op" id="4287370">++</span>&nbsp;<span class="op" id="4287373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4287377">//&nbsp;combine&nbsp;halves&nbsp;to&nbsp;form&nbsp;56-bit&nbsp;input&nbsp;to&nbsp;PC2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287425">pc2Input</span>&nbsp;<span class="op" id="4287434">:=</span>&nbsp;<span class="ident" id="4287437">uint64</span><span class="op" id="4287443">(</span><span class="ident" id="4287444">leftRotations</span><span class="op" id="4287457">[</span><span class="ident" id="4287458">i</span><span class="op" id="4287459">]</span><span class="op" id="4287460">)</span><span class="op" id="4287461">&lt;&lt;</span><span class="num" id="4287463">28</span>&nbsp;<span class="op" id="4287466">|</span>&nbsp;<span class="ident" id="4287468">uint64</span><span class="op" id="4287474">(</span><span class="ident" id="4287475">rightRotations</span><span class="op" id="4287489">[</span><span class="ident" id="4287490">i</span><span class="op" id="4287491">]</span><span class="op" id="4287492">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4287496">//&nbsp;apply&nbsp;PC2&nbsp;permutation&nbsp;to&nbsp;7&nbsp;byte&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287539">c</span><span class="op" id="4287540">.</span><span class="ident" id="4287541">subkeys</span><span class="op" id="4287548">[</span><span class="ident" id="4287549">i</span><span class="op" id="4287550">]</span>&nbsp;<span class="op" id="4287552">=</span>&nbsp;<span class="ident" id="4287554">permuteBlock</span><span class="op" id="4287566">(</span><span class="ident" id="4287567">pc2Input</span><span class="op" id="4287575">,</span>&nbsp;<span class="ident" id="4287577">permutedChoice2</span><span class="op" id="4287592">[</span><span class="op" id="4287593">:</span><span class="op" id="4287594">]</span><span class="op" id="4287595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4287598">}</span><br>
<span class="lineno"></span><span class="op" id="4287600">}</span>
</div>
</body>
</html>
