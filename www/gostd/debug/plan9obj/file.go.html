<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/plan9obj</h2>
<ul>
<li><a href="/gostd/debug/plan9obj/file.go.html" class="current">file.go</a></li>
<li><a href="/gostd/debug/plan9obj/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/plan9obj/plan9obj.go.html">plan9obj.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5785245">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5785301">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5785355">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5785406">//&nbsp;Package&nbsp;plan9obj&nbsp;implements&nbsp;access&nbsp;to&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5785474">package</span>&nbsp;<span class="ident" id="5785482">plan9obj</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5785492">import</span>&nbsp;<span class="op" id="5785499">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5785502">&#34;encoding/binary&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5785521">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5785531">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5785538">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5785544">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="5785549">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="5785552">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="5785607">type</span>&nbsp;<span class="ident" id="5785612">FileHeader</span>&nbsp;<span class="keyword" id="5785623">struct</span>&nbsp;<span class="op" id="5785630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5785633">Magic</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785645">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5785653">Bss</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785665">uint32</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5785673">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5785685">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5785693">PtrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785705">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5785710">LoadAddress</span>&nbsp;<span class="ident" id="5785722">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5785730">HdrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5785742">uint64</span><br>
<span class="lineno"></span><span class="op" id="5785749">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="5785752">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5785800">type</span>&nbsp;<span class="ident" id="5785805">File</span>&nbsp;<span class="keyword" id="5785810">struct</span>&nbsp;<span class="op" id="5785817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5785820">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5785832">Sections</span>&nbsp;<span class="op" id="5785841">[</span><span class="op" id="5785842">]</span><span class="op" id="5785843">*</span><span class="ident" id="5785844">Section</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5785853">closer</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5785862">io</span><span class="op" id="5785864">.</span><span class="ident" id="5785865">Closer</span><br>
<span class="lineno"></span><span class="op" id="5785872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5785875">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="comment" id="5785943">//&nbsp;This&nbsp;structure&nbsp;doesn&#39;t&nbsp;exist&nbsp;on-disk,&nbsp;but&nbsp;eases&nbsp;navigation</span><br>
<span class="lineno">35</span><span class="comment" id="5786005">//&nbsp;through&nbsp;the&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5786033">type</span>&nbsp;<span class="ident" id="5786038">SectionHeader</span>&nbsp;<span class="keyword" id="5786052">struct</span>&nbsp;<span class="op" id="5786059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5786062">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5786069">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5786077">Size</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5786084">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5786092">Offset</span>&nbsp;<span class="builtintype" id="5786099">uint32</span><br>
<span class="lineno">40</span><span class="op" id="5786106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5786109">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5786174">type</span>&nbsp;<span class="ident" id="5786179">Section</span>&nbsp;<span class="keyword" id="5786187">struct</span>&nbsp;<span class="op" id="5786194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5786197">SectionHeader</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5786213">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5786251">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5786291">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5786326">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5786374">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5786424">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5786448">io</span><span class="op" id="5786450">.</span><span class="ident" id="5786451">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5786461">sr</span>&nbsp;<span class="op" id="5786464">*</span><span class="ident" id="5786465">io</span><span class="op" id="5786467">.</span><span class="ident" id="5786468">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5786482">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="5786485">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5786553">func</span>&nbsp;<span class="op" id="5786558">(</span><span class="ident" id="5786559">s</span>&nbsp;<span class="op" id="5786561">*</span><span class="ident" id="5786562">Section</span><span class="op" id="5786569">)</span>&nbsp;<span class="ident" id="5786571">Data</span><span class="op" id="5786575">(</span><span class="op" id="5786576">)</span>&nbsp;<span class="op" id="5786578">(</span><span class="op" id="5786579">[</span><span class="op" id="5786580">]</span><span class="builtintype" id="5786581">byte</span><span class="op" id="5786585">,</span>&nbsp;<span class="builtintype" id="5786587">error</span><span class="op" id="5786592">)</span>&nbsp;<span class="op" id="5786594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5786597">dat</span>&nbsp;<span class="op" id="5786601">:=</span>&nbsp;<span class="builtinfunc" id="5786604">make</span><span class="op" id="5786608">(</span><span class="op" id="5786609">[</span><span class="op" id="5786610">]</span><span class="builtintype" id="5786611">byte</span><span class="op" id="5786615">,</span>&nbsp;<span class="ident" id="5786617">s</span><span class="op" id="5786618">.</span><span class="ident" id="5786619">sr</span><span class="op" id="5786621">.</span><span class="ident" id="5786622">Size</span><span class="op" id="5786626">(</span><span class="op" id="5786627">)</span><span class="op" id="5786628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5786631">n</span><span class="op" id="5786632">,</span>&nbsp;<span class="ident" id="5786634">err</span>&nbsp;<span class="op" id="5786638">:=</span>&nbsp;<span class="ident" id="5786641">s</span><span class="op" id="5786642">.</span><span class="ident" id="5786643">sr</span><span class="op" id="5786645">.</span><span class="ident" id="5786646">ReadAt</span><span class="op" id="5786652">(</span><span class="ident" id="5786653">dat</span><span class="op" id="5786656">,</span>&nbsp;<span class="num" id="5786658">0</span><span class="op" id="5786659">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5786662">if</span>&nbsp;<span class="ident" id="5786665">n</span>&nbsp;<span class="op" id="5786667">==</span>&nbsp;<span class="builtinfunc" id="5786670">len</span><span class="op" id="5786673">(</span><span class="ident" id="5786674">dat</span><span class="op" id="5786677">)</span>&nbsp;<span class="op" id="5786679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5786683">err</span>&nbsp;<span class="op" id="5786687">=</span>&nbsp;<span class="ident" id="5786689">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5786694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5786697">return</span>&nbsp;<span class="ident" id="5786704">dat</span><span class="op" id="5786707">[</span><span class="num" id="5786708">0</span><span class="op" id="5786709">:</span><span class="ident" id="5786710">n</span><span class="op" id="5786711">]</span><span class="op" id="5786712">,</span>&nbsp;<span class="ident" id="5786714">err</span><br>
<span class="lineno"></span><span class="op" id="5786718">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="5786721">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5786788">func</span>&nbsp;<span class="op" id="5786793">(</span><span class="ident" id="5786794">s</span>&nbsp;<span class="op" id="5786796">*</span><span class="ident" id="5786797">Section</span><span class="op" id="5786804">)</span>&nbsp;<span class="ident" id="5786806">Open</span><span class="op" id="5786810">(</span><span class="op" id="5786811">)</span>&nbsp;<span class="ident" id="5786813">io</span><span class="op" id="5786815">.</span><span class="ident" id="5786816">ReadSeeker</span>&nbsp;<span class="op" id="5786827">{</span>&nbsp;<span class="keyword" id="5786829">return</span>&nbsp;<span class="ident" id="5786836">io</span><span class="op" id="5786838">.</span><span class="ident" id="5786839">NewSectionReader</span><span class="op" id="5786855">(</span><span class="ident" id="5786856">s</span><span class="op" id="5786857">.</span><span class="ident" id="5786858">sr</span><span class="op" id="5786860">,</span>&nbsp;<span class="num" id="5786862">0</span><span class="op" id="5786863">,</span>&nbsp;<span class="num" id="5786865">1</span><span class="op" id="5786866">&lt;&lt;</span><span class="num" id="5786868">63</span><span class="op" id="5786870">-</span><span class="num" id="5786871">1</span><span class="op" id="5786872">)</span>&nbsp;<span class="op" id="5786874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5786877">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno">70</span><span class="keyword" id="5786949">type</span>&nbsp;<span class="ident" id="5786954">Sym</span>&nbsp;<span class="keyword" id="5786958">struct</span>&nbsp;<span class="op" id="5786965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5786968">Value</span>&nbsp;<span class="ident" id="5786974">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5786982">Type</span>&nbsp;&nbsp;<span class="builtintype" id="5786988">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5786994">Name</span>&nbsp;&nbsp;<span class="builtintype" id="5787000">string</span><br>
<span class="lineno"></span><span class="op" id="5787007">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="5787010">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="5787041">//&nbsp;formatError&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;operations&nbsp;if&nbsp;the&nbsp;data&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="5787104">//&nbsp;not&nbsp;have&nbsp;the&nbsp;correct&nbsp;format&nbsp;for&nbsp;an&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5787155">type</span>&nbsp;<span class="ident" id="5787160">formatError</span>&nbsp;<span class="keyword" id="5787172">struct</span>&nbsp;<span class="op" id="5787179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5787182">off</span>&nbsp;<span class="builtintype" id="5787186">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5787191">msg</span>&nbsp;<span class="builtintype" id="5787195">string</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5787203">val</span>&nbsp;<span class="keyword" id="5787207">interface</span><span class="op" id="5787216">{</span><span class="op" id="5787217">}</span><br>
<span class="lineno"></span><span class="op" id="5787219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5787222">func</span>&nbsp;<span class="op" id="5787227">(</span><span class="ident" id="5787228">e</span>&nbsp;<span class="op" id="5787230">*</span><span class="ident" id="5787231">formatError</span><span class="op" id="5787242">)</span>&nbsp;<span class="ident" id="5787244">Error</span><span class="op" id="5787249">(</span><span class="op" id="5787250">)</span>&nbsp;<span class="builtintype" id="5787252">string</span>&nbsp;<span class="op" id="5787259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5787262">msg</span>&nbsp;<span class="op" id="5787266">:=</span>&nbsp;<span class="ident" id="5787269">e</span><span class="op" id="5787270">.</span><span class="ident" id="5787271">msg</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5787276">if</span>&nbsp;<span class="ident" id="5787279">e</span><span class="op" id="5787280">.</span><span class="ident" id="5787281">val</span>&nbsp;<span class="op" id="5787285">!=</span>&nbsp;<span class="ident" id="5787288">nil</span>&nbsp;<span class="op" id="5787292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5787296">msg</span>&nbsp;<span class="op" id="5787300">+=</span>&nbsp;<span class="ident" id="5787303">fmt</span><span class="op" id="5787306">.</span><span class="ident" id="5787307">Sprintf</span><span class="op" id="5787314">(</span><span class="string" id="5787315">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="5787322">,</span>&nbsp;<span class="ident" id="5787324">e</span><span class="op" id="5787325">.</span><span class="ident" id="5787326">val</span><span class="op" id="5787329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5787332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5787335">msg</span>&nbsp;<span class="op" id="5787339">+=</span>&nbsp;<span class="ident" id="5787342">fmt</span><span class="op" id="5787345">.</span><span class="ident" id="5787346">Sprintf</span><span class="op" id="5787353">(</span><span class="string" id="5787354">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="5787378">,</span>&nbsp;<span class="ident" id="5787380">e</span><span class="op" id="5787381">.</span><span class="ident" id="5787382">off</span><span class="op" id="5787385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5787388">return</span>&nbsp;<span class="ident" id="5787395">msg</span><br>
<span class="lineno">95</span><span class="op" id="5787399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5787402">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="5787495">func</span>&nbsp;<span class="ident" id="5787500">Open</span><span class="op" id="5787504">(</span><span class="ident" id="5787505">name</span>&nbsp;<span class="builtintype" id="5787510">string</span><span class="op" id="5787516">)</span>&nbsp;<span class="op" id="5787518">(</span><span class="op" id="5787519">*</span><span class="ident" id="5787520">File</span><span class="op" id="5787524">,</span>&nbsp;<span class="builtintype" id="5787526">error</span><span class="op" id="5787531">)</span>&nbsp;<span class="op" id="5787533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5787536">f</span><span class="op" id="5787537">,</span>&nbsp;<span class="ident" id="5787539">err</span>&nbsp;<span class="op" id="5787543">:=</span>&nbsp;<span class="ident" id="5787546">os</span><span class="op" id="5787548">.</span><span class="ident" id="5787549">Open</span><span class="op" id="5787553">(</span><span class="ident" id="5787554">name</span><span class="op" id="5787558">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5787561">if</span>&nbsp;<span class="ident" id="5787564">err</span>&nbsp;<span class="op" id="5787568">!=</span>&nbsp;<span class="ident" id="5787571">nil</span>&nbsp;<span class="op" id="5787575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5787579">return</span>&nbsp;<span class="ident" id="5787586">nil</span><span class="op" id="5787589">,</span>&nbsp;<span class="ident" id="5787591">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5787596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5787599">ff</span><span class="op" id="5787601">,</span>&nbsp;<span class="ident" id="5787603">err</span>&nbsp;<span class="op" id="5787607">:=</span>&nbsp;<span class="ident" id="5787610">NewFile</span><span class="op" id="5787617">(</span><span class="ident" id="5787618">f</span><span class="op" id="5787619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5787622">if</span>&nbsp;<span class="ident" id="5787625">err</span>&nbsp;<span class="op" id="5787629">!=</span>&nbsp;<span class="ident" id="5787632">nil</span>&nbsp;<span class="op" id="5787636">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5787640">f</span><span class="op" id="5787641">.</span><span class="ident" id="5787642">Close</span><span class="op" id="5787647">(</span><span class="op" id="5787648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5787652">return</span>&nbsp;<span class="ident" id="5787659">nil</span><span class="op" id="5787662">,</span>&nbsp;<span class="ident" id="5787664">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5787669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5787672">ff</span><span class="op" id="5787674">.</span><span class="ident" id="5787675">closer</span>&nbsp;<span class="op" id="5787682">=</span>&nbsp;<span class="ident" id="5787684">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5787687">return</span>&nbsp;<span class="ident" id="5787694">ff</span><span class="op" id="5787696">,</span>&nbsp;<span class="ident" id="5787698">nil</span><br>
<span class="lineno">110</span><span class="op" id="5787702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5787705">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="5787731">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="5787798">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno">115</span><span class="keyword" id="5787822">func</span>&nbsp;<span class="op" id="5787827">(</span><span class="ident" id="5787828">f</span>&nbsp;<span class="op" id="5787830">*</span><span class="ident" id="5787831">File</span><span class="op" id="5787835">)</span>&nbsp;<span class="ident" id="5787837">Close</span><span class="op" id="5787842">(</span><span class="op" id="5787843">)</span>&nbsp;<span class="builtintype" id="5787845">error</span>&nbsp;<span class="op" id="5787851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5787854">var</span>&nbsp;<span class="ident" id="5787858">err</span>&nbsp;<span class="builtintype" id="5787862">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5787869">if</span>&nbsp;<span class="ident" id="5787872">f</span><span class="op" id="5787873">.</span><span class="ident" id="5787874">closer</span>&nbsp;<span class="op" id="5787881">!=</span>&nbsp;<span class="ident" id="5787884">nil</span>&nbsp;<span class="op" id="5787888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5787892">err</span>&nbsp;<span class="op" id="5787896">=</span>&nbsp;<span class="ident" id="5787898">f</span><span class="op" id="5787899">.</span><span class="ident" id="5787900">closer</span><span class="op" id="5787906">.</span><span class="ident" id="5787907">Close</span><span class="op" id="5787912">(</span><span class="op" id="5787913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5787917">f</span><span class="op" id="5787918">.</span><span class="ident" id="5787919">closer</span>&nbsp;<span class="op" id="5787926">=</span>&nbsp;<span class="ident" id="5787928">nil</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5787933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5787936">return</span>&nbsp;<span class="ident" id="5787943">err</span><br>
<span class="lineno"></span><span class="op" id="5787947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5787950">func</span>&nbsp;<span class="ident" id="5787955">parseMagic</span><span class="op" id="5787965">(</span><span class="ident" id="5787966">magic</span>&nbsp;<span class="op" id="5787972">[</span><span class="op" id="5787973">]</span><span class="builtintype" id="5787974">byte</span><span class="op" id="5787978">)</span>&nbsp;<span class="op" id="5787980">(</span><span class="builtintype" id="5787981">uint32</span><span class="op" id="5787987">,</span>&nbsp;<span class="builtintype" id="5787989">error</span><span class="op" id="5787994">)</span>&nbsp;<span class="op" id="5787996">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5787999">m</span>&nbsp;<span class="op" id="5788001">:=</span>&nbsp;<span class="ident" id="5788004">binary</span><span class="op" id="5788010">.</span><span class="ident" id="5788011">BigEndian</span><span class="op" id="5788020">.</span><span class="ident" id="5788021">Uint32</span><span class="op" id="5788027">(</span><span class="ident" id="5788028">magic</span><span class="op" id="5788033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5788036">switch</span>&nbsp;<span class="ident" id="5788043">m</span>&nbsp;<span class="op" id="5788045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5788048">case</span>&nbsp;<span class="ident" id="5788053">Magic386</span><span class="op" id="5788061">,</span>&nbsp;<span class="ident" id="5788063">MagicAMD64</span><span class="op" id="5788073">,</span>&nbsp;<span class="ident" id="5788075">MagicARM</span><span class="op" id="5788083">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5788087">return</span>&nbsp;<span class="ident" id="5788094">m</span><span class="op" id="5788095">,</span>&nbsp;<span class="ident" id="5788097">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5788102">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5788105">return</span>&nbsp;<span class="num" id="5788112">0</span><span class="op" id="5788113">,</span>&nbsp;<span class="op" id="5788115">&amp;</span><span class="ident" id="5788116">formatError</span><span class="op" id="5788127">{</span><span class="num" id="5788128">0</span><span class="op" id="5788129">,</span>&nbsp;<span class="string" id="5788131">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="5788149">,</span>&nbsp;<span class="ident" id="5788151">magic</span><span class="op" id="5788156">}</span><br>
<span class="lineno"></span><span class="op" id="5788158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5788161">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="5788246">//&nbsp;The&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno">135</span><span class="keyword" id="5788319">func</span>&nbsp;<span class="ident" id="5788324">NewFile</span><span class="op" id="5788331">(</span><span class="ident" id="5788332">r</span>&nbsp;<span class="ident" id="5788334">io</span><span class="op" id="5788336">.</span><span class="ident" id="5788337">ReaderAt</span><span class="op" id="5788345">)</span>&nbsp;<span class="op" id="5788347">(</span><span class="op" id="5788348">*</span><span class="ident" id="5788349">File</span><span class="op" id="5788353">,</span>&nbsp;<span class="builtintype" id="5788355">error</span><span class="op" id="5788360">)</span>&nbsp;<span class="op" id="5788362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788365">sr</span>&nbsp;<span class="op" id="5788368">:=</span>&nbsp;<span class="ident" id="5788371">io</span><span class="op" id="5788373">.</span><span class="ident" id="5788374">NewSectionReader</span><span class="op" id="5788390">(</span><span class="ident" id="5788391">r</span><span class="op" id="5788392">,</span>&nbsp;<span class="num" id="5788394">0</span><span class="op" id="5788395">,</span>&nbsp;<span class="num" id="5788397">1</span><span class="op" id="5788398">&lt;&lt;</span><span class="num" id="5788400">63</span><span class="op" id="5788402">-</span><span class="num" id="5788403">1</span><span class="op" id="5788404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5788407">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;Plan&nbsp;9&nbsp;magic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5788440">var</span>&nbsp;<span class="ident" id="5788444">magic</span>&nbsp;<span class="op" id="5788450">[</span><span class="num" id="5788451">4</span><span class="op" id="5788452">]</span><span class="builtintype" id="5788453">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5788459">if</span>&nbsp;<span class="ident" id="5788462">_</span><span class="op" id="5788463">,</span>&nbsp;<span class="ident" id="5788465">err</span>&nbsp;<span class="op" id="5788469">:=</span>&nbsp;<span class="ident" id="5788472">r</span><span class="op" id="5788473">.</span><span class="ident" id="5788474">ReadAt</span><span class="op" id="5788480">(</span><span class="ident" id="5788481">magic</span><span class="op" id="5788486">[</span><span class="op" id="5788487">:</span><span class="op" id="5788488">]</span><span class="op" id="5788489">,</span>&nbsp;<span class="num" id="5788491">0</span><span class="op" id="5788492">)</span><span class="op" id="5788493">;</span>&nbsp;<span class="ident" id="5788495">err</span>&nbsp;<span class="op" id="5788499">!=</span>&nbsp;<span class="ident" id="5788502">nil</span>&nbsp;<span class="op" id="5788506">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5788510">return</span>&nbsp;<span class="ident" id="5788517">nil</span><span class="op" id="5788520">,</span>&nbsp;<span class="ident" id="5788522">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5788527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788530">_</span><span class="op" id="5788531">,</span>&nbsp;<span class="ident" id="5788533">err</span>&nbsp;<span class="op" id="5788537">:=</span>&nbsp;<span class="ident" id="5788540">parseMagic</span><span class="op" id="5788550">(</span><span class="ident" id="5788551">magic</span><span class="op" id="5788556">[</span><span class="op" id="5788557">:</span><span class="op" id="5788558">]</span><span class="op" id="5788559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5788562">if</span>&nbsp;<span class="ident" id="5788565">err</span>&nbsp;<span class="op" id="5788569">!=</span>&nbsp;<span class="ident" id="5788572">nil</span>&nbsp;<span class="op" id="5788576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5788580">return</span>&nbsp;<span class="ident" id="5788587">nil</span><span class="op" id="5788590">,</span>&nbsp;<span class="ident" id="5788592">err</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5788597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788601">ph</span>&nbsp;<span class="op" id="5788604">:=</span>&nbsp;<span class="builtinfunc" id="5788607">new</span><span class="op" id="5788610">(</span><span class="ident" id="5788611">prog</span><span class="op" id="5788615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5788618">if</span>&nbsp;<span class="ident" id="5788621">err</span>&nbsp;<span class="op" id="5788625">:=</span>&nbsp;<span class="ident" id="5788628">binary</span><span class="op" id="5788634">.</span><span class="ident" id="5788635">Read</span><span class="op" id="5788639">(</span><span class="ident" id="5788640">sr</span><span class="op" id="5788642">,</span>&nbsp;<span class="ident" id="5788644">binary</span><span class="op" id="5788650">.</span><span class="ident" id="5788651">BigEndian</span><span class="op" id="5788660">,</span>&nbsp;<span class="ident" id="5788662">ph</span><span class="op" id="5788664">)</span><span class="op" id="5788665">;</span>&nbsp;<span class="ident" id="5788667">err</span>&nbsp;<span class="op" id="5788671">!=</span>&nbsp;<span class="ident" id="5788674">nil</span>&nbsp;<span class="op" id="5788678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5788682">return</span>&nbsp;<span class="ident" id="5788689">nil</span><span class="op" id="5788692">,</span>&nbsp;<span class="ident" id="5788694">err</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5788699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788703">f</span>&nbsp;<span class="op" id="5788705">:=</span>&nbsp;<span class="op" id="5788708">&amp;</span><span class="ident" id="5788709">File</span><span class="op" id="5788713">{</span><span class="ident" id="5788714">FileHeader</span><span class="op" id="5788724">:</span>&nbsp;<span class="ident" id="5788726">FileHeader</span><span class="op" id="5788736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788740">Magic</span><span class="op" id="5788745">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788753">ph</span><span class="op" id="5788755">.</span><span class="ident" id="5788756">Magic</span><span class="op" id="5788761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788765">Bss</span><span class="op" id="5788768">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788778">ph</span><span class="op" id="5788780">.</span><span class="ident" id="5788781">Bss</span><span class="op" id="5788784">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788788">Entry</span><span class="op" id="5788793">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788801">uint64</span><span class="op" id="5788807">(</span><span class="ident" id="5788808">ph</span><span class="op" id="5788810">.</span><span class="ident" id="5788811">Entry</span><span class="op" id="5788816">)</span><span class="op" id="5788817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788821">PtrSize</span><span class="op" id="5788828">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5788834">4</span><span class="op" id="5788835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788839">LoadAddress</span><span class="op" id="5788850">:</span>&nbsp;<span class="num" id="5788852">0x1000</span><span class="op" id="5788858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788862">HdrSize</span><span class="op" id="5788869">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5788875">4</span>&nbsp;<span class="op" id="5788877">*</span>&nbsp;<span class="num" id="5788879">8</span><span class="op" id="5788880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5788883">}</span><span class="op" id="5788884">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5788888">if</span>&nbsp;<span class="ident" id="5788891">ph</span><span class="op" id="5788893">.</span><span class="ident" id="5788894">Magic</span><span class="op" id="5788899">&amp;</span><span class="ident" id="5788900">Magic64</span>&nbsp;<span class="op" id="5788908">!=</span>&nbsp;<span class="num" id="5788911">0</span>&nbsp;<span class="op" id="5788913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5788917">if</span>&nbsp;<span class="ident" id="5788920">err</span>&nbsp;<span class="op" id="5788924">:=</span>&nbsp;<span class="ident" id="5788927">binary</span><span class="op" id="5788933">.</span><span class="ident" id="5788934">Read</span><span class="op" id="5788938">(</span><span class="ident" id="5788939">sr</span><span class="op" id="5788941">,</span>&nbsp;<span class="ident" id="5788943">binary</span><span class="op" id="5788949">.</span><span class="ident" id="5788950">BigEndian</span><span class="op" id="5788959">,</span>&nbsp;<span class="op" id="5788961">&amp;</span><span class="ident" id="5788962">f</span><span class="op" id="5788963">.</span><span class="ident" id="5788964">Entry</span><span class="op" id="5788969">)</span><span class="op" id="5788970">;</span>&nbsp;<span class="ident" id="5788972">err</span>&nbsp;<span class="op" id="5788976">!=</span>&nbsp;<span class="ident" id="5788979">nil</span>&nbsp;<span class="op" id="5788983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5788988">return</span>&nbsp;<span class="ident" id="5788995">nil</span><span class="op" id="5788998">,</span>&nbsp;<span class="ident" id="5789000">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789006">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789010">f</span><span class="op" id="5789011">.</span><span class="ident" id="5789012">PtrSize</span>&nbsp;<span class="op" id="5789020">=</span>&nbsp;<span class="num" id="5789022">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789026">f</span><span class="op" id="5789027">.</span><span class="ident" id="5789028">LoadAddress</span>&nbsp;<span class="op" id="5789040">=</span>&nbsp;<span class="num" id="5789042">0x200000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789053">f</span><span class="op" id="5789054">.</span><span class="ident" id="5789055">HdrSize</span>&nbsp;<span class="op" id="5789063">+=</span>&nbsp;<span class="num" id="5789066">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789073">var</span>&nbsp;<span class="ident" id="5789077">sects</span>&nbsp;<span class="op" id="5789083">=</span>&nbsp;<span class="op" id="5789085">[</span><span class="op" id="5789086">]</span><span class="keyword" id="5789087">struct</span>&nbsp;<span class="op" id="5789094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789098">name</span>&nbsp;<span class="builtintype" id="5789103">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789112">size</span>&nbsp;<span class="builtintype" id="5789117">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789125">}</span><span class="op" id="5789126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789130">{</span><span class="string" id="5789131">&#34;text&#34;</span><span class="op" id="5789137">,</span>&nbsp;<span class="ident" id="5789139">ph</span><span class="op" id="5789141">.</span><span class="ident" id="5789142">Text</span><span class="op" id="5789146">}</span><span class="op" id="5789147">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789151">{</span><span class="string" id="5789152">&#34;data&#34;</span><span class="op" id="5789158">,</span>&nbsp;<span class="ident" id="5789160">ph</span><span class="op" id="5789162">.</span><span class="ident" id="5789163">Data</span><span class="op" id="5789167">}</span><span class="op" id="5789168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789172">{</span><span class="string" id="5789173">&#34;syms&#34;</span><span class="op" id="5789179">,</span>&nbsp;<span class="ident" id="5789181">ph</span><span class="op" id="5789183">.</span><span class="ident" id="5789184">Syms</span><span class="op" id="5789188">}</span><span class="op" id="5789189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789193">{</span><span class="string" id="5789194">&#34;spsz&#34;</span><span class="op" id="5789200">,</span>&nbsp;<span class="ident" id="5789202">ph</span><span class="op" id="5789204">.</span><span class="ident" id="5789205">Spsz</span><span class="op" id="5789209">}</span><span class="op" id="5789210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789214">{</span><span class="string" id="5789215">&#34;pcsz&#34;</span><span class="op" id="5789221">,</span>&nbsp;<span class="ident" id="5789223">ph</span><span class="op" id="5789225">.</span><span class="ident" id="5789226">Pcsz</span><span class="op" id="5789230">}</span><span class="op" id="5789231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789234">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789238">f</span><span class="op" id="5789239">.</span><span class="ident" id="5789240">Sections</span>&nbsp;<span class="op" id="5789249">=</span>&nbsp;<span class="builtinfunc" id="5789251">make</span><span class="op" id="5789255">(</span><span class="op" id="5789256">[</span><span class="op" id="5789257">]</span><span class="op" id="5789258">*</span><span class="ident" id="5789259">Section</span><span class="op" id="5789266">,</span>&nbsp;<span class="num" id="5789268">5</span><span class="op" id="5789269">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789273">off</span>&nbsp;<span class="op" id="5789277">:=</span>&nbsp;<span class="builtintype" id="5789280">uint32</span><span class="op" id="5789286">(</span><span class="ident" id="5789287">f</span><span class="op" id="5789288">.</span><span class="ident" id="5789289">HdrSize</span><span class="op" id="5789296">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789300">for</span>&nbsp;<span class="ident" id="5789304">i</span><span class="op" id="5789305">,</span>&nbsp;<span class="ident" id="5789307">sect</span>&nbsp;<span class="op" id="5789312">:=</span>&nbsp;<span class="keyword" id="5789315">range</span>&nbsp;<span class="ident" id="5789321">sects</span>&nbsp;<span class="op" id="5789327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789331">s</span>&nbsp;<span class="op" id="5789333">:=</span>&nbsp;<span class="builtinfunc" id="5789336">new</span><span class="op" id="5789339">(</span><span class="ident" id="5789340">Section</span><span class="op" id="5789347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789351">s</span><span class="op" id="5789352">.</span><span class="ident" id="5789353">SectionHeader</span>&nbsp;<span class="op" id="5789367">=</span>&nbsp;<span class="ident" id="5789369">SectionHeader</span><span class="op" id="5789382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789387">Name</span><span class="op" id="5789391">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5789395">sect</span><span class="op" id="5789399">.</span><span class="ident" id="5789400">name</span><span class="op" id="5789404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789409">Size</span><span class="op" id="5789413">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5789417">sect</span><span class="op" id="5789421">.</span><span class="ident" id="5789422">size</span><span class="op" id="5789426">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789431">Offset</span><span class="op" id="5789437">:</span>&nbsp;<span class="ident" id="5789439">off</span><span class="op" id="5789442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789450">off</span>&nbsp;<span class="op" id="5789454">+=</span>&nbsp;<span class="ident" id="5789457">sect</span><span class="op" id="5789461">.</span><span class="ident" id="5789462">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789469">s</span><span class="op" id="5789470">.</span><span class="ident" id="5789471">sr</span>&nbsp;<span class="op" id="5789474">=</span>&nbsp;<span class="ident" id="5789476">io</span><span class="op" id="5789478">.</span><span class="ident" id="5789479">NewSectionReader</span><span class="op" id="5789495">(</span><span class="ident" id="5789496">r</span><span class="op" id="5789497">,</span>&nbsp;<span class="ident" id="5789499">int64</span><span class="op" id="5789504">(</span><span class="ident" id="5789505">s</span><span class="op" id="5789506">.</span><span class="ident" id="5789507">Offset</span><span class="op" id="5789513">)</span><span class="op" id="5789514">,</span>&nbsp;<span class="ident" id="5789516">int64</span><span class="op" id="5789521">(</span><span class="ident" id="5789522">s</span><span class="op" id="5789523">.</span><span class="ident" id="5789524">Size</span><span class="op" id="5789528">)</span><span class="op" id="5789529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789533">s</span><span class="op" id="5789534">.</span><span class="ident" id="5789535">ReaderAt</span>&nbsp;<span class="op" id="5789544">=</span>&nbsp;<span class="ident" id="5789546">s</span><span class="op" id="5789547">.</span><span class="ident" id="5789548">sr</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789553">f</span><span class="op" id="5789554">.</span><span class="ident" id="5789555">Sections</span><span class="op" id="5789563">[</span><span class="ident" id="5789564">i</span><span class="op" id="5789565">]</span>&nbsp;<span class="op" id="5789567">=</span>&nbsp;<span class="ident" id="5789569">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789576">return</span>&nbsp;<span class="ident" id="5789583">f</span><span class="op" id="5789584">,</span>&nbsp;<span class="ident" id="5789586">nil</span><br>
<span class="lineno"></span><span class="op" id="5789590">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="5789593">func</span>&nbsp;<span class="ident" id="5789598">walksymtab</span><span class="op" id="5789608">(</span><span class="ident" id="5789609">data</span>&nbsp;<span class="op" id="5789614">[</span><span class="op" id="5789615">]</span><span class="builtintype" id="5789616">byte</span><span class="op" id="5789620">,</span>&nbsp;<span class="ident" id="5789622">ptrsz</span>&nbsp;<span class="builtintype" id="5789628">int</span><span class="op" id="5789631">,</span>&nbsp;<span class="ident" id="5789633">fn</span>&nbsp;<span class="keyword" id="5789636">func</span><span class="op" id="5789640">(</span><span class="ident" id="5789641">sym</span><span class="op" id="5789644">)</span>&nbsp;<span class="builtintype" id="5789646">error</span><span class="op" id="5789651">)</span>&nbsp;<span class="builtintype" id="5789653">error</span>&nbsp;<span class="op" id="5789659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789662">var</span>&nbsp;<span class="ident" id="5789666">order</span>&nbsp;<span class="ident" id="5789672">binary</span><span class="op" id="5789678">.</span><span class="ident" id="5789679">ByteOrder</span>&nbsp;<span class="op" id="5789689">=</span>&nbsp;<span class="ident" id="5789691">binary</span><span class="op" id="5789697">.</span><span class="ident" id="5789698">BigEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789709">var</span>&nbsp;<span class="ident" id="5789713">s</span>&nbsp;<span class="ident" id="5789715">sym</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789720">p</span>&nbsp;<span class="op" id="5789722">:=</span>&nbsp;<span class="ident" id="5789725">data</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789731">for</span>&nbsp;<span class="builtinfunc" id="5789735">len</span><span class="op" id="5789738">(</span><span class="ident" id="5789739">p</span><span class="op" id="5789740">)</span>&nbsp;<span class="op" id="5789742">&gt;=</span>&nbsp;<span class="num" id="5789745">4</span>&nbsp;<span class="op" id="5789747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5789751">//&nbsp;Symbol&nbsp;type,&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789776">if</span>&nbsp;<span class="builtinfunc" id="5789779">len</span><span class="op" id="5789782">(</span><span class="ident" id="5789783">p</span><span class="op" id="5789784">)</span>&nbsp;<span class="op" id="5789786">&lt;</span>&nbsp;<span class="ident" id="5789788">ptrsz</span>&nbsp;<span class="op" id="5789794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789799">return</span>&nbsp;<span class="op" id="5789806">&amp;</span><span class="ident" id="5789807">formatError</span><span class="op" id="5789818">{</span><span class="builtinfunc" id="5789819">len</span><span class="op" id="5789822">(</span><span class="ident" id="5789823">data</span><span class="op" id="5789827">)</span><span class="op" id="5789828">,</span>&nbsp;<span class="string" id="5789830">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="5789846">,</span>&nbsp;<span class="ident" id="5789848">nil</span><span class="op" id="5789851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789855">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5789859">//&nbsp;fixed-width&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789882">if</span>&nbsp;<span class="ident" id="5789885">ptrsz</span>&nbsp;<span class="op" id="5789891">==</span>&nbsp;<span class="num" id="5789894">8</span>&nbsp;<span class="op" id="5789896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789901">s</span><span class="op" id="5789902">.</span><span class="ident" id="5789903">value</span>&nbsp;<span class="op" id="5789909">=</span>&nbsp;<span class="ident" id="5789911">order</span><span class="op" id="5789916">.</span><span class="ident" id="5789917">Uint64</span><span class="op" id="5789923">(</span><span class="ident" id="5789924">p</span><span class="op" id="5789925">[</span><span class="num" id="5789926">0</span><span class="op" id="5789927">:</span><span class="num" id="5789928">8</span><span class="op" id="5789929">]</span><span class="op" id="5789930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789935">p</span>&nbsp;<span class="op" id="5789937">=</span>&nbsp;<span class="ident" id="5789939">p</span><span class="op" id="5789940">[</span><span class="num" id="5789941">8</span><span class="op" id="5789942">:</span><span class="op" id="5789943">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789947">}</span>&nbsp;<span class="keyword" id="5789949">else</span>&nbsp;<span class="op" id="5789954">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789959">s</span><span class="op" id="5789960">.</span><span class="ident" id="5789961">value</span>&nbsp;<span class="op" id="5789967">=</span>&nbsp;<span class="ident" id="5789969">uint64</span><span class="op" id="5789975">(</span><span class="ident" id="5789976">order</span><span class="op" id="5789981">.</span><span class="ident" id="5789982">Uint32</span><span class="op" id="5789988">(</span><span class="ident" id="5789989">p</span><span class="op" id="5789990">[</span><span class="num" id="5789991">0</span><span class="op" id="5789992">:</span><span class="num" id="5789993">4</span><span class="op" id="5789994">]</span><span class="op" id="5789995">)</span><span class="op" id="5789996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790001">p</span>&nbsp;<span class="op" id="5790003">=</span>&nbsp;<span class="ident" id="5790005">p</span><span class="op" id="5790006">[</span><span class="num" id="5790007">4</span><span class="op" id="5790008">:</span><span class="op" id="5790009">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5790013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790018">var</span>&nbsp;<span class="ident" id="5790022">typ</span>&nbsp;<span class="builtintype" id="5790026">byte</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790033">typ</span>&nbsp;<span class="op" id="5790037">=</span>&nbsp;<span class="ident" id="5790039">p</span><span class="op" id="5790040">[</span><span class="num" id="5790041">0</span><span class="op" id="5790042">]</span>&nbsp;<span class="op" id="5790044">&amp;</span>&nbsp;<span class="num" id="5790046">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790053">s</span><span class="op" id="5790054">.</span><span class="ident" id="5790055">typ</span>&nbsp;<span class="op" id="5790059">=</span>&nbsp;<span class="ident" id="5790061">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790067">p</span>&nbsp;<span class="op" id="5790069">=</span>&nbsp;<span class="ident" id="5790071">p</span><span class="op" id="5790072">[</span><span class="num" id="5790073">1</span><span class="op" id="5790074">:</span><span class="op" id="5790075">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5790080">//&nbsp;Name.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790091">var</span>&nbsp;<span class="ident" id="5790095">i</span>&nbsp;<span class="builtintype" id="5790097">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790103">var</span>&nbsp;<span class="ident" id="5790107">nnul</span>&nbsp;<span class="builtintype" id="5790112">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790118">for</span>&nbsp;<span class="ident" id="5790122">i</span>&nbsp;<span class="op" id="5790124">=</span>&nbsp;<span class="num" id="5790126">0</span><span class="op" id="5790127">;</span>&nbsp;<span class="ident" id="5790129">i</span>&nbsp;<span class="op" id="5790131">&lt;</span>&nbsp;<span class="builtinfunc" id="5790133">len</span><span class="op" id="5790136">(</span><span class="ident" id="5790137">p</span><span class="op" id="5790138">)</span><span class="op" id="5790139">;</span>&nbsp;<span class="ident" id="5790141">i</span><span class="op" id="5790142">++</span>&nbsp;<span class="op" id="5790145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790150">if</span>&nbsp;<span class="ident" id="5790153">p</span><span class="op" id="5790154">[</span><span class="ident" id="5790155">i</span><span class="op" id="5790156">]</span>&nbsp;<span class="op" id="5790158">==</span>&nbsp;<span class="num" id="5790161">0</span>&nbsp;<span class="op" id="5790163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790169">nnul</span>&nbsp;<span class="op" id="5790174">=</span>&nbsp;<span class="num" id="5790176">1</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790182">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5790191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5790195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790199">switch</span>&nbsp;<span class="ident" id="5790206">typ</span>&nbsp;<span class="op" id="5790210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790214">case</span>&nbsp;<span class="string" id="5790219">&#39;z&#39;</span><span class="op" id="5790222">,</span>&nbsp;<span class="string" id="5790224">&#39;Z&#39;</span><span class="op" id="5790227">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790232">p</span>&nbsp;<span class="op" id="5790234">=</span>&nbsp;<span class="ident" id="5790236">p</span><span class="op" id="5790237">[</span><span class="ident" id="5790238">i</span><span class="op" id="5790239">+</span><span class="ident" id="5790240">nnul</span><span class="op" id="5790244">:</span><span class="op" id="5790245">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790250">for</span>&nbsp;<span class="ident" id="5790254">i</span>&nbsp;<span class="op" id="5790256">=</span>&nbsp;<span class="num" id="5790258">0</span><span class="op" id="5790259">;</span>&nbsp;<span class="ident" id="5790261">i</span><span class="op" id="5790262">+</span><span class="num" id="5790263">2</span>&nbsp;<span class="op" id="5790265">&lt;=</span>&nbsp;<span class="builtinfunc" id="5790268">len</span><span class="op" id="5790271">(</span><span class="ident" id="5790272">p</span><span class="op" id="5790273">)</span><span class="op" id="5790274">;</span>&nbsp;<span class="ident" id="5790276">i</span>&nbsp;<span class="op" id="5790278">+=</span>&nbsp;<span class="num" id="5790281">2</span>&nbsp;<span class="op" id="5790283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790289">if</span>&nbsp;<span class="ident" id="5790292">p</span><span class="op" id="5790293">[</span><span class="ident" id="5790294">i</span><span class="op" id="5790295">]</span>&nbsp;<span class="op" id="5790297">==</span>&nbsp;<span class="num" id="5790300">0</span>&nbsp;<span class="op" id="5790302">&amp;&amp;</span>&nbsp;<span class="ident" id="5790305">p</span><span class="op" id="5790306">[</span><span class="ident" id="5790307">i</span><span class="op" id="5790308">+</span><span class="num" id="5790309">1</span><span class="op" id="5790310">]</span>&nbsp;<span class="op" id="5790312">==</span>&nbsp;<span class="num" id="5790315">0</span>&nbsp;<span class="op" id="5790317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790324">nnul</span>&nbsp;<span class="op" id="5790329">=</span>&nbsp;<span class="num" id="5790331">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790338">break</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5790348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5790353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5790357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790361">if</span>&nbsp;<span class="builtinfunc" id="5790364">len</span><span class="op" id="5790367">(</span><span class="ident" id="5790368">p</span><span class="op" id="5790369">)</span>&nbsp;<span class="op" id="5790371">&lt;</span>&nbsp;<span class="ident" id="5790373">i</span><span class="op" id="5790374">+</span><span class="ident" id="5790375">nnul</span>&nbsp;<span class="op" id="5790380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790385">return</span>&nbsp;<span class="op" id="5790392">&amp;</span><span class="ident" id="5790393">formatError</span><span class="op" id="5790404">{</span><span class="builtinfunc" id="5790405">len</span><span class="op" id="5790408">(</span><span class="ident" id="5790409">data</span><span class="op" id="5790413">)</span><span class="op" id="5790414">,</span>&nbsp;<span class="string" id="5790416">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="5790432">,</span>&nbsp;<span class="ident" id="5790434">nil</span><span class="op" id="5790437">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5790441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790445">s</span><span class="op" id="5790446">.</span><span class="ident" id="5790447">name</span>&nbsp;<span class="op" id="5790452">=</span>&nbsp;<span class="ident" id="5790454">p</span><span class="op" id="5790455">[</span><span class="num" id="5790456">0</span><span class="op" id="5790457">:</span><span class="ident" id="5790458">i</span><span class="op" id="5790459">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790463">i</span>&nbsp;<span class="op" id="5790465">+=</span>&nbsp;<span class="ident" id="5790468">nnul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790475">p</span>&nbsp;<span class="op" id="5790477">=</span>&nbsp;<span class="ident" id="5790479">p</span><span class="op" id="5790480">[</span><span class="ident" id="5790481">i</span><span class="op" id="5790482">:</span><span class="op" id="5790483">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790488">fn</span><span class="op" id="5790490">(</span><span class="ident" id="5790491">s</span><span class="op" id="5790492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5790495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790498">return</span>&nbsp;<span class="ident" id="5790505">nil</span><br>
<span class="lineno"></span><span class="op" id="5790509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="5790512">//&nbsp;NewTable&nbsp;decodes&nbsp;the&nbsp;Go&nbsp;symbol&nbsp;table&nbsp;in&nbsp;data,</span><br>
<span class="lineno"></span><span class="comment" id="5790561">//&nbsp;returning&nbsp;an&nbsp;in-memory&nbsp;representation.</span><br>
<span class="lineno"></span><span class="keyword" id="5790603">func</span>&nbsp;<span class="ident" id="5790608">newTable</span><span class="op" id="5790616">(</span><span class="ident" id="5790617">symtab</span>&nbsp;<span class="op" id="5790624">[</span><span class="op" id="5790625">]</span><span class="builtintype" id="5790626">byte</span><span class="op" id="5790630">,</span>&nbsp;<span class="ident" id="5790632">ptrsz</span>&nbsp;<span class="builtintype" id="5790638">int</span><span class="op" id="5790641">)</span>&nbsp;<span class="op" id="5790643">(</span><span class="op" id="5790644">[</span><span class="op" id="5790645">]</span><span class="ident" id="5790646">Sym</span><span class="op" id="5790649">,</span>&nbsp;<span class="builtintype" id="5790651">error</span><span class="op" id="5790656">)</span>&nbsp;<span class="op" id="5790658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790661">var</span>&nbsp;<span class="ident" id="5790665">n</span>&nbsp;<span class="builtintype" id="5790667">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790672">err</span>&nbsp;<span class="op" id="5790676">:=</span>&nbsp;<span class="ident" id="5790679">walksymtab</span><span class="op" id="5790689">(</span><span class="ident" id="5790690">symtab</span><span class="op" id="5790696">,</span>&nbsp;<span class="ident" id="5790698">ptrsz</span><span class="op" id="5790703">,</span>&nbsp;<span class="keyword" id="5790705">func</span><span class="op" id="5790709">(</span><span class="ident" id="5790710">s</span>&nbsp;<span class="ident" id="5790712">sym</span><span class="op" id="5790715">)</span>&nbsp;<span class="builtintype" id="5790717">error</span>&nbsp;<span class="op" id="5790723">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790727">n</span><span class="op" id="5790728">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790733">return</span>&nbsp;<span class="ident" id="5790740">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5790745">}</span><span class="op" id="5790746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790749">if</span>&nbsp;<span class="ident" id="5790752">err</span>&nbsp;<span class="op" id="5790756">!=</span>&nbsp;<span class="ident" id="5790759">nil</span>&nbsp;<span class="op" id="5790763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790767">return</span>&nbsp;<span class="ident" id="5790774">nil</span><span class="op" id="5790777">,</span>&nbsp;<span class="ident" id="5790779">err</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5790784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790788">fname</span>&nbsp;<span class="op" id="5790794">:=</span>&nbsp;<span class="builtinfunc" id="5790797">make</span><span class="op" id="5790801">(</span><span class="keyword" id="5790802">map</span><span class="op" id="5790805">[</span><span class="builtintype" id="5790806">uint16</span><span class="op" id="5790812">]</span><span class="builtintype" id="5790813">string</span><span class="op" id="5790819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790822">syms</span>&nbsp;<span class="op" id="5790827">:=</span>&nbsp;<span class="builtinfunc" id="5790830">make</span><span class="op" id="5790834">(</span><span class="op" id="5790835">[</span><span class="op" id="5790836">]</span><span class="ident" id="5790837">Sym</span><span class="op" id="5790840">,</span>&nbsp;<span class="num" id="5790842">0</span><span class="op" id="5790843">,</span>&nbsp;<span class="ident" id="5790845">n</span><span class="op" id="5790846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790849">err</span>&nbsp;<span class="op" id="5790853">=</span>&nbsp;<span class="ident" id="5790855">walksymtab</span><span class="op" id="5790865">(</span><span class="ident" id="5790866">symtab</span><span class="op" id="5790872">,</span>&nbsp;<span class="ident" id="5790874">ptrsz</span><span class="op" id="5790879">,</span>&nbsp;<span class="keyword" id="5790881">func</span><span class="op" id="5790885">(</span><span class="ident" id="5790886">s</span>&nbsp;<span class="ident" id="5790888">sym</span><span class="op" id="5790891">)</span>&nbsp;<span class="builtintype" id="5790893">error</span>&nbsp;<span class="op" id="5790899">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790903">n</span>&nbsp;<span class="op" id="5790905">:=</span>&nbsp;<span class="builtinfunc" id="5790908">len</span><span class="op" id="5790911">(</span><span class="ident" id="5790912">syms</span><span class="op" id="5790916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790920">syms</span>&nbsp;<span class="op" id="5790925">=</span>&nbsp;<span class="ident" id="5790927">syms</span><span class="op" id="5790931">[</span><span class="num" id="5790932">0</span>&nbsp;<span class="op" id="5790934">:</span>&nbsp;<span class="ident" id="5790936">n</span><span class="op" id="5790937">+</span><span class="num" id="5790938">1</span><span class="op" id="5790939">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790943">ts</span>&nbsp;<span class="op" id="5790946">:=</span>&nbsp;<span class="op" id="5790949">&amp;</span><span class="ident" id="5790950">syms</span><span class="op" id="5790954">[</span><span class="ident" id="5790955">n</span><span class="op" id="5790956">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790960">ts</span><span class="op" id="5790962">.</span><span class="ident" id="5790963">Type</span>&nbsp;<span class="op" id="5790968">=</span>&nbsp;<span class="builtintype" id="5790970">rune</span><span class="op" id="5790974">(</span><span class="ident" id="5790975">s</span><span class="op" id="5790976">.</span><span class="ident" id="5790977">typ</span><span class="op" id="5790980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790984">ts</span><span class="op" id="5790986">.</span><span class="ident" id="5790987">Value</span>&nbsp;<span class="op" id="5790993">=</span>&nbsp;<span class="ident" id="5790995">s</span><span class="op" id="5790996">.</span><span class="ident" id="5790997">value</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791005">switch</span>&nbsp;<span class="ident" id="5791012">s</span><span class="op" id="5791013">.</span><span class="ident" id="5791014">typ</span>&nbsp;<span class="op" id="5791018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791022">default</span><span class="op" id="5791029">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5791034">ts</span><span class="op" id="5791036">.</span><span class="ident" id="5791037">Name</span>&nbsp;<span class="op" id="5791042">=</span>&nbsp;<span class="builtintype" id="5791044">string</span><span class="op" id="5791050">(</span><span class="ident" id="5791051">s</span><span class="op" id="5791052">.</span><span class="ident" id="5791053">name</span><span class="op" id="5791057">[</span><span class="op" id="5791058">:</span><span class="op" id="5791059">]</span><span class="op" id="5791060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791064">case</span>&nbsp;<span class="string" id="5791069">&#39;z&#39;</span><span class="op" id="5791072">,</span>&nbsp;<span class="string" id="5791074">&#39;Z&#39;</span><span class="op" id="5791077">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791082">for</span>&nbsp;<span class="ident" id="5791086">i</span>&nbsp;<span class="op" id="5791088">:=</span>&nbsp;<span class="num" id="5791091">0</span><span class="op" id="5791092">;</span>&nbsp;<span class="ident" id="5791094">i</span>&nbsp;<span class="op" id="5791096">&lt;</span>&nbsp;<span class="builtinfunc" id="5791098">len</span><span class="op" id="5791101">(</span><span class="ident" id="5791102">s</span><span class="op" id="5791103">.</span><span class="ident" id="5791104">name</span><span class="op" id="5791108">)</span><span class="op" id="5791109">;</span>&nbsp;<span class="ident" id="5791111">i</span>&nbsp;<span class="op" id="5791113">+=</span>&nbsp;<span class="num" id="5791116">2</span>&nbsp;<span class="op" id="5791118">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5791124">eltIdx</span>&nbsp;<span class="op" id="5791131">:=</span>&nbsp;<span class="ident" id="5791134">binary</span><span class="op" id="5791140">.</span><span class="ident" id="5791141">BigEndian</span><span class="op" id="5791150">.</span><span class="ident" id="5791151">Uint16</span><span class="op" id="5791157">(</span><span class="ident" id="5791158">s</span><span class="op" id="5791159">.</span><span class="ident" id="5791160">name</span><span class="op" id="5791164">[</span><span class="ident" id="5791165">i</span>&nbsp;<span class="op" id="5791167">:</span>&nbsp;<span class="ident" id="5791169">i</span><span class="op" id="5791170">+</span><span class="num" id="5791171">2</span><span class="op" id="5791172">]</span><span class="op" id="5791173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5791179">elt</span><span class="op" id="5791182">,</span>&nbsp;<span class="ident" id="5791184">ok</span>&nbsp;<span class="op" id="5791187">:=</span>&nbsp;<span class="ident" id="5791190">fname</span><span class="op" id="5791195">[</span><span class="ident" id="5791196">eltIdx</span><span class="op" id="5791202">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791208">if</span>&nbsp;<span class="op" id="5791211">!</span><span class="ident" id="5791212">ok</span>&nbsp;<span class="op" id="5791215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791222">return</span>&nbsp;<span class="op" id="5791229">&amp;</span><span class="ident" id="5791230">formatError</span><span class="op" id="5791241">{</span><span class="op" id="5791242">-</span><span class="num" id="5791243">1</span><span class="op" id="5791244">,</span>&nbsp;<span class="string" id="5791246">&#34;bad&nbsp;filename&nbsp;code&#34;</span><span class="op" id="5791265">,</span>&nbsp;<span class="ident" id="5791267">eltIdx</span><span class="op" id="5791273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5791279">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791285">if</span>&nbsp;<span class="ident" id="5791288">n</span>&nbsp;<span class="op" id="5791290">:=</span>&nbsp;<span class="builtinfunc" id="5791293">len</span><span class="op" id="5791296">(</span><span class="ident" id="5791297">ts</span><span class="op" id="5791299">.</span><span class="ident" id="5791300">Name</span><span class="op" id="5791304">)</span><span class="op" id="5791305">;</span>&nbsp;<span class="ident" id="5791307">n</span>&nbsp;<span class="op" id="5791309">&gt;</span>&nbsp;<span class="num" id="5791311">0</span>&nbsp;<span class="op" id="5791313">&amp;&amp;</span>&nbsp;<span class="ident" id="5791316">ts</span><span class="op" id="5791318">.</span><span class="ident" id="5791319">Name</span><span class="op" id="5791323">[</span><span class="ident" id="5791324">n</span><span class="op" id="5791325">-</span><span class="num" id="5791326">1</span><span class="op" id="5791327">]</span>&nbsp;<span class="op" id="5791329">!=</span>&nbsp;<span class="string" id="5791332">&#39;/&#39;</span>&nbsp;<span class="op" id="5791336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5791343">ts</span><span class="op" id="5791345">.</span><span class="ident" id="5791346">Name</span>&nbsp;<span class="op" id="5791351">+=</span>&nbsp;<span class="string" id="5791354">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5791362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5791368">ts</span><span class="op" id="5791370">.</span><span class="ident" id="5791371">Name</span>&nbsp;<span class="op" id="5791376">+=</span>&nbsp;<span class="ident" id="5791379">elt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5791386">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5791390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791394">switch</span>&nbsp;<span class="ident" id="5791401">s</span><span class="op" id="5791402">.</span><span class="ident" id="5791403">typ</span>&nbsp;<span class="op" id="5791407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791411">case</span>&nbsp;<span class="string" id="5791416">&#39;f&#39;</span><span class="op" id="5791419">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5791424">fname</span><span class="op" id="5791429">[</span><span class="builtintype" id="5791430">uint16</span><span class="op" id="5791436">(</span><span class="ident" id="5791437">s</span><span class="op" id="5791438">.</span><span class="ident" id="5791439">value</span><span class="op" id="5791444">)</span><span class="op" id="5791445">]</span>&nbsp;<span class="op" id="5791447">=</span>&nbsp;<span class="ident" id="5791449">ts</span><span class="op" id="5791451">.</span><span class="ident" id="5791452">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5791459">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791463">return</span>&nbsp;<span class="ident" id="5791470">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5791475">}</span><span class="op" id="5791476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791479">if</span>&nbsp;<span class="ident" id="5791482">err</span>&nbsp;<span class="op" id="5791486">!=</span>&nbsp;<span class="ident" id="5791489">nil</span>&nbsp;<span class="op" id="5791493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791497">return</span>&nbsp;<span class="ident" id="5791504">nil</span><span class="op" id="5791507">,</span>&nbsp;<span class="ident" id="5791509">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5791514">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791518">return</span>&nbsp;<span class="ident" id="5791525">syms</span><span class="op" id="5791529">,</span>&nbsp;<span class="ident" id="5791531">nil</span><br>
<span class="lineno"></span><span class="op" id="5791535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5791538">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.</span><br>
<span class="lineno">305</span><span class="keyword" id="5791581">func</span>&nbsp;<span class="op" id="5791586">(</span><span class="ident" id="5791587">f</span>&nbsp;<span class="op" id="5791589">*</span><span class="ident" id="5791590">File</span><span class="op" id="5791594">)</span>&nbsp;<span class="ident" id="5791596">Symbols</span><span class="op" id="5791603">(</span><span class="op" id="5791604">)</span>&nbsp;<span class="op" id="5791606">(</span><span class="op" id="5791607">[</span><span class="op" id="5791608">]</span><span class="ident" id="5791609">Sym</span><span class="op" id="5791612">,</span>&nbsp;<span class="builtintype" id="5791614">error</span><span class="op" id="5791619">)</span>&nbsp;<span class="op" id="5791621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5791624">symtabSection</span>&nbsp;<span class="op" id="5791638">:=</span>&nbsp;<span class="ident" id="5791641">f</span><span class="op" id="5791642">.</span><span class="ident" id="5791643">Section</span><span class="op" id="5791650">(</span><span class="string" id="5791651">&#34;syms&#34;</span><span class="op" id="5791657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791660">if</span>&nbsp;<span class="ident" id="5791663">symtabSection</span>&nbsp;<span class="op" id="5791677">==</span>&nbsp;<span class="ident" id="5791680">nil</span>&nbsp;<span class="op" id="5791684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791688">return</span>&nbsp;<span class="ident" id="5791695">nil</span><span class="op" id="5791698">,</span>&nbsp;<span class="ident" id="5791700">errors</span><span class="op" id="5791706">.</span><span class="ident" id="5791707">New</span><span class="op" id="5791710">(</span><span class="string" id="5791711">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5791730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5791733">}</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5791737">symtab</span><span class="op" id="5791743">,</span>&nbsp;<span class="ident" id="5791745">err</span>&nbsp;<span class="op" id="5791749">:=</span>&nbsp;<span class="ident" id="5791752">symtabSection</span><span class="op" id="5791765">.</span><span class="ident" id="5791766">Data</span><span class="op" id="5791770">(</span><span class="op" id="5791771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791774">if</span>&nbsp;<span class="ident" id="5791777">err</span>&nbsp;<span class="op" id="5791781">!=</span>&nbsp;<span class="ident" id="5791784">nil</span>&nbsp;<span class="op" id="5791788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791792">return</span>&nbsp;<span class="ident" id="5791799">nil</span><span class="op" id="5791802">,</span>&nbsp;<span class="ident" id="5791804">errors</span><span class="op" id="5791810">.</span><span class="ident" id="5791811">New</span><span class="op" id="5791814">(</span><span class="string" id="5791815">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5791843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5791846">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5791850">return</span>&nbsp;<span class="ident" id="5791857">newTable</span><span class="op" id="5791865">(</span><span class="ident" id="5791866">symtab</span><span class="op" id="5791872">,</span>&nbsp;<span class="ident" id="5791874">f</span><span class="op" id="5791875">.</span><span class="ident" id="5791876">PtrSize</span><span class="op" id="5791883">)</span><br>
<span class="lineno"></span><span class="op" id="5791885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5791888">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno">320</span><span class="comment" id="5791956">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="5791975">func</span>&nbsp;<span class="op" id="5791980">(</span><span class="ident" id="5791981">f</span>&nbsp;<span class="op" id="5791983">*</span><span class="ident" id="5791984">File</span><span class="op" id="5791988">)</span>&nbsp;<span class="ident" id="5791990">Section</span><span class="op" id="5791997">(</span><span class="ident" id="5791998">name</span>&nbsp;<span class="builtintype" id="5792003">string</span><span class="op" id="5792009">)</span>&nbsp;<span class="op" id="5792011">*</span><span class="ident" id="5792012">Section</span>&nbsp;<span class="op" id="5792020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5792023">for</span>&nbsp;<span class="ident" id="5792027">_</span><span class="op" id="5792028">,</span>&nbsp;<span class="ident" id="5792030">s</span>&nbsp;<span class="op" id="5792032">:=</span>&nbsp;<span class="keyword" id="5792035">range</span>&nbsp;<span class="ident" id="5792041">f</span><span class="op" id="5792042">.</span><span class="ident" id="5792043">Sections</span>&nbsp;<span class="op" id="5792052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5792056">if</span>&nbsp;<span class="ident" id="5792059">s</span><span class="op" id="5792060">.</span><span class="ident" id="5792061">Name</span>&nbsp;<span class="op" id="5792066">==</span>&nbsp;<span class="ident" id="5792069">name</span>&nbsp;<span class="op" id="5792074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5792079">return</span>&nbsp;<span class="ident" id="5792086">s</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5792090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5792093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5792096">return</span>&nbsp;<span class="ident" id="5792103">nil</span><br>
<span class="lineno"></span><span class="op" id="5792107">}</span>
</div>
</body>
</html>
