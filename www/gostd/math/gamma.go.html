<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1563761">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1563816">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1563870">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1563921">package</span>&nbsp;<span class="ident" id="1563929">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1563935">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="1563995">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cprob/gamma.c.</span><br>
<span class="lineno"></span><span class="comment" id="1564060">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">10</span><span class="comment" id="1564118">//</span><br>
<span class="lineno"></span><span class="comment" id="1564121">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tgamma.c</span><br>
<span class="lineno"></span><span class="comment" id="1564138">//</span><br>
<span class="lineno"></span><span class="comment" id="1564141">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="1564164">//</span><br>
<span class="lineno">15</span><span class="comment" id="1564167">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="1564180">//</span><br>
<span class="lineno"></span><span class="comment" id="1564183">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;tgamma();</span><br>
<span class="lineno"></span><span class="comment" id="1564209">//&nbsp;extern&nbsp;int&nbsp;signgam;</span><br>
<span class="lineno"></span><span class="comment" id="1564232">//</span><br>
<span class="lineno">20</span><span class="comment" id="1564235">//&nbsp;y&nbsp;=&nbsp;tgamma(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="1564255">//</span><br>
<span class="lineno"></span><span class="comment" id="1564258">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="1564274">//</span><br>
<span class="lineno"></span><span class="comment" id="1564277">//&nbsp;Returns&nbsp;gamma&nbsp;function&nbsp;of&nbsp;the&nbsp;argument.&nbsp;&nbsp;The&nbsp;result&nbsp;is</span><br>
<span class="lineno">25</span><span class="comment" id="1564335">//&nbsp;correctly&nbsp;signed,&nbsp;and&nbsp;the&nbsp;sign&nbsp;(+1&nbsp;or&nbsp;-1)&nbsp;is&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="1564388">//&nbsp;returned&nbsp;in&nbsp;a&nbsp;global&nbsp;(extern)&nbsp;variable&nbsp;named&nbsp;signgam.</span><br>
<span class="lineno"></span><span class="comment" id="1564445">//&nbsp;This&nbsp;variable&nbsp;is&nbsp;also&nbsp;filled&nbsp;in&nbsp;by&nbsp;the&nbsp;logarithmic&nbsp;gamma</span><br>
<span class="lineno"></span><span class="comment" id="1564505">//&nbsp;function&nbsp;lgamma().</span><br>
<span class="lineno"></span><span class="comment" id="1564527">//</span><br>
<span class="lineno">30</span><span class="comment" id="1564530">//&nbsp;Arguments&nbsp;|x|&nbsp;&lt;=&nbsp;34&nbsp;are&nbsp;reduced&nbsp;by&nbsp;recurrence&nbsp;and&nbsp;the&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="1564596">//&nbsp;approximated&nbsp;by&nbsp;a&nbsp;rational&nbsp;function&nbsp;of&nbsp;degree&nbsp;6/7&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1564656">//&nbsp;interval&nbsp;(2,3).&nbsp;&nbsp;Large&nbsp;arguments&nbsp;are&nbsp;handled&nbsp;by&nbsp;Stirling&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="1564718">//&nbsp;formula.&nbsp;Large&nbsp;negative&nbsp;arguments&nbsp;are&nbsp;made&nbsp;positive&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="1564779">//&nbsp;a&nbsp;reflection&nbsp;formula.</span><br>
<span class="lineno">35</span><span class="comment" id="1564804">//</span><br>
<span class="lineno"></span><span class="comment" id="1564807">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="1564820">//</span><br>
<span class="lineno"></span><span class="comment" id="1564823">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="1564863">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="1564921">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-34,&nbsp;34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.3e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.5e-17</span><br>
<span class="lineno"></span><span class="comment" id="1564981">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;-170,-33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.3e-16</span><br>
<span class="lineno"></span><span class="comment" id="1565041">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-33,&nbsp;&nbsp;33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="1565101">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33,&nbsp;171.6&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="1565161">//</span><br>
<span class="lineno">45</span><span class="comment" id="1565164">//&nbsp;Error&nbsp;for&nbsp;arguments&nbsp;outside&nbsp;the&nbsp;test&nbsp;range&nbsp;will&nbsp;be&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="1565225">//&nbsp;owing&nbsp;to&nbsp;error&nbsp;amplification&nbsp;by&nbsp;the&nbsp;exponential&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="1565286">//</span><br>
<span class="lineno"></span><span class="comment" id="1565289">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="1565337">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">50</span><span class="comment" id="1565401">//</span><br>
<span class="lineno"></span><span class="comment" id="1565404">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="1565465">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1565535">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="1565610">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">55</span><span class="comment" id="1565677">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="1565750">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1565822">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="1565836">//</span><br>
<span class="lineno"></span><span class="comment" id="1565839">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">60</span><span class="comment" id="1565905">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="1565971">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="1565984">//</span><br>
<span class="lineno"></span><span class="comment" id="1565987">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="1566011">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="1566041">var</span>&nbsp;<span class="ident" id="1566045">_gamP</span>&nbsp;<span class="op" id="1566051">=</span>&nbsp;<span class="op" id="1566053">[</span><span class="op" id="1566054">...</span><span class="op" id="1566057">]</span><span class="builtintype" id="1566058">float64</span><span class="op" id="1566065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1566068">1.60119522476751861407e-04</span><span class="op" id="1566094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1566097">1.19135147006586384913e-03</span><span class="op" id="1566123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1566126">1.04213797561761569935e-02</span><span class="op" id="1566152">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1566155">4.76367800457137231464e-02</span><span class="op" id="1566181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1566184">2.07448227648435975150e-01</span><span class="op" id="1566210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1566213">4.94214826801497100753e-01</span><span class="op" id="1566239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1566242">9.99999999999999996796e-01</span><span class="op" id="1566268">,</span><br>
<span class="lineno"></span><span class="op" id="1566270">}</span><br>
<span class="lineno">75</span><span class="keyword" id="1566272">var</span>&nbsp;<span class="ident" id="1566276">_gamQ</span>&nbsp;<span class="op" id="1566282">=</span>&nbsp;<span class="op" id="1566284">[</span><span class="op" id="1566285">...</span><span class="op" id="1566288">]</span><span class="builtintype" id="1566289">float64</span><span class="op" id="1566296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1566299">-</span><span class="num" id="1566300">2.31581873324120129819e-05</span><span class="op" id="1566326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1566329">5.39605580493303397842e-04</span><span class="op" id="1566355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1566358">-</span><span class="num" id="1566359">4.45641913851797240494e-03</span><span class="op" id="1566385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1566388">1.18139785222060435552e-02</span><span class="op" id="1566414">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1566417">3.58236398605498653373e-02</span><span class="op" id="1566443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1566446">-</span><span class="num" id="1566447">2.34591795718243348568e-01</span><span class="op" id="1566473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1566476">7.14304917030273074085e-02</span><span class="op" id="1566502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1566505">1.00000000000000000320e+00</span><span class="op" id="1566531">,</span><br>
<span class="lineno"></span><span class="op" id="1566533">}</span><br>
<span class="lineno">85</span><span class="keyword" id="1566535">var</span>&nbsp;<span class="ident" id="1566539">_gamS</span>&nbsp;<span class="op" id="1566545">=</span>&nbsp;<span class="op" id="1566547">[</span><span class="op" id="1566548">...</span><span class="op" id="1566551">]</span><span class="builtintype" id="1566552">float64</span><span class="op" id="1566559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1566562">7.87311395793093628397e-04</span><span class="op" id="1566588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1566591">-</span><span class="num" id="1566592">2.29549961613378126380e-04</span><span class="op" id="1566618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1566621">-</span><span class="num" id="1566622">2.68132617805781232825e-03</span><span class="op" id="1566648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1566651">3.47222221605458667310e-03</span><span class="op" id="1566677">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1566680">8.33333333333482257126e-02</span><span class="op" id="1566706">,</span><br>
<span class="lineno"></span><span class="op" id="1566708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1566711">//&nbsp;Gamma&nbsp;function&nbsp;computed&nbsp;by&nbsp;Stirling&#39;s&nbsp;formula.</span><br>
<span class="lineno"></span><span class="comment" id="1566761">//&nbsp;The&nbsp;polynomial&nbsp;is&nbsp;valid&nbsp;for&nbsp;33&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;172.</span><br>
<span class="lineno">95</span><span class="keyword" id="1566808">func</span>&nbsp;<span class="ident" id="1566813">stirling</span><span class="op" id="1566821">(</span><span class="ident" id="1566822">x</span>&nbsp;<span class="builtintype" id="1566824">float64</span><span class="op" id="1566831">)</span>&nbsp;<span class="builtintype" id="1566833">float64</span>&nbsp;<span class="op" id="1566841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1566844">const</span>&nbsp;<span class="op" id="1566850">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566854">SqrtTwoPi</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1566866">=</span>&nbsp;<span class="num" id="1566868">2.506628274631000502417</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566894">MaxStirling</span>&nbsp;<span class="op" id="1566906">=</span>&nbsp;<span class="num" id="1566908">143.01608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1566919">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566922">w</span>&nbsp;<span class="op" id="1566924">:=</span>&nbsp;<span class="num" id="1566927">1</span>&nbsp;<span class="op" id="1566929">/</span>&nbsp;<span class="ident" id="1566931">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1566934">w</span>&nbsp;<span class="op" id="1566936">=</span>&nbsp;<span class="num" id="1566938">1</span>&nbsp;<span class="op" id="1566940">+</span>&nbsp;<span class="ident" id="1566942">w</span><span class="op" id="1566943">*</span><span class="op" id="1566944">(</span><span class="op" id="1566945">(</span><span class="op" id="1566946">(</span><span class="op" id="1566947">(</span><span class="ident" id="1566948">_gamS</span><span class="op" id="1566953">[</span><span class="num" id="1566954">0</span><span class="op" id="1566955">]</span><span class="op" id="1566956">*</span><span class="ident" id="1566957">w</span><span class="op" id="1566958">+</span><span class="ident" id="1566959">_gamS</span><span class="op" id="1566964">[</span><span class="num" id="1566965">1</span><span class="op" id="1566966">]</span><span class="op" id="1566967">)</span><span class="op" id="1566968">*</span><span class="ident" id="1566969">w</span><span class="op" id="1566970">+</span><span class="ident" id="1566971">_gamS</span><span class="op" id="1566976">[</span><span class="num" id="1566977">2</span><span class="op" id="1566978">]</span><span class="op" id="1566979">)</span><span class="op" id="1566980">*</span><span class="ident" id="1566981">w</span><span class="op" id="1566982">+</span><span class="ident" id="1566983">_gamS</span><span class="op" id="1566988">[</span><span class="num" id="1566989">3</span><span class="op" id="1566990">]</span><span class="op" id="1566991">)</span><span class="op" id="1566992">*</span><span class="ident" id="1566993">w</span><span class="op" id="1566994">+</span><span class="ident" id="1566995">_gamS</span><span class="op" id="1567000">[</span><span class="num" id="1567001">4</span><span class="op" id="1567002">]</span><span class="op" id="1567003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567006">y</span>&nbsp;<span class="op" id="1567008">:=</span>&nbsp;<span class="ident" id="1567011">Exp</span><span class="op" id="1567014">(</span><span class="ident" id="1567015">x</span><span class="op" id="1567016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567019">if</span>&nbsp;<span class="ident" id="1567022">x</span>&nbsp;<span class="op" id="1567024">&gt;</span>&nbsp;<span class="ident" id="1567026">MaxStirling</span>&nbsp;<span class="op" id="1567038">{</span>&nbsp;<span class="comment" id="1567040">//&nbsp;avoid&nbsp;Pow()&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567066">v</span>&nbsp;<span class="op" id="1567068">:=</span>&nbsp;<span class="ident" id="1567071">Pow</span><span class="op" id="1567074">(</span><span class="ident" id="1567075">x</span><span class="op" id="1567076">,</span>&nbsp;<span class="num" id="1567078">0.5</span><span class="op" id="1567081">*</span><span class="ident" id="1567082">x</span><span class="op" id="1567083">-</span><span class="num" id="1567084">0.25</span><span class="op" id="1567088">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567092">y</span>&nbsp;<span class="op" id="1567094">=</span>&nbsp;<span class="ident" id="1567096">v</span>&nbsp;<span class="op" id="1567098">*</span>&nbsp;<span class="op" id="1567100">(</span><span class="ident" id="1567101">v</span>&nbsp;<span class="op" id="1567103">/</span>&nbsp;<span class="ident" id="1567105">y</span><span class="op" id="1567106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1567109">}</span>&nbsp;<span class="keyword" id="1567111">else</span>&nbsp;<span class="op" id="1567116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567120">y</span>&nbsp;<span class="op" id="1567122">=</span>&nbsp;<span class="ident" id="1567124">Pow</span><span class="op" id="1567127">(</span><span class="ident" id="1567128">x</span><span class="op" id="1567129">,</span>&nbsp;<span class="ident" id="1567131">x</span><span class="op" id="1567132">-</span><span class="num" id="1567133">0.5</span><span class="op" id="1567136">)</span>&nbsp;<span class="op" id="1567138">/</span>&nbsp;<span class="ident" id="1567140">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1567143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567146">y</span>&nbsp;<span class="op" id="1567148">=</span>&nbsp;<span class="ident" id="1567150">SqrtTwoPi</span>&nbsp;<span class="op" id="1567160">*</span>&nbsp;<span class="ident" id="1567162">y</span>&nbsp;<span class="op" id="1567164">*</span>&nbsp;<span class="ident" id="1567166">w</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567169">return</span>&nbsp;<span class="ident" id="1567176">y</span><br>
<span class="lineno"></span><span class="op" id="1567178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1567181">//&nbsp;Gamma&nbsp;returns&nbsp;the&nbsp;Gamma&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1567223">//</span><br>
<span class="lineno">115</span><span class="comment" id="1567226">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1567248">//&nbsp;&nbsp;&nbsp;&nbspGamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1567270">//&nbsp;&nbsp;&nbsp;&nbspGamma(+0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1567290">//&nbsp;&nbsp;&nbsp;&nbspGamma(-0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="1567310">//&nbsp;&nbsp;&nbsp;&nbspGamma(x)&nbsp;=&nbsp;NaN&nbsp;for&nbsp;integer&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">120</span><span class="comment" id="1567346">//&nbsp;&nbsp;&nbsp;&nbspGamma(-Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1567367">//&nbsp;&nbsp;&nbsp;&nbspGamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1567387">func</span>&nbsp;<span class="ident" id="1567392">Gamma</span><span class="op" id="1567397">(</span><span class="ident" id="1567398">x</span>&nbsp;<span class="builtintype" id="1567400">float64</span><span class="op" id="1567407">)</span>&nbsp;<span class="builtintype" id="1567409">float64</span>&nbsp;<span class="op" id="1567417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567420">const</span>&nbsp;<span class="ident" id="1567426">Euler</span>&nbsp;<span class="op" id="1567432">=</span>&nbsp;<span class="num" id="1567434">0.57721566490153286060651209008240243104215933593992</span>&nbsp;<span class="comment" id="1567487">//&nbsp;A001620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1567499">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567517">switch</span>&nbsp;<span class="op" id="1567524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567527">case</span>&nbsp;<span class="ident" id="1567532">isNegInt</span><span class="op" id="1567540">(</span><span class="ident" id="1567541">x</span><span class="op" id="1567542">)</span>&nbsp;<span class="op" id="1567544">||</span>&nbsp;<span class="ident" id="1567547">IsInf</span><span class="op" id="1567552">(</span><span class="ident" id="1567553">x</span><span class="op" id="1567554">,</span>&nbsp;<span class="op" id="1567556">-</span><span class="num" id="1567557">1</span><span class="op" id="1567558">)</span>&nbsp;<span class="op" id="1567560">||</span>&nbsp;<span class="ident" id="1567563">IsNaN</span><span class="op" id="1567568">(</span><span class="ident" id="1567569">x</span><span class="op" id="1567570">)</span><span class="op" id="1567571">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567575">return</span>&nbsp;<span class="ident" id="1567582">NaN</span><span class="op" id="1567585">(</span><span class="op" id="1567586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567589">case</span>&nbsp;<span class="ident" id="1567594">x</span>&nbsp;<span class="op" id="1567596">==</span>&nbsp;<span class="num" id="1567599">0</span><span class="op" id="1567600">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567604">if</span>&nbsp;<span class="ident" id="1567607">Signbit</span><span class="op" id="1567614">(</span><span class="ident" id="1567615">x</span><span class="op" id="1567616">)</span>&nbsp;<span class="op" id="1567618">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567623">return</span>&nbsp;<span class="ident" id="1567630">Inf</span><span class="op" id="1567633">(</span><span class="op" id="1567634">-</span><span class="num" id="1567635">1</span><span class="op" id="1567636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1567640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567644">return</span>&nbsp;<span class="ident" id="1567651">Inf</span><span class="op" id="1567654">(</span><span class="num" id="1567655">1</span><span class="op" id="1567656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567659">case</span>&nbsp;<span class="ident" id="1567664">x</span>&nbsp;<span class="op" id="1567666">&lt;</span>&nbsp;<span class="op" id="1567668">-</span><span class="num" id="1567669">170.5674972726612</span>&nbsp;<span class="op" id="1567687">||</span>&nbsp;<span class="ident" id="1567690">x</span>&nbsp;<span class="op" id="1567692">&gt;</span>&nbsp;<span class="num" id="1567694">171.61447887182298</span><span class="op" id="1567712">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567716">return</span>&nbsp;<span class="ident" id="1567723">Inf</span><span class="op" id="1567726">(</span><span class="num" id="1567727">1</span><span class="op" id="1567728">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1567731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567734">q</span>&nbsp;<span class="op" id="1567736">:=</span>&nbsp;<span class="ident" id="1567739">Abs</span><span class="op" id="1567742">(</span><span class="ident" id="1567743">x</span><span class="op" id="1567744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567747">p</span>&nbsp;<span class="op" id="1567749">:=</span>&nbsp;<span class="ident" id="1567752">Floor</span><span class="op" id="1567757">(</span><span class="ident" id="1567758">q</span><span class="op" id="1567759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567762">if</span>&nbsp;<span class="ident" id="1567765">q</span>&nbsp;<span class="op" id="1567767">&gt;</span>&nbsp;<span class="num" id="1567769">33</span>&nbsp;<span class="op" id="1567772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567776">if</span>&nbsp;<span class="ident" id="1567779">x</span>&nbsp;<span class="op" id="1567781">&gt;=</span>&nbsp;<span class="num" id="1567784">0</span>&nbsp;<span class="op" id="1567786">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567791">return</span>&nbsp;<span class="ident" id="1567798">stirling</span><span class="op" id="1567806">(</span><span class="ident" id="1567807">x</span><span class="op" id="1567808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1567812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567816">signgam</span>&nbsp;<span class="op" id="1567824">:=</span>&nbsp;<span class="num" id="1567827">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567831">if</span>&nbsp;<span class="ident" id="1567834">ip</span>&nbsp;<span class="op" id="1567837">:=</span>&nbsp;<span class="builtintype" id="1567840">int</span><span class="op" id="1567843">(</span><span class="ident" id="1567844">p</span><span class="op" id="1567845">)</span><span class="op" id="1567846">;</span>&nbsp;<span class="ident" id="1567848">ip</span><span class="op" id="1567850">&amp;</span><span class="num" id="1567851">1</span>&nbsp;<span class="op" id="1567853">==</span>&nbsp;<span class="num" id="1567856">0</span>&nbsp;<span class="op" id="1567858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567863">signgam</span>&nbsp;<span class="op" id="1567871">=</span>&nbsp;<span class="op" id="1567873">-</span><span class="num" id="1567874">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1567878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567882">z</span>&nbsp;<span class="op" id="1567884">:=</span>&nbsp;<span class="ident" id="1567887">q</span>&nbsp;<span class="op" id="1567889">-</span>&nbsp;<span class="ident" id="1567891">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567895">if</span>&nbsp;<span class="ident" id="1567898">z</span>&nbsp;<span class="op" id="1567900">&gt;</span>&nbsp;<span class="num" id="1567902">0.5</span>&nbsp;<span class="op" id="1567906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567911">p</span>&nbsp;<span class="op" id="1567913">=</span>&nbsp;<span class="ident" id="1567915">p</span>&nbsp;<span class="op" id="1567917">+</span>&nbsp;<span class="num" id="1567919">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567924">z</span>&nbsp;<span class="op" id="1567926">=</span>&nbsp;<span class="ident" id="1567928">q</span>&nbsp;<span class="op" id="1567930">-</span>&nbsp;<span class="ident" id="1567932">p</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1567936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1567940">z</span>&nbsp;<span class="op" id="1567942">=</span>&nbsp;<span class="ident" id="1567944">q</span>&nbsp;<span class="op" id="1567946">*</span>&nbsp;<span class="ident" id="1567948">Sin</span><span class="op" id="1567951">(</span><span class="ident" id="1567952">Pi</span><span class="op" id="1567954">*</span><span class="ident" id="1567955">z</span><span class="op" id="1567956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567960">if</span>&nbsp;<span class="ident" id="1567963">z</span>&nbsp;<span class="op" id="1567965">==</span>&nbsp;<span class="num" id="1567968">0</span>&nbsp;<span class="op" id="1567970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1567975">return</span>&nbsp;<span class="ident" id="1567982">Inf</span><span class="op" id="1567985">(</span><span class="ident" id="1567986">signgam</span><span class="op" id="1567993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1567997">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568001">z</span>&nbsp;<span class="op" id="1568003">=</span>&nbsp;<span class="ident" id="1568005">Pi</span>&nbsp;<span class="op" id="1568008">/</span>&nbsp;<span class="op" id="1568010">(</span><span class="ident" id="1568011">Abs</span><span class="op" id="1568014">(</span><span class="ident" id="1568015">z</span><span class="op" id="1568016">)</span>&nbsp;<span class="op" id="1568018">*</span>&nbsp;<span class="ident" id="1568020">stirling</span><span class="op" id="1568028">(</span><span class="ident" id="1568029">q</span><span class="op" id="1568030">)</span><span class="op" id="1568031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568035">return</span>&nbsp;<span class="builtintype" id="1568042">float64</span><span class="op" id="1568049">(</span><span class="ident" id="1568050">signgam</span><span class="op" id="1568057">)</span>&nbsp;<span class="op" id="1568059">*</span>&nbsp;<span class="ident" id="1568061">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1568064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1568068">//&nbsp;Reduce&nbsp;argument</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568088">z</span>&nbsp;<span class="op" id="1568090">:=</span>&nbsp;<span class="num" id="1568093">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568098">for</span>&nbsp;<span class="ident" id="1568102">x</span>&nbsp;<span class="op" id="1568104">&gt;=</span>&nbsp;<span class="num" id="1568107">3</span>&nbsp;<span class="op" id="1568109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568113">x</span>&nbsp;<span class="op" id="1568115">=</span>&nbsp;<span class="ident" id="1568117">x</span>&nbsp;<span class="op" id="1568119">-</span>&nbsp;<span class="num" id="1568121">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568125">z</span>&nbsp;<span class="op" id="1568127">=</span>&nbsp;<span class="ident" id="1568129">z</span>&nbsp;<span class="op" id="1568131">*</span>&nbsp;<span class="ident" id="1568133">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1568136">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568139">for</span>&nbsp;<span class="ident" id="1568143">x</span>&nbsp;<span class="op" id="1568145">&lt;</span>&nbsp;<span class="num" id="1568147">0</span>&nbsp;<span class="op" id="1568149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568153">if</span>&nbsp;<span class="ident" id="1568156">x</span>&nbsp;<span class="op" id="1568158">&gt;</span>&nbsp;<span class="op" id="1568160">-</span><span class="num" id="1568161">1e-09</span>&nbsp;<span class="op" id="1568167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568172">goto</span>&nbsp;<span class="ident" id="1568177">small</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1568185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568189">z</span>&nbsp;<span class="op" id="1568191">=</span>&nbsp;<span class="ident" id="1568193">z</span>&nbsp;<span class="op" id="1568195">/</span>&nbsp;<span class="ident" id="1568197">x</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568201">x</span>&nbsp;<span class="op" id="1568203">=</span>&nbsp;<span class="ident" id="1568205">x</span>&nbsp;<span class="op" id="1568207">+</span>&nbsp;<span class="num" id="1568209">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1568212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568215">for</span>&nbsp;<span class="ident" id="1568219">x</span>&nbsp;<span class="op" id="1568221">&lt;</span>&nbsp;<span class="num" id="1568223">2</span>&nbsp;<span class="op" id="1568225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568229">if</span>&nbsp;<span class="ident" id="1568232">x</span>&nbsp;<span class="op" id="1568234">&lt;</span>&nbsp;<span class="num" id="1568236">1e-09</span>&nbsp;<span class="op" id="1568242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568247">goto</span>&nbsp;<span class="ident" id="1568252">small</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1568260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568264">z</span>&nbsp;<span class="op" id="1568266">=</span>&nbsp;<span class="ident" id="1568268">z</span>&nbsp;<span class="op" id="1568270">/</span>&nbsp;<span class="ident" id="1568272">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568276">x</span>&nbsp;<span class="op" id="1568278">=</span>&nbsp;<span class="ident" id="1568280">x</span>&nbsp;<span class="op" id="1568282">+</span>&nbsp;<span class="num" id="1568284">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1568287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568291">if</span>&nbsp;<span class="ident" id="1568294">x</span>&nbsp;<span class="op" id="1568296">==</span>&nbsp;<span class="num" id="1568299">2</span>&nbsp;<span class="op" id="1568301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568305">return</span>&nbsp;<span class="ident" id="1568312">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1568315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568319">x</span>&nbsp;<span class="op" id="1568321">=</span>&nbsp;<span class="ident" id="1568323">x</span>&nbsp;<span class="op" id="1568325">-</span>&nbsp;<span class="num" id="1568327">2</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568330">p</span>&nbsp;<span class="op" id="1568332">=</span>&nbsp;<span class="op" id="1568334">(</span><span class="op" id="1568335">(</span><span class="op" id="1568336">(</span><span class="op" id="1568337">(</span><span class="op" id="1568338">(</span><span class="ident" id="1568339">x</span><span class="op" id="1568340">*</span><span class="ident" id="1568341">_gamP</span><span class="op" id="1568346">[</span><span class="num" id="1568347">0</span><span class="op" id="1568348">]</span><span class="op" id="1568349">+</span><span class="ident" id="1568350">_gamP</span><span class="op" id="1568355">[</span><span class="num" id="1568356">1</span><span class="op" id="1568357">]</span><span class="op" id="1568358">)</span><span class="op" id="1568359">*</span><span class="ident" id="1568360">x</span><span class="op" id="1568361">+</span><span class="ident" id="1568362">_gamP</span><span class="op" id="1568367">[</span><span class="num" id="1568368">2</span><span class="op" id="1568369">]</span><span class="op" id="1568370">)</span><span class="op" id="1568371">*</span><span class="ident" id="1568372">x</span><span class="op" id="1568373">+</span><span class="ident" id="1568374">_gamP</span><span class="op" id="1568379">[</span><span class="num" id="1568380">3</span><span class="op" id="1568381">]</span><span class="op" id="1568382">)</span><span class="op" id="1568383">*</span><span class="ident" id="1568384">x</span><span class="op" id="1568385">+</span><span class="ident" id="1568386">_gamP</span><span class="op" id="1568391">[</span><span class="num" id="1568392">4</span><span class="op" id="1568393">]</span><span class="op" id="1568394">)</span><span class="op" id="1568395">*</span><span class="ident" id="1568396">x</span><span class="op" id="1568397">+</span><span class="ident" id="1568398">_gamP</span><span class="op" id="1568403">[</span><span class="num" id="1568404">5</span><span class="op" id="1568405">]</span><span class="op" id="1568406">)</span><span class="op" id="1568407">*</span><span class="ident" id="1568408">x</span>&nbsp;<span class="op" id="1568410">+</span>&nbsp;<span class="ident" id="1568412">_gamP</span><span class="op" id="1568417">[</span><span class="num" id="1568418">6</span><span class="op" id="1568419">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568422">q</span>&nbsp;<span class="op" id="1568424">=</span>&nbsp;<span class="op" id="1568426">(</span><span class="op" id="1568427">(</span><span class="op" id="1568428">(</span><span class="op" id="1568429">(</span><span class="op" id="1568430">(</span><span class="op" id="1568431">(</span><span class="ident" id="1568432">x</span><span class="op" id="1568433">*</span><span class="ident" id="1568434">_gamQ</span><span class="op" id="1568439">[</span><span class="num" id="1568440">0</span><span class="op" id="1568441">]</span><span class="op" id="1568442">+</span><span class="ident" id="1568443">_gamQ</span><span class="op" id="1568448">[</span><span class="num" id="1568449">1</span><span class="op" id="1568450">]</span><span class="op" id="1568451">)</span><span class="op" id="1568452">*</span><span class="ident" id="1568453">x</span><span class="op" id="1568454">+</span><span class="ident" id="1568455">_gamQ</span><span class="op" id="1568460">[</span><span class="num" id="1568461">2</span><span class="op" id="1568462">]</span><span class="op" id="1568463">)</span><span class="op" id="1568464">*</span><span class="ident" id="1568465">x</span><span class="op" id="1568466">+</span><span class="ident" id="1568467">_gamQ</span><span class="op" id="1568472">[</span><span class="num" id="1568473">3</span><span class="op" id="1568474">]</span><span class="op" id="1568475">)</span><span class="op" id="1568476">*</span><span class="ident" id="1568477">x</span><span class="op" id="1568478">+</span><span class="ident" id="1568479">_gamQ</span><span class="op" id="1568484">[</span><span class="num" id="1568485">4</span><span class="op" id="1568486">]</span><span class="op" id="1568487">)</span><span class="op" id="1568488">*</span><span class="ident" id="1568489">x</span><span class="op" id="1568490">+</span><span class="ident" id="1568491">_gamQ</span><span class="op" id="1568496">[</span><span class="num" id="1568497">5</span><span class="op" id="1568498">]</span><span class="op" id="1568499">)</span><span class="op" id="1568500">*</span><span class="ident" id="1568501">x</span><span class="op" id="1568502">+</span><span class="ident" id="1568503">_gamQ</span><span class="op" id="1568508">[</span><span class="num" id="1568509">6</span><span class="op" id="1568510">]</span><span class="op" id="1568511">)</span><span class="op" id="1568512">*</span><span class="ident" id="1568513">x</span>&nbsp;<span class="op" id="1568515">+</span>&nbsp;<span class="ident" id="1568517">_gamQ</span><span class="op" id="1568522">[</span><span class="num" id="1568523">7</span><span class="op" id="1568524">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568527">return</span>&nbsp;<span class="ident" id="1568534">z</span>&nbsp;<span class="op" id="1568536">*</span>&nbsp;<span class="ident" id="1568538">p</span>&nbsp;<span class="op" id="1568540">/</span>&nbsp;<span class="ident" id="1568542">q</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="1568545">small</span><span class="op" id="1568550">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568553">if</span>&nbsp;<span class="ident" id="1568556">x</span>&nbsp;<span class="op" id="1568558">==</span>&nbsp;<span class="num" id="1568561">0</span>&nbsp;<span class="op" id="1568563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568567">return</span>&nbsp;<span class="ident" id="1568574">Inf</span><span class="op" id="1568577">(</span><span class="num" id="1568578">1</span><span class="op" id="1568579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1568582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568585">return</span>&nbsp;<span class="ident" id="1568592">z</span>&nbsp;<span class="op" id="1568594">/</span>&nbsp;<span class="op" id="1568596">(</span><span class="op" id="1568597">(</span><span class="num" id="1568598">1</span>&nbsp;<span class="op" id="1568600">+</span>&nbsp;<span class="ident" id="1568602">Euler</span><span class="op" id="1568607">*</span><span class="ident" id="1568608">x</span><span class="op" id="1568609">)</span>&nbsp;<span class="op" id="1568611">*</span>&nbsp;<span class="ident" id="1568613">x</span><span class="op" id="1568614">)</span><br>
<span class="lineno"></span><span class="op" id="1568616">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="1568619">func</span>&nbsp;<span class="ident" id="1568624">isNegInt</span><span class="op" id="1568632">(</span><span class="ident" id="1568633">x</span>&nbsp;<span class="builtintype" id="1568635">float64</span><span class="op" id="1568642">)</span>&nbsp;<span class="builtintype" id="1568644">bool</span>&nbsp;<span class="op" id="1568649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568652">if</span>&nbsp;<span class="ident" id="1568655">x</span>&nbsp;<span class="op" id="1568657">&lt;</span>&nbsp;<span class="num" id="1568659">0</span>&nbsp;<span class="op" id="1568661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1568665">_</span><span class="op" id="1568666">,</span>&nbsp;<span class="ident" id="1568668">xf</span>&nbsp;<span class="op" id="1568671">:=</span>&nbsp;<span class="ident" id="1568674">Modf</span><span class="op" id="1568678">(</span><span class="ident" id="1568679">x</span><span class="op" id="1568680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568684">return</span>&nbsp;<span class="ident" id="1568691">xf</span>&nbsp;<span class="op" id="1568694">==</span>&nbsp;<span class="num" id="1568697">0</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1568700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1568703">return</span>&nbsp;<span class="builtintype" id="1568710">false</span><br>
<span class="lineno"></span><span class="op" id="1568716">}</span>
</div>
</body>
</html>
