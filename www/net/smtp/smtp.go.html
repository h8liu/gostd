<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6331521">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6331576">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6331630">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6331681">//&nbsp;Package&nbsp;smtp&nbsp;implements&nbsp;the&nbsp;Simple&nbsp;Mail&nbsp;Transfer&nbsp;Protocol&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;5321.</span><br>
<span class="lineno"></span><span class="comment" id="6331766">//&nbsp;It&nbsp;also&nbsp;implements&nbsp;the&nbsp;following&nbsp;extensions:</span><br>
<span class="lineno"></span><span class="comment" id="6331814">//&nbsp;&nbsp;&nbsp;&nbsp8BITMIME&nbsp;&nbsp;RFC&nbsp;1652</span><br>
<span class="lineno"></span><span class="comment" id="6331836">//&nbsp;&nbsp;&nbsp;&nbspAUTH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RFC&nbsp;2554</span><br>
<span class="lineno"></span><span class="comment" id="6331858">//&nbsp;&nbsp;&nbsp;&nbspSTARTTLS&nbsp;&nbsp;RFC&nbsp;3207</span><br>
<span class="lineno">10</span><span class="comment" id="6331880">//&nbsp;Additional&nbsp;extensions&nbsp;may&nbsp;be&nbsp;handled&nbsp;by&nbsp;clients.</span><br>
<span class="lineno"></span><span class="keyword" id="6331932">package</span>&nbsp;<span class="ident" id="6331940">smtp</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6331946">import</span>&nbsp;<span class="op" id="6331953">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6331956">&#34;crypto/tls&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6331970">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6331989">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6331999">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6332005">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6332012">&#34;net/textproto&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6332029">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="6332039">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6332042">//&nbsp;A&nbsp;Client&nbsp;represents&nbsp;a&nbsp;client&nbsp;connection&nbsp;to&nbsp;an&nbsp;SMTP&nbsp;server.</span><br>
<span class="lineno"></span><span class="keyword" id="6332104">type</span>&nbsp;<span class="ident" id="6332109">Client</span>&nbsp;<span class="keyword" id="6332116">struct</span>&nbsp;<span class="op" id="6332123">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332126">//&nbsp;Text&nbsp;is&nbsp;the&nbsp;textproto.Conn&nbsp;used&nbsp;by&nbsp;the&nbsp;Client.&nbsp;It&nbsp;is&nbsp;exported&nbsp;to&nbsp;allow&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332205">//&nbsp;clients&nbsp;to&nbsp;add&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332236">Text</span>&nbsp;<span class="op" id="6332241">*</span><span class="ident" id="6332242"><a href="/net/smtp/smtp.go.html#6332012">textproto</a></span><span class="op" id="6332251">.</span><span class="ident" id="6332252">Conn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332258">//&nbsp;keep&nbsp;a&nbsp;reference&nbsp;to&nbsp;the&nbsp;connection&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;create&nbsp;a&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332331">//&nbsp;connection&nbsp;later</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332352">conn</span>&nbsp;<span class="ident" id="6332357"><a href="/net/smtp/smtp.go.html#6332005">net</a></span><span class="op" id="6332360">.</span><span class="ident" id="6332361">Conn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332367">//&nbsp;whether&nbsp;the&nbsp;Client&nbsp;is&nbsp;using&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332403">tls</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6332414">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332420">serverName</span>&nbsp;<span class="builtintype" id="6332431">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332439">//&nbsp;map&nbsp;of&nbsp;supported&nbsp;extensions</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332471">ext</span>&nbsp;<span class="keyword" id="6332475">map</span><span class="op" id="6332478">[</span><span class="builtintype" id="6332479">string</span><span class="op" id="6332485">]</span><span class="builtintype" id="6332486">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332494">//&nbsp;supported&nbsp;auth&nbsp;mechanisms</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332524">auth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6332535">[</span><span class="op" id="6332536">]</span><span class="builtintype" id="6332537">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332545">localName</span>&nbsp;&nbsp;<span class="builtintype" id="6332556">string</span>&nbsp;<span class="comment" id="6332563">//&nbsp;the&nbsp;name&nbsp;to&nbsp;use&nbsp;in&nbsp;HELO/EHLO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332596">didHello</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6332607">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6332614">//&nbsp;whether&nbsp;we&#39;ve&nbsp;said&nbsp;HELO/EHLO</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332647">helloError</span>&nbsp;<span class="builtintype" id="6332658">error</span>&nbsp;&nbsp;<span class="comment" id="6332665">//&nbsp;the&nbsp;error&nbsp;from&nbsp;the&nbsp;hello</span><br>
<span class="lineno"></span><span class="op" id="6332693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6332696">//&nbsp;Dial&nbsp;returns&nbsp;a&nbsp;new&nbsp;Client&nbsp;connected&nbsp;to&nbsp;an&nbsp;SMTP&nbsp;server&nbsp;at&nbsp;addr.</span><br>
<span class="lineno"></span><span class="comment" id="6332762">//&nbsp;The&nbsp;addr&nbsp;must&nbsp;include&nbsp;a&nbsp;port&nbsp;number.</span><br>
<span class="lineno">45</span><span class="keyword" id="6332802">func</span>&nbsp;<span class="ident" id="6332807">Dial</span><span class="op" id="6332811">(</span><span class="ident" id="6332812">addr</span>&nbsp;<span class="builtintype" id="6332817">string</span><span class="op" id="6332823">)</span>&nbsp;<span class="op" id="6332825">(</span><span class="op" id="6332826">*</span><span class="ident" id="6332827"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6332833">,</span>&nbsp;<span class="builtintype" id="6332835">error</span><span class="op" id="6332840">)</span>&nbsp;<span class="op" id="6332842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332845">conn</span><span class="op" id="6332849">,</span>&nbsp;<span class="ident" id="6332851">err</span>&nbsp;<span class="op" id="6332855">:=</span>&nbsp;<span class="ident" id="6332858"><a href="/net/smtp/smtp.go.html#6332005">net</a></span><span class="op" id="6332861">.</span><span class="ident" id="6332862">Dial</span><span class="op" id="6332866">(</span><span class="string" id="6332867">&#34;tcp&#34;</span><span class="op" id="6332872">,</span>&nbsp;<span class="ident" id="6332874"><a href="/net/smtp/smtp.go.html#6332812">addr</a></span><span class="op" id="6332878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332881">if</span>&nbsp;<span class="ident" id="6332884"><a href="/net/smtp/smtp.go.html#6332851">err</a></span>&nbsp;<span class="op" id="6332888">!=</span>&nbsp;<span class="ident" id="6332891">nil</span>&nbsp;<span class="op" id="6332895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332899">return</span>&nbsp;<span class="ident" id="6332906">nil</span><span class="op" id="6332909">,</span>&nbsp;<span class="ident" id="6332911"><a href="/net/smtp/smtp.go.html#6332851">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6332916">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332919">host</span><span class="op" id="6332923">,</span>&nbsp;<span class="ident" id="6332925">_</span><span class="op" id="6332926">,</span>&nbsp;<span class="ident" id="6332928">_</span>&nbsp;<span class="op" id="6332930">:=</span>&nbsp;<span class="ident" id="6332933"><a href="/net/smtp/smtp.go.html#6332005">net</a></span><span class="op" id="6332936">.</span><span class="ident" id="6332937">SplitHostPort</span><span class="op" id="6332950">(</span><span class="ident" id="6332951"><a href="/net/smtp/smtp.go.html#6332812">addr</a></span><span class="op" id="6332955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6332958">return</span>&nbsp;<span class="ident" id="6332965"><a href="/net/smtp/smtp.go.html#6333119">NewClient</a></span><span class="op" id="6332974">(</span><span class="ident" id="6332975"><a href="/net/smtp/smtp.go.html#6332845">conn</a></span><span class="op" id="6332979">,</span>&nbsp;<span class="ident" id="6332981"><a href="/net/smtp/smtp.go.html#6332919">host</a></span><span class="op" id="6332985">)</span><br>
<span class="lineno"></span><span class="op" id="6332987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6332990">//&nbsp;NewClient&nbsp;returns&nbsp;a&nbsp;new&nbsp;Client&nbsp;using&nbsp;an&nbsp;existing&nbsp;connection&nbsp;and&nbsp;host&nbsp;as&nbsp;a</span><br>
<span class="lineno">55</span><span class="comment" id="6333067">//&nbsp;server&nbsp;name&nbsp;to&nbsp;be&nbsp;used&nbsp;when&nbsp;authenticating.</span><br>
<span class="lineno"></span><span class="keyword" id="6333114">func</span>&nbsp;<span class="ident" id="6333119">NewClient</span><span class="op" id="6333128">(</span><span class="ident" id="6333129">conn</span>&nbsp;<span class="ident" id="6333134"><a href="/net/smtp/smtp.go.html#6332005">net</a></span><span class="op" id="6333137">.</span><span class="ident" id="6333138">Conn</span><span class="op" id="6333142">,</span>&nbsp;<span class="ident" id="6333144">host</span>&nbsp;<span class="builtintype" id="6333149">string</span><span class="op" id="6333155">)</span>&nbsp;<span class="op" id="6333157">(</span><span class="op" id="6333158">*</span><span class="ident" id="6333159"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6333165">,</span>&nbsp;<span class="builtintype" id="6333167">error</span><span class="op" id="6333172">)</span>&nbsp;<span class="op" id="6333174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333177">text</span>&nbsp;<span class="op" id="6333182">:=</span>&nbsp;<span class="ident" id="6333185"><a href="/net/smtp/smtp.go.html#6332012">textproto</a></span><span class="op" id="6333194">.</span><span class="ident" id="6333195">NewConn</span><span class="op" id="6333202">(</span><span class="ident" id="6333203"><a href="/net/smtp/smtp.go.html#6333129">conn</a></span><span class="op" id="6333207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333210">_</span><span class="op" id="6333211">,</span>&nbsp;<span class="ident" id="6333213">_</span><span class="op" id="6333214">,</span>&nbsp;<span class="ident" id="6333216">err</span>&nbsp;<span class="op" id="6333220">:=</span>&nbsp;<span class="ident" id="6333223"><a href="/net/smtp/smtp.go.html#6333177">text</a></span><span class="op" id="6333227">.</span><span class="ident" id="6333228">ReadResponse</span><span class="op" id="6333240">(</span><span class="num" id="6333241">220</span><span class="op" id="6333244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333247">if</span>&nbsp;<span class="ident" id="6333250"><a href="/net/smtp/smtp.go.html#6333216">err</a></span>&nbsp;<span class="op" id="6333254">!=</span>&nbsp;<span class="ident" id="6333257">nil</span>&nbsp;<span class="op" id="6333261">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333265"><a href="/net/smtp/smtp.go.html#6333177">text</a></span><span class="op" id="6333269">.</span><span class="ident" id="6333270">Close</span><span class="op" id="6333275">(</span><span class="op" id="6333276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333280">return</span>&nbsp;<span class="ident" id="6333287">nil</span><span class="op" id="6333290">,</span>&nbsp;<span class="ident" id="6333292"><a href="/net/smtp/smtp.go.html#6333216">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6333297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333300">c</span>&nbsp;<span class="op" id="6333302">:=</span>&nbsp;<span class="op" id="6333305">&amp;</span><span class="ident" id="6333306"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6333312">{</span><span class="ident" id="6333313">Text</span><span class="op" id="6333317">:</span>&nbsp;<span class="ident" id="6333319"><a href="/net/smtp/smtp.go.html#6333177">text</a></span><span class="op" id="6333323">,</span>&nbsp;<span class="ident" id="6333325">conn</span><span class="op" id="6333329">:</span>&nbsp;<span class="ident" id="6333331"><a href="/net/smtp/smtp.go.html#6333129">conn</a></span><span class="op" id="6333335">,</span>&nbsp;<span class="ident" id="6333337">serverName</span><span class="op" id="6333347">:</span>&nbsp;<span class="ident" id="6333349"><a href="/net/smtp/smtp.go.html#6333144">host</a></span><span class="op" id="6333353">,</span>&nbsp;<span class="ident" id="6333355">localName</span><span class="op" id="6333364">:</span>&nbsp;<span class="string" id="6333366">&#34;localhost&#34;</span><span class="op" id="6333377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333380">return</span>&nbsp;<span class="ident" id="6333387"><a href="/net/smtp/smtp.go.html#6333300">c</a></span><span class="op" id="6333388">,</span>&nbsp;<span class="ident" id="6333390">nil</span><br>
<span class="lineno">65</span><span class="op" id="6333394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6333397">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="6333429">func</span>&nbsp;<span class="op" id="6333434">(</span><span class="ident" id="6333435">c</span>&nbsp;<span class="op" id="6333437">*</span><span class="ident" id="6333438"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6333444">)</span>&nbsp;<span class="ident" id="6333446">Close</span><span class="op" id="6333451">(</span><span class="op" id="6333452">)</span>&nbsp;<span class="builtintype" id="6333454">error</span>&nbsp;<span class="op" id="6333460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333463">return</span>&nbsp;<span class="ident" id="6333470"><a href="/net/smtp/smtp.go.html#6333435">c</a></span><span class="op" id="6333471">.</span><span class="ident" id="6333472">Text</span><span class="op" id="6333476">.</span><span class="ident" id="6333477">Close</span><span class="op" id="6333482">(</span><span class="op" id="6333483">)</span><br>
<span class="lineno">70</span><span class="op" id="6333485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6333488">//&nbsp;hello&nbsp;runs&nbsp;a&nbsp;hello&nbsp;exchange&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span><span class="keyword" id="6333530">func</span>&nbsp;<span class="op" id="6333535">(</span><span class="ident" id="6333536">c</span>&nbsp;<span class="op" id="6333538">*</span><span class="ident" id="6333539"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6333545">)</span>&nbsp;<span class="ident" id="6333547">hello</span><span class="op" id="6333552">(</span><span class="op" id="6333553">)</span>&nbsp;<span class="builtintype" id="6333555">error</span>&nbsp;<span class="op" id="6333561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333564">if</span>&nbsp;<span class="op" id="6333567">!</span><span class="ident" id="6333568"><a href="/net/smtp/smtp.go.html#6333536">c</a></span><span class="op" id="6333569">.</span><span class="ident" id="6333570">didHello</span>&nbsp;<span class="op" id="6333579">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333583"><a href="/net/smtp/smtp.go.html#6333536">c</a></span><span class="op" id="6333584">.</span><span class="ident" id="6333585">didHello</span>&nbsp;<span class="op" id="6333594">=</span>&nbsp;<span class="builtintype" id="6333596">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333603">err</span>&nbsp;<span class="op" id="6333607">:=</span>&nbsp;<span class="ident" id="6333610"><a href="/net/smtp/smtp.go.html#6333536">c</a></span><span class="op" id="6333611">.</span><span class="ident" id="6333612">ehlo</span><span class="op" id="6333616">(</span><span class="op" id="6333617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333621">if</span>&nbsp;<span class="ident" id="6333624"><a href="/net/smtp/smtp.go.html#6333603">err</a></span>&nbsp;<span class="op" id="6333628">!=</span>&nbsp;<span class="ident" id="6333631">nil</span>&nbsp;<span class="op" id="6333635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333640"><a href="/net/smtp/smtp.go.html#6333536">c</a></span><span class="op" id="6333641">.</span><span class="ident" id="6333642">helloError</span>&nbsp;<span class="op" id="6333653">=</span>&nbsp;<span class="ident" id="6333655"><a href="/net/smtp/smtp.go.html#6333536">c</a></span><span class="op" id="6333656">.</span><span class="ident" id="6333657">helo</span><span class="op" id="6333661">(</span><span class="op" id="6333662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6333666">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6333669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6333672">return</span>&nbsp;<span class="ident" id="6333679"><a href="/net/smtp/smtp.go.html#6333536">c</a></span><span class="op" id="6333680">.</span><span class="ident" id="6333681">helloError</span><br>
<span class="lineno"></span><span class="op" id="6333692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6333695">//&nbsp;Hello&nbsp;sends&nbsp;a&nbsp;HELO&nbsp;or&nbsp;EHLO&nbsp;to&nbsp;the&nbsp;server&nbsp;as&nbsp;the&nbsp;given&nbsp;host&nbsp;name.</span><br>
<span class="lineno">85</span><span class="comment" id="6333763">//&nbsp;Calling&nbsp;this&nbsp;method&nbsp;is&nbsp;only&nbsp;necessary&nbsp;if&nbsp;the&nbsp;client&nbsp;needs&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="6333832">//&nbsp;over&nbsp;the&nbsp;host&nbsp;name&nbsp;used.&nbsp;&nbsp;The&nbsp;client&nbsp;will&nbsp;introduce&nbsp;itself&nbsp;as&nbsp;&#34;localhost&#34;</span><br>
<span class="lineno"></span><span class="comment" id="6333909">//&nbsp;automatically&nbsp;otherwise.&nbsp;&nbsp;If&nbsp;Hello&nbsp;is&nbsp;called,&nbsp;it&nbsp;must&nbsp;be&nbsp;called&nbsp;before</span><br>
<span class="lineno"></span><span class="comment" id="6333983">//&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="6334012">func</span>&nbsp;<span class="op" id="6334017">(</span><span class="ident" id="6334018">c</span>&nbsp;<span class="op" id="6334020">*</span><span class="ident" id="6334021"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6334027">)</span>&nbsp;<span class="ident" id="6334029">Hello</span><span class="op" id="6334034">(</span><span class="ident" id="6334035">localName</span>&nbsp;<span class="builtintype" id="6334045">string</span><span class="op" id="6334051">)</span>&nbsp;<span class="builtintype" id="6334053">error</span>&nbsp;<span class="op" id="6334059">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334062">if</span>&nbsp;<span class="ident" id="6334065"><a href="/net/smtp/smtp.go.html#6334018">c</a></span><span class="op" id="6334066">.</span><span class="ident" id="6334067">didHello</span>&nbsp;<span class="op" id="6334076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334080">return</span>&nbsp;<span class="ident" id="6334087"><a href="/net/smtp/smtp.go.html#6331989">errors</a></span><span class="op" id="6334093">.</span><span class="ident" id="6334094">New</span><span class="op" id="6334097">(</span><span class="string" id="6334098">&#34;smtp:&nbsp;Hello&nbsp;called&nbsp;after&nbsp;other&nbsp;methods&#34;</span><span class="op" id="6334138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6334141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334144"><a href="/net/smtp/smtp.go.html#6334018">c</a></span><span class="op" id="6334145">.</span><span class="ident" id="6334146">localName</span>&nbsp;<span class="op" id="6334156">=</span>&nbsp;<span class="ident" id="6334158"><a href="/net/smtp/smtp.go.html#6334035">localName</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334169">return</span>&nbsp;<span class="ident" id="6334176"><a href="/net/smtp/smtp.go.html#6334018">c</a></span><span class="op" id="6334177">.</span><span class="ident" id="6334178">hello</span><span class="op" id="6334183">(</span><span class="op" id="6334184">)</span><br>
<span class="lineno">95</span><span class="op" id="6334186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6334189">//&nbsp;cmd&nbsp;is&nbsp;a&nbsp;convenience&nbsp;function&nbsp;that&nbsp;sends&nbsp;a&nbsp;command&nbsp;and&nbsp;returns&nbsp;the&nbsp;response</span><br>
<span class="lineno"></span><span class="keyword" id="6334268">func</span>&nbsp;<span class="op" id="6334273">(</span><span class="ident" id="6334274">c</span>&nbsp;<span class="op" id="6334276">*</span><span class="ident" id="6334277"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6334283">)</span>&nbsp;<span class="ident" id="6334285">cmd</span><span class="op" id="6334288">(</span><span class="ident" id="6334289">expectCode</span>&nbsp;<span class="builtintype" id="6334300">int</span><span class="op" id="6334303">,</span>&nbsp;<span class="ident" id="6334305">format</span>&nbsp;<span class="builtintype" id="6334312">string</span><span class="op" id="6334318">,</span>&nbsp;<span class="ident" id="6334320">args</span>&nbsp;<span class="op" id="6334325">...</span><span class="keyword" id="6334328">interface</span><span class="op" id="6334337">{</span><span class="op" id="6334338">}</span><span class="op" id="6334339">)</span>&nbsp;<span class="op" id="6334341">(</span><span class="builtintype" id="6334342">int</span><span class="op" id="6334345">,</span>&nbsp;<span class="builtintype" id="6334347">string</span><span class="op" id="6334353">,</span>&nbsp;<span class="builtintype" id="6334355">error</span><span class="op" id="6334360">)</span>&nbsp;<span class="op" id="6334362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334365">id</span><span class="op" id="6334367">,</span>&nbsp;<span class="ident" id="6334369">err</span>&nbsp;<span class="op" id="6334373">:=</span>&nbsp;<span class="ident" id="6334376"><a href="/net/smtp/smtp.go.html#6334274">c</a></span><span class="op" id="6334377">.</span><span class="ident" id="6334378">Text</span><span class="op" id="6334382">.</span><span class="ident" id="6334383">Cmd</span><span class="op" id="6334386">(</span><span class="ident" id="6334387"><a href="/net/smtp/smtp.go.html#6334305">format</a></span><span class="op" id="6334393">,</span>&nbsp;<span class="ident" id="6334395"><a href="/net/smtp/smtp.go.html#6334320">args</a></span><span class="op" id="6334399">...</span><span class="op" id="6334402">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334405">if</span>&nbsp;<span class="ident" id="6334408"><a href="/net/smtp/smtp.go.html#6334369">err</a></span>&nbsp;<span class="op" id="6334412">!=</span>&nbsp;<span class="ident" id="6334415">nil</span>&nbsp;<span class="op" id="6334419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334423">return</span>&nbsp;<span class="num" id="6334430">0</span><span class="op" id="6334431">,</span>&nbsp;<span class="string" id="6334433">&#34;&#34;</span><span class="op" id="6334435">,</span>&nbsp;<span class="ident" id="6334437"><a href="/net/smtp/smtp.go.html#6334369">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6334442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334445"><a href="/net/smtp/smtp.go.html#6334274">c</a></span><span class="op" id="6334446">.</span><span class="ident" id="6334447">Text</span><span class="op" id="6334451">.</span><span class="ident" id="6334452">StartResponse</span><span class="op" id="6334465">(</span><span class="ident" id="6334466"><a href="/net/smtp/smtp.go.html#6334365">id</a></span><span class="op" id="6334468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334471">defer</span>&nbsp;<span class="ident" id="6334477"><a href="/net/smtp/smtp.go.html#6334274">c</a></span><span class="op" id="6334478">.</span><span class="ident" id="6334479">Text</span><span class="op" id="6334483">.</span><span class="ident" id="6334484">EndResponse</span><span class="op" id="6334495">(</span><span class="ident" id="6334496"><a href="/net/smtp/smtp.go.html#6334365">id</a></span><span class="op" id="6334498">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334501">code</span><span class="op" id="6334505">,</span>&nbsp;<span class="ident" id="6334507">msg</span><span class="op" id="6334510">,</span>&nbsp;<span class="ident" id="6334512"><a href="/net/smtp/smtp.go.html#6334369">err</a></span>&nbsp;<span class="op" id="6334516">:=</span>&nbsp;<span class="ident" id="6334519"><a href="/net/smtp/smtp.go.html#6334274">c</a></span><span class="op" id="6334520">.</span><span class="ident" id="6334521">Text</span><span class="op" id="6334525">.</span><span class="ident" id="6334526">ReadResponse</span><span class="op" id="6334538">(</span><span class="ident" id="6334539"><a href="/net/smtp/smtp.go.html#6334289">expectCode</a></span><span class="op" id="6334549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334552">return</span>&nbsp;<span class="ident" id="6334559"><a href="/net/smtp/smtp.go.html#6334501">code</a></span><span class="op" id="6334563">,</span>&nbsp;<span class="ident" id="6334565"><a href="/net/smtp/smtp.go.html#6334507">msg</a></span><span class="op" id="6334568">,</span>&nbsp;<span class="ident" id="6334570"><a href="/net/smtp/smtp.go.html#6334369">err</a></span><br>
<span class="lineno"></span><span class="op" id="6334574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6334577">//&nbsp;helo&nbsp;sends&nbsp;the&nbsp;HELO&nbsp;greeting&nbsp;to&nbsp;the&nbsp;server.&nbsp;It&nbsp;should&nbsp;be&nbsp;used&nbsp;only&nbsp;when&nbsp;the</span><br>
<span class="lineno">110</span><span class="comment" id="6334656">//&nbsp;server&nbsp;does&nbsp;not&nbsp;support&nbsp;ehlo.</span><br>
<span class="lineno"></span><span class="keyword" id="6334689">func</span>&nbsp;<span class="op" id="6334694">(</span><span class="ident" id="6334695">c</span>&nbsp;<span class="op" id="6334697">*</span><span class="ident" id="6334698"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6334704">)</span>&nbsp;<span class="ident" id="6334706">helo</span><span class="op" id="6334710">(</span><span class="op" id="6334711">)</span>&nbsp;<span class="builtintype" id="6334713">error</span>&nbsp;<span class="op" id="6334719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334722"><a href="/net/smtp/smtp.go.html#6334695">c</a></span><span class="op" id="6334723">.</span><span class="ident" id="6334724">ext</span>&nbsp;<span class="op" id="6334728">=</span>&nbsp;<span class="ident" id="6334730">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334735">_</span><span class="op" id="6334736">,</span>&nbsp;<span class="ident" id="6334738">_</span><span class="op" id="6334739">,</span>&nbsp;<span class="ident" id="6334741">err</span>&nbsp;<span class="op" id="6334745">:=</span>&nbsp;<span class="ident" id="6334748"><a href="/net/smtp/smtp.go.html#6334695">c</a></span><span class="op" id="6334749">.</span><span class="ident" id="6334750">cmd</span><span class="op" id="6334753">(</span><span class="num" id="6334754">250</span><span class="op" id="6334757">,</span>&nbsp;<span class="string" id="6334759">&#34;HELO&nbsp;%s&#34;</span><span class="op" id="6334768">,</span>&nbsp;<span class="ident" id="6334770"><a href="/net/smtp/smtp.go.html#6334695">c</a></span><span class="op" id="6334771">.</span><span class="ident" id="6334772">localName</span><span class="op" id="6334781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334784">return</span>&nbsp;<span class="ident" id="6334791"><a href="/net/smtp/smtp.go.html#6334741">err</a></span><br>
<span class="lineno">115</span><span class="op" id="6334795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6334798">//&nbsp;ehlo&nbsp;sends&nbsp;the&nbsp;EHLO&nbsp;(extended&nbsp;hello)&nbsp;greeting&nbsp;to&nbsp;the&nbsp;server.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="6334865">//&nbsp;should&nbsp;be&nbsp;the&nbsp;preferred&nbsp;greeting&nbsp;for&nbsp;servers&nbsp;that&nbsp;support&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="6334930">func</span>&nbsp;<span class="op" id="6334935">(</span><span class="ident" id="6334936">c</span>&nbsp;<span class="op" id="6334938">*</span><span class="ident" id="6334939"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6334945">)</span>&nbsp;<span class="ident" id="6334947">ehlo</span><span class="op" id="6334951">(</span><span class="op" id="6334952">)</span>&nbsp;<span class="builtintype" id="6334954">error</span>&nbsp;<span class="op" id="6334960">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334963">_</span><span class="op" id="6334964">,</span>&nbsp;<span class="ident" id="6334966">msg</span><span class="op" id="6334969">,</span>&nbsp;<span class="ident" id="6334971">err</span>&nbsp;<span class="op" id="6334975">:=</span>&nbsp;<span class="ident" id="6334978"><a href="/net/smtp/smtp.go.html#6334936">c</a></span><span class="op" id="6334979">.</span><span class="ident" id="6334980">cmd</span><span class="op" id="6334983">(</span><span class="num" id="6334984">250</span><span class="op" id="6334987">,</span>&nbsp;<span class="string" id="6334989">&#34;EHLO&nbsp;%s&#34;</span><span class="op" id="6334998">,</span>&nbsp;<span class="ident" id="6335000"><a href="/net/smtp/smtp.go.html#6334936">c</a></span><span class="op" id="6335001">.</span><span class="ident" id="6335002">localName</span><span class="op" id="6335011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335014">if</span>&nbsp;<span class="ident" id="6335017"><a href="/net/smtp/smtp.go.html#6334971">err</a></span>&nbsp;<span class="op" id="6335021">!=</span>&nbsp;<span class="ident" id="6335024">nil</span>&nbsp;<span class="op" id="6335028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335032">return</span>&nbsp;<span class="ident" id="6335039"><a href="/net/smtp/smtp.go.html#6334971">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335047">ext</span>&nbsp;<span class="op" id="6335051">:=</span>&nbsp;<span class="builtinfunc" id="6335054">make</span><span class="op" id="6335058">(</span><span class="keyword" id="6335059">map</span><span class="op" id="6335062">[</span><span class="builtintype" id="6335063">string</span><span class="op" id="6335069">]</span><span class="builtintype" id="6335070">string</span><span class="op" id="6335076">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335079">extList</span>&nbsp;<span class="op" id="6335087">:=</span>&nbsp;<span class="ident" id="6335090"><a href="/net/smtp/smtp.go.html#6332029">strings</a></span><span class="op" id="6335097">.</span><span class="ident" id="6335098">Split</span><span class="op" id="6335103">(</span><span class="ident" id="6335104"><a href="/net/smtp/smtp.go.html#6334966">msg</a></span><span class="op" id="6335107">,</span>&nbsp;<span class="string" id="6335109">&#34;\n&#34;</span><span class="op" id="6335113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335116">if</span>&nbsp;<span class="builtinfunc" id="6335119">len</span><span class="op" id="6335122">(</span><span class="ident" id="6335123"><a href="/net/smtp/smtp.go.html#6335079">extList</a></span><span class="op" id="6335130">)</span>&nbsp;<span class="op" id="6335132">&gt;</span>&nbsp;<span class="num" id="6335134">1</span>&nbsp;<span class="op" id="6335136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335140"><a href="/net/smtp/smtp.go.html#6335079">extList</a></span>&nbsp;<span class="op" id="6335148">=</span>&nbsp;<span class="ident" id="6335150"><a href="/net/smtp/smtp.go.html#6335079">extList</a></span><span class="op" id="6335157">[</span><span class="num" id="6335158">1</span><span class="op" id="6335159">:</span><span class="op" id="6335160">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335164">for</span>&nbsp;<span class="ident" id="6335168">_</span><span class="op" id="6335169">,</span>&nbsp;<span class="ident" id="6335171">line</span>&nbsp;<span class="op" id="6335176">:=</span>&nbsp;<span class="keyword" id="6335179">range</span>&nbsp;<span class="ident" id="6335185"><a href="/net/smtp/smtp.go.html#6335079">extList</a></span>&nbsp;<span class="op" id="6335193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335198">args</span>&nbsp;<span class="op" id="6335203">:=</span>&nbsp;<span class="ident" id="6335206"><a href="/net/smtp/smtp.go.html#6332029">strings</a></span><span class="op" id="6335213">.</span><span class="ident" id="6335214">SplitN</span><span class="op" id="6335220">(</span><span class="ident" id="6335221"><a href="/net/smtp/smtp.go.html#6335171">line</a></span><span class="op" id="6335225">,</span>&nbsp;<span class="string" id="6335227">&#34;&nbsp;&#34;</span><span class="op" id="6335230">,</span>&nbsp;<span class="num" id="6335232">2</span><span class="op" id="6335233">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335238">if</span>&nbsp;<span class="builtinfunc" id="6335241">len</span><span class="op" id="6335244">(</span><span class="ident" id="6335245"><a href="/net/smtp/smtp.go.html#6335198">args</a></span><span class="op" id="6335249">)</span>&nbsp;<span class="op" id="6335251">&gt;</span>&nbsp;<span class="num" id="6335253">1</span>&nbsp;<span class="op" id="6335255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335261"><a href="/net/smtp/smtp.go.html#6335047">ext</a></span><span class="op" id="6335264">[</span><span class="ident" id="6335265"><a href="/net/smtp/smtp.go.html#6335198">args</a></span><span class="op" id="6335269">[</span><span class="num" id="6335270">0</span><span class="op" id="6335271">]</span><span class="op" id="6335272">]</span>&nbsp;<span class="op" id="6335274">=</span>&nbsp;<span class="ident" id="6335276"><a href="/net/smtp/smtp.go.html#6335198">args</a></span><span class="op" id="6335280">[</span><span class="num" id="6335281">1</span><span class="op" id="6335282">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335287">}</span>&nbsp;<span class="keyword" id="6335289">else</span>&nbsp;<span class="op" id="6335294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335300"><a href="/net/smtp/smtp.go.html#6335047">ext</a></span><span class="op" id="6335303">[</span><span class="ident" id="6335304"><a href="/net/smtp/smtp.go.html#6335198">args</a></span><span class="op" id="6335308">[</span><span class="num" id="6335309">0</span><span class="op" id="6335310">]</span><span class="op" id="6335311">]</span>&nbsp;<span class="op" id="6335313">=</span>&nbsp;<span class="string" id="6335315">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335321">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335331">if</span>&nbsp;<span class="ident" id="6335334">mechs</span><span class="op" id="6335339">,</span>&nbsp;<span class="ident" id="6335341">ok</span>&nbsp;<span class="op" id="6335344">:=</span>&nbsp;<span class="ident" id="6335347"><a href="/net/smtp/smtp.go.html#6335047">ext</a></span><span class="op" id="6335350">[</span><span class="string" id="6335351">&#34;AUTH&#34;</span><span class="op" id="6335357">]</span><span class="op" id="6335358">;</span>&nbsp;<span class="ident" id="6335360"><a href="/net/smtp/smtp.go.html#6335341">ok</a></span>&nbsp;<span class="op" id="6335363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335367"><a href="/net/smtp/smtp.go.html#6334936">c</a></span><span class="op" id="6335368">.</span><span class="ident" id="6335369">auth</span>&nbsp;<span class="op" id="6335374">=</span>&nbsp;<span class="ident" id="6335376"><a href="/net/smtp/smtp.go.html#6332029">strings</a></span><span class="op" id="6335383">.</span><span class="ident" id="6335384">Split</span><span class="op" id="6335389">(</span><span class="ident" id="6335390"><a href="/net/smtp/smtp.go.html#6335334">mechs</a></span><span class="op" id="6335395">,</span>&nbsp;<span class="string" id="6335397">&#34;&nbsp;&#34;</span><span class="op" id="6335400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335403">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335406"><a href="/net/smtp/smtp.go.html#6334936">c</a></span><span class="op" id="6335407">.</span><span class="ident" id="6335408">ext</span>&nbsp;<span class="op" id="6335412">=</span>&nbsp;<span class="ident" id="6335414"><a href="/net/smtp/smtp.go.html#6335047">ext</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335419">return</span>&nbsp;<span class="ident" id="6335426"><a href="/net/smtp/smtp.go.html#6334971">err</a></span><br>
<span class="lineno"></span><span class="op" id="6335430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6335433">//&nbsp;StartTLS&nbsp;sends&nbsp;the&nbsp;STARTTLS&nbsp;command&nbsp;and&nbsp;encrypts&nbsp;all&nbsp;further&nbsp;communication.</span><br>
<span class="lineno">145</span><span class="comment" id="6335512">//&nbsp;Only&nbsp;servers&nbsp;that&nbsp;advertise&nbsp;the&nbsp;STARTTLS&nbsp;extension&nbsp;support&nbsp;this&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="6335589">func</span>&nbsp;<span class="op" id="6335594">(</span><span class="ident" id="6335595">c</span>&nbsp;<span class="op" id="6335597">*</span><span class="ident" id="6335598"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6335604">)</span>&nbsp;<span class="ident" id="6335606">StartTLS</span><span class="op" id="6335614">(</span><span class="ident" id="6335615">config</span>&nbsp;<span class="op" id="6335622">*</span><span class="ident" id="6335623"><a href="/net/smtp/smtp.go.html#6331956">tls</a></span><span class="op" id="6335626">.</span><span class="ident" id="6335627">Config</span><span class="op" id="6335633">)</span>&nbsp;<span class="builtintype" id="6335635">error</span>&nbsp;<span class="op" id="6335641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335644">if</span>&nbsp;<span class="ident" id="6335647">err</span>&nbsp;<span class="op" id="6335651">:=</span>&nbsp;<span class="ident" id="6335654"><a href="/net/smtp/smtp.go.html#6335595">c</a></span><span class="op" id="6335655">.</span><span class="ident" id="6335656">hello</span><span class="op" id="6335661">(</span><span class="op" id="6335662">)</span><span class="op" id="6335663">;</span>&nbsp;<span class="ident" id="6335665"><a href="/net/smtp/smtp.go.html#6335647">err</a></span>&nbsp;<span class="op" id="6335669">!=</span>&nbsp;<span class="ident" id="6335672">nil</span>&nbsp;<span class="op" id="6335676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335680">return</span>&nbsp;<span class="ident" id="6335687"><a href="/net/smtp/smtp.go.html#6335647">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335692">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335695">_</span><span class="op" id="6335696">,</span>&nbsp;<span class="ident" id="6335698">_</span><span class="op" id="6335699">,</span>&nbsp;<span class="ident" id="6335701">err</span>&nbsp;<span class="op" id="6335705">:=</span>&nbsp;<span class="ident" id="6335708"><a href="/net/smtp/smtp.go.html#6335595">c</a></span><span class="op" id="6335709">.</span><span class="ident" id="6335710">cmd</span><span class="op" id="6335713">(</span><span class="num" id="6335714">220</span><span class="op" id="6335717">,</span>&nbsp;<span class="string" id="6335719">&#34;STARTTLS&#34;</span><span class="op" id="6335729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335732">if</span>&nbsp;<span class="ident" id="6335735"><a href="/net/smtp/smtp.go.html#6335701">err</a></span>&nbsp;<span class="op" id="6335739">!=</span>&nbsp;<span class="ident" id="6335742">nil</span>&nbsp;<span class="op" id="6335746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335750">return</span>&nbsp;<span class="ident" id="6335757"><a href="/net/smtp/smtp.go.html#6335701">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335765"><a href="/net/smtp/smtp.go.html#6335595">c</a></span><span class="op" id="6335766">.</span><span class="ident" id="6335767">conn</span>&nbsp;<span class="op" id="6335772">=</span>&nbsp;<span class="ident" id="6335774"><a href="/net/smtp/smtp.go.html#6331956">tls</a></span><span class="op" id="6335777">.</span><span class="ident" id="6335778">Client</span><span class="op" id="6335784">(</span><span class="ident" id="6335785"><a href="/net/smtp/smtp.go.html#6335595">c</a></span><span class="op" id="6335786">.</span><span class="ident" id="6335787">conn</span><span class="op" id="6335791">,</span>&nbsp;<span class="ident" id="6335793"><a href="/net/smtp/smtp.go.html#6335615">config</a></span><span class="op" id="6335799">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335802"><a href="/net/smtp/smtp.go.html#6335595">c</a></span><span class="op" id="6335803">.</span><span class="ident" id="6335804">Text</span>&nbsp;<span class="op" id="6335809">=</span>&nbsp;<span class="ident" id="6335811"><a href="/net/smtp/smtp.go.html#6332012">textproto</a></span><span class="op" id="6335820">.</span><span class="ident" id="6335821">NewConn</span><span class="op" id="6335828">(</span><span class="ident" id="6335829"><a href="/net/smtp/smtp.go.html#6335595">c</a></span><span class="op" id="6335830">.</span><span class="ident" id="6335831">conn</span><span class="op" id="6335835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335838"><a href="/net/smtp/smtp.go.html#6335595">c</a></span><span class="op" id="6335839">.</span><span class="ident" id="6335840">tls</span>&nbsp;<span class="op" id="6335844">=</span>&nbsp;<span class="builtintype" id="6335846">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335852">return</span>&nbsp;<span class="ident" id="6335859"><a href="/net/smtp/smtp.go.html#6335595">c</a></span><span class="op" id="6335860">.</span><span class="ident" id="6335861">ehlo</span><span class="op" id="6335865">(</span><span class="op" id="6335866">)</span><br>
<span class="lineno"></span><span class="op" id="6335868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="6335871">//&nbsp;Verify&nbsp;checks&nbsp;the&nbsp;validity&nbsp;of&nbsp;an&nbsp;email&nbsp;address&nbsp;on&nbsp;the&nbsp;server.</span><br>
<span class="lineno"></span><span class="comment" id="6335936">//&nbsp;If&nbsp;Verify&nbsp;returns&nbsp;nil,&nbsp;the&nbsp;address&nbsp;is&nbsp;valid.&nbsp;A&nbsp;non-nil&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="6336001">//&nbsp;does&nbsp;not&nbsp;necessarily&nbsp;indicate&nbsp;an&nbsp;invalid&nbsp;address.&nbsp;Many&nbsp;servers</span><br>
<span class="lineno"></span><span class="comment" id="6336067">//&nbsp;will&nbsp;not&nbsp;verify&nbsp;addresses&nbsp;for&nbsp;security&nbsp;reasons.</span><br>
<span class="lineno"></span><span class="keyword" id="6336118">func</span>&nbsp;<span class="op" id="6336123">(</span><span class="ident" id="6336124">c</span>&nbsp;<span class="op" id="6336126">*</span><span class="ident" id="6336127"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6336133">)</span>&nbsp;<span class="ident" id="6336135">Verify</span><span class="op" id="6336141">(</span><span class="ident" id="6336142">addr</span>&nbsp;<span class="builtintype" id="6336147">string</span><span class="op" id="6336153">)</span>&nbsp;<span class="builtintype" id="6336155">error</span>&nbsp;<span class="op" id="6336161">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336164">if</span>&nbsp;<span class="ident" id="6336167">err</span>&nbsp;<span class="op" id="6336171">:=</span>&nbsp;<span class="ident" id="6336174"><a href="/net/smtp/smtp.go.html#6336124">c</a></span><span class="op" id="6336175">.</span><span class="ident" id="6336176">hello</span><span class="op" id="6336181">(</span><span class="op" id="6336182">)</span><span class="op" id="6336183">;</span>&nbsp;<span class="ident" id="6336185"><a href="/net/smtp/smtp.go.html#6336167">err</a></span>&nbsp;<span class="op" id="6336189">!=</span>&nbsp;<span class="ident" id="6336192">nil</span>&nbsp;<span class="op" id="6336196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336200">return</span>&nbsp;<span class="ident" id="6336207"><a href="/net/smtp/smtp.go.html#6336167">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6336212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336215">_</span><span class="op" id="6336216">,</span>&nbsp;<span class="ident" id="6336218">_</span><span class="op" id="6336219">,</span>&nbsp;<span class="ident" id="6336221">err</span>&nbsp;<span class="op" id="6336225">:=</span>&nbsp;<span class="ident" id="6336228"><a href="/net/smtp/smtp.go.html#6336124">c</a></span><span class="op" id="6336229">.</span><span class="ident" id="6336230">cmd</span><span class="op" id="6336233">(</span><span class="num" id="6336234">250</span><span class="op" id="6336237">,</span>&nbsp;<span class="string" id="6336239">&#34;VRFY&nbsp;%s&#34;</span><span class="op" id="6336248">,</span>&nbsp;<span class="ident" id="6336250"><a href="/net/smtp/smtp.go.html#6336142">addr</a></span><span class="op" id="6336254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336257">return</span>&nbsp;<span class="ident" id="6336264"><a href="/net/smtp/smtp.go.html#6336221">err</a></span><br>
<span class="lineno">170</span><span class="op" id="6336268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6336271">//&nbsp;Auth&nbsp;authenticates&nbsp;a&nbsp;client&nbsp;using&nbsp;the&nbsp;provided&nbsp;authentication&nbsp;mechanism.</span><br>
<span class="lineno"></span><span class="comment" id="6336347">//&nbsp;A&nbsp;failed&nbsp;authentication&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="6336397">//&nbsp;Only&nbsp;servers&nbsp;that&nbsp;advertise&nbsp;the&nbsp;AUTH&nbsp;extension&nbsp;support&nbsp;this&nbsp;function.</span><br>
<span class="lineno">175</span><span class="keyword" id="6336470">func</span>&nbsp;<span class="op" id="6336475">(</span><span class="ident" id="6336476">c</span>&nbsp;<span class="op" id="6336478">*</span><span class="ident" id="6336479"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6336485">)</span>&nbsp;<span class="ident" id="6336487">Auth</span><span class="op" id="6336491">(</span><span class="ident" id="6336492">a</span>&nbsp;<span class="ident" id="6336494"><a href="/net/smtp/auth.go.html#6328425">Auth</a></span><span class="op" id="6336498">)</span>&nbsp;<span class="builtintype" id="6336500">error</span>&nbsp;<span class="op" id="6336506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336509">if</span>&nbsp;<span class="ident" id="6336512">err</span>&nbsp;<span class="op" id="6336516">:=</span>&nbsp;<span class="ident" id="6336519"><a href="/net/smtp/smtp.go.html#6336476">c</a></span><span class="op" id="6336520">.</span><span class="ident" id="6336521">hello</span><span class="op" id="6336526">(</span><span class="op" id="6336527">)</span><span class="op" id="6336528">;</span>&nbsp;<span class="ident" id="6336530"><a href="/net/smtp/smtp.go.html#6336512">err</a></span>&nbsp;<span class="op" id="6336534">!=</span>&nbsp;<span class="ident" id="6336537">nil</span>&nbsp;<span class="op" id="6336541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336545">return</span>&nbsp;<span class="ident" id="6336552"><a href="/net/smtp/smtp.go.html#6336512">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6336557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336560">encoding</span>&nbsp;<span class="op" id="6336569">:=</span>&nbsp;<span class="ident" id="6336572"><a href="/net/smtp/smtp.go.html#6331970">base64</a></span><span class="op" id="6336578">.</span><span class="ident" id="6336579">StdEncoding</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336592">mech</span><span class="op" id="6336596">,</span>&nbsp;<span class="ident" id="6336598">resp</span><span class="op" id="6336602">,</span>&nbsp;<span class="ident" id="6336604">err</span>&nbsp;<span class="op" id="6336608">:=</span>&nbsp;<span class="ident" id="6336611"><a href="/net/smtp/smtp.go.html#6336492">a</a></span><span class="op" id="6336612">.</span><span class="ident" id="6336613">Start</span><span class="op" id="6336618">(</span><span class="op" id="6336619">&amp;</span><span class="ident" id="6336620"><a href="/net/smtp/auth.go.html#6329382">ServerInfo</a></span><span class="op" id="6336630">{</span><span class="ident" id="6336631"><a href="/net/smtp/smtp.go.html#6336476">c</a></span><span class="op" id="6336632">.</span><span class="ident" id="6336633">serverName</span><span class="op" id="6336643">,</span>&nbsp;<span class="ident" id="6336645"><a href="/net/smtp/smtp.go.html#6336476">c</a></span><span class="op" id="6336646">.</span><span class="ident" id="6336647">tls</span><span class="op" id="6336650">,</span>&nbsp;<span class="ident" id="6336652"><a href="/net/smtp/smtp.go.html#6336476">c</a></span><span class="op" id="6336653">.</span><span class="ident" id="6336654">auth</span><span class="op" id="6336658">}</span><span class="op" id="6336659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336662">if</span>&nbsp;<span class="ident" id="6336665"><a href="/net/smtp/smtp.go.html#6336604">err</a></span>&nbsp;<span class="op" id="6336669">!=</span>&nbsp;<span class="ident" id="6336672">nil</span>&nbsp;<span class="op" id="6336676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336680"><a href="/net/smtp/smtp.go.html#6336476">c</a></span><span class="op" id="6336681">.</span><span class="ident" id="6336682">Quit</span><span class="op" id="6336686">(</span><span class="op" id="6336687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336691">return</span>&nbsp;<span class="ident" id="6336698"><a href="/net/smtp/smtp.go.html#6336604">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6336703">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336706">resp64</span>&nbsp;<span class="op" id="6336713">:=</span>&nbsp;<span class="builtinfunc" id="6336716">make</span><span class="op" id="6336720">(</span><span class="op" id="6336721">[</span><span class="op" id="6336722">]</span><span class="builtintype" id="6336723">byte</span><span class="op" id="6336727">,</span>&nbsp;<span class="ident" id="6336729"><a href="/net/smtp/smtp.go.html#6336560">encoding</a></span><span class="op" id="6336737">.</span><span class="ident" id="6336738">EncodedLen</span><span class="op" id="6336748">(</span><span class="builtinfunc" id="6336749">len</span><span class="op" id="6336752">(</span><span class="ident" id="6336753"><a href="/net/smtp/smtp.go.html#6336598">resp</a></span><span class="op" id="6336757">)</span><span class="op" id="6336758">)</span><span class="op" id="6336759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336762"><a href="/net/smtp/smtp.go.html#6336560">encoding</a></span><span class="op" id="6336770">.</span><span class="ident" id="6336771">Encode</span><span class="op" id="6336777">(</span><span class="ident" id="6336778"><a href="/net/smtp/smtp.go.html#6336706">resp64</a></span><span class="op" id="6336784">,</span>&nbsp;<span class="ident" id="6336786"><a href="/net/smtp/smtp.go.html#6336598">resp</a></span><span class="op" id="6336790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336793">code</span><span class="op" id="6336797">,</span>&nbsp;<span class="ident" id="6336799">msg64</span><span class="op" id="6336804">,</span>&nbsp;<span class="ident" id="6336806"><a href="/net/smtp/smtp.go.html#6336604">err</a></span>&nbsp;<span class="op" id="6336810">:=</span>&nbsp;<span class="ident" id="6336813"><a href="/net/smtp/smtp.go.html#6336476">c</a></span><span class="op" id="6336814">.</span><span class="ident" id="6336815">cmd</span><span class="op" id="6336818">(</span><span class="num" id="6336819">0</span><span class="op" id="6336820">,</span>&nbsp;<span class="string" id="6336822">&#34;AUTH&nbsp;%s&nbsp;%s&#34;</span><span class="op" id="6336834">,</span>&nbsp;<span class="ident" id="6336836"><a href="/net/smtp/smtp.go.html#6336592">mech</a></span><span class="op" id="6336840">,</span>&nbsp;<span class="ident" id="6336842"><a href="/net/smtp/smtp.go.html#6336706">resp64</a></span><span class="op" id="6336848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336851">for</span>&nbsp;<span class="ident" id="6336855"><a href="/net/smtp/smtp.go.html#6336604">err</a></span>&nbsp;<span class="op" id="6336859">==</span>&nbsp;<span class="ident" id="6336862">nil</span>&nbsp;<span class="op" id="6336866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336870">var</span>&nbsp;<span class="ident" id="6336874">msg</span>&nbsp;<span class="op" id="6336878">[</span><span class="op" id="6336879">]</span><span class="builtintype" id="6336880">byte</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336887">switch</span>&nbsp;<span class="ident" id="6336894"><a href="/net/smtp/smtp.go.html#6336793">code</a></span>&nbsp;<span class="op" id="6336899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336903">case</span>&nbsp;<span class="num" id="6336908">334</span><span class="op" id="6336911">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336916"><a href="/net/smtp/smtp.go.html#6336874">msg</a></span><span class="op" id="6336919">,</span>&nbsp;<span class="ident" id="6336921"><a href="/net/smtp/smtp.go.html#6336604">err</a></span>&nbsp;<span class="op" id="6336925">=</span>&nbsp;<span class="ident" id="6336927"><a href="/net/smtp/smtp.go.html#6336560">encoding</a></span><span class="op" id="6336935">.</span><span class="ident" id="6336936">DecodeString</span><span class="op" id="6336948">(</span><span class="ident" id="6336949"><a href="/net/smtp/smtp.go.html#6336799">msg64</a></span><span class="op" id="6336954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336958">case</span>&nbsp;<span class="num" id="6336963">235</span><span class="op" id="6336966">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6336971">//&nbsp;the&nbsp;last&nbsp;message&nbsp;isn&#39;t&nbsp;base64&nbsp;because&nbsp;it&nbsp;isn&#39;t&nbsp;a&nbsp;challenge</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337036"><a href="/net/smtp/smtp.go.html#6336874">msg</a></span>&nbsp;<span class="op" id="6337040">=</span>&nbsp;<span class="op" id="6337042">[</span><span class="op" id="6337043">]</span><span class="builtintype" id="6337044">byte</span><span class="op" id="6337048">(</span><span class="ident" id="6337049"><a href="/net/smtp/smtp.go.html#6336799">msg64</a></span><span class="op" id="6337054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337058">default</span><span class="op" id="6337065">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337070"><a href="/net/smtp/smtp.go.html#6336604">err</a></span>&nbsp;<span class="op" id="6337074">=</span>&nbsp;<span class="op" id="6337076">&amp;</span><span class="ident" id="6337077"><a href="/net/smtp/smtp.go.html#6332012">textproto</a></span><span class="op" id="6337086">.</span><span class="ident" id="6337087">Error</span><span class="op" id="6337092">{</span><span class="ident" id="6337093">Code</span><span class="op" id="6337097">:</span>&nbsp;<span class="ident" id="6337099"><a href="/net/smtp/smtp.go.html#6336793">code</a></span><span class="op" id="6337103">,</span>&nbsp;<span class="ident" id="6337105">Msg</span><span class="op" id="6337108">:</span>&nbsp;<span class="ident" id="6337110"><a href="/net/smtp/smtp.go.html#6336799">msg64</a></span><span class="op" id="6337115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337123">if</span>&nbsp;<span class="ident" id="6337126"><a href="/net/smtp/smtp.go.html#6336604">err</a></span>&nbsp;<span class="op" id="6337130">==</span>&nbsp;<span class="ident" id="6337133">nil</span>&nbsp;<span class="op" id="6337137">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337142"><a href="/net/smtp/smtp.go.html#6336598">resp</a></span><span class="op" id="6337146">,</span>&nbsp;<span class="ident" id="6337148"><a href="/net/smtp/smtp.go.html#6336604">err</a></span>&nbsp;<span class="op" id="6337152">=</span>&nbsp;<span class="ident" id="6337154"><a href="/net/smtp/smtp.go.html#6336492">a</a></span><span class="op" id="6337155">.</span><span class="ident" id="6337156">Next</span><span class="op" id="6337160">(</span><span class="ident" id="6337161"><a href="/net/smtp/smtp.go.html#6336874">msg</a></span><span class="op" id="6337164">,</span>&nbsp;<span class="ident" id="6337166"><a href="/net/smtp/smtp.go.html#6336793">code</a></span>&nbsp;<span class="op" id="6337171">==</span>&nbsp;<span class="num" id="6337174">334</span><span class="op" id="6337177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337185">if</span>&nbsp;<span class="ident" id="6337188"><a href="/net/smtp/smtp.go.html#6336604">err</a></span>&nbsp;<span class="op" id="6337192">!=</span>&nbsp;<span class="ident" id="6337195">nil</span>&nbsp;<span class="op" id="6337199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6337204">//&nbsp;abort&nbsp;the&nbsp;AUTH</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337225"><a href="/net/smtp/smtp.go.html#6336476">c</a></span><span class="op" id="6337226">.</span><span class="ident" id="6337227">cmd</span><span class="op" id="6337230">(</span><span class="num" id="6337231">501</span><span class="op" id="6337234">,</span>&nbsp;<span class="string" id="6337236">&#34;*&#34;</span><span class="op" id="6337239">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337244"><a href="/net/smtp/smtp.go.html#6336476">c</a></span><span class="op" id="6337245">.</span><span class="ident" id="6337246">Quit</span><span class="op" id="6337250">(</span><span class="op" id="6337251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337256">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337268">if</span>&nbsp;<span class="ident" id="6337271"><a href="/net/smtp/smtp.go.html#6336598">resp</a></span>&nbsp;<span class="op" id="6337276">==</span>&nbsp;<span class="ident" id="6337279">nil</span>&nbsp;<span class="op" id="6337283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337288">break</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337300"><a href="/net/smtp/smtp.go.html#6336706">resp64</a></span>&nbsp;<span class="op" id="6337307">=</span>&nbsp;<span class="builtinfunc" id="6337309">make</span><span class="op" id="6337313">(</span><span class="op" id="6337314">[</span><span class="op" id="6337315">]</span><span class="builtintype" id="6337316">byte</span><span class="op" id="6337320">,</span>&nbsp;<span class="ident" id="6337322"><a href="/net/smtp/smtp.go.html#6336560">encoding</a></span><span class="op" id="6337330">.</span><span class="ident" id="6337331">EncodedLen</span><span class="op" id="6337341">(</span><span class="builtinfunc" id="6337342">len</span><span class="op" id="6337345">(</span><span class="ident" id="6337346"><a href="/net/smtp/smtp.go.html#6336598">resp</a></span><span class="op" id="6337350">)</span><span class="op" id="6337351">)</span><span class="op" id="6337352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337356"><a href="/net/smtp/smtp.go.html#6336560">encoding</a></span><span class="op" id="6337364">.</span><span class="ident" id="6337365">Encode</span><span class="op" id="6337371">(</span><span class="ident" id="6337372"><a href="/net/smtp/smtp.go.html#6336706">resp64</a></span><span class="op" id="6337378">,</span>&nbsp;<span class="ident" id="6337380"><a href="/net/smtp/smtp.go.html#6336598">resp</a></span><span class="op" id="6337384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337388"><a href="/net/smtp/smtp.go.html#6336793">code</a></span><span class="op" id="6337392">,</span>&nbsp;<span class="ident" id="6337394"><a href="/net/smtp/smtp.go.html#6336799">msg64</a></span><span class="op" id="6337399">,</span>&nbsp;<span class="ident" id="6337401"><a href="/net/smtp/smtp.go.html#6336604">err</a></span>&nbsp;<span class="op" id="6337405">=</span>&nbsp;<span class="ident" id="6337407"><a href="/net/smtp/smtp.go.html#6336476">c</a></span><span class="op" id="6337408">.</span><span class="ident" id="6337409">cmd</span><span class="op" id="6337412">(</span><span class="num" id="6337413">0</span><span class="op" id="6337414">,</span>&nbsp;<span class="builtintype" id="6337416">string</span><span class="op" id="6337422">(</span><span class="ident" id="6337423"><a href="/net/smtp/smtp.go.html#6336706">resp64</a></span><span class="op" id="6337429">)</span><span class="op" id="6337430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337433">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337436">return</span>&nbsp;<span class="ident" id="6337443"><a href="/net/smtp/smtp.go.html#6336604">err</a></span><br>
<span class="lineno"></span><span class="op" id="6337447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6337450">//&nbsp;Mail&nbsp;issues&nbsp;a&nbsp;MAIL&nbsp;command&nbsp;to&nbsp;the&nbsp;server&nbsp;using&nbsp;the&nbsp;provided&nbsp;email&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="6337528">//&nbsp;If&nbsp;the&nbsp;server&nbsp;supports&nbsp;the&nbsp;8BITMIME&nbsp;extension,&nbsp;Mail&nbsp;adds&nbsp;the&nbsp;BODY=8BITMIME</span><br>
<span class="lineno">220</span><span class="comment" id="6337606">//&nbsp;parameter.</span><br>
<span class="lineno"></span><span class="comment" id="6337620">//&nbsp;This&nbsp;initiates&nbsp;a&nbsp;mail&nbsp;transaction&nbsp;and&nbsp;is&nbsp;followed&nbsp;by&nbsp;one&nbsp;or&nbsp;more&nbsp;Rcpt&nbsp;calls.</span><br>
<span class="lineno"></span><span class="keyword" id="6337700">func</span>&nbsp;<span class="op" id="6337705">(</span><span class="ident" id="6337706">c</span>&nbsp;<span class="op" id="6337708">*</span><span class="ident" id="6337709"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6337715">)</span>&nbsp;<span class="ident" id="6337717">Mail</span><span class="op" id="6337721">(</span><span class="ident" id="6337722">from</span>&nbsp;<span class="builtintype" id="6337727">string</span><span class="op" id="6337733">)</span>&nbsp;<span class="builtintype" id="6337735">error</span>&nbsp;<span class="op" id="6337741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337744">if</span>&nbsp;<span class="ident" id="6337747">err</span>&nbsp;<span class="op" id="6337751">:=</span>&nbsp;<span class="ident" id="6337754"><a href="/net/smtp/smtp.go.html#6337706">c</a></span><span class="op" id="6337755">.</span><span class="ident" id="6337756">hello</span><span class="op" id="6337761">(</span><span class="op" id="6337762">)</span><span class="op" id="6337763">;</span>&nbsp;<span class="ident" id="6337765"><a href="/net/smtp/smtp.go.html#6337747">err</a></span>&nbsp;<span class="op" id="6337769">!=</span>&nbsp;<span class="ident" id="6337772">nil</span>&nbsp;<span class="op" id="6337776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337780">return</span>&nbsp;<span class="ident" id="6337787"><a href="/net/smtp/smtp.go.html#6337747">err</a></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337795">cmdStr</span>&nbsp;<span class="op" id="6337802">:=</span>&nbsp;<span class="string" id="6337805">&#34;MAIL&nbsp;FROM:&lt;%s&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337823">if</span>&nbsp;<span class="ident" id="6337826"><a href="/net/smtp/smtp.go.html#6337706">c</a></span><span class="op" id="6337827">.</span><span class="ident" id="6337828">ext</span>&nbsp;<span class="op" id="6337832">!=</span>&nbsp;<span class="ident" id="6337835">nil</span>&nbsp;<span class="op" id="6337839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337843">if</span>&nbsp;<span class="ident" id="6337846">_</span><span class="op" id="6337847">,</span>&nbsp;<span class="ident" id="6337849">ok</span>&nbsp;<span class="op" id="6337852">:=</span>&nbsp;<span class="ident" id="6337855"><a href="/net/smtp/smtp.go.html#6337706">c</a></span><span class="op" id="6337856">.</span><span class="ident" id="6337857">ext</span><span class="op" id="6337860">[</span><span class="string" id="6337861">&#34;8BITMIME&#34;</span><span class="op" id="6337871">]</span><span class="op" id="6337872">;</span>&nbsp;<span class="ident" id="6337874"><a href="/net/smtp/smtp.go.html#6337849">ok</a></span>&nbsp;<span class="op" id="6337877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337882"><a href="/net/smtp/smtp.go.html#6337795">cmdStr</a></span>&nbsp;<span class="op" id="6337889">+=</span>&nbsp;<span class="string" id="6337892">&#34;&nbsp;BODY=8BITMIME&#34;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337917">_</span><span class="op" id="6337918">,</span>&nbsp;<span class="ident" id="6337920">_</span><span class="op" id="6337921">,</span>&nbsp;<span class="ident" id="6337923">err</span>&nbsp;<span class="op" id="6337927">:=</span>&nbsp;<span class="ident" id="6337930"><a href="/net/smtp/smtp.go.html#6337706">c</a></span><span class="op" id="6337931">.</span><span class="ident" id="6337932">cmd</span><span class="op" id="6337935">(</span><span class="num" id="6337936">250</span><span class="op" id="6337939">,</span>&nbsp;<span class="ident" id="6337941"><a href="/net/smtp/smtp.go.html#6337795">cmdStr</a></span><span class="op" id="6337947">,</span>&nbsp;<span class="ident" id="6337949"><a href="/net/smtp/smtp.go.html#6337722">from</a></span><span class="op" id="6337953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337956">return</span>&nbsp;<span class="ident" id="6337963"><a href="/net/smtp/smtp.go.html#6337923">err</a></span><br>
<span class="lineno"></span><span class="op" id="6337967">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="6337970">//&nbsp;Rcpt&nbsp;issues&nbsp;a&nbsp;RCPT&nbsp;command&nbsp;to&nbsp;the&nbsp;server&nbsp;using&nbsp;the&nbsp;provided&nbsp;email&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="6338048">//&nbsp;A&nbsp;call&nbsp;to&nbsp;Rcpt&nbsp;must&nbsp;be&nbsp;preceded&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Mail&nbsp;and&nbsp;may&nbsp;be&nbsp;followed&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6338124">//&nbsp;a&nbsp;Data&nbsp;call&nbsp;or&nbsp;another&nbsp;Rcpt&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="6338161">func</span>&nbsp;<span class="op" id="6338166">(</span><span class="ident" id="6338167">c</span>&nbsp;<span class="op" id="6338169">*</span><span class="ident" id="6338170"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6338176">)</span>&nbsp;<span class="ident" id="6338178">Rcpt</span><span class="op" id="6338182">(</span><span class="ident" id="6338183">to</span>&nbsp;<span class="builtintype" id="6338186">string</span><span class="op" id="6338192">)</span>&nbsp;<span class="builtintype" id="6338194">error</span>&nbsp;<span class="op" id="6338200">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338203">_</span><span class="op" id="6338204">,</span>&nbsp;<span class="ident" id="6338206">_</span><span class="op" id="6338207">,</span>&nbsp;<span class="ident" id="6338209">err</span>&nbsp;<span class="op" id="6338213">:=</span>&nbsp;<span class="ident" id="6338216"><a href="/net/smtp/smtp.go.html#6338167">c</a></span><span class="op" id="6338217">.</span><span class="ident" id="6338218">cmd</span><span class="op" id="6338221">(</span><span class="num" id="6338222">25</span><span class="op" id="6338224">,</span>&nbsp;<span class="string" id="6338226">&#34;RCPT&nbsp;TO:&lt;%s&gt;&#34;</span><span class="op" id="6338240">,</span>&nbsp;<span class="ident" id="6338242"><a href="/net/smtp/smtp.go.html#6338183">to</a></span><span class="op" id="6338244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338247">return</span>&nbsp;<span class="ident" id="6338254"><a href="/net/smtp/smtp.go.html#6338209">err</a></span><br>
<span class="lineno"></span><span class="op" id="6338258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6338261">type</span>&nbsp;<span class="ident" id="6338266">dataCloser</span>&nbsp;<span class="keyword" id="6338277">struct</span>&nbsp;<span class="op" id="6338284">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338287">c</span>&nbsp;<span class="op" id="6338289">*</span><span class="ident" id="6338290"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338298"><a href="/net/smtp/smtp.go.html#6331999">io</a></span><span class="op" id="6338300">.</span><span class="ident" id="6338301">WriteCloser</span><br>
<span class="lineno"></span><span class="op" id="6338313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6338316">func</span>&nbsp;<span class="op" id="6338321">(</span><span class="ident" id="6338322">d</span>&nbsp;<span class="op" id="6338324">*</span><span class="ident" id="6338325"><a href="/net/smtp/smtp.go.html#6338266">dataCloser</a></span><span class="op" id="6338335">)</span>&nbsp;<span class="ident" id="6338337">Close</span><span class="op" id="6338342">(</span><span class="op" id="6338343">)</span>&nbsp;<span class="builtintype" id="6338345">error</span>&nbsp;<span class="op" id="6338351">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338354"><a href="/net/smtp/smtp.go.html#6338322">d</a></span><span class="op" id="6338355">.</span><span class="ident" id="6338356">WriteCloser</span><span class="op" id="6338367">.</span><span class="ident" id="6338368">Close</span><span class="op" id="6338373">(</span><span class="op" id="6338374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338377">_</span><span class="op" id="6338378">,</span>&nbsp;<span class="ident" id="6338380">_</span><span class="op" id="6338381">,</span>&nbsp;<span class="ident" id="6338383">err</span>&nbsp;<span class="op" id="6338387">:=</span>&nbsp;<span class="ident" id="6338390"><a href="/net/smtp/smtp.go.html#6338322">d</a></span><span class="op" id="6338391">.</span><span class="ident" id="6338392">c</span><span class="op" id="6338393">.</span><span class="ident" id="6338394">Text</span><span class="op" id="6338398">.</span><span class="ident" id="6338399">ReadResponse</span><span class="op" id="6338411">(</span><span class="num" id="6338412">250</span><span class="op" id="6338415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338418">return</span>&nbsp;<span class="ident" id="6338425"><a href="/net/smtp/smtp.go.html#6338383">err</a></span><br>
<span class="lineno"></span><span class="op" id="6338429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="6338432">//&nbsp;Data&nbsp;issues&nbsp;a&nbsp;DATA&nbsp;command&nbsp;to&nbsp;the&nbsp;server&nbsp;and&nbsp;returns&nbsp;a&nbsp;writer&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="6338502">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;write&nbsp;the&nbsp;data.&nbsp;The&nbsp;caller&nbsp;should&nbsp;close&nbsp;the&nbsp;writer</span><br>
<span class="lineno"></span><span class="comment" id="6338571">//&nbsp;before&nbsp;calling&nbsp;any&nbsp;more&nbsp;methods&nbsp;on&nbsp;c.</span><br>
<span class="lineno"></span><span class="comment" id="6338612">//&nbsp;A&nbsp;call&nbsp;to&nbsp;Data&nbsp;must&nbsp;be&nbsp;preceded&nbsp;by&nbsp;one&nbsp;or&nbsp;more&nbsp;calls&nbsp;to&nbsp;Rcpt.</span><br>
<span class="lineno"></span><span class="keyword" id="6338677">func</span>&nbsp;<span class="op" id="6338682">(</span><span class="ident" id="6338683">c</span>&nbsp;<span class="op" id="6338685">*</span><span class="ident" id="6338686"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6338692">)</span>&nbsp;<span class="ident" id="6338694">Data</span><span class="op" id="6338698">(</span><span class="op" id="6338699">)</span>&nbsp;<span class="op" id="6338701">(</span><span class="ident" id="6338702"><a href="/net/smtp/smtp.go.html#6331999">io</a></span><span class="op" id="6338704">.</span><span class="ident" id="6338705">WriteCloser</span><span class="op" id="6338716">,</span>&nbsp;<span class="builtintype" id="6338718">error</span><span class="op" id="6338723">)</span>&nbsp;<span class="op" id="6338725">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338728">_</span><span class="op" id="6338729">,</span>&nbsp;<span class="ident" id="6338731">_</span><span class="op" id="6338732">,</span>&nbsp;<span class="ident" id="6338734">err</span>&nbsp;<span class="op" id="6338738">:=</span>&nbsp;<span class="ident" id="6338741"><a href="/net/smtp/smtp.go.html#6338683">c</a></span><span class="op" id="6338742">.</span><span class="ident" id="6338743">cmd</span><span class="op" id="6338746">(</span><span class="num" id="6338747">354</span><span class="op" id="6338750">,</span>&nbsp;<span class="string" id="6338752">&#34;DATA&#34;</span><span class="op" id="6338758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338761">if</span>&nbsp;<span class="ident" id="6338764"><a href="/net/smtp/smtp.go.html#6338734">err</a></span>&nbsp;<span class="op" id="6338768">!=</span>&nbsp;<span class="ident" id="6338771">nil</span>&nbsp;<span class="op" id="6338775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338779">return</span>&nbsp;<span class="ident" id="6338786">nil</span><span class="op" id="6338789">,</span>&nbsp;<span class="ident" id="6338791"><a href="/net/smtp/smtp.go.html#6338734">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338799">return</span>&nbsp;<span class="op" id="6338806">&amp;</span><span class="ident" id="6338807"><a href="/net/smtp/smtp.go.html#6338266">dataCloser</a></span><span class="op" id="6338817">{</span><span class="ident" id="6338818"><a href="/net/smtp/smtp.go.html#6338683">c</a></span><span class="op" id="6338819">,</span>&nbsp;<span class="ident" id="6338821"><a href="/net/smtp/smtp.go.html#6338683">c</a></span><span class="op" id="6338822">.</span><span class="ident" id="6338823">Text</span><span class="op" id="6338827">.</span><span class="ident" id="6338828">DotWriter</span><span class="op" id="6338837">(</span><span class="op" id="6338838">)</span><span class="op" id="6338839">}</span><span class="op" id="6338840">,</span>&nbsp;<span class="ident" id="6338842">nil</span><br>
<span class="lineno">265</span><span class="op" id="6338846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6338849">var</span>&nbsp;<span class="ident" id="6338853">testHookStartTLS</span>&nbsp;<span class="keyword" id="6338870">func</span><span class="op" id="6338874">(</span><span class="op" id="6338875">*</span><span class="ident" id="6338876"><a href="/net/smtp/smtp.go.html#6331956">tls</a></span><span class="op" id="6338879">.</span><span class="ident" id="6338880">Config</span><span class="op" id="6338886">)</span>&nbsp;<span class="comment" id="6338888">//&nbsp;nil,&nbsp;except&nbsp;for&nbsp;tests</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6338914">//&nbsp;SendMail&nbsp;connects&nbsp;to&nbsp;the&nbsp;server&nbsp;at&nbsp;addr,&nbsp;switches&nbsp;to&nbsp;TLS&nbsp;if</span><br>
<span class="lineno">270</span><span class="comment" id="6338977">//&nbsp;possible,&nbsp;authenticates&nbsp;with&nbsp;the&nbsp;optional&nbsp;mechanism&nbsp;a&nbsp;if&nbsp;possible,</span><br>
<span class="lineno"></span><span class="comment" id="6339047">//&nbsp;and&nbsp;then&nbsp;sends&nbsp;an&nbsp;email&nbsp;from&nbsp;address&nbsp;from,&nbsp;to&nbsp;addresses&nbsp;to,&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6339115">//&nbsp;message&nbsp;msg.</span><br>
<span class="lineno"></span><span class="keyword" id="6339131">func</span>&nbsp;<span class="ident" id="6339136">SendMail</span><span class="op" id="6339144">(</span><span class="ident" id="6339145">addr</span>&nbsp;<span class="builtintype" id="6339150">string</span><span class="op" id="6339156">,</span>&nbsp;<span class="ident" id="6339158">a</span>&nbsp;<span class="ident" id="6339160"><a href="/net/smtp/auth.go.html#6328425">Auth</a></span><span class="op" id="6339164">,</span>&nbsp;<span class="ident" id="6339166">from</span>&nbsp;<span class="builtintype" id="6339171">string</span><span class="op" id="6339177">,</span>&nbsp;<span class="ident" id="6339179">to</span>&nbsp;<span class="op" id="6339182">[</span><span class="op" id="6339183">]</span><span class="builtintype" id="6339184">string</span><span class="op" id="6339190">,</span>&nbsp;<span class="ident" id="6339192">msg</span>&nbsp;<span class="op" id="6339196">[</span><span class="op" id="6339197">]</span><span class="builtintype" id="6339198">byte</span><span class="op" id="6339202">)</span>&nbsp;<span class="builtintype" id="6339204">error</span>&nbsp;<span class="op" id="6339210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339213">c</span><span class="op" id="6339214">,</span>&nbsp;<span class="ident" id="6339216">err</span>&nbsp;<span class="op" id="6339220">:=</span>&nbsp;<span class="ident" id="6339223"><a href="/net/smtp/smtp.go.html#6332807">Dial</a></span><span class="op" id="6339227">(</span><span class="ident" id="6339228"><a href="/net/smtp/smtp.go.html#6339145">addr</a></span><span class="op" id="6339232">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339235">if</span>&nbsp;<span class="ident" id="6339238"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339242">!=</span>&nbsp;<span class="ident" id="6339245">nil</span>&nbsp;<span class="op" id="6339249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339253">return</span>&nbsp;<span class="ident" id="6339260"><a href="/net/smtp/smtp.go.html#6339216">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339268">defer</span>&nbsp;<span class="ident" id="6339274"><a href="/net/smtp/smtp.go.html#6339213">c</a></span><span class="op" id="6339275">.</span><span class="ident" id="6339276">Close</span><span class="op" id="6339281">(</span><span class="op" id="6339282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339285">if</span>&nbsp;<span class="ident" id="6339288"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339292">=</span>&nbsp;<span class="ident" id="6339294"><a href="/net/smtp/smtp.go.html#6339213">c</a></span><span class="op" id="6339295">.</span><span class="ident" id="6339296">hello</span><span class="op" id="6339301">(</span><span class="op" id="6339302">)</span><span class="op" id="6339303">;</span>&nbsp;<span class="ident" id="6339305"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339309">!=</span>&nbsp;<span class="ident" id="6339312">nil</span>&nbsp;<span class="op" id="6339316">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339320">return</span>&nbsp;<span class="ident" id="6339327"><a href="/net/smtp/smtp.go.html#6339216">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339335">if</span>&nbsp;<span class="ident" id="6339338">ok</span><span class="op" id="6339340">,</span>&nbsp;<span class="ident" id="6339342">_</span>&nbsp;<span class="op" id="6339344">:=</span>&nbsp;<span class="ident" id="6339347"><a href="/net/smtp/smtp.go.html#6339213">c</a></span><span class="op" id="6339348">.</span><span class="ident" id="6339349">Extension</span><span class="op" id="6339358">(</span><span class="string" id="6339359">&#34;STARTTLS&#34;</span><span class="op" id="6339369">)</span><span class="op" id="6339370">;</span>&nbsp;<span class="ident" id="6339372"><a href="/net/smtp/smtp.go.html#6339338">ok</a></span>&nbsp;<span class="op" id="6339375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339379">config</span>&nbsp;<span class="op" id="6339386">:=</span>&nbsp;<span class="op" id="6339389">&amp;</span><span class="ident" id="6339390"><a href="/net/smtp/smtp.go.html#6331956">tls</a></span><span class="op" id="6339393">.</span><span class="ident" id="6339394">Config</span><span class="op" id="6339400">{</span><span class="ident" id="6339401">ServerName</span><span class="op" id="6339411">:</span>&nbsp;<span class="ident" id="6339413"><a href="/net/smtp/smtp.go.html#6339213">c</a></span><span class="op" id="6339414">.</span><span class="ident" id="6339415">serverName</span><span class="op" id="6339425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339429">if</span>&nbsp;<span class="ident" id="6339432"><a href="/net/smtp/smtp.go.html#6338853">testHookStartTLS</a></span>&nbsp;<span class="op" id="6339449">!=</span>&nbsp;<span class="ident" id="6339452">nil</span>&nbsp;<span class="op" id="6339456">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339461"><a href="/net/smtp/smtp.go.html#6338853">testHookStartTLS</a></span><span class="op" id="6339477">(</span><span class="ident" id="6339478"><a href="/net/smtp/smtp.go.html#6339379">config</a></span><span class="op" id="6339484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339492">if</span>&nbsp;<span class="ident" id="6339495"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339499">=</span>&nbsp;<span class="ident" id="6339501"><a href="/net/smtp/smtp.go.html#6339213">c</a></span><span class="op" id="6339502">.</span><span class="ident" id="6339503">StartTLS</span><span class="op" id="6339511">(</span><span class="ident" id="6339512"><a href="/net/smtp/smtp.go.html#6339379">config</a></span><span class="op" id="6339518">)</span><span class="op" id="6339519">;</span>&nbsp;<span class="ident" id="6339521"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339525">!=</span>&nbsp;<span class="ident" id="6339528">nil</span>&nbsp;<span class="op" id="6339532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339537">return</span>&nbsp;<span class="ident" id="6339544"><a href="/net/smtp/smtp.go.html#6339216">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339550">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339556">if</span>&nbsp;<span class="ident" id="6339559"><a href="/net/smtp/smtp.go.html#6339158">a</a></span>&nbsp;<span class="op" id="6339561">!=</span>&nbsp;<span class="ident" id="6339564">nil</span>&nbsp;<span class="op" id="6339568">&amp;&amp;</span>&nbsp;<span class="ident" id="6339571"><a href="/net/smtp/smtp.go.html#6339213">c</a></span><span class="op" id="6339572">.</span><span class="ident" id="6339573">ext</span>&nbsp;<span class="op" id="6339577">!=</span>&nbsp;<span class="ident" id="6339580">nil</span>&nbsp;<span class="op" id="6339584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339588">if</span>&nbsp;<span class="ident" id="6339591">_</span><span class="op" id="6339592">,</span>&nbsp;<span class="ident" id="6339594">ok</span>&nbsp;<span class="op" id="6339597">:=</span>&nbsp;<span class="ident" id="6339600"><a href="/net/smtp/smtp.go.html#6339213">c</a></span><span class="op" id="6339601">.</span><span class="ident" id="6339602">ext</span><span class="op" id="6339605">[</span><span class="string" id="6339606">&#34;AUTH&#34;</span><span class="op" id="6339612">]</span><span class="op" id="6339613">;</span>&nbsp;<span class="ident" id="6339615"><a href="/net/smtp/smtp.go.html#6339594">ok</a></span>&nbsp;<span class="op" id="6339618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339623">if</span>&nbsp;<span class="ident" id="6339626"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339630">=</span>&nbsp;<span class="ident" id="6339632"><a href="/net/smtp/smtp.go.html#6339213">c</a></span><span class="op" id="6339633">.</span><span class="ident" id="6339634">Auth</span><span class="op" id="6339638">(</span><span class="ident" id="6339639"><a href="/net/smtp/smtp.go.html#6339158">a</a></span><span class="op" id="6339640">)</span><span class="op" id="6339641">;</span>&nbsp;<span class="ident" id="6339643"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339647">!=</span>&nbsp;<span class="ident" id="6339650">nil</span>&nbsp;<span class="op" id="6339654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339660">return</span>&nbsp;<span class="ident" id="6339667"><a href="/net/smtp/smtp.go.html#6339216">err</a></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339684">if</span>&nbsp;<span class="ident" id="6339687"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339691">=</span>&nbsp;<span class="ident" id="6339693"><a href="/net/smtp/smtp.go.html#6339213">c</a></span><span class="op" id="6339694">.</span><span class="ident" id="6339695">Mail</span><span class="op" id="6339699">(</span><span class="ident" id="6339700"><a href="/net/smtp/smtp.go.html#6339166">from</a></span><span class="op" id="6339704">)</span><span class="op" id="6339705">;</span>&nbsp;<span class="ident" id="6339707"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339711">!=</span>&nbsp;<span class="ident" id="6339714">nil</span>&nbsp;<span class="op" id="6339718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339722">return</span>&nbsp;<span class="ident" id="6339729"><a href="/net/smtp/smtp.go.html#6339216">err</a></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339737">for</span>&nbsp;<span class="ident" id="6339741">_</span><span class="op" id="6339742">,</span>&nbsp;<span class="ident" id="6339744">addr</span>&nbsp;<span class="op" id="6339749">:=</span>&nbsp;<span class="keyword" id="6339752">range</span>&nbsp;<span class="ident" id="6339758"><a href="/net/smtp/smtp.go.html#6339179">to</a></span>&nbsp;<span class="op" id="6339761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339765">if</span>&nbsp;<span class="ident" id="6339768"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339772">=</span>&nbsp;<span class="ident" id="6339774"><a href="/net/smtp/smtp.go.html#6339213">c</a></span><span class="op" id="6339775">.</span><span class="ident" id="6339776">Rcpt</span><span class="op" id="6339780">(</span><span class="ident" id="6339781"><a href="/net/smtp/smtp.go.html#6339744">addr</a></span><span class="op" id="6339785">)</span><span class="op" id="6339786">;</span>&nbsp;<span class="ident" id="6339788"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339792">!=</span>&nbsp;<span class="ident" id="6339795">nil</span>&nbsp;<span class="op" id="6339799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339804">return</span>&nbsp;<span class="ident" id="6339811"><a href="/net/smtp/smtp.go.html#6339216">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339817">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339823">w</span><span class="op" id="6339824">,</span>&nbsp;<span class="ident" id="6339826"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339830">:=</span>&nbsp;<span class="ident" id="6339833"><a href="/net/smtp/smtp.go.html#6339213">c</a></span><span class="op" id="6339834">.</span><span class="ident" id="6339835">Data</span><span class="op" id="6339839">(</span><span class="op" id="6339840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339843">if</span>&nbsp;<span class="ident" id="6339846"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339850">!=</span>&nbsp;<span class="ident" id="6339853">nil</span>&nbsp;<span class="op" id="6339857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339861">return</span>&nbsp;<span class="ident" id="6339868"><a href="/net/smtp/smtp.go.html#6339216">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339873">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339876">_</span><span class="op" id="6339877">,</span>&nbsp;<span class="ident" id="6339879"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339883">=</span>&nbsp;<span class="ident" id="6339885"><a href="/net/smtp/smtp.go.html#6339823">w</a></span><span class="op" id="6339886">.</span><span class="ident" id="6339887">Write</span><span class="op" id="6339892">(</span><span class="ident" id="6339893"><a href="/net/smtp/smtp.go.html#6339192">msg</a></span><span class="op" id="6339896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339899">if</span>&nbsp;<span class="ident" id="6339902"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339906">!=</span>&nbsp;<span class="ident" id="6339909">nil</span>&nbsp;<span class="op" id="6339913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339917">return</span>&nbsp;<span class="ident" id="6339924"><a href="/net/smtp/smtp.go.html#6339216">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339932"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339936">=</span>&nbsp;<span class="ident" id="6339938"><a href="/net/smtp/smtp.go.html#6339823">w</a></span><span class="op" id="6339939">.</span><span class="ident" id="6339940">Close</span><span class="op" id="6339945">(</span><span class="op" id="6339946">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339949">if</span>&nbsp;<span class="ident" id="6339952"><a href="/net/smtp/smtp.go.html#6339216">err</a></span>&nbsp;<span class="op" id="6339956">!=</span>&nbsp;<span class="ident" id="6339959">nil</span>&nbsp;<span class="op" id="6339963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339967">return</span>&nbsp;<span class="ident" id="6339974"><a href="/net/smtp/smtp.go.html#6339216">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339982">return</span>&nbsp;<span class="ident" id="6339989"><a href="/net/smtp/smtp.go.html#6339213">c</a></span><span class="op" id="6339990">.</span><span class="ident" id="6339991">Quit</span><span class="op" id="6339995">(</span><span class="op" id="6339996">)</span><br>
<span class="lineno"></span><span class="op" id="6339998">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="6340001">//&nbsp;Extension&nbsp;reports&nbsp;whether&nbsp;an&nbsp;extension&nbsp;is&nbsp;support&nbsp;by&nbsp;the&nbsp;server.</span><br>
<span class="lineno"></span><span class="comment" id="6340069">//&nbsp;The&nbsp;extension&nbsp;name&nbsp;is&nbsp;case-insensitive.&nbsp;If&nbsp;the&nbsp;extension&nbsp;is&nbsp;supported,</span><br>
<span class="lineno"></span><span class="comment" id="6340143">//&nbsp;Extension&nbsp;also&nbsp;returns&nbsp;a&nbsp;string&nbsp;that&nbsp;contains&nbsp;any&nbsp;parameters&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6340211">//&nbsp;server&nbsp;specifies&nbsp;for&nbsp;the&nbsp;extension.</span><br>
<span class="lineno">325</span><span class="keyword" id="6340250">func</span>&nbsp;<span class="op" id="6340255">(</span><span class="ident" id="6340256">c</span>&nbsp;<span class="op" id="6340258">*</span><span class="ident" id="6340259"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6340265">)</span>&nbsp;<span class="ident" id="6340267">Extension</span><span class="op" id="6340276">(</span><span class="ident" id="6340277">ext</span>&nbsp;<span class="builtintype" id="6340281">string</span><span class="op" id="6340287">)</span>&nbsp;<span class="op" id="6340289">(</span><span class="builtintype" id="6340290">bool</span><span class="op" id="6340294">,</span>&nbsp;<span class="builtintype" id="6340296">string</span><span class="op" id="6340302">)</span>&nbsp;<span class="op" id="6340304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340307">if</span>&nbsp;<span class="ident" id="6340310">err</span>&nbsp;<span class="op" id="6340314">:=</span>&nbsp;<span class="ident" id="6340317"><a href="/net/smtp/smtp.go.html#6340256">c</a></span><span class="op" id="6340318">.</span><span class="ident" id="6340319">hello</span><span class="op" id="6340324">(</span><span class="op" id="6340325">)</span><span class="op" id="6340326">;</span>&nbsp;<span class="ident" id="6340328"><a href="/net/smtp/smtp.go.html#6340310">err</a></span>&nbsp;<span class="op" id="6340332">!=</span>&nbsp;<span class="ident" id="6340335">nil</span>&nbsp;<span class="op" id="6340339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340343">return</span>&nbsp;<span class="builtintype" id="6340350">false</span><span class="op" id="6340355">,</span>&nbsp;<span class="string" id="6340357">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340364">if</span>&nbsp;<span class="ident" id="6340367"><a href="/net/smtp/smtp.go.html#6340256">c</a></span><span class="op" id="6340368">.</span><span class="ident" id="6340369">ext</span>&nbsp;<span class="op" id="6340373">==</span>&nbsp;<span class="ident" id="6340376">nil</span>&nbsp;<span class="op" id="6340380">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340384">return</span>&nbsp;<span class="builtintype" id="6340391">false</span><span class="op" id="6340396">,</span>&nbsp;<span class="string" id="6340398">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340405"><a href="/net/smtp/smtp.go.html#6340277">ext</a></span>&nbsp;<span class="op" id="6340409">=</span>&nbsp;<span class="ident" id="6340411"><a href="/net/smtp/smtp.go.html#6332029">strings</a></span><span class="op" id="6340418">.</span><span class="ident" id="6340419">ToUpper</span><span class="op" id="6340426">(</span><span class="ident" id="6340427"><a href="/net/smtp/smtp.go.html#6340277">ext</a></span><span class="op" id="6340430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340433">param</span><span class="op" id="6340438">,</span>&nbsp;<span class="ident" id="6340440">ok</span>&nbsp;<span class="op" id="6340443">:=</span>&nbsp;<span class="ident" id="6340446"><a href="/net/smtp/smtp.go.html#6340256">c</a></span><span class="op" id="6340447">.</span><span class="ident" id="6340448">ext</span><span class="op" id="6340451">[</span><span class="ident" id="6340452"><a href="/net/smtp/smtp.go.html#6340277">ext</a></span><span class="op" id="6340455">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340458">return</span>&nbsp;<span class="ident" id="6340465"><a href="/net/smtp/smtp.go.html#6340440">ok</a></span><span class="op" id="6340467">,</span>&nbsp;<span class="ident" id="6340469"><a href="/net/smtp/smtp.go.html#6340433">param</a></span><br>
<span class="lineno">335</span><span class="op" id="6340475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6340478">//&nbsp;Reset&nbsp;sends&nbsp;the&nbsp;RSET&nbsp;command&nbsp;to&nbsp;the&nbsp;server,&nbsp;aborting&nbsp;the&nbsp;current&nbsp;mail</span><br>
<span class="lineno"></span><span class="comment" id="6340551">//&nbsp;transaction.</span><br>
<span class="lineno"></span><span class="keyword" id="6340567">func</span>&nbsp;<span class="op" id="6340572">(</span><span class="ident" id="6340573">c</span>&nbsp;<span class="op" id="6340575">*</span><span class="ident" id="6340576"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6340582">)</span>&nbsp;<span class="ident" id="6340584">Reset</span><span class="op" id="6340589">(</span><span class="op" id="6340590">)</span>&nbsp;<span class="builtintype" id="6340592">error</span>&nbsp;<span class="op" id="6340598">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340601">if</span>&nbsp;<span class="ident" id="6340604">err</span>&nbsp;<span class="op" id="6340608">:=</span>&nbsp;<span class="ident" id="6340611"><a href="/net/smtp/smtp.go.html#6340573">c</a></span><span class="op" id="6340612">.</span><span class="ident" id="6340613">hello</span><span class="op" id="6340618">(</span><span class="op" id="6340619">)</span><span class="op" id="6340620">;</span>&nbsp;<span class="ident" id="6340622"><a href="/net/smtp/smtp.go.html#6340604">err</a></span>&nbsp;<span class="op" id="6340626">!=</span>&nbsp;<span class="ident" id="6340629">nil</span>&nbsp;<span class="op" id="6340633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340637">return</span>&nbsp;<span class="ident" id="6340644"><a href="/net/smtp/smtp.go.html#6340604">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340652">_</span><span class="op" id="6340653">,</span>&nbsp;<span class="ident" id="6340655">_</span><span class="op" id="6340656">,</span>&nbsp;<span class="ident" id="6340658">err</span>&nbsp;<span class="op" id="6340662">:=</span>&nbsp;<span class="ident" id="6340665"><a href="/net/smtp/smtp.go.html#6340573">c</a></span><span class="op" id="6340666">.</span><span class="ident" id="6340667">cmd</span><span class="op" id="6340670">(</span><span class="num" id="6340671">250</span><span class="op" id="6340674">,</span>&nbsp;<span class="string" id="6340676">&#34;RSET&#34;</span><span class="op" id="6340682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340685">return</span>&nbsp;<span class="ident" id="6340692"><a href="/net/smtp/smtp.go.html#6340658">err</a></span><br>
<span class="lineno">345</span><span class="op" id="6340696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6340699">//&nbsp;Quit&nbsp;sends&nbsp;the&nbsp;QUIT&nbsp;command&nbsp;and&nbsp;closes&nbsp;the&nbsp;connection&nbsp;to&nbsp;the&nbsp;server.</span><br>
<span class="lineno"></span><span class="keyword" id="6340771">func</span>&nbsp;<span class="op" id="6340776">(</span><span class="ident" id="6340777">c</span>&nbsp;<span class="op" id="6340779">*</span><span class="ident" id="6340780"><a href="/net/smtp/smtp.go.html#6332109">Client</a></span><span class="op" id="6340786">)</span>&nbsp;<span class="ident" id="6340788">Quit</span><span class="op" id="6340792">(</span><span class="op" id="6340793">)</span>&nbsp;<span class="builtintype" id="6340795">error</span>&nbsp;<span class="op" id="6340801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340804">if</span>&nbsp;<span class="ident" id="6340807">err</span>&nbsp;<span class="op" id="6340811">:=</span>&nbsp;<span class="ident" id="6340814"><a href="/net/smtp/smtp.go.html#6340777">c</a></span><span class="op" id="6340815">.</span><span class="ident" id="6340816">hello</span><span class="op" id="6340821">(</span><span class="op" id="6340822">)</span><span class="op" id="6340823">;</span>&nbsp;<span class="ident" id="6340825"><a href="/net/smtp/smtp.go.html#6340807">err</a></span>&nbsp;<span class="op" id="6340829">!=</span>&nbsp;<span class="ident" id="6340832">nil</span>&nbsp;<span class="op" id="6340836">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340840">return</span>&nbsp;<span class="ident" id="6340847"><a href="/net/smtp/smtp.go.html#6340807">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340855">_</span><span class="op" id="6340856">,</span>&nbsp;<span class="ident" id="6340858">_</span><span class="op" id="6340859">,</span>&nbsp;<span class="ident" id="6340861">err</span>&nbsp;<span class="op" id="6340865">:=</span>&nbsp;<span class="ident" id="6340868"><a href="/net/smtp/smtp.go.html#6340777">c</a></span><span class="op" id="6340869">.</span><span class="ident" id="6340870">cmd</span><span class="op" id="6340873">(</span><span class="num" id="6340874">221</span><span class="op" id="6340877">,</span>&nbsp;<span class="string" id="6340879">&#34;QUIT&#34;</span><span class="op" id="6340885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340888">if</span>&nbsp;<span class="ident" id="6340891"><a href="/net/smtp/smtp.go.html#6340861">err</a></span>&nbsp;<span class="op" id="6340895">!=</span>&nbsp;<span class="ident" id="6340898">nil</span>&nbsp;<span class="op" id="6340902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340906">return</span>&nbsp;<span class="ident" id="6340913"><a href="/net/smtp/smtp.go.html#6340861">err</a></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340921">return</span>&nbsp;<span class="ident" id="6340928"><a href="/net/smtp/smtp.go.html#6340777">c</a></span><span class="op" id="6340929">.</span><span class="ident" id="6340930">Text</span><span class="op" id="6340934">.</span><span class="ident" id="6340935">Close</span><span class="op" id="6340940">(</span><span class="op" id="6340941">)</span><br>
<span class="lineno"></span><span class="op" id="6340943">}</span>
</div>
</body>
</html>
