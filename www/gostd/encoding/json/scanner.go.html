<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html" class="current">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3752949">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3753005">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3753059">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3753110">package</span>&nbsp;<span class="ident" id="3753118">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3753124">//&nbsp;JSON&nbsp;value&nbsp;parser&nbsp;state&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="3753160">//&nbsp;Just&nbsp;about&nbsp;at&nbsp;the&nbsp;limit&nbsp;of&nbsp;what&nbsp;is&nbsp;reasonable&nbsp;to&nbsp;write&nbsp;by&nbsp;hand.</span><br>
<span class="lineno"></span><span class="comment" id="3753227">//&nbsp;Some&nbsp;parts&nbsp;are&nbsp;a&nbsp;bit&nbsp;tedious,&nbsp;but&nbsp;overall&nbsp;it&nbsp;nicely&nbsp;factors&nbsp;out&nbsp;the</span><br>
<span class="lineno">10</span><span class="comment" id="3753298">//&nbsp;otherwise&nbsp;common&nbsp;code&nbsp;from&nbsp;the&nbsp;multiple&nbsp;scanning&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="3753360">//&nbsp;in&nbsp;this&nbsp;package&nbsp;(Compact,&nbsp;Indent,&nbsp;checkValid,&nbsp;nextValue,&nbsp;etc).</span><br>
<span class="lineno"></span><span class="comment" id="3753426">//</span><br>
<span class="lineno"></span><span class="comment" id="3753429">//&nbsp;This&nbsp;file&nbsp;starts&nbsp;with&nbsp;two&nbsp;simple&nbsp;examples&nbsp;using&nbsp;the&nbsp;scanner</span><br>
<span class="lineno"></span><span class="comment" id="3753492">//&nbsp;before&nbsp;diving&nbsp;into&nbsp;the&nbsp;scanner&nbsp;itself.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3753535">import</span>&nbsp;<span class="string" id="3753542">&#34;strconv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3753553">//&nbsp;checkValid&nbsp;verifies&nbsp;that&nbsp;data&nbsp;is&nbsp;valid&nbsp;JSON-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="3753614">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;checkValid&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno">20</span><span class="keyword" id="3753681">func</span>&nbsp;<span class="ident" id="3753686">checkValid</span><span class="op" id="3753696">(</span><span class="ident" id="3753697">data</span>&nbsp;<span class="op" id="3753702">[</span><span class="op" id="3753703">]</span><span class="builtintype" id="3753704">byte</span><span class="op" id="3753708">,</span>&nbsp;<span class="ident" id="3753710">scan</span>&nbsp;<span class="op" id="3753715">*</span><span class="ident" id="3753716">scanner</span><span class="op" id="3753723">)</span>&nbsp;<span class="builtintype" id="3753725">error</span>&nbsp;<span class="op" id="3753731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753734">scan</span><span class="op" id="3753738">.</span><span class="ident" id="3753739">reset</span><span class="op" id="3753744">(</span><span class="op" id="3753745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753748">for</span>&nbsp;<span class="ident" id="3753752">_</span><span class="op" id="3753753">,</span>&nbsp;<span class="ident" id="3753755">c</span>&nbsp;<span class="op" id="3753757">:=</span>&nbsp;<span class="keyword" id="3753760">range</span>&nbsp;<span class="ident" id="3753766">data</span>&nbsp;<span class="op" id="3753771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753775">scan</span><span class="op" id="3753779">.</span><span class="ident" id="3753780">bytes</span><span class="op" id="3753785">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753790">if</span>&nbsp;<span class="ident" id="3753793">scan</span><span class="op" id="3753797">.</span><span class="ident" id="3753798">step</span><span class="op" id="3753802">(</span><span class="ident" id="3753803">scan</span><span class="op" id="3753807">,</span>&nbsp;<span class="builtintype" id="3753809">int</span><span class="op" id="3753812">(</span><span class="ident" id="3753813">c</span><span class="op" id="3753814">)</span><span class="op" id="3753815">)</span>&nbsp;<span class="op" id="3753817">==</span>&nbsp;<span class="ident" id="3753820">scanError</span>&nbsp;<span class="op" id="3753830">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753835">return</span>&nbsp;<span class="ident" id="3753842">scan</span><span class="op" id="3753846">.</span><span class="ident" id="3753847">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3753853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3753856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753859">if</span>&nbsp;<span class="ident" id="3753862">scan</span><span class="op" id="3753866">.</span><span class="ident" id="3753867">eof</span><span class="op" id="3753870">(</span><span class="op" id="3753871">)</span>&nbsp;<span class="op" id="3753873">==</span>&nbsp;<span class="ident" id="3753876">scanError</span>&nbsp;<span class="op" id="3753886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753890">return</span>&nbsp;<span class="ident" id="3753897">scan</span><span class="op" id="3753901">.</span><span class="ident" id="3753902">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3753907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753910">return</span>&nbsp;<span class="ident" id="3753917">nil</span><br>
<span class="lineno"></span><span class="op" id="3753921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3753924">//&nbsp;nextValue&nbsp;splits&nbsp;data&nbsp;after&nbsp;the&nbsp;next&nbsp;whole&nbsp;JSON&nbsp;value,</span><br>
<span class="lineno">35</span><span class="comment" id="3753982">//&nbsp;returning&nbsp;that&nbsp;value&nbsp;and&nbsp;the&nbsp;bytes&nbsp;that&nbsp;follow&nbsp;it&nbsp;as&nbsp;separate&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="3754055">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;nextValue&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="3754121">func</span>&nbsp;<span class="ident" id="3754126">nextValue</span><span class="op" id="3754135">(</span><span class="ident" id="3754136">data</span>&nbsp;<span class="op" id="3754141">[</span><span class="op" id="3754142">]</span><span class="builtintype" id="3754143">byte</span><span class="op" id="3754147">,</span>&nbsp;<span class="ident" id="3754149">scan</span>&nbsp;<span class="op" id="3754154">*</span><span class="ident" id="3754155">scanner</span><span class="op" id="3754162">)</span>&nbsp;<span class="op" id="3754164">(</span><span class="ident" id="3754165">value</span><span class="op" id="3754170">,</span>&nbsp;<span class="ident" id="3754172">rest</span>&nbsp;<span class="op" id="3754177">[</span><span class="op" id="3754178">]</span><span class="builtintype" id="3754179">byte</span><span class="op" id="3754183">,</span>&nbsp;<span class="ident" id="3754185">err</span>&nbsp;<span class="builtintype" id="3754189">error</span><span class="op" id="3754194">)</span>&nbsp;<span class="op" id="3754196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754199">scan</span><span class="op" id="3754203">.</span><span class="ident" id="3754204">reset</span><span class="op" id="3754209">(</span><span class="op" id="3754210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754213">for</span>&nbsp;<span class="ident" id="3754217">i</span><span class="op" id="3754218">,</span>&nbsp;<span class="ident" id="3754220">c</span>&nbsp;<span class="op" id="3754222">:=</span>&nbsp;<span class="keyword" id="3754225">range</span>&nbsp;<span class="ident" id="3754231">data</span>&nbsp;<span class="op" id="3754236">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754240">v</span>&nbsp;<span class="op" id="3754242">:=</span>&nbsp;<span class="ident" id="3754245">scan</span><span class="op" id="3754249">.</span><span class="ident" id="3754250">step</span><span class="op" id="3754254">(</span><span class="ident" id="3754255">scan</span><span class="op" id="3754259">,</span>&nbsp;<span class="builtintype" id="3754261">int</span><span class="op" id="3754264">(</span><span class="ident" id="3754265">c</span><span class="op" id="3754266">)</span><span class="op" id="3754267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754271">if</span>&nbsp;<span class="ident" id="3754274">v</span>&nbsp;<span class="op" id="3754276">&gt;=</span>&nbsp;<span class="ident" id="3754279">scanEnd</span>&nbsp;<span class="op" id="3754287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754292">switch</span>&nbsp;<span class="ident" id="3754299">v</span>&nbsp;<span class="op" id="3754301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754306">case</span>&nbsp;<span class="ident" id="3754311">scanError</span><span class="op" id="3754320">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754326">return</span>&nbsp;<span class="ident" id="3754333">nil</span><span class="op" id="3754336">,</span>&nbsp;<span class="ident" id="3754338">nil</span><span class="op" id="3754341">,</span>&nbsp;<span class="ident" id="3754343">scan</span><span class="op" id="3754347">.</span><span class="ident" id="3754348">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754355">case</span>&nbsp;<span class="ident" id="3754360">scanEnd</span><span class="op" id="3754367">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754373">return</span>&nbsp;<span class="ident" id="3754380">data</span><span class="op" id="3754384">[</span><span class="num" id="3754385">0</span><span class="op" id="3754386">:</span><span class="ident" id="3754387">i</span><span class="op" id="3754388">]</span><span class="op" id="3754389">,</span>&nbsp;<span class="ident" id="3754391">data</span><span class="op" id="3754395">[</span><span class="ident" id="3754396">i</span><span class="op" id="3754397">:</span><span class="op" id="3754398">]</span><span class="op" id="3754399">,</span>&nbsp;<span class="ident" id="3754401">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754415">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754418">if</span>&nbsp;<span class="ident" id="3754421">scan</span><span class="op" id="3754425">.</span><span class="ident" id="3754426">eof</span><span class="op" id="3754429">(</span><span class="op" id="3754430">)</span>&nbsp;<span class="op" id="3754432">==</span>&nbsp;<span class="ident" id="3754435">scanError</span>&nbsp;<span class="op" id="3754445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754449">return</span>&nbsp;<span class="ident" id="3754456">nil</span><span class="op" id="3754459">,</span>&nbsp;<span class="ident" id="3754461">nil</span><span class="op" id="3754464">,</span>&nbsp;<span class="ident" id="3754466">scan</span><span class="op" id="3754470">.</span><span class="ident" id="3754471">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754479">return</span>&nbsp;<span class="ident" id="3754486">data</span><span class="op" id="3754490">,</span>&nbsp;<span class="ident" id="3754492">nil</span><span class="op" id="3754495">,</span>&nbsp;<span class="ident" id="3754497">nil</span><br>
<span class="lineno"></span><span class="op" id="3754501">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="3754504">//&nbsp;A&nbsp;SyntaxError&nbsp;is&nbsp;a&nbsp;description&nbsp;of&nbsp;a&nbsp;JSON&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3754562">type</span>&nbsp;<span class="ident" id="3754567">SyntaxError</span>&nbsp;<span class="keyword" id="3754579">struct</span>&nbsp;<span class="op" id="3754586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754589">msg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3754596">string</span>&nbsp;<span class="comment" id="3754603">//&nbsp;description&nbsp;of&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754628">Offset</span>&nbsp;<span class="ident" id="3754635">int64</span>&nbsp;&nbsp;<span class="comment" id="3754642">//&nbsp;error&nbsp;occurred&nbsp;after&nbsp;reading&nbsp;Offset&nbsp;bytes</span><br>
<span class="lineno">60</span><span class="op" id="3754687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3754690">func</span>&nbsp;<span class="op" id="3754695">(</span><span class="ident" id="3754696">e</span>&nbsp;<span class="op" id="3754698">*</span><span class="ident" id="3754699">SyntaxError</span><span class="op" id="3754710">)</span>&nbsp;<span class="ident" id="3754712">Error</span><span class="op" id="3754717">(</span><span class="op" id="3754718">)</span>&nbsp;<span class="builtintype" id="3754720">string</span>&nbsp;<span class="op" id="3754727">{</span>&nbsp;<span class="keyword" id="3754729">return</span>&nbsp;<span class="ident" id="3754736">e</span><span class="op" id="3754737">.</span><span class="ident" id="3754738">msg</span>&nbsp;<span class="op" id="3754742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3754745">//&nbsp;A&nbsp;scanner&nbsp;is&nbsp;a&nbsp;JSON&nbsp;scanning&nbsp;state&nbsp;machine.</span><br>
<span class="lineno">65</span><span class="comment" id="3754792">//&nbsp;Callers&nbsp;call&nbsp;scan.reset()&nbsp;and&nbsp;then&nbsp;pass&nbsp;bytes&nbsp;in&nbsp;one&nbsp;at&nbsp;a&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="3754858">//&nbsp;by&nbsp;calling&nbsp;scan.step(&amp;scan,&nbsp;c)&nbsp;for&nbsp;each&nbsp;byte.</span><br>
<span class="lineno"></span><span class="comment" id="3754907">//&nbsp;The&nbsp;return&nbsp;value,&nbsp;referred&nbsp;to&nbsp;as&nbsp;an&nbsp;opcode,&nbsp;tells&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3754964">//&nbsp;caller&nbsp;about&nbsp;significant&nbsp;parsing&nbsp;events&nbsp;like&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="3755022">//&nbsp;and&nbsp;ending&nbsp;literals,&nbsp;objects,&nbsp;and&nbsp;arrays,&nbsp;so&nbsp;that&nbsp;the</span><br>
<span class="lineno">70</span><span class="comment" id="3755079">//&nbsp;caller&nbsp;can&nbsp;follow&nbsp;along&nbsp;if&nbsp;it&nbsp;wishes.</span><br>
<span class="lineno"></span><span class="comment" id="3755120">//&nbsp;The&nbsp;return&nbsp;value&nbsp;scanEnd&nbsp;indicates&nbsp;that&nbsp;a&nbsp;single&nbsp;top-level</span><br>
<span class="lineno"></span><span class="comment" id="3755182">//&nbsp;JSON&nbsp;value&nbsp;has&nbsp;been&nbsp;completed,&nbsp;*before*&nbsp;the&nbsp;byte&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3755239">//&nbsp;just&nbsp;got&nbsp;passed&nbsp;in.&nbsp;&nbsp;(The&nbsp;indication&nbsp;must&nbsp;be&nbsp;delayed&nbsp;in&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="3755304">//&nbsp;to&nbsp;recognize&nbsp;the&nbsp;end&nbsp;of&nbsp;numbers:&nbsp;is&nbsp;123&nbsp;a&nbsp;whole&nbsp;value&nbsp;or</span><br>
<span class="lineno">75</span><span class="comment" id="3755364">//&nbsp;the&nbsp;beginning&nbsp;of&nbsp;12345e+6?).</span><br>
<span class="lineno"></span><span class="keyword" id="3755396">type</span>&nbsp;<span class="ident" id="3755401">scanner</span>&nbsp;<span class="keyword" id="3755409">struct</span>&nbsp;<span class="op" id="3755416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755419">//&nbsp;The&nbsp;step&nbsp;is&nbsp;a&nbsp;func&nbsp;to&nbsp;be&nbsp;called&nbsp;to&nbsp;execute&nbsp;the&nbsp;next&nbsp;transition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755487">//&nbsp;Also&nbsp;tried&nbsp;using&nbsp;an&nbsp;integer&nbsp;constant&nbsp;and&nbsp;a&nbsp;single&nbsp;func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755546">//&nbsp;with&nbsp;a&nbsp;switch,&nbsp;but&nbsp;using&nbsp;the&nbsp;func&nbsp;directly&nbsp;was&nbsp;10%&nbsp;faster</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755608">//&nbsp;on&nbsp;a&nbsp;64-bit&nbsp;Mac&nbsp;Mini,&nbsp;and&nbsp;it&#39;s&nbsp;nicer&nbsp;to&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755658">step</span>&nbsp;<span class="keyword" id="3755663">func</span><span class="op" id="3755667">(</span><span class="op" id="3755668">*</span><span class="ident" id="3755669">scanner</span><span class="op" id="3755676">,</span>&nbsp;<span class="builtintype" id="3755678">int</span><span class="op" id="3755681">)</span>&nbsp;<span class="builtintype" id="3755683">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755689">//&nbsp;Reached&nbsp;end&nbsp;of&nbsp;top-level&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755725">endTop</span>&nbsp;<span class="builtintype" id="3755732">bool</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755739">//&nbsp;Stack&nbsp;of&nbsp;what&nbsp;we&#39;re&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;-&nbsp;array&nbsp;values,&nbsp;object&nbsp;keys,&nbsp;object&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755824">parseState</span>&nbsp;<span class="op" id="3755835">[</span><span class="op" id="3755836">]</span><span class="builtintype" id="3755837">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755843">//&nbsp;Error&nbsp;that&nbsp;happened,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755876">err</span>&nbsp;<span class="builtintype" id="3755880">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755888">//&nbsp;1-byte&nbsp;redo&nbsp;(see&nbsp;undo&nbsp;method)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755922">redo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3755932">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755938">redoCode</span>&nbsp;&nbsp;<span class="builtintype" id="3755948">int</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755953">redoState</span>&nbsp;<span class="keyword" id="3755963">func</span><span class="op" id="3755967">(</span><span class="op" id="3755968">*</span><span class="ident" id="3755969">scanner</span><span class="op" id="3755976">,</span>&nbsp;<span class="builtintype" id="3755978">int</span><span class="op" id="3755981">)</span>&nbsp;<span class="builtintype" id="3755983">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755989">//&nbsp;total&nbsp;bytes&nbsp;consumed,&nbsp;updated&nbsp;by&nbsp;decoder.Decode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756041">bytes</span>&nbsp;<span class="ident" id="3756047">int64</span><br>
<span class="lineno"></span><span class="op" id="3756053">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3756056">//&nbsp;These&nbsp;values&nbsp;are&nbsp;returned&nbsp;by&nbsp;the&nbsp;state&nbsp;transition&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="3756119">//&nbsp;assigned&nbsp;to&nbsp;scanner.state&nbsp;and&nbsp;the&nbsp;method&nbsp;scanner.eof.</span><br>
<span class="lineno"></span><span class="comment" id="3756176">//&nbsp;They&nbsp;give&nbsp;details&nbsp;about&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;the&nbsp;scan&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3756238">//&nbsp;callers&nbsp;might&nbsp;be&nbsp;interested&nbsp;to&nbsp;know&nbsp;about.</span><br>
<span class="lineno">105</span><span class="comment" id="3756284">//&nbsp;It&nbsp;is&nbsp;okay&nbsp;to&nbsp;ignore&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;any&nbsp;particular</span><br>
<span class="lineno"></span><span class="comment" id="3756343">//&nbsp;call&nbsp;to&nbsp;scanner.state:&nbsp;if&nbsp;one&nbsp;call&nbsp;returns&nbsp;scanError,</span><br>
<span class="lineno"></span><span class="comment" id="3756400">//&nbsp;every&nbsp;subsequent&nbsp;call&nbsp;will&nbsp;return&nbsp;scanError&nbsp;too.</span><br>
<span class="lineno"></span><span class="keyword" id="3756452">const</span>&nbsp;<span class="op" id="3756458">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3756461">//&nbsp;Continue.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756475">scanContinue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3756492">=</span>&nbsp;<span class="ident" id="3756494">iota</span>&nbsp;<span class="comment" id="3756499">//&nbsp;uninteresting&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756522">scanBeginLiteral</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3756546">//&nbsp;end&nbsp;implied&nbsp;by&nbsp;next&nbsp;result&nbsp;!=&nbsp;scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756593">scanBeginObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3756617">//&nbsp;begin&nbsp;object</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756634">scanObjectKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3756658">//&nbsp;just&nbsp;finished&nbsp;object&nbsp;key&nbsp;(string)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756696">scanObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3756720">//&nbsp;just&nbsp;finished&nbsp;non-last&nbsp;object&nbsp;value</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756760">scanEndObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3756784">//&nbsp;end&nbsp;object&nbsp;(implies&nbsp;scanObjectValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756837">scanBeginArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3756861">//&nbsp;begin&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756877">scanArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3756901">//&nbsp;just&nbsp;finished&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3756931">scanEndArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3756955">//&nbsp;end&nbsp;array&nbsp;(implies&nbsp;scanArrayValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757006">scanSkipSpace</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3757030">//&nbsp;space&nbsp;byte;&nbsp;can&nbsp;skip;&nbsp;known&nbsp;to&nbsp;be&nbsp;last&nbsp;&#34;continue&#34;&nbsp;result</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3757092">//&nbsp;Stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757102">scanEnd</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3757112">//&nbsp;top-level&nbsp;value&nbsp;ended&nbsp;*before*&nbsp;this&nbsp;byte;&nbsp;known&nbsp;to&nbsp;be&nbsp;first&nbsp;&#34;stop&#34;&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757190">scanError</span>&nbsp;<span class="comment" id="3757200">//&nbsp;hit&nbsp;an&nbsp;error,&nbsp;scanner.err.</span><br>
<span class="lineno"></span><span class="op" id="3757230">)</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="3757233">//&nbsp;These&nbsp;values&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;parseState&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="3757285">//&nbsp;They&nbsp;give&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;a&nbsp;composite&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="3757337">//&nbsp;being&nbsp;scanned.&nbsp;&nbsp;If&nbsp;the&nbsp;parser&nbsp;is&nbsp;inside&nbsp;a&nbsp;nested&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="3757395">//&nbsp;the&nbsp;parseState&nbsp;describes&nbsp;the&nbsp;nested&nbsp;state,&nbsp;outermost&nbsp;at&nbsp;entry&nbsp;0.</span><br>
<span class="lineno">130</span><span class="keyword" id="3757463">const</span>&nbsp;<span class="op" id="3757469">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757472">parseObjectKey</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3757489">=</span>&nbsp;<span class="ident" id="3757491">iota</span>&nbsp;<span class="comment" id="3757496">//&nbsp;parsing&nbsp;object&nbsp;key&nbsp;(before&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757534">parseObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3757558">//&nbsp;parsing&nbsp;object&nbsp;value&nbsp;(after&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757597">parseArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3757621">//&nbsp;parsing&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span><span class="op" id="3757644">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="3757647">//&nbsp;reset&nbsp;prepares&nbsp;the&nbsp;scanner&nbsp;for&nbsp;use.</span><br>
<span class="lineno"></span><span class="comment" id="3757686">//&nbsp;It&nbsp;must&nbsp;be&nbsp;called&nbsp;before&nbsp;calling&nbsp;s.step.</span><br>
<span class="lineno"></span><span class="keyword" id="3757730">func</span>&nbsp;<span class="op" id="3757735">(</span><span class="ident" id="3757736">s</span>&nbsp;<span class="op" id="3757738">*</span><span class="ident" id="3757739">scanner</span><span class="op" id="3757746">)</span>&nbsp;<span class="ident" id="3757748">reset</span><span class="op" id="3757753">(</span><span class="op" id="3757754">)</span>&nbsp;<span class="op" id="3757756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757759">s</span><span class="op" id="3757760">.</span><span class="ident" id="3757761">step</span>&nbsp;<span class="op" id="3757766">=</span>&nbsp;<span class="ident" id="3757768">stateBeginValue</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757785">s</span><span class="op" id="3757786">.</span><span class="ident" id="3757787">parseState</span>&nbsp;<span class="op" id="3757798">=</span>&nbsp;<span class="ident" id="3757800">s</span><span class="op" id="3757801">.</span><span class="ident" id="3757802">parseState</span><span class="op" id="3757812">[</span><span class="num" id="3757813">0</span><span class="op" id="3757814">:</span><span class="num" id="3757815">0</span><span class="op" id="3757816">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757819">s</span><span class="op" id="3757820">.</span><span class="ident" id="3757821">err</span>&nbsp;<span class="op" id="3757825">=</span>&nbsp;<span class="ident" id="3757827">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757832">s</span><span class="op" id="3757833">.</span><span class="ident" id="3757834">redo</span>&nbsp;<span class="op" id="3757839">=</span>&nbsp;<span class="builtintype" id="3757841">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757848">s</span><span class="op" id="3757849">.</span><span class="ident" id="3757850">endTop</span>&nbsp;<span class="op" id="3757857">=</span>&nbsp;<span class="builtintype" id="3757859">false</span><br>
<span class="lineno"></span><span class="op" id="3757865">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="3757868">//&nbsp;eof&nbsp;tells&nbsp;the&nbsp;scanner&nbsp;that&nbsp;the&nbsp;end&nbsp;of&nbsp;input&nbsp;has&nbsp;been&nbsp;reached.</span><br>
<span class="lineno"></span><span class="comment" id="3757933">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;scan&nbsp;status&nbsp;just&nbsp;as&nbsp;s.step&nbsp;does.</span><br>
<span class="lineno"></span><span class="keyword" id="3757982">func</span>&nbsp;<span class="op" id="3757987">(</span><span class="ident" id="3757988">s</span>&nbsp;<span class="op" id="3757990">*</span><span class="ident" id="3757991">scanner</span><span class="op" id="3757998">)</span>&nbsp;<span class="ident" id="3758000">eof</span><span class="op" id="3758003">(</span><span class="op" id="3758004">)</span>&nbsp;<span class="builtintype" id="3758006">int</span>&nbsp;<span class="op" id="3758010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758013">if</span>&nbsp;<span class="ident" id="3758016">s</span><span class="op" id="3758017">.</span><span class="ident" id="3758018">err</span>&nbsp;<span class="op" id="3758022">!=</span>&nbsp;<span class="ident" id="3758025">nil</span>&nbsp;<span class="op" id="3758029">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758033">return</span>&nbsp;<span class="ident" id="3758040">scanError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3758051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758054">if</span>&nbsp;<span class="ident" id="3758057">s</span><span class="op" id="3758058">.</span><span class="ident" id="3758059">endTop</span>&nbsp;<span class="op" id="3758066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758070">return</span>&nbsp;<span class="ident" id="3758077">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3758086">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758089">s</span><span class="op" id="3758090">.</span><span class="ident" id="3758091">step</span><span class="op" id="3758095">(</span><span class="ident" id="3758096">s</span><span class="op" id="3758097">,</span>&nbsp;<span class="string" id="3758099">&#39;&nbsp;&#39;</span><span class="op" id="3758102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758105">if</span>&nbsp;<span class="ident" id="3758108">s</span><span class="op" id="3758109">.</span><span class="ident" id="3758110">endTop</span>&nbsp;<span class="op" id="3758117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758121">return</span>&nbsp;<span class="ident" id="3758128">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3758137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758140">if</span>&nbsp;<span class="ident" id="3758143">s</span><span class="op" id="3758144">.</span><span class="ident" id="3758145">err</span>&nbsp;<span class="op" id="3758149">==</span>&nbsp;<span class="ident" id="3758152">nil</span>&nbsp;<span class="op" id="3758156">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758160">s</span><span class="op" id="3758161">.</span><span class="ident" id="3758162">err</span>&nbsp;<span class="op" id="3758166">=</span>&nbsp;<span class="op" id="3758168">&amp;</span><span class="ident" id="3758169">SyntaxError</span><span class="op" id="3758180">{</span><span class="string" id="3758181">&#34;unexpected&nbsp;end&nbsp;of&nbsp;JSON&nbsp;input&#34;</span><span class="op" id="3758211">,</span>&nbsp;<span class="ident" id="3758213">s</span><span class="op" id="3758214">.</span><span class="ident" id="3758215">bytes</span><span class="op" id="3758220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3758223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758226">return</span>&nbsp;<span class="ident" id="3758233">scanError</span><br>
<span class="lineno"></span><span class="op" id="3758243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="3758246">//&nbsp;pushParseState&nbsp;pushes&nbsp;a&nbsp;new&nbsp;parse&nbsp;state&nbsp;p&nbsp;onto&nbsp;the&nbsp;parse&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="3758313">func</span>&nbsp;<span class="op" id="3758318">(</span><span class="ident" id="3758319">s</span>&nbsp;<span class="op" id="3758321">*</span><span class="ident" id="3758322">scanner</span><span class="op" id="3758329">)</span>&nbsp;<span class="ident" id="3758331">pushParseState</span><span class="op" id="3758345">(</span><span class="ident" id="3758346">p</span>&nbsp;<span class="builtintype" id="3758348">int</span><span class="op" id="3758351">)</span>&nbsp;<span class="op" id="3758353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758356">s</span><span class="op" id="3758357">.</span><span class="ident" id="3758358">parseState</span>&nbsp;<span class="op" id="3758369">=</span>&nbsp;<span class="builtinfunc" id="3758371">append</span><span class="op" id="3758377">(</span><span class="ident" id="3758378">s</span><span class="op" id="3758379">.</span><span class="ident" id="3758380">parseState</span><span class="op" id="3758390">,</span>&nbsp;<span class="ident" id="3758392">p</span><span class="op" id="3758393">)</span><br>
<span class="lineno"></span><span class="op" id="3758395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="3758398">//&nbsp;popParseState&nbsp;pops&nbsp;a&nbsp;parse&nbsp;state&nbsp;(already&nbsp;obtained)&nbsp;off&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="3758467">//&nbsp;and&nbsp;updates&nbsp;s.step&nbsp;accordingly.</span><br>
<span class="lineno"></span><span class="keyword" id="3758502">func</span>&nbsp;<span class="op" id="3758507">(</span><span class="ident" id="3758508">s</span>&nbsp;<span class="op" id="3758510">*</span><span class="ident" id="3758511">scanner</span><span class="op" id="3758518">)</span>&nbsp;<span class="ident" id="3758520">popParseState</span><span class="op" id="3758533">(</span><span class="op" id="3758534">)</span>&nbsp;<span class="op" id="3758536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758539">n</span>&nbsp;<span class="op" id="3758541">:=</span>&nbsp;<span class="builtinfunc" id="3758544">len</span><span class="op" id="3758547">(</span><span class="ident" id="3758548">s</span><span class="op" id="3758549">.</span><span class="ident" id="3758550">parseState</span><span class="op" id="3758560">)</span>&nbsp;<span class="op" id="3758562">-</span>&nbsp;<span class="num" id="3758564">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758567">s</span><span class="op" id="3758568">.</span><span class="ident" id="3758569">parseState</span>&nbsp;<span class="op" id="3758580">=</span>&nbsp;<span class="ident" id="3758582">s</span><span class="op" id="3758583">.</span><span class="ident" id="3758584">parseState</span><span class="op" id="3758594">[</span><span class="num" id="3758595">0</span><span class="op" id="3758596">:</span><span class="ident" id="3758597">n</span><span class="op" id="3758598">]</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758601">s</span><span class="op" id="3758602">.</span><span class="ident" id="3758603">redo</span>&nbsp;<span class="op" id="3758608">=</span>&nbsp;<span class="builtintype" id="3758610">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758617">if</span>&nbsp;<span class="ident" id="3758620">n</span>&nbsp;<span class="op" id="3758622">==</span>&nbsp;<span class="num" id="3758625">0</span>&nbsp;<span class="op" id="3758627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758631">s</span><span class="op" id="3758632">.</span><span class="ident" id="3758633">step</span>&nbsp;<span class="op" id="3758638">=</span>&nbsp;<span class="ident" id="3758640">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758654">s</span><span class="op" id="3758655">.</span><span class="ident" id="3758656">endTop</span>&nbsp;<span class="op" id="3758663">=</span>&nbsp;<span class="builtintype" id="3758665">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3758671">}</span>&nbsp;<span class="keyword" id="3758673">else</span>&nbsp;<span class="op" id="3758678">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758682">s</span><span class="op" id="3758683">.</span><span class="ident" id="3758684">step</span>&nbsp;<span class="op" id="3758689">=</span>&nbsp;<span class="ident" id="3758691">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3758706">}</span><br>
<span class="lineno"></span><span class="op" id="3758708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3758711">func</span>&nbsp;<span class="ident" id="3758716">isSpace</span><span class="op" id="3758723">(</span><span class="ident" id="3758724">c</span>&nbsp;<span class="builtintype" id="3758726">rune</span><span class="op" id="3758730">)</span>&nbsp;<span class="builtintype" id="3758732">bool</span>&nbsp;<span class="op" id="3758737">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758740">return</span>&nbsp;<span class="ident" id="3758747">c</span>&nbsp;<span class="op" id="3758749">==</span>&nbsp;<span class="string" id="3758752">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3758756">||</span>&nbsp;<span class="ident" id="3758759">c</span>&nbsp;<span class="op" id="3758761">==</span>&nbsp;<span class="string" id="3758764">&#39;\t&#39;</span>&nbsp;<span class="op" id="3758769">||</span>&nbsp;<span class="ident" id="3758772">c</span>&nbsp;<span class="op" id="3758774">==</span>&nbsp;<span class="string" id="3758777">&#39;\r&#39;</span>&nbsp;<span class="op" id="3758782">||</span>&nbsp;<span class="ident" id="3758785">c</span>&nbsp;<span class="op" id="3758787">==</span>&nbsp;<span class="string" id="3758790">&#39;\n&#39;</span><br>
<span class="lineno"></span><span class="op" id="3758795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3758798">//&nbsp;stateBeginValueOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`[`.</span><br>
<span class="lineno"></span><span class="keyword" id="3758856">func</span>&nbsp;<span class="ident" id="3758861">stateBeginValueOrEmpty</span><span class="op" id="3758883">(</span><span class="ident" id="3758884">s</span>&nbsp;<span class="op" id="3758886">*</span><span class="ident" id="3758887">scanner</span><span class="op" id="3758894">,</span>&nbsp;<span class="ident" id="3758896">c</span>&nbsp;<span class="builtintype" id="3758898">int</span><span class="op" id="3758901">)</span>&nbsp;<span class="builtintype" id="3758903">int</span>&nbsp;<span class="op" id="3758907">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758910">if</span>&nbsp;<span class="ident" id="3758913">c</span>&nbsp;<span class="op" id="3758915">&lt;=</span>&nbsp;<span class="string" id="3758918">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3758922">&amp;&amp;</span>&nbsp;<span class="ident" id="3758925">isSpace</span><span class="op" id="3758932">(</span><span class="builtintype" id="3758933">rune</span><span class="op" id="3758937">(</span><span class="ident" id="3758938">c</span><span class="op" id="3758939">)</span><span class="op" id="3758940">)</span>&nbsp;<span class="op" id="3758942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758946">return</span>&nbsp;<span class="ident" id="3758953">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3758968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758971">if</span>&nbsp;<span class="ident" id="3758974">c</span>&nbsp;<span class="op" id="3758976">==</span>&nbsp;<span class="string" id="3758979">&#39;]&#39;</span>&nbsp;<span class="op" id="3758983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758987">return</span>&nbsp;<span class="ident" id="3758994">stateEndValue</span><span class="op" id="3759007">(</span><span class="ident" id="3759008">s</span><span class="op" id="3759009">,</span>&nbsp;<span class="ident" id="3759011">c</span><span class="op" id="3759012">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759018">return</span>&nbsp;<span class="ident" id="3759025">stateBeginValue</span><span class="op" id="3759040">(</span><span class="ident" id="3759041">s</span><span class="op" id="3759042">,</span>&nbsp;<span class="ident" id="3759044">c</span><span class="op" id="3759045">)</span><br>
<span class="lineno"></span><span class="op" id="3759047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3759050">//&nbsp;stateBeginValue&nbsp;is&nbsp;the&nbsp;state&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;input.</span><br>
<span class="lineno">200</span><span class="keyword" id="3759113">func</span>&nbsp;<span class="ident" id="3759118">stateBeginValue</span><span class="op" id="3759133">(</span><span class="ident" id="3759134">s</span>&nbsp;<span class="op" id="3759136">*</span><span class="ident" id="3759137">scanner</span><span class="op" id="3759144">,</span>&nbsp;<span class="ident" id="3759146">c</span>&nbsp;<span class="builtintype" id="3759148">int</span><span class="op" id="3759151">)</span>&nbsp;<span class="builtintype" id="3759153">int</span>&nbsp;<span class="op" id="3759157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759160">if</span>&nbsp;<span class="ident" id="3759163">c</span>&nbsp;<span class="op" id="3759165">&lt;=</span>&nbsp;<span class="string" id="3759168">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3759172">&amp;&amp;</span>&nbsp;<span class="ident" id="3759175">isSpace</span><span class="op" id="3759182">(</span><span class="builtintype" id="3759183">rune</span><span class="op" id="3759187">(</span><span class="ident" id="3759188">c</span><span class="op" id="3759189">)</span><span class="op" id="3759190">)</span>&nbsp;<span class="op" id="3759192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759196">return</span>&nbsp;<span class="ident" id="3759203">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759221">switch</span>&nbsp;<span class="ident" id="3759228">c</span>&nbsp;<span class="op" id="3759230">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759233">case</span>&nbsp;<span class="string" id="3759238">&#39;{&#39;</span><span class="op" id="3759241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759245">s</span><span class="op" id="3759246">.</span><span class="ident" id="3759247">step</span>&nbsp;<span class="op" id="3759252">=</span>&nbsp;<span class="ident" id="3759254">stateBeginStringOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759280">s</span><span class="op" id="3759281">.</span><span class="ident" id="3759282">pushParseState</span><span class="op" id="3759296">(</span><span class="ident" id="3759297">parseObjectKey</span><span class="op" id="3759311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759315">return</span>&nbsp;<span class="ident" id="3759322">scanBeginObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759339">case</span>&nbsp;<span class="string" id="3759344">&#39;[&#39;</span><span class="op" id="3759347">:</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759351">s</span><span class="op" id="3759352">.</span><span class="ident" id="3759353">step</span>&nbsp;<span class="op" id="3759358">=</span>&nbsp;<span class="ident" id="3759360">stateBeginValueOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759385">s</span><span class="op" id="3759386">.</span><span class="ident" id="3759387">pushParseState</span><span class="op" id="3759401">(</span><span class="ident" id="3759402">parseArrayValue</span><span class="op" id="3759417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759421">return</span>&nbsp;<span class="ident" id="3759428">scanBeginArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759444">case</span>&nbsp;<span class="string" id="3759449">&#39;&#34;&#39;</span><span class="op" id="3759452">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759456">s</span><span class="op" id="3759457">.</span><span class="ident" id="3759458">step</span>&nbsp;<span class="op" id="3759463">=</span>&nbsp;<span class="ident" id="3759465">stateInString</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759481">return</span>&nbsp;<span class="ident" id="3759488">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759506">case</span>&nbsp;<span class="string" id="3759511">&#39;-&#39;</span><span class="op" id="3759514">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759518">s</span><span class="op" id="3759519">.</span><span class="ident" id="3759520">step</span>&nbsp;<span class="op" id="3759525">=</span>&nbsp;<span class="ident" id="3759527">stateNeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759538">return</span>&nbsp;<span class="ident" id="3759545">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759563">case</span>&nbsp;<span class="string" id="3759568">&#39;0&#39;</span><span class="op" id="3759571">:</span>&nbsp;<span class="comment" id="3759573">//&nbsp;beginning&nbsp;of&nbsp;0.123</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759597">s</span><span class="op" id="3759598">.</span><span class="ident" id="3759599">step</span>&nbsp;<span class="op" id="3759604">=</span>&nbsp;<span class="ident" id="3759606">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759615">return</span>&nbsp;<span class="ident" id="3759622">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759640">case</span>&nbsp;<span class="string" id="3759645">&#39;t&#39;</span><span class="op" id="3759648">:</span>&nbsp;<span class="comment" id="3759650">//&nbsp;beginning&nbsp;of&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759673">s</span><span class="op" id="3759674">.</span><span class="ident" id="3759675">step</span>&nbsp;<span class="op" id="3759680">=</span>&nbsp;<span class="ident" id="3759682">stateT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759691">return</span>&nbsp;<span class="ident" id="3759698">scanBeginLiteral</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759716">case</span>&nbsp;<span class="string" id="3759721">&#39;f&#39;</span><span class="op" id="3759724">:</span>&nbsp;<span class="comment" id="3759726">//&nbsp;beginning&nbsp;of&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759750">s</span><span class="op" id="3759751">.</span><span class="ident" id="3759752">step</span>&nbsp;<span class="op" id="3759757">=</span>&nbsp;<span class="ident" id="3759759">stateF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759768">return</span>&nbsp;<span class="ident" id="3759775">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759793">case</span>&nbsp;<span class="string" id="3759798">&#39;n&#39;</span><span class="op" id="3759801">:</span>&nbsp;<span class="comment" id="3759803">//&nbsp;beginning&nbsp;of&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759826">s</span><span class="op" id="3759827">.</span><span class="ident" id="3759828">step</span>&nbsp;<span class="op" id="3759833">=</span>&nbsp;<span class="ident" id="3759835">stateN</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759844">return</span>&nbsp;<span class="ident" id="3759851">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759872">if</span>&nbsp;<span class="string" id="3759875">&#39;1&#39;</span>&nbsp;<span class="op" id="3759879">&lt;=</span>&nbsp;<span class="ident" id="3759882">c</span>&nbsp;<span class="op" id="3759884">&amp;&amp;</span>&nbsp;<span class="ident" id="3759887">c</span>&nbsp;<span class="op" id="3759889">&lt;=</span>&nbsp;<span class="string" id="3759892">&#39;9&#39;</span>&nbsp;<span class="op" id="3759896">{</span>&nbsp;<span class="comment" id="3759898">//&nbsp;beginning&nbsp;of&nbsp;1234.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759923">s</span><span class="op" id="3759924">.</span><span class="ident" id="3759925">step</span>&nbsp;<span class="op" id="3759930">=</span>&nbsp;<span class="ident" id="3759932">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759941">return</span>&nbsp;<span class="ident" id="3759948">scanBeginLiteral</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759969">return</span>&nbsp;<span class="ident" id="3759976">s</span><span class="op" id="3759977">.</span><span class="builtintype" id="3759978">error</span><span class="op" id="3759983">(</span><span class="ident" id="3759984">c</span><span class="op" id="3759985">,</span>&nbsp;<span class="string" id="3759987">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;value&#34;</span><span class="op" id="3760019">)</span><br>
<span class="lineno"></span><span class="op" id="3760021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3760024">//&nbsp;stateBeginStringOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{`.</span><br>
<span class="lineno">240</span><span class="keyword" id="3760083">func</span>&nbsp;<span class="ident" id="3760088">stateBeginStringOrEmpty</span><span class="op" id="3760111">(</span><span class="ident" id="3760112">s</span>&nbsp;<span class="op" id="3760114">*</span><span class="ident" id="3760115">scanner</span><span class="op" id="3760122">,</span>&nbsp;<span class="ident" id="3760124">c</span>&nbsp;<span class="builtintype" id="3760126">int</span><span class="op" id="3760129">)</span>&nbsp;<span class="builtintype" id="3760131">int</span>&nbsp;<span class="op" id="3760135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760138">if</span>&nbsp;<span class="ident" id="3760141">c</span>&nbsp;<span class="op" id="3760143">&lt;=</span>&nbsp;<span class="string" id="3760146">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3760150">&amp;&amp;</span>&nbsp;<span class="ident" id="3760153">isSpace</span><span class="op" id="3760160">(</span><span class="builtintype" id="3760161">rune</span><span class="op" id="3760165">(</span><span class="ident" id="3760166">c</span><span class="op" id="3760167">)</span><span class="op" id="3760168">)</span>&nbsp;<span class="op" id="3760170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760174">return</span>&nbsp;<span class="ident" id="3760181">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3760196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760199">if</span>&nbsp;<span class="ident" id="3760202">c</span>&nbsp;<span class="op" id="3760204">==</span>&nbsp;<span class="string" id="3760207">&#39;}&#39;</span>&nbsp;<span class="op" id="3760211">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760215">n</span>&nbsp;<span class="op" id="3760217">:=</span>&nbsp;<span class="builtinfunc" id="3760220">len</span><span class="op" id="3760223">(</span><span class="ident" id="3760224">s</span><span class="op" id="3760225">.</span><span class="ident" id="3760226">parseState</span><span class="op" id="3760236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760240">s</span><span class="op" id="3760241">.</span><span class="ident" id="3760242">parseState</span><span class="op" id="3760252">[</span><span class="ident" id="3760253">n</span><span class="op" id="3760254">-</span><span class="num" id="3760255">1</span><span class="op" id="3760256">]</span>&nbsp;<span class="op" id="3760258">=</span>&nbsp;<span class="ident" id="3760260">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760279">return</span>&nbsp;<span class="ident" id="3760286">stateEndValue</span><span class="op" id="3760299">(</span><span class="ident" id="3760300">s</span><span class="op" id="3760301">,</span>&nbsp;<span class="ident" id="3760303">c</span><span class="op" id="3760304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3760307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760310">return</span>&nbsp;<span class="ident" id="3760317">stateBeginString</span><span class="op" id="3760333">(</span><span class="ident" id="3760334">s</span><span class="op" id="3760335">,</span>&nbsp;<span class="ident" id="3760337">c</span><span class="op" id="3760338">)</span><br>
<span class="lineno">250</span><span class="op" id="3760340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3760343">//&nbsp;stateBeginString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{&#34;key&#34;:&nbsp;value,`.</span><br>
<span class="lineno"></span><span class="keyword" id="3760408">func</span>&nbsp;<span class="ident" id="3760413">stateBeginString</span><span class="op" id="3760429">(</span><span class="ident" id="3760430">s</span>&nbsp;<span class="op" id="3760432">*</span><span class="ident" id="3760433">scanner</span><span class="op" id="3760440">,</span>&nbsp;<span class="ident" id="3760442">c</span>&nbsp;<span class="builtintype" id="3760444">int</span><span class="op" id="3760447">)</span>&nbsp;<span class="builtintype" id="3760449">int</span>&nbsp;<span class="op" id="3760453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760456">if</span>&nbsp;<span class="ident" id="3760459">c</span>&nbsp;<span class="op" id="3760461">&lt;=</span>&nbsp;<span class="string" id="3760464">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3760468">&amp;&amp;</span>&nbsp;<span class="ident" id="3760471">isSpace</span><span class="op" id="3760478">(</span><span class="builtintype" id="3760479">rune</span><span class="op" id="3760483">(</span><span class="ident" id="3760484">c</span><span class="op" id="3760485">)</span><span class="op" id="3760486">)</span>&nbsp;<span class="op" id="3760488">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760492">return</span>&nbsp;<span class="ident" id="3760499">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3760514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760517">if</span>&nbsp;<span class="ident" id="3760520">c</span>&nbsp;<span class="op" id="3760522">==</span>&nbsp;<span class="string" id="3760525">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3760529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760533">s</span><span class="op" id="3760534">.</span><span class="ident" id="3760535">step</span>&nbsp;<span class="op" id="3760540">=</span>&nbsp;<span class="ident" id="3760542">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760558">return</span>&nbsp;<span class="ident" id="3760565">scanBeginLiteral</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3760583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760586">return</span>&nbsp;<span class="ident" id="3760593">s</span><span class="op" id="3760594">.</span><span class="builtintype" id="3760595">error</span><span class="op" id="3760600">(</span><span class="ident" id="3760601">c</span><span class="op" id="3760602">,</span>&nbsp;<span class="string" id="3760604">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;object&nbsp;key&nbsp;string&#34;</span><span class="op" id="3760648">)</span><br>
<span class="lineno"></span><span class="op" id="3760650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3760653">//&nbsp;stateEndValue&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;completing&nbsp;a&nbsp;value,</span><br>
<span class="lineno">265</span><span class="comment" id="3760709">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`true`&nbsp;or&nbsp;`[&#34;x&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="3760760">func</span>&nbsp;<span class="ident" id="3760765">stateEndValue</span><span class="op" id="3760778">(</span><span class="ident" id="3760779">s</span>&nbsp;<span class="op" id="3760781">*</span><span class="ident" id="3760782">scanner</span><span class="op" id="3760789">,</span>&nbsp;<span class="ident" id="3760791">c</span>&nbsp;<span class="builtintype" id="3760793">int</span><span class="op" id="3760796">)</span>&nbsp;<span class="builtintype" id="3760798">int</span>&nbsp;<span class="op" id="3760802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760805">n</span>&nbsp;<span class="op" id="3760807">:=</span>&nbsp;<span class="builtinfunc" id="3760810">len</span><span class="op" id="3760813">(</span><span class="ident" id="3760814">s</span><span class="op" id="3760815">.</span><span class="ident" id="3760816">parseState</span><span class="op" id="3760826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760829">if</span>&nbsp;<span class="ident" id="3760832">n</span>&nbsp;<span class="op" id="3760834">==</span>&nbsp;<span class="num" id="3760837">0</span>&nbsp;<span class="op" id="3760839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3760843">//&nbsp;Completed&nbsp;top-level&nbsp;before&nbsp;the&nbsp;current&nbsp;byte.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760893">s</span><span class="op" id="3760894">.</span><span class="ident" id="3760895">step</span>&nbsp;<span class="op" id="3760900">=</span>&nbsp;<span class="ident" id="3760902">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760916">s</span><span class="op" id="3760917">.</span><span class="ident" id="3760918">endTop</span>&nbsp;<span class="op" id="3760925">=</span>&nbsp;<span class="builtintype" id="3760927">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760934">return</span>&nbsp;<span class="ident" id="3760941">stateEndTop</span><span class="op" id="3760952">(</span><span class="ident" id="3760953">s</span><span class="op" id="3760954">,</span>&nbsp;<span class="ident" id="3760956">c</span><span class="op" id="3760957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3760960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760963">if</span>&nbsp;<span class="ident" id="3760966">c</span>&nbsp;<span class="op" id="3760968">&lt;=</span>&nbsp;<span class="string" id="3760971">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3760975">&amp;&amp;</span>&nbsp;<span class="ident" id="3760978">isSpace</span><span class="op" id="3760985">(</span><span class="builtintype" id="3760986">rune</span><span class="op" id="3760990">(</span><span class="ident" id="3760991">c</span><span class="op" id="3760992">)</span><span class="op" id="3760993">)</span>&nbsp;<span class="op" id="3760995">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760999">s</span><span class="op" id="3761000">.</span><span class="ident" id="3761001">step</span>&nbsp;<span class="op" id="3761006">=</span>&nbsp;<span class="ident" id="3761008">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761024">return</span>&nbsp;<span class="ident" id="3761031">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761049">ps</span>&nbsp;<span class="op" id="3761052">:=</span>&nbsp;<span class="ident" id="3761055">s</span><span class="op" id="3761056">.</span><span class="ident" id="3761057">parseState</span><span class="op" id="3761067">[</span><span class="ident" id="3761068">n</span><span class="op" id="3761069">-</span><span class="num" id="3761070">1</span><span class="op" id="3761071">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761074">switch</span>&nbsp;<span class="ident" id="3761081">ps</span>&nbsp;<span class="op" id="3761084">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761087">case</span>&nbsp;<span class="ident" id="3761092">parseObjectKey</span><span class="op" id="3761106">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761110">if</span>&nbsp;<span class="ident" id="3761113">c</span>&nbsp;<span class="op" id="3761115">==</span>&nbsp;<span class="string" id="3761118">&#39;:&#39;</span>&nbsp;<span class="op" id="3761122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761127">s</span><span class="op" id="3761128">.</span><span class="ident" id="3761129">parseState</span><span class="op" id="3761139">[</span><span class="ident" id="3761140">n</span><span class="op" id="3761141">-</span><span class="num" id="3761142">1</span><span class="op" id="3761143">]</span>&nbsp;<span class="op" id="3761145">=</span>&nbsp;<span class="ident" id="3761147">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761167">s</span><span class="op" id="3761168">.</span><span class="ident" id="3761169">step</span>&nbsp;<span class="op" id="3761174">=</span>&nbsp;<span class="ident" id="3761176">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761195">return</span>&nbsp;<span class="ident" id="3761202">scanObjectKey</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761222">return</span>&nbsp;<span class="ident" id="3761229">s</span><span class="op" id="3761230">.</span><span class="builtintype" id="3761231">error</span><span class="op" id="3761236">(</span><span class="ident" id="3761237">c</span><span class="op" id="3761238">,</span>&nbsp;<span class="string" id="3761240">&#34;after&nbsp;object&nbsp;key&#34;</span><span class="op" id="3761258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761261">case</span>&nbsp;<span class="ident" id="3761266">parseObjectValue</span><span class="op" id="3761282">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761286">if</span>&nbsp;<span class="ident" id="3761289">c</span>&nbsp;<span class="op" id="3761291">==</span>&nbsp;<span class="string" id="3761294">&#39;,&#39;</span>&nbsp;<span class="op" id="3761298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761303">s</span><span class="op" id="3761304">.</span><span class="ident" id="3761305">parseState</span><span class="op" id="3761315">[</span><span class="ident" id="3761316">n</span><span class="op" id="3761317">-</span><span class="num" id="3761318">1</span><span class="op" id="3761319">]</span>&nbsp;<span class="op" id="3761321">=</span>&nbsp;<span class="ident" id="3761323">parseObjectKey</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761341">s</span><span class="op" id="3761342">.</span><span class="ident" id="3761343">step</span>&nbsp;<span class="op" id="3761348">=</span>&nbsp;<span class="ident" id="3761350">stateBeginString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761370">return</span>&nbsp;<span class="ident" id="3761377">scanObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761399">if</span>&nbsp;<span class="ident" id="3761402">c</span>&nbsp;<span class="op" id="3761404">==</span>&nbsp;<span class="string" id="3761407">&#39;}&#39;</span>&nbsp;<span class="op" id="3761411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761416">s</span><span class="op" id="3761417">.</span><span class="ident" id="3761418">popParseState</span><span class="op" id="3761431">(</span><span class="op" id="3761432">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761437">return</span>&nbsp;<span class="ident" id="3761444">scanEndObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761464">return</span>&nbsp;<span class="ident" id="3761471">s</span><span class="op" id="3761472">.</span><span class="builtintype" id="3761473">error</span><span class="op" id="3761478">(</span><span class="ident" id="3761479">c</span><span class="op" id="3761480">,</span>&nbsp;<span class="string" id="3761482">&#34;after&nbsp;object&nbsp;key:value&nbsp;pair&#34;</span><span class="op" id="3761511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761514">case</span>&nbsp;<span class="ident" id="3761519">parseArrayValue</span><span class="op" id="3761534">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761538">if</span>&nbsp;<span class="ident" id="3761541">c</span>&nbsp;<span class="op" id="3761543">==</span>&nbsp;<span class="string" id="3761546">&#39;,&#39;</span>&nbsp;<span class="op" id="3761550">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761555">s</span><span class="op" id="3761556">.</span><span class="ident" id="3761557">step</span>&nbsp;<span class="op" id="3761562">=</span>&nbsp;<span class="ident" id="3761564">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761583">return</span>&nbsp;<span class="ident" id="3761590">scanArrayValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761611">if</span>&nbsp;<span class="ident" id="3761614">c</span>&nbsp;<span class="op" id="3761616">==</span>&nbsp;<span class="string" id="3761619">&#39;]&#39;</span>&nbsp;<span class="op" id="3761623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761628">s</span><span class="op" id="3761629">.</span><span class="ident" id="3761630">popParseState</span><span class="op" id="3761643">(</span><span class="op" id="3761644">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761649">return</span>&nbsp;<span class="ident" id="3761656">scanEndArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761675">return</span>&nbsp;<span class="ident" id="3761682">s</span><span class="op" id="3761683">.</span><span class="builtintype" id="3761684">error</span><span class="op" id="3761689">(</span><span class="ident" id="3761690">c</span><span class="op" id="3761691">,</span>&nbsp;<span class="string" id="3761693">&#34;after&nbsp;array&nbsp;element&#34;</span><span class="op" id="3761714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761720">return</span>&nbsp;<span class="ident" id="3761727">s</span><span class="op" id="3761728">.</span><span class="builtintype" id="3761729">error</span><span class="op" id="3761734">(</span><span class="ident" id="3761735">c</span><span class="op" id="3761736">,</span>&nbsp;<span class="string" id="3761738">&#34;&#34;</span><span class="op" id="3761740">)</span><br>
<span class="lineno">310</span><span class="op" id="3761742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3761745">//&nbsp;stateEndTop&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;finishing&nbsp;the&nbsp;top-level&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="3761810">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`[1,2,3]`.</span><br>
<span class="lineno"></span><span class="comment" id="3761854">//&nbsp;Only&nbsp;space&nbsp;characters&nbsp;should&nbsp;be&nbsp;seen&nbsp;now.</span><br>
<span class="lineno">315</span><span class="keyword" id="3761899">func</span>&nbsp;<span class="ident" id="3761904">stateEndTop</span><span class="op" id="3761915">(</span><span class="ident" id="3761916">s</span>&nbsp;<span class="op" id="3761918">*</span><span class="ident" id="3761919">scanner</span><span class="op" id="3761926">,</span>&nbsp;<span class="ident" id="3761928">c</span>&nbsp;<span class="builtintype" id="3761930">int</span><span class="op" id="3761933">)</span>&nbsp;<span class="builtintype" id="3761935">int</span>&nbsp;<span class="op" id="3761939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761942">if</span>&nbsp;<span class="ident" id="3761945">c</span>&nbsp;<span class="op" id="3761947">!=</span>&nbsp;<span class="string" id="3761950">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3761954">&amp;&amp;</span>&nbsp;<span class="ident" id="3761957">c</span>&nbsp;<span class="op" id="3761959">!=</span>&nbsp;<span class="string" id="3761962">&#39;\t&#39;</span>&nbsp;<span class="op" id="3761967">&amp;&amp;</span>&nbsp;<span class="ident" id="3761970">c</span>&nbsp;<span class="op" id="3761972">!=</span>&nbsp;<span class="string" id="3761975">&#39;\r&#39;</span>&nbsp;<span class="op" id="3761980">&amp;&amp;</span>&nbsp;<span class="ident" id="3761983">c</span>&nbsp;<span class="op" id="3761985">!=</span>&nbsp;<span class="string" id="3761988">&#39;\n&#39;</span>&nbsp;<span class="op" id="3761993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3761997">//&nbsp;Complain&nbsp;about&nbsp;non-space&nbsp;byte&nbsp;on&nbsp;next&nbsp;call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762046">s</span><span class="op" id="3762047">.</span><span class="builtintype" id="3762048">error</span><span class="op" id="3762053">(</span><span class="ident" id="3762054">c</span><span class="op" id="3762055">,</span>&nbsp;<span class="string" id="3762057">&#34;after&nbsp;top-level&nbsp;value&#34;</span><span class="op" id="3762080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3762083">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762086">return</span>&nbsp;<span class="ident" id="3762093">scanEnd</span><br>
<span class="lineno"></span><span class="op" id="3762101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3762104">//&nbsp;stateInString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="3762153">func</span>&nbsp;<span class="ident" id="3762158">stateInString</span><span class="op" id="3762171">(</span><span class="ident" id="3762172">s</span>&nbsp;<span class="op" id="3762174">*</span><span class="ident" id="3762175">scanner</span><span class="op" id="3762182">,</span>&nbsp;<span class="ident" id="3762184">c</span>&nbsp;<span class="builtintype" id="3762186">int</span><span class="op" id="3762189">)</span>&nbsp;<span class="builtintype" id="3762191">int</span>&nbsp;<span class="op" id="3762195">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762198">if</span>&nbsp;<span class="ident" id="3762201">c</span>&nbsp;<span class="op" id="3762203">==</span>&nbsp;<span class="string" id="3762206">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3762210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762214">s</span><span class="op" id="3762215">.</span><span class="ident" id="3762216">step</span>&nbsp;<span class="op" id="3762221">=</span>&nbsp;<span class="ident" id="3762223">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762239">return</span>&nbsp;<span class="ident" id="3762246">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3762260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762263">if</span>&nbsp;<span class="ident" id="3762266">c</span>&nbsp;<span class="op" id="3762268">==</span>&nbsp;<span class="string" id="3762271">&#39;\\&#39;</span>&nbsp;<span class="op" id="3762276">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762280">s</span><span class="op" id="3762281">.</span><span class="ident" id="3762282">step</span>&nbsp;<span class="op" id="3762287">=</span>&nbsp;<span class="ident" id="3762289">stateInStringEsc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762308">return</span>&nbsp;<span class="ident" id="3762315">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3762329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762332">if</span>&nbsp;<span class="ident" id="3762335">c</span>&nbsp;<span class="op" id="3762337">&lt;</span>&nbsp;<span class="num" id="3762339">0x20</span>&nbsp;<span class="op" id="3762344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762348">return</span>&nbsp;<span class="ident" id="3762355">s</span><span class="op" id="3762356">.</span><span class="builtintype" id="3762357">error</span><span class="op" id="3762362">(</span><span class="ident" id="3762363">c</span><span class="op" id="3762364">,</span>&nbsp;<span class="string" id="3762366">&#34;in&nbsp;string&nbsp;literal&#34;</span><span class="op" id="3762385">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3762388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762391">return</span>&nbsp;<span class="ident" id="3762398">scanContinue</span><br>
<span class="lineno"></span><span class="op" id="3762411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3762414">//&nbsp;stateInStringEsc&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">340</span><span class="keyword" id="3762490">func</span>&nbsp;<span class="ident" id="3762495">stateInStringEsc</span><span class="op" id="3762511">(</span><span class="ident" id="3762512">s</span>&nbsp;<span class="op" id="3762514">*</span><span class="ident" id="3762515">scanner</span><span class="op" id="3762522">,</span>&nbsp;<span class="ident" id="3762524">c</span>&nbsp;<span class="builtintype" id="3762526">int</span><span class="op" id="3762529">)</span>&nbsp;<span class="builtintype" id="3762531">int</span>&nbsp;<span class="op" id="3762535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762538">switch</span>&nbsp;<span class="ident" id="3762545">c</span>&nbsp;<span class="op" id="3762547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762550">case</span>&nbsp;<span class="string" id="3762555">&#39;b&#39;</span><span class="op" id="3762558">,</span>&nbsp;<span class="string" id="3762560">&#39;f&#39;</span><span class="op" id="3762563">,</span>&nbsp;<span class="string" id="3762565">&#39;n&#39;</span><span class="op" id="3762568">,</span>&nbsp;<span class="string" id="3762570">&#39;r&#39;</span><span class="op" id="3762573">,</span>&nbsp;<span class="string" id="3762575">&#39;t&#39;</span><span class="op" id="3762578">,</span>&nbsp;<span class="string" id="3762580">&#39;\\&#39;</span><span class="op" id="3762584">,</span>&nbsp;<span class="string" id="3762586">&#39;/&#39;</span><span class="op" id="3762589">,</span>&nbsp;<span class="string" id="3762591">&#39;&#34;&#39;</span><span class="op" id="3762594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762598">s</span><span class="op" id="3762599">.</span><span class="ident" id="3762600">step</span>&nbsp;<span class="op" id="3762605">=</span>&nbsp;<span class="ident" id="3762607">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762623">return</span>&nbsp;<span class="ident" id="3762630">scanContinue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3762644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762647">if</span>&nbsp;<span class="ident" id="3762650">c</span>&nbsp;<span class="op" id="3762652">==</span>&nbsp;<span class="string" id="3762655">&#39;u&#39;</span>&nbsp;<span class="op" id="3762659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762663">s</span><span class="op" id="3762664">.</span><span class="ident" id="3762665">step</span>&nbsp;<span class="op" id="3762670">=</span>&nbsp;<span class="ident" id="3762672">stateInStringEscU</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762692">return</span>&nbsp;<span class="ident" id="3762699">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3762713">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762716">return</span>&nbsp;<span class="ident" id="3762723">s</span><span class="op" id="3762724">.</span><span class="builtintype" id="3762725">error</span><span class="op" id="3762730">(</span><span class="ident" id="3762731">c</span><span class="op" id="3762732">,</span>&nbsp;<span class="string" id="3762734">&#34;in&nbsp;string&nbsp;escape&nbsp;code&#34;</span><span class="op" id="3762757">)</span><br>
<span class="lineno"></span><span class="op" id="3762759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3762762">//&nbsp;stateInStringEscU&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3762840">func</span>&nbsp;<span class="ident" id="3762845">stateInStringEscU</span><span class="op" id="3762862">(</span><span class="ident" id="3762863">s</span>&nbsp;<span class="op" id="3762865">*</span><span class="ident" id="3762866">scanner</span><span class="op" id="3762873">,</span>&nbsp;<span class="ident" id="3762875">c</span>&nbsp;<span class="builtintype" id="3762877">int</span><span class="op" id="3762880">)</span>&nbsp;<span class="builtintype" id="3762882">int</span>&nbsp;<span class="op" id="3762886">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762889">if</span>&nbsp;<span class="string" id="3762892">&#39;0&#39;</span>&nbsp;<span class="op" id="3762896">&lt;=</span>&nbsp;<span class="ident" id="3762899">c</span>&nbsp;<span class="op" id="3762901">&amp;&amp;</span>&nbsp;<span class="ident" id="3762904">c</span>&nbsp;<span class="op" id="3762906">&lt;=</span>&nbsp;<span class="string" id="3762909">&#39;9&#39;</span>&nbsp;<span class="op" id="3762913">||</span>&nbsp;<span class="string" id="3762916">&#39;a&#39;</span>&nbsp;<span class="op" id="3762920">&lt;=</span>&nbsp;<span class="ident" id="3762923">c</span>&nbsp;<span class="op" id="3762925">&amp;&amp;</span>&nbsp;<span class="ident" id="3762928">c</span>&nbsp;<span class="op" id="3762930">&lt;=</span>&nbsp;<span class="string" id="3762933">&#39;f&#39;</span>&nbsp;<span class="op" id="3762937">||</span>&nbsp;<span class="string" id="3762940">&#39;A&#39;</span>&nbsp;<span class="op" id="3762944">&lt;=</span>&nbsp;<span class="ident" id="3762947">c</span>&nbsp;<span class="op" id="3762949">&amp;&amp;</span>&nbsp;<span class="ident" id="3762952">c</span>&nbsp;<span class="op" id="3762954">&lt;=</span>&nbsp;<span class="string" id="3762957">&#39;F&#39;</span>&nbsp;<span class="op" id="3762961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762965">s</span><span class="op" id="3762966">.</span><span class="ident" id="3762967">step</span>&nbsp;<span class="op" id="3762972">=</span>&nbsp;<span class="ident" id="3762974">stateInStringEscU1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762995">return</span>&nbsp;<span class="ident" id="3763002">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3763016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763019">//&nbsp;numbers</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3763031">return</span>&nbsp;<span class="ident" id="3763038">s</span><span class="op" id="3763039">.</span><span class="builtintype" id="3763040">error</span><span class="op" id="3763045">(</span><span class="ident" id="3763046">c</span><span class="op" id="3763047">,</span>&nbsp;<span class="string" id="3763049">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="3763086">)</span><br>
<span class="lineno"></span><span class="op" id="3763088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3763091">//&nbsp;stateInStringEscU1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u1`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3763171">func</span>&nbsp;<span class="ident" id="3763176">stateInStringEscU1</span><span class="op" id="3763194">(</span><span class="ident" id="3763195">s</span>&nbsp;<span class="op" id="3763197">*</span><span class="ident" id="3763198">scanner</span><span class="op" id="3763205">,</span>&nbsp;<span class="ident" id="3763207">c</span>&nbsp;<span class="builtintype" id="3763209">int</span><span class="op" id="3763212">)</span>&nbsp;<span class="builtintype" id="3763214">int</span>&nbsp;<span class="op" id="3763218">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3763221">if</span>&nbsp;<span class="string" id="3763224">&#39;0&#39;</span>&nbsp;<span class="op" id="3763228">&lt;=</span>&nbsp;<span class="ident" id="3763231">c</span>&nbsp;<span class="op" id="3763233">&amp;&amp;</span>&nbsp;<span class="ident" id="3763236">c</span>&nbsp;<span class="op" id="3763238">&lt;=</span>&nbsp;<span class="string" id="3763241">&#39;9&#39;</span>&nbsp;<span class="op" id="3763245">||</span>&nbsp;<span class="string" id="3763248">&#39;a&#39;</span>&nbsp;<span class="op" id="3763252">&lt;=</span>&nbsp;<span class="ident" id="3763255">c</span>&nbsp;<span class="op" id="3763257">&amp;&amp;</span>&nbsp;<span class="ident" id="3763260">c</span>&nbsp;<span class="op" id="3763262">&lt;=</span>&nbsp;<span class="string" id="3763265">&#39;f&#39;</span>&nbsp;<span class="op" id="3763269">||</span>&nbsp;<span class="string" id="3763272">&#39;A&#39;</span>&nbsp;<span class="op" id="3763276">&lt;=</span>&nbsp;<span class="ident" id="3763279">c</span>&nbsp;<span class="op" id="3763281">&amp;&amp;</span>&nbsp;<span class="ident" id="3763284">c</span>&nbsp;<span class="op" id="3763286">&lt;=</span>&nbsp;<span class="string" id="3763289">&#39;F&#39;</span>&nbsp;<span class="op" id="3763293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3763297">s</span><span class="op" id="3763298">.</span><span class="ident" id="3763299">step</span>&nbsp;<span class="op" id="3763304">=</span>&nbsp;<span class="ident" id="3763306">stateInStringEscU12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3763328">return</span>&nbsp;<span class="ident" id="3763335">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3763349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763352">//&nbsp;numbers</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3763364">return</span>&nbsp;<span class="ident" id="3763371">s</span><span class="op" id="3763372">.</span><span class="builtintype" id="3763373">error</span><span class="op" id="3763378">(</span><span class="ident" id="3763379">c</span><span class="op" id="3763380">,</span>&nbsp;<span class="string" id="3763382">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="3763419">)</span><br>
<span class="lineno"></span><span class="op" id="3763421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3763424">//&nbsp;stateInStringEscU12&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u12`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3763506">func</span>&nbsp;<span class="ident" id="3763511">stateInStringEscU12</span><span class="op" id="3763530">(</span><span class="ident" id="3763531">s</span>&nbsp;<span class="op" id="3763533">*</span><span class="ident" id="3763534">scanner</span><span class="op" id="3763541">,</span>&nbsp;<span class="ident" id="3763543">c</span>&nbsp;<span class="builtintype" id="3763545">int</span><span class="op" id="3763548">)</span>&nbsp;<span class="builtintype" id="3763550">int</span>&nbsp;<span class="op" id="3763554">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3763557">if</span>&nbsp;<span class="string" id="3763560">&#39;0&#39;</span>&nbsp;<span class="op" id="3763564">&lt;=</span>&nbsp;<span class="ident" id="3763567">c</span>&nbsp;<span class="op" id="3763569">&amp;&amp;</span>&nbsp;<span class="ident" id="3763572">c</span>&nbsp;<span class="op" id="3763574">&lt;=</span>&nbsp;<span class="string" id="3763577">&#39;9&#39;</span>&nbsp;<span class="op" id="3763581">||</span>&nbsp;<span class="string" id="3763584">&#39;a&#39;</span>&nbsp;<span class="op" id="3763588">&lt;=</span>&nbsp;<span class="ident" id="3763591">c</span>&nbsp;<span class="op" id="3763593">&amp;&amp;</span>&nbsp;<span class="ident" id="3763596">c</span>&nbsp;<span class="op" id="3763598">&lt;=</span>&nbsp;<span class="string" id="3763601">&#39;f&#39;</span>&nbsp;<span class="op" id="3763605">||</span>&nbsp;<span class="string" id="3763608">&#39;A&#39;</span>&nbsp;<span class="op" id="3763612">&lt;=</span>&nbsp;<span class="ident" id="3763615">c</span>&nbsp;<span class="op" id="3763617">&amp;&amp;</span>&nbsp;<span class="ident" id="3763620">c</span>&nbsp;<span class="op" id="3763622">&lt;=</span>&nbsp;<span class="string" id="3763625">&#39;F&#39;</span>&nbsp;<span class="op" id="3763629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3763633">s</span><span class="op" id="3763634">.</span><span class="ident" id="3763635">step</span>&nbsp;<span class="op" id="3763640">=</span>&nbsp;<span class="ident" id="3763642">stateInStringEscU123</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3763665">return</span>&nbsp;<span class="ident" id="3763672">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3763686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763689">//&nbsp;numbers</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3763701">return</span>&nbsp;<span class="ident" id="3763708">s</span><span class="op" id="3763709">.</span><span class="builtintype" id="3763710">error</span><span class="op" id="3763715">(</span><span class="ident" id="3763716">c</span><span class="op" id="3763717">,</span>&nbsp;<span class="string" id="3763719">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="3763756">)</span><br>
<span class="lineno"></span><span class="op" id="3763758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3763761">//&nbsp;stateInStringEscU123&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u123`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3763845">func</span>&nbsp;<span class="ident" id="3763850">stateInStringEscU123</span><span class="op" id="3763870">(</span><span class="ident" id="3763871">s</span>&nbsp;<span class="op" id="3763873">*</span><span class="ident" id="3763874">scanner</span><span class="op" id="3763881">,</span>&nbsp;<span class="ident" id="3763883">c</span>&nbsp;<span class="builtintype" id="3763885">int</span><span class="op" id="3763888">)</span>&nbsp;<span class="builtintype" id="3763890">int</span>&nbsp;<span class="op" id="3763894">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3763897">if</span>&nbsp;<span class="string" id="3763900">&#39;0&#39;</span>&nbsp;<span class="op" id="3763904">&lt;=</span>&nbsp;<span class="ident" id="3763907">c</span>&nbsp;<span class="op" id="3763909">&amp;&amp;</span>&nbsp;<span class="ident" id="3763912">c</span>&nbsp;<span class="op" id="3763914">&lt;=</span>&nbsp;<span class="string" id="3763917">&#39;9&#39;</span>&nbsp;<span class="op" id="3763921">||</span>&nbsp;<span class="string" id="3763924">&#39;a&#39;</span>&nbsp;<span class="op" id="3763928">&lt;=</span>&nbsp;<span class="ident" id="3763931">c</span>&nbsp;<span class="op" id="3763933">&amp;&amp;</span>&nbsp;<span class="ident" id="3763936">c</span>&nbsp;<span class="op" id="3763938">&lt;=</span>&nbsp;<span class="string" id="3763941">&#39;f&#39;</span>&nbsp;<span class="op" id="3763945">||</span>&nbsp;<span class="string" id="3763948">&#39;A&#39;</span>&nbsp;<span class="op" id="3763952">&lt;=</span>&nbsp;<span class="ident" id="3763955">c</span>&nbsp;<span class="op" id="3763957">&amp;&amp;</span>&nbsp;<span class="ident" id="3763960">c</span>&nbsp;<span class="op" id="3763962">&lt;=</span>&nbsp;<span class="string" id="3763965">&#39;F&#39;</span>&nbsp;<span class="op" id="3763969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3763973">s</span><span class="op" id="3763974">.</span><span class="ident" id="3763975">step</span>&nbsp;<span class="op" id="3763980">=</span>&nbsp;<span class="ident" id="3763982">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3763998">return</span>&nbsp;<span class="ident" id="3764005">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3764019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3764022">//&nbsp;numbers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764034">return</span>&nbsp;<span class="ident" id="3764041">s</span><span class="op" id="3764042">.</span><span class="builtintype" id="3764043">error</span><span class="op" id="3764048">(</span><span class="ident" id="3764049">c</span><span class="op" id="3764050">,</span>&nbsp;<span class="string" id="3764052">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="3764089">)</span><br>
<span class="lineno"></span><span class="op" id="3764091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3764094">//&nbsp;stateNeg&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`-`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="3764154">func</span>&nbsp;<span class="ident" id="3764159">stateNeg</span><span class="op" id="3764167">(</span><span class="ident" id="3764168">s</span>&nbsp;<span class="op" id="3764170">*</span><span class="ident" id="3764171">scanner</span><span class="op" id="3764178">,</span>&nbsp;<span class="ident" id="3764180">c</span>&nbsp;<span class="builtintype" id="3764182">int</span><span class="op" id="3764185">)</span>&nbsp;<span class="builtintype" id="3764187">int</span>&nbsp;<span class="op" id="3764191">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764194">if</span>&nbsp;<span class="ident" id="3764197">c</span>&nbsp;<span class="op" id="3764199">==</span>&nbsp;<span class="string" id="3764202">&#39;0&#39;</span>&nbsp;<span class="op" id="3764206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764210">s</span><span class="op" id="3764211">.</span><span class="ident" id="3764212">step</span>&nbsp;<span class="op" id="3764217">=</span>&nbsp;<span class="ident" id="3764219">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764228">return</span>&nbsp;<span class="ident" id="3764235">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3764249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764252">if</span>&nbsp;<span class="string" id="3764255">&#39;1&#39;</span>&nbsp;<span class="op" id="3764259">&lt;=</span>&nbsp;<span class="ident" id="3764262">c</span>&nbsp;<span class="op" id="3764264">&amp;&amp;</span>&nbsp;<span class="ident" id="3764267">c</span>&nbsp;<span class="op" id="3764269">&lt;=</span>&nbsp;<span class="string" id="3764272">&#39;9&#39;</span>&nbsp;<span class="op" id="3764276">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764280">s</span><span class="op" id="3764281">.</span><span class="ident" id="3764282">step</span>&nbsp;<span class="op" id="3764287">=</span>&nbsp;<span class="ident" id="3764289">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764298">return</span>&nbsp;<span class="ident" id="3764305">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3764319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764322">return</span>&nbsp;<span class="ident" id="3764329">s</span><span class="op" id="3764330">.</span><span class="builtintype" id="3764331">error</span><span class="op" id="3764336">(</span><span class="ident" id="3764337">c</span><span class="op" id="3764338">,</span>&nbsp;<span class="string" id="3764340">&#34;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="3764360">)</span><br>
<span class="lineno"></span><span class="op" id="3764362">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="comment" id="3764365">//&nbsp;state1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;a&nbsp;non-zero&nbsp;integer&nbsp;during&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="3764438">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1`&nbsp;or&nbsp;`100`&nbsp;but&nbsp;not&nbsp;`0`.</span><br>
<span class="lineno"></span><span class="keyword" id="3764489">func</span>&nbsp;<span class="ident" id="3764494">state1</span><span class="op" id="3764500">(</span><span class="ident" id="3764501">s</span>&nbsp;<span class="op" id="3764503">*</span><span class="ident" id="3764504">scanner</span><span class="op" id="3764511">,</span>&nbsp;<span class="ident" id="3764513">c</span>&nbsp;<span class="builtintype" id="3764515">int</span><span class="op" id="3764518">)</span>&nbsp;<span class="builtintype" id="3764520">int</span>&nbsp;<span class="op" id="3764524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764527">if</span>&nbsp;<span class="string" id="3764530">&#39;0&#39;</span>&nbsp;<span class="op" id="3764534">&lt;=</span>&nbsp;<span class="ident" id="3764537">c</span>&nbsp;<span class="op" id="3764539">&amp;&amp;</span>&nbsp;<span class="ident" id="3764542">c</span>&nbsp;<span class="op" id="3764544">&lt;=</span>&nbsp;<span class="string" id="3764547">&#39;9&#39;</span>&nbsp;<span class="op" id="3764551">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764555">s</span><span class="op" id="3764556">.</span><span class="ident" id="3764557">step</span>&nbsp;<span class="op" id="3764562">=</span>&nbsp;<span class="ident" id="3764564">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764573">return</span>&nbsp;<span class="ident" id="3764580">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3764594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764597">return</span>&nbsp;<span class="ident" id="3764604">state0</span><span class="op" id="3764610">(</span><span class="ident" id="3764611">s</span><span class="op" id="3764612">,</span>&nbsp;<span class="ident" id="3764614">c</span><span class="op" id="3764615">)</span><br>
<span class="lineno"></span><span class="op" id="3764617">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="comment" id="3764620">//&nbsp;state0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`0`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="3764678">func</span>&nbsp;<span class="ident" id="3764683">state0</span><span class="op" id="3764689">(</span><span class="ident" id="3764690">s</span>&nbsp;<span class="op" id="3764692">*</span><span class="ident" id="3764693">scanner</span><span class="op" id="3764700">,</span>&nbsp;<span class="ident" id="3764702">c</span>&nbsp;<span class="builtintype" id="3764704">int</span><span class="op" id="3764707">)</span>&nbsp;<span class="builtintype" id="3764709">int</span>&nbsp;<span class="op" id="3764713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764716">if</span>&nbsp;<span class="ident" id="3764719">c</span>&nbsp;<span class="op" id="3764721">==</span>&nbsp;<span class="string" id="3764724">&#39;.&#39;</span>&nbsp;<span class="op" id="3764728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764732">s</span><span class="op" id="3764733">.</span><span class="ident" id="3764734">step</span>&nbsp;<span class="op" id="3764739">=</span>&nbsp;<span class="ident" id="3764741">stateDot</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764752">return</span>&nbsp;<span class="ident" id="3764759">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3764773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764776">if</span>&nbsp;<span class="ident" id="3764779">c</span>&nbsp;<span class="op" id="3764781">==</span>&nbsp;<span class="string" id="3764784">&#39;e&#39;</span>&nbsp;<span class="op" id="3764788">||</span>&nbsp;<span class="ident" id="3764791">c</span>&nbsp;<span class="op" id="3764793">==</span>&nbsp;<span class="string" id="3764796">&#39;E&#39;</span>&nbsp;<span class="op" id="3764800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764804">s</span><span class="op" id="3764805">.</span><span class="ident" id="3764806">step</span>&nbsp;<span class="op" id="3764811">=</span>&nbsp;<span class="ident" id="3764813">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764822">return</span>&nbsp;<span class="ident" id="3764829">scanContinue</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3764843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764846">return</span>&nbsp;<span class="ident" id="3764853">stateEndValue</span><span class="op" id="3764866">(</span><span class="ident" id="3764867">s</span><span class="op" id="3764868">,</span>&nbsp;<span class="ident" id="3764870">c</span><span class="op" id="3764871">)</span><br>
<span class="lineno"></span><span class="op" id="3764873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3764876">//&nbsp;stateDot&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer&nbsp;and&nbsp;decimal&nbsp;point&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno">430</span><span class="comment" id="3764958">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1.`.</span><br>
<span class="lineno"></span><span class="keyword" id="3764989">func</span>&nbsp;<span class="ident" id="3764994">stateDot</span><span class="op" id="3765002">(</span><span class="ident" id="3765003">s</span>&nbsp;<span class="op" id="3765005">*</span><span class="ident" id="3765006">scanner</span><span class="op" id="3765013">,</span>&nbsp;<span class="ident" id="3765015">c</span>&nbsp;<span class="builtintype" id="3765017">int</span><span class="op" id="3765020">)</span>&nbsp;<span class="builtintype" id="3765022">int</span>&nbsp;<span class="op" id="3765026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765029">if</span>&nbsp;<span class="string" id="3765032">&#39;0&#39;</span>&nbsp;<span class="op" id="3765036">&lt;=</span>&nbsp;<span class="ident" id="3765039">c</span>&nbsp;<span class="op" id="3765041">&amp;&amp;</span>&nbsp;<span class="ident" id="3765044">c</span>&nbsp;<span class="op" id="3765046">&lt;=</span>&nbsp;<span class="string" id="3765049">&#39;9&#39;</span>&nbsp;<span class="op" id="3765053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3765057">s</span><span class="op" id="3765058">.</span><span class="ident" id="3765059">step</span>&nbsp;<span class="op" id="3765064">=</span>&nbsp;<span class="ident" id="3765066">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765078">return</span>&nbsp;<span class="ident" id="3765085">scanContinue</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3765099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765102">return</span>&nbsp;<span class="ident" id="3765109">s</span><span class="op" id="3765110">.</span><span class="builtintype" id="3765111">error</span><span class="op" id="3765116">(</span><span class="ident" id="3765117">c</span><span class="op" id="3765118">,</span>&nbsp;<span class="string" id="3765120">&#34;after&nbsp;decimal&nbsp;point&nbsp;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="3765160">)</span><br>
<span class="lineno"></span><span class="op" id="3765162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3765165">//&nbsp;stateDot0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer,&nbsp;decimal&nbsp;point,&nbsp;and&nbsp;subsequent</span><br>
<span class="lineno">440</span><span class="comment" id="3765248">//&nbsp;digits&nbsp;of&nbsp;a&nbsp;number,&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`3.14`.</span><br>
<span class="lineno"></span><span class="keyword" id="3765301">func</span>&nbsp;<span class="ident" id="3765306">stateDot0</span><span class="op" id="3765315">(</span><span class="ident" id="3765316">s</span>&nbsp;<span class="op" id="3765318">*</span><span class="ident" id="3765319">scanner</span><span class="op" id="3765326">,</span>&nbsp;<span class="ident" id="3765328">c</span>&nbsp;<span class="builtintype" id="3765330">int</span><span class="op" id="3765333">)</span>&nbsp;<span class="builtintype" id="3765335">int</span>&nbsp;<span class="op" id="3765339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765342">if</span>&nbsp;<span class="string" id="3765345">&#39;0&#39;</span>&nbsp;<span class="op" id="3765349">&lt;=</span>&nbsp;<span class="ident" id="3765352">c</span>&nbsp;<span class="op" id="3765354">&amp;&amp;</span>&nbsp;<span class="ident" id="3765357">c</span>&nbsp;<span class="op" id="3765359">&lt;=</span>&nbsp;<span class="string" id="3765362">&#39;9&#39;</span>&nbsp;<span class="op" id="3765366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3765370">s</span><span class="op" id="3765371">.</span><span class="ident" id="3765372">step</span>&nbsp;<span class="op" id="3765377">=</span>&nbsp;<span class="ident" id="3765379">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765391">return</span>&nbsp;<span class="ident" id="3765398">scanContinue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3765412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765415">if</span>&nbsp;<span class="ident" id="3765418">c</span>&nbsp;<span class="op" id="3765420">==</span>&nbsp;<span class="string" id="3765423">&#39;e&#39;</span>&nbsp;<span class="op" id="3765427">||</span>&nbsp;<span class="ident" id="3765430">c</span>&nbsp;<span class="op" id="3765432">==</span>&nbsp;<span class="string" id="3765435">&#39;E&#39;</span>&nbsp;<span class="op" id="3765439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3765443">s</span><span class="op" id="3765444">.</span><span class="ident" id="3765445">step</span>&nbsp;<span class="op" id="3765450">=</span>&nbsp;<span class="ident" id="3765452">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765461">return</span>&nbsp;<span class="ident" id="3765468">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3765482">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765485">return</span>&nbsp;<span class="ident" id="3765492">stateEndValue</span><span class="op" id="3765505">(</span><span class="ident" id="3765506">s</span><span class="op" id="3765507">,</span>&nbsp;<span class="ident" id="3765509">c</span><span class="op" id="3765510">)</span><br>
<span class="lineno"></span><span class="op" id="3765512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3765515">//&nbsp;stateE&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa&nbsp;and&nbsp;e&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="3765584">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e`&nbsp;or&nbsp;`0.314e`.</span><br>
<span class="lineno">455</span><span class="keyword" id="3765629">func</span>&nbsp;<span class="ident" id="3765634">stateE</span><span class="op" id="3765640">(</span><span class="ident" id="3765641">s</span>&nbsp;<span class="op" id="3765643">*</span><span class="ident" id="3765644">scanner</span><span class="op" id="3765651">,</span>&nbsp;<span class="ident" id="3765653">c</span>&nbsp;<span class="builtintype" id="3765655">int</span><span class="op" id="3765658">)</span>&nbsp;<span class="builtintype" id="3765660">int</span>&nbsp;<span class="op" id="3765664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765667">if</span>&nbsp;<span class="ident" id="3765670">c</span>&nbsp;<span class="op" id="3765672">==</span>&nbsp;<span class="string" id="3765675">&#39;+&#39;</span>&nbsp;<span class="op" id="3765679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3765683">s</span><span class="op" id="3765684">.</span><span class="ident" id="3765685">step</span>&nbsp;<span class="op" id="3765690">=</span>&nbsp;<span class="ident" id="3765692">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765705">return</span>&nbsp;<span class="ident" id="3765712">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3765726">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765729">if</span>&nbsp;<span class="ident" id="3765732">c</span>&nbsp;<span class="op" id="3765734">==</span>&nbsp;<span class="string" id="3765737">&#39;-&#39;</span>&nbsp;<span class="op" id="3765741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3765745">s</span><span class="op" id="3765746">.</span><span class="ident" id="3765747">step</span>&nbsp;<span class="op" id="3765752">=</span>&nbsp;<span class="ident" id="3765754">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765767">return</span>&nbsp;<span class="ident" id="3765774">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3765788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765791">return</span>&nbsp;<span class="ident" id="3765798">stateESign</span><span class="op" id="3765808">(</span><span class="ident" id="3765809">s</span><span class="op" id="3765810">,</span>&nbsp;<span class="ident" id="3765812">c</span><span class="op" id="3765813">)</span><br>
<span class="lineno">465</span><span class="op" id="3765815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3765818">//&nbsp;stateESign&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;and&nbsp;sign&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="3765898">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-`&nbsp;or&nbsp;`0.314e+`.</span><br>
<span class="lineno"></span><span class="keyword" id="3765945">func</span>&nbsp;<span class="ident" id="3765950">stateESign</span><span class="op" id="3765960">(</span><span class="ident" id="3765961">s</span>&nbsp;<span class="op" id="3765963">*</span><span class="ident" id="3765964">scanner</span><span class="op" id="3765971">,</span>&nbsp;<span class="ident" id="3765973">c</span>&nbsp;<span class="builtintype" id="3765975">int</span><span class="op" id="3765978">)</span>&nbsp;<span class="builtintype" id="3765980">int</span>&nbsp;<span class="op" id="3765984">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765987">if</span>&nbsp;<span class="string" id="3765990">&#39;0&#39;</span>&nbsp;<span class="op" id="3765994">&lt;=</span>&nbsp;<span class="ident" id="3765997">c</span>&nbsp;<span class="op" id="3765999">&amp;&amp;</span>&nbsp;<span class="ident" id="3766002">c</span>&nbsp;<span class="op" id="3766004">&lt;=</span>&nbsp;<span class="string" id="3766007">&#39;9&#39;</span>&nbsp;<span class="op" id="3766011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3766015">s</span><span class="op" id="3766016">.</span><span class="ident" id="3766017">step</span>&nbsp;<span class="op" id="3766022">=</span>&nbsp;<span class="ident" id="3766024">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766034">return</span>&nbsp;<span class="ident" id="3766041">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3766055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766058">return</span>&nbsp;<span class="ident" id="3766065">s</span><span class="op" id="3766066">.</span><span class="builtintype" id="3766067">error</span><span class="op" id="3766072">(</span><span class="ident" id="3766073">c</span><span class="op" id="3766074">,</span>&nbsp;<span class="string" id="3766076">&#34;in&nbsp;exponent&nbsp;of&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="3766108">)</span><br>
<span class="lineno">475</span><span class="op" id="3766110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3766113">//&nbsp;stateE0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;optional&nbsp;sign,</span><br>
<span class="lineno"></span><span class="comment" id="3766183">//&nbsp;and&nbsp;at&nbsp;least&nbsp;one&nbsp;digit&nbsp;of&nbsp;the&nbsp;exponent&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="3766238">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-2`&nbsp;or&nbsp;`0.314e+1`&nbsp;or&nbsp;`3.14e0`.</span><br>
<span class="lineno">480</span><span class="keyword" id="3766299">func</span>&nbsp;<span class="ident" id="3766304">stateE0</span><span class="op" id="3766311">(</span><span class="ident" id="3766312">s</span>&nbsp;<span class="op" id="3766314">*</span><span class="ident" id="3766315">scanner</span><span class="op" id="3766322">,</span>&nbsp;<span class="ident" id="3766324">c</span>&nbsp;<span class="builtintype" id="3766326">int</span><span class="op" id="3766329">)</span>&nbsp;<span class="builtintype" id="3766331">int</span>&nbsp;<span class="op" id="3766335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766338">if</span>&nbsp;<span class="string" id="3766341">&#39;0&#39;</span>&nbsp;<span class="op" id="3766345">&lt;=</span>&nbsp;<span class="ident" id="3766348">c</span>&nbsp;<span class="op" id="3766350">&amp;&amp;</span>&nbsp;<span class="ident" id="3766353">c</span>&nbsp;<span class="op" id="3766355">&lt;=</span>&nbsp;<span class="string" id="3766358">&#39;9&#39;</span>&nbsp;<span class="op" id="3766362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3766366">s</span><span class="op" id="3766367">.</span><span class="ident" id="3766368">step</span>&nbsp;<span class="op" id="3766373">=</span>&nbsp;<span class="ident" id="3766375">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766385">return</span>&nbsp;<span class="ident" id="3766392">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3766406">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766409">return</span>&nbsp;<span class="ident" id="3766416">stateEndValue</span><span class="op" id="3766429">(</span><span class="ident" id="3766430">s</span><span class="op" id="3766431">,</span>&nbsp;<span class="ident" id="3766433">c</span><span class="op" id="3766434">)</span><br>
<span class="lineno"></span><span class="op" id="3766436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3766439">//&nbsp;stateT&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`t`.</span><br>
<span class="lineno"></span><span class="keyword" id="3766481">func</span>&nbsp;<span class="ident" id="3766486">stateT</span><span class="op" id="3766492">(</span><span class="ident" id="3766493">s</span>&nbsp;<span class="op" id="3766495">*</span><span class="ident" id="3766496">scanner</span><span class="op" id="3766503">,</span>&nbsp;<span class="ident" id="3766505">c</span>&nbsp;<span class="builtintype" id="3766507">int</span><span class="op" id="3766510">)</span>&nbsp;<span class="builtintype" id="3766512">int</span>&nbsp;<span class="op" id="3766516">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766519">if</span>&nbsp;<span class="ident" id="3766522">c</span>&nbsp;<span class="op" id="3766524">==</span>&nbsp;<span class="string" id="3766527">&#39;r&#39;</span>&nbsp;<span class="op" id="3766531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3766535">s</span><span class="op" id="3766536">.</span><span class="ident" id="3766537">step</span>&nbsp;<span class="op" id="3766542">=</span>&nbsp;<span class="ident" id="3766544">stateTr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766554">return</span>&nbsp;<span class="ident" id="3766561">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3766575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766578">return</span>&nbsp;<span class="ident" id="3766585">s</span><span class="op" id="3766586">.</span><span class="builtintype" id="3766587">error</span><span class="op" id="3766592">(</span><span class="ident" id="3766593">c</span><span class="op" id="3766594">,</span>&nbsp;<span class="string" id="3766596">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;r&#39;)&#34;</span><span class="op" id="3766629">)</span><br>
<span class="lineno">495</span><span class="op" id="3766631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3766634">//&nbsp;stateTr&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tr`.</span><br>
<span class="lineno"></span><span class="keyword" id="3766678">func</span>&nbsp;<span class="ident" id="3766683">stateTr</span><span class="op" id="3766690">(</span><span class="ident" id="3766691">s</span>&nbsp;<span class="op" id="3766693">*</span><span class="ident" id="3766694">scanner</span><span class="op" id="3766701">,</span>&nbsp;<span class="ident" id="3766703">c</span>&nbsp;<span class="builtintype" id="3766705">int</span><span class="op" id="3766708">)</span>&nbsp;<span class="builtintype" id="3766710">int</span>&nbsp;<span class="op" id="3766714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766717">if</span>&nbsp;<span class="ident" id="3766720">c</span>&nbsp;<span class="op" id="3766722">==</span>&nbsp;<span class="string" id="3766725">&#39;u&#39;</span>&nbsp;<span class="op" id="3766729">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3766733">s</span><span class="op" id="3766734">.</span><span class="ident" id="3766735">step</span>&nbsp;<span class="op" id="3766740">=</span>&nbsp;<span class="ident" id="3766742">stateTru</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766753">return</span>&nbsp;<span class="ident" id="3766760">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3766774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766777">return</span>&nbsp;<span class="ident" id="3766784">s</span><span class="op" id="3766785">.</span><span class="builtintype" id="3766786">error</span><span class="op" id="3766791">(</span><span class="ident" id="3766792">c</span><span class="op" id="3766793">,</span>&nbsp;<span class="string" id="3766795">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="3766828">)</span><br>
<span class="lineno"></span><span class="op" id="3766830">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="3766833">//&nbsp;stateTru&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tru`.</span><br>
<span class="lineno"></span><span class="keyword" id="3766879">func</span>&nbsp;<span class="ident" id="3766884">stateTru</span><span class="op" id="3766892">(</span><span class="ident" id="3766893">s</span>&nbsp;<span class="op" id="3766895">*</span><span class="ident" id="3766896">scanner</span><span class="op" id="3766903">,</span>&nbsp;<span class="ident" id="3766905">c</span>&nbsp;<span class="builtintype" id="3766907">int</span><span class="op" id="3766910">)</span>&nbsp;<span class="builtintype" id="3766912">int</span>&nbsp;<span class="op" id="3766916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766919">if</span>&nbsp;<span class="ident" id="3766922">c</span>&nbsp;<span class="op" id="3766924">==</span>&nbsp;<span class="string" id="3766927">&#39;e&#39;</span>&nbsp;<span class="op" id="3766931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3766935">s</span><span class="op" id="3766936">.</span><span class="ident" id="3766937">step</span>&nbsp;<span class="op" id="3766942">=</span>&nbsp;<span class="ident" id="3766944">stateEndValue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766960">return</span>&nbsp;<span class="ident" id="3766967">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3766981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766984">return</span>&nbsp;<span class="ident" id="3766991">s</span><span class="op" id="3766992">.</span><span class="builtintype" id="3766993">error</span><span class="op" id="3766998">(</span><span class="ident" id="3766999">c</span><span class="op" id="3767000">,</span>&nbsp;<span class="string" id="3767002">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="3767035">)</span><br>
<span class="lineno"></span><span class="op" id="3767037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="3767040">//&nbsp;stateF&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`f`.</span><br>
<span class="lineno"></span><span class="keyword" id="3767082">func</span>&nbsp;<span class="ident" id="3767087">stateF</span><span class="op" id="3767093">(</span><span class="ident" id="3767094">s</span>&nbsp;<span class="op" id="3767096">*</span><span class="ident" id="3767097">scanner</span><span class="op" id="3767104">,</span>&nbsp;<span class="ident" id="3767106">c</span>&nbsp;<span class="builtintype" id="3767108">int</span><span class="op" id="3767111">)</span>&nbsp;<span class="builtintype" id="3767113">int</span>&nbsp;<span class="op" id="3767117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767120">if</span>&nbsp;<span class="ident" id="3767123">c</span>&nbsp;<span class="op" id="3767125">==</span>&nbsp;<span class="string" id="3767128">&#39;a&#39;</span>&nbsp;<span class="op" id="3767132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767136">s</span><span class="op" id="3767137">.</span><span class="ident" id="3767138">step</span>&nbsp;<span class="op" id="3767143">=</span>&nbsp;<span class="ident" id="3767145">stateFa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767155">return</span>&nbsp;<span class="ident" id="3767162">scanContinue</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3767176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767179">return</span>&nbsp;<span class="ident" id="3767186">s</span><span class="op" id="3767187">.</span><span class="builtintype" id="3767188">error</span><span class="op" id="3767193">(</span><span class="ident" id="3767194">c</span><span class="op" id="3767195">,</span>&nbsp;<span class="string" id="3767197">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;a&#39;)&#34;</span><span class="op" id="3767231">)</span><br>
<span class="lineno"></span><span class="op" id="3767233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3767236">//&nbsp;stateFa&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fa`.</span><br>
<span class="lineno">525</span><span class="keyword" id="3767280">func</span>&nbsp;<span class="ident" id="3767285">stateFa</span><span class="op" id="3767292">(</span><span class="ident" id="3767293">s</span>&nbsp;<span class="op" id="3767295">*</span><span class="ident" id="3767296">scanner</span><span class="op" id="3767303">,</span>&nbsp;<span class="ident" id="3767305">c</span>&nbsp;<span class="builtintype" id="3767307">int</span><span class="op" id="3767310">)</span>&nbsp;<span class="builtintype" id="3767312">int</span>&nbsp;<span class="op" id="3767316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767319">if</span>&nbsp;<span class="ident" id="3767322">c</span>&nbsp;<span class="op" id="3767324">==</span>&nbsp;<span class="string" id="3767327">&#39;l&#39;</span>&nbsp;<span class="op" id="3767331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767335">s</span><span class="op" id="3767336">.</span><span class="ident" id="3767337">step</span>&nbsp;<span class="op" id="3767342">=</span>&nbsp;<span class="ident" id="3767344">stateFal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767355">return</span>&nbsp;<span class="ident" id="3767362">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3767376">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767379">return</span>&nbsp;<span class="ident" id="3767386">s</span><span class="op" id="3767387">.</span><span class="builtintype" id="3767388">error</span><span class="op" id="3767393">(</span><span class="ident" id="3767394">c</span><span class="op" id="3767395">,</span>&nbsp;<span class="string" id="3767397">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="3767431">)</span><br>
<span class="lineno"></span><span class="op" id="3767433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3767436">//&nbsp;stateFal&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fal`.</span><br>
<span class="lineno"></span><span class="keyword" id="3767482">func</span>&nbsp;<span class="ident" id="3767487">stateFal</span><span class="op" id="3767495">(</span><span class="ident" id="3767496">s</span>&nbsp;<span class="op" id="3767498">*</span><span class="ident" id="3767499">scanner</span><span class="op" id="3767506">,</span>&nbsp;<span class="ident" id="3767508">c</span>&nbsp;<span class="builtintype" id="3767510">int</span><span class="op" id="3767513">)</span>&nbsp;<span class="builtintype" id="3767515">int</span>&nbsp;<span class="op" id="3767519">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767522">if</span>&nbsp;<span class="ident" id="3767525">c</span>&nbsp;<span class="op" id="3767527">==</span>&nbsp;<span class="string" id="3767530">&#39;s&#39;</span>&nbsp;<span class="op" id="3767534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767538">s</span><span class="op" id="3767539">.</span><span class="ident" id="3767540">step</span>&nbsp;<span class="op" id="3767545">=</span>&nbsp;<span class="ident" id="3767547">stateFals</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767559">return</span>&nbsp;<span class="ident" id="3767566">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3767580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767583">return</span>&nbsp;<span class="ident" id="3767590">s</span><span class="op" id="3767591">.</span><span class="builtintype" id="3767592">error</span><span class="op" id="3767597">(</span><span class="ident" id="3767598">c</span><span class="op" id="3767599">,</span>&nbsp;<span class="string" id="3767601">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;s&#39;)&#34;</span><span class="op" id="3767635">)</span><br>
<span class="lineno">540</span><span class="op" id="3767637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3767640">//&nbsp;stateFals&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fals`.</span><br>
<span class="lineno"></span><span class="keyword" id="3767688">func</span>&nbsp;<span class="ident" id="3767693">stateFals</span><span class="op" id="3767702">(</span><span class="ident" id="3767703">s</span>&nbsp;<span class="op" id="3767705">*</span><span class="ident" id="3767706">scanner</span><span class="op" id="3767713">,</span>&nbsp;<span class="ident" id="3767715">c</span>&nbsp;<span class="builtintype" id="3767717">int</span><span class="op" id="3767720">)</span>&nbsp;<span class="builtintype" id="3767722">int</span>&nbsp;<span class="op" id="3767726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767729">if</span>&nbsp;<span class="ident" id="3767732">c</span>&nbsp;<span class="op" id="3767734">==</span>&nbsp;<span class="string" id="3767737">&#39;e&#39;</span>&nbsp;<span class="op" id="3767741">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767745">s</span><span class="op" id="3767746">.</span><span class="ident" id="3767747">step</span>&nbsp;<span class="op" id="3767752">=</span>&nbsp;<span class="ident" id="3767754">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767770">return</span>&nbsp;<span class="ident" id="3767777">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3767791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767794">return</span>&nbsp;<span class="ident" id="3767801">s</span><span class="op" id="3767802">.</span><span class="builtintype" id="3767803">error</span><span class="op" id="3767808">(</span><span class="ident" id="3767809">c</span><span class="op" id="3767810">,</span>&nbsp;<span class="string" id="3767812">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="3767846">)</span><br>
<span class="lineno"></span><span class="op" id="3767848">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="comment" id="3767851">//&nbsp;stateN&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`n`.</span><br>
<span class="lineno"></span><span class="keyword" id="3767893">func</span>&nbsp;<span class="ident" id="3767898">stateN</span><span class="op" id="3767904">(</span><span class="ident" id="3767905">s</span>&nbsp;<span class="op" id="3767907">*</span><span class="ident" id="3767908">scanner</span><span class="op" id="3767915">,</span>&nbsp;<span class="ident" id="3767917">c</span>&nbsp;<span class="builtintype" id="3767919">int</span><span class="op" id="3767922">)</span>&nbsp;<span class="builtintype" id="3767924">int</span>&nbsp;<span class="op" id="3767928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767931">if</span>&nbsp;<span class="ident" id="3767934">c</span>&nbsp;<span class="op" id="3767936">==</span>&nbsp;<span class="string" id="3767939">&#39;u&#39;</span>&nbsp;<span class="op" id="3767943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767947">s</span><span class="op" id="3767948">.</span><span class="ident" id="3767949">step</span>&nbsp;<span class="op" id="3767954">=</span>&nbsp;<span class="ident" id="3767956">stateNu</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767966">return</span>&nbsp;<span class="ident" id="3767973">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3767987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767990">return</span>&nbsp;<span class="ident" id="3767997">s</span><span class="op" id="3767998">.</span><span class="builtintype" id="3767999">error</span><span class="op" id="3768004">(</span><span class="ident" id="3768005">c</span><span class="op" id="3768006">,</span>&nbsp;<span class="string" id="3768008">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="3768041">)</span><br>
<span class="lineno"></span><span class="op" id="3768043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="comment" id="3768046">//&nbsp;stateNu&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nu`.</span><br>
<span class="lineno"></span><span class="keyword" id="3768090">func</span>&nbsp;<span class="ident" id="3768095">stateNu</span><span class="op" id="3768102">(</span><span class="ident" id="3768103">s</span>&nbsp;<span class="op" id="3768105">*</span><span class="ident" id="3768106">scanner</span><span class="op" id="3768113">,</span>&nbsp;<span class="ident" id="3768115">c</span>&nbsp;<span class="builtintype" id="3768117">int</span><span class="op" id="3768120">)</span>&nbsp;<span class="builtintype" id="3768122">int</span>&nbsp;<span class="op" id="3768126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768129">if</span>&nbsp;<span class="ident" id="3768132">c</span>&nbsp;<span class="op" id="3768134">==</span>&nbsp;<span class="string" id="3768137">&#39;l&#39;</span>&nbsp;<span class="op" id="3768141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3768145">s</span><span class="op" id="3768146">.</span><span class="ident" id="3768147">step</span>&nbsp;<span class="op" id="3768152">=</span>&nbsp;<span class="ident" id="3768154">stateNul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768165">return</span>&nbsp;<span class="ident" id="3768172">scanContinue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3768186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768189">return</span>&nbsp;<span class="ident" id="3768196">s</span><span class="op" id="3768197">.</span><span class="builtintype" id="3768198">error</span><span class="op" id="3768203">(</span><span class="ident" id="3768204">c</span><span class="op" id="3768205">,</span>&nbsp;<span class="string" id="3768207">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="3768240">)</span><br>
<span class="lineno"></span><span class="op" id="3768242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3768245">//&nbsp;stateNul&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nul`.</span><br>
<span class="lineno">570</span><span class="keyword" id="3768291">func</span>&nbsp;<span class="ident" id="3768296">stateNul</span><span class="op" id="3768304">(</span><span class="ident" id="3768305">s</span>&nbsp;<span class="op" id="3768307">*</span><span class="ident" id="3768308">scanner</span><span class="op" id="3768315">,</span>&nbsp;<span class="ident" id="3768317">c</span>&nbsp;<span class="builtintype" id="3768319">int</span><span class="op" id="3768322">)</span>&nbsp;<span class="builtintype" id="3768324">int</span>&nbsp;<span class="op" id="3768328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768331">if</span>&nbsp;<span class="ident" id="3768334">c</span>&nbsp;<span class="op" id="3768336">==</span>&nbsp;<span class="string" id="3768339">&#39;l&#39;</span>&nbsp;<span class="op" id="3768343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3768347">s</span><span class="op" id="3768348">.</span><span class="ident" id="3768349">step</span>&nbsp;<span class="op" id="3768354">=</span>&nbsp;<span class="ident" id="3768356">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768372">return</span>&nbsp;<span class="ident" id="3768379">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3768393">}</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768396">return</span>&nbsp;<span class="ident" id="3768403">s</span><span class="op" id="3768404">.</span><span class="builtintype" id="3768405">error</span><span class="op" id="3768410">(</span><span class="ident" id="3768411">c</span><span class="op" id="3768412">,</span>&nbsp;<span class="string" id="3768414">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="3768447">)</span><br>
<span class="lineno"></span><span class="op" id="3768449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3768452">//&nbsp;stateError&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reaching&nbsp;a&nbsp;syntax&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="3768510">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`[1}`&nbsp;or&nbsp;`5.1.2`.</span><br>
<span class="lineno">580</span><span class="keyword" id="3768553">func</span>&nbsp;<span class="ident" id="3768558">stateError</span><span class="op" id="3768568">(</span><span class="ident" id="3768569">s</span>&nbsp;<span class="op" id="3768571">*</span><span class="ident" id="3768572">scanner</span><span class="op" id="3768579">,</span>&nbsp;<span class="ident" id="3768581">c</span>&nbsp;<span class="builtintype" id="3768583">int</span><span class="op" id="3768586">)</span>&nbsp;<span class="builtintype" id="3768588">int</span>&nbsp;<span class="op" id="3768592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768595">return</span>&nbsp;<span class="ident" id="3768602">scanError</span><br>
<span class="lineno"></span><span class="op" id="3768612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3768615">//&nbsp;error&nbsp;records&nbsp;an&nbsp;error&nbsp;and&nbsp;switches&nbsp;to&nbsp;the&nbsp;error&nbsp;state.</span><br>
<span class="lineno">585</span><span class="keyword" id="3768674">func</span>&nbsp;<span class="op" id="3768679">(</span><span class="ident" id="3768680">s</span>&nbsp;<span class="op" id="3768682">*</span><span class="ident" id="3768683">scanner</span><span class="op" id="3768690">)</span>&nbsp;<span class="builtintype" id="3768692">error</span><span class="op" id="3768697">(</span><span class="ident" id="3768698">c</span>&nbsp;<span class="builtintype" id="3768700">int</span><span class="op" id="3768703">,</span>&nbsp;<span class="ident" id="3768705">context</span>&nbsp;<span class="builtintype" id="3768713">string</span><span class="op" id="3768719">)</span>&nbsp;<span class="builtintype" id="3768721">int</span>&nbsp;<span class="op" id="3768725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3768728">s</span><span class="op" id="3768729">.</span><span class="ident" id="3768730">step</span>&nbsp;<span class="op" id="3768735">=</span>&nbsp;<span class="ident" id="3768737">stateError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3768749">s</span><span class="op" id="3768750">.</span><span class="ident" id="3768751">err</span>&nbsp;<span class="op" id="3768755">=</span>&nbsp;<span class="op" id="3768757">&amp;</span><span class="ident" id="3768758">SyntaxError</span><span class="op" id="3768769">{</span><span class="string" id="3768770">&#34;invalid&nbsp;character&nbsp;&#34;</span>&nbsp;<span class="op" id="3768791">+</span>&nbsp;<span class="ident" id="3768793">quoteChar</span><span class="op" id="3768802">(</span><span class="ident" id="3768803">c</span><span class="op" id="3768804">)</span>&nbsp;<span class="op" id="3768806">+</span>&nbsp;<span class="string" id="3768808">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3768812">+</span>&nbsp;<span class="ident" id="3768814">context</span><span class="op" id="3768821">,</span>&nbsp;<span class="ident" id="3768823">s</span><span class="op" id="3768824">.</span><span class="ident" id="3768825">bytes</span><span class="op" id="3768830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768833">return</span>&nbsp;<span class="ident" id="3768840">scanError</span><br>
<span class="lineno"></span><span class="op" id="3768850">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="3768853">//&nbsp;quoteChar&nbsp;formats&nbsp;c&nbsp;as&nbsp;a&nbsp;quoted&nbsp;character&nbsp;literal</span><br>
<span class="lineno"></span><span class="keyword" id="3768906">func</span>&nbsp;<span class="ident" id="3768911">quoteChar</span><span class="op" id="3768920">(</span><span class="ident" id="3768921">c</span>&nbsp;<span class="builtintype" id="3768923">int</span><span class="op" id="3768926">)</span>&nbsp;<span class="builtintype" id="3768928">string</span>&nbsp;<span class="op" id="3768935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3768938">//&nbsp;special&nbsp;cases&nbsp;-&nbsp;different&nbsp;from&nbsp;quoted&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768988">if</span>&nbsp;<span class="ident" id="3768991">c</span>&nbsp;<span class="op" id="3768993">==</span>&nbsp;<span class="string" id="3768996">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="3769001">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3769005">return</span>&nbsp;<span class="string" id="3769012">`&#39;\&#39;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3769020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3769023">if</span>&nbsp;<span class="ident" id="3769026">c</span>&nbsp;<span class="op" id="3769028">==</span>&nbsp;<span class="string" id="3769031">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3769035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3769039">return</span>&nbsp;<span class="string" id="3769046">`&#39;&#34;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3769053">}</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3769057">//&nbsp;use&nbsp;quoted&nbsp;string&nbsp;with&nbsp;different&nbsp;quotation&nbsp;marks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769110">s</span>&nbsp;<span class="op" id="3769112">:=</span>&nbsp;<span class="ident" id="3769115">strconv</span><span class="op" id="3769122">.</span><span class="ident" id="3769123">Quote</span><span class="op" id="3769128">(</span><span class="builtintype" id="3769129">string</span><span class="op" id="3769135">(</span><span class="ident" id="3769136">c</span><span class="op" id="3769137">)</span><span class="op" id="3769138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3769141">return</span>&nbsp;<span class="string" id="3769148">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="3769152">+</span>&nbsp;<span class="ident" id="3769154">s</span><span class="op" id="3769155">[</span><span class="num" id="3769156">1</span><span class="op" id="3769157">:</span><span class="builtinfunc" id="3769158">len</span><span class="op" id="3769161">(</span><span class="ident" id="3769162">s</span><span class="op" id="3769163">)</span><span class="op" id="3769164">-</span><span class="num" id="3769165">1</span><span class="op" id="3769166">]</span>&nbsp;<span class="op" id="3769168">+</span>&nbsp;<span class="string" id="3769170">&#34;&#39;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3769174">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span><span class="comment" id="3769177">//&nbsp;undo&nbsp;causes&nbsp;the&nbsp;scanner&nbsp;to&nbsp;return&nbsp;scanCode&nbsp;from&nbsp;the&nbsp;next&nbsp;state&nbsp;transition.</span><br>
<span class="lineno"></span><span class="comment" id="3769255">//&nbsp;This&nbsp;gives&nbsp;callers&nbsp;a&nbsp;simple&nbsp;1-byte&nbsp;undo&nbsp;mechanism.</span><br>
<span class="lineno"></span><span class="keyword" id="3769309">func</span>&nbsp;<span class="op" id="3769314">(</span><span class="ident" id="3769315">s</span>&nbsp;<span class="op" id="3769317">*</span><span class="ident" id="3769318">scanner</span><span class="op" id="3769325">)</span>&nbsp;<span class="ident" id="3769327">undo</span><span class="op" id="3769331">(</span><span class="ident" id="3769332">scanCode</span>&nbsp;<span class="builtintype" id="3769341">int</span><span class="op" id="3769344">)</span>&nbsp;<span class="op" id="3769346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3769349">if</span>&nbsp;<span class="ident" id="3769352">s</span><span class="op" id="3769353">.</span><span class="ident" id="3769354">redo</span>&nbsp;<span class="op" id="3769359">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3769363">panic</span><span class="op" id="3769368">(</span><span class="string" id="3769369">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;scanner&#34;</span><span class="op" id="3769399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3769402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769405">s</span><span class="op" id="3769406">.</span><span class="ident" id="3769407">redoCode</span>&nbsp;<span class="op" id="3769416">=</span>&nbsp;<span class="ident" id="3769418">scanCode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769428">s</span><span class="op" id="3769429">.</span><span class="ident" id="3769430">redoState</span>&nbsp;<span class="op" id="3769440">=</span>&nbsp;<span class="ident" id="3769442">s</span><span class="op" id="3769443">.</span><span class="ident" id="3769444">step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769450">s</span><span class="op" id="3769451">.</span><span class="ident" id="3769452">step</span>&nbsp;<span class="op" id="3769457">=</span>&nbsp;<span class="ident" id="3769459">stateRedo</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769470">s</span><span class="op" id="3769471">.</span><span class="ident" id="3769472">redo</span>&nbsp;<span class="op" id="3769477">=</span>&nbsp;<span class="builtintype" id="3769479">true</span><br>
<span class="lineno"></span><span class="op" id="3769484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3769487">//&nbsp;stateRedo&nbsp;helps&nbsp;implement&nbsp;the&nbsp;scanner&#39;s&nbsp;1-byte&nbsp;undo.</span><br>
<span class="lineno"></span><span class="keyword" id="3769543">func</span>&nbsp;<span class="ident" id="3769548">stateRedo</span><span class="op" id="3769557">(</span><span class="ident" id="3769558">s</span>&nbsp;<span class="op" id="3769560">*</span><span class="ident" id="3769561">scanner</span><span class="op" id="3769568">,</span>&nbsp;<span class="ident" id="3769570">c</span>&nbsp;<span class="builtintype" id="3769572">int</span><span class="op" id="3769575">)</span>&nbsp;<span class="builtintype" id="3769577">int</span>&nbsp;<span class="op" id="3769581">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769584">s</span><span class="op" id="3769585">.</span><span class="ident" id="3769586">redo</span>&nbsp;<span class="op" id="3769591">=</span>&nbsp;<span class="builtintype" id="3769593">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769600">s</span><span class="op" id="3769601">.</span><span class="ident" id="3769602">step</span>&nbsp;<span class="op" id="3769607">=</span>&nbsp;<span class="ident" id="3769609">s</span><span class="op" id="3769610">.</span><span class="ident" id="3769611">redoState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3769622">return</span>&nbsp;<span class="ident" id="3769629">s</span><span class="op" id="3769630">.</span><span class="ident" id="3769631">redoCode</span><br>
<span class="lineno"></span><span class="op" id="3769640">}</span>
</div>
</body>
</html>
