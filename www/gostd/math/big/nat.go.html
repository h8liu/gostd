<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/big</h2>
<ul>
<li><a href="/gostd/math/big/arith.go.html">arith.go</a></li>
<li><a href="/gostd/math/big/arith_decl.go.html">arith_decl.go</a></li>
<li><a href="/gostd/math/big/arith_test.go.html">arith_test.go</a></li>
<li><a href="/gostd/math/big/calibrate_test.go.html">calibrate_test.go</a></li>
<li><a href="/gostd/math/big/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/math/big/gcd_test.go.html">gcd_test.go</a></li>
<li><a href="/gostd/math/big/hilbert_test.go.html">hilbert_test.go</a></li>
<li><a href="/gostd/math/big/int.go.html">int.go</a></li>
<li><a href="/gostd/math/big/int_test.go.html">int_test.go</a></li>
<li><a href="/gostd/math/big/nat.go.html" class="current">nat.go</a></li>
<li><a href="/gostd/math/big/nat_test.go.html">nat_test.go</a></li>
<li><a href="/gostd/math/big/rat.go.html">rat.go</a></li>
<li><a href="/gostd/math/big/rat_test.go.html">rat_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2060666">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2060721">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2060775">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2060826">//&nbsp;Package&nbsp;big&nbsp;implements&nbsp;multi-precision&nbsp;arithmetic&nbsp;(big&nbsp;numbers).</span><br>
<span class="lineno"></span><span class="comment" id="2060894">//&nbsp;The&nbsp;following&nbsp;numeric&nbsp;types&nbsp;are&nbsp;supported:</span><br>
<span class="lineno"></span><span class="comment" id="2060940">//</span><br>
<span class="lineno"></span><span class="comment" id="2060943">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Int&nbsp;&nbsp;&nbsp;&nbsp;signed&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="2060968">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Rat&nbsp;&nbsp;&nbsp;&nbsp;rational&nbsp;numbers</span><br>
<span class="lineno">10</span><span class="comment" id="2060994">//</span><br>
<span class="lineno"></span><span class="comment" id="2060997">//&nbsp;Methods&nbsp;are&nbsp;typically&nbsp;of&nbsp;the&nbsp;form:</span><br>
<span class="lineno"></span><span class="comment" id="2061035">//</span><br>
<span class="lineno"></span><span class="comment" id="2061038">//&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;(z&nbsp;*Int)&nbsp;Op(x,&nbsp;y&nbsp;*Int)&nbsp;*Int&nbsp;&nbsp;&nbsp;&nbsp;(similar&nbsp;for&nbsp;*Rat)</span><br>
<span class="lineno"></span><span class="comment" id="2061093">//</span><br>
<span class="lineno">15</span><span class="comment" id="2061096">//&nbsp;and&nbsp;implement&nbsp;operations&nbsp;z&nbsp;=&nbsp;x&nbsp;Op&nbsp;y&nbsp;with&nbsp;the&nbsp;result&nbsp;as&nbsp;receiver;&nbsp;if&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="2061170">//&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;operands&nbsp;it&nbsp;may&nbsp;be&nbsp;overwritten&nbsp;(and&nbsp;its&nbsp;memory&nbsp;reused).</span><br>
<span class="lineno"></span><span class="comment" id="2061243">//&nbsp;To&nbsp;enable&nbsp;chaining&nbsp;of&nbsp;operations,&nbsp;the&nbsp;result&nbsp;is&nbsp;also&nbsp;returned.&nbsp;Methods</span><br>
<span class="lineno"></span><span class="comment" id="2061317">//&nbsp;returning&nbsp;a&nbsp;result&nbsp;other&nbsp;than&nbsp;*Int&nbsp;or&nbsp;*Rat&nbsp;take&nbsp;one&nbsp;of&nbsp;the&nbsp;operands&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2061391">//&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno">20</span><span class="comment" id="2061408">//</span><br>
<span class="lineno"></span><span class="keyword" id="2061411">package</span>&nbsp;<span class="ident" id="2061419">big</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2061424">//&nbsp;This&nbsp;file&nbsp;contains&nbsp;operations&nbsp;on&nbsp;unsigned&nbsp;multi-precision&nbsp;integers.</span><br>
<span class="lineno"></span><span class="comment" id="2061495">//&nbsp;These&nbsp;are&nbsp;the&nbsp;building&nbsp;blocks&nbsp;for&nbsp;the&nbsp;operations&nbsp;on&nbsp;signed&nbsp;integers</span><br>
<span class="lineno">25</span><span class="comment" id="2061566">//&nbsp;and&nbsp;rationals.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2061585">import</span>&nbsp;<span class="op" id="2061592">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2061595">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2061605">&#34;io&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2061611">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2061619">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2061632">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="2061639">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="2061642">//&nbsp;An&nbsp;unsigned&nbsp;integer&nbsp;x&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span><span class="comment" id="2061679">//</span><br>
<span class="lineno"></span><span class="comment" id="2061682">//&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;x[n-1]*_B^(n-1)&nbsp;+&nbsp;x[n-2]*_B^(n-2)&nbsp;+&nbsp;...&nbsp;+&nbsp;x[1]*_B&nbsp;+&nbsp;x[0]</span><br>
<span class="lineno"></span><span class="comment" id="2061748">//</span><br>
<span class="lineno"></span><span class="comment" id="2061751">//&nbsp;with&nbsp;0&nbsp;&lt;=&nbsp;x[i]&nbsp;&lt;&nbsp;_B&nbsp;and&nbsp;0&nbsp;&lt;=&nbsp;i&nbsp;&lt;&nbsp;n&nbsp;is&nbsp;stored&nbsp;in&nbsp;a&nbsp;slice&nbsp;of&nbsp;length&nbsp;n,</span><br>
<span class="lineno">40</span><span class="comment" id="2061823">//&nbsp;with&nbsp;the&nbsp;digits&nbsp;x[i]&nbsp;as&nbsp;the&nbsp;slice&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="2061870">//</span><br>
<span class="lineno"></span><span class="comment" id="2061873">//&nbsp;A&nbsp;number&nbsp;is&nbsp;normalized&nbsp;if&nbsp;the&nbsp;slice&nbsp;contains&nbsp;no&nbsp;leading&nbsp;0&nbsp;digits.</span><br>
<span class="lineno"></span><span class="comment" id="2061942">//&nbsp;During&nbsp;arithmetic&nbsp;operations,&nbsp;denormalized&nbsp;values&nbsp;may&nbsp;occur&nbsp;but&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2062013">//&nbsp;always&nbsp;normalized&nbsp;before&nbsp;returning&nbsp;the&nbsp;final&nbsp;result.&nbsp;The&nbsp;normalized</span><br>
<span class="lineno">45</span><span class="comment" id="2062084">//&nbsp;representation&nbsp;of&nbsp;0&nbsp;is&nbsp;the&nbsp;empty&nbsp;or&nbsp;nil&nbsp;slice&nbsp;(length&nbsp;=&nbsp;0).</span><br>
<span class="lineno"></span><span class="comment" id="2062147">//</span><br>
<span class="lineno"></span><span class="keyword" id="2062150">type</span>&nbsp;<span class="ident" id="2062155">nat</span>&nbsp;<span class="op" id="2062159">[</span><span class="op" id="2062160">]</span><span class="ident" id="2062161"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2062167">var</span>&nbsp;<span class="op" id="2062171">(</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2062174">natOne</span>&nbsp;<span class="op" id="2062181">=</span>&nbsp;<span class="ident" id="2062183"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2062186">{</span><span class="num" id="2062187">1</span><span class="op" id="2062188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2062191">natTwo</span>&nbsp;<span class="op" id="2062198">=</span>&nbsp;<span class="ident" id="2062200"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2062203">{</span><span class="num" id="2062204">2</span><span class="op" id="2062205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2062208">natTen</span>&nbsp;<span class="op" id="2062215">=</span>&nbsp;<span class="ident" id="2062217"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2062220">{</span><span class="num" id="2062221">10</span><span class="op" id="2062223">}</span><br>
<span class="lineno"></span><span class="op" id="2062225">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="2062228">func</span>&nbsp;<span class="op" id="2062233">(</span><span class="ident" id="2062234">z</span>&nbsp;<span class="ident" id="2062236"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2062239">)</span>&nbsp;<span class="ident" id="2062241">clear</span><span class="op" id="2062246">(</span><span class="op" id="2062247">)</span>&nbsp;<span class="op" id="2062249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2062252">for</span>&nbsp;<span class="ident" id="2062256">i</span>&nbsp;<span class="op" id="2062258">:=</span>&nbsp;<span class="keyword" id="2062261">range</span>&nbsp;<span class="ident" id="2062267"><a href="/gostd/math/big/nat.go.html#2062234">z</a></span>&nbsp;<span class="op" id="2062269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2062273"><a href="/gostd/math/big/nat.go.html#2062234">z</a></span><span class="op" id="2062274">[</span><span class="ident" id="2062275"><a href="/gostd/math/big/nat.go.html#2062256">i</a></span><span class="op" id="2062276">]</span>&nbsp;<span class="op" id="2062278">=</span>&nbsp;<span class="num" id="2062280">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2062283">}</span><br>
<span class="lineno"></span><span class="op" id="2062285">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="2062288">func</span>&nbsp;<span class="op" id="2062293">(</span><span class="ident" id="2062294">z</span>&nbsp;<span class="ident" id="2062296"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2062299">)</span>&nbsp;<span class="ident" id="2062301">norm</span><span class="op" id="2062305">(</span><span class="op" id="2062306">)</span>&nbsp;<span class="ident" id="2062308"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2062312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2062315">i</span>&nbsp;<span class="op" id="2062317">:=</span>&nbsp;<span class="builtinfunc" id="2062320">len</span><span class="op" id="2062323">(</span><span class="ident" id="2062324"><a href="/gostd/math/big/nat.go.html#2062294">z</a></span><span class="op" id="2062325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2062328">for</span>&nbsp;<span class="ident" id="2062332"><a href="/gostd/math/big/nat.go.html#2062315">i</a></span>&nbsp;<span class="op" id="2062334">&gt;</span>&nbsp;<span class="num" id="2062336">0</span>&nbsp;<span class="op" id="2062338">&amp;&amp;</span>&nbsp;<span class="ident" id="2062341"><a href="/gostd/math/big/nat.go.html#2062294">z</a></span><span class="op" id="2062342">[</span><span class="ident" id="2062343"><a href="/gostd/math/big/nat.go.html#2062315">i</a></span><span class="op" id="2062344">-</span><span class="num" id="2062345">1</span><span class="op" id="2062346">]</span>&nbsp;<span class="op" id="2062348">==</span>&nbsp;<span class="num" id="2062351">0</span>&nbsp;<span class="op" id="2062353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2062357"><a href="/gostd/math/big/nat.go.html#2062315">i</a></span><span class="op" id="2062358">--</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2062362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2062365">return</span>&nbsp;<span class="ident" id="2062372"><a href="/gostd/math/big/nat.go.html#2062294">z</a></span><span class="op" id="2062373">[</span><span class="num" id="2062374">0</span><span class="op" id="2062375">:</span><span class="ident" id="2062376"><a href="/gostd/math/big/nat.go.html#2062315">i</a></span><span class="op" id="2062377">]</span><br>
<span class="lineno"></span><span class="op" id="2062379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2062382">func</span>&nbsp;<span class="op" id="2062387">(</span><span class="ident" id="2062388">z</span>&nbsp;<span class="ident" id="2062390"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2062393">)</span>&nbsp;<span class="builtinfunc" id="2062395">make</span><span class="op" id="2062399">(</span><span class="ident" id="2062400">n</span>&nbsp;<span class="builtintype" id="2062402">int</span><span class="op" id="2062405">)</span>&nbsp;<span class="ident" id="2062407"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2062411">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2062414">if</span>&nbsp;<span class="ident" id="2062417"><a href="/gostd/math/big/nat.go.html#2062400">n</a></span>&nbsp;<span class="op" id="2062419">&lt;=</span>&nbsp;<span class="builtinfunc" id="2062422">cap</span><span class="op" id="2062425">(</span><span class="ident" id="2062426"><a href="/gostd/math/big/nat.go.html#2062388">z</a></span><span class="op" id="2062427">)</span>&nbsp;<span class="op" id="2062429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2062433">return</span>&nbsp;<span class="ident" id="2062440"><a href="/gostd/math/big/nat.go.html#2062388">z</a></span><span class="op" id="2062441">[</span><span class="num" id="2062442">0</span><span class="op" id="2062443">:</span><span class="ident" id="2062444"><a href="/gostd/math/big/nat.go.html#2062400">n</a></span><span class="op" id="2062445">]</span>&nbsp;<span class="comment" id="2062447">//&nbsp;reuse&nbsp;z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2062459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2062462">//&nbsp;Choosing&nbsp;a&nbsp;good&nbsp;value&nbsp;for&nbsp;e&nbsp;has&nbsp;significant&nbsp;performance&nbsp;impact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2062529">//&nbsp;because&nbsp;it&nbsp;increases&nbsp;the&nbsp;chance&nbsp;that&nbsp;a&nbsp;value&nbsp;can&nbsp;be&nbsp;reused.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2062593">const</span>&nbsp;<span class="ident" id="2062599">e</span>&nbsp;<span class="op" id="2062601">=</span>&nbsp;<span class="num" id="2062603">4</span>&nbsp;<span class="comment" id="2062605">//&nbsp;extra&nbsp;capacity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2062624">return</span>&nbsp;<span class="builtinfunc" id="2062631">make</span><span class="op" id="2062635">(</span><span class="ident" id="2062636"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2062639">,</span>&nbsp;<span class="ident" id="2062641"><a href="/gostd/math/big/nat.go.html#2062400">n</a></span><span class="op" id="2062642">,</span>&nbsp;<span class="ident" id="2062644"><a href="/gostd/math/big/nat.go.html#2062400">n</a></span><span class="op" id="2062645">+</span><span class="ident" id="2062646"><a href="/gostd/math/big/nat.go.html#2062599">e</a></span><span class="op" id="2062647">)</span><br>
<span class="lineno"></span><span class="op" id="2062649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2062652">func</span>&nbsp;<span class="op" id="2062657">(</span><span class="ident" id="2062658">z</span>&nbsp;<span class="ident" id="2062660"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2062663">)</span>&nbsp;<span class="ident" id="2062665">setWord</span><span class="op" id="2062672">(</span><span class="ident" id="2062673">x</span>&nbsp;<span class="ident" id="2062675"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2062679">)</span>&nbsp;<span class="ident" id="2062681"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2062685">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2062688">if</span>&nbsp;<span class="ident" id="2062691"><a href="/gostd/math/big/nat.go.html#2062673">x</a></span>&nbsp;<span class="op" id="2062693">==</span>&nbsp;<span class="num" id="2062696">0</span>&nbsp;<span class="op" id="2062698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2062702">return</span>&nbsp;<span class="ident" id="2062709"><a href="/gostd/math/big/nat.go.html#2062658">z</a></span><span class="op" id="2062710">.</span><span class="builtinfunc" id="2062711"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2062715">(</span><span class="num" id="2062716">0</span><span class="op" id="2062717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2062720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2062723"><a href="/gostd/math/big/nat.go.html#2062658">z</a></span>&nbsp;<span class="op" id="2062725">=</span>&nbsp;<span class="ident" id="2062727"><a href="/gostd/math/big/nat.go.html#2062658">z</a></span><span class="op" id="2062728">.</span><span class="builtinfunc" id="2062729"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2062733">(</span><span class="num" id="2062734">1</span><span class="op" id="2062735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2062738"><a href="/gostd/math/big/nat.go.html#2062658">z</a></span><span class="op" id="2062739">[</span><span class="num" id="2062740">0</span><span class="op" id="2062741">]</span>&nbsp;<span class="op" id="2062743">=</span>&nbsp;<span class="ident" id="2062745"><a href="/gostd/math/big/nat.go.html#2062673">x</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2062748">return</span>&nbsp;<span class="ident" id="2062755"><a href="/gostd/math/big/nat.go.html#2062658">z</a></span><br>
<span class="lineno"></span><span class="op" id="2062757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2062760">func</span>&nbsp;<span class="op" id="2062765">(</span><span class="ident" id="2062766">z</span>&nbsp;<span class="ident" id="2062768"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2062771">)</span>&nbsp;<span class="ident" id="2062773">setUint64</span><span class="op" id="2062782">(</span><span class="ident" id="2062783">x</span>&nbsp;<span class="builtintype" id="2062785">uint64</span><span class="op" id="2062791">)</span>&nbsp;<span class="ident" id="2062793"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2062797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2062800">//&nbsp;single-digit&nbsp;values</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2062824">if</span>&nbsp;<span class="ident" id="2062827">w</span>&nbsp;<span class="op" id="2062829">:=</span>&nbsp;<span class="ident" id="2062832"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2062836">(</span><span class="ident" id="2062837"><a href="/gostd/math/big/nat.go.html#2062783">x</a></span><span class="op" id="2062838">)</span><span class="op" id="2062839">;</span>&nbsp;<span class="builtintype" id="2062841">uint64</span><span class="op" id="2062847">(</span><span class="ident" id="2062848"><a href="/gostd/math/big/nat.go.html#2062827">w</a></span><span class="op" id="2062849">)</span>&nbsp;<span class="op" id="2062851">==</span>&nbsp;<span class="ident" id="2062854"><a href="/gostd/math/big/nat.go.html#2062783">x</a></span>&nbsp;<span class="op" id="2062856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2062860">return</span>&nbsp;<span class="ident" id="2062867"><a href="/gostd/math/big/nat.go.html#2062766">z</a></span><span class="op" id="2062868">.</span><span class="ident" id="2062869"><a href="/gostd/math/big/nat.go.html#2062665">setWord</a></span><span class="op" id="2062876">(</span><span class="ident" id="2062877"><a href="/gostd/math/big/nat.go.html#2062827">w</a></span><span class="op" id="2062878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2062881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2062885">//&nbsp;compute&nbsp;number&nbsp;of&nbsp;words&nbsp;n&nbsp;required&nbsp;to&nbsp;represent&nbsp;x</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2062939">n</span>&nbsp;<span class="op" id="2062941">:=</span>&nbsp;<span class="num" id="2062944">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2062947">for</span>&nbsp;<span class="ident" id="2062951">t</span>&nbsp;<span class="op" id="2062953">:=</span>&nbsp;<span class="ident" id="2062956"><a href="/gostd/math/big/nat.go.html#2062783">x</a></span><span class="op" id="2062957">;</span>&nbsp;<span class="ident" id="2062959"><a href="/gostd/math/big/nat.go.html#2062951">t</a></span>&nbsp;<span class="op" id="2062961">&gt;</span>&nbsp;<span class="num" id="2062963">0</span><span class="op" id="2062964">;</span>&nbsp;<span class="ident" id="2062966"><a href="/gostd/math/big/nat.go.html#2062951">t</a></span>&nbsp;<span class="op" id="2062968">&gt;&gt;=</span>&nbsp;<span class="ident" id="2062972"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span>&nbsp;<span class="op" id="2062975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2062979"><a href="/gostd/math/big/nat.go.html#2062939">n</a></span><span class="op" id="2062980">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2062984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2062988">//&nbsp;split&nbsp;x&nbsp;into&nbsp;n&nbsp;words</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063013"><a href="/gostd/math/big/nat.go.html#2062766">z</a></span>&nbsp;<span class="op" id="2063015">=</span>&nbsp;<span class="ident" id="2063017"><a href="/gostd/math/big/nat.go.html#2062766">z</a></span><span class="op" id="2063018">.</span><span class="builtinfunc" id="2063019"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2063023">(</span><span class="ident" id="2063024"><a href="/gostd/math/big/nat.go.html#2062939">n</a></span><span class="op" id="2063025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063028">for</span>&nbsp;<span class="ident" id="2063032">i</span>&nbsp;<span class="op" id="2063034">:=</span>&nbsp;<span class="keyword" id="2063037">range</span>&nbsp;<span class="ident" id="2063043"><a href="/gostd/math/big/nat.go.html#2062766">z</a></span>&nbsp;<span class="op" id="2063045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063049"><a href="/gostd/math/big/nat.go.html#2062766">z</a></span><span class="op" id="2063050">[</span><span class="ident" id="2063051"><a href="/gostd/math/big/nat.go.html#2063032">i</a></span><span class="op" id="2063052">]</span>&nbsp;<span class="op" id="2063054">=</span>&nbsp;<span class="ident" id="2063056"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2063060">(</span><span class="ident" id="2063061"><a href="/gostd/math/big/nat.go.html#2062783">x</a></span>&nbsp;<span class="op" id="2063063">&amp;</span>&nbsp;<span class="ident" id="2063065"><a href="/gostd/math/big/arith.go.html#2031219">_M</a></span><span class="op" id="2063067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063071"><a href="/gostd/math/big/nat.go.html#2062783">x</a></span>&nbsp;<span class="op" id="2063073">&gt;&gt;=</span>&nbsp;<span class="ident" id="2063077"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2063081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063085">return</span>&nbsp;<span class="ident" id="2063092"><a href="/gostd/math/big/nat.go.html#2062766">z</a></span><br>
<span class="lineno"></span><span class="op" id="2063094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="2063097">func</span>&nbsp;<span class="op" id="2063102">(</span><span class="ident" id="2063103">z</span>&nbsp;<span class="ident" id="2063105"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2063108">)</span>&nbsp;<span class="ident" id="2063110">set</span><span class="op" id="2063113">(</span><span class="ident" id="2063114">x</span>&nbsp;<span class="ident" id="2063116"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2063119">)</span>&nbsp;<span class="ident" id="2063121"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2063125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063128"><a href="/gostd/math/big/nat.go.html#2063103">z</a></span>&nbsp;<span class="op" id="2063130">=</span>&nbsp;<span class="ident" id="2063132"><a href="/gostd/math/big/nat.go.html#2063103">z</a></span><span class="op" id="2063133">.</span><span class="builtinfunc" id="2063134"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2063138">(</span><span class="builtinfunc" id="2063139">len</span><span class="op" id="2063142">(</span><span class="ident" id="2063143"><a href="/gostd/math/big/nat.go.html#2063114">x</a></span><span class="op" id="2063144">)</span><span class="op" id="2063145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2063148">copy</span><span class="op" id="2063152">(</span><span class="ident" id="2063153"><a href="/gostd/math/big/nat.go.html#2063103">z</a></span><span class="op" id="2063154">,</span>&nbsp;<span class="ident" id="2063156"><a href="/gostd/math/big/nat.go.html#2063114">x</a></span><span class="op" id="2063157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063160">return</span>&nbsp;<span class="ident" id="2063167"><a href="/gostd/math/big/nat.go.html#2063103">z</a></span><br>
<span class="lineno"></span><span class="op" id="2063169">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="2063172">func</span>&nbsp;<span class="op" id="2063177">(</span><span class="ident" id="2063178">z</span>&nbsp;<span class="ident" id="2063180"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2063183">)</span>&nbsp;<span class="ident" id="2063185">add</span><span class="op" id="2063188">(</span><span class="ident" id="2063189">x</span><span class="op" id="2063190">,</span>&nbsp;<span class="ident" id="2063192">y</span>&nbsp;<span class="ident" id="2063194"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2063197">)</span>&nbsp;<span class="ident" id="2063199"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2063203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063206">m</span>&nbsp;<span class="op" id="2063208">:=</span>&nbsp;<span class="builtinfunc" id="2063211">len</span><span class="op" id="2063214">(</span><span class="ident" id="2063215"><a href="/gostd/math/big/nat.go.html#2063189">x</a></span><span class="op" id="2063216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063219">n</span>&nbsp;<span class="op" id="2063221">:=</span>&nbsp;<span class="builtinfunc" id="2063224">len</span><span class="op" id="2063227">(</span><span class="ident" id="2063228"><a href="/gostd/math/big/nat.go.html#2063192">y</a></span><span class="op" id="2063229">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063233">switch</span>&nbsp;<span class="op" id="2063240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063243">case</span>&nbsp;<span class="ident" id="2063248"><a href="/gostd/math/big/nat.go.html#2063206">m</a></span>&nbsp;<span class="op" id="2063250">&lt;</span>&nbsp;<span class="ident" id="2063252"><a href="/gostd/math/big/nat.go.html#2063219">n</a></span><span class="op" id="2063253">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063257">return</span>&nbsp;<span class="ident" id="2063264"><a href="/gostd/math/big/nat.go.html#2063178">z</a></span><span class="op" id="2063265">.</span><span class="ident" id="2063266"><a href="/gostd/math/big/nat.go.html#2063185">add</a></span><span class="op" id="2063269">(</span><span class="ident" id="2063270"><a href="/gostd/math/big/nat.go.html#2063192">y</a></span><span class="op" id="2063271">,</span>&nbsp;<span class="ident" id="2063273"><a href="/gostd/math/big/nat.go.html#2063189">x</a></span><span class="op" id="2063274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063277">case</span>&nbsp;<span class="ident" id="2063282"><a href="/gostd/math/big/nat.go.html#2063206">m</a></span>&nbsp;<span class="op" id="2063284">==</span>&nbsp;<span class="num" id="2063287">0</span><span class="op" id="2063288">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2063292">//&nbsp;n&nbsp;==&nbsp;0&nbsp;because&nbsp;m&nbsp;&gt;=&nbsp;n;&nbsp;result&nbsp;is&nbsp;0</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063332">return</span>&nbsp;<span class="ident" id="2063339"><a href="/gostd/math/big/nat.go.html#2063178">z</a></span><span class="op" id="2063340">.</span><span class="builtinfunc" id="2063341"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2063345">(</span><span class="num" id="2063346">0</span><span class="op" id="2063347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063350">case</span>&nbsp;<span class="ident" id="2063355"><a href="/gostd/math/big/nat.go.html#2063219">n</a></span>&nbsp;<span class="op" id="2063357">==</span>&nbsp;<span class="num" id="2063360">0</span><span class="op" id="2063361">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2063365">//&nbsp;result&nbsp;is&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063382">return</span>&nbsp;<span class="ident" id="2063389"><a href="/gostd/math/big/nat.go.html#2063178">z</a></span><span class="op" id="2063390">.</span><span class="ident" id="2063391"><a href="/gostd/math/big/nat.go.html#2063110">set</a></span><span class="op" id="2063394">(</span><span class="ident" id="2063395"><a href="/gostd/math/big/nat.go.html#2063189">x</a></span><span class="op" id="2063396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2063399">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2063402">//&nbsp;m&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063413"><a href="/gostd/math/big/nat.go.html#2063178">z</a></span>&nbsp;<span class="op" id="2063415">=</span>&nbsp;<span class="ident" id="2063417"><a href="/gostd/math/big/nat.go.html#2063178">z</a></span><span class="op" id="2063418">.</span><span class="builtinfunc" id="2063419"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2063423">(</span><span class="ident" id="2063424"><a href="/gostd/math/big/nat.go.html#2063206">m</a></span>&nbsp;<span class="op" id="2063426">+</span>&nbsp;<span class="num" id="2063428">1</span><span class="op" id="2063429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063432">c</span>&nbsp;<span class="op" id="2063434">:=</span>&nbsp;<span class="ident" id="2063437"><a href="/gostd/math/big/arith_decl.go.html#2035171">addVV</a></span><span class="op" id="2063442">(</span><span class="ident" id="2063443"><a href="/gostd/math/big/nat.go.html#2063178">z</a></span><span class="op" id="2063444">[</span><span class="num" id="2063445">0</span><span class="op" id="2063446">:</span><span class="ident" id="2063447"><a href="/gostd/math/big/nat.go.html#2063219">n</a></span><span class="op" id="2063448">]</span><span class="op" id="2063449">,</span>&nbsp;<span class="ident" id="2063451"><a href="/gostd/math/big/nat.go.html#2063189">x</a></span><span class="op" id="2063452">,</span>&nbsp;<span class="ident" id="2063454"><a href="/gostd/math/big/nat.go.html#2063192">y</a></span><span class="op" id="2063455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063458">if</span>&nbsp;<span class="ident" id="2063461"><a href="/gostd/math/big/nat.go.html#2063206">m</a></span>&nbsp;<span class="op" id="2063463">&gt;</span>&nbsp;<span class="ident" id="2063465"><a href="/gostd/math/big/nat.go.html#2063219">n</a></span>&nbsp;<span class="op" id="2063467">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063471"><a href="/gostd/math/big/nat.go.html#2063432">c</a></span>&nbsp;<span class="op" id="2063473">=</span>&nbsp;<span class="ident" id="2063475"><a href="/gostd/math/big/arith_decl.go.html#2035243">addVW</a></span><span class="op" id="2063480">(</span><span class="ident" id="2063481"><a href="/gostd/math/big/nat.go.html#2063178">z</a></span><span class="op" id="2063482">[</span><span class="ident" id="2063483"><a href="/gostd/math/big/nat.go.html#2063219">n</a></span><span class="op" id="2063484">:</span><span class="ident" id="2063485"><a href="/gostd/math/big/nat.go.html#2063206">m</a></span><span class="op" id="2063486">]</span><span class="op" id="2063487">,</span>&nbsp;<span class="ident" id="2063489"><a href="/gostd/math/big/nat.go.html#2063189">x</a></span><span class="op" id="2063490">[</span><span class="ident" id="2063491"><a href="/gostd/math/big/nat.go.html#2063219">n</a></span><span class="op" id="2063492">:</span><span class="op" id="2063493">]</span><span class="op" id="2063494">,</span>&nbsp;<span class="ident" id="2063496"><a href="/gostd/math/big/nat.go.html#2063432">c</a></span><span class="op" id="2063497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2063500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063503"><a href="/gostd/math/big/nat.go.html#2063178">z</a></span><span class="op" id="2063504">[</span><span class="ident" id="2063505"><a href="/gostd/math/big/nat.go.html#2063206">m</a></span><span class="op" id="2063506">]</span>&nbsp;<span class="op" id="2063508">=</span>&nbsp;<span class="ident" id="2063510"><a href="/gostd/math/big/nat.go.html#2063432">c</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063514">return</span>&nbsp;<span class="ident" id="2063521"><a href="/gostd/math/big/nat.go.html#2063178">z</a></span><span class="op" id="2063522">.</span><span class="ident" id="2063523"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2063527">(</span><span class="op" id="2063528">)</span><br>
<span class="lineno">140</span><span class="op" id="2063530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2063533">func</span>&nbsp;<span class="op" id="2063538">(</span><span class="ident" id="2063539">z</span>&nbsp;<span class="ident" id="2063541"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2063544">)</span>&nbsp;<span class="ident" id="2063546">sub</span><span class="op" id="2063549">(</span><span class="ident" id="2063550">x</span><span class="op" id="2063551">,</span>&nbsp;<span class="ident" id="2063553">y</span>&nbsp;<span class="ident" id="2063555"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2063558">)</span>&nbsp;<span class="ident" id="2063560"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2063564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063567">m</span>&nbsp;<span class="op" id="2063569">:=</span>&nbsp;<span class="builtinfunc" id="2063572">len</span><span class="op" id="2063575">(</span><span class="ident" id="2063576"><a href="/gostd/math/big/nat.go.html#2063550">x</a></span><span class="op" id="2063577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063580">n</span>&nbsp;<span class="op" id="2063582">:=</span>&nbsp;<span class="builtinfunc" id="2063585">len</span><span class="op" id="2063588">(</span><span class="ident" id="2063589"><a href="/gostd/math/big/nat.go.html#2063553">y</a></span><span class="op" id="2063590">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063594">switch</span>&nbsp;<span class="op" id="2063601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063604">case</span>&nbsp;<span class="ident" id="2063609"><a href="/gostd/math/big/nat.go.html#2063567">m</a></span>&nbsp;<span class="op" id="2063611">&lt;</span>&nbsp;<span class="ident" id="2063613"><a href="/gostd/math/big/nat.go.html#2063580">n</a></span><span class="op" id="2063614">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2063618">panic</span><span class="op" id="2063623">(</span><span class="string" id="2063624">&#34;underflow&#34;</span><span class="op" id="2063635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063638">case</span>&nbsp;<span class="ident" id="2063643"><a href="/gostd/math/big/nat.go.html#2063567">m</a></span>&nbsp;<span class="op" id="2063645">==</span>&nbsp;<span class="num" id="2063648">0</span><span class="op" id="2063649">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2063653">//&nbsp;n&nbsp;==&nbsp;0&nbsp;because&nbsp;m&nbsp;&gt;=&nbsp;n;&nbsp;result&nbsp;is&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063693">return</span>&nbsp;<span class="ident" id="2063700"><a href="/gostd/math/big/nat.go.html#2063539">z</a></span><span class="op" id="2063701">.</span><span class="builtinfunc" id="2063702"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2063706">(</span><span class="num" id="2063707">0</span><span class="op" id="2063708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063711">case</span>&nbsp;<span class="ident" id="2063716"><a href="/gostd/math/big/nat.go.html#2063580">n</a></span>&nbsp;<span class="op" id="2063718">==</span>&nbsp;<span class="num" id="2063721">0</span><span class="op" id="2063722">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2063726">//&nbsp;result&nbsp;is&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063743">return</span>&nbsp;<span class="ident" id="2063750"><a href="/gostd/math/big/nat.go.html#2063539">z</a></span><span class="op" id="2063751">.</span><span class="ident" id="2063752"><a href="/gostd/math/big/nat.go.html#2063110">set</a></span><span class="op" id="2063755">(</span><span class="ident" id="2063756"><a href="/gostd/math/big/nat.go.html#2063550">x</a></span><span class="op" id="2063757">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2063760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2063763">//&nbsp;m&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063774"><a href="/gostd/math/big/nat.go.html#2063539">z</a></span>&nbsp;<span class="op" id="2063776">=</span>&nbsp;<span class="ident" id="2063778"><a href="/gostd/math/big/nat.go.html#2063539">z</a></span><span class="op" id="2063779">.</span><span class="builtinfunc" id="2063780"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2063784">(</span><span class="ident" id="2063785"><a href="/gostd/math/big/nat.go.html#2063567">m</a></span><span class="op" id="2063786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063789">c</span>&nbsp;<span class="op" id="2063791">:=</span>&nbsp;<span class="ident" id="2063794"><a href="/gostd/math/big/arith_decl.go.html#2035207">subVV</a></span><span class="op" id="2063799">(</span><span class="ident" id="2063800"><a href="/gostd/math/big/nat.go.html#2063539">z</a></span><span class="op" id="2063801">[</span><span class="num" id="2063802">0</span><span class="op" id="2063803">:</span><span class="ident" id="2063804"><a href="/gostd/math/big/nat.go.html#2063580">n</a></span><span class="op" id="2063805">]</span><span class="op" id="2063806">,</span>&nbsp;<span class="ident" id="2063808"><a href="/gostd/math/big/nat.go.html#2063550">x</a></span><span class="op" id="2063809">,</span>&nbsp;<span class="ident" id="2063811"><a href="/gostd/math/big/nat.go.html#2063553">y</a></span><span class="op" id="2063812">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063815">if</span>&nbsp;<span class="ident" id="2063818"><a href="/gostd/math/big/nat.go.html#2063567">m</a></span>&nbsp;<span class="op" id="2063820">&gt;</span>&nbsp;<span class="ident" id="2063822"><a href="/gostd/math/big/nat.go.html#2063580">n</a></span>&nbsp;<span class="op" id="2063824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063828"><a href="/gostd/math/big/nat.go.html#2063789">c</a></span>&nbsp;<span class="op" id="2063830">=</span>&nbsp;<span class="ident" id="2063832"><a href="/gostd/math/big/arith_decl.go.html#2035284">subVW</a></span><span class="op" id="2063837">(</span><span class="ident" id="2063838"><a href="/gostd/math/big/nat.go.html#2063539">z</a></span><span class="op" id="2063839">[</span><span class="ident" id="2063840"><a href="/gostd/math/big/nat.go.html#2063580">n</a></span><span class="op" id="2063841">:</span><span class="op" id="2063842">]</span><span class="op" id="2063843">,</span>&nbsp;<span class="ident" id="2063845"><a href="/gostd/math/big/nat.go.html#2063550">x</a></span><span class="op" id="2063846">[</span><span class="ident" id="2063847"><a href="/gostd/math/big/nat.go.html#2063580">n</a></span><span class="op" id="2063848">:</span><span class="op" id="2063849">]</span><span class="op" id="2063850">,</span>&nbsp;<span class="ident" id="2063852"><a href="/gostd/math/big/nat.go.html#2063789">c</a></span><span class="op" id="2063853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2063856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063859">if</span>&nbsp;<span class="ident" id="2063862"><a href="/gostd/math/big/nat.go.html#2063789">c</a></span>&nbsp;<span class="op" id="2063864">!=</span>&nbsp;<span class="num" id="2063867">0</span>&nbsp;<span class="op" id="2063869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2063873">panic</span><span class="op" id="2063878">(</span><span class="string" id="2063879">&#34;underflow&#34;</span><span class="op" id="2063890">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2063893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063897">return</span>&nbsp;<span class="ident" id="2063904"><a href="/gostd/math/big/nat.go.html#2063539">z</a></span><span class="op" id="2063905">.</span><span class="ident" id="2063906"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2063910">(</span><span class="op" id="2063911">)</span><br>
<span class="lineno"></span><span class="op" id="2063913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="2063916">func</span>&nbsp;<span class="op" id="2063921">(</span><span class="ident" id="2063922">x</span>&nbsp;<span class="ident" id="2063924"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2063927">)</span>&nbsp;<span class="ident" id="2063929">cmp</span><span class="op" id="2063932">(</span><span class="ident" id="2063933">y</span>&nbsp;<span class="ident" id="2063935"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2063938">)</span>&nbsp;<span class="op" id="2063940">(</span><span class="ident" id="2063941">r</span>&nbsp;<span class="builtintype" id="2063943">int</span><span class="op" id="2063946">)</span>&nbsp;<span class="op" id="2063948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063951">m</span>&nbsp;<span class="op" id="2063953">:=</span>&nbsp;<span class="builtinfunc" id="2063956">len</span><span class="op" id="2063959">(</span><span class="ident" id="2063960"><a href="/gostd/math/big/nat.go.html#2063922">x</a></span><span class="op" id="2063961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2063964">n</span>&nbsp;<span class="op" id="2063966">:=</span>&nbsp;<span class="builtinfunc" id="2063969">len</span><span class="op" id="2063972">(</span><span class="ident" id="2063973"><a href="/gostd/math/big/nat.go.html#2063933">y</a></span><span class="op" id="2063974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2063977">if</span>&nbsp;<span class="ident" id="2063980"><a href="/gostd/math/big/nat.go.html#2063951">m</a></span>&nbsp;<span class="op" id="2063982">!=</span>&nbsp;<span class="ident" id="2063985"><a href="/gostd/math/big/nat.go.html#2063964">n</a></span>&nbsp;<span class="op" id="2063987">||</span>&nbsp;<span class="ident" id="2063990"><a href="/gostd/math/big/nat.go.html#2063951">m</a></span>&nbsp;<span class="op" id="2063992">==</span>&nbsp;<span class="num" id="2063995">0</span>&nbsp;<span class="op" id="2063997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2064001">switch</span>&nbsp;<span class="op" id="2064008">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2064012">case</span>&nbsp;<span class="ident" id="2064017"><a href="/gostd/math/big/nat.go.html#2063951">m</a></span>&nbsp;<span class="op" id="2064019">&lt;</span>&nbsp;<span class="ident" id="2064021"><a href="/gostd/math/big/nat.go.html#2063964">n</a></span><span class="op" id="2064022">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064027"><a href="/gostd/math/big/nat.go.html#2063941">r</a></span>&nbsp;<span class="op" id="2064029">=</span>&nbsp;<span class="op" id="2064031">-</span><span class="num" id="2064032">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2064036">case</span>&nbsp;<span class="ident" id="2064041"><a href="/gostd/math/big/nat.go.html#2063951">m</a></span>&nbsp;<span class="op" id="2064043">&gt;</span>&nbsp;<span class="ident" id="2064045"><a href="/gostd/math/big/nat.go.html#2063964">n</a></span><span class="op" id="2064046">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064051"><a href="/gostd/math/big/nat.go.html#2063941">r</a></span>&nbsp;<span class="op" id="2064053">=</span>&nbsp;<span class="num" id="2064055">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2064059">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2064063">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2064071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064075">i</span>&nbsp;<span class="op" id="2064077">:=</span>&nbsp;<span class="ident" id="2064080"><a href="/gostd/math/big/nat.go.html#2063951">m</a></span>&nbsp;<span class="op" id="2064082">-</span>&nbsp;<span class="num" id="2064084">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2064087">for</span>&nbsp;<span class="ident" id="2064091"><a href="/gostd/math/big/nat.go.html#2064075">i</a></span>&nbsp;<span class="op" id="2064093">&gt;</span>&nbsp;<span class="num" id="2064095">0</span>&nbsp;<span class="op" id="2064097">&amp;&amp;</span>&nbsp;<span class="ident" id="2064100"><a href="/gostd/math/big/nat.go.html#2063922">x</a></span><span class="op" id="2064101">[</span><span class="ident" id="2064102"><a href="/gostd/math/big/nat.go.html#2064075">i</a></span><span class="op" id="2064103">]</span>&nbsp;<span class="op" id="2064105">==</span>&nbsp;<span class="ident" id="2064108"><a href="/gostd/math/big/nat.go.html#2063933">y</a></span><span class="op" id="2064109">[</span><span class="ident" id="2064110"><a href="/gostd/math/big/nat.go.html#2064075">i</a></span><span class="op" id="2064111">]</span>&nbsp;<span class="op" id="2064113">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064117"><a href="/gostd/math/big/nat.go.html#2064075">i</a></span><span class="op" id="2064118">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2064122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2064126">switch</span>&nbsp;<span class="op" id="2064133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2064136">case</span>&nbsp;<span class="ident" id="2064141"><a href="/gostd/math/big/nat.go.html#2063922">x</a></span><span class="op" id="2064142">[</span><span class="ident" id="2064143"><a href="/gostd/math/big/nat.go.html#2064075">i</a></span><span class="op" id="2064144">]</span>&nbsp;<span class="op" id="2064146">&lt;</span>&nbsp;<span class="ident" id="2064148"><a href="/gostd/math/big/nat.go.html#2063933">y</a></span><span class="op" id="2064149">[</span><span class="ident" id="2064150"><a href="/gostd/math/big/nat.go.html#2064075">i</a></span><span class="op" id="2064151">]</span><span class="op" id="2064152">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064156"><a href="/gostd/math/big/nat.go.html#2063941">r</a></span>&nbsp;<span class="op" id="2064158">=</span>&nbsp;<span class="op" id="2064160">-</span><span class="num" id="2064161">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2064164">case</span>&nbsp;<span class="ident" id="2064169"><a href="/gostd/math/big/nat.go.html#2063922">x</a></span><span class="op" id="2064170">[</span><span class="ident" id="2064171"><a href="/gostd/math/big/nat.go.html#2064075">i</a></span><span class="op" id="2064172">]</span>&nbsp;<span class="op" id="2064174">&gt;</span>&nbsp;<span class="ident" id="2064176"><a href="/gostd/math/big/nat.go.html#2063933">y</a></span><span class="op" id="2064177">[</span><span class="ident" id="2064178"><a href="/gostd/math/big/nat.go.html#2064075">i</a></span><span class="op" id="2064179">]</span><span class="op" id="2064180">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064184"><a href="/gostd/math/big/nat.go.html#2063941">r</a></span>&nbsp;<span class="op" id="2064186">=</span>&nbsp;<span class="num" id="2064188">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2064191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2064194">return</span><br>
<span class="lineno">195</span><span class="op" id="2064201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2064204">func</span>&nbsp;<span class="op" id="2064209">(</span><span class="ident" id="2064210">z</span>&nbsp;<span class="ident" id="2064212"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2064215">)</span>&nbsp;<span class="ident" id="2064217">mulAddWW</span><span class="op" id="2064225">(</span><span class="ident" id="2064226">x</span>&nbsp;<span class="ident" id="2064228"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2064231">,</span>&nbsp;<span class="ident" id="2064233">y</span><span class="op" id="2064234">,</span>&nbsp;<span class="ident" id="2064236">r</span>&nbsp;<span class="ident" id="2064238"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2064242">)</span>&nbsp;<span class="ident" id="2064244"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2064248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064251">m</span>&nbsp;<span class="op" id="2064253">:=</span>&nbsp;<span class="builtinfunc" id="2064256">len</span><span class="op" id="2064259">(</span><span class="ident" id="2064260"><a href="/gostd/math/big/nat.go.html#2064226">x</a></span><span class="op" id="2064261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2064264">if</span>&nbsp;<span class="ident" id="2064267"><a href="/gostd/math/big/nat.go.html#2064251">m</a></span>&nbsp;<span class="op" id="2064269">==</span>&nbsp;<span class="num" id="2064272">0</span>&nbsp;<span class="op" id="2064274">||</span>&nbsp;<span class="ident" id="2064277"><a href="/gostd/math/big/nat.go.html#2064233">y</a></span>&nbsp;<span class="op" id="2064279">==</span>&nbsp;<span class="num" id="2064282">0</span>&nbsp;<span class="op" id="2064284">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2064288">return</span>&nbsp;<span class="ident" id="2064295"><a href="/gostd/math/big/nat.go.html#2064210">z</a></span><span class="op" id="2064296">.</span><span class="ident" id="2064297"><a href="/gostd/math/big/nat.go.html#2062665">setWord</a></span><span class="op" id="2064304">(</span><span class="ident" id="2064305"><a href="/gostd/math/big/nat.go.html#2064236">r</a></span><span class="op" id="2064306">)</span>&nbsp;<span class="comment" id="2064308">//&nbsp;result&nbsp;is&nbsp;r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2064324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2064327">//&nbsp;m&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064338"><a href="/gostd/math/big/nat.go.html#2064210">z</a></span>&nbsp;<span class="op" id="2064340">=</span>&nbsp;<span class="ident" id="2064342"><a href="/gostd/math/big/nat.go.html#2064210">z</a></span><span class="op" id="2064343">.</span><span class="builtinfunc" id="2064344"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2064348">(</span><span class="ident" id="2064349"><a href="/gostd/math/big/nat.go.html#2064251">m</a></span>&nbsp;<span class="op" id="2064351">+</span>&nbsp;<span class="num" id="2064353">1</span><span class="op" id="2064354">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064357"><a href="/gostd/math/big/nat.go.html#2064210">z</a></span><span class="op" id="2064358">[</span><span class="ident" id="2064359"><a href="/gostd/math/big/nat.go.html#2064251">m</a></span><span class="op" id="2064360">]</span>&nbsp;<span class="op" id="2064362">=</span>&nbsp;<span class="ident" id="2064364"><a href="/gostd/math/big/arith_decl.go.html#2035407">mulAddVWW</a></span><span class="op" id="2064373">(</span><span class="ident" id="2064374"><a href="/gostd/math/big/nat.go.html#2064210">z</a></span><span class="op" id="2064375">[</span><span class="num" id="2064376">0</span><span class="op" id="2064377">:</span><span class="ident" id="2064378"><a href="/gostd/math/big/nat.go.html#2064251">m</a></span><span class="op" id="2064379">]</span><span class="op" id="2064380">,</span>&nbsp;<span class="ident" id="2064382"><a href="/gostd/math/big/nat.go.html#2064226">x</a></span><span class="op" id="2064383">,</span>&nbsp;<span class="ident" id="2064385"><a href="/gostd/math/big/nat.go.html#2064233">y</a></span><span class="op" id="2064386">,</span>&nbsp;<span class="ident" id="2064388"><a href="/gostd/math/big/nat.go.html#2064236">r</a></span><span class="op" id="2064389">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2064393">return</span>&nbsp;<span class="ident" id="2064400"><a href="/gostd/math/big/nat.go.html#2064210">z</a></span><span class="op" id="2064401">.</span><span class="ident" id="2064402"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2064406">(</span><span class="op" id="2064407">)</span><br>
<span class="lineno"></span><span class="op" id="2064409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="comment" id="2064412">//&nbsp;basicMul&nbsp;multiplies&nbsp;x&nbsp;and&nbsp;y&nbsp;and&nbsp;leaves&nbsp;the&nbsp;result&nbsp;in&nbsp;z.</span><br>
<span class="lineno"></span><span class="comment" id="2064471">//&nbsp;The&nbsp;(non-normalized)&nbsp;result&nbsp;is&nbsp;placed&nbsp;in&nbsp;z[0&nbsp;:&nbsp;len(x)&nbsp;+&nbsp;len(y)].</span><br>
<span class="lineno"></span><span class="keyword" id="2064539">func</span>&nbsp;<span class="ident" id="2064544">basicMul</span><span class="op" id="2064552">(</span><span class="ident" id="2064553">z</span><span class="op" id="2064554">,</span>&nbsp;<span class="ident" id="2064556">x</span><span class="op" id="2064557">,</span>&nbsp;<span class="ident" id="2064559">y</span>&nbsp;<span class="ident" id="2064561"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2064564">)</span>&nbsp;<span class="op" id="2064566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064569"><a href="/gostd/math/big/nat.go.html#2064553">z</a></span><span class="op" id="2064570">[</span><span class="num" id="2064571">0</span>&nbsp;<span class="op" id="2064573">:</span>&nbsp;<span class="builtinfunc" id="2064575">len</span><span class="op" id="2064578">(</span><span class="ident" id="2064579"><a href="/gostd/math/big/nat.go.html#2064556">x</a></span><span class="op" id="2064580">)</span><span class="op" id="2064581">+</span><span class="builtinfunc" id="2064582">len</span><span class="op" id="2064585">(</span><span class="ident" id="2064586"><a href="/gostd/math/big/nat.go.html#2064559">y</a></span><span class="op" id="2064587">)</span><span class="op" id="2064588">]</span><span class="op" id="2064589">.</span><span class="ident" id="2064590"><a href="/gostd/math/big/nat.go.html#2062241">clear</a></span><span class="op" id="2064595">(</span><span class="op" id="2064596">)</span>&nbsp;<span class="comment" id="2064598">//&nbsp;initialize&nbsp;z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2064615">for</span>&nbsp;<span class="ident" id="2064619">i</span><span class="op" id="2064620">,</span>&nbsp;<span class="ident" id="2064622">d</span>&nbsp;<span class="op" id="2064624">:=</span>&nbsp;<span class="keyword" id="2064627">range</span>&nbsp;<span class="ident" id="2064633"><a href="/gostd/math/big/nat.go.html#2064559">y</a></span>&nbsp;<span class="op" id="2064635">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2064639">if</span>&nbsp;<span class="ident" id="2064642"><a href="/gostd/math/big/nat.go.html#2064622">d</a></span>&nbsp;<span class="op" id="2064644">!=</span>&nbsp;<span class="num" id="2064647">0</span>&nbsp;<span class="op" id="2064649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064654"><a href="/gostd/math/big/nat.go.html#2064553">z</a></span><span class="op" id="2064655">[</span><span class="builtinfunc" id="2064656">len</span><span class="op" id="2064659">(</span><span class="ident" id="2064660"><a href="/gostd/math/big/nat.go.html#2064556">x</a></span><span class="op" id="2064661">)</span><span class="op" id="2064662">+</span><span class="ident" id="2064663"><a href="/gostd/math/big/nat.go.html#2064619">i</a></span><span class="op" id="2064664">]</span>&nbsp;<span class="op" id="2064666">=</span>&nbsp;<span class="ident" id="2064668"><a href="/gostd/math/big/arith_decl.go.html#2035455">addMulVVW</a></span><span class="op" id="2064677">(</span><span class="ident" id="2064678"><a href="/gostd/math/big/nat.go.html#2064553">z</a></span><span class="op" id="2064679">[</span><span class="ident" id="2064680"><a href="/gostd/math/big/nat.go.html#2064619">i</a></span><span class="op" id="2064681">:</span><span class="ident" id="2064682"><a href="/gostd/math/big/nat.go.html#2064619">i</a></span><span class="op" id="2064683">+</span><span class="builtinfunc" id="2064684">len</span><span class="op" id="2064687">(</span><span class="ident" id="2064688"><a href="/gostd/math/big/nat.go.html#2064556">x</a></span><span class="op" id="2064689">)</span><span class="op" id="2064690">]</span><span class="op" id="2064691">,</span>&nbsp;<span class="ident" id="2064693"><a href="/gostd/math/big/nat.go.html#2064556">x</a></span><span class="op" id="2064694">,</span>&nbsp;<span class="ident" id="2064696"><a href="/gostd/math/big/nat.go.html#2064622">d</a></span><span class="op" id="2064697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2064701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2064704">}</span><br>
<span class="lineno"></span><span class="op" id="2064706">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="2064709">//&nbsp;Fast&nbsp;version&nbsp;of&nbsp;z[0:n+n&gt;&gt;1].add(z[0:n+n&gt;&gt;1],&nbsp;x[0:n])&nbsp;w/o&nbsp;bounds&nbsp;checks.</span><br>
<span class="lineno"></span><span class="comment" id="2064784">//&nbsp;Factored&nbsp;out&nbsp;for&nbsp;readability&nbsp;-&nbsp;do&nbsp;not&nbsp;use&nbsp;outside&nbsp;karatsuba.</span><br>
<span class="lineno"></span><span class="keyword" id="2064848">func</span>&nbsp;<span class="ident" id="2064853">karatsubaAdd</span><span class="op" id="2064865">(</span><span class="ident" id="2064866">z</span><span class="op" id="2064867">,</span>&nbsp;<span class="ident" id="2064869">x</span>&nbsp;<span class="ident" id="2064871"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2064874">,</span>&nbsp;<span class="ident" id="2064876">n</span>&nbsp;<span class="builtintype" id="2064878">int</span><span class="op" id="2064881">)</span>&nbsp;<span class="op" id="2064883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2064886">if</span>&nbsp;<span class="ident" id="2064889">c</span>&nbsp;<span class="op" id="2064891">:=</span>&nbsp;<span class="ident" id="2064894"><a href="/gostd/math/big/arith_decl.go.html#2035171">addVV</a></span><span class="op" id="2064899">(</span><span class="ident" id="2064900"><a href="/gostd/math/big/nat.go.html#2064866">z</a></span><span class="op" id="2064901">[</span><span class="num" id="2064902">0</span><span class="op" id="2064903">:</span><span class="ident" id="2064904"><a href="/gostd/math/big/nat.go.html#2064876">n</a></span><span class="op" id="2064905">]</span><span class="op" id="2064906">,</span>&nbsp;<span class="ident" id="2064908"><a href="/gostd/math/big/nat.go.html#2064866">z</a></span><span class="op" id="2064909">,</span>&nbsp;<span class="ident" id="2064911"><a href="/gostd/math/big/nat.go.html#2064869">x</a></span><span class="op" id="2064912">)</span><span class="op" id="2064913">;</span>&nbsp;<span class="ident" id="2064915"><a href="/gostd/math/big/nat.go.html#2064889">c</a></span>&nbsp;<span class="op" id="2064917">!=</span>&nbsp;<span class="num" id="2064920">0</span>&nbsp;<span class="op" id="2064922">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064926"><a href="/gostd/math/big/arith_decl.go.html#2035243">addVW</a></span><span class="op" id="2064931">(</span><span class="ident" id="2064932"><a href="/gostd/math/big/nat.go.html#2064866">z</a></span><span class="op" id="2064933">[</span><span class="ident" id="2064934"><a href="/gostd/math/big/nat.go.html#2064876">n</a></span><span class="op" id="2064935">:</span><span class="ident" id="2064936"><a href="/gostd/math/big/nat.go.html#2064876">n</a></span><span class="op" id="2064937">+</span><span class="ident" id="2064938"><a href="/gostd/math/big/nat.go.html#2064876">n</a></span><span class="op" id="2064939">&gt;&gt;</span><span class="num" id="2064941">1</span><span class="op" id="2064942">]</span><span class="op" id="2064943">,</span>&nbsp;<span class="ident" id="2064945"><a href="/gostd/math/big/nat.go.html#2064866">z</a></span><span class="op" id="2064946">[</span><span class="ident" id="2064947"><a href="/gostd/math/big/nat.go.html#2064876">n</a></span><span class="op" id="2064948">:</span><span class="op" id="2064949">]</span><span class="op" id="2064950">,</span>&nbsp;<span class="ident" id="2064952"><a href="/gostd/math/big/nat.go.html#2064889">c</a></span><span class="op" id="2064953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2064956">}</span><br>
<span class="lineno"></span><span class="op" id="2064958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2064961">//&nbsp;Like&nbsp;karatsubaAdd,&nbsp;but&nbsp;does&nbsp;subtract.</span><br>
<span class="lineno">230</span><span class="keyword" id="2065002">func</span>&nbsp;<span class="ident" id="2065007">karatsubaSub</span><span class="op" id="2065019">(</span><span class="ident" id="2065020">z</span><span class="op" id="2065021">,</span>&nbsp;<span class="ident" id="2065023">x</span>&nbsp;<span class="ident" id="2065025"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2065028">,</span>&nbsp;<span class="ident" id="2065030">n</span>&nbsp;<span class="builtintype" id="2065032">int</span><span class="op" id="2065035">)</span>&nbsp;<span class="op" id="2065037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2065040">if</span>&nbsp;<span class="ident" id="2065043">c</span>&nbsp;<span class="op" id="2065045">:=</span>&nbsp;<span class="ident" id="2065048"><a href="/gostd/math/big/arith_decl.go.html#2035207">subVV</a></span><span class="op" id="2065053">(</span><span class="ident" id="2065054"><a href="/gostd/math/big/nat.go.html#2065020">z</a></span><span class="op" id="2065055">[</span><span class="num" id="2065056">0</span><span class="op" id="2065057">:</span><span class="ident" id="2065058"><a href="/gostd/math/big/nat.go.html#2065030">n</a></span><span class="op" id="2065059">]</span><span class="op" id="2065060">,</span>&nbsp;<span class="ident" id="2065062"><a href="/gostd/math/big/nat.go.html#2065020">z</a></span><span class="op" id="2065063">,</span>&nbsp;<span class="ident" id="2065065"><a href="/gostd/math/big/nat.go.html#2065023">x</a></span><span class="op" id="2065066">)</span><span class="op" id="2065067">;</span>&nbsp;<span class="ident" id="2065069"><a href="/gostd/math/big/nat.go.html#2065043">c</a></span>&nbsp;<span class="op" id="2065071">!=</span>&nbsp;<span class="num" id="2065074">0</span>&nbsp;<span class="op" id="2065076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065080"><a href="/gostd/math/big/arith_decl.go.html#2035284">subVW</a></span><span class="op" id="2065085">(</span><span class="ident" id="2065086"><a href="/gostd/math/big/nat.go.html#2065020">z</a></span><span class="op" id="2065087">[</span><span class="ident" id="2065088"><a href="/gostd/math/big/nat.go.html#2065030">n</a></span><span class="op" id="2065089">:</span><span class="ident" id="2065090"><a href="/gostd/math/big/nat.go.html#2065030">n</a></span><span class="op" id="2065091">+</span><span class="ident" id="2065092"><a href="/gostd/math/big/nat.go.html#2065030">n</a></span><span class="op" id="2065093">&gt;&gt;</span><span class="num" id="2065095">1</span><span class="op" id="2065096">]</span><span class="op" id="2065097">,</span>&nbsp;<span class="ident" id="2065099"><a href="/gostd/math/big/nat.go.html#2065020">z</a></span><span class="op" id="2065100">[</span><span class="ident" id="2065101"><a href="/gostd/math/big/nat.go.html#2065030">n</a></span><span class="op" id="2065102">:</span><span class="op" id="2065103">]</span><span class="op" id="2065104">,</span>&nbsp;<span class="ident" id="2065106"><a href="/gostd/math/big/nat.go.html#2065043">c</a></span><span class="op" id="2065107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2065110">}</span><br>
<span class="lineno"></span><span class="op" id="2065112">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="2065115">//&nbsp;Operands&nbsp;that&nbsp;are&nbsp;shorter&nbsp;than&nbsp;karatsubaThreshold&nbsp;are&nbsp;multiplied&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="2065189">//&nbsp;&#34;grade&nbsp;school&#34;&nbsp;multiplication;&nbsp;for&nbsp;longer&nbsp;operands&nbsp;the&nbsp;Karatsuba&nbsp;algorithm</span><br>
<span class="lineno"></span><span class="comment" id="2065267">//&nbsp;is&nbsp;used.</span><br>
<span class="lineno"></span><span class="keyword" id="2065279">var</span>&nbsp;<span class="ident" id="2065283">karatsubaThreshold</span>&nbsp;<span class="builtintype" id="2065302">int</span>&nbsp;<span class="op" id="2065306">=</span>&nbsp;<span class="num" id="2065308">40</span>&nbsp;<span class="comment" id="2065311">//&nbsp;computed&nbsp;by&nbsp;calibrate.go</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="comment" id="2065340">//&nbsp;karatsuba&nbsp;multiplies&nbsp;x&nbsp;and&nbsp;y&nbsp;and&nbsp;leaves&nbsp;the&nbsp;result&nbsp;in&nbsp;z.</span><br>
<span class="lineno"></span><span class="comment" id="2065400">//&nbsp;Both&nbsp;x&nbsp;and&nbsp;y&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;length&nbsp;n&nbsp;and&nbsp;n&nbsp;must&nbsp;be&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2065460">//&nbsp;power&nbsp;of&nbsp;2.&nbsp;The&nbsp;result&nbsp;vector&nbsp;z&nbsp;must&nbsp;have&nbsp;len(z)&nbsp;&gt;=&nbsp;6*n.</span><br>
<span class="lineno"></span><span class="comment" id="2065520">//&nbsp;The&nbsp;(non-normalized)&nbsp;result&nbsp;is&nbsp;placed&nbsp;in&nbsp;z[0&nbsp;:&nbsp;2*n].</span><br>
<span class="lineno">245</span><span class="keyword" id="2065576">func</span>&nbsp;<span class="ident" id="2065581">karatsuba</span><span class="op" id="2065590">(</span><span class="ident" id="2065591">z</span><span class="op" id="2065592">,</span>&nbsp;<span class="ident" id="2065594">x</span><span class="op" id="2065595">,</span>&nbsp;<span class="ident" id="2065597">y</span>&nbsp;<span class="ident" id="2065599"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2065602">)</span>&nbsp;<span class="op" id="2065604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065607">n</span>&nbsp;<span class="op" id="2065609">:=</span>&nbsp;<span class="builtinfunc" id="2065612">len</span><span class="op" id="2065615">(</span><span class="ident" id="2065616"><a href="/gostd/math/big/nat.go.html#2065597">y</a></span><span class="op" id="2065617">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2065621">//&nbsp;Switch&nbsp;to&nbsp;basic&nbsp;multiplication&nbsp;if&nbsp;numbers&nbsp;are&nbsp;odd&nbsp;or&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2065685">//&nbsp;(n&nbsp;is&nbsp;always&nbsp;even&nbsp;if&nbsp;karatsubaThreshold&nbsp;is&nbsp;even,&nbsp;but&nbsp;be</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2065745">//&nbsp;conservative)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2065763">if</span>&nbsp;<span class="ident" id="2065766"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span><span class="op" id="2065767">&amp;</span><span class="num" id="2065768">1</span>&nbsp;<span class="op" id="2065770">!=</span>&nbsp;<span class="num" id="2065773">0</span>&nbsp;<span class="op" id="2065775">||</span>&nbsp;<span class="ident" id="2065778"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span>&nbsp;<span class="op" id="2065780">&lt;</span>&nbsp;<span class="ident" id="2065782"><a href="/gostd/math/big/nat.go.html#2065283">karatsubaThreshold</a></span>&nbsp;<span class="op" id="2065801">||</span>&nbsp;<span class="ident" id="2065804"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span>&nbsp;<span class="op" id="2065806">&lt;</span>&nbsp;<span class="num" id="2065808">2</span>&nbsp;<span class="op" id="2065810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065814"><a href="/gostd/math/big/nat.go.html#2064544">basicMul</a></span><span class="op" id="2065822">(</span><span class="ident" id="2065823"><a href="/gostd/math/big/nat.go.html#2065591">z</a></span><span class="op" id="2065824">,</span>&nbsp;<span class="ident" id="2065826"><a href="/gostd/math/big/nat.go.html#2065594">x</a></span><span class="op" id="2065827">,</span>&nbsp;<span class="ident" id="2065829"><a href="/gostd/math/big/nat.go.html#2065597">y</a></span><span class="op" id="2065830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2065834">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2065842">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2065845">//&nbsp;n&amp;1&nbsp;==&nbsp;0&nbsp;&amp;&amp;&nbsp;n&nbsp;&gt;=&nbsp;karatsubaThreshold&nbsp;&amp;&amp;&nbsp;n&nbsp;&gt;=&nbsp;2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2065896">//&nbsp;Karatsuba&nbsp;multiplication&nbsp;is&nbsp;based&nbsp;on&nbsp;the&nbsp;observation&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2065958">//&nbsp;for&nbsp;two&nbsp;numbers&nbsp;x&nbsp;and&nbsp;y&nbsp;with:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2065992">//</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2065996">//&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;x1*b&nbsp;+&nbsp;x0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066016">//&nbsp;&nbsp;&nbsp;y&nbsp;=&nbsp;y1*b&nbsp;+&nbsp;y0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066036">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066040">//&nbsp;the&nbsp;product&nbsp;x*y&nbsp;can&nbsp;be&nbsp;obtained&nbsp;with&nbsp;3&nbsp;products&nbsp;z2,&nbsp;z1,&nbsp;z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066103">//&nbsp;instead&nbsp;of&nbsp;4:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066121">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066125">//&nbsp;&nbsp;&nbsp;x*y&nbsp;=&nbsp;x1*y1*b*b&nbsp;+&nbsp;(x1*y0&nbsp;+&nbsp;x0*y1)*b&nbsp;+&nbsp;x0*y0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066175">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;z2*b*b&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z1*b&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066225">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066229">//&nbsp;with:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066239">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066243">//&nbsp;&nbsp;&nbsp;xd&nbsp;=&nbsp;x1&nbsp;-&nbsp;x0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066262">//&nbsp;&nbsp;&nbsp;yd&nbsp;=&nbsp;y0&nbsp;-&nbsp;y1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066281">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066285">//&nbsp;&nbsp;&nbsp;z1&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xd*yd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;z2&nbsp;+&nbsp;z0</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066336">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(x1-x0)*(y0&nbsp;-&nbsp;y1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;z2&nbsp;+&nbsp;z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066387">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;x1*y0&nbsp;-&nbsp;x1*y1&nbsp;-&nbsp;x0*y0&nbsp;+&nbsp;x0*y1&nbsp;+&nbsp;z2&nbsp;+&nbsp;z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066438">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;x1*y0&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;z2&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;z0&nbsp;+&nbsp;x0*y1&nbsp;+&nbsp;z2&nbsp;+&nbsp;z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066489">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;x1*y0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;x0*y1</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066531">//&nbsp;split&nbsp;x,&nbsp;y&nbsp;into&nbsp;&#34;digits&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066560">n2</span>&nbsp;<span class="op" id="2066563">:=</span>&nbsp;<span class="ident" id="2066566"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span>&nbsp;<span class="op" id="2066568">&gt;&gt;</span>&nbsp;<span class="num" id="2066571">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066586">//&nbsp;n2&nbsp;&gt;=&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066598">x1</span><span class="op" id="2066600">,</span>&nbsp;<span class="ident" id="2066602">x0</span>&nbsp;<span class="op" id="2066605">:=</span>&nbsp;<span class="ident" id="2066608"><a href="/gostd/math/big/nat.go.html#2065594">x</a></span><span class="op" id="2066609">[</span><span class="ident" id="2066610"><a href="/gostd/math/big/nat.go.html#2066560">n2</a></span><span class="op" id="2066612">:</span><span class="op" id="2066613">]</span><span class="op" id="2066614">,</span>&nbsp;<span class="ident" id="2066616"><a href="/gostd/math/big/nat.go.html#2065594">x</a></span><span class="op" id="2066617">[</span><span class="num" id="2066618">0</span><span class="op" id="2066619">:</span><span class="ident" id="2066620"><a href="/gostd/math/big/nat.go.html#2066560">n2</a></span><span class="op" id="2066622">]</span>&nbsp;<span class="comment" id="2066624">//&nbsp;x&nbsp;=&nbsp;x1*b&nbsp;+&nbsp;y0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066642">y1</span><span class="op" id="2066644">,</span>&nbsp;<span class="ident" id="2066646">y0</span>&nbsp;<span class="op" id="2066649">:=</span>&nbsp;<span class="ident" id="2066652"><a href="/gostd/math/big/nat.go.html#2065597">y</a></span><span class="op" id="2066653">[</span><span class="ident" id="2066654"><a href="/gostd/math/big/nat.go.html#2066560">n2</a></span><span class="op" id="2066656">:</span><span class="op" id="2066657">]</span><span class="op" id="2066658">,</span>&nbsp;<span class="ident" id="2066660"><a href="/gostd/math/big/nat.go.html#2065597">y</a></span><span class="op" id="2066661">[</span><span class="num" id="2066662">0</span><span class="op" id="2066663">:</span><span class="ident" id="2066664"><a href="/gostd/math/big/nat.go.html#2066560">n2</a></span><span class="op" id="2066666">]</span>&nbsp;<span class="comment" id="2066668">//&nbsp;y&nbsp;=&nbsp;y1*b&nbsp;+&nbsp;y0</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066687">//&nbsp;z&nbsp;is&nbsp;used&nbsp;for&nbsp;the&nbsp;result&nbsp;and&nbsp;temporary&nbsp;storage:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066739">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066743">//&nbsp;&nbsp;&nbsp;6*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0*n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066801">//&nbsp;z&nbsp;=&nbsp;[z2&nbsp;copy|z0&nbsp;copy|&nbsp;xd*yd&nbsp;|&nbsp;yd:xd&nbsp;|&nbsp;x1*y1&nbsp;|&nbsp;x0*y0&nbsp;]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066859">//</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066863">//&nbsp;For&nbsp;each&nbsp;recursive&nbsp;call&nbsp;of&nbsp;karatsuba,&nbsp;an&nbsp;unused&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066924">//&nbsp;z&nbsp;is&nbsp;passed&nbsp;in&nbsp;that&nbsp;has&nbsp;(at&nbsp;least)&nbsp;half&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066986">//&nbsp;caller&#39;s&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067003">//&nbsp;compute&nbsp;z0&nbsp;and&nbsp;z2&nbsp;with&nbsp;the&nbsp;result&nbsp;&#34;in&nbsp;place&#34;&nbsp;in&nbsp;z</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067057"><a href="/gostd/math/big/nat.go.html#2065581">karatsuba</a></span><span class="op" id="2067066">(</span><span class="ident" id="2067067"><a href="/gostd/math/big/nat.go.html#2065591">z</a></span><span class="op" id="2067068">,</span>&nbsp;<span class="ident" id="2067070"><a href="/gostd/math/big/nat.go.html#2066602">x0</a></span><span class="op" id="2067072">,</span>&nbsp;<span class="ident" id="2067074"><a href="/gostd/math/big/nat.go.html#2066646">y0</a></span><span class="op" id="2067076">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067082">//&nbsp;z0&nbsp;=&nbsp;x0*y0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067097"><a href="/gostd/math/big/nat.go.html#2065581">karatsuba</a></span><span class="op" id="2067106">(</span><span class="ident" id="2067107"><a href="/gostd/math/big/nat.go.html#2065591">z</a></span><span class="op" id="2067108">[</span><span class="ident" id="2067109"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span><span class="op" id="2067110">:</span><span class="op" id="2067111">]</span><span class="op" id="2067112">,</span>&nbsp;<span class="ident" id="2067114"><a href="/gostd/math/big/nat.go.html#2066598">x1</a></span><span class="op" id="2067116">,</span>&nbsp;<span class="ident" id="2067118"><a href="/gostd/math/big/nat.go.html#2066642">y1</a></span><span class="op" id="2067120">)</span>&nbsp;<span class="comment" id="2067122">//&nbsp;z2&nbsp;=&nbsp;x1*y1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067138">//&nbsp;compute&nbsp;xd&nbsp;(or&nbsp;the&nbsp;negative&nbsp;value&nbsp;if&nbsp;underflow&nbsp;occurs)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067197">s</span>&nbsp;<span class="op" id="2067199">:=</span>&nbsp;<span class="num" id="2067202">1</span>&nbsp;<span class="comment" id="2067204">//&nbsp;sign&nbsp;of&nbsp;product&nbsp;xd*yd</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067230">xd</span>&nbsp;<span class="op" id="2067233">:=</span>&nbsp;<span class="ident" id="2067236"><a href="/gostd/math/big/nat.go.html#2065591">z</a></span><span class="op" id="2067237">[</span><span class="num" id="2067238">2</span><span class="op" id="2067239">*</span><span class="ident" id="2067240"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span>&nbsp;<span class="op" id="2067242">:</span>&nbsp;<span class="num" id="2067244">2</span><span class="op" id="2067245">*</span><span class="ident" id="2067246"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span><span class="op" id="2067247">+</span><span class="ident" id="2067248"><a href="/gostd/math/big/nat.go.html#2066560">n2</a></span><span class="op" id="2067250">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067253">if</span>&nbsp;<span class="ident" id="2067256"><a href="/gostd/math/big/arith_decl.go.html#2035207">subVV</a></span><span class="op" id="2067261">(</span><span class="ident" id="2067262"><a href="/gostd/math/big/nat.go.html#2067230">xd</a></span><span class="op" id="2067264">,</span>&nbsp;<span class="ident" id="2067266"><a href="/gostd/math/big/nat.go.html#2066598">x1</a></span><span class="op" id="2067268">,</span>&nbsp;<span class="ident" id="2067270"><a href="/gostd/math/big/nat.go.html#2066602">x0</a></span><span class="op" id="2067272">)</span>&nbsp;<span class="op" id="2067274">!=</span>&nbsp;<span class="num" id="2067277">0</span>&nbsp;<span class="op" id="2067279">{</span>&nbsp;<span class="comment" id="2067281">//&nbsp;x1-x0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067292"><a href="/gostd/math/big/nat.go.html#2067197">s</a></span>&nbsp;<span class="op" id="2067294">=</span>&nbsp;<span class="op" id="2067296">-</span><span class="ident" id="2067297"><a href="/gostd/math/big/nat.go.html#2067197">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067301"><a href="/gostd/math/big/arith_decl.go.html#2035207">subVV</a></span><span class="op" id="2067306">(</span><span class="ident" id="2067307"><a href="/gostd/math/big/nat.go.html#2067230">xd</a></span><span class="op" id="2067309">,</span>&nbsp;<span class="ident" id="2067311"><a href="/gostd/math/big/nat.go.html#2066602">x0</a></span><span class="op" id="2067313">,</span>&nbsp;<span class="ident" id="2067315"><a href="/gostd/math/big/nat.go.html#2066598">x1</a></span><span class="op" id="2067317">)</span>&nbsp;<span class="comment" id="2067319">//&nbsp;x0-x1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067329">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067333">//&nbsp;compute&nbsp;yd&nbsp;(or&nbsp;the&nbsp;negative&nbsp;value&nbsp;if&nbsp;underflow&nbsp;occurs)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067392">yd</span>&nbsp;<span class="op" id="2067395">:=</span>&nbsp;<span class="ident" id="2067398"><a href="/gostd/math/big/nat.go.html#2065591">z</a></span><span class="op" id="2067399">[</span><span class="num" id="2067400">2</span><span class="op" id="2067401">*</span><span class="ident" id="2067402"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span><span class="op" id="2067403">+</span><span class="ident" id="2067404"><a href="/gostd/math/big/nat.go.html#2066560">n2</a></span>&nbsp;<span class="op" id="2067407">:</span>&nbsp;<span class="num" id="2067409">3</span><span class="op" id="2067410">*</span><span class="ident" id="2067411"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span><span class="op" id="2067412">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067415">if</span>&nbsp;<span class="ident" id="2067418"><a href="/gostd/math/big/arith_decl.go.html#2035207">subVV</a></span><span class="op" id="2067423">(</span><span class="ident" id="2067424"><a href="/gostd/math/big/nat.go.html#2067392">yd</a></span><span class="op" id="2067426">,</span>&nbsp;<span class="ident" id="2067428"><a href="/gostd/math/big/nat.go.html#2066646">y0</a></span><span class="op" id="2067430">,</span>&nbsp;<span class="ident" id="2067432"><a href="/gostd/math/big/nat.go.html#2066642">y1</a></span><span class="op" id="2067434">)</span>&nbsp;<span class="op" id="2067436">!=</span>&nbsp;<span class="num" id="2067439">0</span>&nbsp;<span class="op" id="2067441">{</span>&nbsp;<span class="comment" id="2067443">//&nbsp;y0-y1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067454"><a href="/gostd/math/big/nat.go.html#2067197">s</a></span>&nbsp;<span class="op" id="2067456">=</span>&nbsp;<span class="op" id="2067458">-</span><span class="ident" id="2067459"><a href="/gostd/math/big/nat.go.html#2067197">s</a></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067463"><a href="/gostd/math/big/arith_decl.go.html#2035207">subVV</a></span><span class="op" id="2067468">(</span><span class="ident" id="2067469"><a href="/gostd/math/big/nat.go.html#2067392">yd</a></span><span class="op" id="2067471">,</span>&nbsp;<span class="ident" id="2067473"><a href="/gostd/math/big/nat.go.html#2066642">y1</a></span><span class="op" id="2067475">,</span>&nbsp;<span class="ident" id="2067477"><a href="/gostd/math/big/nat.go.html#2066646">y0</a></span><span class="op" id="2067479">)</span>&nbsp;<span class="comment" id="2067481">//&nbsp;y1-y0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067495">//&nbsp;p&nbsp;=&nbsp;(x1-x0)*(y0-y1)&nbsp;==&nbsp;x1*y0&nbsp;-&nbsp;x1*y1&nbsp;-&nbsp;x0*y0&nbsp;+&nbsp;x0*y1&nbsp;for&nbsp;s&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067562">//&nbsp;p&nbsp;=&nbsp;(x0-x1)*(y0-y1)&nbsp;==&nbsp;x0*y0&nbsp;-&nbsp;x0*y1&nbsp;-&nbsp;x1*y0&nbsp;+&nbsp;x1*y1&nbsp;for&nbsp;s&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067629">p</span>&nbsp;<span class="op" id="2067631">:=</span>&nbsp;<span class="ident" id="2067634"><a href="/gostd/math/big/nat.go.html#2065591">z</a></span><span class="op" id="2067635">[</span><span class="ident" id="2067636"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span><span class="op" id="2067637">*</span><span class="num" id="2067638">3</span><span class="op" id="2067639">:</span><span class="op" id="2067640">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067643"><a href="/gostd/math/big/nat.go.html#2065581">karatsuba</a></span><span class="op" id="2067652">(</span><span class="ident" id="2067653"><a href="/gostd/math/big/nat.go.html#2067629">p</a></span><span class="op" id="2067654">,</span>&nbsp;<span class="ident" id="2067656"><a href="/gostd/math/big/nat.go.html#2067230">xd</a></span><span class="op" id="2067658">,</span>&nbsp;<span class="ident" id="2067660"><a href="/gostd/math/big/nat.go.html#2067392">yd</a></span><span class="op" id="2067662">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067666">//&nbsp;save&nbsp;original&nbsp;z2:z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067690">//&nbsp;(ok&nbsp;to&nbsp;use&nbsp;upper&nbsp;half&nbsp;of&nbsp;z&nbsp;since&nbsp;we&#39;re&nbsp;done&nbsp;recursing)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067749">r</span>&nbsp;<span class="op" id="2067751">:=</span>&nbsp;<span class="ident" id="2067754"><a href="/gostd/math/big/nat.go.html#2065591">z</a></span><span class="op" id="2067755">[</span><span class="ident" id="2067756"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span><span class="op" id="2067757">*</span><span class="num" id="2067758">4</span><span class="op" id="2067759">:</span><span class="op" id="2067760">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2067763">copy</span><span class="op" id="2067767">(</span><span class="ident" id="2067768"><a href="/gostd/math/big/nat.go.html#2067749">r</a></span><span class="op" id="2067769">,</span>&nbsp;<span class="ident" id="2067771"><a href="/gostd/math/big/nat.go.html#2065591">z</a></span><span class="op" id="2067772">[</span><span class="op" id="2067773">:</span><span class="ident" id="2067774"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span><span class="op" id="2067775">*</span><span class="num" id="2067776">2</span><span class="op" id="2067777">]</span><span class="op" id="2067778">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067782">//&nbsp;add&nbsp;up&nbsp;all&nbsp;partial&nbsp;products</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067814">//</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067818">//&nbsp;&nbsp;&nbsp;2*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067840">//&nbsp;z&nbsp;=&nbsp;[&nbsp;z2&nbsp;&nbsp;|&nbsp;z0&nbsp;&nbsp;]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067862">//&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;z0&nbsp;&nbsp;]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067881">//&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;z2&nbsp;&nbsp;]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067900">//&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;&nbsp;p&nbsp;&nbsp;]</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067919">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067923"><a href="/gostd/math/big/nat.go.html#2064853">karatsubaAdd</a></span><span class="op" id="2067935">(</span><span class="ident" id="2067936"><a href="/gostd/math/big/nat.go.html#2065591">z</a></span><span class="op" id="2067937">[</span><span class="ident" id="2067938"><a href="/gostd/math/big/nat.go.html#2066560">n2</a></span><span class="op" id="2067940">:</span><span class="op" id="2067941">]</span><span class="op" id="2067942">,</span>&nbsp;<span class="ident" id="2067944"><a href="/gostd/math/big/nat.go.html#2067749">r</a></span><span class="op" id="2067945">,</span>&nbsp;<span class="ident" id="2067947"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span><span class="op" id="2067948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067951"><a href="/gostd/math/big/nat.go.html#2064853">karatsubaAdd</a></span><span class="op" id="2067963">(</span><span class="ident" id="2067964"><a href="/gostd/math/big/nat.go.html#2065591">z</a></span><span class="op" id="2067965">[</span><span class="ident" id="2067966"><a href="/gostd/math/big/nat.go.html#2066560">n2</a></span><span class="op" id="2067968">:</span><span class="op" id="2067969">]</span><span class="op" id="2067970">,</span>&nbsp;<span class="ident" id="2067972"><a href="/gostd/math/big/nat.go.html#2067749">r</a></span><span class="op" id="2067973">[</span><span class="ident" id="2067974"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span><span class="op" id="2067975">:</span><span class="op" id="2067976">]</span><span class="op" id="2067977">,</span>&nbsp;<span class="ident" id="2067979"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span><span class="op" id="2067980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067983">if</span>&nbsp;<span class="ident" id="2067986"><a href="/gostd/math/big/nat.go.html#2067197">s</a></span>&nbsp;<span class="op" id="2067988">&gt;</span>&nbsp;<span class="num" id="2067990">0</span>&nbsp;<span class="op" id="2067992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067996"><a href="/gostd/math/big/nat.go.html#2064853">karatsubaAdd</a></span><span class="op" id="2068008">(</span><span class="ident" id="2068009"><a href="/gostd/math/big/nat.go.html#2065591">z</a></span><span class="op" id="2068010">[</span><span class="ident" id="2068011"><a href="/gostd/math/big/nat.go.html#2066560">n2</a></span><span class="op" id="2068013">:</span><span class="op" id="2068014">]</span><span class="op" id="2068015">,</span>&nbsp;<span class="ident" id="2068017"><a href="/gostd/math/big/nat.go.html#2067629">p</a></span><span class="op" id="2068018">,</span>&nbsp;<span class="ident" id="2068020"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span><span class="op" id="2068021">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068024">}</span>&nbsp;<span class="keyword" id="2068026">else</span>&nbsp;<span class="op" id="2068031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068035"><a href="/gostd/math/big/nat.go.html#2065007">karatsubaSub</a></span><span class="op" id="2068047">(</span><span class="ident" id="2068048"><a href="/gostd/math/big/nat.go.html#2065591">z</a></span><span class="op" id="2068049">[</span><span class="ident" id="2068050"><a href="/gostd/math/big/nat.go.html#2066560">n2</a></span><span class="op" id="2068052">:</span><span class="op" id="2068053">]</span><span class="op" id="2068054">,</span>&nbsp;<span class="ident" id="2068056"><a href="/gostd/math/big/nat.go.html#2067629">p</a></span><span class="op" id="2068057">,</span>&nbsp;<span class="ident" id="2068059"><a href="/gostd/math/big/nat.go.html#2065607">n</a></span><span class="op" id="2068060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068063">}</span><br>
<span class="lineno"></span><span class="op" id="2068065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="2068068">//&nbsp;alias&nbsp;returns&nbsp;true&nbsp;if&nbsp;x&nbsp;and&nbsp;y&nbsp;share&nbsp;the&nbsp;same&nbsp;base&nbsp;array.</span><br>
<span class="lineno"></span><span class="keyword" id="2068128">func</span>&nbsp;<span class="ident" id="2068133">alias</span><span class="op" id="2068138">(</span><span class="ident" id="2068139">x</span><span class="op" id="2068140">,</span>&nbsp;<span class="ident" id="2068142">y</span>&nbsp;<span class="ident" id="2068144"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2068147">)</span>&nbsp;<span class="builtintype" id="2068149">bool</span>&nbsp;<span class="op" id="2068154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068157">return</span>&nbsp;<span class="builtinfunc" id="2068164">cap</span><span class="op" id="2068167">(</span><span class="ident" id="2068168"><a href="/gostd/math/big/nat.go.html#2068139">x</a></span><span class="op" id="2068169">)</span>&nbsp;<span class="op" id="2068171">&gt;</span>&nbsp;<span class="num" id="2068173">0</span>&nbsp;<span class="op" id="2068175">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2068178">cap</span><span class="op" id="2068181">(</span><span class="ident" id="2068182"><a href="/gostd/math/big/nat.go.html#2068142">y</a></span><span class="op" id="2068183">)</span>&nbsp;<span class="op" id="2068185">&gt;</span>&nbsp;<span class="num" id="2068187">0</span>&nbsp;<span class="op" id="2068189">&amp;&amp;</span>&nbsp;<span class="op" id="2068192">&amp;</span><span class="ident" id="2068193"><a href="/gostd/math/big/nat.go.html#2068139">x</a></span><span class="op" id="2068194">[</span><span class="num" id="2068195">0</span><span class="op" id="2068196">:</span><span class="builtinfunc" id="2068197">cap</span><span class="op" id="2068200">(</span><span class="ident" id="2068201"><a href="/gostd/math/big/nat.go.html#2068139">x</a></span><span class="op" id="2068202">)</span><span class="op" id="2068203">]</span><span class="op" id="2068204">[</span><span class="builtinfunc" id="2068205">cap</span><span class="op" id="2068208">(</span><span class="ident" id="2068209"><a href="/gostd/math/big/nat.go.html#2068139">x</a></span><span class="op" id="2068210">)</span><span class="op" id="2068211">-</span><span class="num" id="2068212">1</span><span class="op" id="2068213">]</span>&nbsp;<span class="op" id="2068215">==</span>&nbsp;<span class="op" id="2068218">&amp;</span><span class="ident" id="2068219"><a href="/gostd/math/big/nat.go.html#2068142">y</a></span><span class="op" id="2068220">[</span><span class="num" id="2068221">0</span><span class="op" id="2068222">:</span><span class="builtinfunc" id="2068223">cap</span><span class="op" id="2068226">(</span><span class="ident" id="2068227"><a href="/gostd/math/big/nat.go.html#2068142">y</a></span><span class="op" id="2068228">)</span><span class="op" id="2068229">]</span><span class="op" id="2068230">[</span><span class="builtinfunc" id="2068231">cap</span><span class="op" id="2068234">(</span><span class="ident" id="2068235"><a href="/gostd/math/big/nat.go.html#2068142">y</a></span><span class="op" id="2068236">)</span><span class="op" id="2068237">-</span><span class="num" id="2068238">1</span><span class="op" id="2068239">]</span><br>
<span class="lineno"></span><span class="op" id="2068241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="comment" id="2068244">//&nbsp;addAt&nbsp;implements&nbsp;z&nbsp;+=&nbsp;x&lt;&lt;(_W*i);&nbsp;z&nbsp;must&nbsp;be&nbsp;long&nbsp;enough.</span><br>
<span class="lineno"></span><span class="comment" id="2068303">//&nbsp;(we&nbsp;don&#39;t&nbsp;use&nbsp;nat.add&nbsp;because&nbsp;we&nbsp;need&nbsp;z&nbsp;to&nbsp;stay&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2068363">//&nbsp;slice,&nbsp;and&nbsp;we&nbsp;don&#39;t&nbsp;need&nbsp;to&nbsp;normalize&nbsp;z&nbsp;after&nbsp;each&nbsp;addition)</span><br>
<span class="lineno"></span><span class="keyword" id="2068427">func</span>&nbsp;<span class="ident" id="2068432">addAt</span><span class="op" id="2068437">(</span><span class="ident" id="2068438">z</span><span class="op" id="2068439">,</span>&nbsp;<span class="ident" id="2068441">x</span>&nbsp;<span class="ident" id="2068443"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2068446">,</span>&nbsp;<span class="ident" id="2068448">i</span>&nbsp;<span class="builtintype" id="2068450">int</span><span class="op" id="2068453">)</span>&nbsp;<span class="op" id="2068455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068458">if</span>&nbsp;<span class="ident" id="2068461">n</span>&nbsp;<span class="op" id="2068463">:=</span>&nbsp;<span class="builtinfunc" id="2068466">len</span><span class="op" id="2068469">(</span><span class="ident" id="2068470"><a href="/gostd/math/big/nat.go.html#2068441">x</a></span><span class="op" id="2068471">)</span><span class="op" id="2068472">;</span>&nbsp;<span class="ident" id="2068474"><a href="/gostd/math/big/nat.go.html#2068461">n</a></span>&nbsp;<span class="op" id="2068476">&gt;</span>&nbsp;<span class="num" id="2068478">0</span>&nbsp;<span class="op" id="2068480">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068484">if</span>&nbsp;<span class="ident" id="2068487">c</span>&nbsp;<span class="op" id="2068489">:=</span>&nbsp;<span class="ident" id="2068492"><a href="/gostd/math/big/arith_decl.go.html#2035171">addVV</a></span><span class="op" id="2068497">(</span><span class="ident" id="2068498"><a href="/gostd/math/big/nat.go.html#2068438">z</a></span><span class="op" id="2068499">[</span><span class="ident" id="2068500"><a href="/gostd/math/big/nat.go.html#2068448">i</a></span><span class="op" id="2068501">:</span><span class="ident" id="2068502"><a href="/gostd/math/big/nat.go.html#2068448">i</a></span><span class="op" id="2068503">+</span><span class="ident" id="2068504"><a href="/gostd/math/big/nat.go.html#2068461">n</a></span><span class="op" id="2068505">]</span><span class="op" id="2068506">,</span>&nbsp;<span class="ident" id="2068508"><a href="/gostd/math/big/nat.go.html#2068438">z</a></span><span class="op" id="2068509">[</span><span class="ident" id="2068510"><a href="/gostd/math/big/nat.go.html#2068448">i</a></span><span class="op" id="2068511">:</span><span class="op" id="2068512">]</span><span class="op" id="2068513">,</span>&nbsp;<span class="ident" id="2068515"><a href="/gostd/math/big/nat.go.html#2068441">x</a></span><span class="op" id="2068516">)</span><span class="op" id="2068517">;</span>&nbsp;<span class="ident" id="2068519"><a href="/gostd/math/big/nat.go.html#2068487">c</a></span>&nbsp;<span class="op" id="2068521">!=</span>&nbsp;<span class="num" id="2068524">0</span>&nbsp;<span class="op" id="2068526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068531">j</span>&nbsp;<span class="op" id="2068533">:=</span>&nbsp;<span class="ident" id="2068536"><a href="/gostd/math/big/nat.go.html#2068448">i</a></span>&nbsp;<span class="op" id="2068538">+</span>&nbsp;<span class="ident" id="2068540"><a href="/gostd/math/big/nat.go.html#2068461">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068545">if</span>&nbsp;<span class="ident" id="2068548"><a href="/gostd/math/big/nat.go.html#2068531">j</a></span>&nbsp;<span class="op" id="2068550">&lt;</span>&nbsp;<span class="builtinfunc" id="2068552">len</span><span class="op" id="2068555">(</span><span class="ident" id="2068556"><a href="/gostd/math/big/nat.go.html#2068438">z</a></span><span class="op" id="2068557">)</span>&nbsp;<span class="op" id="2068559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068565"><a href="/gostd/math/big/arith_decl.go.html#2035243">addVW</a></span><span class="op" id="2068570">(</span><span class="ident" id="2068571"><a href="/gostd/math/big/nat.go.html#2068438">z</a></span><span class="op" id="2068572">[</span><span class="ident" id="2068573"><a href="/gostd/math/big/nat.go.html#2068531">j</a></span><span class="op" id="2068574">:</span><span class="op" id="2068575">]</span><span class="op" id="2068576">,</span>&nbsp;<span class="ident" id="2068578"><a href="/gostd/math/big/nat.go.html#2068438">z</a></span><span class="op" id="2068579">[</span><span class="ident" id="2068580"><a href="/gostd/math/big/nat.go.html#2068531">j</a></span><span class="op" id="2068581">:</span><span class="op" id="2068582">]</span><span class="op" id="2068583">,</span>&nbsp;<span class="ident" id="2068585"><a href="/gostd/math/big/nat.go.html#2068487">c</a></span><span class="op" id="2068586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068591">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068598">}</span><br>
<span class="lineno"></span><span class="op" id="2068600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2068603">func</span>&nbsp;<span class="ident" id="2068608">max</span><span class="op" id="2068611">(</span><span class="ident" id="2068612">x</span><span class="op" id="2068613">,</span>&nbsp;<span class="ident" id="2068615">y</span>&nbsp;<span class="builtintype" id="2068617">int</span><span class="op" id="2068620">)</span>&nbsp;<span class="builtintype" id="2068622">int</span>&nbsp;<span class="op" id="2068626">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068629">if</span>&nbsp;<span class="ident" id="2068632"><a href="/gostd/math/big/nat.go.html#2068612">x</a></span>&nbsp;<span class="op" id="2068634">&gt;</span>&nbsp;<span class="ident" id="2068636"><a href="/gostd/math/big/nat.go.html#2068615">y</a></span>&nbsp;<span class="op" id="2068638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068642">return</span>&nbsp;<span class="ident" id="2068649"><a href="/gostd/math/big/nat.go.html#2068612">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068655">return</span>&nbsp;<span class="ident" id="2068662"><a href="/gostd/math/big/nat.go.html#2068615">y</a></span><br>
<span class="lineno"></span><span class="op" id="2068664">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="2068667">//&nbsp;karatsubaLen&nbsp;computes&nbsp;an&nbsp;approximation&nbsp;to&nbsp;the&nbsp;maximum&nbsp;k&nbsp;&lt;=&nbsp;n&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2068741">//&nbsp;k&nbsp;=&nbsp;p&lt;&lt;i&nbsp;for&nbsp;a&nbsp;number&nbsp;p&nbsp;&lt;=&nbsp;karatsubaThreshold&nbsp;and&nbsp;an&nbsp;i&nbsp;&gt;=&nbsp;0.&nbsp;Thus,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2068815">//&nbsp;result&nbsp;is&nbsp;the&nbsp;largest&nbsp;number&nbsp;that&nbsp;can&nbsp;be&nbsp;divided&nbsp;repeatedly&nbsp;by&nbsp;2&nbsp;before</span><br>
<span class="lineno"></span><span class="comment" id="2068890">//&nbsp;becoming&nbsp;about&nbsp;the&nbsp;value&nbsp;of&nbsp;karatsubaThreshold.</span><br>
<span class="lineno">370</span><span class="keyword" id="2068941">func</span>&nbsp;<span class="ident" id="2068946">karatsubaLen</span><span class="op" id="2068958">(</span><span class="ident" id="2068959">n</span>&nbsp;<span class="builtintype" id="2068961">int</span><span class="op" id="2068964">)</span>&nbsp;<span class="builtintype" id="2068966">int</span>&nbsp;<span class="op" id="2068970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068973">i</span>&nbsp;<span class="op" id="2068975">:=</span>&nbsp;<span class="builtintype" id="2068978">uint</span><span class="op" id="2068982">(</span><span class="num" id="2068983">0</span><span class="op" id="2068984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068987">for</span>&nbsp;<span class="ident" id="2068991"><a href="/gostd/math/big/nat.go.html#2068959">n</a></span>&nbsp;<span class="op" id="2068993">&gt;</span>&nbsp;<span class="ident" id="2068995"><a href="/gostd/math/big/nat.go.html#2065283">karatsubaThreshold</a></span>&nbsp;<span class="op" id="2069014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069018"><a href="/gostd/math/big/nat.go.html#2068959">n</a></span>&nbsp;<span class="op" id="2069020">&gt;&gt;=</span>&nbsp;<span class="num" id="2069024">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069028"><a href="/gostd/math/big/nat.go.html#2068973">i</a></span><span class="op" id="2069029">++</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069036">return</span>&nbsp;<span class="ident" id="2069043"><a href="/gostd/math/big/nat.go.html#2068959">n</a></span>&nbsp;<span class="op" id="2069045">&lt;&lt;</span>&nbsp;<span class="ident" id="2069048"><a href="/gostd/math/big/nat.go.html#2068973">i</a></span><br>
<span class="lineno"></span><span class="op" id="2069050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2069053">func</span>&nbsp;<span class="op" id="2069058">(</span><span class="ident" id="2069059">z</span>&nbsp;<span class="ident" id="2069061"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2069064">)</span>&nbsp;<span class="ident" id="2069066">mul</span><span class="op" id="2069069">(</span><span class="ident" id="2069070">x</span><span class="op" id="2069071">,</span>&nbsp;<span class="ident" id="2069073">y</span>&nbsp;<span class="ident" id="2069075"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2069078">)</span>&nbsp;<span class="ident" id="2069080"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2069084">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069087">m</span>&nbsp;<span class="op" id="2069089">:=</span>&nbsp;<span class="builtinfunc" id="2069092">len</span><span class="op" id="2069095">(</span><span class="ident" id="2069096"><a href="/gostd/math/big/nat.go.html#2069070">x</a></span><span class="op" id="2069097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069100">n</span>&nbsp;<span class="op" id="2069102">:=</span>&nbsp;<span class="builtinfunc" id="2069105">len</span><span class="op" id="2069108">(</span><span class="ident" id="2069109"><a href="/gostd/math/big/nat.go.html#2069073">y</a></span><span class="op" id="2069110">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069114">switch</span>&nbsp;<span class="op" id="2069121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069124">case</span>&nbsp;<span class="ident" id="2069129"><a href="/gostd/math/big/nat.go.html#2069087">m</a></span>&nbsp;<span class="op" id="2069131">&lt;</span>&nbsp;<span class="ident" id="2069133"><a href="/gostd/math/big/nat.go.html#2069100">n</a></span><span class="op" id="2069134">:</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069138">return</span>&nbsp;<span class="ident" id="2069145"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span><span class="op" id="2069146">.</span><span class="ident" id="2069147"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2069150">(</span><span class="ident" id="2069151"><a href="/gostd/math/big/nat.go.html#2069073">y</a></span><span class="op" id="2069152">,</span>&nbsp;<span class="ident" id="2069154"><a href="/gostd/math/big/nat.go.html#2069070">x</a></span><span class="op" id="2069155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069158">case</span>&nbsp;<span class="ident" id="2069163"><a href="/gostd/math/big/nat.go.html#2069087">m</a></span>&nbsp;<span class="op" id="2069165">==</span>&nbsp;<span class="num" id="2069168">0</span>&nbsp;<span class="op" id="2069170">||</span>&nbsp;<span class="ident" id="2069173"><a href="/gostd/math/big/nat.go.html#2069100">n</a></span>&nbsp;<span class="op" id="2069175">==</span>&nbsp;<span class="num" id="2069178">0</span><span class="op" id="2069179">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069183">return</span>&nbsp;<span class="ident" id="2069190"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span><span class="op" id="2069191">.</span><span class="builtinfunc" id="2069192"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2069196">(</span><span class="num" id="2069197">0</span><span class="op" id="2069198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069201">case</span>&nbsp;<span class="ident" id="2069206"><a href="/gostd/math/big/nat.go.html#2069100">n</a></span>&nbsp;<span class="op" id="2069208">==</span>&nbsp;<span class="num" id="2069211">1</span><span class="op" id="2069212">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069216">return</span>&nbsp;<span class="ident" id="2069223"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span><span class="op" id="2069224">.</span><span class="ident" id="2069225"><a href="/gostd/math/big/nat.go.html#2064217">mulAddWW</a></span><span class="op" id="2069233">(</span><span class="ident" id="2069234"><a href="/gostd/math/big/nat.go.html#2069070">x</a></span><span class="op" id="2069235">,</span>&nbsp;<span class="ident" id="2069237"><a href="/gostd/math/big/nat.go.html#2069073">y</a></span><span class="op" id="2069238">[</span><span class="num" id="2069239">0</span><span class="op" id="2069240">]</span><span class="op" id="2069241">,</span>&nbsp;<span class="num" id="2069243">0</span><span class="op" id="2069244">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069250">//&nbsp;m&nbsp;&gt;=&nbsp;n&nbsp;&gt;&nbsp;1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069266">//&nbsp;determine&nbsp;if&nbsp;z&nbsp;can&nbsp;be&nbsp;reused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069299">if</span>&nbsp;<span class="ident" id="2069302"><a href="/gostd/math/big/nat.go.html#2068133">alias</a></span><span class="op" id="2069307">(</span><span class="ident" id="2069308"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span><span class="op" id="2069309">,</span>&nbsp;<span class="ident" id="2069311"><a href="/gostd/math/big/nat.go.html#2069070">x</a></span><span class="op" id="2069312">)</span>&nbsp;<span class="op" id="2069314">||</span>&nbsp;<span class="ident" id="2069317"><a href="/gostd/math/big/nat.go.html#2068133">alias</a></span><span class="op" id="2069322">(</span><span class="ident" id="2069323"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span><span class="op" id="2069324">,</span>&nbsp;<span class="ident" id="2069326"><a href="/gostd/math/big/nat.go.html#2069073">y</a></span><span class="op" id="2069327">)</span>&nbsp;<span class="op" id="2069329">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069333"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span>&nbsp;<span class="op" id="2069335">=</span>&nbsp;<span class="builtintype" id="2069337">nil</span>&nbsp;<span class="comment" id="2069341">//&nbsp;z&nbsp;is&nbsp;an&nbsp;alias&nbsp;for&nbsp;x&nbsp;or&nbsp;y&nbsp;-&nbsp;cannot&nbsp;reuse</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069389">//&nbsp;use&nbsp;basic&nbsp;multiplication&nbsp;if&nbsp;the&nbsp;numbers&nbsp;are&nbsp;small</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069443">if</span>&nbsp;<span class="ident" id="2069446"><a href="/gostd/math/big/nat.go.html#2069100">n</a></span>&nbsp;<span class="op" id="2069448">&lt;</span>&nbsp;<span class="ident" id="2069450"><a href="/gostd/math/big/nat.go.html#2065283">karatsubaThreshold</a></span>&nbsp;<span class="op" id="2069469">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069473"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span>&nbsp;<span class="op" id="2069475">=</span>&nbsp;<span class="ident" id="2069477"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span><span class="op" id="2069478">.</span><span class="builtinfunc" id="2069479"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2069483">(</span><span class="ident" id="2069484"><a href="/gostd/math/big/nat.go.html#2069087">m</a></span>&nbsp;<span class="op" id="2069486">+</span>&nbsp;<span class="ident" id="2069488"><a href="/gostd/math/big/nat.go.html#2069100">n</a></span><span class="op" id="2069489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069493"><a href="/gostd/math/big/nat.go.html#2064544">basicMul</a></span><span class="op" id="2069501">(</span><span class="ident" id="2069502"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span><span class="op" id="2069503">,</span>&nbsp;<span class="ident" id="2069505"><a href="/gostd/math/big/nat.go.html#2069070">x</a></span><span class="op" id="2069506">,</span>&nbsp;<span class="ident" id="2069508"><a href="/gostd/math/big/nat.go.html#2069073">y</a></span><span class="op" id="2069509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069513">return</span>&nbsp;<span class="ident" id="2069520"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span><span class="op" id="2069521">.</span><span class="ident" id="2069522"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2069526">(</span><span class="op" id="2069527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069533">//&nbsp;m&nbsp;&gt;=&nbsp;n&nbsp;&amp;&amp;&nbsp;n&nbsp;&gt;=&nbsp;karatsubaThreshold&nbsp;&amp;&amp;&nbsp;n&nbsp;&gt;=&nbsp;2</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069582">//&nbsp;determine&nbsp;Karatsuba&nbsp;length&nbsp;k&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069625">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069629">//&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;xh*b&nbsp;+&nbsp;x0&nbsp;&nbsp;(0&nbsp;&lt;=&nbsp;x0&nbsp;&lt;&nbsp;b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069664">//&nbsp;&nbsp;&nbsp;y&nbsp;=&nbsp;yh*b&nbsp;+&nbsp;y0&nbsp;&nbsp;(0&nbsp;&lt;=&nbsp;y0&nbsp;&lt;&nbsp;b)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069699">//&nbsp;&nbsp;&nbsp;b&nbsp;=&nbsp;1&lt;&lt;(_W*k)&nbsp;&nbsp;(&#34;base&#34;&nbsp;of&nbsp;digits&nbsp;xi,&nbsp;yi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069746">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069750">k</span>&nbsp;<span class="op" id="2069752">:=</span>&nbsp;<span class="ident" id="2069755"><a href="/gostd/math/big/nat.go.html#2068946">karatsubaLen</a></span><span class="op" id="2069767">(</span><span class="ident" id="2069768"><a href="/gostd/math/big/nat.go.html#2069100">n</a></span><span class="op" id="2069769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069772">//&nbsp;k&nbsp;&lt;=&nbsp;n</span><br>
<span class="lineno"></span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069784">//&nbsp;multiply&nbsp;x0&nbsp;and&nbsp;y0&nbsp;via&nbsp;Karatsuba</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069821">x0</span>&nbsp;<span class="op" id="2069824">:=</span>&nbsp;<span class="ident" id="2069827"><a href="/gostd/math/big/nat.go.html#2069070">x</a></span><span class="op" id="2069828">[</span><span class="num" id="2069829">0</span><span class="op" id="2069830">:</span><span class="ident" id="2069831"><a href="/gostd/math/big/nat.go.html#2069750">k</a></span><span class="op" id="2069832">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069847">//&nbsp;x0&nbsp;is&nbsp;not&nbsp;normalized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069872">y0</span>&nbsp;<span class="op" id="2069875">:=</span>&nbsp;<span class="ident" id="2069878"><a href="/gostd/math/big/nat.go.html#2069073">y</a></span><span class="op" id="2069879">[</span><span class="num" id="2069880">0</span><span class="op" id="2069881">:</span><span class="ident" id="2069882"><a href="/gostd/math/big/nat.go.html#2069750">k</a></span><span class="op" id="2069883">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069898">//&nbsp;y0&nbsp;is&nbsp;not&nbsp;normalized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069923"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span>&nbsp;<span class="op" id="2069925">=</span>&nbsp;<span class="ident" id="2069927"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span><span class="op" id="2069928">.</span><span class="builtinfunc" id="2069929"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2069933">(</span><span class="ident" id="2069934"><a href="/gostd/math/big/nat.go.html#2068608">max</a></span><span class="op" id="2069937">(</span><span class="num" id="2069938">6</span><span class="op" id="2069939">*</span><span class="ident" id="2069940"><a href="/gostd/math/big/nat.go.html#2069750">k</a></span><span class="op" id="2069941">,</span>&nbsp;<span class="ident" id="2069943"><a href="/gostd/math/big/nat.go.html#2069087">m</a></span><span class="op" id="2069944">+</span><span class="ident" id="2069945"><a href="/gostd/math/big/nat.go.html#2069100">n</a></span><span class="op" id="2069946">)</span><span class="op" id="2069947">)</span>&nbsp;<span class="comment" id="2069949">//&nbsp;enough&nbsp;space&nbsp;for&nbsp;karatsuba&nbsp;of&nbsp;x0*y0&nbsp;and&nbsp;full&nbsp;result&nbsp;of&nbsp;x*y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070012"><a href="/gostd/math/big/nat.go.html#2065581">karatsuba</a></span><span class="op" id="2070021">(</span><span class="ident" id="2070022"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span><span class="op" id="2070023">,</span>&nbsp;<span class="ident" id="2070025"><a href="/gostd/math/big/nat.go.html#2069821">x0</a></span><span class="op" id="2070027">,</span>&nbsp;<span class="ident" id="2070029"><a href="/gostd/math/big/nat.go.html#2069872">y0</a></span><span class="op" id="2070031">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070034"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span>&nbsp;<span class="op" id="2070036">=</span>&nbsp;<span class="ident" id="2070038"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span><span class="op" id="2070039">[</span><span class="num" id="2070040">0</span>&nbsp;<span class="op" id="2070042">:</span>&nbsp;<span class="ident" id="2070044"><a href="/gostd/math/big/nat.go.html#2069087">m</a></span><span class="op" id="2070045">+</span><span class="ident" id="2070046"><a href="/gostd/math/big/nat.go.html#2069100">n</a></span><span class="op" id="2070047">]</span>&nbsp;&nbsp;<span class="comment" id="2070050">//&nbsp;z&nbsp;has&nbsp;final&nbsp;length&nbsp;but&nbsp;may&nbsp;be&nbsp;incomplete</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070095"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span><span class="op" id="2070096">[</span><span class="num" id="2070097">2</span><span class="op" id="2070098">*</span><span class="ident" id="2070099"><a href="/gostd/math/big/nat.go.html#2069750">k</a></span><span class="op" id="2070100">:</span><span class="op" id="2070101">]</span><span class="op" id="2070102">.</span><span class="ident" id="2070103"><a href="/gostd/math/big/nat.go.html#2062241">clear</a></span><span class="op" id="2070108">(</span><span class="op" id="2070109">)</span>&nbsp;<span class="comment" id="2070111">//&nbsp;upper&nbsp;portion&nbsp;of&nbsp;z&nbsp;is&nbsp;garbage&nbsp;(and&nbsp;2*k&nbsp;&lt;=&nbsp;m+n&nbsp;since&nbsp;k&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;m)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070181">//&nbsp;If&nbsp;xh&nbsp;!=&nbsp;0&nbsp;or&nbsp;yh&nbsp;!=&nbsp;0,&nbsp;add&nbsp;the&nbsp;missing&nbsp;terms&nbsp;to&nbsp;z.&nbsp;For</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070240">//</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070244">//&nbsp;&nbsp;&nbsp;xh&nbsp;=&nbsp;xi*b^i&nbsp;+&nbsp;...&nbsp;+&nbsp;x2*b^2&nbsp;+&nbsp;x1*b&nbsp;(0&nbsp;&lt;=&nbsp;xi&nbsp;&lt;&nbsp;b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070298">//&nbsp;&nbsp;&nbsp;yh&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y1*b&nbsp;(0&nbsp;&lt;=&nbsp;y1&nbsp;&lt;&nbsp;b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070352">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070356">//&nbsp;the&nbsp;missing&nbsp;terms&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070382">//</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070386">//&nbsp;&nbsp;&nbsp;x0*y1*b&nbsp;and&nbsp;xi*y0*b^i,&nbsp;xi*y1*b^(i+1)&nbsp;for&nbsp;i&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070439">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070443">//&nbsp;since&nbsp;all&nbsp;the&nbsp;yi&nbsp;for&nbsp;i&nbsp;&gt;&nbsp;1&nbsp;are&nbsp;0&nbsp;by&nbsp;choice&nbsp;of&nbsp;k:&nbsp;If&nbsp;any&nbsp;of&nbsp;them</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070511">//&nbsp;were&nbsp;&gt;&nbsp;0,&nbsp;then&nbsp;yh&nbsp;&gt;=&nbsp;b^2&nbsp;and&nbsp;thus&nbsp;y&nbsp;&gt;=&nbsp;b^2.&nbsp;Then&nbsp;k&#39;&nbsp;=&nbsp;k*2&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070579">//&nbsp;be&nbsp;a&nbsp;larger&nbsp;valid&nbsp;threshold&nbsp;contradicting&nbsp;the&nbsp;assumption&nbsp;about&nbsp;k.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070649">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070653">if</span>&nbsp;<span class="ident" id="2070656"><a href="/gostd/math/big/nat.go.html#2069750">k</a></span>&nbsp;<span class="op" id="2070658">&lt;</span>&nbsp;<span class="ident" id="2070660"><a href="/gostd/math/big/nat.go.html#2069100">n</a></span>&nbsp;<span class="op" id="2070662">||</span>&nbsp;<span class="ident" id="2070665"><a href="/gostd/math/big/nat.go.html#2069087">m</a></span>&nbsp;<span class="op" id="2070667">!=</span>&nbsp;<span class="ident" id="2070670"><a href="/gostd/math/big/nat.go.html#2069100">n</a></span>&nbsp;<span class="op" id="2070672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070676">var</span>&nbsp;<span class="ident" id="2070680">t</span>&nbsp;<span class="ident" id="2070682"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070689">//&nbsp;add&nbsp;x0*y1*b</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070706">x0</span>&nbsp;<span class="op" id="2070709">:=</span>&nbsp;<span class="ident" id="2070712"><a href="/gostd/math/big/nat.go.html#2069821">x0</a></span><span class="op" id="2070714">.</span><span class="ident" id="2070715"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2070719">(</span><span class="op" id="2070720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070724">y1</span>&nbsp;<span class="op" id="2070727">:=</span>&nbsp;<span class="ident" id="2070730"><a href="/gostd/math/big/nat.go.html#2069073">y</a></span><span class="op" id="2070731">[</span><span class="ident" id="2070732"><a href="/gostd/math/big/nat.go.html#2069750">k</a></span><span class="op" id="2070733">:</span><span class="op" id="2070734">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070742">//&nbsp;y1&nbsp;is&nbsp;normalized&nbsp;because&nbsp;y&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070777"><a href="/gostd/math/big/nat.go.html#2070680">t</a></span>&nbsp;<span class="op" id="2070779">=</span>&nbsp;<span class="ident" id="2070781"><a href="/gostd/math/big/nat.go.html#2070680">t</a></span><span class="op" id="2070782">.</span><span class="ident" id="2070783"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2070786">(</span><span class="ident" id="2070787"><a href="/gostd/math/big/nat.go.html#2070706">x0</a></span><span class="op" id="2070789">,</span>&nbsp;<span class="ident" id="2070791"><a href="/gostd/math/big/nat.go.html#2070724">y1</a></span><span class="op" id="2070793">)</span>&nbsp;<span class="comment" id="2070795">//&nbsp;update&nbsp;t&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;t&#39;s&nbsp;underlying&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070847"><a href="/gostd/math/big/nat.go.html#2068432">addAt</a></span><span class="op" id="2070852">(</span><span class="ident" id="2070853"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span><span class="op" id="2070854">,</span>&nbsp;<span class="ident" id="2070856"><a href="/gostd/math/big/nat.go.html#2070680">t</a></span><span class="op" id="2070857">,</span>&nbsp;<span class="ident" id="2070859"><a href="/gostd/math/big/nat.go.html#2069750">k</a></span><span class="op" id="2070860">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070865">//&nbsp;add&nbsp;xi*y0&lt;&lt;i,&nbsp;xi*y1*b&lt;&lt;(i+k)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070899">y0</span>&nbsp;<span class="op" id="2070902">:=</span>&nbsp;<span class="ident" id="2070905"><a href="/gostd/math/big/nat.go.html#2069872">y0</a></span><span class="op" id="2070907">.</span><span class="ident" id="2070908"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2070912">(</span><span class="op" id="2070913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070917">for</span>&nbsp;<span class="ident" id="2070921">i</span>&nbsp;<span class="op" id="2070923">:=</span>&nbsp;<span class="ident" id="2070926"><a href="/gostd/math/big/nat.go.html#2069750">k</a></span><span class="op" id="2070927">;</span>&nbsp;<span class="ident" id="2070929"><a href="/gostd/math/big/nat.go.html#2070921">i</a></span>&nbsp;<span class="op" id="2070931">&lt;</span>&nbsp;<span class="builtinfunc" id="2070933">len</span><span class="op" id="2070936">(</span><span class="ident" id="2070937"><a href="/gostd/math/big/nat.go.html#2069070">x</a></span><span class="op" id="2070938">)</span><span class="op" id="2070939">;</span>&nbsp;<span class="ident" id="2070941"><a href="/gostd/math/big/nat.go.html#2070921">i</a></span>&nbsp;<span class="op" id="2070943">+=</span>&nbsp;<span class="ident" id="2070946"><a href="/gostd/math/big/nat.go.html#2069750">k</a></span>&nbsp;<span class="op" id="2070948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070953">xi</span>&nbsp;<span class="op" id="2070956">:=</span>&nbsp;<span class="ident" id="2070959"><a href="/gostd/math/big/nat.go.html#2069070">x</a></span><span class="op" id="2070960">[</span><span class="ident" id="2070961"><a href="/gostd/math/big/nat.go.html#2070921">i</a></span><span class="op" id="2070962">:</span><span class="op" id="2070963">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070968">if</span>&nbsp;<span class="builtinfunc" id="2070971">len</span><span class="op" id="2070974">(</span><span class="ident" id="2070975"><a href="/gostd/math/big/nat.go.html#2070953">xi</a></span><span class="op" id="2070977">)</span>&nbsp;<span class="op" id="2070979">&gt;</span>&nbsp;<span class="ident" id="2070981"><a href="/gostd/math/big/nat.go.html#2069750">k</a></span>&nbsp;<span class="op" id="2070983">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070989"><a href="/gostd/math/big/nat.go.html#2070953">xi</a></span>&nbsp;<span class="op" id="2070992">=</span>&nbsp;<span class="ident" id="2070994"><a href="/gostd/math/big/nat.go.html#2070953">xi</a></span><span class="op" id="2070996">[</span><span class="op" id="2070997">:</span><span class="ident" id="2070998"><a href="/gostd/math/big/nat.go.html#2069750">k</a></span><span class="op" id="2070999">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2071004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071009"><a href="/gostd/math/big/nat.go.html#2070953">xi</a></span>&nbsp;<span class="op" id="2071012">=</span>&nbsp;<span class="ident" id="2071014"><a href="/gostd/math/big/nat.go.html#2070953">xi</a></span><span class="op" id="2071016">.</span><span class="ident" id="2071017"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2071021">(</span><span class="op" id="2071022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071027"><a href="/gostd/math/big/nat.go.html#2070680">t</a></span>&nbsp;<span class="op" id="2071029">=</span>&nbsp;<span class="ident" id="2071031"><a href="/gostd/math/big/nat.go.html#2070680">t</a></span><span class="op" id="2071032">.</span><span class="ident" id="2071033"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2071036">(</span><span class="ident" id="2071037"><a href="/gostd/math/big/nat.go.html#2070953">xi</a></span><span class="op" id="2071039">,</span>&nbsp;<span class="ident" id="2071041"><a href="/gostd/math/big/nat.go.html#2070899">y0</a></span><span class="op" id="2071043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071048"><a href="/gostd/math/big/nat.go.html#2068432">addAt</a></span><span class="op" id="2071053">(</span><span class="ident" id="2071054"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span><span class="op" id="2071055">,</span>&nbsp;<span class="ident" id="2071057"><a href="/gostd/math/big/nat.go.html#2070680">t</a></span><span class="op" id="2071058">,</span>&nbsp;<span class="ident" id="2071060"><a href="/gostd/math/big/nat.go.html#2070921">i</a></span><span class="op" id="2071061">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071066"><a href="/gostd/math/big/nat.go.html#2070680">t</a></span>&nbsp;<span class="op" id="2071068">=</span>&nbsp;<span class="ident" id="2071070"><a href="/gostd/math/big/nat.go.html#2070680">t</a></span><span class="op" id="2071071">.</span><span class="ident" id="2071072"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2071075">(</span><span class="ident" id="2071076"><a href="/gostd/math/big/nat.go.html#2070953">xi</a></span><span class="op" id="2071078">,</span>&nbsp;<span class="ident" id="2071080"><a href="/gostd/math/big/nat.go.html#2070724">y1</a></span><span class="op" id="2071082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071087"><a href="/gostd/math/big/nat.go.html#2068432">addAt</a></span><span class="op" id="2071092">(</span><span class="ident" id="2071093"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span><span class="op" id="2071094">,</span>&nbsp;<span class="ident" id="2071096"><a href="/gostd/math/big/nat.go.html#2070680">t</a></span><span class="op" id="2071097">,</span>&nbsp;<span class="ident" id="2071099"><a href="/gostd/math/big/nat.go.html#2070921">i</a></span><span class="op" id="2071100">+</span><span class="ident" id="2071101"><a href="/gostd/math/big/nat.go.html#2069750">k</a></span><span class="op" id="2071102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2071106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2071109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071113">return</span>&nbsp;<span class="ident" id="2071120"><a href="/gostd/math/big/nat.go.html#2069059">z</a></span><span class="op" id="2071121">.</span><span class="ident" id="2071122"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2071126">(</span><span class="op" id="2071127">)</span><br>
<span class="lineno"></span><span class="op" id="2071129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2071132">//&nbsp;mulRange&nbsp;computes&nbsp;the&nbsp;product&nbsp;of&nbsp;all&nbsp;the&nbsp;unsigned&nbsp;integers&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2071201">//&nbsp;range&nbsp;[a,&nbsp;b]&nbsp;inclusively.&nbsp;If&nbsp;a&nbsp;&gt;&nbsp;b&nbsp;(empty&nbsp;range),&nbsp;the&nbsp;result&nbsp;is&nbsp;1.</span><br>
<span class="lineno">465</span><span class="keyword" id="2071271">func</span>&nbsp;<span class="op" id="2071276">(</span><span class="ident" id="2071277">z</span>&nbsp;<span class="ident" id="2071279"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2071282">)</span>&nbsp;<span class="ident" id="2071284">mulRange</span><span class="op" id="2071292">(</span><span class="ident" id="2071293">a</span><span class="op" id="2071294">,</span>&nbsp;<span class="ident" id="2071296">b</span>&nbsp;<span class="builtintype" id="2071298">uint64</span><span class="op" id="2071304">)</span>&nbsp;<span class="ident" id="2071306"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2071310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071313">switch</span>&nbsp;<span class="op" id="2071320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071323">case</span>&nbsp;<span class="ident" id="2071328"><a href="/gostd/math/big/nat.go.html#2071293">a</a></span>&nbsp;<span class="op" id="2071330">==</span>&nbsp;<span class="num" id="2071333">0</span><span class="op" id="2071334">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2071338">//&nbsp;cut&nbsp;long&nbsp;ranges&nbsp;short&nbsp;(optimization)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071380">return</span>&nbsp;<span class="ident" id="2071387"><a href="/gostd/math/big/nat.go.html#2071277">z</a></span><span class="op" id="2071388">.</span><span class="ident" id="2071389"><a href="/gostd/math/big/nat.go.html#2062773">setUint64</a></span><span class="op" id="2071398">(</span><span class="num" id="2071399">0</span><span class="op" id="2071400">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071403">case</span>&nbsp;<span class="ident" id="2071408"><a href="/gostd/math/big/nat.go.html#2071293">a</a></span>&nbsp;<span class="op" id="2071410">&gt;</span>&nbsp;<span class="ident" id="2071412"><a href="/gostd/math/big/nat.go.html#2071296">b</a></span><span class="op" id="2071413">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071417">return</span>&nbsp;<span class="ident" id="2071424"><a href="/gostd/math/big/nat.go.html#2071277">z</a></span><span class="op" id="2071425">.</span><span class="ident" id="2071426"><a href="/gostd/math/big/nat.go.html#2062773">setUint64</a></span><span class="op" id="2071435">(</span><span class="num" id="2071436">1</span><span class="op" id="2071437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071440">case</span>&nbsp;<span class="ident" id="2071445"><a href="/gostd/math/big/nat.go.html#2071293">a</a></span>&nbsp;<span class="op" id="2071447">==</span>&nbsp;<span class="ident" id="2071450"><a href="/gostd/math/big/nat.go.html#2071296">b</a></span><span class="op" id="2071451">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071455">return</span>&nbsp;<span class="ident" id="2071462"><a href="/gostd/math/big/nat.go.html#2071277">z</a></span><span class="op" id="2071463">.</span><span class="ident" id="2071464"><a href="/gostd/math/big/nat.go.html#2062773">setUint64</a></span><span class="op" id="2071473">(</span><span class="ident" id="2071474"><a href="/gostd/math/big/nat.go.html#2071293">a</a></span><span class="op" id="2071475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071478">case</span>&nbsp;<span class="ident" id="2071483"><a href="/gostd/math/big/nat.go.html#2071293">a</a></span><span class="op" id="2071484">+</span><span class="num" id="2071485">1</span>&nbsp;<span class="op" id="2071487">==</span>&nbsp;<span class="ident" id="2071490"><a href="/gostd/math/big/nat.go.html#2071296">b</a></span><span class="op" id="2071491">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071495">return</span>&nbsp;<span class="ident" id="2071502"><a href="/gostd/math/big/nat.go.html#2071277">z</a></span><span class="op" id="2071503">.</span><span class="ident" id="2071504"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2071507">(</span><span class="ident" id="2071508"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2071511">(</span><span class="builtintype" id="2071512">nil</span><span class="op" id="2071515">)</span><span class="op" id="2071516">.</span><span class="ident" id="2071517"><a href="/gostd/math/big/nat.go.html#2062773">setUint64</a></span><span class="op" id="2071526">(</span><span class="ident" id="2071527"><a href="/gostd/math/big/nat.go.html#2071293">a</a></span><span class="op" id="2071528">)</span><span class="op" id="2071529">,</span>&nbsp;<span class="ident" id="2071531"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2071534">(</span><span class="builtintype" id="2071535">nil</span><span class="op" id="2071538">)</span><span class="op" id="2071539">.</span><span class="ident" id="2071540"><a href="/gostd/math/big/nat.go.html#2062773">setUint64</a></span><span class="op" id="2071549">(</span><span class="ident" id="2071550"><a href="/gostd/math/big/nat.go.html#2071296">b</a></span><span class="op" id="2071551">)</span><span class="op" id="2071552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2071555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071558">m</span>&nbsp;<span class="op" id="2071560">:=</span>&nbsp;<span class="op" id="2071563">(</span><span class="ident" id="2071564"><a href="/gostd/math/big/nat.go.html#2071293">a</a></span>&nbsp;<span class="op" id="2071566">+</span>&nbsp;<span class="ident" id="2071568"><a href="/gostd/math/big/nat.go.html#2071296">b</a></span><span class="op" id="2071569">)</span>&nbsp;<span class="op" id="2071571">/</span>&nbsp;<span class="num" id="2071573">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071576">return</span>&nbsp;<span class="ident" id="2071583"><a href="/gostd/math/big/nat.go.html#2071277">z</a></span><span class="op" id="2071584">.</span><span class="ident" id="2071585"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2071588">(</span><span class="ident" id="2071589"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2071592">(</span><span class="builtintype" id="2071593">nil</span><span class="op" id="2071596">)</span><span class="op" id="2071597">.</span><span class="ident" id="2071598"><a href="/gostd/math/big/nat.go.html#2071284">mulRange</a></span><span class="op" id="2071606">(</span><span class="ident" id="2071607"><a href="/gostd/math/big/nat.go.html#2071293">a</a></span><span class="op" id="2071608">,</span>&nbsp;<span class="ident" id="2071610"><a href="/gostd/math/big/nat.go.html#2071558">m</a></span><span class="op" id="2071611">)</span><span class="op" id="2071612">,</span>&nbsp;<span class="ident" id="2071614"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2071617">(</span><span class="builtintype" id="2071618">nil</span><span class="op" id="2071621">)</span><span class="op" id="2071622">.</span><span class="ident" id="2071623"><a href="/gostd/math/big/nat.go.html#2071284">mulRange</a></span><span class="op" id="2071631">(</span><span class="ident" id="2071632"><a href="/gostd/math/big/nat.go.html#2071558">m</a></span><span class="op" id="2071633">+</span><span class="num" id="2071634">1</span><span class="op" id="2071635">,</span>&nbsp;<span class="ident" id="2071637"><a href="/gostd/math/big/nat.go.html#2071296">b</a></span><span class="op" id="2071638">)</span><span class="op" id="2071639">)</span><br>
<span class="lineno"></span><span class="op" id="2071641">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="comment" id="2071644">//&nbsp;q&nbsp;=&nbsp;(x-r)/y,&nbsp;with&nbsp;0&nbsp;&lt;=&nbsp;r&nbsp;&lt;&nbsp;y</span><br>
<span class="lineno"></span><span class="keyword" id="2071676">func</span>&nbsp;<span class="op" id="2071681">(</span><span class="ident" id="2071682">z</span>&nbsp;<span class="ident" id="2071684"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2071687">)</span>&nbsp;<span class="ident" id="2071689">divW</span><span class="op" id="2071693">(</span><span class="ident" id="2071694">x</span>&nbsp;<span class="ident" id="2071696"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2071699">,</span>&nbsp;<span class="ident" id="2071701">y</span>&nbsp;<span class="ident" id="2071703"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2071707">)</span>&nbsp;<span class="op" id="2071709">(</span><span class="ident" id="2071710">q</span>&nbsp;<span class="ident" id="2071712"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2071715">,</span>&nbsp;<span class="ident" id="2071717">r</span>&nbsp;<span class="ident" id="2071719"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2071723">)</span>&nbsp;<span class="op" id="2071725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071728">m</span>&nbsp;<span class="op" id="2071730">:=</span>&nbsp;<span class="builtinfunc" id="2071733">len</span><span class="op" id="2071736">(</span><span class="ident" id="2071737"><a href="/gostd/math/big/nat.go.html#2071694">x</a></span><span class="op" id="2071738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071741">switch</span>&nbsp;<span class="op" id="2071748">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071751">case</span>&nbsp;<span class="ident" id="2071756"><a href="/gostd/math/big/nat.go.html#2071701">y</a></span>&nbsp;<span class="op" id="2071758">==</span>&nbsp;<span class="num" id="2071761">0</span><span class="op" id="2071762">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2071766">panic</span><span class="op" id="2071771">(</span><span class="string" id="2071772">&#34;division&nbsp;by&nbsp;zero&#34;</span><span class="op" id="2071790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071793">case</span>&nbsp;<span class="ident" id="2071798"><a href="/gostd/math/big/nat.go.html#2071701">y</a></span>&nbsp;<span class="op" id="2071800">==</span>&nbsp;<span class="num" id="2071803">1</span><span class="op" id="2071804">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071808"><a href="/gostd/math/big/nat.go.html#2071710">q</a></span>&nbsp;<span class="op" id="2071810">=</span>&nbsp;<span class="ident" id="2071812"><a href="/gostd/math/big/nat.go.html#2071682">z</a></span><span class="op" id="2071813">.</span><span class="ident" id="2071814"><a href="/gostd/math/big/nat.go.html#2063110">set</a></span><span class="op" id="2071817">(</span><span class="ident" id="2071818"><a href="/gostd/math/big/nat.go.html#2071694">x</a></span><span class="op" id="2071819">)</span>&nbsp;<span class="comment" id="2071821">//&nbsp;result&nbsp;is&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071838">return</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071846">case</span>&nbsp;<span class="ident" id="2071851"><a href="/gostd/math/big/nat.go.html#2071728">m</a></span>&nbsp;<span class="op" id="2071853">==</span>&nbsp;<span class="num" id="2071856">0</span><span class="op" id="2071857">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071861"><a href="/gostd/math/big/nat.go.html#2071710">q</a></span>&nbsp;<span class="op" id="2071863">=</span>&nbsp;<span class="ident" id="2071865"><a href="/gostd/math/big/nat.go.html#2071682">z</a></span><span class="op" id="2071866">.</span><span class="builtinfunc" id="2071867"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2071871">(</span><span class="num" id="2071872">0</span><span class="op" id="2071873">)</span>&nbsp;<span class="comment" id="2071875">//&nbsp;result&nbsp;is&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071892">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2071900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2071903">//&nbsp;m&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071913"><a href="/gostd/math/big/nat.go.html#2071682">z</a></span>&nbsp;<span class="op" id="2071915">=</span>&nbsp;<span class="ident" id="2071917"><a href="/gostd/math/big/nat.go.html#2071682">z</a></span><span class="op" id="2071918">.</span><span class="builtinfunc" id="2071919"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2071923">(</span><span class="ident" id="2071924"><a href="/gostd/math/big/nat.go.html#2071728">m</a></span><span class="op" id="2071925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071928"><a href="/gostd/math/big/nat.go.html#2071717">r</a></span>&nbsp;<span class="op" id="2071930">=</span>&nbsp;<span class="ident" id="2071932"><a href="/gostd/math/big/arith_decl.go.html#2035500">divWVW</a></span><span class="op" id="2071938">(</span><span class="ident" id="2071939"><a href="/gostd/math/big/nat.go.html#2071682">z</a></span><span class="op" id="2071940">,</span>&nbsp;<span class="num" id="2071942">0</span><span class="op" id="2071943">,</span>&nbsp;<span class="ident" id="2071945"><a href="/gostd/math/big/nat.go.html#2071694">x</a></span><span class="op" id="2071946">,</span>&nbsp;<span class="ident" id="2071948"><a href="/gostd/math/big/nat.go.html#2071701">y</a></span><span class="op" id="2071949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071952"><a href="/gostd/math/big/nat.go.html#2071710">q</a></span>&nbsp;<span class="op" id="2071954">=</span>&nbsp;<span class="ident" id="2071956"><a href="/gostd/math/big/nat.go.html#2071682">z</a></span><span class="op" id="2071957">.</span><span class="ident" id="2071958"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2071962">(</span><span class="op" id="2071963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071966">return</span><br>
<span class="lineno"></span><span class="op" id="2071973">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span><span class="keyword" id="2071976">func</span>&nbsp;<span class="op" id="2071981">(</span><span class="ident" id="2071982">z</span>&nbsp;<span class="ident" id="2071984"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2071987">)</span>&nbsp;<span class="ident" id="2071989">div</span><span class="op" id="2071992">(</span><span class="ident" id="2071993">z2</span><span class="op" id="2071995">,</span>&nbsp;<span class="ident" id="2071997">u</span><span class="op" id="2071998">,</span>&nbsp;<span class="ident" id="2072000">v</span>&nbsp;<span class="ident" id="2072002"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2072005">)</span>&nbsp;<span class="op" id="2072007">(</span><span class="ident" id="2072008">q</span><span class="op" id="2072009">,</span>&nbsp;<span class="ident" id="2072011">r</span>&nbsp;<span class="ident" id="2072013"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2072016">)</span>&nbsp;<span class="op" id="2072018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072021">if</span>&nbsp;<span class="builtinfunc" id="2072024">len</span><span class="op" id="2072027">(</span><span class="ident" id="2072028"><a href="/gostd/math/big/nat.go.html#2072000">v</a></span><span class="op" id="2072029">)</span>&nbsp;<span class="op" id="2072031">==</span>&nbsp;<span class="num" id="2072034">0</span>&nbsp;<span class="op" id="2072036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2072040">panic</span><span class="op" id="2072045">(</span><span class="string" id="2072046">&#34;division&nbsp;by&nbsp;zero&#34;</span><span class="op" id="2072064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2072067">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072071">if</span>&nbsp;<span class="ident" id="2072074"><a href="/gostd/math/big/nat.go.html#2071997">u</a></span><span class="op" id="2072075">.</span><span class="ident" id="2072076"><a href="/gostd/math/big/nat.go.html#2063929">cmp</a></span><span class="op" id="2072079">(</span><span class="ident" id="2072080"><a href="/gostd/math/big/nat.go.html#2072000">v</a></span><span class="op" id="2072081">)</span>&nbsp;<span class="op" id="2072083">&lt;</span>&nbsp;<span class="num" id="2072085">0</span>&nbsp;<span class="op" id="2072087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072091"><a href="/gostd/math/big/nat.go.html#2072008">q</a></span>&nbsp;<span class="op" id="2072093">=</span>&nbsp;<span class="ident" id="2072095"><a href="/gostd/math/big/nat.go.html#2071982">z</a></span><span class="op" id="2072096">.</span><span class="builtinfunc" id="2072097"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2072101">(</span><span class="num" id="2072102">0</span><span class="op" id="2072103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072107"><a href="/gostd/math/big/nat.go.html#2072011">r</a></span>&nbsp;<span class="op" id="2072109">=</span>&nbsp;<span class="ident" id="2072111"><a href="/gostd/math/big/nat.go.html#2071993">z2</a></span><span class="op" id="2072113">.</span><span class="ident" id="2072114"><a href="/gostd/math/big/nat.go.html#2063110">set</a></span><span class="op" id="2072117">(</span><span class="ident" id="2072118"><a href="/gostd/math/big/nat.go.html#2071997">u</a></span><span class="op" id="2072119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072123">return</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2072131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072135">if</span>&nbsp;<span class="builtinfunc" id="2072138">len</span><span class="op" id="2072141">(</span><span class="ident" id="2072142"><a href="/gostd/math/big/nat.go.html#2072000">v</a></span><span class="op" id="2072143">)</span>&nbsp;<span class="op" id="2072145">==</span>&nbsp;<span class="num" id="2072148">1</span>&nbsp;<span class="op" id="2072150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072154">var</span>&nbsp;<span class="ident" id="2072158">r2</span>&nbsp;<span class="ident" id="2072161"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072168"><a href="/gostd/math/big/nat.go.html#2072008">q</a></span><span class="op" id="2072169">,</span>&nbsp;<span class="ident" id="2072171"><a href="/gostd/math/big/nat.go.html#2072158">r2</a></span>&nbsp;<span class="op" id="2072174">=</span>&nbsp;<span class="ident" id="2072176"><a href="/gostd/math/big/nat.go.html#2071982">z</a></span><span class="op" id="2072177">.</span><span class="ident" id="2072178"><a href="/gostd/math/big/nat.go.html#2071689">divW</a></span><span class="op" id="2072182">(</span><span class="ident" id="2072183"><a href="/gostd/math/big/nat.go.html#2071997">u</a></span><span class="op" id="2072184">,</span>&nbsp;<span class="ident" id="2072186"><a href="/gostd/math/big/nat.go.html#2072000">v</a></span><span class="op" id="2072187">[</span><span class="num" id="2072188">0</span><span class="op" id="2072189">]</span><span class="op" id="2072190">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072194"><a href="/gostd/math/big/nat.go.html#2072011">r</a></span>&nbsp;<span class="op" id="2072196">=</span>&nbsp;<span class="ident" id="2072198"><a href="/gostd/math/big/nat.go.html#2071993">z2</a></span><span class="op" id="2072200">.</span><span class="ident" id="2072201"><a href="/gostd/math/big/nat.go.html#2062665">setWord</a></span><span class="op" id="2072208">(</span><span class="ident" id="2072209"><a href="/gostd/math/big/nat.go.html#2072158">r2</a></span><span class="op" id="2072211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072215">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2072223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072227"><a href="/gostd/math/big/nat.go.html#2072008">q</a></span><span class="op" id="2072228">,</span>&nbsp;<span class="ident" id="2072230"><a href="/gostd/math/big/nat.go.html#2072011">r</a></span>&nbsp;<span class="op" id="2072232">=</span>&nbsp;<span class="ident" id="2072234"><a href="/gostd/math/big/nat.go.html#2071982">z</a></span><span class="op" id="2072235">.</span><span class="ident" id="2072236"><a href="/gostd/math/big/nat.go.html#2072490">divLarge</a></span><span class="op" id="2072244">(</span><span class="ident" id="2072245"><a href="/gostd/math/big/nat.go.html#2071993">z2</a></span><span class="op" id="2072247">,</span>&nbsp;<span class="ident" id="2072249"><a href="/gostd/math/big/nat.go.html#2071997">u</a></span><span class="op" id="2072250">,</span>&nbsp;<span class="ident" id="2072252"><a href="/gostd/math/big/nat.go.html#2072000">v</a></span><span class="op" id="2072253">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072256">return</span><br>
<span class="lineno"></span><span class="op" id="2072263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2072266">//&nbsp;q&nbsp;=&nbsp;(uIn-r)/v,&nbsp;with&nbsp;0&nbsp;&lt;=&nbsp;r&nbsp;&lt;&nbsp;y</span><br>
<span class="lineno"></span><span class="comment" id="2072300">//&nbsp;Uses&nbsp;z&nbsp;as&nbsp;storage&nbsp;for&nbsp;q,&nbsp;and&nbsp;u&nbsp;as&nbsp;storage&nbsp;for&nbsp;r&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">525</span><span class="comment" id="2072364">//&nbsp;See&nbsp;Knuth,&nbsp;Volume&nbsp;2,&nbsp;section&nbsp;4.3.1,&nbsp;Algorithm&nbsp;D.</span><br>
<span class="lineno"></span><span class="comment" id="2072416">//&nbsp;Preconditions:</span><br>
<span class="lineno"></span><span class="comment" id="2072434">//&nbsp;&nbsp;&nbsp;&nbsp;len(v)&nbsp;&gt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2072452">//&nbsp;&nbsp;&nbsp;&nbsp;len(uIn)&nbsp;&gt;=&nbsp;len(v)</span><br>
<span class="lineno"></span><span class="keyword" id="2072477">func</span>&nbsp;<span class="op" id="2072482">(</span><span class="ident" id="2072483">z</span>&nbsp;<span class="ident" id="2072485"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2072488">)</span>&nbsp;<span class="ident" id="2072490">divLarge</span><span class="op" id="2072498">(</span><span class="ident" id="2072499">u</span><span class="op" id="2072500">,</span>&nbsp;<span class="ident" id="2072502">uIn</span><span class="op" id="2072505">,</span>&nbsp;<span class="ident" id="2072507">v</span>&nbsp;<span class="ident" id="2072509"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2072512">)</span>&nbsp;<span class="op" id="2072514">(</span><span class="ident" id="2072515">q</span><span class="op" id="2072516">,</span>&nbsp;<span class="ident" id="2072518">r</span>&nbsp;<span class="ident" id="2072520"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2072523">)</span>&nbsp;<span class="op" id="2072525">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072528">n</span>&nbsp;<span class="op" id="2072530">:=</span>&nbsp;<span class="builtinfunc" id="2072533">len</span><span class="op" id="2072536">(</span><span class="ident" id="2072537"><a href="/gostd/math/big/nat.go.html#2072507">v</a></span><span class="op" id="2072538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072541">m</span>&nbsp;<span class="op" id="2072543">:=</span>&nbsp;<span class="builtinfunc" id="2072546">len</span><span class="op" id="2072549">(</span><span class="ident" id="2072550"><a href="/gostd/math/big/nat.go.html#2072502">uIn</a></span><span class="op" id="2072553">)</span>&nbsp;<span class="op" id="2072555">-</span>&nbsp;<span class="ident" id="2072557"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2072561">//&nbsp;determine&nbsp;if&nbsp;z&nbsp;can&nbsp;be&nbsp;reused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2072594">//&nbsp;TODO(gri)&nbsp;should&nbsp;find&nbsp;a&nbsp;better&nbsp;solution&nbsp;-&nbsp;this&nbsp;if&nbsp;statement</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2072658">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;very&nbsp;costly&nbsp;(see&nbsp;e.g.&nbsp;time&nbsp;pidigits&nbsp;-s&nbsp;-n&nbsp;10000)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072724">if</span>&nbsp;<span class="ident" id="2072727"><a href="/gostd/math/big/nat.go.html#2068133">alias</a></span><span class="op" id="2072732">(</span><span class="ident" id="2072733"><a href="/gostd/math/big/nat.go.html#2072483">z</a></span><span class="op" id="2072734">,</span>&nbsp;<span class="ident" id="2072736"><a href="/gostd/math/big/nat.go.html#2072502">uIn</a></span><span class="op" id="2072739">)</span>&nbsp;<span class="op" id="2072741">||</span>&nbsp;<span class="ident" id="2072744"><a href="/gostd/math/big/nat.go.html#2068133">alias</a></span><span class="op" id="2072749">(</span><span class="ident" id="2072750"><a href="/gostd/math/big/nat.go.html#2072483">z</a></span><span class="op" id="2072751">,</span>&nbsp;<span class="ident" id="2072753"><a href="/gostd/math/big/nat.go.html#2072507">v</a></span><span class="op" id="2072754">)</span>&nbsp;<span class="op" id="2072756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072760"><a href="/gostd/math/big/nat.go.html#2072483">z</a></span>&nbsp;<span class="op" id="2072762">=</span>&nbsp;<span class="builtintype" id="2072764">nil</span>&nbsp;<span class="comment" id="2072768">//&nbsp;z&nbsp;is&nbsp;an&nbsp;alias&nbsp;for&nbsp;uIn&nbsp;or&nbsp;v&nbsp;-&nbsp;cannot&nbsp;reuse</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2072814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072817"><a href="/gostd/math/big/nat.go.html#2072515">q</a></span>&nbsp;<span class="op" id="2072819">=</span>&nbsp;<span class="ident" id="2072821"><a href="/gostd/math/big/nat.go.html#2072483">z</a></span><span class="op" id="2072822">.</span><span class="builtinfunc" id="2072823"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2072827">(</span><span class="ident" id="2072828"><a href="/gostd/math/big/nat.go.html#2072541">m</a></span>&nbsp;<span class="op" id="2072830">+</span>&nbsp;<span class="num" id="2072832">1</span><span class="op" id="2072833">)</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072837">qhatv</span>&nbsp;<span class="op" id="2072843">:=</span>&nbsp;<span class="builtinfunc" id="2072846">make</span><span class="op" id="2072850">(</span><span class="ident" id="2072851"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2072854">,</span>&nbsp;<span class="ident" id="2072856"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><span class="op" id="2072857">+</span><span class="num" id="2072858">1</span><span class="op" id="2072859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072862">if</span>&nbsp;<span class="ident" id="2072865"><a href="/gostd/math/big/nat.go.html#2068133">alias</a></span><span class="op" id="2072870">(</span><span class="ident" id="2072871"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2072872">,</span>&nbsp;<span class="ident" id="2072874"><a href="/gostd/math/big/nat.go.html#2072502">uIn</a></span><span class="op" id="2072877">)</span>&nbsp;<span class="op" id="2072879">||</span>&nbsp;<span class="ident" id="2072882"><a href="/gostd/math/big/nat.go.html#2068133">alias</a></span><span class="op" id="2072887">(</span><span class="ident" id="2072888"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2072889">,</span>&nbsp;<span class="ident" id="2072891"><a href="/gostd/math/big/nat.go.html#2072507">v</a></span><span class="op" id="2072892">)</span>&nbsp;<span class="op" id="2072894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072898"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span>&nbsp;<span class="op" id="2072900">=</span>&nbsp;<span class="builtintype" id="2072902">nil</span>&nbsp;<span class="comment" id="2072906">//&nbsp;u&nbsp;is&nbsp;an&nbsp;alias&nbsp;for&nbsp;uIn&nbsp;or&nbsp;v&nbsp;-&nbsp;cannot&nbsp;reuse</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2072952">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072955"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span>&nbsp;<span class="op" id="2072957">=</span>&nbsp;<span class="ident" id="2072959"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2072960">.</span><span class="builtinfunc" id="2072961"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2072965">(</span><span class="builtinfunc" id="2072966">len</span><span class="op" id="2072969">(</span><span class="ident" id="2072970"><a href="/gostd/math/big/nat.go.html#2072502">uIn</a></span><span class="op" id="2072973">)</span>&nbsp;<span class="op" id="2072975">+</span>&nbsp;<span class="num" id="2072977">1</span><span class="op" id="2072978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072981"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2072982">.</span><span class="ident" id="2072983"><a href="/gostd/math/big/nat.go.html#2062241">clear</a></span><span class="op" id="2072988">(</span><span class="op" id="2072989">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2072993">//&nbsp;D1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073001">shift</span>&nbsp;<span class="op" id="2073007">:=</span>&nbsp;<span class="ident" id="2073010"><a href="/gostd/math/big/arith.go.html#2032784">leadingZeros</a></span><span class="op" id="2073022">(</span><span class="ident" id="2073023"><a href="/gostd/math/big/nat.go.html#2072507">v</a></span><span class="op" id="2073024">[</span><span class="ident" id="2073025"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><span class="op" id="2073026">-</span><span class="num" id="2073027">1</span><span class="op" id="2073028">]</span><span class="op" id="2073029">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073032">if</span>&nbsp;<span class="ident" id="2073035"><a href="/gostd/math/big/nat.go.html#2073001">shift</a></span>&nbsp;<span class="op" id="2073041">&gt;</span>&nbsp;<span class="num" id="2073043">0</span>&nbsp;<span class="op" id="2073045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073049">//&nbsp;do&nbsp;not&nbsp;modify&nbsp;v,&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;by&nbsp;another&nbsp;goroutine&nbsp;simultaneously</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073122">v1</span>&nbsp;<span class="op" id="2073125">:=</span>&nbsp;<span class="builtinfunc" id="2073128">make</span><span class="op" id="2073132">(</span><span class="ident" id="2073133"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2073136">,</span>&nbsp;<span class="ident" id="2073138"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><span class="op" id="2073139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073143"><a href="/gostd/math/big/arith_decl.go.html#2035325">shlVU</a></span><span class="op" id="2073148">(</span><span class="ident" id="2073149"><a href="/gostd/math/big/nat.go.html#2073122">v1</a></span><span class="op" id="2073151">,</span>&nbsp;<span class="ident" id="2073153"><a href="/gostd/math/big/nat.go.html#2072507">v</a></span><span class="op" id="2073154">,</span>&nbsp;<span class="ident" id="2073156"><a href="/gostd/math/big/nat.go.html#2073001">shift</a></span><span class="op" id="2073161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073165"><a href="/gostd/math/big/nat.go.html#2072507">v</a></span>&nbsp;<span class="op" id="2073167">=</span>&nbsp;<span class="ident" id="2073169"><a href="/gostd/math/big/nat.go.html#2073122">v1</a></span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073176"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2073177">[</span><span class="builtinfunc" id="2073178">len</span><span class="op" id="2073181">(</span><span class="ident" id="2073182"><a href="/gostd/math/big/nat.go.html#2072502">uIn</a></span><span class="op" id="2073185">)</span><span class="op" id="2073186">]</span>&nbsp;<span class="op" id="2073188">=</span>&nbsp;<span class="ident" id="2073190"><a href="/gostd/math/big/arith_decl.go.html#2035325">shlVU</a></span><span class="op" id="2073195">(</span><span class="ident" id="2073196"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2073197">[</span><span class="num" id="2073198">0</span><span class="op" id="2073199">:</span><span class="builtinfunc" id="2073200">len</span><span class="op" id="2073203">(</span><span class="ident" id="2073204"><a href="/gostd/math/big/nat.go.html#2072502">uIn</a></span><span class="op" id="2073207">)</span><span class="op" id="2073208">]</span><span class="op" id="2073209">,</span>&nbsp;<span class="ident" id="2073211"><a href="/gostd/math/big/nat.go.html#2072502">uIn</a></span><span class="op" id="2073214">,</span>&nbsp;<span class="ident" id="2073216"><a href="/gostd/math/big/nat.go.html#2073001">shift</a></span><span class="op" id="2073221">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073225">//&nbsp;D2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073233">for</span>&nbsp;<span class="ident" id="2073237">j</span>&nbsp;<span class="op" id="2073239">:=</span>&nbsp;<span class="ident" id="2073242"><a href="/gostd/math/big/nat.go.html#2072541">m</a></span><span class="op" id="2073243">;</span>&nbsp;<span class="ident" id="2073245"><a href="/gostd/math/big/nat.go.html#2073237">j</a></span>&nbsp;<span class="op" id="2073247">&gt;=</span>&nbsp;<span class="num" id="2073250">0</span><span class="op" id="2073251">;</span>&nbsp;<span class="ident" id="2073253"><a href="/gostd/math/big/nat.go.html#2073237">j</a></span><span class="op" id="2073254">--</span>&nbsp;<span class="op" id="2073257">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073261">//&nbsp;D3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073270">qhat</span>&nbsp;<span class="op" id="2073275">:=</span>&nbsp;<span class="ident" id="2073278"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2073282">(</span><span class="ident" id="2073283"><a href="/gostd/math/big/arith.go.html#2031219">_M</a></span><span class="op" id="2073285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073289">if</span>&nbsp;<span class="ident" id="2073292"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2073293">[</span><span class="ident" id="2073294"><a href="/gostd/math/big/nat.go.html#2073237">j</a></span><span class="op" id="2073295">+</span><span class="ident" id="2073296"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><span class="op" id="2073297">]</span>&nbsp;<span class="op" id="2073299">!=</span>&nbsp;<span class="ident" id="2073302"><a href="/gostd/math/big/nat.go.html#2072507">v</a></span><span class="op" id="2073303">[</span><span class="ident" id="2073304"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><span class="op" id="2073305">-</span><span class="num" id="2073306">1</span><span class="op" id="2073307">]</span>&nbsp;<span class="op" id="2073309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073314">var</span>&nbsp;<span class="ident" id="2073318">rhat</span>&nbsp;<span class="ident" id="2073323"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073331"><a href="/gostd/math/big/nat.go.html#2073270">qhat</a></span><span class="op" id="2073335">,</span>&nbsp;<span class="ident" id="2073337"><a href="/gostd/math/big/nat.go.html#2073318">rhat</a></span>&nbsp;<span class="op" id="2073342">=</span>&nbsp;<span class="ident" id="2073344"><a href="/gostd/math/big/arith_decl.go.html#2035132">divWW</a></span><span class="op" id="2073349">(</span><span class="ident" id="2073350"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2073351">[</span><span class="ident" id="2073352"><a href="/gostd/math/big/nat.go.html#2073237">j</a></span><span class="op" id="2073353">+</span><span class="ident" id="2073354"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><span class="op" id="2073355">]</span><span class="op" id="2073356">,</span>&nbsp;<span class="ident" id="2073358"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2073359">[</span><span class="ident" id="2073360"><a href="/gostd/math/big/nat.go.html#2073237">j</a></span><span class="op" id="2073361">+</span><span class="ident" id="2073362"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><span class="op" id="2073363">-</span><span class="num" id="2073364">1</span><span class="op" id="2073365">]</span><span class="op" id="2073366">,</span>&nbsp;<span class="ident" id="2073368"><a href="/gostd/math/big/nat.go.html#2072507">v</a></span><span class="op" id="2073369">[</span><span class="ident" id="2073370"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><span class="op" id="2073371">-</span><span class="num" id="2073372">1</span><span class="op" id="2073373">]</span><span class="op" id="2073374">)</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073380">//&nbsp;x1&nbsp;|&nbsp;x2&nbsp;=&nbsp;q̂v_{n-2}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073407">x1</span><span class="op" id="2073409">,</span>&nbsp;<span class="ident" id="2073411">x2</span>&nbsp;<span class="op" id="2073414">:=</span>&nbsp;<span class="ident" id="2073417"><a href="/gostd/math/big/arith_decl.go.html#2035096">mulWW</a></span><span class="op" id="2073422">(</span><span class="ident" id="2073423"><a href="/gostd/math/big/nat.go.html#2073270">qhat</a></span><span class="op" id="2073427">,</span>&nbsp;<span class="ident" id="2073429"><a href="/gostd/math/big/nat.go.html#2072507">v</a></span><span class="op" id="2073430">[</span><span class="ident" id="2073431"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><span class="op" id="2073432">-</span><span class="num" id="2073433">2</span><span class="op" id="2073434">]</span><span class="op" id="2073435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073440">//&nbsp;test&nbsp;if&nbsp;q̂v_{n-2}&nbsp;&gt;&nbsp;br̂&nbsp;+&nbsp;u_{j+n-2}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073484">for</span>&nbsp;<span class="ident" id="2073488"><a href="/gostd/math/big/nat.go.html#2088960">greaterThan</a></span><span class="op" id="2073499">(</span><span class="ident" id="2073500"><a href="/gostd/math/big/nat.go.html#2073407">x1</a></span><span class="op" id="2073502">,</span>&nbsp;<span class="ident" id="2073504"><a href="/gostd/math/big/nat.go.html#2073411">x2</a></span><span class="op" id="2073506">,</span>&nbsp;<span class="ident" id="2073508"><a href="/gostd/math/big/nat.go.html#2073318">rhat</a></span><span class="op" id="2073512">,</span>&nbsp;<span class="ident" id="2073514"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2073515">[</span><span class="ident" id="2073516"><a href="/gostd/math/big/nat.go.html#2073237">j</a></span><span class="op" id="2073517">+</span><span class="ident" id="2073518"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><span class="op" id="2073519">-</span><span class="num" id="2073520">2</span><span class="op" id="2073521">]</span><span class="op" id="2073522">)</span>&nbsp;<span class="op" id="2073524">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073530"><a href="/gostd/math/big/nat.go.html#2073270">qhat</a></span><span class="op" id="2073534">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073541">prevRhat</span>&nbsp;<span class="op" id="2073550">:=</span>&nbsp;<span class="ident" id="2073553"><a href="/gostd/math/big/nat.go.html#2073318">rhat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073562"><a href="/gostd/math/big/nat.go.html#2073318">rhat</a></span>&nbsp;<span class="op" id="2073567">+=</span>&nbsp;<span class="ident" id="2073570"><a href="/gostd/math/big/nat.go.html#2072507">v</a></span><span class="op" id="2073571">[</span><span class="ident" id="2073572"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><span class="op" id="2073573">-</span><span class="num" id="2073574">1</span><span class="op" id="2073575">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073581">//&nbsp;v[n-1]&nbsp;&gt;=&nbsp;0,&nbsp;so&nbsp;this&nbsp;tests&nbsp;for&nbsp;overflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073629">if</span>&nbsp;<span class="ident" id="2073632"><a href="/gostd/math/big/nat.go.html#2073318">rhat</a></span>&nbsp;<span class="op" id="2073637">&lt;</span>&nbsp;<span class="ident" id="2073639"><a href="/gostd/math/big/nat.go.html#2073541">prevRhat</a></span>&nbsp;<span class="op" id="2073648">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073655">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073671"><a href="/gostd/math/big/nat.go.html#2073407">x1</a></span><span class="op" id="2073673">,</span>&nbsp;<span class="ident" id="2073675"><a href="/gostd/math/big/nat.go.html#2073411">x2</a></span>&nbsp;<span class="op" id="2073678">=</span>&nbsp;<span class="ident" id="2073680"><a href="/gostd/math/big/arith_decl.go.html#2035096">mulWW</a></span><span class="op" id="2073685">(</span><span class="ident" id="2073686"><a href="/gostd/math/big/nat.go.html#2073270">qhat</a></span><span class="op" id="2073690">,</span>&nbsp;<span class="ident" id="2073692"><a href="/gostd/math/big/nat.go.html#2072507">v</a></span><span class="op" id="2073693">[</span><span class="ident" id="2073694"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><span class="op" id="2073695">-</span><span class="num" id="2073696">2</span><span class="op" id="2073697">]</span><span class="op" id="2073698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073707">}</span><br>
<span class="lineno">580</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073712">//&nbsp;D4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073721"><a href="/gostd/math/big/nat.go.html#2072837">qhatv</a></span><span class="op" id="2073726">[</span><span class="ident" id="2073727"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><span class="op" id="2073728">]</span>&nbsp;<span class="op" id="2073730">=</span>&nbsp;<span class="ident" id="2073732"><a href="/gostd/math/big/arith_decl.go.html#2035407">mulAddVWW</a></span><span class="op" id="2073741">(</span><span class="ident" id="2073742"><a href="/gostd/math/big/nat.go.html#2072837">qhatv</a></span><span class="op" id="2073747">[</span><span class="num" id="2073748">0</span><span class="op" id="2073749">:</span><span class="ident" id="2073750"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><span class="op" id="2073751">]</span><span class="op" id="2073752">,</span>&nbsp;<span class="ident" id="2073754"><a href="/gostd/math/big/nat.go.html#2072507">v</a></span><span class="op" id="2073755">,</span>&nbsp;<span class="ident" id="2073757"><a href="/gostd/math/big/nat.go.html#2073270">qhat</a></span><span class="op" id="2073761">,</span>&nbsp;<span class="num" id="2073763">0</span><span class="op" id="2073764">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073769">c</span>&nbsp;<span class="op" id="2073771">:=</span>&nbsp;<span class="ident" id="2073774"><a href="/gostd/math/big/arith_decl.go.html#2035207">subVV</a></span><span class="op" id="2073779">(</span><span class="ident" id="2073780"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2073781">[</span><span class="ident" id="2073782"><a href="/gostd/math/big/nat.go.html#2073237">j</a></span><span class="op" id="2073783">:</span><span class="ident" id="2073784"><a href="/gostd/math/big/nat.go.html#2073237">j</a></span><span class="op" id="2073785">+</span><span class="builtinfunc" id="2073786">len</span><span class="op" id="2073789">(</span><span class="ident" id="2073790"><a href="/gostd/math/big/nat.go.html#2072837">qhatv</a></span><span class="op" id="2073795">)</span><span class="op" id="2073796">]</span><span class="op" id="2073797">,</span>&nbsp;<span class="ident" id="2073799"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2073800">[</span><span class="ident" id="2073801"><a href="/gostd/math/big/nat.go.html#2073237">j</a></span><span class="op" id="2073802">:</span><span class="op" id="2073803">]</span><span class="op" id="2073804">,</span>&nbsp;<span class="ident" id="2073806"><a href="/gostd/math/big/nat.go.html#2072837">qhatv</a></span><span class="op" id="2073811">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073815">if</span>&nbsp;<span class="ident" id="2073818"><a href="/gostd/math/big/nat.go.html#2073769">c</a></span>&nbsp;<span class="op" id="2073820">!=</span>&nbsp;<span class="num" id="2073823">0</span>&nbsp;<span class="op" id="2073825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073830">c</span>&nbsp;<span class="op" id="2073832">:=</span>&nbsp;<span class="ident" id="2073835"><a href="/gostd/math/big/arith_decl.go.html#2035171">addVV</a></span><span class="op" id="2073840">(</span><span class="ident" id="2073841"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2073842">[</span><span class="ident" id="2073843"><a href="/gostd/math/big/nat.go.html#2073237">j</a></span><span class="op" id="2073844">:</span><span class="ident" id="2073845"><a href="/gostd/math/big/nat.go.html#2073237">j</a></span><span class="op" id="2073846">+</span><span class="ident" id="2073847"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><span class="op" id="2073848">]</span><span class="op" id="2073849">,</span>&nbsp;<span class="ident" id="2073851"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2073852">[</span><span class="ident" id="2073853"><a href="/gostd/math/big/nat.go.html#2073237">j</a></span><span class="op" id="2073854">:</span><span class="op" id="2073855">]</span><span class="op" id="2073856">,</span>&nbsp;<span class="ident" id="2073858"><a href="/gostd/math/big/nat.go.html#2072507">v</a></span><span class="op" id="2073859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073864"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2073865">[</span><span class="ident" id="2073866"><a href="/gostd/math/big/nat.go.html#2073237">j</a></span><span class="op" id="2073867">+</span><span class="ident" id="2073868"><a href="/gostd/math/big/nat.go.html#2072528">n</a></span><span class="op" id="2073869">]</span>&nbsp;<span class="op" id="2073871">+=</span>&nbsp;<span class="ident" id="2073874"><a href="/gostd/math/big/nat.go.html#2073830">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073879"><a href="/gostd/math/big/nat.go.html#2073270">qhat</a></span><span class="op" id="2073883">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073888">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073893"><a href="/gostd/math/big/nat.go.html#2072515">q</a></span><span class="op" id="2073894">[</span><span class="ident" id="2073895"><a href="/gostd/math/big/nat.go.html#2073237">j</a></span><span class="op" id="2073896">]</span>&nbsp;<span class="op" id="2073898">=</span>&nbsp;<span class="ident" id="2073900"><a href="/gostd/math/big/nat.go.html#2073270">qhat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073910"><a href="/gostd/math/big/nat.go.html#2072515">q</a></span>&nbsp;<span class="op" id="2073912">=</span>&nbsp;<span class="ident" id="2073914"><a href="/gostd/math/big/nat.go.html#2072515">q</a></span><span class="op" id="2073915">.</span><span class="ident" id="2073916"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2073920">(</span><span class="op" id="2073921">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073924"><a href="/gostd/math/big/arith_decl.go.html#2035366">shrVU</a></span><span class="op" id="2073929">(</span><span class="ident" id="2073930"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2073931">,</span>&nbsp;<span class="ident" id="2073933"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2073934">,</span>&nbsp;<span class="ident" id="2073936"><a href="/gostd/math/big/nat.go.html#2073001">shift</a></span><span class="op" id="2073941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073944"><a href="/gostd/math/big/nat.go.html#2072518">r</a></span>&nbsp;<span class="op" id="2073946">=</span>&nbsp;<span class="ident" id="2073948"><a href="/gostd/math/big/nat.go.html#2072499">u</a></span><span class="op" id="2073949">.</span><span class="ident" id="2073950"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2073954">(</span><span class="op" id="2073955">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073959">return</span>&nbsp;<span class="ident" id="2073966"><a href="/gostd/math/big/nat.go.html#2072515">q</a></span><span class="op" id="2073967">,</span>&nbsp;<span class="ident" id="2073969"><a href="/gostd/math/big/nat.go.html#2072518">r</a></span><br>
<span class="lineno"></span><span class="op" id="2073971">}</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span><span class="comment" id="2073974">//&nbsp;Length&nbsp;of&nbsp;x&nbsp;in&nbsp;bits.&nbsp;x&nbsp;must&nbsp;be&nbsp;normalized.</span><br>
<span class="lineno"></span><span class="keyword" id="2074020">func</span>&nbsp;<span class="op" id="2074025">(</span><span class="ident" id="2074026">x</span>&nbsp;<span class="ident" id="2074028"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2074031">)</span>&nbsp;<span class="ident" id="2074033">bitLen</span><span class="op" id="2074039">(</span><span class="op" id="2074040">)</span>&nbsp;<span class="builtintype" id="2074042">int</span>&nbsp;<span class="op" id="2074046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074049">if</span>&nbsp;<span class="ident" id="2074052">i</span>&nbsp;<span class="op" id="2074054">:=</span>&nbsp;<span class="builtinfunc" id="2074057">len</span><span class="op" id="2074060">(</span><span class="ident" id="2074061"><a href="/gostd/math/big/nat.go.html#2074026">x</a></span><span class="op" id="2074062">)</span>&nbsp;<span class="op" id="2074064">-</span>&nbsp;<span class="num" id="2074066">1</span><span class="op" id="2074067">;</span>&nbsp;<span class="ident" id="2074069"><a href="/gostd/math/big/nat.go.html#2074052">i</a></span>&nbsp;<span class="op" id="2074071">&gt;=</span>&nbsp;<span class="num" id="2074074">0</span>&nbsp;<span class="op" id="2074076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074080">return</span>&nbsp;<span class="ident" id="2074087"><a href="/gostd/math/big/nat.go.html#2074052">i</a></span><span class="op" id="2074088">*</span><span class="ident" id="2074089"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span>&nbsp;<span class="op" id="2074092">+</span>&nbsp;<span class="ident" id="2074094"><a href="/gostd/math/big/arith_decl.go.html#2035558">bitLen</a></span><span class="op" id="2074100">(</span><span class="ident" id="2074101"><a href="/gostd/math/big/nat.go.html#2074026">x</a></span><span class="op" id="2074102">[</span><span class="ident" id="2074103"><a href="/gostd/math/big/nat.go.html#2074052">i</a></span><span class="op" id="2074104">]</span><span class="op" id="2074105">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2074108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074111">return</span>&nbsp;<span class="num" id="2074118">0</span><br>
<span class="lineno"></span><span class="op" id="2074120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2074123">//&nbsp;MaxBase&nbsp;is&nbsp;the&nbsp;largest&nbsp;number&nbsp;base&nbsp;accepted&nbsp;for&nbsp;string&nbsp;conversions.</span><br>
<span class="lineno">610</span><span class="keyword" id="2074194">const</span>&nbsp;<span class="ident" id="2074200">MaxBase</span>&nbsp;<span class="op" id="2074208">=</span>&nbsp;<span class="string" id="2074210">&#39;z&#39;</span>&nbsp;<span class="op" id="2074214">-</span>&nbsp;<span class="string" id="2074216">&#39;a&#39;</span>&nbsp;<span class="op" id="2074220">+</span>&nbsp;<span class="num" id="2074222">10</span>&nbsp;<span class="op" id="2074225">+</span>&nbsp;<span class="num" id="2074227">1</span>&nbsp;<span class="comment" id="2074229">//&nbsp;=&nbsp;hexValue(&#39;z&#39;)&nbsp;+&nbsp;1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2074253">func</span>&nbsp;<span class="ident" id="2074258">hexValue</span><span class="op" id="2074266">(</span><span class="ident" id="2074267">ch</span>&nbsp;<span class="builtintype" id="2074270">rune</span><span class="op" id="2074274">)</span>&nbsp;<span class="ident" id="2074276"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span>&nbsp;<span class="op" id="2074281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074284">d</span>&nbsp;<span class="op" id="2074286">:=</span>&nbsp;<span class="builtintype" id="2074289">int</span><span class="op" id="2074292">(</span><span class="ident" id="2074293"><a href="/gostd/math/big/nat.go.html#2074200">MaxBase</a></span>&nbsp;<span class="op" id="2074301">+</span>&nbsp;<span class="num" id="2074303">1</span><span class="op" id="2074304">)</span>&nbsp;<span class="comment" id="2074306">//&nbsp;illegal&nbsp;base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074323">switch</span>&nbsp;<span class="op" id="2074330">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074333">case</span>&nbsp;<span class="string" id="2074338">&#39;0&#39;</span>&nbsp;<span class="op" id="2074342">&lt;=</span>&nbsp;<span class="ident" id="2074345"><a href="/gostd/math/big/nat.go.html#2074267">ch</a></span>&nbsp;<span class="op" id="2074348">&amp;&amp;</span>&nbsp;<span class="ident" id="2074351"><a href="/gostd/math/big/nat.go.html#2074267">ch</a></span>&nbsp;<span class="op" id="2074354">&lt;=</span>&nbsp;<span class="string" id="2074357">&#39;9&#39;</span><span class="op" id="2074360">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074364"><a href="/gostd/math/big/nat.go.html#2074284">d</a></span>&nbsp;<span class="op" id="2074366">=</span>&nbsp;<span class="builtintype" id="2074368">int</span><span class="op" id="2074371">(</span><span class="ident" id="2074372"><a href="/gostd/math/big/nat.go.html#2074267">ch</a></span>&nbsp;<span class="op" id="2074375">-</span>&nbsp;<span class="string" id="2074377">&#39;0&#39;</span><span class="op" id="2074380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074383">case</span>&nbsp;<span class="string" id="2074388">&#39;a&#39;</span>&nbsp;<span class="op" id="2074392">&lt;=</span>&nbsp;<span class="ident" id="2074395"><a href="/gostd/math/big/nat.go.html#2074267">ch</a></span>&nbsp;<span class="op" id="2074398">&amp;&amp;</span>&nbsp;<span class="ident" id="2074401"><a href="/gostd/math/big/nat.go.html#2074267">ch</a></span>&nbsp;<span class="op" id="2074404">&lt;=</span>&nbsp;<span class="string" id="2074407">&#39;z&#39;</span><span class="op" id="2074410">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074414"><a href="/gostd/math/big/nat.go.html#2074284">d</a></span>&nbsp;<span class="op" id="2074416">=</span>&nbsp;<span class="builtintype" id="2074418">int</span><span class="op" id="2074421">(</span><span class="ident" id="2074422"><a href="/gostd/math/big/nat.go.html#2074267">ch</a></span>&nbsp;<span class="op" id="2074425">-</span>&nbsp;<span class="string" id="2074427">&#39;a&#39;</span>&nbsp;<span class="op" id="2074431">+</span>&nbsp;<span class="num" id="2074433">10</span><span class="op" id="2074435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074438">case</span>&nbsp;<span class="string" id="2074443">&#39;A&#39;</span>&nbsp;<span class="op" id="2074447">&lt;=</span>&nbsp;<span class="ident" id="2074450"><a href="/gostd/math/big/nat.go.html#2074267">ch</a></span>&nbsp;<span class="op" id="2074453">&amp;&amp;</span>&nbsp;<span class="ident" id="2074456"><a href="/gostd/math/big/nat.go.html#2074267">ch</a></span>&nbsp;<span class="op" id="2074459">&lt;=</span>&nbsp;<span class="string" id="2074462">&#39;Z&#39;</span><span class="op" id="2074465">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074469"><a href="/gostd/math/big/nat.go.html#2074284">d</a></span>&nbsp;<span class="op" id="2074471">=</span>&nbsp;<span class="builtintype" id="2074473">int</span><span class="op" id="2074476">(</span><span class="ident" id="2074477"><a href="/gostd/math/big/nat.go.html#2074267">ch</a></span>&nbsp;<span class="op" id="2074480">-</span>&nbsp;<span class="string" id="2074482">&#39;A&#39;</span>&nbsp;<span class="op" id="2074486">+</span>&nbsp;<span class="num" id="2074488">10</span><span class="op" id="2074490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2074493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074496">return</span>&nbsp;<span class="ident" id="2074503"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2074507">(</span><span class="ident" id="2074508"><a href="/gostd/math/big/nat.go.html#2074284">d</a></span><span class="op" id="2074509">)</span><br>
<span class="lineno"></span><span class="op" id="2074511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="comment" id="2074514">//&nbsp;scan&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;natural&nbsp;number&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;longest&nbsp;possible&nbsp;prefix</span><br>
<span class="lineno"></span><span class="comment" id="2074596">//&nbsp;read&nbsp;from&nbsp;r&nbsp;representing&nbsp;an&nbsp;unsigned&nbsp;integer&nbsp;in&nbsp;a&nbsp;given&nbsp;conversion&nbsp;base.</span><br>
<span class="lineno"></span><span class="comment" id="2074672">//&nbsp;It&nbsp;returns&nbsp;z,&nbsp;the&nbsp;actual&nbsp;conversion&nbsp;base&nbsp;used,&nbsp;and&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.&nbsp;In&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2074751">//&nbsp;error&nbsp;case,&nbsp;the&nbsp;value&nbsp;of&nbsp;z&nbsp;is&nbsp;undefined.&nbsp;The&nbsp;syntax&nbsp;follows&nbsp;the&nbsp;syntax&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2074828">//&nbsp;unsigned&nbsp;integer&nbsp;literals&nbsp;in&nbsp;Go.</span><br>
<span class="lineno">630</span><span class="comment" id="2074864">//</span><br>
<span class="lineno"></span><span class="comment" id="2074867">//&nbsp;The&nbsp;base&nbsp;argument&nbsp;must&nbsp;be&nbsp;0&nbsp;or&nbsp;a&nbsp;value&nbsp;from&nbsp;2&nbsp;through&nbsp;MaxBase.&nbsp;If&nbsp;the&nbsp;base</span><br>
<span class="lineno"></span><span class="comment" id="2074945">//&nbsp;is&nbsp;0,&nbsp;the&nbsp;string&nbsp;prefix&nbsp;determines&nbsp;the&nbsp;actual&nbsp;conversion&nbsp;base.&nbsp;A&nbsp;prefix&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2075023">//&nbsp;``0x&#39;&#39;&nbsp;or&nbsp;``0X&#39;&#39;&nbsp;selects&nbsp;base&nbsp;16;&nbsp;the&nbsp;``0&#39;&#39;&nbsp;prefix&nbsp;selects&nbsp;base&nbsp;8,&nbsp;and&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2075099">//&nbsp;``0b&#39;&#39;&nbsp;or&nbsp;``0B&#39;&#39;&nbsp;prefix&nbsp;selects&nbsp;base&nbsp;2.&nbsp;Otherwise&nbsp;the&nbsp;selected&nbsp;base&nbsp;is&nbsp;10.</span><br>
<span class="lineno">635</span><span class="comment" id="2075177">//</span><br>
<span class="lineno"></span><span class="keyword" id="2075180">func</span>&nbsp;<span class="op" id="2075185">(</span><span class="ident" id="2075186">z</span>&nbsp;<span class="ident" id="2075188"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2075191">)</span>&nbsp;<span class="ident" id="2075193">scan</span><span class="op" id="2075197">(</span><span class="ident" id="2075198">r</span>&nbsp;<span class="ident" id="2075200"><a href="/gostd/math/big/nat.go.html#2061605">io</a></span><span class="op" id="2075202">.</span><span class="ident" id="2075203"><a href="/gostd/io/io.go.html#1428105">RuneScanner</a></span><span class="op" id="2075214">,</span>&nbsp;<span class="ident" id="2075216">base</span>&nbsp;<span class="builtintype" id="2075221">int</span><span class="op" id="2075224">)</span>&nbsp;<span class="op" id="2075226">(</span><span class="ident" id="2075227"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2075230">,</span>&nbsp;<span class="builtintype" id="2075232">int</span><span class="op" id="2075235">,</span>&nbsp;<span class="builtintype" id="2075237">error</span><span class="op" id="2075242">)</span>&nbsp;<span class="op" id="2075244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2075247">//&nbsp;reject&nbsp;illegal&nbsp;bases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075272">if</span>&nbsp;<span class="ident" id="2075275"><a href="/gostd/math/big/nat.go.html#2075216">base</a></span>&nbsp;<span class="op" id="2075280">&lt;</span>&nbsp;<span class="num" id="2075282">0</span>&nbsp;<span class="op" id="2075284">||</span>&nbsp;<span class="ident" id="2075287"><a href="/gostd/math/big/nat.go.html#2075216">base</a></span>&nbsp;<span class="op" id="2075292">==</span>&nbsp;<span class="num" id="2075295">1</span>&nbsp;<span class="op" id="2075297">||</span>&nbsp;<span class="ident" id="2075300"><a href="/gostd/math/big/nat.go.html#2074200">MaxBase</a></span>&nbsp;<span class="op" id="2075308">&lt;</span>&nbsp;<span class="ident" id="2075310"><a href="/gostd/math/big/nat.go.html#2075216">base</a></span>&nbsp;<span class="op" id="2075315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075319">return</span>&nbsp;<span class="ident" id="2075326"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span><span class="op" id="2075327">,</span>&nbsp;<span class="num" id="2075329">0</span><span class="op" id="2075330">,</span>&nbsp;<span class="ident" id="2075332"><a href="/gostd/math/big/nat.go.html#2061595">errors</a></span><span class="op" id="2075338">.</span><span class="ident" id="2075339"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="2075342">(</span><span class="string" id="2075343">&#34;illegal&nbsp;number&nbsp;base&#34;</span><span class="op" id="2075364">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2075367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2075371">//&nbsp;one&nbsp;char&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2075395">ch</span><span class="op" id="2075397">,</span>&nbsp;<span class="ident" id="2075399">_</span><span class="op" id="2075400">,</span>&nbsp;<span class="ident" id="2075402">err</span>&nbsp;<span class="op" id="2075406">:=</span>&nbsp;<span class="ident" id="2075409"><a href="/gostd/math/big/nat.go.html#2075198">r</a></span><span class="op" id="2075410">.</span><span class="ident" id="2075411"><a href="/gostd/io/io.go.html#1427757">ReadRune</a></span><span class="op" id="2075419">(</span><span class="op" id="2075420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075423">if</span>&nbsp;<span class="ident" id="2075426"><a href="/gostd/math/big/nat.go.html#2075402">err</a></span>&nbsp;<span class="op" id="2075430">!=</span>&nbsp;<span class="builtintype" id="2075433">nil</span>&nbsp;<span class="op" id="2075437">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075441">return</span>&nbsp;<span class="ident" id="2075448"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span><span class="op" id="2075449">,</span>&nbsp;<span class="num" id="2075451">0</span><span class="op" id="2075452">,</span>&nbsp;<span class="ident" id="2075454"><a href="/gostd/math/big/nat.go.html#2075402">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2075459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2075463">//&nbsp;determine&nbsp;base&nbsp;if&nbsp;necessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2075495">b</span>&nbsp;<span class="op" id="2075497">:=</span>&nbsp;<span class="ident" id="2075500"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2075504">(</span><span class="ident" id="2075505"><a href="/gostd/math/big/nat.go.html#2075216">base</a></span><span class="op" id="2075509">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075512">if</span>&nbsp;<span class="ident" id="2075515"><a href="/gostd/math/big/nat.go.html#2075216">base</a></span>&nbsp;<span class="op" id="2075520">==</span>&nbsp;<span class="num" id="2075523">0</span>&nbsp;<span class="op" id="2075525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2075529"><a href="/gostd/math/big/nat.go.html#2075495">b</a></span>&nbsp;<span class="op" id="2075531">=</span>&nbsp;<span class="num" id="2075533">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075538">if</span>&nbsp;<span class="ident" id="2075541"><a href="/gostd/math/big/nat.go.html#2075395">ch</a></span>&nbsp;<span class="op" id="2075544">==</span>&nbsp;<span class="string" id="2075547">&#39;0&#39;</span>&nbsp;<span class="op" id="2075551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075556">switch</span>&nbsp;<span class="ident" id="2075563"><a href="/gostd/math/big/nat.go.html#2075395">ch</a></span><span class="op" id="2075565">,</span>&nbsp;<span class="ident" id="2075567">_</span><span class="op" id="2075568">,</span>&nbsp;<span class="ident" id="2075570"><a href="/gostd/math/big/nat.go.html#2075402">err</a></span>&nbsp;<span class="op" id="2075574">=</span>&nbsp;<span class="ident" id="2075576"><a href="/gostd/math/big/nat.go.html#2075198">r</a></span><span class="op" id="2075577">.</span><span class="ident" id="2075578"><a href="/gostd/io/io.go.html#1427757">ReadRune</a></span><span class="op" id="2075586">(</span><span class="op" id="2075587">)</span><span class="op" id="2075588">;</span>&nbsp;<span class="ident" id="2075590"><a href="/gostd/math/big/nat.go.html#2075402">err</a></span>&nbsp;<span class="op" id="2075594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075599">case</span>&nbsp;<span class="builtintype" id="2075604">nil</span><span class="op" id="2075607">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2075613"><a href="/gostd/math/big/nat.go.html#2075495">b</a></span>&nbsp;<span class="op" id="2075615">=</span>&nbsp;<span class="num" id="2075617">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075623">switch</span>&nbsp;<span class="ident" id="2075630"><a href="/gostd/math/big/nat.go.html#2075395">ch</a></span>&nbsp;<span class="op" id="2075633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075639">case</span>&nbsp;<span class="string" id="2075644">&#39;x&#39;</span><span class="op" id="2075647">,</span>&nbsp;<span class="string" id="2075649">&#39;X&#39;</span><span class="op" id="2075652">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2075659"><a href="/gostd/math/big/nat.go.html#2075495">b</a></span>&nbsp;<span class="op" id="2075661">=</span>&nbsp;<span class="num" id="2075663">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075670">case</span>&nbsp;<span class="string" id="2075675">&#39;b&#39;</span><span class="op" id="2075678">,</span>&nbsp;<span class="string" id="2075680">&#39;B&#39;</span><span class="op" id="2075683">:</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2075690"><a href="/gostd/math/big/nat.go.html#2075495">b</a></span>&nbsp;<span class="op" id="2075692">=</span>&nbsp;<span class="num" id="2075694">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2075700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075706">if</span>&nbsp;<span class="ident" id="2075709"><a href="/gostd/math/big/nat.go.html#2075495">b</a></span>&nbsp;<span class="op" id="2075711">==</span>&nbsp;<span class="num" id="2075714">2</span>&nbsp;<span class="op" id="2075716">||</span>&nbsp;<span class="ident" id="2075719"><a href="/gostd/math/big/nat.go.html#2075495">b</a></span>&nbsp;<span class="op" id="2075721">==</span>&nbsp;<span class="num" id="2075724">16</span>&nbsp;<span class="op" id="2075727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075734">if</span>&nbsp;<span class="ident" id="2075737"><a href="/gostd/math/big/nat.go.html#2075395">ch</a></span><span class="op" id="2075739">,</span>&nbsp;<span class="ident" id="2075741">_</span><span class="op" id="2075742">,</span>&nbsp;<span class="ident" id="2075744"><a href="/gostd/math/big/nat.go.html#2075402">err</a></span>&nbsp;<span class="op" id="2075748">=</span>&nbsp;<span class="ident" id="2075750"><a href="/gostd/math/big/nat.go.html#2075198">r</a></span><span class="op" id="2075751">.</span><span class="ident" id="2075752"><a href="/gostd/io/io.go.html#1427757">ReadRune</a></span><span class="op" id="2075760">(</span><span class="op" id="2075761">)</span><span class="op" id="2075762">;</span>&nbsp;<span class="ident" id="2075764"><a href="/gostd/math/big/nat.go.html#2075402">err</a></span>&nbsp;<span class="op" id="2075768">!=</span>&nbsp;<span class="builtintype" id="2075771">nil</span>&nbsp;<span class="op" id="2075775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075783">return</span>&nbsp;<span class="ident" id="2075790"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span><span class="op" id="2075791">,</span>&nbsp;<span class="num" id="2075793">0</span><span class="op" id="2075794">,</span>&nbsp;<span class="ident" id="2075796"><a href="/gostd/math/big/nat.go.html#2075402">err</a></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2075805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2075811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075816">case</span>&nbsp;<span class="ident" id="2075821"><a href="/gostd/math/big/nat.go.html#2061605">io</a></span><span class="op" id="2075823">.</span><span class="ident" id="2075824"><a href="/gostd/io/io.go.html#1419950">EOF</a></span><span class="op" id="2075827">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075833">return</span>&nbsp;<span class="ident" id="2075840"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span><span class="op" id="2075841">.</span><span class="builtinfunc" id="2075842"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2075846">(</span><span class="num" id="2075847">0</span><span class="op" id="2075848">)</span><span class="op" id="2075849">,</span>&nbsp;<span class="num" id="2075851">10</span><span class="op" id="2075853">,</span>&nbsp;<span class="builtintype" id="2075855">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075862">default</span><span class="op" id="2075869">:</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075875">return</span>&nbsp;<span class="ident" id="2075882"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span><span class="op" id="2075883">,</span>&nbsp;<span class="num" id="2075885">10</span><span class="op" id="2075887">,</span>&nbsp;<span class="ident" id="2075889"><a href="/gostd/math/big/nat.go.html#2075402">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2075896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2075900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2075903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2075907">//&nbsp;convert&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2075926">//&nbsp;-&nbsp;group&nbsp;as&nbsp;many&nbsp;digits&nbsp;d&nbsp;as&nbsp;possible&nbsp;together&nbsp;into&nbsp;a&nbsp;&#34;super-digit&#34;&nbsp;dd&nbsp;with&nbsp;&#34;super-base&#34;&nbsp;bb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2076021">//&nbsp;-&nbsp;only&nbsp;when&nbsp;bb&nbsp;does&nbsp;not&nbsp;fit&nbsp;into&nbsp;a&nbsp;word&nbsp;anymore,&nbsp;do&nbsp;a&nbsp;full&nbsp;number&nbsp;mulAddWW&nbsp;using&nbsp;bb&nbsp;and&nbsp;dd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2076116"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span>&nbsp;<span class="op" id="2076118">=</span>&nbsp;<span class="ident" id="2076120"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span><span class="op" id="2076121">.</span><span class="builtinfunc" id="2076122"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2076126">(</span><span class="num" id="2076127">0</span><span class="op" id="2076128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2076131">bb</span>&nbsp;<span class="op" id="2076134">:=</span>&nbsp;<span class="ident" id="2076137"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2076141">(</span><span class="num" id="2076142">1</span><span class="op" id="2076143">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2076146">dd</span>&nbsp;<span class="op" id="2076149">:=</span>&nbsp;<span class="ident" id="2076152"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2076156">(</span><span class="num" id="2076157">0</span><span class="op" id="2076158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076161">for</span>&nbsp;<span class="ident" id="2076165">max</span>&nbsp;<span class="op" id="2076169">:=</span>&nbsp;<span class="ident" id="2076172"><a href="/gostd/math/big/arith.go.html#2031219">_M</a></span>&nbsp;<span class="op" id="2076175">/</span>&nbsp;<span class="ident" id="2076177"><a href="/gostd/math/big/nat.go.html#2075495">b</a></span><span class="op" id="2076178">;</span>&nbsp;<span class="op" id="2076180">;</span>&nbsp;<span class="op" id="2076182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2076186">d</span>&nbsp;<span class="op" id="2076188">:=</span>&nbsp;<span class="ident" id="2076191"><a href="/gostd/math/big/nat.go.html#2074258">hexValue</a></span><span class="op" id="2076199">(</span><span class="ident" id="2076200"><a href="/gostd/math/big/nat.go.html#2075395">ch</a></span><span class="op" id="2076202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076206">if</span>&nbsp;<span class="ident" id="2076209"><a href="/gostd/math/big/nat.go.html#2076186">d</a></span>&nbsp;<span class="op" id="2076211">&gt;=</span>&nbsp;<span class="ident" id="2076214"><a href="/gostd/math/big/nat.go.html#2075495">b</a></span>&nbsp;<span class="op" id="2076216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2076221"><a href="/gostd/math/big/nat.go.html#2075198">r</a></span><span class="op" id="2076222">.</span><span class="ident" id="2076223"><a href="/gostd/io/io.go.html#1428142">UnreadRune</a></span><span class="op" id="2076233">(</span><span class="op" id="2076234">)</span>&nbsp;<span class="comment" id="2076236">//&nbsp;ch&nbsp;does&nbsp;not&nbsp;belong&nbsp;to&nbsp;number&nbsp;anymore</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076279">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2076287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076292">if</span>&nbsp;<span class="ident" id="2076295"><a href="/gostd/math/big/nat.go.html#2076131">bb</a></span>&nbsp;<span class="op" id="2076298">&lt;=</span>&nbsp;<span class="ident" id="2076301"><a href="/gostd/math/big/nat.go.html#2076165">max</a></span>&nbsp;<span class="op" id="2076305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2076310"><a href="/gostd/math/big/nat.go.html#2076131">bb</a></span>&nbsp;<span class="op" id="2076313">*=</span>&nbsp;<span class="ident" id="2076316"><a href="/gostd/math/big/nat.go.html#2075495">b</a></span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2076321"><a href="/gostd/math/big/nat.go.html#2076146">dd</a></span>&nbsp;<span class="op" id="2076324">=</span>&nbsp;<span class="ident" id="2076326"><a href="/gostd/math/big/nat.go.html#2076146">dd</a></span><span class="op" id="2076328">*</span><span class="ident" id="2076329"><a href="/gostd/math/big/nat.go.html#2075495">b</a></span>&nbsp;<span class="op" id="2076331">+</span>&nbsp;<span class="ident" id="2076333"><a href="/gostd/math/big/nat.go.html#2076186">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2076337">}</span>&nbsp;<span class="keyword" id="2076339">else</span>&nbsp;<span class="op" id="2076344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2076349">//&nbsp;bb&nbsp;*&nbsp;b&nbsp;would&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2076377"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span>&nbsp;<span class="op" id="2076379">=</span>&nbsp;<span class="ident" id="2076381"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span><span class="op" id="2076382">.</span><span class="ident" id="2076383"><a href="/gostd/math/big/nat.go.html#2064217">mulAddWW</a></span><span class="op" id="2076391">(</span><span class="ident" id="2076392"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span><span class="op" id="2076393">,</span>&nbsp;<span class="ident" id="2076395"><a href="/gostd/math/big/nat.go.html#2076131">bb</a></span><span class="op" id="2076397">,</span>&nbsp;<span class="ident" id="2076399"><a href="/gostd/math/big/nat.go.html#2076146">dd</a></span><span class="op" id="2076401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2076406"><a href="/gostd/math/big/nat.go.html#2076131">bb</a></span>&nbsp;<span class="op" id="2076409">=</span>&nbsp;<span class="ident" id="2076411"><a href="/gostd/math/big/nat.go.html#2075495">b</a></span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2076416"><a href="/gostd/math/big/nat.go.html#2076146">dd</a></span>&nbsp;<span class="op" id="2076419">=</span>&nbsp;<span class="ident" id="2076421"><a href="/gostd/math/big/nat.go.html#2076186">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2076425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076430">if</span>&nbsp;<span class="ident" id="2076433"><a href="/gostd/math/big/nat.go.html#2075395">ch</a></span><span class="op" id="2076435">,</span>&nbsp;<span class="ident" id="2076437">_</span><span class="op" id="2076438">,</span>&nbsp;<span class="ident" id="2076440"><a href="/gostd/math/big/nat.go.html#2075402">err</a></span>&nbsp;<span class="op" id="2076444">=</span>&nbsp;<span class="ident" id="2076446"><a href="/gostd/math/big/nat.go.html#2075198">r</a></span><span class="op" id="2076447">.</span><span class="ident" id="2076448"><a href="/gostd/io/io.go.html#1427757">ReadRune</a></span><span class="op" id="2076456">(</span><span class="op" id="2076457">)</span><span class="op" id="2076458">;</span>&nbsp;<span class="ident" id="2076460"><a href="/gostd/math/big/nat.go.html#2075402">err</a></span>&nbsp;<span class="op" id="2076464">!=</span>&nbsp;<span class="builtintype" id="2076467">nil</span>&nbsp;<span class="op" id="2076471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076476">if</span>&nbsp;<span class="ident" id="2076479"><a href="/gostd/math/big/nat.go.html#2075402">err</a></span>&nbsp;<span class="op" id="2076483">!=</span>&nbsp;<span class="ident" id="2076486"><a href="/gostd/math/big/nat.go.html#2061605">io</a></span><span class="op" id="2076488">.</span><span class="ident" id="2076489"><a href="/gostd/io/io.go.html#1419950">EOF</a></span>&nbsp;<span class="op" id="2076493">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076499">return</span>&nbsp;<span class="ident" id="2076506"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span><span class="op" id="2076507">,</span>&nbsp;<span class="builtintype" id="2076509">int</span><span class="op" id="2076512">(</span><span class="ident" id="2076513"><a href="/gostd/math/big/nat.go.html#2075495">b</a></span><span class="op" id="2076514">)</span><span class="op" id="2076515">,</span>&nbsp;<span class="ident" id="2076517"><a href="/gostd/math/big/nat.go.html#2075402">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2076524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076529">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2076537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2076540">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076544">switch</span>&nbsp;<span class="op" id="2076551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076554">case</span>&nbsp;<span class="ident" id="2076559"><a href="/gostd/math/big/nat.go.html#2076131">bb</a></span>&nbsp;<span class="op" id="2076562">&gt;</span>&nbsp;<span class="num" id="2076564">1</span><span class="op" id="2076565">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2076569">//&nbsp;there&nbsp;was&nbsp;at&nbsp;least&nbsp;one&nbsp;mantissa&nbsp;digit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2076612"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span>&nbsp;<span class="op" id="2076614">=</span>&nbsp;<span class="ident" id="2076616"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span><span class="op" id="2076617">.</span><span class="ident" id="2076618"><a href="/gostd/math/big/nat.go.html#2064217">mulAddWW</a></span><span class="op" id="2076626">(</span><span class="ident" id="2076627"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span><span class="op" id="2076628">,</span>&nbsp;<span class="ident" id="2076630"><a href="/gostd/math/big/nat.go.html#2076131">bb</a></span><span class="op" id="2076632">,</span>&nbsp;<span class="ident" id="2076634"><a href="/gostd/math/big/nat.go.html#2076146">dd</a></span><span class="op" id="2076636">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076639">case</span>&nbsp;<span class="ident" id="2076644"><a href="/gostd/math/big/nat.go.html#2075216">base</a></span>&nbsp;<span class="op" id="2076649">==</span>&nbsp;<span class="num" id="2076652">0</span>&nbsp;<span class="op" id="2076654">&amp;&amp;</span>&nbsp;<span class="ident" id="2076657"><a href="/gostd/math/big/nat.go.html#2075495">b</a></span>&nbsp;<span class="op" id="2076659">==</span>&nbsp;<span class="num" id="2076662">8</span><span class="op" id="2076663">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2076667">//&nbsp;there&nbsp;was&nbsp;only&nbsp;the&nbsp;octal&nbsp;prefix&nbsp;0&nbsp;(possibly&nbsp;followed&nbsp;by&nbsp;digits&nbsp;&gt;&nbsp;7);</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2076741">//&nbsp;return&nbsp;base&nbsp;10,&nbsp;not&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076768">return</span>&nbsp;<span class="ident" id="2076775"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span><span class="op" id="2076776">,</span>&nbsp;<span class="num" id="2076778">10</span><span class="op" id="2076780">,</span>&nbsp;<span class="builtintype" id="2076782">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076787">case</span>&nbsp;<span class="ident" id="2076792"><a href="/gostd/math/big/nat.go.html#2075216">base</a></span>&nbsp;<span class="op" id="2076797">!=</span>&nbsp;<span class="num" id="2076800">0</span>&nbsp;<span class="op" id="2076802">||</span>&nbsp;<span class="ident" id="2076805"><a href="/gostd/math/big/nat.go.html#2075495">b</a></span>&nbsp;<span class="op" id="2076807">!=</span>&nbsp;<span class="num" id="2076810">8</span><span class="op" id="2076811">:</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2076815">//&nbsp;there&nbsp;was&nbsp;neither&nbsp;a&nbsp;mantissa&nbsp;digit&nbsp;nor&nbsp;the&nbsp;octal&nbsp;prefix&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076878">return</span>&nbsp;<span class="ident" id="2076885"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span><span class="op" id="2076886">,</span>&nbsp;<span class="builtintype" id="2076888">int</span><span class="op" id="2076891">(</span><span class="ident" id="2076892"><a href="/gostd/math/big/nat.go.html#2075495">b</a></span><span class="op" id="2076893">)</span><span class="op" id="2076894">,</span>&nbsp;<span class="ident" id="2076896"><a href="/gostd/math/big/nat.go.html#2061595">errors</a></span><span class="op" id="2076902">.</span><span class="ident" id="2076903"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="2076906">(</span><span class="string" id="2076907">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;number&#34;</span><span class="op" id="2076937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2076940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076944">return</span>&nbsp;<span class="ident" id="2076951"><a href="/gostd/math/big/nat.go.html#2075186">z</a></span><span class="op" id="2076952">.</span><span class="ident" id="2076953"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2076957">(</span><span class="op" id="2076958">)</span><span class="op" id="2076959">,</span>&nbsp;<span class="builtintype" id="2076961">int</span><span class="op" id="2076964">(</span><span class="ident" id="2076965"><a href="/gostd/math/big/nat.go.html#2075495">b</a></span><span class="op" id="2076966">)</span><span class="op" id="2076967">,</span>&nbsp;<span class="builtintype" id="2076969">nil</span><br>
<span class="lineno">720</span><span class="op" id="2076973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2076976">//&nbsp;Character&nbsp;sets&nbsp;for&nbsp;string&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="keyword" id="2077017">const</span>&nbsp;<span class="op" id="2077023">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2077026">lowercaseDigits</span>&nbsp;<span class="op" id="2077042">=</span>&nbsp;<span class="string" id="2077044">&#34;0123456789abcdefghijklmnopqrstuvwxyz&#34;</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2077084">uppercaseDigits</span>&nbsp;<span class="op" id="2077100">=</span>&nbsp;<span class="string" id="2077102">&#34;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span><br>
<span class="lineno"></span><span class="op" id="2077141">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2077144">//&nbsp;decimalString&nbsp;returns&nbsp;a&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2077200">//&nbsp;It&nbsp;calls&nbsp;x.string&nbsp;with&nbsp;the&nbsp;charset&nbsp;&#34;0123456789&#34;.</span><br>
<span class="lineno">730</span><span class="keyword" id="2077252">func</span>&nbsp;<span class="op" id="2077257">(</span><span class="ident" id="2077258">x</span>&nbsp;<span class="ident" id="2077260"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2077263">)</span>&nbsp;<span class="ident" id="2077265">decimalString</span><span class="op" id="2077278">(</span><span class="op" id="2077279">)</span>&nbsp;<span class="builtintype" id="2077281">string</span>&nbsp;<span class="op" id="2077288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2077291">return</span>&nbsp;<span class="ident" id="2077298"><a href="/gostd/math/big/nat.go.html#2077258">x</a></span><span class="op" id="2077299">.</span><span class="builtintype" id="2077300"><a href="/gostd/math/big/nat.go.html#2077547">string</a></span><span class="op" id="2077306">(</span><span class="ident" id="2077307"><a href="/gostd/math/big/nat.go.html#2077026">lowercaseDigits</a></span><span class="op" id="2077322">[</span><span class="num" id="2077323">0</span><span class="op" id="2077324">:</span><span class="num" id="2077325">10</span><span class="op" id="2077327">]</span><span class="op" id="2077328">)</span><br>
<span class="lineno"></span><span class="op" id="2077330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2077333">//&nbsp;string&nbsp;converts&nbsp;x&nbsp;to&nbsp;a&nbsp;string&nbsp;using&nbsp;digits&nbsp;from&nbsp;a&nbsp;charset;&nbsp;a&nbsp;digit&nbsp;with</span><br>
<span class="lineno">735</span><span class="comment" id="2077408">//&nbsp;value&nbsp;d&nbsp;is&nbsp;represented&nbsp;by&nbsp;charset[d].&nbsp;The&nbsp;conversion&nbsp;base&nbsp;is&nbsp;determined</span><br>
<span class="lineno"></span><span class="comment" id="2077483">//&nbsp;by&nbsp;len(charset),&nbsp;which&nbsp;must&nbsp;be&nbsp;&gt;=&nbsp;2&nbsp;and&nbsp;&lt;=&nbsp;256.</span><br>
<span class="lineno"></span><span class="keyword" id="2077534">func</span>&nbsp;<span class="op" id="2077539">(</span><span class="ident" id="2077540">x</span>&nbsp;<span class="ident" id="2077542"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2077545">)</span>&nbsp;<span class="builtintype" id="2077547">string</span><span class="op" id="2077553">(</span><span class="ident" id="2077554">charset</span>&nbsp;<span class="builtintype" id="2077562">string</span><span class="op" id="2077568">)</span>&nbsp;<span class="builtintype" id="2077570">string</span>&nbsp;<span class="op" id="2077577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2077580">b</span>&nbsp;<span class="op" id="2077582">:=</span>&nbsp;<span class="ident" id="2077585"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2077589">(</span><span class="builtinfunc" id="2077590">len</span><span class="op" id="2077593">(</span><span class="ident" id="2077594"><a href="/gostd/math/big/nat.go.html#2077554">charset</a></span><span class="op" id="2077601">)</span><span class="op" id="2077602">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2077606">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2077624">switch</span>&nbsp;<span class="op" id="2077631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2077634">case</span>&nbsp;<span class="ident" id="2077639"><a href="/gostd/math/big/nat.go.html#2077580">b</a></span>&nbsp;<span class="op" id="2077641">&lt;</span>&nbsp;<span class="num" id="2077643">2</span>&nbsp;<span class="op" id="2077645">||</span>&nbsp;<span class="ident" id="2077648"><a href="/gostd/math/big/nat.go.html#2074200">MaxBase</a></span>&nbsp;<span class="op" id="2077656">&gt;</span>&nbsp;<span class="num" id="2077658">256</span><span class="op" id="2077661">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2077665">panic</span><span class="op" id="2077670">(</span><span class="string" id="2077671">&#34;illegal&nbsp;base&#34;</span><span class="op" id="2077685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2077688">case</span>&nbsp;<span class="builtinfunc" id="2077693">len</span><span class="op" id="2077696">(</span><span class="ident" id="2077697"><a href="/gostd/math/big/nat.go.html#2077540">x</a></span><span class="op" id="2077698">)</span>&nbsp;<span class="op" id="2077700">==</span>&nbsp;<span class="num" id="2077703">0</span><span class="op" id="2077704">:</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2077708">return</span>&nbsp;<span class="builtintype" id="2077715">string</span><span class="op" id="2077721">(</span><span class="ident" id="2077722"><a href="/gostd/math/big/nat.go.html#2077554">charset</a></span><span class="op" id="2077729">[</span><span class="num" id="2077730">0</span><span class="op" id="2077731">]</span><span class="op" id="2077732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2077735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2077739">//&nbsp;allocate&nbsp;buffer&nbsp;for&nbsp;conversion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2077774">i</span>&nbsp;<span class="op" id="2077776">:=</span>&nbsp;<span class="builtintype" id="2077779">int</span><span class="op" id="2077782">(</span><span class="builtintype" id="2077783">float64</span><span class="op" id="2077790">(</span><span class="ident" id="2077791"><a href="/gostd/math/big/nat.go.html#2077540">x</a></span><span class="op" id="2077792">.</span><span class="ident" id="2077793"><a href="/gostd/math/big/nat.go.html#2074033">bitLen</a></span><span class="op" id="2077799">(</span><span class="op" id="2077800">)</span><span class="op" id="2077801">)</span><span class="op" id="2077802">/</span><span class="ident" id="2077803"><a href="/gostd/math/big/nat.go.html#2061611">math</a></span><span class="op" id="2077807">.</span><span class="ident" id="2077808"><a href="/gostd/math/log10.go.html#2302252">Log2</a></span><span class="op" id="2077812">(</span><span class="builtintype" id="2077813">float64</span><span class="op" id="2077820">(</span><span class="ident" id="2077821"><a href="/gostd/math/big/nat.go.html#2077580">b</a></span><span class="op" id="2077822">)</span><span class="op" id="2077823">)</span><span class="op" id="2077824">)</span>&nbsp;<span class="op" id="2077826">+</span>&nbsp;<span class="num" id="2077828">1</span>&nbsp;<span class="comment" id="2077830">//&nbsp;off&nbsp;by&nbsp;one&nbsp;at&nbsp;most</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2077853">s</span>&nbsp;<span class="op" id="2077855">:=</span>&nbsp;<span class="builtinfunc" id="2077858">make</span><span class="op" id="2077862">(</span><span class="op" id="2077863">[</span><span class="op" id="2077864">]</span><span class="builtintype" id="2077865">byte</span><span class="op" id="2077869">,</span>&nbsp;<span class="ident" id="2077871"><a href="/gostd/math/big/nat.go.html#2077774">i</a></span><span class="op" id="2077872">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2077876">//&nbsp;convert&nbsp;power&nbsp;of&nbsp;two&nbsp;and&nbsp;non&nbsp;power&nbsp;of&nbsp;two&nbsp;bases&nbsp;separately</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2077939">if</span>&nbsp;<span class="ident" id="2077942"><a href="/gostd/math/big/nat.go.html#2077580">b</a></span>&nbsp;<span class="op" id="2077944">==</span>&nbsp;<span class="ident" id="2077947"><a href="/gostd/math/big/nat.go.html#2077580">b</a></span><span class="op" id="2077948">&amp;</span><span class="op" id="2077949">-</span><span class="ident" id="2077950"><a href="/gostd/math/big/nat.go.html#2077580">b</a></span>&nbsp;<span class="op" id="2077952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2077956">//&nbsp;shift&nbsp;is&nbsp;base-b&nbsp;digit&nbsp;size&nbsp;in&nbsp;bits</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2077996">shift</span>&nbsp;<span class="op" id="2078002">:=</span>&nbsp;<span class="ident" id="2078005"><a href="/gostd/math/big/nat.go.html#2086034">trailingZeroBits</a></span><span class="op" id="2078021">(</span><span class="ident" id="2078022"><a href="/gostd/math/big/nat.go.html#2077580">b</a></span><span class="op" id="2078023">)</span>&nbsp;<span class="comment" id="2078025">//&nbsp;shift&nbsp;&gt;&nbsp;0&nbsp;because&nbsp;b&nbsp;&gt;=&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078055">mask</span>&nbsp;<span class="op" id="2078060">:=</span>&nbsp;<span class="ident" id="2078063"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2078067">(</span><span class="num" id="2078068">1</span><span class="op" id="2078069">)</span><span class="op" id="2078070">&lt;&lt;</span><span class="ident" id="2078072"><a href="/gostd/math/big/nat.go.html#2077996">shift</a></span>&nbsp;<span class="op" id="2078078">-</span>&nbsp;<span class="num" id="2078080">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078084">w</span>&nbsp;<span class="op" id="2078086">:=</span>&nbsp;<span class="ident" id="2078089"><a href="/gostd/math/big/nat.go.html#2077540">x</a></span><span class="op" id="2078090">[</span><span class="num" id="2078091">0</span><span class="op" id="2078092">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078096">nbits</span>&nbsp;<span class="op" id="2078102">:=</span>&nbsp;<span class="builtintype" id="2078105">uint</span><span class="op" id="2078109">(</span><span class="ident" id="2078110"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span><span class="op" id="2078112">)</span>&nbsp;<span class="comment" id="2078114">//&nbsp;number&nbsp;of&nbsp;unprocessed&nbsp;bits&nbsp;in&nbsp;w</span><br>
<span class="lineno"></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2078152">//&nbsp;convert&nbsp;less-significant&nbsp;words</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2078188">for</span>&nbsp;<span class="ident" id="2078192">k</span>&nbsp;<span class="op" id="2078194">:=</span>&nbsp;<span class="num" id="2078197">1</span><span class="op" id="2078198">;</span>&nbsp;<span class="ident" id="2078200"><a href="/gostd/math/big/nat.go.html#2078192">k</a></span>&nbsp;<span class="op" id="2078202">&lt;</span>&nbsp;<span class="builtinfunc" id="2078204">len</span><span class="op" id="2078207">(</span><span class="ident" id="2078208"><a href="/gostd/math/big/nat.go.html#2077540">x</a></span><span class="op" id="2078209">)</span><span class="op" id="2078210">;</span>&nbsp;<span class="ident" id="2078212"><a href="/gostd/math/big/nat.go.html#2078192">k</a></span><span class="op" id="2078213">++</span>&nbsp;<span class="op" id="2078216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2078221">//&nbsp;convert&nbsp;full&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2078247">for</span>&nbsp;<span class="ident" id="2078251"><a href="/gostd/math/big/nat.go.html#2078096">nbits</a></span>&nbsp;<span class="op" id="2078257">&gt;=</span>&nbsp;<span class="ident" id="2078260"><a href="/gostd/math/big/nat.go.html#2077996">shift</a></span>&nbsp;<span class="op" id="2078266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078272"><a href="/gostd/math/big/nat.go.html#2077774">i</a></span><span class="op" id="2078273">--</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078280"><a href="/gostd/math/big/nat.go.html#2077853">s</a></span><span class="op" id="2078281">[</span><span class="ident" id="2078282"><a href="/gostd/math/big/nat.go.html#2077774">i</a></span><span class="op" id="2078283">]</span>&nbsp;<span class="op" id="2078285">=</span>&nbsp;<span class="ident" id="2078287"><a href="/gostd/math/big/nat.go.html#2077554">charset</a></span><span class="op" id="2078294">[</span><span class="ident" id="2078295"><a href="/gostd/math/big/nat.go.html#2078084">w</a></span><span class="op" id="2078296">&amp;</span><span class="ident" id="2078297"><a href="/gostd/math/big/nat.go.html#2078055">mask</a></span><span class="op" id="2078301">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078307"><a href="/gostd/math/big/nat.go.html#2078084">w</a></span>&nbsp;<span class="op" id="2078309">&gt;&gt;=</span>&nbsp;<span class="ident" id="2078313"><a href="/gostd/math/big/nat.go.html#2077996">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078323"><a href="/gostd/math/big/nat.go.html#2078096">nbits</a></span>&nbsp;<span class="op" id="2078329">-=</span>&nbsp;<span class="ident" id="2078332"><a href="/gostd/math/big/nat.go.html#2077996">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2078341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2078347">//&nbsp;convert&nbsp;any&nbsp;partial&nbsp;leading&nbsp;digit&nbsp;and&nbsp;advance&nbsp;to&nbsp;next&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2078412">if</span>&nbsp;<span class="ident" id="2078415"><a href="/gostd/math/big/nat.go.html#2078096">nbits</a></span>&nbsp;<span class="op" id="2078421">==</span>&nbsp;<span class="num" id="2078424">0</span>&nbsp;<span class="op" id="2078426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2078432">//&nbsp;no&nbsp;partial&nbsp;digit&nbsp;remaining,&nbsp;just&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078480"><a href="/gostd/math/big/nat.go.html#2078084">w</a></span>&nbsp;<span class="op" id="2078482">=</span>&nbsp;<span class="ident" id="2078484"><a href="/gostd/math/big/nat.go.html#2077540">x</a></span><span class="op" id="2078485">[</span><span class="ident" id="2078486"><a href="/gostd/math/big/nat.go.html#2078192">k</a></span><span class="op" id="2078487">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078493"><a href="/gostd/math/big/nat.go.html#2078096">nbits</a></span>&nbsp;<span class="op" id="2078499">=</span>&nbsp;<span class="ident" id="2078501"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2078507">}</span>&nbsp;<span class="keyword" id="2078509">else</span>&nbsp;<span class="op" id="2078514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2078520">//&nbsp;partial&nbsp;digit&nbsp;in&nbsp;current&nbsp;(k-1)&nbsp;and&nbsp;next&nbsp;(k)&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078576"><a href="/gostd/math/big/nat.go.html#2078084">w</a></span>&nbsp;<span class="op" id="2078578">|=</span>&nbsp;<span class="ident" id="2078581"><a href="/gostd/math/big/nat.go.html#2077540">x</a></span><span class="op" id="2078582">[</span><span class="ident" id="2078583"><a href="/gostd/math/big/nat.go.html#2078192">k</a></span><span class="op" id="2078584">]</span>&nbsp;<span class="op" id="2078586">&lt;&lt;</span>&nbsp;<span class="ident" id="2078589"><a href="/gostd/math/big/nat.go.html#2078096">nbits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078599"><a href="/gostd/math/big/nat.go.html#2077774">i</a></span><span class="op" id="2078600">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078607"><a href="/gostd/math/big/nat.go.html#2077853">s</a></span><span class="op" id="2078608">[</span><span class="ident" id="2078609"><a href="/gostd/math/big/nat.go.html#2077774">i</a></span><span class="op" id="2078610">]</span>&nbsp;<span class="op" id="2078612">=</span>&nbsp;<span class="ident" id="2078614"><a href="/gostd/math/big/nat.go.html#2077554">charset</a></span><span class="op" id="2078621">[</span><span class="ident" id="2078622"><a href="/gostd/math/big/nat.go.html#2078084">w</a></span><span class="op" id="2078623">&amp;</span><span class="ident" id="2078624"><a href="/gostd/math/big/nat.go.html#2078055">mask</a></span><span class="op" id="2078628">]</span><br>
<span class="lineno">780</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2078635">//&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078650"><a href="/gostd/math/big/nat.go.html#2078084">w</a></span>&nbsp;<span class="op" id="2078652">=</span>&nbsp;<span class="ident" id="2078654"><a href="/gostd/math/big/nat.go.html#2077540">x</a></span><span class="op" id="2078655">[</span><span class="ident" id="2078656"><a href="/gostd/math/big/nat.go.html#2078192">k</a></span><span class="op" id="2078657">]</span>&nbsp;<span class="op" id="2078659">&gt;&gt;</span>&nbsp;<span class="op" id="2078662">(</span><span class="ident" id="2078663"><a href="/gostd/math/big/nat.go.html#2077996">shift</a></span>&nbsp;<span class="op" id="2078669">-</span>&nbsp;<span class="ident" id="2078671"><a href="/gostd/math/big/nat.go.html#2078096">nbits</a></span><span class="op" id="2078676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078682"><a href="/gostd/math/big/nat.go.html#2078096">nbits</a></span>&nbsp;<span class="op" id="2078688">=</span>&nbsp;<span class="ident" id="2078690"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span>&nbsp;<span class="op" id="2078693">-</span>&nbsp;<span class="op" id="2078695">(</span><span class="ident" id="2078696"><a href="/gostd/math/big/nat.go.html#2077996">shift</a></span>&nbsp;<span class="op" id="2078702">-</span>&nbsp;<span class="ident" id="2078704"><a href="/gostd/math/big/nat.go.html#2078096">nbits</a></span><span class="op" id="2078709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2078714">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2078718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2078723">//&nbsp;convert&nbsp;digits&nbsp;of&nbsp;most-significant&nbsp;word&nbsp;(omit&nbsp;leading&nbsp;zeros)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2078789">for</span>&nbsp;<span class="ident" id="2078793"><a href="/gostd/math/big/nat.go.html#2078096">nbits</a></span>&nbsp;<span class="op" id="2078799">&gt;=</span>&nbsp;<span class="num" id="2078802">0</span>&nbsp;<span class="op" id="2078804">&amp;&amp;</span>&nbsp;<span class="ident" id="2078807"><a href="/gostd/math/big/nat.go.html#2078084">w</a></span>&nbsp;<span class="op" id="2078809">!=</span>&nbsp;<span class="num" id="2078812">0</span>&nbsp;<span class="op" id="2078814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078819"><a href="/gostd/math/big/nat.go.html#2077774">i</a></span><span class="op" id="2078820">--</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078826"><a href="/gostd/math/big/nat.go.html#2077853">s</a></span><span class="op" id="2078827">[</span><span class="ident" id="2078828"><a href="/gostd/math/big/nat.go.html#2077774">i</a></span><span class="op" id="2078829">]</span>&nbsp;<span class="op" id="2078831">=</span>&nbsp;<span class="ident" id="2078833"><a href="/gostd/math/big/nat.go.html#2077554">charset</a></span><span class="op" id="2078840">[</span><span class="ident" id="2078841"><a href="/gostd/math/big/nat.go.html#2078084">w</a></span><span class="op" id="2078842">&amp;</span><span class="ident" id="2078843"><a href="/gostd/math/big/nat.go.html#2078055">mask</a></span><span class="op" id="2078847">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078852"><a href="/gostd/math/big/nat.go.html#2078084">w</a></span>&nbsp;<span class="op" id="2078854">&gt;&gt;=</span>&nbsp;<span class="ident" id="2078858"><a href="/gostd/math/big/nat.go.html#2077996">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2078867"><a href="/gostd/math/big/nat.go.html#2078096">nbits</a></span>&nbsp;<span class="op" id="2078873">-=</span>&nbsp;<span class="ident" id="2078876"><a href="/gostd/math/big/nat.go.html#2077996">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2078884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2078888">}</span>&nbsp;<span class="keyword" id="2078890">else</span>&nbsp;<span class="op" id="2078895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2078899">//&nbsp;determine&nbsp;&#34;big&nbsp;base&#34;;&nbsp;i.e.,&nbsp;the&nbsp;largest&nbsp;possible&nbsp;value&nbsp;bb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2078962">//&nbsp;that&nbsp;is&nbsp;a&nbsp;power&nbsp;of&nbsp;base&nbsp;b&nbsp;and&nbsp;still&nbsp;fits&nbsp;into&nbsp;a&nbsp;Word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2079020">//&nbsp;(as&nbsp;in&nbsp;10^19&nbsp;for&nbsp;19&nbsp;decimal&nbsp;digits&nbsp;in&nbsp;a&nbsp;64bit&nbsp;Word)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2079077">bb</span>&nbsp;<span class="op" id="2079080">:=</span>&nbsp;<span class="ident" id="2079083"><a href="/gostd/math/big/nat.go.html#2077580">b</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2079090">//&nbsp;big&nbsp;base&nbsp;is&nbsp;b**ndigits</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2079118">ndigits</span>&nbsp;<span class="op" id="2079126">:=</span>&nbsp;<span class="num" id="2079129">1</span>&nbsp;<span class="comment" id="2079131">//&nbsp;number&nbsp;of&nbsp;base&nbsp;b&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2079160">for</span>&nbsp;<span class="ident" id="2079164">max</span>&nbsp;<span class="op" id="2079168">:=</span>&nbsp;<span class="ident" id="2079171"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2079175">(</span><span class="ident" id="2079176"><a href="/gostd/math/big/arith.go.html#2031219">_M</a></span>&nbsp;<span class="op" id="2079179">/</span>&nbsp;<span class="ident" id="2079181"><a href="/gostd/math/big/nat.go.html#2077580">b</a></span><span class="op" id="2079182">)</span><span class="op" id="2079183">;</span>&nbsp;<span class="ident" id="2079185"><a href="/gostd/math/big/nat.go.html#2079077">bb</a></span>&nbsp;<span class="op" id="2079188">&lt;=</span>&nbsp;<span class="ident" id="2079191"><a href="/gostd/math/big/nat.go.html#2079164">max</a></span><span class="op" id="2079194">;</span>&nbsp;<span class="ident" id="2079196"><a href="/gostd/math/big/nat.go.html#2079077">bb</a></span>&nbsp;<span class="op" id="2079199">*=</span>&nbsp;<span class="ident" id="2079202"><a href="/gostd/math/big/nat.go.html#2077580">b</a></span>&nbsp;<span class="op" id="2079204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2079209"><a href="/gostd/math/big/nat.go.html#2079118">ndigits</a></span><span class="op" id="2079216">++</span>&nbsp;<span class="comment" id="2079219">//&nbsp;maximize&nbsp;ndigits&nbsp;where&nbsp;bb&nbsp;=&nbsp;b**ndigits,&nbsp;bb&nbsp;&lt;=&nbsp;_M</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2079273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2079278">//&nbsp;construct&nbsp;table&nbsp;of&nbsp;successive&nbsp;squares&nbsp;of&nbsp;bb*leafSize&nbsp;to&nbsp;use&nbsp;in&nbsp;subdivisions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2079359">//&nbsp;result&nbsp;(table&nbsp;!=&nbsp;nil)&nbsp;&lt;=&gt;&nbsp;(len(x)&nbsp;&gt;&nbsp;leafSize&nbsp;&gt;&nbsp;0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2079414">table</span>&nbsp;<span class="op" id="2079420">:=</span>&nbsp;<span class="ident" id="2079423"><a href="/gostd/math/big/nat.go.html#2083997">divisors</a></span><span class="op" id="2079431">(</span><span class="builtinfunc" id="2079432">len</span><span class="op" id="2079435">(</span><span class="ident" id="2079436"><a href="/gostd/math/big/nat.go.html#2077540">x</a></span><span class="op" id="2079437">)</span><span class="op" id="2079438">,</span>&nbsp;<span class="ident" id="2079440"><a href="/gostd/math/big/nat.go.html#2077580">b</a></span><span class="op" id="2079441">,</span>&nbsp;<span class="ident" id="2079443"><a href="/gostd/math/big/nat.go.html#2079118">ndigits</a></span><span class="op" id="2079450">,</span>&nbsp;<span class="ident" id="2079452"><a href="/gostd/math/big/nat.go.html#2079077">bb</a></span><span class="op" id="2079454">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2079459">//&nbsp;preserve&nbsp;x,&nbsp;create&nbsp;local&nbsp;copy&nbsp;for&nbsp;use&nbsp;by&nbsp;convertWords</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2079518">q</span>&nbsp;<span class="op" id="2079520">:=</span>&nbsp;<span class="ident" id="2079523"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2079526">(</span><span class="builtintype" id="2079527">nil</span><span class="op" id="2079530">)</span><span class="op" id="2079531">.</span><span class="ident" id="2079532"><a href="/gostd/math/big/nat.go.html#2063110">set</a></span><span class="op" id="2079535">(</span><span class="ident" id="2079536"><a href="/gostd/math/big/nat.go.html#2077540">x</a></span><span class="op" id="2079537">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2079542">//&nbsp;convert&nbsp;q&nbsp;to&nbsp;string&nbsp;s&nbsp;in&nbsp;base&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2079579"><a href="/gostd/math/big/nat.go.html#2079518">q</a></span><span class="op" id="2079580">.</span><span class="ident" id="2079581"><a href="/gostd/math/big/nat.go.html#2081069">convertWords</a></span><span class="op" id="2079593">(</span><span class="ident" id="2079594"><a href="/gostd/math/big/nat.go.html#2077853">s</a></span><span class="op" id="2079595">,</span>&nbsp;<span class="ident" id="2079597"><a href="/gostd/math/big/nat.go.html#2077554">charset</a></span><span class="op" id="2079604">,</span>&nbsp;<span class="ident" id="2079606"><a href="/gostd/math/big/nat.go.html#2077580">b</a></span><span class="op" id="2079607">,</span>&nbsp;<span class="ident" id="2079609"><a href="/gostd/math/big/nat.go.html#2079118">ndigits</a></span><span class="op" id="2079616">,</span>&nbsp;<span class="ident" id="2079618"><a href="/gostd/math/big/nat.go.html#2079077">bb</a></span><span class="op" id="2079620">,</span>&nbsp;<span class="ident" id="2079622"><a href="/gostd/math/big/nat.go.html#2079414">table</a></span><span class="op" id="2079627">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2079632">//&nbsp;strip&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2079657">//&nbsp;(x&nbsp;!=&nbsp;0;&nbsp;thus&nbsp;s&nbsp;must&nbsp;contain&nbsp;at&nbsp;least&nbsp;one&nbsp;non-zero&nbsp;digit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2079719">//&nbsp;and&nbsp;the&nbsp;loop&nbsp;will&nbsp;terminate)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2079753"><a href="/gostd/math/big/nat.go.html#2077774">i</a></span>&nbsp;<span class="op" id="2079755">=</span>&nbsp;<span class="num" id="2079757">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2079761">for</span>&nbsp;<span class="ident" id="2079765">zero</span>&nbsp;<span class="op" id="2079770">:=</span>&nbsp;<span class="ident" id="2079773"><a href="/gostd/math/big/nat.go.html#2077554">charset</a></span><span class="op" id="2079780">[</span><span class="num" id="2079781">0</span><span class="op" id="2079782">]</span><span class="op" id="2079783">;</span>&nbsp;<span class="ident" id="2079785"><a href="/gostd/math/big/nat.go.html#2077853">s</a></span><span class="op" id="2079786">[</span><span class="ident" id="2079787"><a href="/gostd/math/big/nat.go.html#2077774">i</a></span><span class="op" id="2079788">]</span>&nbsp;<span class="op" id="2079790">==</span>&nbsp;<span class="ident" id="2079793"><a href="/gostd/math/big/nat.go.html#2079765">zero</a></span><span class="op" id="2079797">;</span>&nbsp;<span class="op" id="2079799">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2079804"><a href="/gostd/math/big/nat.go.html#2077774">i</a></span><span class="op" id="2079805">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2079810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2079813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2079817">return</span>&nbsp;<span class="builtintype" id="2079824">string</span><span class="op" id="2079830">(</span><span class="ident" id="2079831"><a href="/gostd/math/big/nat.go.html#2077853">s</a></span><span class="op" id="2079832">[</span><span class="ident" id="2079833"><a href="/gostd/math/big/nat.go.html#2077774">i</a></span><span class="op" id="2079834">:</span><span class="op" id="2079835">]</span><span class="op" id="2079836">)</span><br>
<span class="lineno">825</span><span class="op" id="2079838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2079841">//&nbsp;Convert&nbsp;words&nbsp;of&nbsp;q&nbsp;to&nbsp;base&nbsp;b&nbsp;digits&nbsp;in&nbsp;s.&nbsp;If&nbsp;q&nbsp;is&nbsp;large,&nbsp;it&nbsp;is&nbsp;recursively&nbsp;&#34;split&nbsp;in&nbsp;half&#34;</span><br>
<span class="lineno"></span><span class="comment" id="2079935">//&nbsp;by&nbsp;nat/nat&nbsp;division&nbsp;using&nbsp;tabulated&nbsp;divisors.&nbsp;Otherwise,&nbsp;it&nbsp;is&nbsp;converted&nbsp;iteratively&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="2080029">//&nbsp;repeated&nbsp;nat/Word&nbsp;division.</span><br>
<span class="lineno">830</span><span class="comment" id="2080060">//</span><br>
<span class="lineno"></span><span class="comment" id="2080063">//&nbsp;The&nbsp;iterative&nbsp;method&nbsp;processes&nbsp;n&nbsp;Words&nbsp;by&nbsp;n&nbsp;divW()&nbsp;calls,&nbsp;each&nbsp;of&nbsp;which&nbsp;visits&nbsp;every&nbsp;Word&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2080163">//&nbsp;incrementally&nbsp;shortened&nbsp;q&nbsp;for&nbsp;a&nbsp;total&nbsp;of&nbsp;n&nbsp;+&nbsp;(n-1)&nbsp;+&nbsp;(n-2)&nbsp;...&nbsp;+&nbsp;2&nbsp;+&nbsp;1,&nbsp;or&nbsp;n(n+1)/2&nbsp;divW()&#39;s.</span><br>
<span class="lineno"></span><span class="comment" id="2080260">//&nbsp;Recursive&nbsp;conversion&nbsp;divides&nbsp;q&nbsp;by&nbsp;its&nbsp;approximate&nbsp;square&nbsp;root,&nbsp;yielding&nbsp;two&nbsp;parts,&nbsp;each&nbsp;half</span><br>
<span class="lineno"></span><span class="comment" id="2080356">//&nbsp;the&nbsp;size&nbsp;of&nbsp;q.&nbsp;Using&nbsp;the&nbsp;iterative&nbsp;method&nbsp;on&nbsp;both&nbsp;halves&nbsp;means&nbsp;2&nbsp;*&nbsp;(n/2)(n/2&nbsp;+&nbsp;1)/2&nbsp;divW()&#39;s</span><br>
<span class="lineno">835</span><span class="comment" id="2080452">//&nbsp;plus&nbsp;the&nbsp;expensive&nbsp;long&nbsp;div().&nbsp;Asymptotically,&nbsp;the&nbsp;ratio&nbsp;is&nbsp;favorable&nbsp;at&nbsp;1/2&nbsp;the&nbsp;divW()&#39;s,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2080550">//&nbsp;is&nbsp;made&nbsp;better&nbsp;by&nbsp;splitting&nbsp;the&nbsp;subblocks&nbsp;recursively.&nbsp;Best&nbsp;is&nbsp;to&nbsp;split&nbsp;blocks&nbsp;until&nbsp;one&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="2080647">//&nbsp;split&nbsp;would&nbsp;take&nbsp;longer&nbsp;(because&nbsp;of&nbsp;the&nbsp;nat/nat&nbsp;div())&nbsp;than&nbsp;the&nbsp;twice&nbsp;as&nbsp;many&nbsp;divW()&#39;s&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2080744">//&nbsp;iterative&nbsp;approach.&nbsp;This&nbsp;threshold&nbsp;is&nbsp;represented&nbsp;by&nbsp;leafSize.&nbsp;Benchmarking&nbsp;of&nbsp;leafSize&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2080842">//&nbsp;range&nbsp;2..64&nbsp;shows&nbsp;that&nbsp;values&nbsp;of&nbsp;8&nbsp;and&nbsp;16&nbsp;work&nbsp;well,&nbsp;with&nbsp;a&nbsp;4x&nbsp;speedup&nbsp;at&nbsp;medium&nbsp;lengths&nbsp;and</span><br>
<span class="lineno">840</span><span class="comment" id="2080938">//&nbsp;~30x&nbsp;for&nbsp;20000&nbsp;digits.&nbsp;Use&nbsp;nat_test.go&#39;s&nbsp;BenchmarkLeafSize&nbsp;tests&nbsp;to&nbsp;optimize&nbsp;leafSize&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="2081031">//&nbsp;specific&nbsp;hardware.</span><br>
<span class="lineno"></span><span class="comment" id="2081053">//</span><br>
<span class="lineno"></span><span class="keyword" id="2081056">func</span>&nbsp;<span class="op" id="2081061">(</span><span class="ident" id="2081062">q</span>&nbsp;<span class="ident" id="2081064"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2081067">)</span>&nbsp;<span class="ident" id="2081069">convertWords</span><span class="op" id="2081081">(</span><span class="ident" id="2081082">s</span>&nbsp;<span class="op" id="2081084">[</span><span class="op" id="2081085">]</span><span class="builtintype" id="2081086">byte</span><span class="op" id="2081090">,</span>&nbsp;<span class="ident" id="2081092">charset</span>&nbsp;<span class="builtintype" id="2081100">string</span><span class="op" id="2081106">,</span>&nbsp;<span class="ident" id="2081108">b</span>&nbsp;<span class="ident" id="2081110"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2081114">,</span>&nbsp;<span class="ident" id="2081116">ndigits</span>&nbsp;<span class="builtintype" id="2081124">int</span><span class="op" id="2081127">,</span>&nbsp;<span class="ident" id="2081129">bb</span>&nbsp;<span class="ident" id="2081132"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2081136">,</span>&nbsp;<span class="ident" id="2081138">table</span>&nbsp;<span class="op" id="2081144">[</span><span class="op" id="2081145">]</span><span class="ident" id="2081146"><a href="/gostd/math/big/nat.go.html#2083515">divisor</a></span><span class="op" id="2081153">)</span>&nbsp;<span class="op" id="2081155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2081158">//&nbsp;split&nbsp;larger&nbsp;blocks&nbsp;recursively</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2081194">if</span>&nbsp;<span class="ident" id="2081197"><a href="/gostd/math/big/nat.go.html#2081138">table</a></span>&nbsp;<span class="op" id="2081203">!=</span>&nbsp;<span class="builtintype" id="2081206">nil</span>&nbsp;<span class="op" id="2081210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2081214">//&nbsp;len(q)&nbsp;&gt;&nbsp;leafSize&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2081241">var</span>&nbsp;<span class="ident" id="2081245">r</span>&nbsp;<span class="ident" id="2081247"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2081253">index</span>&nbsp;<span class="op" id="2081259">:=</span>&nbsp;<span class="builtinfunc" id="2081262">len</span><span class="op" id="2081265">(</span><span class="ident" id="2081266"><a href="/gostd/math/big/nat.go.html#2081138">table</a></span><span class="op" id="2081271">)</span>&nbsp;<span class="op" id="2081273">-</span>&nbsp;<span class="num" id="2081275">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2081279">for</span>&nbsp;<span class="builtinfunc" id="2081283">len</span><span class="op" id="2081286">(</span><span class="ident" id="2081287"><a href="/gostd/math/big/nat.go.html#2081062">q</a></span><span class="op" id="2081288">)</span>&nbsp;<span class="op" id="2081290">&gt;</span>&nbsp;<span class="ident" id="2081292"><a href="/gostd/math/big/nat.go.html#2083427">leafSize</a></span>&nbsp;<span class="op" id="2081301">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2081306">//&nbsp;find&nbsp;divisor&nbsp;close&nbsp;to&nbsp;sqrt(q)&nbsp;if&nbsp;possible,&nbsp;but&nbsp;in&nbsp;any&nbsp;case&nbsp;&lt;&nbsp;q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2081375">maxLength</span>&nbsp;<span class="op" id="2081385">:=</span>&nbsp;<span class="ident" id="2081388"><a href="/gostd/math/big/nat.go.html#2081062">q</a></span><span class="op" id="2081389">.</span><span class="ident" id="2081390"><a href="/gostd/math/big/nat.go.html#2074033">bitLen</a></span><span class="op" id="2081396">(</span><span class="op" id="2081397">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2081403">//&nbsp;~=&nbsp;log2&nbsp;q,&nbsp;or&nbsp;at&nbsp;of&nbsp;least&nbsp;largest&nbsp;possible&nbsp;q&nbsp;of&nbsp;this&nbsp;bit&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2081473">minLength</span>&nbsp;<span class="op" id="2081483">:=</span>&nbsp;<span class="ident" id="2081486"><a href="/gostd/math/big/nat.go.html#2081375">maxLength</a></span>&nbsp;<span class="op" id="2081496">&gt;&gt;</span>&nbsp;<span class="num" id="2081499">1</span>&nbsp;<span class="comment" id="2081501">//&nbsp;~=&nbsp;log2&nbsp;sqrt(q)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2081523">for</span>&nbsp;<span class="ident" id="2081527"><a href="/gostd/math/big/nat.go.html#2081253">index</a></span>&nbsp;<span class="op" id="2081533">&gt;</span>&nbsp;<span class="num" id="2081535">0</span>&nbsp;<span class="op" id="2081537">&amp;&amp;</span>&nbsp;<span class="ident" id="2081540"><a href="/gostd/math/big/nat.go.html#2081138">table</a></span><span class="op" id="2081545">[</span><span class="ident" id="2081546"><a href="/gostd/math/big/nat.go.html#2081253">index</a></span><span class="op" id="2081551">-</span><span class="num" id="2081552">1</span><span class="op" id="2081553">]</span><span class="op" id="2081554">.</span><span class="ident" id="2081555"><a href="/gostd/math/big/nat.go.html#2083557">nbits</a></span>&nbsp;<span class="op" id="2081561">&gt;</span>&nbsp;<span class="ident" id="2081563"><a href="/gostd/math/big/nat.go.html#2081473">minLength</a></span>&nbsp;<span class="op" id="2081573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2081579"><a href="/gostd/math/big/nat.go.html#2081253">index</a></span><span class="op" id="2081584">--</span>&nbsp;<span class="comment" id="2081587">//&nbsp;desired</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2081601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2081606">if</span>&nbsp;<span class="ident" id="2081609"><a href="/gostd/math/big/nat.go.html#2081138">table</a></span><span class="op" id="2081614">[</span><span class="ident" id="2081615"><a href="/gostd/math/big/nat.go.html#2081253">index</a></span><span class="op" id="2081620">]</span><span class="op" id="2081621">.</span><span class="ident" id="2081622"><a href="/gostd/math/big/nat.go.html#2083557">nbits</a></span>&nbsp;<span class="op" id="2081628">&gt;=</span>&nbsp;<span class="ident" id="2081631"><a href="/gostd/math/big/nat.go.html#2081375">maxLength</a></span>&nbsp;<span class="op" id="2081641">&amp;&amp;</span>&nbsp;<span class="ident" id="2081644"><a href="/gostd/math/big/nat.go.html#2081138">table</a></span><span class="op" id="2081649">[</span><span class="ident" id="2081650"><a href="/gostd/math/big/nat.go.html#2081253">index</a></span><span class="op" id="2081655">]</span><span class="op" id="2081656">.</span><span class="ident" id="2081657"><a href="/gostd/math/big/nat.go.html#2083533">bbb</a></span><span class="op" id="2081660">.</span><span class="ident" id="2081661"><a href="/gostd/math/big/nat.go.html#2063929">cmp</a></span><span class="op" id="2081664">(</span><span class="ident" id="2081665"><a href="/gostd/math/big/nat.go.html#2081062">q</a></span><span class="op" id="2081666">)</span>&nbsp;<span class="op" id="2081668">&gt;=</span>&nbsp;<span class="num" id="2081671">0</span>&nbsp;<span class="op" id="2081673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2081679"><a href="/gostd/math/big/nat.go.html#2081253">index</a></span><span class="op" id="2081684">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2081691">if</span>&nbsp;<span class="ident" id="2081694"><a href="/gostd/math/big/nat.go.html#2081253">index</a></span>&nbsp;<span class="op" id="2081700">&lt;</span>&nbsp;<span class="num" id="2081702">0</span>&nbsp;<span class="op" id="2081704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2081711">panic</span><span class="op" id="2081716">(</span><span class="string" id="2081717">&#34;internal&nbsp;inconsistency&#34;</span><span class="op" id="2081741">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2081747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2081752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2081758">//&nbsp;split&nbsp;q&nbsp;into&nbsp;the&nbsp;two&nbsp;digit&nbsp;number&nbsp;(q&#39;*bbb&nbsp;+&nbsp;r)&nbsp;to&nbsp;form&nbsp;independent&nbsp;subblocks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2081841"><a href="/gostd/math/big/nat.go.html#2081062">q</a></span><span class="op" id="2081842">,</span>&nbsp;<span class="ident" id="2081844"><a href="/gostd/math/big/nat.go.html#2081245">r</a></span>&nbsp;<span class="op" id="2081846">=</span>&nbsp;<span class="ident" id="2081848"><a href="/gostd/math/big/nat.go.html#2081062">q</a></span><span class="op" id="2081849">.</span><span class="ident" id="2081850"><a href="/gostd/math/big/nat.go.html#2071989">div</a></span><span class="op" id="2081853">(</span><span class="ident" id="2081854"><a href="/gostd/math/big/nat.go.html#2081245">r</a></span><span class="op" id="2081855">,</span>&nbsp;<span class="ident" id="2081857"><a href="/gostd/math/big/nat.go.html#2081062">q</a></span><span class="op" id="2081858">,</span>&nbsp;<span class="ident" id="2081860"><a href="/gostd/math/big/nat.go.html#2081138">table</a></span><span class="op" id="2081865">[</span><span class="ident" id="2081866"><a href="/gostd/math/big/nat.go.html#2081253">index</a></span><span class="op" id="2081871">]</span><span class="op" id="2081872">.</span><span class="ident" id="2081873"><a href="/gostd/math/big/nat.go.html#2083533">bbb</a></span><span class="op" id="2081876">)</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2081882">//&nbsp;convert&nbsp;subblocks&nbsp;and&nbsp;collect&nbsp;results&nbsp;in&nbsp;s[:h]&nbsp;and&nbsp;s[h:]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2081945">h</span>&nbsp;<span class="op" id="2081947">:=</span>&nbsp;<span class="builtinfunc" id="2081950">len</span><span class="op" id="2081953">(</span><span class="ident" id="2081954"><a href="/gostd/math/big/nat.go.html#2081082">s</a></span><span class="op" id="2081955">)</span>&nbsp;<span class="op" id="2081957">-</span>&nbsp;<span class="ident" id="2081959"><a href="/gostd/math/big/nat.go.html#2081138">table</a></span><span class="op" id="2081964">[</span><span class="ident" id="2081965"><a href="/gostd/math/big/nat.go.html#2081253">index</a></span><span class="op" id="2081970">]</span><span class="op" id="2081971">.</span><span class="ident" id="2081972"><a href="/gostd/math/big/nat.go.html#2083637">ndigits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2081983"><a href="/gostd/math/big/nat.go.html#2081245">r</a></span><span class="op" id="2081984">.</span><span class="ident" id="2081985"><a href="/gostd/math/big/nat.go.html#2081069">convertWords</a></span><span class="op" id="2081997">(</span><span class="ident" id="2081998"><a href="/gostd/math/big/nat.go.html#2081082">s</a></span><span class="op" id="2081999">[</span><span class="ident" id="2082000"><a href="/gostd/math/big/nat.go.html#2081945">h</a></span><span class="op" id="2082001">:</span><span class="op" id="2082002">]</span><span class="op" id="2082003">,</span>&nbsp;<span class="ident" id="2082005"><a href="/gostd/math/big/nat.go.html#2081092">charset</a></span><span class="op" id="2082012">,</span>&nbsp;<span class="ident" id="2082014"><a href="/gostd/math/big/nat.go.html#2081108">b</a></span><span class="op" id="2082015">,</span>&nbsp;<span class="ident" id="2082017"><a href="/gostd/math/big/nat.go.html#2081116">ndigits</a></span><span class="op" id="2082024">,</span>&nbsp;<span class="ident" id="2082026"><a href="/gostd/math/big/nat.go.html#2081129">bb</a></span><span class="op" id="2082028">,</span>&nbsp;<span class="ident" id="2082030"><a href="/gostd/math/big/nat.go.html#2081138">table</a></span><span class="op" id="2082035">[</span><span class="num" id="2082036">0</span><span class="op" id="2082037">:</span><span class="ident" id="2082038"><a href="/gostd/math/big/nat.go.html#2081253">index</a></span><span class="op" id="2082043">]</span><span class="op" id="2082044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2082049"><a href="/gostd/math/big/nat.go.html#2081082">s</a></span>&nbsp;<span class="op" id="2082051">=</span>&nbsp;<span class="ident" id="2082053"><a href="/gostd/math/big/nat.go.html#2081082">s</a></span><span class="op" id="2082054">[</span><span class="op" id="2082055">:</span><span class="ident" id="2082056"><a href="/gostd/math/big/nat.go.html#2081945">h</a></span><span class="op" id="2082057">]</span>&nbsp;<span class="comment" id="2082059">//&nbsp;==&nbsp;q.convertWords(s,&nbsp;charset,&nbsp;b,&nbsp;ndigits,&nbsp;bb,&nbsp;table[0:index+1])</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2082128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2082131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2082135">//&nbsp;having&nbsp;split&nbsp;any&nbsp;large&nbsp;blocks&nbsp;now&nbsp;process&nbsp;the&nbsp;remaining&nbsp;(small)&nbsp;block&nbsp;iteratively</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2082221">i</span>&nbsp;<span class="op" id="2082223">:=</span>&nbsp;<span class="builtinfunc" id="2082226">len</span><span class="op" id="2082229">(</span><span class="ident" id="2082230"><a href="/gostd/math/big/nat.go.html#2081082">s</a></span><span class="op" id="2082231">)</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2082234">var</span>&nbsp;<span class="ident" id="2082238">r</span>&nbsp;<span class="ident" id="2082240"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2082246">if</span>&nbsp;<span class="ident" id="2082249"><a href="/gostd/math/big/nat.go.html#2081108">b</a></span>&nbsp;<span class="op" id="2082251">==</span>&nbsp;<span class="num" id="2082254">10</span>&nbsp;<span class="op" id="2082257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2082261">//&nbsp;hard-coding&nbsp;for&nbsp;10&nbsp;here&nbsp;speeds&nbsp;this&nbsp;up&nbsp;by&nbsp;1.25x&nbsp;(allows&nbsp;for&nbsp;/&nbsp;and&nbsp;%&nbsp;by&nbsp;constants)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2082348">for</span>&nbsp;<span class="builtinfunc" id="2082352">len</span><span class="op" id="2082355">(</span><span class="ident" id="2082356"><a href="/gostd/math/big/nat.go.html#2081062">q</a></span><span class="op" id="2082357">)</span>&nbsp;<span class="op" id="2082359">&gt;</span>&nbsp;<span class="num" id="2082361">0</span>&nbsp;<span class="op" id="2082363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2082368">//&nbsp;extract&nbsp;least&nbsp;significant,&nbsp;base&nbsp;bb&nbsp;&#34;digit&#34;</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2082417"><a href="/gostd/math/big/nat.go.html#2081062">q</a></span><span class="op" id="2082418">,</span>&nbsp;<span class="ident" id="2082420"><a href="/gostd/math/big/nat.go.html#2082238">r</a></span>&nbsp;<span class="op" id="2082422">=</span>&nbsp;<span class="ident" id="2082424"><a href="/gostd/math/big/nat.go.html#2081062">q</a></span><span class="op" id="2082425">.</span><span class="ident" id="2082426"><a href="/gostd/math/big/nat.go.html#2071689">divW</a></span><span class="op" id="2082430">(</span><span class="ident" id="2082431"><a href="/gostd/math/big/nat.go.html#2081062">q</a></span><span class="op" id="2082432">,</span>&nbsp;<span class="ident" id="2082434"><a href="/gostd/math/big/nat.go.html#2081129">bb</a></span><span class="op" id="2082436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2082441">for</span>&nbsp;<span class="ident" id="2082445">j</span>&nbsp;<span class="op" id="2082447">:=</span>&nbsp;<span class="num" id="2082450">0</span><span class="op" id="2082451">;</span>&nbsp;<span class="ident" id="2082453"><a href="/gostd/math/big/nat.go.html#2082445">j</a></span>&nbsp;<span class="op" id="2082455">&lt;</span>&nbsp;<span class="ident" id="2082457"><a href="/gostd/math/big/nat.go.html#2081116">ndigits</a></span>&nbsp;<span class="op" id="2082465">&amp;&amp;</span>&nbsp;<span class="ident" id="2082468"><a href="/gostd/math/big/nat.go.html#2082221">i</a></span>&nbsp;<span class="op" id="2082470">&gt;</span>&nbsp;<span class="num" id="2082472">0</span><span class="op" id="2082473">;</span>&nbsp;<span class="ident" id="2082475"><a href="/gostd/math/big/nat.go.html#2082445">j</a></span><span class="op" id="2082476">++</span>&nbsp;<span class="op" id="2082479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2082485"><a href="/gostd/math/big/nat.go.html#2082221">i</a></span><span class="op" id="2082486">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2082493">//&nbsp;avoid&nbsp;%&nbsp;computation&nbsp;since&nbsp;r%10&nbsp;==&nbsp;r&nbsp;-&nbsp;int(r/10)*10;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2082552">//&nbsp;this&nbsp;appears&nbsp;to&nbsp;be&nbsp;faster&nbsp;for&nbsp;BenchmarkString10000Base10</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2082616">//&nbsp;and&nbsp;smaller&nbsp;strings&nbsp;(but&nbsp;a&nbsp;bit&nbsp;slower&nbsp;for&nbsp;larger&nbsp;ones)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2082678">t</span>&nbsp;<span class="op" id="2082680">:=</span>&nbsp;<span class="ident" id="2082683"><a href="/gostd/math/big/nat.go.html#2082238">r</a></span>&nbsp;<span class="op" id="2082685">/</span>&nbsp;<span class="num" id="2082687">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2082694"><a href="/gostd/math/big/nat.go.html#2081082">s</a></span><span class="op" id="2082695">[</span><span class="ident" id="2082696"><a href="/gostd/math/big/nat.go.html#2082221">i</a></span><span class="op" id="2082697">]</span>&nbsp;<span class="op" id="2082699">=</span>&nbsp;<span class="ident" id="2082701"><a href="/gostd/math/big/nat.go.html#2081092">charset</a></span><span class="op" id="2082708">[</span><span class="ident" id="2082709"><a href="/gostd/math/big/nat.go.html#2082238">r</a></span><span class="op" id="2082710">-</span><span class="ident" id="2082711"><a href="/gostd/math/big/nat.go.html#2082678">t</a></span><span class="op" id="2082712">&lt;&lt;</span><span class="num" id="2082714">3</span><span class="op" id="2082715">-</span><span class="ident" id="2082716"><a href="/gostd/math/big/nat.go.html#2082678">t</a></span><span class="op" id="2082717">-</span><span class="ident" id="2082718"><a href="/gostd/math/big/nat.go.html#2082678">t</a></span><span class="op" id="2082719">]</span>&nbsp;<span class="comment" id="2082721">//&nbsp;TODO(gri)&nbsp;replace&nbsp;w/&nbsp;t*10&nbsp;once&nbsp;compiler&nbsp;produces&nbsp;better&nbsp;code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2082789"><a href="/gostd/math/big/nat.go.html#2082238">r</a></span>&nbsp;<span class="op" id="2082791">=</span>&nbsp;<span class="ident" id="2082793"><a href="/gostd/math/big/nat.go.html#2082678">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2082798">}</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2082802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2082805">}</span>&nbsp;<span class="keyword" id="2082807">else</span>&nbsp;<span class="op" id="2082812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2082816">for</span>&nbsp;<span class="builtinfunc" id="2082820">len</span><span class="op" id="2082823">(</span><span class="ident" id="2082824"><a href="/gostd/math/big/nat.go.html#2081062">q</a></span><span class="op" id="2082825">)</span>&nbsp;<span class="op" id="2082827">&gt;</span>&nbsp;<span class="num" id="2082829">0</span>&nbsp;<span class="op" id="2082831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2082836">//&nbsp;extract&nbsp;least&nbsp;significant,&nbsp;base&nbsp;bb&nbsp;&#34;digit&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2082885"><a href="/gostd/math/big/nat.go.html#2081062">q</a></span><span class="op" id="2082886">,</span>&nbsp;<span class="ident" id="2082888"><a href="/gostd/math/big/nat.go.html#2082238">r</a></span>&nbsp;<span class="op" id="2082890">=</span>&nbsp;<span class="ident" id="2082892"><a href="/gostd/math/big/nat.go.html#2081062">q</a></span><span class="op" id="2082893">.</span><span class="ident" id="2082894"><a href="/gostd/math/big/nat.go.html#2071689">divW</a></span><span class="op" id="2082898">(</span><span class="ident" id="2082899"><a href="/gostd/math/big/nat.go.html#2081062">q</a></span><span class="op" id="2082900">,</span>&nbsp;<span class="ident" id="2082902"><a href="/gostd/math/big/nat.go.html#2081129">bb</a></span><span class="op" id="2082904">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2082909">for</span>&nbsp;<span class="ident" id="2082913">j</span>&nbsp;<span class="op" id="2082915">:=</span>&nbsp;<span class="num" id="2082918">0</span><span class="op" id="2082919">;</span>&nbsp;<span class="ident" id="2082921"><a href="/gostd/math/big/nat.go.html#2082913">j</a></span>&nbsp;<span class="op" id="2082923">&lt;</span>&nbsp;<span class="ident" id="2082925"><a href="/gostd/math/big/nat.go.html#2081116">ndigits</a></span>&nbsp;<span class="op" id="2082933">&amp;&amp;</span>&nbsp;<span class="ident" id="2082936"><a href="/gostd/math/big/nat.go.html#2082221">i</a></span>&nbsp;<span class="op" id="2082938">&gt;</span>&nbsp;<span class="num" id="2082940">0</span><span class="op" id="2082941">;</span>&nbsp;<span class="ident" id="2082943"><a href="/gostd/math/big/nat.go.html#2082913">j</a></span><span class="op" id="2082944">++</span>&nbsp;<span class="op" id="2082947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2082953"><a href="/gostd/math/big/nat.go.html#2082221">i</a></span><span class="op" id="2082954">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2082961"><a href="/gostd/math/big/nat.go.html#2081082">s</a></span><span class="op" id="2082962">[</span><span class="ident" id="2082963"><a href="/gostd/math/big/nat.go.html#2082221">i</a></span><span class="op" id="2082964">]</span>&nbsp;<span class="op" id="2082966">=</span>&nbsp;<span class="ident" id="2082968"><a href="/gostd/math/big/nat.go.html#2081092">charset</a></span><span class="op" id="2082975">[</span><span class="ident" id="2082976"><a href="/gostd/math/big/nat.go.html#2082238">r</a></span><span class="op" id="2082977">%</span><span class="ident" id="2082978"><a href="/gostd/math/big/nat.go.html#2081108">b</a></span><span class="op" id="2082979">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2082985"><a href="/gostd/math/big/nat.go.html#2082238">r</a></span>&nbsp;<span class="op" id="2082987">/=</span>&nbsp;<span class="ident" id="2082990"><a href="/gostd/math/big/nat.go.html#2081108">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2082995">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2082999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2083002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2083006">//&nbsp;prepend&nbsp;high-order&nbsp;zeroes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2083036">zero</span>&nbsp;<span class="op" id="2083041">:=</span>&nbsp;<span class="ident" id="2083044"><a href="/gostd/math/big/nat.go.html#2081092">charset</a></span><span class="op" id="2083051">[</span><span class="num" id="2083052">0</span><span class="op" id="2083053">]</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2083056">for</span>&nbsp;<span class="ident" id="2083060"><a href="/gostd/math/big/nat.go.html#2082221">i</a></span>&nbsp;<span class="op" id="2083062">&gt;</span>&nbsp;<span class="num" id="2083064">0</span>&nbsp;<span class="op" id="2083066">{</span>&nbsp;<span class="comment" id="2083068">//&nbsp;while&nbsp;need&nbsp;more&nbsp;leading&nbsp;zeroes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2083104"><a href="/gostd/math/big/nat.go.html#2082221">i</a></span><span class="op" id="2083105">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2083110"><a href="/gostd/math/big/nat.go.html#2081082">s</a></span><span class="op" id="2083111">[</span><span class="ident" id="2083112"><a href="/gostd/math/big/nat.go.html#2082221">i</a></span><span class="op" id="2083113">]</span>&nbsp;<span class="op" id="2083115">=</span>&nbsp;<span class="ident" id="2083117"><a href="/gostd/math/big/nat.go.html#2083036">zero</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2083123">}</span><br>
<span class="lineno"></span><span class="op" id="2083125">}</span><br>
<span class="lineno">910</span><br>
<span class="lineno"></span><span class="comment" id="2083128">//&nbsp;Split&nbsp;blocks&nbsp;greater&nbsp;than&nbsp;leafSize&nbsp;Words&nbsp;(or&nbsp;set&nbsp;to&nbsp;0&nbsp;to&nbsp;disable&nbsp;recursive&nbsp;conversion)</span><br>
<span class="lineno"></span><span class="comment" id="2083218">//&nbsp;Benchmark&nbsp;and&nbsp;configure&nbsp;leafSize&nbsp;using:&nbsp;go&nbsp;test&nbsp;-bench=&#34;Leaf&#34;</span><br>
<span class="lineno"></span><span class="comment" id="2083283">//&nbsp;&nbsp;&nbsp;8&nbsp;and&nbsp;16&nbsp;effective&nbsp;on&nbsp;3.0&nbsp;GHz&nbsp;Xeon&nbsp;&#34;Clovertown&#34;&nbsp;CPU&nbsp;(128&nbsp;byte&nbsp;cache&nbsp;lines)</span><br>
<span class="lineno"></span><span class="comment" id="2083363">//&nbsp;&nbsp;&nbsp;8&nbsp;and&nbsp;16&nbsp;effective&nbsp;on&nbsp;2.66&nbsp;GHz&nbsp;Core&nbsp;2&nbsp;Duo&nbsp;&#34;Penryn&#34;&nbsp;CPU</span><br>
<span class="lineno">915</span><span class="keyword" id="2083423">var</span>&nbsp;<span class="ident" id="2083427">leafSize</span>&nbsp;<span class="builtintype" id="2083436">int</span>&nbsp;<span class="op" id="2083440">=</span>&nbsp;<span class="num" id="2083442">8</span>&nbsp;<span class="comment" id="2083444">//&nbsp;number&nbsp;of&nbsp;Word-size&nbsp;binary&nbsp;values&nbsp;treat&nbsp;as&nbsp;a&nbsp;monolithic&nbsp;block</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2083510">type</span>&nbsp;<span class="ident" id="2083515">divisor</span>&nbsp;<span class="keyword" id="2083523">struct</span>&nbsp;<span class="op" id="2083530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2083533">bbb</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2083541"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="comment" id="2083545">//&nbsp;divisor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2083557">nbits</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2083565">int</span>&nbsp;<span class="comment" id="2083569">//&nbsp;bit&nbsp;length&nbsp;of&nbsp;divisor&nbsp;(discounting&nbsp;leading&nbsp;zeroes)&nbsp;~=&nbsp;log2(bbb)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2083637">ndigits</span>&nbsp;<span class="builtintype" id="2083645">int</span>&nbsp;<span class="comment" id="2083649">//&nbsp;digit&nbsp;length&nbsp;of&nbsp;divisor&nbsp;in&nbsp;terms&nbsp;of&nbsp;output&nbsp;base&nbsp;digits</span><br>
<span class="lineno"></span><span class="op" id="2083707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2083710">var</span>&nbsp;<span class="ident" id="2083714">cacheBase10</span>&nbsp;<span class="keyword" id="2083726">struct</span>&nbsp;<span class="op" id="2083733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2083736"><a href="/gostd/math/big/nat.go.html#2061632">sync</a></span><span class="op" id="2083740">.</span><span class="ident" id="2083741"><a href="/gostd/sync/mutex.go.html#1443974">Mutex</a></span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2083748">table</span>&nbsp;<span class="op" id="2083754">[</span><span class="num" id="2083755">64</span><span class="op" id="2083757">]</span><span class="ident" id="2083758"><a href="/gostd/math/big/nat.go.html#2083515">divisor</a></span>&nbsp;<span class="comment" id="2083766">//&nbsp;cached&nbsp;divisors&nbsp;for&nbsp;base&nbsp;10</span><br>
<span class="lineno"></span><span class="op" id="2083797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2083800">//&nbsp;expWW&nbsp;computes&nbsp;x**y</span><br>
<span class="lineno"></span><span class="keyword" id="2083823">func</span>&nbsp;<span class="op" id="2083828">(</span><span class="ident" id="2083829">z</span>&nbsp;<span class="ident" id="2083831"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2083834">)</span>&nbsp;<span class="ident" id="2083836">expWW</span><span class="op" id="2083841">(</span><span class="ident" id="2083842">x</span><span class="op" id="2083843">,</span>&nbsp;<span class="ident" id="2083845">y</span>&nbsp;<span class="ident" id="2083847"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2083851">)</span>&nbsp;<span class="ident" id="2083853"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2083857">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2083860">return</span>&nbsp;<span class="ident" id="2083867"><a href="/gostd/math/big/nat.go.html#2083829">z</a></span><span class="op" id="2083868">.</span><span class="ident" id="2083869"><a href="/gostd/math/big/nat.go.html#2090082">expNN</a></span><span class="op" id="2083874">(</span><span class="ident" id="2083875"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2083878">(</span><span class="builtintype" id="2083879">nil</span><span class="op" id="2083882">)</span><span class="op" id="2083883">.</span><span class="ident" id="2083884"><a href="/gostd/math/big/nat.go.html#2062665">setWord</a></span><span class="op" id="2083891">(</span><span class="ident" id="2083892"><a href="/gostd/math/big/nat.go.html#2083842">x</a></span><span class="op" id="2083893">)</span><span class="op" id="2083894">,</span>&nbsp;<span class="ident" id="2083896"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2083899">(</span><span class="builtintype" id="2083900">nil</span><span class="op" id="2083903">)</span><span class="op" id="2083904">.</span><span class="ident" id="2083905"><a href="/gostd/math/big/nat.go.html#2062665">setWord</a></span><span class="op" id="2083912">(</span><span class="ident" id="2083913"><a href="/gostd/math/big/nat.go.html#2083845">y</a></span><span class="op" id="2083914">)</span><span class="op" id="2083915">,</span>&nbsp;<span class="builtintype" id="2083917">nil</span><span class="op" id="2083920">)</span><br>
<span class="lineno"></span><span class="op" id="2083922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2083925">//&nbsp;construct&nbsp;table&nbsp;of&nbsp;powers&nbsp;of&nbsp;bb*leafSize&nbsp;to&nbsp;use&nbsp;in&nbsp;subdivisions</span><br>
<span class="lineno"></span><span class="keyword" id="2083992">func</span>&nbsp;<span class="ident" id="2083997">divisors</span><span class="op" id="2084005">(</span><span class="ident" id="2084006">m</span>&nbsp;<span class="builtintype" id="2084008">int</span><span class="op" id="2084011">,</span>&nbsp;<span class="ident" id="2084013">b</span>&nbsp;<span class="ident" id="2084015"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2084019">,</span>&nbsp;<span class="ident" id="2084021">ndigits</span>&nbsp;<span class="builtintype" id="2084029">int</span><span class="op" id="2084032">,</span>&nbsp;<span class="ident" id="2084034">bb</span>&nbsp;<span class="ident" id="2084037"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2084041">)</span>&nbsp;<span class="op" id="2084043">[</span><span class="op" id="2084044">]</span><span class="ident" id="2084045"><a href="/gostd/math/big/nat.go.html#2083515">divisor</a></span>&nbsp;<span class="op" id="2084053">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2084056">//&nbsp;only&nbsp;compute&nbsp;table&nbsp;when&nbsp;recursive&nbsp;conversion&nbsp;is&nbsp;enabled&nbsp;and&nbsp;x&nbsp;is&nbsp;large</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2084131">if</span>&nbsp;<span class="ident" id="2084134"><a href="/gostd/math/big/nat.go.html#2083427">leafSize</a></span>&nbsp;<span class="op" id="2084143">==</span>&nbsp;<span class="num" id="2084146">0</span>&nbsp;<span class="op" id="2084148">||</span>&nbsp;<span class="ident" id="2084151"><a href="/gostd/math/big/nat.go.html#2084006">m</a></span>&nbsp;<span class="op" id="2084153">&lt;=</span>&nbsp;<span class="ident" id="2084156"><a href="/gostd/math/big/nat.go.html#2083427">leafSize</a></span>&nbsp;<span class="op" id="2084165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2084169">return</span>&nbsp;<span class="builtintype" id="2084176">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2084181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2084185">//&nbsp;determine&nbsp;k&nbsp;where&nbsp;(bb**leafSize)**(2**k)&nbsp;&gt;=&nbsp;sqrt(x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2084241">k</span>&nbsp;<span class="op" id="2084243">:=</span>&nbsp;<span class="num" id="2084246">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2084249">for</span>&nbsp;<span class="ident" id="2084253">words</span>&nbsp;<span class="op" id="2084259">:=</span>&nbsp;<span class="ident" id="2084262"><a href="/gostd/math/big/nat.go.html#2083427">leafSize</a></span><span class="op" id="2084270">;</span>&nbsp;<span class="ident" id="2084272"><a href="/gostd/math/big/nat.go.html#2084253">words</a></span>&nbsp;<span class="op" id="2084278">&lt;</span>&nbsp;<span class="ident" id="2084280"><a href="/gostd/math/big/nat.go.html#2084006">m</a></span><span class="op" id="2084281">&gt;&gt;</span><span class="num" id="2084283">1</span>&nbsp;<span class="op" id="2084285">&amp;&amp;</span>&nbsp;<span class="ident" id="2084288"><a href="/gostd/math/big/nat.go.html#2084241">k</a></span>&nbsp;<span class="op" id="2084290">&lt;</span>&nbsp;<span class="builtinfunc" id="2084292">len</span><span class="op" id="2084295">(</span><span class="ident" id="2084296"><a href="/gostd/math/big/nat.go.html#2083714">cacheBase10</a></span><span class="op" id="2084307">.</span><span class="ident" id="2084308"><a href="/gostd/math/big/nat.go.html#2083748">table</a></span><span class="op" id="2084313">)</span><span class="op" id="2084314">;</span>&nbsp;<span class="ident" id="2084316"><a href="/gostd/math/big/nat.go.html#2084253">words</a></span>&nbsp;<span class="op" id="2084322">&lt;&lt;=</span>&nbsp;<span class="num" id="2084326">1</span>&nbsp;<span class="op" id="2084328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2084332"><a href="/gostd/math/big/nat.go.html#2084241">k</a></span><span class="op" id="2084333">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2084337">}</span><br>
<span class="lineno">945</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2084341">//&nbsp;reuse&nbsp;and&nbsp;extend&nbsp;existing&nbsp;table&nbsp;of&nbsp;divisors&nbsp;or&nbsp;create&nbsp;new&nbsp;table&nbsp;as&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2084424">var</span>&nbsp;<span class="ident" id="2084428">table</span>&nbsp;<span class="op" id="2084434">[</span><span class="op" id="2084435">]</span><span class="ident" id="2084436"><a href="/gostd/math/big/nat.go.html#2083515">divisor</a></span>&nbsp;<span class="comment" id="2084444">//&nbsp;for&nbsp;b&nbsp;==&nbsp;10,&nbsp;table&nbsp;overlaps&nbsp;with&nbsp;cacheBase10.table</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2084499">if</span>&nbsp;<span class="ident" id="2084502"><a href="/gostd/math/big/nat.go.html#2084013">b</a></span>&nbsp;<span class="op" id="2084504">==</span>&nbsp;<span class="num" id="2084507">10</span>&nbsp;<span class="op" id="2084510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2084514"><a href="/gostd/math/big/nat.go.html#2083714">cacheBase10</a></span><span class="op" id="2084525">.</span><span class="ident" id="2084526"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="2084530">(</span><span class="op" id="2084531">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2084535"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span>&nbsp;<span class="op" id="2084541">=</span>&nbsp;<span class="ident" id="2084543"><a href="/gostd/math/big/nat.go.html#2083714">cacheBase10</a></span><span class="op" id="2084554">.</span><span class="ident" id="2084555"><a href="/gostd/math/big/nat.go.html#2083748">table</a></span><span class="op" id="2084560">[</span><span class="num" id="2084561">0</span><span class="op" id="2084562">:</span><span class="ident" id="2084563"><a href="/gostd/math/big/nat.go.html#2084241">k</a></span><span class="op" id="2084564">]</span>&nbsp;<span class="comment" id="2084566">//&nbsp;reuse&nbsp;old&nbsp;table&nbsp;for&nbsp;this&nbsp;conversion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2084606">}</span>&nbsp;<span class="keyword" id="2084608">else</span>&nbsp;<span class="op" id="2084613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2084617"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span>&nbsp;<span class="op" id="2084623">=</span>&nbsp;<span class="builtinfunc" id="2084625">make</span><span class="op" id="2084629">(</span><span class="op" id="2084630">[</span><span class="op" id="2084631">]</span><span class="ident" id="2084632"><a href="/gostd/math/big/nat.go.html#2083515">divisor</a></span><span class="op" id="2084639">,</span>&nbsp;<span class="ident" id="2084641"><a href="/gostd/math/big/nat.go.html#2084241">k</a></span><span class="op" id="2084642">)</span>&nbsp;<span class="comment" id="2084644">//&nbsp;create&nbsp;new&nbsp;table&nbsp;for&nbsp;this&nbsp;conversion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2084685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2084689">//&nbsp;extend&nbsp;table</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2084706">if</span>&nbsp;<span class="ident" id="2084709"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span><span class="op" id="2084714">[</span><span class="ident" id="2084715"><a href="/gostd/math/big/nat.go.html#2084241">k</a></span><span class="op" id="2084716">-</span><span class="num" id="2084717">1</span><span class="op" id="2084718">]</span><span class="op" id="2084719">.</span><span class="ident" id="2084720"><a href="/gostd/math/big/nat.go.html#2083637">ndigits</a></span>&nbsp;<span class="op" id="2084728">==</span>&nbsp;<span class="num" id="2084731">0</span>&nbsp;<span class="op" id="2084733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2084737">//&nbsp;add&nbsp;new&nbsp;entries&nbsp;as&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2084768">var</span>&nbsp;<span class="ident" id="2084772">larger</span>&nbsp;<span class="ident" id="2084779"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2084785">for</span>&nbsp;<span class="ident" id="2084789">i</span>&nbsp;<span class="op" id="2084791">:=</span>&nbsp;<span class="num" id="2084794">0</span><span class="op" id="2084795">;</span>&nbsp;<span class="ident" id="2084797"><a href="/gostd/math/big/nat.go.html#2084789">i</a></span>&nbsp;<span class="op" id="2084799">&lt;</span>&nbsp;<span class="ident" id="2084801"><a href="/gostd/math/big/nat.go.html#2084241">k</a></span><span class="op" id="2084802">;</span>&nbsp;<span class="ident" id="2084804"><a href="/gostd/math/big/nat.go.html#2084789">i</a></span><span class="op" id="2084805">++</span>&nbsp;<span class="op" id="2084808">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2084813">if</span>&nbsp;<span class="ident" id="2084816"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span><span class="op" id="2084821">[</span><span class="ident" id="2084822"><a href="/gostd/math/big/nat.go.html#2084789">i</a></span><span class="op" id="2084823">]</span><span class="op" id="2084824">.</span><span class="ident" id="2084825"><a href="/gostd/math/big/nat.go.html#2083637">ndigits</a></span>&nbsp;<span class="op" id="2084833">==</span>&nbsp;<span class="num" id="2084836">0</span>&nbsp;<span class="op" id="2084838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2084844">if</span>&nbsp;<span class="ident" id="2084847"><a href="/gostd/math/big/nat.go.html#2084789">i</a></span>&nbsp;<span class="op" id="2084849">==</span>&nbsp;<span class="num" id="2084852">0</span>&nbsp;<span class="op" id="2084854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2084861"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span><span class="op" id="2084866">[</span><span class="num" id="2084867">0</span><span class="op" id="2084868">]</span><span class="op" id="2084869">.</span><span class="ident" id="2084870"><a href="/gostd/math/big/nat.go.html#2083533">bbb</a></span>&nbsp;<span class="op" id="2084874">=</span>&nbsp;<span class="ident" id="2084876"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2084879">(</span><span class="builtintype" id="2084880">nil</span><span class="op" id="2084883">)</span><span class="op" id="2084884">.</span><span class="ident" id="2084885"><a href="/gostd/math/big/nat.go.html#2083836">expWW</a></span><span class="op" id="2084890">(</span><span class="ident" id="2084891"><a href="/gostd/math/big/nat.go.html#2084034">bb</a></span><span class="op" id="2084893">,</span>&nbsp;<span class="ident" id="2084895"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2084899">(</span><span class="ident" id="2084900"><a href="/gostd/math/big/nat.go.html#2083427">leafSize</a></span><span class="op" id="2084908">)</span><span class="op" id="2084909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2084916"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span><span class="op" id="2084921">[</span><span class="num" id="2084922">0</span><span class="op" id="2084923">]</span><span class="op" id="2084924">.</span><span class="ident" id="2084925"><a href="/gostd/math/big/nat.go.html#2083637">ndigits</a></span>&nbsp;<span class="op" id="2084933">=</span>&nbsp;<span class="ident" id="2084935"><a href="/gostd/math/big/nat.go.html#2084021">ndigits</a></span>&nbsp;<span class="op" id="2084943">*</span>&nbsp;<span class="ident" id="2084945"><a href="/gostd/math/big/nat.go.html#2083427">leafSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2084958">}</span>&nbsp;<span class="keyword" id="2084960">else</span>&nbsp;<span class="op" id="2084965">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2084972"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span><span class="op" id="2084977">[</span><span class="ident" id="2084978"><a href="/gostd/math/big/nat.go.html#2084789">i</a></span><span class="op" id="2084979">]</span><span class="op" id="2084980">.</span><span class="ident" id="2084981"><a href="/gostd/math/big/nat.go.html#2083533">bbb</a></span>&nbsp;<span class="op" id="2084985">=</span>&nbsp;<span class="ident" id="2084987"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2084990">(</span><span class="builtintype" id="2084991">nil</span><span class="op" id="2084994">)</span><span class="op" id="2084995">.</span><span class="ident" id="2084996"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2084999">(</span><span class="ident" id="2085000"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span><span class="op" id="2085005">[</span><span class="ident" id="2085006"><a href="/gostd/math/big/nat.go.html#2084789">i</a></span><span class="op" id="2085007">-</span><span class="num" id="2085008">1</span><span class="op" id="2085009">]</span><span class="op" id="2085010">.</span><span class="ident" id="2085011"><a href="/gostd/math/big/nat.go.html#2083533">bbb</a></span><span class="op" id="2085014">,</span>&nbsp;<span class="ident" id="2085016"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span><span class="op" id="2085021">[</span><span class="ident" id="2085022"><a href="/gostd/math/big/nat.go.html#2084789">i</a></span><span class="op" id="2085023">-</span><span class="num" id="2085024">1</span><span class="op" id="2085025">]</span><span class="op" id="2085026">.</span><span class="ident" id="2085027"><a href="/gostd/math/big/nat.go.html#2083533">bbb</a></span><span class="op" id="2085030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2085037"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span><span class="op" id="2085042">[</span><span class="ident" id="2085043"><a href="/gostd/math/big/nat.go.html#2084789">i</a></span><span class="op" id="2085044">]</span><span class="op" id="2085045">.</span><span class="ident" id="2085046"><a href="/gostd/math/big/nat.go.html#2083637">ndigits</a></span>&nbsp;<span class="op" id="2085054">=</span>&nbsp;<span class="num" id="2085056">2</span>&nbsp;<span class="op" id="2085058">*</span>&nbsp;<span class="ident" id="2085060"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span><span class="op" id="2085065">[</span><span class="ident" id="2085066"><a href="/gostd/math/big/nat.go.html#2084789">i</a></span><span class="op" id="2085067">-</span><span class="num" id="2085068">1</span><span class="op" id="2085069">]</span><span class="op" id="2085070">.</span><span class="ident" id="2085071"><a href="/gostd/math/big/nat.go.html#2083637">ndigits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2085083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2085090">//&nbsp;optimization:&nbsp;exploit&nbsp;aggregated&nbsp;extra&nbsp;bits&nbsp;in&nbsp;macro&nbsp;blocks</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2085157"><a href="/gostd/math/big/nat.go.html#2084772">larger</a></span>&nbsp;<span class="op" id="2085164">=</span>&nbsp;<span class="ident" id="2085166"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2085169">(</span><span class="builtintype" id="2085170">nil</span><span class="op" id="2085173">)</span><span class="op" id="2085174">.</span><span class="ident" id="2085175"><a href="/gostd/math/big/nat.go.html#2063110">set</a></span><span class="op" id="2085178">(</span><span class="ident" id="2085179"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span><span class="op" id="2085184">[</span><span class="ident" id="2085185"><a href="/gostd/math/big/nat.go.html#2084789">i</a></span><span class="op" id="2085186">]</span><span class="op" id="2085187">.</span><span class="ident" id="2085188"><a href="/gostd/math/big/nat.go.html#2083533">bbb</a></span><span class="op" id="2085191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2085197">for</span>&nbsp;<span class="ident" id="2085201"><a href="/gostd/math/big/arith_decl.go.html#2035407">mulAddVWW</a></span><span class="op" id="2085210">(</span><span class="ident" id="2085211"><a href="/gostd/math/big/nat.go.html#2084772">larger</a></span><span class="op" id="2085217">,</span>&nbsp;<span class="ident" id="2085219"><a href="/gostd/math/big/nat.go.html#2084772">larger</a></span><span class="op" id="2085225">,</span>&nbsp;<span class="ident" id="2085227"><a href="/gostd/math/big/nat.go.html#2084013">b</a></span><span class="op" id="2085228">,</span>&nbsp;<span class="num" id="2085230">0</span><span class="op" id="2085231">)</span>&nbsp;<span class="op" id="2085233">==</span>&nbsp;<span class="num" id="2085236">0</span>&nbsp;<span class="op" id="2085238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2085245"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span><span class="op" id="2085250">[</span><span class="ident" id="2085251"><a href="/gostd/math/big/nat.go.html#2084789">i</a></span><span class="op" id="2085252">]</span><span class="op" id="2085253">.</span><span class="ident" id="2085254"><a href="/gostd/math/big/nat.go.html#2083533">bbb</a></span>&nbsp;<span class="op" id="2085258">=</span>&nbsp;<span class="ident" id="2085260"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span><span class="op" id="2085265">[</span><span class="ident" id="2085266"><a href="/gostd/math/big/nat.go.html#2084789">i</a></span><span class="op" id="2085267">]</span><span class="op" id="2085268">.</span><span class="ident" id="2085269"><a href="/gostd/math/big/nat.go.html#2083533">bbb</a></span><span class="op" id="2085272">.</span><span class="ident" id="2085273"><a href="/gostd/math/big/nat.go.html#2063110">set</a></span><span class="op" id="2085276">(</span><span class="ident" id="2085277"><a href="/gostd/math/big/nat.go.html#2084772">larger</a></span><span class="op" id="2085283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2085290"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span><span class="op" id="2085295">[</span><span class="ident" id="2085296"><a href="/gostd/math/big/nat.go.html#2084789">i</a></span><span class="op" id="2085297">]</span><span class="op" id="2085298">.</span><span class="ident" id="2085299"><a href="/gostd/math/big/nat.go.html#2083637">ndigits</a></span><span class="op" id="2085306">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2085313">}</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2085320"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span><span class="op" id="2085325">[</span><span class="ident" id="2085326"><a href="/gostd/math/big/nat.go.html#2084789">i</a></span><span class="op" id="2085327">]</span><span class="op" id="2085328">.</span><span class="ident" id="2085329"><a href="/gostd/math/big/nat.go.html#2083557">nbits</a></span>&nbsp;<span class="op" id="2085335">=</span>&nbsp;<span class="ident" id="2085337"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span><span class="op" id="2085342">[</span><span class="ident" id="2085343"><a href="/gostd/math/big/nat.go.html#2084789">i</a></span><span class="op" id="2085344">]</span><span class="op" id="2085345">.</span><span class="ident" id="2085346"><a href="/gostd/math/big/nat.go.html#2083533">bbb</a></span><span class="op" id="2085349">.</span><span class="ident" id="2085350"><a href="/gostd/math/big/nat.go.html#2074033">bitLen</a></span><span class="op" id="2085356">(</span><span class="op" id="2085357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2085362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2085366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2085369">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2085373">if</span>&nbsp;<span class="ident" id="2085376"><a href="/gostd/math/big/nat.go.html#2084013">b</a></span>&nbsp;<span class="op" id="2085378">==</span>&nbsp;<span class="num" id="2085381">10</span>&nbsp;<span class="op" id="2085384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2085388"><a href="/gostd/math/big/nat.go.html#2083714">cacheBase10</a></span><span class="op" id="2085399">.</span><span class="ident" id="2085400"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="2085406">(</span><span class="op" id="2085407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2085410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2085414">return</span>&nbsp;<span class="ident" id="2085421"><a href="/gostd/math/big/nat.go.html#2084428">table</a></span><br>
<span class="lineno"></span><span class="op" id="2085427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2085430">const</span>&nbsp;<span class="ident" id="2085436">deBruijn32</span>&nbsp;<span class="op" id="2085447">=</span>&nbsp;<span class="num" id="2085449">0x077CB531</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span><span class="keyword" id="2085461">var</span>&nbsp;<span class="ident" id="2085465">deBruijn32Lookup</span>&nbsp;<span class="op" id="2085482">=</span>&nbsp;<span class="op" id="2085484">[</span><span class="op" id="2085485">]</span><span class="builtintype" id="2085486">byte</span><span class="op" id="2085490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2085493">0</span><span class="op" id="2085494">,</span>&nbsp;<span class="num" id="2085496">1</span><span class="op" id="2085497">,</span>&nbsp;<span class="num" id="2085499">28</span><span class="op" id="2085501">,</span>&nbsp;<span class="num" id="2085503">2</span><span class="op" id="2085504">,</span>&nbsp;<span class="num" id="2085506">29</span><span class="op" id="2085508">,</span>&nbsp;<span class="num" id="2085510">14</span><span class="op" id="2085512">,</span>&nbsp;<span class="num" id="2085514">24</span><span class="op" id="2085516">,</span>&nbsp;<span class="num" id="2085518">3</span><span class="op" id="2085519">,</span>&nbsp;<span class="num" id="2085521">30</span><span class="op" id="2085523">,</span>&nbsp;<span class="num" id="2085525">22</span><span class="op" id="2085527">,</span>&nbsp;<span class="num" id="2085529">20</span><span class="op" id="2085531">,</span>&nbsp;<span class="num" id="2085533">15</span><span class="op" id="2085535">,</span>&nbsp;<span class="num" id="2085537">25</span><span class="op" id="2085539">,</span>&nbsp;<span class="num" id="2085541">17</span><span class="op" id="2085543">,</span>&nbsp;<span class="num" id="2085545">4</span><span class="op" id="2085546">,</span>&nbsp;<span class="num" id="2085548">8</span><span class="op" id="2085549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2085552">31</span><span class="op" id="2085554">,</span>&nbsp;<span class="num" id="2085556">27</span><span class="op" id="2085558">,</span>&nbsp;<span class="num" id="2085560">13</span><span class="op" id="2085562">,</span>&nbsp;<span class="num" id="2085564">23</span><span class="op" id="2085566">,</span>&nbsp;<span class="num" id="2085568">21</span><span class="op" id="2085570">,</span>&nbsp;<span class="num" id="2085572">19</span><span class="op" id="2085574">,</span>&nbsp;<span class="num" id="2085576">16</span><span class="op" id="2085578">,</span>&nbsp;<span class="num" id="2085580">7</span><span class="op" id="2085581">,</span>&nbsp;<span class="num" id="2085583">26</span><span class="op" id="2085585">,</span>&nbsp;<span class="num" id="2085587">12</span><span class="op" id="2085589">,</span>&nbsp;<span class="num" id="2085591">18</span><span class="op" id="2085593">,</span>&nbsp;<span class="num" id="2085595">6</span><span class="op" id="2085596">,</span>&nbsp;<span class="num" id="2085598">11</span><span class="op" id="2085600">,</span>&nbsp;<span class="num" id="2085602">5</span><span class="op" id="2085603">,</span>&nbsp;<span class="num" id="2085605">10</span><span class="op" id="2085607">,</span>&nbsp;<span class="num" id="2085609">9</span><span class="op" id="2085610">,</span><br>
<span class="lineno"></span><span class="op" id="2085612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">995</span><span class="keyword" id="2085615">const</span>&nbsp;<span class="ident" id="2085621">deBruijn64</span>&nbsp;<span class="op" id="2085632">=</span>&nbsp;<span class="num" id="2085634">0x03f79d71b4ca8b09</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2085654">var</span>&nbsp;<span class="ident" id="2085658">deBruijn64Lookup</span>&nbsp;<span class="op" id="2085675">=</span>&nbsp;<span class="op" id="2085677">[</span><span class="op" id="2085678">]</span><span class="builtintype" id="2085679">byte</span><span class="op" id="2085683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2085686">0</span><span class="op" id="2085687">,</span>&nbsp;<span class="num" id="2085689">1</span><span class="op" id="2085690">,</span>&nbsp;<span class="num" id="2085692">56</span><span class="op" id="2085694">,</span>&nbsp;<span class="num" id="2085696">2</span><span class="op" id="2085697">,</span>&nbsp;<span class="num" id="2085699">57</span><span class="op" id="2085701">,</span>&nbsp;<span class="num" id="2085703">49</span><span class="op" id="2085705">,</span>&nbsp;<span class="num" id="2085707">28</span><span class="op" id="2085709">,</span>&nbsp;<span class="num" id="2085711">3</span><span class="op" id="2085712">,</span>&nbsp;<span class="num" id="2085714">61</span><span class="op" id="2085716">,</span>&nbsp;<span class="num" id="2085718">58</span><span class="op" id="2085720">,</span>&nbsp;<span class="num" id="2085722">42</span><span class="op" id="2085724">,</span>&nbsp;<span class="num" id="2085726">50</span><span class="op" id="2085728">,</span>&nbsp;<span class="num" id="2085730">38</span><span class="op" id="2085732">,</span>&nbsp;<span class="num" id="2085734">29</span><span class="op" id="2085736">,</span>&nbsp;<span class="num" id="2085738">17</span><span class="op" id="2085740">,</span>&nbsp;<span class="num" id="2085742">4</span><span class="op" id="2085743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2085746">62</span><span class="op" id="2085748">,</span>&nbsp;<span class="num" id="2085750">47</span><span class="op" id="2085752">,</span>&nbsp;<span class="num" id="2085754">59</span><span class="op" id="2085756">,</span>&nbsp;<span class="num" id="2085758">36</span><span class="op" id="2085760">,</span>&nbsp;<span class="num" id="2085762">45</span><span class="op" id="2085764">,</span>&nbsp;<span class="num" id="2085766">43</span><span class="op" id="2085768">,</span>&nbsp;<span class="num" id="2085770">51</span><span class="op" id="2085772">,</span>&nbsp;<span class="num" id="2085774">22</span><span class="op" id="2085776">,</span>&nbsp;<span class="num" id="2085778">53</span><span class="op" id="2085780">,</span>&nbsp;<span class="num" id="2085782">39</span><span class="op" id="2085784">,</span>&nbsp;<span class="num" id="2085786">33</span><span class="op" id="2085788">,</span>&nbsp;<span class="num" id="2085790">30</span><span class="op" id="2085792">,</span>&nbsp;<span class="num" id="2085794">24</span><span class="op" id="2085796">,</span>&nbsp;<span class="num" id="2085798">18</span><span class="op" id="2085800">,</span>&nbsp;<span class="num" id="2085802">12</span><span class="op" id="2085804">,</span>&nbsp;<span class="num" id="2085806">5</span><span class="op" id="2085807">,</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2085810">63</span><span class="op" id="2085812">,</span>&nbsp;<span class="num" id="2085814">55</span><span class="op" id="2085816">,</span>&nbsp;<span class="num" id="2085818">48</span><span class="op" id="2085820">,</span>&nbsp;<span class="num" id="2085822">27</span><span class="op" id="2085824">,</span>&nbsp;<span class="num" id="2085826">60</span><span class="op" id="2085828">,</span>&nbsp;<span class="num" id="2085830">41</span><span class="op" id="2085832">,</span>&nbsp;<span class="num" id="2085834">37</span><span class="op" id="2085836">,</span>&nbsp;<span class="num" id="2085838">16</span><span class="op" id="2085840">,</span>&nbsp;<span class="num" id="2085842">46</span><span class="op" id="2085844">,</span>&nbsp;<span class="num" id="2085846">35</span><span class="op" id="2085848">,</span>&nbsp;<span class="num" id="2085850">44</span><span class="op" id="2085852">,</span>&nbsp;<span class="num" id="2085854">21</span><span class="op" id="2085856">,</span>&nbsp;<span class="num" id="2085858">52</span><span class="op" id="2085860">,</span>&nbsp;<span class="num" id="2085862">32</span><span class="op" id="2085864">,</span>&nbsp;<span class="num" id="2085866">23</span><span class="op" id="2085868">,</span>&nbsp;<span class="num" id="2085870">11</span><span class="op" id="2085872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2085875">54</span><span class="op" id="2085877">,</span>&nbsp;<span class="num" id="2085879">26</span><span class="op" id="2085881">,</span>&nbsp;<span class="num" id="2085883">40</span><span class="op" id="2085885">,</span>&nbsp;<span class="num" id="2085887">15</span><span class="op" id="2085889">,</span>&nbsp;<span class="num" id="2085891">34</span><span class="op" id="2085893">,</span>&nbsp;<span class="num" id="2085895">20</span><span class="op" id="2085897">,</span>&nbsp;<span class="num" id="2085899">31</span><span class="op" id="2085901">,</span>&nbsp;<span class="num" id="2085903">10</span><span class="op" id="2085905">,</span>&nbsp;<span class="num" id="2085907">25</span><span class="op" id="2085909">,</span>&nbsp;<span class="num" id="2085911">14</span><span class="op" id="2085913">,</span>&nbsp;<span class="num" id="2085915">19</span><span class="op" id="2085917">,</span>&nbsp;<span class="num" id="2085919">9</span><span class="op" id="2085920">,</span>&nbsp;<span class="num" id="2085922">13</span><span class="op" id="2085924">,</span>&nbsp;<span class="num" id="2085926">8</span><span class="op" id="2085927">,</span>&nbsp;<span class="num" id="2085929">7</span><span class="op" id="2085930">,</span>&nbsp;<span class="num" id="2085932">6</span><span class="op" id="2085933">,</span><br>
<span class="lineno"></span><span class="op" id="2085935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2085938">//&nbsp;trailingZeroBits&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;consecutive&nbsp;least&nbsp;significant&nbsp;zero</span><br>
<span class="lineno">1005</span><span class="comment" id="2086015">//&nbsp;bits&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="2086029">func</span>&nbsp;<span class="ident" id="2086034">trailingZeroBits</span><span class="op" id="2086050">(</span><span class="ident" id="2086051">x</span>&nbsp;<span class="ident" id="2086053"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2086057">)</span>&nbsp;<span class="builtintype" id="2086059">uint</span>&nbsp;<span class="op" id="2086064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2086067">//&nbsp;x&nbsp;&amp;&nbsp;-x&nbsp;leaves&nbsp;only&nbsp;the&nbsp;right-most&nbsp;bit&nbsp;set&nbsp;in&nbsp;the&nbsp;word.&nbsp;Let&nbsp;k&nbsp;be&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2086139">//&nbsp;index&nbsp;of&nbsp;that&nbsp;bit.&nbsp;Since&nbsp;only&nbsp;a&nbsp;single&nbsp;bit&nbsp;is&nbsp;set,&nbsp;the&nbsp;value&nbsp;is&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2086211">//&nbsp;to&nbsp;the&nbsp;power&nbsp;of&nbsp;k.&nbsp;Multiplying&nbsp;by&nbsp;a&nbsp;power&nbsp;of&nbsp;two&nbsp;is&nbsp;equivalent&nbsp;to</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2086281">//&nbsp;left&nbsp;shifting,&nbsp;in&nbsp;this&nbsp;case&nbsp;by&nbsp;k&nbsp;bits.&nbsp;&nbsp;The&nbsp;de&nbsp;Bruijn&nbsp;constant&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2086351">//&nbsp;such&nbsp;that&nbsp;all&nbsp;six&nbsp;bit,&nbsp;consecutive&nbsp;substrings&nbsp;are&nbsp;distinct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2086415">//&nbsp;Therefore,&nbsp;if&nbsp;we&nbsp;have&nbsp;a&nbsp;left&nbsp;shifted&nbsp;version&nbsp;of&nbsp;this&nbsp;constant&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2086488">//&nbsp;find&nbsp;by&nbsp;how&nbsp;many&nbsp;bits&nbsp;it&nbsp;was&nbsp;shifted&nbsp;by&nbsp;looking&nbsp;at&nbsp;which&nbsp;six&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2086557">//&nbsp;substring&nbsp;ended&nbsp;up&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;word.</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2086604">//&nbsp;(Knuth,&nbsp;volume&nbsp;4,&nbsp;section&nbsp;7.3.1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2086641">switch</span>&nbsp;<span class="ident" id="2086648"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span>&nbsp;<span class="op" id="2086651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2086654">case</span>&nbsp;<span class="num" id="2086659">32</span><span class="op" id="2086661">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2086665">return</span>&nbsp;<span class="builtintype" id="2086672">uint</span><span class="op" id="2086676">(</span><span class="ident" id="2086677"><a href="/gostd/math/big/nat.go.html#2085465">deBruijn32Lookup</a></span><span class="op" id="2086693">[</span><span class="op" id="2086694">(</span><span class="op" id="2086695">(</span><span class="ident" id="2086696"><a href="/gostd/math/big/nat.go.html#2086051">x</a></span><span class="op" id="2086697">&amp;</span><span class="op" id="2086698">-</span><span class="ident" id="2086699"><a href="/gostd/math/big/nat.go.html#2086051">x</a></span><span class="op" id="2086700">)</span><span class="op" id="2086701">*</span><span class="ident" id="2086702"><a href="/gostd/math/big/nat.go.html#2085436">deBruijn32</a></span><span class="op" id="2086712">)</span><span class="op" id="2086713">&gt;&gt;</span><span class="num" id="2086715">27</span><span class="op" id="2086717">]</span><span class="op" id="2086718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2086721">case</span>&nbsp;<span class="num" id="2086726">64</span><span class="op" id="2086728">:</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2086732">return</span>&nbsp;<span class="builtintype" id="2086739">uint</span><span class="op" id="2086743">(</span><span class="ident" id="2086744"><a href="/gostd/math/big/nat.go.html#2085658">deBruijn64Lookup</a></span><span class="op" id="2086760">[</span><span class="op" id="2086761">(</span><span class="op" id="2086762">(</span><span class="ident" id="2086763"><a href="/gostd/math/big/nat.go.html#2086051">x</a></span><span class="op" id="2086764">&amp;</span><span class="op" id="2086765">-</span><span class="ident" id="2086766"><a href="/gostd/math/big/nat.go.html#2086051">x</a></span><span class="op" id="2086767">)</span><span class="op" id="2086768">*</span><span class="op" id="2086769">(</span><span class="ident" id="2086770"><a href="/gostd/math/big/nat.go.html#2085621">deBruijn64</a></span><span class="op" id="2086780">&amp;</span><span class="ident" id="2086781"><a href="/gostd/math/big/arith.go.html#2031219">_M</a></span><span class="op" id="2086783">)</span><span class="op" id="2086784">)</span><span class="op" id="2086785">&gt;&gt;</span><span class="num" id="2086787">58</span><span class="op" id="2086789">]</span><span class="op" id="2086790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2086793">default</span><span class="op" id="2086800">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2086804">panic</span><span class="op" id="2086809">(</span><span class="string" id="2086810">&#34;unknown&nbsp;word&nbsp;size&#34;</span><span class="op" id="2086829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2086832">}</span><br>
<span class="lineno"></span><span class="op" id="2086834">}</span><br>
<span class="lineno">1025</span><br>
<span class="lineno"></span><span class="comment" id="2086837">//&nbsp;trailingZeroBits&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;consecutive&nbsp;least&nbsp;significant&nbsp;zero</span><br>
<span class="lineno"></span><span class="comment" id="2086914">//&nbsp;bits&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="2086928">func</span>&nbsp;<span class="op" id="2086933">(</span><span class="ident" id="2086934">x</span>&nbsp;<span class="ident" id="2086936"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2086939">)</span>&nbsp;<span class="ident" id="2086941">trailingZeroBits</span><span class="op" id="2086957">(</span><span class="op" id="2086958">)</span>&nbsp;<span class="builtintype" id="2086960">uint</span>&nbsp;<span class="op" id="2086965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2086968">if</span>&nbsp;<span class="builtinfunc" id="2086971">len</span><span class="op" id="2086974">(</span><span class="ident" id="2086975"><a href="/gostd/math/big/nat.go.html#2086934">x</a></span><span class="op" id="2086976">)</span>&nbsp;<span class="op" id="2086978">==</span>&nbsp;<span class="num" id="2086981">0</span>&nbsp;<span class="op" id="2086983">{</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2086987">return</span>&nbsp;<span class="num" id="2086994">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2086997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087000">var</span>&nbsp;<span class="ident" id="2087004">i</span>&nbsp;<span class="builtintype" id="2087006">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087012">for</span>&nbsp;<span class="ident" id="2087016"><a href="/gostd/math/big/nat.go.html#2086934">x</a></span><span class="op" id="2087017">[</span><span class="ident" id="2087018"><a href="/gostd/math/big/nat.go.html#2087004">i</a></span><span class="op" id="2087019">]</span>&nbsp;<span class="op" id="2087021">==</span>&nbsp;<span class="num" id="2087024">0</span>&nbsp;<span class="op" id="2087026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087030"><a href="/gostd/math/big/nat.go.html#2087004">i</a></span><span class="op" id="2087031">++</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2087038">//&nbsp;x[i]&nbsp;!=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087052">return</span>&nbsp;<span class="ident" id="2087059"><a href="/gostd/math/big/nat.go.html#2087004">i</a></span><span class="op" id="2087060">*</span><span class="ident" id="2087061"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span>&nbsp;<span class="op" id="2087064">+</span>&nbsp;<span class="ident" id="2087066"><a href="/gostd/math/big/nat.go.html#2086034">trailingZeroBits</a></span><span class="op" id="2087082">(</span><span class="ident" id="2087083"><a href="/gostd/math/big/nat.go.html#2086934">x</a></span><span class="op" id="2087084">[</span><span class="ident" id="2087085"><a href="/gostd/math/big/nat.go.html#2087004">i</a></span><span class="op" id="2087086">]</span><span class="op" id="2087087">)</span><br>
<span class="lineno"></span><span class="op" id="2087089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1040</span><span class="comment" id="2087092">//&nbsp;z&nbsp;=&nbsp;x&nbsp;&lt;&lt;&nbsp;s</span><br>
<span class="lineno"></span><span class="keyword" id="2087106">func</span>&nbsp;<span class="op" id="2087111">(</span><span class="ident" id="2087112">z</span>&nbsp;<span class="ident" id="2087114"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2087117">)</span>&nbsp;<span class="ident" id="2087119">shl</span><span class="op" id="2087122">(</span><span class="ident" id="2087123">x</span>&nbsp;<span class="ident" id="2087125"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2087128">,</span>&nbsp;<span class="ident" id="2087130">s</span>&nbsp;<span class="builtintype" id="2087132">uint</span><span class="op" id="2087136">)</span>&nbsp;<span class="ident" id="2087138"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2087142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087145">m</span>&nbsp;<span class="op" id="2087147">:=</span>&nbsp;<span class="builtinfunc" id="2087150">len</span><span class="op" id="2087153">(</span><span class="ident" id="2087154"><a href="/gostd/math/big/nat.go.html#2087123">x</a></span><span class="op" id="2087155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087158">if</span>&nbsp;<span class="ident" id="2087161"><a href="/gostd/math/big/nat.go.html#2087145">m</a></span>&nbsp;<span class="op" id="2087163">==</span>&nbsp;<span class="num" id="2087166">0</span>&nbsp;<span class="op" id="2087168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087172">return</span>&nbsp;<span class="ident" id="2087179"><a href="/gostd/math/big/nat.go.html#2087112">z</a></span><span class="op" id="2087180">.</span><span class="builtinfunc" id="2087181"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2087185">(</span><span class="num" id="2087186">0</span><span class="op" id="2087187">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2087193">//&nbsp;m&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087204">n</span>&nbsp;<span class="op" id="2087206">:=</span>&nbsp;<span class="ident" id="2087209"><a href="/gostd/math/big/nat.go.html#2087145">m</a></span>&nbsp;<span class="op" id="2087211">+</span>&nbsp;<span class="builtintype" id="2087213">int</span><span class="op" id="2087216">(</span><span class="ident" id="2087217"><a href="/gostd/math/big/nat.go.html#2087130">s</a></span><span class="op" id="2087218">/</span><span class="ident" id="2087219"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span><span class="op" id="2087221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087224"><a href="/gostd/math/big/nat.go.html#2087112">z</a></span>&nbsp;<span class="op" id="2087226">=</span>&nbsp;<span class="ident" id="2087228"><a href="/gostd/math/big/nat.go.html#2087112">z</a></span><span class="op" id="2087229">.</span><span class="builtinfunc" id="2087230"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2087234">(</span><span class="ident" id="2087235"><a href="/gostd/math/big/nat.go.html#2087204">n</a></span>&nbsp;<span class="op" id="2087237">+</span>&nbsp;<span class="num" id="2087239">1</span><span class="op" id="2087240">)</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087243"><a href="/gostd/math/big/nat.go.html#2087112">z</a></span><span class="op" id="2087244">[</span><span class="ident" id="2087245"><a href="/gostd/math/big/nat.go.html#2087204">n</a></span><span class="op" id="2087246">]</span>&nbsp;<span class="op" id="2087248">=</span>&nbsp;<span class="ident" id="2087250"><a href="/gostd/math/big/arith_decl.go.html#2035325">shlVU</a></span><span class="op" id="2087255">(</span><span class="ident" id="2087256"><a href="/gostd/math/big/nat.go.html#2087112">z</a></span><span class="op" id="2087257">[</span><span class="ident" id="2087258"><a href="/gostd/math/big/nat.go.html#2087204">n</a></span><span class="op" id="2087259">-</span><span class="ident" id="2087260"><a href="/gostd/math/big/nat.go.html#2087145">m</a></span><span class="op" id="2087261">:</span><span class="ident" id="2087262"><a href="/gostd/math/big/nat.go.html#2087204">n</a></span><span class="op" id="2087263">]</span><span class="op" id="2087264">,</span>&nbsp;<span class="ident" id="2087266"><a href="/gostd/math/big/nat.go.html#2087123">x</a></span><span class="op" id="2087267">,</span>&nbsp;<span class="ident" id="2087269"><a href="/gostd/math/big/nat.go.html#2087130">s</a></span><span class="op" id="2087270">%</span><span class="ident" id="2087271"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span><span class="op" id="2087273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087276"><a href="/gostd/math/big/nat.go.html#2087112">z</a></span><span class="op" id="2087277">[</span><span class="num" id="2087278">0</span>&nbsp;<span class="op" id="2087280">:</span>&nbsp;<span class="ident" id="2087282"><a href="/gostd/math/big/nat.go.html#2087204">n</a></span><span class="op" id="2087283">-</span><span class="ident" id="2087284"><a href="/gostd/math/big/nat.go.html#2087145">m</a></span><span class="op" id="2087285">]</span><span class="op" id="2087286">.</span><span class="ident" id="2087287"><a href="/gostd/math/big/nat.go.html#2062241">clear</a></span><span class="op" id="2087292">(</span><span class="op" id="2087293">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087297">return</span>&nbsp;<span class="ident" id="2087304"><a href="/gostd/math/big/nat.go.html#2087112">z</a></span><span class="op" id="2087305">.</span><span class="ident" id="2087306"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2087310">(</span><span class="op" id="2087311">)</span><br>
<span class="lineno"></span><span class="op" id="2087313">}</span><br>
<span class="lineno">1055</span><br>
<span class="lineno"></span><span class="comment" id="2087316">//&nbsp;z&nbsp;=&nbsp;x&nbsp;&gt;&gt;&nbsp;s</span><br>
<span class="lineno"></span><span class="keyword" id="2087330">func</span>&nbsp;<span class="op" id="2087335">(</span><span class="ident" id="2087336">z</span>&nbsp;<span class="ident" id="2087338"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2087341">)</span>&nbsp;<span class="ident" id="2087343">shr</span><span class="op" id="2087346">(</span><span class="ident" id="2087347">x</span>&nbsp;<span class="ident" id="2087349"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2087352">,</span>&nbsp;<span class="ident" id="2087354">s</span>&nbsp;<span class="builtintype" id="2087356">uint</span><span class="op" id="2087360">)</span>&nbsp;<span class="ident" id="2087362"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2087366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087369">m</span>&nbsp;<span class="op" id="2087371">:=</span>&nbsp;<span class="builtinfunc" id="2087374">len</span><span class="op" id="2087377">(</span><span class="ident" id="2087378"><a href="/gostd/math/big/nat.go.html#2087347">x</a></span><span class="op" id="2087379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087382">n</span>&nbsp;<span class="op" id="2087384">:=</span>&nbsp;<span class="ident" id="2087387"><a href="/gostd/math/big/nat.go.html#2087369">m</a></span>&nbsp;<span class="op" id="2087389">-</span>&nbsp;<span class="builtintype" id="2087391">int</span><span class="op" id="2087394">(</span><span class="ident" id="2087395"><a href="/gostd/math/big/nat.go.html#2087354">s</a></span><span class="op" id="2087396">/</span><span class="ident" id="2087397"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span><span class="op" id="2087399">)</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087402">if</span>&nbsp;<span class="ident" id="2087405"><a href="/gostd/math/big/nat.go.html#2087382">n</a></span>&nbsp;<span class="op" id="2087407">&lt;=</span>&nbsp;<span class="num" id="2087410">0</span>&nbsp;<span class="op" id="2087412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087416">return</span>&nbsp;<span class="ident" id="2087423"><a href="/gostd/math/big/nat.go.html#2087336">z</a></span><span class="op" id="2087424">.</span><span class="builtinfunc" id="2087425"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2087429">(</span><span class="num" id="2087430">0</span><span class="op" id="2087431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2087437">//&nbsp;n&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087448"><a href="/gostd/math/big/nat.go.html#2087336">z</a></span>&nbsp;<span class="op" id="2087450">=</span>&nbsp;<span class="ident" id="2087452"><a href="/gostd/math/big/nat.go.html#2087336">z</a></span><span class="op" id="2087453">.</span><span class="builtinfunc" id="2087454"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2087458">(</span><span class="ident" id="2087459"><a href="/gostd/math/big/nat.go.html#2087382">n</a></span><span class="op" id="2087460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087463"><a href="/gostd/math/big/arith_decl.go.html#2035366">shrVU</a></span><span class="op" id="2087468">(</span><span class="ident" id="2087469"><a href="/gostd/math/big/nat.go.html#2087336">z</a></span><span class="op" id="2087470">,</span>&nbsp;<span class="ident" id="2087472"><a href="/gostd/math/big/nat.go.html#2087347">x</a></span><span class="op" id="2087473">[</span><span class="ident" id="2087474"><a href="/gostd/math/big/nat.go.html#2087369">m</a></span><span class="op" id="2087475">-</span><span class="ident" id="2087476"><a href="/gostd/math/big/nat.go.html#2087382">n</a></span><span class="op" id="2087477">:</span><span class="op" id="2087478">]</span><span class="op" id="2087479">,</span>&nbsp;<span class="ident" id="2087481"><a href="/gostd/math/big/nat.go.html#2087354">s</a></span><span class="op" id="2087482">%</span><span class="ident" id="2087483"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span><span class="op" id="2087485">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087489">return</span>&nbsp;<span class="ident" id="2087496"><a href="/gostd/math/big/nat.go.html#2087336">z</a></span><span class="op" id="2087497">.</span><span class="ident" id="2087498"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2087502">(</span><span class="op" id="2087503">)</span><br>
<span class="lineno"></span><span class="op" id="2087505">}</span><br>
<span class="lineno">1070</span><br>
<span class="lineno"></span><span class="keyword" id="2087508">func</span>&nbsp;<span class="op" id="2087513">(</span><span class="ident" id="2087514">z</span>&nbsp;<span class="ident" id="2087516"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2087519">)</span>&nbsp;<span class="ident" id="2087521">setBit</span><span class="op" id="2087527">(</span><span class="ident" id="2087528">x</span>&nbsp;<span class="ident" id="2087530"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2087533">,</span>&nbsp;<span class="ident" id="2087535">i</span>&nbsp;<span class="builtintype" id="2087537">uint</span><span class="op" id="2087541">,</span>&nbsp;<span class="ident" id="2087543">b</span>&nbsp;<span class="builtintype" id="2087545">uint</span><span class="op" id="2087549">)</span>&nbsp;<span class="ident" id="2087551"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2087555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087558">j</span>&nbsp;<span class="op" id="2087560">:=</span>&nbsp;<span class="builtintype" id="2087563">int</span><span class="op" id="2087566">(</span><span class="ident" id="2087567"><a href="/gostd/math/big/nat.go.html#2087535">i</a></span>&nbsp;<span class="op" id="2087569">/</span>&nbsp;<span class="ident" id="2087571"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span><span class="op" id="2087573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087576">m</span>&nbsp;<span class="op" id="2087578">:=</span>&nbsp;<span class="ident" id="2087581"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2087585">(</span><span class="num" id="2087586">1</span><span class="op" id="2087587">)</span>&nbsp;<span class="op" id="2087589">&lt;&lt;</span>&nbsp;<span class="op" id="2087592">(</span><span class="ident" id="2087593"><a href="/gostd/math/big/nat.go.html#2087535">i</a></span>&nbsp;<span class="op" id="2087595">%</span>&nbsp;<span class="ident" id="2087597"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span><span class="op" id="2087599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087602">n</span>&nbsp;<span class="op" id="2087604">:=</span>&nbsp;<span class="builtinfunc" id="2087607">len</span><span class="op" id="2087610">(</span><span class="ident" id="2087611"><a href="/gostd/math/big/nat.go.html#2087528">x</a></span><span class="op" id="2087612">)</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087615">switch</span>&nbsp;<span class="ident" id="2087622"><a href="/gostd/math/big/nat.go.html#2087543">b</a></span>&nbsp;<span class="op" id="2087624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087627">case</span>&nbsp;<span class="num" id="2087632">0</span><span class="op" id="2087633">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087637"><a href="/gostd/math/big/nat.go.html#2087514">z</a></span>&nbsp;<span class="op" id="2087639">=</span>&nbsp;<span class="ident" id="2087641"><a href="/gostd/math/big/nat.go.html#2087514">z</a></span><span class="op" id="2087642">.</span><span class="builtinfunc" id="2087643"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2087647">(</span><span class="ident" id="2087648"><a href="/gostd/math/big/nat.go.html#2087602">n</a></span><span class="op" id="2087649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2087653">copy</span><span class="op" id="2087657">(</span><span class="ident" id="2087658"><a href="/gostd/math/big/nat.go.html#2087514">z</a></span><span class="op" id="2087659">,</span>&nbsp;<span class="ident" id="2087661"><a href="/gostd/math/big/nat.go.html#2087528">x</a></span><span class="op" id="2087662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087666">if</span>&nbsp;<span class="ident" id="2087669"><a href="/gostd/math/big/nat.go.html#2087558">j</a></span>&nbsp;<span class="op" id="2087671">&gt;=</span>&nbsp;<span class="ident" id="2087674"><a href="/gostd/math/big/nat.go.html#2087602">n</a></span>&nbsp;<span class="op" id="2087676">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2087681">//&nbsp;no&nbsp;need&nbsp;to&nbsp;grow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087703">return</span>&nbsp;<span class="ident" id="2087710"><a href="/gostd/math/big/nat.go.html#2087514">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087718"><a href="/gostd/math/big/nat.go.html#2087514">z</a></span><span class="op" id="2087719">[</span><span class="ident" id="2087720"><a href="/gostd/math/big/nat.go.html#2087558">j</a></span><span class="op" id="2087721">]</span>&nbsp;<span class="op" id="2087723">&amp;^=</span>&nbsp;<span class="ident" id="2087727"><a href="/gostd/math/big/nat.go.html#2087576">m</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087731">return</span>&nbsp;<span class="ident" id="2087738"><a href="/gostd/math/big/nat.go.html#2087514">z</a></span><span class="op" id="2087739">.</span><span class="ident" id="2087740"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2087744">(</span><span class="op" id="2087745">)</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087748">case</span>&nbsp;<span class="num" id="2087753">1</span><span class="op" id="2087754">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087758">if</span>&nbsp;<span class="ident" id="2087761"><a href="/gostd/math/big/nat.go.html#2087558">j</a></span>&nbsp;<span class="op" id="2087763">&gt;=</span>&nbsp;<span class="ident" id="2087766"><a href="/gostd/math/big/nat.go.html#2087602">n</a></span>&nbsp;<span class="op" id="2087768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087773"><a href="/gostd/math/big/nat.go.html#2087514">z</a></span>&nbsp;<span class="op" id="2087775">=</span>&nbsp;<span class="ident" id="2087777"><a href="/gostd/math/big/nat.go.html#2087514">z</a></span><span class="op" id="2087778">.</span><span class="builtinfunc" id="2087779"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2087783">(</span><span class="ident" id="2087784"><a href="/gostd/math/big/nat.go.html#2087558">j</a></span>&nbsp;<span class="op" id="2087786">+</span>&nbsp;<span class="num" id="2087788">1</span><span class="op" id="2087789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087794"><a href="/gostd/math/big/nat.go.html#2087514">z</a></span><span class="op" id="2087795">[</span><span class="ident" id="2087796"><a href="/gostd/math/big/nat.go.html#2087602">n</a></span><span class="op" id="2087797">:</span><span class="op" id="2087798">]</span><span class="op" id="2087799">.</span><span class="ident" id="2087800"><a href="/gostd/math/big/nat.go.html#2062241">clear</a></span><span class="op" id="2087805">(</span><span class="op" id="2087806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087810">}</span>&nbsp;<span class="keyword" id="2087812">else</span>&nbsp;<span class="op" id="2087817">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087822"><a href="/gostd/math/big/nat.go.html#2087514">z</a></span>&nbsp;<span class="op" id="2087824">=</span>&nbsp;<span class="ident" id="2087826"><a href="/gostd/math/big/nat.go.html#2087514">z</a></span><span class="op" id="2087827">.</span><span class="builtinfunc" id="2087828"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2087832">(</span><span class="ident" id="2087833"><a href="/gostd/math/big/nat.go.html#2087602">n</a></span><span class="op" id="2087834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2087842">copy</span><span class="op" id="2087846">(</span><span class="ident" id="2087847"><a href="/gostd/math/big/nat.go.html#2087514">z</a></span><span class="op" id="2087848">,</span>&nbsp;<span class="ident" id="2087850"><a href="/gostd/math/big/nat.go.html#2087528">x</a></span><span class="op" id="2087851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087855"><a href="/gostd/math/big/nat.go.html#2087514">z</a></span><span class="op" id="2087856">[</span><span class="ident" id="2087857"><a href="/gostd/math/big/nat.go.html#2087558">j</a></span><span class="op" id="2087858">]</span>&nbsp;<span class="op" id="2087860">|=</span>&nbsp;<span class="ident" id="2087863"><a href="/gostd/math/big/nat.go.html#2087576">m</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2087867">//&nbsp;no&nbsp;need&nbsp;to&nbsp;normalize</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087893">return</span>&nbsp;<span class="ident" id="2087900"><a href="/gostd/math/big/nat.go.html#2087514">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2087906">panic</span><span class="op" id="2087911">(</span><span class="string" id="2087912">&#34;set&nbsp;bit&nbsp;is&nbsp;not&nbsp;0&nbsp;or&nbsp;1&#34;</span><span class="op" id="2087935">)</span><br>
<span class="lineno"></span><span class="op" id="2087937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1100</span><span class="keyword" id="2087940">func</span>&nbsp;<span class="op" id="2087945">(</span><span class="ident" id="2087946">z</span>&nbsp;<span class="ident" id="2087948"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2087951">)</span>&nbsp;<span class="ident" id="2087953">bit</span><span class="op" id="2087956">(</span><span class="ident" id="2087957">i</span>&nbsp;<span class="builtintype" id="2087959">uint</span><span class="op" id="2087963">)</span>&nbsp;<span class="builtintype" id="2087965">uint</span>&nbsp;<span class="op" id="2087970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087973">j</span>&nbsp;<span class="op" id="2087975">:=</span>&nbsp;<span class="builtintype" id="2087978">int</span><span class="op" id="2087981">(</span><span class="ident" id="2087982"><a href="/gostd/math/big/nat.go.html#2087957">i</a></span>&nbsp;<span class="op" id="2087984">/</span>&nbsp;<span class="ident" id="2087986"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span><span class="op" id="2087988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087991">if</span>&nbsp;<span class="ident" id="2087994"><a href="/gostd/math/big/nat.go.html#2087973">j</a></span>&nbsp;<span class="op" id="2087996">&gt;=</span>&nbsp;<span class="builtinfunc" id="2087999">len</span><span class="op" id="2088002">(</span><span class="ident" id="2088003"><a href="/gostd/math/big/nat.go.html#2087946">z</a></span><span class="op" id="2088004">)</span>&nbsp;<span class="op" id="2088006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088010">return</span>&nbsp;<span class="num" id="2088017">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088020">}</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088023">return</span>&nbsp;<span class="builtintype" id="2088030">uint</span><span class="op" id="2088034">(</span><span class="ident" id="2088035"><a href="/gostd/math/big/nat.go.html#2087946">z</a></span><span class="op" id="2088036">[</span><span class="ident" id="2088037"><a href="/gostd/math/big/nat.go.html#2087973">j</a></span><span class="op" id="2088038">]</span>&nbsp;<span class="op" id="2088040">&gt;&gt;</span>&nbsp;<span class="op" id="2088043">(</span><span class="ident" id="2088044"><a href="/gostd/math/big/nat.go.html#2087957">i</a></span>&nbsp;<span class="op" id="2088046">%</span>&nbsp;<span class="ident" id="2088048"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span><span class="op" id="2088050">)</span>&nbsp;<span class="op" id="2088052">&amp;</span>&nbsp;<span class="num" id="2088054">1</span><span class="op" id="2088055">)</span><br>
<span class="lineno"></span><span class="op" id="2088057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2088060">func</span>&nbsp;<span class="op" id="2088065">(</span><span class="ident" id="2088066">z</span>&nbsp;<span class="ident" id="2088068"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2088071">)</span>&nbsp;<span class="ident" id="2088073">and</span><span class="op" id="2088076">(</span><span class="ident" id="2088077">x</span><span class="op" id="2088078">,</span>&nbsp;<span class="ident" id="2088080">y</span>&nbsp;<span class="ident" id="2088082"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2088085">)</span>&nbsp;<span class="ident" id="2088087"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2088091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088094">m</span>&nbsp;<span class="op" id="2088096">:=</span>&nbsp;<span class="builtinfunc" id="2088099">len</span><span class="op" id="2088102">(</span><span class="ident" id="2088103"><a href="/gostd/math/big/nat.go.html#2088077">x</a></span><span class="op" id="2088104">)</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088107">n</span>&nbsp;<span class="op" id="2088109">:=</span>&nbsp;<span class="builtinfunc" id="2088112">len</span><span class="op" id="2088115">(</span><span class="ident" id="2088116"><a href="/gostd/math/big/nat.go.html#2088080">y</a></span><span class="op" id="2088117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088120">if</span>&nbsp;<span class="ident" id="2088123"><a href="/gostd/math/big/nat.go.html#2088094">m</a></span>&nbsp;<span class="op" id="2088125">&gt;</span>&nbsp;<span class="ident" id="2088127"><a href="/gostd/math/big/nat.go.html#2088107">n</a></span>&nbsp;<span class="op" id="2088129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088133"><a href="/gostd/math/big/nat.go.html#2088094">m</a></span>&nbsp;<span class="op" id="2088135">=</span>&nbsp;<span class="ident" id="2088137"><a href="/gostd/math/big/nat.go.html#2088107">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2088143">//&nbsp;m&nbsp;&lt;=&nbsp;n</span><br>
<span class="lineno">1115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088155"><a href="/gostd/math/big/nat.go.html#2088066">z</a></span>&nbsp;<span class="op" id="2088157">=</span>&nbsp;<span class="ident" id="2088159"><a href="/gostd/math/big/nat.go.html#2088066">z</a></span><span class="op" id="2088160">.</span><span class="builtinfunc" id="2088161"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2088165">(</span><span class="ident" id="2088166"><a href="/gostd/math/big/nat.go.html#2088094">m</a></span><span class="op" id="2088167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088170">for</span>&nbsp;<span class="ident" id="2088174">i</span>&nbsp;<span class="op" id="2088176">:=</span>&nbsp;<span class="num" id="2088179">0</span><span class="op" id="2088180">;</span>&nbsp;<span class="ident" id="2088182"><a href="/gostd/math/big/nat.go.html#2088174">i</a></span>&nbsp;<span class="op" id="2088184">&lt;</span>&nbsp;<span class="ident" id="2088186"><a href="/gostd/math/big/nat.go.html#2088094">m</a></span><span class="op" id="2088187">;</span>&nbsp;<span class="ident" id="2088189"><a href="/gostd/math/big/nat.go.html#2088174">i</a></span><span class="op" id="2088190">++</span>&nbsp;<span class="op" id="2088193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088197"><a href="/gostd/math/big/nat.go.html#2088066">z</a></span><span class="op" id="2088198">[</span><span class="ident" id="2088199"><a href="/gostd/math/big/nat.go.html#2088174">i</a></span><span class="op" id="2088200">]</span>&nbsp;<span class="op" id="2088202">=</span>&nbsp;<span class="ident" id="2088204"><a href="/gostd/math/big/nat.go.html#2088077">x</a></span><span class="op" id="2088205">[</span><span class="ident" id="2088206"><a href="/gostd/math/big/nat.go.html#2088174">i</a></span><span class="op" id="2088207">]</span>&nbsp;<span class="op" id="2088209">&amp;</span>&nbsp;<span class="ident" id="2088211"><a href="/gostd/math/big/nat.go.html#2088080">y</a></span><span class="op" id="2088212">[</span><span class="ident" id="2088213"><a href="/gostd/math/big/nat.go.html#2088174">i</a></span><span class="op" id="2088214">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088217">}</span><br>
<span class="lineno">1120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088221">return</span>&nbsp;<span class="ident" id="2088228"><a href="/gostd/math/big/nat.go.html#2088066">z</a></span><span class="op" id="2088229">.</span><span class="ident" id="2088230"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2088234">(</span><span class="op" id="2088235">)</span><br>
<span class="lineno"></span><span class="op" id="2088237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2088240">func</span>&nbsp;<span class="op" id="2088245">(</span><span class="ident" id="2088246">z</span>&nbsp;<span class="ident" id="2088248"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2088251">)</span>&nbsp;<span class="ident" id="2088253">andNot</span><span class="op" id="2088259">(</span><span class="ident" id="2088260">x</span><span class="op" id="2088261">,</span>&nbsp;<span class="ident" id="2088263">y</span>&nbsp;<span class="ident" id="2088265"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2088268">)</span>&nbsp;<span class="ident" id="2088270"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2088274">{</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088277">m</span>&nbsp;<span class="op" id="2088279">:=</span>&nbsp;<span class="builtinfunc" id="2088282">len</span><span class="op" id="2088285">(</span><span class="ident" id="2088286"><a href="/gostd/math/big/nat.go.html#2088260">x</a></span><span class="op" id="2088287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088290">n</span>&nbsp;<span class="op" id="2088292">:=</span>&nbsp;<span class="builtinfunc" id="2088295">len</span><span class="op" id="2088298">(</span><span class="ident" id="2088299"><a href="/gostd/math/big/nat.go.html#2088263">y</a></span><span class="op" id="2088300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088303">if</span>&nbsp;<span class="ident" id="2088306"><a href="/gostd/math/big/nat.go.html#2088290">n</a></span>&nbsp;<span class="op" id="2088308">&gt;</span>&nbsp;<span class="ident" id="2088310"><a href="/gostd/math/big/nat.go.html#2088277">m</a></span>&nbsp;<span class="op" id="2088312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088316"><a href="/gostd/math/big/nat.go.html#2088290">n</a></span>&nbsp;<span class="op" id="2088318">=</span>&nbsp;<span class="ident" id="2088320"><a href="/gostd/math/big/nat.go.html#2088277">m</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088323">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2088326">//&nbsp;m&nbsp;&gt;=&nbsp;n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088338"><a href="/gostd/math/big/nat.go.html#2088246">z</a></span>&nbsp;<span class="op" id="2088340">=</span>&nbsp;<span class="ident" id="2088342"><a href="/gostd/math/big/nat.go.html#2088246">z</a></span><span class="op" id="2088343">.</span><span class="builtinfunc" id="2088344"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2088348">(</span><span class="ident" id="2088349"><a href="/gostd/math/big/nat.go.html#2088277">m</a></span><span class="op" id="2088350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088353">for</span>&nbsp;<span class="ident" id="2088357">i</span>&nbsp;<span class="op" id="2088359">:=</span>&nbsp;<span class="num" id="2088362">0</span><span class="op" id="2088363">;</span>&nbsp;<span class="ident" id="2088365"><a href="/gostd/math/big/nat.go.html#2088357">i</a></span>&nbsp;<span class="op" id="2088367">&lt;</span>&nbsp;<span class="ident" id="2088369"><a href="/gostd/math/big/nat.go.html#2088290">n</a></span><span class="op" id="2088370">;</span>&nbsp;<span class="ident" id="2088372"><a href="/gostd/math/big/nat.go.html#2088357">i</a></span><span class="op" id="2088373">++</span>&nbsp;<span class="op" id="2088376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088380"><a href="/gostd/math/big/nat.go.html#2088246">z</a></span><span class="op" id="2088381">[</span><span class="ident" id="2088382"><a href="/gostd/math/big/nat.go.html#2088357">i</a></span><span class="op" id="2088383">]</span>&nbsp;<span class="op" id="2088385">=</span>&nbsp;<span class="ident" id="2088387"><a href="/gostd/math/big/nat.go.html#2088260">x</a></span><span class="op" id="2088388">[</span><span class="ident" id="2088389"><a href="/gostd/math/big/nat.go.html#2088357">i</a></span><span class="op" id="2088390">]</span>&nbsp;<span class="op" id="2088392">&amp;^</span>&nbsp;<span class="ident" id="2088395"><a href="/gostd/math/big/nat.go.html#2088263">y</a></span><span class="op" id="2088396">[</span><span class="ident" id="2088397"><a href="/gostd/math/big/nat.go.html#2088357">i</a></span><span class="op" id="2088398">]</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2088404">copy</span><span class="op" id="2088408">(</span><span class="ident" id="2088409"><a href="/gostd/math/big/nat.go.html#2088246">z</a></span><span class="op" id="2088410">[</span><span class="ident" id="2088411"><a href="/gostd/math/big/nat.go.html#2088290">n</a></span><span class="op" id="2088412">:</span><span class="ident" id="2088413"><a href="/gostd/math/big/nat.go.html#2088277">m</a></span><span class="op" id="2088414">]</span><span class="op" id="2088415">,</span>&nbsp;<span class="ident" id="2088417"><a href="/gostd/math/big/nat.go.html#2088260">x</a></span><span class="op" id="2088418">[</span><span class="ident" id="2088419"><a href="/gostd/math/big/nat.go.html#2088290">n</a></span><span class="op" id="2088420">:</span><span class="ident" id="2088421"><a href="/gostd/math/big/nat.go.html#2088277">m</a></span><span class="op" id="2088422">]</span><span class="op" id="2088423">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088427">return</span>&nbsp;<span class="ident" id="2088434"><a href="/gostd/math/big/nat.go.html#2088246">z</a></span><span class="op" id="2088435">.</span><span class="ident" id="2088436"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2088440">(</span><span class="op" id="2088441">)</span><br>
<span class="lineno"></span><span class="op" id="2088443">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span><span class="keyword" id="2088446">func</span>&nbsp;<span class="op" id="2088451">(</span><span class="ident" id="2088452">z</span>&nbsp;<span class="ident" id="2088454"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2088457">)</span>&nbsp;<span class="ident" id="2088459">or</span><span class="op" id="2088461">(</span><span class="ident" id="2088462">x</span><span class="op" id="2088463">,</span>&nbsp;<span class="ident" id="2088465">y</span>&nbsp;<span class="ident" id="2088467"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2088470">)</span>&nbsp;<span class="ident" id="2088472"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2088476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088479">m</span>&nbsp;<span class="op" id="2088481">:=</span>&nbsp;<span class="builtinfunc" id="2088484">len</span><span class="op" id="2088487">(</span><span class="ident" id="2088488"><a href="/gostd/math/big/nat.go.html#2088462">x</a></span><span class="op" id="2088489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088492">n</span>&nbsp;<span class="op" id="2088494">:=</span>&nbsp;<span class="builtinfunc" id="2088497">len</span><span class="op" id="2088500">(</span><span class="ident" id="2088501"><a href="/gostd/math/big/nat.go.html#2088465">y</a></span><span class="op" id="2088502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088505">s</span>&nbsp;<span class="op" id="2088507">:=</span>&nbsp;<span class="ident" id="2088510"><a href="/gostd/math/big/nat.go.html#2088462">x</a></span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088513">if</span>&nbsp;<span class="ident" id="2088516"><a href="/gostd/math/big/nat.go.html#2088479">m</a></span>&nbsp;<span class="op" id="2088518">&lt;</span>&nbsp;<span class="ident" id="2088520"><a href="/gostd/math/big/nat.go.html#2088492">n</a></span>&nbsp;<span class="op" id="2088522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088526"><a href="/gostd/math/big/nat.go.html#2088492">n</a></span><span class="op" id="2088527">,</span>&nbsp;<span class="ident" id="2088529"><a href="/gostd/math/big/nat.go.html#2088479">m</a></span>&nbsp;<span class="op" id="2088531">=</span>&nbsp;<span class="ident" id="2088533"><a href="/gostd/math/big/nat.go.html#2088479">m</a></span><span class="op" id="2088534">,</span>&nbsp;<span class="ident" id="2088536"><a href="/gostd/math/big/nat.go.html#2088492">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088540"><a href="/gostd/math/big/nat.go.html#2088505">s</a></span>&nbsp;<span class="op" id="2088542">=</span>&nbsp;<span class="ident" id="2088544"><a href="/gostd/math/big/nat.go.html#2088465">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2088550">//&nbsp;m&nbsp;&gt;=&nbsp;n</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088562"><a href="/gostd/math/big/nat.go.html#2088452">z</a></span>&nbsp;<span class="op" id="2088564">=</span>&nbsp;<span class="ident" id="2088566"><a href="/gostd/math/big/nat.go.html#2088452">z</a></span><span class="op" id="2088567">.</span><span class="builtinfunc" id="2088568"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2088572">(</span><span class="ident" id="2088573"><a href="/gostd/math/big/nat.go.html#2088479">m</a></span><span class="op" id="2088574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088577">for</span>&nbsp;<span class="ident" id="2088581">i</span>&nbsp;<span class="op" id="2088583">:=</span>&nbsp;<span class="num" id="2088586">0</span><span class="op" id="2088587">;</span>&nbsp;<span class="ident" id="2088589"><a href="/gostd/math/big/nat.go.html#2088581">i</a></span>&nbsp;<span class="op" id="2088591">&lt;</span>&nbsp;<span class="ident" id="2088593"><a href="/gostd/math/big/nat.go.html#2088492">n</a></span><span class="op" id="2088594">;</span>&nbsp;<span class="ident" id="2088596"><a href="/gostd/math/big/nat.go.html#2088581">i</a></span><span class="op" id="2088597">++</span>&nbsp;<span class="op" id="2088600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088604"><a href="/gostd/math/big/nat.go.html#2088452">z</a></span><span class="op" id="2088605">[</span><span class="ident" id="2088606"><a href="/gostd/math/big/nat.go.html#2088581">i</a></span><span class="op" id="2088607">]</span>&nbsp;<span class="op" id="2088609">=</span>&nbsp;<span class="ident" id="2088611"><a href="/gostd/math/big/nat.go.html#2088462">x</a></span><span class="op" id="2088612">[</span><span class="ident" id="2088613"><a href="/gostd/math/big/nat.go.html#2088581">i</a></span><span class="op" id="2088614">]</span>&nbsp;<span class="op" id="2088616">|</span>&nbsp;<span class="ident" id="2088618"><a href="/gostd/math/big/nat.go.html#2088465">y</a></span><span class="op" id="2088619">[</span><span class="ident" id="2088620"><a href="/gostd/math/big/nat.go.html#2088581">i</a></span><span class="op" id="2088621">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088624">}</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2088627">copy</span><span class="op" id="2088631">(</span><span class="ident" id="2088632"><a href="/gostd/math/big/nat.go.html#2088452">z</a></span><span class="op" id="2088633">[</span><span class="ident" id="2088634"><a href="/gostd/math/big/nat.go.html#2088492">n</a></span><span class="op" id="2088635">:</span><span class="ident" id="2088636"><a href="/gostd/math/big/nat.go.html#2088479">m</a></span><span class="op" id="2088637">]</span><span class="op" id="2088638">,</span>&nbsp;<span class="ident" id="2088640"><a href="/gostd/math/big/nat.go.html#2088505">s</a></span><span class="op" id="2088641">[</span><span class="ident" id="2088642"><a href="/gostd/math/big/nat.go.html#2088492">n</a></span><span class="op" id="2088643">:</span><span class="ident" id="2088644"><a href="/gostd/math/big/nat.go.html#2088479">m</a></span><span class="op" id="2088645">]</span><span class="op" id="2088646">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088650">return</span>&nbsp;<span class="ident" id="2088657"><a href="/gostd/math/big/nat.go.html#2088452">z</a></span><span class="op" id="2088658">.</span><span class="ident" id="2088659"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2088663">(</span><span class="op" id="2088664">)</span><br>
<span class="lineno"></span><span class="op" id="2088666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1160</span><span class="keyword" id="2088669">func</span>&nbsp;<span class="op" id="2088674">(</span><span class="ident" id="2088675">z</span>&nbsp;<span class="ident" id="2088677"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2088680">)</span>&nbsp;<span class="ident" id="2088682">xor</span><span class="op" id="2088685">(</span><span class="ident" id="2088686">x</span><span class="op" id="2088687">,</span>&nbsp;<span class="ident" id="2088689">y</span>&nbsp;<span class="ident" id="2088691"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2088694">)</span>&nbsp;<span class="ident" id="2088696"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2088700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088703">m</span>&nbsp;<span class="op" id="2088705">:=</span>&nbsp;<span class="builtinfunc" id="2088708">len</span><span class="op" id="2088711">(</span><span class="ident" id="2088712"><a href="/gostd/math/big/nat.go.html#2088686">x</a></span><span class="op" id="2088713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088716">n</span>&nbsp;<span class="op" id="2088718">:=</span>&nbsp;<span class="builtinfunc" id="2088721">len</span><span class="op" id="2088724">(</span><span class="ident" id="2088725"><a href="/gostd/math/big/nat.go.html#2088689">y</a></span><span class="op" id="2088726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088729">s</span>&nbsp;<span class="op" id="2088731">:=</span>&nbsp;<span class="ident" id="2088734"><a href="/gostd/math/big/nat.go.html#2088686">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088737">if</span>&nbsp;<span class="ident" id="2088740"><a href="/gostd/math/big/nat.go.html#2088703">m</a></span>&nbsp;<span class="op" id="2088742">&lt;</span>&nbsp;<span class="ident" id="2088744"><a href="/gostd/math/big/nat.go.html#2088716">n</a></span>&nbsp;<span class="op" id="2088746">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088750"><a href="/gostd/math/big/nat.go.html#2088716">n</a></span><span class="op" id="2088751">,</span>&nbsp;<span class="ident" id="2088753"><a href="/gostd/math/big/nat.go.html#2088703">m</a></span>&nbsp;<span class="op" id="2088755">=</span>&nbsp;<span class="ident" id="2088757"><a href="/gostd/math/big/nat.go.html#2088703">m</a></span><span class="op" id="2088758">,</span>&nbsp;<span class="ident" id="2088760"><a href="/gostd/math/big/nat.go.html#2088716">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088764"><a href="/gostd/math/big/nat.go.html#2088729">s</a></span>&nbsp;<span class="op" id="2088766">=</span>&nbsp;<span class="ident" id="2088768"><a href="/gostd/math/big/nat.go.html#2088689">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2088774">//&nbsp;m&nbsp;&gt;=&nbsp;n</span><br>
<span class="lineno"></span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088786"><a href="/gostd/math/big/nat.go.html#2088675">z</a></span>&nbsp;<span class="op" id="2088788">=</span>&nbsp;<span class="ident" id="2088790"><a href="/gostd/math/big/nat.go.html#2088675">z</a></span><span class="op" id="2088791">.</span><span class="builtinfunc" id="2088792"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2088796">(</span><span class="ident" id="2088797"><a href="/gostd/math/big/nat.go.html#2088703">m</a></span><span class="op" id="2088798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088801">for</span>&nbsp;<span class="ident" id="2088805">i</span>&nbsp;<span class="op" id="2088807">:=</span>&nbsp;<span class="num" id="2088810">0</span><span class="op" id="2088811">;</span>&nbsp;<span class="ident" id="2088813"><a href="/gostd/math/big/nat.go.html#2088805">i</a></span>&nbsp;<span class="op" id="2088815">&lt;</span>&nbsp;<span class="ident" id="2088817"><a href="/gostd/math/big/nat.go.html#2088716">n</a></span><span class="op" id="2088818">;</span>&nbsp;<span class="ident" id="2088820"><a href="/gostd/math/big/nat.go.html#2088805">i</a></span><span class="op" id="2088821">++</span>&nbsp;<span class="op" id="2088824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088828"><a href="/gostd/math/big/nat.go.html#2088675">z</a></span><span class="op" id="2088829">[</span><span class="ident" id="2088830"><a href="/gostd/math/big/nat.go.html#2088805">i</a></span><span class="op" id="2088831">]</span>&nbsp;<span class="op" id="2088833">=</span>&nbsp;<span class="ident" id="2088835"><a href="/gostd/math/big/nat.go.html#2088686">x</a></span><span class="op" id="2088836">[</span><span class="ident" id="2088837"><a href="/gostd/math/big/nat.go.html#2088805">i</a></span><span class="op" id="2088838">]</span>&nbsp;<span class="op" id="2088840">^</span>&nbsp;<span class="ident" id="2088842"><a href="/gostd/math/big/nat.go.html#2088689">y</a></span><span class="op" id="2088843">[</span><span class="ident" id="2088844"><a href="/gostd/math/big/nat.go.html#2088805">i</a></span><span class="op" id="2088845">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2088851">copy</span><span class="op" id="2088855">(</span><span class="ident" id="2088856"><a href="/gostd/math/big/nat.go.html#2088675">z</a></span><span class="op" id="2088857">[</span><span class="ident" id="2088858"><a href="/gostd/math/big/nat.go.html#2088716">n</a></span><span class="op" id="2088859">:</span><span class="ident" id="2088860"><a href="/gostd/math/big/nat.go.html#2088703">m</a></span><span class="op" id="2088861">]</span><span class="op" id="2088862">,</span>&nbsp;<span class="ident" id="2088864"><a href="/gostd/math/big/nat.go.html#2088729">s</a></span><span class="op" id="2088865">[</span><span class="ident" id="2088866"><a href="/gostd/math/big/nat.go.html#2088716">n</a></span><span class="op" id="2088867">:</span><span class="ident" id="2088868"><a href="/gostd/math/big/nat.go.html#2088703">m</a></span><span class="op" id="2088869">]</span><span class="op" id="2088870">)</span><br>
<span class="lineno">1175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088874">return</span>&nbsp;<span class="ident" id="2088881"><a href="/gostd/math/big/nat.go.html#2088675">z</a></span><span class="op" id="2088882">.</span><span class="ident" id="2088883"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2088887">(</span><span class="op" id="2088888">)</span><br>
<span class="lineno"></span><span class="op" id="2088890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2088893">//&nbsp;greaterThan&nbsp;returns&nbsp;true&nbsp;iff&nbsp;(x1&lt;&lt;_W&nbsp;+&nbsp;x2)&nbsp;&gt;&nbsp;(y1&lt;&lt;_W&nbsp;+&nbsp;y2)</span><br>
<span class="lineno">1180</span><span class="keyword" id="2088955">func</span>&nbsp;<span class="ident" id="2088960">greaterThan</span><span class="op" id="2088971">(</span><span class="ident" id="2088972">x1</span><span class="op" id="2088974">,</span>&nbsp;<span class="ident" id="2088976">x2</span><span class="op" id="2088978">,</span>&nbsp;<span class="ident" id="2088980">y1</span><span class="op" id="2088982">,</span>&nbsp;<span class="ident" id="2088984">y2</span>&nbsp;<span class="ident" id="2088987"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2088991">)</span>&nbsp;<span class="builtintype" id="2088993">bool</span>&nbsp;<span class="op" id="2088998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089001">return</span>&nbsp;<span class="ident" id="2089008"><a href="/gostd/math/big/nat.go.html#2088972">x1</a></span>&nbsp;<span class="op" id="2089011">&gt;</span>&nbsp;<span class="ident" id="2089013"><a href="/gostd/math/big/nat.go.html#2088980">y1</a></span>&nbsp;<span class="op" id="2089016">||</span>&nbsp;<span class="ident" id="2089019"><a href="/gostd/math/big/nat.go.html#2088972">x1</a></span>&nbsp;<span class="op" id="2089022">==</span>&nbsp;<span class="ident" id="2089025"><a href="/gostd/math/big/nat.go.html#2088980">y1</a></span>&nbsp;<span class="op" id="2089028">&amp;&amp;</span>&nbsp;<span class="ident" id="2089031"><a href="/gostd/math/big/nat.go.html#2088976">x2</a></span>&nbsp;<span class="op" id="2089034">&gt;</span>&nbsp;<span class="ident" id="2089036"><a href="/gostd/math/big/nat.go.html#2088984">y2</a></span><br>
<span class="lineno"></span><span class="op" id="2089039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2089042">//&nbsp;modW&nbsp;returns&nbsp;x&nbsp;%&nbsp;d.</span><br>
<span class="lineno">1185</span><span class="keyword" id="2089065">func</span>&nbsp;<span class="op" id="2089070">(</span><span class="ident" id="2089071">x</span>&nbsp;<span class="ident" id="2089073"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2089076">)</span>&nbsp;<span class="ident" id="2089078">modW</span><span class="op" id="2089082">(</span><span class="ident" id="2089083">d</span>&nbsp;<span class="ident" id="2089085"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2089089">)</span>&nbsp;<span class="op" id="2089091">(</span><span class="ident" id="2089092">r</span>&nbsp;<span class="ident" id="2089094"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2089098">)</span>&nbsp;<span class="op" id="2089100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2089103">//&nbsp;TODO(agl):&nbsp;we&nbsp;don&#39;t&nbsp;actually&nbsp;need&nbsp;to&nbsp;store&nbsp;the&nbsp;q&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089163">var</span>&nbsp;<span class="ident" id="2089167">q</span>&nbsp;<span class="ident" id="2089169"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089174"><a href="/gostd/math/big/nat.go.html#2089167">q</a></span>&nbsp;<span class="op" id="2089176">=</span>&nbsp;<span class="ident" id="2089178"><a href="/gostd/math/big/nat.go.html#2089167">q</a></span><span class="op" id="2089179">.</span><span class="builtinfunc" id="2089180"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2089184">(</span><span class="builtinfunc" id="2089185">len</span><span class="op" id="2089188">(</span><span class="ident" id="2089189"><a href="/gostd/math/big/nat.go.html#2089071">x</a></span><span class="op" id="2089190">)</span><span class="op" id="2089191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089194">return</span>&nbsp;<span class="ident" id="2089201"><a href="/gostd/math/big/arith_decl.go.html#2035500">divWVW</a></span><span class="op" id="2089207">(</span><span class="ident" id="2089208"><a href="/gostd/math/big/nat.go.html#2089167">q</a></span><span class="op" id="2089209">,</span>&nbsp;<span class="num" id="2089211">0</span><span class="op" id="2089212">,</span>&nbsp;<span class="ident" id="2089214"><a href="/gostd/math/big/nat.go.html#2089071">x</a></span><span class="op" id="2089215">,</span>&nbsp;<span class="ident" id="2089217"><a href="/gostd/math/big/nat.go.html#2089083">d</a></span><span class="op" id="2089218">)</span><br>
<span class="lineno">1190</span><span class="op" id="2089220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2089223">//&nbsp;random&nbsp;creates&nbsp;a&nbsp;random&nbsp;integer&nbsp;in&nbsp;[0..limit),&nbsp;using&nbsp;the&nbsp;space&nbsp;in&nbsp;z&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2089297">//&nbsp;possible.&nbsp;n&nbsp;is&nbsp;the&nbsp;bit&nbsp;length&nbsp;of&nbsp;limit.</span><br>
<span class="lineno"></span><span class="keyword" id="2089340">func</span>&nbsp;<span class="op" id="2089345">(</span><span class="ident" id="2089346">z</span>&nbsp;<span class="ident" id="2089348"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2089351">)</span>&nbsp;<span class="ident" id="2089353">random</span><span class="op" id="2089359">(</span><span class="ident" id="2089360">rand</span>&nbsp;<span class="op" id="2089365">*</span><span class="ident" id="2089366"><a href="/gostd/math/big/nat.go.html#2061619">rand</a></span><span class="op" id="2089370">.</span><span class="ident" id="2089371"><a href="/gostd/math/rand/rand.go.html#2921995">Rand</a></span><span class="op" id="2089375">,</span>&nbsp;<span class="ident" id="2089377">limit</span>&nbsp;<span class="ident" id="2089383"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2089386">,</span>&nbsp;<span class="ident" id="2089388">n</span>&nbsp;<span class="builtintype" id="2089390">int</span><span class="op" id="2089393">)</span>&nbsp;<span class="ident" id="2089395"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2089399">{</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089402">if</span>&nbsp;<span class="ident" id="2089405"><a href="/gostd/math/big/nat.go.html#2068133">alias</a></span><span class="op" id="2089410">(</span><span class="ident" id="2089411"><a href="/gostd/math/big/nat.go.html#2089346">z</a></span><span class="op" id="2089412">,</span>&nbsp;<span class="ident" id="2089414"><a href="/gostd/math/big/nat.go.html#2089377">limit</a></span><span class="op" id="2089419">)</span>&nbsp;<span class="op" id="2089421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089425"><a href="/gostd/math/big/nat.go.html#2089346">z</a></span>&nbsp;<span class="op" id="2089427">=</span>&nbsp;<span class="builtintype" id="2089429">nil</span>&nbsp;<span class="comment" id="2089433">//&nbsp;z&nbsp;is&nbsp;an&nbsp;alias&nbsp;for&nbsp;limit&nbsp;-&nbsp;cannot&nbsp;reuse</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089479"><a href="/gostd/math/big/nat.go.html#2089346">z</a></span>&nbsp;<span class="op" id="2089481">=</span>&nbsp;<span class="ident" id="2089483"><a href="/gostd/math/big/nat.go.html#2089346">z</a></span><span class="op" id="2089484">.</span><span class="builtinfunc" id="2089485"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2089489">(</span><span class="builtinfunc" id="2089490">len</span><span class="op" id="2089493">(</span><span class="ident" id="2089494"><a href="/gostd/math/big/nat.go.html#2089377">limit</a></span><span class="op" id="2089499">)</span><span class="op" id="2089500">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089504">bitLengthOfMSW</span>&nbsp;<span class="op" id="2089519">:=</span>&nbsp;<span class="builtintype" id="2089522">uint</span><span class="op" id="2089526">(</span><span class="ident" id="2089527"><a href="/gostd/math/big/nat.go.html#2089388">n</a></span>&nbsp;<span class="op" id="2089529">%</span>&nbsp;<span class="ident" id="2089531"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span><span class="op" id="2089533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089536">if</span>&nbsp;<span class="ident" id="2089539"><a href="/gostd/math/big/nat.go.html#2089504">bitLengthOfMSW</a></span>&nbsp;<span class="op" id="2089554">==</span>&nbsp;<span class="num" id="2089557">0</span>&nbsp;<span class="op" id="2089559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089563"><a href="/gostd/math/big/nat.go.html#2089504">bitLengthOfMSW</a></span>&nbsp;<span class="op" id="2089578">=</span>&nbsp;<span class="ident" id="2089580"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089587">mask</span>&nbsp;<span class="op" id="2089592">:=</span>&nbsp;<span class="ident" id="2089595"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2089599">(</span><span class="op" id="2089600">(</span><span class="num" id="2089601">1</span>&nbsp;<span class="op" id="2089603">&lt;&lt;</span>&nbsp;<span class="ident" id="2089606"><a href="/gostd/math/big/nat.go.html#2089504">bitLengthOfMSW</a></span><span class="op" id="2089620">)</span>&nbsp;<span class="op" id="2089622">-</span>&nbsp;<span class="num" id="2089624">1</span><span class="op" id="2089625">)</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089629">for</span>&nbsp;<span class="op" id="2089633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089637">switch</span>&nbsp;<span class="ident" id="2089644"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span>&nbsp;<span class="op" id="2089647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089651">case</span>&nbsp;<span class="num" id="2089656">32</span><span class="op" id="2089658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089663">for</span>&nbsp;<span class="ident" id="2089667">i</span>&nbsp;<span class="op" id="2089669">:=</span>&nbsp;<span class="keyword" id="2089672">range</span>&nbsp;<span class="ident" id="2089678"><a href="/gostd/math/big/nat.go.html#2089346">z</a></span>&nbsp;<span class="op" id="2089680">{</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089686"><a href="/gostd/math/big/nat.go.html#2089346">z</a></span><span class="op" id="2089687">[</span><span class="ident" id="2089688"><a href="/gostd/math/big/nat.go.html#2089667">i</a></span><span class="op" id="2089689">]</span>&nbsp;<span class="op" id="2089691">=</span>&nbsp;<span class="ident" id="2089693"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2089697">(</span><span class="ident" id="2089698"><a href="/gostd/math/big/nat.go.html#2089360">rand</a></span><span class="op" id="2089702">.</span><span class="ident" id="2089703"><a href="/gostd/math/rand/rand.go.html#2922518">Uint32</a></span><span class="op" id="2089709">(</span><span class="op" id="2089710">)</span><span class="op" id="2089711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089720">case</span>&nbsp;<span class="num" id="2089725">64</span><span class="op" id="2089727">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089732">for</span>&nbsp;<span class="ident" id="2089736">i</span>&nbsp;<span class="op" id="2089738">:=</span>&nbsp;<span class="keyword" id="2089741">range</span>&nbsp;<span class="ident" id="2089747"><a href="/gostd/math/big/nat.go.html#2089346">z</a></span>&nbsp;<span class="op" id="2089749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089755"><a href="/gostd/math/big/nat.go.html#2089346">z</a></span><span class="op" id="2089756">[</span><span class="ident" id="2089757"><a href="/gostd/math/big/nat.go.html#2089736">i</a></span><span class="op" id="2089758">]</span>&nbsp;<span class="op" id="2089760">=</span>&nbsp;<span class="ident" id="2089762"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2089766">(</span><span class="ident" id="2089767"><a href="/gostd/math/big/nat.go.html#2089360">rand</a></span><span class="op" id="2089771">.</span><span class="ident" id="2089772"><a href="/gostd/math/rand/rand.go.html#2922518">Uint32</a></span><span class="op" id="2089778">(</span><span class="op" id="2089779">)</span><span class="op" id="2089780">)</span>&nbsp;<span class="op" id="2089782">|</span>&nbsp;<span class="ident" id="2089784"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2089788">(</span><span class="ident" id="2089789"><a href="/gostd/math/big/nat.go.html#2089360">rand</a></span><span class="op" id="2089793">.</span><span class="ident" id="2089794"><a href="/gostd/math/rand/rand.go.html#2922518">Uint32</a></span><span class="op" id="2089800">(</span><span class="op" id="2089801">)</span><span class="op" id="2089802">)</span><span class="op" id="2089803">&lt;&lt;</span><span class="num" id="2089805">32</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089815">default</span><span class="op" id="2089822">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2089827">panic</span><span class="op" id="2089832">(</span><span class="string" id="2089833">&#34;unknown&nbsp;word&nbsp;size&#34;</span><span class="op" id="2089852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089860"><a href="/gostd/math/big/nat.go.html#2089346">z</a></span><span class="op" id="2089861">[</span><span class="builtinfunc" id="2089862">len</span><span class="op" id="2089865">(</span><span class="ident" id="2089866"><a href="/gostd/math/big/nat.go.html#2089377">limit</a></span><span class="op" id="2089871">)</span><span class="op" id="2089872">-</span><span class="num" id="2089873">1</span><span class="op" id="2089874">]</span>&nbsp;<span class="op" id="2089876">&amp;=</span>&nbsp;<span class="ident" id="2089879"><a href="/gostd/math/big/nat.go.html#2089587">mask</a></span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089886">if</span>&nbsp;<span class="ident" id="2089889"><a href="/gostd/math/big/nat.go.html#2089346">z</a></span><span class="op" id="2089890">.</span><span class="ident" id="2089891"><a href="/gostd/math/big/nat.go.html#2063929">cmp</a></span><span class="op" id="2089894">(</span><span class="ident" id="2089895"><a href="/gostd/math/big/nat.go.html#2089377">limit</a></span><span class="op" id="2089900">)</span>&nbsp;<span class="op" id="2089902">&lt;</span>&nbsp;<span class="num" id="2089904">0</span>&nbsp;<span class="op" id="2089906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089911">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089926">return</span>&nbsp;<span class="ident" id="2089933"><a href="/gostd/math/big/nat.go.html#2089346">z</a></span><span class="op" id="2089934">.</span><span class="ident" id="2089935"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2089939">(</span><span class="op" id="2089940">)</span><br>
<span class="lineno"></span><span class="op" id="2089942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2089945">//&nbsp;If&nbsp;m&nbsp;!=&nbsp;0&nbsp;(i.e.,&nbsp;len(m)&nbsp;!=&nbsp;0),&nbsp;expNN&nbsp;sets&nbsp;z&nbsp;to&nbsp;x**y&nbsp;mod&nbsp;m;</span><br>
<span class="lineno"></span><span class="comment" id="2090007">//&nbsp;otherwise&nbsp;it&nbsp;sets&nbsp;z&nbsp;to&nbsp;x**y.&nbsp;The&nbsp;result&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;z.</span><br>
<span class="lineno">1230</span><span class="keyword" id="2090069">func</span>&nbsp;<span class="op" id="2090074">(</span><span class="ident" id="2090075">z</span>&nbsp;<span class="ident" id="2090077"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2090080">)</span>&nbsp;<span class="ident" id="2090082">expNN</span><span class="op" id="2090087">(</span><span class="ident" id="2090088">x</span><span class="op" id="2090089">,</span>&nbsp;<span class="ident" id="2090091">y</span><span class="op" id="2090092">,</span>&nbsp;<span class="ident" id="2090094">m</span>&nbsp;<span class="ident" id="2090096"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2090099">)</span>&nbsp;<span class="ident" id="2090101"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2090105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090108">if</span>&nbsp;<span class="ident" id="2090111"><a href="/gostd/math/big/nat.go.html#2068133">alias</a></span><span class="op" id="2090116">(</span><span class="ident" id="2090117"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2090118">,</span>&nbsp;<span class="ident" id="2090120"><a href="/gostd/math/big/nat.go.html#2090088">x</a></span><span class="op" id="2090121">)</span>&nbsp;<span class="op" id="2090123">||</span>&nbsp;<span class="ident" id="2090126"><a href="/gostd/math/big/nat.go.html#2068133">alias</a></span><span class="op" id="2090131">(</span><span class="ident" id="2090132"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2090133">,</span>&nbsp;<span class="ident" id="2090135"><a href="/gostd/math/big/nat.go.html#2090091">y</a></span><span class="op" id="2090136">)</span>&nbsp;<span class="op" id="2090138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2090142">//&nbsp;We&nbsp;cannot&nbsp;allow&nbsp;in-place&nbsp;modification&nbsp;of&nbsp;x&nbsp;or&nbsp;y.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090196"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span>&nbsp;<span class="op" id="2090198">=</span>&nbsp;<span class="builtintype" id="2090200">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090205">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2090209">//&nbsp;x**y&nbsp;mod&nbsp;1&nbsp;==&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090229">if</span>&nbsp;<span class="builtinfunc" id="2090232">len</span><span class="op" id="2090235">(</span><span class="ident" id="2090236"><a href="/gostd/math/big/nat.go.html#2090094">m</a></span><span class="op" id="2090237">)</span>&nbsp;<span class="op" id="2090239">==</span>&nbsp;<span class="num" id="2090242">1</span>&nbsp;<span class="op" id="2090244">&amp;&amp;</span>&nbsp;<span class="ident" id="2090247"><a href="/gostd/math/big/nat.go.html#2090094">m</a></span><span class="op" id="2090248">[</span><span class="num" id="2090249">0</span><span class="op" id="2090250">]</span>&nbsp;<span class="op" id="2090252">==</span>&nbsp;<span class="num" id="2090255">1</span>&nbsp;<span class="op" id="2090257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090261">return</span>&nbsp;<span class="ident" id="2090268"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2090269">.</span><span class="ident" id="2090270"><a href="/gostd/math/big/nat.go.html#2062665">setWord</a></span><span class="op" id="2090277">(</span><span class="num" id="2090278">0</span><span class="op" id="2090279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090282">}</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2090285">//&nbsp;m&nbsp;==&nbsp;0&nbsp;||&nbsp;m&nbsp;&gt;&nbsp;1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2090306">//&nbsp;x**0&nbsp;==&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090320">if</span>&nbsp;<span class="builtinfunc" id="2090323">len</span><span class="op" id="2090326">(</span><span class="ident" id="2090327"><a href="/gostd/math/big/nat.go.html#2090091">y</a></span><span class="op" id="2090328">)</span>&nbsp;<span class="op" id="2090330">==</span>&nbsp;<span class="num" id="2090333">0</span>&nbsp;<span class="op" id="2090335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090339">return</span>&nbsp;<span class="ident" id="2090346"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2090347">.</span><span class="ident" id="2090348"><a href="/gostd/math/big/nat.go.html#2062665">setWord</a></span><span class="op" id="2090355">(</span><span class="num" id="2090356">1</span><span class="op" id="2090357">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2090363">//&nbsp;y&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090374">if</span>&nbsp;<span class="builtinfunc" id="2090377">len</span><span class="op" id="2090380">(</span><span class="ident" id="2090381"><a href="/gostd/math/big/nat.go.html#2090094">m</a></span><span class="op" id="2090382">)</span>&nbsp;<span class="op" id="2090384">!=</span>&nbsp;<span class="num" id="2090387">0</span>&nbsp;<span class="op" id="2090389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2090393">//&nbsp;We&nbsp;likely&nbsp;end&nbsp;up&nbsp;being&nbsp;as&nbsp;long&nbsp;as&nbsp;the&nbsp;modulus.</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090445"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span>&nbsp;<span class="op" id="2090447">=</span>&nbsp;<span class="ident" id="2090449"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2090450">.</span><span class="builtinfunc" id="2090451"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2090455">(</span><span class="builtinfunc" id="2090456">len</span><span class="op" id="2090459">(</span><span class="ident" id="2090460"><a href="/gostd/math/big/nat.go.html#2090094">m</a></span><span class="op" id="2090461">)</span><span class="op" id="2090462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090468"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span>&nbsp;<span class="op" id="2090470">=</span>&nbsp;<span class="ident" id="2090472"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2090473">.</span><span class="ident" id="2090474"><a href="/gostd/math/big/nat.go.html#2063110">set</a></span><span class="op" id="2090477">(</span><span class="ident" id="2090478"><a href="/gostd/math/big/nat.go.html#2090088">x</a></span><span class="op" id="2090479">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2090483">//&nbsp;If&nbsp;the&nbsp;base&nbsp;is&nbsp;non-trivial&nbsp;and&nbsp;the&nbsp;exponent&nbsp;is&nbsp;large,&nbsp;we&nbsp;use</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2090548">//&nbsp;4-bit,&nbsp;windowed&nbsp;exponentiation.&nbsp;This&nbsp;involves&nbsp;precomputing&nbsp;14&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2090621">//&nbsp;(x^2...x^15)&nbsp;but&nbsp;then&nbsp;reduces&nbsp;the&nbsp;number&nbsp;of&nbsp;multiply-reduces&nbsp;by&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2090691">//&nbsp;third.&nbsp;Even&nbsp;for&nbsp;a&nbsp;32-bit&nbsp;exponent,&nbsp;this&nbsp;reduces&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2090757">//&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090773">if</span>&nbsp;<span class="builtinfunc" id="2090776">len</span><span class="op" id="2090779">(</span><span class="ident" id="2090780"><a href="/gostd/math/big/nat.go.html#2090088">x</a></span><span class="op" id="2090781">)</span>&nbsp;<span class="op" id="2090783">&gt;</span>&nbsp;<span class="num" id="2090785">1</span>&nbsp;<span class="op" id="2090787">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2090790">len</span><span class="op" id="2090793">(</span><span class="ident" id="2090794"><a href="/gostd/math/big/nat.go.html#2090091">y</a></span><span class="op" id="2090795">)</span>&nbsp;<span class="op" id="2090797">&gt;</span>&nbsp;<span class="num" id="2090799">1</span>&nbsp;<span class="op" id="2090801">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2090804">len</span><span class="op" id="2090807">(</span><span class="ident" id="2090808"><a href="/gostd/math/big/nat.go.html#2090094">m</a></span><span class="op" id="2090809">)</span>&nbsp;<span class="op" id="2090811">&gt;</span>&nbsp;<span class="num" id="2090813">0</span>&nbsp;<span class="op" id="2090815">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090819">return</span>&nbsp;<span class="ident" id="2090826"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2090827">.</span><span class="ident" id="2090828"><a href="/gostd/math/big/nat.go.html#2091942">expNNWindowed</a></span><span class="op" id="2090841">(</span><span class="ident" id="2090842"><a href="/gostd/math/big/nat.go.html#2090088">x</a></span><span class="op" id="2090843">,</span>&nbsp;<span class="ident" id="2090845"><a href="/gostd/math/big/nat.go.html#2090091">y</a></span><span class="op" id="2090846">,</span>&nbsp;<span class="ident" id="2090848"><a href="/gostd/math/big/nat.go.html#2090094">m</a></span><span class="op" id="2090849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090856">v</span>&nbsp;<span class="op" id="2090858">:=</span>&nbsp;<span class="ident" id="2090861"><a href="/gostd/math/big/nat.go.html#2090091">y</a></span><span class="op" id="2090862">[</span><span class="builtinfunc" id="2090863">len</span><span class="op" id="2090866">(</span><span class="ident" id="2090867"><a href="/gostd/math/big/nat.go.html#2090091">y</a></span><span class="op" id="2090868">)</span><span class="op" id="2090869">-</span><span class="num" id="2090870">1</span><span class="op" id="2090871">]</span>&nbsp;<span class="comment" id="2090873">//&nbsp;v&nbsp;&gt;&nbsp;0&nbsp;because&nbsp;y&nbsp;is&nbsp;normalized&nbsp;and&nbsp;y&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090917">shift</span>&nbsp;<span class="op" id="2090923">:=</span>&nbsp;<span class="ident" id="2090926"><a href="/gostd/math/big/arith.go.html#2032784">leadingZeros</a></span><span class="op" id="2090938">(</span><span class="ident" id="2090939"><a href="/gostd/math/big/nat.go.html#2090856">v</a></span><span class="op" id="2090940">)</span>&nbsp;<span class="op" id="2090942">+</span>&nbsp;<span class="num" id="2090944">1</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090947"><a href="/gostd/math/big/nat.go.html#2090856">v</a></span>&nbsp;<span class="op" id="2090949">&lt;&lt;=</span>&nbsp;<span class="ident" id="2090953"><a href="/gostd/math/big/nat.go.html#2090917">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090960">var</span>&nbsp;<span class="ident" id="2090964">q</span>&nbsp;<span class="ident" id="2090966"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090972">const</span>&nbsp;<span class="ident" id="2090978">mask</span>&nbsp;<span class="op" id="2090983">=</span>&nbsp;<span class="num" id="2090985">1</span>&nbsp;<span class="op" id="2090987">&lt;&lt;</span>&nbsp;<span class="op" id="2090990">(</span><span class="ident" id="2090991"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span>&nbsp;<span class="op" id="2090994">-</span>&nbsp;<span class="num" id="2090996">1</span><span class="op" id="2090997">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2091001">//&nbsp;We&nbsp;walk&nbsp;through&nbsp;the&nbsp;bits&nbsp;of&nbsp;the&nbsp;exponent&nbsp;one&nbsp;by&nbsp;one.&nbsp;Each&nbsp;time&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2091071">//&nbsp;see&nbsp;a&nbsp;bit,&nbsp;we&nbsp;square,&nbsp;thus&nbsp;doubling&nbsp;the&nbsp;power.&nbsp;If&nbsp;the&nbsp;bit&nbsp;is&nbsp;a&nbsp;one,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2091143">//&nbsp;we&nbsp;also&nbsp;multiply&nbsp;by&nbsp;x,&nbsp;thus&nbsp;adding&nbsp;one&nbsp;to&nbsp;the&nbsp;power.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091201">w</span>&nbsp;<span class="op" id="2091203">:=</span>&nbsp;<span class="ident" id="2091206"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span>&nbsp;<span class="op" id="2091209">-</span>&nbsp;<span class="builtintype" id="2091211">int</span><span class="op" id="2091214">(</span><span class="ident" id="2091215"><a href="/gostd/math/big/nat.go.html#2090917">shift</a></span><span class="op" id="2091220">)</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2091223">//&nbsp;zz&nbsp;and&nbsp;r&nbsp;are&nbsp;used&nbsp;to&nbsp;avoid&nbsp;allocating&nbsp;in&nbsp;mul&nbsp;and&nbsp;div&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2091283">//&nbsp;otherwise&nbsp;the&nbsp;arguments&nbsp;would&nbsp;alias.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091324">var</span>&nbsp;<span class="ident" id="2091328">zz</span><span class="op" id="2091330">,</span>&nbsp;<span class="ident" id="2091332">r</span>&nbsp;<span class="ident" id="2091334"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091339">for</span>&nbsp;<span class="ident" id="2091343">j</span>&nbsp;<span class="op" id="2091345">:=</span>&nbsp;<span class="num" id="2091348">0</span><span class="op" id="2091349">;</span>&nbsp;<span class="ident" id="2091351"><a href="/gostd/math/big/nat.go.html#2091343">j</a></span>&nbsp;<span class="op" id="2091353">&lt;</span>&nbsp;<span class="ident" id="2091355"><a href="/gostd/math/big/nat.go.html#2091201">w</a></span><span class="op" id="2091356">;</span>&nbsp;<span class="ident" id="2091358"><a href="/gostd/math/big/nat.go.html#2091343">j</a></span><span class="op" id="2091359">++</span>&nbsp;<span class="op" id="2091362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091366"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span>&nbsp;<span class="op" id="2091369">=</span>&nbsp;<span class="ident" id="2091371"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><span class="op" id="2091373">.</span><span class="ident" id="2091374"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2091377">(</span><span class="ident" id="2091378"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2091379">,</span>&nbsp;<span class="ident" id="2091381"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2091382">)</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091386"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><span class="op" id="2091388">,</span>&nbsp;<span class="ident" id="2091390"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span>&nbsp;<span class="op" id="2091392">=</span>&nbsp;<span class="ident" id="2091394"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2091395">,</span>&nbsp;<span class="ident" id="2091397"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091403">if</span>&nbsp;<span class="ident" id="2091406"><a href="/gostd/math/big/nat.go.html#2090856">v</a></span><span class="op" id="2091407">&amp;</span><span class="ident" id="2091408"><a href="/gostd/math/big/nat.go.html#2090978">mask</a></span>&nbsp;<span class="op" id="2091413">!=</span>&nbsp;<span class="num" id="2091416">0</span>&nbsp;<span class="op" id="2091418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091423"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span>&nbsp;<span class="op" id="2091426">=</span>&nbsp;<span class="ident" id="2091428"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><span class="op" id="2091430">.</span><span class="ident" id="2091431"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2091434">(</span><span class="ident" id="2091435"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2091436">,</span>&nbsp;<span class="ident" id="2091438"><a href="/gostd/math/big/nat.go.html#2090088">x</a></span><span class="op" id="2091439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091444"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><span class="op" id="2091446">,</span>&nbsp;<span class="ident" id="2091448"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span>&nbsp;<span class="op" id="2091450">=</span>&nbsp;<span class="ident" id="2091452"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2091453">,</span>&nbsp;<span class="ident" id="2091455"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091465">if</span>&nbsp;<span class="builtinfunc" id="2091468">len</span><span class="op" id="2091471">(</span><span class="ident" id="2091472"><a href="/gostd/math/big/nat.go.html#2090094">m</a></span><span class="op" id="2091473">)</span>&nbsp;<span class="op" id="2091475">!=</span>&nbsp;<span class="num" id="2091478">0</span>&nbsp;<span class="op" id="2091480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091485"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><span class="op" id="2091487">,</span>&nbsp;<span class="ident" id="2091489"><a href="/gostd/math/big/nat.go.html#2091332">r</a></span>&nbsp;<span class="op" id="2091491">=</span>&nbsp;<span class="ident" id="2091493"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><span class="op" id="2091495">.</span><span class="ident" id="2091496"><a href="/gostd/math/big/nat.go.html#2071989">div</a></span><span class="op" id="2091499">(</span><span class="ident" id="2091500"><a href="/gostd/math/big/nat.go.html#2091332">r</a></span><span class="op" id="2091501">,</span>&nbsp;<span class="ident" id="2091503"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2091504">,</span>&nbsp;<span class="ident" id="2091506"><a href="/gostd/math/big/nat.go.html#2090094">m</a></span><span class="op" id="2091507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091512"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><span class="op" id="2091514">,</span>&nbsp;<span class="ident" id="2091516"><a href="/gostd/math/big/nat.go.html#2091332">r</a></span><span class="op" id="2091517">,</span>&nbsp;<span class="ident" id="2091519"><a href="/gostd/math/big/nat.go.html#2090964">q</a></span><span class="op" id="2091520">,</span>&nbsp;<span class="ident" id="2091522"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span>&nbsp;<span class="op" id="2091524">=</span>&nbsp;<span class="ident" id="2091526"><a href="/gostd/math/big/nat.go.html#2090964">q</a></span><span class="op" id="2091527">,</span>&nbsp;<span class="ident" id="2091529"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2091530">,</span>&nbsp;<span class="ident" id="2091532"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><span class="op" id="2091534">,</span>&nbsp;<span class="ident" id="2091536"><a href="/gostd/math/big/nat.go.html#2091332">r</a></span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091545"><a href="/gostd/math/big/nat.go.html#2090856">v</a></span>&nbsp;<span class="op" id="2091547">&lt;&lt;=</span>&nbsp;<span class="num" id="2091551">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091558">for</span>&nbsp;<span class="ident" id="2091562">i</span>&nbsp;<span class="op" id="2091564">:=</span>&nbsp;<span class="builtinfunc" id="2091567">len</span><span class="op" id="2091570">(</span><span class="ident" id="2091571"><a href="/gostd/math/big/nat.go.html#2090091">y</a></span><span class="op" id="2091572">)</span>&nbsp;<span class="op" id="2091574">-</span>&nbsp;<span class="num" id="2091576">2</span><span class="op" id="2091577">;</span>&nbsp;<span class="ident" id="2091579"><a href="/gostd/math/big/nat.go.html#2091562">i</a></span>&nbsp;<span class="op" id="2091581">&gt;=</span>&nbsp;<span class="num" id="2091584">0</span><span class="op" id="2091585">;</span>&nbsp;<span class="ident" id="2091587"><a href="/gostd/math/big/nat.go.html#2091562">i</a></span><span class="op" id="2091588">--</span>&nbsp;<span class="op" id="2091591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091595"><a href="/gostd/math/big/nat.go.html#2090856">v</a></span>&nbsp;<span class="op" id="2091597">=</span>&nbsp;<span class="ident" id="2091599"><a href="/gostd/math/big/nat.go.html#2090091">y</a></span><span class="op" id="2091600">[</span><span class="ident" id="2091601"><a href="/gostd/math/big/nat.go.html#2091562">i</a></span><span class="op" id="2091602">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091607">for</span>&nbsp;<span class="ident" id="2091611">j</span>&nbsp;<span class="op" id="2091613">:=</span>&nbsp;<span class="num" id="2091616">0</span><span class="op" id="2091617">;</span>&nbsp;<span class="ident" id="2091619"><a href="/gostd/math/big/nat.go.html#2091611">j</a></span>&nbsp;<span class="op" id="2091621">&lt;</span>&nbsp;<span class="ident" id="2091623"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span><span class="op" id="2091625">;</span>&nbsp;<span class="ident" id="2091627"><a href="/gostd/math/big/nat.go.html#2091611">j</a></span><span class="op" id="2091628">++</span>&nbsp;<span class="op" id="2091631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091636"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span>&nbsp;<span class="op" id="2091639">=</span>&nbsp;<span class="ident" id="2091641"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><span class="op" id="2091643">.</span><span class="ident" id="2091644"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2091647">(</span><span class="ident" id="2091648"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2091649">,</span>&nbsp;<span class="ident" id="2091651"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2091652">)</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091657"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><span class="op" id="2091659">,</span>&nbsp;<span class="ident" id="2091661"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span>&nbsp;<span class="op" id="2091663">=</span>&nbsp;<span class="ident" id="2091665"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2091666">,</span>&nbsp;<span class="ident" id="2091668"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091675">if</span>&nbsp;<span class="ident" id="2091678"><a href="/gostd/math/big/nat.go.html#2090856">v</a></span><span class="op" id="2091679">&amp;</span><span class="ident" id="2091680"><a href="/gostd/math/big/nat.go.html#2090978">mask</a></span>&nbsp;<span class="op" id="2091685">!=</span>&nbsp;<span class="num" id="2091688">0</span>&nbsp;<span class="op" id="2091690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091696"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span>&nbsp;<span class="op" id="2091699">=</span>&nbsp;<span class="ident" id="2091701"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><span class="op" id="2091703">.</span><span class="ident" id="2091704"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2091707">(</span><span class="ident" id="2091708"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2091709">,</span>&nbsp;<span class="ident" id="2091711"><a href="/gostd/math/big/nat.go.html#2090088">x</a></span><span class="op" id="2091712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091718"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><span class="op" id="2091720">,</span>&nbsp;<span class="ident" id="2091722"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span>&nbsp;<span class="op" id="2091724">=</span>&nbsp;<span class="ident" id="2091726"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2091727">,</span>&nbsp;<span class="ident" id="2091729"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091741">if</span>&nbsp;<span class="builtinfunc" id="2091744">len</span><span class="op" id="2091747">(</span><span class="ident" id="2091748"><a href="/gostd/math/big/nat.go.html#2090094">m</a></span><span class="op" id="2091749">)</span>&nbsp;<span class="op" id="2091751">!=</span>&nbsp;<span class="num" id="2091754">0</span>&nbsp;<span class="op" id="2091756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091762"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><span class="op" id="2091764">,</span>&nbsp;<span class="ident" id="2091766"><a href="/gostd/math/big/nat.go.html#2091332">r</a></span>&nbsp;<span class="op" id="2091768">=</span>&nbsp;<span class="ident" id="2091770"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><span class="op" id="2091772">.</span><span class="ident" id="2091773"><a href="/gostd/math/big/nat.go.html#2071989">div</a></span><span class="op" id="2091776">(</span><span class="ident" id="2091777"><a href="/gostd/math/big/nat.go.html#2091332">r</a></span><span class="op" id="2091778">,</span>&nbsp;<span class="ident" id="2091780"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2091781">,</span>&nbsp;<span class="ident" id="2091783"><a href="/gostd/math/big/nat.go.html#2090094">m</a></span><span class="op" id="2091784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091790"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><span class="op" id="2091792">,</span>&nbsp;<span class="ident" id="2091794"><a href="/gostd/math/big/nat.go.html#2091332">r</a></span><span class="op" id="2091795">,</span>&nbsp;<span class="ident" id="2091797"><a href="/gostd/math/big/nat.go.html#2090964">q</a></span><span class="op" id="2091798">,</span>&nbsp;<span class="ident" id="2091800"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span>&nbsp;<span class="op" id="2091802">=</span>&nbsp;<span class="ident" id="2091804"><a href="/gostd/math/big/nat.go.html#2090964">q</a></span><span class="op" id="2091805">,</span>&nbsp;<span class="ident" id="2091807"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2091808">,</span>&nbsp;<span class="ident" id="2091810"><a href="/gostd/math/big/nat.go.html#2091328">zz</a></span><span class="op" id="2091812">,</span>&nbsp;<span class="ident" id="2091814"><a href="/gostd/math/big/nat.go.html#2091332">r</a></span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091825"><a href="/gostd/math/big/nat.go.html#2090856">v</a></span>&nbsp;<span class="op" id="2091827">&lt;&lt;=</span>&nbsp;<span class="num" id="2091831">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091838">}</span><br>
<span class="lineno">1315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091842">return</span>&nbsp;<span class="ident" id="2091849"><a href="/gostd/math/big/nat.go.html#2090075">z</a></span><span class="op" id="2091850">.</span><span class="ident" id="2091851"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2091855">(</span><span class="op" id="2091856">)</span><br>
<span class="lineno"></span><span class="op" id="2091858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2091861">//&nbsp;expNNWindowed&nbsp;calculates&nbsp;x**y&nbsp;mod&nbsp;m&nbsp;using&nbsp;a&nbsp;fixed,&nbsp;4-bit&nbsp;window.</span><br>
<span class="lineno">1320</span><span class="keyword" id="2091929">func</span>&nbsp;<span class="op" id="2091934">(</span><span class="ident" id="2091935">z</span>&nbsp;<span class="ident" id="2091937"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2091940">)</span>&nbsp;<span class="ident" id="2091942">expNNWindowed</span><span class="op" id="2091955">(</span><span class="ident" id="2091956">x</span><span class="op" id="2091957">,</span>&nbsp;<span class="ident" id="2091959">y</span><span class="op" id="2091960">,</span>&nbsp;<span class="ident" id="2091962">m</span>&nbsp;<span class="ident" id="2091964"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2091967">)</span>&nbsp;<span class="ident" id="2091969"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2091973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2091976">//&nbsp;zz&nbsp;and&nbsp;r&nbsp;are&nbsp;used&nbsp;to&nbsp;avoid&nbsp;allocating&nbsp;in&nbsp;mul&nbsp;and&nbsp;div&nbsp;as&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092046">//&nbsp;the&nbsp;arguments&nbsp;would&nbsp;alias.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092077">var</span>&nbsp;<span class="ident" id="2092081">zz</span><span class="op" id="2092083">,</span>&nbsp;<span class="ident" id="2092085">r</span>&nbsp;<span class="ident" id="2092087"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092093">const</span>&nbsp;<span class="ident" id="2092099">n</span>&nbsp;<span class="op" id="2092101">=</span>&nbsp;<span class="num" id="2092103">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092106">//&nbsp;powers[i]&nbsp;contains&nbsp;x^i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092134">var</span>&nbsp;<span class="ident" id="2092138">powers</span>&nbsp;<span class="op" id="2092145">[</span><span class="num" id="2092146">1</span>&nbsp;<span class="op" id="2092148">&lt;&lt;</span>&nbsp;<span class="ident" id="2092151"><a href="/gostd/math/big/nat.go.html#2092099">n</a></span><span class="op" id="2092152">]</span><span class="ident" id="2092153"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092158"><a href="/gostd/math/big/nat.go.html#2092138">powers</a></span><span class="op" id="2092164">[</span><span class="num" id="2092165">0</span><span class="op" id="2092166">]</span>&nbsp;<span class="op" id="2092168">=</span>&nbsp;<span class="ident" id="2092170"><a href="/gostd/math/big/nat.go.html#2062174">natOne</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092178"><a href="/gostd/math/big/nat.go.html#2092138">powers</a></span><span class="op" id="2092184">[</span><span class="num" id="2092185">1</span><span class="op" id="2092186">]</span>&nbsp;<span class="op" id="2092188">=</span>&nbsp;<span class="ident" id="2092190"><a href="/gostd/math/big/nat.go.html#2091956">x</a></span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092193">for</span>&nbsp;<span class="ident" id="2092197">i</span>&nbsp;<span class="op" id="2092199">:=</span>&nbsp;<span class="num" id="2092202">2</span><span class="op" id="2092203">;</span>&nbsp;<span class="ident" id="2092205"><a href="/gostd/math/big/nat.go.html#2092197">i</a></span>&nbsp;<span class="op" id="2092207">&lt;</span>&nbsp;<span class="num" id="2092209">1</span><span class="op" id="2092210">&lt;&lt;</span><span class="ident" id="2092212"><a href="/gostd/math/big/nat.go.html#2092099">n</a></span><span class="op" id="2092213">;</span>&nbsp;<span class="ident" id="2092215"><a href="/gostd/math/big/nat.go.html#2092197">i</a></span>&nbsp;<span class="op" id="2092217">+=</span>&nbsp;<span class="num" id="2092220">2</span>&nbsp;<span class="op" id="2092222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092226">p2</span><span class="op" id="2092228">,</span>&nbsp;<span class="ident" id="2092230">p</span><span class="op" id="2092231">,</span>&nbsp;<span class="ident" id="2092233">p1</span>&nbsp;<span class="op" id="2092236">:=</span>&nbsp;<span class="op" id="2092239">&amp;</span><span class="ident" id="2092240"><a href="/gostd/math/big/nat.go.html#2092138">powers</a></span><span class="op" id="2092246">[</span><span class="ident" id="2092247"><a href="/gostd/math/big/nat.go.html#2092197">i</a></span><span class="op" id="2092248">/</span><span class="num" id="2092249">2</span><span class="op" id="2092250">]</span><span class="op" id="2092251">,</span>&nbsp;<span class="op" id="2092253">&amp;</span><span class="ident" id="2092254"><a href="/gostd/math/big/nat.go.html#2092138">powers</a></span><span class="op" id="2092260">[</span><span class="ident" id="2092261"><a href="/gostd/math/big/nat.go.html#2092197">i</a></span><span class="op" id="2092262">]</span><span class="op" id="2092263">,</span>&nbsp;<span class="op" id="2092265">&amp;</span><span class="ident" id="2092266"><a href="/gostd/math/big/nat.go.html#2092138">powers</a></span><span class="op" id="2092272">[</span><span class="ident" id="2092273"><a href="/gostd/math/big/nat.go.html#2092197">i</a></span><span class="op" id="2092274">+</span><span class="num" id="2092275">1</span><span class="op" id="2092276">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092280">*</span><span class="ident" id="2092281"><a href="/gostd/math/big/nat.go.html#2092230">p</a></span>&nbsp;<span class="op" id="2092283">=</span>&nbsp;<span class="ident" id="2092285"><a href="/gostd/math/big/nat.go.html#2092230">p</a></span><span class="op" id="2092286">.</span><span class="ident" id="2092287"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2092290">(</span><span class="op" id="2092291">*</span><span class="ident" id="2092292"><a href="/gostd/math/big/nat.go.html#2092226">p2</a></span><span class="op" id="2092294">,</span>&nbsp;<span class="op" id="2092296">*</span><span class="ident" id="2092297"><a href="/gostd/math/big/nat.go.html#2092226">p2</a></span><span class="op" id="2092299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092303"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092305">,</span>&nbsp;<span class="ident" id="2092307"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span>&nbsp;<span class="op" id="2092309">=</span>&nbsp;<span class="ident" id="2092311"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092313">.</span><span class="ident" id="2092314"><a href="/gostd/math/big/nat.go.html#2071989">div</a></span><span class="op" id="2092317">(</span><span class="ident" id="2092318"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span><span class="op" id="2092319">,</span>&nbsp;<span class="op" id="2092321">*</span><span class="ident" id="2092322"><a href="/gostd/math/big/nat.go.html#2092230">p</a></span><span class="op" id="2092323">,</span>&nbsp;<span class="ident" id="2092325"><a href="/gostd/math/big/nat.go.html#2091962">m</a></span><span class="op" id="2092326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092330">*</span><span class="ident" id="2092331"><a href="/gostd/math/big/nat.go.html#2092230">p</a></span><span class="op" id="2092332">,</span>&nbsp;<span class="ident" id="2092334"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span>&nbsp;<span class="op" id="2092336">=</span>&nbsp;<span class="ident" id="2092338"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span><span class="op" id="2092339">,</span>&nbsp;<span class="op" id="2092341">*</span><span class="ident" id="2092342"><a href="/gostd/math/big/nat.go.html#2092230">p</a></span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092346">*</span><span class="ident" id="2092347"><a href="/gostd/math/big/nat.go.html#2092233">p1</a></span>&nbsp;<span class="op" id="2092350">=</span>&nbsp;<span class="ident" id="2092352"><a href="/gostd/math/big/nat.go.html#2092233">p1</a></span><span class="op" id="2092354">.</span><span class="ident" id="2092355"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2092358">(</span><span class="op" id="2092359">*</span><span class="ident" id="2092360"><a href="/gostd/math/big/nat.go.html#2092230">p</a></span><span class="op" id="2092361">,</span>&nbsp;<span class="ident" id="2092363"><a href="/gostd/math/big/nat.go.html#2091956">x</a></span><span class="op" id="2092364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092368"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092370">,</span>&nbsp;<span class="ident" id="2092372"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span>&nbsp;<span class="op" id="2092374">=</span>&nbsp;<span class="ident" id="2092376"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092378">.</span><span class="ident" id="2092379"><a href="/gostd/math/big/nat.go.html#2071989">div</a></span><span class="op" id="2092382">(</span><span class="ident" id="2092383"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span><span class="op" id="2092384">,</span>&nbsp;<span class="op" id="2092386">*</span><span class="ident" id="2092387"><a href="/gostd/math/big/nat.go.html#2092233">p1</a></span><span class="op" id="2092389">,</span>&nbsp;<span class="ident" id="2092391"><a href="/gostd/math/big/nat.go.html#2091962">m</a></span><span class="op" id="2092392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092396">*</span><span class="ident" id="2092397"><a href="/gostd/math/big/nat.go.html#2092233">p1</a></span><span class="op" id="2092399">,</span>&nbsp;<span class="ident" id="2092401"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span>&nbsp;<span class="op" id="2092403">=</span>&nbsp;<span class="ident" id="2092405"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span><span class="op" id="2092406">,</span>&nbsp;<span class="op" id="2092408">*</span><span class="ident" id="2092409"><a href="/gostd/math/big/nat.go.html#2092233">p1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092417"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span>&nbsp;<span class="op" id="2092419">=</span>&nbsp;<span class="ident" id="2092421"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092422">.</span><span class="ident" id="2092423"><a href="/gostd/math/big/nat.go.html#2062665">setWord</a></span><span class="op" id="2092430">(</span><span class="num" id="2092431">1</span><span class="op" id="2092432">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092436">for</span>&nbsp;<span class="ident" id="2092440">i</span>&nbsp;<span class="op" id="2092442">:=</span>&nbsp;<span class="builtinfunc" id="2092445">len</span><span class="op" id="2092448">(</span><span class="ident" id="2092449"><a href="/gostd/math/big/nat.go.html#2091959">y</a></span><span class="op" id="2092450">)</span>&nbsp;<span class="op" id="2092452">-</span>&nbsp;<span class="num" id="2092454">1</span><span class="op" id="2092455">;</span>&nbsp;<span class="ident" id="2092457"><a href="/gostd/math/big/nat.go.html#2092440">i</a></span>&nbsp;<span class="op" id="2092459">&gt;=</span>&nbsp;<span class="num" id="2092462">0</span><span class="op" id="2092463">;</span>&nbsp;<span class="ident" id="2092465"><a href="/gostd/math/big/nat.go.html#2092440">i</a></span><span class="op" id="2092466">--</span>&nbsp;<span class="op" id="2092469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092473">yi</span>&nbsp;<span class="op" id="2092476">:=</span>&nbsp;<span class="ident" id="2092479"><a href="/gostd/math/big/nat.go.html#2091959">y</a></span><span class="op" id="2092480">[</span><span class="ident" id="2092481"><a href="/gostd/math/big/nat.go.html#2092440">i</a></span><span class="op" id="2092482">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092486">for</span>&nbsp;<span class="ident" id="2092490">j</span>&nbsp;<span class="op" id="2092492">:=</span>&nbsp;<span class="num" id="2092495">0</span><span class="op" id="2092496">;</span>&nbsp;<span class="ident" id="2092498"><a href="/gostd/math/big/nat.go.html#2092490">j</a></span>&nbsp;<span class="op" id="2092500">&lt;</span>&nbsp;<span class="ident" id="2092502"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span><span class="op" id="2092504">;</span>&nbsp;<span class="ident" id="2092506"><a href="/gostd/math/big/nat.go.html#2092490">j</a></span>&nbsp;<span class="op" id="2092508">+=</span>&nbsp;<span class="ident" id="2092511"><a href="/gostd/math/big/nat.go.html#2092099">n</a></span>&nbsp;<span class="op" id="2092513">{</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092518">if</span>&nbsp;<span class="ident" id="2092521"><a href="/gostd/math/big/nat.go.html#2092440">i</a></span>&nbsp;<span class="op" id="2092523">!=</span>&nbsp;<span class="builtinfunc" id="2092526">len</span><span class="op" id="2092529">(</span><span class="ident" id="2092530"><a href="/gostd/math/big/nat.go.html#2091959">y</a></span><span class="op" id="2092531">)</span><span class="op" id="2092532">-</span><span class="num" id="2092533">1</span>&nbsp;<span class="op" id="2092535">||</span>&nbsp;<span class="ident" id="2092538"><a href="/gostd/math/big/nat.go.html#2092490">j</a></span>&nbsp;<span class="op" id="2092540">!=</span>&nbsp;<span class="num" id="2092543">0</span>&nbsp;<span class="op" id="2092545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092551">//&nbsp;Unrolled&nbsp;loop&nbsp;for&nbsp;significant&nbsp;performance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092600">//&nbsp;gain.&nbsp;&nbsp;Use&nbsp;go&nbsp;test&nbsp;-bench=&#34;.*&#34;&nbsp;in&nbsp;crypto/rsa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092652">//&nbsp;to&nbsp;check&nbsp;performance&nbsp;before&nbsp;making&nbsp;changes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092703"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span>&nbsp;<span class="op" id="2092706">=</span>&nbsp;<span class="ident" id="2092708"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092710">.</span><span class="ident" id="2092711"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2092714">(</span><span class="ident" id="2092715"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092716">,</span>&nbsp;<span class="ident" id="2092718"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092719">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092725"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092727">,</span>&nbsp;<span class="ident" id="2092729"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span>&nbsp;<span class="op" id="2092731">=</span>&nbsp;<span class="ident" id="2092733"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092734">,</span>&nbsp;<span class="ident" id="2092736"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092743"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092745">,</span>&nbsp;<span class="ident" id="2092747"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span>&nbsp;<span class="op" id="2092749">=</span>&nbsp;<span class="ident" id="2092751"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092753">.</span><span class="ident" id="2092754"><a href="/gostd/math/big/nat.go.html#2071989">div</a></span><span class="op" id="2092757">(</span><span class="ident" id="2092758"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span><span class="op" id="2092759">,</span>&nbsp;<span class="ident" id="2092761"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092762">,</span>&nbsp;<span class="ident" id="2092764"><a href="/gostd/math/big/nat.go.html#2091962">m</a></span><span class="op" id="2092765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092771"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092772">,</span>&nbsp;<span class="ident" id="2092774"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span>&nbsp;<span class="op" id="2092776">=</span>&nbsp;<span class="ident" id="2092778"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span><span class="op" id="2092779">,</span>&nbsp;<span class="ident" id="2092781"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092788"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span>&nbsp;<span class="op" id="2092791">=</span>&nbsp;<span class="ident" id="2092793"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092795">.</span><span class="ident" id="2092796"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2092799">(</span><span class="ident" id="2092800"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092801">,</span>&nbsp;<span class="ident" id="2092803"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092804">)</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092810"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092812">,</span>&nbsp;<span class="ident" id="2092814"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span>&nbsp;<span class="op" id="2092816">=</span>&nbsp;<span class="ident" id="2092818"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092819">,</span>&nbsp;<span class="ident" id="2092821"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092828"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092830">,</span>&nbsp;<span class="ident" id="2092832"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span>&nbsp;<span class="op" id="2092834">=</span>&nbsp;<span class="ident" id="2092836"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092838">.</span><span class="ident" id="2092839"><a href="/gostd/math/big/nat.go.html#2071989">div</a></span><span class="op" id="2092842">(</span><span class="ident" id="2092843"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span><span class="op" id="2092844">,</span>&nbsp;<span class="ident" id="2092846"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092847">,</span>&nbsp;<span class="ident" id="2092849"><a href="/gostd/math/big/nat.go.html#2091962">m</a></span><span class="op" id="2092850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092856"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092857">,</span>&nbsp;<span class="ident" id="2092859"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span>&nbsp;<span class="op" id="2092861">=</span>&nbsp;<span class="ident" id="2092863"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span><span class="op" id="2092864">,</span>&nbsp;<span class="ident" id="2092866"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092873"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span>&nbsp;<span class="op" id="2092876">=</span>&nbsp;<span class="ident" id="2092878"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092880">.</span><span class="ident" id="2092881"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2092884">(</span><span class="ident" id="2092885"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092886">,</span>&nbsp;<span class="ident" id="2092888"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092889">)</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092895"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092897">,</span>&nbsp;<span class="ident" id="2092899"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span>&nbsp;<span class="op" id="2092901">=</span>&nbsp;<span class="ident" id="2092903"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092904">,</span>&nbsp;<span class="ident" id="2092906"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092913"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092915">,</span>&nbsp;<span class="ident" id="2092917"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span>&nbsp;<span class="op" id="2092919">=</span>&nbsp;<span class="ident" id="2092921"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092923">.</span><span class="ident" id="2092924"><a href="/gostd/math/big/nat.go.html#2071989">div</a></span><span class="op" id="2092927">(</span><span class="ident" id="2092928"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span><span class="op" id="2092929">,</span>&nbsp;<span class="ident" id="2092931"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092932">,</span>&nbsp;<span class="ident" id="2092934"><a href="/gostd/math/big/nat.go.html#2091962">m</a></span><span class="op" id="2092935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092941"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092942">,</span>&nbsp;<span class="ident" id="2092944"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span>&nbsp;<span class="op" id="2092946">=</span>&nbsp;<span class="ident" id="2092948"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span><span class="op" id="2092949">,</span>&nbsp;<span class="ident" id="2092951"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092958"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span>&nbsp;<span class="op" id="2092961">=</span>&nbsp;<span class="ident" id="2092963"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092965">.</span><span class="ident" id="2092966"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2092969">(</span><span class="ident" id="2092970"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092971">,</span>&nbsp;<span class="ident" id="2092973"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092974">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092980"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2092982">,</span>&nbsp;<span class="ident" id="2092984"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span>&nbsp;<span class="op" id="2092986">=</span>&nbsp;<span class="ident" id="2092988"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2092989">,</span>&nbsp;<span class="ident" id="2092991"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092998"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2093000">,</span>&nbsp;<span class="ident" id="2093002"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span>&nbsp;<span class="op" id="2093004">=</span>&nbsp;<span class="ident" id="2093006"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2093008">.</span><span class="ident" id="2093009"><a href="/gostd/math/big/nat.go.html#2071989">div</a></span><span class="op" id="2093012">(</span><span class="ident" id="2093013"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span><span class="op" id="2093014">,</span>&nbsp;<span class="ident" id="2093016"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2093017">,</span>&nbsp;<span class="ident" id="2093019"><a href="/gostd/math/big/nat.go.html#2091962">m</a></span><span class="op" id="2093020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2093026"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2093027">,</span>&nbsp;<span class="ident" id="2093029"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span>&nbsp;<span class="op" id="2093031">=</span>&nbsp;<span class="ident" id="2093033"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span><span class="op" id="2093034">,</span>&nbsp;<span class="ident" id="2093036"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2093047"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span>&nbsp;<span class="op" id="2093050">=</span>&nbsp;<span class="ident" id="2093052"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2093054">.</span><span class="ident" id="2093055"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2093058">(</span><span class="ident" id="2093059"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2093060">,</span>&nbsp;<span class="ident" id="2093062"><a href="/gostd/math/big/nat.go.html#2092138">powers</a></span><span class="op" id="2093068">[</span><span class="ident" id="2093069"><a href="/gostd/math/big/nat.go.html#2092473">yi</a></span><span class="op" id="2093071">&gt;&gt;</span><span class="op" id="2093073">(</span><span class="ident" id="2093074"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span><span class="op" id="2093076">-</span><span class="ident" id="2093077"><a href="/gostd/math/big/nat.go.html#2092099">n</a></span><span class="op" id="2093078">)</span><span class="op" id="2093079">]</span><span class="op" id="2093080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2093085"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2093087">,</span>&nbsp;<span class="ident" id="2093089"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span>&nbsp;<span class="op" id="2093091">=</span>&nbsp;<span class="ident" id="2093093"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2093094">,</span>&nbsp;<span class="ident" id="2093096"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2093102"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2093104">,</span>&nbsp;<span class="ident" id="2093106"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span>&nbsp;<span class="op" id="2093108">=</span>&nbsp;<span class="ident" id="2093110"><a href="/gostd/math/big/nat.go.html#2092081">zz</a></span><span class="op" id="2093112">.</span><span class="ident" id="2093113"><a href="/gostd/math/big/nat.go.html#2071989">div</a></span><span class="op" id="2093116">(</span><span class="ident" id="2093117"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span><span class="op" id="2093118">,</span>&nbsp;<span class="ident" id="2093120"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2093121">,</span>&nbsp;<span class="ident" id="2093123"><a href="/gostd/math/big/nat.go.html#2091962">m</a></span><span class="op" id="2093124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2093129"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2093130">,</span>&nbsp;<span class="ident" id="2093132"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span>&nbsp;<span class="op" id="2093134">=</span>&nbsp;<span class="ident" id="2093136"><a href="/gostd/math/big/nat.go.html#2092085">r</a></span><span class="op" id="2093137">,</span>&nbsp;<span class="ident" id="2093139"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2093145"><a href="/gostd/math/big/nat.go.html#2092473">yi</a></span>&nbsp;<span class="op" id="2093148">&lt;&lt;=</span>&nbsp;<span class="ident" id="2093152"><a href="/gostd/math/big/nat.go.html#2092099">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093163">return</span>&nbsp;<span class="ident" id="2093170"><a href="/gostd/math/big/nat.go.html#2091935">z</a></span><span class="op" id="2093171">.</span><span class="ident" id="2093172"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2093176">(</span><span class="op" id="2093177">)</span><br>
<span class="lineno">1380</span><span class="op" id="2093179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2093182">//&nbsp;probablyPrime&nbsp;performs&nbsp;reps&nbsp;Miller-Rabin&nbsp;tests&nbsp;to&nbsp;check&nbsp;whether&nbsp;n&nbsp;is&nbsp;prime.</span><br>
<span class="lineno"></span><span class="comment" id="2093261">//&nbsp;If&nbsp;it&nbsp;returns&nbsp;true,&nbsp;n&nbsp;is&nbsp;prime&nbsp;with&nbsp;probability&nbsp;1&nbsp;-&nbsp;1/4^reps.</span><br>
<span class="lineno"></span><span class="comment" id="2093326">//&nbsp;If&nbsp;it&nbsp;returns&nbsp;false,&nbsp;n&nbsp;is&nbsp;not&nbsp;prime.</span><br>
<span class="lineno">1385</span><span class="keyword" id="2093366">func</span>&nbsp;<span class="op" id="2093371">(</span><span class="ident" id="2093372">n</span>&nbsp;<span class="ident" id="2093374"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2093377">)</span>&nbsp;<span class="ident" id="2093379">probablyPrime</span><span class="op" id="2093392">(</span><span class="ident" id="2093393">reps</span>&nbsp;<span class="builtintype" id="2093398">int</span><span class="op" id="2093401">)</span>&nbsp;<span class="builtintype" id="2093403">bool</span>&nbsp;<span class="op" id="2093408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093411">if</span>&nbsp;<span class="builtinfunc" id="2093414">len</span><span class="op" id="2093417">(</span><span class="ident" id="2093418"><a href="/gostd/math/big/nat.go.html#2093372">n</a></span><span class="op" id="2093419">)</span>&nbsp;<span class="op" id="2093421">==</span>&nbsp;<span class="num" id="2093424">0</span>&nbsp;<span class="op" id="2093426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093430">return</span>&nbsp;<span class="builtintype" id="2093437">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093448">if</span>&nbsp;<span class="builtinfunc" id="2093451">len</span><span class="op" id="2093454">(</span><span class="ident" id="2093455"><a href="/gostd/math/big/nat.go.html#2093372">n</a></span><span class="op" id="2093456">)</span>&nbsp;<span class="op" id="2093458">==</span>&nbsp;<span class="num" id="2093461">1</span>&nbsp;<span class="op" id="2093463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093467">if</span>&nbsp;<span class="ident" id="2093470"><a href="/gostd/math/big/nat.go.html#2093372">n</a></span><span class="op" id="2093471">[</span><span class="num" id="2093472">0</span><span class="op" id="2093473">]</span>&nbsp;<span class="op" id="2093475">&lt;</span>&nbsp;<span class="num" id="2093477">2</span>&nbsp;<span class="op" id="2093479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093484">return</span>&nbsp;<span class="builtintype" id="2093491">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093504">if</span>&nbsp;<span class="ident" id="2093507"><a href="/gostd/math/big/nat.go.html#2093372">n</a></span><span class="op" id="2093508">[</span><span class="num" id="2093509">0</span><span class="op" id="2093510">]</span><span class="op" id="2093511">%</span><span class="num" id="2093512">2</span>&nbsp;<span class="op" id="2093514">==</span>&nbsp;<span class="num" id="2093517">0</span>&nbsp;<span class="op" id="2093519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093524">return</span>&nbsp;<span class="ident" id="2093531"><a href="/gostd/math/big/nat.go.html#2093372">n</a></span><span class="op" id="2093532">[</span><span class="num" id="2093533">0</span><span class="op" id="2093534">]</span>&nbsp;<span class="op" id="2093536">==</span>&nbsp;<span class="num" id="2093539">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2093548">//&nbsp;We&nbsp;have&nbsp;to&nbsp;exclude&nbsp;these&nbsp;cases&nbsp;because&nbsp;we&nbsp;reject&nbsp;all</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2093606">//&nbsp;multiples&nbsp;of&nbsp;these&nbsp;numbers&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093645">switch</span>&nbsp;<span class="ident" id="2093652"><a href="/gostd/math/big/nat.go.html#2093372">n</a></span><span class="op" id="2093653">[</span><span class="num" id="2093654">0</span><span class="op" id="2093655">]</span>&nbsp;<span class="op" id="2093657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093661">case</span>&nbsp;<span class="num" id="2093666">3</span><span class="op" id="2093667">,</span>&nbsp;<span class="num" id="2093669">5</span><span class="op" id="2093670">,</span>&nbsp;<span class="num" id="2093672">7</span><span class="op" id="2093673">,</span>&nbsp;<span class="num" id="2093675">11</span><span class="op" id="2093677">,</span>&nbsp;<span class="num" id="2093679">13</span><span class="op" id="2093681">,</span>&nbsp;<span class="num" id="2093683">17</span><span class="op" id="2093685">,</span>&nbsp;<span class="num" id="2093687">19</span><span class="op" id="2093689">,</span>&nbsp;<span class="num" id="2093691">23</span><span class="op" id="2093693">,</span>&nbsp;<span class="num" id="2093695">29</span><span class="op" id="2093697">,</span>&nbsp;<span class="num" id="2093699">31</span><span class="op" id="2093701">,</span>&nbsp;<span class="num" id="2093703">37</span><span class="op" id="2093705">,</span>&nbsp;<span class="num" id="2093707">41</span><span class="op" id="2093709">,</span>&nbsp;<span class="num" id="2093711">43</span><span class="op" id="2093713">,</span>&nbsp;<span class="num" id="2093715">47</span><span class="op" id="2093717">,</span>&nbsp;<span class="num" id="2093719">53</span><span class="op" id="2093721">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093726">return</span>&nbsp;<span class="builtintype" id="2093733">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093740">}</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093747">const</span>&nbsp;<span class="ident" id="2093753">primesProduct32</span>&nbsp;<span class="op" id="2093769">=</span>&nbsp;<span class="num" id="2093771">0xC0CFD797</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2093790">//&nbsp;Π&nbsp;{p&nbsp;∈&nbsp;primes,&nbsp;2&nbsp;&lt;&nbsp;p&nbsp;&lt;=&nbsp;29}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093825">const</span>&nbsp;<span class="ident" id="2093831">primesProduct64</span>&nbsp;<span class="op" id="2093847">=</span>&nbsp;<span class="num" id="2093849">0xE221F97C30E94E1D</span>&nbsp;<span class="comment" id="2093868">//&nbsp;Π&nbsp;{p&nbsp;∈&nbsp;primes,&nbsp;2&nbsp;&lt;&nbsp;p&nbsp;&lt;=&nbsp;53}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093904">var</span>&nbsp;<span class="ident" id="2093908">r</span>&nbsp;<span class="ident" id="2093910"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093916">switch</span>&nbsp;<span class="ident" id="2093923"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span>&nbsp;<span class="op" id="2093926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093929">case</span>&nbsp;<span class="num" id="2093934">32</span><span class="op" id="2093936">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2093940"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span>&nbsp;<span class="op" id="2093942">=</span>&nbsp;<span class="ident" id="2093944"><a href="/gostd/math/big/nat.go.html#2093372">n</a></span><span class="op" id="2093945">.</span><span class="ident" id="2093946"><a href="/gostd/math/big/nat.go.html#2089078">modW</a></span><span class="op" id="2093950">(</span><span class="ident" id="2093951"><a href="/gostd/math/big/nat.go.html#2093753">primesProduct32</a></span><span class="op" id="2093966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093969">case</span>&nbsp;<span class="num" id="2093974">64</span><span class="op" id="2093976">:</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2093980"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span>&nbsp;<span class="op" id="2093982">=</span>&nbsp;<span class="ident" id="2093984"><a href="/gostd/math/big/nat.go.html#2093372">n</a></span><span class="op" id="2093985">.</span><span class="ident" id="2093986"><a href="/gostd/math/big/nat.go.html#2089078">modW</a></span><span class="op" id="2093990">(</span><span class="ident" id="2093991"><a href="/gostd/math/big/nat.go.html#2093831">primesProduct64</a></span>&nbsp;<span class="op" id="2094007">&amp;</span>&nbsp;<span class="ident" id="2094009"><a href="/gostd/math/big/arith.go.html#2031219">_M</a></span><span class="op" id="2094011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094014">default</span><span class="op" id="2094021">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2094025">panic</span><span class="op" id="2094030">(</span><span class="string" id="2094031">&#34;Unknown&nbsp;word&nbsp;size&#34;</span><span class="op" id="2094050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094057">if</span>&nbsp;<span class="ident" id="2094060"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span><span class="op" id="2094061">%</span><span class="num" id="2094062">3</span>&nbsp;<span class="op" id="2094064">==</span>&nbsp;<span class="num" id="2094067">0</span>&nbsp;<span class="op" id="2094069">||</span>&nbsp;<span class="ident" id="2094072"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span><span class="op" id="2094073">%</span><span class="num" id="2094074">5</span>&nbsp;<span class="op" id="2094076">==</span>&nbsp;<span class="num" id="2094079">0</span>&nbsp;<span class="op" id="2094081">||</span>&nbsp;<span class="ident" id="2094084"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span><span class="op" id="2094085">%</span><span class="num" id="2094086">7</span>&nbsp;<span class="op" id="2094088">==</span>&nbsp;<span class="num" id="2094091">0</span>&nbsp;<span class="op" id="2094093">||</span>&nbsp;<span class="ident" id="2094096"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span><span class="op" id="2094097">%</span><span class="num" id="2094098">11</span>&nbsp;<span class="op" id="2094101">==</span>&nbsp;<span class="num" id="2094104">0</span>&nbsp;<span class="op" id="2094106">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094111"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span><span class="op" id="2094112">%</span><span class="num" id="2094113">13</span>&nbsp;<span class="op" id="2094116">==</span>&nbsp;<span class="num" id="2094119">0</span>&nbsp;<span class="op" id="2094121">||</span>&nbsp;<span class="ident" id="2094124"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span><span class="op" id="2094125">%</span><span class="num" id="2094126">17</span>&nbsp;<span class="op" id="2094129">==</span>&nbsp;<span class="num" id="2094132">0</span>&nbsp;<span class="op" id="2094134">||</span>&nbsp;<span class="ident" id="2094137"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span><span class="op" id="2094138">%</span><span class="num" id="2094139">19</span>&nbsp;<span class="op" id="2094142">==</span>&nbsp;<span class="num" id="2094145">0</span>&nbsp;<span class="op" id="2094147">||</span>&nbsp;<span class="ident" id="2094150"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span><span class="op" id="2094151">%</span><span class="num" id="2094152">23</span>&nbsp;<span class="op" id="2094155">==</span>&nbsp;<span class="num" id="2094158">0</span>&nbsp;<span class="op" id="2094160">||</span>&nbsp;<span class="ident" id="2094163"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span><span class="op" id="2094164">%</span><span class="num" id="2094165">29</span>&nbsp;<span class="op" id="2094168">==</span>&nbsp;<span class="num" id="2094171">0</span>&nbsp;<span class="op" id="2094173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094177">return</span>&nbsp;<span class="builtintype" id="2094184">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094195">if</span>&nbsp;<span class="ident" id="2094198"><a href="/gostd/math/big/arith.go.html#2031156">_W</a></span>&nbsp;<span class="op" id="2094201">==</span>&nbsp;<span class="num" id="2094204">64</span>&nbsp;<span class="op" id="2094207">&amp;&amp;</span>&nbsp;<span class="op" id="2094210">(</span><span class="ident" id="2094211"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span><span class="op" id="2094212">%</span><span class="num" id="2094213">31</span>&nbsp;<span class="op" id="2094216">==</span>&nbsp;<span class="num" id="2094219">0</span>&nbsp;<span class="op" id="2094221">||</span>&nbsp;<span class="ident" id="2094224"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span><span class="op" id="2094225">%</span><span class="num" id="2094226">37</span>&nbsp;<span class="op" id="2094229">==</span>&nbsp;<span class="num" id="2094232">0</span>&nbsp;<span class="op" id="2094234">||</span>&nbsp;<span class="ident" id="2094237"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span><span class="op" id="2094238">%</span><span class="num" id="2094239">41</span>&nbsp;<span class="op" id="2094242">==</span>&nbsp;<span class="num" id="2094245">0</span>&nbsp;<span class="op" id="2094247">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094252"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span><span class="op" id="2094253">%</span><span class="num" id="2094254">43</span>&nbsp;<span class="op" id="2094257">==</span>&nbsp;<span class="num" id="2094260">0</span>&nbsp;<span class="op" id="2094262">||</span>&nbsp;<span class="ident" id="2094265"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span><span class="op" id="2094266">%</span><span class="num" id="2094267">47</span>&nbsp;<span class="op" id="2094270">==</span>&nbsp;<span class="num" id="2094273">0</span>&nbsp;<span class="op" id="2094275">||</span>&nbsp;<span class="ident" id="2094278"><a href="/gostd/math/big/nat.go.html#2093908">r</a></span><span class="op" id="2094279">%</span><span class="num" id="2094280">53</span>&nbsp;<span class="op" id="2094283">==</span>&nbsp;<span class="num" id="2094286">0</span><span class="op" id="2094287">)</span>&nbsp;<span class="op" id="2094289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094293">return</span>&nbsp;<span class="builtintype" id="2094300">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094311">nm1</span>&nbsp;<span class="op" id="2094315">:=</span>&nbsp;<span class="ident" id="2094318"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2094321">(</span><span class="builtintype" id="2094322">nil</span><span class="op" id="2094325">)</span><span class="op" id="2094326">.</span><span class="ident" id="2094327"><a href="/gostd/math/big/nat.go.html#2063546">sub</a></span><span class="op" id="2094330">(</span><span class="ident" id="2094331"><a href="/gostd/math/big/nat.go.html#2093372">n</a></span><span class="op" id="2094332">,</span>&nbsp;<span class="ident" id="2094334"><a href="/gostd/math/big/nat.go.html#2062174">natOne</a></span><span class="op" id="2094340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2094343">//&nbsp;determine&nbsp;q,&nbsp;k&nbsp;such&nbsp;that&nbsp;nm1&nbsp;=&nbsp;q&nbsp;&lt;&lt;&nbsp;k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094385">k</span>&nbsp;<span class="op" id="2094387">:=</span>&nbsp;<span class="ident" id="2094390"><a href="/gostd/math/big/nat.go.html#2094311">nm1</a></span><span class="op" id="2094393">.</span><span class="ident" id="2094394"><a href="/gostd/math/big/nat.go.html#2086941">trailingZeroBits</a></span><span class="op" id="2094410">(</span><span class="op" id="2094411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094414">q</span>&nbsp;<span class="op" id="2094416">:=</span>&nbsp;<span class="ident" id="2094419"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2094422">(</span><span class="builtintype" id="2094423">nil</span><span class="op" id="2094426">)</span><span class="op" id="2094427">.</span><span class="ident" id="2094428"><a href="/gostd/math/big/nat.go.html#2087343">shr</a></span><span class="op" id="2094431">(</span><span class="ident" id="2094432"><a href="/gostd/math/big/nat.go.html#2094311">nm1</a></span><span class="op" id="2094435">,</span>&nbsp;<span class="ident" id="2094437"><a href="/gostd/math/big/nat.go.html#2094385">k</a></span><span class="op" id="2094438">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094442">nm3</span>&nbsp;<span class="op" id="2094446">:=</span>&nbsp;<span class="ident" id="2094449"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2094452">(</span><span class="builtintype" id="2094453">nil</span><span class="op" id="2094456">)</span><span class="op" id="2094457">.</span><span class="ident" id="2094458"><a href="/gostd/math/big/nat.go.html#2063546">sub</a></span><span class="op" id="2094461">(</span><span class="ident" id="2094462"><a href="/gostd/math/big/nat.go.html#2094311">nm1</a></span><span class="op" id="2094465">,</span>&nbsp;<span class="ident" id="2094467"><a href="/gostd/math/big/nat.go.html#2062191">natTwo</a></span><span class="op" id="2094473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094476">rand</span>&nbsp;<span class="op" id="2094481">:=</span>&nbsp;<span class="ident" id="2094484"><a href="/gostd/math/big/nat.go.html#2061619">rand</a></span><span class="op" id="2094488">.</span><span class="ident" id="2094489"><a href="/gostd/math/rand/rand.go.html#2922124">New</a></span><span class="op" id="2094492">(</span><span class="ident" id="2094493"><a href="/gostd/math/big/nat.go.html#2061619">rand</a></span><span class="op" id="2094497">.</span><span class="ident" id="2094498"><a href="/gostd/math/rand/rand.go.html#2921867">NewSource</a></span><span class="op" id="2094507">(</span><span class="builtintype" id="2094508">int64</span><span class="op" id="2094513">(</span><span class="ident" id="2094514"><a href="/gostd/math/big/nat.go.html#2093372">n</a></span><span class="op" id="2094515">[</span><span class="num" id="2094516">0</span><span class="op" id="2094517">]</span><span class="op" id="2094518">)</span><span class="op" id="2094519">)</span><span class="op" id="2094520">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094524">var</span>&nbsp;<span class="ident" id="2094528">x</span><span class="op" id="2094529">,</span>&nbsp;<span class="ident" id="2094531">y</span><span class="op" id="2094532">,</span>&nbsp;<span class="ident" id="2094534">quotient</span>&nbsp;<span class="ident" id="2094543"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094548">nm3Len</span>&nbsp;<span class="op" id="2094555">:=</span>&nbsp;<span class="ident" id="2094558"><a href="/gostd/math/big/nat.go.html#2094442">nm3</a></span><span class="op" id="2094561">.</span><span class="ident" id="2094562"><a href="/gostd/math/big/nat.go.html#2074033">bitLen</a></span><span class="op" id="2094568">(</span><span class="op" id="2094569">)</span><br>
<span class="lineno">1440</span><br>
<span class="lineno"></span><span class="ident" id="2094572">NextRandom</span><span class="op" id="2094582">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094585">for</span>&nbsp;<span class="ident" id="2094589">i</span>&nbsp;<span class="op" id="2094591">:=</span>&nbsp;<span class="num" id="2094594">0</span><span class="op" id="2094595">;</span>&nbsp;<span class="ident" id="2094597"><a href="/gostd/math/big/nat.go.html#2094589">i</a></span>&nbsp;<span class="op" id="2094599">&lt;</span>&nbsp;<span class="ident" id="2094601"><a href="/gostd/math/big/nat.go.html#2093393">reps</a></span><span class="op" id="2094605">;</span>&nbsp;<span class="ident" id="2094607"><a href="/gostd/math/big/nat.go.html#2094589">i</a></span><span class="op" id="2094608">++</span>&nbsp;<span class="op" id="2094611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094615"><a href="/gostd/math/big/nat.go.html#2094528">x</a></span>&nbsp;<span class="op" id="2094617">=</span>&nbsp;<span class="ident" id="2094619"><a href="/gostd/math/big/nat.go.html#2094528">x</a></span><span class="op" id="2094620">.</span><span class="ident" id="2094621"><a href="/gostd/math/big/nat.go.html#2089353">random</a></span><span class="op" id="2094627">(</span><span class="ident" id="2094628"><a href="/gostd/math/big/nat.go.html#2094476">rand</a></span><span class="op" id="2094632">,</span>&nbsp;<span class="ident" id="2094634"><a href="/gostd/math/big/nat.go.html#2094442">nm3</a></span><span class="op" id="2094637">,</span>&nbsp;<span class="ident" id="2094639"><a href="/gostd/math/big/nat.go.html#2094548">nm3Len</a></span><span class="op" id="2094645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094649"><a href="/gostd/math/big/nat.go.html#2094528">x</a></span>&nbsp;<span class="op" id="2094651">=</span>&nbsp;<span class="ident" id="2094653"><a href="/gostd/math/big/nat.go.html#2094528">x</a></span><span class="op" id="2094654">.</span><span class="ident" id="2094655"><a href="/gostd/math/big/nat.go.html#2063185">add</a></span><span class="op" id="2094658">(</span><span class="ident" id="2094659"><a href="/gostd/math/big/nat.go.html#2094528">x</a></span><span class="op" id="2094660">,</span>&nbsp;<span class="ident" id="2094662"><a href="/gostd/math/big/nat.go.html#2062191">natTwo</a></span><span class="op" id="2094668">)</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094672"><a href="/gostd/math/big/nat.go.html#2094531">y</a></span>&nbsp;<span class="op" id="2094674">=</span>&nbsp;<span class="ident" id="2094676"><a href="/gostd/math/big/nat.go.html#2094531">y</a></span><span class="op" id="2094677">.</span><span class="ident" id="2094678"><a href="/gostd/math/big/nat.go.html#2090082">expNN</a></span><span class="op" id="2094683">(</span><span class="ident" id="2094684"><a href="/gostd/math/big/nat.go.html#2094528">x</a></span><span class="op" id="2094685">,</span>&nbsp;<span class="ident" id="2094687"><a href="/gostd/math/big/nat.go.html#2094414">q</a></span><span class="op" id="2094688">,</span>&nbsp;<span class="ident" id="2094690"><a href="/gostd/math/big/nat.go.html#2093372">n</a></span><span class="op" id="2094691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094695">if</span>&nbsp;<span class="ident" id="2094698"><a href="/gostd/math/big/nat.go.html#2094531">y</a></span><span class="op" id="2094699">.</span><span class="ident" id="2094700"><a href="/gostd/math/big/nat.go.html#2063929">cmp</a></span><span class="op" id="2094703">(</span><span class="ident" id="2094704"><a href="/gostd/math/big/nat.go.html#2062174">natOne</a></span><span class="op" id="2094710">)</span>&nbsp;<span class="op" id="2094712">==</span>&nbsp;<span class="num" id="2094715">0</span>&nbsp;<span class="op" id="2094717">||</span>&nbsp;<span class="ident" id="2094720"><a href="/gostd/math/big/nat.go.html#2094531">y</a></span><span class="op" id="2094721">.</span><span class="ident" id="2094722"><a href="/gostd/math/big/nat.go.html#2063929">cmp</a></span><span class="op" id="2094725">(</span><span class="ident" id="2094726"><a href="/gostd/math/big/nat.go.html#2094311">nm1</a></span><span class="op" id="2094729">)</span>&nbsp;<span class="op" id="2094731">==</span>&nbsp;<span class="num" id="2094734">0</span>&nbsp;<span class="op" id="2094736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094741">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094756">for</span>&nbsp;<span class="ident" id="2094760">j</span>&nbsp;<span class="op" id="2094762">:=</span>&nbsp;<span class="builtintype" id="2094765">uint</span><span class="op" id="2094769">(</span><span class="num" id="2094770">1</span><span class="op" id="2094771">)</span><span class="op" id="2094772">;</span>&nbsp;<span class="ident" id="2094774"><a href="/gostd/math/big/nat.go.html#2094760">j</a></span>&nbsp;<span class="op" id="2094776">&lt;</span>&nbsp;<span class="ident" id="2094778"><a href="/gostd/math/big/nat.go.html#2094385">k</a></span><span class="op" id="2094779">;</span>&nbsp;<span class="ident" id="2094781"><a href="/gostd/math/big/nat.go.html#2094760">j</a></span><span class="op" id="2094782">++</span>&nbsp;<span class="op" id="2094785">{</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094790"><a href="/gostd/math/big/nat.go.html#2094531">y</a></span>&nbsp;<span class="op" id="2094792">=</span>&nbsp;<span class="ident" id="2094794"><a href="/gostd/math/big/nat.go.html#2094531">y</a></span><span class="op" id="2094795">.</span><span class="ident" id="2094796"><a href="/gostd/math/big/nat.go.html#2069066">mul</a></span><span class="op" id="2094799">(</span><span class="ident" id="2094800"><a href="/gostd/math/big/nat.go.html#2094531">y</a></span><span class="op" id="2094801">,</span>&nbsp;<span class="ident" id="2094803"><a href="/gostd/math/big/nat.go.html#2094531">y</a></span><span class="op" id="2094804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094809"><a href="/gostd/math/big/nat.go.html#2094534">quotient</a></span><span class="op" id="2094817">,</span>&nbsp;<span class="ident" id="2094819"><a href="/gostd/math/big/nat.go.html#2094531">y</a></span>&nbsp;<span class="op" id="2094821">=</span>&nbsp;<span class="ident" id="2094823"><a href="/gostd/math/big/nat.go.html#2094534">quotient</a></span><span class="op" id="2094831">.</span><span class="ident" id="2094832"><a href="/gostd/math/big/nat.go.html#2071989">div</a></span><span class="op" id="2094835">(</span><span class="ident" id="2094836"><a href="/gostd/math/big/nat.go.html#2094531">y</a></span><span class="op" id="2094837">,</span>&nbsp;<span class="ident" id="2094839"><a href="/gostd/math/big/nat.go.html#2094531">y</a></span><span class="op" id="2094840">,</span>&nbsp;<span class="ident" id="2094842"><a href="/gostd/math/big/nat.go.html#2093372">n</a></span><span class="op" id="2094843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094848">if</span>&nbsp;<span class="ident" id="2094851"><a href="/gostd/math/big/nat.go.html#2094531">y</a></span><span class="op" id="2094852">.</span><span class="ident" id="2094853"><a href="/gostd/math/big/nat.go.html#2063929">cmp</a></span><span class="op" id="2094856">(</span><span class="ident" id="2094857"><a href="/gostd/math/big/nat.go.html#2094311">nm1</a></span><span class="op" id="2094860">)</span>&nbsp;<span class="op" id="2094862">==</span>&nbsp;<span class="num" id="2094865">0</span>&nbsp;<span class="op" id="2094867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094873">continue</span>&nbsp;<span class="ident" id="2094882"><a href="/gostd/math/big/nat.go.html#2094572">NextRandom</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094896">}</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094901">if</span>&nbsp;<span class="ident" id="2094904"><a href="/gostd/math/big/nat.go.html#2094531">y</a></span><span class="op" id="2094905">.</span><span class="ident" id="2094906"><a href="/gostd/math/big/nat.go.html#2063929">cmp</a></span><span class="op" id="2094909">(</span><span class="ident" id="2094910"><a href="/gostd/math/big/nat.go.html#2062174">natOne</a></span><span class="op" id="2094916">)</span>&nbsp;<span class="op" id="2094918">==</span>&nbsp;<span class="num" id="2094921">0</span>&nbsp;<span class="op" id="2094923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094929">return</span>&nbsp;<span class="builtintype" id="2094936">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094953">return</span>&nbsp;<span class="builtintype" id="2094960">false</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094971">return</span>&nbsp;<span class="builtintype" id="2094978">true</span><br>
<span class="lineno"></span><span class="op" id="2094983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span><span class="comment" id="2094986">//&nbsp;bytes&nbsp;writes&nbsp;the&nbsp;value&nbsp;of&nbsp;z&nbsp;into&nbsp;buf&nbsp;using&nbsp;big-endian&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="2095053">//&nbsp;len(buf)&nbsp;must&nbsp;be&nbsp;&gt;=&nbsp;len(z)*_S.&nbsp;The&nbsp;value&nbsp;of&nbsp;z&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2095120">//&nbsp;slice&nbsp;buf[i:].&nbsp;The&nbsp;number&nbsp;i&nbsp;of&nbsp;unused&nbsp;bytes&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2095187">//&nbsp;buf&nbsp;is&nbsp;returned&nbsp;as&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="2095217">func</span>&nbsp;<span class="op" id="2095222">(</span><span class="ident" id="2095223">z</span>&nbsp;<span class="ident" id="2095225"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2095228">)</span>&nbsp;<span class="ident" id="2095230">bytes</span><span class="op" id="2095235">(</span><span class="ident" id="2095236">buf</span>&nbsp;<span class="op" id="2095240">[</span><span class="op" id="2095241">]</span><span class="builtintype" id="2095242">byte</span><span class="op" id="2095246">)</span>&nbsp;<span class="op" id="2095248">(</span><span class="ident" id="2095249">i</span>&nbsp;<span class="builtintype" id="2095251">int</span><span class="op" id="2095254">)</span>&nbsp;<span class="op" id="2095256">{</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095259"><a href="/gostd/math/big/nat.go.html#2095249">i</a></span>&nbsp;<span class="op" id="2095261">=</span>&nbsp;<span class="builtinfunc" id="2095263">len</span><span class="op" id="2095266">(</span><span class="ident" id="2095267"><a href="/gostd/math/big/nat.go.html#2095236">buf</a></span><span class="op" id="2095270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095273">for</span>&nbsp;<span class="ident" id="2095277">_</span><span class="op" id="2095278">,</span>&nbsp;<span class="ident" id="2095280">d</span>&nbsp;<span class="op" id="2095282">:=</span>&nbsp;<span class="keyword" id="2095285">range</span>&nbsp;<span class="ident" id="2095291"><a href="/gostd/math/big/nat.go.html#2095223">z</a></span>&nbsp;<span class="op" id="2095293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095297">for</span>&nbsp;<span class="ident" id="2095301">j</span>&nbsp;<span class="op" id="2095303">:=</span>&nbsp;<span class="num" id="2095306">0</span><span class="op" id="2095307">;</span>&nbsp;<span class="ident" id="2095309"><a href="/gostd/math/big/nat.go.html#2095301">j</a></span>&nbsp;<span class="op" id="2095311">&lt;</span>&nbsp;<span class="ident" id="2095313"><a href="/gostd/math/big/arith.go.html#2031135">_S</a></span><span class="op" id="2095315">;</span>&nbsp;<span class="ident" id="2095317"><a href="/gostd/math/big/nat.go.html#2095301">j</a></span><span class="op" id="2095318">++</span>&nbsp;<span class="op" id="2095321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095326"><a href="/gostd/math/big/nat.go.html#2095249">i</a></span><span class="op" id="2095327">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095333"><a href="/gostd/math/big/nat.go.html#2095236">buf</a></span><span class="op" id="2095336">[</span><span class="ident" id="2095337"><a href="/gostd/math/big/nat.go.html#2095249">i</a></span><span class="op" id="2095338">]</span>&nbsp;<span class="op" id="2095340">=</span>&nbsp;<span class="builtintype" id="2095342">byte</span><span class="op" id="2095346">(</span><span class="ident" id="2095347"><a href="/gostd/math/big/nat.go.html#2095280">d</a></span><span class="op" id="2095348">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095353"><a href="/gostd/math/big/nat.go.html#2095280">d</a></span>&nbsp;<span class="op" id="2095355">&gt;&gt;=</span>&nbsp;<span class="num" id="2095359">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095370">for</span>&nbsp;<span class="ident" id="2095374"><a href="/gostd/math/big/nat.go.html#2095249">i</a></span>&nbsp;<span class="op" id="2095376">&lt;</span>&nbsp;<span class="builtinfunc" id="2095378">len</span><span class="op" id="2095381">(</span><span class="ident" id="2095382"><a href="/gostd/math/big/nat.go.html#2095236">buf</a></span><span class="op" id="2095385">)</span>&nbsp;<span class="op" id="2095387">&amp;&amp;</span>&nbsp;<span class="ident" id="2095390"><a href="/gostd/math/big/nat.go.html#2095236">buf</a></span><span class="op" id="2095393">[</span><span class="ident" id="2095394"><a href="/gostd/math/big/nat.go.html#2095249">i</a></span><span class="op" id="2095395">]</span>&nbsp;<span class="op" id="2095397">==</span>&nbsp;<span class="num" id="2095400">0</span>&nbsp;<span class="op" id="2095402">{</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095406"><a href="/gostd/math/big/nat.go.html#2095249">i</a></span><span class="op" id="2095407">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095415">return</span><br>
<span class="lineno"></span><span class="op" id="2095422">}</span><br>
<span class="lineno">1485</span><br>
<span class="lineno"></span><span class="comment" id="2095425">//&nbsp;setBytes&nbsp;interprets&nbsp;buf&nbsp;as&nbsp;the&nbsp;bytes&nbsp;of&nbsp;a&nbsp;big-endian&nbsp;unsigned</span><br>
<span class="lineno"></span><span class="comment" id="2095490">//&nbsp;integer,&nbsp;sets&nbsp;z&nbsp;to&nbsp;that&nbsp;value,&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword" id="2095539">func</span>&nbsp;<span class="op" id="2095544">(</span><span class="ident" id="2095545">z</span>&nbsp;<span class="ident" id="2095547"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span><span class="op" id="2095550">)</span>&nbsp;<span class="ident" id="2095552">setBytes</span><span class="op" id="2095560">(</span><span class="ident" id="2095561">buf</span>&nbsp;<span class="op" id="2095565">[</span><span class="op" id="2095566">]</span><span class="builtintype" id="2095567">byte</span><span class="op" id="2095571">)</span>&nbsp;<span class="ident" id="2095573"><a href="/gostd/math/big/nat.go.html#2062155">nat</a></span>&nbsp;<span class="op" id="2095577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095580"><a href="/gostd/math/big/nat.go.html#2095545">z</a></span>&nbsp;<span class="op" id="2095582">=</span>&nbsp;<span class="ident" id="2095584"><a href="/gostd/math/big/nat.go.html#2095545">z</a></span><span class="op" id="2095585">.</span><span class="builtinfunc" id="2095586"><a href="/gostd/math/big/nat.go.html#2062395">make</a></span><span class="op" id="2095590">(</span><span class="op" id="2095591">(</span><span class="builtinfunc" id="2095592">len</span><span class="op" id="2095595">(</span><span class="ident" id="2095596"><a href="/gostd/math/big/nat.go.html#2095561">buf</a></span><span class="op" id="2095599">)</span>&nbsp;<span class="op" id="2095601">+</span>&nbsp;<span class="ident" id="2095603"><a href="/gostd/math/big/arith.go.html#2031135">_S</a></span>&nbsp;<span class="op" id="2095606">-</span>&nbsp;<span class="num" id="2095608">1</span><span class="op" id="2095609">)</span>&nbsp;<span class="op" id="2095611">/</span>&nbsp;<span class="ident" id="2095613"><a href="/gostd/math/big/arith.go.html#2031135">_S</a></span><span class="op" id="2095615">)</span><br>
<span class="lineno">1490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095619">k</span>&nbsp;<span class="op" id="2095621">:=</span>&nbsp;<span class="num" id="2095624">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095627">s</span>&nbsp;<span class="op" id="2095629">:=</span>&nbsp;<span class="builtintype" id="2095632">uint</span><span class="op" id="2095636">(</span><span class="num" id="2095637">0</span><span class="op" id="2095638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095641">var</span>&nbsp;<span class="ident" id="2095645">d</span>&nbsp;<span class="ident" id="2095647"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095653">for</span>&nbsp;<span class="ident" id="2095657">i</span>&nbsp;<span class="op" id="2095659">:=</span>&nbsp;<span class="builtinfunc" id="2095662">len</span><span class="op" id="2095665">(</span><span class="ident" id="2095666"><a href="/gostd/math/big/nat.go.html#2095561">buf</a></span><span class="op" id="2095669">)</span><span class="op" id="2095670">;</span>&nbsp;<span class="ident" id="2095672"><a href="/gostd/math/big/nat.go.html#2095657">i</a></span>&nbsp;<span class="op" id="2095674">&gt;</span>&nbsp;<span class="num" id="2095676">0</span><span class="op" id="2095677">;</span>&nbsp;<span class="ident" id="2095679"><a href="/gostd/math/big/nat.go.html#2095657">i</a></span><span class="op" id="2095680">--</span>&nbsp;<span class="op" id="2095683">{</span><br>
<span class="lineno">1495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095687"><a href="/gostd/math/big/nat.go.html#2095645">d</a></span>&nbsp;<span class="op" id="2095689">|=</span>&nbsp;<span class="ident" id="2095692"><a href="/gostd/math/big/arith.go.html#2031011">Word</a></span><span class="op" id="2095696">(</span><span class="ident" id="2095697"><a href="/gostd/math/big/nat.go.html#2095561">buf</a></span><span class="op" id="2095700">[</span><span class="ident" id="2095701"><a href="/gostd/math/big/nat.go.html#2095657">i</a></span><span class="op" id="2095702">-</span><span class="num" id="2095703">1</span><span class="op" id="2095704">]</span><span class="op" id="2095705">)</span>&nbsp;<span class="op" id="2095707">&lt;&lt;</span>&nbsp;<span class="ident" id="2095710"><a href="/gostd/math/big/nat.go.html#2095627">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095714">if</span>&nbsp;<span class="ident" id="2095717"><a href="/gostd/math/big/nat.go.html#2095627">s</a></span>&nbsp;<span class="op" id="2095719">+=</span>&nbsp;<span class="num" id="2095722">8</span><span class="op" id="2095723">;</span>&nbsp;<span class="ident" id="2095725"><a href="/gostd/math/big/nat.go.html#2095627">s</a></span>&nbsp;<span class="op" id="2095727">==</span>&nbsp;<span class="ident" id="2095730"><a href="/gostd/math/big/arith.go.html#2031135">_S</a></span><span class="op" id="2095732">*</span><span class="num" id="2095733">8</span>&nbsp;<span class="op" id="2095735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095740"><a href="/gostd/math/big/nat.go.html#2095545">z</a></span><span class="op" id="2095741">[</span><span class="ident" id="2095742"><a href="/gostd/math/big/nat.go.html#2095619">k</a></span><span class="op" id="2095743">]</span>&nbsp;<span class="op" id="2095745">=</span>&nbsp;<span class="ident" id="2095747"><a href="/gostd/math/big/nat.go.html#2095645">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095752"><a href="/gostd/math/big/nat.go.html#2095619">k</a></span><span class="op" id="2095753">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095759"><a href="/gostd/math/big/nat.go.html#2095627">s</a></span>&nbsp;<span class="op" id="2095761">=</span>&nbsp;<span class="num" id="2095763">0</span><br>
<span class="lineno">1500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095768"><a href="/gostd/math/big/nat.go.html#2095645">d</a></span>&nbsp;<span class="op" id="2095770">=</span>&nbsp;<span class="num" id="2095772">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095782">if</span>&nbsp;<span class="ident" id="2095785"><a href="/gostd/math/big/nat.go.html#2095619">k</a></span>&nbsp;<span class="op" id="2095787">&lt;</span>&nbsp;<span class="builtinfunc" id="2095789">len</span><span class="op" id="2095792">(</span><span class="ident" id="2095793"><a href="/gostd/math/big/nat.go.html#2095545">z</a></span><span class="op" id="2095794">)</span>&nbsp;<span class="op" id="2095796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095800"><a href="/gostd/math/big/nat.go.html#2095545">z</a></span><span class="op" id="2095801">[</span><span class="ident" id="2095802"><a href="/gostd/math/big/nat.go.html#2095619">k</a></span><span class="op" id="2095803">]</span>&nbsp;<span class="op" id="2095805">=</span>&nbsp;<span class="ident" id="2095807"><a href="/gostd/math/big/nat.go.html#2095645">d</a></span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095814">return</span>&nbsp;<span class="ident" id="2095821"><a href="/gostd/math/big/nat.go.html#2095545">z</a></span><span class="op" id="2095822">.</span><span class="ident" id="2095823"><a href="/gostd/math/big/nat.go.html#2062301">norm</a></span><span class="op" id="2095827">(</span><span class="op" id="2095828">)</span><br>
<span class="lineno"></span><span class="op" id="2095830">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
