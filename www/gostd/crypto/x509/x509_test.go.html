<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7799803">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7799858">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7799912">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7799963">package</span>&nbsp;<span class="ident" id="7799971">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7799977">import</span>&nbsp;<span class="op" id="7799984">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7799987">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7799996">&#34;crypto/dsa&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7800010">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7800026">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7800045">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7800060">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7800074">_</span>&nbsp;<span class="string" id="7800076">&#34;crypto/sha256&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7800093">_</span>&nbsp;<span class="string" id="7800095">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7800112">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7800132">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7800149">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7800168">&#34;encoding/hex&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7800184">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7800200">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7800212">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7800219">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7800230">&#34;reflect&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7800241">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7800252">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7800263">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7800270">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="7800273">func</span>&nbsp;<span class="ident" id="7800278">TestParsePKCS1PrivateKey</span><span class="op" id="7800302">(</span><span class="ident" id="7800303">t</span>&nbsp;<span class="op" id="7800305">*</span><span class="ident" id="7800306">testing</span><span class="op" id="7800313">.</span><span class="ident" id="7800314">T</span><span class="op" id="7800315">)</span>&nbsp;<span class="op" id="7800317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7800320">block</span><span class="op" id="7800325">,</span>&nbsp;<span class="ident" id="7800327">_</span>&nbsp;<span class="op" id="7800329">:=</span>&nbsp;<span class="ident" id="7800332">pem</span><span class="op" id="7800335">.</span><span class="ident" id="7800336">Decode</span><span class="op" id="7800342">(</span><span class="op" id="7800343">[</span><span class="op" id="7800344">]</span><span class="builtintype" id="7800345">byte</span><span class="op" id="7800349">(</span><span class="ident" id="7800350">pemPrivateKey</span><span class="op" id="7800363">)</span><span class="op" id="7800364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7800367">priv</span><span class="op" id="7800371">,</span>&nbsp;<span class="ident" id="7800373">err</span>&nbsp;<span class="op" id="7800377">:=</span>&nbsp;<span class="ident" id="7800380">ParsePKCS1PrivateKey</span><span class="op" id="7800400">(</span><span class="ident" id="7800401">block</span><span class="op" id="7800406">.</span><span class="ident" id="7800407">Bytes</span><span class="op" id="7800412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7800415">if</span>&nbsp;<span class="ident" id="7800418">err</span>&nbsp;<span class="op" id="7800422">!=</span>&nbsp;<span class="ident" id="7800425">nil</span>&nbsp;<span class="op" id="7800429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7800433">t</span><span class="op" id="7800434">.</span><span class="ident" id="7800435">Errorf</span><span class="op" id="7800441">(</span><span class="string" id="7800442">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7800475">,</span>&nbsp;<span class="ident" id="7800477">err</span><span class="op" id="7800480">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7800484">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7800492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7800495">if</span>&nbsp;<span class="ident" id="7800498">priv</span><span class="op" id="7800502">.</span><span class="ident" id="7800503">PublicKey</span><span class="op" id="7800512">.</span><span class="ident" id="7800513">N</span><span class="op" id="7800514">.</span><span class="ident" id="7800515">Cmp</span><span class="op" id="7800518">(</span><span class="ident" id="7800519">rsaPrivateKey</span><span class="op" id="7800532">.</span><span class="ident" id="7800533">PublicKey</span><span class="op" id="7800542">.</span><span class="ident" id="7800543">N</span><span class="op" id="7800544">)</span>&nbsp;<span class="op" id="7800546">!=</span>&nbsp;<span class="num" id="7800549">0</span>&nbsp;<span class="op" id="7800551">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7800556">priv</span><span class="op" id="7800560">.</span><span class="ident" id="7800561">PublicKey</span><span class="op" id="7800570">.</span><span class="ident" id="7800571">E</span>&nbsp;<span class="op" id="7800573">!=</span>&nbsp;<span class="ident" id="7800576">rsaPrivateKey</span><span class="op" id="7800589">.</span><span class="ident" id="7800590">PublicKey</span><span class="op" id="7800599">.</span><span class="ident" id="7800600">E</span>&nbsp;<span class="op" id="7800602">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7800607">priv</span><span class="op" id="7800611">.</span><span class="ident" id="7800612">D</span><span class="op" id="7800613">.</span><span class="ident" id="7800614">Cmp</span><span class="op" id="7800617">(</span><span class="ident" id="7800618">rsaPrivateKey</span><span class="op" id="7800631">.</span><span class="ident" id="7800632">D</span><span class="op" id="7800633">)</span>&nbsp;<span class="op" id="7800635">!=</span>&nbsp;<span class="num" id="7800638">0</span>&nbsp;<span class="op" id="7800640">||</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7800645">priv</span><span class="op" id="7800649">.</span><span class="ident" id="7800650">Primes</span><span class="op" id="7800656">[</span><span class="num" id="7800657">0</span><span class="op" id="7800658">]</span><span class="op" id="7800659">.</span><span class="ident" id="7800660">Cmp</span><span class="op" id="7800663">(</span><span class="ident" id="7800664">rsaPrivateKey</span><span class="op" id="7800677">.</span><span class="ident" id="7800678">Primes</span><span class="op" id="7800684">[</span><span class="num" id="7800685">0</span><span class="op" id="7800686">]</span><span class="op" id="7800687">)</span>&nbsp;<span class="op" id="7800689">!=</span>&nbsp;<span class="num" id="7800692">0</span>&nbsp;<span class="op" id="7800694">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7800699">priv</span><span class="op" id="7800703">.</span><span class="ident" id="7800704">Primes</span><span class="op" id="7800710">[</span><span class="num" id="7800711">1</span><span class="op" id="7800712">]</span><span class="op" id="7800713">.</span><span class="ident" id="7800714">Cmp</span><span class="op" id="7800717">(</span><span class="ident" id="7800718">rsaPrivateKey</span><span class="op" id="7800731">.</span><span class="ident" id="7800732">Primes</span><span class="op" id="7800738">[</span><span class="num" id="7800739">1</span><span class="op" id="7800740">]</span><span class="op" id="7800741">)</span>&nbsp;<span class="op" id="7800743">!=</span>&nbsp;<span class="num" id="7800746">0</span>&nbsp;<span class="op" id="7800748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7800752">t</span><span class="op" id="7800753">.</span><span class="ident" id="7800754">Errorf</span><span class="op" id="7800760">(</span><span class="string" id="7800761">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="7800779">,</span>&nbsp;<span class="ident" id="7800781">priv</span><span class="op" id="7800785">,</span>&nbsp;<span class="ident" id="7800787">rsaPrivateKey</span><span class="op" id="7800800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7800803">}</span><br>
<span class="lineno"></span><span class="op" id="7800805">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7800808">func</span>&nbsp;<span class="ident" id="7800813">TestParsePKIXPublicKey</span><span class="op" id="7800835">(</span><span class="ident" id="7800836">t</span>&nbsp;<span class="op" id="7800838">*</span><span class="ident" id="7800839">testing</span><span class="op" id="7800846">.</span><span class="ident" id="7800847">T</span><span class="op" id="7800848">)</span>&nbsp;<span class="op" id="7800850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7800853">block</span><span class="op" id="7800858">,</span>&nbsp;<span class="ident" id="7800860">_</span>&nbsp;<span class="op" id="7800862">:=</span>&nbsp;<span class="ident" id="7800865">pem</span><span class="op" id="7800868">.</span><span class="ident" id="7800869">Decode</span><span class="op" id="7800875">(</span><span class="op" id="7800876">[</span><span class="op" id="7800877">]</span><span class="builtintype" id="7800878">byte</span><span class="op" id="7800882">(</span><span class="ident" id="7800883">pemPublicKey</span><span class="op" id="7800895">)</span><span class="op" id="7800896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7800899">pub</span><span class="op" id="7800902">,</span>&nbsp;<span class="ident" id="7800904">err</span>&nbsp;<span class="op" id="7800908">:=</span>&nbsp;<span class="ident" id="7800911">ParsePKIXPublicKey</span><span class="op" id="7800929">(</span><span class="ident" id="7800930">block</span><span class="op" id="7800935">.</span><span class="ident" id="7800936">Bytes</span><span class="op" id="7800941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7800944">if</span>&nbsp;<span class="ident" id="7800947">err</span>&nbsp;<span class="op" id="7800951">!=</span>&nbsp;<span class="ident" id="7800954">nil</span>&nbsp;<span class="op" id="7800958">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7800962">t</span><span class="op" id="7800963">.</span><span class="ident" id="7800964">Errorf</span><span class="op" id="7800970">(</span><span class="string" id="7800971">&#34;Failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;public&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7801007">,</span>&nbsp;<span class="ident" id="7801009">err</span><span class="op" id="7801012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7801016">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7801024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7801027">rsaPub</span><span class="op" id="7801033">,</span>&nbsp;<span class="ident" id="7801035">ok</span>&nbsp;<span class="op" id="7801038">:=</span>&nbsp;<span class="ident" id="7801041">pub</span><span class="op" id="7801044">.</span><span class="op" id="7801045">(</span><span class="op" id="7801046">*</span><span class="ident" id="7801047">rsa</span><span class="op" id="7801050">.</span><span class="ident" id="7801051">PublicKey</span><span class="op" id="7801060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7801063">if</span>&nbsp;<span class="op" id="7801066">!</span><span class="ident" id="7801067">ok</span>&nbsp;<span class="op" id="7801070">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7801074">t</span><span class="op" id="7801075">.</span><span class="ident" id="7801076">Errorf</span><span class="op" id="7801082">(</span><span class="string" id="7801083">&#34;Value&nbsp;returned&nbsp;from&nbsp;ParsePKIXPublicKey&nbsp;was&nbsp;not&nbsp;an&nbsp;RSA&nbsp;public&nbsp;key&#34;</span><span class="op" id="7801149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7801153">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7801161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7801165">pubBytes2</span><span class="op" id="7801174">,</span>&nbsp;<span class="ident" id="7801176">err</span>&nbsp;<span class="op" id="7801180">:=</span>&nbsp;<span class="ident" id="7801183">MarshalPKIXPublicKey</span><span class="op" id="7801203">(</span><span class="ident" id="7801204">rsaPub</span><span class="op" id="7801210">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7801213">if</span>&nbsp;<span class="ident" id="7801216">err</span>&nbsp;<span class="op" id="7801220">!=</span>&nbsp;<span class="ident" id="7801223">nil</span>&nbsp;<span class="op" id="7801227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7801231">t</span><span class="op" id="7801232">.</span><span class="ident" id="7801233">Errorf</span><span class="op" id="7801239">(</span><span class="string" id="7801240">&#34;Failed&nbsp;to&nbsp;marshal&nbsp;RSA&nbsp;public&nbsp;key&nbsp;for&nbsp;the&nbsp;second&nbsp;time:&nbsp;%s&#34;</span><span class="op" id="7801298">,</span>&nbsp;<span class="ident" id="7801300">err</span><span class="op" id="7801303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7801307">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7801315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7801318">if</span>&nbsp;<span class="op" id="7801321">!</span><span class="ident" id="7801322">bytes</span><span class="op" id="7801327">.</span><span class="ident" id="7801328">Equal</span><span class="op" id="7801333">(</span><span class="ident" id="7801334">pubBytes2</span><span class="op" id="7801343">,</span>&nbsp;<span class="ident" id="7801345">block</span><span class="op" id="7801350">.</span><span class="ident" id="7801351">Bytes</span><span class="op" id="7801356">)</span>&nbsp;<span class="op" id="7801358">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7801362">t</span><span class="op" id="7801363">.</span><span class="ident" id="7801364">Errorf</span><span class="op" id="7801370">(</span><span class="string" id="7801371">&#34;Reserialization&nbsp;of&nbsp;public&nbsp;key&nbsp;didn&#39;t&nbsp;match.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7801432">,</span>&nbsp;<span class="ident" id="7801434">pubBytes2</span><span class="op" id="7801443">,</span>&nbsp;<span class="ident" id="7801445">block</span><span class="op" id="7801450">.</span><span class="ident" id="7801451">Bytes</span><span class="op" id="7801456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7801459">}</span><br>
<span class="lineno"></span><span class="op" id="7801461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7801464">var</span>&nbsp;<span class="ident" id="7801468">pemPublicKey</span>&nbsp;<span class="op" id="7801481">=</span>&nbsp;<span class="string" id="7801483">`-----BEGIN&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno">70</span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3VoPN9PKUjKFLMwOge6+<br>
<span class="lineno"></span>wnDi8sbETGIx2FKXGgqtAKpzmem53kRGEQg8WeqRmp12wgp74TGpkEXsGae7RS1k<br>
<span class="lineno"></span>enJCnma4fii+noGH7R0qKgHvPrI2Bwa9hzsH8tHxpyM3qrXslOmD45EH9SxIDUBJ<br>
<span class="lineno"></span>FehNdaPbLP1gFyahKMsdfxFJLUvbUycuZSJ2ZnIgeVxwm4qbSvZInL9Iu4FzuPtg<br>
<span class="lineno"></span>fINKcbbovy1qq4KvPIrXzhbY3PWDc6btxCf3SE0JdE1MCPThntB62/bLMSQ7xdDR<br>
<span class="lineno">75</span>FF53oIpvxe/SCOymfWq/LW849Ytv3Xwod0+wzAP8STXG4HSELS4UedPYeHJJJYcZ<br>
<span class="lineno"></span>+QIDAQAB<br>
<span class="lineno"></span>-----END&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="7801938">var</span>&nbsp;<span class="ident" id="7801942">pemPrivateKey</span>&nbsp;<span class="op" id="7801956">=</span>&nbsp;<span class="string" id="7801958">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0<br>
<span class="lineno"></span>fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu<br>
<span class="lineno"></span>/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu<br>
<span class="lineno"></span>RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/<br>
<span class="lineno">85</span>EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A<br>
<span class="lineno"></span>IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS<br>
<span class="lineno"></span>tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="7802455">func</span>&nbsp;<span class="ident" id="7802460">bigFromString</span><span class="op" id="7802473">(</span><span class="ident" id="7802474">s</span>&nbsp;<span class="builtintype" id="7802476">string</span><span class="op" id="7802482">)</span>&nbsp;<span class="op" id="7802484">*</span><span class="ident" id="7802485">big</span><span class="op" id="7802488">.</span><span class="ident" id="7802489">Int</span>&nbsp;<span class="op" id="7802493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7802496">ret</span>&nbsp;<span class="op" id="7802500">:=</span>&nbsp;<span class="builtinfunc" id="7802503">new</span><span class="op" id="7802506">(</span><span class="ident" id="7802507">big</span><span class="op" id="7802510">.</span><span class="ident" id="7802511">Int</span><span class="op" id="7802514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7802517">ret</span><span class="op" id="7802520">.</span><span class="ident" id="7802521">SetString</span><span class="op" id="7802530">(</span><span class="ident" id="7802531">s</span><span class="op" id="7802532">,</span>&nbsp;<span class="num" id="7802534">10</span><span class="op" id="7802536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7802539">return</span>&nbsp;<span class="ident" id="7802546">ret</span><br>
<span class="lineno">95</span><span class="op" id="7802550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7802553">func</span>&nbsp;<span class="ident" id="7802558">fromBase10</span><span class="op" id="7802568">(</span><span class="ident" id="7802569">base10</span>&nbsp;<span class="builtintype" id="7802576">string</span><span class="op" id="7802582">)</span>&nbsp;<span class="op" id="7802584">*</span><span class="ident" id="7802585">big</span><span class="op" id="7802588">.</span><span class="ident" id="7802589">Int</span>&nbsp;<span class="op" id="7802593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7802596">i</span>&nbsp;<span class="op" id="7802598">:=</span>&nbsp;<span class="builtinfunc" id="7802601">new</span><span class="op" id="7802604">(</span><span class="ident" id="7802605">big</span><span class="op" id="7802608">.</span><span class="ident" id="7802609">Int</span><span class="op" id="7802612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7802615">i</span><span class="op" id="7802616">.</span><span class="ident" id="7802617">SetString</span><span class="op" id="7802626">(</span><span class="ident" id="7802627">base10</span><span class="op" id="7802633">,</span>&nbsp;<span class="num" id="7802635">10</span><span class="op" id="7802637">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7802640">return</span>&nbsp;<span class="ident" id="7802647">i</span><br>
<span class="lineno"></span><span class="op" id="7802649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7802652">func</span>&nbsp;<span class="ident" id="7802657">bigFromHexString</span><span class="op" id="7802673">(</span><span class="ident" id="7802674">s</span>&nbsp;<span class="builtintype" id="7802676">string</span><span class="op" id="7802682">)</span>&nbsp;<span class="op" id="7802684">*</span><span class="ident" id="7802685">big</span><span class="op" id="7802688">.</span><span class="ident" id="7802689">Int</span>&nbsp;<span class="op" id="7802693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7802696">ret</span>&nbsp;<span class="op" id="7802700">:=</span>&nbsp;<span class="builtinfunc" id="7802703">new</span><span class="op" id="7802706">(</span><span class="ident" id="7802707">big</span><span class="op" id="7802710">.</span><span class="ident" id="7802711">Int</span><span class="op" id="7802714">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7802717">ret</span><span class="op" id="7802720">.</span><span class="ident" id="7802721">SetString</span><span class="op" id="7802730">(</span><span class="ident" id="7802731">s</span><span class="op" id="7802732">,</span>&nbsp;<span class="num" id="7802734">16</span><span class="op" id="7802736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7802739">return</span>&nbsp;<span class="ident" id="7802746">ret</span><br>
<span class="lineno"></span><span class="op" id="7802750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7802753">var</span>&nbsp;<span class="ident" id="7802757">rsaPrivateKey</span>&nbsp;<span class="op" id="7802771">=</span>&nbsp;<span class="op" id="7802773">&amp;</span><span class="ident" id="7802774">rsa</span><span class="op" id="7802777">.</span><span class="ident" id="7802778">PrivateKey</span><span class="op" id="7802788">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7802791">PublicKey</span><span class="op" id="7802800">:</span>&nbsp;<span class="ident" id="7802802">rsa</span><span class="op" id="7802805">.</span><span class="ident" id="7802806">PublicKey</span><span class="op" id="7802815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7802819">N</span><span class="op" id="7802820">:</span>&nbsp;<span class="ident" id="7802822">bigFromString</span><span class="op" id="7802835">(</span><span class="string" id="7802836">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="7802992">)</span><span class="op" id="7802993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7802997">E</span><span class="op" id="7802998">:</span>&nbsp;<span class="num" id="7803000">65537</span><span class="op" id="7803005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7803008">}</span><span class="op" id="7803009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7803012">D</span><span class="op" id="7803013">:</span>&nbsp;<span class="ident" id="7803015">bigFromString</span><span class="op" id="7803028">(</span><span class="string" id="7803029">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="7803185">)</span><span class="op" id="7803186">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7803189">Primes</span><span class="op" id="7803195">:</span>&nbsp;<span class="op" id="7803197">[</span><span class="op" id="7803198">]</span><span class="op" id="7803199">*</span><span class="ident" id="7803200">big</span><span class="op" id="7803203">.</span><span class="ident" id="7803204">Int</span><span class="op" id="7803207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7803211">bigFromString</span><span class="op" id="7803224">(</span><span class="string" id="7803225">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="7803304">)</span><span class="op" id="7803305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7803309">bigFromString</span><span class="op" id="7803322">(</span><span class="string" id="7803323">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="7803402">)</span><span class="op" id="7803403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7803406">}</span><span class="op" id="7803407">,</span><br>
<span class="lineno"></span><span class="op" id="7803409">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7803412">func</span>&nbsp;<span class="ident" id="7803417">TestMarshalRSAPrivateKey</span><span class="op" id="7803441">(</span><span class="ident" id="7803442">t</span>&nbsp;<span class="op" id="7803444">*</span><span class="ident" id="7803445">testing</span><span class="op" id="7803452">.</span><span class="ident" id="7803453">T</span><span class="op" id="7803454">)</span>&nbsp;<span class="op" id="7803456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7803459">priv</span>&nbsp;<span class="op" id="7803464">:=</span>&nbsp;<span class="op" id="7803467">&amp;</span><span class="ident" id="7803468">rsa</span><span class="op" id="7803471">.</span><span class="ident" id="7803472">PrivateKey</span><span class="op" id="7803482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7803486">PublicKey</span><span class="op" id="7803495">:</span>&nbsp;<span class="ident" id="7803497">rsa</span><span class="op" id="7803500">.</span><span class="ident" id="7803501">PublicKey</span><span class="op" id="7803510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7803515">N</span><span class="op" id="7803516">:</span>&nbsp;<span class="ident" id="7803518">fromBase10</span><span class="op" id="7803528">(</span><span class="string" id="7803529">&#34;16346378922382193400538269749936049106320265317511766357599732575277382844051791096569333808598921852351577762718529818072849191122419410612033592401403764925096136759934497687765453905884149505175426053037420486697072448609022753683683718057795566811401938833367954642951433473337066311978821180526439641496973296037000052546108507805269279414789035461158073156772151892452251106173507240488993608650881929629163465099476849643165682709047462010581308719577053905787496296934240246311806555924593059995202856826239801816771116902778517096212527979497399966526283516447337775509777558018145573127308919204297111496233&#34;</span><span class="op" id="7804148">)</span><span class="op" id="7804149">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7804154">E</span><span class="op" id="7804155">:</span>&nbsp;<span class="num" id="7804157">3</span><span class="op" id="7804158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7804162">}</span><span class="op" id="7804163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7804167">D</span><span class="op" id="7804168">:</span>&nbsp;<span class="ident" id="7804170">fromBase10</span><span class="op" id="7804180">(</span><span class="string" id="7804181">&#34;10897585948254795600358846499957366070880176878341177571733155050184921896034527397712889205732614568234385175145686545381899460748279607074689061600935843283397424506622998458510302603922766336783617368686090042765718290914099334449154829375179958369993407724946186243249568928237086215759259909861748642124071874879861299389874230489928271621259294894142840428407196932444474088857746123104978617098858619445675532587787023228852383149557470077802718705420275739737958953794088728369933811184572620857678792001136676902250566845618813972833750098806496641114644760255910789397593428910198080271317419213080834885003&#34;</span><span class="op" id="7804800">)</span><span class="op" id="7804801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7804805">Primes</span><span class="op" id="7804811">:</span>&nbsp;<span class="op" id="7804813">[</span><span class="op" id="7804814">]</span><span class="op" id="7804815">*</span><span class="ident" id="7804816">big</span><span class="op" id="7804819">.</span><span class="ident" id="7804820">Int</span><span class="op" id="7804823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7804828">fromBase10</span><span class="op" id="7804838">(</span><span class="string" id="7804839">&#34;1025363189502892836833747188838978207017355117492483312747347695538428729137306368764177201532277413433182799108299960196606011786562992097313508180436744488171474690412562218914213688661311117337381958560443&#34;</span><span class="op" id="7805049">)</span><span class="op" id="7805050">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805055">fromBase10</span><span class="op" id="7805065">(</span><span class="string" id="7805066">&#34;3467903426626310123395340254094941045497208049900750380025518552334536945536837294961497712862519984786362199788654739924501424784631315081391467293694361474867825728031147665777546570788493758372218019373&#34;</span><span class="op" id="7805273">)</span><span class="op" id="7805274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805279">fromBase10</span><span class="op" id="7805289">(</span><span class="string" id="7805290">&#34;4597024781409332673052708605078359346966325141767460991205742124888960305710298765592730135879076084498363772408626791576005136245060321874472727132746643162385746062759369754202494417496879741537284589047&#34;</span><span class="op" id="7805497">)</span><span class="op" id="7805498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7805502">}</span><span class="op" id="7805503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7805506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805510">derBytes</span>&nbsp;<span class="op" id="7805519">:=</span>&nbsp;<span class="ident" id="7805522">MarshalPKCS1PrivateKey</span><span class="op" id="7805544">(</span><span class="ident" id="7805545">priv</span><span class="op" id="7805549">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805553">priv2</span><span class="op" id="7805558">,</span>&nbsp;<span class="ident" id="7805560">err</span>&nbsp;<span class="op" id="7805564">:=</span>&nbsp;<span class="ident" id="7805567">ParsePKCS1PrivateKey</span><span class="op" id="7805587">(</span><span class="ident" id="7805588">derBytes</span><span class="op" id="7805596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7805599">if</span>&nbsp;<span class="ident" id="7805602">err</span>&nbsp;<span class="op" id="7805606">!=</span>&nbsp;<span class="ident" id="7805609">nil</span>&nbsp;<span class="op" id="7805613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805617">t</span><span class="op" id="7805618">.</span><span class="ident" id="7805619">Errorf</span><span class="op" id="7805625">(</span><span class="string" id="7805626">&#34;error&nbsp;parsing&nbsp;serialized&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7805660">,</span>&nbsp;<span class="ident" id="7805662">err</span><span class="op" id="7805665">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7805669">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7805677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7805680">if</span>&nbsp;<span class="ident" id="7805683">priv</span><span class="op" id="7805687">.</span><span class="ident" id="7805688">PublicKey</span><span class="op" id="7805697">.</span><span class="ident" id="7805698">N</span><span class="op" id="7805699">.</span><span class="ident" id="7805700">Cmp</span><span class="op" id="7805703">(</span><span class="ident" id="7805704">priv2</span><span class="op" id="7805709">.</span><span class="ident" id="7805710">PublicKey</span><span class="op" id="7805719">.</span><span class="ident" id="7805720">N</span><span class="op" id="7805721">)</span>&nbsp;<span class="op" id="7805723">!=</span>&nbsp;<span class="num" id="7805726">0</span>&nbsp;<span class="op" id="7805728">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805733">priv</span><span class="op" id="7805737">.</span><span class="ident" id="7805738">PublicKey</span><span class="op" id="7805747">.</span><span class="ident" id="7805748">E</span>&nbsp;<span class="op" id="7805750">!=</span>&nbsp;<span class="ident" id="7805753">priv2</span><span class="op" id="7805758">.</span><span class="ident" id="7805759">PublicKey</span><span class="op" id="7805768">.</span><span class="ident" id="7805769">E</span>&nbsp;<span class="op" id="7805771">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805776">priv</span><span class="op" id="7805780">.</span><span class="ident" id="7805781">D</span><span class="op" id="7805782">.</span><span class="ident" id="7805783">Cmp</span><span class="op" id="7805786">(</span><span class="ident" id="7805787">priv2</span><span class="op" id="7805792">.</span><span class="ident" id="7805793">D</span><span class="op" id="7805794">)</span>&nbsp;<span class="op" id="7805796">!=</span>&nbsp;<span class="num" id="7805799">0</span>&nbsp;<span class="op" id="7805801">||</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7805806">len</span><span class="op" id="7805809">(</span><span class="ident" id="7805810">priv2</span><span class="op" id="7805815">.</span><span class="ident" id="7805816">Primes</span><span class="op" id="7805822">)</span>&nbsp;<span class="op" id="7805824">!=</span>&nbsp;<span class="num" id="7805827">3</span>&nbsp;<span class="op" id="7805829">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805834">priv</span><span class="op" id="7805838">.</span><span class="ident" id="7805839">Primes</span><span class="op" id="7805845">[</span><span class="num" id="7805846">0</span><span class="op" id="7805847">]</span><span class="op" id="7805848">.</span><span class="ident" id="7805849">Cmp</span><span class="op" id="7805852">(</span><span class="ident" id="7805853">priv2</span><span class="op" id="7805858">.</span><span class="ident" id="7805859">Primes</span><span class="op" id="7805865">[</span><span class="num" id="7805866">0</span><span class="op" id="7805867">]</span><span class="op" id="7805868">)</span>&nbsp;<span class="op" id="7805870">!=</span>&nbsp;<span class="num" id="7805873">0</span>&nbsp;<span class="op" id="7805875">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805880">priv</span><span class="op" id="7805884">.</span><span class="ident" id="7805885">Primes</span><span class="op" id="7805891">[</span><span class="num" id="7805892">1</span><span class="op" id="7805893">]</span><span class="op" id="7805894">.</span><span class="ident" id="7805895">Cmp</span><span class="op" id="7805898">(</span><span class="ident" id="7805899">priv2</span><span class="op" id="7805904">.</span><span class="ident" id="7805905">Primes</span><span class="op" id="7805911">[</span><span class="num" id="7805912">1</span><span class="op" id="7805913">]</span><span class="op" id="7805914">)</span>&nbsp;<span class="op" id="7805916">!=</span>&nbsp;<span class="num" id="7805919">0</span>&nbsp;<span class="op" id="7805921">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805926">priv</span><span class="op" id="7805930">.</span><span class="ident" id="7805931">Primes</span><span class="op" id="7805937">[</span><span class="num" id="7805938">2</span><span class="op" id="7805939">]</span><span class="op" id="7805940">.</span><span class="ident" id="7805941">Cmp</span><span class="op" id="7805944">(</span><span class="ident" id="7805945">priv2</span><span class="op" id="7805950">.</span><span class="ident" id="7805951">Primes</span><span class="op" id="7805957">[</span><span class="num" id="7805958">2</span><span class="op" id="7805959">]</span><span class="op" id="7805960">)</span>&nbsp;<span class="op" id="7805962">!=</span>&nbsp;<span class="num" id="7805965">0</span>&nbsp;<span class="op" id="7805967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805971">t</span><span class="op" id="7805972">.</span><span class="ident" id="7805973">Errorf</span><span class="op" id="7805979">(</span><span class="string" id="7805980">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="7805998">,</span>&nbsp;<span class="ident" id="7806000">priv</span><span class="op" id="7806004">,</span>&nbsp;<span class="ident" id="7806006">priv2</span><span class="op" id="7806011">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806014">}</span><br>
<span class="lineno"></span><span class="op" id="7806016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7806019">type</span>&nbsp;<span class="ident" id="7806024">matchHostnamesTest</span>&nbsp;<span class="keyword" id="7806043">struct</span>&nbsp;<span class="op" id="7806050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806053">pattern</span><span class="op" id="7806060">,</span>&nbsp;<span class="ident" id="7806062">host</span>&nbsp;<span class="builtintype" id="7806067">string</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806075">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7806089">bool</span><br>
<span class="lineno"></span><span class="op" id="7806094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7806097">var</span>&nbsp;<span class="ident" id="7806101">matchHostnamesTests</span>&nbsp;<span class="op" id="7806121">=</span>&nbsp;<span class="op" id="7806123">[</span><span class="op" id="7806124">]</span><span class="ident" id="7806125">matchHostnamesTest</span><span class="op" id="7806143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806146">{</span><span class="string" id="7806147">&#34;a.b.c&#34;</span><span class="op" id="7806154">,</span>&nbsp;<span class="string" id="7806156">&#34;a.b.c&#34;</span><span class="op" id="7806163">,</span>&nbsp;<span class="builtintype" id="7806165">true</span><span class="op" id="7806169">}</span><span class="op" id="7806170">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806173">{</span><span class="string" id="7806174">&#34;a.b.c&#34;</span><span class="op" id="7806181">,</span>&nbsp;<span class="string" id="7806183">&#34;b.b.c&#34;</span><span class="op" id="7806190">,</span>&nbsp;<span class="builtintype" id="7806192">false</span><span class="op" id="7806197">}</span><span class="op" id="7806198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806201">{</span><span class="string" id="7806202">&#34;&#34;</span><span class="op" id="7806204">,</span>&nbsp;<span class="string" id="7806206">&#34;b.b.c&#34;</span><span class="op" id="7806213">,</span>&nbsp;<span class="builtintype" id="7806215">false</span><span class="op" id="7806220">}</span><span class="op" id="7806221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806224">{</span><span class="string" id="7806225">&#34;a.b.c&#34;</span><span class="op" id="7806232">,</span>&nbsp;<span class="string" id="7806234">&#34;&#34;</span><span class="op" id="7806236">,</span>&nbsp;<span class="builtintype" id="7806238">false</span><span class="op" id="7806243">}</span><span class="op" id="7806244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806247">{</span><span class="string" id="7806248">&#34;example.com&#34;</span><span class="op" id="7806261">,</span>&nbsp;<span class="string" id="7806263">&#34;example.com&#34;</span><span class="op" id="7806276">,</span>&nbsp;<span class="builtintype" id="7806278">true</span><span class="op" id="7806282">}</span><span class="op" id="7806283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806286">{</span><span class="string" id="7806287">&#34;example.com&#34;</span><span class="op" id="7806300">,</span>&nbsp;<span class="string" id="7806302">&#34;www.example.com&#34;</span><span class="op" id="7806319">,</span>&nbsp;<span class="builtintype" id="7806321">false</span><span class="op" id="7806326">}</span><span class="op" id="7806327">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806330">{</span><span class="string" id="7806331">&#34;*.example.com&#34;</span><span class="op" id="7806346">,</span>&nbsp;<span class="string" id="7806348">&#34;www.example.com&#34;</span><span class="op" id="7806365">,</span>&nbsp;<span class="builtintype" id="7806367">true</span><span class="op" id="7806371">}</span><span class="op" id="7806372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806375">{</span><span class="string" id="7806376">&#34;*.example.com&#34;</span><span class="op" id="7806391">,</span>&nbsp;<span class="string" id="7806393">&#34;xyz.www.example.com&#34;</span><span class="op" id="7806414">,</span>&nbsp;<span class="builtintype" id="7806416">false</span><span class="op" id="7806421">}</span><span class="op" id="7806422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806425">{</span><span class="string" id="7806426">&#34;*.*.example.com&#34;</span><span class="op" id="7806443">,</span>&nbsp;<span class="string" id="7806445">&#34;xyz.www.example.com&#34;</span><span class="op" id="7806466">,</span>&nbsp;<span class="builtintype" id="7806468">true</span><span class="op" id="7806472">}</span><span class="op" id="7806473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806476">{</span><span class="string" id="7806477">&#34;*.www.*.com&#34;</span><span class="op" id="7806490">,</span>&nbsp;<span class="string" id="7806492">&#34;xyz.www.example.com&#34;</span><span class="op" id="7806513">,</span>&nbsp;<span class="builtintype" id="7806515">true</span><span class="op" id="7806519">}</span><span class="op" id="7806520">,</span><br>
<span class="lineno"></span><span class="op" id="7806522">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7806525">func</span>&nbsp;<span class="ident" id="7806530">TestMatchHostnames</span><span class="op" id="7806548">(</span><span class="ident" id="7806549">t</span>&nbsp;<span class="op" id="7806551">*</span><span class="ident" id="7806552">testing</span><span class="op" id="7806559">.</span><span class="ident" id="7806560">T</span><span class="op" id="7806561">)</span>&nbsp;<span class="op" id="7806563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7806566">for</span>&nbsp;<span class="ident" id="7806570">i</span><span class="op" id="7806571">,</span>&nbsp;<span class="ident" id="7806573">test</span>&nbsp;<span class="op" id="7806578">:=</span>&nbsp;<span class="keyword" id="7806581">range</span>&nbsp;<span class="ident" id="7806587">matchHostnamesTests</span>&nbsp;<span class="op" id="7806607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806611">r</span>&nbsp;<span class="op" id="7806613">:=</span>&nbsp;<span class="ident" id="7806616">matchHostnames</span><span class="op" id="7806630">(</span><span class="ident" id="7806631">test</span><span class="op" id="7806635">.</span><span class="ident" id="7806636">pattern</span><span class="op" id="7806643">,</span>&nbsp;<span class="ident" id="7806645">test</span><span class="op" id="7806649">.</span><span class="ident" id="7806650">host</span><span class="op" id="7806654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7806658">if</span>&nbsp;<span class="ident" id="7806661">r</span>&nbsp;<span class="op" id="7806663">!=</span>&nbsp;<span class="ident" id="7806666">test</span><span class="op" id="7806670">.</span><span class="ident" id="7806671">ok</span>&nbsp;<span class="op" id="7806674">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806679">t</span><span class="op" id="7806680">.</span><span class="ident" id="7806681">Errorf</span><span class="op" id="7806687">(</span><span class="string" id="7806688">&#34;#%d&nbsp;mismatch&nbsp;got:&nbsp;%t&nbsp;want:&nbsp;%t&#34;</span><span class="op" id="7806719">,</span>&nbsp;<span class="ident" id="7806721">i</span><span class="op" id="7806722">,</span>&nbsp;<span class="ident" id="7806724">r</span><span class="op" id="7806725">,</span>&nbsp;<span class="ident" id="7806727">test</span><span class="op" id="7806731">.</span><span class="ident" id="7806732">ok</span><span class="op" id="7806734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806741">}</span><br>
<span class="lineno"></span><span class="op" id="7806743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="7806746">func</span>&nbsp;<span class="ident" id="7806751">TestMatchIP</span><span class="op" id="7806762">(</span><span class="ident" id="7806763">t</span>&nbsp;<span class="op" id="7806765">*</span><span class="ident" id="7806766">testing</span><span class="op" id="7806773">.</span><span class="ident" id="7806774">T</span><span class="op" id="7806775">)</span>&nbsp;<span class="op" id="7806777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7806780">//&nbsp;Check&nbsp;that&nbsp;pattern&nbsp;matching&nbsp;is&nbsp;working.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806824">c</span>&nbsp;<span class="op" id="7806826">:=</span>&nbsp;<span class="op" id="7806829">&amp;</span><span class="ident" id="7806830">Certificate</span><span class="op" id="7806841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806845">DNSNames</span><span class="op" id="7806853">:</span>&nbsp;<span class="op" id="7806855">[</span><span class="op" id="7806856">]</span><span class="builtintype" id="7806857">string</span><span class="op" id="7806863">{</span><span class="string" id="7806864">&#34;*.foo.bar.baz&#34;</span><span class="op" id="7806879">}</span><span class="op" id="7806880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806884">Subject</span><span class="op" id="7806891">:</span>&nbsp;<span class="ident" id="7806893">pkix</span><span class="op" id="7806897">.</span><span class="ident" id="7806898">Name</span><span class="op" id="7806902">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806907">CommonName</span><span class="op" id="7806917">:</span>&nbsp;<span class="string" id="7806919">&#34;*.foo.bar.baz&#34;</span><span class="op" id="7806934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806938">}</span><span class="op" id="7806939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806945">err</span>&nbsp;<span class="op" id="7806949">:=</span>&nbsp;<span class="ident" id="7806952">c</span><span class="op" id="7806953">.</span><span class="ident" id="7806954">VerifyHostname</span><span class="op" id="7806968">(</span><span class="string" id="7806969">&#34;quux.foo.bar.baz&#34;</span><span class="op" id="7806987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7806990">if</span>&nbsp;<span class="ident" id="7806993">err</span>&nbsp;<span class="op" id="7806997">!=</span>&nbsp;<span class="ident" id="7807000">nil</span>&nbsp;<span class="op" id="7807004">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807008">t</span><span class="op" id="7807009">.</span><span class="ident" id="7807010">Fatalf</span><span class="op" id="7807016">(</span><span class="string" id="7807017">&#34;VerifyHostname(quux.foo.bar.baz):&nbsp;%v&#34;</span><span class="op" id="7807055">,</span>&nbsp;<span class="ident" id="7807057">err</span><span class="op" id="7807060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7807063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7807067">//&nbsp;But&nbsp;check&nbsp;that&nbsp;if&nbsp;we&nbsp;change&nbsp;it&nbsp;to&nbsp;be&nbsp;matching&nbsp;against&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7807140">//&nbsp;it&nbsp;is&nbsp;rejected.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807160">c</span>&nbsp;<span class="op" id="7807162">=</span>&nbsp;<span class="op" id="7807164">&amp;</span><span class="ident" id="7807165">Certificate</span><span class="op" id="7807176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807180">DNSNames</span><span class="op" id="7807188">:</span>&nbsp;<span class="op" id="7807190">[</span><span class="op" id="7807191">]</span><span class="builtintype" id="7807192">string</span><span class="op" id="7807198">{</span><span class="string" id="7807199">&#34;*.2.3.4&#34;</span><span class="op" id="7807208">}</span><span class="op" id="7807209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807213">Subject</span><span class="op" id="7807220">:</span>&nbsp;<span class="ident" id="7807222">pkix</span><span class="op" id="7807226">.</span><span class="ident" id="7807227">Name</span><span class="op" id="7807231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807236">CommonName</span><span class="op" id="7807246">:</span>&nbsp;<span class="string" id="7807248">&#34;*.2.3.4&#34;</span><span class="op" id="7807257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7807261">}</span><span class="op" id="7807262">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7807265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807268">err</span>&nbsp;<span class="op" id="7807272">=</span>&nbsp;<span class="ident" id="7807274">c</span><span class="op" id="7807275">.</span><span class="ident" id="7807276">VerifyHostname</span><span class="op" id="7807290">(</span><span class="string" id="7807291">&#34;1.2.3.4&#34;</span><span class="op" id="7807300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7807303">if</span>&nbsp;<span class="ident" id="7807306">err</span>&nbsp;<span class="op" id="7807310">==</span>&nbsp;<span class="ident" id="7807313">nil</span>&nbsp;<span class="op" id="7807317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807321">t</span><span class="op" id="7807322">.</span><span class="ident" id="7807323">Fatalf</span><span class="op" id="7807329">(</span><span class="string" id="7807330">&#34;VerifyHostname(1.2.3.4)&nbsp;should&nbsp;have&nbsp;failed,&nbsp;did&nbsp;not&#34;</span><span class="op" id="7807383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7807386">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807390">c</span>&nbsp;<span class="op" id="7807392">=</span>&nbsp;<span class="op" id="7807394">&amp;</span><span class="ident" id="7807395">Certificate</span><span class="op" id="7807406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807410">IPAddresses</span><span class="op" id="7807421">:</span>&nbsp;<span class="op" id="7807423">[</span><span class="op" id="7807424">]</span><span class="ident" id="7807425">net</span><span class="op" id="7807428">.</span><span class="ident" id="7807429">IP</span><span class="op" id="7807431">{</span><span class="ident" id="7807432">net</span><span class="op" id="7807435">.</span><span class="ident" id="7807436">ParseIP</span><span class="op" id="7807443">(</span><span class="string" id="7807444">&#34;127.0.0.1&#34;</span><span class="op" id="7807455">)</span><span class="op" id="7807456">,</span>&nbsp;<span class="ident" id="7807458">net</span><span class="op" id="7807461">.</span><span class="ident" id="7807462">ParseIP</span><span class="op" id="7807469">(</span><span class="string" id="7807470">&#34;::1&#34;</span><span class="op" id="7807475">)</span><span class="op" id="7807476">}</span><span class="op" id="7807477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7807480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807483">err</span>&nbsp;<span class="op" id="7807487">=</span>&nbsp;<span class="ident" id="7807489">c</span><span class="op" id="7807490">.</span><span class="ident" id="7807491">VerifyHostname</span><span class="op" id="7807505">(</span><span class="string" id="7807506">&#34;127.0.0.1&#34;</span><span class="op" id="7807517">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7807520">if</span>&nbsp;<span class="ident" id="7807523">err</span>&nbsp;<span class="op" id="7807527">!=</span>&nbsp;<span class="ident" id="7807530">nil</span>&nbsp;<span class="op" id="7807534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807538">t</span><span class="op" id="7807539">.</span><span class="ident" id="7807540">Fatalf</span><span class="op" id="7807546">(</span><span class="string" id="7807547">&#34;VerifyHostname(127.0.0.1):&nbsp;%v&#34;</span><span class="op" id="7807578">,</span>&nbsp;<span class="ident" id="7807580">err</span><span class="op" id="7807583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7807586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807589">err</span>&nbsp;<span class="op" id="7807593">=</span>&nbsp;<span class="ident" id="7807595">c</span><span class="op" id="7807596">.</span><span class="ident" id="7807597">VerifyHostname</span><span class="op" id="7807611">(</span><span class="string" id="7807612">&#34;::1&#34;</span><span class="op" id="7807617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7807620">if</span>&nbsp;<span class="ident" id="7807623">err</span>&nbsp;<span class="op" id="7807627">!=</span>&nbsp;<span class="ident" id="7807630">nil</span>&nbsp;<span class="op" id="7807634">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807638">t</span><span class="op" id="7807639">.</span><span class="ident" id="7807640">Fatalf</span><span class="op" id="7807646">(</span><span class="string" id="7807647">&#34;VerifyHostname(::1):&nbsp;%v&#34;</span><span class="op" id="7807672">,</span>&nbsp;<span class="ident" id="7807674">err</span><span class="op" id="7807677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7807680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807683">err</span>&nbsp;<span class="op" id="7807687">=</span>&nbsp;<span class="ident" id="7807689">c</span><span class="op" id="7807690">.</span><span class="ident" id="7807691">VerifyHostname</span><span class="op" id="7807705">(</span><span class="string" id="7807706">&#34;[::1]&#34;</span><span class="op" id="7807713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7807716">if</span>&nbsp;<span class="ident" id="7807719">err</span>&nbsp;<span class="op" id="7807723">!=</span>&nbsp;<span class="ident" id="7807726">nil</span>&nbsp;<span class="op" id="7807730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807734">t</span><span class="op" id="7807735">.</span><span class="ident" id="7807736">Fatalf</span><span class="op" id="7807742">(</span><span class="string" id="7807743">&#34;VerifyHostname([::1]):&nbsp;%v&#34;</span><span class="op" id="7807770">,</span>&nbsp;<span class="ident" id="7807772">err</span><span class="op" id="7807775">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7807778">}</span><br>
<span class="lineno"></span><span class="op" id="7807780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7807783">func</span>&nbsp;<span class="ident" id="7807788">TestCertificateParse</span><span class="op" id="7807808">(</span><span class="ident" id="7807809">t</span>&nbsp;<span class="op" id="7807811">*</span><span class="ident" id="7807812">testing</span><span class="op" id="7807819">.</span><span class="ident" id="7807820">T</span><span class="op" id="7807821">)</span>&nbsp;<span class="op" id="7807823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807826">s</span><span class="op" id="7807827">,</span>&nbsp;<span class="ident" id="7807829">_</span>&nbsp;<span class="op" id="7807831">:=</span>&nbsp;<span class="ident" id="7807834">hex</span><span class="op" id="7807837">.</span><span class="ident" id="7807838">DecodeString</span><span class="op" id="7807850">(</span><span class="ident" id="7807851">certBytes</span><span class="op" id="7807860">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807863">certs</span><span class="op" id="7807868">,</span>&nbsp;<span class="ident" id="7807870">err</span>&nbsp;<span class="op" id="7807874">:=</span>&nbsp;<span class="ident" id="7807877">ParseCertificates</span><span class="op" id="7807894">(</span><span class="ident" id="7807895">s</span><span class="op" id="7807896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7807899">if</span>&nbsp;<span class="ident" id="7807902">err</span>&nbsp;<span class="op" id="7807906">!=</span>&nbsp;<span class="ident" id="7807909">nil</span>&nbsp;<span class="op" id="7807913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807917">t</span><span class="op" id="7807918">.</span><span class="ident" id="7807919">Error</span><span class="op" id="7807924">(</span><span class="ident" id="7807925">err</span><span class="op" id="7807928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7807931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7807934">if</span>&nbsp;<span class="builtinfunc" id="7807937">len</span><span class="op" id="7807940">(</span><span class="ident" id="7807941">certs</span><span class="op" id="7807946">)</span>&nbsp;<span class="op" id="7807948">!=</span>&nbsp;<span class="num" id="7807951">2</span>&nbsp;<span class="op" id="7807953">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7807957">t</span><span class="op" id="7807958">.</span><span class="ident" id="7807959">Errorf</span><span class="op" id="7807965">(</span><span class="string" id="7807966">&#34;Wrong&nbsp;number&nbsp;of&nbsp;certs:&nbsp;got&nbsp;%d&nbsp;want&nbsp;2&#34;</span><span class="op" id="7808004">,</span>&nbsp;<span class="builtinfunc" id="7808006">len</span><span class="op" id="7808009">(</span><span class="ident" id="7808010">certs</span><span class="op" id="7808015">)</span><span class="op" id="7808016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7808020">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7808028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808032">err</span>&nbsp;<span class="op" id="7808036">=</span>&nbsp;<span class="ident" id="7808038">certs</span><span class="op" id="7808043">[</span><span class="num" id="7808044">0</span><span class="op" id="7808045">]</span><span class="op" id="7808046">.</span><span class="ident" id="7808047">CheckSignatureFrom</span><span class="op" id="7808065">(</span><span class="ident" id="7808066">certs</span><span class="op" id="7808071">[</span><span class="num" id="7808072">1</span><span class="op" id="7808073">]</span><span class="op" id="7808074">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7808077">if</span>&nbsp;<span class="ident" id="7808080">err</span>&nbsp;<span class="op" id="7808084">!=</span>&nbsp;<span class="ident" id="7808087">nil</span>&nbsp;<span class="op" id="7808091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808095">t</span><span class="op" id="7808096">.</span><span class="ident" id="7808097">Error</span><span class="op" id="7808102">(</span><span class="ident" id="7808103">err</span><span class="op" id="7808106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7808109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7808113">if</span>&nbsp;<span class="ident" id="7808116">err</span>&nbsp;<span class="op" id="7808120">:=</span>&nbsp;<span class="ident" id="7808123">certs</span><span class="op" id="7808128">[</span><span class="num" id="7808129">0</span><span class="op" id="7808130">]</span><span class="op" id="7808131">.</span><span class="ident" id="7808132">VerifyHostname</span><span class="op" id="7808146">(</span><span class="string" id="7808147">&#34;mail.google.com&#34;</span><span class="op" id="7808164">)</span><span class="op" id="7808165">;</span>&nbsp;<span class="ident" id="7808167">err</span>&nbsp;<span class="op" id="7808171">!=</span>&nbsp;<span class="ident" id="7808174">nil</span>&nbsp;<span class="op" id="7808178">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808182">t</span><span class="op" id="7808183">.</span><span class="ident" id="7808184">Error</span><span class="op" id="7808189">(</span><span class="ident" id="7808190">err</span><span class="op" id="7808193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7808196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7808200">const</span>&nbsp;<span class="ident" id="7808206">expectedExtensions</span>&nbsp;<span class="op" id="7808225">=</span>&nbsp;<span class="num" id="7808227">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7808230">if</span>&nbsp;<span class="ident" id="7808233">n</span>&nbsp;<span class="op" id="7808235">:=</span>&nbsp;<span class="builtinfunc" id="7808238">len</span><span class="op" id="7808241">(</span><span class="ident" id="7808242">certs</span><span class="op" id="7808247">[</span><span class="num" id="7808248">0</span><span class="op" id="7808249">]</span><span class="op" id="7808250">.</span><span class="ident" id="7808251">Extensions</span><span class="op" id="7808261">)</span><span class="op" id="7808262">;</span>&nbsp;<span class="ident" id="7808264">n</span>&nbsp;<span class="op" id="7808266">!=</span>&nbsp;<span class="ident" id="7808269">expectedExtensions</span>&nbsp;<span class="op" id="7808288">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7808292">t</span><span class="op" id="7808293">.</span><span class="ident" id="7808294">Errorf</span><span class="op" id="7808300">(</span><span class="string" id="7808301">&#34;want&nbsp;%d&nbsp;extensions,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7808329">,</span>&nbsp;<span class="ident" id="7808331">expectedExtensions</span><span class="op" id="7808349">,</span>&nbsp;<span class="ident" id="7808351">n</span><span class="op" id="7808352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7808355">}</span><br>
<span class="lineno"></span><span class="op" id="7808357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7808360">var</span>&nbsp;<span class="ident" id="7808364">certBytes</span>&nbsp;<span class="op" id="7808374">=</span>&nbsp;<span class="string" id="7808376">&#34;308203223082028ba00302010202106edf0d9499fd4533dd1297fc42a93be1300d06092a864886&#34;</span>&nbsp;<span class="op" id="7808457">+</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7808460">&#34;f70d0101050500304c310b3009060355040613025a4131253023060355040a131c546861777465&#34;</span>&nbsp;<span class="op" id="7808541">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7808544">&#34;20436f6e73756c74696e67202850747929204c74642e311630140603550403130d546861777465&#34;</span>&nbsp;<span class="op" id="7808625">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7808628">&#34;20534743204341301e170d3039303332353136343932395a170d3130303332353136343932395a&#34;</span>&nbsp;<span class="op" id="7808709">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7808712">&#34;3069310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630&#34;</span>&nbsp;<span class="op" id="7808793">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7808796">&#34;140603550407130d4d6f756e7461696e205669657731133011060355040a130a476f6f676c6520&#34;</span>&nbsp;<span class="op" id="7808877">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7808880">&#34;496e63311830160603550403130f6d61696c2e676f6f676c652e636f6d30819f300d06092a8648&#34;</span>&nbsp;<span class="op" id="7808961">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7808964">&#34;86f70d010101050003818d0030818902818100c5d6f892fccaf5614b064149e80a2c9581a218ef&#34;</span>&nbsp;<span class="op" id="7809045">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7809048">&#34;41ec35bd7a58125ae76f9ea54ddc893abbeb029f6b73616bf0ffd868791fba7af9c4aebf3706ba&#34;</span>&nbsp;<span class="op" id="7809129">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7809132">&#34;3eeaeed27435b4ddcfb157c05f351d66aa87fee0de072d66d773affbd36ab78bef090e0cc861a9&#34;</span>&nbsp;<span class="op" id="7809213">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7809216">&#34;03ac90dd98b51c9c41566c017f0beec3bff391051ffba0f5cc6850ad2a590203010001a381e730&#34;</span>&nbsp;<span class="op" id="7809297">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7809300">&#34;81e430280603551d250421301f06082b0601050507030106082b06010505070302060960864801&#34;</span>&nbsp;<span class="op" id="7809381">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7809384">&#34;86f842040130360603551d1f042f302d302ba029a0278625687474703a2f2f63726c2e74686177&#34;</span>&nbsp;<span class="op" id="7809465">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7809468">&#34;74652e636f6d2f54686177746553474343412e63726c307206082b060105050701010466306430&#34;</span>&nbsp;<span class="op" id="7809549">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7809552">&#34;2206082b060105050730018616687474703a2f2f6f6373702e7468617774652e636f6d303e0608&#34;</span>&nbsp;<span class="op" id="7809633">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7809636">&#34;2b060105050730028632687474703a2f2f7777772e7468617774652e636f6d2f7265706f736974&#34;</span>&nbsp;<span class="op" id="7809717">+</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7809720">&#34;6f72792f5468617774655f5347435f43412e637274300c0603551d130101ff04023000300d0609&#34;</span>&nbsp;<span class="op" id="7809801">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7809804">&#34;2a864886f70d01010505000381810062f1f3050ebc105e497c7aedf87e24d2f4a986bb3b837bd1&#34;</span>&nbsp;<span class="op" id="7809885">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7809888">&#34;9b91ebcad98b065992f6bd2b49b7d6d3cb2e427a99d606c7b1d46352527fac39e6a8b6726de5bf&#34;</span>&nbsp;<span class="op" id="7809969">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7809972">&#34;70212a52cba07634a5e332011bd1868e78eb5e3c93cf03072276786f207494feaa0ed9d53b2110&#34;</span>&nbsp;<span class="op" id="7810053">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7810056">&#34;a76571f90209cdae884385c882587030ee15f33d761e2e45a6bc308203233082028ca003020102&#34;</span>&nbsp;<span class="op" id="7810137">+</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7810140">&#34;020430000002300d06092a864886f70d0101050500305f310b3009060355040613025553311730&#34;</span>&nbsp;<span class="op" id="7810221">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7810224">&#34;15060355040a130e566572695369676e2c20496e632e31373035060355040b132e436c61737320&#34;</span>&nbsp;<span class="op" id="7810305">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7810308">&#34;33205075626c6963205072696d6172792043657274696669636174696f6e20417574686f726974&#34;</span>&nbsp;<span class="op" id="7810389">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7810392">&#34;79301e170d3034303531333030303030305a170d3134303531323233353935395a304c310b3009&#34;</span>&nbsp;<span class="op" id="7810473">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7810476">&#34;060355040613025a4131253023060355040a131c54686177746520436f6e73756c74696e672028&#34;</span>&nbsp;<span class="op" id="7810557">+</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7810560">&#34;50747929204c74642e311630140603550403130d5468617774652053474320434130819f300d06&#34;</span>&nbsp;<span class="op" id="7810641">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7810644">&#34;092a864886f70d010101050003818d0030818902818100d4d367d08d157faecd31fe7d1d91a13f&#34;</span>&nbsp;<span class="op" id="7810725">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7810728">&#34;0b713cacccc864fb63fc324b0794bd6f80ba2fe10493c033fc093323e90b742b71c403c6d2cde2&#34;</span>&nbsp;<span class="op" id="7810809">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7810812">&#34;2ff50963cdff48a500bfe0e7f388b72d32de9836e60aad007bc4644a3b847503f270927d0e62f5&#34;</span>&nbsp;<span class="op" id="7810893">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7810896">&#34;21ab693684317590f8bfc76c881b06957cc9e5a8de75a12c7a68dfd5ca1c875860190203010001&#34;</span>&nbsp;<span class="op" id="7810977">+</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7810980">&#34;a381fe3081fb30120603551d130101ff040830060101ff020100300b0603551d0f040403020106&#34;</span>&nbsp;<span class="op" id="7811061">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7811064">&#34;301106096086480186f842010104040302010630280603551d110421301fa41d301b3119301706&#34;</span>&nbsp;<span class="op" id="7811145">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7811148">&#34;035504031310507269766174654c6162656c332d313530310603551d1f042a30283026a024a022&#34;</span>&nbsp;<span class="op" id="7811229">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7811232">&#34;8620687474703a2f2f63726c2e766572697369676e2e636f6d2f706361332e63726c303206082b&#34;</span>&nbsp;<span class="op" id="7811313">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7811316">&#34;0601050507010104263024302206082b060105050730018616687474703a2f2f6f6373702e7468&#34;</span>&nbsp;<span class="op" id="7811397">+</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7811400">&#34;617774652e636f6d30340603551d25042d302b06082b0601050507030106082b06010505070302&#34;</span>&nbsp;<span class="op" id="7811481">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7811484">&#34;06096086480186f8420401060a6086480186f845010801300d06092a864886f70d010105050003&#34;</span>&nbsp;<span class="op" id="7811565">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7811568">&#34;81810055ac63eadea1ddd2905f9f0bce76be13518f93d9052bc81b774bad6950a1eededcfddb07&#34;</span>&nbsp;<span class="op" id="7811649">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7811652">&#34;e9e83994dcab72792f06bfab8170c4a8edea5334edef1e53d906c7562bd15cf4d18a8eb42bb137&#34;</span>&nbsp;<span class="op" id="7811733">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7811736">&#34;9048084225c53e8acb7feb6f04d16dc574a2f7a27c7b603c77cd0ece48027f012fb69b37e02a2a&#34;</span>&nbsp;<span class="op" id="7811817">+</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7811820">&#34;36dcd585d6ace53f546f961e05af&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7811852">func</span>&nbsp;<span class="ident" id="7811857">TestCreateSelfSignedCertificate</span><span class="op" id="7811888">(</span><span class="ident" id="7811889">t</span>&nbsp;<span class="op" id="7811891">*</span><span class="ident" id="7811892">testing</span><span class="op" id="7811899">.</span><span class="ident" id="7811900">T</span><span class="op" id="7811901">)</span>&nbsp;<span class="op" id="7811903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7811906">random</span>&nbsp;<span class="op" id="7811913">:=</span>&nbsp;<span class="ident" id="7811916">rand</span><span class="op" id="7811920">.</span><span class="ident" id="7811921">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7811930">block</span><span class="op" id="7811935">,</span>&nbsp;<span class="ident" id="7811937">_</span>&nbsp;<span class="op" id="7811939">:=</span>&nbsp;<span class="ident" id="7811942">pem</span><span class="op" id="7811945">.</span><span class="ident" id="7811946">Decode</span><span class="op" id="7811952">(</span><span class="op" id="7811953">[</span><span class="op" id="7811954">]</span><span class="builtintype" id="7811955">byte</span><span class="op" id="7811959">(</span><span class="ident" id="7811960">pemPrivateKey</span><span class="op" id="7811973">)</span><span class="op" id="7811974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7811977">rsaPriv</span><span class="op" id="7811984">,</span>&nbsp;<span class="ident" id="7811986">err</span>&nbsp;<span class="op" id="7811990">:=</span>&nbsp;<span class="ident" id="7811993">ParsePKCS1PrivateKey</span><span class="op" id="7812013">(</span><span class="ident" id="7812014">block</span><span class="op" id="7812019">.</span><span class="ident" id="7812020">Bytes</span><span class="op" id="7812025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7812028">if</span>&nbsp;<span class="ident" id="7812031">err</span>&nbsp;<span class="op" id="7812035">!=</span>&nbsp;<span class="ident" id="7812038">nil</span>&nbsp;<span class="op" id="7812042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7812046">t</span><span class="op" id="7812047">.</span><span class="ident" id="7812048">Fatalf</span><span class="op" id="7812054">(</span><span class="string" id="7812055">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7812088">,</span>&nbsp;<span class="ident" id="7812090">err</span><span class="op" id="7812093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7812096">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7812100">ecdsaPriv</span><span class="op" id="7812109">,</span>&nbsp;<span class="ident" id="7812111">err</span>&nbsp;<span class="op" id="7812115">:=</span>&nbsp;<span class="ident" id="7812118">ecdsa</span><span class="op" id="7812123">.</span><span class="ident" id="7812124">GenerateKey</span><span class="op" id="7812135">(</span><span class="ident" id="7812136">elliptic</span><span class="op" id="7812144">.</span><span class="ident" id="7812145">P256</span><span class="op" id="7812149">(</span><span class="op" id="7812150">)</span><span class="op" id="7812151">,</span>&nbsp;<span class="ident" id="7812153">rand</span><span class="op" id="7812157">.</span><span class="ident" id="7812158">Reader</span><span class="op" id="7812164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7812167">if</span>&nbsp;<span class="ident" id="7812170">err</span>&nbsp;<span class="op" id="7812174">!=</span>&nbsp;<span class="ident" id="7812177">nil</span>&nbsp;<span class="op" id="7812181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7812185">t</span><span class="op" id="7812186">.</span><span class="ident" id="7812187">Fatalf</span><span class="op" id="7812193">(</span><span class="string" id="7812194">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7812228">,</span>&nbsp;<span class="ident" id="7812230">err</span><span class="op" id="7812233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7812236">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7812240">tests</span>&nbsp;<span class="op" id="7812246">:=</span>&nbsp;<span class="op" id="7812249">[</span><span class="op" id="7812250">]</span><span class="keyword" id="7812251">struct</span>&nbsp;<span class="op" id="7812258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7812262">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7812272">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7812281">pub</span><span class="op" id="7812284">,</span>&nbsp;<span class="ident" id="7812286">priv</span>&nbsp;<span class="keyword" id="7812291">interface</span><span class="op" id="7812300">{</span><span class="op" id="7812301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7812305">checkSig</span>&nbsp;&nbsp;<span class="builtintype" id="7812315">bool</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7812322">sigAlgo</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7812332">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7812352">}</span><span class="op" id="7812353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7812357">{</span><span class="string" id="7812358">&#34;RSA/RSA&#34;</span><span class="op" id="7812367">,</span>&nbsp;<span class="op" id="7812369">&amp;</span><span class="ident" id="7812370">rsaPriv</span><span class="op" id="7812377">.</span><span class="ident" id="7812378">PublicKey</span><span class="op" id="7812387">,</span>&nbsp;<span class="ident" id="7812389">rsaPriv</span><span class="op" id="7812396">,</span>&nbsp;<span class="builtintype" id="7812398">true</span><span class="op" id="7812402">,</span>&nbsp;<span class="ident" id="7812404">SHA1WithRSA</span><span class="op" id="7812415">}</span><span class="op" id="7812416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7812420">{</span><span class="string" id="7812421">&#34;RSA/ECDSA&#34;</span><span class="op" id="7812432">,</span>&nbsp;<span class="op" id="7812434">&amp;</span><span class="ident" id="7812435">rsaPriv</span><span class="op" id="7812442">.</span><span class="ident" id="7812443">PublicKey</span><span class="op" id="7812452">,</span>&nbsp;<span class="ident" id="7812454">ecdsaPriv</span><span class="op" id="7812463">,</span>&nbsp;<span class="builtintype" id="7812465">false</span><span class="op" id="7812470">,</span>&nbsp;<span class="ident" id="7812472">ECDSAWithSHA384</span><span class="op" id="7812487">}</span><span class="op" id="7812488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7812492">{</span><span class="string" id="7812493">&#34;ECDSA/RSA&#34;</span><span class="op" id="7812504">,</span>&nbsp;<span class="op" id="7812506">&amp;</span><span class="ident" id="7812507">ecdsaPriv</span><span class="op" id="7812516">.</span><span class="ident" id="7812517">PublicKey</span><span class="op" id="7812526">,</span>&nbsp;<span class="ident" id="7812528">rsaPriv</span><span class="op" id="7812535">,</span>&nbsp;<span class="builtintype" id="7812537">false</span><span class="op" id="7812542">,</span>&nbsp;<span class="ident" id="7812544">SHA256WithRSA</span><span class="op" id="7812557">}</span><span class="op" id="7812558">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7812562">{</span><span class="string" id="7812563">&#34;ECDSA/ECDSA&#34;</span><span class="op" id="7812576">,</span>&nbsp;<span class="op" id="7812578">&amp;</span><span class="ident" id="7812579">ecdsaPriv</span><span class="op" id="7812588">.</span><span class="ident" id="7812589">PublicKey</span><span class="op" id="7812598">,</span>&nbsp;<span class="ident" id="7812600">ecdsaPriv</span><span class="op" id="7812609">,</span>&nbsp;<span class="builtintype" id="7812611">true</span><span class="op" id="7812615">,</span>&nbsp;<span class="ident" id="7812617">ECDSAWithSHA1</span><span class="op" id="7812630">}</span><span class="op" id="7812631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7812634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7812638">testExtKeyUsage</span>&nbsp;<span class="op" id="7812654">:=</span>&nbsp;<span class="op" id="7812657">[</span><span class="op" id="7812658">]</span><span class="ident" id="7812659">ExtKeyUsage</span><span class="op" id="7812670">{</span><span class="ident" id="7812671">ExtKeyUsageClientAuth</span><span class="op" id="7812692">,</span>&nbsp;<span class="ident" id="7812694">ExtKeyUsageServerAuth</span><span class="op" id="7812715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7812718">testUnknownExtKeyUsage</span>&nbsp;<span class="op" id="7812741">:=</span>&nbsp;<span class="op" id="7812744">[</span><span class="op" id="7812745">]</span><span class="ident" id="7812746">asn1</span><span class="op" id="7812750">.</span><span class="ident" id="7812751">ObjectIdentifier</span><span class="op" id="7812767">{</span><span class="op" id="7812768">[</span><span class="op" id="7812769">]</span><span class="builtintype" id="7812770">int</span><span class="op" id="7812773">{</span><span class="num" id="7812774">1</span><span class="op" id="7812775">,</span>&nbsp;<span class="num" id="7812777">2</span><span class="op" id="7812778">,</span>&nbsp;<span class="num" id="7812780">3</span><span class="op" id="7812781">}</span><span class="op" id="7812782">,</span>&nbsp;<span class="op" id="7812784">[</span><span class="op" id="7812785">]</span><span class="builtintype" id="7812786">int</span><span class="op" id="7812789">{</span><span class="num" id="7812790">2</span><span class="op" id="7812791">,</span>&nbsp;<span class="num" id="7812793">59</span><span class="op" id="7812795">,</span>&nbsp;<span class="num" id="7812797">1</span><span class="op" id="7812798">}</span><span class="op" id="7812799">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7812802">extraExtensionData</span>&nbsp;<span class="op" id="7812821">:=</span>&nbsp;<span class="op" id="7812824">[</span><span class="op" id="7812825">]</span><span class="builtintype" id="7812826">byte</span><span class="op" id="7812830">(</span><span class="string" id="7812831">&#34;extra&nbsp;extension&#34;</span><span class="op" id="7812848">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7812852">for</span>&nbsp;<span class="ident" id="7812856">_</span><span class="op" id="7812857">,</span>&nbsp;<span class="ident" id="7812859">test</span>&nbsp;<span class="op" id="7812864">:=</span>&nbsp;<span class="keyword" id="7812867">range</span>&nbsp;<span class="ident" id="7812873">tests</span>&nbsp;<span class="op" id="7812879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7812883">commonName</span>&nbsp;<span class="op" id="7812894">:=</span>&nbsp;<span class="string" id="7812897">&#34;test.example.com&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7812918">template</span>&nbsp;<span class="op" id="7812927">:=</span>&nbsp;<span class="ident" id="7812930">Certificate</span><span class="op" id="7812941">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7812946">SerialNumber</span><span class="op" id="7812958">:</span>&nbsp;<span class="ident" id="7812960">big</span><span class="op" id="7812963">.</span><span class="ident" id="7812964">NewInt</span><span class="op" id="7812970">(</span><span class="num" id="7812971">1</span><span class="op" id="7812972">)</span><span class="op" id="7812973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7812978">Subject</span><span class="op" id="7812985">:</span>&nbsp;<span class="ident" id="7812987">pkix</span><span class="op" id="7812991">.</span><span class="ident" id="7812992">Name</span><span class="op" id="7812996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813002">CommonName</span><span class="op" id="7813012">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7813016">commonName</span><span class="op" id="7813026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813032">Organization</span><span class="op" id="7813044">:</span>&nbsp;<span class="op" id="7813046">[</span><span class="op" id="7813047">]</span><span class="builtintype" id="7813048">string</span><span class="op" id="7813054">{</span><span class="string" id="7813055">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7813067">}</span><span class="op" id="7813068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7813073">}</span><span class="op" id="7813074">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813079">NotBefore</span><span class="op" id="7813088">:</span>&nbsp;<span class="ident" id="7813090">time</span><span class="op" id="7813094">.</span><span class="ident" id="7813095">Unix</span><span class="op" id="7813099">(</span><span class="num" id="7813100">1000</span><span class="op" id="7813104">,</span>&nbsp;<span class="num" id="7813106">0</span><span class="op" id="7813107">)</span><span class="op" id="7813108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813113">NotAfter</span><span class="op" id="7813121">:</span>&nbsp;&nbsp;<span class="ident" id="7813124">time</span><span class="op" id="7813128">.</span><span class="ident" id="7813129">Unix</span><span class="op" id="7813133">(</span><span class="num" id="7813134">100000</span><span class="op" id="7813140">,</span>&nbsp;<span class="num" id="7813142">0</span><span class="op" id="7813143">)</span><span class="op" id="7813144">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813150">SignatureAlgorithm</span><span class="op" id="7813168">:</span>&nbsp;<span class="ident" id="7813170">test</span><span class="op" id="7813174">.</span><span class="ident" id="7813175">sigAlgo</span><span class="op" id="7813182">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813188">SubjectKeyId</span><span class="op" id="7813200">:</span>&nbsp;<span class="op" id="7813202">[</span><span class="op" id="7813203">]</span><span class="builtintype" id="7813204">byte</span><span class="op" id="7813208">{</span><span class="num" id="7813209">1</span><span class="op" id="7813210">,</span>&nbsp;<span class="num" id="7813212">2</span><span class="op" id="7813213">,</span>&nbsp;<span class="num" id="7813215">3</span><span class="op" id="7813216">,</span>&nbsp;<span class="num" id="7813218">4</span><span class="op" id="7813219">}</span><span class="op" id="7813220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813225">KeyUsage</span><span class="op" id="7813233">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7813239">KeyUsageCertSign</span><span class="op" id="7813255">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813261">ExtKeyUsage</span><span class="op" id="7813272">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7813281">testExtKeyUsage</span><span class="op" id="7813296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813301">UnknownExtKeyUsage</span><span class="op" id="7813319">:</span>&nbsp;<span class="ident" id="7813321">testUnknownExtKeyUsage</span><span class="op" id="7813343">,</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813349">BasicConstraintsValid</span><span class="op" id="7813370">:</span>&nbsp;<span class="builtintype" id="7813372">true</span><span class="op" id="7813376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813381">IsCA</span><span class="op" id="7813385">:</span>&nbsp;<span class="builtintype" id="7813387">true</span><span class="op" id="7813391">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813397">OCSPServer</span><span class="op" id="7813407">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7813420">[</span><span class="op" id="7813421">]</span><span class="builtintype" id="7813422">string</span><span class="op" id="7813428">{</span><span class="string" id="7813429">&#34;http://ocsp.example.com&#34;</span><span class="op" id="7813454">}</span><span class="op" id="7813455">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813460">IssuingCertificateURL</span><span class="op" id="7813481">:</span>&nbsp;<span class="op" id="7813483">[</span><span class="op" id="7813484">]</span><span class="builtintype" id="7813485">string</span><span class="op" id="7813491">{</span><span class="string" id="7813492">&#34;http://crt.example.com/ca1.crt&#34;</span><span class="op" id="7813524">}</span><span class="op" id="7813525">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813531">DNSNames</span><span class="op" id="7813539">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7813547">[</span><span class="op" id="7813548">]</span><span class="builtintype" id="7813549">string</span><span class="op" id="7813555">{</span><span class="string" id="7813556">&#34;test.example.com&#34;</span><span class="op" id="7813574">}</span><span class="op" id="7813575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813580">EmailAddresses</span><span class="op" id="7813594">:</span>&nbsp;<span class="op" id="7813596">[</span><span class="op" id="7813597">]</span><span class="builtintype" id="7813598">string</span><span class="op" id="7813604">{</span><span class="string" id="7813605">&#34;gopher@golang.org&#34;</span><span class="op" id="7813624">}</span><span class="op" id="7813625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813630">IPAddresses</span><span class="op" id="7813641">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7813646">[</span><span class="op" id="7813647">]</span><span class="ident" id="7813648">net</span><span class="op" id="7813651">.</span><span class="ident" id="7813652">IP</span><span class="op" id="7813654">{</span><span class="ident" id="7813655">net</span><span class="op" id="7813658">.</span><span class="ident" id="7813659">IPv4</span><span class="op" id="7813663">(</span><span class="num" id="7813664">127</span><span class="op" id="7813667">,</span>&nbsp;<span class="num" id="7813669">0</span><span class="op" id="7813670">,</span>&nbsp;<span class="num" id="7813672">0</span><span class="op" id="7813673">,</span>&nbsp;<span class="num" id="7813675">1</span><span class="op" id="7813676">)</span><span class="op" id="7813677">.</span><span class="ident" id="7813678">To4</span><span class="op" id="7813681">(</span><span class="op" id="7813682">)</span><span class="op" id="7813683">,</span>&nbsp;<span class="ident" id="7813685">net</span><span class="op" id="7813688">.</span><span class="ident" id="7813689">ParseIP</span><span class="op" id="7813696">(</span><span class="string" id="7813697">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7813719">)</span><span class="op" id="7813720">}</span><span class="op" id="7813721">,</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813727">PolicyIdentifiers</span><span class="op" id="7813744">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7813748">[</span><span class="op" id="7813749">]</span><span class="ident" id="7813750">asn1</span><span class="op" id="7813754">.</span><span class="ident" id="7813755">ObjectIdentifier</span><span class="op" id="7813771">{</span><span class="op" id="7813772">[</span><span class="op" id="7813773">]</span><span class="builtintype" id="7813774">int</span><span class="op" id="7813777">{</span><span class="num" id="7813778">1</span><span class="op" id="7813779">,</span>&nbsp;<span class="num" id="7813781">2</span><span class="op" id="7813782">,</span>&nbsp;<span class="num" id="7813784">3</span><span class="op" id="7813785">}</span><span class="op" id="7813786">}</span><span class="op" id="7813787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813792">PermittedDNSDomains</span><span class="op" id="7813811">:</span>&nbsp;<span class="op" id="7813813">[</span><span class="op" id="7813814">]</span><span class="builtintype" id="7813815">string</span><span class="op" id="7813821">{</span><span class="string" id="7813822">&#34;.example.com&#34;</span><span class="op" id="7813836">,</span>&nbsp;<span class="string" id="7813838">&#34;example.com&#34;</span><span class="op" id="7813851">}</span><span class="op" id="7813852">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813858">CRLDistributionPoints</span><span class="op" id="7813879">:</span>&nbsp;<span class="op" id="7813881">[</span><span class="op" id="7813882">]</span><span class="builtintype" id="7813883">string</span><span class="op" id="7813889">{</span><span class="string" id="7813890">&#34;http://crl1.example.com/ca1.crl&#34;</span><span class="op" id="7813923">,</span>&nbsp;<span class="string" id="7813925">&#34;http://crl2.example.com/ca1.crl&#34;</span><span class="op" id="7813958">}</span><span class="op" id="7813959">,</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7813965">ExtraExtensions</span><span class="op" id="7813980">:</span>&nbsp;<span class="op" id="7813982">[</span><span class="op" id="7813983">]</span><span class="ident" id="7813984">pkix</span><span class="op" id="7813988">.</span><span class="ident" id="7813989">Extension</span><span class="op" id="7813998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7814004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7814011">Id</span><span class="op" id="7814013">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7814018">[</span><span class="op" id="7814019">]</span><span class="builtintype" id="7814020">int</span><span class="op" id="7814023">{</span><span class="num" id="7814024">1</span><span class="op" id="7814025">,</span>&nbsp;<span class="num" id="7814027">2</span><span class="op" id="7814028">,</span>&nbsp;<span class="num" id="7814030">3</span><span class="op" id="7814031">,</span>&nbsp;<span class="num" id="7814033">4</span><span class="op" id="7814034">}</span><span class="op" id="7814035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7814042">Value</span><span class="op" id="7814047">:</span>&nbsp;<span class="ident" id="7814049">extraExtensionData</span><span class="op" id="7814067">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7814073">}</span><span class="op" id="7814074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7814080">//&nbsp;This&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;SubjectKeyId,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7814143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7814150">Id</span><span class="op" id="7814152">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7814160">oidExtensionSubjectKeyId</span><span class="op" id="7814184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7814191">Critical</span><span class="op" id="7814199">:</span>&nbsp;<span class="builtintype" id="7814201">false</span><span class="op" id="7814206">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7814213">Value</span><span class="op" id="7814218">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7814223">[</span><span class="op" id="7814224">]</span><span class="builtintype" id="7814225">byte</span><span class="op" id="7814229">{</span><span class="num" id="7814230">0x04</span><span class="op" id="7814234">,</span>&nbsp;<span class="num" id="7814236">0x04</span><span class="op" id="7814240">,</span>&nbsp;<span class="num" id="7814242">4</span><span class="op" id="7814243">,</span>&nbsp;<span class="num" id="7814245">3</span><span class="op" id="7814246">,</span>&nbsp;<span class="num" id="7814248">2</span><span class="op" id="7814249">,</span>&nbsp;<span class="num" id="7814251">1</span><span class="op" id="7814252">}</span><span class="op" id="7814253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7814259">}</span><span class="op" id="7814260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7814265">}</span><span class="op" id="7814266">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7814270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7814275">derBytes</span><span class="op" id="7814283">,</span>&nbsp;<span class="ident" id="7814285">err</span>&nbsp;<span class="op" id="7814289">:=</span>&nbsp;<span class="ident" id="7814292">CreateCertificate</span><span class="op" id="7814309">(</span><span class="ident" id="7814310">random</span><span class="op" id="7814316">,</span>&nbsp;<span class="op" id="7814318">&amp;</span><span class="ident" id="7814319">template</span><span class="op" id="7814327">,</span>&nbsp;<span class="op" id="7814329">&amp;</span><span class="ident" id="7814330">template</span><span class="op" id="7814338">,</span>&nbsp;<span class="ident" id="7814340">test</span><span class="op" id="7814344">.</span><span class="ident" id="7814345">pub</span><span class="op" id="7814348">,</span>&nbsp;<span class="ident" id="7814350">test</span><span class="op" id="7814354">.</span><span class="ident" id="7814355">priv</span><span class="op" id="7814359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7814363">if</span>&nbsp;<span class="ident" id="7814366">err</span>&nbsp;<span class="op" id="7814370">!=</span>&nbsp;<span class="ident" id="7814373">nil</span>&nbsp;<span class="op" id="7814377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7814382">t</span><span class="op" id="7814383">.</span><span class="ident" id="7814384">Errorf</span><span class="op" id="7814390">(</span><span class="string" id="7814391">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7814429">,</span>&nbsp;<span class="ident" id="7814431">test</span><span class="op" id="7814435">.</span><span class="ident" id="7814436">name</span><span class="op" id="7814440">,</span>&nbsp;<span class="ident" id="7814442">err</span><span class="op" id="7814445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7814450">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7814461">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7814466">cert</span><span class="op" id="7814470">,</span>&nbsp;<span class="ident" id="7814472">err</span>&nbsp;<span class="op" id="7814476">:=</span>&nbsp;<span class="ident" id="7814479">ParseCertificate</span><span class="op" id="7814495">(</span><span class="ident" id="7814496">derBytes</span><span class="op" id="7814504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7814508">if</span>&nbsp;<span class="ident" id="7814511">err</span>&nbsp;<span class="op" id="7814515">!=</span>&nbsp;<span class="ident" id="7814518">nil</span>&nbsp;<span class="op" id="7814522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7814527">t</span><span class="op" id="7814528">.</span><span class="ident" id="7814529">Errorf</span><span class="op" id="7814535">(</span><span class="string" id="7814536">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7814573">,</span>&nbsp;<span class="ident" id="7814575">test</span><span class="op" id="7814579">.</span><span class="ident" id="7814580">name</span><span class="op" id="7814584">,</span>&nbsp;<span class="ident" id="7814586">err</span><span class="op" id="7814589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7814594">continue</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7814605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7814610">if</span>&nbsp;<span class="builtinfunc" id="7814613">len</span><span class="op" id="7814616">(</span><span class="ident" id="7814617">cert</span><span class="op" id="7814621">.</span><span class="ident" id="7814622">PolicyIdentifiers</span><span class="op" id="7814639">)</span>&nbsp;<span class="op" id="7814641">!=</span>&nbsp;<span class="num" id="7814644">1</span>&nbsp;<span class="op" id="7814646">||</span>&nbsp;<span class="op" id="7814649">!</span><span class="ident" id="7814650">cert</span><span class="op" id="7814654">.</span><span class="ident" id="7814655">PolicyIdentifiers</span><span class="op" id="7814672">[</span><span class="num" id="7814673">0</span><span class="op" id="7814674">]</span><span class="op" id="7814675">.</span><span class="ident" id="7814676">Equal</span><span class="op" id="7814681">(</span><span class="ident" id="7814682">template</span><span class="op" id="7814690">.</span><span class="ident" id="7814691">PolicyIdentifiers</span><span class="op" id="7814708">[</span><span class="num" id="7814709">0</span><span class="op" id="7814710">]</span><span class="op" id="7814711">)</span>&nbsp;<span class="op" id="7814713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7814718">t</span><span class="op" id="7814719">.</span><span class="ident" id="7814720">Errorf</span><span class="op" id="7814726">(</span><span class="string" id="7814727">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;policy&nbsp;identifiers:&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="7814785">,</span>&nbsp;<span class="ident" id="7814787">test</span><span class="op" id="7814791">.</span><span class="ident" id="7814792">name</span><span class="op" id="7814796">,</span>&nbsp;<span class="ident" id="7814798">cert</span><span class="op" id="7814802">.</span><span class="ident" id="7814803">PolicyIdentifiers</span><span class="op" id="7814820">,</span>&nbsp;<span class="ident" id="7814822">template</span><span class="op" id="7814830">.</span><span class="ident" id="7814831">PolicyIdentifiers</span><span class="op" id="7814848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7814852">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7814857">if</span>&nbsp;<span class="builtinfunc" id="7814860">len</span><span class="op" id="7814863">(</span><span class="ident" id="7814864">cert</span><span class="op" id="7814868">.</span><span class="ident" id="7814869">PermittedDNSDomains</span><span class="op" id="7814888">)</span>&nbsp;<span class="op" id="7814890">!=</span>&nbsp;<span class="num" id="7814893">2</span>&nbsp;<span class="op" id="7814895">||</span>&nbsp;<span class="ident" id="7814898">cert</span><span class="op" id="7814902">.</span><span class="ident" id="7814903">PermittedDNSDomains</span><span class="op" id="7814922">[</span><span class="num" id="7814923">0</span><span class="op" id="7814924">]</span>&nbsp;<span class="op" id="7814926">!=</span>&nbsp;<span class="string" id="7814929">&#34;.example.com&#34;</span>&nbsp;<span class="op" id="7814944">||</span>&nbsp;<span class="ident" id="7814947">cert</span><span class="op" id="7814951">.</span><span class="ident" id="7814952">PermittedDNSDomains</span><span class="op" id="7814971">[</span><span class="num" id="7814972">1</span><span class="op" id="7814973">]</span>&nbsp;<span class="op" id="7814975">!=</span>&nbsp;<span class="string" id="7814978">&#34;example.com&#34;</span>&nbsp;<span class="op" id="7814992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7814997">t</span><span class="op" id="7814998">.</span><span class="ident" id="7814999">Errorf</span><span class="op" id="7815005">(</span><span class="string" id="7815006">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;name&nbsp;constraints:&nbsp;%#v&#34;</span><span class="op" id="7815049">,</span>&nbsp;<span class="ident" id="7815051">test</span><span class="op" id="7815055">.</span><span class="ident" id="7815056">name</span><span class="op" id="7815060">,</span>&nbsp;<span class="ident" id="7815062">cert</span><span class="op" id="7815066">.</span><span class="ident" id="7815067">PermittedDNSDomains</span><span class="op" id="7815086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7815090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7815095">if</span>&nbsp;<span class="ident" id="7815098">cert</span><span class="op" id="7815102">.</span><span class="ident" id="7815103">Subject</span><span class="op" id="7815110">.</span><span class="ident" id="7815111">CommonName</span>&nbsp;<span class="op" id="7815122">!=</span>&nbsp;<span class="ident" id="7815125">commonName</span>&nbsp;<span class="op" id="7815136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7815141">t</span><span class="op" id="7815142">.</span><span class="ident" id="7815143">Errorf</span><span class="op" id="7815149">(</span><span class="string" id="7815150">&#34;%s:&nbsp;subject&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7815222">,</span>&nbsp;<span class="ident" id="7815224">test</span><span class="op" id="7815228">.</span><span class="ident" id="7815229">name</span><span class="op" id="7815233">,</span>&nbsp;<span class="ident" id="7815235">cert</span><span class="op" id="7815239">.</span><span class="ident" id="7815240">Subject</span><span class="op" id="7815247">.</span><span class="ident" id="7815248">CommonName</span><span class="op" id="7815258">,</span>&nbsp;<span class="ident" id="7815260">commonName</span><span class="op" id="7815270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7815274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7815279">if</span>&nbsp;<span class="ident" id="7815282">cert</span><span class="op" id="7815286">.</span><span class="ident" id="7815287">Issuer</span><span class="op" id="7815293">.</span><span class="ident" id="7815294">CommonName</span>&nbsp;<span class="op" id="7815305">!=</span>&nbsp;<span class="ident" id="7815308">commonName</span>&nbsp;<span class="op" id="7815319">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7815324">t</span><span class="op" id="7815325">.</span><span class="ident" id="7815326">Errorf</span><span class="op" id="7815332">(</span><span class="string" id="7815333">&#34;%s:&nbsp;issuer&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7815404">,</span>&nbsp;<span class="ident" id="7815406">test</span><span class="op" id="7815410">.</span><span class="ident" id="7815411">name</span><span class="op" id="7815415">,</span>&nbsp;<span class="ident" id="7815417">cert</span><span class="op" id="7815421">.</span><span class="ident" id="7815422">Issuer</span><span class="op" id="7815428">.</span><span class="ident" id="7815429">CommonName</span><span class="op" id="7815439">,</span>&nbsp;<span class="ident" id="7815441">commonName</span><span class="op" id="7815451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7815455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7815460">if</span>&nbsp;<span class="ident" id="7815463">cert</span><span class="op" id="7815467">.</span><span class="ident" id="7815468">SignatureAlgorithm</span>&nbsp;<span class="op" id="7815487">!=</span>&nbsp;<span class="ident" id="7815490">test</span><span class="op" id="7815494">.</span><span class="ident" id="7815495">sigAlgo</span>&nbsp;<span class="op" id="7815503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7815508">t</span><span class="op" id="7815509">.</span><span class="ident" id="7815510">Errorf</span><span class="op" id="7815516">(</span><span class="string" id="7815517">&#34;%s:&nbsp;SignatureAlgorithm&nbsp;wasn&#39;t&nbsp;copied&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7815586">,</span>&nbsp;<span class="ident" id="7815588">test</span><span class="op" id="7815592">.</span><span class="ident" id="7815593">name</span><span class="op" id="7815597">,</span>&nbsp;<span class="ident" id="7815599">cert</span><span class="op" id="7815603">.</span><span class="ident" id="7815604">SignatureAlgorithm</span><span class="op" id="7815622">,</span>&nbsp;<span class="ident" id="7815624">test</span><span class="op" id="7815628">.</span><span class="ident" id="7815629">sigAlgo</span><span class="op" id="7815636">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7815640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7815645">if</span>&nbsp;<span class="op" id="7815648">!</span><span class="ident" id="7815649">reflect</span><span class="op" id="7815656">.</span><span class="ident" id="7815657">DeepEqual</span><span class="op" id="7815666">(</span><span class="ident" id="7815667">cert</span><span class="op" id="7815671">.</span><span class="ident" id="7815672">ExtKeyUsage</span><span class="op" id="7815683">,</span>&nbsp;<span class="ident" id="7815685">testExtKeyUsage</span><span class="op" id="7815700">)</span>&nbsp;<span class="op" id="7815702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7815707">t</span><span class="op" id="7815708">.</span><span class="ident" id="7815709">Errorf</span><span class="op" id="7815715">(</span><span class="string" id="7815716">&#34;%s:&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7815792">,</span>&nbsp;<span class="ident" id="7815794">test</span><span class="op" id="7815798">.</span><span class="ident" id="7815799">name</span><span class="op" id="7815803">,</span>&nbsp;<span class="ident" id="7815805">cert</span><span class="op" id="7815809">.</span><span class="ident" id="7815810">ExtKeyUsage</span><span class="op" id="7815821">,</span>&nbsp;<span class="ident" id="7815823">testExtKeyUsage</span><span class="op" id="7815838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7815842">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7815847">if</span>&nbsp;<span class="op" id="7815850">!</span><span class="ident" id="7815851">reflect</span><span class="op" id="7815858">.</span><span class="ident" id="7815859">DeepEqual</span><span class="op" id="7815868">(</span><span class="ident" id="7815869">cert</span><span class="op" id="7815873">.</span><span class="ident" id="7815874">UnknownExtKeyUsage</span><span class="op" id="7815892">,</span>&nbsp;<span class="ident" id="7815894">testUnknownExtKeyUsage</span><span class="op" id="7815916">)</span>&nbsp;<span class="op" id="7815918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7815923">t</span><span class="op" id="7815924">.</span><span class="ident" id="7815925">Errorf</span><span class="op" id="7815931">(</span><span class="string" id="7815932">&#34;%s:&nbsp;unknown&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7816016">,</span>&nbsp;<span class="ident" id="7816018">test</span><span class="op" id="7816022">.</span><span class="ident" id="7816023">name</span><span class="op" id="7816027">,</span>&nbsp;<span class="ident" id="7816029">cert</span><span class="op" id="7816033">.</span><span class="ident" id="7816034">UnknownExtKeyUsage</span><span class="op" id="7816052">,</span>&nbsp;<span class="ident" id="7816054">testUnknownExtKeyUsage</span><span class="op" id="7816076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7816080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7816085">if</span>&nbsp;<span class="op" id="7816088">!</span><span class="ident" id="7816089">reflect</span><span class="op" id="7816096">.</span><span class="ident" id="7816097">DeepEqual</span><span class="op" id="7816106">(</span><span class="ident" id="7816107">cert</span><span class="op" id="7816111">.</span><span class="ident" id="7816112">OCSPServer</span><span class="op" id="7816122">,</span>&nbsp;<span class="ident" id="7816124">template</span><span class="op" id="7816132">.</span><span class="ident" id="7816133">OCSPServer</span><span class="op" id="7816143">)</span>&nbsp;<span class="op" id="7816145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7816150">t</span><span class="op" id="7816151">.</span><span class="ident" id="7816152">Errorf</span><span class="op" id="7816158">(</span><span class="string" id="7816159">&#34;%s:&nbsp;OCSP&nbsp;servers&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7816215">,</span>&nbsp;<span class="ident" id="7816217">test</span><span class="op" id="7816221">.</span><span class="ident" id="7816222">name</span><span class="op" id="7816226">,</span>&nbsp;<span class="ident" id="7816228">cert</span><span class="op" id="7816232">.</span><span class="ident" id="7816233">OCSPServer</span><span class="op" id="7816243">,</span>&nbsp;<span class="ident" id="7816245">template</span><span class="op" id="7816253">.</span><span class="ident" id="7816254">OCSPServer</span><span class="op" id="7816264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7816268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7816273">if</span>&nbsp;<span class="op" id="7816276">!</span><span class="ident" id="7816277">reflect</span><span class="op" id="7816284">.</span><span class="ident" id="7816285">DeepEqual</span><span class="op" id="7816294">(</span><span class="ident" id="7816295">cert</span><span class="op" id="7816299">.</span><span class="ident" id="7816300">IssuingCertificateURL</span><span class="op" id="7816321">,</span>&nbsp;<span class="ident" id="7816323">template</span><span class="op" id="7816331">.</span><span class="ident" id="7816332">IssuingCertificateURL</span><span class="op" id="7816353">)</span>&nbsp;<span class="op" id="7816355">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7816360">t</span><span class="op" id="7816361">.</span><span class="ident" id="7816362">Errorf</span><span class="op" id="7816368">(</span><span class="string" id="7816369">&#34;%s:&nbsp;Issuing&nbsp;certificate&nbsp;URLs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7816437">,</span>&nbsp;<span class="ident" id="7816439">test</span><span class="op" id="7816443">.</span><span class="ident" id="7816444">name</span><span class="op" id="7816448">,</span>&nbsp;<span class="ident" id="7816450">cert</span><span class="op" id="7816454">.</span><span class="ident" id="7816455">IssuingCertificateURL</span><span class="op" id="7816476">,</span>&nbsp;<span class="ident" id="7816478">template</span><span class="op" id="7816486">.</span><span class="ident" id="7816487">IssuingCertificateURL</span><span class="op" id="7816508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7816512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7816517">if</span>&nbsp;<span class="op" id="7816520">!</span><span class="ident" id="7816521">reflect</span><span class="op" id="7816528">.</span><span class="ident" id="7816529">DeepEqual</span><span class="op" id="7816538">(</span><span class="ident" id="7816539">cert</span><span class="op" id="7816543">.</span><span class="ident" id="7816544">DNSNames</span><span class="op" id="7816552">,</span>&nbsp;<span class="ident" id="7816554">template</span><span class="op" id="7816562">.</span><span class="ident" id="7816563">DNSNames</span><span class="op" id="7816571">)</span>&nbsp;<span class="op" id="7816573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7816578">t</span><span class="op" id="7816579">.</span><span class="ident" id="7816580">Errorf</span><span class="op" id="7816586">(</span><span class="string" id="7816587">&#34;%s:&nbsp;SAN&nbsp;DNS&nbsp;names&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7816644">,</span>&nbsp;<span class="ident" id="7816646">test</span><span class="op" id="7816650">.</span><span class="ident" id="7816651">name</span><span class="op" id="7816655">,</span>&nbsp;<span class="ident" id="7816657">cert</span><span class="op" id="7816661">.</span><span class="ident" id="7816662">DNSNames</span><span class="op" id="7816670">,</span>&nbsp;<span class="ident" id="7816672">template</span><span class="op" id="7816680">.</span><span class="ident" id="7816681">DNSNames</span><span class="op" id="7816689">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7816693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7816698">if</span>&nbsp;<span class="op" id="7816701">!</span><span class="ident" id="7816702">reflect</span><span class="op" id="7816709">.</span><span class="ident" id="7816710">DeepEqual</span><span class="op" id="7816719">(</span><span class="ident" id="7816720">cert</span><span class="op" id="7816724">.</span><span class="ident" id="7816725">EmailAddresses</span><span class="op" id="7816739">,</span>&nbsp;<span class="ident" id="7816741">template</span><span class="op" id="7816749">.</span><span class="ident" id="7816750">EmailAddresses</span><span class="op" id="7816764">)</span>&nbsp;<span class="op" id="7816766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7816771">t</span><span class="op" id="7816772">.</span><span class="ident" id="7816773">Errorf</span><span class="op" id="7816779">(</span><span class="string" id="7816780">&#34;%s:&nbsp;SAN&nbsp;emails&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7816834">,</span>&nbsp;<span class="ident" id="7816836">test</span><span class="op" id="7816840">.</span><span class="ident" id="7816841">name</span><span class="op" id="7816845">,</span>&nbsp;<span class="ident" id="7816847">cert</span><span class="op" id="7816851">.</span><span class="ident" id="7816852">EmailAddresses</span><span class="op" id="7816866">,</span>&nbsp;<span class="ident" id="7816868">template</span><span class="op" id="7816876">.</span><span class="ident" id="7816877">EmailAddresses</span><span class="op" id="7816891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7816895">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7816900">if</span>&nbsp;<span class="op" id="7816903">!</span><span class="ident" id="7816904">reflect</span><span class="op" id="7816911">.</span><span class="ident" id="7816912">DeepEqual</span><span class="op" id="7816921">(</span><span class="ident" id="7816922">cert</span><span class="op" id="7816926">.</span><span class="ident" id="7816927">IPAddresses</span><span class="op" id="7816938">,</span>&nbsp;<span class="ident" id="7816940">template</span><span class="op" id="7816948">.</span><span class="ident" id="7816949">IPAddresses</span><span class="op" id="7816960">)</span>&nbsp;<span class="op" id="7816962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7816967">t</span><span class="op" id="7816968">.</span><span class="ident" id="7816969">Errorf</span><span class="op" id="7816975">(</span><span class="string" id="7816976">&#34;%s:&nbsp;SAN&nbsp;IPs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7817027">,</span>&nbsp;<span class="ident" id="7817029">test</span><span class="op" id="7817033">.</span><span class="ident" id="7817034">name</span><span class="op" id="7817038">,</span>&nbsp;<span class="ident" id="7817040">cert</span><span class="op" id="7817044">.</span><span class="ident" id="7817045">IPAddresses</span><span class="op" id="7817056">,</span>&nbsp;<span class="ident" id="7817058">template</span><span class="op" id="7817066">.</span><span class="ident" id="7817067">IPAddresses</span><span class="op" id="7817078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7817082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7817087">if</span>&nbsp;<span class="op" id="7817090">!</span><span class="ident" id="7817091">reflect</span><span class="op" id="7817098">.</span><span class="ident" id="7817099">DeepEqual</span><span class="op" id="7817108">(</span><span class="ident" id="7817109">cert</span><span class="op" id="7817113">.</span><span class="ident" id="7817114">CRLDistributionPoints</span><span class="op" id="7817135">,</span>&nbsp;<span class="ident" id="7817137">template</span><span class="op" id="7817145">.</span><span class="ident" id="7817146">CRLDistributionPoints</span><span class="op" id="7817167">)</span>&nbsp;<span class="op" id="7817169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7817174">t</span><span class="op" id="7817175">.</span><span class="ident" id="7817176">Errorf</span><span class="op" id="7817182">(</span><span class="string" id="7817183">&#34;%s:&nbsp;CRL&nbsp;distribution&nbsp;points&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7817250">,</span>&nbsp;<span class="ident" id="7817252">test</span><span class="op" id="7817256">.</span><span class="ident" id="7817257">name</span><span class="op" id="7817261">,</span>&nbsp;<span class="ident" id="7817263">cert</span><span class="op" id="7817267">.</span><span class="ident" id="7817268">CRLDistributionPoints</span><span class="op" id="7817289">,</span>&nbsp;<span class="ident" id="7817291">template</span><span class="op" id="7817299">.</span><span class="ident" id="7817300">CRLDistributionPoints</span><span class="op" id="7817321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7817325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7817330">if</span>&nbsp;<span class="op" id="7817333">!</span><span class="ident" id="7817334">bytes</span><span class="op" id="7817339">.</span><span class="ident" id="7817340">Equal</span><span class="op" id="7817345">(</span><span class="ident" id="7817346">cert</span><span class="op" id="7817350">.</span><span class="ident" id="7817351">SubjectKeyId</span><span class="op" id="7817363">,</span>&nbsp;<span class="op" id="7817365">[</span><span class="op" id="7817366">]</span><span class="builtintype" id="7817367">byte</span><span class="op" id="7817371">{</span><span class="num" id="7817372">4</span><span class="op" id="7817373">,</span>&nbsp;<span class="num" id="7817375">3</span><span class="op" id="7817376">,</span>&nbsp;<span class="num" id="7817378">2</span><span class="op" id="7817379">,</span>&nbsp;<span class="num" id="7817381">1</span><span class="op" id="7817382">}</span><span class="op" id="7817383">)</span>&nbsp;<span class="op" id="7817385">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7817390">t</span><span class="op" id="7817391">.</span><span class="ident" id="7817392">Errorf</span><span class="op" id="7817398">(</span><span class="string" id="7817399">&#34;%s:&nbsp;ExtraExtensions&nbsp;didn&#39;t&nbsp;override&nbsp;SubjectKeyId&#34;</span><span class="op" id="7817449">,</span>&nbsp;<span class="ident" id="7817451">test</span><span class="op" id="7817455">.</span><span class="ident" id="7817456">name</span><span class="op" id="7817460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7817464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7817469">if</span>&nbsp;<span class="ident" id="7817472">bytes</span><span class="op" id="7817477">.</span><span class="ident" id="7817478">Index</span><span class="op" id="7817483">(</span><span class="ident" id="7817484">derBytes</span><span class="op" id="7817492">,</span>&nbsp;<span class="ident" id="7817494">extraExtensionData</span><span class="op" id="7817512">)</span>&nbsp;<span class="op" id="7817514">==</span>&nbsp;<span class="op" id="7817517">-</span><span class="num" id="7817518">1</span>&nbsp;<span class="op" id="7817520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7817525">t</span><span class="op" id="7817526">.</span><span class="ident" id="7817527">Errorf</span><span class="op" id="7817533">(</span><span class="string" id="7817534">&#34;%s:&nbsp;didn&#39;t&nbsp;find&nbsp;extra&nbsp;extension&nbsp;in&nbsp;DER&nbsp;output&#34;</span><span class="op" id="7817581">,</span>&nbsp;<span class="ident" id="7817583">test</span><span class="op" id="7817587">.</span><span class="ident" id="7817588">name</span><span class="op" id="7817592">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7817596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7817601">if</span>&nbsp;<span class="ident" id="7817604">test</span><span class="op" id="7817608">.</span><span class="ident" id="7817609">checkSig</span>&nbsp;<span class="op" id="7817618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7817623">err</span>&nbsp;<span class="op" id="7817627">=</span>&nbsp;<span class="ident" id="7817629">cert</span><span class="op" id="7817633">.</span><span class="ident" id="7817634">CheckSignatureFrom</span><span class="op" id="7817652">(</span><span class="ident" id="7817653">cert</span><span class="op" id="7817657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7817662">if</span>&nbsp;<span class="ident" id="7817665">err</span>&nbsp;<span class="op" id="7817669">!=</span>&nbsp;<span class="ident" id="7817672">nil</span>&nbsp;<span class="op" id="7817676">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7817682">t</span><span class="op" id="7817683">.</span><span class="ident" id="7817684">Errorf</span><span class="op" id="7817690">(</span><span class="string" id="7817691">&#34;%s:&nbsp;signature&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7817730">,</span>&nbsp;<span class="ident" id="7817732">test</span><span class="op" id="7817736">.</span><span class="ident" id="7817737">name</span><span class="op" id="7817741">,</span>&nbsp;<span class="ident" id="7817743">err</span><span class="op" id="7817746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7817751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7817755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7817758">}</span><br>
<span class="lineno"></span><span class="op" id="7817760">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="7817763">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA1&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno"></span><span class="keyword" id="7817824">var</span>&nbsp;<span class="ident" id="7817828">ecdsaSHA1CertPem</span>&nbsp;<span class="op" id="7817845">=</span>&nbsp;<span class="string" id="7817847">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDjCCAbUCCQDF6SfN0nsnrjAJBgcqhkjOPQQBMIGPMQswCQYDVQQGEwJVUzET<br>
<span class="lineno">455</span>MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNTW91bnRhaW4gVmlldzEVMBMG<br>
<span class="lineno"></span>A1UECgwMR29vZ2xlLCBJbmMuMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIwMjAyMDUw<br>
<span class="lineno"></span>WhcNMjIwNTE4MjAyMDUwWjCBjzELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTATBgNVBAoMDEdvb2dsZSwg<br>
<span class="lineno">460</span>SW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAhBgkqhkiG9w0BCQEWFGdv<br>
<span class="lineno"></span>bGFuZy1kZXZAZ21haWwuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/Wgn<br>
<span class="lineno"></span>WQDo5+bz71T0327ERgd5SDDXFbXLpzIZDXTkjpe8QTEbsF+ezsQfrekrpDPC4Cd3<br>
<span class="lineno"></span>P9LY0tG+aI8IyVKdUjAJBgcqhkjOPQQBA0gAMEUCIGlsqMcRqWVIWTD6wXwe6Jk2<br>
<span class="lineno"></span>DKxL46r/FLgJYnzBEH99AiEA3fBouObsvV1R3oVkb4BQYnD4/4LeId6lAT43YvyV<br>
<span class="lineno">465</span>a/A=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7818626">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno">470</span><span class="keyword" id="7818689">var</span>&nbsp;<span class="ident" id="7818693">ecdsaSHA256p256CertPem</span>&nbsp;<span class="op" id="7818716">=</span>&nbsp;<span class="string" id="7818718">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDzCCAbYCCQDlsuMWvgQzhTAKBggqhkjOPQQDAjCBjzELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTAT<br>
<span class="lineno"></span>BgNVBAoMDEdvb2dsZSwgSW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAh<br>
<span class="lineno">475</span>BgkqhkiG9w0BCQEWFGdvbGFuZy1kZXZAZ21haWwuY29tMB4XDTEyMDUyMTAwMTkx<br>
<span class="lineno"></span>NloXDTIyMDUxOTAwMTkxNlowgY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxp<br>
<span class="lineno"></span>Zm9ybmlhMRYwFAYDVQQHDA1Nb3VudGFpbiBWaWV3MRUwEwYDVQQKDAxHb29nbGUs<br>
<span class="lineno"></span>IEluYy4xFzAVBgNVBAMMDnd3dy5nb29nbGUuY29tMSMwIQYJKoZIhvcNAQkBFhRn<br>
<span class="lineno"></span>b2xhbmctZGV2QGdtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABPMt<br>
<span class="lineno">480</span>2ErhxAty5EJRu9yM+MTy+hUXm3pdW1ensAv382KoGExSXAFWP7pjJnNtHO+XSwVm<br>
<span class="lineno"></span>YNtqjcAGFKpweoN//kQwCgYIKoZIzj0EAwIDRwAwRAIgIYSaUA/IB81gjbIw/hUV<br>
<span class="lineno"></span>70twxJr5EcgOo0hLp3Jm+EYCIFDO3NNcgmURbJ1kfoS3N/0O+irUtoPw38YoNkqJ<br>
<span class="lineno"></span>h5wi<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno">485</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7819497">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp384r1</span><br>
<span class="lineno"></span><span class="keyword" id="7819560">var</span>&nbsp;<span class="ident" id="7819564">ecdsaSHA256p384CertPem</span>&nbsp;<span class="op" id="7819587">=</span>&nbsp;<span class="string" id="7819589">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno">490</span>MIICSjCCAdECCQDje/no7mXkVzAKBggqhkjOPQQDAjCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMDYxMDM0<br>
<span class="lineno"></span>WhcNMjIwNTE5MDYxMDM0WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno">495</span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno"></span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARRuzRNIKRK<br>
<span class="lineno"></span>jIktEmXanNmrTR/q/FaHXLhWRZ6nHWe26Fw7Rsrbk+VjGy4vfWtNn7xSFKrOu5ze<br>
<span class="lineno"></span>qxKnmE0h5E480MNgrUiRkaGO2GMJJVmxx20aqkXOk59U8yGA4CghE6MwCgYIKoZI<br>
<span class="lineno">500</span>zj0EAwIDZwAwZAIwBZEN8gvmRmfeP/9C1PRLzODIY4JqWub2PLRT4mv9GU+yw3Gr<br>
<span class="lineno"></span>PU9A3CHMdEcdw/MEAjBBO1lId8KOCh9UZunsSMfqXiVurpzmhWd6VYZ/32G+M+Mh<br>
<span class="lineno"></span>3yILeYQzllt/g0rKVRk=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="7820449">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA384&nbsp;&amp;&nbsp;secp521r1</span><br>
<span class="lineno"></span><span class="keyword" id="7820512">var</span>&nbsp;<span class="ident" id="7820516">ecdsaSHA384p521CertPem</span>&nbsp;<span class="op" id="7820539">=</span>&nbsp;<span class="string" id="7820541">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICljCCAfcCCQDhp1AFD/ahKjAKBggqhkjOPQQDAzCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno">510</span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMTUwNDI5<br>
<span class="lineno"></span>WhcNMjIwNTE5MTUwNDI5WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno">515</span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABACqx9Rv<br>
<span class="lineno"></span>IssRs1LWYcNN+WffwlHw4Tv3y8/LIAA9MF1ZScIonU9nRMxt4a2uGJVCPDw6JHpz<br>
<span class="lineno"></span>PaYc0E9puLoE9AfKpwFr59Jkot7dBg55SKPEFkddoip/rvmN7NPAWjMBirOwjOkm<br>
<span class="lineno"></span>8FPthvPhGPqsu9AvgVuHu3PosWiHGNrhh379pva8MzAKBggqhkjOPQQDAwOBjAAw<br>
<span class="lineno">520</span>gYgCQgEHNmswkUdPpHqrVxp9PvLVl+xxPuHBkT+75z9JizyxtqykHQo9Uh6SWCYH<br>
<span class="lineno"></span>BF9KLolo01wMt8DjoYP5Fb3j5MH7xwJCAbWZzTOp4l4DPkIvAh4LeC4VWbwPPyqh<br>
<span class="lineno"></span>kBg71w/iEcSY3wUKgHGcJJrObZw7wys91I5kENljqw/Samdr3ka+jBJa<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="7821502">var</span>&nbsp;<span class="ident" id="7821506">ecdsaTests</span>&nbsp;<span class="op" id="7821517">=</span>&nbsp;<span class="op" id="7821519">[</span><span class="op" id="7821520">]</span><span class="keyword" id="7821521">struct</span>&nbsp;<span class="op" id="7821528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821531">sigAlgo</span>&nbsp;<span class="ident" id="7821539">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821559">pemCert</span>&nbsp;<span class="builtintype" id="7821567">string</span><br>
<span class="lineno"></span><span class="op" id="7821574">}</span><span class="op" id="7821575">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821578">{</span><span class="ident" id="7821579">ECDSAWithSHA1</span><span class="op" id="7821592">,</span>&nbsp;<span class="ident" id="7821594">ecdsaSHA1CertPem</span><span class="op" id="7821610">}</span><span class="op" id="7821611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821614">{</span><span class="ident" id="7821615">ECDSAWithSHA256</span><span class="op" id="7821630">,</span>&nbsp;<span class="ident" id="7821632">ecdsaSHA256p256CertPem</span><span class="op" id="7821654">}</span><span class="op" id="7821655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821658">{</span><span class="ident" id="7821659">ECDSAWithSHA256</span><span class="op" id="7821674">,</span>&nbsp;<span class="ident" id="7821676">ecdsaSHA256p384CertPem</span><span class="op" id="7821698">}</span><span class="op" id="7821699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821702">{</span><span class="ident" id="7821703">ECDSAWithSHA384</span><span class="op" id="7821718">,</span>&nbsp;<span class="ident" id="7821720">ecdsaSHA384p521CertPem</span><span class="op" id="7821742">}</span><span class="op" id="7821743">,</span><br>
<span class="lineno"></span><span class="op" id="7821745">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="7821748">func</span>&nbsp;<span class="ident" id="7821753">TestECDSA</span><span class="op" id="7821762">(</span><span class="ident" id="7821763">t</span>&nbsp;<span class="op" id="7821765">*</span><span class="ident" id="7821766">testing</span><span class="op" id="7821773">.</span><span class="ident" id="7821774">T</span><span class="op" id="7821775">)</span>&nbsp;<span class="op" id="7821777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7821780">for</span>&nbsp;<span class="ident" id="7821784">i</span><span class="op" id="7821785">,</span>&nbsp;<span class="ident" id="7821787">test</span>&nbsp;<span class="op" id="7821792">:=</span>&nbsp;<span class="keyword" id="7821795">range</span>&nbsp;<span class="ident" id="7821801">ecdsaTests</span>&nbsp;<span class="op" id="7821812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821816">pemBlock</span><span class="op" id="7821824">,</span>&nbsp;<span class="ident" id="7821826">_</span>&nbsp;<span class="op" id="7821828">:=</span>&nbsp;<span class="ident" id="7821831">pem</span><span class="op" id="7821834">.</span><span class="ident" id="7821835">Decode</span><span class="op" id="7821841">(</span><span class="op" id="7821842">[</span><span class="op" id="7821843">]</span><span class="builtintype" id="7821844">byte</span><span class="op" id="7821848">(</span><span class="ident" id="7821849">test</span><span class="op" id="7821853">.</span><span class="ident" id="7821854">pemCert</span><span class="op" id="7821861">)</span><span class="op" id="7821862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821866">cert</span><span class="op" id="7821870">,</span>&nbsp;<span class="ident" id="7821872">err</span>&nbsp;<span class="op" id="7821876">:=</span>&nbsp;<span class="ident" id="7821879">ParseCertificate</span><span class="op" id="7821895">(</span><span class="ident" id="7821896">pemBlock</span><span class="op" id="7821904">.</span><span class="ident" id="7821905">Bytes</span><span class="op" id="7821910">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7821914">if</span>&nbsp;<span class="ident" id="7821917">err</span>&nbsp;<span class="op" id="7821921">!=</span>&nbsp;<span class="ident" id="7821924">nil</span>&nbsp;<span class="op" id="7821928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821933">t</span><span class="op" id="7821934">.</span><span class="ident" id="7821935">Errorf</span><span class="op" id="7821941">(</span><span class="string" id="7821942">&#34;%d:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7821979">,</span>&nbsp;<span class="ident" id="7821981">i</span><span class="op" id="7821982">,</span>&nbsp;<span class="ident" id="7821984">err</span><span class="op" id="7821987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7821992">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7822007">if</span>&nbsp;<span class="ident" id="7822010">sa</span>&nbsp;<span class="op" id="7822013">:=</span>&nbsp;<span class="ident" id="7822016">cert</span><span class="op" id="7822020">.</span><span class="ident" id="7822021">SignatureAlgorithm</span><span class="op" id="7822039">;</span>&nbsp;<span class="ident" id="7822041">sa</span>&nbsp;<span class="op" id="7822044">!=</span>&nbsp;<span class="ident" id="7822047">test</span><span class="op" id="7822051">.</span><span class="ident" id="7822052">sigAlgo</span>&nbsp;<span class="op" id="7822060">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822065">t</span><span class="op" id="7822066">.</span><span class="ident" id="7822067">Errorf</span><span class="op" id="7822073">(</span><span class="string" id="7822074">&#34;%d:&nbsp;signature&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7822114">,</span>&nbsp;<span class="ident" id="7822116">i</span><span class="op" id="7822117">,</span>&nbsp;<span class="ident" id="7822119">sa</span><span class="op" id="7822121">,</span>&nbsp;<span class="ident" id="7822123">test</span><span class="op" id="7822127">.</span><span class="ident" id="7822128">sigAlgo</span><span class="op" id="7822135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7822143">if</span>&nbsp;<span class="ident" id="7822146">parsedKey</span><span class="op" id="7822155">,</span>&nbsp;<span class="ident" id="7822157">ok</span>&nbsp;<span class="op" id="7822160">:=</span>&nbsp;<span class="ident" id="7822163">cert</span><span class="op" id="7822167">.</span><span class="ident" id="7822168">PublicKey</span><span class="op" id="7822177">.</span><span class="op" id="7822178">(</span><span class="op" id="7822179">*</span><span class="ident" id="7822180">ecdsa</span><span class="op" id="7822185">.</span><span class="ident" id="7822186">PublicKey</span><span class="op" id="7822195">)</span><span class="op" id="7822196">;</span>&nbsp;<span class="op" id="7822198">!</span><span class="ident" id="7822199">ok</span>&nbsp;<span class="op" id="7822202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822207">t</span><span class="op" id="7822208">.</span><span class="ident" id="7822209">Errorf</span><span class="op" id="7822215">(</span><span class="string" id="7822216">&#34;%d:&nbsp;wanted&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key&nbsp;but&nbsp;found:&nbsp;%#v&#34;</span><span class="op" id="7822263">,</span>&nbsp;<span class="ident" id="7822265">i</span><span class="op" id="7822266">,</span>&nbsp;<span class="ident" id="7822268">parsedKey</span><span class="op" id="7822277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822281">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7822285">if</span>&nbsp;<span class="ident" id="7822288">pka</span>&nbsp;<span class="op" id="7822292">:=</span>&nbsp;<span class="ident" id="7822295">cert</span><span class="op" id="7822299">.</span><span class="ident" id="7822300">PublicKeyAlgorithm</span><span class="op" id="7822318">;</span>&nbsp;<span class="ident" id="7822320">pka</span>&nbsp;<span class="op" id="7822324">!=</span>&nbsp;<span class="ident" id="7822327">ECDSA</span>&nbsp;<span class="op" id="7822333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822338">t</span><span class="op" id="7822339">.</span><span class="ident" id="7822340">Errorf</span><span class="op" id="7822346">(</span><span class="string" id="7822347">&#34;%d:&nbsp;public&nbsp;key&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;ECDSA&#34;</span><span class="op" id="7822391">,</span>&nbsp;<span class="ident" id="7822393">i</span><span class="op" id="7822394">,</span>&nbsp;<span class="ident" id="7822396">pka</span><span class="op" id="7822399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7822407">if</span>&nbsp;<span class="ident" id="7822410">err</span>&nbsp;<span class="op" id="7822414">=</span>&nbsp;<span class="ident" id="7822416">cert</span><span class="op" id="7822420">.</span><span class="ident" id="7822421">CheckSignatureFrom</span><span class="op" id="7822439">(</span><span class="ident" id="7822440">cert</span><span class="op" id="7822444">)</span><span class="op" id="7822445">;</span>&nbsp;<span class="ident" id="7822447">err</span>&nbsp;<span class="op" id="7822451">!=</span>&nbsp;<span class="ident" id="7822454">nil</span>&nbsp;<span class="op" id="7822458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822463">t</span><span class="op" id="7822464">.</span><span class="ident" id="7822465">Errorf</span><span class="op" id="7822471">(</span><span class="string" id="7822472">&#34;%d:&nbsp;certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7822513">,</span>&nbsp;<span class="ident" id="7822515">i</span><span class="op" id="7822516">,</span>&nbsp;<span class="ident" id="7822518">err</span><span class="op" id="7822521">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822528">}</span><br>
<span class="lineno"></span><span class="op" id="7822530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7822533">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;DSA&nbsp;with&nbsp;SHA1</span><br>
<span class="lineno">560</span><span class="keyword" id="7822580">var</span>&nbsp;<span class="ident" id="7822584">dsaCertPem</span>&nbsp;<span class="op" id="7822595">=</span>&nbsp;<span class="string" id="7822597">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIEDTCCA82gAwIBAgIJALHPghaoxeDhMAkGByqGSM44BAMweTELMAkGA1UEBhMC<br>
<span class="lineno"></span>VVMxCzAJBgNVBAgTAk5DMQ8wDQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2ds<br>
<span class="lineno"></span>ZSwgSW5jMRIwEAYDVQQDEwlKb24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFs<br>
<span class="lineno"></span>bGllQGdvb2dsZS5jb20wHhcNMTEwNTE0MDMwMTQ1WhcNMTEwNjEzMDMwMTQ1WjB5<br>
<span class="lineno">565</span>MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTkMxDzANBgNVBAcTBk5ld3RvbjEUMBIG<br>
<span class="lineno"></span>A1UEChMLR29vZ2xlLCBJbmMxEjAQBgNVBAMTCUpvbiBBbGxpZTEiMCAGCSqGSIb3<br>
<span class="lineno"></span>DQEJARYTam9uYWxsaWVAZ29vZ2xlLmNvbTCCAbcwggEsBgcqhkjOOAQBMIIBHwKB<br>
<span class="lineno"></span>gQC8hLUnQ7FpFYu4WXTj6DKvXvz8QrJkNJCVMTpKAT7uBpobk32S5RrPKXocd4gN<br>
<span class="lineno"></span>8lyGB9ggS03EVlEwXvSmO0DH2MQtke2jl9j1HLydClMf4sbx5V6TV9IFw505U1iW<br>
<span class="lineno">570</span>jL7awRMgxge+FsudtJK254FjMFo03ZnOQ8ZJJ9E6AEDrlwIVAJpnBn9moyP11Ox5<br>
<span class="lineno"></span>Asc/5dnjb6dPAoGBAJFHd4KVv1iTVCvEG6gGiYop5DJh28hUQcN9kul+2A0yPUSC<br>
<span class="lineno"></span>X93oN00P8Vh3eYgSaCWZsha7zDG53MrVJ0Zf6v/X/CoZNhLldeNOepivTRAzn+Rz<br>
<span class="lineno"></span>kKUYy5l1sxYLHQKF0UGNCXfFKZT0PCmgU+PWhYNBBMn6/cIh44vp85ideo5CA4GE<br>
<span class="lineno"></span>AAKBgFmifCafzeRaohYKXJgMGSEaggCVCRq5xdyDCat+wbOkjC4mfG01/um3G8u5<br>
<span class="lineno">575</span>LxasjlWRKTR/tcAL7t0QuokVyQaYdVypZXNaMtx1db7YBuHjj3aP+8JOQRI9xz8c<br>
<span class="lineno"></span>bp5NDJ5pISiFOv4p3GZfqZPcqckDt78AtkQrmnal2txhhjF6o4HeMIHbMB0GA1Ud<br>
<span class="lineno"></span>DgQWBBQVyyr7hO11ZFFpWX50298Sa3V+rzCBqwYDVR0jBIGjMIGggBQVyyr7hO11<br>
<span class="lineno"></span>ZFFpWX50298Sa3V+r6F9pHsweTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk5DMQ8w<br>
<span class="lineno"></span>DQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2dsZSwgSW5jMRIwEAYDVQQDEwlK<br>
<span class="lineno">580</span>b24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFsbGllQGdvb2dsZS5jb22CCQCx<br>
<span class="lineno"></span>z4IWqMXg4TAMBgNVHRMEBTADAQH/MAkGByqGSM44BAMDLwAwLAIUPtn/5j8Q1jJI<br>
<span class="lineno"></span>7ggOIsgrhgUdjGQCFCsmDq1H11q9+9Wp9IMeGrTSKHIM<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span><span class="keyword" id="7824065">func</span>&nbsp;<span class="ident" id="7824070">TestParseCertificateWithDsaPublicKey</span><span class="op" id="7824106">(</span><span class="ident" id="7824107">t</span>&nbsp;<span class="op" id="7824109">*</span><span class="ident" id="7824110">testing</span><span class="op" id="7824117">.</span><span class="ident" id="7824118">T</span><span class="op" id="7824119">)</span>&nbsp;<span class="op" id="7824121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824124">expectedKey</span>&nbsp;<span class="op" id="7824136">:=</span>&nbsp;<span class="op" id="7824139">&amp;</span><span class="ident" id="7824140">dsa</span><span class="op" id="7824143">.</span><span class="ident" id="7824144">PublicKey</span><span class="op" id="7824153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824157">Parameters</span><span class="op" id="7824167">:</span>&nbsp;<span class="ident" id="7824169">dsa</span><span class="op" id="7824172">.</span><span class="ident" id="7824173">Parameters</span><span class="op" id="7824183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824188">P</span><span class="op" id="7824189">:</span>&nbsp;<span class="ident" id="7824191">bigFromHexString</span><span class="op" id="7824207">(</span><span class="string" id="7824208">&#34;00BC84B52743B169158BB85974E3E832AF5EFCFC42B264349095313A4A013EEE069A1B937D92E51ACF297A1C77880DF25C8607D8204B4DC45651305EF4A63B40C7D8C42D91EDA397D8F51CBC9D0A531FE2C6F1E55E9357D205C39D395358968CBEDAC11320C607BE16CB9DB492B6E78163305A34DD99CE43C64927D13A0040EB97&#34;</span><span class="op" id="7824468">)</span><span class="op" id="7824469">,</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824474">Q</span><span class="op" id="7824475">:</span>&nbsp;<span class="ident" id="7824477">bigFromHexString</span><span class="op" id="7824493">(</span><span class="string" id="7824494">&#34;009A67067F66A323F5D4EC7902C73FE5D9E36FA74F&#34;</span><span class="op" id="7824538">)</span><span class="op" id="7824539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824544">G</span><span class="op" id="7824545">:</span>&nbsp;<span class="ident" id="7824547">bigFromHexString</span><span class="op" id="7824563">(</span><span class="string" id="7824564">&#34;009147778295BF5893542BC41BA806898A29E43261DBC85441C37D92E97ED80D323D44825FDDE8374D0FF15877798812682599B216BBCC31B9DCCAD527465FEAFFD7FC2A193612E575E34E7A98AF4D10339FE47390A518CB9975B3160B1D0285D1418D0977C52994F43C29A053E3D685834104C9FAFDC221E38BE9F3989D7A8E42&#34;</span><span class="op" id="7824824">)</span><span class="op" id="7824825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7824829">}</span><span class="op" id="7824830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824834">Y</span><span class="op" id="7824835">:</span>&nbsp;<span class="ident" id="7824837">bigFromHexString</span><span class="op" id="7824853">(</span><span class="string" id="7824854">&#34;59A27C269FCDE45AA2160A5C980C19211A820095091AB9C5DC8309AB7EC1B3A48C2E267C6D35FEE9B71BCBB92F16AC8E559129347FB5C00BEEDD10BA8915C90698755CA965735A32DC7575BED806E1E38F768FFBC24E41123DC73F1C6E9E4D0C9E692128853AFE29DC665FA993DCA9C903B7BF00B6442B9A76A5DADC6186317A&#34;</span><span class="op" id="7825112">)</span><span class="op" id="7825113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825116">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825119">pemBlock</span><span class="op" id="7825127">,</span>&nbsp;<span class="ident" id="7825129">_</span>&nbsp;<span class="op" id="7825131">:=</span>&nbsp;<span class="ident" id="7825134">pem</span><span class="op" id="7825137">.</span><span class="ident" id="7825138">Decode</span><span class="op" id="7825144">(</span><span class="op" id="7825145">[</span><span class="op" id="7825146">]</span><span class="builtintype" id="7825147">byte</span><span class="op" id="7825151">(</span><span class="ident" id="7825152">dsaCertPem</span><span class="op" id="7825162">)</span><span class="op" id="7825163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825166">cert</span><span class="op" id="7825170">,</span>&nbsp;<span class="ident" id="7825172">err</span>&nbsp;<span class="op" id="7825176">:=</span>&nbsp;<span class="ident" id="7825179">ParseCertificate</span><span class="op" id="7825195">(</span><span class="ident" id="7825196">pemBlock</span><span class="op" id="7825204">.</span><span class="ident" id="7825205">Bytes</span><span class="op" id="7825210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7825213">if</span>&nbsp;<span class="ident" id="7825216">err</span>&nbsp;<span class="op" id="7825220">!=</span>&nbsp;<span class="ident" id="7825223">nil</span>&nbsp;<span class="op" id="7825227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825231">t</span><span class="op" id="7825232">.</span><span class="ident" id="7825233">Fatalf</span><span class="op" id="7825239">(</span><span class="string" id="7825240">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7825273">,</span>&nbsp;<span class="ident" id="7825275">err</span><span class="op" id="7825278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825281">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7825284">if</span>&nbsp;<span class="ident" id="7825287">cert</span><span class="op" id="7825291">.</span><span class="ident" id="7825292">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="7825311">!=</span>&nbsp;<span class="ident" id="7825314">DSA</span>&nbsp;<span class="op" id="7825318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825322">t</span><span class="op" id="7825323">.</span><span class="ident" id="7825324">Errorf</span><span class="op" id="7825330">(</span><span class="string" id="7825331">&#34;Parsed&nbsp;key&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSA&#34;</span><span class="op" id="7825365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825371">parsedKey</span><span class="op" id="7825380">,</span>&nbsp;<span class="ident" id="7825382">ok</span>&nbsp;<span class="op" id="7825385">:=</span>&nbsp;<span class="ident" id="7825388">cert</span><span class="op" id="7825392">.</span><span class="ident" id="7825393">PublicKey</span><span class="op" id="7825402">.</span><span class="op" id="7825403">(</span><span class="op" id="7825404">*</span><span class="ident" id="7825405">dsa</span><span class="op" id="7825408">.</span><span class="ident" id="7825409">PublicKey</span><span class="op" id="7825418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7825421">if</span>&nbsp;<span class="op" id="7825424">!</span><span class="ident" id="7825425">ok</span>&nbsp;<span class="op" id="7825428">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825432">t</span><span class="op" id="7825433">.</span><span class="ident" id="7825434">Fatalf</span><span class="op" id="7825440">(</span><span class="string" id="7825441">&#34;Parsed&nbsp;key&nbsp;was&nbsp;not&nbsp;a&nbsp;DSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7825475">,</span>&nbsp;<span class="ident" id="7825477">err</span><span class="op" id="7825480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7825486">if</span>&nbsp;<span class="ident" id="7825489">expectedKey</span><span class="op" id="7825500">.</span><span class="ident" id="7825501">Y</span><span class="op" id="7825502">.</span><span class="ident" id="7825503">Cmp</span><span class="op" id="7825506">(</span><span class="ident" id="7825507">parsedKey</span><span class="op" id="7825516">.</span><span class="ident" id="7825517">Y</span><span class="op" id="7825518">)</span>&nbsp;<span class="op" id="7825520">!=</span>&nbsp;<span class="num" id="7825523">0</span>&nbsp;<span class="op" id="7825525">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825530">expectedKey</span><span class="op" id="7825541">.</span><span class="ident" id="7825542">P</span><span class="op" id="7825543">.</span><span class="ident" id="7825544">Cmp</span><span class="op" id="7825547">(</span><span class="ident" id="7825548">parsedKey</span><span class="op" id="7825557">.</span><span class="ident" id="7825558">P</span><span class="op" id="7825559">)</span>&nbsp;<span class="op" id="7825561">!=</span>&nbsp;<span class="num" id="7825564">0</span>&nbsp;<span class="op" id="7825566">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825571">expectedKey</span><span class="op" id="7825582">.</span><span class="ident" id="7825583">Q</span><span class="op" id="7825584">.</span><span class="ident" id="7825585">Cmp</span><span class="op" id="7825588">(</span><span class="ident" id="7825589">parsedKey</span><span class="op" id="7825598">.</span><span class="ident" id="7825599">Q</span><span class="op" id="7825600">)</span>&nbsp;<span class="op" id="7825602">!=</span>&nbsp;<span class="num" id="7825605">0</span>&nbsp;<span class="op" id="7825607">||</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825612">expectedKey</span><span class="op" id="7825623">.</span><span class="ident" id="7825624">G</span><span class="op" id="7825625">.</span><span class="ident" id="7825626">Cmp</span><span class="op" id="7825629">(</span><span class="ident" id="7825630">parsedKey</span><span class="op" id="7825639">.</span><span class="ident" id="7825640">G</span><span class="op" id="7825641">)</span>&nbsp;<span class="op" id="7825643">!=</span>&nbsp;<span class="num" id="7825646">0</span>&nbsp;<span class="op" id="7825648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825652">t</span><span class="op" id="7825653">.</span><span class="ident" id="7825654">Fatal</span><span class="op" id="7825659">(</span><span class="string" id="7825660">&#34;Parsed&nbsp;key&nbsp;differs&nbsp;from&nbsp;expected&nbsp;key&#34;</span><span class="op" id="7825698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825701">}</span><br>
<span class="lineno"></span><span class="op" id="7825703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="7825706">func</span>&nbsp;<span class="ident" id="7825711">TestParseCertificateWithDSASignatureAlgorithm</span><span class="op" id="7825756">(</span><span class="ident" id="7825757">t</span>&nbsp;<span class="op" id="7825759">*</span><span class="ident" id="7825760">testing</span><span class="op" id="7825767">.</span><span class="ident" id="7825768">T</span><span class="op" id="7825769">)</span>&nbsp;<span class="op" id="7825771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825774">pemBlock</span><span class="op" id="7825782">,</span>&nbsp;<span class="ident" id="7825784">_</span>&nbsp;<span class="op" id="7825786">:=</span>&nbsp;<span class="ident" id="7825789">pem</span><span class="op" id="7825792">.</span><span class="ident" id="7825793">Decode</span><span class="op" id="7825799">(</span><span class="op" id="7825800">[</span><span class="op" id="7825801">]</span><span class="builtintype" id="7825802">byte</span><span class="op" id="7825806">(</span><span class="ident" id="7825807">dsaCertPem</span><span class="op" id="7825817">)</span><span class="op" id="7825818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825821">cert</span><span class="op" id="7825825">,</span>&nbsp;<span class="ident" id="7825827">err</span>&nbsp;<span class="op" id="7825831">:=</span>&nbsp;<span class="ident" id="7825834">ParseCertificate</span><span class="op" id="7825850">(</span><span class="ident" id="7825851">pemBlock</span><span class="op" id="7825859">.</span><span class="ident" id="7825860">Bytes</span><span class="op" id="7825865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7825868">if</span>&nbsp;<span class="ident" id="7825871">err</span>&nbsp;<span class="op" id="7825875">!=</span>&nbsp;<span class="ident" id="7825878">nil</span>&nbsp;<span class="op" id="7825882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825886">t</span><span class="op" id="7825887">.</span><span class="ident" id="7825888">Fatalf</span><span class="op" id="7825894">(</span><span class="string" id="7825895">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7825928">,</span>&nbsp;<span class="ident" id="7825930">err</span><span class="op" id="7825933">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7825939">if</span>&nbsp;<span class="ident" id="7825942">cert</span><span class="op" id="7825946">.</span><span class="ident" id="7825947">SignatureAlgorithm</span>&nbsp;<span class="op" id="7825966">!=</span>&nbsp;<span class="ident" id="7825969">DSAWithSHA1</span>&nbsp;<span class="op" id="7825981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825985">t</span><span class="op" id="7825986">.</span><span class="ident" id="7825987">Errorf</span><span class="op" id="7825993">(</span><span class="string" id="7825994">&#34;Parsed&nbsp;signature&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSAWithSHA1&#34;</span><span class="op" id="7826042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7826045">}</span><br>
<span class="lineno"></span><span class="op" id="7826047">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="7826050">func</span>&nbsp;<span class="ident" id="7826055">TestVerifyCertificateWithDSASignature</span><span class="op" id="7826092">(</span><span class="ident" id="7826093">t</span>&nbsp;<span class="op" id="7826095">*</span><span class="ident" id="7826096">testing</span><span class="op" id="7826103">.</span><span class="ident" id="7826104">T</span><span class="op" id="7826105">)</span>&nbsp;<span class="op" id="7826107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826110">pemBlock</span><span class="op" id="7826118">,</span>&nbsp;<span class="ident" id="7826120">_</span>&nbsp;<span class="op" id="7826122">:=</span>&nbsp;<span class="ident" id="7826125">pem</span><span class="op" id="7826128">.</span><span class="ident" id="7826129">Decode</span><span class="op" id="7826135">(</span><span class="op" id="7826136">[</span><span class="op" id="7826137">]</span><span class="builtintype" id="7826138">byte</span><span class="op" id="7826142">(</span><span class="ident" id="7826143">dsaCertPem</span><span class="op" id="7826153">)</span><span class="op" id="7826154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826157">cert</span><span class="op" id="7826161">,</span>&nbsp;<span class="ident" id="7826163">err</span>&nbsp;<span class="op" id="7826167">:=</span>&nbsp;<span class="ident" id="7826170">ParseCertificate</span><span class="op" id="7826186">(</span><span class="ident" id="7826187">pemBlock</span><span class="op" id="7826195">.</span><span class="ident" id="7826196">Bytes</span><span class="op" id="7826201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7826204">if</span>&nbsp;<span class="ident" id="7826207">err</span>&nbsp;<span class="op" id="7826211">!=</span>&nbsp;<span class="ident" id="7826214">nil</span>&nbsp;<span class="op" id="7826218">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826222">t</span><span class="op" id="7826223">.</span><span class="ident" id="7826224">Fatalf</span><span class="op" id="7826230">(</span><span class="string" id="7826231">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7826264">,</span>&nbsp;<span class="ident" id="7826266">err</span><span class="op" id="7826269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7826272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7826275">//&nbsp;test&nbsp;cert&nbsp;is&nbsp;self-signed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7826304">if</span>&nbsp;<span class="ident" id="7826307">err</span>&nbsp;<span class="op" id="7826311">=</span>&nbsp;<span class="ident" id="7826313">cert</span><span class="op" id="7826317">.</span><span class="ident" id="7826318">CheckSignatureFrom</span><span class="op" id="7826336">(</span><span class="ident" id="7826337">cert</span><span class="op" id="7826341">)</span><span class="op" id="7826342">;</span>&nbsp;<span class="ident" id="7826344">err</span>&nbsp;<span class="op" id="7826348">!=</span>&nbsp;<span class="ident" id="7826351">nil</span>&nbsp;<span class="op" id="7826355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826359">t</span><span class="op" id="7826360">.</span><span class="ident" id="7826361">Fatalf</span><span class="op" id="7826367">(</span><span class="string" id="7826368">&#34;DSA&nbsp;Certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7826409">,</span>&nbsp;<span class="ident" id="7826411">err</span><span class="op" id="7826414">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7826417">}</span><br>
<span class="lineno"></span><span class="op" id="7826419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7826422">const</span>&nbsp;<span class="ident" id="7826428">pemCertificate</span>&nbsp;<span class="op" id="7826443">=</span>&nbsp;<span class="string" id="7826445">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB5DCCAZCgAwIBAgIBATALBgkqhkiG9w0BAQUwLTEQMA4GA1UEChMHQWNtZSBDbzEZMBcGA1UE<br>
<span class="lineno">640</span>AxMQdGVzdC5leGFtcGxlLmNvbTAeFw03MDAxMDEwMDE2NDBaFw03MDAxMDIwMzQ2NDBaMC0xEDAO<br>
<span class="lineno"></span>BgNVBAoTB0FjbWUgQ28xGTAXBgNVBAMTEHRlc3QuZXhhbXBsZS5jb20wWjALBgkqhkiG9w0BAQED<br>
<span class="lineno"></span>SwAwSAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0fd7Ai2KW5ToIwzFo<br>
<span class="lineno"></span>fvJcS/STa6HA5gQenRUCAwEAAaOBnjCBmzAOBgNVHQ8BAf8EBAMCAAQwDwYDVR0TAQH/BAUwAwEB<br>
<span class="lineno"></span>/zANBgNVHQ4EBgQEAQIDBDAPBgNVHSMECDAGgAQBAgMEMBsGA1UdEQQUMBKCEHRlc3QuZXhhbXBs<br>
<span class="lineno">645</span>ZS5jb20wDwYDVR0gBAgwBjAEBgIqAzAqBgNVHR4EIzAhoB8wDoIMLmV4YW1wbGUuY29tMA2CC2V4<br>
<span class="lineno"></span>YW1wbGUuY29tMAsGCSqGSIb3DQEBBQNBAHKZKoS1wEQOGhgklx4+/yFYQlnqwKXvar/ZecQvJwui<br>
<span class="lineno"></span>0seMQnwBhwdBkHfVIU2Fu5VUMRyxlf0ZNaDXcpU581k=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----`</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="keyword" id="7827163">func</span>&nbsp;<span class="ident" id="7827168">TestCRLCreation</span><span class="op" id="7827183">(</span><span class="ident" id="7827184">t</span>&nbsp;<span class="op" id="7827186">*</span><span class="ident" id="7827187">testing</span><span class="op" id="7827194">.</span><span class="ident" id="7827195">T</span><span class="op" id="7827196">)</span>&nbsp;<span class="op" id="7827198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827201">block</span><span class="op" id="7827206">,</span>&nbsp;<span class="ident" id="7827208">_</span>&nbsp;<span class="op" id="7827210">:=</span>&nbsp;<span class="ident" id="7827213">pem</span><span class="op" id="7827216">.</span><span class="ident" id="7827217">Decode</span><span class="op" id="7827223">(</span><span class="op" id="7827224">[</span><span class="op" id="7827225">]</span><span class="builtintype" id="7827226">byte</span><span class="op" id="7827230">(</span><span class="ident" id="7827231">pemPrivateKey</span><span class="op" id="7827244">)</span><span class="op" id="7827245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827248">priv</span><span class="op" id="7827252">,</span>&nbsp;<span class="ident" id="7827254">_</span>&nbsp;<span class="op" id="7827256">:=</span>&nbsp;<span class="ident" id="7827259">ParsePKCS1PrivateKey</span><span class="op" id="7827279">(</span><span class="ident" id="7827280">block</span><span class="op" id="7827285">.</span><span class="ident" id="7827286">Bytes</span><span class="op" id="7827291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827294">block</span><span class="op" id="7827299">,</span>&nbsp;<span class="ident" id="7827301">_</span>&nbsp;<span class="op" id="7827303">=</span>&nbsp;<span class="ident" id="7827305">pem</span><span class="op" id="7827308">.</span><span class="ident" id="7827309">Decode</span><span class="op" id="7827315">(</span><span class="op" id="7827316">[</span><span class="op" id="7827317">]</span><span class="builtintype" id="7827318">byte</span><span class="op" id="7827322">(</span><span class="ident" id="7827323">pemCertificate</span><span class="op" id="7827337">)</span><span class="op" id="7827338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827341">cert</span><span class="op" id="7827345">,</span>&nbsp;<span class="ident" id="7827347">_</span>&nbsp;<span class="op" id="7827349">:=</span>&nbsp;<span class="ident" id="7827352">ParseCertificate</span><span class="op" id="7827368">(</span><span class="ident" id="7827369">block</span><span class="op" id="7827374">.</span><span class="ident" id="7827375">Bytes</span><span class="op" id="7827380">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827384">now</span>&nbsp;<span class="op" id="7827388">:=</span>&nbsp;<span class="ident" id="7827391">time</span><span class="op" id="7827395">.</span><span class="ident" id="7827396">Unix</span><span class="op" id="7827400">(</span><span class="num" id="7827401">1000</span><span class="op" id="7827405">,</span>&nbsp;<span class="num" id="7827407">0</span><span class="op" id="7827408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827411">expiry</span>&nbsp;<span class="op" id="7827418">:=</span>&nbsp;<span class="ident" id="7827421">time</span><span class="op" id="7827425">.</span><span class="ident" id="7827426">Unix</span><span class="op" id="7827430">(</span><span class="num" id="7827431">10000</span><span class="op" id="7827436">,</span>&nbsp;<span class="num" id="7827438">0</span><span class="op" id="7827439">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827443">revokedCerts</span>&nbsp;<span class="op" id="7827456">:=</span>&nbsp;<span class="op" id="7827459">[</span><span class="op" id="7827460">]</span><span class="ident" id="7827461">pkix</span><span class="op" id="7827465">.</span><span class="ident" id="7827466">RevokedCertificate</span><span class="op" id="7827484">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827493">SerialNumber</span><span class="op" id="7827505">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7827509">big</span><span class="op" id="7827512">.</span><span class="ident" id="7827513">NewInt</span><span class="op" id="7827519">(</span><span class="num" id="7827520">1</span><span class="op" id="7827521">)</span><span class="op" id="7827522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827527">RevocationTime</span><span class="op" id="7827541">:</span>&nbsp;<span class="ident" id="7827543">now</span><span class="op" id="7827546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827550">}</span><span class="op" id="7827551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827555">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827560">SerialNumber</span><span class="op" id="7827572">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7827576">big</span><span class="op" id="7827579">.</span><span class="ident" id="7827580">NewInt</span><span class="op" id="7827586">(</span><span class="num" id="7827587">42</span><span class="op" id="7827589">)</span><span class="op" id="7827590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827595">RevocationTime</span><span class="op" id="7827609">:</span>&nbsp;<span class="ident" id="7827611">now</span><span class="op" id="7827614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827618">}</span><span class="op" id="7827619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827626">crlBytes</span><span class="op" id="7827634">,</span>&nbsp;<span class="ident" id="7827636">err</span>&nbsp;<span class="op" id="7827640">:=</span>&nbsp;<span class="ident" id="7827643">cert</span><span class="op" id="7827647">.</span><span class="ident" id="7827648">CreateCRL</span><span class="op" id="7827657">(</span><span class="ident" id="7827658">rand</span><span class="op" id="7827662">.</span><span class="ident" id="7827663">Reader</span><span class="op" id="7827669">,</span>&nbsp;<span class="ident" id="7827671">priv</span><span class="op" id="7827675">,</span>&nbsp;<span class="ident" id="7827677">revokedCerts</span><span class="op" id="7827689">,</span>&nbsp;<span class="ident" id="7827691">now</span><span class="op" id="7827694">,</span>&nbsp;<span class="ident" id="7827696">expiry</span><span class="op" id="7827702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7827705">if</span>&nbsp;<span class="ident" id="7827708">err</span>&nbsp;<span class="op" id="7827712">!=</span>&nbsp;<span class="ident" id="7827715">nil</span>&nbsp;<span class="op" id="7827719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827723">t</span><span class="op" id="7827724">.</span><span class="ident" id="7827725">Errorf</span><span class="op" id="7827731">(</span><span class="string" id="7827732">&#34;error&nbsp;creating&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7827756">,</span>&nbsp;<span class="ident" id="7827758">err</span><span class="op" id="7827761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827768">_</span><span class="op" id="7827769">,</span>&nbsp;<span class="ident" id="7827771">err</span>&nbsp;<span class="op" id="7827775">=</span>&nbsp;<span class="ident" id="7827777">ParseDERCRL</span><span class="op" id="7827788">(</span><span class="ident" id="7827789">crlBytes</span><span class="op" id="7827797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7827800">if</span>&nbsp;<span class="ident" id="7827803">err</span>&nbsp;<span class="op" id="7827807">!=</span>&nbsp;<span class="ident" id="7827810">nil</span>&nbsp;<span class="op" id="7827814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827818">t</span><span class="op" id="7827819">.</span><span class="ident" id="7827820">Errorf</span><span class="op" id="7827826">(</span><span class="string" id="7827827">&#34;error&nbsp;reparsing&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7827852">,</span>&nbsp;<span class="ident" id="7827854">err</span><span class="op" id="7827857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827860">}</span><br>
<span class="lineno"></span><span class="op" id="7827862">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7827865">func</span>&nbsp;<span class="ident" id="7827870">fromBase64</span><span class="op" id="7827880">(</span><span class="ident" id="7827881">in</span>&nbsp;<span class="builtintype" id="7827884">string</span><span class="op" id="7827890">)</span>&nbsp;<span class="op" id="7827892">[</span><span class="op" id="7827893">]</span><span class="builtintype" id="7827894">byte</span>&nbsp;<span class="op" id="7827899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827902">out</span>&nbsp;<span class="op" id="7827906">:=</span>&nbsp;<span class="builtinfunc" id="7827909">make</span><span class="op" id="7827913">(</span><span class="op" id="7827914">[</span><span class="op" id="7827915">]</span><span class="builtintype" id="7827916">byte</span><span class="op" id="7827920">,</span>&nbsp;<span class="ident" id="7827922">base64</span><span class="op" id="7827928">.</span><span class="ident" id="7827929">StdEncoding</span><span class="op" id="7827940">.</span><span class="ident" id="7827941">DecodedLen</span><span class="op" id="7827951">(</span><span class="builtinfunc" id="7827952">len</span><span class="op" id="7827955">(</span><span class="ident" id="7827956">in</span><span class="op" id="7827958">)</span><span class="op" id="7827959">)</span><span class="op" id="7827960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827963">n</span><span class="op" id="7827964">,</span>&nbsp;<span class="ident" id="7827966">err</span>&nbsp;<span class="op" id="7827970">:=</span>&nbsp;<span class="ident" id="7827973">base64</span><span class="op" id="7827979">.</span><span class="ident" id="7827980">StdEncoding</span><span class="op" id="7827991">.</span><span class="ident" id="7827992">Decode</span><span class="op" id="7827998">(</span><span class="ident" id="7827999">out</span><span class="op" id="7828002">,</span>&nbsp;<span class="op" id="7828004">[</span><span class="op" id="7828005">]</span><span class="builtintype" id="7828006">byte</span><span class="op" id="7828010">(</span><span class="ident" id="7828011">in</span><span class="op" id="7828013">)</span><span class="op" id="7828014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7828017">if</span>&nbsp;<span class="ident" id="7828020">err</span>&nbsp;<span class="op" id="7828024">!=</span>&nbsp;<span class="ident" id="7828027">nil</span>&nbsp;<span class="op" id="7828031">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7828035">panic</span><span class="op" id="7828040">(</span><span class="string" id="7828041">&#34;failed&nbsp;to&nbsp;base64&nbsp;decode&#34;</span><span class="op" id="7828066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7828069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7828072">return</span>&nbsp;<span class="ident" id="7828079">out</span><span class="op" id="7828082">[</span><span class="op" id="7828083">:</span><span class="ident" id="7828084">n</span><span class="op" id="7828085">]</span><br>
<span class="lineno"></span><span class="op" id="7828087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="7828090">func</span>&nbsp;<span class="ident" id="7828095">TestParseDERCRL</span><span class="op" id="7828110">(</span><span class="ident" id="7828111">t</span>&nbsp;<span class="op" id="7828113">*</span><span class="ident" id="7828114">testing</span><span class="op" id="7828121">.</span><span class="ident" id="7828122">T</span><span class="op" id="7828123">)</span>&nbsp;<span class="op" id="7828125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828128">derBytes</span>&nbsp;<span class="op" id="7828137">:=</span>&nbsp;<span class="ident" id="7828140">fromBase64</span><span class="op" id="7828150">(</span><span class="ident" id="7828151">derCRLBase64</span><span class="op" id="7828163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828166">certList</span><span class="op" id="7828174">,</span>&nbsp;<span class="ident" id="7828176">err</span>&nbsp;<span class="op" id="7828180">:=</span>&nbsp;<span class="ident" id="7828183">ParseDERCRL</span><span class="op" id="7828194">(</span><span class="ident" id="7828195">derBytes</span><span class="op" id="7828203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7828206">if</span>&nbsp;<span class="ident" id="7828209">err</span>&nbsp;<span class="op" id="7828213">!=</span>&nbsp;<span class="ident" id="7828216">nil</span>&nbsp;<span class="op" id="7828220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828224">t</span><span class="op" id="7828225">.</span><span class="ident" id="7828226">Errorf</span><span class="op" id="7828232">(</span><span class="string" id="7828233">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7828252">,</span>&nbsp;<span class="ident" id="7828254">err</span><span class="op" id="7828257">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7828261">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7828269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828272">numCerts</span>&nbsp;<span class="op" id="7828281">:=</span>&nbsp;<span class="builtinfunc" id="7828284">len</span><span class="op" id="7828287">(</span><span class="ident" id="7828288">certList</span><span class="op" id="7828296">.</span><span class="ident" id="7828297">TBSCertList</span><span class="op" id="7828308">.</span><span class="ident" id="7828309">RevokedCertificates</span><span class="op" id="7828328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828331">expected</span>&nbsp;<span class="op" id="7828340">:=</span>&nbsp;<span class="num" id="7828343">88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7828347">if</span>&nbsp;<span class="ident" id="7828350">numCerts</span>&nbsp;<span class="op" id="7828359">!=</span>&nbsp;<span class="ident" id="7828362">expected</span>&nbsp;<span class="op" id="7828371">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828375">t</span><span class="op" id="7828376">.</span><span class="ident" id="7828377">Errorf</span><span class="op" id="7828383">(</span><span class="string" id="7828384">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7828438">,</span>&nbsp;<span class="ident" id="7828440">numCerts</span><span class="op" id="7828448">,</span>&nbsp;<span class="ident" id="7828450">expected</span><span class="op" id="7828458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7828461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7828465">if</span>&nbsp;<span class="ident" id="7828468">certList</span><span class="op" id="7828476">.</span><span class="ident" id="7828477">HasExpired</span><span class="op" id="7828487">(</span><span class="ident" id="7828488">time</span><span class="op" id="7828492">.</span><span class="ident" id="7828493">Unix</span><span class="op" id="7828497">(</span><span class="num" id="7828498">1302517272</span><span class="op" id="7828508">,</span>&nbsp;<span class="num" id="7828510">0</span><span class="op" id="7828511">)</span><span class="op" id="7828512">)</span>&nbsp;<span class="op" id="7828514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828518">t</span><span class="op" id="7828519">.</span><span class="ident" id="7828520">Errorf</span><span class="op" id="7828526">(</span><span class="string" id="7828527">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7828565">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7828568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7828572">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7828631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="7828634">func</span>&nbsp;<span class="ident" id="7828639">TestCRLWithoutExpiry</span><span class="op" id="7828659">(</span><span class="ident" id="7828660">t</span>&nbsp;<span class="op" id="7828662">*</span><span class="ident" id="7828663">testing</span><span class="op" id="7828670">.</span><span class="ident" id="7828671">T</span><span class="op" id="7828672">)</span>&nbsp;<span class="op" id="7828674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828677">derBytes</span>&nbsp;<span class="op" id="7828686">:=</span>&nbsp;<span class="ident" id="7828689">fromBase64</span><span class="op" id="7828699">(</span><span class="string" id="7828700">&#34;MIHYMIGZMAkGByqGSM44BAMwEjEQMA4GA1UEAxMHQ2FybERTUxcNOTkwODI3MDcwMDAwWjBpMBMCAgDIFw05OTA4MjIwNzAwMDBaMBMCAgDJFw05OTA4MjIwNzAwMDBaMBMCAgDTFw05OTA4MjIwNzAwMDBaMBMCAgDSFw05OTA4MjIwNzAwMDBaMBMCAgDUFw05OTA4MjQwNzAwMDBaMAkGByqGSM44BAMDLwAwLAIUfmVSdjP+NHMX0feW+aDU2G1cfT0CFAJ6W7fVWxjBz4fvftok8yqDnDWh&#34;</span><span class="op" id="7828994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828997">certList</span><span class="op" id="7829005">,</span>&nbsp;<span class="ident" id="7829007">err</span>&nbsp;<span class="op" id="7829011">:=</span>&nbsp;<span class="ident" id="7829014">ParseDERCRL</span><span class="op" id="7829025">(</span><span class="ident" id="7829026">derBytes</span><span class="op" id="7829034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829037">if</span>&nbsp;<span class="ident" id="7829040">err</span>&nbsp;<span class="op" id="7829044">!=</span>&nbsp;<span class="ident" id="7829047">nil</span>&nbsp;<span class="op" id="7829051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829055">t</span><span class="op" id="7829056">.</span><span class="ident" id="7829057">Fatal</span><span class="op" id="7829062">(</span><span class="ident" id="7829063">err</span><span class="op" id="7829066">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7829069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829072">if</span>&nbsp;<span class="op" id="7829075">!</span><span class="ident" id="7829076">certList</span><span class="op" id="7829084">.</span><span class="ident" id="7829085">TBSCertList</span><span class="op" id="7829096">.</span><span class="ident" id="7829097">NextUpdate</span><span class="op" id="7829107">.</span><span class="ident" id="7829108">IsZero</span><span class="op" id="7829114">(</span><span class="op" id="7829115">)</span>&nbsp;<span class="op" id="7829117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829121">t</span><span class="op" id="7829122">.</span><span class="ident" id="7829123">Errorf</span><span class="op" id="7829129">(</span><span class="string" id="7829130">&#34;NextUpdate&nbsp;is&nbsp;not&nbsp;the&nbsp;zero&nbsp;value&#34;</span><span class="op" id="7829164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7829167">}</span><br>
<span class="lineno"></span><span class="op" id="7829169">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="7829172">func</span>&nbsp;<span class="ident" id="7829177">TestParsePEMCRL</span><span class="op" id="7829192">(</span><span class="ident" id="7829193">t</span>&nbsp;<span class="op" id="7829195">*</span><span class="ident" id="7829196">testing</span><span class="op" id="7829203">.</span><span class="ident" id="7829204">T</span><span class="op" id="7829205">)</span>&nbsp;<span class="op" id="7829207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829210">pemBytes</span>&nbsp;<span class="op" id="7829219">:=</span>&nbsp;<span class="ident" id="7829222">fromBase64</span><span class="op" id="7829232">(</span><span class="ident" id="7829233">pemCRLBase64</span><span class="op" id="7829245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829248">certList</span><span class="op" id="7829256">,</span>&nbsp;<span class="ident" id="7829258">err</span>&nbsp;<span class="op" id="7829262">:=</span>&nbsp;<span class="ident" id="7829265">ParseCRL</span><span class="op" id="7829273">(</span><span class="ident" id="7829274">pemBytes</span><span class="op" id="7829282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829285">if</span>&nbsp;<span class="ident" id="7829288">err</span>&nbsp;<span class="op" id="7829292">!=</span>&nbsp;<span class="ident" id="7829295">nil</span>&nbsp;<span class="op" id="7829299">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829303">t</span><span class="op" id="7829304">.</span><span class="ident" id="7829305">Errorf</span><span class="op" id="7829311">(</span><span class="string" id="7829312">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7829331">,</span>&nbsp;<span class="ident" id="7829333">err</span><span class="op" id="7829336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829340">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7829348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829351">numCerts</span>&nbsp;<span class="op" id="7829360">:=</span>&nbsp;<span class="builtinfunc" id="7829363">len</span><span class="op" id="7829366">(</span><span class="ident" id="7829367">certList</span><span class="op" id="7829375">.</span><span class="ident" id="7829376">TBSCertList</span><span class="op" id="7829387">.</span><span class="ident" id="7829388">RevokedCertificates</span><span class="op" id="7829407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829410">expected</span>&nbsp;<span class="op" id="7829419">:=</span>&nbsp;<span class="num" id="7829422">2</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829425">if</span>&nbsp;<span class="ident" id="7829428">numCerts</span>&nbsp;<span class="op" id="7829437">!=</span>&nbsp;<span class="ident" id="7829440">expected</span>&nbsp;<span class="op" id="7829449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829453">t</span><span class="op" id="7829454">.</span><span class="ident" id="7829455">Errorf</span><span class="op" id="7829461">(</span><span class="string" id="7829462">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7829516">,</span>&nbsp;<span class="ident" id="7829518">numCerts</span><span class="op" id="7829526">,</span>&nbsp;<span class="ident" id="7829528">expected</span><span class="op" id="7829536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7829539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829543">if</span>&nbsp;<span class="ident" id="7829546">certList</span><span class="op" id="7829554">.</span><span class="ident" id="7829555">HasExpired</span><span class="op" id="7829565">(</span><span class="ident" id="7829566">time</span><span class="op" id="7829570">.</span><span class="ident" id="7829571">Unix</span><span class="op" id="7829575">(</span><span class="num" id="7829576">1302517272</span><span class="op" id="7829586">,</span>&nbsp;<span class="num" id="7829588">0</span><span class="op" id="7829589">)</span><span class="op" id="7829590">)</span>&nbsp;<span class="op" id="7829592">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829596">t</span><span class="op" id="7829597">.</span><span class="ident" id="7829598">Errorf</span><span class="op" id="7829604">(</span><span class="string" id="7829605">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7829643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7829646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7829650">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7829709">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="7829712">func</span>&nbsp;<span class="ident" id="7829717">TestImports</span><span class="op" id="7829728">(</span><span class="ident" id="7829729">t</span>&nbsp;<span class="op" id="7829731">*</span><span class="ident" id="7829732">testing</span><span class="op" id="7829739">.</span><span class="ident" id="7829740">T</span><span class="op" id="7829741">)</span>&nbsp;<span class="op" id="7829743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829746">switch</span>&nbsp;<span class="ident" id="7829753">runtime</span><span class="op" id="7829760">.</span><span class="ident" id="7829761">GOOS</span>&nbsp;<span class="op" id="7829766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829769">case</span>&nbsp;<span class="string" id="7829774">&#34;android&#34;</span><span class="op" id="7829783">,</span>&nbsp;<span class="string" id="7829785">&#34;nacl&#34;</span><span class="op" id="7829791">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829795">t</span><span class="op" id="7829796">.</span><span class="ident" id="7829797">Skipf</span><span class="op" id="7829802">(</span><span class="string" id="7829803">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="7829819">,</span>&nbsp;<span class="ident" id="7829821">runtime</span><span class="op" id="7829828">.</span><span class="ident" id="7829829">GOOS</span><span class="op" id="7829833">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7829836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829840">if</span>&nbsp;<span class="ident" id="7829843">err</span>&nbsp;<span class="op" id="7829847">:=</span>&nbsp;<span class="ident" id="7829850">exec</span><span class="op" id="7829854">.</span><span class="ident" id="7829855">Command</span><span class="op" id="7829862">(</span><span class="string" id="7829863">&#34;go&#34;</span><span class="op" id="7829867">,</span>&nbsp;<span class="string" id="7829869">&#34;run&#34;</span><span class="op" id="7829874">,</span>&nbsp;<span class="string" id="7829876">&#34;x509_test_import.go&#34;</span><span class="op" id="7829897">)</span><span class="op" id="7829898">.</span><span class="ident" id="7829899">Run</span><span class="op" id="7829902">(</span><span class="op" id="7829903">)</span><span class="op" id="7829904">;</span>&nbsp;<span class="ident" id="7829906">err</span>&nbsp;<span class="op" id="7829910">!=</span>&nbsp;<span class="ident" id="7829913">nil</span>&nbsp;<span class="op" id="7829917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829921">t</span><span class="op" id="7829922">.</span><span class="ident" id="7829923">Errorf</span><span class="op" id="7829929">(</span><span class="string" id="7829930">&#34;failed&nbsp;to&nbsp;run&nbsp;x509_test_import.go:&nbsp;%s&#34;</span><span class="op" id="7829969">,</span>&nbsp;<span class="ident" id="7829971">err</span><span class="op" id="7829974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7829977">}</span><br>
<span class="lineno">750</span><span class="op" id="7829979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7829982">const</span>&nbsp;<span class="ident" id="7829988">derCRLBase64</span>&nbsp;<span class="op" id="7830001">=</span>&nbsp;<span class="string" id="7830003">&#34;MIINqzCCDJMCAQEwDQYJKoZIhvcNAQEFBQAwVjEZMBcGA1UEAxMQUEtJIEZJTk1FQ0NBTklDQTEVMBMGA1UEChMMRklOTUVDQ0FOSUNBMRUwEwYDVQQLEwxGSU5NRUNDQU5JQ0ExCzAJBgNVBAYTAklUFw0xMTA1MDQxNjU3NDJaFw0xMTA1MDQyMDU3NDJaMIIMBzAhAg4Ze1od49Lt1qIXBydAzhcNMDkwNzE2MDg0MzIyWjAAMCECDl0HSL9bcZ1Ci/UHJ0DPFw0wOTA3MTYwODQzMTNaMAAwIQIOESB9tVAmX3cY7QcnQNAXDTA5MDcxNjA4NDUyMlowADAhAg4S1tGAQ3mHt8uVBydA1RcNMDkwODA0MTUyNTIyWjAAMCECDlQ249Y7vtC25ScHJ0DWFw0wOTA4MDQxNTI1MzdaMAAwIQIOISMop3NkA4PfYwcnQNkXDTA5MDgwNDExMDAzNFowADAhAg56/BMoS29KEShTBydA2hcNMDkwODA0MTEwMTAzWjAAMCECDnBp/22HPH5CSWoHJ0DbFw0wOTA4MDQxMDU0NDlaMAAwIQIOV9IP+8CD8bK+XAcnQNwXDTA5MDgwNDEwNTcxN1owADAhAg4v5aRz0IxWqYiXBydA3RcNMDkwODA0MTA1NzQ1WjAAMCECDlOU34VzvZAybQwHJ0DeFw0wOTA4MDQxMDU4MjFaMAAwIAINO4CD9lluIxcwBydBAxcNMDkwNzIyMTUzMTU5WjAAMCECDgOllfO8Y1QA7/wHJ0ExFw0wOTA3MjQxMTQxNDNaMAAwIQIOJBX7jbiCdRdyjgcnQUQXDTA5MDkxNjA5MzAwOFowADAhAg5iYSAgmDrlH/RZBydBRRcNMDkwOTE2MDkzMDE3WjAAMCECDmu6k6srP3jcMaQHJ0FRFw0wOTA4MDQxMDU2NDBaMAAwIQIOX8aHlO0V+WVH4QcnQVMXDTA5MDgwNDEwNTcyOVowADAhAg5flK2rg3NnsRgDBydBzhcNMTEwMjAxMTUzMzQ2WjAAMCECDg35yJDL1jOPTgoHJ0HPFw0xMTAyMDExNTM0MjZaMAAwIQIOMyFJ6+e9iiGVBQcnQdAXDTA5MDkxODEzMjAwNVowADAhAg5Emb/Oykucmn8fBydB1xcNMDkwOTIxMTAxMDQ3WjAAMCECDjQKCncV+MnUavMHJ0HaFw0wOTA5MjIwODE1MjZaMAAwIQIOaxiFUt3dpd+tPwcnQfQXDTEwMDYxODA4NDI1MVowADAhAg5G7P8nO0tkrMt7BydB9RcNMTAwNjE4MDg0MjMwWjAAMCECDmTCC3SXhmDRst4HJ0H2Fw0wOTA5MjgxMjA3MjBaMAAwIQIOHoGhUr/pRwzTKgcnQfcXDTA5MDkyODEyMDcyNFowADAhAg50wrcrCiw8mQmPBydCBBcNMTAwMjE2MTMwMTA2WjAAMCECDifWmkvwyhEqwEcHJ0IFFw0xMDAyMTYxMzAxMjBaMAAwIQIOfgPmlW9fg+osNgcnQhwXDTEwMDQxMzA5NTIwMFowADAhAg4YHAGuA6LgCk7tBydCHRcNMTAwNDEzMDk1MTM4WjAAMCECDi1zH1bxkNJhokAHJ0IsFw0xMDA0MTMwOTU5MzBaMAAwIQIOMipNccsb/wo2fwcnQi0XDTEwMDQxMzA5NTkwMFowADAhAg46lCmvPl4GpP6ABydCShcNMTAwMTE5MDk1MjE3WjAAMCECDjaTcaj+wBpcGAsHJ0JLFw0xMDAxMTkwOTUyMzRaMAAwIQIOOMC13EOrBuxIOQcnQloXDTEwMDIwMTA5NDcwNVowADAhAg5KmZl+krz4RsmrBydCWxcNMTAwMjAxMDk0NjQwWjAAMCECDmLG3zQJ/fzdSsUHJ0JiFw0xMDAzMDEwOTUxNDBaMAAwIQIOP39ksgHdojf4owcnQmMXDTEwMDMwMTA5NTExN1owADAhAg4LDQzvWNRlD6v9BydCZBcNMTAwMzAxMDk0NjIyWjAAMCECDkmNfeclaFhIaaUHJ0JlFw0xMDAzMDEwOTQ2MDVaMAAwIQIOT/qWWfpH/m8NTwcnQpQXDTEwMDUxMTA5MTgyMVowADAhAg5m/ksYxvCEgJSvBydClRcNMTAwNTExMDkxODAxWjAAMCECDgvf3Ohq6JOPU9AHJ0KWFw0xMDA1MTEwOTIxMjNaMAAwIQIOKSPas10z4jNVIQcnQpcXDTEwMDUxMTA5MjEwMlowADAhAg4mCWmhoZ3lyKCDBydCohcNMTEwNDI4MTEwMjI1WjAAMCECDkeiyRsBMK0Gvr4HJ0KjFw0xMTA0MjgxMTAyMDdaMAAwIQIOa09b/nH2+55SSwcnQq4XDTExMDQwMTA4Mjk0NlowADAhAg5O7M7iq7gGplr1BydCrxcNMTEwNDAxMDgzMDE3WjAAMCECDjlT6mJxUjTvyogHJ0K1Fw0xMTAxMjcxNTQ4NTJaMAAwIQIODS/l4UUFLe21NAcnQrYXDTExMDEyNzE1NDgyOFowADAhAg5lPRA0XdOUF6lSBydDHhcNMTEwMTI4MTQzNTA1WjAAMCECDixKX4fFGGpENwgHJ0MfFw0xMTAxMjgxNDM1MzBaMAAwIQIORNBkqsPnpKTtbAcnQ08XDTEwMDkwOTA4NDg0MlowADAhAg5QL+EMM3lohedEBydDUBcNMTAwOTA5MDg0ODE5WjAAMCECDlhDnHK+HiTRAXcHJ0NUFw0xMDEwMTkxNjIxNDBaMAAwIQIOdBFqAzq/INz53gcnQ1UXDTEwMTAxOTE2MjA0NFowADAhAg4OjR7s8MgKles1BydDWhcNMTEwMTI3MTY1MzM2WjAAMCECDmfR/elHee+d0SoHJ0NbFw0xMTAxMjcxNjUzNTZaMAAwIQIOBTKv2ui+KFMI+wcnQ5YXDTEwMDkxNTEwMjE1N1owADAhAg49F3c/GSah+oRUBydDmxcNMTEwMTI3MTczMjMzWjAAMCECDggv4I61WwpKFMMHJ0OcFw0xMTAxMjcxNzMyNTVaMAAwIQIOXx/Y8sEvwS10LAcnQ6UXDTExMDEyODExMjkzN1owADAhAg5LSLbnVrSKaw/9BydDphcNMTEwMTI4MTEyOTIwWjAAMCECDmFFoCuhKUeACQQHJ0PfFw0xMTAxMTExMDE3MzdaMAAwIQIOQTDdFh2fSPF6AAcnQ+AXDTExMDExMTEwMTcxMFowADAhAg5B8AOXX61FpvbbBydD5RcNMTAxMDA2MTAxNDM2WjAAMCECDh41P2Gmi7PkwI4HJ0PmFw0xMDEwMDYxMDE2MjVaMAAwIQIOWUHGLQCd+Ale9gcnQ/0XDTExMDUwMjA3NTYxMFowADAhAg5Z2c9AYkikmgWOBydD/hcNMTEwNTAyMDc1NjM0WjAAMCECDmf/UD+/h8nf+74HJ0QVFw0xMTA0MTUwNzI4MzNaMAAwIQIOICvj4epy3MrqfwcnRBYXDTExMDQxNTA3Mjg1NlowADAhAg4bouRMfOYqgv4xBydEHxcNMTEwMzA4MTYyNDI1WjAAMCECDhebWHGoKiTp7pEHJ0QgFw0xMTAzMDgxNjI0NDhaMAAwIQIOX+qnxxAqJ8LtawcnRDcXDTExMDEzMTE1MTIyOFowADAhAg4j0fICqZ+wkOdqBydEOBcNMTEwMTMxMTUxMTQxWjAAMCECDhmXjsV4SUpWtAMHJ0RLFw0xMTAxMjgxMTI0MTJaMAAwIQIODno/w+zG43kkTwcnREwXDTExMDEyODExMjM1MlowADAhAg4b1gc88767Fr+LBydETxcNMTEwMTI4MTEwMjA4WjAAMCECDn+M3Pa1w2nyFeUHJ0RQFw0xMTAxMjgxMDU4NDVaMAAwIQIOaduoyIH61tqybAcnRJUXDTEwMTIxNTA5NDMyMlowADAhAg4nLqQPkyi3ESAKBydElhcNMTAxMjE1MDk0MzM2WjAAMCECDi504NIMH8578gQHJ0SbFw0xMTAyMTQxNDA1NDFaMAAwIQIOGuaM8PDaC5u1egcnRJwXDTExMDIxNDE0MDYwNFowADAhAg4ehYq/BXGnB5PWBydEnxcNMTEwMjA0MDgwOTUxWjAAMCECDkSD4eS4FxW5H20HJ0SgFw0xMTAyMDQwODA5MjVaMAAwIQIOOCcb6ilYObt1egcnRKEXDTExMDEyNjEwNDEyOVowADAhAg58tISWCCwFnKGnBydEohcNMTEwMjA0MDgxMzQyWjAAMCECDn5rjtabY/L/WL0HJ0TJFw0xMTAyMDQxMTAzNDFaMAAwDQYJKoZIhvcNAQEFBQADggEBAGnF2Gs0+LNiYCW1Ipm83OXQYP/bd5tFFRzyz3iepFqNfYs4D68/QihjFoRHQoXEB0OEe1tvaVnnPGnEOpi6krwekquMxo4H88B5SlyiFIqemCOIss0SxlCFs69LmfRYvPPvPEhoXtQ3ZThe0UvKG83GOklhvGl6OaiRf4Mt+m8zOT4Wox/j6aOBK6cw6qKCdmD+Yj1rrNqFGg1CnSWMoD6S6mwNgkzwdBUJZ22BwrzAAo4RHa2Uy3ef1FjwD0XtU5N3uDSxGGBEDvOe5z82rps3E22FpAA8eYl8kaXtmWqyvYU0epp4brGuTxCuBMCAsxt/OjIjeNNQbBGkwxgfYA0=&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7834679">const</span>&nbsp;<span class="ident" id="7834685">pemCRLBase64</span>&nbsp;<span class="op" id="7834698">=</span>&nbsp;<span class="string" id="7834700">&#34;LS0tLS1CRUdJTiBYNTA5IENSTC0tLS0tDQpNSUlCOWpDQ0FWOENBUUV3RFFZSktvWklodmNOQVFFRkJRQXdiREVhTUJnR0ExVUVDaE1SVWxOQklGTmxZM1Z5DQphWFI1SUVsdVl5NHhIakFjQmdOVkJBTVRGVkpUUVNCUWRXSnNhV01nVW05dmRDQkRRU0IyTVRFdU1Dd0dDU3FHDQpTSWIzRFFFSkFSWWZjbk5oYTJWdmJuSnZiM1J6YVdkdVFISnpZWE5sWTNWeWFYUjVMbU52YlJjTk1URXdNakl6DQpNVGt5T0RNd1doY05NVEV3T0RJeU1Ua3lPRE13V2pDQmpEQktBaEVBckRxb2g5RkhKSFhUN09QZ3V1bjQrQmNODQpNRGt4TVRBeU1UUXlOekE1V2pBbU1Bb0dBMVVkRlFRRENnRUpNQmdHQTFVZEdBUVJHQTh5TURBNU1URXdNakUwDQpNalExTlZvd1BnSVJBTEd6blowOTVQQjVhQU9MUGc1N2ZNTVhEVEF5TVRBeU16RTBOVEF4TkZvd0dqQVlCZ05WDQpIUmdFRVJnUE1qQXdNakV3TWpNeE5EVXdNVFJhb0RBd0xqQWZCZ05WSFNNRUdEQVdnQlQxVERGNlVRTS9MTmVMDQpsNWx2cUhHUXEzZzltekFMQmdOVkhSUUVCQUlDQUlRd0RRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQUZVNUFzNk16DQpxNVBSc2lmYW9iUVBHaDFhSkx5QytNczVBZ2MwYld5QTNHQWR4dXI1U3BQWmVSV0NCamlQL01FSEJXSkNsQkhQDQpHUmNxNXlJZDNFakRrYUV5eFJhK2k2N0x6dmhJNmMyOUVlNks5cFNZd2ppLzdSVWhtbW5Qclh0VHhsTDBsckxyDQptUVFKNnhoRFJhNUczUUE0Q21VZHNITnZicnpnbUNZcHZWRT0NCi0tLS0tRU5EIFg1MDkgQ1JMLS0tLS0NCg0K&#34;</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="keyword" id="7835704">func</span>&nbsp;<span class="ident" id="7835709">TestCreateCertificateRequest</span><span class="op" id="7835737">(</span><span class="ident" id="7835738">t</span>&nbsp;<span class="op" id="7835740">*</span><span class="ident" id="7835741">testing</span><span class="op" id="7835748">.</span><span class="ident" id="7835749">T</span><span class="op" id="7835750">)</span>&nbsp;<span class="op" id="7835752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835755">random</span>&nbsp;<span class="op" id="7835762">:=</span>&nbsp;<span class="ident" id="7835765">rand</span><span class="op" id="7835769">.</span><span class="ident" id="7835770">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835779">block</span><span class="op" id="7835784">,</span>&nbsp;<span class="ident" id="7835786">_</span>&nbsp;<span class="op" id="7835788">:=</span>&nbsp;<span class="ident" id="7835791">pem</span><span class="op" id="7835794">.</span><span class="ident" id="7835795">Decode</span><span class="op" id="7835801">(</span><span class="op" id="7835802">[</span><span class="op" id="7835803">]</span><span class="builtintype" id="7835804">byte</span><span class="op" id="7835808">(</span><span class="ident" id="7835809">pemPrivateKey</span><span class="op" id="7835822">)</span><span class="op" id="7835823">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835826">rsaPriv</span><span class="op" id="7835833">,</span>&nbsp;<span class="ident" id="7835835">err</span>&nbsp;<span class="op" id="7835839">:=</span>&nbsp;<span class="ident" id="7835842">ParsePKCS1PrivateKey</span><span class="op" id="7835862">(</span><span class="ident" id="7835863">block</span><span class="op" id="7835868">.</span><span class="ident" id="7835869">Bytes</span><span class="op" id="7835874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7835877">if</span>&nbsp;<span class="ident" id="7835880">err</span>&nbsp;<span class="op" id="7835884">!=</span>&nbsp;<span class="ident" id="7835887">nil</span>&nbsp;<span class="op" id="7835891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835895">t</span><span class="op" id="7835896">.</span><span class="ident" id="7835897">Fatalf</span><span class="op" id="7835903">(</span><span class="string" id="7835904">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7835937">,</span>&nbsp;<span class="ident" id="7835939">err</span><span class="op" id="7835942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7835945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835949">ecdsa256Priv</span><span class="op" id="7835961">,</span>&nbsp;<span class="ident" id="7835963">err</span>&nbsp;<span class="op" id="7835967">:=</span>&nbsp;<span class="ident" id="7835970">ecdsa</span><span class="op" id="7835975">.</span><span class="ident" id="7835976">GenerateKey</span><span class="op" id="7835987">(</span><span class="ident" id="7835988">elliptic</span><span class="op" id="7835996">.</span><span class="ident" id="7835997">P256</span><span class="op" id="7836001">(</span><span class="op" id="7836002">)</span><span class="op" id="7836003">,</span>&nbsp;<span class="ident" id="7836005">rand</span><span class="op" id="7836009">.</span><span class="ident" id="7836010">Reader</span><span class="op" id="7836016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7836019">if</span>&nbsp;<span class="ident" id="7836022">err</span>&nbsp;<span class="op" id="7836026">!=</span>&nbsp;<span class="ident" id="7836029">nil</span>&nbsp;<span class="op" id="7836033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836037">t</span><span class="op" id="7836038">.</span><span class="ident" id="7836039">Fatalf</span><span class="op" id="7836045">(</span><span class="string" id="7836046">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7836080">,</span>&nbsp;<span class="ident" id="7836082">err</span><span class="op" id="7836085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836092">ecdsa384Priv</span><span class="op" id="7836104">,</span>&nbsp;<span class="ident" id="7836106">err</span>&nbsp;<span class="op" id="7836110">:=</span>&nbsp;<span class="ident" id="7836113">ecdsa</span><span class="op" id="7836118">.</span><span class="ident" id="7836119">GenerateKey</span><span class="op" id="7836130">(</span><span class="ident" id="7836131">elliptic</span><span class="op" id="7836139">.</span><span class="ident" id="7836140">P384</span><span class="op" id="7836144">(</span><span class="op" id="7836145">)</span><span class="op" id="7836146">,</span>&nbsp;<span class="ident" id="7836148">rand</span><span class="op" id="7836152">.</span><span class="ident" id="7836153">Reader</span><span class="op" id="7836159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7836162">if</span>&nbsp;<span class="ident" id="7836165">err</span>&nbsp;<span class="op" id="7836169">!=</span>&nbsp;<span class="ident" id="7836172">nil</span>&nbsp;<span class="op" id="7836176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836180">t</span><span class="op" id="7836181">.</span><span class="ident" id="7836182">Fatalf</span><span class="op" id="7836188">(</span><span class="string" id="7836189">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7836223">,</span>&nbsp;<span class="ident" id="7836225">err</span><span class="op" id="7836228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836235">ecdsa521Priv</span><span class="op" id="7836247">,</span>&nbsp;<span class="ident" id="7836249">err</span>&nbsp;<span class="op" id="7836253">:=</span>&nbsp;<span class="ident" id="7836256">ecdsa</span><span class="op" id="7836261">.</span><span class="ident" id="7836262">GenerateKey</span><span class="op" id="7836273">(</span><span class="ident" id="7836274">elliptic</span><span class="op" id="7836282">.</span><span class="ident" id="7836283">P521</span><span class="op" id="7836287">(</span><span class="op" id="7836288">)</span><span class="op" id="7836289">,</span>&nbsp;<span class="ident" id="7836291">rand</span><span class="op" id="7836295">.</span><span class="ident" id="7836296">Reader</span><span class="op" id="7836302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7836305">if</span>&nbsp;<span class="ident" id="7836308">err</span>&nbsp;<span class="op" id="7836312">!=</span>&nbsp;<span class="ident" id="7836315">nil</span>&nbsp;<span class="op" id="7836319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836323">t</span><span class="op" id="7836324">.</span><span class="ident" id="7836325">Fatalf</span><span class="op" id="7836331">(</span><span class="string" id="7836332">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7836366">,</span>&nbsp;<span class="ident" id="7836368">err</span><span class="op" id="7836371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836378">tests</span>&nbsp;<span class="op" id="7836384">:=</span>&nbsp;<span class="op" id="7836387">[</span><span class="op" id="7836388">]</span><span class="keyword" id="7836389">struct</span>&nbsp;<span class="op" id="7836396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836400">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7836408">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836417">priv</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7836425">interface</span><span class="op" id="7836434">{</span><span class="op" id="7836435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836439">sigAlgo</span>&nbsp;<span class="ident" id="7836447">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836467">}</span><span class="op" id="7836468">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836472">{</span><span class="string" id="7836473">&#34;RSA&#34;</span><span class="op" id="7836478">,</span>&nbsp;<span class="ident" id="7836480">rsaPriv</span><span class="op" id="7836487">,</span>&nbsp;<span class="ident" id="7836489">SHA1WithRSA</span><span class="op" id="7836500">}</span><span class="op" id="7836501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836505">{</span><span class="string" id="7836506">&#34;ECDSA-256&#34;</span><span class="op" id="7836517">,</span>&nbsp;<span class="ident" id="7836519">ecdsa256Priv</span><span class="op" id="7836531">,</span>&nbsp;<span class="ident" id="7836533">ECDSAWithSHA1</span><span class="op" id="7836546">}</span><span class="op" id="7836547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836551">{</span><span class="string" id="7836552">&#34;ECDSA-384&#34;</span><span class="op" id="7836563">,</span>&nbsp;<span class="ident" id="7836565">ecdsa384Priv</span><span class="op" id="7836577">,</span>&nbsp;<span class="ident" id="7836579">ECDSAWithSHA1</span><span class="op" id="7836592">}</span><span class="op" id="7836593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836597">{</span><span class="string" id="7836598">&#34;ECDSA-521&#34;</span><span class="op" id="7836609">,</span>&nbsp;<span class="ident" id="7836611">ecdsa521Priv</span><span class="op" id="7836623">,</span>&nbsp;<span class="ident" id="7836625">ECDSAWithSHA1</span><span class="op" id="7836638">}</span><span class="op" id="7836639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836642">}</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7836646">for</span>&nbsp;<span class="ident" id="7836650">_</span><span class="op" id="7836651">,</span>&nbsp;<span class="ident" id="7836653">test</span>&nbsp;<span class="op" id="7836658">:=</span>&nbsp;<span class="keyword" id="7836661">range</span>&nbsp;<span class="ident" id="7836667">tests</span>&nbsp;<span class="op" id="7836673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836677">template</span>&nbsp;<span class="op" id="7836686">:=</span>&nbsp;<span class="ident" id="7836689">CertificateRequest</span><span class="op" id="7836707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836712">Subject</span><span class="op" id="7836719">:</span>&nbsp;<span class="ident" id="7836721">pkix</span><span class="op" id="7836725">.</span><span class="ident" id="7836726">Name</span><span class="op" id="7836730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836736">CommonName</span><span class="op" id="7836746">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7836750">&#34;test.example.com&#34;</span><span class="op" id="7836768">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836774">Organization</span><span class="op" id="7836786">:</span>&nbsp;<span class="op" id="7836788">[</span><span class="op" id="7836789">]</span><span class="builtintype" id="7836790">string</span><span class="op" id="7836796">{</span><span class="string" id="7836797">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7836809">}</span><span class="op" id="7836810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836815">}</span><span class="op" id="7836816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836821">SignatureAlgorithm</span><span class="op" id="7836839">:</span>&nbsp;<span class="ident" id="7836841">test</span><span class="op" id="7836845">.</span><span class="ident" id="7836846">sigAlgo</span><span class="op" id="7836853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836858">DNSNames</span><span class="op" id="7836866">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7836878">[</span><span class="op" id="7836879">]</span><span class="builtintype" id="7836880">string</span><span class="op" id="7836886">{</span><span class="string" id="7836887">&#34;test.example.com&#34;</span><span class="op" id="7836905">}</span><span class="op" id="7836906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836911">EmailAddresses</span><span class="op" id="7836925">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7836931">[</span><span class="op" id="7836932">]</span><span class="builtintype" id="7836933">string</span><span class="op" id="7836939">{</span><span class="string" id="7836940">&#34;gopher@golang.org&#34;</span><span class="op" id="7836959">}</span><span class="op" id="7836960">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836965">IPAddresses</span><span class="op" id="7836976">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7836985">[</span><span class="op" id="7836986">]</span><span class="ident" id="7836987">net</span><span class="op" id="7836990">.</span><span class="ident" id="7836991">IP</span><span class="op" id="7836993">{</span><span class="ident" id="7836994">net</span><span class="op" id="7836997">.</span><span class="ident" id="7836998">IPv4</span><span class="op" id="7837002">(</span><span class="num" id="7837003">127</span><span class="op" id="7837006">,</span>&nbsp;<span class="num" id="7837008">0</span><span class="op" id="7837009">,</span>&nbsp;<span class="num" id="7837011">0</span><span class="op" id="7837012">,</span>&nbsp;<span class="num" id="7837014">1</span><span class="op" id="7837015">)</span><span class="op" id="7837016">.</span><span class="ident" id="7837017">To4</span><span class="op" id="7837020">(</span><span class="op" id="7837021">)</span><span class="op" id="7837022">,</span>&nbsp;<span class="ident" id="7837024">net</span><span class="op" id="7837027">.</span><span class="ident" id="7837028">ParseIP</span><span class="op" id="7837035">(</span><span class="string" id="7837036">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7837058">)</span><span class="op" id="7837059">}</span><span class="op" id="7837060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7837064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7837069">derBytes</span><span class="op" id="7837077">,</span>&nbsp;<span class="ident" id="7837079">err</span>&nbsp;<span class="op" id="7837083">:=</span>&nbsp;<span class="ident" id="7837086">CreateCertificateRequest</span><span class="op" id="7837110">(</span><span class="ident" id="7837111">random</span><span class="op" id="7837117">,</span>&nbsp;<span class="op" id="7837119">&amp;</span><span class="ident" id="7837120">template</span><span class="op" id="7837128">,</span>&nbsp;<span class="ident" id="7837130">test</span><span class="op" id="7837134">.</span><span class="ident" id="7837135">priv</span><span class="op" id="7837139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7837143">if</span>&nbsp;<span class="ident" id="7837146">err</span>&nbsp;<span class="op" id="7837150">!=</span>&nbsp;<span class="ident" id="7837153">nil</span>&nbsp;<span class="op" id="7837157">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7837162">t</span><span class="op" id="7837163">.</span><span class="ident" id="7837164">Errorf</span><span class="op" id="7837170">(</span><span class="string" id="7837171">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7837217">,</span>&nbsp;<span class="ident" id="7837219">test</span><span class="op" id="7837223">.</span><span class="ident" id="7837224">name</span><span class="op" id="7837228">,</span>&nbsp;<span class="ident" id="7837230">err</span><span class="op" id="7837233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7837238">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7837249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7837254">out</span><span class="op" id="7837257">,</span>&nbsp;<span class="ident" id="7837259">err</span>&nbsp;<span class="op" id="7837263">:=</span>&nbsp;<span class="ident" id="7837266">ParseCertificateRequest</span><span class="op" id="7837289">(</span><span class="ident" id="7837290">derBytes</span><span class="op" id="7837298">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7837302">if</span>&nbsp;<span class="ident" id="7837305">err</span>&nbsp;<span class="op" id="7837309">!=</span>&nbsp;<span class="ident" id="7837312">nil</span>&nbsp;<span class="op" id="7837316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7837321">t</span><span class="op" id="7837322">.</span><span class="ident" id="7837323">Errorf</span><span class="op" id="7837329">(</span><span class="string" id="7837330">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7837376">,</span>&nbsp;<span class="ident" id="7837378">test</span><span class="op" id="7837382">.</span><span class="ident" id="7837383">name</span><span class="op" id="7837387">,</span>&nbsp;<span class="ident" id="7837389">err</span><span class="op" id="7837392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7837397">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7837408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7837413">if</span>&nbsp;<span class="ident" id="7837416">out</span><span class="op" id="7837419">.</span><span class="ident" id="7837420">Subject</span><span class="op" id="7837427">.</span><span class="ident" id="7837428">CommonName</span>&nbsp;<span class="op" id="7837439">!=</span>&nbsp;<span class="ident" id="7837442">template</span><span class="op" id="7837450">.</span><span class="ident" id="7837451">Subject</span><span class="op" id="7837458">.</span><span class="ident" id="7837459">CommonName</span>&nbsp;<span class="op" id="7837470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7837475">t</span><span class="op" id="7837476">.</span><span class="ident" id="7837477">Errorf</span><span class="op" id="7837483">(</span><span class="string" id="7837484">&#34;%s:&nbsp;output&nbsp;subject&nbsp;common&nbsp;name&nbsp;and&nbsp;template&nbsp;subject&nbsp;common&nbsp;name&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7837561">,</span>&nbsp;<span class="ident" id="7837563">test</span><span class="op" id="7837567">.</span><span class="ident" id="7837568">name</span><span class="op" id="7837572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7837576">}</span>&nbsp;<span class="keyword" id="7837578">else</span>&nbsp;<span class="keyword" id="7837583">if</span>&nbsp;<span class="builtinfunc" id="7837586">len</span><span class="op" id="7837589">(</span><span class="ident" id="7837590">out</span><span class="op" id="7837593">.</span><span class="ident" id="7837594">Subject</span><span class="op" id="7837601">.</span><span class="ident" id="7837602">Organization</span><span class="op" id="7837614">)</span>&nbsp;<span class="op" id="7837616">!=</span>&nbsp;<span class="builtinfunc" id="7837619">len</span><span class="op" id="7837622">(</span><span class="ident" id="7837623">template</span><span class="op" id="7837631">.</span><span class="ident" id="7837632">Subject</span><span class="op" id="7837639">.</span><span class="ident" id="7837640">Organization</span><span class="op" id="7837652">)</span>&nbsp;<span class="op" id="7837654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7837659">t</span><span class="op" id="7837660">.</span><span class="ident" id="7837661">Errorf</span><span class="op" id="7837667">(</span><span class="string" id="7837668">&#34;%s:&nbsp;output&nbsp;subject&nbsp;organisation&nbsp;and&nbsp;template&nbsp;subject&nbsp;organisation&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7837747">,</span>&nbsp;<span class="ident" id="7837749">test</span><span class="op" id="7837753">.</span><span class="ident" id="7837754">name</span><span class="op" id="7837758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7837762">}</span>&nbsp;<span class="keyword" id="7837764">else</span>&nbsp;<span class="keyword" id="7837769">if</span>&nbsp;<span class="builtinfunc" id="7837772">len</span><span class="op" id="7837775">(</span><span class="ident" id="7837776">out</span><span class="op" id="7837779">.</span><span class="ident" id="7837780">DNSNames</span><span class="op" id="7837788">)</span>&nbsp;<span class="op" id="7837790">!=</span>&nbsp;<span class="builtinfunc" id="7837793">len</span><span class="op" id="7837796">(</span><span class="ident" id="7837797">template</span><span class="op" id="7837805">.</span><span class="ident" id="7837806">DNSNames</span><span class="op" id="7837814">)</span>&nbsp;<span class="op" id="7837816">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7837821">t</span><span class="op" id="7837822">.</span><span class="ident" id="7837823">Errorf</span><span class="op" id="7837829">(</span><span class="string" id="7837830">&#34;%s:&nbsp;output&nbsp;DNS&nbsp;names&nbsp;and&nbsp;template&nbsp;DNS&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7837887">,</span>&nbsp;<span class="ident" id="7837889">test</span><span class="op" id="7837893">.</span><span class="ident" id="7837894">name</span><span class="op" id="7837898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7837902">}</span>&nbsp;<span class="keyword" id="7837904">else</span>&nbsp;<span class="keyword" id="7837909">if</span>&nbsp;<span class="builtinfunc" id="7837912">len</span><span class="op" id="7837915">(</span><span class="ident" id="7837916">out</span><span class="op" id="7837919">.</span><span class="ident" id="7837920">EmailAddresses</span><span class="op" id="7837934">)</span>&nbsp;<span class="op" id="7837936">!=</span>&nbsp;<span class="builtinfunc" id="7837939">len</span><span class="op" id="7837942">(</span><span class="ident" id="7837943">template</span><span class="op" id="7837951">.</span><span class="ident" id="7837952">EmailAddresses</span><span class="op" id="7837966">)</span>&nbsp;<span class="op" id="7837968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7837973">t</span><span class="op" id="7837974">.</span><span class="ident" id="7837975">Errorf</span><span class="op" id="7837981">(</span><span class="string" id="7837982">&#34;%s:&nbsp;output&nbsp;email&nbsp;addresses&nbsp;and&nbsp;template&nbsp;email&nbsp;addresses&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7838051">,</span>&nbsp;<span class="ident" id="7838053">test</span><span class="op" id="7838057">.</span><span class="ident" id="7838058">name</span><span class="op" id="7838062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7838066">}</span>&nbsp;<span class="keyword" id="7838068">else</span>&nbsp;<span class="keyword" id="7838073">if</span>&nbsp;<span class="builtinfunc" id="7838076">len</span><span class="op" id="7838079">(</span><span class="ident" id="7838080">out</span><span class="op" id="7838083">.</span><span class="ident" id="7838084">IPAddresses</span><span class="op" id="7838095">)</span>&nbsp;<span class="op" id="7838097">!=</span>&nbsp;<span class="builtinfunc" id="7838100">len</span><span class="op" id="7838103">(</span><span class="ident" id="7838104">template</span><span class="op" id="7838112">.</span><span class="ident" id="7838113">IPAddresses</span><span class="op" id="7838124">)</span>&nbsp;<span class="op" id="7838126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7838131">t</span><span class="op" id="7838132">.</span><span class="ident" id="7838133">Errorf</span><span class="op" id="7838139">(</span><span class="string" id="7838140">&#34;%s:&nbsp;output&nbsp;IP&nbsp;addresses&nbsp;and&nbsp;template&nbsp;IP&nbsp;addresses&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7838209">,</span>&nbsp;<span class="ident" id="7838211">test</span><span class="op" id="7838215">.</span><span class="ident" id="7838216">name</span><span class="op" id="7838220">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7838224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7838227">}</span><br>
<span class="lineno"></span><span class="op" id="7838229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7838232">func</span>&nbsp;<span class="ident" id="7838237">marshalAndParseCSR</span><span class="op" id="7838255">(</span><span class="ident" id="7838256">t</span>&nbsp;<span class="op" id="7838258">*</span><span class="ident" id="7838259">testing</span><span class="op" id="7838266">.</span><span class="ident" id="7838267">T</span><span class="op" id="7838268">,</span>&nbsp;<span class="ident" id="7838270">template</span>&nbsp;<span class="op" id="7838279">*</span><span class="ident" id="7838280">CertificateRequest</span><span class="op" id="7838298">)</span>&nbsp;<span class="op" id="7838300">*</span><span class="ident" id="7838301">CertificateRequest</span>&nbsp;<span class="op" id="7838320">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7838323">block</span><span class="op" id="7838328">,</span>&nbsp;<span class="ident" id="7838330">_</span>&nbsp;<span class="op" id="7838332">:=</span>&nbsp;<span class="ident" id="7838335">pem</span><span class="op" id="7838338">.</span><span class="ident" id="7838339">Decode</span><span class="op" id="7838345">(</span><span class="op" id="7838346">[</span><span class="op" id="7838347">]</span><span class="builtintype" id="7838348">byte</span><span class="op" id="7838352">(</span><span class="ident" id="7838353">pemPrivateKey</span><span class="op" id="7838366">)</span><span class="op" id="7838367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7838370">rsaPriv</span><span class="op" id="7838377">,</span>&nbsp;<span class="ident" id="7838379">err</span>&nbsp;<span class="op" id="7838383">:=</span>&nbsp;<span class="ident" id="7838386">ParsePKCS1PrivateKey</span><span class="op" id="7838406">(</span><span class="ident" id="7838407">block</span><span class="op" id="7838412">.</span><span class="ident" id="7838413">Bytes</span><span class="op" id="7838418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7838421">if</span>&nbsp;<span class="ident" id="7838424">err</span>&nbsp;<span class="op" id="7838428">!=</span>&nbsp;<span class="ident" id="7838431">nil</span>&nbsp;<span class="op" id="7838435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7838439">t</span><span class="op" id="7838440">.</span><span class="ident" id="7838441">Fatal</span><span class="op" id="7838446">(</span><span class="ident" id="7838447">err</span><span class="op" id="7838450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7838453">}</span><br>
<span class="lineno">835</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7838457">derBytes</span><span class="op" id="7838465">,</span>&nbsp;<span class="ident" id="7838467">err</span>&nbsp;<span class="op" id="7838471">:=</span>&nbsp;<span class="ident" id="7838474">CreateCertificateRequest</span><span class="op" id="7838498">(</span><span class="ident" id="7838499">rand</span><span class="op" id="7838503">.</span><span class="ident" id="7838504">Reader</span><span class="op" id="7838510">,</span>&nbsp;<span class="ident" id="7838512">template</span><span class="op" id="7838520">,</span>&nbsp;<span class="ident" id="7838522">rsaPriv</span><span class="op" id="7838529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7838532">if</span>&nbsp;<span class="ident" id="7838535">err</span>&nbsp;<span class="op" id="7838539">!=</span>&nbsp;<span class="ident" id="7838542">nil</span>&nbsp;<span class="op" id="7838546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7838550">t</span><span class="op" id="7838551">.</span><span class="ident" id="7838552">Fatal</span><span class="op" id="7838557">(</span><span class="ident" id="7838558">err</span><span class="op" id="7838561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7838564">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7838568">csr</span><span class="op" id="7838571">,</span>&nbsp;<span class="ident" id="7838573">err</span>&nbsp;<span class="op" id="7838577">:=</span>&nbsp;<span class="ident" id="7838580">ParseCertificateRequest</span><span class="op" id="7838603">(</span><span class="ident" id="7838604">derBytes</span><span class="op" id="7838612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7838615">if</span>&nbsp;<span class="ident" id="7838618">err</span>&nbsp;<span class="op" id="7838622">!=</span>&nbsp;<span class="ident" id="7838625">nil</span>&nbsp;<span class="op" id="7838629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7838633">t</span><span class="op" id="7838634">.</span><span class="ident" id="7838635">Fatal</span><span class="op" id="7838640">(</span><span class="ident" id="7838641">err</span><span class="op" id="7838644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7838647">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7838651">return</span>&nbsp;<span class="ident" id="7838658">csr</span><br>
<span class="lineno"></span><span class="op" id="7838662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7838665">func</span>&nbsp;<span class="ident" id="7838670">TestCertificateRequestOverrides</span><span class="op" id="7838701">(</span><span class="ident" id="7838702">t</span>&nbsp;<span class="op" id="7838704">*</span><span class="ident" id="7838705">testing</span><span class="op" id="7838712">.</span><span class="ident" id="7838713">T</span><span class="op" id="7838714">)</span>&nbsp;<span class="op" id="7838716">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7838719">sanContents</span><span class="op" id="7838730">,</span>&nbsp;<span class="ident" id="7838732">err</span>&nbsp;<span class="op" id="7838736">:=</span>&nbsp;<span class="ident" id="7838739">marshalSANs</span><span class="op" id="7838750">(</span><span class="op" id="7838751">[</span><span class="op" id="7838752">]</span><span class="builtintype" id="7838753">string</span><span class="op" id="7838759">{</span><span class="string" id="7838760">&#34;foo.example.com&#34;</span><span class="op" id="7838777">}</span><span class="op" id="7838778">,</span>&nbsp;<span class="ident" id="7838780">nil</span><span class="op" id="7838783">,</span>&nbsp;<span class="ident" id="7838785">nil</span><span class="op" id="7838788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7838791">if</span>&nbsp;<span class="ident" id="7838794">err</span>&nbsp;<span class="op" id="7838798">!=</span>&nbsp;<span class="ident" id="7838801">nil</span>&nbsp;<span class="op" id="7838805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7838809">t</span><span class="op" id="7838810">.</span><span class="ident" id="7838811">Fatal</span><span class="op" id="7838816">(</span><span class="ident" id="7838817">err</span><span class="op" id="7838820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7838823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7838827">template</span>&nbsp;<span class="op" id="7838836">:=</span>&nbsp;<span class="ident" id="7838839">CertificateRequest</span><span class="op" id="7838857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7838861">Subject</span><span class="op" id="7838868">:</span>&nbsp;<span class="ident" id="7838870">pkix</span><span class="op" id="7838874">.</span><span class="ident" id="7838875">Name</span><span class="op" id="7838879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7838884">CommonName</span><span class="op" id="7838894">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7838898">&#34;test.example.com&#34;</span><span class="op" id="7838916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7838921">Organization</span><span class="op" id="7838933">:</span>&nbsp;<span class="op" id="7838935">[</span><span class="op" id="7838936">]</span><span class="builtintype" id="7838937">string</span><span class="op" id="7838943">{</span><span class="string" id="7838944">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7838956">}</span><span class="op" id="7838957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7838961">}</span><span class="op" id="7838962">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7838966">DNSNames</span><span class="op" id="7838974">:</span>&nbsp;<span class="op" id="7838976">[</span><span class="op" id="7838977">]</span><span class="builtintype" id="7838978">string</span><span class="op" id="7838984">{</span><span class="string" id="7838985">&#34;test.example.com&#34;</span><span class="op" id="7839003">}</span><span class="op" id="7839004">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7839009">//&nbsp;An&nbsp;explicit&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;DNSNames&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7839074">//&nbsp;template.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839089">ExtraExtensions</span><span class="op" id="7839104">:</span>&nbsp;<span class="op" id="7839106">[</span><span class="op" id="7839107">]</span><span class="ident" id="7839108">pkix</span><span class="op" id="7839112">.</span><span class="ident" id="7839113">Extension</span><span class="op" id="7839122">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7839127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839133">Id</span><span class="op" id="7839135">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7839140">oidExtensionSubjectAltName</span><span class="op" id="7839166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839172">Value</span><span class="op" id="7839177">:</span>&nbsp;<span class="ident" id="7839179">sanContents</span><span class="op" id="7839190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7839195">}</span><span class="op" id="7839196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7839200">}</span><span class="op" id="7839201">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7839204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839208">csr</span>&nbsp;<span class="op" id="7839212">:=</span>&nbsp;<span class="ident" id="7839215">marshalAndParseCSR</span><span class="op" id="7839233">(</span><span class="ident" id="7839234">t</span><span class="op" id="7839235">,</span>&nbsp;<span class="op" id="7839237">&amp;</span><span class="ident" id="7839238">template</span><span class="op" id="7839246">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7839250">if</span>&nbsp;<span class="builtinfunc" id="7839253">len</span><span class="op" id="7839256">(</span><span class="ident" id="7839257">csr</span><span class="op" id="7839260">.</span><span class="ident" id="7839261">DNSNames</span><span class="op" id="7839269">)</span>&nbsp;<span class="op" id="7839271">!=</span>&nbsp;<span class="num" id="7839274">1</span>&nbsp;<span class="op" id="7839276">||</span>&nbsp;<span class="ident" id="7839279">csr</span><span class="op" id="7839282">.</span><span class="ident" id="7839283">DNSNames</span><span class="op" id="7839291">[</span><span class="num" id="7839292">0</span><span class="op" id="7839293">]</span>&nbsp;<span class="op" id="7839295">!=</span>&nbsp;<span class="string" id="7839298">&#34;foo.example.com&#34;</span>&nbsp;<span class="op" id="7839316">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839320">t</span><span class="op" id="7839321">.</span><span class="ident" id="7839322">Errorf</span><span class="op" id="7839328">(</span><span class="string" id="7839329">&#34;Extension&nbsp;did&nbsp;not&nbsp;override&nbsp;template.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7839376">,</span>&nbsp;<span class="ident" id="7839378">csr</span><span class="op" id="7839381">.</span><span class="ident" id="7839382">DNSNames</span><span class="op" id="7839390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7839393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7839397">//&nbsp;If&nbsp;there&nbsp;is&nbsp;already&nbsp;an&nbsp;attribute&nbsp;with&nbsp;X.509&nbsp;extensions&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7839465">//&nbsp;extra&nbsp;extensions&nbsp;should&nbsp;be&nbsp;added&nbsp;to&nbsp;it&nbsp;rather&nbsp;than&nbsp;creating&nbsp;a&nbsp;CSR</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7839535">//&nbsp;with&nbsp;two&nbsp;extension&nbsp;attributes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839571">template</span><span class="op" id="7839579">.</span><span class="ident" id="7839580">Attributes</span>&nbsp;<span class="op" id="7839591">=</span>&nbsp;<span class="op" id="7839593">[</span><span class="op" id="7839594">]</span><span class="ident" id="7839595">pkix</span><span class="op" id="7839599">.</span><span class="ident" id="7839600">AttributeTypeAndValueSET</span><span class="op" id="7839624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7839628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839633">Type</span><span class="op" id="7839637">:</span>&nbsp;<span class="ident" id="7839639">oidExtensionRequest</span><span class="op" id="7839658">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839663">Value</span><span class="op" id="7839668">:</span>&nbsp;<span class="op" id="7839670">[</span><span class="op" id="7839671">]</span><span class="op" id="7839672">[</span><span class="op" id="7839673">]</span><span class="ident" id="7839674">pkix</span><span class="op" id="7839678">.</span><span class="ident" id="7839679">AttributeTypeAndValue</span><span class="op" id="7839700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7839706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7839713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839721">Type</span><span class="op" id="7839725">:</span>&nbsp;&nbsp;<span class="ident" id="7839728">oidExtensionAuthorityInfoAccess</span><span class="op" id="7839759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839767">Value</span><span class="op" id="7839772">:</span>&nbsp;<span class="op" id="7839774">[</span><span class="op" id="7839775">]</span><span class="builtintype" id="7839776">byte</span><span class="op" id="7839780">(</span><span class="string" id="7839781">&#34;foo&#34;</span><span class="op" id="7839786">)</span><span class="op" id="7839787">,</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7839794">}</span><span class="op" id="7839795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7839801">}</span><span class="op" id="7839802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7839807">}</span><span class="op" id="7839808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7839812">}</span><span class="op" id="7839813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7839816">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839820">csr</span>&nbsp;<span class="op" id="7839824">=</span>&nbsp;<span class="ident" id="7839826">marshalAndParseCSR</span><span class="op" id="7839844">(</span><span class="ident" id="7839845">t</span><span class="op" id="7839846">,</span>&nbsp;<span class="op" id="7839848">&amp;</span><span class="ident" id="7839849">template</span><span class="op" id="7839857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7839860">if</span>&nbsp;<span class="ident" id="7839863">l</span>&nbsp;<span class="op" id="7839865">:=</span>&nbsp;<span class="builtinfunc" id="7839868">len</span><span class="op" id="7839871">(</span><span class="ident" id="7839872">csr</span><span class="op" id="7839875">.</span><span class="ident" id="7839876">Attributes</span><span class="op" id="7839886">)</span><span class="op" id="7839887">;</span>&nbsp;<span class="ident" id="7839889">l</span>&nbsp;<span class="op" id="7839891">!=</span>&nbsp;<span class="num" id="7839894">1</span>&nbsp;<span class="op" id="7839896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839900">t</span><span class="op" id="7839901">.</span><span class="ident" id="7839902">Errorf</span><span class="op" id="7839908">(</span><span class="string" id="7839909">&#34;incorrect&nbsp;number&nbsp;of&nbsp;attributes:&nbsp;%d\n&#34;</span><span class="op" id="7839947">,</span>&nbsp;<span class="ident" id="7839949">l</span><span class="op" id="7839950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7839953">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7839957">if</span>&nbsp;<span class="op" id="7839960">!</span><span class="ident" id="7839961">csr</span><span class="op" id="7839964">.</span><span class="ident" id="7839965">Attributes</span><span class="op" id="7839975">[</span><span class="num" id="7839976">0</span><span class="op" id="7839977">]</span><span class="op" id="7839978">.</span><span class="ident" id="7839979">Type</span><span class="op" id="7839983">.</span><span class="ident" id="7839984">Equal</span><span class="op" id="7839989">(</span><span class="ident" id="7839990">oidExtensionRequest</span><span class="op" id="7840009">)</span>&nbsp;<span class="op" id="7840011">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7840016">len</span><span class="op" id="7840019">(</span><span class="ident" id="7840020">csr</span><span class="op" id="7840023">.</span><span class="ident" id="7840024">Attributes</span><span class="op" id="7840034">[</span><span class="num" id="7840035">0</span><span class="op" id="7840036">]</span><span class="op" id="7840037">.</span><span class="ident" id="7840038">Value</span><span class="op" id="7840043">)</span>&nbsp;<span class="op" id="7840045">!=</span>&nbsp;<span class="num" id="7840048">1</span>&nbsp;<span class="op" id="7840050">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7840055">len</span><span class="op" id="7840058">(</span><span class="ident" id="7840059">csr</span><span class="op" id="7840062">.</span><span class="ident" id="7840063">Attributes</span><span class="op" id="7840073">[</span><span class="num" id="7840074">0</span><span class="op" id="7840075">]</span><span class="op" id="7840076">.</span><span class="ident" id="7840077">Value</span><span class="op" id="7840082">[</span><span class="num" id="7840083">0</span><span class="op" id="7840084">]</span><span class="op" id="7840085">)</span>&nbsp;<span class="op" id="7840087">!=</span>&nbsp;<span class="num" id="7840090">2</span>&nbsp;<span class="op" id="7840092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840096">t</span><span class="op" id="7840097">.</span><span class="ident" id="7840098">Errorf</span><span class="op" id="7840104">(</span><span class="string" id="7840105">&#34;bad&nbsp;attributes:&nbsp;%#v\n&#34;</span><span class="op" id="7840128">,</span>&nbsp;<span class="ident" id="7840130">csr</span><span class="op" id="7840133">.</span><span class="ident" id="7840134">Attributes</span><span class="op" id="7840144">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7840147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840151">sanContents2</span><span class="op" id="7840163">,</span>&nbsp;<span class="ident" id="7840165">err</span>&nbsp;<span class="op" id="7840169">:=</span>&nbsp;<span class="ident" id="7840172">marshalSANs</span><span class="op" id="7840183">(</span><span class="op" id="7840184">[</span><span class="op" id="7840185">]</span><span class="builtintype" id="7840186">string</span><span class="op" id="7840192">{</span><span class="string" id="7840193">&#34;foo2.example.com&#34;</span><span class="op" id="7840211">}</span><span class="op" id="7840212">,</span>&nbsp;<span class="ident" id="7840214">nil</span><span class="op" id="7840217">,</span>&nbsp;<span class="ident" id="7840219">nil</span><span class="op" id="7840222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7840225">if</span>&nbsp;<span class="ident" id="7840228">err</span>&nbsp;<span class="op" id="7840232">!=</span>&nbsp;<span class="ident" id="7840235">nil</span>&nbsp;<span class="op" id="7840239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840243">t</span><span class="op" id="7840244">.</span><span class="ident" id="7840245">Fatal</span><span class="op" id="7840250">(</span><span class="ident" id="7840251">err</span><span class="op" id="7840254">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7840257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7840261">//&nbsp;Extensions&nbsp;in&nbsp;Attributes&nbsp;should&nbsp;override&nbsp;those&nbsp;in&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840332">template</span><span class="op" id="7840340">.</span><span class="ident" id="7840341">Attributes</span><span class="op" id="7840351">[</span><span class="num" id="7840352">0</span><span class="op" id="7840353">]</span><span class="op" id="7840354">.</span><span class="ident" id="7840355">Value</span><span class="op" id="7840360">[</span><span class="num" id="7840361">0</span><span class="op" id="7840362">]</span>&nbsp;<span class="op" id="7840364">=</span>&nbsp;<span class="builtinfunc" id="7840366">append</span><span class="op" id="7840372">(</span><span class="ident" id="7840373">template</span><span class="op" id="7840381">.</span><span class="ident" id="7840382">Attributes</span><span class="op" id="7840392">[</span><span class="num" id="7840393">0</span><span class="op" id="7840394">]</span><span class="op" id="7840395">.</span><span class="ident" id="7840396">Value</span><span class="op" id="7840401">[</span><span class="num" id="7840402">0</span><span class="op" id="7840403">]</span><span class="op" id="7840404">,</span>&nbsp;<span class="ident" id="7840406">pkix</span><span class="op" id="7840410">.</span><span class="ident" id="7840411">AttributeTypeAndValue</span><span class="op" id="7840432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840436">Type</span><span class="op" id="7840440">:</span>&nbsp;&nbsp;<span class="ident" id="7840443">oidExtensionSubjectAltName</span><span class="op" id="7840469">,</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840473">Value</span><span class="op" id="7840478">:</span>&nbsp;<span class="ident" id="7840480">sanContents2</span><span class="op" id="7840492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7840495">}</span><span class="op" id="7840496">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840500">csr</span>&nbsp;<span class="op" id="7840504">=</span>&nbsp;<span class="ident" id="7840506">marshalAndParseCSR</span><span class="op" id="7840524">(</span><span class="ident" id="7840525">t</span><span class="op" id="7840526">,</span>&nbsp;<span class="op" id="7840528">&amp;</span><span class="ident" id="7840529">template</span><span class="op" id="7840537">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7840541">if</span>&nbsp;<span class="builtinfunc" id="7840544">len</span><span class="op" id="7840547">(</span><span class="ident" id="7840548">csr</span><span class="op" id="7840551">.</span><span class="ident" id="7840552">DNSNames</span><span class="op" id="7840560">)</span>&nbsp;<span class="op" id="7840562">!=</span>&nbsp;<span class="num" id="7840565">1</span>&nbsp;<span class="op" id="7840567">||</span>&nbsp;<span class="ident" id="7840570">csr</span><span class="op" id="7840573">.</span><span class="ident" id="7840574">DNSNames</span><span class="op" id="7840582">[</span><span class="num" id="7840583">0</span><span class="op" id="7840584">]</span>&nbsp;<span class="op" id="7840586">!=</span>&nbsp;<span class="string" id="7840589">&#34;foo2.example.com&#34;</span>&nbsp;<span class="op" id="7840608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840612">t</span><span class="op" id="7840613">.</span><span class="ident" id="7840614">Errorf</span><span class="op" id="7840620">(</span><span class="string" id="7840621">&#34;Attributes&nbsp;did&nbsp;not&nbsp;override&nbsp;ExtraExtensions.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7840676">,</span>&nbsp;<span class="ident" id="7840678">csr</span><span class="op" id="7840681">.</span><span class="ident" id="7840682">DNSNames</span><span class="op" id="7840690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7840693">}</span><br>
<span class="lineno"></span><span class="op" id="7840695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="7840698">func</span>&nbsp;<span class="ident" id="7840703">TestParseCertificateRequest</span><span class="op" id="7840730">(</span><span class="ident" id="7840731">t</span>&nbsp;<span class="op" id="7840733">*</span><span class="ident" id="7840734">testing</span><span class="op" id="7840741">.</span><span class="ident" id="7840742">T</span><span class="op" id="7840743">)</span>&nbsp;<span class="op" id="7840745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840748">csrBytes</span>&nbsp;<span class="op" id="7840757">:=</span>&nbsp;<span class="ident" id="7840760">fromBase64</span><span class="op" id="7840770">(</span><span class="ident" id="7840771">csrBase64</span><span class="op" id="7840780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840783">csr</span><span class="op" id="7840786">,</span>&nbsp;<span class="ident" id="7840788">err</span>&nbsp;<span class="op" id="7840792">:=</span>&nbsp;<span class="ident" id="7840795">ParseCertificateRequest</span><span class="op" id="7840818">(</span><span class="ident" id="7840819">csrBytes</span><span class="op" id="7840827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7840830">if</span>&nbsp;<span class="ident" id="7840833">err</span>&nbsp;<span class="op" id="7840837">!=</span>&nbsp;<span class="ident" id="7840840">nil</span>&nbsp;<span class="op" id="7840844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840848">t</span><span class="op" id="7840849">.</span><span class="ident" id="7840850">Fatalf</span><span class="op" id="7840856">(</span><span class="string" id="7840857">&#34;failed&nbsp;to&nbsp;parse&nbsp;CSR:&nbsp;%s&#34;</span><span class="op" id="7840882">,</span>&nbsp;<span class="ident" id="7840884">err</span><span class="op" id="7840887">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7840890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7840894">if</span>&nbsp;<span class="builtinfunc" id="7840897">len</span><span class="op" id="7840900">(</span><span class="ident" id="7840901">csr</span><span class="op" id="7840904">.</span><span class="ident" id="7840905">EmailAddresses</span><span class="op" id="7840919">)</span>&nbsp;<span class="op" id="7840921">!=</span>&nbsp;<span class="num" id="7840924">1</span>&nbsp;<span class="op" id="7840926">||</span>&nbsp;<span class="ident" id="7840929">csr</span><span class="op" id="7840932">.</span><span class="ident" id="7840933">EmailAddresses</span><span class="op" id="7840947">[</span><span class="num" id="7840948">0</span><span class="op" id="7840949">]</span>&nbsp;<span class="op" id="7840951">!=</span>&nbsp;<span class="string" id="7840954">&#34;gopher@golang.org&#34;</span>&nbsp;<span class="op" id="7840974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840978">t</span><span class="op" id="7840979">.</span><span class="ident" id="7840980">Errorf</span><span class="op" id="7840986">(</span><span class="string" id="7840987">&#34;incorrect&nbsp;email&nbsp;addresses&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7841024">,</span>&nbsp;<span class="ident" id="7841026">csr</span><span class="op" id="7841029">.</span><span class="ident" id="7841030">EmailAddresses</span><span class="op" id="7841044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841047">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841051">if</span>&nbsp;<span class="builtinfunc" id="7841054">len</span><span class="op" id="7841057">(</span><span class="ident" id="7841058">csr</span><span class="op" id="7841061">.</span><span class="ident" id="7841062">DNSNames</span><span class="op" id="7841070">)</span>&nbsp;<span class="op" id="7841072">!=</span>&nbsp;<span class="num" id="7841075">1</span>&nbsp;<span class="op" id="7841077">||</span>&nbsp;<span class="ident" id="7841080">csr</span><span class="op" id="7841083">.</span><span class="ident" id="7841084">DNSNames</span><span class="op" id="7841092">[</span><span class="num" id="7841093">0</span><span class="op" id="7841094">]</span>&nbsp;<span class="op" id="7841096">!=</span>&nbsp;<span class="string" id="7841099">&#34;test.example.com&#34;</span>&nbsp;<span class="op" id="7841118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841122">t</span><span class="op" id="7841123">.</span><span class="ident" id="7841124">Errorf</span><span class="op" id="7841130">(</span><span class="string" id="7841131">&#34;incorrect&nbsp;DNS&nbsp;names&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7841162">,</span>&nbsp;<span class="ident" id="7841164">csr</span><span class="op" id="7841167">.</span><span class="ident" id="7841168">DNSNames</span><span class="op" id="7841176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841183">if</span>&nbsp;<span class="builtinfunc" id="7841186">len</span><span class="op" id="7841189">(</span><span class="ident" id="7841190">csr</span><span class="op" id="7841193">.</span><span class="ident" id="7841194">Subject</span><span class="op" id="7841201">.</span><span class="ident" id="7841202">Country</span><span class="op" id="7841209">)</span>&nbsp;<span class="op" id="7841211">!=</span>&nbsp;<span class="num" id="7841214">1</span>&nbsp;<span class="op" id="7841216">||</span>&nbsp;<span class="ident" id="7841219">csr</span><span class="op" id="7841222">.</span><span class="ident" id="7841223">Subject</span><span class="op" id="7841230">.</span><span class="ident" id="7841231">Country</span><span class="op" id="7841238">[</span><span class="num" id="7841239">0</span><span class="op" id="7841240">]</span>&nbsp;<span class="op" id="7841242">!=</span>&nbsp;<span class="string" id="7841245">&#34;AU&#34;</span>&nbsp;<span class="op" id="7841250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841254">t</span><span class="op" id="7841255">.</span><span class="ident" id="7841256">Errorf</span><span class="op" id="7841262">(</span><span class="string" id="7841263">&#34;incorrect&nbsp;Subject&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7841291">,</span>&nbsp;<span class="ident" id="7841293">csr</span><span class="op" id="7841296">.</span><span class="ident" id="7841297">Subject</span><span class="op" id="7841304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841311">found</span>&nbsp;<span class="op" id="7841317">:=</span>&nbsp;<span class="builtintype" id="7841320">false</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841327">for</span>&nbsp;<span class="ident" id="7841331">_</span><span class="op" id="7841332">,</span>&nbsp;<span class="ident" id="7841334">e</span>&nbsp;<span class="op" id="7841336">:=</span>&nbsp;<span class="keyword" id="7841339">range</span>&nbsp;<span class="ident" id="7841345">csr</span><span class="op" id="7841348">.</span><span class="ident" id="7841349">Extensions</span>&nbsp;<span class="op" id="7841360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841364">if</span>&nbsp;<span class="ident" id="7841367">e</span><span class="op" id="7841368">.</span><span class="ident" id="7841369">Id</span><span class="op" id="7841371">.</span><span class="ident" id="7841372">Equal</span><span class="op" id="7841377">(</span><span class="ident" id="7841378">oidExtensionBasicConstraints</span><span class="op" id="7841406">)</span>&nbsp;<span class="op" id="7841408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841413">found</span>&nbsp;<span class="op" id="7841419">=</span>&nbsp;<span class="builtintype" id="7841421">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841429">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841437">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841443">if</span>&nbsp;<span class="op" id="7841446">!</span><span class="ident" id="7841447">found</span>&nbsp;<span class="op" id="7841453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841457">t</span><span class="op" id="7841458">.</span><span class="ident" id="7841459">Errorf</span><span class="op" id="7841465">(</span><span class="string" id="7841466">&#34;basic&nbsp;constraints&nbsp;extension&nbsp;not&nbsp;found&nbsp;in&nbsp;CSR&#34;</span><span class="op" id="7841512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841515">}</span><br>
<span class="lineno"></span><span class="op" id="7841517">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="keyword" id="7841520">func</span>&nbsp;<span class="ident" id="7841525">TestMaxPathLen</span><span class="op" id="7841539">(</span><span class="ident" id="7841540">t</span>&nbsp;<span class="op" id="7841542">*</span><span class="ident" id="7841543">testing</span><span class="op" id="7841550">.</span><span class="ident" id="7841551">T</span><span class="op" id="7841552">)</span>&nbsp;<span class="op" id="7841554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841557">block</span><span class="op" id="7841562">,</span>&nbsp;<span class="ident" id="7841564">_</span>&nbsp;<span class="op" id="7841566">:=</span>&nbsp;<span class="ident" id="7841569">pem</span><span class="op" id="7841572">.</span><span class="ident" id="7841573">Decode</span><span class="op" id="7841579">(</span><span class="op" id="7841580">[</span><span class="op" id="7841581">]</span><span class="builtintype" id="7841582">byte</span><span class="op" id="7841586">(</span><span class="ident" id="7841587">pemPrivateKey</span><span class="op" id="7841600">)</span><span class="op" id="7841601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841604">rsaPriv</span><span class="op" id="7841611">,</span>&nbsp;<span class="ident" id="7841613">err</span>&nbsp;<span class="op" id="7841617">:=</span>&nbsp;<span class="ident" id="7841620">ParsePKCS1PrivateKey</span><span class="op" id="7841640">(</span><span class="ident" id="7841641">block</span><span class="op" id="7841646">.</span><span class="ident" id="7841647">Bytes</span><span class="op" id="7841652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841655">if</span>&nbsp;<span class="ident" id="7841658">err</span>&nbsp;<span class="op" id="7841662">!=</span>&nbsp;<span class="ident" id="7841665">nil</span>&nbsp;<span class="op" id="7841669">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841673">t</span><span class="op" id="7841674">.</span><span class="ident" id="7841675">Fatalf</span><span class="op" id="7841681">(</span><span class="string" id="7841682">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7841715">,</span>&nbsp;<span class="ident" id="7841717">err</span><span class="op" id="7841720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841727">template</span>&nbsp;<span class="op" id="7841736">:=</span>&nbsp;<span class="op" id="7841739">&amp;</span><span class="ident" id="7841740">Certificate</span><span class="op" id="7841751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841755">SerialNumber</span><span class="op" id="7841767">:</span>&nbsp;<span class="ident" id="7841769">big</span><span class="op" id="7841772">.</span><span class="ident" id="7841773">NewInt</span><span class="op" id="7841779">(</span><span class="num" id="7841780">1</span><span class="op" id="7841781">)</span><span class="op" id="7841782">,</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841786">Subject</span><span class="op" id="7841793">:</span>&nbsp;<span class="ident" id="7841795">pkix</span><span class="op" id="7841799">.</span><span class="ident" id="7841800">Name</span><span class="op" id="7841804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841809">CommonName</span><span class="op" id="7841819">:</span>&nbsp;<span class="string" id="7841821">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7841833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841837">}</span><span class="op" id="7841838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841842">NotBefore</span><span class="op" id="7841851">:</span>&nbsp;<span class="ident" id="7841853">time</span><span class="op" id="7841857">.</span><span class="ident" id="7841858">Unix</span><span class="op" id="7841862">(</span><span class="num" id="7841863">1000</span><span class="op" id="7841867">,</span>&nbsp;<span class="num" id="7841869">0</span><span class="op" id="7841870">)</span><span class="op" id="7841871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841875">NotAfter</span><span class="op" id="7841883">:</span>&nbsp;&nbsp;<span class="ident" id="7841886">time</span><span class="op" id="7841890">.</span><span class="ident" id="7841891">Unix</span><span class="op" id="7841895">(</span><span class="num" id="7841896">100000</span><span class="op" id="7841902">,</span>&nbsp;<span class="num" id="7841904">0</span><span class="op" id="7841905">)</span><span class="op" id="7841906">,</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841911">BasicConstraintsValid</span><span class="op" id="7841932">:</span>&nbsp;<span class="builtintype" id="7841934">true</span><span class="op" id="7841938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841942">IsCA</span><span class="op" id="7841946">:</span>&nbsp;<span class="builtintype" id="7841948">true</span><span class="op" id="7841952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841959">serialiseAndParse</span>&nbsp;<span class="op" id="7841977">:=</span>&nbsp;<span class="keyword" id="7841980">func</span><span class="op" id="7841984">(</span><span class="ident" id="7841985">template</span>&nbsp;<span class="op" id="7841994">*</span><span class="ident" id="7841995">Certificate</span><span class="op" id="7842006">)</span>&nbsp;<span class="op" id="7842008">*</span><span class="ident" id="7842009">Certificate</span>&nbsp;<span class="op" id="7842021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842025">derBytes</span><span class="op" id="7842033">,</span>&nbsp;<span class="ident" id="7842035">err</span>&nbsp;<span class="op" id="7842039">:=</span>&nbsp;<span class="ident" id="7842042">CreateCertificate</span><span class="op" id="7842059">(</span><span class="ident" id="7842060">rand</span><span class="op" id="7842064">.</span><span class="ident" id="7842065">Reader</span><span class="op" id="7842071">,</span>&nbsp;<span class="ident" id="7842073">template</span><span class="op" id="7842081">,</span>&nbsp;<span class="ident" id="7842083">template</span><span class="op" id="7842091">,</span>&nbsp;<span class="op" id="7842093">&amp;</span><span class="ident" id="7842094">rsaPriv</span><span class="op" id="7842101">.</span><span class="ident" id="7842102">PublicKey</span><span class="op" id="7842111">,</span>&nbsp;<span class="ident" id="7842113">rsaPriv</span><span class="op" id="7842120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842124">if</span>&nbsp;<span class="ident" id="7842127">err</span>&nbsp;<span class="op" id="7842131">!=</span>&nbsp;<span class="ident" id="7842134">nil</span>&nbsp;<span class="op" id="7842138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842143">t</span><span class="op" id="7842144">.</span><span class="ident" id="7842145">Fatalf</span><span class="op" id="7842151">(</span><span class="string" id="7842152">&#34;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7842186">,</span>&nbsp;<span class="ident" id="7842188">err</span><span class="op" id="7842191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842196">return</span>&nbsp;<span class="ident" id="7842203">nil</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842214">cert</span><span class="op" id="7842218">,</span>&nbsp;<span class="ident" id="7842220">err</span>&nbsp;<span class="op" id="7842224">:=</span>&nbsp;<span class="ident" id="7842227">ParseCertificate</span><span class="op" id="7842243">(</span><span class="ident" id="7842244">derBytes</span><span class="op" id="7842252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842256">if</span>&nbsp;<span class="ident" id="7842259">err</span>&nbsp;<span class="op" id="7842263">!=</span>&nbsp;<span class="ident" id="7842266">nil</span>&nbsp;<span class="op" id="7842270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842275">t</span><span class="op" id="7842276">.</span><span class="ident" id="7842277">Fatalf</span><span class="op" id="7842283">(</span><span class="string" id="7842284">&#34;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7842317">,</span>&nbsp;<span class="ident" id="7842319">err</span><span class="op" id="7842322">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842327">return</span>&nbsp;<span class="ident" id="7842334">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842345">return</span>&nbsp;<span class="ident" id="7842352">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842358">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842362">cert1</span>&nbsp;<span class="op" id="7842368">:=</span>&nbsp;<span class="ident" id="7842371">serialiseAndParse</span><span class="op" id="7842388">(</span><span class="ident" id="7842389">template</span><span class="op" id="7842397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842400">if</span>&nbsp;<span class="ident" id="7842403">m</span>&nbsp;<span class="op" id="7842405">:=</span>&nbsp;<span class="ident" id="7842408">cert1</span><span class="op" id="7842413">.</span><span class="ident" id="7842414">MaxPathLen</span><span class="op" id="7842424">;</span>&nbsp;<span class="ident" id="7842426">m</span>&nbsp;<span class="op" id="7842428">!=</span>&nbsp;<span class="op" id="7842431">-</span><span class="num" id="7842432">1</span>&nbsp;<span class="op" id="7842434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842438">t</span><span class="op" id="7842439">.</span><span class="ident" id="7842440">Errorf</span><span class="op" id="7842446">(</span><span class="string" id="7842447">&#34;Omitting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;turn&nbsp;into&nbsp;-1,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7842496">,</span>&nbsp;<span class="ident" id="7842498">m</span><span class="op" id="7842499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842502">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842505">if</span>&nbsp;<span class="ident" id="7842508">cert1</span><span class="op" id="7842513">.</span><span class="ident" id="7842514">MaxPathLenZero</span>&nbsp;<span class="op" id="7842529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842533">t</span><span class="op" id="7842534">.</span><span class="ident" id="7842535">Errorf</span><span class="op" id="7842541">(</span><span class="string" id="7842542">&#34;Omitting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7842590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842597">template</span><span class="op" id="7842605">.</span><span class="ident" id="7842606">MaxPathLen</span>&nbsp;<span class="op" id="7842617">=</span>&nbsp;<span class="num" id="7842619">1</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842622">cert2</span>&nbsp;<span class="op" id="7842628">:=</span>&nbsp;<span class="ident" id="7842631">serialiseAndParse</span><span class="op" id="7842648">(</span><span class="ident" id="7842649">template</span><span class="op" id="7842657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842660">if</span>&nbsp;<span class="ident" id="7842663">m</span>&nbsp;<span class="op" id="7842665">:=</span>&nbsp;<span class="ident" id="7842668">cert2</span><span class="op" id="7842673">.</span><span class="ident" id="7842674">MaxPathLen</span><span class="op" id="7842684">;</span>&nbsp;<span class="ident" id="7842686">m</span>&nbsp;<span class="op" id="7842688">!=</span>&nbsp;<span class="num" id="7842691">1</span>&nbsp;<span class="op" id="7842693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842697">t</span><span class="op" id="7842698">.</span><span class="ident" id="7842699">Errorf</span><span class="op" id="7842705">(</span><span class="string" id="7842706">&#34;Setting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;work.&nbsp;Got&nbsp;%d&nbsp;but&nbsp;set&nbsp;1&#34;</span><span class="op" id="7842756">,</span>&nbsp;<span class="ident" id="7842758">m</span><span class="op" id="7842759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842765">if</span>&nbsp;<span class="ident" id="7842768">cert2</span><span class="op" id="7842773">.</span><span class="ident" id="7842774">MaxPathLenZero</span>&nbsp;<span class="op" id="7842789">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842793">t</span><span class="op" id="7842794">.</span><span class="ident" id="7842795">Errorf</span><span class="op" id="7842801">(</span><span class="string" id="7842802">&#34;Setting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7842849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842856">template</span><span class="op" id="7842864">.</span><span class="ident" id="7842865">MaxPathLen</span>&nbsp;<span class="op" id="7842876">=</span>&nbsp;<span class="num" id="7842878">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842881">template</span><span class="op" id="7842889">.</span><span class="ident" id="7842890">MaxPathLenZero</span>&nbsp;<span class="op" id="7842905">=</span>&nbsp;<span class="builtintype" id="7842907">true</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842913">cert3</span>&nbsp;<span class="op" id="7842919">:=</span>&nbsp;<span class="ident" id="7842922">serialiseAndParse</span><span class="op" id="7842939">(</span><span class="ident" id="7842940">template</span><span class="op" id="7842948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842951">if</span>&nbsp;<span class="ident" id="7842954">m</span>&nbsp;<span class="op" id="7842956">:=</span>&nbsp;<span class="ident" id="7842959">cert3</span><span class="op" id="7842964">.</span><span class="ident" id="7842965">MaxPathLen</span><span class="op" id="7842975">;</span>&nbsp;<span class="ident" id="7842977">m</span>&nbsp;<span class="op" id="7842979">!=</span>&nbsp;<span class="num" id="7842982">0</span>&nbsp;<span class="op" id="7842984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842988">t</span><span class="op" id="7842989">.</span><span class="ident" id="7842990">Errorf</span><span class="op" id="7842996">(</span><span class="string" id="7842997">&#34;Setting&nbsp;MaxPathLenZero&nbsp;didn&#39;t&nbsp;work,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7843041">,</span>&nbsp;<span class="ident" id="7843043">m</span><span class="op" id="7843044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7843047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843050">if</span>&nbsp;<span class="op" id="7843053">!</span><span class="ident" id="7843054">cert3</span><span class="op" id="7843059">.</span><span class="ident" id="7843060">MaxPathLenZero</span>&nbsp;<span class="op" id="7843075">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843079">t</span><span class="op" id="7843080">.</span><span class="ident" id="7843081">Errorf</span><span class="op" id="7843087">(</span><span class="string" id="7843088">&#34;Setting&nbsp;MaxPathLen&nbsp;to&nbsp;zero&nbsp;didn&#39;t&nbsp;result&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7843148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7843151">}</span><br>
<span class="lineno"></span><span class="op" id="7843153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7843156">//&nbsp;This&nbsp;CSR&nbsp;was&nbsp;generated&nbsp;with&nbsp;OpenSSL:</span><br>
<span class="lineno">1020</span><span class="comment" id="7843196">//&nbsp;&nbsp;openssl&nbsp;req&nbsp;-out&nbsp;CSR.csr&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-nodes&nbsp;-keyout&nbsp;privateKey.key&nbsp;-config&nbsp;openssl.cnf</span><br>
<span class="lineno"></span><span class="comment" id="7843297">//</span><br>
<span class="lineno"></span><span class="comment" id="7843300">//&nbsp;The&nbsp;openssl.cnf&nbsp;needs&nbsp;to&nbsp;include&nbsp;this&nbsp;section:</span><br>
<span class="lineno"></span><span class="comment" id="7843350">//&nbsp;&nbsp;&nbsp;[&nbsp;v3_req&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="7843366">//&nbsp;&nbsp;&nbsp;basicConstraints&nbsp;=&nbsp;CA:FALSE</span><br>
<span class="lineno">1025</span><span class="comment" id="7843399">//&nbsp;&nbsp;&nbsp;keyUsage&nbsp;=&nbsp;nonRepudiation,&nbsp;digitalSignature,&nbsp;keyEncipherment</span><br>
<span class="lineno"></span><span class="comment" id="7843465">//&nbsp;&nbsp;&nbsp;subjectAltName&nbsp;=&nbsp;email:gopher@golang.org,DNS:test.example.com</span><br>
<span class="lineno"></span><span class="keyword" id="7843532">const</span>&nbsp;<span class="ident" id="7843538">csrBase64</span>&nbsp;<span class="op" id="7843548">=</span>&nbsp;<span class="string" id="7843550">&#34;MIIC4zCCAcsCAQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOY+MVedRg2JEnyeLcSzcsMv2VcsTfkB5+Etd6hihAh6MrGezNyASMMKuQN6YhCX1icQDiQtGsDLTtheNnSXK06tAhHjAP/hGlszRJp+5+rP2M58fDBAkUBEhskbCUWwpY14jFtVuGNJ8vF8h8IeczdolvQhX9lVai9G0EUXJMliMKdjA899H0mRs9PzHyidyrXFNiZlQXfD8Kg7gETn2Ny965iyI6ujAIYSCvam6TnxRHYH2MBKyVGvsYGbPYUQJCsgdgyajEg6ekihvQY3SzO1HSAlZAd7d1QYO4VeWJ2mY6Wu3Jpmh+AmG19S9CcHqGjd0bhuAX9cpPOKgnEmqn0CAwEAAaBZMFcGCSqGSIb3DQEJDjFKMEgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwLgYDVR0RBCcwJYERZ29waGVyQGdvbGFuZy5vcmeCEHRlc3QuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQEFBQADggEBAC9+QpKfdabxwCWwf4IEe1cKjdXLS1ScSuw27a3kZzQiPV78WJMa6dB8dqhdH5BRwGZ/qsgLrO6ZHlNeIv2Ib41Ccq71ecHW/nXc94A1BzJ/bVdI9LZcmTUvR1/m1jCpN7UqQ0ml1u9VihK7Pe762hEYxuWDQzYEU0l15S/bXmqeq3eF1A59XT/2jwe5+NV0Wwf4UQlkTXsAQMsJ+KzrQafd8Qv2A49o048uRvmjeJDrXLawGVianZ7D5A6Fpd1rZh6XcjqBpmgLw41DRQWENOdzhy+HyphKRv1MlY8OLkNqpGMhu8DdgJVGoT16DGiickoEa7Z3UCPVNgdTkT9jq7U=&#34;</span>
</div>
</body>
</html>
