<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html" class="current">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6168165">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6168221">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6168275">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6168326">package</span>&nbsp;<span class="ident" id="6168334">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6168341">import</span>&nbsp;<span class="op" id="6168348">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6168351">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6168360">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6168370">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="6168375">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6168378">type</span>&nbsp;<span class="ident" id="6168383">importReader</span>&nbsp;<span class="keyword" id="6168396">struct</span>&nbsp;<span class="op" id="6168403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168406">b</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6168411">*</span><span class="ident" id="6168412">bufio</span><span class="op" id="6168417">.</span><span class="ident" id="6168418">Reader</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168426">buf</span>&nbsp;&nbsp;<span class="op" id="6168431">[</span><span class="op" id="6168432">]</span><span class="builtintype" id="6168433">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168439">peek</span>&nbsp;<span class="builtintype" id="6168444">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168450">err</span>&nbsp;&nbsp;<span class="builtintype" id="6168455">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168462">eof</span>&nbsp;&nbsp;<span class="builtintype" id="6168467">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168473">nerr</span>&nbsp;<span class="builtintype" id="6168478">int</span><br>
<span class="lineno">20</span><span class="op" id="6168482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6168485">func</span>&nbsp;<span class="ident" id="6168490">isIdent</span><span class="op" id="6168497">(</span><span class="ident" id="6168498">c</span>&nbsp;<span class="builtintype" id="6168500">byte</span><span class="op" id="6168504">)</span>&nbsp;<span class="builtintype" id="6168506">bool</span>&nbsp;<span class="op" id="6168511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168514">return</span>&nbsp;<span class="string" id="6168521">&#39;A&#39;</span>&nbsp;<span class="op" id="6168525">&lt;=</span>&nbsp;<span class="ident" id="6168528">c</span>&nbsp;<span class="op" id="6168530">&amp;&amp;</span>&nbsp;<span class="ident" id="6168533">c</span>&nbsp;<span class="op" id="6168535">&lt;=</span>&nbsp;<span class="string" id="6168538">&#39;Z&#39;</span>&nbsp;<span class="op" id="6168542">||</span>&nbsp;<span class="string" id="6168545">&#39;a&#39;</span>&nbsp;<span class="op" id="6168549">&lt;=</span>&nbsp;<span class="ident" id="6168552">c</span>&nbsp;<span class="op" id="6168554">&amp;&amp;</span>&nbsp;<span class="ident" id="6168557">c</span>&nbsp;<span class="op" id="6168559">&lt;=</span>&nbsp;<span class="string" id="6168562">&#39;z&#39;</span>&nbsp;<span class="op" id="6168566">||</span>&nbsp;<span class="string" id="6168569">&#39;0&#39;</span>&nbsp;<span class="op" id="6168573">&lt;=</span>&nbsp;<span class="ident" id="6168576">c</span>&nbsp;<span class="op" id="6168578">&amp;&amp;</span>&nbsp;<span class="ident" id="6168581">c</span>&nbsp;<span class="op" id="6168583">&lt;=</span>&nbsp;<span class="string" id="6168586">&#39;9&#39;</span>&nbsp;<span class="op" id="6168590">||</span>&nbsp;<span class="ident" id="6168593">c</span>&nbsp;<span class="op" id="6168595">==</span>&nbsp;<span class="string" id="6168598">&#39;_&#39;</span>&nbsp;<span class="op" id="6168602">||</span>&nbsp;<span class="ident" id="6168605">c</span>&nbsp;<span class="op" id="6168607">&gt;=</span>&nbsp;<span class="num" id="6168610">0x80</span><br>
<span class="lineno"></span><span class="op" id="6168615">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6168618">var</span>&nbsp;<span class="op" id="6168622">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168625">errSyntax</span>&nbsp;<span class="op" id="6168635">=</span>&nbsp;<span class="ident" id="6168637">errors</span><span class="op" id="6168643">.</span><span class="ident" id="6168644">New</span><span class="op" id="6168647">(</span><span class="string" id="6168648">&#34;syntax&nbsp;error&#34;</span><span class="op" id="6168662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168665">errNUL</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6168675">=</span>&nbsp;<span class="ident" id="6168677">errors</span><span class="op" id="6168683">.</span><span class="ident" id="6168684">New</span><span class="op" id="6168687">(</span><span class="string" id="6168688">&#34;unexpected&nbsp;NUL&nbsp;in&nbsp;input&#34;</span><span class="op" id="6168713">)</span><br>
<span class="lineno"></span><span class="op" id="6168715">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6168718">//&nbsp;syntaxError&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;but&nbsp;only&nbsp;if&nbsp;an&nbsp;I/O&nbsp;error&nbsp;has&nbsp;not&nbsp;already&nbsp;been&nbsp;recorded.</span><br>
<span class="lineno"></span><span class="keyword" id="6168813">func</span>&nbsp;<span class="op" id="6168818">(</span><span class="ident" id="6168819">r</span>&nbsp;<span class="op" id="6168821">*</span><span class="ident" id="6168822">importReader</span><span class="op" id="6168834">)</span>&nbsp;<span class="ident" id="6168836">syntaxError</span><span class="op" id="6168847">(</span><span class="op" id="6168848">)</span>&nbsp;<span class="op" id="6168850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168853">if</span>&nbsp;<span class="ident" id="6168856">r</span><span class="op" id="6168857">.</span><span class="ident" id="6168858">err</span>&nbsp;<span class="op" id="6168862">==</span>&nbsp;<span class="ident" id="6168865">nil</span>&nbsp;<span class="op" id="6168869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168873">r</span><span class="op" id="6168874">.</span><span class="ident" id="6168875">err</span>&nbsp;<span class="op" id="6168879">=</span>&nbsp;<span class="ident" id="6168881">errSyntax</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168892">}</span><br>
<span class="lineno"></span><span class="op" id="6168894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6168897">//&nbsp;readByte&nbsp;reads&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input,&nbsp;saves&nbsp;it&nbsp;in&nbsp;buf,&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6168978">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;readByte&nbsp;records&nbsp;the&nbsp;error&nbsp;in&nbsp;r.err&nbsp;and&nbsp;returns&nbsp;0.</span><br>
<span class="lineno">40</span><span class="keyword" id="6169052">func</span>&nbsp;<span class="op" id="6169057">(</span><span class="ident" id="6169058">r</span>&nbsp;<span class="op" id="6169060">*</span><span class="ident" id="6169061">importReader</span><span class="op" id="6169073">)</span>&nbsp;<span class="ident" id="6169075">readByte</span><span class="op" id="6169083">(</span><span class="op" id="6169084">)</span>&nbsp;<span class="builtintype" id="6169086">byte</span>&nbsp;<span class="op" id="6169091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169094">c</span><span class="op" id="6169095">,</span>&nbsp;<span class="ident" id="6169097">err</span>&nbsp;<span class="op" id="6169101">:=</span>&nbsp;<span class="ident" id="6169104">r</span><span class="op" id="6169105">.</span><span class="ident" id="6169106">b</span><span class="op" id="6169107">.</span><span class="ident" id="6169108">ReadByte</span><span class="op" id="6169116">(</span><span class="op" id="6169117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169120">if</span>&nbsp;<span class="ident" id="6169123">err</span>&nbsp;<span class="op" id="6169127">==</span>&nbsp;<span class="ident" id="6169130">nil</span>&nbsp;<span class="op" id="6169134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169138">r</span><span class="op" id="6169139">.</span><span class="ident" id="6169140">buf</span>&nbsp;<span class="op" id="6169144">=</span>&nbsp;<span class="builtinfunc" id="6169146">append</span><span class="op" id="6169152">(</span><span class="ident" id="6169153">r</span><span class="op" id="6169154">.</span><span class="ident" id="6169155">buf</span><span class="op" id="6169158">,</span>&nbsp;<span class="ident" id="6169160">c</span><span class="op" id="6169161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169165">if</span>&nbsp;<span class="ident" id="6169168">c</span>&nbsp;<span class="op" id="6169170">==</span>&nbsp;<span class="num" id="6169173">0</span>&nbsp;<span class="op" id="6169175">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169180">err</span>&nbsp;<span class="op" id="6169184">=</span>&nbsp;<span class="ident" id="6169186">errNUL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6169195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6169198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169201">if</span>&nbsp;<span class="ident" id="6169204">err</span>&nbsp;<span class="op" id="6169208">!=</span>&nbsp;<span class="ident" id="6169211">nil</span>&nbsp;<span class="op" id="6169215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169219">if</span>&nbsp;<span class="ident" id="6169222">err</span>&nbsp;<span class="op" id="6169226">==</span>&nbsp;<span class="ident" id="6169229">io</span><span class="op" id="6169231">.</span><span class="ident" id="6169232">EOF</span>&nbsp;<span class="op" id="6169236">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169241">r</span><span class="op" id="6169242">.</span><span class="ident" id="6169243">eof</span>&nbsp;<span class="op" id="6169247">=</span>&nbsp;<span class="builtintype" id="6169249">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6169256">}</span>&nbsp;<span class="keyword" id="6169258">else</span>&nbsp;<span class="keyword" id="6169263">if</span>&nbsp;<span class="ident" id="6169266">r</span><span class="op" id="6169267">.</span><span class="ident" id="6169268">err</span>&nbsp;<span class="op" id="6169272">==</span>&nbsp;<span class="ident" id="6169275">nil</span>&nbsp;<span class="op" id="6169279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169284">r</span><span class="op" id="6169285">.</span><span class="ident" id="6169286">err</span>&nbsp;<span class="op" id="6169290">=</span>&nbsp;<span class="ident" id="6169292">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6169298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169302">c</span>&nbsp;<span class="op" id="6169304">=</span>&nbsp;<span class="num" id="6169306">0</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6169309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169312">return</span>&nbsp;<span class="ident" id="6169319">c</span><br>
<span class="lineno"></span><span class="op" id="6169321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6169324">//&nbsp;peekByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input&nbsp;reader&nbsp;but&nbsp;does&nbsp;not&nbsp;advance&nbsp;beyond&nbsp;it.</span><br>
<span class="lineno">60</span><span class="comment" id="6169412">//&nbsp;If&nbsp;skipSpace&nbsp;is&nbsp;set,&nbsp;peekByte&nbsp;skips&nbsp;leading&nbsp;spaces&nbsp;and&nbsp;comments.</span><br>
<span class="lineno"></span><span class="keyword" id="6169480">func</span>&nbsp;<span class="op" id="6169485">(</span><span class="ident" id="6169486">r</span>&nbsp;<span class="op" id="6169488">*</span><span class="ident" id="6169489">importReader</span><span class="op" id="6169501">)</span>&nbsp;<span class="ident" id="6169503">peekByte</span><span class="op" id="6169511">(</span><span class="ident" id="6169512">skipSpace</span>&nbsp;<span class="builtintype" id="6169522">bool</span><span class="op" id="6169526">)</span>&nbsp;<span class="builtintype" id="6169528">byte</span>&nbsp;<span class="op" id="6169533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169536">if</span>&nbsp;<span class="ident" id="6169539">r</span><span class="op" id="6169540">.</span><span class="ident" id="6169541">err</span>&nbsp;<span class="op" id="6169545">!=</span>&nbsp;<span class="ident" id="6169548">nil</span>&nbsp;<span class="op" id="6169552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169556">if</span>&nbsp;<span class="ident" id="6169559">r</span><span class="op" id="6169560">.</span><span class="ident" id="6169561">nerr</span><span class="op" id="6169565">++</span><span class="op" id="6169567">;</span>&nbsp;<span class="ident" id="6169569">r</span><span class="op" id="6169570">.</span><span class="ident" id="6169571">nerr</span>&nbsp;<span class="op" id="6169576">&gt;</span>&nbsp;<span class="num" id="6169578">10000</span>&nbsp;<span class="op" id="6169584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6169589">panic</span><span class="op" id="6169594">(</span><span class="string" id="6169595">&#34;go/build:&nbsp;import&nbsp;reader&nbsp;looping&#34;</span><span class="op" id="6169628">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6169632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169636">return</span>&nbsp;<span class="num" id="6169643">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6169646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6169650">//&nbsp;Use&nbsp;r.peek&nbsp;as&nbsp;first&nbsp;input&nbsp;byte.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6169686">//&nbsp;Don&#39;t&nbsp;just&nbsp;return&nbsp;r.peek&nbsp;here:&nbsp;it&nbsp;might&nbsp;have&nbsp;been&nbsp;left&nbsp;by&nbsp;peekByte(false)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6169764">//&nbsp;and&nbsp;this&nbsp;might&nbsp;be&nbsp;peekByte(true).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169802">c</span>&nbsp;<span class="op" id="6169804">:=</span>&nbsp;<span class="ident" id="6169807">r</span><span class="op" id="6169808">.</span><span class="ident" id="6169809">peek</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169815">if</span>&nbsp;<span class="ident" id="6169818">c</span>&nbsp;<span class="op" id="6169820">==</span>&nbsp;<span class="num" id="6169823">0</span>&nbsp;<span class="op" id="6169825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169829">c</span>&nbsp;<span class="op" id="6169831">=</span>&nbsp;<span class="ident" id="6169833">r</span><span class="op" id="6169834">.</span><span class="ident" id="6169835">readByte</span><span class="op" id="6169843">(</span><span class="op" id="6169844">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6169847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169850">for</span>&nbsp;<span class="ident" id="6169854">r</span><span class="op" id="6169855">.</span><span class="ident" id="6169856">err</span>&nbsp;<span class="op" id="6169860">==</span>&nbsp;<span class="ident" id="6169863">nil</span>&nbsp;<span class="op" id="6169867">&amp;&amp;</span>&nbsp;<span class="op" id="6169870">!</span><span class="ident" id="6169871">r</span><span class="op" id="6169872">.</span><span class="ident" id="6169873">eof</span>&nbsp;<span class="op" id="6169877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169881">if</span>&nbsp;<span class="ident" id="6169884">skipSpace</span>&nbsp;<span class="op" id="6169894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6169899">//&nbsp;For&nbsp;the&nbsp;purposes&nbsp;of&nbsp;this&nbsp;reader,&nbsp;semicolons&nbsp;are&nbsp;never&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6169972">//&nbsp;understand&nbsp;the&nbsp;input&nbsp;and&nbsp;are&nbsp;treated&nbsp;as&nbsp;spaces.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170026">switch</span>&nbsp;<span class="ident" id="6170033">c</span>&nbsp;<span class="op" id="6170035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170040">case</span>&nbsp;<span class="string" id="6170045">&#39;&nbsp;&#39;</span><span class="op" id="6170048">,</span>&nbsp;<span class="string" id="6170050">&#39;\f&#39;</span><span class="op" id="6170054">,</span>&nbsp;<span class="string" id="6170056">&#39;\t&#39;</span><span class="op" id="6170060">,</span>&nbsp;<span class="string" id="6170062">&#39;\r&#39;</span><span class="op" id="6170066">,</span>&nbsp;<span class="string" id="6170068">&#39;\n&#39;</span><span class="op" id="6170072">,</span>&nbsp;<span class="string" id="6170074">&#39;;&#39;</span><span class="op" id="6170077">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170083">c</span>&nbsp;<span class="op" id="6170085">=</span>&nbsp;<span class="ident" id="6170087">r</span><span class="op" id="6170088">.</span><span class="ident" id="6170089">readByte</span><span class="op" id="6170097">(</span><span class="op" id="6170098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170104">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170117">case</span>&nbsp;<span class="string" id="6170122">&#39;/&#39;</span><span class="op" id="6170125">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170131">c</span>&nbsp;<span class="op" id="6170133">=</span>&nbsp;<span class="ident" id="6170135">r</span><span class="op" id="6170136">.</span><span class="ident" id="6170137">readByte</span><span class="op" id="6170145">(</span><span class="op" id="6170146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170152">if</span>&nbsp;<span class="ident" id="6170155">c</span>&nbsp;<span class="op" id="6170157">==</span>&nbsp;<span class="string" id="6170160">&#39;/&#39;</span>&nbsp;<span class="op" id="6170164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170171">for</span>&nbsp;<span class="ident" id="6170175">c</span>&nbsp;<span class="op" id="6170177">!=</span>&nbsp;<span class="string" id="6170180">&#39;\n&#39;</span>&nbsp;<span class="op" id="6170185">&amp;&amp;</span>&nbsp;<span class="ident" id="6170188">r</span><span class="op" id="6170189">.</span><span class="ident" id="6170190">err</span>&nbsp;<span class="op" id="6170194">==</span>&nbsp;<span class="ident" id="6170197">nil</span>&nbsp;<span class="op" id="6170201">&amp;&amp;</span>&nbsp;<span class="op" id="6170204">!</span><span class="ident" id="6170205">r</span><span class="op" id="6170206">.</span><span class="ident" id="6170207">eof</span>&nbsp;<span class="op" id="6170211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170219">c</span>&nbsp;<span class="op" id="6170221">=</span>&nbsp;<span class="ident" id="6170223">r</span><span class="op" id="6170224">.</span><span class="ident" id="6170225">readByte</span><span class="op" id="6170233">(</span><span class="op" id="6170234">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6170241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6170247">}</span>&nbsp;<span class="keyword" id="6170249">else</span>&nbsp;<span class="keyword" id="6170254">if</span>&nbsp;<span class="ident" id="6170257">c</span>&nbsp;<span class="op" id="6170259">==</span>&nbsp;<span class="string" id="6170262">&#39;*&#39;</span>&nbsp;<span class="op" id="6170266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170273">var</span>&nbsp;<span class="ident" id="6170277">c1</span>&nbsp;<span class="builtintype" id="6170280">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170290">for</span>&nbsp;<span class="op" id="6170294">(</span><span class="ident" id="6170295">c</span>&nbsp;<span class="op" id="6170297">!=</span>&nbsp;<span class="string" id="6170300">&#39;*&#39;</span>&nbsp;<span class="op" id="6170304">||</span>&nbsp;<span class="ident" id="6170307">c1</span>&nbsp;<span class="op" id="6170310">!=</span>&nbsp;<span class="string" id="6170313">&#39;/&#39;</span><span class="op" id="6170316">)</span>&nbsp;<span class="op" id="6170318">&amp;&amp;</span>&nbsp;<span class="ident" id="6170321">r</span><span class="op" id="6170322">.</span><span class="ident" id="6170323">err</span>&nbsp;<span class="op" id="6170327">==</span>&nbsp;<span class="ident" id="6170330">nil</span>&nbsp;<span class="op" id="6170334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170342">if</span>&nbsp;<span class="ident" id="6170345">r</span><span class="op" id="6170346">.</span><span class="ident" id="6170347">eof</span>&nbsp;<span class="op" id="6170351">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170360">r</span><span class="op" id="6170361">.</span><span class="ident" id="6170362">syntaxError</span><span class="op" id="6170373">(</span><span class="op" id="6170374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6170382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170390">c</span><span class="op" id="6170391">,</span>&nbsp;<span class="ident" id="6170393">c1</span>&nbsp;<span class="op" id="6170396">=</span>&nbsp;<span class="ident" id="6170398">c1</span><span class="op" id="6170400">,</span>&nbsp;<span class="ident" id="6170402">r</span><span class="op" id="6170403">.</span><span class="ident" id="6170404">readByte</span><span class="op" id="6170412">(</span><span class="op" id="6170413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6170420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6170426">}</span>&nbsp;<span class="keyword" id="6170428">else</span>&nbsp;<span class="op" id="6170433">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170440">r</span><span class="op" id="6170441">.</span><span class="ident" id="6170442">syntaxError</span><span class="op" id="6170453">(</span><span class="op" id="6170454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6170460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170466">c</span>&nbsp;<span class="op" id="6170468">=</span>&nbsp;<span class="ident" id="6170470">r</span><span class="op" id="6170471">.</span><span class="ident" id="6170472">readByte</span><span class="op" id="6170480">(</span><span class="op" id="6170481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170487">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6170499">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6170503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170507">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6170514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170517">r</span><span class="op" id="6170518">.</span><span class="ident" id="6170519">peek</span>&nbsp;<span class="op" id="6170524">=</span>&nbsp;<span class="ident" id="6170526">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170529">return</span>&nbsp;<span class="ident" id="6170536">r</span><span class="op" id="6170537">.</span><span class="ident" id="6170538">peek</span><br>
<span class="lineno">110</span><span class="op" id="6170543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6170546">//&nbsp;nextByte&nbsp;is&nbsp;like&nbsp;peekByte&nbsp;but&nbsp;advances&nbsp;beyond&nbsp;the&nbsp;returned&nbsp;byte.</span><br>
<span class="lineno"></span><span class="keyword" id="6170614">func</span>&nbsp;<span class="op" id="6170619">(</span><span class="ident" id="6170620">r</span>&nbsp;<span class="op" id="6170622">*</span><span class="ident" id="6170623">importReader</span><span class="op" id="6170635">)</span>&nbsp;<span class="ident" id="6170637">nextByte</span><span class="op" id="6170645">(</span><span class="ident" id="6170646">skipSpace</span>&nbsp;<span class="builtintype" id="6170656">bool</span><span class="op" id="6170660">)</span>&nbsp;<span class="builtintype" id="6170662">byte</span>&nbsp;<span class="op" id="6170667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170670">c</span>&nbsp;<span class="op" id="6170672">:=</span>&nbsp;<span class="ident" id="6170675">r</span><span class="op" id="6170676">.</span><span class="ident" id="6170677">peekByte</span><span class="op" id="6170685">(</span><span class="ident" id="6170686">skipSpace</span><span class="op" id="6170695">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170698">r</span><span class="op" id="6170699">.</span><span class="ident" id="6170700">peek</span>&nbsp;<span class="op" id="6170705">=</span>&nbsp;<span class="num" id="6170707">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170710">return</span>&nbsp;<span class="ident" id="6170717">c</span><br>
<span class="lineno"></span><span class="op" id="6170719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6170722">//&nbsp;readKeyword&nbsp;reads&nbsp;the&nbsp;given&nbsp;keyword&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">120</span><span class="comment" id="6170777">//&nbsp;If&nbsp;the&nbsp;keyword&nbsp;is&nbsp;not&nbsp;present,&nbsp;readKeyword&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="6170847">func</span>&nbsp;<span class="op" id="6170852">(</span><span class="ident" id="6170853">r</span>&nbsp;<span class="op" id="6170855">*</span><span class="ident" id="6170856">importReader</span><span class="op" id="6170868">)</span>&nbsp;<span class="ident" id="6170870">readKeyword</span><span class="op" id="6170881">(</span><span class="ident" id="6170882">kw</span>&nbsp;<span class="builtintype" id="6170885">string</span><span class="op" id="6170891">)</span>&nbsp;<span class="op" id="6170893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170896">r</span><span class="op" id="6170897">.</span><span class="ident" id="6170898">peekByte</span><span class="op" id="6170906">(</span><span class="builtintype" id="6170907">true</span><span class="op" id="6170911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170914">for</span>&nbsp;<span class="ident" id="6170918">i</span>&nbsp;<span class="op" id="6170920">:=</span>&nbsp;<span class="num" id="6170923">0</span><span class="op" id="6170924">;</span>&nbsp;<span class="ident" id="6170926">i</span>&nbsp;<span class="op" id="6170928">&lt;</span>&nbsp;<span class="builtinfunc" id="6170930">len</span><span class="op" id="6170933">(</span><span class="ident" id="6170934">kw</span><span class="op" id="6170936">)</span><span class="op" id="6170937">;</span>&nbsp;<span class="ident" id="6170939">i</span><span class="op" id="6170940">++</span>&nbsp;<span class="op" id="6170943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170947">if</span>&nbsp;<span class="ident" id="6170950">r</span><span class="op" id="6170951">.</span><span class="ident" id="6170952">nextByte</span><span class="op" id="6170960">(</span><span class="builtintype" id="6170961">false</span><span class="op" id="6170966">)</span>&nbsp;<span class="op" id="6170968">!=</span>&nbsp;<span class="ident" id="6170971">kw</span><span class="op" id="6170973">[</span><span class="ident" id="6170974">i</span><span class="op" id="6170975">]</span>&nbsp;<span class="op" id="6170977">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170982">r</span><span class="op" id="6170983">.</span><span class="ident" id="6170984">syntaxError</span><span class="op" id="6170995">(</span><span class="op" id="6170996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171001">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171016">if</span>&nbsp;<span class="ident" id="6171019">isIdent</span><span class="op" id="6171026">(</span><span class="ident" id="6171027">r</span><span class="op" id="6171028">.</span><span class="ident" id="6171029">peekByte</span><span class="op" id="6171037">(</span><span class="builtintype" id="6171038">false</span><span class="op" id="6171043">)</span><span class="op" id="6171044">)</span>&nbsp;<span class="op" id="6171046">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171050">r</span><span class="op" id="6171051">.</span><span class="ident" id="6171052">syntaxError</span><span class="op" id="6171063">(</span><span class="op" id="6171064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171067">}</span><br>
<span class="lineno"></span><span class="op" id="6171069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6171072">//&nbsp;readIdent&nbsp;reads&nbsp;an&nbsp;identifier&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">135</span><span class="comment" id="6171121">//&nbsp;If&nbsp;an&nbsp;identifier&nbsp;is&nbsp;not&nbsp;present,&nbsp;readIdent&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="6171191">func</span>&nbsp;<span class="op" id="6171196">(</span><span class="ident" id="6171197">r</span>&nbsp;<span class="op" id="6171199">*</span><span class="ident" id="6171200">importReader</span><span class="op" id="6171212">)</span>&nbsp;<span class="ident" id="6171214">readIdent</span><span class="op" id="6171223">(</span><span class="op" id="6171224">)</span>&nbsp;<span class="op" id="6171226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171229">c</span>&nbsp;<span class="op" id="6171231">:=</span>&nbsp;<span class="ident" id="6171234">r</span><span class="op" id="6171235">.</span><span class="ident" id="6171236">peekByte</span><span class="op" id="6171244">(</span><span class="builtintype" id="6171245">true</span><span class="op" id="6171249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171252">if</span>&nbsp;<span class="op" id="6171255">!</span><span class="ident" id="6171256">isIdent</span><span class="op" id="6171263">(</span><span class="ident" id="6171264">c</span><span class="op" id="6171265">)</span>&nbsp;<span class="op" id="6171267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171271">r</span><span class="op" id="6171272">.</span><span class="ident" id="6171273">syntaxError</span><span class="op" id="6171284">(</span><span class="op" id="6171285">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171289">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171300">for</span>&nbsp;<span class="ident" id="6171304">isIdent</span><span class="op" id="6171311">(</span><span class="ident" id="6171312">r</span><span class="op" id="6171313">.</span><span class="ident" id="6171314">peekByte</span><span class="op" id="6171322">(</span><span class="builtintype" id="6171323">false</span><span class="op" id="6171328">)</span><span class="op" id="6171329">)</span>&nbsp;<span class="op" id="6171331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171335">r</span><span class="op" id="6171336">.</span><span class="ident" id="6171337">peek</span>&nbsp;<span class="op" id="6171342">=</span>&nbsp;<span class="num" id="6171344">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171347">}</span><br>
<span class="lineno">145</span><span class="op" id="6171349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6171352">//&nbsp;readString&nbsp;reads&nbsp;a&nbsp;quoted&nbsp;string&nbsp;literal&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="6171412">//&nbsp;If&nbsp;an&nbsp;identifier&nbsp;is&nbsp;not&nbsp;present,&nbsp;readString&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="6171483">func</span>&nbsp;<span class="op" id="6171488">(</span><span class="ident" id="6171489">r</span>&nbsp;<span class="op" id="6171491">*</span><span class="ident" id="6171492">importReader</span><span class="op" id="6171504">)</span>&nbsp;<span class="ident" id="6171506">readString</span><span class="op" id="6171516">(</span><span class="op" id="6171517">)</span>&nbsp;<span class="op" id="6171519">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171522">switch</span>&nbsp;<span class="ident" id="6171529">r</span><span class="op" id="6171530">.</span><span class="ident" id="6171531">nextByte</span><span class="op" id="6171539">(</span><span class="builtintype" id="6171540">true</span><span class="op" id="6171544">)</span>&nbsp;<span class="op" id="6171546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171549">case</span>&nbsp;<span class="string" id="6171554">&#39;`&#39;</span><span class="op" id="6171557">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171561">for</span>&nbsp;<span class="ident" id="6171565">r</span><span class="op" id="6171566">.</span><span class="ident" id="6171567">err</span>&nbsp;<span class="op" id="6171571">==</span>&nbsp;<span class="ident" id="6171574">nil</span>&nbsp;<span class="op" id="6171578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171583">if</span>&nbsp;<span class="ident" id="6171586">r</span><span class="op" id="6171587">.</span><span class="ident" id="6171588">nextByte</span><span class="op" id="6171596">(</span><span class="builtintype" id="6171597">false</span><span class="op" id="6171602">)</span>&nbsp;<span class="op" id="6171604">==</span>&nbsp;<span class="string" id="6171607">&#39;`&#39;</span>&nbsp;<span class="op" id="6171611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171617">break</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171631">if</span>&nbsp;<span class="ident" id="6171634">r</span><span class="op" id="6171635">.</span><span class="ident" id="6171636">eof</span>&nbsp;<span class="op" id="6171640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171646">r</span><span class="op" id="6171647">.</span><span class="ident" id="6171648">syntaxError</span><span class="op" id="6171659">(</span><span class="op" id="6171660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171669">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171672">case</span>&nbsp;<span class="string" id="6171677">&#39;&#34;&#39;</span><span class="op" id="6171680">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171684">for</span>&nbsp;<span class="ident" id="6171688">r</span><span class="op" id="6171689">.</span><span class="ident" id="6171690">err</span>&nbsp;<span class="op" id="6171694">==</span>&nbsp;<span class="ident" id="6171697">nil</span>&nbsp;<span class="op" id="6171701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171706">c</span>&nbsp;<span class="op" id="6171708">:=</span>&nbsp;<span class="ident" id="6171711">r</span><span class="op" id="6171712">.</span><span class="ident" id="6171713">nextByte</span><span class="op" id="6171721">(</span><span class="builtintype" id="6171722">false</span><span class="op" id="6171727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171732">if</span>&nbsp;<span class="ident" id="6171735">c</span>&nbsp;<span class="op" id="6171737">==</span>&nbsp;<span class="string" id="6171740">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6171744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171750">break</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171764">if</span>&nbsp;<span class="ident" id="6171767">r</span><span class="op" id="6171768">.</span><span class="ident" id="6171769">eof</span>&nbsp;<span class="op" id="6171773">||</span>&nbsp;<span class="ident" id="6171776">c</span>&nbsp;<span class="op" id="6171778">==</span>&nbsp;<span class="string" id="6171781">&#39;\n&#39;</span>&nbsp;<span class="op" id="6171786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171792">r</span><span class="op" id="6171793">.</span><span class="ident" id="6171794">syntaxError</span><span class="op" id="6171805">(</span><span class="op" id="6171806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171816">if</span>&nbsp;<span class="ident" id="6171819">c</span>&nbsp;<span class="op" id="6171821">==</span>&nbsp;<span class="string" id="6171824">&#39;\\&#39;</span>&nbsp;<span class="op" id="6171829">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171835">r</span><span class="op" id="6171836">.</span><span class="ident" id="6171837">nextByte</span><span class="op" id="6171845">(</span><span class="builtintype" id="6171846">false</span><span class="op" id="6171851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171863">default</span><span class="op" id="6171870">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171874">r</span><span class="op" id="6171875">.</span><span class="ident" id="6171876">syntaxError</span><span class="op" id="6171887">(</span><span class="op" id="6171888">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171891">}</span><br>
<span class="lineno"></span><span class="op" id="6171893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6171896">//&nbsp;readImport&nbsp;reads&nbsp;an&nbsp;import&nbsp;clause&nbsp;-&nbsp;optional&nbsp;identifier&nbsp;followed&nbsp;by&nbsp;quoted&nbsp;string&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="6171983">//&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">180</span><span class="keyword" id="6172002">func</span>&nbsp;<span class="op" id="6172007">(</span><span class="ident" id="6172008">r</span>&nbsp;<span class="op" id="6172010">*</span><span class="ident" id="6172011">importReader</span><span class="op" id="6172023">)</span>&nbsp;<span class="ident" id="6172025">readImport</span><span class="op" id="6172035">(</span><span class="op" id="6172036">)</span>&nbsp;<span class="op" id="6172038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172041">c</span>&nbsp;<span class="op" id="6172043">:=</span>&nbsp;<span class="ident" id="6172046">r</span><span class="op" id="6172047">.</span><span class="ident" id="6172048">peekByte</span><span class="op" id="6172056">(</span><span class="builtintype" id="6172057">true</span><span class="op" id="6172061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172064">if</span>&nbsp;<span class="ident" id="6172067">c</span>&nbsp;<span class="op" id="6172069">==</span>&nbsp;<span class="string" id="6172072">&#39;.&#39;</span>&nbsp;<span class="op" id="6172076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172080">r</span><span class="op" id="6172081">.</span><span class="ident" id="6172082">peek</span>&nbsp;<span class="op" id="6172087">=</span>&nbsp;<span class="num" id="6172089">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172092">}</span>&nbsp;<span class="keyword" id="6172094">else</span>&nbsp;<span class="keyword" id="6172099">if</span>&nbsp;<span class="ident" id="6172102">isIdent</span><span class="op" id="6172109">(</span><span class="ident" id="6172110">c</span><span class="op" id="6172111">)</span>&nbsp;<span class="op" id="6172113">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172117">r</span><span class="op" id="6172118">.</span><span class="ident" id="6172119">readIdent</span><span class="op" id="6172128">(</span><span class="op" id="6172129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172135">r</span><span class="op" id="6172136">.</span><span class="ident" id="6172137">readString</span><span class="op" id="6172147">(</span><span class="op" id="6172148">)</span><br>
<span class="lineno"></span><span class="op" id="6172150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="6172153">//&nbsp;readComments&nbsp;is&nbsp;like&nbsp;ioutil.ReadAll,&nbsp;except&nbsp;that&nbsp;it&nbsp;only&nbsp;reads&nbsp;the&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="6172231">//&nbsp;block&nbsp;of&nbsp;comments&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6172265">func</span>&nbsp;<span class="ident" id="6172270">readComments</span><span class="op" id="6172282">(</span><span class="ident" id="6172283">f</span>&nbsp;<span class="ident" id="6172285">io</span><span class="op" id="6172287">.</span><span class="ident" id="6172288">Reader</span><span class="op" id="6172294">)</span>&nbsp;<span class="op" id="6172296">(</span><span class="op" id="6172297">[</span><span class="op" id="6172298">]</span><span class="builtintype" id="6172299">byte</span><span class="op" id="6172303">,</span>&nbsp;<span class="builtintype" id="6172305">error</span><span class="op" id="6172310">)</span>&nbsp;<span class="op" id="6172312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172315">r</span>&nbsp;<span class="op" id="6172317">:=</span>&nbsp;<span class="op" id="6172320">&amp;</span><span class="ident" id="6172321">importReader</span><span class="op" id="6172333">{</span><span class="ident" id="6172334">b</span><span class="op" id="6172335">:</span>&nbsp;<span class="ident" id="6172337">bufio</span><span class="op" id="6172342">.</span><span class="ident" id="6172343">NewReader</span><span class="op" id="6172352">(</span><span class="ident" id="6172353">f</span><span class="op" id="6172354">)</span><span class="op" id="6172355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172358">r</span><span class="op" id="6172359">.</span><span class="ident" id="6172360">peekByte</span><span class="op" id="6172368">(</span><span class="builtintype" id="6172369">true</span><span class="op" id="6172373">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172376">if</span>&nbsp;<span class="ident" id="6172379">r</span><span class="op" id="6172380">.</span><span class="ident" id="6172381">err</span>&nbsp;<span class="op" id="6172385">==</span>&nbsp;<span class="ident" id="6172388">nil</span>&nbsp;<span class="op" id="6172392">&amp;&amp;</span>&nbsp;<span class="op" id="6172395">!</span><span class="ident" id="6172396">r</span><span class="op" id="6172397">.</span><span class="ident" id="6172398">eof</span>&nbsp;<span class="op" id="6172402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6172406">//&nbsp;Didn&#39;t&nbsp;reach&nbsp;EOF,&nbsp;so&nbsp;must&nbsp;have&nbsp;found&nbsp;a&nbsp;non-space&nbsp;byte.&nbsp;Remove&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172477">r</span><span class="op" id="6172478">.</span><span class="ident" id="6172479">buf</span>&nbsp;<span class="op" id="6172483">=</span>&nbsp;<span class="ident" id="6172485">r</span><span class="op" id="6172486">.</span><span class="ident" id="6172487">buf</span><span class="op" id="6172490">[</span><span class="op" id="6172491">:</span><span class="builtinfunc" id="6172492">len</span><span class="op" id="6172495">(</span><span class="ident" id="6172496">r</span><span class="op" id="6172497">.</span><span class="ident" id="6172498">buf</span><span class="op" id="6172501">)</span><span class="op" id="6172502">-</span><span class="num" id="6172503">1</span><span class="op" id="6172504">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172510">return</span>&nbsp;<span class="ident" id="6172517">r</span><span class="op" id="6172518">.</span><span class="ident" id="6172519">buf</span><span class="op" id="6172522">,</span>&nbsp;<span class="ident" id="6172524">r</span><span class="op" id="6172525">.</span><span class="ident" id="6172526">err</span><br>
<span class="lineno">200</span><span class="op" id="6172530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6172533">//&nbsp;readImports&nbsp;is&nbsp;like&nbsp;ioutil.ReadAll,&nbsp;except&nbsp;that&nbsp;it&nbsp;expects&nbsp;a&nbsp;Go&nbsp;file&nbsp;as&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="6172614">//&nbsp;and&nbsp;stops&nbsp;reading&nbsp;the&nbsp;input&nbsp;once&nbsp;the&nbsp;imports&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="keyword" id="6172678">func</span>&nbsp;<span class="ident" id="6172683">readImports</span><span class="op" id="6172694">(</span><span class="ident" id="6172695">f</span>&nbsp;<span class="ident" id="6172697">io</span><span class="op" id="6172699">.</span><span class="ident" id="6172700">Reader</span><span class="op" id="6172706">,</span>&nbsp;<span class="ident" id="6172708">reportSyntaxError</span>&nbsp;<span class="builtintype" id="6172726">bool</span><span class="op" id="6172730">)</span>&nbsp;<span class="op" id="6172732">(</span><span class="op" id="6172733">[</span><span class="op" id="6172734">]</span><span class="builtintype" id="6172735">byte</span><span class="op" id="6172739">,</span>&nbsp;<span class="builtintype" id="6172741">error</span><span class="op" id="6172746">)</span>&nbsp;<span class="op" id="6172748">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172751">r</span>&nbsp;<span class="op" id="6172753">:=</span>&nbsp;<span class="op" id="6172756">&amp;</span><span class="ident" id="6172757">importReader</span><span class="op" id="6172769">{</span><span class="ident" id="6172770">b</span><span class="op" id="6172771">:</span>&nbsp;<span class="ident" id="6172773">bufio</span><span class="op" id="6172778">.</span><span class="ident" id="6172779">NewReader</span><span class="op" id="6172788">(</span><span class="ident" id="6172789">f</span><span class="op" id="6172790">)</span><span class="op" id="6172791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172795">r</span><span class="op" id="6172796">.</span><span class="ident" id="6172797">readKeyword</span><span class="op" id="6172808">(</span><span class="string" id="6172809">&#34;package&#34;</span><span class="op" id="6172818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172821">r</span><span class="op" id="6172822">.</span><span class="ident" id="6172823">readIdent</span><span class="op" id="6172832">(</span><span class="op" id="6172833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172836">for</span>&nbsp;<span class="ident" id="6172840">r</span><span class="op" id="6172841">.</span><span class="ident" id="6172842">peekByte</span><span class="op" id="6172850">(</span><span class="builtintype" id="6172851">true</span><span class="op" id="6172855">)</span>&nbsp;<span class="op" id="6172857">==</span>&nbsp;<span class="string" id="6172860">&#39;i&#39;</span>&nbsp;<span class="op" id="6172864">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172868">r</span><span class="op" id="6172869">.</span><span class="ident" id="6172870">readKeyword</span><span class="op" id="6172881">(</span><span class="string" id="6172882">&#34;import&#34;</span><span class="op" id="6172890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172894">if</span>&nbsp;<span class="ident" id="6172897">r</span><span class="op" id="6172898">.</span><span class="ident" id="6172899">peekByte</span><span class="op" id="6172907">(</span><span class="builtintype" id="6172908">true</span><span class="op" id="6172912">)</span>&nbsp;<span class="op" id="6172914">==</span>&nbsp;<span class="string" id="6172917">&#39;(&#39;</span>&nbsp;<span class="op" id="6172921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172926">r</span><span class="op" id="6172927">.</span><span class="ident" id="6172928">nextByte</span><span class="op" id="6172936">(</span><span class="builtintype" id="6172937">false</span><span class="op" id="6172942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172947">for</span>&nbsp;<span class="ident" id="6172951">r</span><span class="op" id="6172952">.</span><span class="ident" id="6172953">peekByte</span><span class="op" id="6172961">(</span><span class="builtintype" id="6172962">true</span><span class="op" id="6172966">)</span>&nbsp;<span class="op" id="6172968">!=</span>&nbsp;<span class="string" id="6172971">&#39;)&#39;</span>&nbsp;<span class="op" id="6172975">&amp;&amp;</span>&nbsp;<span class="ident" id="6172978">r</span><span class="op" id="6172979">.</span><span class="ident" id="6172980">err</span>&nbsp;<span class="op" id="6172984">==</span>&nbsp;<span class="ident" id="6172987">nil</span>&nbsp;<span class="op" id="6172991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172997">r</span><span class="op" id="6172998">.</span><span class="ident" id="6172999">readImport</span><span class="op" id="6173009">(</span><span class="op" id="6173010">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173020">r</span><span class="op" id="6173021">.</span><span class="ident" id="6173022">nextByte</span><span class="op" id="6173030">(</span><span class="builtintype" id="6173031">false</span><span class="op" id="6173036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173040">}</span>&nbsp;<span class="keyword" id="6173042">else</span>&nbsp;<span class="op" id="6173047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173052">r</span><span class="op" id="6173053">.</span><span class="ident" id="6173054">readImport</span><span class="op" id="6173064">(</span><span class="op" id="6173065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173069">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6173076">//&nbsp;If&nbsp;we&nbsp;stopped&nbsp;successfully&nbsp;before&nbsp;EOF,&nbsp;we&nbsp;read&nbsp;a&nbsp;byte&nbsp;that&nbsp;told&nbsp;us&nbsp;we&nbsp;were&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6173161">//&nbsp;Return&nbsp;all&nbsp;but&nbsp;that&nbsp;last&nbsp;byte,&nbsp;which&nbsp;would&nbsp;cause&nbsp;a&nbsp;syntax&nbsp;error&nbsp;if&nbsp;we&nbsp;let&nbsp;it&nbsp;through.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173251">if</span>&nbsp;<span class="ident" id="6173254">r</span><span class="op" id="6173255">.</span><span class="ident" id="6173256">err</span>&nbsp;<span class="op" id="6173260">==</span>&nbsp;<span class="ident" id="6173263">nil</span>&nbsp;<span class="op" id="6173267">&amp;&amp;</span>&nbsp;<span class="op" id="6173270">!</span><span class="ident" id="6173271">r</span><span class="op" id="6173272">.</span><span class="ident" id="6173273">eof</span>&nbsp;<span class="op" id="6173277">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173281">return</span>&nbsp;<span class="ident" id="6173288">r</span><span class="op" id="6173289">.</span><span class="ident" id="6173290">buf</span><span class="op" id="6173293">[</span><span class="op" id="6173294">:</span><span class="builtinfunc" id="6173295">len</span><span class="op" id="6173298">(</span><span class="ident" id="6173299">r</span><span class="op" id="6173300">.</span><span class="ident" id="6173301">buf</span><span class="op" id="6173304">)</span><span class="op" id="6173305">-</span><span class="num" id="6173306">1</span><span class="op" id="6173307">]</span><span class="op" id="6173308">,</span>&nbsp;<span class="ident" id="6173310">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6173319">//&nbsp;If&nbsp;we&nbsp;stopped&nbsp;for&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;consume&nbsp;the&nbsp;whole&nbsp;file&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6173388">//&nbsp;we&nbsp;are&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;the&nbsp;errors&nbsp;that&nbsp;go/parser&nbsp;returns.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173455">if</span>&nbsp;<span class="ident" id="6173458">r</span><span class="op" id="6173459">.</span><span class="ident" id="6173460">err</span>&nbsp;<span class="op" id="6173464">==</span>&nbsp;<span class="ident" id="6173467">errSyntax</span>&nbsp;<span class="op" id="6173477">&amp;&amp;</span>&nbsp;<span class="op" id="6173480">!</span><span class="ident" id="6173481">reportSyntaxError</span>&nbsp;<span class="op" id="6173499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173503">r</span><span class="op" id="6173504">.</span><span class="ident" id="6173505">err</span>&nbsp;<span class="op" id="6173509">=</span>&nbsp;<span class="ident" id="6173511">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173517">for</span>&nbsp;<span class="ident" id="6173521">r</span><span class="op" id="6173522">.</span><span class="ident" id="6173523">err</span>&nbsp;<span class="op" id="6173527">==</span>&nbsp;<span class="ident" id="6173530">nil</span>&nbsp;<span class="op" id="6173534">&amp;&amp;</span>&nbsp;<span class="op" id="6173537">!</span><span class="ident" id="6173538">r</span><span class="op" id="6173539">.</span><span class="ident" id="6173540">eof</span>&nbsp;<span class="op" id="6173544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173549">r</span><span class="op" id="6173550">.</span><span class="ident" id="6173551">readByte</span><span class="op" id="6173559">(</span><span class="op" id="6173560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173564">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173571">return</span>&nbsp;<span class="ident" id="6173578">r</span><span class="op" id="6173579">.</span><span class="ident" id="6173580">buf</span><span class="op" id="6173583">,</span>&nbsp;<span class="ident" id="6173585">r</span><span class="op" id="6173586">.</span><span class="ident" id="6173587">err</span><br>
<span class="lineno"></span><span class="op" id="6173591">}</span>
</div>
</body>
</html>
