<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/scanner</h2>
<ul>
<li><a href="/gostd/text/scanner/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/text/scanner/scanner_test.go.html">scanner_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6327042">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6327097">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6327151">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6327202">//&nbsp;Package&nbsp;scanner&nbsp;provides&nbsp;a&nbsp;scanner&nbsp;and&nbsp;tokenizer&nbsp;for&nbsp;UTF-8-encoded&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="6327278">//&nbsp;It&nbsp;takes&nbsp;an&nbsp;io.Reader&nbsp;providing&nbsp;the&nbsp;source,&nbsp;which&nbsp;then&nbsp;can&nbsp;be&nbsp;tokenized</span><br>
<span class="lineno"></span><span class="comment" id="6327353">//&nbsp;through&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;the&nbsp;Scan&nbsp;function.&nbsp;&nbsp;For&nbsp;compatibility&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6327425">//&nbsp;existing&nbsp;tools,&nbsp;the&nbsp;NUL&nbsp;character&nbsp;is&nbsp;not&nbsp;allowed.&nbsp;If&nbsp;the&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="6327501">//&nbsp;in&nbsp;the&nbsp;source&nbsp;is&nbsp;a&nbsp;UTF-8&nbsp;encoded&nbsp;byte&nbsp;order&nbsp;mark&nbsp;(BOM),&nbsp;it&nbsp;is&nbsp;discarded.</span><br>
<span class="lineno">10</span><span class="comment" id="6327577">//</span><br>
<span class="lineno"></span><span class="comment" id="6327580">//&nbsp;By&nbsp;default,&nbsp;a&nbsp;Scanner&nbsp;skips&nbsp;white&nbsp;space&nbsp;and&nbsp;Go&nbsp;comments&nbsp;and&nbsp;recognizes&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="6327658">//&nbsp;literals&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;Go&nbsp;language&nbsp;specification.&nbsp;&nbsp;It&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6327726">//&nbsp;customized&nbsp;to&nbsp;recognize&nbsp;only&nbsp;a&nbsp;subset&nbsp;of&nbsp;those&nbsp;literals&nbsp;and&nbsp;to&nbsp;recognize</span><br>
<span class="lineno"></span><span class="comment" id="6327802">//&nbsp;different&nbsp;identifier&nbsp;and&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno">15</span><span class="comment" id="6327854">//</span><br>
<span class="lineno"></span><span class="comment" id="6327857">//&nbsp;Basic&nbsp;usage&nbsp;pattern:</span><br>
<span class="lineno"></span><span class="comment" id="6327881">//</span><br>
<span class="lineno"></span><span class="comment" id="6327884">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;s&nbsp;scanner.Scanner</span><br>
<span class="lineno"></span><span class="comment" id="6327909">//&nbsp;&nbsp;&nbsp;&nbsps.Init(src)</span><br>
<span class="lineno">20</span><span class="comment" id="6327924">//&nbsp;&nbsp;&nbsp;&nbsptok&nbsp;:=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="6327943">//&nbsp;&nbsp;&nbsp;&nbspfor&nbsp;tok&nbsp;!=&nbsp;scanner.EOF&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6327971">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;do&nbsp;something&nbsp;with&nbsp;tok</span><br>
<span class="lineno"></span><span class="comment" id="6328000">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsptok&nbsp;=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="6328019">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno">25</span><span class="comment" id="6328024">//</span><br>
<span class="lineno"></span><span class="keyword" id="6328027">package</span>&nbsp;<span class="ident" id="6328035">scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6328044">import</span>&nbsp;<span class="op" id="6328051">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6328054">&#34;bytes&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6328063">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6328070">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6328076">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6328082">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6328093">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">35</span><span class="op" id="6328108">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6328111">//&nbsp;A&nbsp;source&nbsp;position&nbsp;is&nbsp;represented&nbsp;by&nbsp;a&nbsp;Position&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="6328168">//&nbsp;A&nbsp;position&nbsp;is&nbsp;valid&nbsp;if&nbsp;Line&nbsp;&gt;&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="6328204">type</span>&nbsp;<span class="ident" id="6328209">Position</span>&nbsp;<span class="keyword" id="6328218">struct</span>&nbsp;<span class="op" id="6328225">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328228">Filename</span>&nbsp;<span class="builtintype" id="6328237">string</span>&nbsp;<span class="comment" id="6328244">//&nbsp;filename,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328265">Offset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6328274">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6328281">//&nbsp;byte&nbsp;offset,&nbsp;starting&nbsp;at&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328312">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6328321">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6328328">//&nbsp;line&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328359">Column</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6328368">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6328375">//&nbsp;column&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1&nbsp;(character&nbsp;count&nbsp;per&nbsp;line)</span><br>
<span class="lineno"></span><span class="op" id="6328434">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="6328437">//&nbsp;IsValid&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;position&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="6328487">func</span>&nbsp;<span class="op" id="6328492">(</span><span class="ident" id="6328493">pos</span>&nbsp;<span class="op" id="6328497">*</span><span class="ident" id="6328498">Position</span><span class="op" id="6328506">)</span>&nbsp;<span class="ident" id="6328508">IsValid</span><span class="op" id="6328515">(</span><span class="op" id="6328516">)</span>&nbsp;<span class="builtintype" id="6328518">bool</span>&nbsp;<span class="op" id="6328523">{</span>&nbsp;<span class="keyword" id="6328525">return</span>&nbsp;<span class="ident" id="6328532">pos</span><span class="op" id="6328535">.</span><span class="ident" id="6328536">Line</span>&nbsp;<span class="op" id="6328541">&gt;</span>&nbsp;<span class="num" id="6328543">0</span>&nbsp;<span class="op" id="6328545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6328548">func</span>&nbsp;<span class="op" id="6328553">(</span><span class="ident" id="6328554">pos</span>&nbsp;<span class="ident" id="6328558">Position</span><span class="op" id="6328566">)</span>&nbsp;<span class="ident" id="6328568">String</span><span class="op" id="6328574">(</span><span class="op" id="6328575">)</span>&nbsp;<span class="builtintype" id="6328577">string</span>&nbsp;<span class="op" id="6328584">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328587">s</span>&nbsp;<span class="op" id="6328589">:=</span>&nbsp;<span class="ident" id="6328592">pos</span><span class="op" id="6328595">.</span><span class="ident" id="6328596">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328606">if</span>&nbsp;<span class="ident" id="6328609">pos</span><span class="op" id="6328612">.</span><span class="ident" id="6328613">IsValid</span><span class="op" id="6328620">(</span><span class="op" id="6328621">)</span>&nbsp;<span class="op" id="6328623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328627">if</span>&nbsp;<span class="ident" id="6328630">s</span>&nbsp;<span class="op" id="6328632">!=</span>&nbsp;<span class="string" id="6328635">&#34;&#34;</span>&nbsp;<span class="op" id="6328638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328643">s</span>&nbsp;<span class="op" id="6328645">+=</span>&nbsp;<span class="string" id="6328648">&#34;:&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6328654">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328658">s</span>&nbsp;<span class="op" id="6328660">+=</span>&nbsp;<span class="ident" id="6328663">fmt</span><span class="op" id="6328666">.</span><span class="ident" id="6328667">Sprintf</span><span class="op" id="6328674">(</span><span class="string" id="6328675">&#34;%d:%d&#34;</span><span class="op" id="6328682">,</span>&nbsp;<span class="ident" id="6328684">pos</span><span class="op" id="6328687">.</span><span class="ident" id="6328688">Line</span><span class="op" id="6328692">,</span>&nbsp;<span class="ident" id="6328694">pos</span><span class="op" id="6328697">.</span><span class="ident" id="6328698">Column</span><span class="op" id="6328704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6328707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328710">if</span>&nbsp;<span class="ident" id="6328713">s</span>&nbsp;<span class="op" id="6328715">==</span>&nbsp;<span class="string" id="6328718">&#34;&#34;</span>&nbsp;<span class="op" id="6328721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6328725">s</span>&nbsp;<span class="op" id="6328727">=</span>&nbsp;<span class="string" id="6328729">&#34;???&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6328736">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328739">return</span>&nbsp;<span class="ident" id="6328746">s</span><br>
<span class="lineno"></span><span class="op" id="6328748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6328751">//&nbsp;Predefined&nbsp;mode&nbsp;bits&nbsp;to&nbsp;control&nbsp;recognition&nbsp;of&nbsp;tokens.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span><span class="comment" id="6328823">//&nbsp;to&nbsp;configure&nbsp;a&nbsp;Scanner&nbsp;such&nbsp;that&nbsp;it&nbsp;only&nbsp;recognizes&nbsp;(Go)&nbsp;identifiers,</span><br>
<span class="lineno">65</span><span class="comment" id="6328896">//&nbsp;integers,&nbsp;and&nbsp;skips&nbsp;comments,&nbsp;set&nbsp;the&nbsp;Scanner&#39;s&nbsp;Mode&nbsp;field&nbsp;to:</span><br>
<span class="lineno"></span><span class="comment" id="6328962">//</span><br>
<span class="lineno"></span><span class="comment" id="6328965">//&nbsp;&nbsp;&nbsp;&nbspScanIdents&nbsp;|&nbsp;ScanInts&nbsp;|&nbsp;SkipComments</span><br>
<span class="lineno"></span><span class="comment" id="6329005">//</span><br>
<span class="lineno"></span><span class="comment" id="6329008">//&nbsp;With&nbsp;the&nbsp;exceptions&nbsp;of&nbsp;comments,&nbsp;which&nbsp;are&nbsp;skipped&nbsp;if&nbsp;SkipComments&nbsp;is</span><br>
<span class="lineno">70</span><span class="comment" id="6329081">//&nbsp;set,&nbsp;unrecognized&nbsp;tokens&nbsp;are&nbsp;not&nbsp;ignored.&nbsp;Instead,&nbsp;the&nbsp;scanner&nbsp;simply</span><br>
<span class="lineno"></span><span class="comment" id="6329154">//&nbsp;returns&nbsp;the&nbsp;respective&nbsp;individual&nbsp;characters&nbsp;(or&nbsp;possibly&nbsp;sub-tokens).</span><br>
<span class="lineno"></span><span class="comment" id="6329228">//&nbsp;For&nbsp;instance,&nbsp;if&nbsp;the&nbsp;mode&nbsp;is&nbsp;ScanIdents&nbsp;(not&nbsp;ScanStrings),&nbsp;the&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="6329301">//&nbsp;&#34;foo&#34;&nbsp;is&nbsp;scanned&nbsp;as&nbsp;the&nbsp;token&nbsp;sequence&nbsp;&#39;&#34;&#39;&nbsp;Ident&nbsp;&#39;&#34;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="6329358">//</span><br>
<span class="lineno">75</span><span class="keyword" id="6329361">const</span>&nbsp;<span class="op" id="6329367">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329370">ScanIdents</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6329385">=</span>&nbsp;<span class="num" id="6329387">1</span>&nbsp;<span class="op" id="6329389">&lt;&lt;</span>&nbsp;<span class="op" id="6329392">-</span><span class="ident" id="6329393">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329400">ScanInts</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6329415">=</span>&nbsp;<span class="num" id="6329417">1</span>&nbsp;<span class="op" id="6329419">&lt;&lt;</span>&nbsp;<span class="op" id="6329422">-</span><span class="ident" id="6329423">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329428">ScanFloats</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6329443">=</span>&nbsp;<span class="num" id="6329445">1</span>&nbsp;<span class="op" id="6329447">&lt;&lt;</span>&nbsp;<span class="op" id="6329450">-</span><span class="ident" id="6329451">Float</span>&nbsp;<span class="comment" id="6329457">//&nbsp;includes&nbsp;Ints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329475">ScanChars</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6329490">=</span>&nbsp;<span class="num" id="6329492">1</span>&nbsp;<span class="op" id="6329494">&lt;&lt;</span>&nbsp;<span class="op" id="6329497">-</span><span class="ident" id="6329498">Char</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329504">ScanStrings</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6329519">=</span>&nbsp;<span class="num" id="6329521">1</span>&nbsp;<span class="op" id="6329523">&lt;&lt;</span>&nbsp;<span class="op" id="6329526">-</span><span class="ident" id="6329527">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329535">ScanRawStrings</span>&nbsp;<span class="op" id="6329550">=</span>&nbsp;<span class="num" id="6329552">1</span>&nbsp;<span class="op" id="6329554">&lt;&lt;</span>&nbsp;<span class="op" id="6329557">-</span><span class="ident" id="6329558">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329569">ScanComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6329584">=</span>&nbsp;<span class="num" id="6329586">1</span>&nbsp;<span class="op" id="6329588">&lt;&lt;</span>&nbsp;<span class="op" id="6329591">-</span><span class="ident" id="6329592">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329601">SkipComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6329616">=</span>&nbsp;<span class="num" id="6329618">1</span>&nbsp;<span class="op" id="6329620">&lt;&lt;</span>&nbsp;<span class="op" id="6329623">-</span><span class="ident" id="6329624">skipComment</span>&nbsp;<span class="comment" id="6329636">//&nbsp;if&nbsp;set&nbsp;with&nbsp;ScanComments,&nbsp;comments&nbsp;become&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329694">GoTokens</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6329709">=</span>&nbsp;<span class="ident" id="6329711">ScanIdents</span>&nbsp;<span class="op" id="6329722">|</span>&nbsp;<span class="ident" id="6329724">ScanFloats</span>&nbsp;<span class="op" id="6329735">|</span>&nbsp;<span class="ident" id="6329737">ScanChars</span>&nbsp;<span class="op" id="6329747">|</span>&nbsp;<span class="ident" id="6329749">ScanStrings</span>&nbsp;<span class="op" id="6329761">|</span>&nbsp;<span class="ident" id="6329763">ScanRawStrings</span>&nbsp;<span class="op" id="6329778">|</span>&nbsp;<span class="ident" id="6329780">ScanComments</span>&nbsp;<span class="op" id="6329793">|</span>&nbsp;<span class="ident" id="6329795">SkipComments</span><br>
<span class="lineno">85</span><span class="op" id="6329808">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6329811">//&nbsp;The&nbsp;result&nbsp;of&nbsp;Scan&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;following&nbsp;tokens&nbsp;or&nbsp;a&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6329888">const</span>&nbsp;<span class="op" id="6329894">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329897">EOF</span>&nbsp;<span class="op" id="6329901">=</span>&nbsp;<span class="op" id="6329903">-</span><span class="op" id="6329904">(</span><span class="ident" id="6329905">iota</span>&nbsp;<span class="op" id="6329910">+</span>&nbsp;<span class="num" id="6329912">1</span><span class="op" id="6329913">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329916">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329923">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329928">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329935">Char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329941">String</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329949">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329960">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6329969">skipComment</span><br>
<span class="lineno"></span><span class="op" id="6329981">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="6329984">var</span>&nbsp;<span class="ident" id="6329988">tokenString</span>&nbsp;<span class="op" id="6330000">=</span>&nbsp;<span class="keyword" id="6330002">map</span><span class="op" id="6330005">[</span><span class="builtintype" id="6330006">rune</span><span class="op" id="6330010">]</span><span class="builtintype" id="6330011">string</span><span class="op" id="6330017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330020">EOF</span><span class="op" id="6330023">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6330031">&#34;EOF&#34;</span><span class="op" id="6330036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330039">Ident</span><span class="op" id="6330044">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6330050">&#34;Ident&#34;</span><span class="op" id="6330057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330060">Int</span><span class="op" id="6330063">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6330071">&#34;Int&#34;</span><span class="op" id="6330076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330079">Float</span><span class="op" id="6330084">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6330090">&#34;Float&#34;</span><span class="op" id="6330097">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330100">Char</span><span class="op" id="6330104">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6330111">&#34;Char&#34;</span><span class="op" id="6330117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330120">String</span><span class="op" id="6330126">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6330131">&#34;String&#34;</span><span class="op" id="6330139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330142">RawString</span><span class="op" id="6330151">:</span>&nbsp;<span class="string" id="6330153">&#34;RawString&#34;</span><span class="op" id="6330164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330167">Comment</span><span class="op" id="6330174">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6330178">&#34;Comment&#34;</span><span class="op" id="6330187">,</span><br>
<span class="lineno"></span><span class="op" id="6330189">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="6330192">//&nbsp;TokenString&nbsp;returns&nbsp;a&nbsp;printable&nbsp;string&nbsp;for&nbsp;a&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6330268">func</span>&nbsp;<span class="ident" id="6330273">TokenString</span><span class="op" id="6330284">(</span><span class="ident" id="6330285">tok</span>&nbsp;<span class="builtintype" id="6330289">rune</span><span class="op" id="6330293">)</span>&nbsp;<span class="builtintype" id="6330295">string</span>&nbsp;<span class="op" id="6330302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330305">if</span>&nbsp;<span class="ident" id="6330308">s</span><span class="op" id="6330309">,</span>&nbsp;<span class="ident" id="6330311">found</span>&nbsp;<span class="op" id="6330317">:=</span>&nbsp;<span class="ident" id="6330320">tokenString</span><span class="op" id="6330331">[</span><span class="ident" id="6330332">tok</span><span class="op" id="6330335">]</span><span class="op" id="6330336">;</span>&nbsp;<span class="ident" id="6330338">found</span>&nbsp;<span class="op" id="6330344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330348">return</span>&nbsp;<span class="ident" id="6330355">s</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6330358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6330361">return</span>&nbsp;<span class="ident" id="6330368">fmt</span><span class="op" id="6330371">.</span><span class="ident" id="6330372">Sprintf</span><span class="op" id="6330379">(</span><span class="string" id="6330380">&#34;%q&#34;</span><span class="op" id="6330384">,</span>&nbsp;<span class="builtintype" id="6330386">string</span><span class="op" id="6330392">(</span><span class="ident" id="6330393">tok</span><span class="op" id="6330396">)</span><span class="op" id="6330397">)</span><br>
<span class="lineno"></span><span class="op" id="6330399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6330402">//&nbsp;GoWhitespace&nbsp;is&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;the&nbsp;Scanner&#39;s&nbsp;Whitespace&nbsp;field.</span><br>
<span class="lineno">120</span><span class="comment" id="6330475">//&nbsp;Its&nbsp;value&nbsp;selects&nbsp;Go&#39;s&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="6330525">const</span>&nbsp;<span class="ident" id="6330531">GoWhitespace</span>&nbsp;<span class="op" id="6330544">=</span>&nbsp;<span class="num" id="6330546">1</span><span class="op" id="6330547">&lt;&lt;</span><span class="string" id="6330549">&#39;\t&#39;</span>&nbsp;<span class="op" id="6330554">|</span>&nbsp;<span class="num" id="6330556">1</span><span class="op" id="6330557">&lt;&lt;</span><span class="string" id="6330559">&#39;\n&#39;</span>&nbsp;<span class="op" id="6330564">|</span>&nbsp;<span class="num" id="6330566">1</span><span class="op" id="6330567">&lt;&lt;</span><span class="string" id="6330569">&#39;\r&#39;</span>&nbsp;<span class="op" id="6330574">|</span>&nbsp;<span class="num" id="6330576">1</span><span class="op" id="6330577">&lt;&lt;</span><span class="string" id="6330579">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6330584">const</span>&nbsp;<span class="ident" id="6330590">bufLen</span>&nbsp;<span class="op" id="6330597">=</span>&nbsp;<span class="num" id="6330599">1024</span>&nbsp;<span class="comment" id="6330604">//&nbsp;at&nbsp;least&nbsp;utf8.UTFMax</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="6330629">//&nbsp;A&nbsp;Scanner&nbsp;implements&nbsp;reading&nbsp;of&nbsp;Unicode&nbsp;characters&nbsp;and&nbsp;tokens&nbsp;from&nbsp;an&nbsp;io.Reader.</span><br>
<span class="lineno"></span><span class="keyword" id="6330713">type</span>&nbsp;<span class="ident" id="6330718">Scanner</span>&nbsp;<span class="keyword" id="6330726">struct</span>&nbsp;<span class="op" id="6330733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6330736">//&nbsp;Input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330746">src</span>&nbsp;<span class="ident" id="6330750">io</span><span class="op" id="6330752">.</span><span class="ident" id="6330753">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6330762">//&nbsp;Source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330780">srcBuf</span>&nbsp;<span class="op" id="6330787">[</span><span class="ident" id="6330788">bufLen</span>&nbsp;<span class="op" id="6330795">+</span>&nbsp;<span class="num" id="6330797">1</span><span class="op" id="6330798">]</span><span class="builtintype" id="6330799">byte</span>&nbsp;<span class="comment" id="6330804">//&nbsp;+1&nbsp;for&nbsp;sentinel&nbsp;for&nbsp;common&nbsp;case&nbsp;of&nbsp;s.next()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330852">srcPos</span>&nbsp;<span class="builtintype" id="6330859">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6330876">//&nbsp;reading&nbsp;position&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330912">srcEnd</span>&nbsp;<span class="builtintype" id="6330919">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6330936">//&nbsp;source&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6330967">//&nbsp;Source&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6330987">srcBufOffset</span>&nbsp;<span class="builtintype" id="6331000">int</span>&nbsp;<span class="comment" id="6331004">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;srcBuf[0]&nbsp;in&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331043">line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6331056">int</span>&nbsp;<span class="comment" id="6331060">//&nbsp;line&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331075">column</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6331088">int</span>&nbsp;<span class="comment" id="6331092">//&nbsp;character&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331112">lastLineLen</span>&nbsp;&nbsp;<span class="builtintype" id="6331125">int</span>&nbsp;<span class="comment" id="6331129">//&nbsp;length&nbsp;of&nbsp;last&nbsp;line&nbsp;in&nbsp;characters&nbsp;(for&nbsp;correct&nbsp;column&nbsp;reporting)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331198">lastCharLen</span>&nbsp;&nbsp;<span class="builtintype" id="6331211">int</span>&nbsp;<span class="comment" id="6331215">//&nbsp;length&nbsp;of&nbsp;last&nbsp;character&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6331254">//&nbsp;Token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6331276">//&nbsp;Typically,&nbsp;token&nbsp;text&nbsp;is&nbsp;stored&nbsp;completely&nbsp;in&nbsp;srcBuf,&nbsp;but&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6331349">//&nbsp;the&nbsp;token&nbsp;text&#39;s&nbsp;head&nbsp;may&nbsp;be&nbsp;buffered&nbsp;in&nbsp;tokBuf&nbsp;while&nbsp;the&nbsp;token&nbsp;text&#39;s</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6331424">//&nbsp;tail&nbsp;is&nbsp;stored&nbsp;in&nbsp;srcBuf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331454">tokBuf</span>&nbsp;<span class="ident" id="6331461">bytes</span><span class="op" id="6331466">.</span><span class="ident" id="6331467">Buffer</span>&nbsp;<span class="comment" id="6331474">//&nbsp;token&nbsp;text&nbsp;head&nbsp;that&nbsp;is&nbsp;not&nbsp;in&nbsp;srcBuf&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331524">tokPos</span>&nbsp;<span class="builtintype" id="6331531">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6331544">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;position&nbsp;(srcBuf&nbsp;index);&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331603">tokEnd</span>&nbsp;<span class="builtintype" id="6331610">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6331623">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6331663">//&nbsp;One&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331692">ch</span>&nbsp;<span class="builtintype" id="6331695">rune</span>&nbsp;<span class="comment" id="6331700">//&nbsp;character&nbsp;before&nbsp;current&nbsp;srcPos</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6331737">//&nbsp;Error&nbsp;is&nbsp;called&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.&nbsp;If&nbsp;no&nbsp;Error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6331797">//&nbsp;function&nbsp;is&nbsp;set,&nbsp;the&nbsp;error&nbsp;is&nbsp;reported&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331854">Error</span>&nbsp;<span class="keyword" id="6331860">func</span><span class="op" id="6331864">(</span><span class="ident" id="6331865">s</span>&nbsp;<span class="op" id="6331867">*</span><span class="ident" id="6331868">Scanner</span><span class="op" id="6331875">,</span>&nbsp;<span class="ident" id="6331877">msg</span>&nbsp;<span class="builtintype" id="6331881">string</span><span class="op" id="6331887">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6331891">//&nbsp;ErrorCount&nbsp;is&nbsp;incremented&nbsp;by&nbsp;one&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6331956">ErrorCount</span>&nbsp;<span class="builtintype" id="6331967">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6331973">//&nbsp;The&nbsp;Mode&nbsp;field&nbsp;controls&nbsp;which&nbsp;tokens&nbsp;are&nbsp;recognized.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332044">//&nbsp;to&nbsp;recognize&nbsp;Ints,&nbsp;set&nbsp;the&nbsp;ScanInts&nbsp;bit&nbsp;in&nbsp;Mode.&nbsp;The&nbsp;field&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332114">//&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332139">Mode</span>&nbsp;<span class="builtintype" id="6332144">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332151">//&nbsp;The&nbsp;Whitespace&nbsp;field&nbsp;controls&nbsp;which&nbsp;characters&nbsp;are&nbsp;recognized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332217">//&nbsp;as&nbsp;white&nbsp;space.&nbsp;To&nbsp;recognize&nbsp;a&nbsp;character&nbsp;ch&nbsp;&lt;=&nbsp;&#39;&nbsp;&#39;&nbsp;as&nbsp;white&nbsp;space,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332288">//&nbsp;set&nbsp;the&nbsp;ch&#39;th&nbsp;bit&nbsp;in&nbsp;Whitespace&nbsp;(the&nbsp;Scanner&#39;s&nbsp;behavior&nbsp;is&nbsp;undefined</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332361">//&nbsp;for&nbsp;values&nbsp;ch&nbsp;&gt;&nbsp;&#39;&nbsp;&#39;).&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332425">Whitespace</span>&nbsp;<span class="ident" id="6332436">uint64</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332445">//&nbsp;IsIdentRune&nbsp;is&nbsp;a&nbsp;predicate&nbsp;controlling&nbsp;the&nbsp;characters&nbsp;accepted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332512">//&nbsp;as&nbsp;the&nbsp;ith&nbsp;rune&nbsp;in&nbsp;an&nbsp;identifier.&nbsp;The&nbsp;set&nbsp;of&nbsp;valid&nbsp;characters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332578">//&nbsp;must&nbsp;not&nbsp;intersect&nbsp;with&nbsp;the&nbsp;set&nbsp;of&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332641">//&nbsp;If&nbsp;no&nbsp;IsIdentRune&nbsp;function&nbsp;is&nbsp;set,&nbsp;regular&nbsp;Go&nbsp;identifiers&nbsp;are</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332707">//&nbsp;accepted&nbsp;instead.&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6332767">IsIdentRune</span>&nbsp;<span class="keyword" id="6332779">func</span><span class="op" id="6332783">(</span><span class="ident" id="6332784">ch</span>&nbsp;<span class="builtintype" id="6332787">rune</span><span class="op" id="6332791">,</span>&nbsp;<span class="ident" id="6332793">i</span>&nbsp;<span class="builtintype" id="6332795">int</span><span class="op" id="6332798">)</span>&nbsp;<span class="builtintype" id="6332800">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332807">//&nbsp;Start&nbsp;position&nbsp;of&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token;&nbsp;set&nbsp;by&nbsp;Scan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332871">//&nbsp;Calling&nbsp;Init&nbsp;or&nbsp;Next&nbsp;invalidates&nbsp;the&nbsp;position&nbsp;(Line&nbsp;==&nbsp;0).</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332934">//&nbsp;The&nbsp;Filename&nbsp;field&nbsp;is&nbsp;always&nbsp;left&nbsp;untouched&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6332998">//&nbsp;If&nbsp;an&nbsp;error&nbsp;is&nbsp;reported&nbsp;(via&nbsp;Error)&nbsp;and&nbsp;Position&nbsp;is&nbsp;invalid,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6333063">//&nbsp;the&nbsp;scanner&nbsp;is&nbsp;not&nbsp;inside&nbsp;a&nbsp;token.&nbsp;Call&nbsp;Pos&nbsp;to&nbsp;obtain&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6333130">//&nbsp;position&nbsp;in&nbsp;that&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333157">Position</span><br>
<span class="lineno">185</span><span class="op" id="6333166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6333169">//&nbsp;Init&nbsp;initializes&nbsp;a&nbsp;Scanner&nbsp;with&nbsp;a&nbsp;new&nbsp;source&nbsp;and&nbsp;returns&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="6333232">//&nbsp;Error&nbsp;is&nbsp;set&nbsp;to&nbsp;nil,&nbsp;ErrorCount&nbsp;is&nbsp;set&nbsp;to&nbsp;0,&nbsp;Mode&nbsp;is&nbsp;set&nbsp;to&nbsp;GoTokens,</span><br>
<span class="lineno"></span><span class="comment" id="6333305">//&nbsp;and&nbsp;Whitespace&nbsp;is&nbsp;set&nbsp;to&nbsp;GoWhitespace.</span><br>
<span class="lineno">190</span><span class="keyword" id="6333347">func</span>&nbsp;<span class="op" id="6333352">(</span><span class="ident" id="6333353">s</span>&nbsp;<span class="op" id="6333355">*</span><span class="ident" id="6333356">Scanner</span><span class="op" id="6333363">)</span>&nbsp;<span class="ident" id="6333365">Init</span><span class="op" id="6333369">(</span><span class="ident" id="6333370">src</span>&nbsp;<span class="ident" id="6333374">io</span><span class="op" id="6333376">.</span><span class="ident" id="6333377">Reader</span><span class="op" id="6333383">)</span>&nbsp;<span class="op" id="6333385">*</span><span class="ident" id="6333386">Scanner</span>&nbsp;<span class="op" id="6333394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333397">s</span><span class="op" id="6333398">.</span><span class="ident" id="6333399">src</span>&nbsp;<span class="op" id="6333403">=</span>&nbsp;<span class="ident" id="6333405">src</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6333411">//&nbsp;initialize&nbsp;source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6333440">//&nbsp;(the&nbsp;first&nbsp;call&nbsp;to&nbsp;next()&nbsp;will&nbsp;fill&nbsp;it&nbsp;by&nbsp;calling&nbsp;src.Read)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333504">s</span><span class="op" id="6333505">.</span><span class="ident" id="6333506">srcBuf</span><span class="op" id="6333512">[</span><span class="num" id="6333513">0</span><span class="op" id="6333514">]</span>&nbsp;<span class="op" id="6333516">=</span>&nbsp;<span class="ident" id="6333518">utf8</span><span class="op" id="6333522">.</span><span class="ident" id="6333523">RuneSelf</span>&nbsp;<span class="comment" id="6333532">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333545">s</span><span class="op" id="6333546">.</span><span class="ident" id="6333547">srcPos</span>&nbsp;<span class="op" id="6333554">=</span>&nbsp;<span class="num" id="6333556">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333559">s</span><span class="op" id="6333560">.</span><span class="ident" id="6333561">srcEnd</span>&nbsp;<span class="op" id="6333568">=</span>&nbsp;<span class="num" id="6333570">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6333574">//&nbsp;initialize&nbsp;source&nbsp;position</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333605">s</span><span class="op" id="6333606">.</span><span class="ident" id="6333607">srcBufOffset</span>&nbsp;<span class="op" id="6333620">=</span>&nbsp;<span class="num" id="6333622">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333625">s</span><span class="op" id="6333626">.</span><span class="ident" id="6333627">line</span>&nbsp;<span class="op" id="6333632">=</span>&nbsp;<span class="num" id="6333634">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333637">s</span><span class="op" id="6333638">.</span><span class="ident" id="6333639">column</span>&nbsp;<span class="op" id="6333646">=</span>&nbsp;<span class="num" id="6333648">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333651">s</span><span class="op" id="6333652">.</span><span class="ident" id="6333653">lastLineLen</span>&nbsp;<span class="op" id="6333665">=</span>&nbsp;<span class="num" id="6333667">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333670">s</span><span class="op" id="6333671">.</span><span class="ident" id="6333672">lastCharLen</span>&nbsp;<span class="op" id="6333684">=</span>&nbsp;<span class="num" id="6333686">0</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6333690">//&nbsp;initialize&nbsp;token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6333723">//&nbsp;(required&nbsp;for&nbsp;first&nbsp;call&nbsp;to&nbsp;next()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333764">s</span><span class="op" id="6333765">.</span><span class="ident" id="6333766">tokPos</span>&nbsp;<span class="op" id="6333773">=</span>&nbsp;<span class="op" id="6333775">-</span><span class="num" id="6333776">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6333780">//&nbsp;initialize&nbsp;one&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333820">s</span><span class="op" id="6333821">.</span><span class="ident" id="6333822">ch</span>&nbsp;<span class="op" id="6333825">=</span>&nbsp;<span class="op" id="6333827">-</span><span class="num" id="6333828">1</span>&nbsp;<span class="comment" id="6333830">//&nbsp;no&nbsp;char&nbsp;read&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6333852">//&nbsp;initialize&nbsp;public&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333881">s</span><span class="op" id="6333882">.</span><span class="ident" id="6333883">Error</span>&nbsp;<span class="op" id="6333889">=</span>&nbsp;<span class="ident" id="6333891">nil</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333896">s</span><span class="op" id="6333897">.</span><span class="ident" id="6333898">ErrorCount</span>&nbsp;<span class="op" id="6333909">=</span>&nbsp;<span class="num" id="6333911">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333914">s</span><span class="op" id="6333915">.</span><span class="ident" id="6333916">Mode</span>&nbsp;<span class="op" id="6333921">=</span>&nbsp;<span class="ident" id="6333923">GoTokens</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333933">s</span><span class="op" id="6333934">.</span><span class="ident" id="6333935">Whitespace</span>&nbsp;<span class="op" id="6333946">=</span>&nbsp;<span class="ident" id="6333948">GoWhitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6333962">s</span><span class="op" id="6333963">.</span><span class="ident" id="6333964">Line</span>&nbsp;<span class="op" id="6333969">=</span>&nbsp;<span class="num" id="6333971">0</span>&nbsp;<span class="comment" id="6333973">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334004">return</span>&nbsp;<span class="ident" id="6334011">s</span><br>
<span class="lineno"></span><span class="op" id="6334013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6334016">//&nbsp;next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.&nbsp;It&nbsp;is&nbsp;designed&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="6334090">//&nbsp;that&nbsp;only&nbsp;a&nbsp;minimal&nbsp;amount&nbsp;of&nbsp;work&nbsp;needs&nbsp;to&nbsp;be&nbsp;done&nbsp;in&nbsp;the&nbsp;common&nbsp;ASCII</span><br>
<span class="lineno">225</span><span class="comment" id="6334165">//&nbsp;case&nbsp;(one&nbsp;test&nbsp;to&nbsp;check&nbsp;for&nbsp;both&nbsp;ASCII&nbsp;and&nbsp;end-of-buffer,&nbsp;and&nbsp;one&nbsp;test</span><br>
<span class="lineno"></span><span class="comment" id="6334239">//&nbsp;to&nbsp;check&nbsp;for&nbsp;newlines).</span><br>
<span class="lineno"></span><span class="keyword" id="6334266">func</span>&nbsp;<span class="op" id="6334271">(</span><span class="ident" id="6334272">s</span>&nbsp;<span class="op" id="6334274">*</span><span class="ident" id="6334275">Scanner</span><span class="op" id="6334282">)</span>&nbsp;<span class="ident" id="6334284">next</span><span class="op" id="6334288">(</span><span class="op" id="6334289">)</span>&nbsp;<span class="builtintype" id="6334291">rune</span>&nbsp;<span class="op" id="6334296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334299">ch</span><span class="op" id="6334301">,</span>&nbsp;<span class="ident" id="6334303">width</span>&nbsp;<span class="op" id="6334309">:=</span>&nbsp;<span class="builtintype" id="6334312">rune</span><span class="op" id="6334316">(</span><span class="ident" id="6334317">s</span><span class="op" id="6334318">.</span><span class="ident" id="6334319">srcBuf</span><span class="op" id="6334325">[</span><span class="ident" id="6334326">s</span><span class="op" id="6334327">.</span><span class="ident" id="6334328">srcPos</span><span class="op" id="6334334">]</span><span class="op" id="6334335">)</span><span class="op" id="6334336">,</span>&nbsp;<span class="num" id="6334338">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334342">if</span>&nbsp;<span class="ident" id="6334345">ch</span>&nbsp;<span class="op" id="6334348">&gt;=</span>&nbsp;<span class="ident" id="6334351">utf8</span><span class="op" id="6334355">.</span><span class="ident" id="6334356">RuneSelf</span>&nbsp;<span class="op" id="6334365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6334369">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII&nbsp;or&nbsp;not&nbsp;enough&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334419">for</span>&nbsp;<span class="ident" id="6334423">s</span><span class="op" id="6334424">.</span><span class="ident" id="6334425">srcPos</span><span class="op" id="6334431">+</span><span class="ident" id="6334432">utf8</span><span class="op" id="6334436">.</span><span class="ident" id="6334437">UTFMax</span>&nbsp;<span class="op" id="6334444">&gt;</span>&nbsp;<span class="ident" id="6334446">s</span><span class="op" id="6334447">.</span><span class="ident" id="6334448">srcEnd</span>&nbsp;<span class="op" id="6334455">&amp;&amp;</span>&nbsp;<span class="op" id="6334458">!</span><span class="ident" id="6334459">utf8</span><span class="op" id="6334463">.</span><span class="ident" id="6334464">FullRune</span><span class="op" id="6334472">(</span><span class="ident" id="6334473">s</span><span class="op" id="6334474">.</span><span class="ident" id="6334475">srcBuf</span><span class="op" id="6334481">[</span><span class="ident" id="6334482">s</span><span class="op" id="6334483">.</span><span class="ident" id="6334484">srcPos</span><span class="op" id="6334490">:</span><span class="ident" id="6334491">s</span><span class="op" id="6334492">.</span><span class="ident" id="6334493">srcEnd</span><span class="op" id="6334499">]</span><span class="op" id="6334500">)</span>&nbsp;<span class="op" id="6334502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6334507">//&nbsp;not&nbsp;enough&nbsp;bytes:&nbsp;read&nbsp;some&nbsp;more,&nbsp;but&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6334557">//&nbsp;save&nbsp;away&nbsp;token&nbsp;text&nbsp;if&nbsp;any</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6334591">if</span>&nbsp;<span class="ident" id="6334594">s</span><span class="op" id="6334595">.</span><span class="ident" id="6334596">tokPos</span>&nbsp;<span class="op" id="6334603">&gt;=</span>&nbsp;<span class="num" id="6334606">0</span>&nbsp;<span class="op" id="6334608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334614">s</span><span class="op" id="6334615">.</span><span class="ident" id="6334616">tokBuf</span><span class="op" id="6334622">.</span><span class="ident" id="6334623">Write</span><span class="op" id="6334628">(</span><span class="ident" id="6334629">s</span><span class="op" id="6334630">.</span><span class="ident" id="6334631">srcBuf</span><span class="op" id="6334637">[</span><span class="ident" id="6334638">s</span><span class="op" id="6334639">.</span><span class="ident" id="6334640">tokPos</span><span class="op" id="6334646">:</span><span class="ident" id="6334647">s</span><span class="op" id="6334648">.</span><span class="ident" id="6334649">srcPos</span><span class="op" id="6334655">]</span><span class="op" id="6334656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334662">s</span><span class="op" id="6334663">.</span><span class="ident" id="6334664">tokPos</span>&nbsp;<span class="op" id="6334671">=</span>&nbsp;<span class="num" id="6334673">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6334679">//&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;by&nbsp;Scan()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6334711">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6334716">//&nbsp;move&nbsp;unread&nbsp;bytes&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6334763">copy</span><span class="op" id="6334767">(</span><span class="ident" id="6334768">s</span><span class="op" id="6334769">.</span><span class="ident" id="6334770">srcBuf</span><span class="op" id="6334776">[</span><span class="num" id="6334777">0</span><span class="op" id="6334778">:</span><span class="op" id="6334779">]</span><span class="op" id="6334780">,</span>&nbsp;<span class="ident" id="6334782">s</span><span class="op" id="6334783">.</span><span class="ident" id="6334784">srcBuf</span><span class="op" id="6334790">[</span><span class="ident" id="6334791">s</span><span class="op" id="6334792">.</span><span class="ident" id="6334793">srcPos</span><span class="op" id="6334799">:</span><span class="ident" id="6334800">s</span><span class="op" id="6334801">.</span><span class="ident" id="6334802">srcEnd</span><span class="op" id="6334808">]</span><span class="op" id="6334809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6334814">s</span><span class="op" id="6334815">.</span><span class="ident" id="6334816">srcBufOffset</span>&nbsp;<span class="op" id="6334829">+=</span>&nbsp;<span class="ident" id="6334832">s</span><span class="op" id="6334833">.</span><span class="ident" id="6334834">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6334844">//&nbsp;read&nbsp;more&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6334866">//&nbsp;(an&nbsp;io.Reader&nbsp;must&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;it&nbsp;reaches</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6334921">//&nbsp;the&nbsp;end&nbsp;of&nbsp;what&nbsp;it&nbsp;is&nbsp;reading&nbsp;-&nbsp;simply&nbsp;returning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6334976">//&nbsp;n&nbsp;==&nbsp;0&nbsp;will&nbsp;make&nbsp;this&nbsp;loop&nbsp;retry&nbsp;forever;&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6335032">//&nbsp;error&nbsp;is&nbsp;in&nbsp;the&nbsp;reader&nbsp;implementation&nbsp;in&nbsp;that&nbsp;case)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335090">i</span>&nbsp;<span class="op" id="6335092">:=</span>&nbsp;<span class="ident" id="6335095">s</span><span class="op" id="6335096">.</span><span class="ident" id="6335097">srcEnd</span>&nbsp;<span class="op" id="6335104">-</span>&nbsp;<span class="ident" id="6335106">s</span><span class="op" id="6335107">.</span><span class="ident" id="6335108">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335118">n</span><span class="op" id="6335119">,</span>&nbsp;<span class="ident" id="6335121">err</span>&nbsp;<span class="op" id="6335125">:=</span>&nbsp;<span class="ident" id="6335128">s</span><span class="op" id="6335129">.</span><span class="ident" id="6335130">src</span><span class="op" id="6335133">.</span><span class="ident" id="6335134">Read</span><span class="op" id="6335138">(</span><span class="ident" id="6335139">s</span><span class="op" id="6335140">.</span><span class="ident" id="6335141">srcBuf</span><span class="op" id="6335147">[</span><span class="ident" id="6335148">i</span><span class="op" id="6335149">:</span><span class="ident" id="6335150">bufLen</span><span class="op" id="6335156">]</span><span class="op" id="6335157">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335162">s</span><span class="op" id="6335163">.</span><span class="ident" id="6335164">srcPos</span>&nbsp;<span class="op" id="6335171">=</span>&nbsp;<span class="num" id="6335173">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335178">s</span><span class="op" id="6335179">.</span><span class="ident" id="6335180">srcEnd</span>&nbsp;<span class="op" id="6335187">=</span>&nbsp;<span class="ident" id="6335189">i</span>&nbsp;<span class="op" id="6335191">+</span>&nbsp;<span class="ident" id="6335193">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335198">s</span><span class="op" id="6335199">.</span><span class="ident" id="6335200">srcBuf</span><span class="op" id="6335206">[</span><span class="ident" id="6335207">s</span><span class="op" id="6335208">.</span><span class="ident" id="6335209">srcEnd</span><span class="op" id="6335215">]</span>&nbsp;<span class="op" id="6335217">=</span>&nbsp;<span class="ident" id="6335219">utf8</span><span class="op" id="6335223">.</span><span class="ident" id="6335224">RuneSelf</span>&nbsp;<span class="comment" id="6335233">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335248">if</span>&nbsp;<span class="ident" id="6335251">err</span>&nbsp;<span class="op" id="6335255">!=</span>&nbsp;<span class="ident" id="6335258">nil</span>&nbsp;<span class="op" id="6335262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335268">if</span>&nbsp;<span class="ident" id="6335271">err</span>&nbsp;<span class="op" id="6335275">!=</span>&nbsp;<span class="ident" id="6335278">io</span><span class="op" id="6335280">.</span><span class="ident" id="6335281">EOF</span>&nbsp;<span class="op" id="6335285">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335292">s</span><span class="op" id="6335293">.</span><span class="builtintype" id="6335294">error</span><span class="op" id="6335299">(</span><span class="ident" id="6335300">err</span><span class="op" id="6335303">.</span><span class="ident" id="6335304">Error</span><span class="op" id="6335309">(</span><span class="op" id="6335310">)</span><span class="op" id="6335311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335323">if</span>&nbsp;<span class="ident" id="6335326">s</span><span class="op" id="6335327">.</span><span class="ident" id="6335328">srcEnd</span>&nbsp;<span class="op" id="6335335">==</span>&nbsp;<span class="num" id="6335338">0</span>&nbsp;<span class="op" id="6335340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335347">if</span>&nbsp;<span class="ident" id="6335350">s</span><span class="op" id="6335351">.</span><span class="ident" id="6335352">lastCharLen</span>&nbsp;<span class="op" id="6335364">&gt;</span>&nbsp;<span class="num" id="6335366">0</span>&nbsp;<span class="op" id="6335368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6335376">//&nbsp;previous&nbsp;character&nbsp;was&nbsp;not&nbsp;EOF</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335416">s</span><span class="op" id="6335417">.</span><span class="ident" id="6335418">column</span><span class="op" id="6335424">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335439">s</span><span class="op" id="6335440">.</span><span class="ident" id="6335441">lastCharLen</span>&nbsp;<span class="op" id="6335453">=</span>&nbsp;<span class="num" id="6335455">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335462">return</span>&nbsp;<span class="ident" id="6335469">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335477">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6335483">//&nbsp;If&nbsp;err&nbsp;==&nbsp;EOF,&nbsp;we&nbsp;won&#39;t&nbsp;be&nbsp;getting&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6335530">//&nbsp;bytes;&nbsp;break&nbsp;to&nbsp;avoid&nbsp;infinite&nbsp;loop.&nbsp;If</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6335577">//&nbsp;err&nbsp;is&nbsp;something&nbsp;else,&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6335624">//&nbsp;we&nbsp;can&nbsp;get&nbsp;more&nbsp;bytes;&nbsp;thus&nbsp;also&nbsp;break.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335671">break</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6335684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6335688">//&nbsp;at&nbsp;least&nbsp;one&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335711">ch</span>&nbsp;<span class="op" id="6335714">=</span>&nbsp;<span class="builtintype" id="6335716">rune</span><span class="op" id="6335720">(</span><span class="ident" id="6335721">s</span><span class="op" id="6335722">.</span><span class="ident" id="6335723">srcBuf</span><span class="op" id="6335729">[</span><span class="ident" id="6335730">s</span><span class="op" id="6335731">.</span><span class="ident" id="6335732">srcPos</span><span class="op" id="6335738">]</span><span class="op" id="6335739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335743">if</span>&nbsp;<span class="ident" id="6335746">ch</span>&nbsp;<span class="op" id="6335749">&gt;=</span>&nbsp;<span class="ident" id="6335752">utf8</span><span class="op" id="6335756">.</span><span class="ident" id="6335757">RuneSelf</span>&nbsp;<span class="op" id="6335766">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6335771">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335802">ch</span><span class="op" id="6335804">,</span>&nbsp;<span class="ident" id="6335806">width</span>&nbsp;<span class="op" id="6335812">=</span>&nbsp;<span class="ident" id="6335814">utf8</span><span class="op" id="6335818">.</span><span class="ident" id="6335819">DecodeRune</span><span class="op" id="6335829">(</span><span class="ident" id="6335830">s</span><span class="op" id="6335831">.</span><span class="ident" id="6335832">srcBuf</span><span class="op" id="6335838">[</span><span class="ident" id="6335839">s</span><span class="op" id="6335840">.</span><span class="ident" id="6335841">srcPos</span><span class="op" id="6335847">:</span><span class="ident" id="6335848">s</span><span class="op" id="6335849">.</span><span class="ident" id="6335850">srcEnd</span><span class="op" id="6335856">]</span><span class="op" id="6335857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6335862">if</span>&nbsp;<span class="ident" id="6335865">ch</span>&nbsp;<span class="op" id="6335868">==</span>&nbsp;<span class="ident" id="6335871">utf8</span><span class="op" id="6335875">.</span><span class="ident" id="6335876">RuneError</span>&nbsp;<span class="op" id="6335886">&amp;&amp;</span>&nbsp;<span class="ident" id="6335889">width</span>&nbsp;<span class="op" id="6335895">==</span>&nbsp;<span class="num" id="6335898">1</span>&nbsp;<span class="op" id="6335900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6335906">//&nbsp;advance&nbsp;for&nbsp;correct&nbsp;error&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335948">s</span><span class="op" id="6335949">.</span><span class="ident" id="6335950">srcPos</span>&nbsp;<span class="op" id="6335957">+=</span>&nbsp;<span class="ident" id="6335960">width</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335970">s</span><span class="op" id="6335971">.</span><span class="ident" id="6335972">lastCharLen</span>&nbsp;<span class="op" id="6335984">=</span>&nbsp;<span class="ident" id="6335986">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6335996">s</span><span class="op" id="6335997">.</span><span class="ident" id="6335998">column</span><span class="op" id="6336004">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336011">s</span><span class="op" id="6336012">.</span><span class="builtintype" id="6336013">error</span><span class="op" id="6336018">(</span><span class="string" id="6336019">&#34;illegal&nbsp;UTF-8&nbsp;encoding&#34;</span><span class="op" id="6336043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336049">return</span>&nbsp;<span class="ident" id="6336056">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6336062">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6336066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6336069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6336073">//&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336085">s</span><span class="op" id="6336086">.</span><span class="ident" id="6336087">srcPos</span>&nbsp;<span class="op" id="6336094">+=</span>&nbsp;<span class="ident" id="6336097">width</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336104">s</span><span class="op" id="6336105">.</span><span class="ident" id="6336106">lastCharLen</span>&nbsp;<span class="op" id="6336118">=</span>&nbsp;<span class="ident" id="6336120">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336127">s</span><span class="op" id="6336128">.</span><span class="ident" id="6336129">column</span><span class="op" id="6336135">++</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6336140">//&nbsp;special&nbsp;situations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336163">switch</span>&nbsp;<span class="ident" id="6336170">ch</span>&nbsp;<span class="op" id="6336173">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336176">case</span>&nbsp;<span class="num" id="6336181">0</span><span class="op" id="6336182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6336186">//&nbsp;for&nbsp;compatibility&nbsp;with&nbsp;other&nbsp;tools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336226">s</span><span class="op" id="6336227">.</span><span class="builtintype" id="6336228">error</span><span class="op" id="6336233">(</span><span class="string" id="6336234">&#34;illegal&nbsp;character&nbsp;NUL&#34;</span><span class="op" id="6336257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336260">case</span>&nbsp;<span class="string" id="6336265">&#39;\n&#39;</span><span class="op" id="6336269">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336273">s</span><span class="op" id="6336274">.</span><span class="ident" id="6336275">line</span><span class="op" id="6336279">++</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336284">s</span><span class="op" id="6336285">.</span><span class="ident" id="6336286">lastLineLen</span>&nbsp;<span class="op" id="6336298">=</span>&nbsp;<span class="ident" id="6336300">s</span><span class="op" id="6336301">.</span><span class="ident" id="6336302">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336311">s</span><span class="op" id="6336312">.</span><span class="ident" id="6336313">column</span>&nbsp;<span class="op" id="6336320">=</span>&nbsp;<span class="num" id="6336322">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6336325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336329">return</span>&nbsp;<span class="ident" id="6336336">ch</span><br>
<span class="lineno">305</span><span class="op" id="6336339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6336342">//&nbsp;Next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="6336396">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports</span><br>
<span class="lineno"></span><span class="comment" id="6336451">//&nbsp;a&nbsp;read&nbsp;error&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise</span><br>
<span class="lineno">310</span><span class="comment" id="6336509">//&nbsp;it&nbsp;prints&nbsp;an&nbsp;error&nbsp;message&nbsp;to&nbsp;os.Stderr.&nbsp;Next&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="6336567">//&nbsp;update&nbsp;the&nbsp;Scanner&#39;s&nbsp;Position&nbsp;field;&nbsp;use&nbsp;Pos()&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6336620">//&nbsp;get&nbsp;the&nbsp;current&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="6336649">func</span>&nbsp;<span class="op" id="6336654">(</span><span class="ident" id="6336655">s</span>&nbsp;<span class="op" id="6336657">*</span><span class="ident" id="6336658">Scanner</span><span class="op" id="6336665">)</span>&nbsp;<span class="ident" id="6336667">Next</span><span class="op" id="6336671">(</span><span class="op" id="6336672">)</span>&nbsp;<span class="builtintype" id="6336674">rune</span>&nbsp;<span class="op" id="6336679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336682">s</span><span class="op" id="6336683">.</span><span class="ident" id="6336684">tokPos</span>&nbsp;<span class="op" id="6336691">=</span>&nbsp;<span class="op" id="6336693">-</span><span class="num" id="6336694">1</span>&nbsp;<span class="comment" id="6336696">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336725">s</span><span class="op" id="6336726">.</span><span class="ident" id="6336727">Line</span>&nbsp;<span class="op" id="6336732">=</span>&nbsp;<span class="num" id="6336734">0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6336739">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336769">ch</span>&nbsp;<span class="op" id="6336772">:=</span>&nbsp;<span class="ident" id="6336775">s</span><span class="op" id="6336776">.</span><span class="ident" id="6336777">Peek</span><span class="op" id="6336781">(</span><span class="op" id="6336782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6336785">s</span><span class="op" id="6336786">.</span><span class="ident" id="6336787">ch</span>&nbsp;<span class="op" id="6336790">=</span>&nbsp;<span class="ident" id="6336792">s</span><span class="op" id="6336793">.</span><span class="ident" id="6336794">next</span><span class="op" id="6336798">(</span><span class="op" id="6336799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6336802">return</span>&nbsp;<span class="ident" id="6336809">ch</span><br>
<span class="lineno"></span><span class="op" id="6336812">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="6336815">//&nbsp;Peek&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character&nbsp;in&nbsp;the&nbsp;source&nbsp;without&nbsp;advancing</span><br>
<span class="lineno"></span><span class="comment" id="6336890">//&nbsp;the&nbsp;scanner.&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;if&nbsp;the&nbsp;scanner&#39;s&nbsp;position&nbsp;is&nbsp;at&nbsp;the&nbsp;last</span><br>
<span class="lineno"></span><span class="comment" id="6336962">//&nbsp;character&nbsp;of&nbsp;the&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="6336990">func</span>&nbsp;<span class="op" id="6336995">(</span><span class="ident" id="6336996">s</span>&nbsp;<span class="op" id="6336998">*</span><span class="ident" id="6336999">Scanner</span><span class="op" id="6337006">)</span>&nbsp;<span class="ident" id="6337008">Peek</span><span class="op" id="6337012">(</span><span class="op" id="6337013">)</span>&nbsp;<span class="builtintype" id="6337015">rune</span>&nbsp;<span class="op" id="6337020">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337023">if</span>&nbsp;<span class="ident" id="6337026">s</span><span class="op" id="6337027">.</span><span class="ident" id="6337028">ch</span>&nbsp;<span class="op" id="6337031">&lt;</span>&nbsp;<span class="num" id="6337033">0</span>&nbsp;<span class="op" id="6337035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6337039">//&nbsp;this&nbsp;code&nbsp;is&nbsp;only&nbsp;run&nbsp;for&nbsp;the&nbsp;very&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337095">s</span><span class="op" id="6337096">.</span><span class="ident" id="6337097">ch</span>&nbsp;<span class="op" id="6337100">=</span>&nbsp;<span class="ident" id="6337102">s</span><span class="op" id="6337103">.</span><span class="ident" id="6337104">next</span><span class="op" id="6337108">(</span><span class="op" id="6337109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337113">if</span>&nbsp;<span class="ident" id="6337116">s</span><span class="op" id="6337117">.</span><span class="ident" id="6337118">ch</span>&nbsp;<span class="op" id="6337121">==</span>&nbsp;<span class="string" id="6337124">&#39;\uFEFF&#39;</span>&nbsp;<span class="op" id="6337133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337138">s</span><span class="op" id="6337139">.</span><span class="ident" id="6337140">ch</span>&nbsp;<span class="op" id="6337143">=</span>&nbsp;<span class="ident" id="6337145">s</span><span class="op" id="6337146">.</span><span class="ident" id="6337147">next</span><span class="op" id="6337151">(</span><span class="op" id="6337152">)</span>&nbsp;<span class="comment" id="6337154">//&nbsp;ignore&nbsp;BOM</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337176">return</span>&nbsp;<span class="ident" id="6337183">s</span><span class="op" id="6337184">.</span><span class="ident" id="6337185">ch</span><br>
<span class="lineno"></span><span class="op" id="6337188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="6337191">func</span>&nbsp;<span class="op" id="6337196">(</span><span class="ident" id="6337197">s</span>&nbsp;<span class="op" id="6337199">*</span><span class="ident" id="6337200">Scanner</span><span class="op" id="6337207">)</span>&nbsp;<span class="builtintype" id="6337209">error</span><span class="op" id="6337214">(</span><span class="ident" id="6337215">msg</span>&nbsp;<span class="builtintype" id="6337219">string</span><span class="op" id="6337225">)</span>&nbsp;<span class="op" id="6337227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337230">s</span><span class="op" id="6337231">.</span><span class="ident" id="6337232">ErrorCount</span><span class="op" id="6337242">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337246">if</span>&nbsp;<span class="ident" id="6337249">s</span><span class="op" id="6337250">.</span><span class="ident" id="6337251">Error</span>&nbsp;<span class="op" id="6337257">!=</span>&nbsp;<span class="ident" id="6337260">nil</span>&nbsp;<span class="op" id="6337264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337268">s</span><span class="op" id="6337269">.</span><span class="ident" id="6337270">Error</span><span class="op" id="6337275">(</span><span class="ident" id="6337276">s</span><span class="op" id="6337277">,</span>&nbsp;<span class="ident" id="6337279">msg</span><span class="op" id="6337282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337286">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337297">pos</span>&nbsp;<span class="op" id="6337301">:=</span>&nbsp;<span class="ident" id="6337304">s</span><span class="op" id="6337305">.</span><span class="ident" id="6337306">Position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337316">if</span>&nbsp;<span class="op" id="6337319">!</span><span class="ident" id="6337320">pos</span><span class="op" id="6337323">.</span><span class="ident" id="6337324">IsValid</span><span class="op" id="6337331">(</span><span class="op" id="6337332">)</span>&nbsp;<span class="op" id="6337334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337338">pos</span>&nbsp;<span class="op" id="6337342">=</span>&nbsp;<span class="ident" id="6337344">s</span><span class="op" id="6337345">.</span><span class="ident" id="6337346">Pos</span><span class="op" id="6337349">(</span><span class="op" id="6337350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337353">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337356">fmt</span><span class="op" id="6337359">.</span><span class="ident" id="6337360">Fprintf</span><span class="op" id="6337367">(</span><span class="ident" id="6337368">os</span><span class="op" id="6337370">.</span><span class="ident" id="6337371">Stderr</span><span class="op" id="6337377">,</span>&nbsp;<span class="string" id="6337379">&#34;%s:&nbsp;%s\n&#34;</span><span class="op" id="6337389">,</span>&nbsp;<span class="ident" id="6337391">pos</span><span class="op" id="6337394">,</span>&nbsp;<span class="ident" id="6337396">msg</span><span class="op" id="6337399">)</span><br>
<span class="lineno"></span><span class="op" id="6337401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6337404">func</span>&nbsp;<span class="op" id="6337409">(</span><span class="ident" id="6337410">s</span>&nbsp;<span class="op" id="6337412">*</span><span class="ident" id="6337413">Scanner</span><span class="op" id="6337420">)</span>&nbsp;<span class="ident" id="6337422">isIdentRune</span><span class="op" id="6337433">(</span><span class="ident" id="6337434">ch</span>&nbsp;<span class="builtintype" id="6337437">rune</span><span class="op" id="6337441">,</span>&nbsp;<span class="ident" id="6337443">i</span>&nbsp;<span class="builtintype" id="6337445">int</span><span class="op" id="6337448">)</span>&nbsp;<span class="builtintype" id="6337450">bool</span>&nbsp;<span class="op" id="6337455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337458">if</span>&nbsp;<span class="ident" id="6337461">s</span><span class="op" id="6337462">.</span><span class="ident" id="6337463">IsIdentRune</span>&nbsp;<span class="op" id="6337475">!=</span>&nbsp;<span class="ident" id="6337478">nil</span>&nbsp;<span class="op" id="6337482">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337486">return</span>&nbsp;<span class="ident" id="6337493">s</span><span class="op" id="6337494">.</span><span class="ident" id="6337495">IsIdentRune</span><span class="op" id="6337506">(</span><span class="ident" id="6337507">ch</span><span class="op" id="6337509">,</span>&nbsp;<span class="ident" id="6337511">i</span><span class="op" id="6337512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337518">return</span>&nbsp;<span class="ident" id="6337525">ch</span>&nbsp;<span class="op" id="6337528">==</span>&nbsp;<span class="string" id="6337531">&#39;_&#39;</span>&nbsp;<span class="op" id="6337535">||</span>&nbsp;<span class="ident" id="6337538">unicode</span><span class="op" id="6337545">.</span><span class="ident" id="6337546">IsLetter</span><span class="op" id="6337554">(</span><span class="ident" id="6337555">ch</span><span class="op" id="6337557">)</span>&nbsp;<span class="op" id="6337559">||</span>&nbsp;<span class="ident" id="6337562">unicode</span><span class="op" id="6337569">.</span><span class="ident" id="6337570">IsDigit</span><span class="op" id="6337577">(</span><span class="ident" id="6337578">ch</span><span class="op" id="6337580">)</span>&nbsp;<span class="op" id="6337582">&amp;&amp;</span>&nbsp;<span class="ident" id="6337585">i</span>&nbsp;<span class="op" id="6337587">&gt;</span>&nbsp;<span class="num" id="6337589">0</span><br>
<span class="lineno"></span><span class="op" id="6337591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="6337594">func</span>&nbsp;<span class="op" id="6337599">(</span><span class="ident" id="6337600">s</span>&nbsp;<span class="op" id="6337602">*</span><span class="ident" id="6337603">Scanner</span><span class="op" id="6337610">)</span>&nbsp;<span class="ident" id="6337612">scanIdentifier</span><span class="op" id="6337626">(</span><span class="op" id="6337627">)</span>&nbsp;<span class="builtintype" id="6337629">rune</span>&nbsp;<span class="op" id="6337634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6337637">//&nbsp;we&nbsp;know&nbsp;the&nbsp;zero&#39;th&nbsp;rune&nbsp;is&nbsp;OK;&nbsp;start&nbsp;scanning&nbsp;at&nbsp;the&nbsp;next&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337704">ch</span>&nbsp;<span class="op" id="6337707">:=</span>&nbsp;<span class="ident" id="6337710">s</span><span class="op" id="6337711">.</span><span class="ident" id="6337712">next</span><span class="op" id="6337716">(</span><span class="op" id="6337717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337720">for</span>&nbsp;<span class="ident" id="6337724">i</span>&nbsp;<span class="op" id="6337726">:=</span>&nbsp;<span class="num" id="6337729">1</span><span class="op" id="6337730">;</span>&nbsp;<span class="ident" id="6337732">s</span><span class="op" id="6337733">.</span><span class="ident" id="6337734">isIdentRune</span><span class="op" id="6337745">(</span><span class="ident" id="6337746">ch</span><span class="op" id="6337748">,</span>&nbsp;<span class="ident" id="6337750">i</span><span class="op" id="6337751">)</span><span class="op" id="6337752">;</span>&nbsp;<span class="ident" id="6337754">i</span><span class="op" id="6337755">++</span>&nbsp;<span class="op" id="6337758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6337762">ch</span>&nbsp;<span class="op" id="6337765">=</span>&nbsp;<span class="ident" id="6337767">s</span><span class="op" id="6337768">.</span><span class="ident" id="6337769">next</span><span class="op" id="6337773">(</span><span class="op" id="6337774">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6337777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337780">return</span>&nbsp;<span class="ident" id="6337787">ch</span><br>
<span class="lineno"></span><span class="op" id="6337790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6337793">func</span>&nbsp;<span class="ident" id="6337798">digitVal</span><span class="op" id="6337806">(</span><span class="ident" id="6337807">ch</span>&nbsp;<span class="builtintype" id="6337810">rune</span><span class="op" id="6337814">)</span>&nbsp;<span class="builtintype" id="6337816">int</span>&nbsp;<span class="op" id="6337820">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337823">switch</span>&nbsp;<span class="op" id="6337830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337833">case</span>&nbsp;<span class="string" id="6337838">&#39;0&#39;</span>&nbsp;<span class="op" id="6337842">&lt;=</span>&nbsp;<span class="ident" id="6337845">ch</span>&nbsp;<span class="op" id="6337848">&amp;&amp;</span>&nbsp;<span class="ident" id="6337851">ch</span>&nbsp;<span class="op" id="6337854">&lt;=</span>&nbsp;<span class="string" id="6337857">&#39;9&#39;</span><span class="op" id="6337860">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337864">return</span>&nbsp;<span class="builtintype" id="6337871">int</span><span class="op" id="6337874">(</span><span class="ident" id="6337875">ch</span>&nbsp;<span class="op" id="6337878">-</span>&nbsp;<span class="string" id="6337880">&#39;0&#39;</span><span class="op" id="6337883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337886">case</span>&nbsp;<span class="string" id="6337891">&#39;a&#39;</span>&nbsp;<span class="op" id="6337895">&lt;=</span>&nbsp;<span class="ident" id="6337898">ch</span>&nbsp;<span class="op" id="6337901">&amp;&amp;</span>&nbsp;<span class="ident" id="6337904">ch</span>&nbsp;<span class="op" id="6337907">&lt;=</span>&nbsp;<span class="string" id="6337910">&#39;f&#39;</span><span class="op" id="6337913">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337917">return</span>&nbsp;<span class="builtintype" id="6337924">int</span><span class="op" id="6337927">(</span><span class="ident" id="6337928">ch</span>&nbsp;<span class="op" id="6337931">-</span>&nbsp;<span class="string" id="6337933">&#39;a&#39;</span>&nbsp;<span class="op" id="6337937">+</span>&nbsp;<span class="num" id="6337939">10</span><span class="op" id="6337941">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337944">case</span>&nbsp;<span class="string" id="6337949">&#39;A&#39;</span>&nbsp;<span class="op" id="6337953">&lt;=</span>&nbsp;<span class="ident" id="6337956">ch</span>&nbsp;<span class="op" id="6337959">&amp;&amp;</span>&nbsp;<span class="ident" id="6337962">ch</span>&nbsp;<span class="op" id="6337965">&lt;=</span>&nbsp;<span class="string" id="6337968">&#39;F&#39;</span><span class="op" id="6337971">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6337975">return</span>&nbsp;<span class="builtintype" id="6337982">int</span><span class="op" id="6337985">(</span><span class="ident" id="6337986">ch</span>&nbsp;<span class="op" id="6337989">-</span>&nbsp;<span class="string" id="6337991">&#39;A&#39;</span>&nbsp;<span class="op" id="6337995">+</span>&nbsp;<span class="num" id="6337997">10</span><span class="op" id="6337999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338005">return</span>&nbsp;<span class="num" id="6338012">16</span>&nbsp;<span class="comment" id="6338015">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;legal&nbsp;digit&nbsp;val</span><br>
<span class="lineno"></span><span class="op" id="6338050">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="6338053">func</span>&nbsp;<span class="ident" id="6338058">isDecimal</span><span class="op" id="6338067">(</span><span class="ident" id="6338068">ch</span>&nbsp;<span class="builtintype" id="6338071">rune</span><span class="op" id="6338075">)</span>&nbsp;<span class="builtintype" id="6338077">bool</span>&nbsp;<span class="op" id="6338082">{</span>&nbsp;<span class="keyword" id="6338084">return</span>&nbsp;<span class="string" id="6338091">&#39;0&#39;</span>&nbsp;<span class="op" id="6338095">&lt;=</span>&nbsp;<span class="ident" id="6338098">ch</span>&nbsp;<span class="op" id="6338101">&amp;&amp;</span>&nbsp;<span class="ident" id="6338104">ch</span>&nbsp;<span class="op" id="6338107">&lt;=</span>&nbsp;<span class="string" id="6338110">&#39;9&#39;</span>&nbsp;<span class="op" id="6338114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6338117">func</span>&nbsp;<span class="op" id="6338122">(</span><span class="ident" id="6338123">s</span>&nbsp;<span class="op" id="6338125">*</span><span class="ident" id="6338126">Scanner</span><span class="op" id="6338133">)</span>&nbsp;<span class="ident" id="6338135">scanMantissa</span><span class="op" id="6338147">(</span><span class="ident" id="6338148">ch</span>&nbsp;<span class="builtintype" id="6338151">rune</span><span class="op" id="6338155">)</span>&nbsp;<span class="builtintype" id="6338157">rune</span>&nbsp;<span class="op" id="6338162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338165">for</span>&nbsp;<span class="ident" id="6338169">isDecimal</span><span class="op" id="6338178">(</span><span class="ident" id="6338179">ch</span><span class="op" id="6338181">)</span>&nbsp;<span class="op" id="6338183">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338187">ch</span>&nbsp;<span class="op" id="6338190">=</span>&nbsp;<span class="ident" id="6338192">s</span><span class="op" id="6338193">.</span><span class="ident" id="6338194">next</span><span class="op" id="6338198">(</span><span class="op" id="6338199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338205">return</span>&nbsp;<span class="ident" id="6338212">ch</span><br>
<span class="lineno"></span><span class="op" id="6338215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="6338218">func</span>&nbsp;<span class="op" id="6338223">(</span><span class="ident" id="6338224">s</span>&nbsp;<span class="op" id="6338226">*</span><span class="ident" id="6338227">Scanner</span><span class="op" id="6338234">)</span>&nbsp;<span class="ident" id="6338236">scanFraction</span><span class="op" id="6338248">(</span><span class="ident" id="6338249">ch</span>&nbsp;<span class="builtintype" id="6338252">rune</span><span class="op" id="6338256">)</span>&nbsp;<span class="builtintype" id="6338258">rune</span>&nbsp;<span class="op" id="6338263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338266">if</span>&nbsp;<span class="ident" id="6338269">ch</span>&nbsp;<span class="op" id="6338272">==</span>&nbsp;<span class="string" id="6338275">&#39;.&#39;</span>&nbsp;<span class="op" id="6338279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338283">ch</span>&nbsp;<span class="op" id="6338286">=</span>&nbsp;<span class="ident" id="6338288">s</span><span class="op" id="6338289">.</span><span class="ident" id="6338290">scanMantissa</span><span class="op" id="6338302">(</span><span class="ident" id="6338303">s</span><span class="op" id="6338304">.</span><span class="ident" id="6338305">next</span><span class="op" id="6338309">(</span><span class="op" id="6338310">)</span><span class="op" id="6338311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338317">return</span>&nbsp;<span class="ident" id="6338324">ch</span><br>
<span class="lineno">390</span><span class="op" id="6338327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6338330">func</span>&nbsp;<span class="op" id="6338335">(</span><span class="ident" id="6338336">s</span>&nbsp;<span class="op" id="6338338">*</span><span class="ident" id="6338339">Scanner</span><span class="op" id="6338346">)</span>&nbsp;<span class="ident" id="6338348">scanExponent</span><span class="op" id="6338360">(</span><span class="ident" id="6338361">ch</span>&nbsp;<span class="builtintype" id="6338364">rune</span><span class="op" id="6338368">)</span>&nbsp;<span class="builtintype" id="6338370">rune</span>&nbsp;<span class="op" id="6338375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338378">if</span>&nbsp;<span class="ident" id="6338381">ch</span>&nbsp;<span class="op" id="6338384">==</span>&nbsp;<span class="string" id="6338387">&#39;e&#39;</span>&nbsp;<span class="op" id="6338391">||</span>&nbsp;<span class="ident" id="6338394">ch</span>&nbsp;<span class="op" id="6338397">==</span>&nbsp;<span class="string" id="6338400">&#39;E&#39;</span>&nbsp;<span class="op" id="6338404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338408">ch</span>&nbsp;<span class="op" id="6338411">=</span>&nbsp;<span class="ident" id="6338413">s</span><span class="op" id="6338414">.</span><span class="ident" id="6338415">next</span><span class="op" id="6338419">(</span><span class="op" id="6338420">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338424">if</span>&nbsp;<span class="ident" id="6338427">ch</span>&nbsp;<span class="op" id="6338430">==</span>&nbsp;<span class="string" id="6338433">&#39;-&#39;</span>&nbsp;<span class="op" id="6338437">||</span>&nbsp;<span class="ident" id="6338440">ch</span>&nbsp;<span class="op" id="6338443">==</span>&nbsp;<span class="string" id="6338446">&#39;+&#39;</span>&nbsp;<span class="op" id="6338450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338455">ch</span>&nbsp;<span class="op" id="6338458">=</span>&nbsp;<span class="ident" id="6338460">s</span><span class="op" id="6338461">.</span><span class="ident" id="6338462">next</span><span class="op" id="6338466">(</span><span class="op" id="6338467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338475">ch</span>&nbsp;<span class="op" id="6338478">=</span>&nbsp;<span class="ident" id="6338480">s</span><span class="op" id="6338481">.</span><span class="ident" id="6338482">scanMantissa</span><span class="op" id="6338494">(</span><span class="ident" id="6338495">ch</span><span class="op" id="6338497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338500">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338503">return</span>&nbsp;<span class="ident" id="6338510">ch</span><br>
<span class="lineno"></span><span class="op" id="6338513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6338516">func</span>&nbsp;<span class="op" id="6338521">(</span><span class="ident" id="6338522">s</span>&nbsp;<span class="op" id="6338524">*</span><span class="ident" id="6338525">Scanner</span><span class="op" id="6338532">)</span>&nbsp;<span class="ident" id="6338534">scanNumber</span><span class="op" id="6338544">(</span><span class="ident" id="6338545">ch</span>&nbsp;<span class="builtintype" id="6338548">rune</span><span class="op" id="6338552">)</span>&nbsp;<span class="op" id="6338554">(</span><span class="builtintype" id="6338555">rune</span><span class="op" id="6338559">,</span>&nbsp;<span class="builtintype" id="6338561">rune</span><span class="op" id="6338565">)</span>&nbsp;<span class="op" id="6338567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6338570">//&nbsp;isDecimal(ch)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338588">if</span>&nbsp;<span class="ident" id="6338591">ch</span>&nbsp;<span class="op" id="6338594">==</span>&nbsp;<span class="string" id="6338597">&#39;0&#39;</span>&nbsp;<span class="op" id="6338601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6338605">//&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338623">ch</span>&nbsp;<span class="op" id="6338626">=</span>&nbsp;<span class="ident" id="6338628">s</span><span class="op" id="6338629">.</span><span class="ident" id="6338630">next</span><span class="op" id="6338634">(</span><span class="op" id="6338635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338639">if</span>&nbsp;<span class="ident" id="6338642">ch</span>&nbsp;<span class="op" id="6338645">==</span>&nbsp;<span class="string" id="6338648">&#39;x&#39;</span>&nbsp;<span class="op" id="6338652">||</span>&nbsp;<span class="ident" id="6338655">ch</span>&nbsp;<span class="op" id="6338658">==</span>&nbsp;<span class="string" id="6338661">&#39;X&#39;</span>&nbsp;<span class="op" id="6338665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6338670">//&nbsp;hexadecimal&nbsp;int</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338692">ch</span>&nbsp;<span class="op" id="6338695">=</span>&nbsp;<span class="ident" id="6338697">s</span><span class="op" id="6338698">.</span><span class="ident" id="6338699">next</span><span class="op" id="6338703">(</span><span class="op" id="6338704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338709">hasMantissa</span>&nbsp;<span class="op" id="6338721">:=</span>&nbsp;<span class="builtintype" id="6338724">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338733">for</span>&nbsp;<span class="ident" id="6338737">digitVal</span><span class="op" id="6338745">(</span><span class="ident" id="6338746">ch</span><span class="op" id="6338748">)</span>&nbsp;<span class="op" id="6338750">&lt;</span>&nbsp;<span class="num" id="6338752">16</span>&nbsp;<span class="op" id="6338755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338761">ch</span>&nbsp;<span class="op" id="6338764">=</span>&nbsp;<span class="ident" id="6338766">s</span><span class="op" id="6338767">.</span><span class="ident" id="6338768">next</span><span class="op" id="6338772">(</span><span class="op" id="6338773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338779">hasMantissa</span>&nbsp;<span class="op" id="6338791">=</span>&nbsp;<span class="builtintype" id="6338793">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338806">if</span>&nbsp;<span class="op" id="6338809">!</span><span class="ident" id="6338810">hasMantissa</span>&nbsp;<span class="op" id="6338822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338828">s</span><span class="op" id="6338829">.</span><span class="builtintype" id="6338830">error</span><span class="op" id="6338835">(</span><span class="string" id="6338836">&#34;illegal&nbsp;hexadecimal&nbsp;number&#34;</span><span class="op" id="6338864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338873">}</span>&nbsp;<span class="keyword" id="6338875">else</span>&nbsp;<span class="op" id="6338880">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6338885">//&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338910">has8or9</span>&nbsp;<span class="op" id="6338918">:=</span>&nbsp;<span class="builtintype" id="6338921">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338930">for</span>&nbsp;<span class="ident" id="6338934">isDecimal</span><span class="op" id="6338943">(</span><span class="ident" id="6338944">ch</span><span class="op" id="6338946">)</span>&nbsp;<span class="op" id="6338948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6338954">if</span>&nbsp;<span class="ident" id="6338957">ch</span>&nbsp;<span class="op" id="6338960">&gt;</span>&nbsp;<span class="string" id="6338962">&#39;7&#39;</span>&nbsp;<span class="op" id="6338966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338973">has8or9</span>&nbsp;<span class="op" id="6338981">=</span>&nbsp;<span class="builtintype" id="6338983">true</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6338992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6338998">ch</span>&nbsp;<span class="op" id="6339001">=</span>&nbsp;<span class="ident" id="6339003">s</span><span class="op" id="6339004">.</span><span class="ident" id="6339005">next</span><span class="op" id="6339009">(</span><span class="op" id="6339010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339020">if</span>&nbsp;<span class="ident" id="6339023">s</span><span class="op" id="6339024">.</span><span class="ident" id="6339025">Mode</span><span class="op" id="6339029">&amp;</span><span class="ident" id="6339030">ScanFloats</span>&nbsp;<span class="op" id="6339041">!=</span>&nbsp;<span class="num" id="6339044">0</span>&nbsp;<span class="op" id="6339046">&amp;&amp;</span>&nbsp;<span class="op" id="6339049">(</span><span class="ident" id="6339050">ch</span>&nbsp;<span class="op" id="6339053">==</span>&nbsp;<span class="string" id="6339056">&#39;.&#39;</span>&nbsp;<span class="op" id="6339060">||</span>&nbsp;<span class="ident" id="6339063">ch</span>&nbsp;<span class="op" id="6339066">==</span>&nbsp;<span class="string" id="6339069">&#39;e&#39;</span>&nbsp;<span class="op" id="6339073">||</span>&nbsp;<span class="ident" id="6339076">ch</span>&nbsp;<span class="op" id="6339079">==</span>&nbsp;<span class="string" id="6339082">&#39;E&#39;</span><span class="op" id="6339085">)</span>&nbsp;<span class="op" id="6339087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6339093">//&nbsp;float</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339106">ch</span>&nbsp;<span class="op" id="6339109">=</span>&nbsp;<span class="ident" id="6339111">s</span><span class="op" id="6339112">.</span><span class="ident" id="6339113">scanFraction</span><span class="op" id="6339125">(</span><span class="ident" id="6339126">ch</span><span class="op" id="6339128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339134">ch</span>&nbsp;<span class="op" id="6339137">=</span>&nbsp;<span class="ident" id="6339139">s</span><span class="op" id="6339140">.</span><span class="ident" id="6339141">scanExponent</span><span class="op" id="6339153">(</span><span class="ident" id="6339154">ch</span><span class="op" id="6339156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339162">return</span>&nbsp;<span class="ident" id="6339169">Float</span><span class="op" id="6339174">,</span>&nbsp;<span class="ident" id="6339176">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6339187">//&nbsp;octal&nbsp;int</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339203">if</span>&nbsp;<span class="ident" id="6339206">has8or9</span>&nbsp;<span class="op" id="6339214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339220">s</span><span class="op" id="6339221">.</span><span class="builtintype" id="6339222">error</span><span class="op" id="6339227">(</span><span class="string" id="6339228">&#34;illegal&nbsp;octal&nbsp;number&#34;</span><span class="op" id="6339250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339263">return</span>&nbsp;<span class="ident" id="6339270">Int</span><span class="op" id="6339273">,</span>&nbsp;<span class="ident" id="6339275">ch</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6339282">//&nbsp;decimal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339307">ch</span>&nbsp;<span class="op" id="6339310">=</span>&nbsp;<span class="ident" id="6339312">s</span><span class="op" id="6339313">.</span><span class="ident" id="6339314">scanMantissa</span><span class="op" id="6339326">(</span><span class="ident" id="6339327">ch</span><span class="op" id="6339329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339332">if</span>&nbsp;<span class="ident" id="6339335">s</span><span class="op" id="6339336">.</span><span class="ident" id="6339337">Mode</span><span class="op" id="6339341">&amp;</span><span class="ident" id="6339342">ScanFloats</span>&nbsp;<span class="op" id="6339353">!=</span>&nbsp;<span class="num" id="6339356">0</span>&nbsp;<span class="op" id="6339358">&amp;&amp;</span>&nbsp;<span class="op" id="6339361">(</span><span class="ident" id="6339362">ch</span>&nbsp;<span class="op" id="6339365">==</span>&nbsp;<span class="string" id="6339368">&#39;.&#39;</span>&nbsp;<span class="op" id="6339372">||</span>&nbsp;<span class="ident" id="6339375">ch</span>&nbsp;<span class="op" id="6339378">==</span>&nbsp;<span class="string" id="6339381">&#39;e&#39;</span>&nbsp;<span class="op" id="6339385">||</span>&nbsp;<span class="ident" id="6339388">ch</span>&nbsp;<span class="op" id="6339391">==</span>&nbsp;<span class="string" id="6339394">&#39;E&#39;</span><span class="op" id="6339397">)</span>&nbsp;<span class="op" id="6339399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6339403">//&nbsp;float</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339414">ch</span>&nbsp;<span class="op" id="6339417">=</span>&nbsp;<span class="ident" id="6339419">s</span><span class="op" id="6339420">.</span><span class="ident" id="6339421">scanFraction</span><span class="op" id="6339433">(</span><span class="ident" id="6339434">ch</span><span class="op" id="6339436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339440">ch</span>&nbsp;<span class="op" id="6339443">=</span>&nbsp;<span class="ident" id="6339445">s</span><span class="op" id="6339446">.</span><span class="ident" id="6339447">scanExponent</span><span class="op" id="6339459">(</span><span class="ident" id="6339460">ch</span><span class="op" id="6339462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339466">return</span>&nbsp;<span class="ident" id="6339473">Float</span><span class="op" id="6339478">,</span>&nbsp;<span class="ident" id="6339480">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339487">return</span>&nbsp;<span class="ident" id="6339494">Int</span><span class="op" id="6339497">,</span>&nbsp;<span class="ident" id="6339499">ch</span><br>
<span class="lineno">450</span><span class="op" id="6339502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6339505">func</span>&nbsp;<span class="op" id="6339510">(</span><span class="ident" id="6339511">s</span>&nbsp;<span class="op" id="6339513">*</span><span class="ident" id="6339514">Scanner</span><span class="op" id="6339521">)</span>&nbsp;<span class="ident" id="6339523">scanDigits</span><span class="op" id="6339533">(</span><span class="ident" id="6339534">ch</span>&nbsp;<span class="builtintype" id="6339537">rune</span><span class="op" id="6339541">,</span>&nbsp;<span class="ident" id="6339543">base</span><span class="op" id="6339547">,</span>&nbsp;<span class="ident" id="6339549">n</span>&nbsp;<span class="builtintype" id="6339551">int</span><span class="op" id="6339554">)</span>&nbsp;<span class="builtintype" id="6339556">rune</span>&nbsp;<span class="op" id="6339561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339564">for</span>&nbsp;<span class="ident" id="6339568">n</span>&nbsp;<span class="op" id="6339570">&gt;</span>&nbsp;<span class="num" id="6339572">0</span>&nbsp;<span class="op" id="6339574">&amp;&amp;</span>&nbsp;<span class="ident" id="6339577">digitVal</span><span class="op" id="6339585">(</span><span class="ident" id="6339586">ch</span><span class="op" id="6339588">)</span>&nbsp;<span class="op" id="6339590">&lt;</span>&nbsp;<span class="ident" id="6339592">base</span>&nbsp;<span class="op" id="6339597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339601">ch</span>&nbsp;<span class="op" id="6339604">=</span>&nbsp;<span class="ident" id="6339606">s</span><span class="op" id="6339607">.</span><span class="ident" id="6339608">next</span><span class="op" id="6339612">(</span><span class="op" id="6339613">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339617">n</span><span class="op" id="6339618">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339625">if</span>&nbsp;<span class="ident" id="6339628">n</span>&nbsp;<span class="op" id="6339630">&gt;</span>&nbsp;<span class="num" id="6339632">0</span>&nbsp;<span class="op" id="6339634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339638">s</span><span class="op" id="6339639">.</span><span class="builtintype" id="6339640">error</span><span class="op" id="6339645">(</span><span class="string" id="6339646">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="6339667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6339670">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339673">return</span>&nbsp;<span class="ident" id="6339680">ch</span><br>
<span class="lineno"></span><span class="op" id="6339683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6339686">func</span>&nbsp;<span class="op" id="6339691">(</span><span class="ident" id="6339692">s</span>&nbsp;<span class="op" id="6339694">*</span><span class="ident" id="6339695">Scanner</span><span class="op" id="6339702">)</span>&nbsp;<span class="ident" id="6339704">scanEscape</span><span class="op" id="6339714">(</span><span class="ident" id="6339715">quote</span>&nbsp;<span class="builtintype" id="6339721">rune</span><span class="op" id="6339725">)</span>&nbsp;<span class="builtintype" id="6339727">rune</span>&nbsp;<span class="op" id="6339732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339735">ch</span>&nbsp;<span class="op" id="6339738">:=</span>&nbsp;<span class="ident" id="6339741">s</span><span class="op" id="6339742">.</span><span class="ident" id="6339743">next</span><span class="op" id="6339747">(</span><span class="op" id="6339748">)</span>&nbsp;<span class="comment" id="6339750">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;/&#39;</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339779">switch</span>&nbsp;<span class="ident" id="6339786">ch</span>&nbsp;<span class="op" id="6339789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339792">case</span>&nbsp;<span class="string" id="6339797">&#39;a&#39;</span><span class="op" id="6339800">,</span>&nbsp;<span class="string" id="6339802">&#39;b&#39;</span><span class="op" id="6339805">,</span>&nbsp;<span class="string" id="6339807">&#39;f&#39;</span><span class="op" id="6339810">,</span>&nbsp;<span class="string" id="6339812">&#39;n&#39;</span><span class="op" id="6339815">,</span>&nbsp;<span class="string" id="6339817">&#39;r&#39;</span><span class="op" id="6339820">,</span>&nbsp;<span class="string" id="6339822">&#39;t&#39;</span><span class="op" id="6339825">,</span>&nbsp;<span class="string" id="6339827">&#39;v&#39;</span><span class="op" id="6339830">,</span>&nbsp;<span class="string" id="6339832">&#39;\\&#39;</span><span class="op" id="6339836">,</span>&nbsp;<span class="ident" id="6339838">quote</span><span class="op" id="6339843">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6339847">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339866">ch</span>&nbsp;<span class="op" id="6339869">=</span>&nbsp;<span class="ident" id="6339871">s</span><span class="op" id="6339872">.</span><span class="ident" id="6339873">next</span><span class="op" id="6339877">(</span><span class="op" id="6339878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339881">case</span>&nbsp;<span class="string" id="6339886">&#39;0&#39;</span><span class="op" id="6339889">,</span>&nbsp;<span class="string" id="6339891">&#39;1&#39;</span><span class="op" id="6339894">,</span>&nbsp;<span class="string" id="6339896">&#39;2&#39;</span><span class="op" id="6339899">,</span>&nbsp;<span class="string" id="6339901">&#39;3&#39;</span><span class="op" id="6339904">,</span>&nbsp;<span class="string" id="6339906">&#39;4&#39;</span><span class="op" id="6339909">,</span>&nbsp;<span class="string" id="6339911">&#39;5&#39;</span><span class="op" id="6339914">,</span>&nbsp;<span class="string" id="6339916">&#39;6&#39;</span><span class="op" id="6339919">,</span>&nbsp;<span class="string" id="6339921">&#39;7&#39;</span><span class="op" id="6339924">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339928">ch</span>&nbsp;<span class="op" id="6339931">=</span>&nbsp;<span class="ident" id="6339933">s</span><span class="op" id="6339934">.</span><span class="ident" id="6339935">scanDigits</span><span class="op" id="6339945">(</span><span class="ident" id="6339946">ch</span><span class="op" id="6339948">,</span>&nbsp;<span class="num" id="6339950">8</span><span class="op" id="6339951">,</span>&nbsp;<span class="num" id="6339953">3</span><span class="op" id="6339954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6339957">case</span>&nbsp;<span class="string" id="6339962">&#39;x&#39;</span><span class="op" id="6339965">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6339969">ch</span>&nbsp;<span class="op" id="6339972">=</span>&nbsp;<span class="ident" id="6339974">s</span><span class="op" id="6339975">.</span><span class="ident" id="6339976">scanDigits</span><span class="op" id="6339986">(</span><span class="ident" id="6339987">s</span><span class="op" id="6339988">.</span><span class="ident" id="6339989">next</span><span class="op" id="6339993">(</span><span class="op" id="6339994">)</span><span class="op" id="6339995">,</span>&nbsp;<span class="num" id="6339997">16</span><span class="op" id="6339999">,</span>&nbsp;<span class="num" id="6340001">2</span><span class="op" id="6340002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340005">case</span>&nbsp;<span class="string" id="6340010">&#39;u&#39;</span><span class="op" id="6340013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340017">ch</span>&nbsp;<span class="op" id="6340020">=</span>&nbsp;<span class="ident" id="6340022">s</span><span class="op" id="6340023">.</span><span class="ident" id="6340024">scanDigits</span><span class="op" id="6340034">(</span><span class="ident" id="6340035">s</span><span class="op" id="6340036">.</span><span class="ident" id="6340037">next</span><span class="op" id="6340041">(</span><span class="op" id="6340042">)</span><span class="op" id="6340043">,</span>&nbsp;<span class="num" id="6340045">16</span><span class="op" id="6340047">,</span>&nbsp;<span class="num" id="6340049">4</span><span class="op" id="6340050">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340053">case</span>&nbsp;<span class="string" id="6340058">&#39;U&#39;</span><span class="op" id="6340061">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340065">ch</span>&nbsp;<span class="op" id="6340068">=</span>&nbsp;<span class="ident" id="6340070">s</span><span class="op" id="6340071">.</span><span class="ident" id="6340072">scanDigits</span><span class="op" id="6340082">(</span><span class="ident" id="6340083">s</span><span class="op" id="6340084">.</span><span class="ident" id="6340085">next</span><span class="op" id="6340089">(</span><span class="op" id="6340090">)</span><span class="op" id="6340091">,</span>&nbsp;<span class="num" id="6340093">16</span><span class="op" id="6340095">,</span>&nbsp;<span class="num" id="6340097">8</span><span class="op" id="6340098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340101">default</span><span class="op" id="6340108">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340112">s</span><span class="op" id="6340113">.</span><span class="builtintype" id="6340114">error</span><span class="op" id="6340119">(</span><span class="string" id="6340120">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="6340141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340144">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340147">return</span>&nbsp;<span class="ident" id="6340154">ch</span><br>
<span class="lineno"></span><span class="op" id="6340157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6340160">func</span>&nbsp;<span class="op" id="6340165">(</span><span class="ident" id="6340166">s</span>&nbsp;<span class="op" id="6340168">*</span><span class="ident" id="6340169">Scanner</span><span class="op" id="6340176">)</span>&nbsp;<span class="ident" id="6340178">scanString</span><span class="op" id="6340188">(</span><span class="ident" id="6340189">quote</span>&nbsp;<span class="builtintype" id="6340195">rune</span><span class="op" id="6340199">)</span>&nbsp;<span class="op" id="6340201">(</span><span class="ident" id="6340202">n</span>&nbsp;<span class="builtintype" id="6340204">int</span><span class="op" id="6340207">)</span>&nbsp;<span class="op" id="6340209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340212">ch</span>&nbsp;<span class="op" id="6340215">:=</span>&nbsp;<span class="ident" id="6340218">s</span><span class="op" id="6340219">.</span><span class="ident" id="6340220">next</span><span class="op" id="6340224">(</span><span class="op" id="6340225">)</span>&nbsp;<span class="comment" id="6340227">//&nbsp;read&nbsp;character&nbsp;after&nbsp;quote</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340258">for</span>&nbsp;<span class="ident" id="6340262">ch</span>&nbsp;<span class="op" id="6340265">!=</span>&nbsp;<span class="ident" id="6340268">quote</span>&nbsp;<span class="op" id="6340274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340278">if</span>&nbsp;<span class="ident" id="6340281">ch</span>&nbsp;<span class="op" id="6340284">==</span>&nbsp;<span class="string" id="6340287">&#39;\n&#39;</span>&nbsp;<span class="op" id="6340292">||</span>&nbsp;<span class="ident" id="6340295">ch</span>&nbsp;<span class="op" id="6340298">&lt;</span>&nbsp;<span class="num" id="6340300">0</span>&nbsp;<span class="op" id="6340302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340307">s</span><span class="op" id="6340308">.</span><span class="builtintype" id="6340309">error</span><span class="op" id="6340314">(</span><span class="string" id="6340315">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6340339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340344">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340353">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340357">if</span>&nbsp;<span class="ident" id="6340360">ch</span>&nbsp;<span class="op" id="6340363">==</span>&nbsp;<span class="string" id="6340366">&#39;\\&#39;</span>&nbsp;<span class="op" id="6340371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340376">ch</span>&nbsp;<span class="op" id="6340379">=</span>&nbsp;<span class="ident" id="6340381">s</span><span class="op" id="6340382">.</span><span class="ident" id="6340383">scanEscape</span><span class="op" id="6340393">(</span><span class="ident" id="6340394">quote</span><span class="op" id="6340399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340403">}</span>&nbsp;<span class="keyword" id="6340405">else</span>&nbsp;<span class="op" id="6340410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340415">ch</span>&nbsp;<span class="op" id="6340418">=</span>&nbsp;<span class="ident" id="6340420">s</span><span class="op" id="6340421">.</span><span class="ident" id="6340422">next</span><span class="op" id="6340426">(</span><span class="op" id="6340427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340431">}</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340435">n</span><span class="op" id="6340436">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340443">return</span><br>
<span class="lineno"></span><span class="op" id="6340450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="6340453">func</span>&nbsp;<span class="op" id="6340458">(</span><span class="ident" id="6340459">s</span>&nbsp;<span class="op" id="6340461">*</span><span class="ident" id="6340462">Scanner</span><span class="op" id="6340469">)</span>&nbsp;<span class="ident" id="6340471">scanRawString</span><span class="op" id="6340484">(</span><span class="op" id="6340485">)</span>&nbsp;<span class="op" id="6340487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340490">ch</span>&nbsp;<span class="op" id="6340493">:=</span>&nbsp;<span class="ident" id="6340496">s</span><span class="op" id="6340497">.</span><span class="ident" id="6340498">next</span><span class="op" id="6340502">(</span><span class="op" id="6340503">)</span>&nbsp;<span class="comment" id="6340505">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;`&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340534">for</span>&nbsp;<span class="ident" id="6340538">ch</span>&nbsp;<span class="op" id="6340541">!=</span>&nbsp;<span class="string" id="6340544">&#39;`&#39;</span>&nbsp;<span class="op" id="6340548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340552">if</span>&nbsp;<span class="ident" id="6340555">ch</span>&nbsp;<span class="op" id="6340558">&lt;</span>&nbsp;<span class="num" id="6340560">0</span>&nbsp;<span class="op" id="6340562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340567">s</span><span class="op" id="6340568">.</span><span class="builtintype" id="6340569">error</span><span class="op" id="6340574">(</span><span class="string" id="6340575">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6340599">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340604">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340617">ch</span>&nbsp;<span class="op" id="6340620">=</span>&nbsp;<span class="ident" id="6340622">s</span><span class="op" id="6340623">.</span><span class="ident" id="6340624">next</span><span class="op" id="6340628">(</span><span class="op" id="6340629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340632">}</span><br>
<span class="lineno"></span><span class="op" id="6340634">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="6340637">func</span>&nbsp;<span class="op" id="6340642">(</span><span class="ident" id="6340643">s</span>&nbsp;<span class="op" id="6340645">*</span><span class="ident" id="6340646">Scanner</span><span class="op" id="6340653">)</span>&nbsp;<span class="ident" id="6340655">scanChar</span><span class="op" id="6340663">(</span><span class="op" id="6340664">)</span>&nbsp;<span class="op" id="6340666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340669">if</span>&nbsp;<span class="ident" id="6340672">s</span><span class="op" id="6340673">.</span><span class="ident" id="6340674">scanString</span><span class="op" id="6340684">(</span><span class="string" id="6340685">&#39;\&#39;&#39;</span><span class="op" id="6340689">)</span>&nbsp;<span class="op" id="6340691">!=</span>&nbsp;<span class="num" id="6340694">1</span>&nbsp;<span class="op" id="6340696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340700">s</span><span class="op" id="6340701">.</span><span class="builtintype" id="6340702">error</span><span class="op" id="6340707">(</span><span class="string" id="6340708">&#34;illegal&nbsp;char&nbsp;literal&#34;</span><span class="op" id="6340730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340733">}</span><br>
<span class="lineno">515</span><span class="op" id="6340735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6340738">func</span>&nbsp;<span class="op" id="6340743">(</span><span class="ident" id="6340744">s</span>&nbsp;<span class="op" id="6340746">*</span><span class="ident" id="6340747">Scanner</span><span class="op" id="6340754">)</span>&nbsp;<span class="ident" id="6340756">scanComment</span><span class="op" id="6340767">(</span><span class="ident" id="6340768">ch</span>&nbsp;<span class="builtintype" id="6340771">rune</span><span class="op" id="6340775">)</span>&nbsp;<span class="builtintype" id="6340777">rune</span>&nbsp;<span class="op" id="6340782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6340785">//&nbsp;ch&nbsp;==&nbsp;&#39;/&#39;&nbsp;||&nbsp;ch&nbsp;==&nbsp;&#39;*&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340812">if</span>&nbsp;<span class="ident" id="6340815">ch</span>&nbsp;<span class="op" id="6340818">==</span>&nbsp;<span class="string" id="6340821">&#39;/&#39;</span>&nbsp;<span class="op" id="6340825">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6340829">//&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340847">ch</span>&nbsp;<span class="op" id="6340850">=</span>&nbsp;<span class="ident" id="6340852">s</span><span class="op" id="6340853">.</span><span class="ident" id="6340854">next</span><span class="op" id="6340858">(</span><span class="op" id="6340859">)</span>&nbsp;<span class="comment" id="6340861">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;//&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340892">for</span>&nbsp;<span class="ident" id="6340896">ch</span>&nbsp;<span class="op" id="6340899">!=</span>&nbsp;<span class="string" id="6340902">&#39;\n&#39;</span>&nbsp;<span class="op" id="6340907">&amp;&amp;</span>&nbsp;<span class="ident" id="6340910">ch</span>&nbsp;<span class="op" id="6340913">&gt;=</span>&nbsp;<span class="num" id="6340916">0</span>&nbsp;<span class="op" id="6340918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340923">ch</span>&nbsp;<span class="op" id="6340926">=</span>&nbsp;<span class="ident" id="6340928">s</span><span class="op" id="6340929">.</span><span class="ident" id="6340930">next</span><span class="op" id="6340934">(</span><span class="op" id="6340935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340939">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6340943">return</span>&nbsp;<span class="ident" id="6340950">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6340954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6340958">//&nbsp;general&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6340978">ch</span>&nbsp;<span class="op" id="6340981">=</span>&nbsp;<span class="ident" id="6340983">s</span><span class="op" id="6340984">.</span><span class="ident" id="6340985">next</span><span class="op" id="6340989">(</span><span class="op" id="6340990">)</span>&nbsp;<span class="comment" id="6340992">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;/*&#34;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341022">for</span>&nbsp;<span class="op" id="6341026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341030">if</span>&nbsp;<span class="ident" id="6341033">ch</span>&nbsp;<span class="op" id="6341036">&lt;</span>&nbsp;<span class="num" id="6341038">0</span>&nbsp;<span class="op" id="6341040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341045">s</span><span class="op" id="6341046">.</span><span class="builtintype" id="6341047">error</span><span class="op" id="6341052">(</span><span class="string" id="6341053">&#34;comment&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6341077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341082">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341090">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341094">ch0</span>&nbsp;<span class="op" id="6341098">:=</span>&nbsp;<span class="ident" id="6341101">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341106">ch</span>&nbsp;<span class="op" id="6341109">=</span>&nbsp;<span class="ident" id="6341111">s</span><span class="op" id="6341112">.</span><span class="ident" id="6341113">next</span><span class="op" id="6341117">(</span><span class="op" id="6341118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341122">if</span>&nbsp;<span class="ident" id="6341125">ch0</span>&nbsp;<span class="op" id="6341129">==</span>&nbsp;<span class="string" id="6341132">&#39;*&#39;</span>&nbsp;<span class="op" id="6341136">&amp;&amp;</span>&nbsp;<span class="ident" id="6341139">ch</span>&nbsp;<span class="op" id="6341142">==</span>&nbsp;<span class="string" id="6341145">&#39;/&#39;</span>&nbsp;<span class="op" id="6341149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341154">ch</span>&nbsp;<span class="op" id="6341157">=</span>&nbsp;<span class="ident" id="6341159">s</span><span class="op" id="6341160">.</span><span class="ident" id="6341161">next</span><span class="op" id="6341165">(</span><span class="op" id="6341166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341171">break</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341185">return</span>&nbsp;<span class="ident" id="6341192">ch</span><br>
<span class="lineno"></span><span class="op" id="6341195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="6341198">//&nbsp;Scan&nbsp;reads&nbsp;the&nbsp;next&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character&nbsp;from&nbsp;source&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6341276">//&nbsp;It&nbsp;only&nbsp;recognizes&nbsp;tokens&nbsp;t&nbsp;for&nbsp;which&nbsp;the&nbsp;respective&nbsp;Mode&nbsp;bit&nbsp;(1&lt;&lt;-t)&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="6341357">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports&nbsp;scanner&nbsp;errors&nbsp;(read&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6341437">//&nbsp;token&nbsp;errors)&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise&nbsp;it&nbsp;prints&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="6341515">//&nbsp;message&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">550</span><span class="keyword" id="6341540">func</span>&nbsp;<span class="op" id="6341545">(</span><span class="ident" id="6341546">s</span>&nbsp;<span class="op" id="6341548">*</span><span class="ident" id="6341549">Scanner</span><span class="op" id="6341556">)</span>&nbsp;<span class="ident" id="6341558">Scan</span><span class="op" id="6341562">(</span><span class="op" id="6341563">)</span>&nbsp;<span class="builtintype" id="6341565">rune</span>&nbsp;<span class="op" id="6341570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341573">ch</span>&nbsp;<span class="op" id="6341576">:=</span>&nbsp;<span class="ident" id="6341579">s</span><span class="op" id="6341580">.</span><span class="ident" id="6341581">Peek</span><span class="op" id="6341585">(</span><span class="op" id="6341586">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6341590">//&nbsp;reset&nbsp;token&nbsp;text&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341620">s</span><span class="op" id="6341621">.</span><span class="ident" id="6341622">tokPos</span>&nbsp;<span class="op" id="6341629">=</span>&nbsp;<span class="op" id="6341631">-</span><span class="num" id="6341632">1</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341635">s</span><span class="op" id="6341636">.</span><span class="ident" id="6341637">Line</span>&nbsp;<span class="op" id="6341642">=</span>&nbsp;<span class="num" id="6341644">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="6341647">redo</span><span class="op" id="6341651">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6341654">//&nbsp;skip&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341675">for</span>&nbsp;<span class="ident" id="6341679">s</span><span class="op" id="6341680">.</span><span class="ident" id="6341681">Whitespace</span><span class="op" id="6341691">&amp;</span><span class="op" id="6341692">(</span><span class="num" id="6341693">1</span><span class="op" id="6341694">&lt;&lt;</span><span class="builtintype" id="6341696">uint</span><span class="op" id="6341700">(</span><span class="ident" id="6341701">ch</span><span class="op" id="6341703">)</span><span class="op" id="6341704">)</span>&nbsp;<span class="op" id="6341706">!=</span>&nbsp;<span class="num" id="6341709">0</span>&nbsp;<span class="op" id="6341711">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341715">ch</span>&nbsp;<span class="op" id="6341718">=</span>&nbsp;<span class="ident" id="6341720">s</span><span class="op" id="6341721">.</span><span class="ident" id="6341722">next</span><span class="op" id="6341726">(</span><span class="op" id="6341727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6341730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6341734">//&nbsp;start&nbsp;collecting&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341766">s</span><span class="op" id="6341767">.</span><span class="ident" id="6341768">tokBuf</span><span class="op" id="6341774">.</span><span class="ident" id="6341775">Reset</span><span class="op" id="6341780">(</span><span class="op" id="6341781">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341784">s</span><span class="op" id="6341785">.</span><span class="ident" id="6341786">tokPos</span>&nbsp;<span class="op" id="6341793">=</span>&nbsp;<span class="ident" id="6341795">s</span><span class="op" id="6341796">.</span><span class="ident" id="6341797">srcPos</span>&nbsp;<span class="op" id="6341804">-</span>&nbsp;<span class="ident" id="6341806">s</span><span class="op" id="6341807">.</span><span class="ident" id="6341808">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6341822">//&nbsp;set&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6341845">//&nbsp;(this&nbsp;is&nbsp;a&nbsp;slightly&nbsp;optimized&nbsp;version&nbsp;of&nbsp;the&nbsp;code&nbsp;in&nbsp;Pos())</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6341909">s</span><span class="op" id="6341910">.</span><span class="ident" id="6341911">Offset</span>&nbsp;<span class="op" id="6341918">=</span>&nbsp;<span class="ident" id="6341920">s</span><span class="op" id="6341921">.</span><span class="ident" id="6341922">srcBufOffset</span>&nbsp;<span class="op" id="6341935">+</span>&nbsp;<span class="ident" id="6341937">s</span><span class="op" id="6341938">.</span><span class="ident" id="6341939">tokPos</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6341947">if</span>&nbsp;<span class="ident" id="6341950">s</span><span class="op" id="6341951">.</span><span class="ident" id="6341952">column</span>&nbsp;<span class="op" id="6341959">&gt;</span>&nbsp;<span class="num" id="6341961">0</span>&nbsp;<span class="op" id="6341963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6341967">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342015">s</span><span class="op" id="6342016">.</span><span class="ident" id="6342017">Line</span>&nbsp;<span class="op" id="6342022">=</span>&nbsp;<span class="ident" id="6342024">s</span><span class="op" id="6342025">.</span><span class="ident" id="6342026">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342033">s</span><span class="op" id="6342034">.</span><span class="ident" id="6342035">Column</span>&nbsp;<span class="op" id="6342042">=</span>&nbsp;<span class="ident" id="6342044">s</span><span class="op" id="6342045">.</span><span class="ident" id="6342046">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342054">}</span>&nbsp;<span class="keyword" id="6342056">else</span>&nbsp;<span class="op" id="6342061">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6342065">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6342096">//&nbsp;(we&nbsp;cannot&nbsp;be&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6342146">//&nbsp;since&nbsp;we&nbsp;have&nbsp;called&nbsp;next()&nbsp;at&nbsp;least&nbsp;once)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342194">s</span><span class="op" id="6342195">.</span><span class="ident" id="6342196">Line</span>&nbsp;<span class="op" id="6342201">=</span>&nbsp;<span class="ident" id="6342203">s</span><span class="op" id="6342204">.</span><span class="ident" id="6342205">line</span>&nbsp;<span class="op" id="6342210">-</span>&nbsp;<span class="num" id="6342212">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342216">s</span><span class="op" id="6342217">.</span><span class="ident" id="6342218">Column</span>&nbsp;<span class="op" id="6342225">=</span>&nbsp;<span class="ident" id="6342227">s</span><span class="op" id="6342228">.</span><span class="ident" id="6342229">lastLineLen</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6342246">//&nbsp;determine&nbsp;token&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342272">tok</span>&nbsp;<span class="op" id="6342276">:=</span>&nbsp;<span class="ident" id="6342279">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342283">switch</span>&nbsp;<span class="op" id="6342290">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342293">case</span>&nbsp;<span class="ident" id="6342298">s</span><span class="op" id="6342299">.</span><span class="ident" id="6342300">isIdentRune</span><span class="op" id="6342311">(</span><span class="ident" id="6342312">ch</span><span class="op" id="6342314">,</span>&nbsp;<span class="num" id="6342316">0</span><span class="op" id="6342317">)</span><span class="op" id="6342318">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342322">if</span>&nbsp;<span class="ident" id="6342325">s</span><span class="op" id="6342326">.</span><span class="ident" id="6342327">Mode</span><span class="op" id="6342331">&amp;</span><span class="ident" id="6342332">ScanIdents</span>&nbsp;<span class="op" id="6342343">!=</span>&nbsp;<span class="num" id="6342346">0</span>&nbsp;<span class="op" id="6342348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342353">tok</span>&nbsp;<span class="op" id="6342357">=</span>&nbsp;<span class="ident" id="6342359">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342368">ch</span>&nbsp;<span class="op" id="6342371">=</span>&nbsp;<span class="ident" id="6342373">s</span><span class="op" id="6342374">.</span><span class="ident" id="6342375">scanIdentifier</span><span class="op" id="6342389">(</span><span class="op" id="6342390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342394">}</span>&nbsp;<span class="keyword" id="6342396">else</span>&nbsp;<span class="op" id="6342401">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342406">ch</span>&nbsp;<span class="op" id="6342409">=</span>&nbsp;<span class="ident" id="6342411">s</span><span class="op" id="6342412">.</span><span class="ident" id="6342413">next</span><span class="op" id="6342417">(</span><span class="op" id="6342418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342425">case</span>&nbsp;<span class="ident" id="6342430">isDecimal</span><span class="op" id="6342439">(</span><span class="ident" id="6342440">ch</span><span class="op" id="6342442">)</span><span class="op" id="6342443">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342447">if</span>&nbsp;<span class="ident" id="6342450">s</span><span class="op" id="6342451">.</span><span class="ident" id="6342452">Mode</span><span class="op" id="6342456">&amp;</span><span class="op" id="6342457">(</span><span class="ident" id="6342458">ScanInts</span><span class="op" id="6342466">|</span><span class="ident" id="6342467">ScanFloats</span><span class="op" id="6342477">)</span>&nbsp;<span class="op" id="6342479">!=</span>&nbsp;<span class="num" id="6342482">0</span>&nbsp;<span class="op" id="6342484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342489">tok</span><span class="op" id="6342492">,</span>&nbsp;<span class="ident" id="6342494">ch</span>&nbsp;<span class="op" id="6342497">=</span>&nbsp;<span class="ident" id="6342499">s</span><span class="op" id="6342500">.</span><span class="ident" id="6342501">scanNumber</span><span class="op" id="6342511">(</span><span class="ident" id="6342512">ch</span><span class="op" id="6342514">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342518">}</span>&nbsp;<span class="keyword" id="6342520">else</span>&nbsp;<span class="op" id="6342525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342530">ch</span>&nbsp;<span class="op" id="6342533">=</span>&nbsp;<span class="ident" id="6342535">s</span><span class="op" id="6342536">.</span><span class="ident" id="6342537">next</span><span class="op" id="6342541">(</span><span class="op" id="6342542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342549">default</span><span class="op" id="6342556">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342560">switch</span>&nbsp;<span class="ident" id="6342567">ch</span>&nbsp;<span class="op" id="6342570">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342574">case</span>&nbsp;<span class="string" id="6342579">&#39;&#34;&#39;</span><span class="op" id="6342582">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342587">if</span>&nbsp;<span class="ident" id="6342590">s</span><span class="op" id="6342591">.</span><span class="ident" id="6342592">Mode</span><span class="op" id="6342596">&amp;</span><span class="ident" id="6342597">ScanStrings</span>&nbsp;<span class="op" id="6342609">!=</span>&nbsp;<span class="num" id="6342612">0</span>&nbsp;<span class="op" id="6342614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342620">s</span><span class="op" id="6342621">.</span><span class="ident" id="6342622">scanString</span><span class="op" id="6342632">(</span><span class="string" id="6342633">&#39;&#34;&#39;</span><span class="op" id="6342636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342642">tok</span>&nbsp;<span class="op" id="6342646">=</span>&nbsp;<span class="ident" id="6342648">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342658">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342663">ch</span>&nbsp;<span class="op" id="6342666">=</span>&nbsp;<span class="ident" id="6342668">s</span><span class="op" id="6342669">.</span><span class="ident" id="6342670">next</span><span class="op" id="6342674">(</span><span class="op" id="6342675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342679">case</span>&nbsp;<span class="string" id="6342684">&#39;\&#39;&#39;</span><span class="op" id="6342688">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342693">if</span>&nbsp;<span class="ident" id="6342696">s</span><span class="op" id="6342697">.</span><span class="ident" id="6342698">Mode</span><span class="op" id="6342702">&amp;</span><span class="ident" id="6342703">ScanChars</span>&nbsp;<span class="op" id="6342713">!=</span>&nbsp;<span class="num" id="6342716">0</span>&nbsp;<span class="op" id="6342718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342724">s</span><span class="op" id="6342725">.</span><span class="ident" id="6342726">scanChar</span><span class="op" id="6342734">(</span><span class="op" id="6342735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342741">tok</span>&nbsp;<span class="op" id="6342745">=</span>&nbsp;<span class="ident" id="6342747">Char</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342760">ch</span>&nbsp;<span class="op" id="6342763">=</span>&nbsp;<span class="ident" id="6342765">s</span><span class="op" id="6342766">.</span><span class="ident" id="6342767">next</span><span class="op" id="6342771">(</span><span class="op" id="6342772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342776">case</span>&nbsp;<span class="string" id="6342781">&#39;.&#39;</span><span class="op" id="6342784">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342789">ch</span>&nbsp;<span class="op" id="6342792">=</span>&nbsp;<span class="ident" id="6342794">s</span><span class="op" id="6342795">.</span><span class="ident" id="6342796">next</span><span class="op" id="6342800">(</span><span class="op" id="6342801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342806">if</span>&nbsp;<span class="ident" id="6342809">isDecimal</span><span class="op" id="6342818">(</span><span class="ident" id="6342819">ch</span><span class="op" id="6342821">)</span>&nbsp;<span class="op" id="6342823">&amp;&amp;</span>&nbsp;<span class="ident" id="6342826">s</span><span class="op" id="6342827">.</span><span class="ident" id="6342828">Mode</span><span class="op" id="6342832">&amp;</span><span class="ident" id="6342833">ScanFloats</span>&nbsp;<span class="op" id="6342844">!=</span>&nbsp;<span class="num" id="6342847">0</span>&nbsp;<span class="op" id="6342849">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342855">tok</span>&nbsp;<span class="op" id="6342859">=</span>&nbsp;<span class="ident" id="6342861">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342871">ch</span>&nbsp;<span class="op" id="6342874">=</span>&nbsp;<span class="ident" id="6342876">s</span><span class="op" id="6342877">.</span><span class="ident" id="6342878">scanMantissa</span><span class="op" id="6342890">(</span><span class="ident" id="6342891">ch</span><span class="op" id="6342893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342899">ch</span>&nbsp;<span class="op" id="6342902">=</span>&nbsp;<span class="ident" id="6342904">s</span><span class="op" id="6342905">.</span><span class="ident" id="6342906">scanExponent</span><span class="op" id="6342918">(</span><span class="ident" id="6342919">ch</span><span class="op" id="6342921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6342926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342930">case</span>&nbsp;<span class="string" id="6342935">&#39;/&#39;</span><span class="op" id="6342938">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6342943">ch</span>&nbsp;<span class="op" id="6342946">=</span>&nbsp;<span class="ident" id="6342948">s</span><span class="op" id="6342949">.</span><span class="ident" id="6342950">next</span><span class="op" id="6342954">(</span><span class="op" id="6342955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6342960">if</span>&nbsp;<span class="op" id="6342963">(</span><span class="ident" id="6342964">ch</span>&nbsp;<span class="op" id="6342967">==</span>&nbsp;<span class="string" id="6342970">&#39;/&#39;</span>&nbsp;<span class="op" id="6342974">||</span>&nbsp;<span class="ident" id="6342977">ch</span>&nbsp;<span class="op" id="6342980">==</span>&nbsp;<span class="string" id="6342983">&#39;*&#39;</span><span class="op" id="6342986">)</span>&nbsp;<span class="op" id="6342988">&amp;&amp;</span>&nbsp;<span class="ident" id="6342991">s</span><span class="op" id="6342992">.</span><span class="ident" id="6342993">Mode</span><span class="op" id="6342997">&amp;</span><span class="ident" id="6342998">ScanComments</span>&nbsp;<span class="op" id="6343011">!=</span>&nbsp;<span class="num" id="6343014">0</span>&nbsp;<span class="op" id="6343016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343022">if</span>&nbsp;<span class="ident" id="6343025">s</span><span class="op" id="6343026">.</span><span class="ident" id="6343027">Mode</span><span class="op" id="6343031">&amp;</span><span class="ident" id="6343032">SkipComments</span>&nbsp;<span class="op" id="6343045">!=</span>&nbsp;<span class="num" id="6343048">0</span>&nbsp;<span class="op" id="6343050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343057">s</span><span class="op" id="6343058">.</span><span class="ident" id="6343059">tokPos</span>&nbsp;<span class="op" id="6343066">=</span>&nbsp;<span class="op" id="6343068">-</span><span class="num" id="6343069">1</span>&nbsp;<span class="comment" id="6343071">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343104">ch</span>&nbsp;<span class="op" id="6343107">=</span>&nbsp;<span class="ident" id="6343109">s</span><span class="op" id="6343110">.</span><span class="ident" id="6343111">scanComment</span><span class="op" id="6343122">(</span><span class="ident" id="6343123">ch</span><span class="op" id="6343125">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343132">goto</span>&nbsp;<span class="ident" id="6343137">redo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343152">ch</span>&nbsp;<span class="op" id="6343155">=</span>&nbsp;<span class="ident" id="6343157">s</span><span class="op" id="6343158">.</span><span class="ident" id="6343159">scanComment</span><span class="op" id="6343170">(</span><span class="ident" id="6343171">ch</span><span class="op" id="6343173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343179">tok</span>&nbsp;<span class="op" id="6343183">=</span>&nbsp;<span class="ident" id="6343185">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343196">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343200">case</span>&nbsp;<span class="string" id="6343205">&#39;`&#39;</span><span class="op" id="6343208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343213">if</span>&nbsp;<span class="ident" id="6343216">s</span><span class="op" id="6343217">.</span><span class="ident" id="6343218">Mode</span><span class="op" id="6343222">&amp;</span><span class="ident" id="6343223">ScanRawStrings</span>&nbsp;<span class="op" id="6343238">!=</span>&nbsp;<span class="num" id="6343241">0</span>&nbsp;<span class="op" id="6343243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343249">s</span><span class="op" id="6343250">.</span><span class="ident" id="6343251">scanRawString</span><span class="op" id="6343264">(</span><span class="op" id="6343265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343271">tok</span>&nbsp;<span class="op" id="6343275">=</span>&nbsp;<span class="ident" id="6343277">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343287">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343292">ch</span>&nbsp;<span class="op" id="6343295">=</span>&nbsp;<span class="ident" id="6343297">s</span><span class="op" id="6343298">.</span><span class="ident" id="6343299">next</span><span class="op" id="6343303">(</span><span class="op" id="6343304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343308">default</span><span class="op" id="6343315">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343320">ch</span>&nbsp;<span class="op" id="6343323">=</span>&nbsp;<span class="ident" id="6343325">s</span><span class="op" id="6343326">.</span><span class="ident" id="6343327">next</span><span class="op" id="6343331">(</span><span class="op" id="6343332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343339">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6343343">//&nbsp;end&nbsp;of&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343365">s</span><span class="op" id="6343366">.</span><span class="ident" id="6343367">tokEnd</span>&nbsp;<span class="op" id="6343374">=</span>&nbsp;<span class="ident" id="6343376">s</span><span class="op" id="6343377">.</span><span class="ident" id="6343378">srcPos</span>&nbsp;<span class="op" id="6343385">-</span>&nbsp;<span class="ident" id="6343387">s</span><span class="op" id="6343388">.</span><span class="ident" id="6343389">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343403">s</span><span class="op" id="6343404">.</span><span class="ident" id="6343405">ch</span>&nbsp;<span class="op" id="6343408">=</span>&nbsp;<span class="ident" id="6343410">ch</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343414">return</span>&nbsp;<span class="ident" id="6343421">tok</span><br>
<span class="lineno"></span><span class="op" id="6343425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6343428">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;character&nbsp;immediately&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="6343491">//&nbsp;the&nbsp;character&nbsp;or&nbsp;token&nbsp;returned&nbsp;by&nbsp;the&nbsp;last&nbsp;call&nbsp;to&nbsp;Next&nbsp;or&nbsp;Scan.</span><br>
<span class="lineno">650</span><span class="keyword" id="6343560">func</span>&nbsp;<span class="op" id="6343565">(</span><span class="ident" id="6343566">s</span>&nbsp;<span class="op" id="6343568">*</span><span class="ident" id="6343569">Scanner</span><span class="op" id="6343576">)</span>&nbsp;<span class="ident" id="6343578">Pos</span><span class="op" id="6343581">(</span><span class="op" id="6343582">)</span>&nbsp;<span class="op" id="6343584">(</span><span class="ident" id="6343585">pos</span>&nbsp;<span class="ident" id="6343589">Position</span><span class="op" id="6343597">)</span>&nbsp;<span class="op" id="6343599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343602">pos</span><span class="op" id="6343605">.</span><span class="ident" id="6343606">Filename</span>&nbsp;<span class="op" id="6343615">=</span>&nbsp;<span class="ident" id="6343617">s</span><span class="op" id="6343618">.</span><span class="ident" id="6343619">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343629">pos</span><span class="op" id="6343632">.</span><span class="ident" id="6343633">Offset</span>&nbsp;<span class="op" id="6343640">=</span>&nbsp;<span class="ident" id="6343642">s</span><span class="op" id="6343643">.</span><span class="ident" id="6343644">srcBufOffset</span>&nbsp;<span class="op" id="6343657">+</span>&nbsp;<span class="ident" id="6343659">s</span><span class="op" id="6343660">.</span><span class="ident" id="6343661">srcPos</span>&nbsp;<span class="op" id="6343668">-</span>&nbsp;<span class="ident" id="6343670">s</span><span class="op" id="6343671">.</span><span class="ident" id="6343672">lastCharLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343685">switch</span>&nbsp;<span class="op" id="6343692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343695">case</span>&nbsp;<span class="ident" id="6343700">s</span><span class="op" id="6343701">.</span><span class="ident" id="6343702">column</span>&nbsp;<span class="op" id="6343709">&gt;</span>&nbsp;<span class="num" id="6343711">0</span><span class="op" id="6343712">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6343716">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343764">pos</span><span class="op" id="6343767">.</span><span class="ident" id="6343768">Line</span>&nbsp;<span class="op" id="6343773">=</span>&nbsp;<span class="ident" id="6343775">s</span><span class="op" id="6343776">.</span><span class="ident" id="6343777">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343784">pos</span><span class="op" id="6343787">.</span><span class="ident" id="6343788">Column</span>&nbsp;<span class="op" id="6343795">=</span>&nbsp;<span class="ident" id="6343797">s</span><span class="op" id="6343798">.</span><span class="ident" id="6343799">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343807">case</span>&nbsp;<span class="ident" id="6343812">s</span><span class="op" id="6343813">.</span><span class="ident" id="6343814">lastLineLen</span>&nbsp;<span class="op" id="6343826">&gt;</span>&nbsp;<span class="num" id="6343828">0</span><span class="op" id="6343829">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6343833">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343864">pos</span><span class="op" id="6343867">.</span><span class="ident" id="6343868">Line</span>&nbsp;<span class="op" id="6343873">=</span>&nbsp;<span class="ident" id="6343875">s</span><span class="op" id="6343876">.</span><span class="ident" id="6343877">line</span>&nbsp;<span class="op" id="6343882">-</span>&nbsp;<span class="num" id="6343884">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343888">pos</span><span class="op" id="6343891">.</span><span class="ident" id="6343892">Column</span>&nbsp;<span class="op" id="6343899">=</span>&nbsp;<span class="ident" id="6343901">s</span><span class="op" id="6343902">.</span><span class="ident" id="6343903">lastLineLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343916">default</span><span class="op" id="6343923">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6343927">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343963">pos</span><span class="op" id="6343966">.</span><span class="ident" id="6343967">Line</span>&nbsp;<span class="op" id="6343972">=</span>&nbsp;<span class="num" id="6343974">1</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343978">pos</span><span class="op" id="6343981">.</span><span class="ident" id="6343982">Column</span>&nbsp;<span class="op" id="6343989">=</span>&nbsp;<span class="num" id="6343991">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6343994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6343997">return</span><br>
<span class="lineno"></span><span class="op" id="6344004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="6344007">//&nbsp;TokenText&nbsp;returns&nbsp;the&nbsp;string&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token.</span><br>
<span class="lineno"></span><span class="comment" id="6344089">//&nbsp;Valid&nbsp;after&nbsp;calling&nbsp;Scan().</span><br>
<span class="lineno"></span><span class="keyword" id="6344120">func</span>&nbsp;<span class="op" id="6344125">(</span><span class="ident" id="6344126">s</span>&nbsp;<span class="op" id="6344128">*</span><span class="ident" id="6344129">Scanner</span><span class="op" id="6344136">)</span>&nbsp;<span class="ident" id="6344138">TokenText</span><span class="op" id="6344147">(</span><span class="op" id="6344148">)</span>&nbsp;<span class="builtintype" id="6344150">string</span>&nbsp;<span class="op" id="6344157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344160">if</span>&nbsp;<span class="ident" id="6344163">s</span><span class="op" id="6344164">.</span><span class="ident" id="6344165">tokPos</span>&nbsp;<span class="op" id="6344172">&lt;</span>&nbsp;<span class="num" id="6344174">0</span>&nbsp;<span class="op" id="6344176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6344180">//&nbsp;no&nbsp;token&nbsp;text</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344199">return</span>&nbsp;<span class="string" id="6344206">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344214">if</span>&nbsp;<span class="ident" id="6344217">s</span><span class="op" id="6344218">.</span><span class="ident" id="6344219">tokEnd</span>&nbsp;<span class="op" id="6344226">&lt;</span>&nbsp;<span class="num" id="6344228">0</span>&nbsp;<span class="op" id="6344230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6344234">//&nbsp;if&nbsp;EOF&nbsp;was&nbsp;reached,&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;to&nbsp;-1&nbsp;(s.srcPos&nbsp;==&nbsp;0)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6344297">s</span><span class="op" id="6344298">.</span><span class="ident" id="6344299">tokEnd</span>&nbsp;<span class="op" id="6344306">=</span>&nbsp;<span class="ident" id="6344308">s</span><span class="op" id="6344309">.</span><span class="ident" id="6344310">tokPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344322">if</span>&nbsp;<span class="ident" id="6344325">s</span><span class="op" id="6344326">.</span><span class="ident" id="6344327">tokBuf</span><span class="op" id="6344333">.</span><span class="ident" id="6344334">Len</span><span class="op" id="6344337">(</span><span class="op" id="6344338">)</span>&nbsp;<span class="op" id="6344340">==</span>&nbsp;<span class="num" id="6344343">0</span>&nbsp;<span class="op" id="6344345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6344349">//&nbsp;common&nbsp;case:&nbsp;the&nbsp;entire&nbsp;token&nbsp;text&nbsp;is&nbsp;still&nbsp;in&nbsp;srcBuf</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344408">return</span>&nbsp;<span class="builtintype" id="6344415">string</span><span class="op" id="6344421">(</span><span class="ident" id="6344422">s</span><span class="op" id="6344423">.</span><span class="ident" id="6344424">srcBuf</span><span class="op" id="6344430">[</span><span class="ident" id="6344431">s</span><span class="op" id="6344432">.</span><span class="ident" id="6344433">tokPos</span><span class="op" id="6344439">:</span><span class="ident" id="6344440">s</span><span class="op" id="6344441">.</span><span class="ident" id="6344442">tokEnd</span><span class="op" id="6344448">]</span><span class="op" id="6344449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6344456">//&nbsp;part&nbsp;of&nbsp;the&nbsp;token&nbsp;text&nbsp;was&nbsp;saved&nbsp;in&nbsp;tokBuf:&nbsp;save&nbsp;the&nbsp;rest&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6344521">//&nbsp;tokBuf&nbsp;as&nbsp;well&nbsp;and&nbsp;return&nbsp;its&nbsp;content</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6344563">s</span><span class="op" id="6344564">.</span><span class="ident" id="6344565">tokBuf</span><span class="op" id="6344571">.</span><span class="ident" id="6344572">Write</span><span class="op" id="6344577">(</span><span class="ident" id="6344578">s</span><span class="op" id="6344579">.</span><span class="ident" id="6344580">srcBuf</span><span class="op" id="6344586">[</span><span class="ident" id="6344587">s</span><span class="op" id="6344588">.</span><span class="ident" id="6344589">tokPos</span><span class="op" id="6344595">:</span><span class="ident" id="6344596">s</span><span class="op" id="6344597">.</span><span class="ident" id="6344598">tokEnd</span><span class="op" id="6344604">]</span><span class="op" id="6344605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6344608">s</span><span class="op" id="6344609">.</span><span class="ident" id="6344610">tokPos</span>&nbsp;<span class="op" id="6344617">=</span>&nbsp;<span class="ident" id="6344619">s</span><span class="op" id="6344620">.</span><span class="ident" id="6344621">tokEnd</span>&nbsp;<span class="comment" id="6344628">//&nbsp;ensure&nbsp;idempotency&nbsp;of&nbsp;TokenText()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344671">return</span>&nbsp;<span class="ident" id="6344678">s</span><span class="op" id="6344679">.</span><span class="ident" id="6344680">tokBuf</span><span class="op" id="6344686">.</span><span class="ident" id="6344687">String</span><span class="op" id="6344693">(</span><span class="op" id="6344694">)</span><br>
<span class="lineno"></span><span class="op" id="6344696">}</span>
</div>
</body>
</html>
