<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>hash/crc32</h2>
<ul>
<li><a href="/gostd/hash/crc32/crc32.go.html" class="current">crc32.go</a></li>
<li><a href="/gostd/hash/crc32/crc32_amd64x.go.html">crc32_amd64x.go</a></li>
<li><a href="/gostd/hash/crc32/crc32_test.go.html">crc32_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5056091">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5056146">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5056200">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5056251">//&nbsp;Package&nbsp;crc32&nbsp;implements&nbsp;the&nbsp;32-bit&nbsp;cyclic&nbsp;redundancy&nbsp;check,&nbsp;or&nbsp;CRC-32,</span><br>
<span class="lineno"></span><span class="comment" id="5056326">//&nbsp;checksum.&nbsp;See&nbsp;http://en.wikipedia.org/wiki/Cyclic_redundancy_check&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="5056400">//&nbsp;information.</span><br>
<span class="lineno"></span><span class="keyword" id="5056416">package</span>&nbsp;<span class="ident" id="5056424">crc32</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="5056431">import</span>&nbsp;<span class="op" id="5056438">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5056441">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5056449">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="5056456">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5056459">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;CRC-32&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="5056502">const</span>&nbsp;<span class="ident" id="5056508">Size</span>&nbsp;<span class="op" id="5056513">=</span>&nbsp;<span class="num" id="5056515">4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5056518">//&nbsp;Predefined&nbsp;polynomials.</span><br>
<span class="lineno"></span><span class="keyword" id="5056545">const</span>&nbsp;<span class="op" id="5056551">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5056554">//&nbsp;IEEE&nbsp;is&nbsp;by&nbsp;far&nbsp;and&nbsp;away&nbsp;the&nbsp;most&nbsp;common&nbsp;CRC-32&nbsp;polynomial.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5056617">//&nbsp;Used&nbsp;by&nbsp;ethernet&nbsp;(IEEE&nbsp;802.3),&nbsp;v.42,&nbsp;fddi,&nbsp;gzip,&nbsp;zip,&nbsp;png,&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056684">IEEE</span>&nbsp;<span class="op" id="5056689">=</span>&nbsp;<span class="num" id="5056691">0xedb88320</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5056704">//&nbsp;Castagnoli&#39;s&nbsp;polynomial,&nbsp;used&nbsp;in&nbsp;iSCSI.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5056748">//&nbsp;Has&nbsp;better&nbsp;error&nbsp;detection&nbsp;characteristics&nbsp;than&nbsp;IEEE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5056806">//&nbsp;http://dx.doi.org/10.1109/26.231911</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056846">Castagnoli</span>&nbsp;<span class="op" id="5056857">=</span>&nbsp;<span class="num" id="5056859">0x82f63b78</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5056872">//&nbsp;Koopman&#39;s&nbsp;polynomial.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5056898">//&nbsp;Also&nbsp;has&nbsp;better&nbsp;error&nbsp;detection&nbsp;characteristics&nbsp;than&nbsp;IEEE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5056961">//&nbsp;http://dx.doi.org/10.1109/DSN.2002.1028931</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5057008">Koopman</span>&nbsp;<span class="op" id="5057016">=</span>&nbsp;<span class="num" id="5057018">0xeb31d82e</span><br>
<span class="lineno"></span><span class="op" id="5057029">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="5057032">//&nbsp;Table&nbsp;is&nbsp;a&nbsp;256-word&nbsp;table&nbsp;representing&nbsp;the&nbsp;polynomial&nbsp;for&nbsp;efficient&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="5057115">type</span>&nbsp;<span class="ident" id="5057120">Table</span>&nbsp;<span class="op" id="5057126">[</span><span class="num" id="5057127">256</span><span class="op" id="5057130">]</span><span class="builtintype" id="5057131">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5057139">//&nbsp;castagnoliTable&nbsp;points&nbsp;to&nbsp;a&nbsp;lazily&nbsp;initialized&nbsp;Table&nbsp;for&nbsp;the&nbsp;Castagnoli</span><br>
<span class="lineno"></span><span class="comment" id="5057214">//&nbsp;polynomial.&nbsp;MakeTable&nbsp;will&nbsp;always&nbsp;return&nbsp;this&nbsp;value&nbsp;when&nbsp;asked&nbsp;to&nbsp;make&nbsp;a</span><br>
<span class="lineno">40</span><span class="comment" id="5057290">//&nbsp;Castagnoli&nbsp;table&nbsp;so&nbsp;we&nbsp;can&nbsp;compare&nbsp;against&nbsp;it&nbsp;to&nbsp;find&nbsp;when&nbsp;the&nbsp;caller&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5057366">//&nbsp;using&nbsp;this&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="5057392">var</span>&nbsp;<span class="ident" id="5057396">castagnoliTable</span>&nbsp;<span class="op" id="5057412">*</span><span class="ident" id="5057413">Table</span><br>
<span class="lineno"></span><span class="keyword" id="5057419">var</span>&nbsp;<span class="ident" id="5057423">castagnoliOnce</span>&nbsp;<span class="ident" id="5057438">sync</span><span class="op" id="5057442">.</span><span class="ident" id="5057443">Once</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="5057449">func</span>&nbsp;<span class="ident" id="5057454">castagnoliInit</span><span class="op" id="5057468">(</span><span class="op" id="5057469">)</span>&nbsp;<span class="op" id="5057471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5057474">castagnoliTable</span>&nbsp;<span class="op" id="5057490">=</span>&nbsp;<span class="ident" id="5057492">makeTable</span><span class="op" id="5057501">(</span><span class="ident" id="5057502">Castagnoli</span><span class="op" id="5057512">)</span><br>
<span class="lineno"></span><span class="op" id="5057514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5057517">//&nbsp;IEEETable&nbsp;is&nbsp;the&nbsp;table&nbsp;for&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno">50</span><span class="keyword" id="5057568">var</span>&nbsp;<span class="ident" id="5057572">IEEETable</span>&nbsp;<span class="op" id="5057582">=</span>&nbsp;<span class="ident" id="5057584">makeTable</span><span class="op" id="5057593">(</span><span class="ident" id="5057594">IEEE</span><span class="op" id="5057598">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5057601">//&nbsp;MakeTable&nbsp;returns&nbsp;the&nbsp;Table&nbsp;constructed&nbsp;from&nbsp;the&nbsp;specified&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="5057675">func</span>&nbsp;<span class="ident" id="5057680">MakeTable</span><span class="op" id="5057689">(</span><span class="ident" id="5057690">poly</span>&nbsp;<span class="builtintype" id="5057695">uint32</span><span class="op" id="5057701">)</span>&nbsp;<span class="op" id="5057703">*</span><span class="ident" id="5057704">Table</span>&nbsp;<span class="op" id="5057710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5057713">switch</span>&nbsp;<span class="ident" id="5057720">poly</span>&nbsp;<span class="op" id="5057725">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5057728">case</span>&nbsp;<span class="ident" id="5057733">IEEE</span><span class="op" id="5057737">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5057741">return</span>&nbsp;<span class="ident" id="5057748">IEEETable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5057759">case</span>&nbsp;<span class="ident" id="5057764">Castagnoli</span><span class="op" id="5057774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5057778">castagnoliOnce</span><span class="op" id="5057792">.</span><span class="ident" id="5057793">Do</span><span class="op" id="5057795">(</span><span class="ident" id="5057796">castagnoliInit</span><span class="op" id="5057810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5057814">return</span>&nbsp;<span class="ident" id="5057821">castagnoliTable</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5057838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5057841">return</span>&nbsp;<span class="ident" id="5057848">makeTable</span><span class="op" id="5057857">(</span><span class="ident" id="5057858">poly</span><span class="op" id="5057862">)</span><br>
<span class="lineno"></span><span class="op" id="5057864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5057867">//&nbsp;makeTable&nbsp;returns&nbsp;the&nbsp;Table&nbsp;constructed&nbsp;from&nbsp;the&nbsp;specified&nbsp;polynomial.</span><br>
<span class="lineno">65</span><span class="keyword" id="5057941">func</span>&nbsp;<span class="ident" id="5057946">makeTable</span><span class="op" id="5057955">(</span><span class="ident" id="5057956">poly</span>&nbsp;<span class="builtintype" id="5057961">uint32</span><span class="op" id="5057967">)</span>&nbsp;<span class="op" id="5057969">*</span><span class="ident" id="5057970">Table</span>&nbsp;<span class="op" id="5057976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5057979">t</span>&nbsp;<span class="op" id="5057981">:=</span>&nbsp;<span class="builtinfunc" id="5057984">new</span><span class="op" id="5057987">(</span><span class="ident" id="5057988">Table</span><span class="op" id="5057993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5057996">for</span>&nbsp;<span class="ident" id="5058000">i</span>&nbsp;<span class="op" id="5058002">:=</span>&nbsp;<span class="num" id="5058005">0</span><span class="op" id="5058006">;</span>&nbsp;<span class="ident" id="5058008">i</span>&nbsp;<span class="op" id="5058010">&lt;</span>&nbsp;<span class="num" id="5058012">256</span><span class="op" id="5058015">;</span>&nbsp;<span class="ident" id="5058017">i</span><span class="op" id="5058018">++</span>&nbsp;<span class="op" id="5058021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5058025">crc</span>&nbsp;<span class="op" id="5058029">:=</span>&nbsp;<span class="builtintype" id="5058032">uint32</span><span class="op" id="5058038">(</span><span class="ident" id="5058039">i</span><span class="op" id="5058040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5058044">for</span>&nbsp;<span class="ident" id="5058048">j</span>&nbsp;<span class="op" id="5058050">:=</span>&nbsp;<span class="num" id="5058053">0</span><span class="op" id="5058054">;</span>&nbsp;<span class="ident" id="5058056">j</span>&nbsp;<span class="op" id="5058058">&lt;</span>&nbsp;<span class="num" id="5058060">8</span><span class="op" id="5058061">;</span>&nbsp;<span class="ident" id="5058063">j</span><span class="op" id="5058064">++</span>&nbsp;<span class="op" id="5058067">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5058072">if</span>&nbsp;<span class="ident" id="5058075">crc</span><span class="op" id="5058078">&amp;</span><span class="num" id="5058079">1</span>&nbsp;<span class="op" id="5058081">==</span>&nbsp;<span class="num" id="5058084">1</span>&nbsp;<span class="op" id="5058086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5058092">crc</span>&nbsp;<span class="op" id="5058096">=</span>&nbsp;<span class="op" id="5058098">(</span><span class="ident" id="5058099">crc</span>&nbsp;<span class="op" id="5058103">&gt;&gt;</span>&nbsp;<span class="num" id="5058106">1</span><span class="op" id="5058107">)</span>&nbsp;<span class="op" id="5058109">^</span>&nbsp;<span class="ident" id="5058111">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5058119">}</span>&nbsp;<span class="keyword" id="5058121">else</span>&nbsp;<span class="op" id="5058126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5058132">crc</span>&nbsp;<span class="op" id="5058136">&gt;&gt;=</span>&nbsp;<span class="num" id="5058140">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5058145">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5058149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5058153">t</span><span class="op" id="5058154">[</span><span class="ident" id="5058155">i</span><span class="op" id="5058156">]</span>&nbsp;<span class="op" id="5058158">=</span>&nbsp;<span class="ident" id="5058160">crc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5058165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5058168">return</span>&nbsp;<span class="ident" id="5058175">t</span><br>
<span class="lineno"></span><span class="op" id="5058177">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="5058180">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="5058239">type</span>&nbsp;<span class="ident" id="5058244">digest</span>&nbsp;<span class="keyword" id="5058251">struct</span>&nbsp;<span class="op" id="5058258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5058261">crc</span>&nbsp;<span class="builtintype" id="5058265">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5058273">tab</span>&nbsp;<span class="op" id="5058277">*</span><span class="ident" id="5058278">Table</span><br>
<span class="lineno">85</span><span class="op" id="5058284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5058287">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;new&nbsp;hash.Hash32&nbsp;computing&nbsp;the&nbsp;CRC-32&nbsp;checksum</span><br>
<span class="lineno"></span><span class="comment" id="5058350">//&nbsp;using&nbsp;the&nbsp;polynomial&nbsp;represented&nbsp;by&nbsp;the&nbsp;Table.</span><br>
<span class="lineno"></span><span class="keyword" id="5058400">func</span>&nbsp;<span class="ident" id="5058405">New</span><span class="op" id="5058408">(</span><span class="ident" id="5058409">tab</span>&nbsp;<span class="op" id="5058413">*</span><span class="ident" id="5058414">Table</span><span class="op" id="5058419">)</span>&nbsp;<span class="ident" id="5058421">hash</span><span class="op" id="5058425">.</span><span class="ident" id="5058426">Hash32</span>&nbsp;<span class="op" id="5058433">{</span>&nbsp;<span class="keyword" id="5058435">return</span>&nbsp;<span class="op" id="5058442">&amp;</span><span class="ident" id="5058443">digest</span><span class="op" id="5058449">{</span><span class="num" id="5058450">0</span><span class="op" id="5058451">,</span>&nbsp;<span class="ident" id="5058453">tab</span><span class="op" id="5058456">}</span>&nbsp;<span class="op" id="5058458">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="5058461">//&nbsp;NewIEEE&nbsp;creates&nbsp;a&nbsp;new&nbsp;hash.Hash32&nbsp;computing&nbsp;the&nbsp;CRC-32&nbsp;checksum</span><br>
<span class="lineno"></span><span class="comment" id="5058528">//&nbsp;using&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="5058558">func</span>&nbsp;<span class="ident" id="5058563">NewIEEE</span><span class="op" id="5058570">(</span><span class="op" id="5058571">)</span>&nbsp;<span class="ident" id="5058573">hash</span><span class="op" id="5058577">.</span><span class="ident" id="5058578">Hash32</span>&nbsp;<span class="op" id="5058585">{</span>&nbsp;<span class="keyword" id="5058587">return</span>&nbsp;<span class="ident" id="5058594">New</span><span class="op" id="5058597">(</span><span class="ident" id="5058598">IEEETable</span><span class="op" id="5058607">)</span>&nbsp;<span class="op" id="5058609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="5058612">func</span>&nbsp;<span class="op" id="5058617">(</span><span class="ident" id="5058618">d</span>&nbsp;<span class="op" id="5058620">*</span><span class="ident" id="5058621">digest</span><span class="op" id="5058627">)</span>&nbsp;<span class="ident" id="5058629">Size</span><span class="op" id="5058633">(</span><span class="op" id="5058634">)</span>&nbsp;<span class="builtintype" id="5058636">int</span>&nbsp;<span class="op" id="5058640">{</span>&nbsp;<span class="keyword" id="5058642">return</span>&nbsp;<span class="ident" id="5058649">Size</span>&nbsp;<span class="op" id="5058654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5058657">func</span>&nbsp;<span class="op" id="5058662">(</span><span class="ident" id="5058663">d</span>&nbsp;<span class="op" id="5058665">*</span><span class="ident" id="5058666">digest</span><span class="op" id="5058672">)</span>&nbsp;<span class="ident" id="5058674">BlockSize</span><span class="op" id="5058683">(</span><span class="op" id="5058684">)</span>&nbsp;<span class="builtintype" id="5058686">int</span>&nbsp;<span class="op" id="5058690">{</span>&nbsp;<span class="keyword" id="5058692">return</span>&nbsp;<span class="num" id="5058699">1</span>&nbsp;<span class="op" id="5058701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5058704">func</span>&nbsp;<span class="op" id="5058709">(</span><span class="ident" id="5058710">d</span>&nbsp;<span class="op" id="5058712">*</span><span class="ident" id="5058713">digest</span><span class="op" id="5058719">)</span>&nbsp;<span class="ident" id="5058721">Reset</span><span class="op" id="5058726">(</span><span class="op" id="5058727">)</span>&nbsp;<span class="op" id="5058729">{</span>&nbsp;<span class="ident" id="5058731">d</span><span class="op" id="5058732">.</span><span class="ident" id="5058733">crc</span>&nbsp;<span class="op" id="5058737">=</span>&nbsp;<span class="num" id="5058739">0</span>&nbsp;<span class="op" id="5058741">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="5058744">func</span>&nbsp;<span class="ident" id="5058749">update</span><span class="op" id="5058755">(</span><span class="ident" id="5058756">crc</span>&nbsp;<span class="builtintype" id="5058760">uint32</span><span class="op" id="5058766">,</span>&nbsp;<span class="ident" id="5058768">tab</span>&nbsp;<span class="op" id="5058772">*</span><span class="ident" id="5058773">Table</span><span class="op" id="5058778">,</span>&nbsp;<span class="ident" id="5058780">p</span>&nbsp;<span class="op" id="5058782">[</span><span class="op" id="5058783">]</span><span class="builtintype" id="5058784">byte</span><span class="op" id="5058788">)</span>&nbsp;<span class="builtintype" id="5058790">uint32</span>&nbsp;<span class="op" id="5058797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5058800">crc</span>&nbsp;<span class="op" id="5058804">=</span>&nbsp;<span class="op" id="5058806">^</span><span class="ident" id="5058807">crc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5058812">for</span>&nbsp;<span class="ident" id="5058816">_</span><span class="op" id="5058817">,</span>&nbsp;<span class="ident" id="5058819">v</span>&nbsp;<span class="op" id="5058821">:=</span>&nbsp;<span class="keyword" id="5058824">range</span>&nbsp;<span class="ident" id="5058830">p</span>&nbsp;<span class="op" id="5058832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5058836">crc</span>&nbsp;<span class="op" id="5058840">=</span>&nbsp;<span class="ident" id="5058842">tab</span><span class="op" id="5058845">[</span><span class="builtintype" id="5058846">byte</span><span class="op" id="5058850">(</span><span class="ident" id="5058851">crc</span><span class="op" id="5058854">)</span><span class="op" id="5058855">^</span><span class="ident" id="5058856">v</span><span class="op" id="5058857">]</span>&nbsp;<span class="op" id="5058859">^</span>&nbsp;<span class="op" id="5058861">(</span><span class="ident" id="5058862">crc</span>&nbsp;<span class="op" id="5058866">&gt;&gt;</span>&nbsp;<span class="num" id="5058869">8</span><span class="op" id="5058870">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5058873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5058876">return</span>&nbsp;<span class="op" id="5058883">^</span><span class="ident" id="5058884">crc</span><br>
<span class="lineno"></span><span class="op" id="5058888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5058891">//&nbsp;Update&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;adding&nbsp;the&nbsp;bytes&nbsp;in&nbsp;p&nbsp;to&nbsp;the&nbsp;crc.</span><br>
<span class="lineno">110</span><span class="keyword" id="5058957">func</span>&nbsp;<span class="ident" id="5058962">Update</span><span class="op" id="5058968">(</span><span class="ident" id="5058969">crc</span>&nbsp;<span class="builtintype" id="5058973">uint32</span><span class="op" id="5058979">,</span>&nbsp;<span class="ident" id="5058981">tab</span>&nbsp;<span class="op" id="5058985">*</span><span class="ident" id="5058986">Table</span><span class="op" id="5058991">,</span>&nbsp;<span class="ident" id="5058993">p</span>&nbsp;<span class="op" id="5058995">[</span><span class="op" id="5058996">]</span><span class="builtintype" id="5058997">byte</span><span class="op" id="5059001">)</span>&nbsp;<span class="builtintype" id="5059003">uint32</span>&nbsp;<span class="op" id="5059010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059013">if</span>&nbsp;<span class="ident" id="5059016">tab</span>&nbsp;<span class="op" id="5059020">==</span>&nbsp;<span class="ident" id="5059023">castagnoliTable</span>&nbsp;<span class="op" id="5059039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059043">return</span>&nbsp;<span class="ident" id="5059050">updateCastagnoli</span><span class="op" id="5059066">(</span><span class="ident" id="5059067">crc</span><span class="op" id="5059070">,</span>&nbsp;<span class="ident" id="5059072">p</span><span class="op" id="5059073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5059076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059079">return</span>&nbsp;<span class="ident" id="5059086">update</span><span class="op" id="5059092">(</span><span class="ident" id="5059093">crc</span><span class="op" id="5059096">,</span>&nbsp;<span class="ident" id="5059098">tab</span><span class="op" id="5059101">,</span>&nbsp;<span class="ident" id="5059103">p</span><span class="op" id="5059104">)</span><br>
<span class="lineno">115</span><span class="op" id="5059106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5059109">func</span>&nbsp;<span class="op" id="5059114">(</span><span class="ident" id="5059115">d</span>&nbsp;<span class="op" id="5059117">*</span><span class="ident" id="5059118">digest</span><span class="op" id="5059124">)</span>&nbsp;<span class="ident" id="5059126">Write</span><span class="op" id="5059131">(</span><span class="ident" id="5059132">p</span>&nbsp;<span class="op" id="5059134">[</span><span class="op" id="5059135">]</span><span class="builtintype" id="5059136">byte</span><span class="op" id="5059140">)</span>&nbsp;<span class="op" id="5059142">(</span><span class="ident" id="5059143">n</span>&nbsp;<span class="builtintype" id="5059145">int</span><span class="op" id="5059148">,</span>&nbsp;<span class="ident" id="5059150">err</span>&nbsp;<span class="builtintype" id="5059154">error</span><span class="op" id="5059159">)</span>&nbsp;<span class="op" id="5059161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5059164">d</span><span class="op" id="5059165">.</span><span class="ident" id="5059166">crc</span>&nbsp;<span class="op" id="5059170">=</span>&nbsp;<span class="ident" id="5059172">Update</span><span class="op" id="5059178">(</span><span class="ident" id="5059179">d</span><span class="op" id="5059180">.</span><span class="ident" id="5059181">crc</span><span class="op" id="5059184">,</span>&nbsp;<span class="ident" id="5059186">d</span><span class="op" id="5059187">.</span><span class="ident" id="5059188">tab</span><span class="op" id="5059191">,</span>&nbsp;<span class="ident" id="5059193">p</span><span class="op" id="5059194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059197">return</span>&nbsp;<span class="builtinfunc" id="5059204">len</span><span class="op" id="5059207">(</span><span class="ident" id="5059208">p</span><span class="op" id="5059209">)</span><span class="op" id="5059210">,</span>&nbsp;<span class="ident" id="5059212">nil</span><br>
<span class="lineno">120</span><span class="op" id="5059216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5059219">func</span>&nbsp;<span class="op" id="5059224">(</span><span class="ident" id="5059225">d</span>&nbsp;<span class="op" id="5059227">*</span><span class="ident" id="5059228">digest</span><span class="op" id="5059234">)</span>&nbsp;<span class="ident" id="5059236">Sum32</span><span class="op" id="5059241">(</span><span class="op" id="5059242">)</span>&nbsp;<span class="builtintype" id="5059244">uint32</span>&nbsp;<span class="op" id="5059251">{</span>&nbsp;<span class="keyword" id="5059253">return</span>&nbsp;<span class="ident" id="5059260">d</span><span class="op" id="5059261">.</span><span class="ident" id="5059262">crc</span>&nbsp;<span class="op" id="5059266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5059269">func</span>&nbsp;<span class="op" id="5059274">(</span><span class="ident" id="5059275">d</span>&nbsp;<span class="op" id="5059277">*</span><span class="ident" id="5059278">digest</span><span class="op" id="5059284">)</span>&nbsp;<span class="ident" id="5059286">Sum</span><span class="op" id="5059289">(</span><span class="ident" id="5059290">in</span>&nbsp;<span class="op" id="5059293">[</span><span class="op" id="5059294">]</span><span class="builtintype" id="5059295">byte</span><span class="op" id="5059299">)</span>&nbsp;<span class="op" id="5059301">[</span><span class="op" id="5059302">]</span><span class="builtintype" id="5059303">byte</span>&nbsp;<span class="op" id="5059308">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5059311">s</span>&nbsp;<span class="op" id="5059313">:=</span>&nbsp;<span class="ident" id="5059316">d</span><span class="op" id="5059317">.</span><span class="ident" id="5059318">Sum32</span><span class="op" id="5059323">(</span><span class="op" id="5059324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059327">return</span>&nbsp;<span class="builtinfunc" id="5059334">append</span><span class="op" id="5059340">(</span><span class="ident" id="5059341">in</span><span class="op" id="5059343">,</span>&nbsp;<span class="builtintype" id="5059345">byte</span><span class="op" id="5059349">(</span><span class="ident" id="5059350">s</span><span class="op" id="5059351">&gt;&gt;</span><span class="num" id="5059353">24</span><span class="op" id="5059355">)</span><span class="op" id="5059356">,</span>&nbsp;<span class="builtintype" id="5059358">byte</span><span class="op" id="5059362">(</span><span class="ident" id="5059363">s</span><span class="op" id="5059364">&gt;&gt;</span><span class="num" id="5059366">16</span><span class="op" id="5059368">)</span><span class="op" id="5059369">,</span>&nbsp;<span class="builtintype" id="5059371">byte</span><span class="op" id="5059375">(</span><span class="ident" id="5059376">s</span><span class="op" id="5059377">&gt;&gt;</span><span class="num" id="5059379">8</span><span class="op" id="5059380">)</span><span class="op" id="5059381">,</span>&nbsp;<span class="builtintype" id="5059383">byte</span><span class="op" id="5059387">(</span><span class="ident" id="5059388">s</span><span class="op" id="5059389">)</span><span class="op" id="5059390">)</span><br>
<span class="lineno"></span><span class="op" id="5059392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5059395">//&nbsp;Checksum&nbsp;returns&nbsp;the&nbsp;CRC-32&nbsp;checksum&nbsp;of&nbsp;data</span><br>
<span class="lineno">130</span><span class="comment" id="5059443">//&nbsp;using&nbsp;the&nbsp;polynomial&nbsp;represented&nbsp;by&nbsp;the&nbsp;Table.</span><br>
<span class="lineno"></span><span class="keyword" id="5059493">func</span>&nbsp;<span class="ident" id="5059498">Checksum</span><span class="op" id="5059506">(</span><span class="ident" id="5059507">data</span>&nbsp;<span class="op" id="5059512">[</span><span class="op" id="5059513">]</span><span class="builtintype" id="5059514">byte</span><span class="op" id="5059518">,</span>&nbsp;<span class="ident" id="5059520">tab</span>&nbsp;<span class="op" id="5059524">*</span><span class="ident" id="5059525">Table</span><span class="op" id="5059530">)</span>&nbsp;<span class="builtintype" id="5059532">uint32</span>&nbsp;<span class="op" id="5059539">{</span>&nbsp;<span class="keyword" id="5059541">return</span>&nbsp;<span class="ident" id="5059548">Update</span><span class="op" id="5059554">(</span><span class="num" id="5059555">0</span><span class="op" id="5059556">,</span>&nbsp;<span class="ident" id="5059558">tab</span><span class="op" id="5059561">,</span>&nbsp;<span class="ident" id="5059563">data</span><span class="op" id="5059567">)</span>&nbsp;<span class="op" id="5059569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5059572">//&nbsp;ChecksumIEEE&nbsp;returns&nbsp;the&nbsp;CRC-32&nbsp;checksum&nbsp;of&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="5059624">//&nbsp;using&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno">135</span><span class="keyword" id="5059654">func</span>&nbsp;<span class="ident" id="5059659">ChecksumIEEE</span><span class="op" id="5059671">(</span><span class="ident" id="5059672">data</span>&nbsp;<span class="op" id="5059677">[</span><span class="op" id="5059678">]</span><span class="builtintype" id="5059679">byte</span><span class="op" id="5059683">)</span>&nbsp;<span class="builtintype" id="5059685">uint32</span>&nbsp;<span class="op" id="5059692">{</span>&nbsp;<span class="keyword" id="5059694">return</span>&nbsp;<span class="ident" id="5059701">update</span><span class="op" id="5059707">(</span><span class="num" id="5059708">0</span><span class="op" id="5059709">,</span>&nbsp;<span class="ident" id="5059711">IEEETable</span><span class="op" id="5059720">,</span>&nbsp;<span class="ident" id="5059722">data</span><span class="op" id="5059726">)</span>&nbsp;<span class="op" id="5059728">}</span>
</div>
</body>
</html>
