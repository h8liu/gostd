<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4838930">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4838985">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4839039">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4839090">package</span>&nbsp;<span class="ident" id="4839098">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4839104">import</span>&nbsp;<span class="op" id="4839111">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4839114">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4839123">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4839130">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4839137">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4839144">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4839155">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4839166">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="4839173">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4839176">//&nbsp;This&nbsp;implementation&nbsp;is&nbsp;done&nbsp;according&nbsp;to&nbsp;RFC&nbsp;6265:</span><br>
<span class="lineno"></span><span class="comment" id="4839230">//</span><br>
<span class="lineno"></span><span class="comment" id="4839233">//&nbsp;&nbsp;&nbsp;&nbsp;http://tools.ietf.org/html/rfc6265</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="4839275">//&nbsp;A&nbsp;Cookie&nbsp;represents&nbsp;an&nbsp;HTTP&nbsp;cookie&nbsp;as&nbsp;sent&nbsp;in&nbsp;the&nbsp;Set-Cookie&nbsp;header&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4839352">//&nbsp;HTTP&nbsp;response&nbsp;or&nbsp;the&nbsp;Cookie&nbsp;header&nbsp;of&nbsp;an&nbsp;HTTP&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="4839410">type</span>&nbsp;<span class="ident" id="4839415">Cookie</span>&nbsp;<span class="keyword" id="4839422">struct</span>&nbsp;<span class="op" id="4839429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839432">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4839443">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839451">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4839462">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839470">Path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4839481">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839489">Domain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4839500">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839508">Expires</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839519">time</span><span class="op" id="4839523">.</span><span class="ident" id="4839524">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839530">RawExpires</span>&nbsp;<span class="builtintype" id="4839541">string</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839550">//&nbsp;MaxAge=0&nbsp;means&nbsp;no&nbsp;&#39;Max-Age&#39;&nbsp;attribute&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839603">//&nbsp;MaxAge&lt;0&nbsp;means&nbsp;delete&nbsp;cookie&nbsp;now,&nbsp;equivalently&nbsp;&#39;Max-Age:&nbsp;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839667">//&nbsp;MaxAge&gt;0&nbsp;means&nbsp;Max-Age&nbsp;attribute&nbsp;present&nbsp;and&nbsp;given&nbsp;in&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839733">MaxAge</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4839742">int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839747">Secure</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4839756">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839762">HttpOnly</span>&nbsp;<span class="builtintype" id="4839771">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839777">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4839786">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839794">Unparsed</span>&nbsp;<span class="op" id="4839803">[</span><span class="op" id="4839804">]</span><span class="builtintype" id="4839805">string</span>&nbsp;<span class="comment" id="4839812">//&nbsp;Raw&nbsp;text&nbsp;of&nbsp;unparsed&nbsp;attribute-value&nbsp;pairs</span><br>
<span class="lineno"></span><span class="op" id="4839858">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4839861">//&nbsp;readSetCookies&nbsp;parses&nbsp;all&nbsp;&#34;Set-Cookie&#34;&nbsp;values&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="4839915">//&nbsp;the&nbsp;header&nbsp;h&nbsp;and&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="keyword" id="4839976">func</span>&nbsp;<span class="ident" id="4839981">readSetCookies</span><span class="op" id="4839995">(</span><span class="ident" id="4839996">h</span>&nbsp;<span class="ident" id="4839998">Header</span><span class="op" id="4840004">)</span>&nbsp;<span class="op" id="4840006">[</span><span class="op" id="4840007">]</span><span class="op" id="4840008">*</span><span class="ident" id="4840009">Cookie</span>&nbsp;<span class="op" id="4840016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840019">cookies</span>&nbsp;<span class="op" id="4840027">:=</span>&nbsp;<span class="op" id="4840030">[</span><span class="op" id="4840031">]</span><span class="op" id="4840032">*</span><span class="ident" id="4840033">Cookie</span><span class="op" id="4840039">{</span><span class="op" id="4840040">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840043">for</span>&nbsp;<span class="ident" id="4840047">_</span><span class="op" id="4840048">,</span>&nbsp;<span class="ident" id="4840050">line</span>&nbsp;<span class="op" id="4840055">:=</span>&nbsp;<span class="keyword" id="4840058">range</span>&nbsp;<span class="ident" id="4840064">h</span><span class="op" id="4840065">[</span><span class="string" id="4840066">&#34;Set-Cookie&#34;</span><span class="op" id="4840078">]</span>&nbsp;<span class="op" id="4840080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840084">parts</span>&nbsp;<span class="op" id="4840090">:=</span>&nbsp;<span class="ident" id="4840093">strings</span><span class="op" id="4840100">.</span><span class="ident" id="4840101">Split</span><span class="op" id="4840106">(</span><span class="ident" id="4840107">strings</span><span class="op" id="4840114">.</span><span class="ident" id="4840115">TrimSpace</span><span class="op" id="4840124">(</span><span class="ident" id="4840125">line</span><span class="op" id="4840129">)</span><span class="op" id="4840130">,</span>&nbsp;<span class="string" id="4840132">&#34;;&#34;</span><span class="op" id="4840135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840139">if</span>&nbsp;<span class="builtinfunc" id="4840142">len</span><span class="op" id="4840145">(</span><span class="ident" id="4840146">parts</span><span class="op" id="4840151">)</span>&nbsp;<span class="op" id="4840153">==</span>&nbsp;<span class="num" id="4840156">1</span>&nbsp;<span class="op" id="4840158">&amp;&amp;</span>&nbsp;<span class="ident" id="4840161">parts</span><span class="op" id="4840166">[</span><span class="num" id="4840167">0</span><span class="op" id="4840168">]</span>&nbsp;<span class="op" id="4840170">==</span>&nbsp;<span class="string" id="4840173">&#34;&#34;</span>&nbsp;<span class="op" id="4840176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840181">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840192">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840196">parts</span><span class="op" id="4840201">[</span><span class="num" id="4840202">0</span><span class="op" id="4840203">]</span>&nbsp;<span class="op" id="4840205">=</span>&nbsp;<span class="ident" id="4840207">strings</span><span class="op" id="4840214">.</span><span class="ident" id="4840215">TrimSpace</span><span class="op" id="4840224">(</span><span class="ident" id="4840225">parts</span><span class="op" id="4840230">[</span><span class="num" id="4840231">0</span><span class="op" id="4840232">]</span><span class="op" id="4840233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840237">j</span>&nbsp;<span class="op" id="4840239">:=</span>&nbsp;<span class="ident" id="4840242">strings</span><span class="op" id="4840249">.</span><span class="ident" id="4840250">Index</span><span class="op" id="4840255">(</span><span class="ident" id="4840256">parts</span><span class="op" id="4840261">[</span><span class="num" id="4840262">0</span><span class="op" id="4840263">]</span><span class="op" id="4840264">,</span>&nbsp;<span class="string" id="4840266">&#34;=&#34;</span><span class="op" id="4840269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840273">if</span>&nbsp;<span class="ident" id="4840276">j</span>&nbsp;<span class="op" id="4840278">&lt;</span>&nbsp;<span class="num" id="4840280">0</span>&nbsp;<span class="op" id="4840282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840287">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840298">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840302">name</span><span class="op" id="4840306">,</span>&nbsp;<span class="ident" id="4840308">value</span>&nbsp;<span class="op" id="4840314">:=</span>&nbsp;<span class="ident" id="4840317">parts</span><span class="op" id="4840322">[</span><span class="num" id="4840323">0</span><span class="op" id="4840324">]</span><span class="op" id="4840325">[</span><span class="op" id="4840326">:</span><span class="ident" id="4840327">j</span><span class="op" id="4840328">]</span><span class="op" id="4840329">,</span>&nbsp;<span class="ident" id="4840331">parts</span><span class="op" id="4840336">[</span><span class="num" id="4840337">0</span><span class="op" id="4840338">]</span><span class="op" id="4840339">[</span><span class="ident" id="4840340">j</span><span class="op" id="4840341">+</span><span class="num" id="4840342">1</span><span class="op" id="4840343">:</span><span class="op" id="4840344">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840348">if</span>&nbsp;<span class="op" id="4840351">!</span><span class="ident" id="4840352">isCookieNameValid</span><span class="op" id="4840369">(</span><span class="ident" id="4840370">name</span><span class="op" id="4840374">)</span>&nbsp;<span class="op" id="4840376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840381">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840396">value</span><span class="op" id="4840401">,</span>&nbsp;<span class="ident" id="4840403">success</span>&nbsp;<span class="op" id="4840411">:=</span>&nbsp;<span class="ident" id="4840414">parseCookieValue</span><span class="op" id="4840430">(</span><span class="ident" id="4840431">value</span><span class="op" id="4840436">,</span>&nbsp;<span class="builtintype" id="4840438">true</span><span class="op" id="4840442">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840446">if</span>&nbsp;<span class="op" id="4840449">!</span><span class="ident" id="4840450">success</span>&nbsp;<span class="op" id="4840458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840463">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840478">c</span>&nbsp;<span class="op" id="4840480">:=</span>&nbsp;<span class="op" id="4840483">&amp;</span><span class="ident" id="4840484">Cookie</span><span class="op" id="4840490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840495">Name</span><span class="op" id="4840499">:</span>&nbsp;&nbsp;<span class="ident" id="4840502">name</span><span class="op" id="4840506">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840511">Value</span><span class="op" id="4840516">:</span>&nbsp;<span class="ident" id="4840518">value</span><span class="op" id="4840523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840528">Raw</span><span class="op" id="4840531">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4840535">line</span><span class="op" id="4840539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840547">for</span>&nbsp;<span class="ident" id="4840551">i</span>&nbsp;<span class="op" id="4840553">:=</span>&nbsp;<span class="num" id="4840556">1</span><span class="op" id="4840557">;</span>&nbsp;<span class="ident" id="4840559">i</span>&nbsp;<span class="op" id="4840561">&lt;</span>&nbsp;<span class="builtinfunc" id="4840563">len</span><span class="op" id="4840566">(</span><span class="ident" id="4840567">parts</span><span class="op" id="4840572">)</span><span class="op" id="4840573">;</span>&nbsp;<span class="ident" id="4840575">i</span><span class="op" id="4840576">++</span>&nbsp;<span class="op" id="4840579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840584">parts</span><span class="op" id="4840589">[</span><span class="ident" id="4840590">i</span><span class="op" id="4840591">]</span>&nbsp;<span class="op" id="4840593">=</span>&nbsp;<span class="ident" id="4840595">strings</span><span class="op" id="4840602">.</span><span class="ident" id="4840603">TrimSpace</span><span class="op" id="4840612">(</span><span class="ident" id="4840613">parts</span><span class="op" id="4840618">[</span><span class="ident" id="4840619">i</span><span class="op" id="4840620">]</span><span class="op" id="4840621">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840626">if</span>&nbsp;<span class="builtinfunc" id="4840629">len</span><span class="op" id="4840632">(</span><span class="ident" id="4840633">parts</span><span class="op" id="4840638">[</span><span class="ident" id="4840639">i</span><span class="op" id="4840640">]</span><span class="op" id="4840641">)</span>&nbsp;<span class="op" id="4840643">==</span>&nbsp;<span class="num" id="4840646">0</span>&nbsp;<span class="op" id="4840648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840654">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840672">attr</span><span class="op" id="4840676">,</span>&nbsp;<span class="ident" id="4840678">val</span>&nbsp;<span class="op" id="4840682">:=</span>&nbsp;<span class="ident" id="4840685">parts</span><span class="op" id="4840690">[</span><span class="ident" id="4840691">i</span><span class="op" id="4840692">]</span><span class="op" id="4840693">,</span>&nbsp;<span class="string" id="4840695">&#34;&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840701">if</span>&nbsp;<span class="ident" id="4840704">j</span>&nbsp;<span class="op" id="4840706">:=</span>&nbsp;<span class="ident" id="4840709">strings</span><span class="op" id="4840716">.</span><span class="ident" id="4840717">Index</span><span class="op" id="4840722">(</span><span class="ident" id="4840723">attr</span><span class="op" id="4840727">,</span>&nbsp;<span class="string" id="4840729">&#34;=&#34;</span><span class="op" id="4840732">)</span><span class="op" id="4840733">;</span>&nbsp;<span class="ident" id="4840735">j</span>&nbsp;<span class="op" id="4840737">&gt;=</span>&nbsp;<span class="num" id="4840740">0</span>&nbsp;<span class="op" id="4840742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840748">attr</span><span class="op" id="4840752">,</span>&nbsp;<span class="ident" id="4840754">val</span>&nbsp;<span class="op" id="4840758">=</span>&nbsp;<span class="ident" id="4840760">attr</span><span class="op" id="4840764">[</span><span class="op" id="4840765">:</span><span class="ident" id="4840766">j</span><span class="op" id="4840767">]</span><span class="op" id="4840768">,</span>&nbsp;<span class="ident" id="4840770">attr</span><span class="op" id="4840774">[</span><span class="ident" id="4840775">j</span><span class="op" id="4840776">+</span><span class="num" id="4840777">1</span><span class="op" id="4840778">:</span><span class="op" id="4840779">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840789">lowerAttr</span>&nbsp;<span class="op" id="4840799">:=</span>&nbsp;<span class="ident" id="4840802">strings</span><span class="op" id="4840809">.</span><span class="ident" id="4840810">ToLower</span><span class="op" id="4840817">(</span><span class="ident" id="4840818">attr</span><span class="op" id="4840822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840827">val</span><span class="op" id="4840830">,</span>&nbsp;<span class="ident" id="4840832">success</span>&nbsp;<span class="op" id="4840840">=</span>&nbsp;<span class="ident" id="4840842">parseCookieValue</span><span class="op" id="4840858">(</span><span class="ident" id="4840859">val</span><span class="op" id="4840862">,</span>&nbsp;<span class="builtintype" id="4840864">false</span><span class="op" id="4840869">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840874">if</span>&nbsp;<span class="op" id="4840877">!</span><span class="ident" id="4840878">success</span>&nbsp;<span class="op" id="4840886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840892">c</span><span class="op" id="4840893">.</span><span class="ident" id="4840894">Unparsed</span>&nbsp;<span class="op" id="4840903">=</span>&nbsp;<span class="builtinfunc" id="4840905">append</span><span class="op" id="4840911">(</span><span class="ident" id="4840912">c</span><span class="op" id="4840913">.</span><span class="ident" id="4840914">Unparsed</span><span class="op" id="4840922">,</span>&nbsp;<span class="ident" id="4840924">parts</span><span class="op" id="4840929">[</span><span class="ident" id="4840930">i</span><span class="op" id="4840931">]</span><span class="op" id="4840932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840938">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4840950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840955">switch</span>&nbsp;<span class="ident" id="4840962">lowerAttr</span>&nbsp;<span class="op" id="4840972">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4840977">case</span>&nbsp;<span class="string" id="4840982">&#34;secure&#34;</span><span class="op" id="4840990">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840996">c</span><span class="op" id="4840997">.</span><span class="ident" id="4840998">Secure</span>&nbsp;<span class="op" id="4841005">=</span>&nbsp;<span class="builtintype" id="4841007">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841016">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841028">case</span>&nbsp;<span class="string" id="4841033">&#34;httponly&#34;</span><span class="op" id="4841043">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841049">c</span><span class="op" id="4841050">.</span><span class="ident" id="4841051">HttpOnly</span>&nbsp;<span class="op" id="4841060">=</span>&nbsp;<span class="builtintype" id="4841062">true</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841071">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841083">case</span>&nbsp;<span class="string" id="4841088">&#34;domain&#34;</span><span class="op" id="4841096">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841102">c</span><span class="op" id="4841103">.</span><span class="ident" id="4841104">Domain</span>&nbsp;<span class="op" id="4841111">=</span>&nbsp;<span class="ident" id="4841113">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841121">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841133">case</span>&nbsp;<span class="string" id="4841138">&#34;max-age&#34;</span><span class="op" id="4841147">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841153">secs</span><span class="op" id="4841157">,</span>&nbsp;<span class="ident" id="4841159">err</span>&nbsp;<span class="op" id="4841163">:=</span>&nbsp;<span class="ident" id="4841166">strconv</span><span class="op" id="4841173">.</span><span class="ident" id="4841174">Atoi</span><span class="op" id="4841178">(</span><span class="ident" id="4841179">val</span><span class="op" id="4841182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841188">if</span>&nbsp;<span class="ident" id="4841191">err</span>&nbsp;<span class="op" id="4841195">!=</span>&nbsp;<span class="ident" id="4841198">nil</span>&nbsp;<span class="op" id="4841202">||</span>&nbsp;<span class="ident" id="4841205">secs</span>&nbsp;<span class="op" id="4841210">!=</span>&nbsp;<span class="num" id="4841213">0</span>&nbsp;<span class="op" id="4841215">&amp;&amp;</span>&nbsp;<span class="ident" id="4841218">val</span><span class="op" id="4841221">[</span><span class="num" id="4841222">0</span><span class="op" id="4841223">]</span>&nbsp;<span class="op" id="4841225">==</span>&nbsp;<span class="string" id="4841228">&#39;0&#39;</span>&nbsp;<span class="op" id="4841232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841239">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841255">if</span>&nbsp;<span class="ident" id="4841258">secs</span>&nbsp;<span class="op" id="4841263">&lt;=</span>&nbsp;<span class="num" id="4841266">0</span>&nbsp;<span class="op" id="4841268">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841275">c</span><span class="op" id="4841276">.</span><span class="ident" id="4841277">MaxAge</span>&nbsp;<span class="op" id="4841284">=</span>&nbsp;<span class="op" id="4841286">-</span><span class="num" id="4841287">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841293">}</span>&nbsp;<span class="keyword" id="4841295">else</span>&nbsp;<span class="op" id="4841300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841307">c</span><span class="op" id="4841308">.</span><span class="ident" id="4841309">MaxAge</span>&nbsp;<span class="op" id="4841316">=</span>&nbsp;<span class="ident" id="4841318">secs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841333">continue</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841345">case</span>&nbsp;<span class="string" id="4841350">&#34;expires&#34;</span><span class="op" id="4841359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841365">c</span><span class="op" id="4841366">.</span><span class="ident" id="4841367">RawExpires</span>&nbsp;<span class="op" id="4841378">=</span>&nbsp;<span class="ident" id="4841380">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841388">exptime</span><span class="op" id="4841395">,</span>&nbsp;<span class="ident" id="4841397">err</span>&nbsp;<span class="op" id="4841401">:=</span>&nbsp;<span class="ident" id="4841404">time</span><span class="op" id="4841408">.</span><span class="ident" id="4841409">Parse</span><span class="op" id="4841414">(</span><span class="ident" id="4841415">time</span><span class="op" id="4841419">.</span><span class="ident" id="4841420">RFC1123</span><span class="op" id="4841427">,</span>&nbsp;<span class="ident" id="4841429">val</span><span class="op" id="4841432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841438">if</span>&nbsp;<span class="ident" id="4841441">err</span>&nbsp;<span class="op" id="4841445">!=</span>&nbsp;<span class="ident" id="4841448">nil</span>&nbsp;<span class="op" id="4841452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841459">exptime</span><span class="op" id="4841466">,</span>&nbsp;<span class="ident" id="4841468">err</span>&nbsp;<span class="op" id="4841472">=</span>&nbsp;<span class="ident" id="4841474">time</span><span class="op" id="4841478">.</span><span class="ident" id="4841479">Parse</span><span class="op" id="4841484">(</span><span class="string" id="4841485">&#34;Mon,&nbsp;02-Jan-2006&nbsp;15:04:05&nbsp;MST&#34;</span><span class="op" id="4841516">,</span>&nbsp;<span class="ident" id="4841518">val</span><span class="op" id="4841521">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841528">if</span>&nbsp;<span class="ident" id="4841531">err</span>&nbsp;<span class="op" id="4841535">!=</span>&nbsp;<span class="ident" id="4841538">nil</span>&nbsp;<span class="op" id="4841542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841550">c</span><span class="op" id="4841551">.</span><span class="ident" id="4841552">Expires</span>&nbsp;<span class="op" id="4841560">=</span>&nbsp;<span class="ident" id="4841562">time</span><span class="op" id="4841566">.</span><span class="ident" id="4841567">Time</span><span class="op" id="4841571">{</span><span class="op" id="4841572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841580">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841597">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841603">c</span><span class="op" id="4841604">.</span><span class="ident" id="4841605">Expires</span>&nbsp;<span class="op" id="4841613">=</span>&nbsp;<span class="ident" id="4841615">exptime</span><span class="op" id="4841622">.</span><span class="ident" id="4841623">UTC</span><span class="op" id="4841626">(</span><span class="op" id="4841627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841633">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841645">case</span>&nbsp;<span class="string" id="4841650">&#34;path&#34;</span><span class="op" id="4841656">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841662">c</span><span class="op" id="4841663">.</span><span class="ident" id="4841664">Path</span>&nbsp;<span class="op" id="4841669">=</span>&nbsp;<span class="ident" id="4841671">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841679">continue</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841696">c</span><span class="op" id="4841697">.</span><span class="ident" id="4841698">Unparsed</span>&nbsp;<span class="op" id="4841707">=</span>&nbsp;<span class="builtinfunc" id="4841709">append</span><span class="op" id="4841715">(</span><span class="ident" id="4841716">c</span><span class="op" id="4841717">.</span><span class="ident" id="4841718">Unparsed</span><span class="op" id="4841726">,</span>&nbsp;<span class="ident" id="4841728">parts</span><span class="op" id="4841733">[</span><span class="ident" id="4841734">i</span><span class="op" id="4841735">]</span><span class="op" id="4841736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841744">cookies</span>&nbsp;<span class="op" id="4841752">=</span>&nbsp;<span class="builtinfunc" id="4841754">append</span><span class="op" id="4841760">(</span><span class="ident" id="4841761">cookies</span><span class="op" id="4841768">,</span>&nbsp;<span class="ident" id="4841770">c</span><span class="op" id="4841771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841774">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841777">return</span>&nbsp;<span class="ident" id="4841784">cookies</span><br>
<span class="lineno"></span><span class="op" id="4841792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4841795">//&nbsp;SetCookie&nbsp;adds&nbsp;a&nbsp;Set-Cookie&nbsp;header&nbsp;to&nbsp;the&nbsp;provided&nbsp;ResponseWriter&#39;s&nbsp;headers.</span><br>
<span class="lineno"></span><span class="keyword" id="4841875">func</span>&nbsp;<span class="ident" id="4841880">SetCookie</span><span class="op" id="4841889">(</span><span class="ident" id="4841890">w</span>&nbsp;<span class="ident" id="4841892">ResponseWriter</span><span class="op" id="4841906">,</span>&nbsp;<span class="ident" id="4841908">cookie</span>&nbsp;<span class="op" id="4841915">*</span><span class="ident" id="4841916">Cookie</span><span class="op" id="4841922">)</span>&nbsp;<span class="op" id="4841924">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841927">w</span><span class="op" id="4841928">.</span><span class="ident" id="4841929">Header</span><span class="op" id="4841935">(</span><span class="op" id="4841936">)</span><span class="op" id="4841937">.</span><span class="ident" id="4841938">Add</span><span class="op" id="4841941">(</span><span class="string" id="4841942">&#34;Set-Cookie&#34;</span><span class="op" id="4841954">,</span>&nbsp;<span class="ident" id="4841956">cookie</span><span class="op" id="4841962">.</span><span class="ident" id="4841963">String</span><span class="op" id="4841969">(</span><span class="op" id="4841970">)</span><span class="op" id="4841971">)</span><br>
<span class="lineno"></span><span class="op" id="4841973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4841976">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;serialization&nbsp;of&nbsp;the&nbsp;cookie&nbsp;for&nbsp;use&nbsp;in&nbsp;a&nbsp;Cookie</span><br>
<span class="lineno"></span><span class="comment" id="4842046">//&nbsp;header&nbsp;(if&nbsp;only&nbsp;Name&nbsp;and&nbsp;Value&nbsp;are&nbsp;set)&nbsp;or&nbsp;a&nbsp;Set-Cookie&nbsp;response</span><br>
<span class="lineno">135</span><span class="comment" id="4842114">//&nbsp;header&nbsp;(if&nbsp;other&nbsp;fields&nbsp;are&nbsp;set).</span><br>
<span class="lineno"></span><span class="keyword" id="4842151">func</span>&nbsp;<span class="op" id="4842156">(</span><span class="ident" id="4842157">c</span>&nbsp;<span class="op" id="4842159">*</span><span class="ident" id="4842160">Cookie</span><span class="op" id="4842166">)</span>&nbsp;<span class="ident" id="4842168">String</span><span class="op" id="4842174">(</span><span class="op" id="4842175">)</span>&nbsp;<span class="builtintype" id="4842177">string</span>&nbsp;<span class="op" id="4842184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842187">var</span>&nbsp;<span class="ident" id="4842191">b</span>&nbsp;<span class="ident" id="4842193">bytes</span><span class="op" id="4842198">.</span><span class="ident" id="4842199">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842207">fmt</span><span class="op" id="4842210">.</span><span class="ident" id="4842211">Fprintf</span><span class="op" id="4842218">(</span><span class="op" id="4842219">&amp;</span><span class="ident" id="4842220">b</span><span class="op" id="4842221">,</span>&nbsp;<span class="string" id="4842223">&#34;%s=%s&#34;</span><span class="op" id="4842230">,</span>&nbsp;<span class="ident" id="4842232">sanitizeCookieName</span><span class="op" id="4842250">(</span><span class="ident" id="4842251">c</span><span class="op" id="4842252">.</span><span class="ident" id="4842253">Name</span><span class="op" id="4842257">)</span><span class="op" id="4842258">,</span>&nbsp;<span class="ident" id="4842260">sanitizeCookieValue</span><span class="op" id="4842279">(</span><span class="ident" id="4842280">c</span><span class="op" id="4842281">.</span><span class="ident" id="4842282">Value</span><span class="op" id="4842287">)</span><span class="op" id="4842288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842291">if</span>&nbsp;<span class="builtinfunc" id="4842294">len</span><span class="op" id="4842297">(</span><span class="ident" id="4842298">c</span><span class="op" id="4842299">.</span><span class="ident" id="4842300">Path</span><span class="op" id="4842304">)</span>&nbsp;<span class="op" id="4842306">&gt;</span>&nbsp;<span class="num" id="4842308">0</span>&nbsp;<span class="op" id="4842310">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842314">fmt</span><span class="op" id="4842317">.</span><span class="ident" id="4842318">Fprintf</span><span class="op" id="4842325">(</span><span class="op" id="4842326">&amp;</span><span class="ident" id="4842327">b</span><span class="op" id="4842328">,</span>&nbsp;<span class="string" id="4842330">&#34;;&nbsp;Path=%s&#34;</span><span class="op" id="4842341">,</span>&nbsp;<span class="ident" id="4842343">sanitizeCookiePath</span><span class="op" id="4842361">(</span><span class="ident" id="4842362">c</span><span class="op" id="4842363">.</span><span class="ident" id="4842364">Path</span><span class="op" id="4842368">)</span><span class="op" id="4842369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842375">if</span>&nbsp;<span class="builtinfunc" id="4842378">len</span><span class="op" id="4842381">(</span><span class="ident" id="4842382">c</span><span class="op" id="4842383">.</span><span class="ident" id="4842384">Domain</span><span class="op" id="4842390">)</span>&nbsp;<span class="op" id="4842392">&gt;</span>&nbsp;<span class="num" id="4842394">0</span>&nbsp;<span class="op" id="4842396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842400">if</span>&nbsp;<span class="ident" id="4842403">validCookieDomain</span><span class="op" id="4842420">(</span><span class="ident" id="4842421">c</span><span class="op" id="4842422">.</span><span class="ident" id="4842423">Domain</span><span class="op" id="4842429">)</span>&nbsp;<span class="op" id="4842431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4842436">//&nbsp;A&nbsp;c.Domain&nbsp;containing&nbsp;illegal&nbsp;characters&nbsp;is&nbsp;not</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4842490">//&nbsp;sanitized&nbsp;but&nbsp;simply&nbsp;dropped&nbsp;which&nbsp;turns&nbsp;the&nbsp;cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4842548">//&nbsp;into&nbsp;a&nbsp;host-only&nbsp;cookie.&nbsp;A&nbsp;leading&nbsp;dot&nbsp;is&nbsp;okay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4842601">//&nbsp;but&nbsp;won&#39;t&nbsp;be&nbsp;sent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842626">d</span>&nbsp;<span class="op" id="4842628">:=</span>&nbsp;<span class="ident" id="4842631">c</span><span class="op" id="4842632">.</span><span class="ident" id="4842633">Domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842643">if</span>&nbsp;<span class="ident" id="4842646">d</span><span class="op" id="4842647">[</span><span class="num" id="4842648">0</span><span class="op" id="4842649">]</span>&nbsp;<span class="op" id="4842651">==</span>&nbsp;<span class="string" id="4842654">&#39;.&#39;</span>&nbsp;<span class="op" id="4842658">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842664">d</span>&nbsp;<span class="op" id="4842666">=</span>&nbsp;<span class="ident" id="4842668">d</span><span class="op" id="4842669">[</span><span class="num" id="4842670">1</span><span class="op" id="4842671">:</span><span class="op" id="4842672">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842682">fmt</span><span class="op" id="4842685">.</span><span class="ident" id="4842686">Fprintf</span><span class="op" id="4842693">(</span><span class="op" id="4842694">&amp;</span><span class="ident" id="4842695">b</span><span class="op" id="4842696">,</span>&nbsp;<span class="string" id="4842698">&#34;;&nbsp;Domain=%s&#34;</span><span class="op" id="4842711">,</span>&nbsp;<span class="ident" id="4842713">d</span><span class="op" id="4842714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842718">}</span>&nbsp;<span class="keyword" id="4842720">else</span>&nbsp;<span class="op" id="4842725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842730">log</span><span class="op" id="4842733">.</span><span class="ident" id="4842734">Printf</span><span class="op" id="4842740">(</span><span class="string" id="4842741">&#34;net/http:&nbsp;invalid&nbsp;Cookie.Domain&nbsp;%q;&nbsp;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="4842804">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842810">c</span><span class="op" id="4842811">.</span><span class="ident" id="4842812">Domain</span><span class="op" id="4842818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842828">if</span>&nbsp;<span class="ident" id="4842831">c</span><span class="op" id="4842832">.</span><span class="ident" id="4842833">Expires</span><span class="op" id="4842840">.</span><span class="ident" id="4842841">Unix</span><span class="op" id="4842845">(</span><span class="op" id="4842846">)</span>&nbsp;<span class="op" id="4842848">&gt;</span>&nbsp;<span class="num" id="4842850">0</span>&nbsp;<span class="op" id="4842852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842856">fmt</span><span class="op" id="4842859">.</span><span class="ident" id="4842860">Fprintf</span><span class="op" id="4842867">(</span><span class="op" id="4842868">&amp;</span><span class="ident" id="4842869">b</span><span class="op" id="4842870">,</span>&nbsp;<span class="string" id="4842872">&#34;;&nbsp;Expires=%s&#34;</span><span class="op" id="4842886">,</span>&nbsp;<span class="ident" id="4842888">c</span><span class="op" id="4842889">.</span><span class="ident" id="4842890">Expires</span><span class="op" id="4842897">.</span><span class="ident" id="4842898">UTC</span><span class="op" id="4842901">(</span><span class="op" id="4842902">)</span><span class="op" id="4842903">.</span><span class="ident" id="4842904">Format</span><span class="op" id="4842910">(</span><span class="ident" id="4842911">time</span><span class="op" id="4842915">.</span><span class="ident" id="4842916">RFC1123</span><span class="op" id="4842923">)</span><span class="op" id="4842924">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842930">if</span>&nbsp;<span class="ident" id="4842933">c</span><span class="op" id="4842934">.</span><span class="ident" id="4842935">MaxAge</span>&nbsp;<span class="op" id="4842942">&gt;</span>&nbsp;<span class="num" id="4842944">0</span>&nbsp;<span class="op" id="4842946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842950">fmt</span><span class="op" id="4842953">.</span><span class="ident" id="4842954">Fprintf</span><span class="op" id="4842961">(</span><span class="op" id="4842962">&amp;</span><span class="ident" id="4842963">b</span><span class="op" id="4842964">,</span>&nbsp;<span class="string" id="4842966">&#34;;&nbsp;Max-Age=%d&#34;</span><span class="op" id="4842980">,</span>&nbsp;<span class="ident" id="4842982">c</span><span class="op" id="4842983">.</span><span class="ident" id="4842984">MaxAge</span><span class="op" id="4842990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842993">}</span>&nbsp;<span class="keyword" id="4842995">else</span>&nbsp;<span class="keyword" id="4843000">if</span>&nbsp;<span class="ident" id="4843003">c</span><span class="op" id="4843004">.</span><span class="ident" id="4843005">MaxAge</span>&nbsp;<span class="op" id="4843012">&lt;</span>&nbsp;<span class="num" id="4843014">0</span>&nbsp;<span class="op" id="4843016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843020">fmt</span><span class="op" id="4843023">.</span><span class="ident" id="4843024">Fprintf</span><span class="op" id="4843031">(</span><span class="op" id="4843032">&amp;</span><span class="ident" id="4843033">b</span><span class="op" id="4843034">,</span>&nbsp;<span class="string" id="4843036">&#34;;&nbsp;Max-Age=0&#34;</span><span class="op" id="4843049">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843055">if</span>&nbsp;<span class="ident" id="4843058">c</span><span class="op" id="4843059">.</span><span class="ident" id="4843060">HttpOnly</span>&nbsp;<span class="op" id="4843069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843073">fmt</span><span class="op" id="4843076">.</span><span class="ident" id="4843077">Fprintf</span><span class="op" id="4843084">(</span><span class="op" id="4843085">&amp;</span><span class="ident" id="4843086">b</span><span class="op" id="4843087">,</span>&nbsp;<span class="string" id="4843089">&#34;;&nbsp;HttpOnly&#34;</span><span class="op" id="4843101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843107">if</span>&nbsp;<span class="ident" id="4843110">c</span><span class="op" id="4843111">.</span><span class="ident" id="4843112">Secure</span>&nbsp;<span class="op" id="4843119">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843123">fmt</span><span class="op" id="4843126">.</span><span class="ident" id="4843127">Fprintf</span><span class="op" id="4843134">(</span><span class="op" id="4843135">&amp;</span><span class="ident" id="4843136">b</span><span class="op" id="4843137">,</span>&nbsp;<span class="string" id="4843139">&#34;;&nbsp;Secure&#34;</span><span class="op" id="4843149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843155">return</span>&nbsp;<span class="ident" id="4843162">b</span><span class="op" id="4843163">.</span><span class="ident" id="4843164">String</span><span class="op" id="4843170">(</span><span class="op" id="4843171">)</span><br>
<span class="lineno"></span><span class="op" id="4843173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="4843176">//&nbsp;readCookies&nbsp;parses&nbsp;all&nbsp;&#34;Cookie&#34;&nbsp;values&nbsp;from&nbsp;the&nbsp;header&nbsp;h&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4843240">//&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="comment" id="4843284">//</span><br>
<span class="lineno"></span><span class="comment" id="4843287">//&nbsp;if&nbsp;filter&nbsp;isn&#39;t&nbsp;empty,&nbsp;only&nbsp;cookies&nbsp;of&nbsp;that&nbsp;name&nbsp;are&nbsp;returned</span><br>
<span class="lineno"></span><span class="keyword" id="4843352">func</span>&nbsp;<span class="ident" id="4843357">readCookies</span><span class="op" id="4843368">(</span><span class="ident" id="4843369">h</span>&nbsp;<span class="ident" id="4843371">Header</span><span class="op" id="4843377">,</span>&nbsp;<span class="ident" id="4843379">filter</span>&nbsp;<span class="builtintype" id="4843386">string</span><span class="op" id="4843392">)</span>&nbsp;<span class="op" id="4843394">[</span><span class="op" id="4843395">]</span><span class="op" id="4843396">*</span><span class="ident" id="4843397">Cookie</span>&nbsp;<span class="op" id="4843404">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843407">cookies</span>&nbsp;<span class="op" id="4843415">:=</span>&nbsp;<span class="op" id="4843418">[</span><span class="op" id="4843419">]</span><span class="op" id="4843420">*</span><span class="ident" id="4843421">Cookie</span><span class="op" id="4843427">{</span><span class="op" id="4843428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843431">lines</span><span class="op" id="4843436">,</span>&nbsp;<span class="ident" id="4843438">ok</span>&nbsp;<span class="op" id="4843441">:=</span>&nbsp;<span class="ident" id="4843444">h</span><span class="op" id="4843445">[</span><span class="string" id="4843446">&#34;Cookie&#34;</span><span class="op" id="4843454">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843457">if</span>&nbsp;<span class="op" id="4843460">!</span><span class="ident" id="4843461">ok</span>&nbsp;<span class="op" id="4843464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843468">return</span>&nbsp;<span class="ident" id="4843475">cookies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843484">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843488">for</span>&nbsp;<span class="ident" id="4843492">_</span><span class="op" id="4843493">,</span>&nbsp;<span class="ident" id="4843495">line</span>&nbsp;<span class="op" id="4843500">:=</span>&nbsp;<span class="keyword" id="4843503">range</span>&nbsp;<span class="ident" id="4843509">lines</span>&nbsp;<span class="op" id="4843515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843519">parts</span>&nbsp;<span class="op" id="4843525">:=</span>&nbsp;<span class="ident" id="4843528">strings</span><span class="op" id="4843535">.</span><span class="ident" id="4843536">Split</span><span class="op" id="4843541">(</span><span class="ident" id="4843542">strings</span><span class="op" id="4843549">.</span><span class="ident" id="4843550">TrimSpace</span><span class="op" id="4843559">(</span><span class="ident" id="4843560">line</span><span class="op" id="4843564">)</span><span class="op" id="4843565">,</span>&nbsp;<span class="string" id="4843567">&#34;;&#34;</span><span class="op" id="4843570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843574">if</span>&nbsp;<span class="builtinfunc" id="4843577">len</span><span class="op" id="4843580">(</span><span class="ident" id="4843581">parts</span><span class="op" id="4843586">)</span>&nbsp;<span class="op" id="4843588">==</span>&nbsp;<span class="num" id="4843591">1</span>&nbsp;<span class="op" id="4843593">&amp;&amp;</span>&nbsp;<span class="ident" id="4843596">parts</span><span class="op" id="4843601">[</span><span class="num" id="4843602">0</span><span class="op" id="4843603">]</span>&nbsp;<span class="op" id="4843605">==</span>&nbsp;<span class="string" id="4843608">&#34;&#34;</span>&nbsp;<span class="op" id="4843611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843616">continue</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4843631">//&nbsp;Per-line&nbsp;attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843656">parsedPairs</span>&nbsp;<span class="op" id="4843668">:=</span>&nbsp;<span class="num" id="4843671">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843675">for</span>&nbsp;<span class="ident" id="4843679">i</span>&nbsp;<span class="op" id="4843681">:=</span>&nbsp;<span class="num" id="4843684">0</span><span class="op" id="4843685">;</span>&nbsp;<span class="ident" id="4843687">i</span>&nbsp;<span class="op" id="4843689">&lt;</span>&nbsp;<span class="builtinfunc" id="4843691">len</span><span class="op" id="4843694">(</span><span class="ident" id="4843695">parts</span><span class="op" id="4843700">)</span><span class="op" id="4843701">;</span>&nbsp;<span class="ident" id="4843703">i</span><span class="op" id="4843704">++</span>&nbsp;<span class="op" id="4843707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843712">parts</span><span class="op" id="4843717">[</span><span class="ident" id="4843718">i</span><span class="op" id="4843719">]</span>&nbsp;<span class="op" id="4843721">=</span>&nbsp;<span class="ident" id="4843723">strings</span><span class="op" id="4843730">.</span><span class="ident" id="4843731">TrimSpace</span><span class="op" id="4843740">(</span><span class="ident" id="4843741">parts</span><span class="op" id="4843746">[</span><span class="ident" id="4843747">i</span><span class="op" id="4843748">]</span><span class="op" id="4843749">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843754">if</span>&nbsp;<span class="builtinfunc" id="4843757">len</span><span class="op" id="4843760">(</span><span class="ident" id="4843761">parts</span><span class="op" id="4843766">[</span><span class="ident" id="4843767">i</span><span class="op" id="4843768">]</span><span class="op" id="4843769">)</span>&nbsp;<span class="op" id="4843771">==</span>&nbsp;<span class="num" id="4843774">0</span>&nbsp;<span class="op" id="4843776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843782">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843799">name</span><span class="op" id="4843803">,</span>&nbsp;<span class="ident" id="4843805">val</span>&nbsp;<span class="op" id="4843809">:=</span>&nbsp;<span class="ident" id="4843812">parts</span><span class="op" id="4843817">[</span><span class="ident" id="4843818">i</span><span class="op" id="4843819">]</span><span class="op" id="4843820">,</span>&nbsp;<span class="string" id="4843822">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843828">if</span>&nbsp;<span class="ident" id="4843831">j</span>&nbsp;<span class="op" id="4843833">:=</span>&nbsp;<span class="ident" id="4843836">strings</span><span class="op" id="4843843">.</span><span class="ident" id="4843844">Index</span><span class="op" id="4843849">(</span><span class="ident" id="4843850">name</span><span class="op" id="4843854">,</span>&nbsp;<span class="string" id="4843856">&#34;=&#34;</span><span class="op" id="4843859">)</span><span class="op" id="4843860">;</span>&nbsp;<span class="ident" id="4843862">j</span>&nbsp;<span class="op" id="4843864">&gt;=</span>&nbsp;<span class="num" id="4843867">0</span>&nbsp;<span class="op" id="4843869">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843875">name</span><span class="op" id="4843879">,</span>&nbsp;<span class="ident" id="4843881">val</span>&nbsp;<span class="op" id="4843885">=</span>&nbsp;<span class="ident" id="4843887">name</span><span class="op" id="4843891">[</span><span class="op" id="4843892">:</span><span class="ident" id="4843893">j</span><span class="op" id="4843894">]</span><span class="op" id="4843895">,</span>&nbsp;<span class="ident" id="4843897">name</span><span class="op" id="4843901">[</span><span class="ident" id="4843902">j</span><span class="op" id="4843903">+</span><span class="num" id="4843904">1</span><span class="op" id="4843905">:</span><span class="op" id="4843906">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843916">if</span>&nbsp;<span class="op" id="4843919">!</span><span class="ident" id="4843920">isCookieNameValid</span><span class="op" id="4843937">(</span><span class="ident" id="4843938">name</span><span class="op" id="4843942">)</span>&nbsp;<span class="op" id="4843944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843950">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843962">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843967">if</span>&nbsp;<span class="ident" id="4843970">filter</span>&nbsp;<span class="op" id="4843977">!=</span>&nbsp;<span class="string" id="4843980">&#34;&#34;</span>&nbsp;<span class="op" id="4843983">&amp;&amp;</span>&nbsp;<span class="ident" id="4843986">filter</span>&nbsp;<span class="op" id="4843993">!=</span>&nbsp;<span class="ident" id="4843996">name</span>&nbsp;<span class="op" id="4844001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844007">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844024">val</span><span class="op" id="4844027">,</span>&nbsp;<span class="ident" id="4844029">success</span>&nbsp;<span class="op" id="4844037">:=</span>&nbsp;<span class="ident" id="4844040">parseCookieValue</span><span class="op" id="4844056">(</span><span class="ident" id="4844057">val</span><span class="op" id="4844060">,</span>&nbsp;<span class="builtintype" id="4844062">true</span><span class="op" id="4844066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844071">if</span>&nbsp;<span class="op" id="4844074">!</span><span class="ident" id="4844075">success</span>&nbsp;<span class="op" id="4844083">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844089">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844106">cookies</span>&nbsp;<span class="op" id="4844114">=</span>&nbsp;<span class="builtinfunc" id="4844116">append</span><span class="op" id="4844122">(</span><span class="ident" id="4844123">cookies</span><span class="op" id="4844130">,</span>&nbsp;<span class="op" id="4844132">&amp;</span><span class="ident" id="4844133">Cookie</span><span class="op" id="4844139">{</span><span class="ident" id="4844140">Name</span><span class="op" id="4844144">:</span>&nbsp;<span class="ident" id="4844146">name</span><span class="op" id="4844150">,</span>&nbsp;<span class="ident" id="4844152">Value</span><span class="op" id="4844157">:</span>&nbsp;<span class="ident" id="4844159">val</span><span class="op" id="4844162">}</span><span class="op" id="4844163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844168">parsedPairs</span><span class="op" id="4844179">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844184">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844190">return</span>&nbsp;<span class="ident" id="4844197">cookies</span><br>
<span class="lineno"></span><span class="op" id="4844205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4844208">//&nbsp;validCookieDomain&nbsp;returns&nbsp;wheter&nbsp;v&nbsp;is&nbsp;a&nbsp;valid&nbsp;cookie&nbsp;domain-value.</span><br>
<span class="lineno">220</span><span class="keyword" id="4844278">func</span>&nbsp;<span class="ident" id="4844283">validCookieDomain</span><span class="op" id="4844300">(</span><span class="ident" id="4844301">v</span>&nbsp;<span class="builtintype" id="4844303">string</span><span class="op" id="4844309">)</span>&nbsp;<span class="builtintype" id="4844311">bool</span>&nbsp;<span class="op" id="4844316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844319">if</span>&nbsp;<span class="ident" id="4844322">isCookieDomainName</span><span class="op" id="4844340">(</span><span class="ident" id="4844341">v</span><span class="op" id="4844342">)</span>&nbsp;<span class="op" id="4844344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844348">return</span>&nbsp;<span class="builtintype" id="4844355">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844364">if</span>&nbsp;<span class="ident" id="4844367">net</span><span class="op" id="4844370">.</span><span class="ident" id="4844371">ParseIP</span><span class="op" id="4844378">(</span><span class="ident" id="4844379">v</span><span class="op" id="4844380">)</span>&nbsp;<span class="op" id="4844382">!=</span>&nbsp;<span class="ident" id="4844385">nil</span>&nbsp;<span class="op" id="4844389">&amp;&amp;</span>&nbsp;<span class="op" id="4844392">!</span><span class="ident" id="4844393">strings</span><span class="op" id="4844400">.</span><span class="ident" id="4844401">Contains</span><span class="op" id="4844409">(</span><span class="ident" id="4844410">v</span><span class="op" id="4844411">,</span>&nbsp;<span class="string" id="4844413">&#34;:&#34;</span><span class="op" id="4844416">)</span>&nbsp;<span class="op" id="4844418">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844422">return</span>&nbsp;<span class="builtintype" id="4844429">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844438">return</span>&nbsp;<span class="builtintype" id="4844445">false</span><br>
<span class="lineno"></span><span class="op" id="4844451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="comment" id="4844454">//&nbsp;isCookieDomainName&nbsp;returns&nbsp;whether&nbsp;s&nbsp;is&nbsp;a&nbsp;valid&nbsp;domain&nbsp;name&nbsp;or&nbsp;a&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="4844528">//&nbsp;domain&nbsp;name&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot&nbsp;&#39;.&#39;.&nbsp;&nbsp;It&nbsp;is&nbsp;almost&nbsp;a&nbsp;direct&nbsp;copy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4844598">//&nbsp;package&nbsp;net&#39;s&nbsp;isDomainName.</span><br>
<span class="lineno"></span><span class="keyword" id="4844629">func</span>&nbsp;<span class="ident" id="4844634">isCookieDomainName</span><span class="op" id="4844652">(</span><span class="ident" id="4844653">s</span>&nbsp;<span class="builtintype" id="4844655">string</span><span class="op" id="4844661">)</span>&nbsp;<span class="builtintype" id="4844663">bool</span>&nbsp;<span class="op" id="4844668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844671">if</span>&nbsp;<span class="builtinfunc" id="4844674">len</span><span class="op" id="4844677">(</span><span class="ident" id="4844678">s</span><span class="op" id="4844679">)</span>&nbsp;<span class="op" id="4844681">==</span>&nbsp;<span class="num" id="4844684">0</span>&nbsp;<span class="op" id="4844686">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844690">return</span>&nbsp;<span class="builtintype" id="4844697">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844707">if</span>&nbsp;<span class="builtinfunc" id="4844710">len</span><span class="op" id="4844713">(</span><span class="ident" id="4844714">s</span><span class="op" id="4844715">)</span>&nbsp;<span class="op" id="4844717">&gt;</span>&nbsp;<span class="num" id="4844719">255</span>&nbsp;<span class="op" id="4844723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844727">return</span>&nbsp;<span class="builtintype" id="4844734">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844741">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844745">if</span>&nbsp;<span class="ident" id="4844748">s</span><span class="op" id="4844749">[</span><span class="num" id="4844750">0</span><span class="op" id="4844751">]</span>&nbsp;<span class="op" id="4844753">==</span>&nbsp;<span class="string" id="4844756">&#39;.&#39;</span>&nbsp;<span class="op" id="4844760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4844764">//&nbsp;A&nbsp;cookie&nbsp;a&nbsp;domain&nbsp;attribute&nbsp;may&nbsp;start&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844827">s</span>&nbsp;<span class="op" id="4844829">=</span>&nbsp;<span class="ident" id="4844831">s</span><span class="op" id="4844832">[</span><span class="num" id="4844833">1</span><span class="op" id="4844834">:</span><span class="op" id="4844835">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844838">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844841">last</span>&nbsp;<span class="op" id="4844846">:=</span>&nbsp;<span class="builtintype" id="4844849">byte</span><span class="op" id="4844853">(</span><span class="string" id="4844854">&#39;.&#39;</span><span class="op" id="4844857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844860">ok</span>&nbsp;<span class="op" id="4844863">:=</span>&nbsp;<span class="builtintype" id="4844866">false</span>&nbsp;<span class="comment" id="4844872">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844905">partlen</span>&nbsp;<span class="op" id="4844913">:=</span>&nbsp;<span class="num" id="4844916">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844919">for</span>&nbsp;<span class="ident" id="4844923">i</span>&nbsp;<span class="op" id="4844925">:=</span>&nbsp;<span class="num" id="4844928">0</span><span class="op" id="4844929">;</span>&nbsp;<span class="ident" id="4844931">i</span>&nbsp;<span class="op" id="4844933">&lt;</span>&nbsp;<span class="builtinfunc" id="4844935">len</span><span class="op" id="4844938">(</span><span class="ident" id="4844939">s</span><span class="op" id="4844940">)</span><span class="op" id="4844941">;</span>&nbsp;<span class="ident" id="4844943">i</span><span class="op" id="4844944">++</span>&nbsp;<span class="op" id="4844947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844951">c</span>&nbsp;<span class="op" id="4844953">:=</span>&nbsp;<span class="ident" id="4844956">s</span><span class="op" id="4844957">[</span><span class="ident" id="4844958">i</span><span class="op" id="4844959">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844963">switch</span>&nbsp;<span class="op" id="4844970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844974">default</span><span class="op" id="4844981">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844986">return</span>&nbsp;<span class="builtintype" id="4844993">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845001">case</span>&nbsp;<span class="string" id="4845006">&#39;a&#39;</span>&nbsp;<span class="op" id="4845010">&lt;=</span>&nbsp;<span class="ident" id="4845013">c</span>&nbsp;<span class="op" id="4845015">&amp;&amp;</span>&nbsp;<span class="ident" id="4845018">c</span>&nbsp;<span class="op" id="4845020">&lt;=</span>&nbsp;<span class="string" id="4845023">&#39;z&#39;</span>&nbsp;<span class="op" id="4845027">||</span>&nbsp;<span class="string" id="4845030">&#39;A&#39;</span>&nbsp;<span class="op" id="4845034">&lt;=</span>&nbsp;<span class="ident" id="4845037">c</span>&nbsp;<span class="op" id="4845039">&amp;&amp;</span>&nbsp;<span class="ident" id="4845042">c</span>&nbsp;<span class="op" id="4845044">&lt;=</span>&nbsp;<span class="string" id="4845047">&#39;Z&#39;</span><span class="op" id="4845050">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4845055">//&nbsp;No&nbsp;&#39;_&#39;&nbsp;allowed&nbsp;here&nbsp;(in&nbsp;contrast&nbsp;to&nbsp;package&nbsp;net).</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845111">ok</span>&nbsp;<span class="op" id="4845114">=</span>&nbsp;<span class="builtintype" id="4845116">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845124">partlen</span><span class="op" id="4845131">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845136">case</span>&nbsp;<span class="string" id="4845141">&#39;0&#39;</span>&nbsp;<span class="op" id="4845145">&lt;=</span>&nbsp;<span class="ident" id="4845148">c</span>&nbsp;<span class="op" id="4845150">&amp;&amp;</span>&nbsp;<span class="ident" id="4845153">c</span>&nbsp;<span class="op" id="4845155">&lt;=</span>&nbsp;<span class="string" id="4845158">&#39;9&#39;</span><span class="op" id="4845161">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4845166">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845177">partlen</span><span class="op" id="4845184">++</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845189">case</span>&nbsp;<span class="ident" id="4845194">c</span>&nbsp;<span class="op" id="4845196">==</span>&nbsp;<span class="string" id="4845199">&#39;-&#39;</span><span class="op" id="4845202">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4845207">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845245">if</span>&nbsp;<span class="ident" id="4845248">last</span>&nbsp;<span class="op" id="4845253">==</span>&nbsp;<span class="string" id="4845256">&#39;.&#39;</span>&nbsp;<span class="op" id="4845260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845266">return</span>&nbsp;<span class="builtintype" id="4845273">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845282">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845287">partlen</span><span class="op" id="4845294">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845299">case</span>&nbsp;<span class="ident" id="4845304">c</span>&nbsp;<span class="op" id="4845306">==</span>&nbsp;<span class="string" id="4845309">&#39;.&#39;</span><span class="op" id="4845312">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4845317">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845360">if</span>&nbsp;<span class="ident" id="4845363">last</span>&nbsp;<span class="op" id="4845368">==</span>&nbsp;<span class="string" id="4845371">&#39;.&#39;</span>&nbsp;<span class="op" id="4845375">||</span>&nbsp;<span class="ident" id="4845378">last</span>&nbsp;<span class="op" id="4845383">==</span>&nbsp;<span class="string" id="4845386">&#39;-&#39;</span>&nbsp;<span class="op" id="4845390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845396">return</span>&nbsp;<span class="builtintype" id="4845403">false</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845417">if</span>&nbsp;<span class="ident" id="4845420">partlen</span>&nbsp;<span class="op" id="4845428">&gt;</span>&nbsp;<span class="num" id="4845430">63</span>&nbsp;<span class="op" id="4845433">||</span>&nbsp;<span class="ident" id="4845436">partlen</span>&nbsp;<span class="op" id="4845444">==</span>&nbsp;<span class="num" id="4845447">0</span>&nbsp;<span class="op" id="4845449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845455">return</span>&nbsp;<span class="builtintype" id="4845462">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845476">partlen</span>&nbsp;<span class="op" id="4845484">=</span>&nbsp;<span class="num" id="4845486">0</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845494">last</span>&nbsp;<span class="op" id="4845499">=</span>&nbsp;<span class="ident" id="4845501">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845507">if</span>&nbsp;<span class="ident" id="4845510">last</span>&nbsp;<span class="op" id="4845515">==</span>&nbsp;<span class="string" id="4845518">&#39;-&#39;</span>&nbsp;<span class="op" id="4845522">||</span>&nbsp;<span class="ident" id="4845525">partlen</span>&nbsp;<span class="op" id="4845533">&gt;</span>&nbsp;<span class="num" id="4845535">63</span>&nbsp;<span class="op" id="4845538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845542">return</span>&nbsp;<span class="builtintype" id="4845549">false</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845560">return</span>&nbsp;<span class="ident" id="4845567">ok</span><br>
<span class="lineno"></span><span class="op" id="4845570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="4845573">var</span>&nbsp;<span class="ident" id="4845577">cookieNameSanitizer</span>&nbsp;<span class="op" id="4845597">=</span>&nbsp;<span class="ident" id="4845599">strings</span><span class="op" id="4845606">.</span><span class="ident" id="4845607">NewReplacer</span><span class="op" id="4845618">(</span><span class="string" id="4845619">&#34;\n&#34;</span><span class="op" id="4845623">,</span>&nbsp;<span class="string" id="4845625">&#34;-&#34;</span><span class="op" id="4845628">,</span>&nbsp;<span class="string" id="4845630">&#34;\r&#34;</span><span class="op" id="4845634">,</span>&nbsp;<span class="string" id="4845636">&#34;-&#34;</span><span class="op" id="4845639">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4845642">func</span>&nbsp;<span class="ident" id="4845647">sanitizeCookieName</span><span class="op" id="4845665">(</span><span class="ident" id="4845666">n</span>&nbsp;<span class="builtintype" id="4845668">string</span><span class="op" id="4845674">)</span>&nbsp;<span class="builtintype" id="4845676">string</span>&nbsp;<span class="op" id="4845683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845686">return</span>&nbsp;<span class="ident" id="4845693">cookieNameSanitizer</span><span class="op" id="4845712">.</span><span class="ident" id="4845713">Replace</span><span class="op" id="4845720">(</span><span class="ident" id="4845721">n</span><span class="op" id="4845722">)</span><br>
<span class="lineno"></span><span class="op" id="4845724">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="4845727">//&nbsp;http://tools.ietf.org/html/rfc6265#section-4.1.1</span><br>
<span class="lineno"></span><span class="comment" id="4845779">//&nbsp;cookie-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;*cookie-octet&nbsp;/&nbsp;(&nbsp;DQUOTE&nbsp;*cookie-octet&nbsp;DQUOTE&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="4845850">//&nbsp;cookie-octet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;%x21&nbsp;/&nbsp;%x23-2B&nbsp;/&nbsp;%x2D-3A&nbsp;/&nbsp;%x3C-5B&nbsp;/&nbsp;%x5D-7E</span><br>
<span class="lineno"></span><span class="comment" id="4845918">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;US-ASCII&nbsp;characters&nbsp;excluding&nbsp;CTLs,</span><br>
<span class="lineno">295</span><span class="comment" id="4845969">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;whitespace&nbsp;DQUOTE,&nbsp;comma,&nbsp;semicolon,</span><br>
<span class="lineno"></span><span class="comment" id="4846021">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;and&nbsp;backslash</span><br>
<span class="lineno"></span><span class="comment" id="4846050">//&nbsp;We&nbsp;loosen&nbsp;this&nbsp;as&nbsp;spaces&nbsp;and&nbsp;commas&nbsp;are&nbsp;common&nbsp;in&nbsp;cookie&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="4846117">//&nbsp;but&nbsp;we&nbsp;produce&nbsp;a&nbsp;quoted&nbsp;cookie-value&nbsp;in&nbsp;when&nbsp;value&nbsp;starts&nbsp;or&nbsp;ends</span><br>
<span class="lineno"></span><span class="comment" id="4846186">//&nbsp;with&nbsp;a&nbsp;comma&nbsp;or&nbsp;space.</span><br>
<span class="lineno">300</span><span class="comment" id="4846212">//&nbsp;See&nbsp;http://golang.org/issue/7243&nbsp;for&nbsp;the&nbsp;discussion.</span><br>
<span class="lineno"></span><span class="keyword" id="4846268">func</span>&nbsp;<span class="ident" id="4846273">sanitizeCookieValue</span><span class="op" id="4846292">(</span><span class="ident" id="4846293">v</span>&nbsp;<span class="builtintype" id="4846295">string</span><span class="op" id="4846301">)</span>&nbsp;<span class="builtintype" id="4846303">string</span>&nbsp;<span class="op" id="4846310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846313">v</span>&nbsp;<span class="op" id="4846315">=</span>&nbsp;<span class="ident" id="4846317">sanitizeOrWarn</span><span class="op" id="4846331">(</span><span class="string" id="4846332">&#34;Cookie.Value&#34;</span><span class="op" id="4846346">,</span>&nbsp;<span class="ident" id="4846348">validCookieValueByte</span><span class="op" id="4846368">,</span>&nbsp;<span class="ident" id="4846370">v</span><span class="op" id="4846371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846374">if</span>&nbsp;<span class="builtinfunc" id="4846377">len</span><span class="op" id="4846380">(</span><span class="ident" id="4846381">v</span><span class="op" id="4846382">)</span>&nbsp;<span class="op" id="4846384">==</span>&nbsp;<span class="num" id="4846387">0</span>&nbsp;<span class="op" id="4846389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846393">return</span>&nbsp;<span class="ident" id="4846400">v</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846406">if</span>&nbsp;<span class="ident" id="4846409">v</span><span class="op" id="4846410">[</span><span class="num" id="4846411">0</span><span class="op" id="4846412">]</span>&nbsp;<span class="op" id="4846414">==</span>&nbsp;<span class="string" id="4846417">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4846421">||</span>&nbsp;<span class="ident" id="4846424">v</span><span class="op" id="4846425">[</span><span class="num" id="4846426">0</span><span class="op" id="4846427">]</span>&nbsp;<span class="op" id="4846429">==</span>&nbsp;<span class="string" id="4846432">&#39;,&#39;</span>&nbsp;<span class="op" id="4846436">||</span>&nbsp;<span class="ident" id="4846439">v</span><span class="op" id="4846440">[</span><span class="builtinfunc" id="4846441">len</span><span class="op" id="4846444">(</span><span class="ident" id="4846445">v</span><span class="op" id="4846446">)</span><span class="op" id="4846447">-</span><span class="num" id="4846448">1</span><span class="op" id="4846449">]</span>&nbsp;<span class="op" id="4846451">==</span>&nbsp;<span class="string" id="4846454">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4846458">||</span>&nbsp;<span class="ident" id="4846461">v</span><span class="op" id="4846462">[</span><span class="builtinfunc" id="4846463">len</span><span class="op" id="4846466">(</span><span class="ident" id="4846467">v</span><span class="op" id="4846468">)</span><span class="op" id="4846469">-</span><span class="num" id="4846470">1</span><span class="op" id="4846471">]</span>&nbsp;<span class="op" id="4846473">==</span>&nbsp;<span class="string" id="4846476">&#39;,&#39;</span>&nbsp;<span class="op" id="4846480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846484">return</span>&nbsp;<span class="string" id="4846491">`&#34;`</span>&nbsp;<span class="op" id="4846495">+</span>&nbsp;<span class="ident" id="4846497">v</span>&nbsp;<span class="op" id="4846499">+</span>&nbsp;<span class="string" id="4846501">`&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846509">return</span>&nbsp;<span class="ident" id="4846516">v</span><br>
<span class="lineno">310</span><span class="op" id="4846518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4846521">func</span>&nbsp;<span class="ident" id="4846526">validCookieValueByte</span><span class="op" id="4846546">(</span><span class="ident" id="4846547">b</span>&nbsp;<span class="builtintype" id="4846549">byte</span><span class="op" id="4846553">)</span>&nbsp;<span class="builtintype" id="4846555">bool</span>&nbsp;<span class="op" id="4846560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846563">return</span>&nbsp;<span class="num" id="4846570">0x20</span>&nbsp;<span class="op" id="4846575">&lt;=</span>&nbsp;<span class="ident" id="4846578">b</span>&nbsp;<span class="op" id="4846580">&amp;&amp;</span>&nbsp;<span class="ident" id="4846583">b</span>&nbsp;<span class="op" id="4846585">&lt;</span>&nbsp;<span class="num" id="4846587">0x7f</span>&nbsp;<span class="op" id="4846592">&amp;&amp;</span>&nbsp;<span class="ident" id="4846595">b</span>&nbsp;<span class="op" id="4846597">!=</span>&nbsp;<span class="string" id="4846600">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4846604">&amp;&amp;</span>&nbsp;<span class="ident" id="4846607">b</span>&nbsp;<span class="op" id="4846609">!=</span>&nbsp;<span class="string" id="4846612">&#39;;&#39;</span>&nbsp;<span class="op" id="4846616">&amp;&amp;</span>&nbsp;<span class="ident" id="4846619">b</span>&nbsp;<span class="op" id="4846621">!=</span>&nbsp;<span class="string" id="4846624">&#39;\\&#39;</span><br>
<span class="lineno"></span><span class="op" id="4846629">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="4846632">//&nbsp;path-av&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&#34;Path=&#34;&nbsp;path-value</span><br>
<span class="lineno"></span><span class="comment" id="4846674">//&nbsp;path-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;any&nbsp;CHAR&nbsp;except&nbsp;CTLs&nbsp;or&nbsp;&#34;;&#34;&gt;</span><br>
<span class="lineno"></span><span class="keyword" id="4846727">func</span>&nbsp;<span class="ident" id="4846732">sanitizeCookiePath</span><span class="op" id="4846750">(</span><span class="ident" id="4846751">v</span>&nbsp;<span class="builtintype" id="4846753">string</span><span class="op" id="4846759">)</span>&nbsp;<span class="builtintype" id="4846761">string</span>&nbsp;<span class="op" id="4846768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846771">return</span>&nbsp;<span class="ident" id="4846778">sanitizeOrWarn</span><span class="op" id="4846792">(</span><span class="string" id="4846793">&#34;Cookie.Path&#34;</span><span class="op" id="4846806">,</span>&nbsp;<span class="ident" id="4846808">validCookiePathByte</span><span class="op" id="4846827">,</span>&nbsp;<span class="ident" id="4846829">v</span><span class="op" id="4846830">)</span><br>
<span class="lineno">320</span><span class="op" id="4846832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4846835">func</span>&nbsp;<span class="ident" id="4846840">validCookiePathByte</span><span class="op" id="4846859">(</span><span class="ident" id="4846860">b</span>&nbsp;<span class="builtintype" id="4846862">byte</span><span class="op" id="4846866">)</span>&nbsp;<span class="builtintype" id="4846868">bool</span>&nbsp;<span class="op" id="4846873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846876">return</span>&nbsp;<span class="num" id="4846883">0x20</span>&nbsp;<span class="op" id="4846888">&lt;=</span>&nbsp;<span class="ident" id="4846891">b</span>&nbsp;<span class="op" id="4846893">&amp;&amp;</span>&nbsp;<span class="ident" id="4846896">b</span>&nbsp;<span class="op" id="4846898">&lt;</span>&nbsp;<span class="num" id="4846900">0x7f</span>&nbsp;<span class="op" id="4846905">&amp;&amp;</span>&nbsp;<span class="ident" id="4846908">b</span>&nbsp;<span class="op" id="4846910">!=</span>&nbsp;<span class="string" id="4846913">&#39;;&#39;</span><br>
<span class="lineno"></span><span class="op" id="4846917">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="4846920">func</span>&nbsp;<span class="ident" id="4846925">sanitizeOrWarn</span><span class="op" id="4846939">(</span><span class="ident" id="4846940">fieldName</span>&nbsp;<span class="builtintype" id="4846950">string</span><span class="op" id="4846956">,</span>&nbsp;<span class="ident" id="4846958">valid</span>&nbsp;<span class="keyword" id="4846964">func</span><span class="op" id="4846968">(</span><span class="builtintype" id="4846969">byte</span><span class="op" id="4846973">)</span>&nbsp;<span class="builtintype" id="4846975">bool</span><span class="op" id="4846979">,</span>&nbsp;<span class="ident" id="4846981">v</span>&nbsp;<span class="builtintype" id="4846983">string</span><span class="op" id="4846989">)</span>&nbsp;<span class="builtintype" id="4846991">string</span>&nbsp;<span class="op" id="4846998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847001">ok</span>&nbsp;<span class="op" id="4847004">:=</span>&nbsp;<span class="builtintype" id="4847007">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847013">for</span>&nbsp;<span class="ident" id="4847017">i</span>&nbsp;<span class="op" id="4847019">:=</span>&nbsp;<span class="num" id="4847022">0</span><span class="op" id="4847023">;</span>&nbsp;<span class="ident" id="4847025">i</span>&nbsp;<span class="op" id="4847027">&lt;</span>&nbsp;<span class="builtinfunc" id="4847029">len</span><span class="op" id="4847032">(</span><span class="ident" id="4847033">v</span><span class="op" id="4847034">)</span><span class="op" id="4847035">;</span>&nbsp;<span class="ident" id="4847037">i</span><span class="op" id="4847038">++</span>&nbsp;<span class="op" id="4847041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847045">if</span>&nbsp;<span class="ident" id="4847048">valid</span><span class="op" id="4847053">(</span><span class="ident" id="4847054">v</span><span class="op" id="4847055">[</span><span class="ident" id="4847056">i</span><span class="op" id="4847057">]</span><span class="op" id="4847058">)</span>&nbsp;<span class="op" id="4847060">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847065">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847080">log</span><span class="op" id="4847083">.</span><span class="ident" id="4847084">Printf</span><span class="op" id="4847090">(</span><span class="string" id="4847091">&#34;net/http:&nbsp;invalid&nbsp;byte&nbsp;%q&nbsp;in&nbsp;%s;&nbsp;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="4847148">,</span>&nbsp;<span class="ident" id="4847150">v</span><span class="op" id="4847151">[</span><span class="ident" id="4847152">i</span><span class="op" id="4847153">]</span><span class="op" id="4847154">,</span>&nbsp;<span class="ident" id="4847156">fieldName</span><span class="op" id="4847165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847169">ok</span>&nbsp;<span class="op" id="4847172">=</span>&nbsp;<span class="builtintype" id="4847174">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847182">break</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847192">if</span>&nbsp;<span class="ident" id="4847195">ok</span>&nbsp;<span class="op" id="4847198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847202">return</span>&nbsp;<span class="ident" id="4847209">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847215">buf</span>&nbsp;<span class="op" id="4847219">:=</span>&nbsp;<span class="builtinfunc" id="4847222">make</span><span class="op" id="4847226">(</span><span class="op" id="4847227">[</span><span class="op" id="4847228">]</span><span class="builtintype" id="4847229">byte</span><span class="op" id="4847233">,</span>&nbsp;<span class="num" id="4847235">0</span><span class="op" id="4847236">,</span>&nbsp;<span class="builtinfunc" id="4847238">len</span><span class="op" id="4847241">(</span><span class="ident" id="4847242">v</span><span class="op" id="4847243">)</span><span class="op" id="4847244">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847247">for</span>&nbsp;<span class="ident" id="4847251">i</span>&nbsp;<span class="op" id="4847253">:=</span>&nbsp;<span class="num" id="4847256">0</span><span class="op" id="4847257">;</span>&nbsp;<span class="ident" id="4847259">i</span>&nbsp;<span class="op" id="4847261">&lt;</span>&nbsp;<span class="builtinfunc" id="4847263">len</span><span class="op" id="4847266">(</span><span class="ident" id="4847267">v</span><span class="op" id="4847268">)</span><span class="op" id="4847269">;</span>&nbsp;<span class="ident" id="4847271">i</span><span class="op" id="4847272">++</span>&nbsp;<span class="op" id="4847275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847279">if</span>&nbsp;<span class="ident" id="4847282">b</span>&nbsp;<span class="op" id="4847284">:=</span>&nbsp;<span class="ident" id="4847287">v</span><span class="op" id="4847288">[</span><span class="ident" id="4847289">i</span><span class="op" id="4847290">]</span><span class="op" id="4847291">;</span>&nbsp;<span class="ident" id="4847293">valid</span><span class="op" id="4847298">(</span><span class="ident" id="4847299">b</span><span class="op" id="4847300">)</span>&nbsp;<span class="op" id="4847302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847307">buf</span>&nbsp;<span class="op" id="4847311">=</span>&nbsp;<span class="builtinfunc" id="4847313">append</span><span class="op" id="4847319">(</span><span class="ident" id="4847320">buf</span><span class="op" id="4847323">,</span>&nbsp;<span class="ident" id="4847325">b</span><span class="op" id="4847326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847333">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847336">return</span>&nbsp;<span class="builtintype" id="4847343">string</span><span class="op" id="4847349">(</span><span class="ident" id="4847350">buf</span><span class="op" id="4847353">)</span><br>
<span class="lineno"></span><span class="op" id="4847355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4847358">func</span>&nbsp;<span class="ident" id="4847363">parseCookieValue</span><span class="op" id="4847379">(</span><span class="ident" id="4847380">raw</span>&nbsp;<span class="builtintype" id="4847384">string</span><span class="op" id="4847390">,</span>&nbsp;<span class="ident" id="4847392">allowDoubleQuote</span>&nbsp;<span class="builtintype" id="4847409">bool</span><span class="op" id="4847413">)</span>&nbsp;<span class="op" id="4847415">(</span><span class="builtintype" id="4847416">string</span><span class="op" id="4847422">,</span>&nbsp;<span class="builtintype" id="4847424">bool</span><span class="op" id="4847428">)</span>&nbsp;<span class="op" id="4847430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4847433">//&nbsp;Strip&nbsp;the&nbsp;quotes,&nbsp;if&nbsp;present.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847467">if</span>&nbsp;<span class="ident" id="4847470">allowDoubleQuote</span>&nbsp;<span class="op" id="4847487">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4847490">len</span><span class="op" id="4847493">(</span><span class="ident" id="4847494">raw</span><span class="op" id="4847497">)</span>&nbsp;<span class="op" id="4847499">&gt;</span>&nbsp;<span class="num" id="4847501">1</span>&nbsp;<span class="op" id="4847503">&amp;&amp;</span>&nbsp;<span class="ident" id="4847506">raw</span><span class="op" id="4847509">[</span><span class="num" id="4847510">0</span><span class="op" id="4847511">]</span>&nbsp;<span class="op" id="4847513">==</span>&nbsp;<span class="string" id="4847516">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4847520">&amp;&amp;</span>&nbsp;<span class="ident" id="4847523">raw</span><span class="op" id="4847526">[</span><span class="builtinfunc" id="4847527">len</span><span class="op" id="4847530">(</span><span class="ident" id="4847531">raw</span><span class="op" id="4847534">)</span><span class="op" id="4847535">-</span><span class="num" id="4847536">1</span><span class="op" id="4847537">]</span>&nbsp;<span class="op" id="4847539">==</span>&nbsp;<span class="string" id="4847542">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4847546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847550">raw</span>&nbsp;<span class="op" id="4847554">=</span>&nbsp;<span class="ident" id="4847556">raw</span><span class="op" id="4847559">[</span><span class="num" id="4847560">1</span>&nbsp;<span class="op" id="4847562">:</span>&nbsp;<span class="builtinfunc" id="4847564">len</span><span class="op" id="4847567">(</span><span class="ident" id="4847568">raw</span><span class="op" id="4847571">)</span><span class="op" id="4847572">-</span><span class="num" id="4847573">1</span><span class="op" id="4847574">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847580">for</span>&nbsp;<span class="ident" id="4847584">i</span>&nbsp;<span class="op" id="4847586">:=</span>&nbsp;<span class="num" id="4847589">0</span><span class="op" id="4847590">;</span>&nbsp;<span class="ident" id="4847592">i</span>&nbsp;<span class="op" id="4847594">&lt;</span>&nbsp;<span class="builtinfunc" id="4847596">len</span><span class="op" id="4847599">(</span><span class="ident" id="4847600">raw</span><span class="op" id="4847603">)</span><span class="op" id="4847604">;</span>&nbsp;<span class="ident" id="4847606">i</span><span class="op" id="4847607">++</span>&nbsp;<span class="op" id="4847610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847614">if</span>&nbsp;<span class="op" id="4847617">!</span><span class="ident" id="4847618">validCookieValueByte</span><span class="op" id="4847638">(</span><span class="ident" id="4847639">raw</span><span class="op" id="4847642">[</span><span class="ident" id="4847643">i</span><span class="op" id="4847644">]</span><span class="op" id="4847645">)</span>&nbsp;<span class="op" id="4847647">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847652">return</span>&nbsp;<span class="string" id="4847659">&#34;&#34;</span><span class="op" id="4847661">,</span>&nbsp;<span class="builtintype" id="4847663">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847677">return</span>&nbsp;<span class="ident" id="4847684">raw</span><span class="op" id="4847687">,</span>&nbsp;<span class="builtintype" id="4847689">true</span><br>
<span class="lineno"></span><span class="op" id="4847694">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="4847697">func</span>&nbsp;<span class="ident" id="4847702">isCookieNameValid</span><span class="op" id="4847719">(</span><span class="ident" id="4847720">raw</span>&nbsp;<span class="builtintype" id="4847724">string</span><span class="op" id="4847730">)</span>&nbsp;<span class="builtintype" id="4847732">bool</span>&nbsp;<span class="op" id="4847737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847740">return</span>&nbsp;<span class="ident" id="4847747">strings</span><span class="op" id="4847754">.</span><span class="ident" id="4847755">IndexFunc</span><span class="op" id="4847764">(</span><span class="ident" id="4847765">raw</span><span class="op" id="4847768">,</span>&nbsp;<span class="ident" id="4847770">isNotToken</span><span class="op" id="4847780">)</span>&nbsp;<span class="op" id="4847782">&lt;</span>&nbsp;<span class="num" id="4847784">0</span><br>
<span class="lineno"></span><span class="op" id="4847786">}</span>
</div>
</body>
</html>
