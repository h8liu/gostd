<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>bytes</h2>
<ul>
<li><a href="/gostd/bytes/buffer.go.html">buffer.go</a></li>
<li><a href="/gostd/bytes/buffer_test.go.html">buffer_test.go</a></li>
<li><a href="/gostd/bytes/bytes.go.html" class="current">bytes.go</a></li>
<li><a href="/gostd/bytes/bytes_decl.go.html">bytes_decl.go</a></li>
<li><a href="/gostd/bytes/bytes_test.go.html">bytes_test.go</a></li>
<li><a href="/gostd/bytes/compare_test.go.html">compare_test.go</a></li>
<li><a href="/gostd/bytes/equal_test.go.html">equal_test.go</a></li>
<li><a href="/gostd/bytes/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/bytes/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/bytes/reader.go.html">reader.go</a></li>
<li><a href="/gostd/bytes/reader_test.go.html">reader_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1355369">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1355424">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1355478">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1355529">//&nbsp;Package&nbsp;bytes&nbsp;implements&nbsp;functions&nbsp;for&nbsp;the&nbsp;manipulation&nbsp;of&nbsp;byte&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="1355604">//&nbsp;It&nbsp;is&nbsp;analogous&nbsp;to&nbsp;the&nbsp;facilities&nbsp;of&nbsp;the&nbsp;strings&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="1355665">package</span>&nbsp;<span class="ident" id="1355673">bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1355680">import</span>&nbsp;<span class="op" id="1355687">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1355690">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1355701">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="1355716">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1355719">func</span>&nbsp;<span class="ident" id="1355724">equalPortable</span><span class="op" id="1355737">(</span><span class="ident" id="1355738">a</span><span class="op" id="1355739">,</span>&nbsp;<span class="ident" id="1355741">b</span>&nbsp;<span class="op" id="1355743">[</span><span class="op" id="1355744">]</span><span class="builtintype" id="1355745">byte</span><span class="op" id="1355749">)</span>&nbsp;<span class="builtintype" id="1355751">bool</span>&nbsp;<span class="op" id="1355756">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1355759">if</span>&nbsp;<span class="builtinfunc" id="1355762">len</span><span class="op" id="1355765">(</span><span class="ident" id="1355766">a</span><span class="op" id="1355767">)</span>&nbsp;<span class="op" id="1355769">!=</span>&nbsp;<span class="builtinfunc" id="1355772">len</span><span class="op" id="1355775">(</span><span class="ident" id="1355776">b</span><span class="op" id="1355777">)</span>&nbsp;<span class="op" id="1355779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1355783">return</span>&nbsp;<span class="builtintype" id="1355790">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1355797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1355800">for</span>&nbsp;<span class="ident" id="1355804">i</span><span class="op" id="1355805">,</span>&nbsp;<span class="ident" id="1355807">c</span>&nbsp;<span class="op" id="1355809">:=</span>&nbsp;<span class="keyword" id="1355812">range</span>&nbsp;<span class="ident" id="1355818">a</span>&nbsp;<span class="op" id="1355820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1355824">if</span>&nbsp;<span class="ident" id="1355827">c</span>&nbsp;<span class="op" id="1355829">!=</span>&nbsp;<span class="ident" id="1355832">b</span><span class="op" id="1355833">[</span><span class="ident" id="1355834">i</span><span class="op" id="1355835">]</span>&nbsp;<span class="op" id="1355837">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1355842">return</span>&nbsp;<span class="builtintype" id="1355849">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1355857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1355860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1355863">return</span>&nbsp;<span class="builtintype" id="1355870">true</span><br>
<span class="lineno"></span><span class="op" id="1355875">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1355878">//&nbsp;explode&nbsp;splits&nbsp;s&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;UTF-8&nbsp;sequences,&nbsp;one&nbsp;per&nbsp;Unicode&nbsp;character&nbsp;(still&nbsp;slices&nbsp;of&nbsp;bytes),</span><br>
<span class="lineno"></span><span class="comment" id="1355982">//&nbsp;up&nbsp;to&nbsp;a&nbsp;maximum&nbsp;of&nbsp;n&nbsp;byte&nbsp;slices.&nbsp;Invalid&nbsp;UTF-8&nbsp;sequences&nbsp;are&nbsp;chopped&nbsp;into&nbsp;individual&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="1356078">func</span>&nbsp;<span class="ident" id="1356083">explode</span><span class="op" id="1356090">(</span><span class="ident" id="1356091">s</span>&nbsp;<span class="op" id="1356093">[</span><span class="op" id="1356094">]</span><span class="builtintype" id="1356095">byte</span><span class="op" id="1356099">,</span>&nbsp;<span class="ident" id="1356101">n</span>&nbsp;<span class="builtintype" id="1356103">int</span><span class="op" id="1356106">)</span>&nbsp;<span class="op" id="1356108">[</span><span class="op" id="1356109">]</span><span class="op" id="1356110">[</span><span class="op" id="1356111">]</span><span class="builtintype" id="1356112">byte</span>&nbsp;<span class="op" id="1356117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356120">if</span>&nbsp;<span class="ident" id="1356123">n</span>&nbsp;<span class="op" id="1356125">&lt;=</span>&nbsp;<span class="num" id="1356128">0</span>&nbsp;<span class="op" id="1356130">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356134">n</span>&nbsp;<span class="op" id="1356136">=</span>&nbsp;<span class="builtinfunc" id="1356138">len</span><span class="op" id="1356141">(</span><span class="ident" id="1356142">s</span><span class="op" id="1356143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1356146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356149">a</span>&nbsp;<span class="op" id="1356151">:=</span>&nbsp;<span class="builtinfunc" id="1356154">make</span><span class="op" id="1356158">(</span><span class="op" id="1356159">[</span><span class="op" id="1356160">]</span><span class="op" id="1356161">[</span><span class="op" id="1356162">]</span><span class="builtintype" id="1356163">byte</span><span class="op" id="1356167">,</span>&nbsp;<span class="ident" id="1356169">n</span><span class="op" id="1356170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356173">var</span>&nbsp;<span class="ident" id="1356177">size</span>&nbsp;<span class="builtintype" id="1356182">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356187">na</span>&nbsp;<span class="op" id="1356190">:=</span>&nbsp;<span class="num" id="1356193">0</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356196">for</span>&nbsp;<span class="builtinfunc" id="1356200">len</span><span class="op" id="1356203">(</span><span class="ident" id="1356204">s</span><span class="op" id="1356205">)</span>&nbsp;<span class="op" id="1356207">&gt;</span>&nbsp;<span class="num" id="1356209">0</span>&nbsp;<span class="op" id="1356211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356215">if</span>&nbsp;<span class="ident" id="1356218">na</span><span class="op" id="1356220">+</span><span class="num" id="1356221">1</span>&nbsp;<span class="op" id="1356223">&gt;=</span>&nbsp;<span class="ident" id="1356226">n</span>&nbsp;<span class="op" id="1356228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356233">a</span><span class="op" id="1356234">[</span><span class="ident" id="1356235">na</span><span class="op" id="1356237">]</span>&nbsp;<span class="op" id="1356239">=</span>&nbsp;<span class="ident" id="1356241">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356246">na</span><span class="op" id="1356248">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356254">break</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1356262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356266">_</span><span class="op" id="1356267">,</span>&nbsp;<span class="ident" id="1356269">size</span>&nbsp;<span class="op" id="1356274">=</span>&nbsp;<span class="ident" id="1356276">utf8</span><span class="op" id="1356280">.</span><span class="ident" id="1356281">DecodeRune</span><span class="op" id="1356291">(</span><span class="ident" id="1356292">s</span><span class="op" id="1356293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356297">a</span><span class="op" id="1356298">[</span><span class="ident" id="1356299">na</span><span class="op" id="1356301">]</span>&nbsp;<span class="op" id="1356303">=</span>&nbsp;<span class="ident" id="1356305">s</span><span class="op" id="1356306">[</span><span class="num" id="1356307">0</span><span class="op" id="1356308">:</span><span class="ident" id="1356309">size</span><span class="op" id="1356313">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356317">s</span>&nbsp;<span class="op" id="1356319">=</span>&nbsp;<span class="ident" id="1356321">s</span><span class="op" id="1356322">[</span><span class="ident" id="1356323">size</span><span class="op" id="1356327">:</span><span class="op" id="1356328">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356332">na</span><span class="op" id="1356334">++</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1356338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356341">return</span>&nbsp;<span class="ident" id="1356348">a</span><span class="op" id="1356349">[</span><span class="num" id="1356350">0</span><span class="op" id="1356351">:</span><span class="ident" id="1356352">na</span><span class="op" id="1356354">]</span><br>
<span class="lineno"></span><span class="op" id="1356356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1356359">//&nbsp;Count&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;non-overlapping&nbsp;instances&nbsp;of&nbsp;sep&nbsp;in&nbsp;s.</span><br>
<span class="lineno">50</span><span class="keyword" id="1356428">func</span>&nbsp;<span class="ident" id="1356433">Count</span><span class="op" id="1356438">(</span><span class="ident" id="1356439">s</span><span class="op" id="1356440">,</span>&nbsp;<span class="ident" id="1356442">sep</span>&nbsp;<span class="op" id="1356446">[</span><span class="op" id="1356447">]</span><span class="builtintype" id="1356448">byte</span><span class="op" id="1356452">)</span>&nbsp;<span class="builtintype" id="1356454">int</span>&nbsp;<span class="op" id="1356458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356461">n</span>&nbsp;<span class="op" id="1356463">:=</span>&nbsp;<span class="builtinfunc" id="1356466">len</span><span class="op" id="1356469">(</span><span class="ident" id="1356470">sep</span><span class="op" id="1356473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356476">if</span>&nbsp;<span class="ident" id="1356479">n</span>&nbsp;<span class="op" id="1356481">==</span>&nbsp;<span class="num" id="1356484">0</span>&nbsp;<span class="op" id="1356486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356490">return</span>&nbsp;<span class="ident" id="1356497">utf8</span><span class="op" id="1356501">.</span><span class="ident" id="1356502">RuneCount</span><span class="op" id="1356511">(</span><span class="ident" id="1356512">s</span><span class="op" id="1356513">)</span>&nbsp;<span class="op" id="1356515">+</span>&nbsp;<span class="num" id="1356517">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1356520">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356523">if</span>&nbsp;<span class="ident" id="1356526">n</span>&nbsp;<span class="op" id="1356528">&gt;</span>&nbsp;<span class="builtinfunc" id="1356530">len</span><span class="op" id="1356533">(</span><span class="ident" id="1356534">s</span><span class="op" id="1356535">)</span>&nbsp;<span class="op" id="1356537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356541">return</span>&nbsp;<span class="num" id="1356548">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1356551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356554">count</span>&nbsp;<span class="op" id="1356560">:=</span>&nbsp;<span class="num" id="1356563">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356566">c</span>&nbsp;<span class="op" id="1356568">:=</span>&nbsp;<span class="ident" id="1356571">sep</span><span class="op" id="1356574">[</span><span class="num" id="1356575">0</span><span class="op" id="1356576">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356579">i</span>&nbsp;<span class="op" id="1356581">:=</span>&nbsp;<span class="num" id="1356584">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356587">t</span>&nbsp;<span class="op" id="1356589">:=</span>&nbsp;<span class="ident" id="1356592">s</span><span class="op" id="1356593">[</span><span class="op" id="1356594">:</span><span class="builtinfunc" id="1356595">len</span><span class="op" id="1356598">(</span><span class="ident" id="1356599">s</span><span class="op" id="1356600">)</span><span class="op" id="1356601">-</span><span class="ident" id="1356602">n</span><span class="op" id="1356603">+</span><span class="num" id="1356604">1</span><span class="op" id="1356605">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356608">for</span>&nbsp;<span class="ident" id="1356612">i</span>&nbsp;<span class="op" id="1356614">&lt;</span>&nbsp;<span class="builtinfunc" id="1356616">len</span><span class="op" id="1356619">(</span><span class="ident" id="1356620">t</span><span class="op" id="1356621">)</span>&nbsp;<span class="op" id="1356623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356627">if</span>&nbsp;<span class="ident" id="1356630">t</span><span class="op" id="1356631">[</span><span class="ident" id="1356632">i</span><span class="op" id="1356633">]</span>&nbsp;<span class="op" id="1356635">!=</span>&nbsp;<span class="ident" id="1356638">c</span>&nbsp;<span class="op" id="1356640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356645">o</span>&nbsp;<span class="op" id="1356647">:=</span>&nbsp;<span class="ident" id="1356650">IndexByte</span><span class="op" id="1356659">(</span><span class="ident" id="1356660">t</span><span class="op" id="1356661">[</span><span class="ident" id="1356662">i</span><span class="op" id="1356663">:</span><span class="op" id="1356664">]</span><span class="op" id="1356665">,</span>&nbsp;<span class="ident" id="1356667">c</span><span class="op" id="1356668">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356673">if</span>&nbsp;<span class="ident" id="1356676">o</span>&nbsp;<span class="op" id="1356678">&lt;</span>&nbsp;<span class="num" id="1356680">0</span>&nbsp;<span class="op" id="1356682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356688">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1356697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356702">i</span>&nbsp;<span class="op" id="1356704">+=</span>&nbsp;<span class="ident" id="1356707">o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1356711">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356715">if</span>&nbsp;<span class="ident" id="1356718">n</span>&nbsp;<span class="op" id="1356720">==</span>&nbsp;<span class="num" id="1356723">1</span>&nbsp;<span class="op" id="1356725">||</span>&nbsp;<span class="ident" id="1356728">Equal</span><span class="op" id="1356733">(</span><span class="ident" id="1356734">s</span><span class="op" id="1356735">[</span><span class="ident" id="1356736">i</span><span class="op" id="1356737">:</span><span class="ident" id="1356738">i</span><span class="op" id="1356739">+</span><span class="ident" id="1356740">n</span><span class="op" id="1356741">]</span><span class="op" id="1356742">,</span>&nbsp;<span class="ident" id="1356744">sep</span><span class="op" id="1356747">)</span>&nbsp;<span class="op" id="1356749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356754">count</span><span class="op" id="1356759">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356765">i</span>&nbsp;<span class="op" id="1356767">+=</span>&nbsp;<span class="ident" id="1356770">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356775">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1356786">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356790">i</span><span class="op" id="1356791">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1356795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356798">return</span>&nbsp;<span class="ident" id="1356805">count</span><br>
<span class="lineno"></span><span class="op" id="1356811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="1356814">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;subslice&nbsp;is&nbsp;within&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="1356864">func</span>&nbsp;<span class="ident" id="1356869">Contains</span><span class="op" id="1356877">(</span><span class="ident" id="1356878">b</span><span class="op" id="1356879">,</span>&nbsp;<span class="ident" id="1356881">subslice</span>&nbsp;<span class="op" id="1356890">[</span><span class="op" id="1356891">]</span><span class="builtintype" id="1356892">byte</span><span class="op" id="1356896">)</span>&nbsp;<span class="builtintype" id="1356898">bool</span>&nbsp;<span class="op" id="1356903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356906">return</span>&nbsp;<span class="ident" id="1356913">Index</span><span class="op" id="1356918">(</span><span class="ident" id="1356919">b</span><span class="op" id="1356920">,</span>&nbsp;<span class="ident" id="1356922">subslice</span><span class="op" id="1356930">)</span>&nbsp;<span class="op" id="1356932">!=</span>&nbsp;<span class="op" id="1356935">-</span><span class="num" id="1356936">1</span><br>
<span class="lineno"></span><span class="op" id="1356938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="1356941">//&nbsp;Index&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;instance&nbsp;of&nbsp;sep&nbsp;in&nbsp;s,&nbsp;or&nbsp;-1&nbsp;if&nbsp;sep&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1357037">func</span>&nbsp;<span class="ident" id="1357042">Index</span><span class="op" id="1357047">(</span><span class="ident" id="1357048">s</span><span class="op" id="1357049">,</span>&nbsp;<span class="ident" id="1357051">sep</span>&nbsp;<span class="op" id="1357055">[</span><span class="op" id="1357056">]</span><span class="builtintype" id="1357057">byte</span><span class="op" id="1357061">)</span>&nbsp;<span class="builtintype" id="1357063">int</span>&nbsp;<span class="op" id="1357067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1357070">n</span>&nbsp;<span class="op" id="1357072">:=</span>&nbsp;<span class="builtinfunc" id="1357075">len</span><span class="op" id="1357078">(</span><span class="ident" id="1357079">sep</span><span class="op" id="1357082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357085">if</span>&nbsp;<span class="ident" id="1357088">n</span>&nbsp;<span class="op" id="1357090">==</span>&nbsp;<span class="num" id="1357093">0</span>&nbsp;<span class="op" id="1357095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357099">return</span>&nbsp;<span class="num" id="1357106">0</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357112">if</span>&nbsp;<span class="ident" id="1357115">n</span>&nbsp;<span class="op" id="1357117">&gt;</span>&nbsp;<span class="builtinfunc" id="1357119">len</span><span class="op" id="1357122">(</span><span class="ident" id="1357123">s</span><span class="op" id="1357124">)</span>&nbsp;<span class="op" id="1357126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357130">return</span>&nbsp;<span class="op" id="1357137">-</span><span class="num" id="1357138">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1357144">c</span>&nbsp;<span class="op" id="1357146">:=</span>&nbsp;<span class="ident" id="1357149">sep</span><span class="op" id="1357152">[</span><span class="num" id="1357153">0</span><span class="op" id="1357154">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357157">if</span>&nbsp;<span class="ident" id="1357160">n</span>&nbsp;<span class="op" id="1357162">==</span>&nbsp;<span class="num" id="1357165">1</span>&nbsp;<span class="op" id="1357167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357171">return</span>&nbsp;<span class="ident" id="1357178">IndexByte</span><span class="op" id="1357187">(</span><span class="ident" id="1357188">s</span><span class="op" id="1357189">,</span>&nbsp;<span class="ident" id="1357191">c</span><span class="op" id="1357192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1357198">i</span>&nbsp;<span class="op" id="1357200">:=</span>&nbsp;<span class="num" id="1357203">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1357206">t</span>&nbsp;<span class="op" id="1357208">:=</span>&nbsp;<span class="ident" id="1357211">s</span><span class="op" id="1357212">[</span><span class="op" id="1357213">:</span><span class="builtinfunc" id="1357214">len</span><span class="op" id="1357217">(</span><span class="ident" id="1357218">s</span><span class="op" id="1357219">)</span><span class="op" id="1357220">-</span><span class="ident" id="1357221">n</span><span class="op" id="1357222">+</span><span class="num" id="1357223">1</span><span class="op" id="1357224">]</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357227">for</span>&nbsp;<span class="ident" id="1357231">i</span>&nbsp;<span class="op" id="1357233">&lt;</span>&nbsp;<span class="builtinfunc" id="1357235">len</span><span class="op" id="1357238">(</span><span class="ident" id="1357239">t</span><span class="op" id="1357240">)</span>&nbsp;<span class="op" id="1357242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357246">if</span>&nbsp;<span class="ident" id="1357249">t</span><span class="op" id="1357250">[</span><span class="ident" id="1357251">i</span><span class="op" id="1357252">]</span>&nbsp;<span class="op" id="1357254">!=</span>&nbsp;<span class="ident" id="1357257">c</span>&nbsp;<span class="op" id="1357259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1357264">o</span>&nbsp;<span class="op" id="1357266">:=</span>&nbsp;<span class="ident" id="1357269">IndexByte</span><span class="op" id="1357278">(</span><span class="ident" id="1357279">t</span><span class="op" id="1357280">[</span><span class="ident" id="1357281">i</span><span class="op" id="1357282">:</span><span class="op" id="1357283">]</span><span class="op" id="1357284">,</span>&nbsp;<span class="ident" id="1357286">c</span><span class="op" id="1357287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357292">if</span>&nbsp;<span class="ident" id="1357295">o</span>&nbsp;<span class="op" id="1357297">&lt;</span>&nbsp;<span class="num" id="1357299">0</span>&nbsp;<span class="op" id="1357301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357307">break</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1357321">i</span>&nbsp;<span class="op" id="1357323">+=</span>&nbsp;<span class="ident" id="1357326">o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357334">if</span>&nbsp;<span class="ident" id="1357337">Equal</span><span class="op" id="1357342">(</span><span class="ident" id="1357343">s</span><span class="op" id="1357344">[</span><span class="ident" id="1357345">i</span><span class="op" id="1357346">:</span><span class="ident" id="1357347">i</span><span class="op" id="1357348">+</span><span class="ident" id="1357349">n</span><span class="op" id="1357350">]</span><span class="op" id="1357351">,</span>&nbsp;<span class="ident" id="1357353">sep</span><span class="op" id="1357356">)</span>&nbsp;<span class="op" id="1357358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357363">return</span>&nbsp;<span class="ident" id="1357370">i</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1357378">i</span><span class="op" id="1357379">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357386">return</span>&nbsp;<span class="op" id="1357393">-</span><span class="num" id="1357394">1</span><br>
<span class="lineno"></span><span class="op" id="1357396">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="1357399">func</span>&nbsp;<span class="ident" id="1357404">indexBytePortable</span><span class="op" id="1357421">(</span><span class="ident" id="1357422">s</span>&nbsp;<span class="op" id="1357424">[</span><span class="op" id="1357425">]</span><span class="builtintype" id="1357426">byte</span><span class="op" id="1357430">,</span>&nbsp;<span class="ident" id="1357432">c</span>&nbsp;<span class="builtintype" id="1357434">byte</span><span class="op" id="1357438">)</span>&nbsp;<span class="builtintype" id="1357440">int</span>&nbsp;<span class="op" id="1357444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357447">for</span>&nbsp;<span class="ident" id="1357451">i</span><span class="op" id="1357452">,</span>&nbsp;<span class="ident" id="1357454">b</span>&nbsp;<span class="op" id="1357456">:=</span>&nbsp;<span class="keyword" id="1357459">range</span>&nbsp;<span class="ident" id="1357465">s</span>&nbsp;<span class="op" id="1357467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357471">if</span>&nbsp;<span class="ident" id="1357474">b</span>&nbsp;<span class="op" id="1357476">==</span>&nbsp;<span class="ident" id="1357479">c</span>&nbsp;<span class="op" id="1357481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357486">return</span>&nbsp;<span class="ident" id="1357493">i</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357503">return</span>&nbsp;<span class="op" id="1357510">-</span><span class="num" id="1357511">1</span><br>
<span class="lineno"></span><span class="op" id="1357513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="1357516">//&nbsp;LastIndex&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;instance&nbsp;of&nbsp;sep&nbsp;in&nbsp;s,&nbsp;or&nbsp;-1&nbsp;if&nbsp;sep&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1357615">func</span>&nbsp;<span class="ident" id="1357620">LastIndex</span><span class="op" id="1357629">(</span><span class="ident" id="1357630">s</span><span class="op" id="1357631">,</span>&nbsp;<span class="ident" id="1357633">sep</span>&nbsp;<span class="op" id="1357637">[</span><span class="op" id="1357638">]</span><span class="builtintype" id="1357639">byte</span><span class="op" id="1357643">)</span>&nbsp;<span class="builtintype" id="1357645">int</span>&nbsp;<span class="op" id="1357649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1357652">n</span>&nbsp;<span class="op" id="1357654">:=</span>&nbsp;<span class="builtinfunc" id="1357657">len</span><span class="op" id="1357660">(</span><span class="ident" id="1357661">sep</span><span class="op" id="1357664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357667">if</span>&nbsp;<span class="ident" id="1357670">n</span>&nbsp;<span class="op" id="1357672">==</span>&nbsp;<span class="num" id="1357675">0</span>&nbsp;<span class="op" id="1357677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357681">return</span>&nbsp;<span class="builtinfunc" id="1357688">len</span><span class="op" id="1357691">(</span><span class="ident" id="1357692">s</span><span class="op" id="1357693">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1357699">c</span>&nbsp;<span class="op" id="1357701">:=</span>&nbsp;<span class="ident" id="1357704">sep</span><span class="op" id="1357707">[</span><span class="num" id="1357708">0</span><span class="op" id="1357709">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357712">for</span>&nbsp;<span class="ident" id="1357716">i</span>&nbsp;<span class="op" id="1357718">:=</span>&nbsp;<span class="builtinfunc" id="1357721">len</span><span class="op" id="1357724">(</span><span class="ident" id="1357725">s</span><span class="op" id="1357726">)</span>&nbsp;<span class="op" id="1357728">-</span>&nbsp;<span class="ident" id="1357730">n</span><span class="op" id="1357731">;</span>&nbsp;<span class="ident" id="1357733">i</span>&nbsp;<span class="op" id="1357735">&gt;=</span>&nbsp;<span class="num" id="1357738">0</span><span class="op" id="1357739">;</span>&nbsp;<span class="ident" id="1357741">i</span><span class="op" id="1357742">--</span>&nbsp;<span class="op" id="1357745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357749">if</span>&nbsp;<span class="ident" id="1357752">s</span><span class="op" id="1357753">[</span><span class="ident" id="1357754">i</span><span class="op" id="1357755">]</span>&nbsp;<span class="op" id="1357757">==</span>&nbsp;<span class="ident" id="1357760">c</span>&nbsp;<span class="op" id="1357762">&amp;&amp;</span>&nbsp;<span class="op" id="1357765">(</span><span class="ident" id="1357766">n</span>&nbsp;<span class="op" id="1357768">==</span>&nbsp;<span class="num" id="1357771">1</span>&nbsp;<span class="op" id="1357773">||</span>&nbsp;<span class="ident" id="1357776">Equal</span><span class="op" id="1357781">(</span><span class="ident" id="1357782">s</span><span class="op" id="1357783">[</span><span class="ident" id="1357784">i</span><span class="op" id="1357785">:</span><span class="ident" id="1357786">i</span><span class="op" id="1357787">+</span><span class="ident" id="1357788">n</span><span class="op" id="1357789">]</span><span class="op" id="1357790">,</span>&nbsp;<span class="ident" id="1357792">sep</span><span class="op" id="1357795">)</span><span class="op" id="1357796">)</span>&nbsp;<span class="op" id="1357798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357803">return</span>&nbsp;<span class="ident" id="1357810">i</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357820">return</span>&nbsp;<span class="op" id="1357827">-</span><span class="num" id="1357828">1</span><br>
<span class="lineno"></span><span class="op" id="1357830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="1357833">//&nbsp;IndexRune&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1357911">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1357988">//&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;rune&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1358034">func</span>&nbsp;<span class="ident" id="1358039">IndexRune</span><span class="op" id="1358048">(</span><span class="ident" id="1358049">s</span>&nbsp;<span class="op" id="1358051">[</span><span class="op" id="1358052">]</span><span class="builtintype" id="1358053">byte</span><span class="op" id="1358057">,</span>&nbsp;<span class="ident" id="1358059">r</span>&nbsp;<span class="builtintype" id="1358061">rune</span><span class="op" id="1358065">)</span>&nbsp;<span class="builtintype" id="1358067">int</span>&nbsp;<span class="op" id="1358071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358074">for</span>&nbsp;<span class="ident" id="1358078">i</span>&nbsp;<span class="op" id="1358080">:=</span>&nbsp;<span class="num" id="1358083">0</span><span class="op" id="1358084">;</span>&nbsp;<span class="ident" id="1358086">i</span>&nbsp;<span class="op" id="1358088">&lt;</span>&nbsp;<span class="builtinfunc" id="1358090">len</span><span class="op" id="1358093">(</span><span class="ident" id="1358094">s</span><span class="op" id="1358095">)</span><span class="op" id="1358096">;</span>&nbsp;<span class="op" id="1358098">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1358102">r1</span><span class="op" id="1358104">,</span>&nbsp;<span class="ident" id="1358106">size</span>&nbsp;<span class="op" id="1358111">:=</span>&nbsp;<span class="ident" id="1358114">utf8</span><span class="op" id="1358118">.</span><span class="ident" id="1358119">DecodeRune</span><span class="op" id="1358129">(</span><span class="ident" id="1358130">s</span><span class="op" id="1358131">[</span><span class="ident" id="1358132">i</span><span class="op" id="1358133">:</span><span class="op" id="1358134">]</span><span class="op" id="1358135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358139">if</span>&nbsp;<span class="ident" id="1358142">r</span>&nbsp;<span class="op" id="1358144">==</span>&nbsp;<span class="ident" id="1358147">r1</span>&nbsp;<span class="op" id="1358150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358155">return</span>&nbsp;<span class="ident" id="1358162">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1358166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1358170">i</span>&nbsp;<span class="op" id="1358172">+=</span>&nbsp;<span class="ident" id="1358175">size</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1358181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358184">return</span>&nbsp;<span class="op" id="1358191">-</span><span class="num" id="1358192">1</span><br>
<span class="lineno"></span><span class="op" id="1358194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1358197">//&nbsp;IndexAny&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno">155</span><span class="comment" id="1358274">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;any&nbsp;of&nbsp;the&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1358354">//&nbsp;code&nbsp;points&nbsp;in&nbsp;chars.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;chars&nbsp;is&nbsp;empty&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="1358435">//&nbsp;point&nbsp;in&nbsp;common.</span><br>
<span class="lineno"></span><span class="keyword" id="1358455">func</span>&nbsp;<span class="ident" id="1358460">IndexAny</span><span class="op" id="1358468">(</span><span class="ident" id="1358469">s</span>&nbsp;<span class="op" id="1358471">[</span><span class="op" id="1358472">]</span><span class="builtintype" id="1358473">byte</span><span class="op" id="1358477">,</span>&nbsp;<span class="ident" id="1358479">chars</span>&nbsp;<span class="builtintype" id="1358485">string</span><span class="op" id="1358491">)</span>&nbsp;<span class="builtintype" id="1358493">int</span>&nbsp;<span class="op" id="1358497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358500">if</span>&nbsp;<span class="builtinfunc" id="1358503">len</span><span class="op" id="1358506">(</span><span class="ident" id="1358507">chars</span><span class="op" id="1358512">)</span>&nbsp;<span class="op" id="1358514">&gt;</span>&nbsp;<span class="num" id="1358516">0</span>&nbsp;<span class="op" id="1358518">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358522">var</span>&nbsp;<span class="ident" id="1358526">r</span>&nbsp;<span class="builtintype" id="1358528">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358535">var</span>&nbsp;<span class="ident" id="1358539">width</span>&nbsp;<span class="builtintype" id="1358545">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358551">for</span>&nbsp;<span class="ident" id="1358555">i</span>&nbsp;<span class="op" id="1358557">:=</span>&nbsp;<span class="num" id="1358560">0</span><span class="op" id="1358561">;</span>&nbsp;<span class="ident" id="1358563">i</span>&nbsp;<span class="op" id="1358565">&lt;</span>&nbsp;<span class="builtinfunc" id="1358567">len</span><span class="op" id="1358570">(</span><span class="ident" id="1358571">s</span><span class="op" id="1358572">)</span><span class="op" id="1358573">;</span>&nbsp;<span class="ident" id="1358575">i</span>&nbsp;<span class="op" id="1358577">+=</span>&nbsp;<span class="ident" id="1358580">width</span>&nbsp;<span class="op" id="1358586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1358591">r</span>&nbsp;<span class="op" id="1358593">=</span>&nbsp;<span class="builtintype" id="1358595">rune</span><span class="op" id="1358599">(</span><span class="ident" id="1358600">s</span><span class="op" id="1358601">[</span><span class="ident" id="1358602">i</span><span class="op" id="1358603">]</span><span class="op" id="1358604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358609">if</span>&nbsp;<span class="ident" id="1358612">r</span>&nbsp;<span class="op" id="1358614">&lt;</span>&nbsp;<span class="ident" id="1358616">utf8</span><span class="op" id="1358620">.</span><span class="ident" id="1358621">RuneSelf</span>&nbsp;<span class="op" id="1358630">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1358636">width</span>&nbsp;<span class="op" id="1358642">=</span>&nbsp;<span class="num" id="1358644">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1358649">}</span>&nbsp;<span class="keyword" id="1358651">else</span>&nbsp;<span class="op" id="1358656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1358662">r</span><span class="op" id="1358663">,</span>&nbsp;<span class="ident" id="1358665">width</span>&nbsp;<span class="op" id="1358671">=</span>&nbsp;<span class="ident" id="1358673">utf8</span><span class="op" id="1358677">.</span><span class="ident" id="1358678">DecodeRune</span><span class="op" id="1358688">(</span><span class="ident" id="1358689">s</span><span class="op" id="1358690">[</span><span class="ident" id="1358691">i</span><span class="op" id="1358692">:</span><span class="op" id="1358693">]</span><span class="op" id="1358694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1358699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358704">for</span>&nbsp;<span class="ident" id="1358708">_</span><span class="op" id="1358709">,</span>&nbsp;<span class="ident" id="1358711">ch</span>&nbsp;<span class="op" id="1358714">:=</span>&nbsp;<span class="keyword" id="1358717">range</span>&nbsp;<span class="ident" id="1358723">chars</span>&nbsp;<span class="op" id="1358729">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358735">if</span>&nbsp;<span class="ident" id="1358738">r</span>&nbsp;<span class="op" id="1358740">==</span>&nbsp;<span class="ident" id="1358743">ch</span>&nbsp;<span class="op" id="1358746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358753">return</span>&nbsp;<span class="ident" id="1358760">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1358766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1358771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1358775">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1358778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358781">return</span>&nbsp;<span class="op" id="1358788">-</span><span class="num" id="1358789">1</span><br>
<span class="lineno"></span><span class="op" id="1358791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1358794">//&nbsp;LastIndexAny&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code</span><br>
<span class="lineno">180</span><span class="comment" id="1358867">//&nbsp;points.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;any&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1358943">//&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;in&nbsp;chars.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;chars&nbsp;is&nbsp;empty&nbsp;or&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1359019">//&nbsp;there&nbsp;is&nbsp;no&nbsp;code&nbsp;point&nbsp;in&nbsp;common.</span><br>
<span class="lineno"></span><span class="keyword" id="1359056">func</span>&nbsp;<span class="ident" id="1359061">LastIndexAny</span><span class="op" id="1359073">(</span><span class="ident" id="1359074">s</span>&nbsp;<span class="op" id="1359076">[</span><span class="op" id="1359077">]</span><span class="builtintype" id="1359078">byte</span><span class="op" id="1359082">,</span>&nbsp;<span class="ident" id="1359084">chars</span>&nbsp;<span class="builtintype" id="1359090">string</span><span class="op" id="1359096">)</span>&nbsp;<span class="builtintype" id="1359098">int</span>&nbsp;<span class="op" id="1359102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359105">if</span>&nbsp;<span class="builtinfunc" id="1359108">len</span><span class="op" id="1359111">(</span><span class="ident" id="1359112">chars</span><span class="op" id="1359117">)</span>&nbsp;<span class="op" id="1359119">&gt;</span>&nbsp;<span class="num" id="1359121">0</span>&nbsp;<span class="op" id="1359123">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359127">for</span>&nbsp;<span class="ident" id="1359131">i</span>&nbsp;<span class="op" id="1359133">:=</span>&nbsp;<span class="builtinfunc" id="1359136">len</span><span class="op" id="1359139">(</span><span class="ident" id="1359140">s</span><span class="op" id="1359141">)</span><span class="op" id="1359142">;</span>&nbsp;<span class="ident" id="1359144">i</span>&nbsp;<span class="op" id="1359146">&gt;</span>&nbsp;<span class="num" id="1359148">0</span><span class="op" id="1359149">;</span>&nbsp;<span class="op" id="1359151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359156">r</span><span class="op" id="1359157">,</span>&nbsp;<span class="ident" id="1359159">size</span>&nbsp;<span class="op" id="1359164">:=</span>&nbsp;<span class="ident" id="1359167">utf8</span><span class="op" id="1359171">.</span><span class="ident" id="1359172">DecodeLastRune</span><span class="op" id="1359186">(</span><span class="ident" id="1359187">s</span><span class="op" id="1359188">[</span><span class="num" id="1359189">0</span><span class="op" id="1359190">:</span><span class="ident" id="1359191">i</span><span class="op" id="1359192">]</span><span class="op" id="1359193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359198">i</span>&nbsp;<span class="op" id="1359200">-=</span>&nbsp;<span class="ident" id="1359203">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359211">for</span>&nbsp;<span class="ident" id="1359215">_</span><span class="op" id="1359216">,</span>&nbsp;<span class="ident" id="1359218">ch</span>&nbsp;<span class="op" id="1359221">:=</span>&nbsp;<span class="keyword" id="1359224">range</span>&nbsp;<span class="ident" id="1359230">chars</span>&nbsp;<span class="op" id="1359236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359242">if</span>&nbsp;<span class="ident" id="1359245">r</span>&nbsp;<span class="op" id="1359247">==</span>&nbsp;<span class="ident" id="1359250">ch</span>&nbsp;<span class="op" id="1359253">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359260">return</span>&nbsp;<span class="ident" id="1359267">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359285">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359288">return</span>&nbsp;<span class="op" id="1359295">-</span><span class="num" id="1359296">1</span><br>
<span class="lineno"></span><span class="op" id="1359298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1359301">//&nbsp;Generic&nbsp;split:&nbsp;splits&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep,</span><br>
<span class="lineno"></span><span class="comment" id="1359354">//&nbsp;including&nbsp;sepSave&nbsp;bytes&nbsp;of&nbsp;sep&nbsp;in&nbsp;the&nbsp;subslices.</span><br>
<span class="lineno">200</span><span class="keyword" id="1359406">func</span>&nbsp;<span class="ident" id="1359411">genSplit</span><span class="op" id="1359419">(</span><span class="ident" id="1359420">s</span><span class="op" id="1359421">,</span>&nbsp;<span class="ident" id="1359423">sep</span>&nbsp;<span class="op" id="1359427">[</span><span class="op" id="1359428">]</span><span class="builtintype" id="1359429">byte</span><span class="op" id="1359433">,</span>&nbsp;<span class="ident" id="1359435">sepSave</span><span class="op" id="1359442">,</span>&nbsp;<span class="ident" id="1359444">n</span>&nbsp;<span class="builtintype" id="1359446">int</span><span class="op" id="1359449">)</span>&nbsp;<span class="op" id="1359451">[</span><span class="op" id="1359452">]</span><span class="op" id="1359453">[</span><span class="op" id="1359454">]</span><span class="builtintype" id="1359455">byte</span>&nbsp;<span class="op" id="1359460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359463">if</span>&nbsp;<span class="ident" id="1359466">n</span>&nbsp;<span class="op" id="1359468">==</span>&nbsp;<span class="num" id="1359471">0</span>&nbsp;<span class="op" id="1359473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359477">return</span>&nbsp;<span class="builtintype" id="1359484">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359492">if</span>&nbsp;<span class="builtinfunc" id="1359495">len</span><span class="op" id="1359498">(</span><span class="ident" id="1359499">sep</span><span class="op" id="1359502">)</span>&nbsp;<span class="op" id="1359504">==</span>&nbsp;<span class="num" id="1359507">0</span>&nbsp;<span class="op" id="1359509">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359513">return</span>&nbsp;<span class="ident" id="1359520">explode</span><span class="op" id="1359527">(</span><span class="ident" id="1359528">s</span><span class="op" id="1359529">,</span>&nbsp;<span class="ident" id="1359531">n</span><span class="op" id="1359532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359538">if</span>&nbsp;<span class="ident" id="1359541">n</span>&nbsp;<span class="op" id="1359543">&lt;</span>&nbsp;<span class="num" id="1359545">0</span>&nbsp;<span class="op" id="1359547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359551">n</span>&nbsp;<span class="op" id="1359553">=</span>&nbsp;<span class="ident" id="1359555">Count</span><span class="op" id="1359560">(</span><span class="ident" id="1359561">s</span><span class="op" id="1359562">,</span>&nbsp;<span class="ident" id="1359564">sep</span><span class="op" id="1359567">)</span>&nbsp;<span class="op" id="1359569">+</span>&nbsp;<span class="num" id="1359571">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359574">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359577">c</span>&nbsp;<span class="op" id="1359579">:=</span>&nbsp;<span class="ident" id="1359582">sep</span><span class="op" id="1359585">[</span><span class="num" id="1359586">0</span><span class="op" id="1359587">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359590">start</span>&nbsp;<span class="op" id="1359596">:=</span>&nbsp;<span class="num" id="1359599">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359602">a</span>&nbsp;<span class="op" id="1359604">:=</span>&nbsp;<span class="builtinfunc" id="1359607">make</span><span class="op" id="1359611">(</span><span class="op" id="1359612">[</span><span class="op" id="1359613">]</span><span class="op" id="1359614">[</span><span class="op" id="1359615">]</span><span class="builtintype" id="1359616">byte</span><span class="op" id="1359620">,</span>&nbsp;<span class="ident" id="1359622">n</span><span class="op" id="1359623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359626">na</span>&nbsp;<span class="op" id="1359629">:=</span>&nbsp;<span class="num" id="1359632">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359635">for</span>&nbsp;<span class="ident" id="1359639">i</span>&nbsp;<span class="op" id="1359641">:=</span>&nbsp;<span class="num" id="1359644">0</span><span class="op" id="1359645">;</span>&nbsp;<span class="ident" id="1359647">i</span><span class="op" id="1359648">+</span><span class="builtinfunc" id="1359649">len</span><span class="op" id="1359652">(</span><span class="ident" id="1359653">sep</span><span class="op" id="1359656">)</span>&nbsp;<span class="op" id="1359658">&lt;=</span>&nbsp;<span class="builtinfunc" id="1359661">len</span><span class="op" id="1359664">(</span><span class="ident" id="1359665">s</span><span class="op" id="1359666">)</span>&nbsp;<span class="op" id="1359668">&amp;&amp;</span>&nbsp;<span class="ident" id="1359671">na</span><span class="op" id="1359673">+</span><span class="num" id="1359674">1</span>&nbsp;<span class="op" id="1359676">&lt;</span>&nbsp;<span class="ident" id="1359678">n</span><span class="op" id="1359679">;</span>&nbsp;<span class="ident" id="1359681">i</span><span class="op" id="1359682">++</span>&nbsp;<span class="op" id="1359685">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359689">if</span>&nbsp;<span class="ident" id="1359692">s</span><span class="op" id="1359693">[</span><span class="ident" id="1359694">i</span><span class="op" id="1359695">]</span>&nbsp;<span class="op" id="1359697">==</span>&nbsp;<span class="ident" id="1359700">c</span>&nbsp;<span class="op" id="1359702">&amp;&amp;</span>&nbsp;<span class="op" id="1359705">(</span><span class="builtinfunc" id="1359706">len</span><span class="op" id="1359709">(</span><span class="ident" id="1359710">sep</span><span class="op" id="1359713">)</span>&nbsp;<span class="op" id="1359715">==</span>&nbsp;<span class="num" id="1359718">1</span>&nbsp;<span class="op" id="1359720">||</span>&nbsp;<span class="ident" id="1359723">Equal</span><span class="op" id="1359728">(</span><span class="ident" id="1359729">s</span><span class="op" id="1359730">[</span><span class="ident" id="1359731">i</span><span class="op" id="1359732">:</span><span class="ident" id="1359733">i</span><span class="op" id="1359734">+</span><span class="builtinfunc" id="1359735">len</span><span class="op" id="1359738">(</span><span class="ident" id="1359739">sep</span><span class="op" id="1359742">)</span><span class="op" id="1359743">]</span><span class="op" id="1359744">,</span>&nbsp;<span class="ident" id="1359746">sep</span><span class="op" id="1359749">)</span><span class="op" id="1359750">)</span>&nbsp;<span class="op" id="1359752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359757">a</span><span class="op" id="1359758">[</span><span class="ident" id="1359759">na</span><span class="op" id="1359761">]</span>&nbsp;<span class="op" id="1359763">=</span>&nbsp;<span class="ident" id="1359765">s</span><span class="op" id="1359766">[</span><span class="ident" id="1359767">start</span>&nbsp;<span class="op" id="1359773">:</span>&nbsp;<span class="ident" id="1359775">i</span><span class="op" id="1359776">+</span><span class="ident" id="1359777">sepSave</span><span class="op" id="1359784">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359789">na</span><span class="op" id="1359791">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359797">start</span>&nbsp;<span class="op" id="1359803">=</span>&nbsp;<span class="ident" id="1359805">i</span>&nbsp;<span class="op" id="1359807">+</span>&nbsp;<span class="builtinfunc" id="1359809">len</span><span class="op" id="1359812">(</span><span class="ident" id="1359813">sep</span><span class="op" id="1359816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359821">i</span>&nbsp;<span class="op" id="1359823">+=</span>&nbsp;<span class="builtinfunc" id="1359826">len</span><span class="op" id="1359829">(</span><span class="ident" id="1359830">sep</span><span class="op" id="1359833">)</span>&nbsp;<span class="op" id="1359835">-</span>&nbsp;<span class="num" id="1359837">1</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359847">a</span><span class="op" id="1359848">[</span><span class="ident" id="1359849">na</span><span class="op" id="1359851">]</span>&nbsp;<span class="op" id="1359853">=</span>&nbsp;<span class="ident" id="1359855">s</span><span class="op" id="1359856">[</span><span class="ident" id="1359857">start</span><span class="op" id="1359862">:</span><span class="op" id="1359863">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359866">return</span>&nbsp;<span class="ident" id="1359873">a</span><span class="op" id="1359874">[</span><span class="num" id="1359875">0</span>&nbsp;<span class="op" id="1359877">:</span>&nbsp;<span class="ident" id="1359879">na</span><span class="op" id="1359881">+</span><span class="num" id="1359882">1</span><span class="op" id="1359883">]</span><br>
<span class="lineno"></span><span class="op" id="1359885">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="1359888">//&nbsp;SplitN&nbsp;slices&nbsp;s&nbsp;into&nbsp;subslices&nbsp;separated&nbsp;by&nbsp;sep&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1359962">//&nbsp;the&nbsp;subslices&nbsp;between&nbsp;those&nbsp;separators.</span><br>
<span class="lineno"></span><span class="comment" id="1360005">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitN&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1360066">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;subslices&nbsp;to&nbsp;return:</span><br>
<span class="lineno">230</span><span class="comment" id="1360125">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;subslices;&nbsp;the&nbsp;last&nbsp;subslice&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="1360207">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;subslices)</span><br>
<span class="lineno"></span><span class="comment" id="1360255">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;subslices</span><br>
<span class="lineno"></span><span class="keyword" id="1360281">func</span>&nbsp;<span class="ident" id="1360286">SplitN</span><span class="op" id="1360292">(</span><span class="ident" id="1360293">s</span><span class="op" id="1360294">,</span>&nbsp;<span class="ident" id="1360296">sep</span>&nbsp;<span class="op" id="1360300">[</span><span class="op" id="1360301">]</span><span class="builtintype" id="1360302">byte</span><span class="op" id="1360306">,</span>&nbsp;<span class="ident" id="1360308">n</span>&nbsp;<span class="builtintype" id="1360310">int</span><span class="op" id="1360313">)</span>&nbsp;<span class="op" id="1360315">[</span><span class="op" id="1360316">]</span><span class="op" id="1360317">[</span><span class="op" id="1360318">]</span><span class="builtintype" id="1360319">byte</span>&nbsp;<span class="op" id="1360324">{</span>&nbsp;<span class="keyword" id="1360326">return</span>&nbsp;<span class="ident" id="1360333">genSplit</span><span class="op" id="1360341">(</span><span class="ident" id="1360342">s</span><span class="op" id="1360343">,</span>&nbsp;<span class="ident" id="1360345">sep</span><span class="op" id="1360348">,</span>&nbsp;<span class="num" id="1360350">0</span><span class="op" id="1360351">,</span>&nbsp;<span class="ident" id="1360353">n</span><span class="op" id="1360354">)</span>&nbsp;<span class="op" id="1360356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="1360359">//&nbsp;SplitAfterN&nbsp;slices&nbsp;s&nbsp;into&nbsp;subslices&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1360429">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;those&nbsp;subslices.</span><br>
<span class="lineno"></span><span class="comment" id="1360468">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitAfterN&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1360534">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;subslices&nbsp;to&nbsp;return:</span><br>
<span class="lineno"></span><span class="comment" id="1360593">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;subslices;&nbsp;the&nbsp;last&nbsp;subslice&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno">240</span><span class="comment" id="1360675">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;subslices)</span><br>
<span class="lineno"></span><span class="comment" id="1360723">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;subslices</span><br>
<span class="lineno"></span><span class="keyword" id="1360749">func</span>&nbsp;<span class="ident" id="1360754">SplitAfterN</span><span class="op" id="1360765">(</span><span class="ident" id="1360766">s</span><span class="op" id="1360767">,</span>&nbsp;<span class="ident" id="1360769">sep</span>&nbsp;<span class="op" id="1360773">[</span><span class="op" id="1360774">]</span><span class="builtintype" id="1360775">byte</span><span class="op" id="1360779">,</span>&nbsp;<span class="ident" id="1360781">n</span>&nbsp;<span class="builtintype" id="1360783">int</span><span class="op" id="1360786">)</span>&nbsp;<span class="op" id="1360788">[</span><span class="op" id="1360789">]</span><span class="op" id="1360790">[</span><span class="op" id="1360791">]</span><span class="builtintype" id="1360792">byte</span>&nbsp;<span class="op" id="1360797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1360800">return</span>&nbsp;<span class="ident" id="1360807">genSplit</span><span class="op" id="1360815">(</span><span class="ident" id="1360816">s</span><span class="op" id="1360817">,</span>&nbsp;<span class="ident" id="1360819">sep</span><span class="op" id="1360822">,</span>&nbsp;<span class="builtinfunc" id="1360824">len</span><span class="op" id="1360827">(</span><span class="ident" id="1360828">sep</span><span class="op" id="1360831">)</span><span class="op" id="1360832">,</span>&nbsp;<span class="ident" id="1360834">n</span><span class="op" id="1360835">)</span><br>
<span class="lineno"></span><span class="op" id="1360837">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="1360840">//&nbsp;Split&nbsp;slices&nbsp;s&nbsp;into&nbsp;all&nbsp;subslices&nbsp;separated&nbsp;by&nbsp;sep&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1360917">//&nbsp;the&nbsp;subslices&nbsp;between&nbsp;those&nbsp;separators.</span><br>
<span class="lineno"></span><span class="comment" id="1360960">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;Split&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1361020">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;SplitN&nbsp;with&nbsp;a&nbsp;count&nbsp;of&nbsp;-1.</span><br>
<span class="lineno">250</span><span class="keyword" id="1361070">func</span>&nbsp;<span class="ident" id="1361075">Split</span><span class="op" id="1361080">(</span><span class="ident" id="1361081">s</span><span class="op" id="1361082">,</span>&nbsp;<span class="ident" id="1361084">sep</span>&nbsp;<span class="op" id="1361088">[</span><span class="op" id="1361089">]</span><span class="builtintype" id="1361090">byte</span><span class="op" id="1361094">)</span>&nbsp;<span class="op" id="1361096">[</span><span class="op" id="1361097">]</span><span class="op" id="1361098">[</span><span class="op" id="1361099">]</span><span class="builtintype" id="1361100">byte</span>&nbsp;<span class="op" id="1361105">{</span>&nbsp;<span class="keyword" id="1361107">return</span>&nbsp;<span class="ident" id="1361114">genSplit</span><span class="op" id="1361122">(</span><span class="ident" id="1361123">s</span><span class="op" id="1361124">,</span>&nbsp;<span class="ident" id="1361126">sep</span><span class="op" id="1361129">,</span>&nbsp;<span class="num" id="1361131">0</span><span class="op" id="1361132">,</span>&nbsp;<span class="op" id="1361134">-</span><span class="num" id="1361135">1</span><span class="op" id="1361136">)</span>&nbsp;<span class="op" id="1361138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1361141">//&nbsp;SplitAfter&nbsp;slices&nbsp;s&nbsp;into&nbsp;all&nbsp;subslices&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1361214">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;those&nbsp;subslices.</span><br>
<span class="lineno"></span><span class="comment" id="1361253">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitAfter&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno">255</span><span class="comment" id="1361318">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;SplitAfterN&nbsp;with&nbsp;a&nbsp;count&nbsp;of&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="1361373">func</span>&nbsp;<span class="ident" id="1361378">SplitAfter</span><span class="op" id="1361388">(</span><span class="ident" id="1361389">s</span><span class="op" id="1361390">,</span>&nbsp;<span class="ident" id="1361392">sep</span>&nbsp;<span class="op" id="1361396">[</span><span class="op" id="1361397">]</span><span class="builtintype" id="1361398">byte</span><span class="op" id="1361402">)</span>&nbsp;<span class="op" id="1361404">[</span><span class="op" id="1361405">]</span><span class="op" id="1361406">[</span><span class="op" id="1361407">]</span><span class="builtintype" id="1361408">byte</span>&nbsp;<span class="op" id="1361413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1361416">return</span>&nbsp;<span class="ident" id="1361423">genSplit</span><span class="op" id="1361431">(</span><span class="ident" id="1361432">s</span><span class="op" id="1361433">,</span>&nbsp;<span class="ident" id="1361435">sep</span><span class="op" id="1361438">,</span>&nbsp;<span class="builtinfunc" id="1361440">len</span><span class="op" id="1361443">(</span><span class="ident" id="1361444">sep</span><span class="op" id="1361447">)</span><span class="op" id="1361448">,</span>&nbsp;<span class="op" id="1361450">-</span><span class="num" id="1361451">1</span><span class="op" id="1361452">)</span><br>
<span class="lineno"></span><span class="op" id="1361454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="1361457">//&nbsp;Fields&nbsp;splits&nbsp;the&nbsp;slice&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span><span class="comment" id="1361546">//&nbsp;characters,&nbsp;returning&nbsp;a&nbsp;slice&nbsp;of&nbsp;subslices&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="1361646">func</span>&nbsp;<span class="ident" id="1361651">Fields</span><span class="op" id="1361657">(</span><span class="ident" id="1361658">s</span>&nbsp;<span class="op" id="1361660">[</span><span class="op" id="1361661">]</span><span class="builtintype" id="1361662">byte</span><span class="op" id="1361666">)</span>&nbsp;<span class="op" id="1361668">[</span><span class="op" id="1361669">]</span><span class="op" id="1361670">[</span><span class="op" id="1361671">]</span><span class="builtintype" id="1361672">byte</span>&nbsp;<span class="op" id="1361677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1361680">return</span>&nbsp;<span class="ident" id="1361687">FieldsFunc</span><span class="op" id="1361697">(</span><span class="ident" id="1361698">s</span><span class="op" id="1361699">,</span>&nbsp;<span class="ident" id="1361701">unicode</span><span class="op" id="1361708">.</span><span class="ident" id="1361709">IsSpace</span><span class="op" id="1361716">)</span><br>
<span class="lineno"></span><span class="op" id="1361718">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="comment" id="1361721">//&nbsp;FieldsFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1361800">//&nbsp;It&nbsp;splits&nbsp;the&nbsp;slice&nbsp;s&nbsp;at&nbsp;each&nbsp;run&nbsp;of&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1361874">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;subslices&nbsp;of&nbsp;s.&nbsp;&nbsp;If&nbsp;all&nbsp;code&nbsp;points&nbsp;in&nbsp;s&nbsp;satisfy&nbsp;f(c),&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1361954">//&nbsp;len(s)&nbsp;==&nbsp;0,&nbsp;an&nbsp;empty&nbsp;slice&nbsp;is&nbsp;returned.</span><br>
<span class="lineno">270</span><span class="comment" id="1361998">//&nbsp;FieldsFunc&nbsp;makes&nbsp;no&nbsp;guarantees&nbsp;about&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;it&nbsp;calls&nbsp;f(c).</span><br>
<span class="lineno"></span><span class="comment" id="1362072">//&nbsp;If&nbsp;f&nbsp;does&nbsp;not&nbsp;return&nbsp;consistent&nbsp;results&nbsp;for&nbsp;a&nbsp;given&nbsp;c,&nbsp;FieldsFunc&nbsp;may&nbsp;crash.</span><br>
<span class="lineno"></span><span class="keyword" id="1362152">func</span>&nbsp;<span class="ident" id="1362157">FieldsFunc</span><span class="op" id="1362167">(</span><span class="ident" id="1362168">s</span>&nbsp;<span class="op" id="1362170">[</span><span class="op" id="1362171">]</span><span class="builtintype" id="1362172">byte</span><span class="op" id="1362176">,</span>&nbsp;<span class="ident" id="1362178">f</span>&nbsp;<span class="keyword" id="1362180">func</span><span class="op" id="1362184">(</span><span class="builtintype" id="1362185">rune</span><span class="op" id="1362189">)</span>&nbsp;<span class="builtintype" id="1362191">bool</span><span class="op" id="1362195">)</span>&nbsp;<span class="op" id="1362197">[</span><span class="op" id="1362198">]</span><span class="op" id="1362199">[</span><span class="op" id="1362200">]</span><span class="builtintype" id="1362201">byte</span>&nbsp;<span class="op" id="1362206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362209">n</span>&nbsp;<span class="op" id="1362211">:=</span>&nbsp;<span class="num" id="1362214">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362217">inField</span>&nbsp;<span class="op" id="1362225">:=</span>&nbsp;<span class="builtintype" id="1362228">false</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1362235">for</span>&nbsp;<span class="ident" id="1362239">i</span>&nbsp;<span class="op" id="1362241">:=</span>&nbsp;<span class="num" id="1362244">0</span><span class="op" id="1362245">;</span>&nbsp;<span class="ident" id="1362247">i</span>&nbsp;<span class="op" id="1362249">&lt;</span>&nbsp;<span class="builtinfunc" id="1362251">len</span><span class="op" id="1362254">(</span><span class="ident" id="1362255">s</span><span class="op" id="1362256">)</span><span class="op" id="1362257">;</span>&nbsp;<span class="op" id="1362259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362263">r</span><span class="op" id="1362264">,</span>&nbsp;<span class="ident" id="1362266">size</span>&nbsp;<span class="op" id="1362271">:=</span>&nbsp;<span class="ident" id="1362274">utf8</span><span class="op" id="1362278">.</span><span class="ident" id="1362279">DecodeRune</span><span class="op" id="1362289">(</span><span class="ident" id="1362290">s</span><span class="op" id="1362291">[</span><span class="ident" id="1362292">i</span><span class="op" id="1362293">:</span><span class="op" id="1362294">]</span><span class="op" id="1362295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362299">wasInField</span>&nbsp;<span class="op" id="1362310">:=</span>&nbsp;<span class="ident" id="1362313">inField</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362323">inField</span>&nbsp;<span class="op" id="1362331">=</span>&nbsp;<span class="op" id="1362333">!</span><span class="ident" id="1362334">f</span><span class="op" id="1362335">(</span><span class="ident" id="1362336">r</span><span class="op" id="1362337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1362341">if</span>&nbsp;<span class="ident" id="1362344">inField</span>&nbsp;<span class="op" id="1362352">&amp;&amp;</span>&nbsp;<span class="op" id="1362355">!</span><span class="ident" id="1362356">wasInField</span>&nbsp;<span class="op" id="1362367">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362372">n</span><span class="op" id="1362373">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1362378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362382">i</span>&nbsp;<span class="op" id="1362384">+=</span>&nbsp;<span class="ident" id="1362387">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1362393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362397">a</span>&nbsp;<span class="op" id="1362399">:=</span>&nbsp;<span class="builtinfunc" id="1362402">make</span><span class="op" id="1362406">(</span><span class="op" id="1362407">[</span><span class="op" id="1362408">]</span><span class="op" id="1362409">[</span><span class="op" id="1362410">]</span><span class="builtintype" id="1362411">byte</span><span class="op" id="1362415">,</span>&nbsp;<span class="ident" id="1362417">n</span><span class="op" id="1362418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362421">na</span>&nbsp;<span class="op" id="1362424">:=</span>&nbsp;<span class="num" id="1362427">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362430">fieldStart</span>&nbsp;<span class="op" id="1362441">:=</span>&nbsp;<span class="op" id="1362444">-</span><span class="num" id="1362445">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1362448">for</span>&nbsp;<span class="ident" id="1362452">i</span>&nbsp;<span class="op" id="1362454">:=</span>&nbsp;<span class="num" id="1362457">0</span><span class="op" id="1362458">;</span>&nbsp;<span class="ident" id="1362460">i</span>&nbsp;<span class="op" id="1362462">&lt;=</span>&nbsp;<span class="builtinfunc" id="1362465">len</span><span class="op" id="1362468">(</span><span class="ident" id="1362469">s</span><span class="op" id="1362470">)</span>&nbsp;<span class="op" id="1362472">&amp;&amp;</span>&nbsp;<span class="ident" id="1362475">na</span>&nbsp;<span class="op" id="1362478">&lt;</span>&nbsp;<span class="ident" id="1362480">n</span><span class="op" id="1362481">;</span>&nbsp;<span class="op" id="1362483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362487">r</span><span class="op" id="1362488">,</span>&nbsp;<span class="ident" id="1362490">size</span>&nbsp;<span class="op" id="1362495">:=</span>&nbsp;<span class="ident" id="1362498">utf8</span><span class="op" id="1362502">.</span><span class="ident" id="1362503">DecodeRune</span><span class="op" id="1362513">(</span><span class="ident" id="1362514">s</span><span class="op" id="1362515">[</span><span class="ident" id="1362516">i</span><span class="op" id="1362517">:</span><span class="op" id="1362518">]</span><span class="op" id="1362519">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1362523">if</span>&nbsp;<span class="ident" id="1362526">fieldStart</span>&nbsp;<span class="op" id="1362537">&lt;</span>&nbsp;<span class="num" id="1362539">0</span>&nbsp;<span class="op" id="1362541">&amp;&amp;</span>&nbsp;<span class="ident" id="1362544">size</span>&nbsp;<span class="op" id="1362549">&gt;</span>&nbsp;<span class="num" id="1362551">0</span>&nbsp;<span class="op" id="1362553">&amp;&amp;</span>&nbsp;<span class="op" id="1362556">!</span><span class="ident" id="1362557">f</span><span class="op" id="1362558">(</span><span class="ident" id="1362559">r</span><span class="op" id="1362560">)</span>&nbsp;<span class="op" id="1362562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362567">fieldStart</span>&nbsp;<span class="op" id="1362578">=</span>&nbsp;<span class="ident" id="1362580">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362585">i</span>&nbsp;<span class="op" id="1362587">+=</span>&nbsp;<span class="ident" id="1362590">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1362598">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1362609">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1362613">if</span>&nbsp;<span class="ident" id="1362616">fieldStart</span>&nbsp;<span class="op" id="1362627">&gt;=</span>&nbsp;<span class="num" id="1362630">0</span>&nbsp;<span class="op" id="1362632">&amp;&amp;</span>&nbsp;<span class="op" id="1362635">(</span><span class="ident" id="1362636">size</span>&nbsp;<span class="op" id="1362641">==</span>&nbsp;<span class="num" id="1362644">0</span>&nbsp;<span class="op" id="1362646">||</span>&nbsp;<span class="ident" id="1362649">f</span><span class="op" id="1362650">(</span><span class="ident" id="1362651">r</span><span class="op" id="1362652">)</span><span class="op" id="1362653">)</span>&nbsp;<span class="op" id="1362655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362660">a</span><span class="op" id="1362661">[</span><span class="ident" id="1362662">na</span><span class="op" id="1362664">]</span>&nbsp;<span class="op" id="1362666">=</span>&nbsp;<span class="ident" id="1362668">s</span><span class="op" id="1362669">[</span><span class="ident" id="1362670">fieldStart</span><span class="op" id="1362680">:</span><span class="ident" id="1362681">i</span><span class="op" id="1362682">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362687">na</span><span class="op" id="1362689">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362695">fieldStart</span>&nbsp;<span class="op" id="1362706">=</span>&nbsp;<span class="op" id="1362708">-</span><span class="num" id="1362709">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1362713">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1362717">if</span>&nbsp;<span class="ident" id="1362720">size</span>&nbsp;<span class="op" id="1362725">==</span>&nbsp;<span class="num" id="1362728">0</span>&nbsp;<span class="op" id="1362730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1362735">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1362743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1362747">i</span>&nbsp;<span class="op" id="1362749">+=</span>&nbsp;<span class="ident" id="1362752">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1362758">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1362761">return</span>&nbsp;<span class="ident" id="1362768">a</span><span class="op" id="1362769">[</span><span class="num" id="1362770">0</span><span class="op" id="1362771">:</span><span class="ident" id="1362772">na</span><span class="op" id="1362774">]</span><br>
<span class="lineno"></span><span class="op" id="1362776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1362779">//&nbsp;Join&nbsp;concatenates&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;byte&nbsp;slice.&nbsp;The&nbsp;separator</span><br>
<span class="lineno"></span><span class="comment" id="1362860">//&nbsp;sep&nbsp;is&nbsp;placed&nbsp;between&nbsp;elements&nbsp;in&nbsp;the&nbsp;resulting&nbsp;slice.</span><br>
<span class="lineno">310</span><span class="keyword" id="1362918">func</span>&nbsp;<span class="ident" id="1362923">Join</span><span class="op" id="1362927">(</span><span class="ident" id="1362928">s</span>&nbsp;<span class="op" id="1362930">[</span><span class="op" id="1362931">]</span><span class="op" id="1362932">[</span><span class="op" id="1362933">]</span><span class="builtintype" id="1362934">byte</span><span class="op" id="1362938">,</span>&nbsp;<span class="ident" id="1362940">sep</span>&nbsp;<span class="op" id="1362944">[</span><span class="op" id="1362945">]</span><span class="builtintype" id="1362946">byte</span><span class="op" id="1362950">)</span>&nbsp;<span class="op" id="1362952">[</span><span class="op" id="1362953">]</span><span class="builtintype" id="1362954">byte</span>&nbsp;<span class="op" id="1362959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1362962">if</span>&nbsp;<span class="builtinfunc" id="1362965">len</span><span class="op" id="1362968">(</span><span class="ident" id="1362969">s</span><span class="op" id="1362970">)</span>&nbsp;<span class="op" id="1362972">==</span>&nbsp;<span class="num" id="1362975">0</span>&nbsp;<span class="op" id="1362977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1362981">return</span>&nbsp;<span class="op" id="1362988">[</span><span class="op" id="1362989">]</span><span class="builtintype" id="1362990">byte</span><span class="op" id="1362994">{</span><span class="op" id="1362995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1362998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1363001">if</span>&nbsp;<span class="builtinfunc" id="1363004">len</span><span class="op" id="1363007">(</span><span class="ident" id="1363008">s</span><span class="op" id="1363009">)</span>&nbsp;<span class="op" id="1363011">==</span>&nbsp;<span class="num" id="1363014">1</span>&nbsp;<span class="op" id="1363016">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1363020">//&nbsp;Just&nbsp;return&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1363045">return</span>&nbsp;<span class="builtinfunc" id="1363052">append</span><span class="op" id="1363058">(</span><span class="op" id="1363059">[</span><span class="op" id="1363060">]</span><span class="builtintype" id="1363061">byte</span><span class="op" id="1363065">(</span><span class="builtintype" id="1363066">nil</span><span class="op" id="1363069">)</span><span class="op" id="1363070">,</span>&nbsp;<span class="ident" id="1363072">s</span><span class="op" id="1363073">[</span><span class="num" id="1363074">0</span><span class="op" id="1363075">]</span><span class="op" id="1363076">...</span><span class="op" id="1363079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1363082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1363085">n</span>&nbsp;<span class="op" id="1363087">:=</span>&nbsp;<span class="builtinfunc" id="1363090">len</span><span class="op" id="1363093">(</span><span class="ident" id="1363094">sep</span><span class="op" id="1363097">)</span>&nbsp;<span class="op" id="1363099">*</span>&nbsp;<span class="op" id="1363101">(</span><span class="builtinfunc" id="1363102">len</span><span class="op" id="1363105">(</span><span class="ident" id="1363106">s</span><span class="op" id="1363107">)</span>&nbsp;<span class="op" id="1363109">-</span>&nbsp;<span class="num" id="1363111">1</span><span class="op" id="1363112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1363115">for</span>&nbsp;<span class="ident" id="1363119">_</span><span class="op" id="1363120">,</span>&nbsp;<span class="ident" id="1363122">v</span>&nbsp;<span class="op" id="1363124">:=</span>&nbsp;<span class="keyword" id="1363127">range</span>&nbsp;<span class="ident" id="1363133">s</span>&nbsp;<span class="op" id="1363135">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1363139">n</span>&nbsp;<span class="op" id="1363141">+=</span>&nbsp;<span class="builtinfunc" id="1363144">len</span><span class="op" id="1363147">(</span><span class="ident" id="1363148">v</span><span class="op" id="1363149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1363152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1363156">b</span>&nbsp;<span class="op" id="1363158">:=</span>&nbsp;<span class="builtinfunc" id="1363161">make</span><span class="op" id="1363165">(</span><span class="op" id="1363166">[</span><span class="op" id="1363167">]</span><span class="builtintype" id="1363168">byte</span><span class="op" id="1363172">,</span>&nbsp;<span class="ident" id="1363174">n</span><span class="op" id="1363175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1363178">bp</span>&nbsp;<span class="op" id="1363181">:=</span>&nbsp;<span class="builtinfunc" id="1363184">copy</span><span class="op" id="1363188">(</span><span class="ident" id="1363189">b</span><span class="op" id="1363190">,</span>&nbsp;<span class="ident" id="1363192">s</span><span class="op" id="1363193">[</span><span class="num" id="1363194">0</span><span class="op" id="1363195">]</span><span class="op" id="1363196">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1363199">for</span>&nbsp;<span class="ident" id="1363203">_</span><span class="op" id="1363204">,</span>&nbsp;<span class="ident" id="1363206">v</span>&nbsp;<span class="op" id="1363208">:=</span>&nbsp;<span class="keyword" id="1363211">range</span>&nbsp;<span class="ident" id="1363217">s</span><span class="op" id="1363218">[</span><span class="num" id="1363219">1</span><span class="op" id="1363220">:</span><span class="op" id="1363221">]</span>&nbsp;<span class="op" id="1363223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1363227">bp</span>&nbsp;<span class="op" id="1363230">+=</span>&nbsp;<span class="builtinfunc" id="1363233">copy</span><span class="op" id="1363237">(</span><span class="ident" id="1363238">b</span><span class="op" id="1363239">[</span><span class="ident" id="1363240">bp</span><span class="op" id="1363242">:</span><span class="op" id="1363243">]</span><span class="op" id="1363244">,</span>&nbsp;<span class="ident" id="1363246">sep</span><span class="op" id="1363249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1363253">bp</span>&nbsp;<span class="op" id="1363256">+=</span>&nbsp;<span class="builtinfunc" id="1363259">copy</span><span class="op" id="1363263">(</span><span class="ident" id="1363264">b</span><span class="op" id="1363265">[</span><span class="ident" id="1363266">bp</span><span class="op" id="1363268">:</span><span class="op" id="1363269">]</span><span class="op" id="1363270">,</span>&nbsp;<span class="ident" id="1363272">v</span><span class="op" id="1363273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1363276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1363279">return</span>&nbsp;<span class="ident" id="1363286">b</span><br>
<span class="lineno">330</span><span class="op" id="1363288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1363291">//&nbsp;HasPrefix&nbsp;tests&nbsp;whether&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;begins&nbsp;with&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="1363355">func</span>&nbsp;<span class="ident" id="1363360">HasPrefix</span><span class="op" id="1363369">(</span><span class="ident" id="1363370">s</span><span class="op" id="1363371">,</span>&nbsp;<span class="ident" id="1363373">prefix</span>&nbsp;<span class="op" id="1363380">[</span><span class="op" id="1363381">]</span><span class="builtintype" id="1363382">byte</span><span class="op" id="1363386">)</span>&nbsp;<span class="builtintype" id="1363388">bool</span>&nbsp;<span class="op" id="1363393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1363396">return</span>&nbsp;<span class="builtinfunc" id="1363403">len</span><span class="op" id="1363406">(</span><span class="ident" id="1363407">s</span><span class="op" id="1363408">)</span>&nbsp;<span class="op" id="1363410">&gt;=</span>&nbsp;<span class="builtinfunc" id="1363413">len</span><span class="op" id="1363416">(</span><span class="ident" id="1363417">prefix</span><span class="op" id="1363423">)</span>&nbsp;<span class="op" id="1363425">&amp;&amp;</span>&nbsp;<span class="ident" id="1363428">Equal</span><span class="op" id="1363433">(</span><span class="ident" id="1363434">s</span><span class="op" id="1363435">[</span><span class="num" id="1363436">0</span><span class="op" id="1363437">:</span><span class="builtinfunc" id="1363438">len</span><span class="op" id="1363441">(</span><span class="ident" id="1363442">prefix</span><span class="op" id="1363448">)</span><span class="op" id="1363449">]</span><span class="op" id="1363450">,</span>&nbsp;<span class="ident" id="1363452">prefix</span><span class="op" id="1363458">)</span><br>
<span class="lineno">335</span><span class="op" id="1363460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1363463">//&nbsp;HasSuffix&nbsp;tests&nbsp;whether&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;ends&nbsp;with&nbsp;suffix.</span><br>
<span class="lineno"></span><span class="keyword" id="1363525">func</span>&nbsp;<span class="ident" id="1363530">HasSuffix</span><span class="op" id="1363539">(</span><span class="ident" id="1363540">s</span><span class="op" id="1363541">,</span>&nbsp;<span class="ident" id="1363543">suffix</span>&nbsp;<span class="op" id="1363550">[</span><span class="op" id="1363551">]</span><span class="builtintype" id="1363552">byte</span><span class="op" id="1363556">)</span>&nbsp;<span class="builtintype" id="1363558">bool</span>&nbsp;<span class="op" id="1363563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1363566">return</span>&nbsp;<span class="builtinfunc" id="1363573">len</span><span class="op" id="1363576">(</span><span class="ident" id="1363577">s</span><span class="op" id="1363578">)</span>&nbsp;<span class="op" id="1363580">&gt;=</span>&nbsp;<span class="builtinfunc" id="1363583">len</span><span class="op" id="1363586">(</span><span class="ident" id="1363587">suffix</span><span class="op" id="1363593">)</span>&nbsp;<span class="op" id="1363595">&amp;&amp;</span>&nbsp;<span class="ident" id="1363598">Equal</span><span class="op" id="1363603">(</span><span class="ident" id="1363604">s</span><span class="op" id="1363605">[</span><span class="builtinfunc" id="1363606">len</span><span class="op" id="1363609">(</span><span class="ident" id="1363610">s</span><span class="op" id="1363611">)</span><span class="op" id="1363612">-</span><span class="builtinfunc" id="1363613">len</span><span class="op" id="1363616">(</span><span class="ident" id="1363617">suffix</span><span class="op" id="1363623">)</span><span class="op" id="1363624">:</span><span class="op" id="1363625">]</span><span class="op" id="1363626">,</span>&nbsp;<span class="ident" id="1363628">suffix</span><span class="op" id="1363634">)</span><br>
<span class="lineno">340</span><span class="op" id="1363636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1363639">//&nbsp;Map&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;its&nbsp;characters&nbsp;modified</span><br>
<span class="lineno"></span><span class="comment" id="1363714">//&nbsp;according&nbsp;to&nbsp;the&nbsp;mapping&nbsp;function.&nbsp;If&nbsp;mapping&nbsp;returns&nbsp;a&nbsp;negative&nbsp;value,&nbsp;the&nbsp;character&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1363806">//&nbsp;dropped&nbsp;from&nbsp;the&nbsp;string&nbsp;with&nbsp;no&nbsp;replacement.&nbsp;&nbsp;The&nbsp;characters&nbsp;in&nbsp;s&nbsp;and&nbsp;the</span><br>
<span class="lineno">345</span><span class="comment" id="1363883">//&nbsp;output&nbsp;are&nbsp;interpreted&nbsp;as&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="1363947">func</span>&nbsp;<span class="ident" id="1363952">Map</span><span class="op" id="1363955">(</span><span class="ident" id="1363956">mapping</span>&nbsp;<span class="keyword" id="1363964">func</span><span class="op" id="1363968">(</span><span class="ident" id="1363969">r</span>&nbsp;<span class="builtintype" id="1363971">rune</span><span class="op" id="1363975">)</span>&nbsp;<span class="builtintype" id="1363977">rune</span><span class="op" id="1363981">,</span>&nbsp;<span class="ident" id="1363983">s</span>&nbsp;<span class="op" id="1363985">[</span><span class="op" id="1363986">]</span><span class="builtintype" id="1363987">byte</span><span class="op" id="1363991">)</span>&nbsp;<span class="op" id="1363993">[</span><span class="op" id="1363994">]</span><span class="builtintype" id="1363995">byte</span>&nbsp;<span class="op" id="1364000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1364003">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;the&nbsp;slice&nbsp;can&nbsp;grow&nbsp;when&nbsp;mapped,&nbsp;making</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1364065">//&nbsp;things&nbsp;unpleasant.&nbsp;&nbsp;But&nbsp;it&#39;s&nbsp;so&nbsp;rare&nbsp;we&nbsp;barge&nbsp;in&nbsp;assuming&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1364132">//&nbsp;fine.&nbsp;&nbsp;It&nbsp;could&nbsp;also&nbsp;shrink&nbsp;but&nbsp;that&nbsp;falls&nbsp;out&nbsp;naturally.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1364194">maxbytes</span>&nbsp;<span class="op" id="1364203">:=</span>&nbsp;<span class="builtinfunc" id="1364206">len</span><span class="op" id="1364209">(</span><span class="ident" id="1364210">s</span><span class="op" id="1364211">)</span>&nbsp;<span class="comment" id="1364213">//&nbsp;length&nbsp;of&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1364229">nbytes</span>&nbsp;<span class="op" id="1364236">:=</span>&nbsp;<span class="num" id="1364239">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1364248">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;encoded&nbsp;in&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1364281">b</span>&nbsp;<span class="op" id="1364283">:=</span>&nbsp;<span class="builtinfunc" id="1364286">make</span><span class="op" id="1364290">(</span><span class="op" id="1364291">[</span><span class="op" id="1364292">]</span><span class="builtintype" id="1364293">byte</span><span class="op" id="1364297">,</span>&nbsp;<span class="ident" id="1364299">maxbytes</span><span class="op" id="1364307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1364310">for</span>&nbsp;<span class="ident" id="1364314">i</span>&nbsp;<span class="op" id="1364316">:=</span>&nbsp;<span class="num" id="1364319">0</span><span class="op" id="1364320">;</span>&nbsp;<span class="ident" id="1364322">i</span>&nbsp;<span class="op" id="1364324">&lt;</span>&nbsp;<span class="builtinfunc" id="1364326">len</span><span class="op" id="1364329">(</span><span class="ident" id="1364330">s</span><span class="op" id="1364331">)</span><span class="op" id="1364332">;</span>&nbsp;<span class="op" id="1364334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1364338">wid</span>&nbsp;<span class="op" id="1364342">:=</span>&nbsp;<span class="num" id="1364345">1</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1364349">r</span>&nbsp;<span class="op" id="1364351">:=</span>&nbsp;<span class="builtintype" id="1364354">rune</span><span class="op" id="1364358">(</span><span class="ident" id="1364359">s</span><span class="op" id="1364360">[</span><span class="ident" id="1364361">i</span><span class="op" id="1364362">]</span><span class="op" id="1364363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1364367">if</span>&nbsp;<span class="ident" id="1364370">r</span>&nbsp;<span class="op" id="1364372">&gt;=</span>&nbsp;<span class="ident" id="1364375">utf8</span><span class="op" id="1364379">.</span><span class="ident" id="1364380">RuneSelf</span>&nbsp;<span class="op" id="1364389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1364394">r</span><span class="op" id="1364395">,</span>&nbsp;<span class="ident" id="1364397">wid</span>&nbsp;<span class="op" id="1364401">=</span>&nbsp;<span class="ident" id="1364403">utf8</span><span class="op" id="1364407">.</span><span class="ident" id="1364408">DecodeRune</span><span class="op" id="1364418">(</span><span class="ident" id="1364419">s</span><span class="op" id="1364420">[</span><span class="ident" id="1364421">i</span><span class="op" id="1364422">:</span><span class="op" id="1364423">]</span><span class="op" id="1364424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1364428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1364432">r</span>&nbsp;<span class="op" id="1364434">=</span>&nbsp;<span class="ident" id="1364436">mapping</span><span class="op" id="1364443">(</span><span class="ident" id="1364444">r</span><span class="op" id="1364445">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1364449">if</span>&nbsp;<span class="ident" id="1364452">r</span>&nbsp;<span class="op" id="1364454">&gt;=</span>&nbsp;<span class="num" id="1364457">0</span>&nbsp;<span class="op" id="1364459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1364464">rl</span>&nbsp;<span class="op" id="1364467">:=</span>&nbsp;<span class="ident" id="1364470">utf8</span><span class="op" id="1364474">.</span><span class="ident" id="1364475">RuneLen</span><span class="op" id="1364482">(</span><span class="ident" id="1364483">r</span><span class="op" id="1364484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1364489">if</span>&nbsp;<span class="ident" id="1364492">rl</span>&nbsp;<span class="op" id="1364495">&lt;</span>&nbsp;<span class="num" id="1364497">0</span>&nbsp;<span class="op" id="1364499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1364505">rl</span>&nbsp;<span class="op" id="1364508">=</span>&nbsp;<span class="builtinfunc" id="1364510">len</span><span class="op" id="1364513">(</span><span class="builtintype" id="1364514">string</span><span class="op" id="1364520">(</span><span class="ident" id="1364521">utf8</span><span class="op" id="1364525">.</span><span class="ident" id="1364526">RuneError</span><span class="op" id="1364535">)</span><span class="op" id="1364536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1364541">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1364546">if</span>&nbsp;<span class="ident" id="1364549">nbytes</span><span class="op" id="1364555">+</span><span class="ident" id="1364556">rl</span>&nbsp;<span class="op" id="1364559">&gt;</span>&nbsp;<span class="ident" id="1364561">maxbytes</span>&nbsp;<span class="op" id="1364570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1364576">//&nbsp;Grow&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1364600">maxbytes</span>&nbsp;<span class="op" id="1364609">=</span>&nbsp;<span class="ident" id="1364611">maxbytes</span><span class="op" id="1364619">*</span><span class="num" id="1364620">2</span>&nbsp;<span class="op" id="1364622">+</span>&nbsp;<span class="ident" id="1364624">utf8</span><span class="op" id="1364628">.</span><span class="ident" id="1364629">UTFMax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1364640">nb</span>&nbsp;<span class="op" id="1364643">:=</span>&nbsp;<span class="builtinfunc" id="1364646">make</span><span class="op" id="1364650">(</span><span class="op" id="1364651">[</span><span class="op" id="1364652">]</span><span class="builtintype" id="1364653">byte</span><span class="op" id="1364657">,</span>&nbsp;<span class="ident" id="1364659">maxbytes</span><span class="op" id="1364667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1364673">copy</span><span class="op" id="1364677">(</span><span class="ident" id="1364678">nb</span><span class="op" id="1364680">,</span>&nbsp;<span class="ident" id="1364682">b</span><span class="op" id="1364683">[</span><span class="num" id="1364684">0</span><span class="op" id="1364685">:</span><span class="ident" id="1364686">nbytes</span><span class="op" id="1364692">]</span><span class="op" id="1364693">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1364699">b</span>&nbsp;<span class="op" id="1364701">=</span>&nbsp;<span class="ident" id="1364703">nb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1364709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1364714">nbytes</span>&nbsp;<span class="op" id="1364721">+=</span>&nbsp;<span class="ident" id="1364724">utf8</span><span class="op" id="1364728">.</span><span class="ident" id="1364729">EncodeRune</span><span class="op" id="1364739">(</span><span class="ident" id="1364740">b</span><span class="op" id="1364741">[</span><span class="ident" id="1364742">nbytes</span><span class="op" id="1364748">:</span><span class="ident" id="1364749">maxbytes</span><span class="op" id="1364757">]</span><span class="op" id="1364758">,</span>&nbsp;<span class="ident" id="1364760">r</span><span class="op" id="1364761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1364765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1364769">i</span>&nbsp;<span class="op" id="1364771">+=</span>&nbsp;<span class="ident" id="1364774">wid</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1364779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1364782">return</span>&nbsp;<span class="ident" id="1364789">b</span><span class="op" id="1364790">[</span><span class="num" id="1364791">0</span><span class="op" id="1364792">:</span><span class="ident" id="1364793">nbytes</span><span class="op" id="1364799">]</span><br>
<span class="lineno"></span><span class="op" id="1364801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1364804">//&nbsp;Repeat&nbsp;returns&nbsp;a&nbsp;new&nbsp;byte&nbsp;slice&nbsp;consisting&nbsp;of&nbsp;count&nbsp;copies&nbsp;of&nbsp;b.</span><br>
<span class="lineno">380</span><span class="keyword" id="1364872">func</span>&nbsp;<span class="ident" id="1364877">Repeat</span><span class="op" id="1364883">(</span><span class="ident" id="1364884">b</span>&nbsp;<span class="op" id="1364886">[</span><span class="op" id="1364887">]</span><span class="builtintype" id="1364888">byte</span><span class="op" id="1364892">,</span>&nbsp;<span class="ident" id="1364894">count</span>&nbsp;<span class="builtintype" id="1364900">int</span><span class="op" id="1364903">)</span>&nbsp;<span class="op" id="1364905">[</span><span class="op" id="1364906">]</span><span class="builtintype" id="1364907">byte</span>&nbsp;<span class="op" id="1364912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1364915">nb</span>&nbsp;<span class="op" id="1364918">:=</span>&nbsp;<span class="builtinfunc" id="1364921">make</span><span class="op" id="1364925">(</span><span class="op" id="1364926">[</span><span class="op" id="1364927">]</span><span class="builtintype" id="1364928">byte</span><span class="op" id="1364932">,</span>&nbsp;<span class="builtinfunc" id="1364934">len</span><span class="op" id="1364937">(</span><span class="ident" id="1364938">b</span><span class="op" id="1364939">)</span><span class="op" id="1364940">*</span><span class="ident" id="1364941">count</span><span class="op" id="1364946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1364949">bp</span>&nbsp;<span class="op" id="1364952">:=</span>&nbsp;<span class="builtinfunc" id="1364955">copy</span><span class="op" id="1364959">(</span><span class="ident" id="1364960">nb</span><span class="op" id="1364962">,</span>&nbsp;<span class="ident" id="1364964">b</span><span class="op" id="1364965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1364968">for</span>&nbsp;<span class="ident" id="1364972">bp</span>&nbsp;<span class="op" id="1364975">&lt;</span>&nbsp;<span class="builtinfunc" id="1364977">len</span><span class="op" id="1364980">(</span><span class="ident" id="1364981">nb</span><span class="op" id="1364983">)</span>&nbsp;<span class="op" id="1364985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1364989">copy</span><span class="op" id="1364993">(</span><span class="ident" id="1364994">nb</span><span class="op" id="1364996">[</span><span class="ident" id="1364997">bp</span><span class="op" id="1364999">:</span><span class="op" id="1365000">]</span><span class="op" id="1365001">,</span>&nbsp;<span class="ident" id="1365003">nb</span><span class="op" id="1365005">[</span><span class="op" id="1365006">:</span><span class="ident" id="1365007">bp</span><span class="op" id="1365009">]</span><span class="op" id="1365010">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1365014">bp</span>&nbsp;<span class="op" id="1365017">*=</span>&nbsp;<span class="num" id="1365020">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1365023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1365026">return</span>&nbsp;<span class="ident" id="1365033">nb</span><br>
<span class="lineno"></span><span class="op" id="1365036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="1365039">//&nbsp;ToUpper&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1365138">func</span>&nbsp;<span class="ident" id="1365143">ToUpper</span><span class="op" id="1365150">(</span><span class="ident" id="1365151">s</span>&nbsp;<span class="op" id="1365153">[</span><span class="op" id="1365154">]</span><span class="builtintype" id="1365155">byte</span><span class="op" id="1365159">)</span>&nbsp;<span class="op" id="1365161">[</span><span class="op" id="1365162">]</span><span class="builtintype" id="1365163">byte</span>&nbsp;<span class="op" id="1365168">{</span>&nbsp;<span class="keyword" id="1365170">return</span>&nbsp;<span class="ident" id="1365177">Map</span><span class="op" id="1365180">(</span><span class="ident" id="1365181">unicode</span><span class="op" id="1365188">.</span><span class="ident" id="1365189">ToUpper</span><span class="op" id="1365196">,</span>&nbsp;<span class="ident" id="1365198">s</span><span class="op" id="1365199">)</span>&nbsp;<span class="op" id="1365201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1365204">//&nbsp;ToLower&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1365303">func</span>&nbsp;<span class="ident" id="1365308">ToLower</span><span class="op" id="1365315">(</span><span class="ident" id="1365316">s</span>&nbsp;<span class="op" id="1365318">[</span><span class="op" id="1365319">]</span><span class="builtintype" id="1365320">byte</span><span class="op" id="1365324">)</span>&nbsp;<span class="op" id="1365326">[</span><span class="op" id="1365327">]</span><span class="builtintype" id="1365328">byte</span>&nbsp;<span class="op" id="1365333">{</span>&nbsp;<span class="keyword" id="1365335">return</span>&nbsp;<span class="ident" id="1365342">Map</span><span class="op" id="1365345">(</span><span class="ident" id="1365346">unicode</span><span class="op" id="1365353">.</span><span class="ident" id="1365354">ToLower</span><span class="op" id="1365361">,</span>&nbsp;<span class="ident" id="1365363">s</span><span class="op" id="1365364">)</span>&nbsp;<span class="op" id="1365366">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="1365369">//&nbsp;ToTitle&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1365468">func</span>&nbsp;<span class="ident" id="1365473">ToTitle</span><span class="op" id="1365480">(</span><span class="ident" id="1365481">s</span>&nbsp;<span class="op" id="1365483">[</span><span class="op" id="1365484">]</span><span class="builtintype" id="1365485">byte</span><span class="op" id="1365489">)</span>&nbsp;<span class="op" id="1365491">[</span><span class="op" id="1365492">]</span><span class="builtintype" id="1365493">byte</span>&nbsp;<span class="op" id="1365498">{</span>&nbsp;<span class="keyword" id="1365500">return</span>&nbsp;<span class="ident" id="1365507">Map</span><span class="op" id="1365510">(</span><span class="ident" id="1365511">unicode</span><span class="op" id="1365518">.</span><span class="ident" id="1365519">ToTitle</span><span class="op" id="1365526">,</span>&nbsp;<span class="ident" id="1365528">s</span><span class="op" id="1365529">)</span>&nbsp;<span class="op" id="1365531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1365534">//&nbsp;ToUpperSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno">400</span><span class="comment" id="1365628">//&nbsp;upper&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1365688">func</span>&nbsp;<span class="ident" id="1365693">ToUpperSpecial</span><span class="op" id="1365707">(</span><span class="ident" id="1365708">_case</span>&nbsp;<span class="ident" id="1365714">unicode</span><span class="op" id="1365721">.</span><span class="ident" id="1365722">SpecialCase</span><span class="op" id="1365733">,</span>&nbsp;<span class="ident" id="1365735">s</span>&nbsp;<span class="op" id="1365737">[</span><span class="op" id="1365738">]</span><span class="builtintype" id="1365739">byte</span><span class="op" id="1365743">)</span>&nbsp;<span class="op" id="1365745">[</span><span class="op" id="1365746">]</span><span class="builtintype" id="1365747">byte</span>&nbsp;<span class="op" id="1365752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1365755">return</span>&nbsp;<span class="ident" id="1365762">Map</span><span class="op" id="1365765">(</span><span class="keyword" id="1365766">func</span><span class="op" id="1365770">(</span><span class="ident" id="1365771">r</span>&nbsp;<span class="builtintype" id="1365773">rune</span><span class="op" id="1365777">)</span>&nbsp;<span class="builtintype" id="1365779">rune</span>&nbsp;<span class="op" id="1365784">{</span>&nbsp;<span class="keyword" id="1365786">return</span>&nbsp;<span class="ident" id="1365793">_case</span><span class="op" id="1365798">.</span><span class="ident" id="1365799">ToUpper</span><span class="op" id="1365806">(</span><span class="ident" id="1365807">r</span><span class="op" id="1365808">)</span>&nbsp;<span class="op" id="1365810">}</span><span class="op" id="1365811">,</span>&nbsp;<span class="ident" id="1365813">s</span><span class="op" id="1365814">)</span><br>
<span class="lineno"></span><span class="op" id="1365816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="1365819">//&nbsp;ToLowerSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="1365913">//&nbsp;lower&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1365973">func</span>&nbsp;<span class="ident" id="1365978">ToLowerSpecial</span><span class="op" id="1365992">(</span><span class="ident" id="1365993">_case</span>&nbsp;<span class="ident" id="1365999">unicode</span><span class="op" id="1366006">.</span><span class="ident" id="1366007">SpecialCase</span><span class="op" id="1366018">,</span>&nbsp;<span class="ident" id="1366020">s</span>&nbsp;<span class="op" id="1366022">[</span><span class="op" id="1366023">]</span><span class="builtintype" id="1366024">byte</span><span class="op" id="1366028">)</span>&nbsp;<span class="op" id="1366030">[</span><span class="op" id="1366031">]</span><span class="builtintype" id="1366032">byte</span>&nbsp;<span class="op" id="1366037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1366040">return</span>&nbsp;<span class="ident" id="1366047">Map</span><span class="op" id="1366050">(</span><span class="keyword" id="1366051">func</span><span class="op" id="1366055">(</span><span class="ident" id="1366056">r</span>&nbsp;<span class="builtintype" id="1366058">rune</span><span class="op" id="1366062">)</span>&nbsp;<span class="builtintype" id="1366064">rune</span>&nbsp;<span class="op" id="1366069">{</span>&nbsp;<span class="keyword" id="1366071">return</span>&nbsp;<span class="ident" id="1366078">_case</span><span class="op" id="1366083">.</span><span class="ident" id="1366084">ToLower</span><span class="op" id="1366091">(</span><span class="ident" id="1366092">r</span><span class="op" id="1366093">)</span>&nbsp;<span class="op" id="1366095">}</span><span class="op" id="1366096">,</span>&nbsp;<span class="ident" id="1366098">s</span><span class="op" id="1366099">)</span><br>
<span class="lineno"></span><span class="op" id="1366101">}</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="1366104">//&nbsp;ToTitleSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="1366198">//&nbsp;title&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1366258">func</span>&nbsp;<span class="ident" id="1366263">ToTitleSpecial</span><span class="op" id="1366277">(</span><span class="ident" id="1366278">_case</span>&nbsp;<span class="ident" id="1366284">unicode</span><span class="op" id="1366291">.</span><span class="ident" id="1366292">SpecialCase</span><span class="op" id="1366303">,</span>&nbsp;<span class="ident" id="1366305">s</span>&nbsp;<span class="op" id="1366307">[</span><span class="op" id="1366308">]</span><span class="builtintype" id="1366309">byte</span><span class="op" id="1366313">)</span>&nbsp;<span class="op" id="1366315">[</span><span class="op" id="1366316">]</span><span class="builtintype" id="1366317">byte</span>&nbsp;<span class="op" id="1366322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1366325">return</span>&nbsp;<span class="ident" id="1366332">Map</span><span class="op" id="1366335">(</span><span class="keyword" id="1366336">func</span><span class="op" id="1366340">(</span><span class="ident" id="1366341">r</span>&nbsp;<span class="builtintype" id="1366343">rune</span><span class="op" id="1366347">)</span>&nbsp;<span class="builtintype" id="1366349">rune</span>&nbsp;<span class="op" id="1366354">{</span>&nbsp;<span class="keyword" id="1366356">return</span>&nbsp;<span class="ident" id="1366363">_case</span><span class="op" id="1366368">.</span><span class="ident" id="1366369">ToTitle</span><span class="op" id="1366376">(</span><span class="ident" id="1366377">r</span><span class="op" id="1366378">)</span>&nbsp;<span class="op" id="1366380">}</span><span class="op" id="1366381">,</span>&nbsp;<span class="ident" id="1366383">s</span><span class="op" id="1366384">)</span><br>
<span class="lineno">415</span><span class="op" id="1366386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1366389">//&nbsp;isSeparator&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;could&nbsp;mark&nbsp;a&nbsp;word&nbsp;boundary.</span><br>
<span class="lineno"></span><span class="comment" id="1366457">//&nbsp;TODO:&nbsp;update&nbsp;when&nbsp;package&nbsp;unicode&nbsp;captures&nbsp;more&nbsp;of&nbsp;the&nbsp;properties.</span><br>
<span class="lineno"></span><span class="keyword" id="1366527">func</span>&nbsp;<span class="ident" id="1366532">isSeparator</span><span class="op" id="1366543">(</span><span class="ident" id="1366544">r</span>&nbsp;<span class="builtintype" id="1366546">rune</span><span class="op" id="1366550">)</span>&nbsp;<span class="builtintype" id="1366552">bool</span>&nbsp;<span class="op" id="1366557">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1366560">//&nbsp;ASCII&nbsp;alphanumerics&nbsp;and&nbsp;underscore&nbsp;are&nbsp;not&nbsp;separators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1366618">if</span>&nbsp;<span class="ident" id="1366621">r</span>&nbsp;<span class="op" id="1366623">&lt;=</span>&nbsp;<span class="num" id="1366626">0x7F</span>&nbsp;<span class="op" id="1366631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1366635">switch</span>&nbsp;<span class="op" id="1366642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1366646">case</span>&nbsp;<span class="string" id="1366651">&#39;0&#39;</span>&nbsp;<span class="op" id="1366655">&lt;=</span>&nbsp;<span class="ident" id="1366658">r</span>&nbsp;<span class="op" id="1366660">&amp;&amp;</span>&nbsp;<span class="ident" id="1366663">r</span>&nbsp;<span class="op" id="1366665">&lt;=</span>&nbsp;<span class="string" id="1366668">&#39;9&#39;</span><span class="op" id="1366671">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1366676">return</span>&nbsp;<span class="builtintype" id="1366683">false</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1366691">case</span>&nbsp;<span class="string" id="1366696">&#39;a&#39;</span>&nbsp;<span class="op" id="1366700">&lt;=</span>&nbsp;<span class="ident" id="1366703">r</span>&nbsp;<span class="op" id="1366705">&amp;&amp;</span>&nbsp;<span class="ident" id="1366708">r</span>&nbsp;<span class="op" id="1366710">&lt;=</span>&nbsp;<span class="string" id="1366713">&#39;z&#39;</span><span class="op" id="1366716">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1366721">return</span>&nbsp;<span class="builtintype" id="1366728">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1366736">case</span>&nbsp;<span class="string" id="1366741">&#39;A&#39;</span>&nbsp;<span class="op" id="1366745">&lt;=</span>&nbsp;<span class="ident" id="1366748">r</span>&nbsp;<span class="op" id="1366750">&amp;&amp;</span>&nbsp;<span class="ident" id="1366753">r</span>&nbsp;<span class="op" id="1366755">&lt;=</span>&nbsp;<span class="string" id="1366758">&#39;Z&#39;</span><span class="op" id="1366761">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1366766">return</span>&nbsp;<span class="builtintype" id="1366773">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1366781">case</span>&nbsp;<span class="ident" id="1366786">r</span>&nbsp;<span class="op" id="1366788">==</span>&nbsp;<span class="string" id="1366791">&#39;_&#39;</span><span class="op" id="1366794">:</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1366799">return</span>&nbsp;<span class="builtintype" id="1366806">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1366814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1366818">return</span>&nbsp;<span class="builtintype" id="1366825">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1366831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1366834">//&nbsp;Letters&nbsp;and&nbsp;digits&nbsp;are&nbsp;not&nbsp;separators</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1366876">if</span>&nbsp;<span class="ident" id="1366879">unicode</span><span class="op" id="1366886">.</span><span class="ident" id="1366887">IsLetter</span><span class="op" id="1366895">(</span><span class="ident" id="1366896">r</span><span class="op" id="1366897">)</span>&nbsp;<span class="op" id="1366899">||</span>&nbsp;<span class="ident" id="1366902">unicode</span><span class="op" id="1366909">.</span><span class="ident" id="1366910">IsDigit</span><span class="op" id="1366917">(</span><span class="ident" id="1366918">r</span><span class="op" id="1366919">)</span>&nbsp;<span class="op" id="1366921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1366925">return</span>&nbsp;<span class="builtintype" id="1366932">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1366939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1366942">//&nbsp;Otherwise,&nbsp;all&nbsp;we&nbsp;can&nbsp;do&nbsp;for&nbsp;now&nbsp;is&nbsp;treat&nbsp;spaces&nbsp;as&nbsp;separators.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1367010">return</span>&nbsp;<span class="ident" id="1367017">unicode</span><span class="op" id="1367024">.</span><span class="ident" id="1367025">IsSpace</span><span class="op" id="1367032">(</span><span class="ident" id="1367033">r</span><span class="op" id="1367034">)</span><br>
<span class="lineno">440</span><span class="op" id="1367036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1367039">//&nbsp;Title&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;that&nbsp;begin&nbsp;words</span><br>
<span class="lineno"></span><span class="comment" id="1367110">//&nbsp;mapped&nbsp;to&nbsp;their&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="comment" id="1367141">//</span><br>
<span class="lineno">445</span><span class="comment" id="1367144">//&nbsp;BUG:&nbsp;The&nbsp;rule&nbsp;Title&nbsp;uses&nbsp;for&nbsp;word&nbsp;boundaries&nbsp;does&nbsp;not&nbsp;handle&nbsp;Unicode&nbsp;punctuation&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="1367238">func</span>&nbsp;<span class="ident" id="1367243">Title</span><span class="op" id="1367248">(</span><span class="ident" id="1367249">s</span>&nbsp;<span class="op" id="1367251">[</span><span class="op" id="1367252">]</span><span class="builtintype" id="1367253">byte</span><span class="op" id="1367257">)</span>&nbsp;<span class="op" id="1367259">[</span><span class="op" id="1367260">]</span><span class="builtintype" id="1367261">byte</span>&nbsp;<span class="op" id="1367266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1367269">//&nbsp;Use&nbsp;a&nbsp;closure&nbsp;here&nbsp;to&nbsp;remember&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1367311">//&nbsp;Hackish&nbsp;but&nbsp;effective.&nbsp;Depends&nbsp;on&nbsp;Map&nbsp;scanning&nbsp;in&nbsp;order&nbsp;and&nbsp;calling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1367383">//&nbsp;the&nbsp;closure&nbsp;once&nbsp;per&nbsp;rune.</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1367414">prev</span>&nbsp;<span class="op" id="1367419">:=</span>&nbsp;<span class="string" id="1367422">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1367427">return</span>&nbsp;<span class="ident" id="1367434">Map</span><span class="op" id="1367437">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1367441">func</span><span class="op" id="1367445">(</span><span class="ident" id="1367446">r</span>&nbsp;<span class="builtintype" id="1367448">rune</span><span class="op" id="1367452">)</span>&nbsp;<span class="builtintype" id="1367454">rune</span>&nbsp;<span class="op" id="1367459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1367464">if</span>&nbsp;<span class="ident" id="1367467">isSeparator</span><span class="op" id="1367478">(</span><span class="ident" id="1367479">prev</span><span class="op" id="1367483">)</span>&nbsp;<span class="op" id="1367485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1367491">prev</span>&nbsp;<span class="op" id="1367496">=</span>&nbsp;<span class="ident" id="1367498">r</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1367504">return</span>&nbsp;<span class="ident" id="1367511">unicode</span><span class="op" id="1367518">.</span><span class="ident" id="1367519">ToTitle</span><span class="op" id="1367526">(</span><span class="ident" id="1367527">r</span><span class="op" id="1367528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1367533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1367538">prev</span>&nbsp;<span class="op" id="1367543">=</span>&nbsp;<span class="ident" id="1367545">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1367550">return</span>&nbsp;<span class="ident" id="1367557">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1367561">}</span><span class="op" id="1367562">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1367566">s</span><span class="op" id="1367567">)</span><br>
<span class="lineno"></span><span class="op" id="1367569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1367572">//&nbsp;TrimLeftFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;UTF-8-encoded</span><br>
<span class="lineno"></span><span class="comment" id="1367653">//&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno">465</span><span class="keyword" id="1367697">func</span>&nbsp;<span class="ident" id="1367702">TrimLeftFunc</span><span class="op" id="1367714">(</span><span class="ident" id="1367715">s</span>&nbsp;<span class="op" id="1367717">[</span><span class="op" id="1367718">]</span><span class="builtintype" id="1367719">byte</span><span class="op" id="1367723">,</span>&nbsp;<span class="ident" id="1367725">f</span>&nbsp;<span class="keyword" id="1367727">func</span><span class="op" id="1367731">(</span><span class="ident" id="1367732">r</span>&nbsp;<span class="builtintype" id="1367734">rune</span><span class="op" id="1367738">)</span>&nbsp;<span class="builtintype" id="1367740">bool</span><span class="op" id="1367744">)</span>&nbsp;<span class="op" id="1367746">[</span><span class="op" id="1367747">]</span><span class="builtintype" id="1367748">byte</span>&nbsp;<span class="op" id="1367753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1367756">i</span>&nbsp;<span class="op" id="1367758">:=</span>&nbsp;<span class="ident" id="1367761">indexFunc</span><span class="op" id="1367770">(</span><span class="ident" id="1367771">s</span><span class="op" id="1367772">,</span>&nbsp;<span class="ident" id="1367774">f</span><span class="op" id="1367775">,</span>&nbsp;<span class="builtintype" id="1367777">false</span><span class="op" id="1367782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1367785">if</span>&nbsp;<span class="ident" id="1367788">i</span>&nbsp;<span class="op" id="1367790">==</span>&nbsp;<span class="op" id="1367793">-</span><span class="num" id="1367794">1</span>&nbsp;<span class="op" id="1367796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1367800">return</span>&nbsp;<span class="builtintype" id="1367807">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1367812">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1367815">return</span>&nbsp;<span class="ident" id="1367822">s</span><span class="op" id="1367823">[</span><span class="ident" id="1367824">i</span><span class="op" id="1367825">:</span><span class="op" id="1367826">]</span><br>
<span class="lineno"></span><span class="op" id="1367828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1367831">//&nbsp;TrimRightFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;trailing&nbsp;UTF-8</span><br>
<span class="lineno"></span><span class="comment" id="1367906">//&nbsp;encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno">475</span><span class="keyword" id="1367958">func</span>&nbsp;<span class="ident" id="1367963">TrimRightFunc</span><span class="op" id="1367976">(</span><span class="ident" id="1367977">s</span>&nbsp;<span class="op" id="1367979">[</span><span class="op" id="1367980">]</span><span class="builtintype" id="1367981">byte</span><span class="op" id="1367985">,</span>&nbsp;<span class="ident" id="1367987">f</span>&nbsp;<span class="keyword" id="1367989">func</span><span class="op" id="1367993">(</span><span class="ident" id="1367994">r</span>&nbsp;<span class="builtintype" id="1367996">rune</span><span class="op" id="1368000">)</span>&nbsp;<span class="builtintype" id="1368002">bool</span><span class="op" id="1368006">)</span>&nbsp;<span class="op" id="1368008">[</span><span class="op" id="1368009">]</span><span class="builtintype" id="1368010">byte</span>&nbsp;<span class="op" id="1368015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1368018">i</span>&nbsp;<span class="op" id="1368020">:=</span>&nbsp;<span class="ident" id="1368023">lastIndexFunc</span><span class="op" id="1368036">(</span><span class="ident" id="1368037">s</span><span class="op" id="1368038">,</span>&nbsp;<span class="ident" id="1368040">f</span><span class="op" id="1368041">,</span>&nbsp;<span class="builtintype" id="1368043">false</span><span class="op" id="1368048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1368051">if</span>&nbsp;<span class="ident" id="1368054">i</span>&nbsp;<span class="op" id="1368056">&gt;=</span>&nbsp;<span class="num" id="1368059">0</span>&nbsp;<span class="op" id="1368061">&amp;&amp;</span>&nbsp;<span class="ident" id="1368064">s</span><span class="op" id="1368065">[</span><span class="ident" id="1368066">i</span><span class="op" id="1368067">]</span>&nbsp;<span class="op" id="1368069">&gt;=</span>&nbsp;<span class="ident" id="1368072">utf8</span><span class="op" id="1368076">.</span><span class="ident" id="1368077">RuneSelf</span>&nbsp;<span class="op" id="1368086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1368090">_</span><span class="op" id="1368091">,</span>&nbsp;<span class="ident" id="1368093">wid</span>&nbsp;<span class="op" id="1368097">:=</span>&nbsp;<span class="ident" id="1368100">utf8</span><span class="op" id="1368104">.</span><span class="ident" id="1368105">DecodeRune</span><span class="op" id="1368115">(</span><span class="ident" id="1368116">s</span><span class="op" id="1368117">[</span><span class="ident" id="1368118">i</span><span class="op" id="1368119">:</span><span class="op" id="1368120">]</span><span class="op" id="1368121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1368125">i</span>&nbsp;<span class="op" id="1368127">+=</span>&nbsp;<span class="ident" id="1368130">wid</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1368135">}</span>&nbsp;<span class="keyword" id="1368137">else</span>&nbsp;<span class="op" id="1368142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1368146">i</span><span class="op" id="1368147">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1368151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1368154">return</span>&nbsp;<span class="ident" id="1368161">s</span><span class="op" id="1368162">[</span><span class="num" id="1368163">0</span><span class="op" id="1368164">:</span><span class="ident" id="1368165">i</span><span class="op" id="1368166">]</span><br>
<span class="lineno"></span><span class="op" id="1368168">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="comment" id="1368171">//&nbsp;TrimFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="1368247">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno"></span><span class="keyword" id="1368305">func</span>&nbsp;<span class="ident" id="1368310">TrimFunc</span><span class="op" id="1368318">(</span><span class="ident" id="1368319">s</span>&nbsp;<span class="op" id="1368321">[</span><span class="op" id="1368322">]</span><span class="builtintype" id="1368323">byte</span><span class="op" id="1368327">,</span>&nbsp;<span class="ident" id="1368329">f</span>&nbsp;<span class="keyword" id="1368331">func</span><span class="op" id="1368335">(</span><span class="ident" id="1368336">r</span>&nbsp;<span class="builtintype" id="1368338">rune</span><span class="op" id="1368342">)</span>&nbsp;<span class="builtintype" id="1368344">bool</span><span class="op" id="1368348">)</span>&nbsp;<span class="op" id="1368350">[</span><span class="op" id="1368351">]</span><span class="builtintype" id="1368352">byte</span>&nbsp;<span class="op" id="1368357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1368360">return</span>&nbsp;<span class="ident" id="1368367">TrimRightFunc</span><span class="op" id="1368380">(</span><span class="ident" id="1368381">TrimLeftFunc</span><span class="op" id="1368393">(</span><span class="ident" id="1368394">s</span><span class="op" id="1368395">,</span>&nbsp;<span class="ident" id="1368397">f</span><span class="op" id="1368398">)</span><span class="op" id="1368399">,</span>&nbsp;<span class="ident" id="1368401">f</span><span class="op" id="1368402">)</span><br>
<span class="lineno">490</span><span class="op" id="1368404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1368407">//&nbsp;TrimPrefix&nbsp;returns&nbsp;s&nbsp;without&nbsp;the&nbsp;provided&nbsp;leading&nbsp;prefix&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="1368475">//&nbsp;If&nbsp;s&nbsp;doesn&#39;t&nbsp;start&nbsp;with&nbsp;prefix,&nbsp;s&nbsp;is&nbsp;returned&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="1368535">func</span>&nbsp;<span class="ident" id="1368540">TrimPrefix</span><span class="op" id="1368550">(</span><span class="ident" id="1368551">s</span><span class="op" id="1368552">,</span>&nbsp;<span class="ident" id="1368554">prefix</span>&nbsp;<span class="op" id="1368561">[</span><span class="op" id="1368562">]</span><span class="builtintype" id="1368563">byte</span><span class="op" id="1368567">)</span>&nbsp;<span class="op" id="1368569">[</span><span class="op" id="1368570">]</span><span class="builtintype" id="1368571">byte</span>&nbsp;<span class="op" id="1368576">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1368579">if</span>&nbsp;<span class="ident" id="1368582">HasPrefix</span><span class="op" id="1368591">(</span><span class="ident" id="1368592">s</span><span class="op" id="1368593">,</span>&nbsp;<span class="ident" id="1368595">prefix</span><span class="op" id="1368601">)</span>&nbsp;<span class="op" id="1368603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1368607">return</span>&nbsp;<span class="ident" id="1368614">s</span><span class="op" id="1368615">[</span><span class="builtinfunc" id="1368616">len</span><span class="op" id="1368619">(</span><span class="ident" id="1368620">prefix</span><span class="op" id="1368626">)</span><span class="op" id="1368627">:</span><span class="op" id="1368628">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1368631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1368634">return</span>&nbsp;<span class="ident" id="1368641">s</span><br>
<span class="lineno"></span><span class="op" id="1368643">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span><span class="comment" id="1368646">//&nbsp;TrimSuffix&nbsp;returns&nbsp;s&nbsp;without&nbsp;the&nbsp;provided&nbsp;trailing&nbsp;suffix&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="1368715">//&nbsp;If&nbsp;s&nbsp;doesn&#39;t&nbsp;end&nbsp;with&nbsp;suffix,&nbsp;s&nbsp;is&nbsp;returned&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="1368773">func</span>&nbsp;<span class="ident" id="1368778">TrimSuffix</span><span class="op" id="1368788">(</span><span class="ident" id="1368789">s</span><span class="op" id="1368790">,</span>&nbsp;<span class="ident" id="1368792">suffix</span>&nbsp;<span class="op" id="1368799">[</span><span class="op" id="1368800">]</span><span class="builtintype" id="1368801">byte</span><span class="op" id="1368805">)</span>&nbsp;<span class="op" id="1368807">[</span><span class="op" id="1368808">]</span><span class="builtintype" id="1368809">byte</span>&nbsp;<span class="op" id="1368814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1368817">if</span>&nbsp;<span class="ident" id="1368820">HasSuffix</span><span class="op" id="1368829">(</span><span class="ident" id="1368830">s</span><span class="op" id="1368831">,</span>&nbsp;<span class="ident" id="1368833">suffix</span><span class="op" id="1368839">)</span>&nbsp;<span class="op" id="1368841">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1368845">return</span>&nbsp;<span class="ident" id="1368852">s</span><span class="op" id="1368853">[</span><span class="op" id="1368854">:</span><span class="builtinfunc" id="1368855">len</span><span class="op" id="1368858">(</span><span class="ident" id="1368859">s</span><span class="op" id="1368860">)</span><span class="op" id="1368861">-</span><span class="builtinfunc" id="1368862">len</span><span class="op" id="1368865">(</span><span class="ident" id="1368866">suffix</span><span class="op" id="1368872">)</span><span class="op" id="1368873">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1368876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1368879">return</span>&nbsp;<span class="ident" id="1368886">s</span><br>
<span class="lineno"></span><span class="op" id="1368888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span><span class="comment" id="1368891">//&nbsp;IndexFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1368969">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;first&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1369024">//&nbsp;code&nbsp;point&nbsp;satisfying&nbsp;f(c),&nbsp;or&nbsp;-1&nbsp;if&nbsp;none&nbsp;do.</span><br>
<span class="lineno"></span><span class="keyword" id="1369073">func</span>&nbsp;<span class="ident" id="1369078">IndexFunc</span><span class="op" id="1369087">(</span><span class="ident" id="1369088">s</span>&nbsp;<span class="op" id="1369090">[</span><span class="op" id="1369091">]</span><span class="builtintype" id="1369092">byte</span><span class="op" id="1369096">,</span>&nbsp;<span class="ident" id="1369098">f</span>&nbsp;<span class="keyword" id="1369100">func</span><span class="op" id="1369104">(</span><span class="ident" id="1369105">r</span>&nbsp;<span class="builtintype" id="1369107">rune</span><span class="op" id="1369111">)</span>&nbsp;<span class="builtintype" id="1369113">bool</span><span class="op" id="1369117">)</span>&nbsp;<span class="builtintype" id="1369119">int</span>&nbsp;<span class="op" id="1369123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1369126">return</span>&nbsp;<span class="ident" id="1369133">indexFunc</span><span class="op" id="1369142">(</span><span class="ident" id="1369143">s</span><span class="op" id="1369144">,</span>&nbsp;<span class="ident" id="1369146">f</span><span class="op" id="1369147">,</span>&nbsp;<span class="builtintype" id="1369149">true</span><span class="op" id="1369153">)</span><br>
<span class="lineno">515</span><span class="op" id="1369155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1369158">//&nbsp;LastIndexFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1369240">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;last&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1369294">//&nbsp;code&nbsp;point&nbsp;satisfying&nbsp;f(c),&nbsp;or&nbsp;-1&nbsp;if&nbsp;none&nbsp;do.</span><br>
<span class="lineno">520</span><span class="keyword" id="1369343">func</span>&nbsp;<span class="ident" id="1369348">LastIndexFunc</span><span class="op" id="1369361">(</span><span class="ident" id="1369362">s</span>&nbsp;<span class="op" id="1369364">[</span><span class="op" id="1369365">]</span><span class="builtintype" id="1369366">byte</span><span class="op" id="1369370">,</span>&nbsp;<span class="ident" id="1369372">f</span>&nbsp;<span class="keyword" id="1369374">func</span><span class="op" id="1369378">(</span><span class="ident" id="1369379">r</span>&nbsp;<span class="builtintype" id="1369381">rune</span><span class="op" id="1369385">)</span>&nbsp;<span class="builtintype" id="1369387">bool</span><span class="op" id="1369391">)</span>&nbsp;<span class="builtintype" id="1369393">int</span>&nbsp;<span class="op" id="1369397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1369400">return</span>&nbsp;<span class="ident" id="1369407">lastIndexFunc</span><span class="op" id="1369420">(</span><span class="ident" id="1369421">s</span><span class="op" id="1369422">,</span>&nbsp;<span class="ident" id="1369424">f</span><span class="op" id="1369425">,</span>&nbsp;<span class="builtintype" id="1369427">true</span><span class="op" id="1369431">)</span><br>
<span class="lineno"></span><span class="op" id="1369433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1369436">//&nbsp;indexFunc&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;IndexFunc&nbsp;except&nbsp;that&nbsp;if</span><br>
<span class="lineno">525</span><span class="comment" id="1369489">//&nbsp;truth==false,&nbsp;the&nbsp;sense&nbsp;of&nbsp;the&nbsp;predicate&nbsp;function&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1369545">//&nbsp;inverted.</span><br>
<span class="lineno"></span><span class="keyword" id="1369558">func</span>&nbsp;<span class="ident" id="1369563">indexFunc</span><span class="op" id="1369572">(</span><span class="ident" id="1369573">s</span>&nbsp;<span class="op" id="1369575">[</span><span class="op" id="1369576">]</span><span class="builtintype" id="1369577">byte</span><span class="op" id="1369581">,</span>&nbsp;<span class="ident" id="1369583">f</span>&nbsp;<span class="keyword" id="1369585">func</span><span class="op" id="1369589">(</span><span class="ident" id="1369590">r</span>&nbsp;<span class="builtintype" id="1369592">rune</span><span class="op" id="1369596">)</span>&nbsp;<span class="builtintype" id="1369598">bool</span><span class="op" id="1369602">,</span>&nbsp;<span class="ident" id="1369604">truth</span>&nbsp;<span class="builtintype" id="1369610">bool</span><span class="op" id="1369614">)</span>&nbsp;<span class="builtintype" id="1369616">int</span>&nbsp;<span class="op" id="1369620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1369623">start</span>&nbsp;<span class="op" id="1369629">:=</span>&nbsp;<span class="num" id="1369632">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1369635">for</span>&nbsp;<span class="ident" id="1369639">start</span>&nbsp;<span class="op" id="1369645">&lt;</span>&nbsp;<span class="builtinfunc" id="1369647">len</span><span class="op" id="1369650">(</span><span class="ident" id="1369651">s</span><span class="op" id="1369652">)</span>&nbsp;<span class="op" id="1369654">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1369658">wid</span>&nbsp;<span class="op" id="1369662">:=</span>&nbsp;<span class="num" id="1369665">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1369669">r</span>&nbsp;<span class="op" id="1369671">:=</span>&nbsp;<span class="builtintype" id="1369674">rune</span><span class="op" id="1369678">(</span><span class="ident" id="1369679">s</span><span class="op" id="1369680">[</span><span class="ident" id="1369681">start</span><span class="op" id="1369686">]</span><span class="op" id="1369687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1369691">if</span>&nbsp;<span class="ident" id="1369694">r</span>&nbsp;<span class="op" id="1369696">&gt;=</span>&nbsp;<span class="ident" id="1369699">utf8</span><span class="op" id="1369703">.</span><span class="ident" id="1369704">RuneSelf</span>&nbsp;<span class="op" id="1369713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1369718">r</span><span class="op" id="1369719">,</span>&nbsp;<span class="ident" id="1369721">wid</span>&nbsp;<span class="op" id="1369725">=</span>&nbsp;<span class="ident" id="1369727">utf8</span><span class="op" id="1369731">.</span><span class="ident" id="1369732">DecodeRune</span><span class="op" id="1369742">(</span><span class="ident" id="1369743">s</span><span class="op" id="1369744">[</span><span class="ident" id="1369745">start</span><span class="op" id="1369750">:</span><span class="op" id="1369751">]</span><span class="op" id="1369752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1369756">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1369760">if</span>&nbsp;<span class="ident" id="1369763">f</span><span class="op" id="1369764">(</span><span class="ident" id="1369765">r</span><span class="op" id="1369766">)</span>&nbsp;<span class="op" id="1369768">==</span>&nbsp;<span class="ident" id="1369771">truth</span>&nbsp;<span class="op" id="1369777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1369782">return</span>&nbsp;<span class="ident" id="1369789">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1369797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1369801">start</span>&nbsp;<span class="op" id="1369807">+=</span>&nbsp;<span class="ident" id="1369810">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1369815">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1369818">return</span>&nbsp;<span class="op" id="1369825">-</span><span class="num" id="1369826">1</span><br>
<span class="lineno"></span><span class="op" id="1369828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1369831">//&nbsp;lastIndexFunc&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;LastIndexFunc&nbsp;except&nbsp;that&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1369892">//&nbsp;truth==false,&nbsp;the&nbsp;sense&nbsp;of&nbsp;the&nbsp;predicate&nbsp;function&nbsp;is</span><br>
<span class="lineno">545</span><span class="comment" id="1369948">//&nbsp;inverted.</span><br>
<span class="lineno"></span><span class="keyword" id="1369961">func</span>&nbsp;<span class="ident" id="1369966">lastIndexFunc</span><span class="op" id="1369979">(</span><span class="ident" id="1369980">s</span>&nbsp;<span class="op" id="1369982">[</span><span class="op" id="1369983">]</span><span class="builtintype" id="1369984">byte</span><span class="op" id="1369988">,</span>&nbsp;<span class="ident" id="1369990">f</span>&nbsp;<span class="keyword" id="1369992">func</span><span class="op" id="1369996">(</span><span class="ident" id="1369997">r</span>&nbsp;<span class="builtintype" id="1369999">rune</span><span class="op" id="1370003">)</span>&nbsp;<span class="builtintype" id="1370005">bool</span><span class="op" id="1370009">,</span>&nbsp;<span class="ident" id="1370011">truth</span>&nbsp;<span class="builtintype" id="1370017">bool</span><span class="op" id="1370021">)</span>&nbsp;<span class="builtintype" id="1370023">int</span>&nbsp;<span class="op" id="1370027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1370030">for</span>&nbsp;<span class="ident" id="1370034">i</span>&nbsp;<span class="op" id="1370036">:=</span>&nbsp;<span class="builtinfunc" id="1370039">len</span><span class="op" id="1370042">(</span><span class="ident" id="1370043">s</span><span class="op" id="1370044">)</span><span class="op" id="1370045">;</span>&nbsp;<span class="ident" id="1370047">i</span>&nbsp;<span class="op" id="1370049">&gt;</span>&nbsp;<span class="num" id="1370051">0</span><span class="op" id="1370052">;</span>&nbsp;<span class="op" id="1370054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370058">r</span><span class="op" id="1370059">,</span>&nbsp;<span class="ident" id="1370061">size</span>&nbsp;<span class="op" id="1370066">:=</span>&nbsp;<span class="builtintype" id="1370069">rune</span><span class="op" id="1370073">(</span><span class="ident" id="1370074">s</span><span class="op" id="1370075">[</span><span class="ident" id="1370076">i</span><span class="op" id="1370077">-</span><span class="num" id="1370078">1</span><span class="op" id="1370079">]</span><span class="op" id="1370080">)</span><span class="op" id="1370081">,</span>&nbsp;<span class="num" id="1370083">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1370087">if</span>&nbsp;<span class="ident" id="1370090">r</span>&nbsp;<span class="op" id="1370092">&gt;=</span>&nbsp;<span class="ident" id="1370095">utf8</span><span class="op" id="1370099">.</span><span class="ident" id="1370100">RuneSelf</span>&nbsp;<span class="op" id="1370109">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370114">r</span><span class="op" id="1370115">,</span>&nbsp;<span class="ident" id="1370117">size</span>&nbsp;<span class="op" id="1370122">=</span>&nbsp;<span class="ident" id="1370124">utf8</span><span class="op" id="1370128">.</span><span class="ident" id="1370129">DecodeLastRune</span><span class="op" id="1370143">(</span><span class="ident" id="1370144">s</span><span class="op" id="1370145">[</span><span class="num" id="1370146">0</span><span class="op" id="1370147">:</span><span class="ident" id="1370148">i</span><span class="op" id="1370149">]</span><span class="op" id="1370150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1370154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1370158">i</span>&nbsp;<span class="op" id="1370160">-=</span>&nbsp;<span class="ident" id="1370163">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1370170">if</span>&nbsp;<span class="ident" id="1370173">f</span><span class="op" id="1370174">(</span><span class="ident" id="1370175">r</span><span class="op" id="1370176">)</span>&nbsp;<span class="op" id="1370178">==</span>&nbsp;<span class="ident" id="1370181">truth</span>&nbsp;<span class="op" id="1370187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1370192">return</span>&nbsp;<span class="ident" id="1370199">i</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1370203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1370206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1370209">return</span>&nbsp;<span class="op" id="1370216">-</span><span class="num" id="1370217">1</span><br>
<span class="lineno"></span><span class="op" id="1370219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="keyword" id="1370222">func</span>&nbsp;<span class="ident" id="1370227">makeCutsetFunc</span><span class="op" id="1370241">(</span><span class="ident" id="1370242">cutset</span>&nbsp;<span class="builtintype" id="1370249">string</span><span class="op" id="1370255">)</span>&nbsp;<span class="keyword" id="1370257">func</span><span class="op" id="1370261">(</span><span class="ident" id="1370262">r</span>&nbsp;<span class="builtintype" id="1370264">rune</span><span class="op" id="1370268">)</span>&nbsp;<span class="builtintype" id="1370270">bool</span>&nbsp;<span class="op" id="1370275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1370278">return</span>&nbsp;<span class="keyword" id="1370285">func</span><span class="op" id="1370289">(</span><span class="ident" id="1370290">r</span>&nbsp;<span class="builtintype" id="1370292">rune</span><span class="op" id="1370296">)</span>&nbsp;<span class="builtintype" id="1370298">bool</span>&nbsp;<span class="op" id="1370303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1370307">for</span>&nbsp;<span class="ident" id="1370311">_</span><span class="op" id="1370312">,</span>&nbsp;<span class="ident" id="1370314">c</span>&nbsp;<span class="op" id="1370316">:=</span>&nbsp;<span class="keyword" id="1370319">range</span>&nbsp;<span class="ident" id="1370325">cutset</span>&nbsp;<span class="op" id="1370332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1370337">if</span>&nbsp;<span class="ident" id="1370340">c</span>&nbsp;<span class="op" id="1370342">==</span>&nbsp;<span class="ident" id="1370345">r</span>&nbsp;<span class="op" id="1370347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1370353">return</span>&nbsp;<span class="builtintype" id="1370360">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1370368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1370372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1370376">return</span>&nbsp;<span class="builtintype" id="1370383">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1370390">}</span><br>
<span class="lineno"></span><span class="op" id="1370392">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="1370395">//&nbsp;Trim&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1370458">//&nbsp;trailing&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno"></span><span class="keyword" id="1370525">func</span>&nbsp;<span class="ident" id="1370530">Trim</span><span class="op" id="1370534">(</span><span class="ident" id="1370535">s</span>&nbsp;<span class="op" id="1370537">[</span><span class="op" id="1370538">]</span><span class="builtintype" id="1370539">byte</span><span class="op" id="1370543">,</span>&nbsp;<span class="ident" id="1370545">cutset</span>&nbsp;<span class="builtintype" id="1370552">string</span><span class="op" id="1370558">)</span>&nbsp;<span class="op" id="1370560">[</span><span class="op" id="1370561">]</span><span class="builtintype" id="1370562">byte</span>&nbsp;<span class="op" id="1370567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1370570">return</span>&nbsp;<span class="ident" id="1370577">TrimFunc</span><span class="op" id="1370585">(</span><span class="ident" id="1370586">s</span><span class="op" id="1370587">,</span>&nbsp;<span class="ident" id="1370589">makeCutsetFunc</span><span class="op" id="1370603">(</span><span class="ident" id="1370604">cutset</span><span class="op" id="1370610">)</span><span class="op" id="1370611">)</span><br>
<span class="lineno">575</span><span class="op" id="1370613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1370616">//&nbsp;TrimLeft&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="1370679">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno"></span><span class="keyword" id="1370737">func</span>&nbsp;<span class="ident" id="1370742">TrimLeft</span><span class="op" id="1370750">(</span><span class="ident" id="1370751">s</span>&nbsp;<span class="op" id="1370753">[</span><span class="op" id="1370754">]</span><span class="builtintype" id="1370755">byte</span><span class="op" id="1370759">,</span>&nbsp;<span class="ident" id="1370761">cutset</span>&nbsp;<span class="builtintype" id="1370768">string</span><span class="op" id="1370774">)</span>&nbsp;<span class="op" id="1370776">[</span><span class="op" id="1370777">]</span><span class="builtintype" id="1370778">byte</span>&nbsp;<span class="op" id="1370783">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1370786">return</span>&nbsp;<span class="ident" id="1370793">TrimLeftFunc</span><span class="op" id="1370805">(</span><span class="ident" id="1370806">s</span><span class="op" id="1370807">,</span>&nbsp;<span class="ident" id="1370809">makeCutsetFunc</span><span class="op" id="1370823">(</span><span class="ident" id="1370824">cutset</span><span class="op" id="1370830">)</span><span class="op" id="1370831">)</span><br>
<span class="lineno"></span><span class="op" id="1370833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1370836">//&nbsp;TrimRight&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="1370901">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;that&nbsp;are&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno">585</span><span class="keyword" id="1370968">func</span>&nbsp;<span class="ident" id="1370973">TrimRight</span><span class="op" id="1370982">(</span><span class="ident" id="1370983">s</span>&nbsp;<span class="op" id="1370985">[</span><span class="op" id="1370986">]</span><span class="builtintype" id="1370987">byte</span><span class="op" id="1370991">,</span>&nbsp;<span class="ident" id="1370993">cutset</span>&nbsp;<span class="builtintype" id="1371000">string</span><span class="op" id="1371006">)</span>&nbsp;<span class="op" id="1371008">[</span><span class="op" id="1371009">]</span><span class="builtintype" id="1371010">byte</span>&nbsp;<span class="op" id="1371015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1371018">return</span>&nbsp;<span class="ident" id="1371025">TrimRightFunc</span><span class="op" id="1371038">(</span><span class="ident" id="1371039">s</span><span class="op" id="1371040">,</span>&nbsp;<span class="ident" id="1371042">makeCutsetFunc</span><span class="op" id="1371056">(</span><span class="ident" id="1371057">cutset</span><span class="op" id="1371063">)</span><span class="op" id="1371064">)</span><br>
<span class="lineno"></span><span class="op" id="1371066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1371069">//&nbsp;TrimSpace&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and</span><br>
<span class="lineno">590</span><span class="comment" id="1371137">//&nbsp;trailing&nbsp;white&nbsp;space,&nbsp;as&nbsp;defined&nbsp;by&nbsp;Unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="1371185">func</span>&nbsp;<span class="ident" id="1371190">TrimSpace</span><span class="op" id="1371199">(</span><span class="ident" id="1371200">s</span>&nbsp;<span class="op" id="1371202">[</span><span class="op" id="1371203">]</span><span class="builtintype" id="1371204">byte</span><span class="op" id="1371208">)</span>&nbsp;<span class="op" id="1371210">[</span><span class="op" id="1371211">]</span><span class="builtintype" id="1371212">byte</span>&nbsp;<span class="op" id="1371217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1371220">return</span>&nbsp;<span class="ident" id="1371227">TrimFunc</span><span class="op" id="1371235">(</span><span class="ident" id="1371236">s</span><span class="op" id="1371237">,</span>&nbsp;<span class="ident" id="1371239">unicode</span><span class="op" id="1371246">.</span><span class="ident" id="1371247">IsSpace</span><span class="op" id="1371254">)</span><br>
<span class="lineno"></span><span class="op" id="1371256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="1371259">//&nbsp;Runes&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;runes&nbsp;(Unicode&nbsp;code&nbsp;points)&nbsp;equivalent&nbsp;to&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1371332">func</span>&nbsp;<span class="ident" id="1371337">Runes</span><span class="op" id="1371342">(</span><span class="ident" id="1371343">s</span>&nbsp;<span class="op" id="1371345">[</span><span class="op" id="1371346">]</span><span class="builtintype" id="1371347">byte</span><span class="op" id="1371351">)</span>&nbsp;<span class="op" id="1371353">[</span><span class="op" id="1371354">]</span><span class="builtintype" id="1371355">rune</span>&nbsp;<span class="op" id="1371360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1371363">t</span>&nbsp;<span class="op" id="1371365">:=</span>&nbsp;<span class="builtinfunc" id="1371368">make</span><span class="op" id="1371372">(</span><span class="op" id="1371373">[</span><span class="op" id="1371374">]</span><span class="builtintype" id="1371375">rune</span><span class="op" id="1371379">,</span>&nbsp;<span class="ident" id="1371381">utf8</span><span class="op" id="1371385">.</span><span class="ident" id="1371386">RuneCount</span><span class="op" id="1371395">(</span><span class="ident" id="1371396">s</span><span class="op" id="1371397">)</span><span class="op" id="1371398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1371401">i</span>&nbsp;<span class="op" id="1371403">:=</span>&nbsp;<span class="num" id="1371406">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1371409">for</span>&nbsp;<span class="builtinfunc" id="1371413">len</span><span class="op" id="1371416">(</span><span class="ident" id="1371417">s</span><span class="op" id="1371418">)</span>&nbsp;<span class="op" id="1371420">&gt;</span>&nbsp;<span class="num" id="1371422">0</span>&nbsp;<span class="op" id="1371424">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1371428">r</span><span class="op" id="1371429">,</span>&nbsp;<span class="ident" id="1371431">l</span>&nbsp;<span class="op" id="1371433">:=</span>&nbsp;<span class="ident" id="1371436">utf8</span><span class="op" id="1371440">.</span><span class="ident" id="1371441">DecodeRune</span><span class="op" id="1371451">(</span><span class="ident" id="1371452">s</span><span class="op" id="1371453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1371457">t</span><span class="op" id="1371458">[</span><span class="ident" id="1371459">i</span><span class="op" id="1371460">]</span>&nbsp;<span class="op" id="1371462">=</span>&nbsp;<span class="ident" id="1371464">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1371468">i</span><span class="op" id="1371469">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1371474">s</span>&nbsp;<span class="op" id="1371476">=</span>&nbsp;<span class="ident" id="1371478">s</span><span class="op" id="1371479">[</span><span class="ident" id="1371480">l</span><span class="op" id="1371481">:</span><span class="op" id="1371482">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1371485">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1371488">return</span>&nbsp;<span class="ident" id="1371495">t</span><br>
<span class="lineno"></span><span class="op" id="1371497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1371500">//&nbsp;Replace&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;slice&nbsp;s&nbsp;with&nbsp;the&nbsp;first&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="1371558">//&nbsp;non-overlapping&nbsp;instances&nbsp;of&nbsp;old&nbsp;replaced&nbsp;by&nbsp;new.</span><br>
<span class="lineno">610</span><span class="comment" id="1371611">//&nbsp;If&nbsp;old&nbsp;is&nbsp;empty,&nbsp;it&nbsp;matches&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="1371672">//&nbsp;and&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence,&nbsp;yielding&nbsp;up&nbsp;to&nbsp;k+1&nbsp;replacements</span><br>
<span class="lineno"></span><span class="comment" id="1371738">//&nbsp;for&nbsp;a&nbsp;k-rune&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="1371761">//&nbsp;If&nbsp;n&nbsp;&lt;&nbsp;0,&nbsp;there&nbsp;is&nbsp;no&nbsp;limit&nbsp;on&nbsp;the&nbsp;number&nbsp;of&nbsp;replacements.</span><br>
<span class="lineno"></span><span class="keyword" id="1371823">func</span>&nbsp;<span class="ident" id="1371828">Replace</span><span class="op" id="1371835">(</span><span class="ident" id="1371836">s</span><span class="op" id="1371837">,</span>&nbsp;<span class="ident" id="1371839">old</span><span class="op" id="1371842">,</span>&nbsp;<span class="builtinfunc" id="1371844">new</span>&nbsp;<span class="op" id="1371848">[</span><span class="op" id="1371849">]</span><span class="builtintype" id="1371850">byte</span><span class="op" id="1371854">,</span>&nbsp;<span class="ident" id="1371856">n</span>&nbsp;<span class="builtintype" id="1371858">int</span><span class="op" id="1371861">)</span>&nbsp;<span class="op" id="1371863">[</span><span class="op" id="1371864">]</span><span class="builtintype" id="1371865">byte</span>&nbsp;<span class="op" id="1371870">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1371873">m</span>&nbsp;<span class="op" id="1371875">:=</span>&nbsp;<span class="num" id="1371878">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1371881">if</span>&nbsp;<span class="ident" id="1371884">n</span>&nbsp;<span class="op" id="1371886">!=</span>&nbsp;<span class="num" id="1371889">0</span>&nbsp;<span class="op" id="1371891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1371895">//&nbsp;Compute&nbsp;number&nbsp;of&nbsp;replacements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1371932">m</span>&nbsp;<span class="op" id="1371934">=</span>&nbsp;<span class="ident" id="1371936">Count</span><span class="op" id="1371941">(</span><span class="ident" id="1371942">s</span><span class="op" id="1371943">,</span>&nbsp;<span class="ident" id="1371945">old</span><span class="op" id="1371948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1371951">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1371954">if</span>&nbsp;<span class="ident" id="1371957">m</span>&nbsp;<span class="op" id="1371959">==</span>&nbsp;<span class="num" id="1371962">0</span>&nbsp;<span class="op" id="1371964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1371968">//&nbsp;Just&nbsp;return&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1371993">return</span>&nbsp;<span class="builtinfunc" id="1372000">append</span><span class="op" id="1372006">(</span><span class="op" id="1372007">[</span><span class="op" id="1372008">]</span><span class="builtintype" id="1372009">byte</span><span class="op" id="1372013">(</span><span class="builtintype" id="1372014">nil</span><span class="op" id="1372017">)</span><span class="op" id="1372018">,</span>&nbsp;<span class="ident" id="1372020">s</span><span class="op" id="1372021">...</span><span class="op" id="1372024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1372027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1372030">if</span>&nbsp;<span class="ident" id="1372033">n</span>&nbsp;<span class="op" id="1372035">&lt;</span>&nbsp;<span class="num" id="1372037">0</span>&nbsp;<span class="op" id="1372039">||</span>&nbsp;<span class="ident" id="1372042">m</span>&nbsp;<span class="op" id="1372044">&lt;</span>&nbsp;<span class="ident" id="1372046">n</span>&nbsp;<span class="op" id="1372048">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372052">n</span>&nbsp;<span class="op" id="1372054">=</span>&nbsp;<span class="ident" id="1372056">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1372059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1372063">//&nbsp;Apply&nbsp;replacements&nbsp;to&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372097">t</span>&nbsp;<span class="op" id="1372099">:=</span>&nbsp;<span class="builtinfunc" id="1372102">make</span><span class="op" id="1372106">(</span><span class="op" id="1372107">[</span><span class="op" id="1372108">]</span><span class="builtintype" id="1372109">byte</span><span class="op" id="1372113">,</span>&nbsp;<span class="builtinfunc" id="1372115">len</span><span class="op" id="1372118">(</span><span class="ident" id="1372119">s</span><span class="op" id="1372120">)</span><span class="op" id="1372121">+</span><span class="ident" id="1372122">n</span><span class="op" id="1372123">*</span><span class="op" id="1372124">(</span><span class="builtinfunc" id="1372125">len</span><span class="op" id="1372128">(</span><span class="builtinfunc" id="1372129">new</span><span class="op" id="1372132">)</span><span class="op" id="1372133">-</span><span class="builtinfunc" id="1372134">len</span><span class="op" id="1372137">(</span><span class="ident" id="1372138">old</span><span class="op" id="1372141">)</span><span class="op" id="1372142">)</span><span class="op" id="1372143">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372146">w</span>&nbsp;<span class="op" id="1372148">:=</span>&nbsp;<span class="num" id="1372151">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372154">start</span>&nbsp;<span class="op" id="1372160">:=</span>&nbsp;<span class="num" id="1372163">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1372166">for</span>&nbsp;<span class="ident" id="1372170">i</span>&nbsp;<span class="op" id="1372172">:=</span>&nbsp;<span class="num" id="1372175">0</span><span class="op" id="1372176">;</span>&nbsp;<span class="ident" id="1372178">i</span>&nbsp;<span class="op" id="1372180">&lt;</span>&nbsp;<span class="ident" id="1372182">n</span><span class="op" id="1372183">;</span>&nbsp;<span class="ident" id="1372185">i</span><span class="op" id="1372186">++</span>&nbsp;<span class="op" id="1372189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372193">j</span>&nbsp;<span class="op" id="1372195">:=</span>&nbsp;<span class="ident" id="1372198">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1372206">if</span>&nbsp;<span class="builtinfunc" id="1372209">len</span><span class="op" id="1372212">(</span><span class="ident" id="1372213">old</span><span class="op" id="1372216">)</span>&nbsp;<span class="op" id="1372218">==</span>&nbsp;<span class="num" id="1372221">0</span>&nbsp;<span class="op" id="1372223">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1372228">if</span>&nbsp;<span class="ident" id="1372231">i</span>&nbsp;<span class="op" id="1372233">&gt;</span>&nbsp;<span class="num" id="1372235">0</span>&nbsp;<span class="op" id="1372237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372243">_</span><span class="op" id="1372244">,</span>&nbsp;<span class="ident" id="1372246">wid</span>&nbsp;<span class="op" id="1372250">:=</span>&nbsp;<span class="ident" id="1372253">utf8</span><span class="op" id="1372257">.</span><span class="ident" id="1372258">DecodeRune</span><span class="op" id="1372268">(</span><span class="ident" id="1372269">s</span><span class="op" id="1372270">[</span><span class="ident" id="1372271">start</span><span class="op" id="1372276">:</span><span class="op" id="1372277">]</span><span class="op" id="1372278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372284">j</span>&nbsp;<span class="op" id="1372286">+=</span>&nbsp;<span class="ident" id="1372289">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1372296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1372300">}</span>&nbsp;<span class="keyword" id="1372302">else</span>&nbsp;<span class="op" id="1372307">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372312">j</span>&nbsp;<span class="op" id="1372314">+=</span>&nbsp;<span class="ident" id="1372317">Index</span><span class="op" id="1372322">(</span><span class="ident" id="1372323">s</span><span class="op" id="1372324">[</span><span class="ident" id="1372325">start</span><span class="op" id="1372330">:</span><span class="op" id="1372331">]</span><span class="op" id="1372332">,</span>&nbsp;<span class="ident" id="1372334">old</span><span class="op" id="1372337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1372341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372345">w</span>&nbsp;<span class="op" id="1372347">+=</span>&nbsp;<span class="builtinfunc" id="1372350">copy</span><span class="op" id="1372354">(</span><span class="ident" id="1372355">t</span><span class="op" id="1372356">[</span><span class="ident" id="1372357">w</span><span class="op" id="1372358">:</span><span class="op" id="1372359">]</span><span class="op" id="1372360">,</span>&nbsp;<span class="ident" id="1372362">s</span><span class="op" id="1372363">[</span><span class="ident" id="1372364">start</span><span class="op" id="1372369">:</span><span class="ident" id="1372370">j</span><span class="op" id="1372371">]</span><span class="op" id="1372372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372376">w</span>&nbsp;<span class="op" id="1372378">+=</span>&nbsp;<span class="builtinfunc" id="1372381">copy</span><span class="op" id="1372385">(</span><span class="ident" id="1372386">t</span><span class="op" id="1372387">[</span><span class="ident" id="1372388">w</span><span class="op" id="1372389">:</span><span class="op" id="1372390">]</span><span class="op" id="1372391">,</span>&nbsp;<span class="builtinfunc" id="1372393">new</span><span class="op" id="1372396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372400">start</span>&nbsp;<span class="op" id="1372406">=</span>&nbsp;<span class="ident" id="1372408">j</span>&nbsp;<span class="op" id="1372410">+</span>&nbsp;<span class="builtinfunc" id="1372412">len</span><span class="op" id="1372415">(</span><span class="ident" id="1372416">old</span><span class="op" id="1372419">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1372422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372425">w</span>&nbsp;<span class="op" id="1372427">+=</span>&nbsp;<span class="builtinfunc" id="1372430">copy</span><span class="op" id="1372434">(</span><span class="ident" id="1372435">t</span><span class="op" id="1372436">[</span><span class="ident" id="1372437">w</span><span class="op" id="1372438">:</span><span class="op" id="1372439">]</span><span class="op" id="1372440">,</span>&nbsp;<span class="ident" id="1372442">s</span><span class="op" id="1372443">[</span><span class="ident" id="1372444">start</span><span class="op" id="1372449">:</span><span class="op" id="1372450">]</span><span class="op" id="1372451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1372454">return</span>&nbsp;<span class="ident" id="1372461">t</span><span class="op" id="1372462">[</span><span class="num" id="1372463">0</span><span class="op" id="1372464">:</span><span class="ident" id="1372465">w</span><span class="op" id="1372466">]</span><br>
<span class="lineno"></span><span class="op" id="1372468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="1372471">//&nbsp;EqualFold&nbsp;reports&nbsp;whether&nbsp;s&nbsp;and&nbsp;t,&nbsp;interpreted&nbsp;as&nbsp;UTF-8&nbsp;strings,</span><br>
<span class="lineno"></span><span class="comment" id="1372539">//&nbsp;are&nbsp;equal&nbsp;under&nbsp;Unicode&nbsp;case-folding.</span><br>
<span class="lineno"></span><span class="keyword" id="1372580">func</span>&nbsp;<span class="ident" id="1372585">EqualFold</span><span class="op" id="1372594">(</span><span class="ident" id="1372595">s</span><span class="op" id="1372596">,</span>&nbsp;<span class="ident" id="1372598">t</span>&nbsp;<span class="op" id="1372600">[</span><span class="op" id="1372601">]</span><span class="builtintype" id="1372602">byte</span><span class="op" id="1372606">)</span>&nbsp;<span class="builtintype" id="1372608">bool</span>&nbsp;<span class="op" id="1372613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1372616">for</span>&nbsp;<span class="builtinfunc" id="1372620">len</span><span class="op" id="1372623">(</span><span class="ident" id="1372624">s</span><span class="op" id="1372625">)</span>&nbsp;<span class="op" id="1372627">!=</span>&nbsp;<span class="num" id="1372630">0</span>&nbsp;<span class="op" id="1372632">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1372635">len</span><span class="op" id="1372638">(</span><span class="ident" id="1372639">t</span><span class="op" id="1372640">)</span>&nbsp;<span class="op" id="1372642">!=</span>&nbsp;<span class="num" id="1372645">0</span>&nbsp;<span class="op" id="1372647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1372651">//&nbsp;Extract&nbsp;first&nbsp;rune&nbsp;from&nbsp;each.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1372686">var</span>&nbsp;<span class="ident" id="1372690">sr</span><span class="op" id="1372692">,</span>&nbsp;<span class="ident" id="1372694">tr</span>&nbsp;<span class="builtintype" id="1372697">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1372704">if</span>&nbsp;<span class="ident" id="1372707">s</span><span class="op" id="1372708">[</span><span class="num" id="1372709">0</span><span class="op" id="1372710">]</span>&nbsp;<span class="op" id="1372712">&lt;</span>&nbsp;<span class="ident" id="1372714">utf8</span><span class="op" id="1372718">.</span><span class="ident" id="1372719">RuneSelf</span>&nbsp;<span class="op" id="1372728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372733">sr</span><span class="op" id="1372735">,</span>&nbsp;<span class="ident" id="1372737">s</span>&nbsp;<span class="op" id="1372739">=</span>&nbsp;<span class="builtintype" id="1372741">rune</span><span class="op" id="1372745">(</span><span class="ident" id="1372746">s</span><span class="op" id="1372747">[</span><span class="num" id="1372748">0</span><span class="op" id="1372749">]</span><span class="op" id="1372750">)</span><span class="op" id="1372751">,</span>&nbsp;<span class="ident" id="1372753">s</span><span class="op" id="1372754">[</span><span class="num" id="1372755">1</span><span class="op" id="1372756">:</span><span class="op" id="1372757">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1372761">}</span>&nbsp;<span class="keyword" id="1372763">else</span>&nbsp;<span class="op" id="1372768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372773">r</span><span class="op" id="1372774">,</span>&nbsp;<span class="ident" id="1372776">size</span>&nbsp;<span class="op" id="1372781">:=</span>&nbsp;<span class="ident" id="1372784">utf8</span><span class="op" id="1372788">.</span><span class="ident" id="1372789">DecodeRune</span><span class="op" id="1372799">(</span><span class="ident" id="1372800">s</span><span class="op" id="1372801">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372806">sr</span><span class="op" id="1372808">,</span>&nbsp;<span class="ident" id="1372810">s</span>&nbsp;<span class="op" id="1372812">=</span>&nbsp;<span class="ident" id="1372814">r</span><span class="op" id="1372815">,</span>&nbsp;<span class="ident" id="1372817">s</span><span class="op" id="1372818">[</span><span class="ident" id="1372819">size</span><span class="op" id="1372823">:</span><span class="op" id="1372824">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1372828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1372832">if</span>&nbsp;<span class="ident" id="1372835">t</span><span class="op" id="1372836">[</span><span class="num" id="1372837">0</span><span class="op" id="1372838">]</span>&nbsp;<span class="op" id="1372840">&lt;</span>&nbsp;<span class="ident" id="1372842">utf8</span><span class="op" id="1372846">.</span><span class="ident" id="1372847">RuneSelf</span>&nbsp;<span class="op" id="1372856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372861">tr</span><span class="op" id="1372863">,</span>&nbsp;<span class="ident" id="1372865">t</span>&nbsp;<span class="op" id="1372867">=</span>&nbsp;<span class="builtintype" id="1372869">rune</span><span class="op" id="1372873">(</span><span class="ident" id="1372874">t</span><span class="op" id="1372875">[</span><span class="num" id="1372876">0</span><span class="op" id="1372877">]</span><span class="op" id="1372878">)</span><span class="op" id="1372879">,</span>&nbsp;<span class="ident" id="1372881">t</span><span class="op" id="1372882">[</span><span class="num" id="1372883">1</span><span class="op" id="1372884">:</span><span class="op" id="1372885">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1372889">}</span>&nbsp;<span class="keyword" id="1372891">else</span>&nbsp;<span class="op" id="1372896">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372901">r</span><span class="op" id="1372902">,</span>&nbsp;<span class="ident" id="1372904">size</span>&nbsp;<span class="op" id="1372909">:=</span>&nbsp;<span class="ident" id="1372912">utf8</span><span class="op" id="1372916">.</span><span class="ident" id="1372917">DecodeRune</span><span class="op" id="1372927">(</span><span class="ident" id="1372928">t</span><span class="op" id="1372929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1372934">tr</span><span class="op" id="1372936">,</span>&nbsp;<span class="ident" id="1372938">t</span>&nbsp;<span class="op" id="1372940">=</span>&nbsp;<span class="ident" id="1372942">r</span><span class="op" id="1372943">,</span>&nbsp;<span class="ident" id="1372945">t</span><span class="op" id="1372946">[</span><span class="ident" id="1372947">size</span><span class="op" id="1372951">:</span><span class="op" id="1372952">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1372956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1372961">//&nbsp;If&nbsp;they&nbsp;match,&nbsp;keep&nbsp;going;&nbsp;if&nbsp;not,&nbsp;return&nbsp;false.</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1373016">//&nbsp;Easy&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1373032">if</span>&nbsp;<span class="ident" id="1373035">tr</span>&nbsp;<span class="op" id="1373038">==</span>&nbsp;<span class="ident" id="1373041">sr</span>&nbsp;<span class="op" id="1373044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1373049">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1373060">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1373065">//&nbsp;Make&nbsp;sr&nbsp;&lt;&nbsp;tr&nbsp;to&nbsp;simplify&nbsp;what&nbsp;follows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1373109">if</span>&nbsp;<span class="ident" id="1373112">tr</span>&nbsp;<span class="op" id="1373115">&lt;</span>&nbsp;<span class="ident" id="1373117">sr</span>&nbsp;<span class="op" id="1373120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1373125">tr</span><span class="op" id="1373127">,</span>&nbsp;<span class="ident" id="1373129">sr</span>&nbsp;<span class="op" id="1373132">=</span>&nbsp;<span class="ident" id="1373134">sr</span><span class="op" id="1373136">,</span>&nbsp;<span class="ident" id="1373138">tr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1373143">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1373147">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;ASCII.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1373174">if</span>&nbsp;<span class="ident" id="1373177">tr</span>&nbsp;<span class="op" id="1373180">&lt;</span>&nbsp;<span class="ident" id="1373182">utf8</span><span class="op" id="1373186">.</span><span class="ident" id="1373187">RuneSelf</span>&nbsp;<span class="op" id="1373196">&amp;&amp;</span>&nbsp;<span class="string" id="1373199">&#39;A&#39;</span>&nbsp;<span class="op" id="1373203">&lt;=</span>&nbsp;<span class="ident" id="1373206">sr</span>&nbsp;<span class="op" id="1373209">&amp;&amp;</span>&nbsp;<span class="ident" id="1373212">sr</span>&nbsp;<span class="op" id="1373215">&lt;=</span>&nbsp;<span class="string" id="1373218">&#39;Z&#39;</span>&nbsp;<span class="op" id="1373222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1373227">//&nbsp;ASCII,&nbsp;and&nbsp;sr&nbsp;is&nbsp;upper&nbsp;case.&nbsp;&nbsp;tr&nbsp;must&nbsp;be&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1373286">if</span>&nbsp;<span class="ident" id="1373289">tr</span>&nbsp;<span class="op" id="1373292">==</span>&nbsp;<span class="ident" id="1373295">sr</span><span class="op" id="1373297">+</span><span class="string" id="1373298">&#39;a&#39;</span><span class="op" id="1373301">-</span><span class="string" id="1373302">&#39;A&#39;</span>&nbsp;<span class="op" id="1373306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1373312">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1373324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1373329">return</span>&nbsp;<span class="builtintype" id="1373336">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1373344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1373349">//&nbsp;General&nbsp;case.&nbsp;&nbsp;SimpleFold(x)&nbsp;returns&nbsp;the&nbsp;next&nbsp;equivalent&nbsp;rune&nbsp;&gt;&nbsp;x</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1373420">//&nbsp;or&nbsp;wraps&nbsp;around&nbsp;to&nbsp;smaller&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1373460">r</span>&nbsp;<span class="op" id="1373462">:=</span>&nbsp;<span class="ident" id="1373465">unicode</span><span class="op" id="1373472">.</span><span class="ident" id="1373473">SimpleFold</span><span class="op" id="1373483">(</span><span class="ident" id="1373484">sr</span><span class="op" id="1373486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1373490">for</span>&nbsp;<span class="ident" id="1373494">r</span>&nbsp;<span class="op" id="1373496">!=</span>&nbsp;<span class="ident" id="1373499">sr</span>&nbsp;<span class="op" id="1373502">&amp;&amp;</span>&nbsp;<span class="ident" id="1373505">r</span>&nbsp;<span class="op" id="1373507">&lt;</span>&nbsp;<span class="ident" id="1373509">tr</span>&nbsp;<span class="op" id="1373512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1373517">r</span>&nbsp;<span class="op" id="1373519">=</span>&nbsp;<span class="ident" id="1373521">unicode</span><span class="op" id="1373528">.</span><span class="ident" id="1373529">SimpleFold</span><span class="op" id="1373539">(</span><span class="ident" id="1373540">r</span><span class="op" id="1373541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1373545">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1373549">if</span>&nbsp;<span class="ident" id="1373552">r</span>&nbsp;<span class="op" id="1373554">==</span>&nbsp;<span class="ident" id="1373557">tr</span>&nbsp;<span class="op" id="1373560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1373565">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1373576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1373580">return</span>&nbsp;<span class="builtintype" id="1373587">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1373594">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1373598">//&nbsp;One&nbsp;string&nbsp;is&nbsp;empty.&nbsp;&nbsp;Are&nbsp;both?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1373634">return</span>&nbsp;<span class="builtinfunc" id="1373641">len</span><span class="op" id="1373644">(</span><span class="ident" id="1373645">s</span><span class="op" id="1373646">)</span>&nbsp;<span class="op" id="1373648">==</span>&nbsp;<span class="builtinfunc" id="1373651">len</span><span class="op" id="1373654">(</span><span class="ident" id="1373655">t</span><span class="op" id="1373656">)</span><br>
<span class="lineno"></span><span class="op" id="1373658">}</span>
</div>
</body>
</html>
