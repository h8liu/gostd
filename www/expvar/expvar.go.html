<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4848131">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4848186">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4848240">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4848291">//&nbsp;Package&nbsp;expvar&nbsp;provides&nbsp;a&nbsp;standardized&nbsp;interface&nbsp;to&nbsp;public&nbsp;variables,&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="4848369">//&nbsp;as&nbsp;operation&nbsp;counters&nbsp;in&nbsp;servers.&nbsp;It&nbsp;exposes&nbsp;these&nbsp;variables&nbsp;via&nbsp;HTTP&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4848445">//&nbsp;/debug/vars&nbsp;in&nbsp;JSON&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="4848476">//</span><br>
<span class="lineno"></span><span class="comment" id="4848479">//&nbsp;Operations&nbsp;to&nbsp;set&nbsp;or&nbsp;modify&nbsp;these&nbsp;public&nbsp;variables&nbsp;are&nbsp;atomic.</span><br>
<span class="lineno">10</span><span class="comment" id="4848545">//</span><br>
<span class="lineno"></span><span class="comment" id="4848548">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;adding&nbsp;the&nbsp;HTTP&nbsp;handler,&nbsp;this&nbsp;package&nbsp;registers&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4848618">//&nbsp;following&nbsp;variables:</span><br>
<span class="lineno"></span><span class="comment" id="4848642">//</span><br>
<span class="lineno"></span><span class="comment" id="4848645">//&nbsp;&nbsp;&nbsp;&nbspcmdline&nbsp;&nbsp;&nbsp;os.Args</span><br>
<span class="lineno">15</span><span class="comment" id="4848666">//&nbsp;&nbsp;&nbsp;&nbspmemstats&nbsp;&nbsp;runtime.Memstats</span><br>
<span class="lineno"></span><span class="comment" id="4848696">//</span><br>
<span class="lineno"></span><span class="comment" id="4848699">//&nbsp;The&nbsp;package&nbsp;is&nbsp;sometimes&nbsp;only&nbsp;imported&nbsp;for&nbsp;the&nbsp;side&nbsp;effect&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4848764">//&nbsp;registering&nbsp;its&nbsp;HTTP&nbsp;handler&nbsp;and&nbsp;the&nbsp;above&nbsp;variables.&nbsp;&nbsp;To&nbsp;use&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4848832">//&nbsp;this&nbsp;way,&nbsp;link&nbsp;this&nbsp;package&nbsp;into&nbsp;your&nbsp;program:</span><br>
<span class="lineno">20</span><span class="comment" id="4848882">//&nbsp;&nbsp;&nbsp;&nbspimport&nbsp;_&nbsp;&#34;expvar&#34;</span><br>
<span class="lineno"></span><span class="comment" id="4848903">//</span><br>
<span class="lineno"></span><span class="keyword" id="4848906">package</span>&nbsp;<span class="ident" id="4848914">expvar</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4848922">import</span>&nbsp;<span class="op" id="4848929">(</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4848932">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4848941">&#34;encoding/json&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4848958">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4848965">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4848972">&#34;net/http&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4848984">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4848990">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4849001">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4849009">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4849020">&#34;sync&#34;</span><br>
<span class="lineno">35</span><span class="op" id="4849027">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4849030">//&nbsp;Var&nbsp;is&nbsp;an&nbsp;abstract&nbsp;type&nbsp;for&nbsp;all&nbsp;exported&nbsp;variables.</span><br>
<span class="lineno"></span><span class="keyword" id="4849085">type</span>&nbsp;<span class="ident" id="4849090">Var</span>&nbsp;<span class="keyword" id="4849094">interface</span>&nbsp;<span class="op" id="4849104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849107">String</span><span class="op" id="4849113">(</span><span class="op" id="4849114">)</span>&nbsp;<span class="builtintype" id="4849116">string</span><br>
<span class="lineno">40</span><span class="op" id="4849123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4849126">//&nbsp;Int&nbsp;is&nbsp;a&nbsp;64-bit&nbsp;integer&nbsp;variable&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;Var&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="4849196">type</span>&nbsp;<span class="ident" id="4849201">Int</span>&nbsp;<span class="keyword" id="4849205">struct</span>&nbsp;<span class="op" id="4849212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849215">mu</span>&nbsp;<span class="ident" id="4849218"><a href="/expvar/expvar.go.html#4849020">sync</a></span><span class="op" id="4849222">.</span><span class="ident" id="4849223">RWMutex</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849232">i</span>&nbsp;&nbsp;<span class="ident" id="4849235">int64</span><br>
<span class="lineno"></span><span class="op" id="4849241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4849244">func</span>&nbsp;<span class="op" id="4849249">(</span><span class="ident" id="4849250">v</span>&nbsp;<span class="op" id="4849252">*</span><span class="ident" id="4849253"><a href="/expvar/expvar.go.html#4849201">Int</a></span><span class="op" id="4849256">)</span>&nbsp;<span class="ident" id="4849258">String</span><span class="op" id="4849264">(</span><span class="op" id="4849265">)</span>&nbsp;<span class="builtintype" id="4849267">string</span>&nbsp;<span class="op" id="4849274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849277"><a href="/expvar/expvar.go.html#4849250">v</a></span><span class="op" id="4849278">.</span><span class="ident" id="4849279">mu</span><span class="op" id="4849281">.</span><span class="ident" id="4849282">RLock</span><span class="op" id="4849287">(</span><span class="op" id="4849288">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849291">defer</span>&nbsp;<span class="ident" id="4849297"><a href="/expvar/expvar.go.html#4849250">v</a></span><span class="op" id="4849298">.</span><span class="ident" id="4849299">mu</span><span class="op" id="4849301">.</span><span class="ident" id="4849302">RUnlock</span><span class="op" id="4849309">(</span><span class="op" id="4849310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849313">return</span>&nbsp;<span class="ident" id="4849320"><a href="/expvar/expvar.go.html#4849009">strconv</a></span><span class="op" id="4849327">.</span><span class="ident" id="4849328">FormatInt</span><span class="op" id="4849337">(</span><span class="ident" id="4849338"><a href="/expvar/expvar.go.html#4849250">v</a></span><span class="op" id="4849339">.</span><span class="ident" id="4849340">i</span><span class="op" id="4849341">,</span>&nbsp;<span class="num" id="4849343">10</span><span class="op" id="4849345">)</span><br>
<span class="lineno"></span><span class="op" id="4849347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4849350">func</span>&nbsp;<span class="op" id="4849355">(</span><span class="ident" id="4849356">v</span>&nbsp;<span class="op" id="4849358">*</span><span class="ident" id="4849359"><a href="/expvar/expvar.go.html#4849201">Int</a></span><span class="op" id="4849362">)</span>&nbsp;<span class="ident" id="4849364">Add</span><span class="op" id="4849367">(</span><span class="ident" id="4849368">delta</span>&nbsp;<span class="ident" id="4849374">int64</span><span class="op" id="4849379">)</span>&nbsp;<span class="op" id="4849381">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849384"><a href="/expvar/expvar.go.html#4849356">v</a></span><span class="op" id="4849385">.</span><span class="ident" id="4849386">mu</span><span class="op" id="4849388">.</span><span class="ident" id="4849389">Lock</span><span class="op" id="4849393">(</span><span class="op" id="4849394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849397">defer</span>&nbsp;<span class="ident" id="4849403"><a href="/expvar/expvar.go.html#4849356">v</a></span><span class="op" id="4849404">.</span><span class="ident" id="4849405">mu</span><span class="op" id="4849407">.</span><span class="ident" id="4849408">Unlock</span><span class="op" id="4849414">(</span><span class="op" id="4849415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849418"><a href="/expvar/expvar.go.html#4849356">v</a></span><span class="op" id="4849419">.</span><span class="ident" id="4849420">i</span>&nbsp;<span class="op" id="4849422">+=</span>&nbsp;<span class="ident" id="4849425"><a href="/expvar/expvar.go.html#4849368">delta</a></span><br>
<span class="lineno"></span><span class="op" id="4849431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="4849434">func</span>&nbsp;<span class="op" id="4849439">(</span><span class="ident" id="4849440">v</span>&nbsp;<span class="op" id="4849442">*</span><span class="ident" id="4849443"><a href="/expvar/expvar.go.html#4849201">Int</a></span><span class="op" id="4849446">)</span>&nbsp;<span class="ident" id="4849448">Set</span><span class="op" id="4849451">(</span><span class="ident" id="4849452">value</span>&nbsp;<span class="ident" id="4849458">int64</span><span class="op" id="4849463">)</span>&nbsp;<span class="op" id="4849465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849468"><a href="/expvar/expvar.go.html#4849440">v</a></span><span class="op" id="4849469">.</span><span class="ident" id="4849470">mu</span><span class="op" id="4849472">.</span><span class="ident" id="4849473">Lock</span><span class="op" id="4849477">(</span><span class="op" id="4849478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849481">defer</span>&nbsp;<span class="ident" id="4849487"><a href="/expvar/expvar.go.html#4849440">v</a></span><span class="op" id="4849488">.</span><span class="ident" id="4849489">mu</span><span class="op" id="4849491">.</span><span class="ident" id="4849492">Unlock</span><span class="op" id="4849498">(</span><span class="op" id="4849499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849502"><a href="/expvar/expvar.go.html#4849440">v</a></span><span class="op" id="4849503">.</span><span class="ident" id="4849504">i</span>&nbsp;<span class="op" id="4849506">=</span>&nbsp;<span class="ident" id="4849508"><a href="/expvar/expvar.go.html#4849452">value</a></span><br>
<span class="lineno"></span><span class="op" id="4849514">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="4849517">//&nbsp;Float&nbsp;is&nbsp;a&nbsp;64-bit&nbsp;float&nbsp;variable&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;Var&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="4849587">type</span>&nbsp;<span class="ident" id="4849592">Float</span>&nbsp;<span class="keyword" id="4849598">struct</span>&nbsp;<span class="op" id="4849605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849608">mu</span>&nbsp;<span class="ident" id="4849611"><a href="/expvar/expvar.go.html#4849020">sync</a></span><span class="op" id="4849615">.</span><span class="ident" id="4849616">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849625">f</span>&nbsp;&nbsp;<span class="builtintype" id="4849628">float64</span><br>
<span class="lineno">70</span><span class="op" id="4849636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4849639">func</span>&nbsp;<span class="op" id="4849644">(</span><span class="ident" id="4849645">v</span>&nbsp;<span class="op" id="4849647">*</span><span class="ident" id="4849648"><a href="/expvar/expvar.go.html#4849592">Float</a></span><span class="op" id="4849653">)</span>&nbsp;<span class="ident" id="4849655">String</span><span class="op" id="4849661">(</span><span class="op" id="4849662">)</span>&nbsp;<span class="builtintype" id="4849664">string</span>&nbsp;<span class="op" id="4849671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849674"><a href="/expvar/expvar.go.html#4849645">v</a></span><span class="op" id="4849675">.</span><span class="ident" id="4849676">mu</span><span class="op" id="4849678">.</span><span class="ident" id="4849679">RLock</span><span class="op" id="4849684">(</span><span class="op" id="4849685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849688">defer</span>&nbsp;<span class="ident" id="4849694"><a href="/expvar/expvar.go.html#4849645">v</a></span><span class="op" id="4849695">.</span><span class="ident" id="4849696">mu</span><span class="op" id="4849698">.</span><span class="ident" id="4849699">RUnlock</span><span class="op" id="4849706">(</span><span class="op" id="4849707">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849710">return</span>&nbsp;<span class="ident" id="4849717"><a href="/expvar/expvar.go.html#4849009">strconv</a></span><span class="op" id="4849724">.</span><span class="ident" id="4849725">FormatFloat</span><span class="op" id="4849736">(</span><span class="ident" id="4849737"><a href="/expvar/expvar.go.html#4849645">v</a></span><span class="op" id="4849738">.</span><span class="ident" id="4849739">f</span><span class="op" id="4849740">,</span>&nbsp;<span class="string" id="4849742">&#39;g&#39;</span><span class="op" id="4849745">,</span>&nbsp;<span class="op" id="4849747">-</span><span class="num" id="4849748">1</span><span class="op" id="4849749">,</span>&nbsp;<span class="num" id="4849751">64</span><span class="op" id="4849753">)</span><br>
<span class="lineno"></span><span class="op" id="4849755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4849758">//&nbsp;Add&nbsp;adds&nbsp;delta&nbsp;to&nbsp;v.</span><br>
<span class="lineno"></span><span class="keyword" id="4849782">func</span>&nbsp;<span class="op" id="4849787">(</span><span class="ident" id="4849788">v</span>&nbsp;<span class="op" id="4849790">*</span><span class="ident" id="4849791"><a href="/expvar/expvar.go.html#4849592">Float</a></span><span class="op" id="4849796">)</span>&nbsp;<span class="ident" id="4849798">Add</span><span class="op" id="4849801">(</span><span class="ident" id="4849802">delta</span>&nbsp;<span class="builtintype" id="4849808">float64</span><span class="op" id="4849815">)</span>&nbsp;<span class="op" id="4849817">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849820"><a href="/expvar/expvar.go.html#4849788">v</a></span><span class="op" id="4849821">.</span><span class="ident" id="4849822">mu</span><span class="op" id="4849824">.</span><span class="ident" id="4849825">Lock</span><span class="op" id="4849829">(</span><span class="op" id="4849830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849833">defer</span>&nbsp;<span class="ident" id="4849839"><a href="/expvar/expvar.go.html#4849788">v</a></span><span class="op" id="4849840">.</span><span class="ident" id="4849841">mu</span><span class="op" id="4849843">.</span><span class="ident" id="4849844">Unlock</span><span class="op" id="4849850">(</span><span class="op" id="4849851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849854"><a href="/expvar/expvar.go.html#4849788">v</a></span><span class="op" id="4849855">.</span><span class="ident" id="4849856">f</span>&nbsp;<span class="op" id="4849858">+=</span>&nbsp;<span class="ident" id="4849861"><a href="/expvar/expvar.go.html#4849802">delta</a></span><br>
<span class="lineno"></span><span class="op" id="4849867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="4849870">//&nbsp;Set&nbsp;sets&nbsp;v&nbsp;to&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4849894">func</span>&nbsp;<span class="op" id="4849899">(</span><span class="ident" id="4849900">v</span>&nbsp;<span class="op" id="4849902">*</span><span class="ident" id="4849903"><a href="/expvar/expvar.go.html#4849592">Float</a></span><span class="op" id="4849908">)</span>&nbsp;<span class="ident" id="4849910">Set</span><span class="op" id="4849913">(</span><span class="ident" id="4849914">value</span>&nbsp;<span class="builtintype" id="4849920">float64</span><span class="op" id="4849927">)</span>&nbsp;<span class="op" id="4849929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849932"><a href="/expvar/expvar.go.html#4849900">v</a></span><span class="op" id="4849933">.</span><span class="ident" id="4849934">mu</span><span class="op" id="4849936">.</span><span class="ident" id="4849937">Lock</span><span class="op" id="4849941">(</span><span class="op" id="4849942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849945">defer</span>&nbsp;<span class="ident" id="4849951"><a href="/expvar/expvar.go.html#4849900">v</a></span><span class="op" id="4849952">.</span><span class="ident" id="4849953">mu</span><span class="op" id="4849955">.</span><span class="ident" id="4849956">Unlock</span><span class="op" id="4849962">(</span><span class="op" id="4849963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849966"><a href="/expvar/expvar.go.html#4849900">v</a></span><span class="op" id="4849967">.</span><span class="ident" id="4849968">f</span>&nbsp;<span class="op" id="4849970">=</span>&nbsp;<span class="ident" id="4849972"><a href="/expvar/expvar.go.html#4849914">value</a></span><br>
<span class="lineno">90</span><span class="op" id="4849978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4849981">//&nbsp;Map&nbsp;is&nbsp;a&nbsp;string-to-Var&nbsp;map&nbsp;variable&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;Var&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="4850054">type</span>&nbsp;<span class="ident" id="4850059">Map</span>&nbsp;<span class="keyword" id="4850063">struct</span>&nbsp;<span class="op" id="4850070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850073">mu</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4850078"><a href="/expvar/expvar.go.html#4849020">sync</a></span><span class="op" id="4850082">.</span><span class="ident" id="4850083">RWMutex</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850092">m</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4850097">map</span><span class="op" id="4850100">[</span><span class="builtintype" id="4850101">string</span><span class="op" id="4850107">]</span><span class="ident" id="4850108"><a href="/expvar/expvar.go.html#4849090">Var</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850113">keys</span>&nbsp;<span class="op" id="4850118">[</span><span class="op" id="4850119">]</span><span class="builtintype" id="4850120">string</span>&nbsp;<span class="comment" id="4850127">//&nbsp;sorted</span><br>
<span class="lineno"></span><span class="op" id="4850137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4850140">//&nbsp;KeyValue&nbsp;represents&nbsp;a&nbsp;single&nbsp;entry&nbsp;in&nbsp;a&nbsp;Map.</span><br>
<span class="lineno">100</span><span class="keyword" id="4850188">type</span>&nbsp;<span class="ident" id="4850193">KeyValue</span>&nbsp;<span class="keyword" id="4850202">struct</span>&nbsp;<span class="op" id="4850209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850212">Key</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4850218">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850226">Value</span>&nbsp;<span class="ident" id="4850232"><a href="/expvar/expvar.go.html#4849090">Var</a></span><br>
<span class="lineno"></span><span class="op" id="4850236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4850239">func</span>&nbsp;<span class="op" id="4850244">(</span><span class="ident" id="4850245">v</span>&nbsp;<span class="op" id="4850247">*</span><span class="ident" id="4850248"><a href="/expvar/expvar.go.html#4850059">Map</a></span><span class="op" id="4850251">)</span>&nbsp;<span class="ident" id="4850253">String</span><span class="op" id="4850259">(</span><span class="op" id="4850260">)</span>&nbsp;<span class="builtintype" id="4850262">string</span>&nbsp;<span class="op" id="4850269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850272"><a href="/expvar/expvar.go.html#4850245">v</a></span><span class="op" id="4850273">.</span><span class="ident" id="4850274">mu</span><span class="op" id="4850276">.</span><span class="ident" id="4850277">RLock</span><span class="op" id="4850282">(</span><span class="op" id="4850283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850286">defer</span>&nbsp;<span class="ident" id="4850292"><a href="/expvar/expvar.go.html#4850245">v</a></span><span class="op" id="4850293">.</span><span class="ident" id="4850294">mu</span><span class="op" id="4850296">.</span><span class="ident" id="4850297">RUnlock</span><span class="op" id="4850304">(</span><span class="op" id="4850305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850308">var</span>&nbsp;<span class="ident" id="4850312">b</span>&nbsp;<span class="ident" id="4850314"><a href="/expvar/expvar.go.html#4848932">bytes</a></span><span class="op" id="4850319">.</span><span class="ident" id="4850320">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850328"><a href="/expvar/expvar.go.html#4848958">fmt</a></span><span class="op" id="4850331">.</span><span class="ident" id="4850332">Fprintf</span><span class="op" id="4850339">(</span><span class="op" id="4850340">&amp;</span><span class="ident" id="4850341"><a href="/expvar/expvar.go.html#4850312">b</a></span><span class="op" id="4850342">,</span>&nbsp;<span class="string" id="4850344">&#34;{&#34;</span><span class="op" id="4850347">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850350">first</span>&nbsp;<span class="op" id="4850356">:=</span>&nbsp;<span class="builtintype" id="4850359">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850365"><a href="/expvar/expvar.go.html#4850245">v</a></span><span class="op" id="4850366">.</span><span class="ident" id="4850367">doLocked</span><span class="op" id="4850375">(</span><span class="keyword" id="4850376">func</span><span class="op" id="4850380">(</span><span class="ident" id="4850381">kv</span>&nbsp;<span class="ident" id="4850384"><a href="/expvar/expvar.go.html#4850193">KeyValue</a></span><span class="op" id="4850392">)</span>&nbsp;<span class="op" id="4850394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850398">if</span>&nbsp;<span class="op" id="4850401">!</span><span class="ident" id="4850402"><a href="/expvar/expvar.go.html#4850350">first</a></span>&nbsp;<span class="op" id="4850408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850413"><a href="/expvar/expvar.go.html#4848958">fmt</a></span><span class="op" id="4850416">.</span><span class="ident" id="4850417">Fprintf</span><span class="op" id="4850424">(</span><span class="op" id="4850425">&amp;</span><span class="ident" id="4850426"><a href="/expvar/expvar.go.html#4850312">b</a></span><span class="op" id="4850427">,</span>&nbsp;<span class="string" id="4850429">&#34;,&nbsp;&#34;</span><span class="op" id="4850433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4850437">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850441"><a href="/expvar/expvar.go.html#4848958">fmt</a></span><span class="op" id="4850444">.</span><span class="ident" id="4850445">Fprintf</span><span class="op" id="4850452">(</span><span class="op" id="4850453">&amp;</span><span class="ident" id="4850454"><a href="/expvar/expvar.go.html#4850312">b</a></span><span class="op" id="4850455">,</span>&nbsp;<span class="string" id="4850457">&#34;%q:&nbsp;%v&#34;</span><span class="op" id="4850465">,</span>&nbsp;<span class="ident" id="4850467"><a href="/expvar/expvar.go.html#4850381">kv</a></span><span class="op" id="4850469">.</span><span class="ident" id="4850470">Key</span><span class="op" id="4850473">,</span>&nbsp;<span class="ident" id="4850475"><a href="/expvar/expvar.go.html#4850381">kv</a></span><span class="op" id="4850477">.</span><span class="ident" id="4850478">Value</span><span class="op" id="4850483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850487"><a href="/expvar/expvar.go.html#4850350">first</a></span>&nbsp;<span class="op" id="4850493">=</span>&nbsp;<span class="builtintype" id="4850495">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4850502">}</span><span class="op" id="4850503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850506"><a href="/expvar/expvar.go.html#4848958">fmt</a></span><span class="op" id="4850509">.</span><span class="ident" id="4850510">Fprintf</span><span class="op" id="4850517">(</span><span class="op" id="4850518">&amp;</span><span class="ident" id="4850519"><a href="/expvar/expvar.go.html#4850312">b</a></span><span class="op" id="4850520">,</span>&nbsp;<span class="string" id="4850522">&#34;}&#34;</span><span class="op" id="4850525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850528">return</span>&nbsp;<span class="ident" id="4850535"><a href="/expvar/expvar.go.html#4850312">b</a></span><span class="op" id="4850536">.</span><span class="ident" id="4850537">String</span><span class="op" id="4850543">(</span><span class="op" id="4850544">)</span><br>
<span class="lineno">120</span><span class="op" id="4850546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4850549">func</span>&nbsp;<span class="op" id="4850554">(</span><span class="ident" id="4850555">v</span>&nbsp;<span class="op" id="4850557">*</span><span class="ident" id="4850558"><a href="/expvar/expvar.go.html#4850059">Map</a></span><span class="op" id="4850561">)</span>&nbsp;<span class="ident" id="4850563">Init</span><span class="op" id="4850567">(</span><span class="op" id="4850568">)</span>&nbsp;<span class="op" id="4850570">*</span><span class="ident" id="4850571"><a href="/expvar/expvar.go.html#4850059">Map</a></span>&nbsp;<span class="op" id="4850575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850578"><a href="/expvar/expvar.go.html#4850555">v</a></span><span class="op" id="4850579">.</span><span class="ident" id="4850580">m</span>&nbsp;<span class="op" id="4850582">=</span>&nbsp;<span class="builtinfunc" id="4850584">make</span><span class="op" id="4850588">(</span><span class="keyword" id="4850589">map</span><span class="op" id="4850592">[</span><span class="builtintype" id="4850593">string</span><span class="op" id="4850599">]</span><span class="ident" id="4850600"><a href="/expvar/expvar.go.html#4849090">Var</a></span><span class="op" id="4850603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850606">return</span>&nbsp;<span class="ident" id="4850613"><a href="/expvar/expvar.go.html#4850555">v</a></span><br>
<span class="lineno">125</span><span class="op" id="4850615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4850618">//&nbsp;updateKeys&nbsp;updates&nbsp;the&nbsp;sorted&nbsp;list&nbsp;of&nbsp;keys&nbsp;in&nbsp;v.keys.</span><br>
<span class="lineno"></span><span class="comment" id="4850675">//&nbsp;must&nbsp;be&nbsp;called&nbsp;with&nbsp;v.mu&nbsp;held.</span><br>
<span class="lineno"></span><span class="keyword" id="4850709">func</span>&nbsp;<span class="op" id="4850714">(</span><span class="ident" id="4850715">v</span>&nbsp;<span class="op" id="4850717">*</span><span class="ident" id="4850718"><a href="/expvar/expvar.go.html#4850059">Map</a></span><span class="op" id="4850721">)</span>&nbsp;<span class="ident" id="4850723">updateKeys</span><span class="op" id="4850733">(</span><span class="op" id="4850734">)</span>&nbsp;<span class="op" id="4850736">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850739">if</span>&nbsp;<span class="builtinfunc" id="4850742">len</span><span class="op" id="4850745">(</span><span class="ident" id="4850746"><a href="/expvar/expvar.go.html#4850715">v</a></span><span class="op" id="4850747">.</span><span class="ident" id="4850748">m</span><span class="op" id="4850749">)</span>&nbsp;<span class="op" id="4850751">==</span>&nbsp;<span class="builtinfunc" id="4850754">len</span><span class="op" id="4850757">(</span><span class="ident" id="4850758"><a href="/expvar/expvar.go.html#4850715">v</a></span><span class="op" id="4850759">.</span><span class="ident" id="4850760">keys</span><span class="op" id="4850764">)</span>&nbsp;<span class="op" id="4850766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4850770">//&nbsp;No&nbsp;new&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850787">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4850795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850798"><a href="/expvar/expvar.go.html#4850715">v</a></span><span class="op" id="4850799">.</span><span class="ident" id="4850800">keys</span>&nbsp;<span class="op" id="4850805">=</span>&nbsp;<span class="ident" id="4850807"><a href="/expvar/expvar.go.html#4850715">v</a></span><span class="op" id="4850808">.</span><span class="ident" id="4850809">keys</span><span class="op" id="4850813">[</span><span class="op" id="4850814">:</span><span class="num" id="4850815">0</span><span class="op" id="4850816">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850819">for</span>&nbsp;<span class="ident" id="4850823">k</span>&nbsp;<span class="op" id="4850825">:=</span>&nbsp;<span class="keyword" id="4850828">range</span>&nbsp;<span class="ident" id="4850834"><a href="/expvar/expvar.go.html#4850715">v</a></span><span class="op" id="4850835">.</span><span class="ident" id="4850836">m</span>&nbsp;<span class="op" id="4850838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850842"><a href="/expvar/expvar.go.html#4850715">v</a></span><span class="op" id="4850843">.</span><span class="ident" id="4850844">keys</span>&nbsp;<span class="op" id="4850849">=</span>&nbsp;<span class="builtinfunc" id="4850851">append</span><span class="op" id="4850857">(</span><span class="ident" id="4850858"><a href="/expvar/expvar.go.html#4850715">v</a></span><span class="op" id="4850859">.</span><span class="ident" id="4850860">keys</span><span class="op" id="4850864">,</span>&nbsp;<span class="ident" id="4850866"><a href="/expvar/expvar.go.html#4850823">k</a></span><span class="op" id="4850867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4850870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850873"><a href="/expvar/expvar.go.html#4849001">sort</a></span><span class="op" id="4850877">.</span><span class="ident" id="4850878">Strings</span><span class="op" id="4850885">(</span><span class="ident" id="4850886"><a href="/expvar/expvar.go.html#4850715">v</a></span><span class="op" id="4850887">.</span><span class="ident" id="4850888">keys</span><span class="op" id="4850892">)</span><br>
<span class="lineno"></span><span class="op" id="4850894">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="4850897">func</span>&nbsp;<span class="op" id="4850902">(</span><span class="ident" id="4850903">v</span>&nbsp;<span class="op" id="4850905">*</span><span class="ident" id="4850906"><a href="/expvar/expvar.go.html#4850059">Map</a></span><span class="op" id="4850909">)</span>&nbsp;<span class="ident" id="4850911">Get</span><span class="op" id="4850914">(</span><span class="ident" id="4850915">key</span>&nbsp;<span class="builtintype" id="4850919">string</span><span class="op" id="4850925">)</span>&nbsp;<span class="ident" id="4850927"><a href="/expvar/expvar.go.html#4849090">Var</a></span>&nbsp;<span class="op" id="4850931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850934"><a href="/expvar/expvar.go.html#4850903">v</a></span><span class="op" id="4850935">.</span><span class="ident" id="4850936">mu</span><span class="op" id="4850938">.</span><span class="ident" id="4850939">RLock</span><span class="op" id="4850944">(</span><span class="op" id="4850945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850948">defer</span>&nbsp;<span class="ident" id="4850954"><a href="/expvar/expvar.go.html#4850903">v</a></span><span class="op" id="4850955">.</span><span class="ident" id="4850956">mu</span><span class="op" id="4850958">.</span><span class="ident" id="4850959">RUnlock</span><span class="op" id="4850966">(</span><span class="op" id="4850967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850970">return</span>&nbsp;<span class="ident" id="4850977"><a href="/expvar/expvar.go.html#4850903">v</a></span><span class="op" id="4850978">.</span><span class="ident" id="4850979">m</span><span class="op" id="4850980">[</span><span class="ident" id="4850981"><a href="/expvar/expvar.go.html#4850915">key</a></span><span class="op" id="4850984">]</span><br>
<span class="lineno">145</span><span class="op" id="4850986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4850989">func</span>&nbsp;<span class="op" id="4850994">(</span><span class="ident" id="4850995">v</span>&nbsp;<span class="op" id="4850997">*</span><span class="ident" id="4850998"><a href="/expvar/expvar.go.html#4850059">Map</a></span><span class="op" id="4851001">)</span>&nbsp;<span class="ident" id="4851003">Set</span><span class="op" id="4851006">(</span><span class="ident" id="4851007">key</span>&nbsp;<span class="builtintype" id="4851011">string</span><span class="op" id="4851017">,</span>&nbsp;<span class="ident" id="4851019">av</span>&nbsp;<span class="ident" id="4851022"><a href="/expvar/expvar.go.html#4849090">Var</a></span><span class="op" id="4851025">)</span>&nbsp;<span class="op" id="4851027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851030"><a href="/expvar/expvar.go.html#4850995">v</a></span><span class="op" id="4851031">.</span><span class="ident" id="4851032">mu</span><span class="op" id="4851034">.</span><span class="ident" id="4851035">Lock</span><span class="op" id="4851039">(</span><span class="op" id="4851040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851043">defer</span>&nbsp;<span class="ident" id="4851049"><a href="/expvar/expvar.go.html#4850995">v</a></span><span class="op" id="4851050">.</span><span class="ident" id="4851051">mu</span><span class="op" id="4851053">.</span><span class="ident" id="4851054">Unlock</span><span class="op" id="4851060">(</span><span class="op" id="4851061">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851064"><a href="/expvar/expvar.go.html#4850995">v</a></span><span class="op" id="4851065">.</span><span class="ident" id="4851066">m</span><span class="op" id="4851067">[</span><span class="ident" id="4851068"><a href="/expvar/expvar.go.html#4851007">key</a></span><span class="op" id="4851071">]</span>&nbsp;<span class="op" id="4851073">=</span>&nbsp;<span class="ident" id="4851075"><a href="/expvar/expvar.go.html#4851019">av</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851079"><a href="/expvar/expvar.go.html#4850995">v</a></span><span class="op" id="4851080">.</span><span class="ident" id="4851081">updateKeys</span><span class="op" id="4851091">(</span><span class="op" id="4851092">)</span><br>
<span class="lineno"></span><span class="op" id="4851094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4851097">func</span>&nbsp;<span class="op" id="4851102">(</span><span class="ident" id="4851103">v</span>&nbsp;<span class="op" id="4851105">*</span><span class="ident" id="4851106"><a href="/expvar/expvar.go.html#4850059">Map</a></span><span class="op" id="4851109">)</span>&nbsp;<span class="ident" id="4851111">Add</span><span class="op" id="4851114">(</span><span class="ident" id="4851115">key</span>&nbsp;<span class="builtintype" id="4851119">string</span><span class="op" id="4851125">,</span>&nbsp;<span class="ident" id="4851127">delta</span>&nbsp;<span class="ident" id="4851133">int64</span><span class="op" id="4851138">)</span>&nbsp;<span class="op" id="4851140">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851143"><a href="/expvar/expvar.go.html#4851103">v</a></span><span class="op" id="4851144">.</span><span class="ident" id="4851145">mu</span><span class="op" id="4851147">.</span><span class="ident" id="4851148">RLock</span><span class="op" id="4851153">(</span><span class="op" id="4851154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851157">av</span><span class="op" id="4851159">,</span>&nbsp;<span class="ident" id="4851161">ok</span>&nbsp;<span class="op" id="4851164">:=</span>&nbsp;<span class="ident" id="4851167"><a href="/expvar/expvar.go.html#4851103">v</a></span><span class="op" id="4851168">.</span><span class="ident" id="4851169">m</span><span class="op" id="4851170">[</span><span class="ident" id="4851171"><a href="/expvar/expvar.go.html#4851115">key</a></span><span class="op" id="4851174">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851177"><a href="/expvar/expvar.go.html#4851103">v</a></span><span class="op" id="4851178">.</span><span class="ident" id="4851179">mu</span><span class="op" id="4851181">.</span><span class="ident" id="4851182">RUnlock</span><span class="op" id="4851189">(</span><span class="op" id="4851190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851193">if</span>&nbsp;<span class="op" id="4851196">!</span><span class="ident" id="4851197"><a href="/expvar/expvar.go.html#4851161">ok</a></span>&nbsp;<span class="op" id="4851200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4851204">//&nbsp;check&nbsp;again&nbsp;under&nbsp;the&nbsp;write&nbsp;lock</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851242"><a href="/expvar/expvar.go.html#4851103">v</a></span><span class="op" id="4851243">.</span><span class="ident" id="4851244">mu</span><span class="op" id="4851246">.</span><span class="ident" id="4851247">Lock</span><span class="op" id="4851251">(</span><span class="op" id="4851252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851256"><a href="/expvar/expvar.go.html#4851157">av</a></span><span class="op" id="4851258">,</span>&nbsp;<span class="ident" id="4851260"><a href="/expvar/expvar.go.html#4851161">ok</a></span>&nbsp;<span class="op" id="4851263">=</span>&nbsp;<span class="ident" id="4851265"><a href="/expvar/expvar.go.html#4851103">v</a></span><span class="op" id="4851266">.</span><span class="ident" id="4851267">m</span><span class="op" id="4851268">[</span><span class="ident" id="4851269"><a href="/expvar/expvar.go.html#4851115">key</a></span><span class="op" id="4851272">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851276">if</span>&nbsp;<span class="op" id="4851279">!</span><span class="ident" id="4851280"><a href="/expvar/expvar.go.html#4851161">ok</a></span>&nbsp;<span class="op" id="4851283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851288"><a href="/expvar/expvar.go.html#4851157">av</a></span>&nbsp;<span class="op" id="4851291">=</span>&nbsp;<span class="builtinfunc" id="4851293">new</span><span class="op" id="4851296">(</span><span class="ident" id="4851297"><a href="/expvar/expvar.go.html#4849201">Int</a></span><span class="op" id="4851300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851305"><a href="/expvar/expvar.go.html#4851103">v</a></span><span class="op" id="4851306">.</span><span class="ident" id="4851307">m</span><span class="op" id="4851308">[</span><span class="ident" id="4851309"><a href="/expvar/expvar.go.html#4851115">key</a></span><span class="op" id="4851312">]</span>&nbsp;<span class="op" id="4851314">=</span>&nbsp;<span class="ident" id="4851316"><a href="/expvar/expvar.go.html#4851157">av</a></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851322"><a href="/expvar/expvar.go.html#4851103">v</a></span><span class="op" id="4851323">.</span><span class="ident" id="4851324">updateKeys</span><span class="op" id="4851334">(</span><span class="op" id="4851335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851343"><a href="/expvar/expvar.go.html#4851103">v</a></span><span class="op" id="4851344">.</span><span class="ident" id="4851345">mu</span><span class="op" id="4851347">.</span><span class="ident" id="4851348">Unlock</span><span class="op" id="4851354">(</span><span class="op" id="4851355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4851362">//&nbsp;Add&nbsp;to&nbsp;Int;&nbsp;ignore&nbsp;otherwise.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851396">if</span>&nbsp;<span class="ident" id="4851399">iv</span><span class="op" id="4851401">,</span>&nbsp;<span class="ident" id="4851403">ok</span>&nbsp;<span class="op" id="4851406">:=</span>&nbsp;<span class="ident" id="4851409"><a href="/expvar/expvar.go.html#4851157">av</a></span><span class="op" id="4851411">.</span><span class="op" id="4851412">(</span><span class="op" id="4851413">*</span><span class="ident" id="4851414"><a href="/expvar/expvar.go.html#4849201">Int</a></span><span class="op" id="4851417">)</span><span class="op" id="4851418">;</span>&nbsp;<span class="ident" id="4851420"><a href="/expvar/expvar.go.html#4851403">ok</a></span>&nbsp;<span class="op" id="4851423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851427"><a href="/expvar/expvar.go.html#4851399">iv</a></span><span class="op" id="4851429">.</span><span class="ident" id="4851430">Add</span><span class="op" id="4851433">(</span><span class="ident" id="4851434"><a href="/expvar/expvar.go.html#4851127">delta</a></span><span class="op" id="4851439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851442">}</span><br>
<span class="lineno"></span><span class="op" id="4851444">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4851447">//&nbsp;AddFloat&nbsp;adds&nbsp;delta&nbsp;to&nbsp;the&nbsp;*Float&nbsp;value&nbsp;stored&nbsp;under&nbsp;the&nbsp;given&nbsp;map&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4851522">func</span>&nbsp;<span class="op" id="4851527">(</span><span class="ident" id="4851528">v</span>&nbsp;<span class="op" id="4851530">*</span><span class="ident" id="4851531"><a href="/expvar/expvar.go.html#4850059">Map</a></span><span class="op" id="4851534">)</span>&nbsp;<span class="ident" id="4851536">AddFloat</span><span class="op" id="4851544">(</span><span class="ident" id="4851545">key</span>&nbsp;<span class="builtintype" id="4851549">string</span><span class="op" id="4851555">,</span>&nbsp;<span class="ident" id="4851557">delta</span>&nbsp;<span class="builtintype" id="4851563">float64</span><span class="op" id="4851570">)</span>&nbsp;<span class="op" id="4851572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851575"><a href="/expvar/expvar.go.html#4851528">v</a></span><span class="op" id="4851576">.</span><span class="ident" id="4851577">mu</span><span class="op" id="4851579">.</span><span class="ident" id="4851580">RLock</span><span class="op" id="4851585">(</span><span class="op" id="4851586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851589">av</span><span class="op" id="4851591">,</span>&nbsp;<span class="ident" id="4851593">ok</span>&nbsp;<span class="op" id="4851596">:=</span>&nbsp;<span class="ident" id="4851599"><a href="/expvar/expvar.go.html#4851528">v</a></span><span class="op" id="4851600">.</span><span class="ident" id="4851601">m</span><span class="op" id="4851602">[</span><span class="ident" id="4851603"><a href="/expvar/expvar.go.html#4851545">key</a></span><span class="op" id="4851606">]</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851609"><a href="/expvar/expvar.go.html#4851528">v</a></span><span class="op" id="4851610">.</span><span class="ident" id="4851611">mu</span><span class="op" id="4851613">.</span><span class="ident" id="4851614">RUnlock</span><span class="op" id="4851621">(</span><span class="op" id="4851622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851625">if</span>&nbsp;<span class="op" id="4851628">!</span><span class="ident" id="4851629"><a href="/expvar/expvar.go.html#4851593">ok</a></span>&nbsp;<span class="op" id="4851632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4851636">//&nbsp;check&nbsp;again&nbsp;under&nbsp;the&nbsp;write&nbsp;lock</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851674"><a href="/expvar/expvar.go.html#4851528">v</a></span><span class="op" id="4851675">.</span><span class="ident" id="4851676">mu</span><span class="op" id="4851678">.</span><span class="ident" id="4851679">Lock</span><span class="op" id="4851683">(</span><span class="op" id="4851684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851688"><a href="/expvar/expvar.go.html#4851589">av</a></span><span class="op" id="4851690">,</span>&nbsp;<span class="ident" id="4851692"><a href="/expvar/expvar.go.html#4851593">ok</a></span>&nbsp;<span class="op" id="4851695">=</span>&nbsp;<span class="ident" id="4851697"><a href="/expvar/expvar.go.html#4851528">v</a></span><span class="op" id="4851698">.</span><span class="ident" id="4851699">m</span><span class="op" id="4851700">[</span><span class="ident" id="4851701"><a href="/expvar/expvar.go.html#4851545">key</a></span><span class="op" id="4851704">]</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851708">if</span>&nbsp;<span class="op" id="4851711">!</span><span class="ident" id="4851712"><a href="/expvar/expvar.go.html#4851593">ok</a></span>&nbsp;<span class="op" id="4851715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851720"><a href="/expvar/expvar.go.html#4851589">av</a></span>&nbsp;<span class="op" id="4851723">=</span>&nbsp;<span class="builtinfunc" id="4851725">new</span><span class="op" id="4851728">(</span><span class="ident" id="4851729"><a href="/expvar/expvar.go.html#4849592">Float</a></span><span class="op" id="4851734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851739"><a href="/expvar/expvar.go.html#4851528">v</a></span><span class="op" id="4851740">.</span><span class="ident" id="4851741">m</span><span class="op" id="4851742">[</span><span class="ident" id="4851743"><a href="/expvar/expvar.go.html#4851545">key</a></span><span class="op" id="4851746">]</span>&nbsp;<span class="op" id="4851748">=</span>&nbsp;<span class="ident" id="4851750"><a href="/expvar/expvar.go.html#4851589">av</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851756"><a href="/expvar/expvar.go.html#4851528">v</a></span><span class="op" id="4851757">.</span><span class="ident" id="4851758">updateKeys</span><span class="op" id="4851768">(</span><span class="op" id="4851769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851773">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851777"><a href="/expvar/expvar.go.html#4851528">v</a></span><span class="op" id="4851778">.</span><span class="ident" id="4851779">mu</span><span class="op" id="4851781">.</span><span class="ident" id="4851782">Unlock</span><span class="op" id="4851788">(</span><span class="op" id="4851789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4851796">//&nbsp;Add&nbsp;to&nbsp;Float;&nbsp;ignore&nbsp;otherwise.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851832">if</span>&nbsp;<span class="ident" id="4851835">iv</span><span class="op" id="4851837">,</span>&nbsp;<span class="ident" id="4851839">ok</span>&nbsp;<span class="op" id="4851842">:=</span>&nbsp;<span class="ident" id="4851845"><a href="/expvar/expvar.go.html#4851589">av</a></span><span class="op" id="4851847">.</span><span class="op" id="4851848">(</span><span class="op" id="4851849">*</span><span class="ident" id="4851850"><a href="/expvar/expvar.go.html#4849592">Float</a></span><span class="op" id="4851855">)</span><span class="op" id="4851856">;</span>&nbsp;<span class="ident" id="4851858"><a href="/expvar/expvar.go.html#4851839">ok</a></span>&nbsp;<span class="op" id="4851861">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851865"><a href="/expvar/expvar.go.html#4851835">iv</a></span><span class="op" id="4851867">.</span><span class="ident" id="4851868">Add</span><span class="op" id="4851871">(</span><span class="ident" id="4851872"><a href="/expvar/expvar.go.html#4851557">delta</a></span><span class="op" id="4851877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851880">}</span><br>
<span class="lineno"></span><span class="op" id="4851882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4851885">//&nbsp;Do&nbsp;calls&nbsp;f&nbsp;for&nbsp;each&nbsp;entry&nbsp;in&nbsp;the&nbsp;map.</span><br>
<span class="lineno">200</span><span class="comment" id="4851926">//&nbsp;The&nbsp;map&nbsp;is&nbsp;locked&nbsp;during&nbsp;the&nbsp;iteration,</span><br>
<span class="lineno"></span><span class="comment" id="4851969">//&nbsp;but&nbsp;existing&nbsp;entries&nbsp;may&nbsp;be&nbsp;concurrently&nbsp;updated.</span><br>
<span class="lineno"></span><span class="keyword" id="4852022">func</span>&nbsp;<span class="op" id="4852027">(</span><span class="ident" id="4852028">v</span>&nbsp;<span class="op" id="4852030">*</span><span class="ident" id="4852031"><a href="/expvar/expvar.go.html#4850059">Map</a></span><span class="op" id="4852034">)</span>&nbsp;<span class="ident" id="4852036">Do</span><span class="op" id="4852038">(</span><span class="ident" id="4852039">f</span>&nbsp;<span class="keyword" id="4852041">func</span><span class="op" id="4852045">(</span><span class="ident" id="4852046"><a href="/expvar/expvar.go.html#4850193">KeyValue</a></span><span class="op" id="4852054">)</span><span class="op" id="4852055">)</span>&nbsp;<span class="op" id="4852057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852060"><a href="/expvar/expvar.go.html#4852028">v</a></span><span class="op" id="4852061">.</span><span class="ident" id="4852062">mu</span><span class="op" id="4852064">.</span><span class="ident" id="4852065">RLock</span><span class="op" id="4852070">(</span><span class="op" id="4852071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852074">defer</span>&nbsp;<span class="ident" id="4852080"><a href="/expvar/expvar.go.html#4852028">v</a></span><span class="op" id="4852081">.</span><span class="ident" id="4852082">mu</span><span class="op" id="4852084">.</span><span class="ident" id="4852085">RUnlock</span><span class="op" id="4852092">(</span><span class="op" id="4852093">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852096"><a href="/expvar/expvar.go.html#4852028">v</a></span><span class="op" id="4852097">.</span><span class="ident" id="4852098">doLocked</span><span class="op" id="4852106">(</span><span class="ident" id="4852107"><a href="/expvar/expvar.go.html#4852039">f</a></span><span class="op" id="4852108">)</span><br>
<span class="lineno"></span><span class="op" id="4852110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4852113">//&nbsp;doLocked&nbsp;calls&nbsp;f&nbsp;for&nbsp;each&nbsp;entry&nbsp;in&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="4852160">//&nbsp;v.mu&nbsp;must&nbsp;be&nbsp;held&nbsp;for&nbsp;reads.</span><br>
<span class="lineno">210</span><span class="keyword" id="4852192">func</span>&nbsp;<span class="op" id="4852197">(</span><span class="ident" id="4852198">v</span>&nbsp;<span class="op" id="4852200">*</span><span class="ident" id="4852201"><a href="/expvar/expvar.go.html#4850059">Map</a></span><span class="op" id="4852204">)</span>&nbsp;<span class="ident" id="4852206">doLocked</span><span class="op" id="4852214">(</span><span class="ident" id="4852215">f</span>&nbsp;<span class="keyword" id="4852217">func</span><span class="op" id="4852221">(</span><span class="ident" id="4852222"><a href="/expvar/expvar.go.html#4850193">KeyValue</a></span><span class="op" id="4852230">)</span><span class="op" id="4852231">)</span>&nbsp;<span class="op" id="4852233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852236">for</span>&nbsp;<span class="ident" id="4852240">_</span><span class="op" id="4852241">,</span>&nbsp;<span class="ident" id="4852243">k</span>&nbsp;<span class="op" id="4852245">:=</span>&nbsp;<span class="keyword" id="4852248">range</span>&nbsp;<span class="ident" id="4852254"><a href="/expvar/expvar.go.html#4852198">v</a></span><span class="op" id="4852255">.</span><span class="ident" id="4852256">keys</span>&nbsp;<span class="op" id="4852261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852265"><a href="/expvar/expvar.go.html#4852215">f</a></span><span class="op" id="4852266">(</span><span class="ident" id="4852267"><a href="/expvar/expvar.go.html#4850193">KeyValue</a></span><span class="op" id="4852275">{</span><span class="ident" id="4852276"><a href="/expvar/expvar.go.html#4852243">k</a></span><span class="op" id="4852277">,</span>&nbsp;<span class="ident" id="4852279"><a href="/expvar/expvar.go.html#4852198">v</a></span><span class="op" id="4852280">.</span><span class="ident" id="4852281">m</span><span class="op" id="4852282">[</span><span class="ident" id="4852283"><a href="/expvar/expvar.go.html#4852243">k</a></span><span class="op" id="4852284">]</span><span class="op" id="4852285">}</span><span class="op" id="4852286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4852289">}</span><br>
<span class="lineno"></span><span class="op" id="4852291">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="comment" id="4852294">//&nbsp;String&nbsp;is&nbsp;a&nbsp;string&nbsp;variable,&nbsp;and&nbsp;satisfies&nbsp;the&nbsp;Var&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="4852359">type</span>&nbsp;<span class="ident" id="4852364">String</span>&nbsp;<span class="keyword" id="4852371">struct</span>&nbsp;<span class="op" id="4852378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852381">mu</span>&nbsp;<span class="ident" id="4852384"><a href="/expvar/expvar.go.html#4849020">sync</a></span><span class="op" id="4852388">.</span><span class="ident" id="4852389">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852398">s</span>&nbsp;&nbsp;<span class="builtintype" id="4852401">string</span><br>
<span class="lineno">220</span><span class="op" id="4852408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4852411">func</span>&nbsp;<span class="op" id="4852416">(</span><span class="ident" id="4852417">v</span>&nbsp;<span class="op" id="4852419">*</span><span class="ident" id="4852420"><a href="/expvar/expvar.go.html#4852364">String</a></span><span class="op" id="4852426">)</span>&nbsp;<span class="ident" id="4852428">String</span><span class="op" id="4852434">(</span><span class="op" id="4852435">)</span>&nbsp;<span class="builtintype" id="4852437">string</span>&nbsp;<span class="op" id="4852444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852447"><a href="/expvar/expvar.go.html#4852417">v</a></span><span class="op" id="4852448">.</span><span class="ident" id="4852449">mu</span><span class="op" id="4852451">.</span><span class="ident" id="4852452">RLock</span><span class="op" id="4852457">(</span><span class="op" id="4852458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852461">defer</span>&nbsp;<span class="ident" id="4852467"><a href="/expvar/expvar.go.html#4852417">v</a></span><span class="op" id="4852468">.</span><span class="ident" id="4852469">mu</span><span class="op" id="4852471">.</span><span class="ident" id="4852472">RUnlock</span><span class="op" id="4852479">(</span><span class="op" id="4852480">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852483">return</span>&nbsp;<span class="ident" id="4852490"><a href="/expvar/expvar.go.html#4849009">strconv</a></span><span class="op" id="4852497">.</span><span class="ident" id="4852498">Quote</span><span class="op" id="4852503">(</span><span class="ident" id="4852504"><a href="/expvar/expvar.go.html#4852417">v</a></span><span class="op" id="4852505">.</span><span class="ident" id="4852506">s</span><span class="op" id="4852507">)</span><br>
<span class="lineno"></span><span class="op" id="4852509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4852512">func</span>&nbsp;<span class="op" id="4852517">(</span><span class="ident" id="4852518">v</span>&nbsp;<span class="op" id="4852520">*</span><span class="ident" id="4852521"><a href="/expvar/expvar.go.html#4852364">String</a></span><span class="op" id="4852527">)</span>&nbsp;<span class="ident" id="4852529">Set</span><span class="op" id="4852532">(</span><span class="ident" id="4852533">value</span>&nbsp;<span class="builtintype" id="4852539">string</span><span class="op" id="4852545">)</span>&nbsp;<span class="op" id="4852547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852550"><a href="/expvar/expvar.go.html#4852518">v</a></span><span class="op" id="4852551">.</span><span class="ident" id="4852552">mu</span><span class="op" id="4852554">.</span><span class="ident" id="4852555">Lock</span><span class="op" id="4852559">(</span><span class="op" id="4852560">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852563">defer</span>&nbsp;<span class="ident" id="4852569"><a href="/expvar/expvar.go.html#4852518">v</a></span><span class="op" id="4852570">.</span><span class="ident" id="4852571">mu</span><span class="op" id="4852573">.</span><span class="ident" id="4852574">Unlock</span><span class="op" id="4852580">(</span><span class="op" id="4852581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852584"><a href="/expvar/expvar.go.html#4852518">v</a></span><span class="op" id="4852585">.</span><span class="ident" id="4852586">s</span>&nbsp;<span class="op" id="4852588">=</span>&nbsp;<span class="ident" id="4852590"><a href="/expvar/expvar.go.html#4852533">value</a></span><br>
<span class="lineno"></span><span class="op" id="4852596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4852599">//&nbsp;Func&nbsp;implements&nbsp;Var&nbsp;by&nbsp;calling&nbsp;the&nbsp;function</span><br>
<span class="lineno">235</span><span class="comment" id="4852646">//&nbsp;and&nbsp;formatting&nbsp;the&nbsp;returned&nbsp;value&nbsp;using&nbsp;JSON.</span><br>
<span class="lineno"></span><span class="keyword" id="4852695">type</span>&nbsp;<span class="ident" id="4852700">Func</span>&nbsp;<span class="keyword" id="4852705">func</span><span class="op" id="4852709">(</span><span class="op" id="4852710">)</span>&nbsp;<span class="keyword" id="4852712">interface</span><span class="op" id="4852721">{</span><span class="op" id="4852722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4852725">func</span>&nbsp;<span class="op" id="4852730">(</span><span class="ident" id="4852731">f</span>&nbsp;<span class="ident" id="4852733"><a href="/expvar/expvar.go.html#4852700">Func</a></span><span class="op" id="4852737">)</span>&nbsp;<span class="ident" id="4852739">String</span><span class="op" id="4852745">(</span><span class="op" id="4852746">)</span>&nbsp;<span class="builtintype" id="4852748">string</span>&nbsp;<span class="op" id="4852755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852758">v</span><span class="op" id="4852759">,</span>&nbsp;<span class="ident" id="4852761">_</span>&nbsp;<span class="op" id="4852763">:=</span>&nbsp;<span class="ident" id="4852766"><a href="/expvar/expvar.go.html#4848941">json</a></span><span class="op" id="4852770">.</span><span class="ident" id="4852771">Marshal</span><span class="op" id="4852778">(</span><span class="ident" id="4852779"><a href="/expvar/expvar.go.html#4852731">f</a></span><span class="op" id="4852780">(</span><span class="op" id="4852781">)</span><span class="op" id="4852782">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852785">return</span>&nbsp;<span class="builtintype" id="4852792">string</span><span class="op" id="4852798">(</span><span class="ident" id="4852799"><a href="/expvar/expvar.go.html#4852758">v</a></span><span class="op" id="4852800">)</span><br>
<span class="lineno"></span><span class="op" id="4852802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4852805">//&nbsp;All&nbsp;published&nbsp;variables.</span><br>
<span class="lineno"></span><span class="keyword" id="4852833">var</span>&nbsp;<span class="op" id="4852837">(</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852840">mutex</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4852848"><a href="/expvar/expvar.go.html#4849020">sync</a></span><span class="op" id="4852852">.</span><span class="ident" id="4852853">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852862">vars</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4852870">=</span>&nbsp;<span class="builtinfunc" id="4852872">make</span><span class="op" id="4852876">(</span><span class="keyword" id="4852877">map</span><span class="op" id="4852880">[</span><span class="builtintype" id="4852881">string</span><span class="op" id="4852887">]</span><span class="ident" id="4852888"><a href="/expvar/expvar.go.html#4849090">Var</a></span><span class="op" id="4852891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852894">varKeys</span>&nbsp;<span class="op" id="4852902">[</span><span class="op" id="4852903">]</span><span class="builtintype" id="4852904">string</span>&nbsp;<span class="comment" id="4852911">//&nbsp;sorted</span><br>
<span class="lineno"></span><span class="op" id="4852921">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="4852924">//&nbsp;Publish&nbsp;declares&nbsp;a&nbsp;named&nbsp;exported&nbsp;variable.&nbsp;This&nbsp;should&nbsp;be&nbsp;called&nbsp;from&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4853000">//&nbsp;package&#39;s&nbsp;init&nbsp;function&nbsp;when&nbsp;it&nbsp;creates&nbsp;its&nbsp;Vars.&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="4853076">//&nbsp;registered&nbsp;then&nbsp;this&nbsp;will&nbsp;log.Panic.</span><br>
<span class="lineno"></span><span class="keyword" id="4853116">func</span>&nbsp;<span class="ident" id="4853121">Publish</span><span class="op" id="4853128">(</span><span class="ident" id="4853129">name</span>&nbsp;<span class="builtintype" id="4853134">string</span><span class="op" id="4853140">,</span>&nbsp;<span class="ident" id="4853142">v</span>&nbsp;<span class="ident" id="4853144"><a href="/expvar/expvar.go.html#4849090">Var</a></span><span class="op" id="4853147">)</span>&nbsp;<span class="op" id="4853149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853152"><a href="/expvar/expvar.go.html#4852840">mutex</a></span><span class="op" id="4853157">.</span><span class="ident" id="4853158">Lock</span><span class="op" id="4853162">(</span><span class="op" id="4853163">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4853166">defer</span>&nbsp;<span class="ident" id="4853172"><a href="/expvar/expvar.go.html#4852840">mutex</a></span><span class="op" id="4853177">.</span><span class="ident" id="4853178">Unlock</span><span class="op" id="4853184">(</span><span class="op" id="4853185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4853188">if</span>&nbsp;<span class="ident" id="4853191">_</span><span class="op" id="4853192">,</span>&nbsp;<span class="ident" id="4853194">existing</span>&nbsp;<span class="op" id="4853203">:=</span>&nbsp;<span class="ident" id="4853206"><a href="/expvar/expvar.go.html#4852862">vars</a></span><span class="op" id="4853210">[</span><span class="ident" id="4853211"><a href="/expvar/expvar.go.html#4853129">name</a></span><span class="op" id="4853215">]</span><span class="op" id="4853216">;</span>&nbsp;<span class="ident" id="4853218"><a href="/expvar/expvar.go.html#4853194">existing</a></span>&nbsp;<span class="op" id="4853227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853231"><a href="/expvar/expvar.go.html#4848965">log</a></span><span class="op" id="4853234">.</span><span class="ident" id="4853235">Panicln</span><span class="op" id="4853242">(</span><span class="string" id="4853243">&#34;Reuse&nbsp;of&nbsp;exported&nbsp;var&nbsp;name:&#34;</span><span class="op" id="4853272">,</span>&nbsp;<span class="ident" id="4853274"><a href="/expvar/expvar.go.html#4853129">name</a></span><span class="op" id="4853278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4853281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853284"><a href="/expvar/expvar.go.html#4852862">vars</a></span><span class="op" id="4853288">[</span><span class="ident" id="4853289"><a href="/expvar/expvar.go.html#4853129">name</a></span><span class="op" id="4853293">]</span>&nbsp;<span class="op" id="4853295">=</span>&nbsp;<span class="ident" id="4853297"><a href="/expvar/expvar.go.html#4853142">v</a></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853300"><a href="/expvar/expvar.go.html#4852894">varKeys</a></span>&nbsp;<span class="op" id="4853308">=</span>&nbsp;<span class="builtinfunc" id="4853310">append</span><span class="op" id="4853316">(</span><span class="ident" id="4853317"><a href="/expvar/expvar.go.html#4852894">varKeys</a></span><span class="op" id="4853324">,</span>&nbsp;<span class="ident" id="4853326"><a href="/expvar/expvar.go.html#4853129">name</a></span><span class="op" id="4853330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853333"><a href="/expvar/expvar.go.html#4849001">sort</a></span><span class="op" id="4853337">.</span><span class="ident" id="4853338">Strings</span><span class="op" id="4853345">(</span><span class="ident" id="4853346"><a href="/expvar/expvar.go.html#4852894">varKeys</a></span><span class="op" id="4853353">)</span><br>
<span class="lineno"></span><span class="op" id="4853355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4853358">//&nbsp;Get&nbsp;retrieves&nbsp;a&nbsp;named&nbsp;exported&nbsp;variable.</span><br>
<span class="lineno">265</span><span class="keyword" id="4853402">func</span>&nbsp;<span class="ident" id="4853407">Get</span><span class="op" id="4853410">(</span><span class="ident" id="4853411">name</span>&nbsp;<span class="builtintype" id="4853416">string</span><span class="op" id="4853422">)</span>&nbsp;<span class="ident" id="4853424"><a href="/expvar/expvar.go.html#4849090">Var</a></span>&nbsp;<span class="op" id="4853428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853431"><a href="/expvar/expvar.go.html#4852840">mutex</a></span><span class="op" id="4853436">.</span><span class="ident" id="4853437">RLock</span><span class="op" id="4853442">(</span><span class="op" id="4853443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4853446">defer</span>&nbsp;<span class="ident" id="4853452"><a href="/expvar/expvar.go.html#4852840">mutex</a></span><span class="op" id="4853457">.</span><span class="ident" id="4853458">RUnlock</span><span class="op" id="4853465">(</span><span class="op" id="4853466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4853469">return</span>&nbsp;<span class="ident" id="4853476"><a href="/expvar/expvar.go.html#4852862">vars</a></span><span class="op" id="4853480">[</span><span class="ident" id="4853481"><a href="/expvar/expvar.go.html#4853411">name</a></span><span class="op" id="4853485">]</span><br>
<span class="lineno"></span><span class="op" id="4853487">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="4853490">//&nbsp;Convenience&nbsp;functions&nbsp;for&nbsp;creating&nbsp;new&nbsp;exported&nbsp;variables.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4853553">func</span>&nbsp;<span class="ident" id="4853558">NewInt</span><span class="op" id="4853564">(</span><span class="ident" id="4853565">name</span>&nbsp;<span class="builtintype" id="4853570">string</span><span class="op" id="4853576">)</span>&nbsp;<span class="op" id="4853578">*</span><span class="ident" id="4853579"><a href="/expvar/expvar.go.html#4849201">Int</a></span>&nbsp;<span class="op" id="4853583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853586">v</span>&nbsp;<span class="op" id="4853588">:=</span>&nbsp;<span class="builtinfunc" id="4853591">new</span><span class="op" id="4853594">(</span><span class="ident" id="4853595"><a href="/expvar/expvar.go.html#4849201">Int</a></span><span class="op" id="4853598">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853601"><a href="/expvar/expvar.go.html#4853121">Publish</a></span><span class="op" id="4853608">(</span><span class="ident" id="4853609"><a href="/expvar/expvar.go.html#4853565">name</a></span><span class="op" id="4853613">,</span>&nbsp;<span class="ident" id="4853615"><a href="/expvar/expvar.go.html#4853586">v</a></span><span class="op" id="4853616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4853619">return</span>&nbsp;<span class="ident" id="4853626"><a href="/expvar/expvar.go.html#4853586">v</a></span><br>
<span class="lineno"></span><span class="op" id="4853628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4853631">func</span>&nbsp;<span class="ident" id="4853636">NewFloat</span><span class="op" id="4853644">(</span><span class="ident" id="4853645">name</span>&nbsp;<span class="builtintype" id="4853650">string</span><span class="op" id="4853656">)</span>&nbsp;<span class="op" id="4853658">*</span><span class="ident" id="4853659"><a href="/expvar/expvar.go.html#4849592">Float</a></span>&nbsp;<span class="op" id="4853665">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853668">v</span>&nbsp;<span class="op" id="4853670">:=</span>&nbsp;<span class="builtinfunc" id="4853673">new</span><span class="op" id="4853676">(</span><span class="ident" id="4853677"><a href="/expvar/expvar.go.html#4849592">Float</a></span><span class="op" id="4853682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853685"><a href="/expvar/expvar.go.html#4853121">Publish</a></span><span class="op" id="4853692">(</span><span class="ident" id="4853693"><a href="/expvar/expvar.go.html#4853645">name</a></span><span class="op" id="4853697">,</span>&nbsp;<span class="ident" id="4853699"><a href="/expvar/expvar.go.html#4853668">v</a></span><span class="op" id="4853700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4853703">return</span>&nbsp;<span class="ident" id="4853710"><a href="/expvar/expvar.go.html#4853668">v</a></span><br>
<span class="lineno"></span><span class="op" id="4853712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="4853715">func</span>&nbsp;<span class="ident" id="4853720">NewMap</span><span class="op" id="4853726">(</span><span class="ident" id="4853727">name</span>&nbsp;<span class="builtintype" id="4853732">string</span><span class="op" id="4853738">)</span>&nbsp;<span class="op" id="4853740">*</span><span class="ident" id="4853741"><a href="/expvar/expvar.go.html#4850059">Map</a></span>&nbsp;<span class="op" id="4853745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853748">v</span>&nbsp;<span class="op" id="4853750">:=</span>&nbsp;<span class="builtinfunc" id="4853753">new</span><span class="op" id="4853756">(</span><span class="ident" id="4853757"><a href="/expvar/expvar.go.html#4850059">Map</a></span><span class="op" id="4853760">)</span><span class="op" id="4853761">.</span><span class="ident" id="4853762">Init</span><span class="op" id="4853766">(</span><span class="op" id="4853767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853770"><a href="/expvar/expvar.go.html#4853121">Publish</a></span><span class="op" id="4853777">(</span><span class="ident" id="4853778"><a href="/expvar/expvar.go.html#4853727">name</a></span><span class="op" id="4853782">,</span>&nbsp;<span class="ident" id="4853784"><a href="/expvar/expvar.go.html#4853748">v</a></span><span class="op" id="4853785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4853788">return</span>&nbsp;<span class="ident" id="4853795"><a href="/expvar/expvar.go.html#4853748">v</a></span><br>
<span class="lineno"></span><span class="op" id="4853797">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="keyword" id="4853800">func</span>&nbsp;<span class="ident" id="4853805">NewString</span><span class="op" id="4853814">(</span><span class="ident" id="4853815">name</span>&nbsp;<span class="builtintype" id="4853820">string</span><span class="op" id="4853826">)</span>&nbsp;<span class="op" id="4853828">*</span><span class="ident" id="4853829"><a href="/expvar/expvar.go.html#4852364">String</a></span>&nbsp;<span class="op" id="4853836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853839">v</span>&nbsp;<span class="op" id="4853841">:=</span>&nbsp;<span class="builtinfunc" id="4853844">new</span><span class="op" id="4853847">(</span><span class="ident" id="4853848"><a href="/expvar/expvar.go.html#4852364">String</a></span><span class="op" id="4853854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853857"><a href="/expvar/expvar.go.html#4853121">Publish</a></span><span class="op" id="4853864">(</span><span class="ident" id="4853865"><a href="/expvar/expvar.go.html#4853815">name</a></span><span class="op" id="4853869">,</span>&nbsp;<span class="ident" id="4853871"><a href="/expvar/expvar.go.html#4853839">v</a></span><span class="op" id="4853872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4853875">return</span>&nbsp;<span class="ident" id="4853882"><a href="/expvar/expvar.go.html#4853839">v</a></span><br>
<span class="lineno">295</span><span class="op" id="4853884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4853887">//&nbsp;Do&nbsp;calls&nbsp;f&nbsp;for&nbsp;each&nbsp;exported&nbsp;variable.</span><br>
<span class="lineno"></span><span class="comment" id="4853929">//&nbsp;The&nbsp;global&nbsp;variable&nbsp;map&nbsp;is&nbsp;locked&nbsp;during&nbsp;the&nbsp;iteration,</span><br>
<span class="lineno"></span><span class="comment" id="4853988">//&nbsp;but&nbsp;existing&nbsp;entries&nbsp;may&nbsp;be&nbsp;concurrently&nbsp;updated.</span><br>
<span class="lineno">300</span><span class="keyword" id="4854041">func</span>&nbsp;<span class="ident" id="4854046">Do</span><span class="op" id="4854048">(</span><span class="ident" id="4854049">f</span>&nbsp;<span class="keyword" id="4854051">func</span><span class="op" id="4854055">(</span><span class="ident" id="4854056"><a href="/expvar/expvar.go.html#4850193">KeyValue</a></span><span class="op" id="4854064">)</span><span class="op" id="4854065">)</span>&nbsp;<span class="op" id="4854067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854070"><a href="/expvar/expvar.go.html#4852840">mutex</a></span><span class="op" id="4854075">.</span><span class="ident" id="4854076">RLock</span><span class="op" id="4854081">(</span><span class="op" id="4854082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4854085">defer</span>&nbsp;<span class="ident" id="4854091"><a href="/expvar/expvar.go.html#4852840">mutex</a></span><span class="op" id="4854096">.</span><span class="ident" id="4854097">RUnlock</span><span class="op" id="4854104">(</span><span class="op" id="4854105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4854108">for</span>&nbsp;<span class="ident" id="4854112">_</span><span class="op" id="4854113">,</span>&nbsp;<span class="ident" id="4854115">k</span>&nbsp;<span class="op" id="4854117">:=</span>&nbsp;<span class="keyword" id="4854120">range</span>&nbsp;<span class="ident" id="4854126"><a href="/expvar/expvar.go.html#4852894">varKeys</a></span>&nbsp;<span class="op" id="4854134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854138"><a href="/expvar/expvar.go.html#4854049">f</a></span><span class="op" id="4854139">(</span><span class="ident" id="4854140"><a href="/expvar/expvar.go.html#4850193">KeyValue</a></span><span class="op" id="4854148">{</span><span class="ident" id="4854149"><a href="/expvar/expvar.go.html#4854115">k</a></span><span class="op" id="4854150">,</span>&nbsp;<span class="ident" id="4854152"><a href="/expvar/expvar.go.html#4852862">vars</a></span><span class="op" id="4854156">[</span><span class="ident" id="4854157"><a href="/expvar/expvar.go.html#4854115">k</a></span><span class="op" id="4854158">]</span><span class="op" id="4854159">}</span><span class="op" id="4854160">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4854163">}</span><br>
<span class="lineno"></span><span class="op" id="4854165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4854168">func</span>&nbsp;<span class="ident" id="4854173">expvarHandler</span><span class="op" id="4854186">(</span><span class="ident" id="4854187">w</span>&nbsp;<span class="ident" id="4854189"><a href="/expvar/expvar.go.html#4848972">http</a></span><span class="op" id="4854193">.</span><span class="ident" id="4854194">ResponseWriter</span><span class="op" id="4854208">,</span>&nbsp;<span class="ident" id="4854210">r</span>&nbsp;<span class="op" id="4854212">*</span><span class="ident" id="4854213"><a href="/expvar/expvar.go.html#4848972">http</a></span><span class="op" id="4854217">.</span><span class="ident" id="4854218">Request</span><span class="op" id="4854225">)</span>&nbsp;<span class="op" id="4854227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854230"><a href="/expvar/expvar.go.html#4854187">w</a></span><span class="op" id="4854231">.</span><span class="ident" id="4854232">Header</span><span class="op" id="4854238">(</span><span class="op" id="4854239">)</span><span class="op" id="4854240">.</span><span class="ident" id="4854241">Set</span><span class="op" id="4854244">(</span><span class="string" id="4854245">&#34;Content-Type&#34;</span><span class="op" id="4854259">,</span>&nbsp;<span class="string" id="4854261">&#34;application/json;&nbsp;charset=utf-8&#34;</span><span class="op" id="4854294">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854297"><a href="/expvar/expvar.go.html#4848958">fmt</a></span><span class="op" id="4854300">.</span><span class="ident" id="4854301">Fprintf</span><span class="op" id="4854308">(</span><span class="ident" id="4854309"><a href="/expvar/expvar.go.html#4854187">w</a></span><span class="op" id="4854310">,</span>&nbsp;<span class="string" id="4854312">&#34;{\n&#34;</span><span class="op" id="4854317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854320">first</span>&nbsp;<span class="op" id="4854326">:=</span>&nbsp;<span class="builtintype" id="4854329">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854335"><a href="/expvar/expvar.go.html#4854046">Do</a></span><span class="op" id="4854337">(</span><span class="keyword" id="4854338">func</span><span class="op" id="4854342">(</span><span class="ident" id="4854343">kv</span>&nbsp;<span class="ident" id="4854346"><a href="/expvar/expvar.go.html#4850193">KeyValue</a></span><span class="op" id="4854354">)</span>&nbsp;<span class="op" id="4854356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4854360">if</span>&nbsp;<span class="op" id="4854363">!</span><span class="ident" id="4854364"><a href="/expvar/expvar.go.html#4854320">first</a></span>&nbsp;<span class="op" id="4854370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854375"><a href="/expvar/expvar.go.html#4848958">fmt</a></span><span class="op" id="4854378">.</span><span class="ident" id="4854379">Fprintf</span><span class="op" id="4854386">(</span><span class="ident" id="4854387"><a href="/expvar/expvar.go.html#4854187">w</a></span><span class="op" id="4854388">,</span>&nbsp;<span class="string" id="4854390">&#34;,\n&#34;</span><span class="op" id="4854395">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4854399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854403"><a href="/expvar/expvar.go.html#4854320">first</a></span>&nbsp;<span class="op" id="4854409">=</span>&nbsp;<span class="builtintype" id="4854411">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854419"><a href="/expvar/expvar.go.html#4848958">fmt</a></span><span class="op" id="4854422">.</span><span class="ident" id="4854423">Fprintf</span><span class="op" id="4854430">(</span><span class="ident" id="4854431"><a href="/expvar/expvar.go.html#4854187">w</a></span><span class="op" id="4854432">,</span>&nbsp;<span class="string" id="4854434">&#34;%q:&nbsp;%s&#34;</span><span class="op" id="4854442">,</span>&nbsp;<span class="ident" id="4854444"><a href="/expvar/expvar.go.html#4854343">kv</a></span><span class="op" id="4854446">.</span><span class="ident" id="4854447">Key</span><span class="op" id="4854450">,</span>&nbsp;<span class="ident" id="4854452"><a href="/expvar/expvar.go.html#4854343">kv</a></span><span class="op" id="4854454">.</span><span class="ident" id="4854455">Value</span><span class="op" id="4854460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4854463">}</span><span class="op" id="4854464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854467"><a href="/expvar/expvar.go.html#4848958">fmt</a></span><span class="op" id="4854470">.</span><span class="ident" id="4854471">Fprintf</span><span class="op" id="4854478">(</span><span class="ident" id="4854479"><a href="/expvar/expvar.go.html#4854187">w</a></span><span class="op" id="4854480">,</span>&nbsp;<span class="string" id="4854482">&#34;\n}\n&#34;</span><span class="op" id="4854489">)</span><br>
<span class="lineno">320</span><span class="op" id="4854491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4854494">func</span>&nbsp;<span class="ident" id="4854499">cmdline</span><span class="op" id="4854506">(</span><span class="op" id="4854507">)</span>&nbsp;<span class="keyword" id="4854509">interface</span><span class="op" id="4854518">{</span><span class="op" id="4854519">}</span>&nbsp;<span class="op" id="4854521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4854524">return</span>&nbsp;<span class="ident" id="4854531"><a href="/expvar/expvar.go.html#4848984">os</a></span><span class="op" id="4854533">.</span><span class="ident" id="4854534">Args</span><br>
<span class="lineno"></span><span class="op" id="4854539">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="4854542">func</span>&nbsp;<span class="ident" id="4854547">memstats</span><span class="op" id="4854555">(</span><span class="op" id="4854556">)</span>&nbsp;<span class="keyword" id="4854558">interface</span><span class="op" id="4854567">{</span><span class="op" id="4854568">}</span>&nbsp;<span class="op" id="4854570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854573">stats</span>&nbsp;<span class="op" id="4854579">:=</span>&nbsp;<span class="builtinfunc" id="4854582">new</span><span class="op" id="4854585">(</span><span class="ident" id="4854586"><a href="/expvar/expvar.go.html#4848990">runtime</a></span><span class="op" id="4854593">.</span><span class="ident" id="4854594">MemStats</span><span class="op" id="4854602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854605"><a href="/expvar/expvar.go.html#4848990">runtime</a></span><span class="op" id="4854612">.</span><span class="ident" id="4854613">ReadMemStats</span><span class="op" id="4854625">(</span><span class="ident" id="4854626"><a href="/expvar/expvar.go.html#4854573">stats</a></span><span class="op" id="4854631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4854634">return</span>&nbsp;<span class="op" id="4854641">*</span><span class="ident" id="4854642"><a href="/expvar/expvar.go.html#4854573">stats</a></span><br>
<span class="lineno">330</span><span class="op" id="4854648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4854651">func</span>&nbsp;<span class="ident" id="4854656">init</span><span class="op" id="4854660">(</span><span class="op" id="4854661">)</span>&nbsp;<span class="op" id="4854663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854666"><a href="/expvar/expvar.go.html#4848972">http</a></span><span class="op" id="4854670">.</span><span class="ident" id="4854671">HandleFunc</span><span class="op" id="4854681">(</span><span class="string" id="4854682">&#34;/debug/vars&#34;</span><span class="op" id="4854695">,</span>&nbsp;<span class="ident" id="4854697"><a href="/expvar/expvar.go.html#4854173">expvarHandler</a></span><span class="op" id="4854710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854713"><a href="/expvar/expvar.go.html#4853121">Publish</a></span><span class="op" id="4854720">(</span><span class="string" id="4854721">&#34;cmdline&#34;</span><span class="op" id="4854730">,</span>&nbsp;<span class="ident" id="4854732"><a href="/expvar/expvar.go.html#4852700">Func</a></span><span class="op" id="4854736">(</span><span class="ident" id="4854737"><a href="/expvar/expvar.go.html#4854499">cmdline</a></span><span class="op" id="4854744">)</span><span class="op" id="4854745">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854748"><a href="/expvar/expvar.go.html#4853121">Publish</a></span><span class="op" id="4854755">(</span><span class="string" id="4854756">&#34;memstats&#34;</span><span class="op" id="4854766">,</span>&nbsp;<span class="ident" id="4854768"><a href="/expvar/expvar.go.html#4852700">Func</a></span><span class="op" id="4854772">(</span><span class="ident" id="4854773"><a href="/expvar/expvar.go.html#4854547">memstats</a></span><span class="op" id="4854781">)</span><span class="op" id="4854782">)</span><br>
<span class="lineno"></span><span class="op" id="4854784">}</span>
</div>
</body>
</html>
