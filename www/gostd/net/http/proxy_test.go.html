<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8504740">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8504795">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8504849">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8504900">package</span>&nbsp;<span class="ident" id="8504908">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8504914">import</span>&nbsp;<span class="op" id="8504921">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8504924">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8504935">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8504941">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8504951">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8504954">//&nbsp;TODO(mattn):</span><br>
<span class="lineno"></span><span class="comment" id="8504970">//&nbsp;&nbsp;&nbsp;&nbsptest&nbsp;ProxyAuth</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8504989">var</span>&nbsp;<span class="ident" id="8504993">UseProxyTests</span>&nbsp;<span class="op" id="8505007">=</span>&nbsp;<span class="op" id="8505009">[</span><span class="op" id="8505010">]</span><span class="keyword" id="8505011">struct</span>&nbsp;<span class="op" id="8505018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8505021">host</span>&nbsp;&nbsp;<span class="builtintype" id="8505027">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8505035">match</span>&nbsp;<span class="builtintype" id="8505041">bool</span><br>
<span class="lineno"></span><span class="op" id="8505046">}</span><span class="op" id="8505047">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8505050">//&nbsp;Never&nbsp;proxy&nbsp;localhost:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8505077">{</span><span class="string" id="8505078">&#34;localhost:80&#34;</span><span class="op" id="8505092">,</span>&nbsp;<span class="builtintype" id="8505094">false</span><span class="op" id="8505099">}</span><span class="op" id="8505100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8505103">{</span><span class="string" id="8505104">&#34;127.0.0.1&#34;</span><span class="op" id="8505115">,</span>&nbsp;<span class="builtintype" id="8505117">false</span><span class="op" id="8505122">}</span><span class="op" id="8505123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8505126">{</span><span class="string" id="8505127">&#34;127.0.0.2&#34;</span><span class="op" id="8505138">,</span>&nbsp;<span class="builtintype" id="8505140">false</span><span class="op" id="8505145">}</span><span class="op" id="8505146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8505149">{</span><span class="string" id="8505150">&#34;[::1]&#34;</span><span class="op" id="8505157">,</span>&nbsp;<span class="builtintype" id="8505159">false</span><span class="op" id="8505164">}</span><span class="op" id="8505165">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8505168">{</span><span class="string" id="8505169">&#34;[::2]&#34;</span><span class="op" id="8505176">,</span>&nbsp;<span class="builtintype" id="8505178">true</span><span class="op" id="8505182">}</span><span class="op" id="8505183">,</span>&nbsp;<span class="comment" id="8505185">//&nbsp;not&nbsp;a&nbsp;loopback&nbsp;address</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8505213">{</span><span class="string" id="8505214">&#34;barbaz.net&#34;</span><span class="op" id="8505226">,</span>&nbsp;<span class="builtintype" id="8505228">false</span><span class="op" id="8505233">}</span><span class="op" id="8505234">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8505240">//&nbsp;match&nbsp;as&nbsp;.barbaz.net</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8505265">{</span><span class="string" id="8505266">&#34;foobar.com&#34;</span><span class="op" id="8505278">,</span>&nbsp;<span class="builtintype" id="8505280">false</span><span class="op" id="8505285">}</span><span class="op" id="8505286">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8505292">//&nbsp;have&nbsp;a&nbsp;port&nbsp;but&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8505318">{</span><span class="string" id="8505319">&#34;foofoobar.com&#34;</span><span class="op" id="8505334">,</span>&nbsp;<span class="builtintype" id="8505336">true</span><span class="op" id="8505340">}</span><span class="op" id="8505341">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="8505345">//&nbsp;not&nbsp;match&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;foobar.com</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8505383">{</span><span class="string" id="8505384">&#34;baz.com&#34;</span><span class="op" id="8505393">,</span>&nbsp;<span class="builtintype" id="8505395">true</span><span class="op" id="8505399">}</span><span class="op" id="8505400">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8505410">//&nbsp;not&nbsp;match&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;barbaz.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8505448">{</span><span class="string" id="8505449">&#34;localhost.net&#34;</span><span class="op" id="8505464">,</span>&nbsp;<span class="builtintype" id="8505466">true</span><span class="op" id="8505470">}</span><span class="op" id="8505471">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="8505475">//&nbsp;not&nbsp;match&nbsp;as&nbsp;suffix&nbsp;of&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8505510">{</span><span class="string" id="8505511">&#34;local.localhost&#34;</span><span class="op" id="8505528">,</span>&nbsp;<span class="builtintype" id="8505530">true</span><span class="op" id="8505534">}</span><span class="op" id="8505535">,</span>&nbsp;<span class="comment" id="8505537">//&nbsp;not&nbsp;match&nbsp;as&nbsp;prefix&nbsp;as&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8505572">{</span><span class="string" id="8505573">&#34;barbarbaz.net&#34;</span><span class="op" id="8505588">,</span>&nbsp;<span class="builtintype" id="8505590">true</span><span class="op" id="8505594">}</span><span class="op" id="8505595">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="8505599">//&nbsp;not&nbsp;match&nbsp;because&nbsp;NO_PROXY&nbsp;have&nbsp;a&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8505641">{</span><span class="string" id="8505642">&#34;www.foobar.com&#34;</span><span class="op" id="8505658">,</span>&nbsp;<span class="builtintype" id="8505660">false</span><span class="op" id="8505665">}</span><span class="op" id="8505666">,</span>&nbsp;<span class="comment" id="8505668">//&nbsp;match&nbsp;because&nbsp;NO_PROXY&nbsp;includes&nbsp;&#34;foobar.com&#34;</span><br>
<span class="lineno">35</span><span class="op" id="8505716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8505719">func</span>&nbsp;<span class="ident" id="8505724">TestUseProxy</span><span class="op" id="8505736">(</span><span class="ident" id="8505737">t</span>&nbsp;<span class="op" id="8505739">*</span><span class="ident" id="8505740">testing</span><span class="op" id="8505747">.</span><span class="ident" id="8505748">T</span><span class="op" id="8505749">)</span>&nbsp;<span class="op" id="8505751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8505754">ResetProxyEnv</span><span class="op" id="8505767">(</span><span class="op" id="8505768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8505771">os</span><span class="op" id="8505773">.</span><span class="ident" id="8505774">Setenv</span><span class="op" id="8505780">(</span><span class="string" id="8505781">&#34;NO_PROXY&#34;</span><span class="op" id="8505791">,</span>&nbsp;<span class="string" id="8505793">&#34;foobar.com,&nbsp;.barbaz.net&#34;</span><span class="op" id="8505818">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8505821">for</span>&nbsp;<span class="ident" id="8505825">_</span><span class="op" id="8505826">,</span>&nbsp;<span class="ident" id="8505828">test</span>&nbsp;<span class="op" id="8505833">:=</span>&nbsp;<span class="keyword" id="8505836">range</span>&nbsp;<span class="ident" id="8505842">UseProxyTests</span>&nbsp;<span class="op" id="8505856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8505860">if</span>&nbsp;<span class="ident" id="8505863">useProxy</span><span class="op" id="8505871">(</span><span class="ident" id="8505872">test</span><span class="op" id="8505876">.</span><span class="ident" id="8505877">host</span><span class="op" id="8505881">+</span><span class="string" id="8505882">&#34;:80&#34;</span><span class="op" id="8505887">)</span>&nbsp;<span class="op" id="8505889">!=</span>&nbsp;<span class="ident" id="8505892">test</span><span class="op" id="8505896">.</span><span class="ident" id="8505897">match</span>&nbsp;<span class="op" id="8505903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8505908">t</span><span class="op" id="8505909">.</span><span class="ident" id="8505910">Errorf</span><span class="op" id="8505916">(</span><span class="string" id="8505917">&#34;useProxy(%v)&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8505945">,</span>&nbsp;<span class="ident" id="8505947">test</span><span class="op" id="8505951">.</span><span class="ident" id="8505952">host</span><span class="op" id="8505956">,</span>&nbsp;<span class="op" id="8505958">!</span><span class="ident" id="8505959">test</span><span class="op" id="8505963">.</span><span class="ident" id="8505964">match</span><span class="op" id="8505969">,</span>&nbsp;<span class="ident" id="8505971">test</span><span class="op" id="8505975">.</span><span class="ident" id="8505976">match</span><span class="op" id="8505981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8505985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8505988">}</span><br>
<span class="lineno">45</span><span class="op" id="8505990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8505993">var</span>&nbsp;<span class="ident" id="8505997">cacheKeysTests</span>&nbsp;<span class="op" id="8506012">=</span>&nbsp;<span class="op" id="8506014">[</span><span class="op" id="8506015">]</span><span class="keyword" id="8506016">struct</span>&nbsp;<span class="op" id="8506023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8506026">proxy</span>&nbsp;&nbsp;<span class="builtintype" id="8506033">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8506041">scheme</span>&nbsp;<span class="builtintype" id="8506048">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8506056">addr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8506063">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8506071">key</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8506078">string</span><br>
<span class="lineno"></span><span class="op" id="8506085">}</span><span class="op" id="8506086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8506089">{</span><span class="string" id="8506090">&#34;&#34;</span><span class="op" id="8506092">,</span>&nbsp;<span class="string" id="8506094">&#34;http&#34;</span><span class="op" id="8506100">,</span>&nbsp;<span class="string" id="8506102">&#34;foo.com&#34;</span><span class="op" id="8506111">,</span>&nbsp;<span class="string" id="8506113">&#34;|http|foo.com&#34;</span><span class="op" id="8506128">}</span><span class="op" id="8506129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8506132">{</span><span class="string" id="8506133">&#34;&#34;</span><span class="op" id="8506135">,</span>&nbsp;<span class="string" id="8506137">&#34;https&#34;</span><span class="op" id="8506144">,</span>&nbsp;<span class="string" id="8506146">&#34;foo.com&#34;</span><span class="op" id="8506155">,</span>&nbsp;<span class="string" id="8506157">&#34;|https|foo.com&#34;</span><span class="op" id="8506173">}</span><span class="op" id="8506174">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8506177">{</span><span class="string" id="8506178">&#34;http://foo.com&#34;</span><span class="op" id="8506194">,</span>&nbsp;<span class="string" id="8506196">&#34;http&#34;</span><span class="op" id="8506202">,</span>&nbsp;<span class="string" id="8506204">&#34;foo.com&#34;</span><span class="op" id="8506213">,</span>&nbsp;<span class="string" id="8506215">&#34;http://foo.com|http|&#34;</span><span class="op" id="8506237">}</span><span class="op" id="8506238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8506241">{</span><span class="string" id="8506242">&#34;http://foo.com&#34;</span><span class="op" id="8506258">,</span>&nbsp;<span class="string" id="8506260">&#34;https&#34;</span><span class="op" id="8506267">,</span>&nbsp;<span class="string" id="8506269">&#34;foo.com&#34;</span><span class="op" id="8506278">,</span>&nbsp;<span class="string" id="8506280">&#34;http://foo.com|https|foo.com&#34;</span><span class="op" id="8506310">}</span><span class="op" id="8506311">,</span><br>
<span class="lineno"></span><span class="op" id="8506313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8506316">func</span>&nbsp;<span class="ident" id="8506321">TestCacheKeys</span><span class="op" id="8506334">(</span><span class="ident" id="8506335">t</span>&nbsp;<span class="op" id="8506337">*</span><span class="ident" id="8506338">testing</span><span class="op" id="8506345">.</span><span class="ident" id="8506346">T</span><span class="op" id="8506347">)</span>&nbsp;<span class="op" id="8506349">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8506352">for</span>&nbsp;<span class="ident" id="8506356">_</span><span class="op" id="8506357">,</span>&nbsp;<span class="ident" id="8506359">tt</span>&nbsp;<span class="op" id="8506362">:=</span>&nbsp;<span class="keyword" id="8506365">range</span>&nbsp;<span class="ident" id="8506371">cacheKeysTests</span>&nbsp;<span class="op" id="8506386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8506390">var</span>&nbsp;<span class="ident" id="8506394">proxy</span>&nbsp;<span class="op" id="8506400">*</span><span class="ident" id="8506401">url</span><span class="op" id="8506404">.</span><span class="ident" id="8506405">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8506411">if</span>&nbsp;<span class="ident" id="8506414">tt</span><span class="op" id="8506416">.</span><span class="ident" id="8506417">proxy</span>&nbsp;<span class="op" id="8506423">!=</span>&nbsp;<span class="string" id="8506426">&#34;&#34;</span>&nbsp;<span class="op" id="8506429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8506434">u</span><span class="op" id="8506435">,</span>&nbsp;<span class="ident" id="8506437">err</span>&nbsp;<span class="op" id="8506441">:=</span>&nbsp;<span class="ident" id="8506444">url</span><span class="op" id="8506447">.</span><span class="ident" id="8506448">Parse</span><span class="op" id="8506453">(</span><span class="ident" id="8506454">tt</span><span class="op" id="8506456">.</span><span class="ident" id="8506457">proxy</span><span class="op" id="8506462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8506467">if</span>&nbsp;<span class="ident" id="8506470">err</span>&nbsp;<span class="op" id="8506474">!=</span>&nbsp;<span class="ident" id="8506477">nil</span>&nbsp;<span class="op" id="8506481">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8506487">t</span><span class="op" id="8506488">.</span><span class="ident" id="8506489">Fatal</span><span class="op" id="8506494">(</span><span class="ident" id="8506495">err</span><span class="op" id="8506498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8506503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8506508">proxy</span>&nbsp;<span class="op" id="8506514">=</span>&nbsp;<span class="ident" id="8506516">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8506520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8506524">cm</span>&nbsp;<span class="op" id="8506527">:=</span>&nbsp;<span class="ident" id="8506530">connectMethod</span><span class="op" id="8506543">{</span><span class="ident" id="8506544">proxy</span><span class="op" id="8506549">,</span>&nbsp;<span class="ident" id="8506551">tt</span><span class="op" id="8506553">.</span><span class="ident" id="8506554">scheme</span><span class="op" id="8506560">,</span>&nbsp;<span class="ident" id="8506562">tt</span><span class="op" id="8506564">.</span><span class="ident" id="8506565">addr</span><span class="op" id="8506569">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8506573">if</span>&nbsp;<span class="ident" id="8506576">got</span>&nbsp;<span class="op" id="8506580">:=</span>&nbsp;<span class="ident" id="8506583">cm</span><span class="op" id="8506585">.</span><span class="ident" id="8506586">key</span><span class="op" id="8506589">(</span><span class="op" id="8506590">)</span><span class="op" id="8506591">.</span><span class="ident" id="8506592">String</span><span class="op" id="8506598">(</span><span class="op" id="8506599">)</span><span class="op" id="8506600">;</span>&nbsp;<span class="ident" id="8506602">got</span>&nbsp;<span class="op" id="8506606">!=</span>&nbsp;<span class="ident" id="8506609">tt</span><span class="op" id="8506611">.</span><span class="ident" id="8506612">key</span>&nbsp;<span class="op" id="8506616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8506621">t</span><span class="op" id="8506622">.</span><span class="ident" id="8506623">Fatalf</span><span class="op" id="8506629">(</span><span class="string" id="8506630">&#34;{%q,&nbsp;%q,&nbsp;%q}&nbsp;cache&nbsp;key&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8506668">,</span>&nbsp;<span class="ident" id="8506670">tt</span><span class="op" id="8506672">.</span><span class="ident" id="8506673">proxy</span><span class="op" id="8506678">,</span>&nbsp;<span class="ident" id="8506680">tt</span><span class="op" id="8506682">.</span><span class="ident" id="8506683">scheme</span><span class="op" id="8506689">,</span>&nbsp;<span class="ident" id="8506691">tt</span><span class="op" id="8506693">.</span><span class="ident" id="8506694">addr</span><span class="op" id="8506698">,</span>&nbsp;<span class="ident" id="8506700">got</span><span class="op" id="8506703">,</span>&nbsp;<span class="ident" id="8506705">tt</span><span class="op" id="8506707">.</span><span class="ident" id="8506708">key</span><span class="op" id="8506711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8506715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8506718">}</span><br>
<span class="lineno"></span><span class="op" id="8506720">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="8506723">func</span>&nbsp;<span class="ident" id="8506728">ResetProxyEnv</span><span class="op" id="8506741">(</span><span class="op" id="8506742">)</span>&nbsp;<span class="op" id="8506744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8506747">for</span>&nbsp;<span class="ident" id="8506751">_</span><span class="op" id="8506752">,</span>&nbsp;<span class="ident" id="8506754">v</span>&nbsp;<span class="op" id="8506756">:=</span>&nbsp;<span class="keyword" id="8506759">range</span>&nbsp;<span class="op" id="8506765">[</span><span class="op" id="8506766">]</span><span class="builtintype" id="8506767">string</span><span class="op" id="8506773">{</span><span class="string" id="8506774">&#34;HTTP_PROXY&#34;</span><span class="op" id="8506786">,</span>&nbsp;<span class="string" id="8506788">&#34;http_proxy&#34;</span><span class="op" id="8506800">,</span>&nbsp;<span class="string" id="8506802">&#34;NO_PROXY&#34;</span><span class="op" id="8506812">,</span>&nbsp;<span class="string" id="8506814">&#34;no_proxy&#34;</span><span class="op" id="8506824">}</span>&nbsp;<span class="op" id="8506826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8506830">os</span><span class="op" id="8506832">.</span><span class="ident" id="8506833">Setenv</span><span class="op" id="8506839">(</span><span class="ident" id="8506840">v</span><span class="op" id="8506841">,</span>&nbsp;<span class="string" id="8506843">&#34;&#34;</span><span class="op" id="8506845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8506848">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8506851">ResetCachedEnvironment</span><span class="op" id="8506873">(</span><span class="op" id="8506874">)</span><br>
<span class="lineno"></span><span class="op" id="8506876">}</span>
</div>
</body>
</html>
