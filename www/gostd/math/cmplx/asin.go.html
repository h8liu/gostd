<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html" class="current">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5218775">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5218830">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5218884">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5218935">package</span>&nbsp;<span class="ident" id="5218943">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5218950">import</span>&nbsp;<span class="string" id="5218957">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5218965">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="5219025">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="5219095">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="5219153">//</span><br>
<span class="lineno"></span><span class="comment" id="5219156">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="5219204">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="5219268">//</span><br>
<span class="lineno"></span><span class="comment" id="5219271">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="5219332">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5219402">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="5219477">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5219544">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="5219617">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5219689">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="5219703">//</span><br>
<span class="lineno"></span><span class="comment" id="5219706">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="5219772">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="5219838">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="5219851">//</span><br>
<span class="lineno"></span><span class="comment" id="5219854">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="5219878">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5219908">//&nbsp;Complex&nbsp;circular&nbsp;arc&nbsp;sine</span><br>
<span class="lineno"></span><span class="comment" id="5219937">//</span><br>
<span class="lineno"></span><span class="comment" id="5219940">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5219956">//</span><br>
<span class="lineno">35</span><span class="comment" id="5219959">//&nbsp;Inverse&nbsp;complex&nbsp;sine:</span><br>
<span class="lineno"></span><span class="comment" id="5219984">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="5220019">//&nbsp;w&nbsp;=&nbsp;-i&nbsp;clog(&nbsp;iz&nbsp;+&nbsp;csqrt(&nbsp;1&nbsp;-&nbsp;z&nbsp;)&nbsp;).</span><br>
<span class="lineno"></span><span class="comment" id="5220058">//</span><br>
<span class="lineno"></span><span class="comment" id="5220061">//&nbsp;casin(z)&nbsp;=&nbsp;-i&nbsp;casinh(iz)</span><br>
<span class="lineno">40</span><span class="comment" id="5220089">//</span><br>
<span class="lineno"></span><span class="comment" id="5220092">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5220105">//</span><br>
<span class="lineno"></span><span class="comment" id="5220108">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5220148">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">45</span><span class="comment" id="5220206">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.4e-16</span><br>
<span class="lineno"></span><span class="comment" id="5220266">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.7e-15</span><br>
<span class="lineno"></span><span class="comment" id="5220326">//&nbsp;Larger&nbsp;relative&nbsp;error&nbsp;can&nbsp;be&nbsp;observed&nbsp;for&nbsp;z&nbsp;near&nbsp;zero.</span><br>
<span class="lineno"></span><span class="comment" id="5220384">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;csin(casin(z))&nbsp;=&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="5220423">//&nbsp;Asin&nbsp;returns&nbsp;the&nbsp;inverse&nbsp;sine&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5220462">func</span>&nbsp;<span class="ident" id="5220467">Asin</span><span class="op" id="5220471">(</span><span class="ident" id="5220472">x</span>&nbsp;<span class="builtintype" id="5220474">complex128</span><span class="op" id="5220484">)</span>&nbsp;<span class="builtintype" id="5220486">complex128</span>&nbsp;<span class="op" id="5220497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220500">if</span>&nbsp;<span class="builtinfunc" id="5220503">imag</span><span class="op" id="5220507">(</span><span class="ident" id="5220508">x</span><span class="op" id="5220509">)</span>&nbsp;<span class="op" id="5220511">==</span>&nbsp;<span class="num" id="5220514">0</span>&nbsp;<span class="op" id="5220516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220520">if</span>&nbsp;<span class="ident" id="5220523">math</span><span class="op" id="5220527">.</span><span class="ident" id="5220528">Abs</span><span class="op" id="5220531">(</span><span class="builtinfunc" id="5220532">real</span><span class="op" id="5220536">(</span><span class="ident" id="5220537">x</span><span class="op" id="5220538">)</span><span class="op" id="5220539">)</span>&nbsp;<span class="op" id="5220541">&gt;</span>&nbsp;<span class="num" id="5220543">1</span>&nbsp;<span class="op" id="5220545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220550">return</span>&nbsp;<span class="builtinfunc" id="5220557">complex</span><span class="op" id="5220564">(</span><span class="ident" id="5220565">math</span><span class="op" id="5220569">.</span><span class="ident" id="5220570">Pi</span><span class="op" id="5220572">/</span><span class="num" id="5220573">2</span><span class="op" id="5220574">,</span>&nbsp;<span class="num" id="5220576">0</span><span class="op" id="5220577">)</span>&nbsp;<span class="comment" id="5220579">//&nbsp;DOMAIN&nbsp;error</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5220597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220601">return</span>&nbsp;<span class="builtinfunc" id="5220608">complex</span><span class="op" id="5220615">(</span><span class="ident" id="5220616">math</span><span class="op" id="5220620">.</span><span class="ident" id="5220621">Asin</span><span class="op" id="5220625">(</span><span class="builtinfunc" id="5220626">real</span><span class="op" id="5220630">(</span><span class="ident" id="5220631">x</span><span class="op" id="5220632">)</span><span class="op" id="5220633">)</span><span class="op" id="5220634">,</span>&nbsp;<span class="num" id="5220636">0</span><span class="op" id="5220637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5220640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220643">ct</span>&nbsp;<span class="op" id="5220646">:=</span>&nbsp;<span class="builtinfunc" id="5220649">complex</span><span class="op" id="5220656">(</span><span class="op" id="5220657">-</span><span class="builtinfunc" id="5220658">imag</span><span class="op" id="5220662">(</span><span class="ident" id="5220663">x</span><span class="op" id="5220664">)</span><span class="op" id="5220665">,</span>&nbsp;<span class="builtinfunc" id="5220667">real</span><span class="op" id="5220671">(</span><span class="ident" id="5220672">x</span><span class="op" id="5220673">)</span><span class="op" id="5220674">)</span>&nbsp;<span class="comment" id="5220676">//&nbsp;i&nbsp;*&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220686">xx</span>&nbsp;<span class="op" id="5220689">:=</span>&nbsp;<span class="ident" id="5220692">x</span>&nbsp;<span class="op" id="5220694">*</span>&nbsp;<span class="ident" id="5220696">x</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220699">x1</span>&nbsp;<span class="op" id="5220702">:=</span>&nbsp;<span class="builtinfunc" id="5220705">complex</span><span class="op" id="5220712">(</span><span class="num" id="5220713">1</span><span class="op" id="5220714">-</span><span class="builtinfunc" id="5220715">real</span><span class="op" id="5220719">(</span><span class="ident" id="5220720">xx</span><span class="op" id="5220722">)</span><span class="op" id="5220723">,</span>&nbsp;<span class="op" id="5220725">-</span><span class="builtinfunc" id="5220726">imag</span><span class="op" id="5220730">(</span><span class="ident" id="5220731">xx</span><span class="op" id="5220733">)</span><span class="op" id="5220734">)</span>&nbsp;<span class="comment" id="5220736">//&nbsp;1&nbsp;-&nbsp;x*x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220748">x2</span>&nbsp;<span class="op" id="5220751">:=</span>&nbsp;<span class="ident" id="5220754">Sqrt</span><span class="op" id="5220758">(</span><span class="ident" id="5220759">x1</span><span class="op" id="5220761">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5220785">//&nbsp;x2&nbsp;=&nbsp;sqrt(1&nbsp;-&nbsp;x*x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220808">w</span>&nbsp;<span class="op" id="5220810">:=</span>&nbsp;<span class="ident" id="5220813">Log</span><span class="op" id="5220816">(</span><span class="ident" id="5220817">ct</span>&nbsp;<span class="op" id="5220820">+</span>&nbsp;<span class="ident" id="5220822">x2</span><span class="op" id="5220824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220827">return</span>&nbsp;<span class="builtinfunc" id="5220834">complex</span><span class="op" id="5220841">(</span><span class="builtinfunc" id="5220842">imag</span><span class="op" id="5220846">(</span><span class="ident" id="5220847">w</span><span class="op" id="5220848">)</span><span class="op" id="5220849">,</span>&nbsp;<span class="op" id="5220851">-</span><span class="builtinfunc" id="5220852">real</span><span class="op" id="5220856">(</span><span class="ident" id="5220857">w</span><span class="op" id="5220858">)</span><span class="op" id="5220859">)</span>&nbsp;<span class="comment" id="5220861">//&nbsp;-i&nbsp;*&nbsp;w</span><br>
<span class="lineno"></span><span class="op" id="5220871">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="5220874">//&nbsp;Asinh&nbsp;returns&nbsp;the&nbsp;inverse&nbsp;hyperbolic&nbsp;sine&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5220925">func</span>&nbsp;<span class="ident" id="5220930">Asinh</span><span class="op" id="5220935">(</span><span class="ident" id="5220936">x</span>&nbsp;<span class="builtintype" id="5220938">complex128</span><span class="op" id="5220948">)</span>&nbsp;<span class="builtintype" id="5220950">complex128</span>&nbsp;<span class="op" id="5220961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5220964">//&nbsp;TODO&nbsp;check&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220985">if</span>&nbsp;<span class="builtinfunc" id="5220988">imag</span><span class="op" id="5220992">(</span><span class="ident" id="5220993">x</span><span class="op" id="5220994">)</span>&nbsp;<span class="op" id="5220996">==</span>&nbsp;<span class="num" id="5220999">0</span>&nbsp;<span class="op" id="5221001">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221005">if</span>&nbsp;<span class="ident" id="5221008">math</span><span class="op" id="5221012">.</span><span class="ident" id="5221013">Abs</span><span class="op" id="5221016">(</span><span class="builtinfunc" id="5221017">real</span><span class="op" id="5221021">(</span><span class="ident" id="5221022">x</span><span class="op" id="5221023">)</span><span class="op" id="5221024">)</span>&nbsp;<span class="op" id="5221026">&gt;</span>&nbsp;<span class="num" id="5221028">1</span>&nbsp;<span class="op" id="5221030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221035">return</span>&nbsp;<span class="builtinfunc" id="5221042">complex</span><span class="op" id="5221049">(</span><span class="ident" id="5221050">math</span><span class="op" id="5221054">.</span><span class="ident" id="5221055">Pi</span><span class="op" id="5221057">/</span><span class="num" id="5221058">2</span><span class="op" id="5221059">,</span>&nbsp;<span class="num" id="5221061">0</span><span class="op" id="5221062">)</span>&nbsp;<span class="comment" id="5221064">//&nbsp;DOMAIN&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5221082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221086">return</span>&nbsp;<span class="builtinfunc" id="5221093">complex</span><span class="op" id="5221100">(</span><span class="ident" id="5221101">math</span><span class="op" id="5221105">.</span><span class="ident" id="5221106">Asinh</span><span class="op" id="5221111">(</span><span class="builtinfunc" id="5221112">real</span><span class="op" id="5221116">(</span><span class="ident" id="5221117">x</span><span class="op" id="5221118">)</span><span class="op" id="5221119">)</span><span class="op" id="5221120">,</span>&nbsp;<span class="num" id="5221122">0</span><span class="op" id="5221123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5221126">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5221129">xx</span>&nbsp;<span class="op" id="5221132">:=</span>&nbsp;<span class="ident" id="5221135">x</span>&nbsp;<span class="op" id="5221137">*</span>&nbsp;<span class="ident" id="5221139">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5221142">x1</span>&nbsp;<span class="op" id="5221145">:=</span>&nbsp;<span class="builtinfunc" id="5221148">complex</span><span class="op" id="5221155">(</span><span class="num" id="5221156">1</span><span class="op" id="5221157">+</span><span class="builtinfunc" id="5221158">real</span><span class="op" id="5221162">(</span><span class="ident" id="5221163">xx</span><span class="op" id="5221165">)</span><span class="op" id="5221166">,</span>&nbsp;<span class="builtinfunc" id="5221168">imag</span><span class="op" id="5221172">(</span><span class="ident" id="5221173">xx</span><span class="op" id="5221175">)</span><span class="op" id="5221176">)</span>&nbsp;<span class="comment" id="5221178">//&nbsp;1&nbsp;+&nbsp;x*x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221190">return</span>&nbsp;<span class="ident" id="5221197">Log</span><span class="op" id="5221200">(</span><span class="ident" id="5221201">x</span>&nbsp;<span class="op" id="5221203">+</span>&nbsp;<span class="ident" id="5221205">Sqrt</span><span class="op" id="5221209">(</span><span class="ident" id="5221210">x1</span><span class="op" id="5221212">)</span><span class="op" id="5221213">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5221226">//&nbsp;log(x&nbsp;+&nbsp;sqrt(1&nbsp;+&nbsp;x*x))</span><br>
<span class="lineno"></span><span class="op" id="5221252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="5221255">//&nbsp;Complex&nbsp;circular&nbsp;arc&nbsp;cosine</span><br>
<span class="lineno"></span><span class="comment" id="5221286">//</span><br>
<span class="lineno"></span><span class="comment" id="5221289">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5221305">//</span><br>
<span class="lineno"></span><span class="comment" id="5221308">//&nbsp;w&nbsp;=&nbsp;arccos&nbsp;z&nbsp;&nbsp;=&nbsp;&nbsp;PI/2&nbsp;-&nbsp;arcsin&nbsp;z.</span><br>
<span class="lineno">85</span><span class="comment" id="5221345">//</span><br>
<span class="lineno"></span><span class="comment" id="5221348">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5221361">//</span><br>
<span class="lineno"></span><span class="comment" id="5221364">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5221404">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">90</span><span class="comment" id="5221462">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.8e-16</span><br>
<span class="lineno"></span><span class="comment" id="5221522">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.8e-14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-15</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5221583">//&nbsp;Acos&nbsp;returns&nbsp;the&nbsp;inverse&nbsp;cosine&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5221624">func</span>&nbsp;<span class="ident" id="5221629">Acos</span><span class="op" id="5221633">(</span><span class="ident" id="5221634">x</span>&nbsp;<span class="builtintype" id="5221636">complex128</span><span class="op" id="5221646">)</span>&nbsp;<span class="builtintype" id="5221648">complex128</span>&nbsp;<span class="op" id="5221659">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5221662">w</span>&nbsp;<span class="op" id="5221664">:=</span>&nbsp;<span class="ident" id="5221667">Asin</span><span class="op" id="5221671">(</span><span class="ident" id="5221672">x</span><span class="op" id="5221673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221676">return</span>&nbsp;<span class="builtinfunc" id="5221683">complex</span><span class="op" id="5221690">(</span><span class="ident" id="5221691">math</span><span class="op" id="5221695">.</span><span class="ident" id="5221696">Pi</span><span class="op" id="5221698">/</span><span class="num" id="5221699">2</span><span class="op" id="5221700">-</span><span class="builtinfunc" id="5221701">real</span><span class="op" id="5221705">(</span><span class="ident" id="5221706">w</span><span class="op" id="5221707">)</span><span class="op" id="5221708">,</span>&nbsp;<span class="op" id="5221710">-</span><span class="builtinfunc" id="5221711">imag</span><span class="op" id="5221715">(</span><span class="ident" id="5221716">w</span><span class="op" id="5221717">)</span><span class="op" id="5221718">)</span><br>
<span class="lineno"></span><span class="op" id="5221720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5221723">//&nbsp;Acosh&nbsp;returns&nbsp;the&nbsp;inverse&nbsp;hyperbolic&nbsp;cosine&nbsp;of&nbsp;x.</span><br>
<span class="lineno">100</span><span class="keyword" id="5221776">func</span>&nbsp;<span class="ident" id="5221781">Acosh</span><span class="op" id="5221786">(</span><span class="ident" id="5221787">x</span>&nbsp;<span class="builtintype" id="5221789">complex128</span><span class="op" id="5221799">)</span>&nbsp;<span class="builtintype" id="5221801">complex128</span>&nbsp;<span class="op" id="5221812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5221815">w</span>&nbsp;<span class="op" id="5221817">:=</span>&nbsp;<span class="ident" id="5221820">Acos</span><span class="op" id="5221824">(</span><span class="ident" id="5221825">x</span><span class="op" id="5221826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221829">if</span>&nbsp;<span class="builtinfunc" id="5221832">imag</span><span class="op" id="5221836">(</span><span class="ident" id="5221837">w</span><span class="op" id="5221838">)</span>&nbsp;<span class="op" id="5221840">&lt;=</span>&nbsp;<span class="num" id="5221843">0</span>&nbsp;<span class="op" id="5221845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221849">return</span>&nbsp;<span class="builtinfunc" id="5221856">complex</span><span class="op" id="5221863">(</span><span class="op" id="5221864">-</span><span class="builtinfunc" id="5221865">imag</span><span class="op" id="5221869">(</span><span class="ident" id="5221870">w</span><span class="op" id="5221871">)</span><span class="op" id="5221872">,</span>&nbsp;<span class="builtinfunc" id="5221874">real</span><span class="op" id="5221878">(</span><span class="ident" id="5221879">w</span><span class="op" id="5221880">)</span><span class="op" id="5221881">)</span>&nbsp;<span class="comment" id="5221883">//&nbsp;i&nbsp;*&nbsp;w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5221893">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221896">return</span>&nbsp;<span class="builtinfunc" id="5221903">complex</span><span class="op" id="5221910">(</span><span class="builtinfunc" id="5221911">imag</span><span class="op" id="5221915">(</span><span class="ident" id="5221916">w</span><span class="op" id="5221917">)</span><span class="op" id="5221918">,</span>&nbsp;<span class="op" id="5221920">-</span><span class="builtinfunc" id="5221921">real</span><span class="op" id="5221925">(</span><span class="ident" id="5221926">w</span><span class="op" id="5221927">)</span><span class="op" id="5221928">)</span>&nbsp;<span class="comment" id="5221930">//&nbsp;-i&nbsp;*&nbsp;w</span><br>
<span class="lineno"></span><span class="op" id="5221940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5221943">//&nbsp;Complex&nbsp;circular&nbsp;arc&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="5221975">//</span><br>
<span class="lineno">110</span><span class="comment" id="5221978">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5221994">//</span><br>
<span class="lineno"></span><span class="comment" id="5221997">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="5222003">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno"></span><span class="comment" id="5222022">//</span><br>
<span class="lineno">115</span><span class="comment" id="5222025">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5222033">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;&nbsp;&nbsp;&nbsp;2x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="5222067">//&nbsp;Re&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;-&nbsp;arctan(-----------)&nbsp;&nbsp;+&nbsp;&nbsp;k&nbsp;PI</span><br>
<span class="lineno"></span><span class="comment" id="5222110">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;2)</span><br>
<span class="lineno"></span><span class="comment" id="5222144">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1&nbsp;-&nbsp;x&nbsp;&nbsp;-&nbsp;y&nbsp;)</span><br>
<span class="lineno">120</span><span class="comment" id="5222178">//</span><br>
<span class="lineno"></span><span class="comment" id="5222181">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2)</span><br>
<span class="lineno"></span><span class="comment" id="5222213">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;(x&nbsp;&nbsp;+&nbsp;&nbsp;(y+1)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="5222245">//&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;-&nbsp;log(------------)</span><br>
<span class="lineno"></span><span class="comment" id="5222277">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2)</span><br>
<span class="lineno">125</span><span class="comment" id="5222309">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(x&nbsp;&nbsp;+&nbsp;&nbsp;(y-1)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="5222341">//</span><br>
<span class="lineno"></span><span class="comment" id="5222344">//&nbsp;Where&nbsp;k&nbsp;is&nbsp;an&nbsp;arbitrary&nbsp;integer.</span><br>
<span class="lineno"></span><span class="comment" id="5222380">//</span><br>
<span class="lineno"></span><span class="comment" id="5222383">//&nbsp;catan(z)&nbsp;=&nbsp;-i&nbsp;catanh(iz).</span><br>
<span class="lineno">130</span><span class="comment" id="5222412">//</span><br>
<span class="lineno"></span><span class="comment" id="5222415">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5222428">//</span><br>
<span class="lineno"></span><span class="comment" id="5222431">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5222471">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">135</span><span class="comment" id="5222529">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5900&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.3e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8e-18</span><br>
<span class="lineno"></span><span class="comment" id="5222589">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8.5e-17</span><br>
<span class="lineno"></span><span class="comment" id="5222649">//&nbsp;The&nbsp;check&nbsp;catan(&nbsp;ctan(z)&nbsp;)&nbsp;&nbsp;=&nbsp;&nbsp;z,&nbsp;with&nbsp;|x|&nbsp;and&nbsp;|y|&nbsp;&lt;&nbsp;PI/2,</span><br>
<span class="lineno"></span><span class="comment" id="5222711">//&nbsp;had&nbsp;peak&nbsp;relative&nbsp;error&nbsp;1.5e-16,&nbsp;rms&nbsp;relative&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="5222766">//&nbsp;2.9e-17.&nbsp;&nbsp;See&nbsp;also&nbsp;clog().</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="5222797">//&nbsp;Atan&nbsp;returns&nbsp;the&nbsp;inverse&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5222839">func</span>&nbsp;<span class="ident" id="5222844">Atan</span><span class="op" id="5222848">(</span><span class="ident" id="5222849">x</span>&nbsp;<span class="builtintype" id="5222851">complex128</span><span class="op" id="5222861">)</span>&nbsp;<span class="builtintype" id="5222863">complex128</span>&nbsp;<span class="op" id="5222874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222877">if</span>&nbsp;<span class="builtinfunc" id="5222880">real</span><span class="op" id="5222884">(</span><span class="ident" id="5222885">x</span><span class="op" id="5222886">)</span>&nbsp;<span class="op" id="5222888">==</span>&nbsp;<span class="num" id="5222891">0</span>&nbsp;<span class="op" id="5222893">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5222896">imag</span><span class="op" id="5222900">(</span><span class="ident" id="5222901">x</span><span class="op" id="5222902">)</span>&nbsp;<span class="op" id="5222904">&gt;</span>&nbsp;<span class="num" id="5222906">1</span>&nbsp;<span class="op" id="5222908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222912">return</span>&nbsp;<span class="ident" id="5222919">NaN</span><span class="op" id="5222922">(</span><span class="op" id="5222923">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5222926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5222930">x2</span>&nbsp;<span class="op" id="5222933">:=</span>&nbsp;<span class="builtinfunc" id="5222936">real</span><span class="op" id="5222940">(</span><span class="ident" id="5222941">x</span><span class="op" id="5222942">)</span>&nbsp;<span class="op" id="5222944">*</span>&nbsp;<span class="builtinfunc" id="5222946">real</span><span class="op" id="5222950">(</span><span class="ident" id="5222951">x</span><span class="op" id="5222952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5222955">a</span>&nbsp;<span class="op" id="5222957">:=</span>&nbsp;<span class="num" id="5222960">1</span>&nbsp;<span class="op" id="5222962">-</span>&nbsp;<span class="ident" id="5222964">x2</span>&nbsp;<span class="op" id="5222967">-</span>&nbsp;<span class="builtinfunc" id="5222969">imag</span><span class="op" id="5222973">(</span><span class="ident" id="5222974">x</span><span class="op" id="5222975">)</span><span class="op" id="5222976">*</span><span class="builtinfunc" id="5222977">imag</span><span class="op" id="5222981">(</span><span class="ident" id="5222982">x</span><span class="op" id="5222983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222986">if</span>&nbsp;<span class="ident" id="5222989">a</span>&nbsp;<span class="op" id="5222991">==</span>&nbsp;<span class="num" id="5222994">0</span>&nbsp;<span class="op" id="5222996">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223000">return</span>&nbsp;<span class="ident" id="5223007">NaN</span><span class="op" id="5223010">(</span><span class="op" id="5223011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5223014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5223017">t</span>&nbsp;<span class="op" id="5223019">:=</span>&nbsp;<span class="num" id="5223022">0.5</span>&nbsp;<span class="op" id="5223026">*</span>&nbsp;<span class="ident" id="5223028">math</span><span class="op" id="5223032">.</span><span class="ident" id="5223033">Atan2</span><span class="op" id="5223038">(</span><span class="num" id="5223039">2</span><span class="op" id="5223040">*</span><span class="builtinfunc" id="5223041">real</span><span class="op" id="5223045">(</span><span class="ident" id="5223046">x</span><span class="op" id="5223047">)</span><span class="op" id="5223048">,</span>&nbsp;<span class="ident" id="5223050">a</span><span class="op" id="5223051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5223054">w</span>&nbsp;<span class="op" id="5223056">:=</span>&nbsp;<span class="ident" id="5223059">reducePi</span><span class="op" id="5223067">(</span><span class="ident" id="5223068">t</span><span class="op" id="5223069">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5223073">t</span>&nbsp;<span class="op" id="5223075">=</span>&nbsp;<span class="builtinfunc" id="5223077">imag</span><span class="op" id="5223081">(</span><span class="ident" id="5223082">x</span><span class="op" id="5223083">)</span>&nbsp;<span class="op" id="5223085">-</span>&nbsp;<span class="num" id="5223087">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5223090">b</span>&nbsp;<span class="op" id="5223092">:=</span>&nbsp;<span class="ident" id="5223095">x2</span>&nbsp;<span class="op" id="5223098">+</span>&nbsp;<span class="ident" id="5223100">t</span><span class="op" id="5223101">*</span><span class="ident" id="5223102">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223105">if</span>&nbsp;<span class="ident" id="5223108">b</span>&nbsp;<span class="op" id="5223110">==</span>&nbsp;<span class="num" id="5223113">0</span>&nbsp;<span class="op" id="5223115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223119">return</span>&nbsp;<span class="ident" id="5223126">NaN</span><span class="op" id="5223129">(</span><span class="op" id="5223130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5223133">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5223136">t</span>&nbsp;<span class="op" id="5223138">=</span>&nbsp;<span class="builtinfunc" id="5223140">imag</span><span class="op" id="5223144">(</span><span class="ident" id="5223145">x</span><span class="op" id="5223146">)</span>&nbsp;<span class="op" id="5223148">+</span>&nbsp;<span class="num" id="5223150">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5223153">c</span>&nbsp;<span class="op" id="5223155">:=</span>&nbsp;<span class="op" id="5223158">(</span><span class="ident" id="5223159">x2</span>&nbsp;<span class="op" id="5223162">+</span>&nbsp;<span class="ident" id="5223164">t</span><span class="op" id="5223165">*</span><span class="ident" id="5223166">t</span><span class="op" id="5223167">)</span>&nbsp;<span class="op" id="5223169">/</span>&nbsp;<span class="ident" id="5223171">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223174">return</span>&nbsp;<span class="builtinfunc" id="5223181">complex</span><span class="op" id="5223188">(</span><span class="ident" id="5223189">w</span><span class="op" id="5223190">,</span>&nbsp;<span class="num" id="5223192">0.25</span><span class="op" id="5223196">*</span><span class="ident" id="5223197">math</span><span class="op" id="5223201">.</span><span class="ident" id="5223202">Log</span><span class="op" id="5223205">(</span><span class="ident" id="5223206">c</span><span class="op" id="5223207">)</span><span class="op" id="5223208">)</span><br>
<span class="lineno"></span><span class="op" id="5223210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="5223213">//&nbsp;Atanh&nbsp;returns&nbsp;the&nbsp;inverse&nbsp;hyperbolic&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5223267">func</span>&nbsp;<span class="ident" id="5223272">Atanh</span><span class="op" id="5223277">(</span><span class="ident" id="5223278">x</span>&nbsp;<span class="builtintype" id="5223280">complex128</span><span class="op" id="5223290">)</span>&nbsp;<span class="builtintype" id="5223292">complex128</span>&nbsp;<span class="op" id="5223303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5223306">z</span>&nbsp;<span class="op" id="5223308">:=</span>&nbsp;<span class="builtinfunc" id="5223311">complex</span><span class="op" id="5223318">(</span><span class="op" id="5223319">-</span><span class="builtinfunc" id="5223320">imag</span><span class="op" id="5223324">(</span><span class="ident" id="5223325">x</span><span class="op" id="5223326">)</span><span class="op" id="5223327">,</span>&nbsp;<span class="builtinfunc" id="5223329">real</span><span class="op" id="5223333">(</span><span class="ident" id="5223334">x</span><span class="op" id="5223335">)</span><span class="op" id="5223336">)</span>&nbsp;<span class="comment" id="5223338">//&nbsp;z&nbsp;=&nbsp;i&nbsp;*&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5223352">z</span>&nbsp;<span class="op" id="5223354">=</span>&nbsp;<span class="ident" id="5223356">Atan</span><span class="op" id="5223360">(</span><span class="ident" id="5223361">z</span><span class="op" id="5223362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223365">return</span>&nbsp;<span class="builtinfunc" id="5223372">complex</span><span class="op" id="5223379">(</span><span class="builtinfunc" id="5223380">imag</span><span class="op" id="5223384">(</span><span class="ident" id="5223385">z</span><span class="op" id="5223386">)</span><span class="op" id="5223387">,</span>&nbsp;<span class="op" id="5223389">-</span><span class="builtinfunc" id="5223390">real</span><span class="op" id="5223394">(</span><span class="ident" id="5223395">z</span><span class="op" id="5223396">)</span><span class="op" id="5223397">)</span>&nbsp;<span class="comment" id="5223399">//&nbsp;z&nbsp;=&nbsp;-i&nbsp;*&nbsp;z</span><br>
<span class="lineno">170</span><span class="op" id="5223413">}</span>
</div>
</body>
</html>
