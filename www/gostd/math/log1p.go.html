<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1910680">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1910735">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1910789">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1910840">package</span>&nbsp;<span class="ident" id="1910848">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1910854">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="1910914">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_log1p.c</span><br>
<span class="lineno"></span><span class="comment" id="1910974">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno">10</span><span class="comment" id="1911033">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="1911063">//</span><br>
<span class="lineno"></span><span class="comment" id="1911066">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1911122">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1911191">//</span><br>
<span class="lineno">15</span><span class="comment" id="1911194">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno"></span><span class="comment" id="1911253">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1911309">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1911366">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1911383">//&nbsp;====================================================</span><br>
<span class="lineno">20</span><span class="comment" id="1911439">//</span><br>
<span class="lineno"></span><span class="comment" id="1911442">//</span><br>
<span class="lineno"></span><span class="comment" id="1911445">//&nbsp;double&nbsp;log1p(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="1911471">//</span><br>
<span class="lineno"></span><span class="comment" id="1911474">//&nbsp;Method&nbsp;:</span><br>
<span class="lineno">25</span><span class="comment" id="1911486">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction:&nbsp;find&nbsp;k&nbsp;and&nbsp;f&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1911537">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+x&nbsp;=&nbsp;2**k&nbsp;*&nbsp;(1+f),</span><br>
<span class="lineno"></span><span class="comment" id="1911581">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;sqrt(2)/2&nbsp;&lt;&nbsp;1+f&nbsp;&lt;&nbsp;sqrt(2)&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="1911627">//</span><br>
<span class="lineno"></span><span class="comment" id="1911630">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note.&nbsp;If&nbsp;k=0,&nbsp;then&nbsp;f=x&nbsp;is&nbsp;exact.&nbsp;However,&nbsp;if&nbsp;k!=0,&nbsp;then&nbsp;f</span><br>
<span class="lineno">30</span><span class="comment" id="1911696">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;may&nbsp;not&nbsp;be&nbsp;representable&nbsp;exactly.&nbsp;In&nbsp;that&nbsp;case,&nbsp;a&nbsp;correction</span><br>
<span class="lineno"></span><span class="comment" id="1911765">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;term&nbsp;is&nbsp;need.&nbsp;Let&nbsp;u=1+x&nbsp;rounded.&nbsp;Let&nbsp;c&nbsp;=&nbsp;(1+x)-u,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="1911828">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(1+x)&nbsp;-&nbsp;log(u)&nbsp;~&nbsp;c/u.&nbsp;Thus,&nbsp;we&nbsp;proceed&nbsp;to&nbsp;compute&nbsp;log(u),</span><br>
<span class="lineno"></span><span class="comment" id="1911897">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;add&nbsp;back&nbsp;the&nbsp;correction&nbsp;term&nbsp;c/u.</span><br>
<span class="lineno"></span><span class="comment" id="1911943">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Note:&nbsp;when&nbsp;x&nbsp;&gt;&nbsp;2**53,&nbsp;one&nbsp;can&nbsp;simply&nbsp;return&nbsp;log(x))</span><br>
<span class="lineno">35</span><span class="comment" id="1912004">//</span><br>
<span class="lineno"></span><span class="comment" id="1912007">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;log1p(f).</span><br>
<span class="lineno"></span><span class="comment" id="1912042">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s&nbsp;=&nbsp;f/(2+f)&nbsp;;&nbsp;based&nbsp;on&nbsp;log(1+f)&nbsp;=&nbsp;log(1+s)&nbsp;-&nbsp;log(1-s)</span><br>
<span class="lineno"></span><span class="comment" id="1912108">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2s&nbsp;+&nbsp;2/3&nbsp;s**3&nbsp;+&nbsp;2/5&nbsp;s**5&nbsp;+&nbsp;.....,</span><br>
<span class="lineno"></span><span class="comment" id="1912161">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2s&nbsp;+&nbsp;s*R</span><br>
<span class="lineno">40</span><span class="comment" id="1912189">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Reme&nbsp;algorithm&nbsp;on&nbsp;[0,0.1716]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="1912255">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;14&nbsp;to&nbsp;approximate&nbsp;R&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="1912324">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-58.45.&nbsp;In</span><br>
<span class="lineno"></span><span class="comment" id="1912393">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="1912414">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14</span><br>
<span class="lineno">45</span><span class="comment" id="1912485">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;Lp1*s&nbsp;+Lp2*s&nbsp;+Lp3*s&nbsp;+Lp4*s&nbsp;+Lp5*s&nbsp;&nbsp;+Lp6*s&nbsp;&nbsp;+Lp7*s</span><br>
<span class="lineno"></span><span class="comment" id="1912554">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(the&nbsp;values&nbsp;of&nbsp;Lp1&nbsp;to&nbsp;Lp7&nbsp;are&nbsp;listed&nbsp;in&nbsp;the&nbsp;program)</span><br>
<span class="lineno"></span><span class="comment" id="1912615">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1912627">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-58.45</span><br>
<span class="lineno"></span><span class="comment" id="1912682">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Lp1*s&nbsp;+...+Lp7*s&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno">50</span><span class="comment" id="1912731">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="1912775">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;2s&nbsp;=&nbsp;f&nbsp;-&nbsp;s*f&nbsp;=&nbsp;f&nbsp;-&nbsp;hfsq&nbsp;+&nbsp;s*hfsq,&nbsp;where&nbsp;hfsq&nbsp;=&nbsp;f*f/2.</span><br>
<span class="lineno"></span><span class="comment" id="1912847">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;order&nbsp;to&nbsp;guarantee&nbsp;error&nbsp;in&nbsp;log&nbsp;below&nbsp;1ulp,&nbsp;we&nbsp;compute&nbsp;log</span><br>
<span class="lineno"></span><span class="comment" id="1912917">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1912928">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log1p(f)&nbsp;=&nbsp;f&nbsp;-&nbsp;(hfsq&nbsp;-&nbsp;s*(hfsq+R)).</span><br>
<span class="lineno">55</span><span class="comment" id="1912980">//</span><br>
<span class="lineno"></span><span class="comment" id="1912983">//&nbsp;&nbsp;&nbsp;3.&nbsp;Finally,&nbsp;log1p(x)&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;log1p(f).</span><br>
<span class="lineno"></span><span class="comment" id="1913029">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;k*ln2_hi+(f-(hfsq-(s*(hfsq+R)+k*ln2_lo)))</span><br>
<span class="lineno"></span><span class="comment" id="1913099">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;ln2&nbsp;is&nbsp;split&nbsp;into&nbsp;two&nbsp;floating&nbsp;point&nbsp;number:</span><br>
<span class="lineno"></span><span class="comment" id="1913157">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ln2_hi&nbsp;+&nbsp;ln2_lo,</span><br>
<span class="lineno">60</span><span class="comment" id="1913195">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;n*ln2_hi&nbsp;is&nbsp;always&nbsp;exact&nbsp;for&nbsp;|n|&nbsp;&lt;&nbsp;2000.</span><br>
<span class="lineno"></span><span class="comment" id="1913250">//</span><br>
<span class="lineno"></span><span class="comment" id="1913253">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="1913271">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log1p(x)&nbsp;is&nbsp;NaN&nbsp;with&nbsp;signal&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-1&nbsp;(including&nbsp;-INF)&nbsp;;</span><br>
<span class="lineno"></span><span class="comment" id="1913336">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log1p(+INF)&nbsp;is&nbsp;+INF;&nbsp;log1p(-1)&nbsp;is&nbsp;-INF&nbsp;with&nbsp;signal;</span><br>
<span class="lineno">65</span><span class="comment" id="1913396">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log1p(NaN)&nbsp;is&nbsp;that&nbsp;NaN&nbsp;with&nbsp;no&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="1913443">//</span><br>
<span class="lineno"></span><span class="comment" id="1913446">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="1913459">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="1913529">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">70</span><span class="comment" id="1913569">//</span><br>
<span class="lineno"></span><span class="comment" id="1913572">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="1913586">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="1913652">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1913716">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">75</span><span class="comment" id="1913782">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><span class="comment" id="1913826">//</span><br>
<span class="lineno"></span><span class="comment" id="1913829">//&nbsp;Note:&nbsp;Assuming&nbsp;log()&nbsp;return&nbsp;accurate&nbsp;answer,&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="1913891">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;algorithm&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;compute&nbsp;log1p(x)&nbsp;to&nbsp;within&nbsp;a&nbsp;few&nbsp;ULP:</span><br>
<span class="lineno"></span><span class="comment" id="1913963">//</span><br>
<span class="lineno">80</span><span class="comment" id="1913966">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u&nbsp;=&nbsp;1+x;</span><br>
<span class="lineno"></span><span class="comment" id="1913991">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(u==1.0)&nbsp;return&nbsp;x&nbsp;;&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="1914034">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;log(u)*(x/(u-1.0));</span><br>
<span class="lineno"></span><span class="comment" id="1914088">//</span><br>
<span class="lineno"></span><span class="comment" id="1914091">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;See&nbsp;HP-15C&nbsp;Advanced&nbsp;Functions&nbsp;Handbook,&nbsp;p.193.</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="1914148">//&nbsp;Log1p&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;of&nbsp;1&nbsp;plus&nbsp;its&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1914213">//&nbsp;It&nbsp;is&nbsp;more&nbsp;accurate&nbsp;than&nbsp;Log(1&nbsp;+&nbsp;x)&nbsp;when&nbsp;x&nbsp;is&nbsp;near&nbsp;zero.</span><br>
<span class="lineno"></span><span class="comment" id="1914273">//</span><br>
<span class="lineno"></span><span class="comment" id="1914276">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">90</span><span class="comment" id="1914298">//&nbsp;&nbsp;&nbsp;&nbspLog1p(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1914320">//&nbsp;&nbsp;&nbsp;&nbspLog1p(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="1914340">//&nbsp;&nbsp;&nbsp;&nbspLog1p(-1)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="1914360">//&nbsp;&nbsp;&nbsp;&nbspLog1p(x&nbsp;&lt;&nbsp;-1)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1914383">//&nbsp;&nbsp;&nbsp;&nbspLog1p(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">95</span><span class="keyword" id="1914403">func</span>&nbsp;<span class="ident" id="1914408">Log1p</span><span class="op" id="1914413">(</span><span class="ident" id="1914414">x</span>&nbsp;<span class="builtintype" id="1914416">float64</span><span class="op" id="1914423">)</span>&nbsp;<span class="builtintype" id="1914425">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1914434">func</span>&nbsp;<span class="ident" id="1914439">log1p</span><span class="op" id="1914444">(</span><span class="ident" id="1914445">x</span>&nbsp;<span class="builtintype" id="1914447">float64</span><span class="op" id="1914454">)</span>&nbsp;<span class="builtintype" id="1914456">float64</span>&nbsp;<span class="op" id="1914464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1914467">const</span>&nbsp;<span class="op" id="1914473">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914477">Sqrt2M1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1914489">=</span>&nbsp;<span class="num" id="1914491">4.142135623730950488017e-01</span>&nbsp;&nbsp;<span class="comment" id="1914520">//&nbsp;Sqrt(2)-1&nbsp;=&nbsp;0x3fda827999fcef34</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914556">Sqrt2HalfM1</span>&nbsp;<span class="op" id="1914568">=</span>&nbsp;<span class="op" id="1914570">-</span><span class="num" id="1914571">2.928932188134524755992e-01</span>&nbsp;<span class="comment" id="1914599">//&nbsp;Sqrt(2)/2-1&nbsp;=&nbsp;0xbfd2bec333018866</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914637">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1914649">=</span>&nbsp;<span class="num" id="1914651">1.0</span>&nbsp;<span class="op" id="1914655">/</span>&nbsp;<span class="op" id="1914657">(</span><span class="num" id="1914658">1</span>&nbsp;<span class="op" id="1914660">&lt;&lt;</span>&nbsp;<span class="num" id="1914663">29</span><span class="op" id="1914665">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1914680">//&nbsp;2**-29&nbsp;=&nbsp;0x3e20000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914713">Tiny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1914725">=</span>&nbsp;<span class="num" id="1914727">1.0</span>&nbsp;<span class="op" id="1914731">/</span>&nbsp;<span class="op" id="1914733">(</span><span class="num" id="1914734">1</span>&nbsp;<span class="op" id="1914736">&lt;&lt;</span>&nbsp;<span class="num" id="1914739">54</span><span class="op" id="1914741">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1914756">//&nbsp;2**-54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914768">Two53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1914780">=</span>&nbsp;<span class="num" id="1914782">1</span>&nbsp;<span class="op" id="1914784">&lt;&lt;</span>&nbsp;<span class="num" id="1914787">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1914811">//&nbsp;2**53</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914822">Ln2Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1914834">=</span>&nbsp;<span class="num" id="1914836">6.93147180369123816490e-01</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1914865">//&nbsp;3fe62e42fee00000</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914887">Ln2Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1914899">=</span>&nbsp;<span class="num" id="1914901">1.90821492927058770002e-10</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1914930">//&nbsp;3dea39ef35793c76</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1914952">Lp1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1914964">=</span>&nbsp;<span class="num" id="1914966">6.666666666666735130e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1914995">//&nbsp;3FE5555555555593</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1915017">Lp2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1915029">=</span>&nbsp;<span class="num" id="1915031">3.999999999940941908e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1915060">//&nbsp;3FD999999997FA04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1915082">Lp3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1915094">=</span>&nbsp;<span class="num" id="1915096">2.857142874366239149e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1915125">//&nbsp;3FD2492494229359</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1915147">Lp4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1915159">=</span>&nbsp;<span class="num" id="1915161">2.222219843214978396e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1915190">//&nbsp;3FCC71C51D8E78AF</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1915212">Lp5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1915224">=</span>&nbsp;<span class="num" id="1915226">1.818357216161805012e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1915255">//&nbsp;3FC7466496CB03DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1915277">Lp6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1915289">=</span>&nbsp;<span class="num" id="1915291">1.531383769920937332e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1915320">//&nbsp;3FC39A09D078C69F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1915342">Lp7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1915354">=</span>&nbsp;<span class="num" id="1915356">1.479819860511658591e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1915385">//&nbsp;3FC2F112DF3E5244</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1915406">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1915410">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915428">switch</span>&nbsp;<span class="op" id="1915435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915438">case</span>&nbsp;<span class="ident" id="1915443">x</span>&nbsp;<span class="op" id="1915445">&lt;</span>&nbsp;<span class="op" id="1915447">-</span><span class="num" id="1915448">1</span>&nbsp;<span class="op" id="1915450">||</span>&nbsp;<span class="ident" id="1915453">IsNaN</span><span class="op" id="1915458">(</span><span class="ident" id="1915459">x</span><span class="op" id="1915460">)</span><span class="op" id="1915461">:</span>&nbsp;<span class="comment" id="1915463">//&nbsp;includes&nbsp;-Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915482">return</span>&nbsp;<span class="ident" id="1915489">NaN</span><span class="op" id="1915492">(</span><span class="op" id="1915493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915496">case</span>&nbsp;<span class="ident" id="1915501">x</span>&nbsp;<span class="op" id="1915503">==</span>&nbsp;<span class="op" id="1915506">-</span><span class="num" id="1915507">1</span><span class="op" id="1915508">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915512">return</span>&nbsp;<span class="ident" id="1915519">Inf</span><span class="op" id="1915522">(</span><span class="op" id="1915523">-</span><span class="num" id="1915524">1</span><span class="op" id="1915525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915528">case</span>&nbsp;<span class="ident" id="1915533">IsInf</span><span class="op" id="1915538">(</span><span class="ident" id="1915539">x</span><span class="op" id="1915540">,</span>&nbsp;<span class="num" id="1915542">1</span><span class="op" id="1915543">)</span><span class="op" id="1915544">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915548">return</span>&nbsp;<span class="ident" id="1915555">Inf</span><span class="op" id="1915558">(</span><span class="num" id="1915559">1</span><span class="op" id="1915560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1915563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1915567">absx</span>&nbsp;<span class="op" id="1915572">:=</span>&nbsp;<span class="ident" id="1915575">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915578">if</span>&nbsp;<span class="ident" id="1915581">absx</span>&nbsp;<span class="op" id="1915586">&lt;</span>&nbsp;<span class="num" id="1915588">0</span>&nbsp;<span class="op" id="1915590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1915594">absx</span>&nbsp;<span class="op" id="1915599">=</span>&nbsp;<span class="op" id="1915601">-</span><span class="ident" id="1915602">absx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1915608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915612">var</span>&nbsp;<span class="ident" id="1915616">f</span>&nbsp;<span class="builtintype" id="1915618">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915627">var</span>&nbsp;<span class="ident" id="1915631">iu</span>&nbsp;<span class="ident" id="1915634">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1915642">k</span>&nbsp;<span class="op" id="1915644">:=</span>&nbsp;<span class="num" id="1915647">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915650">if</span>&nbsp;<span class="ident" id="1915653">absx</span>&nbsp;<span class="op" id="1915658">&lt;</span>&nbsp;<span class="ident" id="1915660">Sqrt2M1</span>&nbsp;<span class="op" id="1915668">{</span>&nbsp;<span class="comment" id="1915670">//&nbsp;&nbsp;|x|&nbsp;&lt;&nbsp;Sqrt(2)-1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915692">if</span>&nbsp;<span class="ident" id="1915695">absx</span>&nbsp;<span class="op" id="1915700">&lt;</span>&nbsp;<span class="ident" id="1915702">Small</span>&nbsp;<span class="op" id="1915708">{</span>&nbsp;<span class="comment" id="1915710">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915729">if</span>&nbsp;<span class="ident" id="1915732">absx</span>&nbsp;<span class="op" id="1915737">&lt;</span>&nbsp;<span class="ident" id="1915739">Tiny</span>&nbsp;<span class="op" id="1915744">{</span>&nbsp;<span class="comment" id="1915746">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915766">return</span>&nbsp;<span class="ident" id="1915773">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1915778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915783">return</span>&nbsp;<span class="ident" id="1915790">x</span>&nbsp;<span class="op" id="1915792">-</span>&nbsp;<span class="ident" id="1915794">x</span><span class="op" id="1915795">*</span><span class="ident" id="1915796">x</span><span class="op" id="1915797">*</span><span class="num" id="1915798">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1915804">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915808">if</span>&nbsp;<span class="ident" id="1915811">x</span>&nbsp;<span class="op" id="1915813">&gt;</span>&nbsp;<span class="ident" id="1915815">Sqrt2HalfM1</span>&nbsp;<span class="op" id="1915827">{</span>&nbsp;<span class="comment" id="1915829">//&nbsp;Sqrt(2)/2-1&nbsp;&lt;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1915851">//&nbsp;(Sqrt(2)/2-1)&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;(Sqrt(2)-1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1915889">k</span>&nbsp;<span class="op" id="1915891">=</span>&nbsp;<span class="num" id="1915893">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1915898">f</span>&nbsp;<span class="op" id="1915900">=</span>&nbsp;<span class="ident" id="1915902">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1915907">iu</span>&nbsp;<span class="op" id="1915910">=</span>&nbsp;<span class="num" id="1915912">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1915916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1915919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915922">var</span>&nbsp;<span class="ident" id="1915926">c</span>&nbsp;<span class="builtintype" id="1915928">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915937">if</span>&nbsp;<span class="ident" id="1915940">k</span>&nbsp;<span class="op" id="1915942">!=</span>&nbsp;<span class="num" id="1915945">0</span>&nbsp;<span class="op" id="1915947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915951">var</span>&nbsp;<span class="ident" id="1915955">u</span>&nbsp;<span class="builtintype" id="1915957">float64</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1915967">if</span>&nbsp;<span class="ident" id="1915970">absx</span>&nbsp;<span class="op" id="1915975">&lt;</span>&nbsp;<span class="ident" id="1915977">Two53</span>&nbsp;<span class="op" id="1915983">{</span>&nbsp;<span class="comment" id="1915985">//&nbsp;1&lt;&lt;53</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1915997">u</span>&nbsp;<span class="op" id="1915999">=</span>&nbsp;<span class="num" id="1916001">1.0</span>&nbsp;<span class="op" id="1916005">+</span>&nbsp;<span class="ident" id="1916007">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916012">iu</span>&nbsp;<span class="op" id="1916015">=</span>&nbsp;<span class="ident" id="1916017">Float64bits</span><span class="op" id="1916028">(</span><span class="ident" id="1916029">u</span><span class="op" id="1916030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916035">k</span>&nbsp;<span class="op" id="1916037">=</span>&nbsp;<span class="builtintype" id="1916039">int</span><span class="op" id="1916042">(</span><span class="op" id="1916043">(</span><span class="ident" id="1916044">iu</span>&nbsp;<span class="op" id="1916047">&gt;&gt;</span>&nbsp;<span class="num" id="1916050">52</span><span class="op" id="1916052">)</span>&nbsp;<span class="op" id="1916054">-</span>&nbsp;<span class="num" id="1916056">1023</span><span class="op" id="1916060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1916065">if</span>&nbsp;<span class="ident" id="1916068">k</span>&nbsp;<span class="op" id="1916070">&gt;</span>&nbsp;<span class="num" id="1916072">0</span>&nbsp;<span class="op" id="1916074">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916080">c</span>&nbsp;<span class="op" id="1916082">=</span>&nbsp;<span class="num" id="1916084">1.0</span>&nbsp;<span class="op" id="1916088">-</span>&nbsp;<span class="op" id="1916090">(</span><span class="ident" id="1916091">u</span>&nbsp;<span class="op" id="1916093">-</span>&nbsp;<span class="ident" id="1916095">x</span><span class="op" id="1916096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1916101">}</span>&nbsp;<span class="keyword" id="1916103">else</span>&nbsp;<span class="op" id="1916108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916114">c</span>&nbsp;<span class="op" id="1916116">=</span>&nbsp;<span class="ident" id="1916118">x</span>&nbsp;<span class="op" id="1916120">-</span>&nbsp;<span class="op" id="1916122">(</span><span class="ident" id="1916123">u</span>&nbsp;<span class="op" id="1916125">-</span>&nbsp;<span class="num" id="1916127">1.0</span><span class="op" id="1916130">)</span>&nbsp;<span class="comment" id="1916132">//&nbsp;correction&nbsp;term</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916155">c</span>&nbsp;<span class="op" id="1916157">/=</span>&nbsp;<span class="ident" id="1916160">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1916165">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1916169">}</span>&nbsp;<span class="keyword" id="1916171">else</span>&nbsp;<span class="op" id="1916176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916181">u</span>&nbsp;<span class="op" id="1916183">=</span>&nbsp;<span class="ident" id="1916185">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916190">iu</span>&nbsp;<span class="op" id="1916193">=</span>&nbsp;<span class="ident" id="1916195">Float64bits</span><span class="op" id="1916206">(</span><span class="ident" id="1916207">u</span><span class="op" id="1916208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916213">k</span>&nbsp;<span class="op" id="1916215">=</span>&nbsp;<span class="builtintype" id="1916217">int</span><span class="op" id="1916220">(</span><span class="op" id="1916221">(</span><span class="ident" id="1916222">iu</span>&nbsp;<span class="op" id="1916225">&gt;&gt;</span>&nbsp;<span class="num" id="1916228">52</span><span class="op" id="1916230">)</span>&nbsp;<span class="op" id="1916232">-</span>&nbsp;<span class="num" id="1916234">1023</span><span class="op" id="1916238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916243">c</span>&nbsp;<span class="op" id="1916245">=</span>&nbsp;<span class="num" id="1916247">0</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1916251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916255">iu</span>&nbsp;<span class="op" id="1916258">&amp;=</span>&nbsp;<span class="num" id="1916261">0x000fffffffffffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1916282">if</span>&nbsp;<span class="ident" id="1916285">iu</span>&nbsp;<span class="op" id="1916288">&lt;</span>&nbsp;<span class="num" id="1916290">0x0006a09e667f3bcd</span>&nbsp;<span class="op" id="1916309">{</span>&nbsp;<span class="comment" id="1916311">//&nbsp;mantissa&nbsp;of&nbsp;Sqrt(2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916337">u</span>&nbsp;<span class="op" id="1916339">=</span>&nbsp;<span class="ident" id="1916341">Float64frombits</span><span class="op" id="1916356">(</span><span class="ident" id="1916357">iu</span>&nbsp;<span class="op" id="1916360">|</span>&nbsp;<span class="num" id="1916362">0x3ff0000000000000</span><span class="op" id="1916380">)</span>&nbsp;<span class="comment" id="1916382">//&nbsp;normalize&nbsp;u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1916399">}</span>&nbsp;<span class="keyword" id="1916401">else</span>&nbsp;<span class="op" id="1916406">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916411">k</span>&nbsp;<span class="op" id="1916413">+=</span>&nbsp;<span class="num" id="1916416">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916421">u</span>&nbsp;<span class="op" id="1916423">=</span>&nbsp;<span class="ident" id="1916425">Float64frombits</span><span class="op" id="1916440">(</span><span class="ident" id="1916441">iu</span>&nbsp;<span class="op" id="1916444">|</span>&nbsp;<span class="num" id="1916446">0x3fe0000000000000</span><span class="op" id="1916464">)</span>&nbsp;<span class="comment" id="1916466">//&nbsp;normalize&nbsp;u/2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916486">iu</span>&nbsp;<span class="op" id="1916489">=</span>&nbsp;<span class="op" id="1916491">(</span><span class="num" id="1916492">0x0010000000000000</span>&nbsp;<span class="op" id="1916511">-</span>&nbsp;<span class="ident" id="1916513">iu</span><span class="op" id="1916515">)</span>&nbsp;<span class="op" id="1916517">&gt;&gt;</span>&nbsp;<span class="num" id="1916520">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1916524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916528">f</span>&nbsp;<span class="op" id="1916530">=</span>&nbsp;<span class="ident" id="1916532">u</span>&nbsp;<span class="op" id="1916534">-</span>&nbsp;<span class="num" id="1916536">1.0</span>&nbsp;<span class="comment" id="1916540">//&nbsp;Sqrt(2)/2&nbsp;&lt;&nbsp;u&nbsp;&lt;&nbsp;Sqrt(2)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1916568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916571">hfsq</span>&nbsp;<span class="op" id="1916576">:=</span>&nbsp;<span class="num" id="1916579">0.5</span>&nbsp;<span class="op" id="1916583">*</span>&nbsp;<span class="ident" id="1916585">f</span>&nbsp;<span class="op" id="1916587">*</span>&nbsp;<span class="ident" id="1916589">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1916592">var</span>&nbsp;<span class="ident" id="1916596">s</span><span class="op" id="1916597">,</span>&nbsp;<span class="ident" id="1916599">R</span><span class="op" id="1916600">,</span>&nbsp;<span class="ident" id="1916602">z</span>&nbsp;<span class="builtintype" id="1916604">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1916613">if</span>&nbsp;<span class="ident" id="1916616">iu</span>&nbsp;<span class="op" id="1916619">==</span>&nbsp;<span class="num" id="1916622">0</span>&nbsp;<span class="op" id="1916624">{</span>&nbsp;<span class="comment" id="1916626">//&nbsp;|f|&nbsp;&lt;&nbsp;2**-20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1916644">if</span>&nbsp;<span class="ident" id="1916647">f</span>&nbsp;<span class="op" id="1916649">==</span>&nbsp;<span class="num" id="1916652">0</span>&nbsp;<span class="op" id="1916654">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1916659">if</span>&nbsp;<span class="ident" id="1916662">k</span>&nbsp;<span class="op" id="1916664">==</span>&nbsp;<span class="num" id="1916667">0</span>&nbsp;<span class="op" id="1916669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1916675">return</span>&nbsp;<span class="num" id="1916682">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1916687">}</span>&nbsp;<span class="keyword" id="1916689">else</span>&nbsp;<span class="op" id="1916694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916700">c</span>&nbsp;<span class="op" id="1916702">+=</span>&nbsp;<span class="builtintype" id="1916705">float64</span><span class="op" id="1916712">(</span><span class="ident" id="1916713">k</span><span class="op" id="1916714">)</span>&nbsp;<span class="op" id="1916716">*</span>&nbsp;<span class="ident" id="1916718">Ln2Lo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1916728">return</span>&nbsp;<span class="builtintype" id="1916735">float64</span><span class="op" id="1916742">(</span><span class="ident" id="1916743">k</span><span class="op" id="1916744">)</span><span class="op" id="1916745">*</span><span class="ident" id="1916746">Ln2Hi</span>&nbsp;<span class="op" id="1916752">+</span>&nbsp;<span class="ident" id="1916754">c</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1916759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1916763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916767">R</span>&nbsp;<span class="op" id="1916769">=</span>&nbsp;<span class="ident" id="1916771">hfsq</span>&nbsp;<span class="op" id="1916776">*</span>&nbsp;<span class="op" id="1916778">(</span><span class="num" id="1916779">1.0</span>&nbsp;<span class="op" id="1916783">-</span>&nbsp;<span class="num" id="1916785">0.66666666666666666</span><span class="op" id="1916804">*</span><span class="ident" id="1916805">f</span><span class="op" id="1916806">)</span>&nbsp;<span class="comment" id="1916808">//&nbsp;avoid&nbsp;division</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1916828">if</span>&nbsp;<span class="ident" id="1916831">k</span>&nbsp;<span class="op" id="1916833">==</span>&nbsp;<span class="num" id="1916836">0</span>&nbsp;<span class="op" id="1916838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1916843">return</span>&nbsp;<span class="ident" id="1916850">f</span>&nbsp;<span class="op" id="1916852">-</span>&nbsp;<span class="ident" id="1916854">R</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1916858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1916862">return</span>&nbsp;<span class="builtintype" id="1916869">float64</span><span class="op" id="1916876">(</span><span class="ident" id="1916877">k</span><span class="op" id="1916878">)</span><span class="op" id="1916879">*</span><span class="ident" id="1916880">Ln2Hi</span>&nbsp;<span class="op" id="1916886">-</span>&nbsp;<span class="op" id="1916888">(</span><span class="op" id="1916889">(</span><span class="ident" id="1916890">R</span>&nbsp;<span class="op" id="1916892">-</span>&nbsp;<span class="op" id="1916894">(</span><span class="builtintype" id="1916895">float64</span><span class="op" id="1916902">(</span><span class="ident" id="1916903">k</span><span class="op" id="1916904">)</span><span class="op" id="1916905">*</span><span class="ident" id="1916906">Ln2Lo</span>&nbsp;<span class="op" id="1916912">+</span>&nbsp;<span class="ident" id="1916914">c</span><span class="op" id="1916915">)</span><span class="op" id="1916916">)</span>&nbsp;<span class="op" id="1916918">-</span>&nbsp;<span class="ident" id="1916920">f</span><span class="op" id="1916921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1916924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916927">s</span>&nbsp;<span class="op" id="1916929">=</span>&nbsp;<span class="ident" id="1916931">f</span>&nbsp;<span class="op" id="1916933">/</span>&nbsp;<span class="op" id="1916935">(</span><span class="num" id="1916936">2.0</span>&nbsp;<span class="op" id="1916940">+</span>&nbsp;<span class="ident" id="1916942">f</span><span class="op" id="1916943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916946">z</span>&nbsp;<span class="op" id="1916948">=</span>&nbsp;<span class="ident" id="1916950">s</span>&nbsp;<span class="op" id="1916952">*</span>&nbsp;<span class="ident" id="1916954">s</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1916957">R</span>&nbsp;<span class="op" id="1916959">=</span>&nbsp;<span class="ident" id="1916961">z</span>&nbsp;<span class="op" id="1916963">*</span>&nbsp;<span class="op" id="1916965">(</span><span class="ident" id="1916966">Lp1</span>&nbsp;<span class="op" id="1916970">+</span>&nbsp;<span class="ident" id="1916972">z</span><span class="op" id="1916973">*</span><span class="op" id="1916974">(</span><span class="ident" id="1916975">Lp2</span><span class="op" id="1916978">+</span><span class="ident" id="1916979">z</span><span class="op" id="1916980">*</span><span class="op" id="1916981">(</span><span class="ident" id="1916982">Lp3</span><span class="op" id="1916985">+</span><span class="ident" id="1916986">z</span><span class="op" id="1916987">*</span><span class="op" id="1916988">(</span><span class="ident" id="1916989">Lp4</span><span class="op" id="1916992">+</span><span class="ident" id="1916993">z</span><span class="op" id="1916994">*</span><span class="op" id="1916995">(</span><span class="ident" id="1916996">Lp5</span><span class="op" id="1916999">+</span><span class="ident" id="1917000">z</span><span class="op" id="1917001">*</span><span class="op" id="1917002">(</span><span class="ident" id="1917003">Lp6</span><span class="op" id="1917006">+</span><span class="ident" id="1917007">z</span><span class="op" id="1917008">*</span><span class="ident" id="1917009">Lp7</span><span class="op" id="1917012">)</span><span class="op" id="1917013">)</span><span class="op" id="1917014">)</span><span class="op" id="1917015">)</span><span class="op" id="1917016">)</span><span class="op" id="1917017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1917020">if</span>&nbsp;<span class="ident" id="1917023">k</span>&nbsp;<span class="op" id="1917025">==</span>&nbsp;<span class="num" id="1917028">0</span>&nbsp;<span class="op" id="1917030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1917034">return</span>&nbsp;<span class="ident" id="1917041">f</span>&nbsp;<span class="op" id="1917043">-</span>&nbsp;<span class="op" id="1917045">(</span><span class="ident" id="1917046">hfsq</span>&nbsp;<span class="op" id="1917051">-</span>&nbsp;<span class="ident" id="1917053">s</span><span class="op" id="1917054">*</span><span class="op" id="1917055">(</span><span class="ident" id="1917056">hfsq</span><span class="op" id="1917060">+</span><span class="ident" id="1917061">R</span><span class="op" id="1917062">)</span><span class="op" id="1917063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1917066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1917069">return</span>&nbsp;<span class="builtintype" id="1917076">float64</span><span class="op" id="1917083">(</span><span class="ident" id="1917084">k</span><span class="op" id="1917085">)</span><span class="op" id="1917086">*</span><span class="ident" id="1917087">Ln2Hi</span>&nbsp;<span class="op" id="1917093">-</span>&nbsp;<span class="op" id="1917095">(</span><span class="op" id="1917096">(</span><span class="ident" id="1917097">hfsq</span>&nbsp;<span class="op" id="1917102">-</span>&nbsp;<span class="op" id="1917104">(</span><span class="ident" id="1917105">s</span><span class="op" id="1917106">*</span><span class="op" id="1917107">(</span><span class="ident" id="1917108">hfsq</span><span class="op" id="1917112">+</span><span class="ident" id="1917113">R</span><span class="op" id="1917114">)</span>&nbsp;<span class="op" id="1917116">+</span>&nbsp;<span class="op" id="1917118">(</span><span class="builtintype" id="1917119">float64</span><span class="op" id="1917126">(</span><span class="ident" id="1917127">k</span><span class="op" id="1917128">)</span><span class="op" id="1917129">*</span><span class="ident" id="1917130">Ln2Lo</span>&nbsp;<span class="op" id="1917136">+</span>&nbsp;<span class="ident" id="1917138">c</span><span class="op" id="1917139">)</span><span class="op" id="1917140">)</span><span class="op" id="1917141">)</span>&nbsp;<span class="op" id="1917143">-</span>&nbsp;<span class="ident" id="1917145">f</span><span class="op" id="1917146">)</span><br>
<span class="lineno">200</span><span class="op" id="1917148">}</span>
</div>
</body>
</html>
