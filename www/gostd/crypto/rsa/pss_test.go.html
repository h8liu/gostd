<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html" class="current">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8018746">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8018801">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8018855">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8018906">package</span>&nbsp;<span class="ident" id="8018914">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8018919">import</span>&nbsp;<span class="op" id="8018926">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8018929">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8018938">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8018947">&#34;compress/bzip2&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8018965">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018975">_</span>&nbsp;<span class="string" id="8018977">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8018991">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8019006">&#34;crypto/sha1&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019021">_</span>&nbsp;<span class="string" id="8019023">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8019040">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8019056">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8019068">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8019074">&#34;strconv&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8019085">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8019096">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8019106">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8019109">func</span>&nbsp;<span class="ident" id="8019114">TestEMSAPSS</span><span class="op" id="8019125">(</span><span class="ident" id="8019126">t</span>&nbsp;<span class="op" id="8019128">*</span><span class="ident" id="8019129">testing</span><span class="op" id="8019136">.</span><span class="ident" id="8019137">T</span><span class="op" id="8019138">)</span>&nbsp;<span class="op" id="8019140">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8019143">//&nbsp;Test&nbsp;vector&nbsp;in&nbsp;file&nbsp;pss-int.txt&nbsp;from:&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019246">msg</span>&nbsp;<span class="op" id="8019250">:=</span>&nbsp;<span class="op" id="8019253">[</span><span class="op" id="8019254">]</span><span class="builtintype" id="8019255">byte</span><span class="op" id="8019259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8019263">0x85</span><span class="op" id="8019267">,</span>&nbsp;<span class="num" id="8019269">0x9e</span><span class="op" id="8019273">,</span>&nbsp;<span class="num" id="8019275">0xef</span><span class="op" id="8019279">,</span>&nbsp;<span class="num" id="8019281">0x2f</span><span class="op" id="8019285">,</span>&nbsp;<span class="num" id="8019287">0xd7</span><span class="op" id="8019291">,</span>&nbsp;<span class="num" id="8019293">0x8a</span><span class="op" id="8019297">,</span>&nbsp;<span class="num" id="8019299">0xca</span><span class="op" id="8019303">,</span>&nbsp;<span class="num" id="8019305">0x00</span><span class="op" id="8019309">,</span>&nbsp;<span class="num" id="8019311">0x30</span><span class="op" id="8019315">,</span>&nbsp;<span class="num" id="8019317">0x8b</span><span class="op" id="8019321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8019325">0xdc</span><span class="op" id="8019329">,</span>&nbsp;<span class="num" id="8019331">0x47</span><span class="op" id="8019335">,</span>&nbsp;<span class="num" id="8019337">0x11</span><span class="op" id="8019341">,</span>&nbsp;<span class="num" id="8019343">0x93</span><span class="op" id="8019347">,</span>&nbsp;<span class="num" id="8019349">0xbf</span><span class="op" id="8019353">,</span>&nbsp;<span class="num" id="8019355">0x55</span><span class="op" id="8019359">,</span>&nbsp;<span class="num" id="8019361">0xbf</span><span class="op" id="8019365">,</span>&nbsp;<span class="num" id="8019367">0x9d</span><span class="op" id="8019371">,</span>&nbsp;<span class="num" id="8019373">0x78</span><span class="op" id="8019377">,</span>&nbsp;<span class="num" id="8019379">0xdb</span><span class="op" id="8019383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8019387">0x8f</span><span class="op" id="8019391">,</span>&nbsp;<span class="num" id="8019393">0x8a</span><span class="op" id="8019397">,</span>&nbsp;<span class="num" id="8019399">0x67</span><span class="op" id="8019403">,</span>&nbsp;<span class="num" id="8019405">0x2b</span><span class="op" id="8019409">,</span>&nbsp;<span class="num" id="8019411">0x48</span><span class="op" id="8019415">,</span>&nbsp;<span class="num" id="8019417">0x46</span><span class="op" id="8019421">,</span>&nbsp;<span class="num" id="8019423">0x34</span><span class="op" id="8019427">,</span>&nbsp;<span class="num" id="8019429">0xf3</span><span class="op" id="8019433">,</span>&nbsp;<span class="num" id="8019435">0xc9</span><span class="op" id="8019439">,</span>&nbsp;<span class="num" id="8019441">0xc2</span><span class="op" id="8019445">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8019449">0x6e</span><span class="op" id="8019453">,</span>&nbsp;<span class="num" id="8019455">0x64</span><span class="op" id="8019459">,</span>&nbsp;<span class="num" id="8019461">0x78</span><span class="op" id="8019465">,</span>&nbsp;<span class="num" id="8019467">0xae</span><span class="op" id="8019471">,</span>&nbsp;<span class="num" id="8019473">0x10</span><span class="op" id="8019477">,</span>&nbsp;<span class="num" id="8019479">0x26</span><span class="op" id="8019483">,</span>&nbsp;<span class="num" id="8019485">0x0f</span><span class="op" id="8019489">,</span>&nbsp;<span class="num" id="8019491">0xe0</span><span class="op" id="8019495">,</span>&nbsp;<span class="num" id="8019497">0xdd</span><span class="op" id="8019501">,</span>&nbsp;<span class="num" id="8019503">0x8c</span><span class="op" id="8019507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8019511">0x08</span><span class="op" id="8019515">,</span>&nbsp;<span class="num" id="8019517">0x2e</span><span class="op" id="8019521">,</span>&nbsp;<span class="num" id="8019523">0x53</span><span class="op" id="8019527">,</span>&nbsp;<span class="num" id="8019529">0xa5</span><span class="op" id="8019533">,</span>&nbsp;<span class="num" id="8019535">0x29</span><span class="op" id="8019539">,</span>&nbsp;<span class="num" id="8019541">0x3a</span><span class="op" id="8019545">,</span>&nbsp;<span class="num" id="8019547">0xf2</span><span class="op" id="8019551">,</span>&nbsp;<span class="num" id="8019553">0x17</span><span class="op" id="8019557">,</span>&nbsp;<span class="num" id="8019559">0x3c</span><span class="op" id="8019563">,</span>&nbsp;<span class="num" id="8019565">0xd5</span><span class="op" id="8019569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8019573">0x0c</span><span class="op" id="8019577">,</span>&nbsp;<span class="num" id="8019579">0x6d</span><span class="op" id="8019583">,</span>&nbsp;<span class="num" id="8019585">0x5d</span><span class="op" id="8019589">,</span>&nbsp;<span class="num" id="8019591">0x35</span><span class="op" id="8019595">,</span>&nbsp;<span class="num" id="8019597">0x4f</span><span class="op" id="8019601">,</span>&nbsp;<span class="num" id="8019603">0xeb</span><span class="op" id="8019607">,</span>&nbsp;<span class="num" id="8019609">0xf7</span><span class="op" id="8019613">,</span>&nbsp;<span class="num" id="8019615">0x8b</span><span class="op" id="8019619">,</span>&nbsp;<span class="num" id="8019621">0x26</span><span class="op" id="8019625">,</span>&nbsp;<span class="num" id="8019627">0x02</span><span class="op" id="8019631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8019635">0x1c</span><span class="op" id="8019639">,</span>&nbsp;<span class="num" id="8019641">0x25</span><span class="op" id="8019645">,</span>&nbsp;<span class="num" id="8019647">0xc0</span><span class="op" id="8019651">,</span>&nbsp;<span class="num" id="8019653">0x27</span><span class="op" id="8019657">,</span>&nbsp;<span class="num" id="8019659">0x12</span><span class="op" id="8019663">,</span>&nbsp;<span class="num" id="8019665">0xe7</span><span class="op" id="8019669">,</span>&nbsp;<span class="num" id="8019671">0x8c</span><span class="op" id="8019675">,</span>&nbsp;<span class="num" id="8019677">0xd4</span><span class="op" id="8019681">,</span>&nbsp;<span class="num" id="8019683">0x69</span><span class="op" id="8019687">,</span>&nbsp;<span class="num" id="8019689">0x4c</span><span class="op" id="8019693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8019697">0x9f</span><span class="op" id="8019701">,</span>&nbsp;<span class="num" id="8019703">0x46</span><span class="op" id="8019707">,</span>&nbsp;<span class="num" id="8019709">0x97</span><span class="op" id="8019713">,</span>&nbsp;<span class="num" id="8019715">0x77</span><span class="op" id="8019719">,</span>&nbsp;<span class="num" id="8019721">0xe4</span><span class="op" id="8019725">,</span>&nbsp;<span class="num" id="8019727">0x51</span><span class="op" id="8019731">,</span>&nbsp;<span class="num" id="8019733">0xe7</span><span class="op" id="8019737">,</span>&nbsp;<span class="num" id="8019739">0xf8</span><span class="op" id="8019743">,</span>&nbsp;<span class="num" id="8019745">0xe9</span><span class="op" id="8019749">,</span>&nbsp;<span class="num" id="8019751">0xe0</span><span class="op" id="8019755">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8019759">0x4c</span><span class="op" id="8019763">,</span>&nbsp;<span class="num" id="8019765">0xd3</span><span class="op" id="8019769">,</span>&nbsp;<span class="num" id="8019771">0x73</span><span class="op" id="8019775">,</span>&nbsp;<span class="num" id="8019777">0x9c</span><span class="op" id="8019781">,</span>&nbsp;<span class="num" id="8019783">0x6b</span><span class="op" id="8019787">,</span>&nbsp;<span class="num" id="8019789">0xbf</span><span class="op" id="8019793">,</span>&nbsp;<span class="num" id="8019795">0xed</span><span class="op" id="8019799">,</span>&nbsp;<span class="num" id="8019801">0xae</span><span class="op" id="8019805">,</span>&nbsp;<span class="num" id="8019807">0x48</span><span class="op" id="8019811">,</span>&nbsp;<span class="num" id="8019813">0x7f</span><span class="op" id="8019817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8019821">0xb5</span><span class="op" id="8019825">,</span>&nbsp;<span class="num" id="8019827">0x56</span><span class="op" id="8019831">,</span>&nbsp;<span class="num" id="8019833">0x44</span><span class="op" id="8019837">,</span>&nbsp;<span class="num" id="8019839">0xe9</span><span class="op" id="8019843">,</span>&nbsp;<span class="num" id="8019845">0xca</span><span class="op" id="8019849">,</span>&nbsp;<span class="num" id="8019851">0x74</span><span class="op" id="8019855">,</span>&nbsp;<span class="num" id="8019857">0xff</span><span class="op" id="8019861">,</span>&nbsp;<span class="num" id="8019863">0x77</span><span class="op" id="8019867">,</span>&nbsp;<span class="num" id="8019869">0xa5</span><span class="op" id="8019873">,</span>&nbsp;<span class="num" id="8019875">0x3c</span><span class="op" id="8019879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8019883">0xb7</span><span class="op" id="8019887">,</span>&nbsp;<span class="num" id="8019889">0x29</span><span class="op" id="8019893">,</span>&nbsp;<span class="num" id="8019895">0x80</span><span class="op" id="8019899">,</span>&nbsp;<span class="num" id="8019901">0x2f</span><span class="op" id="8019905">,</span>&nbsp;<span class="num" id="8019907">0x6e</span><span class="op" id="8019911">,</span>&nbsp;<span class="num" id="8019913">0xd4</span><span class="op" id="8019917">,</span>&nbsp;<span class="num" id="8019919">0xa5</span><span class="op" id="8019923">,</span>&nbsp;<span class="num" id="8019925">0xff</span><span class="op" id="8019929">,</span>&nbsp;<span class="num" id="8019931">0xa8</span><span class="op" id="8019935">,</span>&nbsp;<span class="num" id="8019937">0xba</span><span class="op" id="8019941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8019945">0x15</span><span class="op" id="8019949">,</span>&nbsp;<span class="num" id="8019951">0x98</span><span class="op" id="8019955">,</span>&nbsp;<span class="num" id="8019957">0x90</span><span class="op" id="8019961">,</span>&nbsp;<span class="num" id="8019963">0xfc</span><span class="op" id="8019967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019970">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019973">salt</span>&nbsp;<span class="op" id="8019978">:=</span>&nbsp;<span class="op" id="8019981">[</span><span class="op" id="8019982">]</span><span class="builtintype" id="8019983">byte</span><span class="op" id="8019987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8019991">0xe3</span><span class="op" id="8019995">,</span>&nbsp;<span class="num" id="8019997">0xb5</span><span class="op" id="8020001">,</span>&nbsp;<span class="num" id="8020003">0xd5</span><span class="op" id="8020007">,</span>&nbsp;<span class="num" id="8020009">0xd0</span><span class="op" id="8020013">,</span>&nbsp;<span class="num" id="8020015">0x02</span><span class="op" id="8020019">,</span>&nbsp;<span class="num" id="8020021">0xc1</span><span class="op" id="8020025">,</span>&nbsp;<span class="num" id="8020027">0xbc</span><span class="op" id="8020031">,</span>&nbsp;<span class="num" id="8020033">0xe5</span><span class="op" id="8020037">,</span>&nbsp;<span class="num" id="8020039">0x0c</span><span class="op" id="8020043">,</span>&nbsp;<span class="num" id="8020045">0x2b</span><span class="op" id="8020049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8020053">0x65</span><span class="op" id="8020057">,</span>&nbsp;<span class="num" id="8020059">0xef</span><span class="op" id="8020063">,</span>&nbsp;<span class="num" id="8020065">0x88</span><span class="op" id="8020069">,</span>&nbsp;<span class="num" id="8020071">0xa1</span><span class="op" id="8020075">,</span>&nbsp;<span class="num" id="8020077">0x88</span><span class="op" id="8020081">,</span>&nbsp;<span class="num" id="8020083">0xd8</span><span class="op" id="8020087">,</span>&nbsp;<span class="num" id="8020089">0x3b</span><span class="op" id="8020093">,</span>&nbsp;<span class="num" id="8020095">0xce</span><span class="op" id="8020099">,</span>&nbsp;<span class="num" id="8020101">0x7e</span><span class="op" id="8020105">,</span>&nbsp;<span class="num" id="8020107">0x61</span><span class="op" id="8020111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020117">expected</span>&nbsp;<span class="op" id="8020126">:=</span>&nbsp;<span class="op" id="8020129">[</span><span class="op" id="8020130">]</span><span class="builtintype" id="8020131">byte</span><span class="op" id="8020135">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8020139">0x66</span><span class="op" id="8020143">,</span>&nbsp;<span class="num" id="8020145">0xe4</span><span class="op" id="8020149">,</span>&nbsp;<span class="num" id="8020151">0x67</span><span class="op" id="8020155">,</span>&nbsp;<span class="num" id="8020157">0x2e</span><span class="op" id="8020161">,</span>&nbsp;<span class="num" id="8020163">0x83</span><span class="op" id="8020167">,</span>&nbsp;<span class="num" id="8020169">0x6a</span><span class="op" id="8020173">,</span>&nbsp;<span class="num" id="8020175">0xd1</span><span class="op" id="8020179">,</span>&nbsp;<span class="num" id="8020181">0x21</span><span class="op" id="8020185">,</span>&nbsp;<span class="num" id="8020187">0xba</span><span class="op" id="8020191">,</span>&nbsp;<span class="num" id="8020193">0x24</span><span class="op" id="8020197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8020201">0x4b</span><span class="op" id="8020205">,</span>&nbsp;<span class="num" id="8020207">0xed</span><span class="op" id="8020211">,</span>&nbsp;<span class="num" id="8020213">0x65</span><span class="op" id="8020217">,</span>&nbsp;<span class="num" id="8020219">0x76</span><span class="op" id="8020223">,</span>&nbsp;<span class="num" id="8020225">0xb8</span><span class="op" id="8020229">,</span>&nbsp;<span class="num" id="8020231">0x67</span><span class="op" id="8020235">,</span>&nbsp;<span class="num" id="8020237">0xd9</span><span class="op" id="8020241">,</span>&nbsp;<span class="num" id="8020243">0xa4</span><span class="op" id="8020247">,</span>&nbsp;<span class="num" id="8020249">0x47</span><span class="op" id="8020253">,</span>&nbsp;<span class="num" id="8020255">0xc2</span><span class="op" id="8020259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8020263">0x8a</span><span class="op" id="8020267">,</span>&nbsp;<span class="num" id="8020269">0x6e</span><span class="op" id="8020273">,</span>&nbsp;<span class="num" id="8020275">0x66</span><span class="op" id="8020279">,</span>&nbsp;<span class="num" id="8020281">0xa5</span><span class="op" id="8020285">,</span>&nbsp;<span class="num" id="8020287">0xb8</span><span class="op" id="8020291">,</span>&nbsp;<span class="num" id="8020293">0x7d</span><span class="op" id="8020297">,</span>&nbsp;<span class="num" id="8020299">0xee</span><span class="op" id="8020303">,</span>&nbsp;<span class="num" id="8020305">0x7f</span><span class="op" id="8020309">,</span>&nbsp;<span class="num" id="8020311">0xbc</span><span class="op" id="8020315">,</span>&nbsp;<span class="num" id="8020317">0x7e</span><span class="op" id="8020321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8020325">0x65</span><span class="op" id="8020329">,</span>&nbsp;<span class="num" id="8020331">0xaf</span><span class="op" id="8020335">,</span>&nbsp;<span class="num" id="8020337">0x50</span><span class="op" id="8020341">,</span>&nbsp;<span class="num" id="8020343">0x57</span><span class="op" id="8020347">,</span>&nbsp;<span class="num" id="8020349">0xf8</span><span class="op" id="8020353">,</span>&nbsp;<span class="num" id="8020355">0x6f</span><span class="op" id="8020359">,</span>&nbsp;<span class="num" id="8020361">0xae</span><span class="op" id="8020365">,</span>&nbsp;<span class="num" id="8020367">0x89</span><span class="op" id="8020371">,</span>&nbsp;<span class="num" id="8020373">0x84</span><span class="op" id="8020377">,</span>&nbsp;<span class="num" id="8020379">0xd9</span><span class="op" id="8020383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8020387">0xba</span><span class="op" id="8020391">,</span>&nbsp;<span class="num" id="8020393">0x7f</span><span class="op" id="8020397">,</span>&nbsp;<span class="num" id="8020399">0x96</span><span class="op" id="8020403">,</span>&nbsp;<span class="num" id="8020405">0x9a</span><span class="op" id="8020409">,</span>&nbsp;<span class="num" id="8020411">0xd6</span><span class="op" id="8020415">,</span>&nbsp;<span class="num" id="8020417">0xfe</span><span class="op" id="8020421">,</span>&nbsp;<span class="num" id="8020423">0x02</span><span class="op" id="8020427">,</span>&nbsp;<span class="num" id="8020429">0xa4</span><span class="op" id="8020433">,</span>&nbsp;<span class="num" id="8020435">0xd7</span><span class="op" id="8020439">,</span>&nbsp;<span class="num" id="8020441">0x5f</span><span class="op" id="8020445">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8020449">0x74</span><span class="op" id="8020453">,</span>&nbsp;<span class="num" id="8020455">0x45</span><span class="op" id="8020459">,</span>&nbsp;<span class="num" id="8020461">0xfe</span><span class="op" id="8020465">,</span>&nbsp;<span class="num" id="8020467">0xfd</span><span class="op" id="8020471">,</span>&nbsp;<span class="num" id="8020473">0xd8</span><span class="op" id="8020477">,</span>&nbsp;<span class="num" id="8020479">0x5b</span><span class="op" id="8020483">,</span>&nbsp;<span class="num" id="8020485">0x6d</span><span class="op" id="8020489">,</span>&nbsp;<span class="num" id="8020491">0x3a</span><span class="op" id="8020495">,</span>&nbsp;<span class="num" id="8020497">0x47</span><span class="op" id="8020501">,</span>&nbsp;<span class="num" id="8020503">0x7c</span><span class="op" id="8020507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8020511">0x28</span><span class="op" id="8020515">,</span>&nbsp;<span class="num" id="8020517">0xd2</span><span class="op" id="8020521">,</span>&nbsp;<span class="num" id="8020523">0x4b</span><span class="op" id="8020527">,</span>&nbsp;<span class="num" id="8020529">0xa1</span><span class="op" id="8020533">,</span>&nbsp;<span class="num" id="8020535">0xe3</span><span class="op" id="8020539">,</span>&nbsp;<span class="num" id="8020541">0x75</span><span class="op" id="8020545">,</span>&nbsp;<span class="num" id="8020547">0x6f</span><span class="op" id="8020551">,</span>&nbsp;<span class="num" id="8020553">0x79</span><span class="op" id="8020557">,</span>&nbsp;<span class="num" id="8020559">0x2d</span><span class="op" id="8020563">,</span>&nbsp;<span class="num" id="8020565">0xd1</span><span class="op" id="8020569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8020573">0xdc</span><span class="op" id="8020577">,</span>&nbsp;<span class="num" id="8020579">0xe8</span><span class="op" id="8020583">,</span>&nbsp;<span class="num" id="8020585">0xca</span><span class="op" id="8020589">,</span>&nbsp;<span class="num" id="8020591">0x94</span><span class="op" id="8020595">,</span>&nbsp;<span class="num" id="8020597">0x44</span><span class="op" id="8020601">,</span>&nbsp;<span class="num" id="8020603">0x0e</span><span class="op" id="8020607">,</span>&nbsp;<span class="num" id="8020609">0xcb</span><span class="op" id="8020613">,</span>&nbsp;<span class="num" id="8020615">0x52</span><span class="op" id="8020619">,</span>&nbsp;<span class="num" id="8020621">0x79</span><span class="op" id="8020625">,</span>&nbsp;<span class="num" id="8020627">0xec</span><span class="op" id="8020631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8020635">0xd3</span><span class="op" id="8020639">,</span>&nbsp;<span class="num" id="8020641">0x18</span><span class="op" id="8020645">,</span>&nbsp;<span class="num" id="8020647">0x3a</span><span class="op" id="8020651">,</span>&nbsp;<span class="num" id="8020653">0x31</span><span class="op" id="8020657">,</span>&nbsp;<span class="num" id="8020659">0x1f</span><span class="op" id="8020663">,</span>&nbsp;<span class="num" id="8020665">0xc8</span><span class="op" id="8020669">,</span>&nbsp;<span class="num" id="8020671">0x96</span><span class="op" id="8020675">,</span>&nbsp;<span class="num" id="8020677">0xda</span><span class="op" id="8020681">,</span>&nbsp;<span class="num" id="8020683">0x1c</span><span class="op" id="8020687">,</span>&nbsp;<span class="num" id="8020689">0xb3</span><span class="op" id="8020693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8020697">0x93</span><span class="op" id="8020701">,</span>&nbsp;<span class="num" id="8020703">0x11</span><span class="op" id="8020707">,</span>&nbsp;<span class="num" id="8020709">0xaf</span><span class="op" id="8020713">,</span>&nbsp;<span class="num" id="8020715">0x37</span><span class="op" id="8020719">,</span>&nbsp;<span class="num" id="8020721">0xea</span><span class="op" id="8020725">,</span>&nbsp;<span class="num" id="8020727">0x4a</span><span class="op" id="8020731">,</span>&nbsp;<span class="num" id="8020733">0x75</span><span class="op" id="8020737">,</span>&nbsp;<span class="num" id="8020739">0xe2</span><span class="op" id="8020743">,</span>&nbsp;<span class="num" id="8020745">0x4b</span><span class="op" id="8020749">,</span>&nbsp;<span class="num" id="8020751">0xdb</span><span class="op" id="8020755">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8020759">0xfd</span><span class="op" id="8020763">,</span>&nbsp;<span class="num" id="8020765">0x5c</span><span class="op" id="8020769">,</span>&nbsp;<span class="num" id="8020771">0x1d</span><span class="op" id="8020775">,</span>&nbsp;<span class="num" id="8020777">0xa0</span><span class="op" id="8020781">,</span>&nbsp;<span class="num" id="8020783">0xde</span><span class="op" id="8020787">,</span>&nbsp;<span class="num" id="8020789">0x7c</span><span class="op" id="8020793">,</span>&nbsp;<span class="num" id="8020795">0xec</span><span class="op" id="8020799">,</span>&nbsp;<span class="num" id="8020801">0xdf</span><span class="op" id="8020805">,</span>&nbsp;<span class="num" id="8020807">0x1a</span><span class="op" id="8020811">,</span>&nbsp;<span class="num" id="8020813">0x89</span><span class="op" id="8020817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8020821">0x6f</span><span class="op" id="8020825">,</span>&nbsp;<span class="num" id="8020827">0x9d</span><span class="op" id="8020831">,</span>&nbsp;<span class="num" id="8020833">0x8b</span><span class="op" id="8020837">,</span>&nbsp;<span class="num" id="8020839">0xc8</span><span class="op" id="8020843">,</span>&nbsp;<span class="num" id="8020845">0x16</span><span class="op" id="8020849">,</span>&nbsp;<span class="num" id="8020851">0xd9</span><span class="op" id="8020855">,</span>&nbsp;<span class="num" id="8020857">0x7c</span><span class="op" id="8020861">,</span>&nbsp;<span class="num" id="8020863">0xd7</span><span class="op" id="8020867">,</span>&nbsp;<span class="num" id="8020869">0xa2</span><span class="op" id="8020873">,</span>&nbsp;<span class="num" id="8020875">0xc4</span><span class="op" id="8020879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8020883">0x3b</span><span class="op" id="8020887">,</span>&nbsp;<span class="num" id="8020889">0xad</span><span class="op" id="8020893">,</span>&nbsp;<span class="num" id="8020895">0x54</span><span class="op" id="8020899">,</span>&nbsp;<span class="num" id="8020901">0x6f</span><span class="op" id="8020905">,</span>&nbsp;<span class="num" id="8020907">0xbe</span><span class="op" id="8020911">,</span>&nbsp;<span class="num" id="8020913">0x8c</span><span class="op" id="8020917">,</span>&nbsp;<span class="num" id="8020919">0xfe</span><span class="op" id="8020923">,</span>&nbsp;<span class="num" id="8020925">0xbc</span><span class="op" id="8020929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020936">hash</span>&nbsp;<span class="op" id="8020941">:=</span>&nbsp;<span class="ident" id="8020944">sha1</span><span class="op" id="8020948">.</span><span class="ident" id="8020949">New</span><span class="op" id="8020952">(</span><span class="op" id="8020953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020956">hash</span><span class="op" id="8020960">.</span><span class="ident" id="8020961">Write</span><span class="op" id="8020966">(</span><span class="ident" id="8020967">msg</span><span class="op" id="8020970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020973">hashed</span>&nbsp;<span class="op" id="8020980">:=</span>&nbsp;<span class="ident" id="8020983">hash</span><span class="op" id="8020987">.</span><span class="ident" id="8020988">Sum</span><span class="op" id="8020991">(</span><span class="ident" id="8020992">nil</span><span class="op" id="8020995">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020999">encoded</span><span class="op" id="8021006">,</span>&nbsp;<span class="ident" id="8021008">err</span>&nbsp;<span class="op" id="8021012">:=</span>&nbsp;<span class="ident" id="8021015">emsaPSSEncode</span><span class="op" id="8021028">(</span><span class="ident" id="8021029">hashed</span><span class="op" id="8021035">,</span>&nbsp;<span class="num" id="8021037">1023</span><span class="op" id="8021041">,</span>&nbsp;<span class="ident" id="8021043">salt</span><span class="op" id="8021047">,</span>&nbsp;<span class="ident" id="8021049">sha1</span><span class="op" id="8021053">.</span><span class="ident" id="8021054">New</span><span class="op" id="8021057">(</span><span class="op" id="8021058">)</span><span class="op" id="8021059">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021062">if</span>&nbsp;<span class="ident" id="8021065">err</span>&nbsp;<span class="op" id="8021069">!=</span>&nbsp;<span class="ident" id="8021072">nil</span>&nbsp;<span class="op" id="8021076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021080">t</span><span class="op" id="8021081">.</span><span class="ident" id="8021082">Errorf</span><span class="op" id="8021088">(</span><span class="string" id="8021089">&#34;Error&nbsp;from&nbsp;emsaPSSEncode:&nbsp;%s\n&#34;</span><span class="op" id="8021121">,</span>&nbsp;<span class="ident" id="8021123">err</span><span class="op" id="8021126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8021129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021132">if</span>&nbsp;<span class="op" id="8021135">!</span><span class="ident" id="8021136">bytes</span><span class="op" id="8021141">.</span><span class="ident" id="8021142">Equal</span><span class="op" id="8021147">(</span><span class="ident" id="8021148">encoded</span><span class="op" id="8021155">,</span>&nbsp;<span class="ident" id="8021157">expected</span><span class="op" id="8021165">)</span>&nbsp;<span class="op" id="8021167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021171">t</span><span class="op" id="8021172">.</span><span class="ident" id="8021173">Errorf</span><span class="op" id="8021179">(</span><span class="string" id="8021180">&#34;Bad&nbsp;encoding.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8021211">,</span>&nbsp;<span class="ident" id="8021213">encoded</span><span class="op" id="8021220">,</span>&nbsp;<span class="ident" id="8021222">expected</span><span class="op" id="8021230">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8021233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021237">if</span>&nbsp;<span class="ident" id="8021240">err</span>&nbsp;<span class="op" id="8021244">=</span>&nbsp;<span class="ident" id="8021246">emsaPSSVerify</span><span class="op" id="8021259">(</span><span class="ident" id="8021260">hashed</span><span class="op" id="8021266">,</span>&nbsp;<span class="ident" id="8021268">encoded</span><span class="op" id="8021275">,</span>&nbsp;<span class="num" id="8021277">1023</span><span class="op" id="8021281">,</span>&nbsp;<span class="builtinfunc" id="8021283">len</span><span class="op" id="8021286">(</span><span class="ident" id="8021287">salt</span><span class="op" id="8021291">)</span><span class="op" id="8021292">,</span>&nbsp;<span class="ident" id="8021294">sha1</span><span class="op" id="8021298">.</span><span class="ident" id="8021299">New</span><span class="op" id="8021302">(</span><span class="op" id="8021303">)</span><span class="op" id="8021304">)</span><span class="op" id="8021305">;</span>&nbsp;<span class="ident" id="8021307">err</span>&nbsp;<span class="op" id="8021311">!=</span>&nbsp;<span class="ident" id="8021314">nil</span>&nbsp;<span class="op" id="8021318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021322">t</span><span class="op" id="8021323">.</span><span class="ident" id="8021324">Errorf</span><span class="op" id="8021330">(</span><span class="string" id="8021331">&#34;Bad&nbsp;verification:&nbsp;%s&#34;</span><span class="op" id="8021353">,</span>&nbsp;<span class="ident" id="8021355">err</span><span class="op" id="8021358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8021361">}</span><br>
<span class="lineno">75</span><span class="op" id="8021363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8021366">//&nbsp;TestPSSGolden&nbsp;tests&nbsp;all&nbsp;the&nbsp;test&nbsp;vectors&nbsp;in&nbsp;pss-vect.txt&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="8021431">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span><span class="keyword" id="8021495">func</span>&nbsp;<span class="ident" id="8021500">TestPSSGolden</span><span class="op" id="8021513">(</span><span class="ident" id="8021514">t</span>&nbsp;<span class="op" id="8021516">*</span><span class="ident" id="8021517">testing</span><span class="op" id="8021524">.</span><span class="ident" id="8021525">T</span><span class="op" id="8021526">)</span>&nbsp;<span class="op" id="8021528">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021531">inFile</span><span class="op" id="8021537">,</span>&nbsp;<span class="ident" id="8021539">err</span>&nbsp;<span class="op" id="8021543">:=</span>&nbsp;<span class="ident" id="8021546">os</span><span class="op" id="8021548">.</span><span class="ident" id="8021549">Open</span><span class="op" id="8021553">(</span><span class="string" id="8021554">&#34;testdata/pss-vect.txt.bz2&#34;</span><span class="op" id="8021581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021584">if</span>&nbsp;<span class="ident" id="8021587">err</span>&nbsp;<span class="op" id="8021591">!=</span>&nbsp;<span class="ident" id="8021594">nil</span>&nbsp;<span class="op" id="8021598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021602">t</span><span class="op" id="8021603">.</span><span class="ident" id="8021604">Fatalf</span><span class="op" id="8021610">(</span><span class="string" id="8021611">&#34;Failed&nbsp;to&nbsp;open&nbsp;input&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="8021642">,</span>&nbsp;<span class="ident" id="8021644">err</span><span class="op" id="8021647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8021650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021653">defer</span>&nbsp;<span class="ident" id="8021659">inFile</span><span class="op" id="8021665">.</span><span class="ident" id="8021666">Close</span><span class="op" id="8021671">(</span><span class="op" id="8021672">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8021676">//&nbsp;The&nbsp;pss-vect.txt&nbsp;file&nbsp;contains&nbsp;RSA&nbsp;keys&nbsp;and&nbsp;then&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8021741">//&nbsp;signatures.&nbsp;A&nbsp;goroutine&nbsp;is&nbsp;used&nbsp;to&nbsp;preprocess&nbsp;the&nbsp;input&nbsp;by&nbsp;merging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8021812">//&nbsp;lines,&nbsp;removing&nbsp;spaces&nbsp;in&nbsp;hex&nbsp;values&nbsp;and&nbsp;identifying&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8021882">//&nbsp;new&nbsp;keys&nbsp;and&nbsp;signature&nbsp;blocks.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021917">const</span>&nbsp;<span class="ident" id="8021923">newKeyMarker</span>&nbsp;<span class="op" id="8021936">=</span>&nbsp;<span class="string" id="8021938">&#34;START&nbsp;NEW&nbsp;KEY&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021955">const</span>&nbsp;<span class="ident" id="8021961">newSignatureMarker</span>&nbsp;<span class="op" id="8021980">=</span>&nbsp;<span class="string" id="8021982">&#34;START&nbsp;NEW&nbsp;SIGNATURE&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022006">values</span>&nbsp;<span class="op" id="8022013">:=</span>&nbsp;<span class="builtinfunc" id="8022016">make</span><span class="op" id="8022020">(</span><span class="keyword" id="8022021">chan</span>&nbsp;<span class="builtintype" id="8022026">string</span><span class="op" id="8022032">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022036">go</span>&nbsp;<span class="keyword" id="8022039">func</span><span class="op" id="8022043">(</span><span class="op" id="8022044">)</span>&nbsp;<span class="op" id="8022046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022050">defer</span>&nbsp;<span class="builtinfunc" id="8022056">close</span><span class="op" id="8022061">(</span><span class="ident" id="8022062">values</span><span class="op" id="8022068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022072">scanner</span>&nbsp;<span class="op" id="8022080">:=</span>&nbsp;<span class="ident" id="8022083">bufio</span><span class="op" id="8022088">.</span><span class="ident" id="8022089">NewScanner</span><span class="op" id="8022099">(</span><span class="ident" id="8022100">bzip2</span><span class="op" id="8022105">.</span><span class="ident" id="8022106">NewReader</span><span class="op" id="8022115">(</span><span class="ident" id="8022116">inFile</span><span class="op" id="8022122">)</span><span class="op" id="8022123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022127">var</span>&nbsp;<span class="ident" id="8022131">partialValue</span>&nbsp;<span class="builtintype" id="8022144">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022153">lastWasValue</span>&nbsp;<span class="op" id="8022166">:=</span>&nbsp;<span class="builtintype" id="8022169">true</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022177">for</span>&nbsp;<span class="ident" id="8022181">scanner</span><span class="op" id="8022188">.</span><span class="ident" id="8022189">Scan</span><span class="op" id="8022193">(</span><span class="op" id="8022194">)</span>&nbsp;<span class="op" id="8022196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022201">line</span>&nbsp;<span class="op" id="8022206">:=</span>&nbsp;<span class="ident" id="8022209">scanner</span><span class="op" id="8022216">.</span><span class="ident" id="8022217">Text</span><span class="op" id="8022221">(</span><span class="op" id="8022222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022227">switch</span>&nbsp;<span class="op" id="8022234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022239">case</span>&nbsp;<span class="builtinfunc" id="8022244">len</span><span class="op" id="8022247">(</span><span class="ident" id="8022248">line</span><span class="op" id="8022252">)</span>&nbsp;<span class="op" id="8022254">==</span>&nbsp;<span class="num" id="8022257">0</span><span class="op" id="8022258">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022264">if</span>&nbsp;<span class="builtinfunc" id="8022267">len</span><span class="op" id="8022270">(</span><span class="ident" id="8022271">partialValue</span><span class="op" id="8022283">)</span>&nbsp;<span class="op" id="8022285">&gt;</span>&nbsp;<span class="num" id="8022287">0</span>&nbsp;<span class="op" id="8022289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022296">values</span>&nbsp;<span class="op" id="8022303">&lt;-</span>&nbsp;<span class="ident" id="8022306">strings</span><span class="op" id="8022313">.</span><span class="ident" id="8022314">Replace</span><span class="op" id="8022321">(</span><span class="ident" id="8022322">partialValue</span><span class="op" id="8022334">,</span>&nbsp;<span class="string" id="8022336">&#34;&nbsp;&#34;</span><span class="op" id="8022339">,</span>&nbsp;<span class="string" id="8022341">&#34;&#34;</span><span class="op" id="8022343">,</span>&nbsp;<span class="op" id="8022345">-</span><span class="num" id="8022346">1</span><span class="op" id="8022347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022354">partialValue</span>&nbsp;<span class="op" id="8022367">=</span>&nbsp;<span class="string" id="8022369">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022377">lastWasValue</span>&nbsp;<span class="op" id="8022390">=</span>&nbsp;<span class="builtintype" id="8022392">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022401">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022407">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022419">case</span>&nbsp;<span class="ident" id="8022424">strings</span><span class="op" id="8022431">.</span><span class="ident" id="8022432">HasPrefix</span><span class="op" id="8022441">(</span><span class="ident" id="8022442">line</span><span class="op" id="8022446">,</span>&nbsp;<span class="string" id="8022448">&#34;#&nbsp;======&#34;</span><span class="op" id="8022458">)</span>&nbsp;<span class="op" id="8022460">&amp;&amp;</span>&nbsp;<span class="ident" id="8022463">lastWasValue</span><span class="op" id="8022475">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022481">values</span>&nbsp;<span class="op" id="8022488">&lt;-</span>&nbsp;<span class="ident" id="8022491">newKeyMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022508">lastWasValue</span>&nbsp;<span class="op" id="8022521">=</span>&nbsp;<span class="builtintype" id="8022523">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022532">case</span>&nbsp;<span class="ident" id="8022537">strings</span><span class="op" id="8022544">.</span><span class="ident" id="8022545">HasPrefix</span><span class="op" id="8022554">(</span><span class="ident" id="8022555">line</span><span class="op" id="8022559">,</span>&nbsp;<span class="string" id="8022561">&#34;#&nbsp;------&#34;</span><span class="op" id="8022571">)</span>&nbsp;<span class="op" id="8022573">&amp;&amp;</span>&nbsp;<span class="ident" id="8022576">lastWasValue</span><span class="op" id="8022588">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022594">values</span>&nbsp;<span class="op" id="8022601">&lt;-</span>&nbsp;<span class="ident" id="8022604">newSignatureMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022627">lastWasValue</span>&nbsp;<span class="op" id="8022640">=</span>&nbsp;<span class="builtintype" id="8022642">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022651">case</span>&nbsp;<span class="ident" id="8022656">strings</span><span class="op" id="8022663">.</span><span class="ident" id="8022664">HasPrefix</span><span class="op" id="8022673">(</span><span class="ident" id="8022674">line</span><span class="op" id="8022678">,</span>&nbsp;<span class="string" id="8022680">&#34;#&#34;</span><span class="op" id="8022683">)</span><span class="op" id="8022684">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022690">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022702">default</span><span class="op" id="8022709">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022715">partialValue</span>&nbsp;<span class="op" id="8022728">+=</span>&nbsp;<span class="ident" id="8022731">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022747">if</span>&nbsp;<span class="ident" id="8022750">err</span>&nbsp;<span class="op" id="8022754">:=</span>&nbsp;<span class="ident" id="8022757">scanner</span><span class="op" id="8022764">.</span><span class="ident" id="8022765">Err</span><span class="op" id="8022768">(</span><span class="op" id="8022769">)</span><span class="op" id="8022770">;</span>&nbsp;<span class="ident" id="8022772">err</span>&nbsp;<span class="op" id="8022776">!=</span>&nbsp;<span class="ident" id="8022779">nil</span>&nbsp;<span class="op" id="8022783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8022788">panic</span><span class="op" id="8022793">(</span><span class="ident" id="8022794">err</span><span class="op" id="8022797">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022804">}</span><span class="op" id="8022805">(</span><span class="op" id="8022806">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022810">var</span>&nbsp;<span class="ident" id="8022814">key</span>&nbsp;<span class="op" id="8022818">*</span><span class="ident" id="8022819">PublicKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022830">var</span>&nbsp;<span class="ident" id="8022834">hashed</span>&nbsp;<span class="op" id="8022841">[</span><span class="op" id="8022842">]</span><span class="builtintype" id="8022843">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022849">hash</span>&nbsp;<span class="op" id="8022854">:=</span>&nbsp;<span class="ident" id="8022857">crypto</span><span class="op" id="8022863">.</span><span class="ident" id="8022864">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022870">h</span>&nbsp;<span class="op" id="8022872">:=</span>&nbsp;<span class="ident" id="8022875">hash</span><span class="op" id="8022879">.</span><span class="ident" id="8022880">New</span><span class="op" id="8022883">(</span><span class="op" id="8022884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022887">opts</span>&nbsp;<span class="op" id="8022892">:=</span>&nbsp;<span class="op" id="8022895">&amp;</span><span class="ident" id="8022896">PSSOptions</span><span class="op" id="8022906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022910">SaltLength</span><span class="op" id="8022920">:</span>&nbsp;<span class="ident" id="8022922">PSSSaltLengthEqualsHash</span><span class="op" id="8022945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022948">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022952">for</span>&nbsp;<span class="ident" id="8022956">marker</span>&nbsp;<span class="op" id="8022963">:=</span>&nbsp;<span class="keyword" id="8022966">range</span>&nbsp;<span class="ident" id="8022972">values</span>&nbsp;<span class="op" id="8022979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022983">switch</span>&nbsp;<span class="ident" id="8022990">marker</span>&nbsp;<span class="op" id="8022997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8023001">case</span>&nbsp;<span class="ident" id="8023006">newKeyMarker</span><span class="op" id="8023018">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023023">key</span>&nbsp;<span class="op" id="8023027">=</span>&nbsp;<span class="builtinfunc" id="8023029">new</span><span class="op" id="8023032">(</span><span class="ident" id="8023033">PublicKey</span><span class="op" id="8023042">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023047">nHex</span><span class="op" id="8023051">,</span>&nbsp;<span class="ident" id="8023053">ok</span>&nbsp;<span class="op" id="8023056">:=</span>&nbsp;<span class="op" id="8023059">&lt;-</span><span class="ident" id="8023061">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8023071">if</span>&nbsp;<span class="op" id="8023074">!</span><span class="ident" id="8023075">ok</span>&nbsp;<span class="op" id="8023078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8023084">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023101">key</span><span class="op" id="8023104">.</span><span class="ident" id="8023105">N</span>&nbsp;<span class="op" id="8023107">=</span>&nbsp;<span class="ident" id="8023109">bigFromHex</span><span class="op" id="8023119">(</span><span class="ident" id="8023120">nHex</span><span class="op" id="8023124">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023129">key</span><span class="op" id="8023132">.</span><span class="ident" id="8023133">E</span>&nbsp;<span class="op" id="8023135">=</span>&nbsp;<span class="ident" id="8023137">intFromHex</span><span class="op" id="8023147">(</span><span class="op" id="8023148">&lt;-</span><span class="ident" id="8023150">values</span><span class="op" id="8023156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8023161">//&nbsp;We&nbsp;don&#39;t&nbsp;care&nbsp;for&nbsp;d,&nbsp;p,&nbsp;q,&nbsp;dP,&nbsp;dQ&nbsp;or&nbsp;qInv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8023210">for</span>&nbsp;<span class="ident" id="8023214">i</span>&nbsp;<span class="op" id="8023216">:=</span>&nbsp;<span class="num" id="8023219">0</span><span class="op" id="8023220">;</span>&nbsp;<span class="ident" id="8023222">i</span>&nbsp;<span class="op" id="8023224">&lt;</span>&nbsp;<span class="num" id="8023226">6</span><span class="op" id="8023227">;</span>&nbsp;<span class="ident" id="8023229">i</span><span class="op" id="8023230">++</span>&nbsp;<span class="op" id="8023233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023239">&lt;-</span><span class="ident" id="8023241">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023251">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8023255">case</span>&nbsp;<span class="ident" id="8023260">newSignatureMarker</span><span class="op" id="8023278">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023283">msg</span>&nbsp;<span class="op" id="8023287">:=</span>&nbsp;<span class="ident" id="8023290">fromHex</span><span class="op" id="8023297">(</span><span class="op" id="8023298">&lt;-</span><span class="ident" id="8023300">values</span><span class="op" id="8023306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023311">&lt;-</span><span class="ident" id="8023313">values</span>&nbsp;<span class="comment" id="8023320">//&nbsp;skip&nbsp;salt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023336">sig</span>&nbsp;<span class="op" id="8023340">:=</span>&nbsp;<span class="ident" id="8023343">fromHex</span><span class="op" id="8023350">(</span><span class="op" id="8023351">&lt;-</span><span class="ident" id="8023353">values</span><span class="op" id="8023359">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023365">h</span><span class="op" id="8023366">.</span><span class="ident" id="8023367">Reset</span><span class="op" id="8023372">(</span><span class="op" id="8023373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023378">h</span><span class="op" id="8023379">.</span><span class="ident" id="8023380">Write</span><span class="op" id="8023385">(</span><span class="ident" id="8023386">msg</span><span class="op" id="8023389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023394">hashed</span>&nbsp;<span class="op" id="8023401">=</span>&nbsp;<span class="ident" id="8023403">h</span><span class="op" id="8023404">.</span><span class="ident" id="8023405">Sum</span><span class="op" id="8023408">(</span><span class="ident" id="8023409">hashed</span><span class="op" id="8023415">[</span><span class="op" id="8023416">:</span><span class="num" id="8023417">0</span><span class="op" id="8023418">]</span><span class="op" id="8023419">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8023425">if</span>&nbsp;<span class="ident" id="8023428">err</span>&nbsp;<span class="op" id="8023432">:=</span>&nbsp;<span class="ident" id="8023435">VerifyPSS</span><span class="op" id="8023444">(</span><span class="ident" id="8023445">key</span><span class="op" id="8023448">,</span>&nbsp;<span class="ident" id="8023450">hash</span><span class="op" id="8023454">,</span>&nbsp;<span class="ident" id="8023456">hashed</span><span class="op" id="8023462">,</span>&nbsp;<span class="ident" id="8023464">sig</span><span class="op" id="8023467">,</span>&nbsp;<span class="ident" id="8023469">opts</span><span class="op" id="8023473">)</span><span class="op" id="8023474">;</span>&nbsp;<span class="ident" id="8023476">err</span>&nbsp;<span class="op" id="8023480">!=</span>&nbsp;<span class="ident" id="8023483">nil</span>&nbsp;<span class="op" id="8023487">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023493">t</span><span class="op" id="8023494">.</span><span class="ident" id="8023495">Error</span><span class="op" id="8023500">(</span><span class="ident" id="8023501">err</span><span class="op" id="8023504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8023513">default</span><span class="op" id="8023520">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023525">t</span><span class="op" id="8023526">.</span><span class="ident" id="8023527">Fatalf</span><span class="op" id="8023533">(</span><span class="string" id="8023534">&#34;unknown&nbsp;marker:&nbsp;&#34;</span>&nbsp;<span class="op" id="8023553">+</span>&nbsp;<span class="ident" id="8023555">marker</span><span class="op" id="8023561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023565">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023568">}</span><br>
<span class="lineno"></span><span class="op" id="8023570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8023573">//&nbsp;TestPSSOpenSSL&nbsp;ensures&nbsp;that&nbsp;we&nbsp;can&nbsp;verify&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;from&nbsp;OpenSSL&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="8023652">//&nbsp;the&nbsp;default&nbsp;options.&nbsp;OpenSSL&nbsp;sets&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;be&nbsp;maximal.</span><br>
<span class="lineno">170</span><span class="keyword" id="8023720">func</span>&nbsp;<span class="ident" id="8023725">TestPSSOpenSSL</span><span class="op" id="8023739">(</span><span class="ident" id="8023740">t</span>&nbsp;<span class="op" id="8023742">*</span><span class="ident" id="8023743">testing</span><span class="op" id="8023750">.</span><span class="ident" id="8023751">T</span><span class="op" id="8023752">)</span>&nbsp;<span class="op" id="8023754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023757">hash</span>&nbsp;<span class="op" id="8023762">:=</span>&nbsp;<span class="ident" id="8023765">crypto</span><span class="op" id="8023771">.</span><span class="ident" id="8023772">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023780">h</span>&nbsp;<span class="op" id="8023782">:=</span>&nbsp;<span class="ident" id="8023785">hash</span><span class="op" id="8023789">.</span><span class="ident" id="8023790">New</span><span class="op" id="8023793">(</span><span class="op" id="8023794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023797">h</span><span class="op" id="8023798">.</span><span class="ident" id="8023799">Write</span><span class="op" id="8023804">(</span><span class="op" id="8023805">[</span><span class="op" id="8023806">]</span><span class="builtintype" id="8023807">byte</span><span class="op" id="8023811">(</span><span class="string" id="8023812">&#34;testing&#34;</span><span class="op" id="8023821">)</span><span class="op" id="8023822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023825">hashed</span>&nbsp;<span class="op" id="8023832">:=</span>&nbsp;<span class="ident" id="8023835">h</span><span class="op" id="8023836">.</span><span class="ident" id="8023837">Sum</span><span class="op" id="8023840">(</span><span class="ident" id="8023841">nil</span><span class="op" id="8023844">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8023848">//&nbsp;Generated&nbsp;with&nbsp;`echo&nbsp;-n&nbsp;testing&nbsp;|&nbsp;openssl&nbsp;dgst&nbsp;-sign&nbsp;key.pem&nbsp;-sigopt&nbsp;rsa_padding_mode:pss&nbsp;-sha256&nbsp;&gt;&nbsp;sig`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023957">sig</span>&nbsp;<span class="op" id="8023961">:=</span>&nbsp;<span class="op" id="8023964">[</span><span class="op" id="8023965">]</span><span class="builtintype" id="8023966">byte</span><span class="op" id="8023970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8023974">0x95</span><span class="op" id="8023978">,</span>&nbsp;<span class="num" id="8023980">0x59</span><span class="op" id="8023984">,</span>&nbsp;<span class="num" id="8023986">0x6f</span><span class="op" id="8023990">,</span>&nbsp;<span class="num" id="8023992">0xd3</span><span class="op" id="8023996">,</span>&nbsp;<span class="num" id="8023998">0x10</span><span class="op" id="8024002">,</span>&nbsp;<span class="num" id="8024004">0xa2</span><span class="op" id="8024008">,</span>&nbsp;<span class="num" id="8024010">0xe7</span><span class="op" id="8024014">,</span>&nbsp;<span class="num" id="8024016">0xa2</span><span class="op" id="8024020">,</span>&nbsp;<span class="num" id="8024022">0x92</span><span class="op" id="8024026">,</span>&nbsp;<span class="num" id="8024028">0x9d</span><span class="op" id="8024032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8024036">0x4a</span><span class="op" id="8024040">,</span>&nbsp;<span class="num" id="8024042">0x07</span><span class="op" id="8024046">,</span>&nbsp;<span class="num" id="8024048">0x2e</span><span class="op" id="8024052">,</span>&nbsp;<span class="num" id="8024054">0x2b</span><span class="op" id="8024058">,</span>&nbsp;<span class="num" id="8024060">0x27</span><span class="op" id="8024064">,</span>&nbsp;<span class="num" id="8024066">0xcc</span><span class="op" id="8024070">,</span>&nbsp;<span class="num" id="8024072">0x06</span><span class="op" id="8024076">,</span>&nbsp;<span class="num" id="8024078">0xc2</span><span class="op" id="8024082">,</span>&nbsp;<span class="num" id="8024084">0x87</span><span class="op" id="8024088">,</span>&nbsp;<span class="num" id="8024090">0x2c</span><span class="op" id="8024094">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8024098">0x52</span><span class="op" id="8024102">,</span>&nbsp;<span class="num" id="8024104">0xf0</span><span class="op" id="8024108">,</span>&nbsp;<span class="num" id="8024110">0x4a</span><span class="op" id="8024114">,</span>&nbsp;<span class="num" id="8024116">0xcc</span><span class="op" id="8024120">,</span>&nbsp;<span class="num" id="8024122">0x05</span><span class="op" id="8024126">,</span>&nbsp;<span class="num" id="8024128">0x94</span><span class="op" id="8024132">,</span>&nbsp;<span class="num" id="8024134">0xf2</span><span class="op" id="8024138">,</span>&nbsp;<span class="num" id="8024140">0xc3</span><span class="op" id="8024144">,</span>&nbsp;<span class="num" id="8024146">0x2e</span><span class="op" id="8024150">,</span>&nbsp;<span class="num" id="8024152">0x20</span><span class="op" id="8024156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8024160">0xd7</span><span class="op" id="8024164">,</span>&nbsp;<span class="num" id="8024166">0x3e</span><span class="op" id="8024170">,</span>&nbsp;<span class="num" id="8024172">0x66</span><span class="op" id="8024176">,</span>&nbsp;<span class="num" id="8024178">0x62</span><span class="op" id="8024182">,</span>&nbsp;<span class="num" id="8024184">0xb5</span><span class="op" id="8024188">,</span>&nbsp;<span class="num" id="8024190">0x95</span><span class="op" id="8024194">,</span>&nbsp;<span class="num" id="8024196">0x2b</span><span class="op" id="8024200">,</span>&nbsp;<span class="num" id="8024202">0xa3</span><span class="op" id="8024206">,</span>&nbsp;<span class="num" id="8024208">0x93</span><span class="op" id="8024212">,</span>&nbsp;<span class="num" id="8024214">0x9a</span><span class="op" id="8024218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8024222">0x66</span><span class="op" id="8024226">,</span>&nbsp;<span class="num" id="8024228">0x64</span><span class="op" id="8024232">,</span>&nbsp;<span class="num" id="8024234">0x25</span><span class="op" id="8024238">,</span>&nbsp;<span class="num" id="8024240">0xe0</span><span class="op" id="8024244">,</span>&nbsp;<span class="num" id="8024246">0x74</span><span class="op" id="8024250">,</span>&nbsp;<span class="num" id="8024252">0x66</span><span class="op" id="8024256">,</span>&nbsp;<span class="num" id="8024258">0x8c</span><span class="op" id="8024262">,</span>&nbsp;<span class="num" id="8024264">0x3e</span><span class="op" id="8024268">,</span>&nbsp;<span class="num" id="8024270">0x92</span><span class="op" id="8024274">,</span>&nbsp;<span class="num" id="8024276">0xeb</span><span class="op" id="8024280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8024284">0xc6</span><span class="op" id="8024288">,</span>&nbsp;<span class="num" id="8024290">0xe6</span><span class="op" id="8024294">,</span>&nbsp;<span class="num" id="8024296">0xc0</span><span class="op" id="8024300">,</span>&nbsp;<span class="num" id="8024302">0x44</span><span class="op" id="8024306">,</span>&nbsp;<span class="num" id="8024308">0xf3</span><span class="op" id="8024312">,</span>&nbsp;<span class="num" id="8024314">0xb4</span><span class="op" id="8024318">,</span>&nbsp;<span class="num" id="8024320">0xb4</span><span class="op" id="8024324">,</span>&nbsp;<span class="num" id="8024326">0x2e</span><span class="op" id="8024330">,</span>&nbsp;<span class="num" id="8024332">0x8c</span><span class="op" id="8024336">,</span>&nbsp;<span class="num" id="8024338">0x66</span><span class="op" id="8024342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8024346">0x0a</span><span class="op" id="8024350">,</span>&nbsp;<span class="num" id="8024352">0x37</span><span class="op" id="8024356">,</span>&nbsp;<span class="num" id="8024358">0x9c</span><span class="op" id="8024362">,</span>&nbsp;<span class="num" id="8024364">0x69</span><span class="op" id="8024368">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8024371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8024375">if</span>&nbsp;<span class="ident" id="8024378">err</span>&nbsp;<span class="op" id="8024382">:=</span>&nbsp;<span class="ident" id="8024385">VerifyPSS</span><span class="op" id="8024394">(</span><span class="op" id="8024395">&amp;</span><span class="ident" id="8024396">rsaPrivateKey</span><span class="op" id="8024409">.</span><span class="ident" id="8024410">PublicKey</span><span class="op" id="8024419">,</span>&nbsp;<span class="ident" id="8024421">hash</span><span class="op" id="8024425">,</span>&nbsp;<span class="ident" id="8024427">hashed</span><span class="op" id="8024433">,</span>&nbsp;<span class="ident" id="8024435">sig</span><span class="op" id="8024438">,</span>&nbsp;<span class="ident" id="8024440">nil</span><span class="op" id="8024443">)</span><span class="op" id="8024444">;</span>&nbsp;<span class="ident" id="8024446">err</span>&nbsp;<span class="op" id="8024450">!=</span>&nbsp;<span class="ident" id="8024453">nil</span>&nbsp;<span class="op" id="8024457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024461">t</span><span class="op" id="8024462">.</span><span class="ident" id="8024463">Error</span><span class="op" id="8024468">(</span><span class="ident" id="8024469">err</span><span class="op" id="8024472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8024475">}</span><br>
<span class="lineno">190</span><span class="op" id="8024477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8024480">func</span>&nbsp;<span class="ident" id="8024485">TestPSSSigning</span><span class="op" id="8024499">(</span><span class="ident" id="8024500">t</span>&nbsp;<span class="op" id="8024502">*</span><span class="ident" id="8024503">testing</span><span class="op" id="8024510">.</span><span class="ident" id="8024511">T</span><span class="op" id="8024512">)</span>&nbsp;<span class="op" id="8024514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8024517">var</span>&nbsp;<span class="ident" id="8024521">saltLengthCombinations</span>&nbsp;<span class="op" id="8024544">=</span>&nbsp;<span class="op" id="8024546">[</span><span class="op" id="8024547">]</span><span class="keyword" id="8024548">struct</span>&nbsp;<span class="op" id="8024555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024559">signSaltLength</span><span class="op" id="8024573">,</span>&nbsp;<span class="ident" id="8024575">verifySaltLength</span>&nbsp;<span class="builtintype" id="8024592">int</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024598">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8024631">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8024637">}</span><span class="op" id="8024638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8024642">{</span><span class="ident" id="8024643">PSSSaltLengthAuto</span><span class="op" id="8024660">,</span>&nbsp;<span class="ident" id="8024662">PSSSaltLengthAuto</span><span class="op" id="8024679">,</span>&nbsp;<span class="builtintype" id="8024681">true</span><span class="op" id="8024685">}</span><span class="op" id="8024686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8024690">{</span><span class="ident" id="8024691">PSSSaltLengthEqualsHash</span><span class="op" id="8024714">,</span>&nbsp;<span class="ident" id="8024716">PSSSaltLengthAuto</span><span class="op" id="8024733">,</span>&nbsp;<span class="builtintype" id="8024735">true</span><span class="op" id="8024739">}</span><span class="op" id="8024740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8024744">{</span><span class="ident" id="8024745">PSSSaltLengthEqualsHash</span><span class="op" id="8024768">,</span>&nbsp;<span class="ident" id="8024770">PSSSaltLengthEqualsHash</span><span class="op" id="8024793">,</span>&nbsp;<span class="builtintype" id="8024795">true</span><span class="op" id="8024799">}</span><span class="op" id="8024800">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8024804">{</span><span class="ident" id="8024805">PSSSaltLengthEqualsHash</span><span class="op" id="8024828">,</span>&nbsp;<span class="num" id="8024830">8</span><span class="op" id="8024831">,</span>&nbsp;<span class="builtintype" id="8024833">false</span><span class="op" id="8024838">}</span><span class="op" id="8024839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8024843">{</span><span class="ident" id="8024844">PSSSaltLengthAuto</span><span class="op" id="8024861">,</span>&nbsp;<span class="ident" id="8024863">PSSSaltLengthEqualsHash</span><span class="op" id="8024886">,</span>&nbsp;<span class="builtintype" id="8024888">false</span><span class="op" id="8024893">}</span><span class="op" id="8024894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8024898">{</span><span class="num" id="8024899">8</span><span class="op" id="8024900">,</span>&nbsp;<span class="num" id="8024902">8</span><span class="op" id="8024903">,</span>&nbsp;<span class="builtintype" id="8024905">true</span><span class="op" id="8024909">}</span><span class="op" id="8024910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8024913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024917">hash</span>&nbsp;<span class="op" id="8024922">:=</span>&nbsp;<span class="ident" id="8024925">crypto</span><span class="op" id="8024931">.</span><span class="ident" id="8024932">MD5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024937">h</span>&nbsp;<span class="op" id="8024939">:=</span>&nbsp;<span class="ident" id="8024942">hash</span><span class="op" id="8024946">.</span><span class="ident" id="8024947">New</span><span class="op" id="8024950">(</span><span class="op" id="8024951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024954">h</span><span class="op" id="8024955">.</span><span class="ident" id="8024956">Write</span><span class="op" id="8024961">(</span><span class="op" id="8024962">[</span><span class="op" id="8024963">]</span><span class="builtintype" id="8024964">byte</span><span class="op" id="8024968">(</span><span class="string" id="8024969">&#34;testing&#34;</span><span class="op" id="8024978">)</span><span class="op" id="8024979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024982">hashed</span>&nbsp;<span class="op" id="8024989">:=</span>&nbsp;<span class="ident" id="8024992">h</span><span class="op" id="8024993">.</span><span class="ident" id="8024994">Sum</span><span class="op" id="8024997">(</span><span class="ident" id="8024998">nil</span><span class="op" id="8025001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8025004">var</span>&nbsp;<span class="ident" id="8025008">opts</span>&nbsp;<span class="ident" id="8025013">PSSOptions</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8025026">for</span>&nbsp;<span class="ident" id="8025030">i</span><span class="op" id="8025031">,</span>&nbsp;<span class="ident" id="8025033">test</span>&nbsp;<span class="op" id="8025038">:=</span>&nbsp;<span class="keyword" id="8025041">range</span>&nbsp;<span class="ident" id="8025047">saltLengthCombinations</span>&nbsp;<span class="op" id="8025070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025074">opts</span><span class="op" id="8025078">.</span><span class="ident" id="8025079">SaltLength</span>&nbsp;<span class="op" id="8025090">=</span>&nbsp;<span class="ident" id="8025092">test</span><span class="op" id="8025096">.</span><span class="ident" id="8025097">signSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025114">sig</span><span class="op" id="8025117">,</span>&nbsp;<span class="ident" id="8025119">err</span>&nbsp;<span class="op" id="8025123">:=</span>&nbsp;<span class="ident" id="8025126">SignPSS</span><span class="op" id="8025133">(</span><span class="ident" id="8025134">rand</span><span class="op" id="8025138">.</span><span class="ident" id="8025139">Reader</span><span class="op" id="8025145">,</span>&nbsp;<span class="ident" id="8025147">rsaPrivateKey</span><span class="op" id="8025160">,</span>&nbsp;<span class="ident" id="8025162">hash</span><span class="op" id="8025166">,</span>&nbsp;<span class="ident" id="8025168">hashed</span><span class="op" id="8025174">,</span>&nbsp;<span class="op" id="8025176">&amp;</span><span class="ident" id="8025177">opts</span><span class="op" id="8025181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8025185">if</span>&nbsp;<span class="ident" id="8025188">err</span>&nbsp;<span class="op" id="8025192">!=</span>&nbsp;<span class="ident" id="8025195">nil</span>&nbsp;<span class="op" id="8025199">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025204">t</span><span class="op" id="8025205">.</span><span class="ident" id="8025206">Errorf</span><span class="op" id="8025212">(</span><span class="string" id="8025213">&#34;#%d:&nbsp;error&nbsp;while&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="8025243">,</span>&nbsp;<span class="ident" id="8025245">i</span><span class="op" id="8025246">,</span>&nbsp;<span class="ident" id="8025248">err</span><span class="op" id="8025251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8025256">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8025267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025272">opts</span><span class="op" id="8025276">.</span><span class="ident" id="8025277">SaltLength</span>&nbsp;<span class="op" id="8025288">=</span>&nbsp;<span class="ident" id="8025290">test</span><span class="op" id="8025294">.</span><span class="ident" id="8025295">verifySaltLength</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025314">err</span>&nbsp;<span class="op" id="8025318">=</span>&nbsp;<span class="ident" id="8025320">VerifyPSS</span><span class="op" id="8025329">(</span><span class="op" id="8025330">&amp;</span><span class="ident" id="8025331">rsaPrivateKey</span><span class="op" id="8025344">.</span><span class="ident" id="8025345">PublicKey</span><span class="op" id="8025354">,</span>&nbsp;<span class="ident" id="8025356">hash</span><span class="op" id="8025360">,</span>&nbsp;<span class="ident" id="8025362">hashed</span><span class="op" id="8025368">,</span>&nbsp;<span class="ident" id="8025370">sig</span><span class="op" id="8025373">,</span>&nbsp;<span class="op" id="8025375">&amp;</span><span class="ident" id="8025376">opts</span><span class="op" id="8025380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8025384">if</span>&nbsp;<span class="op" id="8025387">(</span><span class="ident" id="8025388">err</span>&nbsp;<span class="op" id="8025392">==</span>&nbsp;<span class="ident" id="8025395">nil</span><span class="op" id="8025398">)</span>&nbsp;<span class="op" id="8025400">!=</span>&nbsp;<span class="ident" id="8025403">test</span><span class="op" id="8025407">.</span><span class="ident" id="8025408">good</span>&nbsp;<span class="op" id="8025413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025418">t</span><span class="op" id="8025419">.</span><span class="ident" id="8025420">Errorf</span><span class="op" id="8025426">(</span><span class="string" id="8025427">&#34;#%d:&nbsp;bad&nbsp;result,&nbsp;wanted:&nbsp;%t,&nbsp;got:&nbsp;%s&#34;</span><span class="op" id="8025465">,</span>&nbsp;<span class="ident" id="8025467">i</span><span class="op" id="8025468">,</span>&nbsp;<span class="ident" id="8025470">test</span><span class="op" id="8025474">.</span><span class="ident" id="8025475">good</span><span class="op" id="8025479">,</span>&nbsp;<span class="ident" id="8025481">err</span><span class="op" id="8025484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8025488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8025491">}</span><br>
<span class="lineno">225</span><span class="op" id="8025493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8025496">func</span>&nbsp;<span class="ident" id="8025501">bigFromHex</span><span class="op" id="8025511">(</span><span class="ident" id="8025512">hex</span>&nbsp;<span class="builtintype" id="8025516">string</span><span class="op" id="8025522">)</span>&nbsp;<span class="op" id="8025524">*</span><span class="ident" id="8025525">big</span><span class="op" id="8025528">.</span><span class="ident" id="8025529">Int</span>&nbsp;<span class="op" id="8025533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025536">n</span><span class="op" id="8025537">,</span>&nbsp;<span class="ident" id="8025539">ok</span>&nbsp;<span class="op" id="8025542">:=</span>&nbsp;<span class="builtinfunc" id="8025545">new</span><span class="op" id="8025548">(</span><span class="ident" id="8025549">big</span><span class="op" id="8025552">.</span><span class="ident" id="8025553">Int</span><span class="op" id="8025556">)</span><span class="op" id="8025557">.</span><span class="ident" id="8025558">SetString</span><span class="op" id="8025567">(</span><span class="ident" id="8025568">hex</span><span class="op" id="8025571">,</span>&nbsp;<span class="num" id="8025573">16</span><span class="op" id="8025575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8025578">if</span>&nbsp;<span class="op" id="8025581">!</span><span class="ident" id="8025582">ok</span>&nbsp;<span class="op" id="8025585">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8025589">panic</span><span class="op" id="8025594">(</span><span class="string" id="8025595">&#34;bad&nbsp;hex:&nbsp;&#34;</span>&nbsp;<span class="op" id="8025607">+</span>&nbsp;<span class="ident" id="8025609">hex</span><span class="op" id="8025612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8025615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8025618">return</span>&nbsp;<span class="ident" id="8025625">n</span><br>
<span class="lineno"></span><span class="op" id="8025627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="8025630">func</span>&nbsp;<span class="ident" id="8025635">intFromHex</span><span class="op" id="8025645">(</span><span class="ident" id="8025646">hex</span>&nbsp;<span class="builtintype" id="8025650">string</span><span class="op" id="8025656">)</span>&nbsp;<span class="builtintype" id="8025658">int</span>&nbsp;<span class="op" id="8025662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025665">i</span><span class="op" id="8025666">,</span>&nbsp;<span class="ident" id="8025668">err</span>&nbsp;<span class="op" id="8025672">:=</span>&nbsp;<span class="ident" id="8025675">strconv</span><span class="op" id="8025682">.</span><span class="ident" id="8025683">ParseInt</span><span class="op" id="8025691">(</span><span class="ident" id="8025692">hex</span><span class="op" id="8025695">,</span>&nbsp;<span class="num" id="8025697">16</span><span class="op" id="8025699">,</span>&nbsp;<span class="num" id="8025701">32</span><span class="op" id="8025703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8025706">if</span>&nbsp;<span class="ident" id="8025709">err</span>&nbsp;<span class="op" id="8025713">!=</span>&nbsp;<span class="ident" id="8025716">nil</span>&nbsp;<span class="op" id="8025720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8025724">panic</span><span class="op" id="8025729">(</span><span class="ident" id="8025730">err</span><span class="op" id="8025733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8025736">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8025739">return</span>&nbsp;<span class="builtintype" id="8025746">int</span><span class="op" id="8025749">(</span><span class="ident" id="8025750">i</span><span class="op" id="8025751">)</span><br>
<span class="lineno"></span><span class="op" id="8025753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8025756">func</span>&nbsp;<span class="ident" id="8025761">fromHex</span><span class="op" id="8025768">(</span><span class="ident" id="8025769">hexStr</span>&nbsp;<span class="builtintype" id="8025776">string</span><span class="op" id="8025782">)</span>&nbsp;<span class="op" id="8025784">[</span><span class="op" id="8025785">]</span><span class="builtintype" id="8025786">byte</span>&nbsp;<span class="op" id="8025791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025794">s</span><span class="op" id="8025795">,</span>&nbsp;<span class="ident" id="8025797">err</span>&nbsp;<span class="op" id="8025801">:=</span>&nbsp;<span class="ident" id="8025804">hex</span><span class="op" id="8025807">.</span><span class="ident" id="8025808">DecodeString</span><span class="op" id="8025820">(</span><span class="ident" id="8025821">hexStr</span><span class="op" id="8025827">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8025830">if</span>&nbsp;<span class="ident" id="8025833">err</span>&nbsp;<span class="op" id="8025837">!=</span>&nbsp;<span class="ident" id="8025840">nil</span>&nbsp;<span class="op" id="8025844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8025848">panic</span><span class="op" id="8025853">(</span><span class="ident" id="8025854">err</span><span class="op" id="8025857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8025860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8025863">return</span>&nbsp;<span class="ident" id="8025870">s</span><br>
<span class="lineno"></span><span class="op" id="8025872">}</span>
</div>
</body>
</html>
