<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html" class="current">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3852741">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3852796">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3852850">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3852901">package</span>&nbsp;<span class="ident" id="3852909">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3852914">import</span>&nbsp;<span class="op" id="3852921">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3852924">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3852938">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3852955">&#34;crypto/des&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3852969">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3852984">&#34;crypto/rc4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3852998">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3853013">&#34;crypto/x509&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3853028">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="3853035">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3853038">//&nbsp;a&nbsp;keyAgreement&nbsp;implements&nbsp;the&nbsp;client&nbsp;and&nbsp;server&nbsp;side&nbsp;of&nbsp;a&nbsp;TLS&nbsp;key&nbsp;agreement</span><br>
<span class="lineno"></span><span class="comment" id="3853117">//&nbsp;protocol&nbsp;by&nbsp;generating&nbsp;and&nbsp;processing&nbsp;key&nbsp;exchange&nbsp;messages.</span><br>
<span class="lineno">20</span><span class="keyword" id="3853181">type</span>&nbsp;<span class="ident" id="3853186">keyAgreement</span>&nbsp;<span class="keyword" id="3853199">interface</span>&nbsp;<span class="op" id="3853209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3853212">//&nbsp;On&nbsp;the&nbsp;server&nbsp;side,&nbsp;the&nbsp;first&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3853280">//&nbsp;In&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;key&nbsp;agreement&nbsp;protocol&nbsp;doesn&#39;t&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3853342">//&nbsp;ServerKeyExchange&nbsp;message,&nbsp;generateServerKeyExchange&nbsp;can&nbsp;return&nbsp;nil,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3853415">//&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3853424">generateServerKeyExchange</span><span class="op" id="3853449">(</span><span class="op" id="3853450">*</span><span class="ident" id="3853451">Config</span><span class="op" id="3853457">,</span>&nbsp;<span class="op" id="3853459">*</span><span class="ident" id="3853460">Certificate</span><span class="op" id="3853471">,</span>&nbsp;<span class="op" id="3853473">*</span><span class="ident" id="3853474">clientHelloMsg</span><span class="op" id="3853488">,</span>&nbsp;<span class="op" id="3853490">*</span><span class="ident" id="3853491">serverHelloMsg</span><span class="op" id="3853505">)</span>&nbsp;<span class="op" id="3853507">(</span><span class="op" id="3853508">*</span><span class="ident" id="3853509">serverKeyExchangeMsg</span><span class="op" id="3853529">,</span>&nbsp;<span class="builtintype" id="3853531">error</span><span class="op" id="3853536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3853539">processClientKeyExchange</span><span class="op" id="3853563">(</span><span class="op" id="3853564">*</span><span class="ident" id="3853565">Config</span><span class="op" id="3853571">,</span>&nbsp;<span class="op" id="3853573">*</span><span class="ident" id="3853574">Certificate</span><span class="op" id="3853585">,</span>&nbsp;<span class="op" id="3853587">*</span><span class="ident" id="3853588">clientKeyExchangeMsg</span><span class="op" id="3853608">,</span>&nbsp;<span class="builtintype" id="3853610">uint16</span><span class="op" id="3853616">)</span>&nbsp;<span class="op" id="3853618">(</span><span class="op" id="3853619">[</span><span class="op" id="3853620">]</span><span class="builtintype" id="3853621">byte</span><span class="op" id="3853625">,</span>&nbsp;<span class="builtintype" id="3853627">error</span><span class="op" id="3853632">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3853636">//&nbsp;On&nbsp;the&nbsp;client&nbsp;side,&nbsp;the&nbsp;next&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3853703">//&nbsp;This&nbsp;method&nbsp;may&nbsp;not&nbsp;be&nbsp;called&nbsp;if&nbsp;the&nbsp;server&nbsp;doesn&#39;t&nbsp;send&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3853766">//&nbsp;ServerKeyExchange&nbsp;message.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3853797">processServerKeyExchange</span><span class="op" id="3853821">(</span><span class="op" id="3853822">*</span><span class="ident" id="3853823">Config</span><span class="op" id="3853829">,</span>&nbsp;<span class="op" id="3853831">*</span><span class="ident" id="3853832">clientHelloMsg</span><span class="op" id="3853846">,</span>&nbsp;<span class="op" id="3853848">*</span><span class="ident" id="3853849">serverHelloMsg</span><span class="op" id="3853863">,</span>&nbsp;<span class="op" id="3853865">*</span><span class="ident" id="3853866">x509</span><span class="op" id="3853870">.</span><span class="ident" id="3853871">Certificate</span><span class="op" id="3853882">,</span>&nbsp;<span class="op" id="3853884">*</span><span class="ident" id="3853885">serverKeyExchangeMsg</span><span class="op" id="3853905">)</span>&nbsp;<span class="builtintype" id="3853907">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3853914">generateClientKeyExchange</span><span class="op" id="3853939">(</span><span class="op" id="3853940">*</span><span class="ident" id="3853941">Config</span><span class="op" id="3853947">,</span>&nbsp;<span class="op" id="3853949">*</span><span class="ident" id="3853950">clientHelloMsg</span><span class="op" id="3853964">,</span>&nbsp;<span class="op" id="3853966">*</span><span class="ident" id="3853967">x509</span><span class="op" id="3853971">.</span><span class="ident" id="3853972">Certificate</span><span class="op" id="3853983">)</span>&nbsp;<span class="op" id="3853985">(</span><span class="op" id="3853986">[</span><span class="op" id="3853987">]</span><span class="builtintype" id="3853988">byte</span><span class="op" id="3853992">,</span>&nbsp;<span class="op" id="3853994">*</span><span class="ident" id="3853995">clientKeyExchangeMsg</span><span class="op" id="3854015">,</span>&nbsp;<span class="builtintype" id="3854017">error</span><span class="op" id="3854022">)</span><br>
<span class="lineno">35</span><span class="op" id="3854024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3854027">const</span>&nbsp;<span class="op" id="3854033">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3854036">//&nbsp;suiteECDH&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3854106">//&nbsp;Diffie-Hellman.&nbsp;This&nbsp;means&nbsp;that&nbsp;it&nbsp;should&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3854178">//&nbsp;client&nbsp;indicates&nbsp;that&nbsp;it&nbsp;supports&nbsp;ECC&nbsp;with&nbsp;a&nbsp;curve&nbsp;and&nbsp;point&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3854250">//&nbsp;that&nbsp;we&#39;re&nbsp;happy&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3854277">suiteECDHE</span>&nbsp;<span class="op" id="3854288">=</span>&nbsp;<span class="num" id="3854290">1</span>&nbsp;<span class="op" id="3854292">&lt;&lt;</span>&nbsp;<span class="ident" id="3854295">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3854301">//&nbsp;suiteECDSA&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;an&nbsp;ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3854366">//&nbsp;signature&nbsp;and&nbsp;therefore&nbsp;may&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the&nbsp;server&#39;s</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3854433">//&nbsp;certificate&nbsp;is&nbsp;ECDSA.&nbsp;If&nbsp;this&nbsp;is&nbsp;not&nbsp;set&nbsp;then&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3854503">//&nbsp;RSA&nbsp;based.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3854518">suiteECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3854530">//&nbsp;suiteTLS12&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;should&nbsp;only&nbsp;be&nbsp;advertised</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3854603">//&nbsp;and&nbsp;accepted&nbsp;when&nbsp;using&nbsp;TLS&nbsp;1.2.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3854640">suiteTLS12</span><br>
<span class="lineno"></span><span class="op" id="3854651">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3854654">//&nbsp;A&nbsp;cipherSuite&nbsp;is&nbsp;a&nbsp;specific&nbsp;combination&nbsp;of&nbsp;key&nbsp;agreement,&nbsp;cipher&nbsp;and&nbsp;MAC</span><br>
<span class="lineno"></span><span class="comment" id="3854730">//&nbsp;function.&nbsp;All&nbsp;cipher&nbsp;suites&nbsp;currently&nbsp;assume&nbsp;RSA&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno">55</span><span class="keyword" id="3854797">type</span>&nbsp;<span class="ident" id="3854802">cipherSuite</span>&nbsp;<span class="keyword" id="3854814">struct</span>&nbsp;<span class="op" id="3854821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3854824">id</span>&nbsp;<span class="builtintype" id="3854827">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3854835">//&nbsp;the&nbsp;lengths,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;the&nbsp;key&nbsp;material&nbsp;needed&nbsp;for&nbsp;each&nbsp;component.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3854909">keyLen</span>&nbsp;<span class="builtintype" id="3854916">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3854921">macLen</span>&nbsp;<span class="builtintype" id="3854928">int</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3854933">ivLen</span>&nbsp;&nbsp;<span class="builtintype" id="3854940">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3854945">ka</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3854952">func</span><span class="op" id="3854956">(</span><span class="ident" id="3854957">version</span>&nbsp;<span class="builtintype" id="3854965">uint16</span><span class="op" id="3854971">)</span>&nbsp;<span class="ident" id="3854973">keyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3854987">//&nbsp;flags&nbsp;is&nbsp;a&nbsp;bitmask&nbsp;of&nbsp;the&nbsp;suite*&nbsp;values,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3855039">flags</span>&nbsp;&nbsp;<span class="builtintype" id="3855046">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3855051">cipher</span>&nbsp;<span class="keyword" id="3855058">func</span><span class="op" id="3855062">(</span><span class="ident" id="3855063">key</span><span class="op" id="3855066">,</span>&nbsp;<span class="ident" id="3855068">iv</span>&nbsp;<span class="op" id="3855071">[</span><span class="op" id="3855072">]</span><span class="builtintype" id="3855073">byte</span><span class="op" id="3855077">,</span>&nbsp;<span class="ident" id="3855079">isRead</span>&nbsp;<span class="builtintype" id="3855086">bool</span><span class="op" id="3855090">)</span>&nbsp;<span class="keyword" id="3855092">interface</span><span class="op" id="3855101">{</span><span class="op" id="3855102">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3855105">mac</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3855112">func</span><span class="op" id="3855116">(</span><span class="ident" id="3855117">version</span>&nbsp;<span class="builtintype" id="3855125">uint16</span><span class="op" id="3855131">,</span>&nbsp;<span class="ident" id="3855133">macKey</span>&nbsp;<span class="op" id="3855140">[</span><span class="op" id="3855141">]</span><span class="builtintype" id="3855142">byte</span><span class="op" id="3855146">)</span>&nbsp;<span class="ident" id="3855148">macFunction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3855161">aead</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3855168">func</span><span class="op" id="3855172">(</span><span class="ident" id="3855173">key</span><span class="op" id="3855176">,</span>&nbsp;<span class="ident" id="3855178">fixedNonce</span>&nbsp;<span class="op" id="3855189">[</span><span class="op" id="3855190">]</span><span class="builtintype" id="3855191">byte</span><span class="op" id="3855195">)</span>&nbsp;<span class="ident" id="3855197">cipher</span><span class="op" id="3855203">.</span><span class="ident" id="3855204">AEAD</span><br>
<span class="lineno"></span><span class="op" id="3855209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3855212">var</span>&nbsp;<span class="ident" id="3855216">cipherSuites</span>&nbsp;<span class="op" id="3855229">=</span>&nbsp;<span class="op" id="3855231">[</span><span class="op" id="3855232">]</span><span class="op" id="3855233">*</span><span class="ident" id="3855234">cipherSuite</span><span class="op" id="3855245">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3855248">//&nbsp;Ciphersuite&nbsp;order&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;ECDHE&nbsp;comes&nbsp;before&nbsp;plain&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3855317">//&nbsp;and&nbsp;RC4&nbsp;comes&nbsp;before&nbsp;AES&nbsp;(because&nbsp;of&nbsp;the&nbsp;Lucky13&nbsp;attack).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3855379">{</span><span class="ident" id="3855380">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="3855417">,</span>&nbsp;<span class="num" id="3855419">16</span><span class="op" id="3855421">,</span>&nbsp;<span class="num" id="3855423">0</span><span class="op" id="3855424">,</span>&nbsp;<span class="num" id="3855426">4</span><span class="op" id="3855427">,</span>&nbsp;<span class="ident" id="3855429">ecdheRSAKA</span><span class="op" id="3855439">,</span>&nbsp;<span class="ident" id="3855441">suiteECDHE</span>&nbsp;<span class="op" id="3855452">|</span>&nbsp;<span class="ident" id="3855454">suiteTLS12</span><span class="op" id="3855464">,</span>&nbsp;<span class="ident" id="3855466">nil</span><span class="op" id="3855469">,</span>&nbsp;<span class="ident" id="3855471">nil</span><span class="op" id="3855474">,</span>&nbsp;<span class="ident" id="3855476">aeadAESGCM</span><span class="op" id="3855486">}</span><span class="op" id="3855487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3855490">{</span><span class="ident" id="3855491">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="3855530">,</span>&nbsp;<span class="num" id="3855532">16</span><span class="op" id="3855534">,</span>&nbsp;<span class="num" id="3855536">0</span><span class="op" id="3855537">,</span>&nbsp;<span class="num" id="3855539">4</span><span class="op" id="3855540">,</span>&nbsp;<span class="ident" id="3855542">ecdheECDSAKA</span><span class="op" id="3855554">,</span>&nbsp;<span class="ident" id="3855556">suiteECDHE</span>&nbsp;<span class="op" id="3855567">|</span>&nbsp;<span class="ident" id="3855569">suiteECDSA</span>&nbsp;<span class="op" id="3855580">|</span>&nbsp;<span class="ident" id="3855582">suiteTLS12</span><span class="op" id="3855592">,</span>&nbsp;<span class="ident" id="3855594">nil</span><span class="op" id="3855597">,</span>&nbsp;<span class="ident" id="3855599">nil</span><span class="op" id="3855602">,</span>&nbsp;<span class="ident" id="3855604">aeadAESGCM</span><span class="op" id="3855614">}</span><span class="op" id="3855615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3855618">{</span><span class="ident" id="3855619">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span><span class="op" id="3855649">,</span>&nbsp;<span class="num" id="3855651">16</span><span class="op" id="3855653">,</span>&nbsp;<span class="num" id="3855655">20</span><span class="op" id="3855657">,</span>&nbsp;<span class="num" id="3855659">0</span><span class="op" id="3855660">,</span>&nbsp;<span class="ident" id="3855662">ecdheRSAKA</span><span class="op" id="3855672">,</span>&nbsp;<span class="ident" id="3855674">suiteECDHE</span><span class="op" id="3855684">,</span>&nbsp;<span class="ident" id="3855686">cipherRC4</span><span class="op" id="3855695">,</span>&nbsp;<span class="ident" id="3855697">macSHA1</span><span class="op" id="3855704">,</span>&nbsp;<span class="ident" id="3855706">nil</span><span class="op" id="3855709">}</span><span class="op" id="3855710">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3855713">{</span><span class="ident" id="3855714">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span><span class="op" id="3855746">,</span>&nbsp;<span class="num" id="3855748">16</span><span class="op" id="3855750">,</span>&nbsp;<span class="num" id="3855752">20</span><span class="op" id="3855754">,</span>&nbsp;<span class="num" id="3855756">0</span><span class="op" id="3855757">,</span>&nbsp;<span class="ident" id="3855759">ecdheECDSAKA</span><span class="op" id="3855771">,</span>&nbsp;<span class="ident" id="3855773">suiteECDHE</span>&nbsp;<span class="op" id="3855784">|</span>&nbsp;<span class="ident" id="3855786">suiteECDSA</span><span class="op" id="3855796">,</span>&nbsp;<span class="ident" id="3855798">cipherRC4</span><span class="op" id="3855807">,</span>&nbsp;<span class="ident" id="3855809">macSHA1</span><span class="op" id="3855816">,</span>&nbsp;<span class="ident" id="3855818">nil</span><span class="op" id="3855821">}</span><span class="op" id="3855822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3855825">{</span><span class="ident" id="3855826">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3855860">,</span>&nbsp;<span class="num" id="3855862">16</span><span class="op" id="3855864">,</span>&nbsp;<span class="num" id="3855866">20</span><span class="op" id="3855868">,</span>&nbsp;<span class="num" id="3855870">16</span><span class="op" id="3855872">,</span>&nbsp;<span class="ident" id="3855874">ecdheRSAKA</span><span class="op" id="3855884">,</span>&nbsp;<span class="ident" id="3855886">suiteECDHE</span><span class="op" id="3855896">,</span>&nbsp;<span class="ident" id="3855898">cipherAES</span><span class="op" id="3855907">,</span>&nbsp;<span class="ident" id="3855909">macSHA1</span><span class="op" id="3855916">,</span>&nbsp;<span class="ident" id="3855918">nil</span><span class="op" id="3855921">}</span><span class="op" id="3855922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3855925">{</span><span class="ident" id="3855926">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3855962">,</span>&nbsp;<span class="num" id="3855964">16</span><span class="op" id="3855966">,</span>&nbsp;<span class="num" id="3855968">20</span><span class="op" id="3855970">,</span>&nbsp;<span class="num" id="3855972">16</span><span class="op" id="3855974">,</span>&nbsp;<span class="ident" id="3855976">ecdheECDSAKA</span><span class="op" id="3855988">,</span>&nbsp;<span class="ident" id="3855990">suiteECDHE</span>&nbsp;<span class="op" id="3856001">|</span>&nbsp;<span class="ident" id="3856003">suiteECDSA</span><span class="op" id="3856013">,</span>&nbsp;<span class="ident" id="3856015">cipherAES</span><span class="op" id="3856024">,</span>&nbsp;<span class="ident" id="3856026">macSHA1</span><span class="op" id="3856033">,</span>&nbsp;<span class="ident" id="3856035">nil</span><span class="op" id="3856038">}</span><span class="op" id="3856039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3856042">{</span><span class="ident" id="3856043">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3856077">,</span>&nbsp;<span class="num" id="3856079">32</span><span class="op" id="3856081">,</span>&nbsp;<span class="num" id="3856083">20</span><span class="op" id="3856085">,</span>&nbsp;<span class="num" id="3856087">16</span><span class="op" id="3856089">,</span>&nbsp;<span class="ident" id="3856091">ecdheRSAKA</span><span class="op" id="3856101">,</span>&nbsp;<span class="ident" id="3856103">suiteECDHE</span><span class="op" id="3856113">,</span>&nbsp;<span class="ident" id="3856115">cipherAES</span><span class="op" id="3856124">,</span>&nbsp;<span class="ident" id="3856126">macSHA1</span><span class="op" id="3856133">,</span>&nbsp;<span class="ident" id="3856135">nil</span><span class="op" id="3856138">}</span><span class="op" id="3856139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3856142">{</span><span class="ident" id="3856143">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3856179">,</span>&nbsp;<span class="num" id="3856181">32</span><span class="op" id="3856183">,</span>&nbsp;<span class="num" id="3856185">20</span><span class="op" id="3856187">,</span>&nbsp;<span class="num" id="3856189">16</span><span class="op" id="3856191">,</span>&nbsp;<span class="ident" id="3856193">ecdheECDSAKA</span><span class="op" id="3856205">,</span>&nbsp;<span class="ident" id="3856207">suiteECDHE</span>&nbsp;<span class="op" id="3856218">|</span>&nbsp;<span class="ident" id="3856220">suiteECDSA</span><span class="op" id="3856230">,</span>&nbsp;<span class="ident" id="3856232">cipherAES</span><span class="op" id="3856241">,</span>&nbsp;<span class="ident" id="3856243">macSHA1</span><span class="op" id="3856250">,</span>&nbsp;<span class="ident" id="3856252">nil</span><span class="op" id="3856255">}</span><span class="op" id="3856256">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3856259">{</span><span class="ident" id="3856260">TLS_RSA_WITH_RC4_128_SHA</span><span class="op" id="3856284">,</span>&nbsp;<span class="num" id="3856286">16</span><span class="op" id="3856288">,</span>&nbsp;<span class="num" id="3856290">20</span><span class="op" id="3856292">,</span>&nbsp;<span class="num" id="3856294">0</span><span class="op" id="3856295">,</span>&nbsp;<span class="ident" id="3856297">rsaKA</span><span class="op" id="3856302">,</span>&nbsp;<span class="num" id="3856304">0</span><span class="op" id="3856305">,</span>&nbsp;<span class="ident" id="3856307">cipherRC4</span><span class="op" id="3856316">,</span>&nbsp;<span class="ident" id="3856318">macSHA1</span><span class="op" id="3856325">,</span>&nbsp;<span class="ident" id="3856327">nil</span><span class="op" id="3856330">}</span><span class="op" id="3856331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3856334">{</span><span class="ident" id="3856335">TLS_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3856363">,</span>&nbsp;<span class="num" id="3856365">16</span><span class="op" id="3856367">,</span>&nbsp;<span class="num" id="3856369">20</span><span class="op" id="3856371">,</span>&nbsp;<span class="num" id="3856373">16</span><span class="op" id="3856375">,</span>&nbsp;<span class="ident" id="3856377">rsaKA</span><span class="op" id="3856382">,</span>&nbsp;<span class="num" id="3856384">0</span><span class="op" id="3856385">,</span>&nbsp;<span class="ident" id="3856387">cipherAES</span><span class="op" id="3856396">,</span>&nbsp;<span class="ident" id="3856398">macSHA1</span><span class="op" id="3856405">,</span>&nbsp;<span class="ident" id="3856407">nil</span><span class="op" id="3856410">}</span><span class="op" id="3856411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3856414">{</span><span class="ident" id="3856415">TLS_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3856443">,</span>&nbsp;<span class="num" id="3856445">32</span><span class="op" id="3856447">,</span>&nbsp;<span class="num" id="3856449">20</span><span class="op" id="3856451">,</span>&nbsp;<span class="num" id="3856453">16</span><span class="op" id="3856455">,</span>&nbsp;<span class="ident" id="3856457">rsaKA</span><span class="op" id="3856462">,</span>&nbsp;<span class="num" id="3856464">0</span><span class="op" id="3856465">,</span>&nbsp;<span class="ident" id="3856467">cipherAES</span><span class="op" id="3856476">,</span>&nbsp;<span class="ident" id="3856478">macSHA1</span><span class="op" id="3856485">,</span>&nbsp;<span class="ident" id="3856487">nil</span><span class="op" id="3856490">}</span><span class="op" id="3856491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3856494">{</span><span class="ident" id="3856495">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="3856530">,</span>&nbsp;<span class="num" id="3856532">24</span><span class="op" id="3856534">,</span>&nbsp;<span class="num" id="3856536">20</span><span class="op" id="3856538">,</span>&nbsp;<span class="num" id="3856540">8</span><span class="op" id="3856541">,</span>&nbsp;<span class="ident" id="3856543">ecdheRSAKA</span><span class="op" id="3856553">,</span>&nbsp;<span class="ident" id="3856555">suiteECDHE</span><span class="op" id="3856565">,</span>&nbsp;<span class="ident" id="3856567">cipher3DES</span><span class="op" id="3856577">,</span>&nbsp;<span class="ident" id="3856579">macSHA1</span><span class="op" id="3856586">,</span>&nbsp;<span class="ident" id="3856588">nil</span><span class="op" id="3856591">}</span><span class="op" id="3856592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3856595">{</span><span class="ident" id="3856596">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="3856625">,</span>&nbsp;<span class="num" id="3856627">24</span><span class="op" id="3856629">,</span>&nbsp;<span class="num" id="3856631">20</span><span class="op" id="3856633">,</span>&nbsp;<span class="num" id="3856635">8</span><span class="op" id="3856636">,</span>&nbsp;<span class="ident" id="3856638">rsaKA</span><span class="op" id="3856643">,</span>&nbsp;<span class="num" id="3856645">0</span><span class="op" id="3856646">,</span>&nbsp;<span class="ident" id="3856648">cipher3DES</span><span class="op" id="3856658">,</span>&nbsp;<span class="ident" id="3856660">macSHA1</span><span class="op" id="3856667">,</span>&nbsp;<span class="ident" id="3856669">nil</span><span class="op" id="3856672">}</span><span class="op" id="3856673">,</span><br>
<span class="lineno">85</span><span class="op" id="3856675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3856678">func</span>&nbsp;<span class="ident" id="3856683">cipherRC4</span><span class="op" id="3856692">(</span><span class="ident" id="3856693">key</span><span class="op" id="3856696">,</span>&nbsp;<span class="ident" id="3856698">iv</span>&nbsp;<span class="op" id="3856701">[</span><span class="op" id="3856702">]</span><span class="builtintype" id="3856703">byte</span><span class="op" id="3856707">,</span>&nbsp;<span class="ident" id="3856709">isRead</span>&nbsp;<span class="builtintype" id="3856716">bool</span><span class="op" id="3856720">)</span>&nbsp;<span class="keyword" id="3856722">interface</span><span class="op" id="3856731">{</span><span class="op" id="3856732">}</span>&nbsp;<span class="op" id="3856734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3856737">cipher</span><span class="op" id="3856743">,</span>&nbsp;<span class="ident" id="3856745">_</span>&nbsp;<span class="op" id="3856747">:=</span>&nbsp;<span class="ident" id="3856750">rc4</span><span class="op" id="3856753">.</span><span class="ident" id="3856754">NewCipher</span><span class="op" id="3856763">(</span><span class="ident" id="3856764">key</span><span class="op" id="3856767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3856770">return</span>&nbsp;<span class="ident" id="3856777">cipher</span><br>
<span class="lineno">90</span><span class="op" id="3856784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3856787">func</span>&nbsp;<span class="ident" id="3856792">cipher3DES</span><span class="op" id="3856802">(</span><span class="ident" id="3856803">key</span><span class="op" id="3856806">,</span>&nbsp;<span class="ident" id="3856808">iv</span>&nbsp;<span class="op" id="3856811">[</span><span class="op" id="3856812">]</span><span class="builtintype" id="3856813">byte</span><span class="op" id="3856817">,</span>&nbsp;<span class="ident" id="3856819">isRead</span>&nbsp;<span class="builtintype" id="3856826">bool</span><span class="op" id="3856830">)</span>&nbsp;<span class="keyword" id="3856832">interface</span><span class="op" id="3856841">{</span><span class="op" id="3856842">}</span>&nbsp;<span class="op" id="3856844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3856847">block</span><span class="op" id="3856852">,</span>&nbsp;<span class="ident" id="3856854">_</span>&nbsp;<span class="op" id="3856856">:=</span>&nbsp;<span class="ident" id="3856859">des</span><span class="op" id="3856862">.</span><span class="ident" id="3856863">NewTripleDESCipher</span><span class="op" id="3856881">(</span><span class="ident" id="3856882">key</span><span class="op" id="3856885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3856888">if</span>&nbsp;<span class="ident" id="3856891">isRead</span>&nbsp;<span class="op" id="3856898">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3856902">return</span>&nbsp;<span class="ident" id="3856909">cipher</span><span class="op" id="3856915">.</span><span class="ident" id="3856916">NewCBCDecrypter</span><span class="op" id="3856931">(</span><span class="ident" id="3856932">block</span><span class="op" id="3856937">,</span>&nbsp;<span class="ident" id="3856939">iv</span><span class="op" id="3856941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3856944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3856947">return</span>&nbsp;<span class="ident" id="3856954">cipher</span><span class="op" id="3856960">.</span><span class="ident" id="3856961">NewCBCEncrypter</span><span class="op" id="3856976">(</span><span class="ident" id="3856977">block</span><span class="op" id="3856982">,</span>&nbsp;<span class="ident" id="3856984">iv</span><span class="op" id="3856986">)</span><br>
<span class="lineno"></span><span class="op" id="3856988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3856991">func</span>&nbsp;<span class="ident" id="3856996">cipherAES</span><span class="op" id="3857005">(</span><span class="ident" id="3857006">key</span><span class="op" id="3857009">,</span>&nbsp;<span class="ident" id="3857011">iv</span>&nbsp;<span class="op" id="3857014">[</span><span class="op" id="3857015">]</span><span class="builtintype" id="3857016">byte</span><span class="op" id="3857020">,</span>&nbsp;<span class="ident" id="3857022">isRead</span>&nbsp;<span class="builtintype" id="3857029">bool</span><span class="op" id="3857033">)</span>&nbsp;<span class="keyword" id="3857035">interface</span><span class="op" id="3857044">{</span><span class="op" id="3857045">}</span>&nbsp;<span class="op" id="3857047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3857050">block</span><span class="op" id="3857055">,</span>&nbsp;<span class="ident" id="3857057">_</span>&nbsp;<span class="op" id="3857059">:=</span>&nbsp;<span class="ident" id="3857062">aes</span><span class="op" id="3857065">.</span><span class="ident" id="3857066">NewCipher</span><span class="op" id="3857075">(</span><span class="ident" id="3857076">key</span><span class="op" id="3857079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3857082">if</span>&nbsp;<span class="ident" id="3857085">isRead</span>&nbsp;<span class="op" id="3857092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3857096">return</span>&nbsp;<span class="ident" id="3857103">cipher</span><span class="op" id="3857109">.</span><span class="ident" id="3857110">NewCBCDecrypter</span><span class="op" id="3857125">(</span><span class="ident" id="3857126">block</span><span class="op" id="3857131">,</span>&nbsp;<span class="ident" id="3857133">iv</span><span class="op" id="3857135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3857138">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3857141">return</span>&nbsp;<span class="ident" id="3857148">cipher</span><span class="op" id="3857154">.</span><span class="ident" id="3857155">NewCBCEncrypter</span><span class="op" id="3857170">(</span><span class="ident" id="3857171">block</span><span class="op" id="3857176">,</span>&nbsp;<span class="ident" id="3857178">iv</span><span class="op" id="3857180">)</span><br>
<span class="lineno"></span><span class="op" id="3857182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3857185">//&nbsp;macSHA1&nbsp;returns&nbsp;a&nbsp;macFunction&nbsp;for&nbsp;the&nbsp;given&nbsp;protocol&nbsp;version.</span><br>
<span class="lineno"></span><span class="keyword" id="3857250">func</span>&nbsp;<span class="ident" id="3857255">macSHA1</span><span class="op" id="3857262">(</span><span class="ident" id="3857263">version</span>&nbsp;<span class="builtintype" id="3857271">uint16</span><span class="op" id="3857277">,</span>&nbsp;<span class="ident" id="3857279">key</span>&nbsp;<span class="op" id="3857283">[</span><span class="op" id="3857284">]</span><span class="builtintype" id="3857285">byte</span><span class="op" id="3857289">)</span>&nbsp;<span class="ident" id="3857291">macFunction</span>&nbsp;<span class="op" id="3857303">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3857306">if</span>&nbsp;<span class="ident" id="3857309">version</span>&nbsp;<span class="op" id="3857317">==</span>&nbsp;<span class="ident" id="3857320">VersionSSL30</span>&nbsp;<span class="op" id="3857333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3857337">mac</span>&nbsp;<span class="op" id="3857341">:=</span>&nbsp;<span class="ident" id="3857344">ssl30MAC</span><span class="op" id="3857352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3857357">h</span><span class="op" id="3857358">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3857362">sha1</span><span class="op" id="3857366">.</span><span class="ident" id="3857367">New</span><span class="op" id="3857370">(</span><span class="op" id="3857371">)</span><span class="op" id="3857372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3857377">key</span><span class="op" id="3857380">:</span>&nbsp;<span class="builtinfunc" id="3857382">make</span><span class="op" id="3857386">(</span><span class="op" id="3857387">[</span><span class="op" id="3857388">]</span><span class="builtintype" id="3857389">byte</span><span class="op" id="3857393">,</span>&nbsp;<span class="builtinfunc" id="3857395">len</span><span class="op" id="3857398">(</span><span class="ident" id="3857399">key</span><span class="op" id="3857402">)</span><span class="op" id="3857403">)</span><span class="op" id="3857404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3857408">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3857412">copy</span><span class="op" id="3857416">(</span><span class="ident" id="3857417">mac</span><span class="op" id="3857420">.</span><span class="ident" id="3857421">key</span><span class="op" id="3857424">,</span>&nbsp;<span class="ident" id="3857426">key</span><span class="op" id="3857429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3857433">return</span>&nbsp;<span class="ident" id="3857440">mac</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3857445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3857448">return</span>&nbsp;<span class="ident" id="3857455">tls10MAC</span><span class="op" id="3857463">{</span><span class="ident" id="3857464">hmac</span><span class="op" id="3857468">.</span><span class="ident" id="3857469">New</span><span class="op" id="3857472">(</span><span class="ident" id="3857473">sha1</span><span class="op" id="3857477">.</span><span class="ident" id="3857478">New</span><span class="op" id="3857481">,</span>&nbsp;<span class="ident" id="3857483">key</span><span class="op" id="3857486">)</span><span class="op" id="3857487">}</span><br>
<span class="lineno"></span><span class="op" id="3857489">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="3857492">type</span>&nbsp;<span class="ident" id="3857497">macFunction</span>&nbsp;<span class="keyword" id="3857509">interface</span>&nbsp;<span class="op" id="3857519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3857522">Size</span><span class="op" id="3857526">(</span><span class="op" id="3857527">)</span>&nbsp;<span class="builtintype" id="3857529">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3857534">MAC</span><span class="op" id="3857537">(</span><span class="ident" id="3857538">digestBuf</span><span class="op" id="3857547">,</span>&nbsp;<span class="ident" id="3857549">seq</span><span class="op" id="3857552">,</span>&nbsp;<span class="ident" id="3857554">header</span><span class="op" id="3857560">,</span>&nbsp;<span class="ident" id="3857562">data</span>&nbsp;<span class="op" id="3857567">[</span><span class="op" id="3857568">]</span><span class="builtintype" id="3857569">byte</span><span class="op" id="3857573">)</span>&nbsp;<span class="op" id="3857575">[</span><span class="op" id="3857576">]</span><span class="builtintype" id="3857577">byte</span><br>
<span class="lineno"></span><span class="op" id="3857582">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="3857585">//&nbsp;fixedNonceAEAD&nbsp;wraps&nbsp;an&nbsp;AEAD&nbsp;and&nbsp;prefixes&nbsp;a&nbsp;fixed&nbsp;portion&nbsp;of&nbsp;the&nbsp;nonce&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3857662">//&nbsp;each&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="3857676">type</span>&nbsp;<span class="ident" id="3857681">fixedNonceAEAD</span>&nbsp;<span class="keyword" id="3857696">struct</span>&nbsp;<span class="op" id="3857703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3857706">//&nbsp;sealNonce&nbsp;and&nbsp;openNonce&nbsp;are&nbsp;buffers&nbsp;where&nbsp;the&nbsp;larger&nbsp;nonce&nbsp;will&nbsp;be</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3857777">//&nbsp;constructed.&nbsp;Since&nbsp;a&nbsp;seal&nbsp;and&nbsp;open&nbsp;operation&nbsp;may&nbsp;be&nbsp;running</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3857841">//&nbsp;concurrently,&nbsp;there&nbsp;is&nbsp;a&nbsp;separate&nbsp;buffer&nbsp;for&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3857896">sealNonce</span><span class="op" id="3857905">,</span>&nbsp;<span class="ident" id="3857907">openNonce</span>&nbsp;<span class="op" id="3857917">[</span><span class="op" id="3857918">]</span><span class="builtintype" id="3857919">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3857925">aead</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3857946">cipher</span><span class="op" id="3857952">.</span><span class="ident" id="3857953">AEAD</span><br>
<span class="lineno"></span><span class="op" id="3857958">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="3857961">func</span>&nbsp;<span class="op" id="3857966">(</span><span class="ident" id="3857967">f</span>&nbsp;<span class="op" id="3857969">*</span><span class="ident" id="3857970">fixedNonceAEAD</span><span class="op" id="3857984">)</span>&nbsp;<span class="ident" id="3857986">NonceSize</span><span class="op" id="3857995">(</span><span class="op" id="3857996">)</span>&nbsp;<span class="builtintype" id="3857998">int</span>&nbsp;<span class="op" id="3858002">{</span>&nbsp;<span class="keyword" id="3858004">return</span>&nbsp;<span class="num" id="3858011">8</span>&nbsp;<span class="op" id="3858013">}</span><br>
<span class="lineno"></span><span class="keyword" id="3858015">func</span>&nbsp;<span class="op" id="3858020">(</span><span class="ident" id="3858021">f</span>&nbsp;<span class="op" id="3858023">*</span><span class="ident" id="3858024">fixedNonceAEAD</span><span class="op" id="3858038">)</span>&nbsp;<span class="ident" id="3858040">Overhead</span><span class="op" id="3858048">(</span><span class="op" id="3858049">)</span>&nbsp;<span class="builtintype" id="3858051">int</span>&nbsp;&nbsp;<span class="op" id="3858056">{</span>&nbsp;<span class="keyword" id="3858058">return</span>&nbsp;<span class="ident" id="3858065">f</span><span class="op" id="3858066">.</span><span class="ident" id="3858067">aead</span><span class="op" id="3858071">.</span><span class="ident" id="3858072">Overhead</span><span class="op" id="3858080">(</span><span class="op" id="3858081">)</span>&nbsp;<span class="op" id="3858083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3858086">func</span>&nbsp;<span class="op" id="3858091">(</span><span class="ident" id="3858092">f</span>&nbsp;<span class="op" id="3858094">*</span><span class="ident" id="3858095">fixedNonceAEAD</span><span class="op" id="3858109">)</span>&nbsp;<span class="ident" id="3858111">Seal</span><span class="op" id="3858115">(</span><span class="ident" id="3858116">out</span><span class="op" id="3858119">,</span>&nbsp;<span class="ident" id="3858121">nonce</span><span class="op" id="3858126">,</span>&nbsp;<span class="ident" id="3858128">plaintext</span><span class="op" id="3858137">,</span>&nbsp;<span class="ident" id="3858139">additionalData</span>&nbsp;<span class="op" id="3858154">[</span><span class="op" id="3858155">]</span><span class="builtintype" id="3858156">byte</span><span class="op" id="3858160">)</span>&nbsp;<span class="op" id="3858162">[</span><span class="op" id="3858163">]</span><span class="builtintype" id="3858164">byte</span>&nbsp;<span class="op" id="3858169">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3858172">copy</span><span class="op" id="3858176">(</span><span class="ident" id="3858177">f</span><span class="op" id="3858178">.</span><span class="ident" id="3858179">sealNonce</span><span class="op" id="3858188">[</span><span class="builtinfunc" id="3858189">len</span><span class="op" id="3858192">(</span><span class="ident" id="3858193">f</span><span class="op" id="3858194">.</span><span class="ident" id="3858195">sealNonce</span><span class="op" id="3858204">)</span><span class="op" id="3858205">-</span><span class="num" id="3858206">8</span><span class="op" id="3858207">:</span><span class="op" id="3858208">]</span><span class="op" id="3858209">,</span>&nbsp;<span class="ident" id="3858211">nonce</span><span class="op" id="3858216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3858219">return</span>&nbsp;<span class="ident" id="3858226">f</span><span class="op" id="3858227">.</span><span class="ident" id="3858228">aead</span><span class="op" id="3858232">.</span><span class="ident" id="3858233">Seal</span><span class="op" id="3858237">(</span><span class="ident" id="3858238">out</span><span class="op" id="3858241">,</span>&nbsp;<span class="ident" id="3858243">f</span><span class="op" id="3858244">.</span><span class="ident" id="3858245">sealNonce</span><span class="op" id="3858254">,</span>&nbsp;<span class="ident" id="3858256">plaintext</span><span class="op" id="3858265">,</span>&nbsp;<span class="ident" id="3858267">additionalData</span><span class="op" id="3858281">)</span><br>
<span class="lineno"></span><span class="op" id="3858283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3858286">func</span>&nbsp;<span class="op" id="3858291">(</span><span class="ident" id="3858292">f</span>&nbsp;<span class="op" id="3858294">*</span><span class="ident" id="3858295">fixedNonceAEAD</span><span class="op" id="3858309">)</span>&nbsp;<span class="ident" id="3858311">Open</span><span class="op" id="3858315">(</span><span class="ident" id="3858316">out</span><span class="op" id="3858319">,</span>&nbsp;<span class="ident" id="3858321">nonce</span><span class="op" id="3858326">,</span>&nbsp;<span class="ident" id="3858328">plaintext</span><span class="op" id="3858337">,</span>&nbsp;<span class="ident" id="3858339">additionalData</span>&nbsp;<span class="op" id="3858354">[</span><span class="op" id="3858355">]</span><span class="builtintype" id="3858356">byte</span><span class="op" id="3858360">)</span>&nbsp;<span class="op" id="3858362">(</span><span class="op" id="3858363">[</span><span class="op" id="3858364">]</span><span class="builtintype" id="3858365">byte</span><span class="op" id="3858369">,</span>&nbsp;<span class="builtintype" id="3858371">error</span><span class="op" id="3858376">)</span>&nbsp;<span class="op" id="3858378">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3858381">copy</span><span class="op" id="3858385">(</span><span class="ident" id="3858386">f</span><span class="op" id="3858387">.</span><span class="ident" id="3858388">openNonce</span><span class="op" id="3858397">[</span><span class="builtinfunc" id="3858398">len</span><span class="op" id="3858401">(</span><span class="ident" id="3858402">f</span><span class="op" id="3858403">.</span><span class="ident" id="3858404">openNonce</span><span class="op" id="3858413">)</span><span class="op" id="3858414">-</span><span class="num" id="3858415">8</span><span class="op" id="3858416">:</span><span class="op" id="3858417">]</span><span class="op" id="3858418">,</span>&nbsp;<span class="ident" id="3858420">nonce</span><span class="op" id="3858425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3858428">return</span>&nbsp;<span class="ident" id="3858435">f</span><span class="op" id="3858436">.</span><span class="ident" id="3858437">aead</span><span class="op" id="3858441">.</span><span class="ident" id="3858442">Open</span><span class="op" id="3858446">(</span><span class="ident" id="3858447">out</span><span class="op" id="3858450">,</span>&nbsp;<span class="ident" id="3858452">f</span><span class="op" id="3858453">.</span><span class="ident" id="3858454">openNonce</span><span class="op" id="3858463">,</span>&nbsp;<span class="ident" id="3858465">plaintext</span><span class="op" id="3858474">,</span>&nbsp;<span class="ident" id="3858476">additionalData</span><span class="op" id="3858490">)</span><br>
<span class="lineno"></span><span class="op" id="3858492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3858495">func</span>&nbsp;<span class="ident" id="3858500">aeadAESGCM</span><span class="op" id="3858510">(</span><span class="ident" id="3858511">key</span><span class="op" id="3858514">,</span>&nbsp;<span class="ident" id="3858516">fixedNonce</span>&nbsp;<span class="op" id="3858527">[</span><span class="op" id="3858528">]</span><span class="builtintype" id="3858529">byte</span><span class="op" id="3858533">)</span>&nbsp;<span class="ident" id="3858535">cipher</span><span class="op" id="3858541">.</span><span class="ident" id="3858542">AEAD</span>&nbsp;<span class="op" id="3858547">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3858550">aes</span><span class="op" id="3858553">,</span>&nbsp;<span class="ident" id="3858555">err</span>&nbsp;<span class="op" id="3858559">:=</span>&nbsp;<span class="ident" id="3858562">aes</span><span class="op" id="3858565">.</span><span class="ident" id="3858566">NewCipher</span><span class="op" id="3858575">(</span><span class="ident" id="3858576">key</span><span class="op" id="3858579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3858582">if</span>&nbsp;<span class="ident" id="3858585">err</span>&nbsp;<span class="op" id="3858589">!=</span>&nbsp;<span class="ident" id="3858592">nil</span>&nbsp;<span class="op" id="3858596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3858600">panic</span><span class="op" id="3858605">(</span><span class="ident" id="3858606">err</span><span class="op" id="3858609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3858612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3858615">aead</span><span class="op" id="3858619">,</span>&nbsp;<span class="ident" id="3858621">err</span>&nbsp;<span class="op" id="3858625">:=</span>&nbsp;<span class="ident" id="3858628">cipher</span><span class="op" id="3858634">.</span><span class="ident" id="3858635">NewGCM</span><span class="op" id="3858641">(</span><span class="ident" id="3858642">aes</span><span class="op" id="3858645">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3858648">if</span>&nbsp;<span class="ident" id="3858651">err</span>&nbsp;<span class="op" id="3858655">!=</span>&nbsp;<span class="ident" id="3858658">nil</span>&nbsp;<span class="op" id="3858662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3858666">panic</span><span class="op" id="3858671">(</span><span class="ident" id="3858672">err</span><span class="op" id="3858675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3858678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3858682">nonce1</span><span class="op" id="3858688">,</span>&nbsp;<span class="ident" id="3858690">nonce2</span>&nbsp;<span class="op" id="3858697">:=</span>&nbsp;<span class="builtinfunc" id="3858700">make</span><span class="op" id="3858704">(</span><span class="op" id="3858705">[</span><span class="op" id="3858706">]</span><span class="builtintype" id="3858707">byte</span><span class="op" id="3858711">,</span>&nbsp;<span class="num" id="3858713">12</span><span class="op" id="3858715">)</span><span class="op" id="3858716">,</span>&nbsp;<span class="builtinfunc" id="3858718">make</span><span class="op" id="3858722">(</span><span class="op" id="3858723">[</span><span class="op" id="3858724">]</span><span class="builtintype" id="3858725">byte</span><span class="op" id="3858729">,</span>&nbsp;<span class="num" id="3858731">12</span><span class="op" id="3858733">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3858736">copy</span><span class="op" id="3858740">(</span><span class="ident" id="3858741">nonce1</span><span class="op" id="3858747">,</span>&nbsp;<span class="ident" id="3858749">fixedNonce</span><span class="op" id="3858759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3858762">copy</span><span class="op" id="3858766">(</span><span class="ident" id="3858767">nonce2</span><span class="op" id="3858773">,</span>&nbsp;<span class="ident" id="3858775">fixedNonce</span><span class="op" id="3858785">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3858789">return</span>&nbsp;<span class="op" id="3858796">&amp;</span><span class="ident" id="3858797">fixedNonceAEAD</span><span class="op" id="3858811">{</span><span class="ident" id="3858812">nonce1</span><span class="op" id="3858818">,</span>&nbsp;<span class="ident" id="3858820">nonce2</span><span class="op" id="3858826">,</span>&nbsp;<span class="ident" id="3858828">aead</span><span class="op" id="3858832">}</span><br>
<span class="lineno"></span><span class="op" id="3858834">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="3858837">//&nbsp;ssl30MAC&nbsp;implements&nbsp;the&nbsp;SSLv3&nbsp;MAC&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3858898">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;5.2.3.1</span><br>
<span class="lineno"></span><span class="keyword" id="3858976">type</span>&nbsp;<span class="ident" id="3858981">ssl30MAC</span>&nbsp;<span class="keyword" id="3858990">struct</span>&nbsp;<span class="op" id="3858997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3859000">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3859004">hash</span><span class="op" id="3859008">.</span><span class="ident" id="3859009">Hash</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3859015">key</span>&nbsp;<span class="op" id="3859019">[</span><span class="op" id="3859020">]</span><span class="builtintype" id="3859021">byte</span><br>
<span class="lineno"></span><span class="op" id="3859026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3859029">func</span>&nbsp;<span class="op" id="3859034">(</span><span class="ident" id="3859035">s</span>&nbsp;<span class="ident" id="3859037">ssl30MAC</span><span class="op" id="3859045">)</span>&nbsp;<span class="ident" id="3859047">Size</span><span class="op" id="3859051">(</span><span class="op" id="3859052">)</span>&nbsp;<span class="builtintype" id="3859054">int</span>&nbsp;<span class="op" id="3859058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3859061">return</span>&nbsp;<span class="ident" id="3859068">s</span><span class="op" id="3859069">.</span><span class="ident" id="3859070">h</span><span class="op" id="3859071">.</span><span class="ident" id="3859072">Size</span><span class="op" id="3859076">(</span><span class="op" id="3859077">)</span><br>
<span class="lineno">175</span><span class="op" id="3859079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3859082">var</span>&nbsp;<span class="ident" id="3859086">ssl30Pad1</span>&nbsp;<span class="op" id="3859096">=</span>&nbsp;<span class="op" id="3859098">[</span><span class="num" id="3859099">48</span><span class="op" id="3859101">]</span><span class="builtintype" id="3859102">byte</span><span class="op" id="3859106">{</span><span class="num" id="3859107">0x36</span><span class="op" id="3859111">,</span>&nbsp;<span class="num" id="3859113">0x36</span><span class="op" id="3859117">,</span>&nbsp;<span class="num" id="3859119">0x36</span><span class="op" id="3859123">,</span>&nbsp;<span class="num" id="3859125">0x36</span><span class="op" id="3859129">,</span>&nbsp;<span class="num" id="3859131">0x36</span><span class="op" id="3859135">,</span>&nbsp;<span class="num" id="3859137">0x36</span><span class="op" id="3859141">,</span>&nbsp;<span class="num" id="3859143">0x36</span><span class="op" id="3859147">,</span>&nbsp;<span class="num" id="3859149">0x36</span><span class="op" id="3859153">,</span>&nbsp;<span class="num" id="3859155">0x36</span><span class="op" id="3859159">,</span>&nbsp;<span class="num" id="3859161">0x36</span><span class="op" id="3859165">,</span>&nbsp;<span class="num" id="3859167">0x36</span><span class="op" id="3859171">,</span>&nbsp;<span class="num" id="3859173">0x36</span><span class="op" id="3859177">,</span>&nbsp;<span class="num" id="3859179">0x36</span><span class="op" id="3859183">,</span>&nbsp;<span class="num" id="3859185">0x36</span><span class="op" id="3859189">,</span>&nbsp;<span class="num" id="3859191">0x36</span><span class="op" id="3859195">,</span>&nbsp;<span class="num" id="3859197">0x36</span><span class="op" id="3859201">,</span>&nbsp;<span class="num" id="3859203">0x36</span><span class="op" id="3859207">,</span>&nbsp;<span class="num" id="3859209">0x36</span><span class="op" id="3859213">,</span>&nbsp;<span class="num" id="3859215">0x36</span><span class="op" id="3859219">,</span>&nbsp;<span class="num" id="3859221">0x36</span><span class="op" id="3859225">,</span>&nbsp;<span class="num" id="3859227">0x36</span><span class="op" id="3859231">,</span>&nbsp;<span class="num" id="3859233">0x36</span><span class="op" id="3859237">,</span>&nbsp;<span class="num" id="3859239">0x36</span><span class="op" id="3859243">,</span>&nbsp;<span class="num" id="3859245">0x36</span><span class="op" id="3859249">,</span>&nbsp;<span class="num" id="3859251">0x36</span><span class="op" id="3859255">,</span>&nbsp;<span class="num" id="3859257">0x36</span><span class="op" id="3859261">,</span>&nbsp;<span class="num" id="3859263">0x36</span><span class="op" id="3859267">,</span>&nbsp;<span class="num" id="3859269">0x36</span><span class="op" id="3859273">,</span>&nbsp;<span class="num" id="3859275">0x36</span><span class="op" id="3859279">,</span>&nbsp;<span class="num" id="3859281">0x36</span><span class="op" id="3859285">,</span>&nbsp;<span class="num" id="3859287">0x36</span><span class="op" id="3859291">,</span>&nbsp;<span class="num" id="3859293">0x36</span><span class="op" id="3859297">,</span>&nbsp;<span class="num" id="3859299">0x36</span><span class="op" id="3859303">,</span>&nbsp;<span class="num" id="3859305">0x36</span><span class="op" id="3859309">,</span>&nbsp;<span class="num" id="3859311">0x36</span><span class="op" id="3859315">,</span>&nbsp;<span class="num" id="3859317">0x36</span><span class="op" id="3859321">,</span>&nbsp;<span class="num" id="3859323">0x36</span><span class="op" id="3859327">,</span>&nbsp;<span class="num" id="3859329">0x36</span><span class="op" id="3859333">,</span>&nbsp;<span class="num" id="3859335">0x36</span><span class="op" id="3859339">,</span>&nbsp;<span class="num" id="3859341">0x36</span><span class="op" id="3859345">,</span>&nbsp;<span class="num" id="3859347">0x36</span><span class="op" id="3859351">,</span>&nbsp;<span class="num" id="3859353">0x36</span><span class="op" id="3859357">,</span>&nbsp;<span class="num" id="3859359">0x36</span><span class="op" id="3859363">,</span>&nbsp;<span class="num" id="3859365">0x36</span><span class="op" id="3859369">,</span>&nbsp;<span class="num" id="3859371">0x36</span><span class="op" id="3859375">,</span>&nbsp;<span class="num" id="3859377">0x36</span><span class="op" id="3859381">,</span>&nbsp;<span class="num" id="3859383">0x36</span><span class="op" id="3859387">,</span>&nbsp;<span class="num" id="3859389">0x36</span><span class="op" id="3859393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3859396">var</span>&nbsp;<span class="ident" id="3859400">ssl30Pad2</span>&nbsp;<span class="op" id="3859410">=</span>&nbsp;<span class="op" id="3859412">[</span><span class="num" id="3859413">48</span><span class="op" id="3859415">]</span><span class="builtintype" id="3859416">byte</span><span class="op" id="3859420">{</span><span class="num" id="3859421">0x5c</span><span class="op" id="3859425">,</span>&nbsp;<span class="num" id="3859427">0x5c</span><span class="op" id="3859431">,</span>&nbsp;<span class="num" id="3859433">0x5c</span><span class="op" id="3859437">,</span>&nbsp;<span class="num" id="3859439">0x5c</span><span class="op" id="3859443">,</span>&nbsp;<span class="num" id="3859445">0x5c</span><span class="op" id="3859449">,</span>&nbsp;<span class="num" id="3859451">0x5c</span><span class="op" id="3859455">,</span>&nbsp;<span class="num" id="3859457">0x5c</span><span class="op" id="3859461">,</span>&nbsp;<span class="num" id="3859463">0x5c</span><span class="op" id="3859467">,</span>&nbsp;<span class="num" id="3859469">0x5c</span><span class="op" id="3859473">,</span>&nbsp;<span class="num" id="3859475">0x5c</span><span class="op" id="3859479">,</span>&nbsp;<span class="num" id="3859481">0x5c</span><span class="op" id="3859485">,</span>&nbsp;<span class="num" id="3859487">0x5c</span><span class="op" id="3859491">,</span>&nbsp;<span class="num" id="3859493">0x5c</span><span class="op" id="3859497">,</span>&nbsp;<span class="num" id="3859499">0x5c</span><span class="op" id="3859503">,</span>&nbsp;<span class="num" id="3859505">0x5c</span><span class="op" id="3859509">,</span>&nbsp;<span class="num" id="3859511">0x5c</span><span class="op" id="3859515">,</span>&nbsp;<span class="num" id="3859517">0x5c</span><span class="op" id="3859521">,</span>&nbsp;<span class="num" id="3859523">0x5c</span><span class="op" id="3859527">,</span>&nbsp;<span class="num" id="3859529">0x5c</span><span class="op" id="3859533">,</span>&nbsp;<span class="num" id="3859535">0x5c</span><span class="op" id="3859539">,</span>&nbsp;<span class="num" id="3859541">0x5c</span><span class="op" id="3859545">,</span>&nbsp;<span class="num" id="3859547">0x5c</span><span class="op" id="3859551">,</span>&nbsp;<span class="num" id="3859553">0x5c</span><span class="op" id="3859557">,</span>&nbsp;<span class="num" id="3859559">0x5c</span><span class="op" id="3859563">,</span>&nbsp;<span class="num" id="3859565">0x5c</span><span class="op" id="3859569">,</span>&nbsp;<span class="num" id="3859571">0x5c</span><span class="op" id="3859575">,</span>&nbsp;<span class="num" id="3859577">0x5c</span><span class="op" id="3859581">,</span>&nbsp;<span class="num" id="3859583">0x5c</span><span class="op" id="3859587">,</span>&nbsp;<span class="num" id="3859589">0x5c</span><span class="op" id="3859593">,</span>&nbsp;<span class="num" id="3859595">0x5c</span><span class="op" id="3859599">,</span>&nbsp;<span class="num" id="3859601">0x5c</span><span class="op" id="3859605">,</span>&nbsp;<span class="num" id="3859607">0x5c</span><span class="op" id="3859611">,</span>&nbsp;<span class="num" id="3859613">0x5c</span><span class="op" id="3859617">,</span>&nbsp;<span class="num" id="3859619">0x5c</span><span class="op" id="3859623">,</span>&nbsp;<span class="num" id="3859625">0x5c</span><span class="op" id="3859629">,</span>&nbsp;<span class="num" id="3859631">0x5c</span><span class="op" id="3859635">,</span>&nbsp;<span class="num" id="3859637">0x5c</span><span class="op" id="3859641">,</span>&nbsp;<span class="num" id="3859643">0x5c</span><span class="op" id="3859647">,</span>&nbsp;<span class="num" id="3859649">0x5c</span><span class="op" id="3859653">,</span>&nbsp;<span class="num" id="3859655">0x5c</span><span class="op" id="3859659">,</span>&nbsp;<span class="num" id="3859661">0x5c</span><span class="op" id="3859665">,</span>&nbsp;<span class="num" id="3859667">0x5c</span><span class="op" id="3859671">,</span>&nbsp;<span class="num" id="3859673">0x5c</span><span class="op" id="3859677">,</span>&nbsp;<span class="num" id="3859679">0x5c</span><span class="op" id="3859683">,</span>&nbsp;<span class="num" id="3859685">0x5c</span><span class="op" id="3859689">,</span>&nbsp;<span class="num" id="3859691">0x5c</span><span class="op" id="3859695">,</span>&nbsp;<span class="num" id="3859697">0x5c</span><span class="op" id="3859701">,</span>&nbsp;<span class="num" id="3859703">0x5c</span><span class="op" id="3859707">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="3859710">func</span>&nbsp;<span class="op" id="3859715">(</span><span class="ident" id="3859716">s</span>&nbsp;<span class="ident" id="3859718">ssl30MAC</span><span class="op" id="3859726">)</span>&nbsp;<span class="ident" id="3859728">MAC</span><span class="op" id="3859731">(</span><span class="ident" id="3859732">digestBuf</span><span class="op" id="3859741">,</span>&nbsp;<span class="ident" id="3859743">seq</span><span class="op" id="3859746">,</span>&nbsp;<span class="ident" id="3859748">header</span><span class="op" id="3859754">,</span>&nbsp;<span class="ident" id="3859756">data</span>&nbsp;<span class="op" id="3859761">[</span><span class="op" id="3859762">]</span><span class="builtintype" id="3859763">byte</span><span class="op" id="3859767">)</span>&nbsp;<span class="op" id="3859769">[</span><span class="op" id="3859770">]</span><span class="builtintype" id="3859771">byte</span>&nbsp;<span class="op" id="3859776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3859779">padLength</span>&nbsp;<span class="op" id="3859789">:=</span>&nbsp;<span class="num" id="3859792">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3859796">if</span>&nbsp;<span class="ident" id="3859799">s</span><span class="op" id="3859800">.</span><span class="ident" id="3859801">h</span><span class="op" id="3859802">.</span><span class="ident" id="3859803">Size</span><span class="op" id="3859807">(</span><span class="op" id="3859808">)</span>&nbsp;<span class="op" id="3859810">==</span>&nbsp;<span class="num" id="3859813">20</span>&nbsp;<span class="op" id="3859816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3859820">padLength</span>&nbsp;<span class="op" id="3859830">=</span>&nbsp;<span class="num" id="3859832">40</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3859836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3859840">s</span><span class="op" id="3859841">.</span><span class="ident" id="3859842">h</span><span class="op" id="3859843">.</span><span class="ident" id="3859844">Reset</span><span class="op" id="3859849">(</span><span class="op" id="3859850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3859853">s</span><span class="op" id="3859854">.</span><span class="ident" id="3859855">h</span><span class="op" id="3859856">.</span><span class="ident" id="3859857">Write</span><span class="op" id="3859862">(</span><span class="ident" id="3859863">s</span><span class="op" id="3859864">.</span><span class="ident" id="3859865">key</span><span class="op" id="3859868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3859871">s</span><span class="op" id="3859872">.</span><span class="ident" id="3859873">h</span><span class="op" id="3859874">.</span><span class="ident" id="3859875">Write</span><span class="op" id="3859880">(</span><span class="ident" id="3859881">ssl30Pad1</span><span class="op" id="3859890">[</span><span class="op" id="3859891">:</span><span class="ident" id="3859892">padLength</span><span class="op" id="3859901">]</span><span class="op" id="3859902">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3859905">s</span><span class="op" id="3859906">.</span><span class="ident" id="3859907">h</span><span class="op" id="3859908">.</span><span class="ident" id="3859909">Write</span><span class="op" id="3859914">(</span><span class="ident" id="3859915">seq</span><span class="op" id="3859918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3859921">s</span><span class="op" id="3859922">.</span><span class="ident" id="3859923">h</span><span class="op" id="3859924">.</span><span class="ident" id="3859925">Write</span><span class="op" id="3859930">(</span><span class="ident" id="3859931">header</span><span class="op" id="3859937">[</span><span class="op" id="3859938">:</span><span class="num" id="3859939">1</span><span class="op" id="3859940">]</span><span class="op" id="3859941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3859944">s</span><span class="op" id="3859945">.</span><span class="ident" id="3859946">h</span><span class="op" id="3859947">.</span><span class="ident" id="3859948">Write</span><span class="op" id="3859953">(</span><span class="ident" id="3859954">header</span><span class="op" id="3859960">[</span><span class="num" id="3859961">3</span><span class="op" id="3859962">:</span><span class="num" id="3859963">5</span><span class="op" id="3859964">]</span><span class="op" id="3859965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3859968">s</span><span class="op" id="3859969">.</span><span class="ident" id="3859970">h</span><span class="op" id="3859971">.</span><span class="ident" id="3859972">Write</span><span class="op" id="3859977">(</span><span class="ident" id="3859978">data</span><span class="op" id="3859982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3859985">digestBuf</span>&nbsp;<span class="op" id="3859995">=</span>&nbsp;<span class="ident" id="3859997">s</span><span class="op" id="3859998">.</span><span class="ident" id="3859999">h</span><span class="op" id="3860000">.</span><span class="ident" id="3860001">Sum</span><span class="op" id="3860004">(</span><span class="ident" id="3860005">digestBuf</span><span class="op" id="3860014">[</span><span class="op" id="3860015">:</span><span class="num" id="3860016">0</span><span class="op" id="3860017">]</span><span class="op" id="3860018">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3860022">s</span><span class="op" id="3860023">.</span><span class="ident" id="3860024">h</span><span class="op" id="3860025">.</span><span class="ident" id="3860026">Reset</span><span class="op" id="3860031">(</span><span class="op" id="3860032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3860035">s</span><span class="op" id="3860036">.</span><span class="ident" id="3860037">h</span><span class="op" id="3860038">.</span><span class="ident" id="3860039">Write</span><span class="op" id="3860044">(</span><span class="ident" id="3860045">s</span><span class="op" id="3860046">.</span><span class="ident" id="3860047">key</span><span class="op" id="3860050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3860053">s</span><span class="op" id="3860054">.</span><span class="ident" id="3860055">h</span><span class="op" id="3860056">.</span><span class="ident" id="3860057">Write</span><span class="op" id="3860062">(</span><span class="ident" id="3860063">ssl30Pad2</span><span class="op" id="3860072">[</span><span class="op" id="3860073">:</span><span class="ident" id="3860074">padLength</span><span class="op" id="3860083">]</span><span class="op" id="3860084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3860087">s</span><span class="op" id="3860088">.</span><span class="ident" id="3860089">h</span><span class="op" id="3860090">.</span><span class="ident" id="3860091">Write</span><span class="op" id="3860096">(</span><span class="ident" id="3860097">digestBuf</span><span class="op" id="3860106">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3860109">return</span>&nbsp;<span class="ident" id="3860116">s</span><span class="op" id="3860117">.</span><span class="ident" id="3860118">h</span><span class="op" id="3860119">.</span><span class="ident" id="3860120">Sum</span><span class="op" id="3860123">(</span><span class="ident" id="3860124">digestBuf</span><span class="op" id="3860133">[</span><span class="op" id="3860134">:</span><span class="num" id="3860135">0</span><span class="op" id="3860136">]</span><span class="op" id="3860137">)</span><br>
<span class="lineno"></span><span class="op" id="3860139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3860142">//&nbsp;tls10MAC&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;MAC&nbsp;function.&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.2.3.</span><br>
<span class="lineno"></span><span class="keyword" id="3860216">type</span>&nbsp;<span class="ident" id="3860221">tls10MAC</span>&nbsp;<span class="keyword" id="3860230">struct</span>&nbsp;<span class="op" id="3860237">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3860240">h</span>&nbsp;<span class="ident" id="3860242">hash</span><span class="op" id="3860246">.</span><span class="ident" id="3860247">Hash</span><br>
<span class="lineno"></span><span class="op" id="3860252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3860255">func</span>&nbsp;<span class="op" id="3860260">(</span><span class="ident" id="3860261">s</span>&nbsp;<span class="ident" id="3860263">tls10MAC</span><span class="op" id="3860271">)</span>&nbsp;<span class="ident" id="3860273">Size</span><span class="op" id="3860277">(</span><span class="op" id="3860278">)</span>&nbsp;<span class="builtintype" id="3860280">int</span>&nbsp;<span class="op" id="3860284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3860287">return</span>&nbsp;<span class="ident" id="3860294">s</span><span class="op" id="3860295">.</span><span class="ident" id="3860296">h</span><span class="op" id="3860297">.</span><span class="ident" id="3860298">Size</span><span class="op" id="3860302">(</span><span class="op" id="3860303">)</span><br>
<span class="lineno">210</span><span class="op" id="3860305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3860308">func</span>&nbsp;<span class="op" id="3860313">(</span><span class="ident" id="3860314">s</span>&nbsp;<span class="ident" id="3860316">tls10MAC</span><span class="op" id="3860324">)</span>&nbsp;<span class="ident" id="3860326">MAC</span><span class="op" id="3860329">(</span><span class="ident" id="3860330">digestBuf</span><span class="op" id="3860339">,</span>&nbsp;<span class="ident" id="3860341">seq</span><span class="op" id="3860344">,</span>&nbsp;<span class="ident" id="3860346">header</span><span class="op" id="3860352">,</span>&nbsp;<span class="ident" id="3860354">data</span>&nbsp;<span class="op" id="3860359">[</span><span class="op" id="3860360">]</span><span class="builtintype" id="3860361">byte</span><span class="op" id="3860365">)</span>&nbsp;<span class="op" id="3860367">[</span><span class="op" id="3860368">]</span><span class="builtintype" id="3860369">byte</span>&nbsp;<span class="op" id="3860374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3860377">s</span><span class="op" id="3860378">.</span><span class="ident" id="3860379">h</span><span class="op" id="3860380">.</span><span class="ident" id="3860381">Reset</span><span class="op" id="3860386">(</span><span class="op" id="3860387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3860390">s</span><span class="op" id="3860391">.</span><span class="ident" id="3860392">h</span><span class="op" id="3860393">.</span><span class="ident" id="3860394">Write</span><span class="op" id="3860399">(</span><span class="ident" id="3860400">seq</span><span class="op" id="3860403">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3860406">s</span><span class="op" id="3860407">.</span><span class="ident" id="3860408">h</span><span class="op" id="3860409">.</span><span class="ident" id="3860410">Write</span><span class="op" id="3860415">(</span><span class="ident" id="3860416">header</span><span class="op" id="3860422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3860425">s</span><span class="op" id="3860426">.</span><span class="ident" id="3860427">h</span><span class="op" id="3860428">.</span><span class="ident" id="3860429">Write</span><span class="op" id="3860434">(</span><span class="ident" id="3860435">data</span><span class="op" id="3860439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3860442">return</span>&nbsp;<span class="ident" id="3860449">s</span><span class="op" id="3860450">.</span><span class="ident" id="3860451">h</span><span class="op" id="3860452">.</span><span class="ident" id="3860453">Sum</span><span class="op" id="3860456">(</span><span class="ident" id="3860457">digestBuf</span><span class="op" id="3860466">[</span><span class="op" id="3860467">:</span><span class="num" id="3860468">0</span><span class="op" id="3860469">]</span><span class="op" id="3860470">)</span><br>
<span class="lineno"></span><span class="op" id="3860472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3860475">func</span>&nbsp;<span class="ident" id="3860480">rsaKA</span><span class="op" id="3860485">(</span><span class="ident" id="3860486">version</span>&nbsp;<span class="builtintype" id="3860494">uint16</span><span class="op" id="3860500">)</span>&nbsp;<span class="ident" id="3860502">keyAgreement</span>&nbsp;<span class="op" id="3860515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3860518">return</span>&nbsp;<span class="ident" id="3860525">rsaKeyAgreement</span><span class="op" id="3860540">{</span><span class="op" id="3860541">}</span><br>
<span class="lineno"></span><span class="op" id="3860543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3860546">func</span>&nbsp;<span class="ident" id="3860551">ecdheECDSAKA</span><span class="op" id="3860563">(</span><span class="ident" id="3860564">version</span>&nbsp;<span class="builtintype" id="3860572">uint16</span><span class="op" id="3860578">)</span>&nbsp;<span class="ident" id="3860580">keyAgreement</span>&nbsp;<span class="op" id="3860593">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3860596">return</span>&nbsp;<span class="op" id="3860603">&amp;</span><span class="ident" id="3860604">ecdheKeyAgreement</span><span class="op" id="3860621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3860625">sigType</span><span class="op" id="3860632">:</span>&nbsp;<span class="ident" id="3860634">signatureECDSA</span><span class="op" id="3860648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3860652">version</span><span class="op" id="3860659">:</span>&nbsp;<span class="ident" id="3860661">version</span><span class="op" id="3860668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3860671">}</span><br>
<span class="lineno"></span><span class="op" id="3860673">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="3860676">func</span>&nbsp;<span class="ident" id="3860681">ecdheRSAKA</span><span class="op" id="3860691">(</span><span class="ident" id="3860692">version</span>&nbsp;<span class="builtintype" id="3860700">uint16</span><span class="op" id="3860706">)</span>&nbsp;<span class="ident" id="3860708">keyAgreement</span>&nbsp;<span class="op" id="3860721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3860724">return</span>&nbsp;<span class="op" id="3860731">&amp;</span><span class="ident" id="3860732">ecdheKeyAgreement</span><span class="op" id="3860749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3860753">sigType</span><span class="op" id="3860760">:</span>&nbsp;<span class="ident" id="3860762">signatureRSA</span><span class="op" id="3860774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3860778">version</span><span class="op" id="3860785">:</span>&nbsp;<span class="ident" id="3860787">version</span><span class="op" id="3860794">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3860797">}</span><br>
<span class="lineno"></span><span class="op" id="3860799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3860802">//&nbsp;mutualCipherSuite&nbsp;returns&nbsp;a&nbsp;cipherSuite&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;supported</span><br>
<span class="lineno"></span><span class="comment" id="3860871">//&nbsp;ciphersuites&nbsp;and&nbsp;the&nbsp;id&nbsp;requested&nbsp;by&nbsp;the&nbsp;peer.</span><br>
<span class="lineno">240</span><span class="keyword" id="3860921">func</span>&nbsp;<span class="ident" id="3860926">mutualCipherSuite</span><span class="op" id="3860943">(</span><span class="ident" id="3860944">have</span>&nbsp;<span class="op" id="3860949">[</span><span class="op" id="3860950">]</span><span class="builtintype" id="3860951">uint16</span><span class="op" id="3860957">,</span>&nbsp;<span class="ident" id="3860959">want</span>&nbsp;<span class="builtintype" id="3860964">uint16</span><span class="op" id="3860970">)</span>&nbsp;<span class="op" id="3860972">*</span><span class="ident" id="3860973">cipherSuite</span>&nbsp;<span class="op" id="3860985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3860988">for</span>&nbsp;<span class="ident" id="3860992">_</span><span class="op" id="3860993">,</span>&nbsp;<span class="ident" id="3860995">id</span>&nbsp;<span class="op" id="3860998">:=</span>&nbsp;<span class="keyword" id="3861001">range</span>&nbsp;<span class="ident" id="3861007">have</span>&nbsp;<span class="op" id="3861012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3861016">if</span>&nbsp;<span class="ident" id="3861019">id</span>&nbsp;<span class="op" id="3861022">==</span>&nbsp;<span class="ident" id="3861025">want</span>&nbsp;<span class="op" id="3861030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3861035">for</span>&nbsp;<span class="ident" id="3861039">_</span><span class="op" id="3861040">,</span>&nbsp;<span class="ident" id="3861042">suite</span>&nbsp;<span class="op" id="3861048">:=</span>&nbsp;<span class="keyword" id="3861051">range</span>&nbsp;<span class="ident" id="3861057">cipherSuites</span>&nbsp;<span class="op" id="3861070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3861076">if</span>&nbsp;<span class="ident" id="3861079">suite</span><span class="op" id="3861084">.</span><span class="ident" id="3861085">id</span>&nbsp;<span class="op" id="3861088">==</span>&nbsp;<span class="ident" id="3861091">want</span>&nbsp;<span class="op" id="3861096">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3861103">return</span>&nbsp;<span class="ident" id="3861110">suite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3861120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3861125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3861130">return</span>&nbsp;<span class="ident" id="3861137">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3861143">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3861146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3861149">return</span>&nbsp;<span class="ident" id="3861156">nil</span><br>
<span class="lineno"></span><span class="op" id="3861160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3861163">//&nbsp;A&nbsp;list&nbsp;of&nbsp;the&nbsp;possible&nbsp;cipher&nbsp;suite&nbsp;ids.&nbsp;Taken&nbsp;from</span><br>
<span class="lineno">255</span><span class="comment" id="3861218">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml</span><br>
<span class="lineno"></span><span class="keyword" id="3861287">const</span>&nbsp;<span class="op" id="3861293">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3861296">TLS_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3861336">uint16</span>&nbsp;<span class="op" id="3861343">=</span>&nbsp;<span class="num" id="3861345">0x0005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3861353">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3861393">uint16</span>&nbsp;<span class="op" id="3861400">=</span>&nbsp;<span class="num" id="3861402">0x000a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3861410">TLS_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3861450">uint16</span>&nbsp;<span class="op" id="3861457">=</span>&nbsp;<span class="num" id="3861459">0x002f</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3861467">TLS_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3861507">uint16</span>&nbsp;<span class="op" id="3861514">=</span>&nbsp;<span class="num" id="3861516">0x0035</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3861524">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3861564">uint16</span>&nbsp;<span class="op" id="3861571">=</span>&nbsp;<span class="num" id="3861573">0xc007</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3861581">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3861621">uint16</span>&nbsp;<span class="op" id="3861628">=</span>&nbsp;<span class="num" id="3861630">0xc009</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3861638">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3861678">uint16</span>&nbsp;<span class="op" id="3861685">=</span>&nbsp;<span class="num" id="3861687">0xc00a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3861695">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3861735">uint16</span>&nbsp;<span class="op" id="3861742">=</span>&nbsp;<span class="num" id="3861744">0xc011</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3861752">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3861792">uint16</span>&nbsp;<span class="op" id="3861799">=</span>&nbsp;<span class="num" id="3861801">0xc012</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3861809">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3861849">uint16</span>&nbsp;<span class="op" id="3861856">=</span>&nbsp;<span class="num" id="3861858">0xc013</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3861866">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3861906">uint16</span>&nbsp;<span class="op" id="3861913">=</span>&nbsp;<span class="num" id="3861915">0xc014</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3861923">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3861963">uint16</span>&nbsp;<span class="op" id="3861970">=</span>&nbsp;<span class="num" id="3861972">0xc02f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3861980">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>&nbsp;<span class="builtintype" id="3862020">uint16</span>&nbsp;<span class="op" id="3862027">=</span>&nbsp;<span class="num" id="3862029">0xc02b</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3862038">//&nbsp;TLS_FALLBACK_SCSV&nbsp;isn&#39;t&nbsp;a&nbsp;standard&nbsp;cipher&nbsp;suite&nbsp;but&nbsp;an&nbsp;indicator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3862107">//&nbsp;that&nbsp;the&nbsp;client&nbsp;is&nbsp;doing&nbsp;version&nbsp;fallback.&nbsp;See</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3862158">//&nbsp;https://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3862224">TLS_FALLBACK_SCSV</span>&nbsp;<span class="builtintype" id="3862242">uint16</span>&nbsp;<span class="op" id="3862249">=</span>&nbsp;<span class="num" id="3862251">0x5600</span><br>
<span class="lineno">275</span><span class="op" id="3862258">)</span>
</div>
</body>
</html>
