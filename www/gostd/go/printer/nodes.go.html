<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/printer</h2>
<ul>
<li><a href="/gostd/go/printer/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/printer/nodes.go.html">nodes.go</a></li>
<li><a href="/gostd/go/printer/performance_test.go.html">performance_test.go</a></li>
<li><a href="/gostd/go/printer/printer.go.html">printer.go</a></li>
<li><a href="/gostd/go/printer/printer_test.go.html">printer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6078728">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6078783">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6078837">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6078888">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;printing&nbsp;of&nbsp;AST&nbsp;nodes;&nbsp;specifically</span><br>
<span class="lineno"></span><span class="comment" id="6078948">//&nbsp;expressions,&nbsp;statements,&nbsp;declarations,&nbsp;and&nbsp;files.&nbsp;It&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="6079009">//&nbsp;the&nbsp;print&nbsp;functionality&nbsp;implemented&nbsp;in&nbsp;printer.go.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6079064">package</span>&nbsp;<span class="ident" id="6079072">printer</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="6079081">import</span>&nbsp;<span class="op" id="6079088">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6079091">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6079100">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6079110">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6079122">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="6079137">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6079140">//&nbsp;Formatting&nbsp;issues:</span><br>
<span class="lineno"></span><span class="comment" id="6079162">//&nbsp;-&nbsp;better&nbsp;comment&nbsp;formatting&nbsp;for&nbsp;/*-style&nbsp;comments&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;(e.g.&nbsp;a&nbsp;declaration)</span><br>
<span class="lineno">20</span><span class="comment" id="6079257">//&nbsp;&nbsp;&nbsp;when&nbsp;the&nbsp;comment&nbsp;spans&nbsp;multiple&nbsp;lines;&nbsp;if&nbsp;such&nbsp;a&nbsp;comment&nbsp;is&nbsp;just&nbsp;two&nbsp;lines,&nbsp;formatting&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="6079352">//&nbsp;&nbsp;&nbsp;not&nbsp;idempotent</span><br>
<span class="lineno"></span><span class="comment" id="6079372">//&nbsp;-&nbsp;formatting&nbsp;of&nbsp;expression&nbsp;lists</span><br>
<span class="lineno"></span><span class="comment" id="6079408">//&nbsp;-&nbsp;should&nbsp;use&nbsp;blank&nbsp;instead&nbsp;of&nbsp;tab&nbsp;to&nbsp;separate&nbsp;one-line&nbsp;function&nbsp;bodies&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="6079487">//&nbsp;&nbsp;&nbsp;the&nbsp;function&nbsp;header&nbsp;unless&nbsp;there&nbsp;is&nbsp;a&nbsp;group&nbsp;of&nbsp;consecutive&nbsp;one-liners</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="6079563">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="6079643">//&nbsp;Common&nbsp;AST&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6079665">//&nbsp;Print&nbsp;as&nbsp;many&nbsp;newlines&nbsp;as&nbsp;necessary&nbsp;(but&nbsp;at&nbsp;least&nbsp;min&nbsp;newlines)&nbsp;to&nbsp;get&nbsp;to</span><br>
<span class="lineno">30</span><span class="comment" id="6079742">//&nbsp;the&nbsp;current&nbsp;line.&nbsp;ws&nbsp;is&nbsp;printed&nbsp;before&nbsp;the&nbsp;first&nbsp;line&nbsp;break.&nbsp;If&nbsp;newSection</span><br>
<span class="lineno"></span><span class="comment" id="6079820">//&nbsp;is&nbsp;set,&nbsp;the&nbsp;first&nbsp;line&nbsp;break&nbsp;is&nbsp;printed&nbsp;as&nbsp;formfeed.&nbsp;Returns&nbsp;true&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="6079896">//&nbsp;line&nbsp;break&nbsp;was&nbsp;printed;&nbsp;returns&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="6079948">//</span><br>
<span class="lineno"></span><span class="comment" id="6079951">//&nbsp;TODO(gri):&nbsp;linebreak&nbsp;may&nbsp;add&nbsp;too&nbsp;many&nbsp;lines&nbsp;if&nbsp;the&nbsp;next&nbsp;statement&nbsp;at&nbsp;&#34;line&#34;</span><br>
<span class="lineno">35</span><span class="comment" id="6080030">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;preceded&nbsp;by&nbsp;comments&nbsp;because&nbsp;the&nbsp;computation&nbsp;of&nbsp;n&nbsp;assumes</span><br>
<span class="lineno"></span><span class="comment" id="6080105">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;current&nbsp;position&nbsp;before&nbsp;the&nbsp;comment&nbsp;and&nbsp;the&nbsp;target&nbsp;position</span><br>
<span class="lineno"></span><span class="comment" id="6080183">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;after&nbsp;the&nbsp;comment.&nbsp;Thus,&nbsp;after&nbsp;interspersing&nbsp;such&nbsp;comments,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6080261">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space&nbsp;taken&nbsp;up&nbsp;by&nbsp;them&nbsp;is&nbsp;not&nbsp;considered&nbsp;to&nbsp;reduce&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="6080340">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linebreaks.&nbsp;At&nbsp;the&nbsp;moment&nbsp;there&nbsp;is&nbsp;no&nbsp;easy&nbsp;way&nbsp;to&nbsp;know&nbsp;about</span><br>
<span class="lineno">40</span><span class="comment" id="6080415">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;future&nbsp;(not&nbsp;yet&nbsp;interspersed)&nbsp;comments&nbsp;in&nbsp;this&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="6080486">//</span><br>
<span class="lineno"></span><span class="keyword" id="6080489">func</span>&nbsp;<span class="op" id="6080494">(</span><span class="ident" id="6080495">p</span>&nbsp;<span class="op" id="6080497">*</span><span class="ident" id="6080498">printer</span><span class="op" id="6080505">)</span>&nbsp;<span class="ident" id="6080507">linebreak</span><span class="op" id="6080516">(</span><span class="ident" id="6080517">line</span><span class="op" id="6080521">,</span>&nbsp;<span class="ident" id="6080523">min</span>&nbsp;<span class="builtintype" id="6080527">int</span><span class="op" id="6080530">,</span>&nbsp;<span class="ident" id="6080532">ws</span>&nbsp;<span class="ident" id="6080535">whiteSpace</span><span class="op" id="6080545">,</span>&nbsp;<span class="ident" id="6080547">newSection</span>&nbsp;<span class="builtintype" id="6080558">bool</span><span class="op" id="6080562">)</span>&nbsp;<span class="op" id="6080564">(</span><span class="ident" id="6080565">printedBreak</span>&nbsp;<span class="builtintype" id="6080578">bool</span><span class="op" id="6080582">)</span>&nbsp;<span class="op" id="6080584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6080587">n</span>&nbsp;<span class="op" id="6080589">:=</span>&nbsp;<span class="ident" id="6080592">nlimit</span><span class="op" id="6080598">(</span><span class="ident" id="6080599">line</span>&nbsp;<span class="op" id="6080604">-</span>&nbsp;<span class="ident" id="6080606">p</span><span class="op" id="6080607">.</span><span class="ident" id="6080608">pos</span><span class="op" id="6080611">.</span><span class="ident" id="6080612">Line</span><span class="op" id="6080616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080619">if</span>&nbsp;<span class="ident" id="6080622">n</span>&nbsp;<span class="op" id="6080624">&lt;</span>&nbsp;<span class="ident" id="6080626">min</span>&nbsp;<span class="op" id="6080630">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6080634">n</span>&nbsp;<span class="op" id="6080636">=</span>&nbsp;<span class="ident" id="6080638">min</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6080643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080646">if</span>&nbsp;<span class="ident" id="6080649">n</span>&nbsp;<span class="op" id="6080651">&gt;</span>&nbsp;<span class="num" id="6080653">0</span>&nbsp;<span class="op" id="6080655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6080659">p</span><span class="op" id="6080660">.</span><span class="builtinfunc" id="6080661">print</span><span class="op" id="6080666">(</span><span class="ident" id="6080667">ws</span><span class="op" id="6080669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080673">if</span>&nbsp;<span class="ident" id="6080676">newSection</span>&nbsp;<span class="op" id="6080687">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6080692">p</span><span class="op" id="6080693">.</span><span class="builtinfunc" id="6080694">print</span><span class="op" id="6080699">(</span><span class="ident" id="6080700">formfeed</span><span class="op" id="6080708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6080713">n</span><span class="op" id="6080714">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6080719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080723">for</span>&nbsp;<span class="op" id="6080727">;</span>&nbsp;<span class="ident" id="6080729">n</span>&nbsp;<span class="op" id="6080731">&gt;</span>&nbsp;<span class="num" id="6080733">0</span><span class="op" id="6080734">;</span>&nbsp;<span class="ident" id="6080736">n</span><span class="op" id="6080737">--</span>&nbsp;<span class="op" id="6080740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6080745">p</span><span class="op" id="6080746">.</span><span class="builtinfunc" id="6080747">print</span><span class="op" id="6080752">(</span><span class="ident" id="6080753">newline</span><span class="op" id="6080760">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6080764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6080768">printedBreak</span>&nbsp;<span class="op" id="6080781">=</span>&nbsp;<span class="builtintype" id="6080783">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6080789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6080792">return</span><br>
<span class="lineno"></span><span class="op" id="6080799">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="6080802">//&nbsp;setComment&nbsp;sets&nbsp;g&nbsp;as&nbsp;the&nbsp;next&nbsp;comment&nbsp;if&nbsp;g&nbsp;!=&nbsp;nil&nbsp;and&nbsp;if&nbsp;node&nbsp;comments</span><br>
<span class="lineno"></span><span class="comment" id="6080876">//&nbsp;are&nbsp;enabled&nbsp;-&nbsp;this&nbsp;mode&nbsp;is&nbsp;used&nbsp;when&nbsp;printing&nbsp;source&nbsp;code&nbsp;fragments&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="6080952">//&nbsp;as&nbsp;exports&nbsp;only.&nbsp;It&nbsp;assumes&nbsp;that&nbsp;there&nbsp;is&nbsp;no&nbsp;pending&nbsp;comment&nbsp;in&nbsp;p.comments</span><br>
<span class="lineno"></span><span class="comment" id="6081030">//&nbsp;and&nbsp;at&nbsp;most&nbsp;one&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache.</span><br>
<span class="lineno">65</span><span class="keyword" id="6081089">func</span>&nbsp;<span class="op" id="6081094">(</span><span class="ident" id="6081095">p</span>&nbsp;<span class="op" id="6081097">*</span><span class="ident" id="6081098">printer</span><span class="op" id="6081105">)</span>&nbsp;<span class="ident" id="6081107">setComment</span><span class="op" id="6081117">(</span><span class="ident" id="6081118">g</span>&nbsp;<span class="op" id="6081120">*</span><span class="ident" id="6081121">ast</span><span class="op" id="6081124">.</span><span class="ident" id="6081125">CommentGroup</span><span class="op" id="6081137">)</span>&nbsp;<span class="op" id="6081139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6081142">if</span>&nbsp;<span class="ident" id="6081145">g</span>&nbsp;<span class="op" id="6081147">==</span>&nbsp;<span class="ident" id="6081150">nil</span>&nbsp;<span class="op" id="6081154">||</span>&nbsp;<span class="op" id="6081157">!</span><span class="ident" id="6081158">p</span><span class="op" id="6081159">.</span><span class="ident" id="6081160">useNodeComments</span>&nbsp;<span class="op" id="6081176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6081180">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6081188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6081191">if</span>&nbsp;<span class="ident" id="6081194">p</span><span class="op" id="6081195">.</span><span class="ident" id="6081196">comments</span>&nbsp;<span class="op" id="6081205">==</span>&nbsp;<span class="ident" id="6081208">nil</span>&nbsp;<span class="op" id="6081212">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6081216">//&nbsp;initialize&nbsp;p.comments&nbsp;lazily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6081250">p</span><span class="op" id="6081251">.</span><span class="ident" id="6081252">comments</span>&nbsp;<span class="op" id="6081261">=</span>&nbsp;<span class="builtinfunc" id="6081263">make</span><span class="op" id="6081267">(</span><span class="op" id="6081268">[</span><span class="op" id="6081269">]</span><span class="op" id="6081270">*</span><span class="ident" id="6081271">ast</span><span class="op" id="6081274">.</span><span class="ident" id="6081275">CommentGroup</span><span class="op" id="6081287">,</span>&nbsp;<span class="num" id="6081289">1</span><span class="op" id="6081290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6081293">}</span>&nbsp;<span class="keyword" id="6081295">else</span>&nbsp;<span class="keyword" id="6081300">if</span>&nbsp;<span class="ident" id="6081303">p</span><span class="op" id="6081304">.</span><span class="ident" id="6081305">cindex</span>&nbsp;<span class="op" id="6081312">&lt;</span>&nbsp;<span class="builtinfunc" id="6081314">len</span><span class="op" id="6081317">(</span><span class="ident" id="6081318">p</span><span class="op" id="6081319">.</span><span class="ident" id="6081320">comments</span><span class="op" id="6081328">)</span>&nbsp;<span class="op" id="6081330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6081334">//&nbsp;for&nbsp;some&nbsp;reason&nbsp;there&nbsp;are&nbsp;pending&nbsp;comments;&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6081388">//&nbsp;should&nbsp;never&nbsp;happen&nbsp;-&nbsp;handle&nbsp;gracefully&nbsp;and&nbsp;flush</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6081443">//&nbsp;all&nbsp;comments&nbsp;up&nbsp;to&nbsp;g,&nbsp;ignore&nbsp;anything&nbsp;after&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6081497">p</span><span class="op" id="6081498">.</span><span class="ident" id="6081499">flush</span><span class="op" id="6081504">(</span><span class="ident" id="6081505">p</span><span class="op" id="6081506">.</span><span class="ident" id="6081507">posFor</span><span class="op" id="6081513">(</span><span class="ident" id="6081514">g</span><span class="op" id="6081515">.</span><span class="ident" id="6081516">List</span><span class="op" id="6081520">[</span><span class="num" id="6081521">0</span><span class="op" id="6081522">]</span><span class="op" id="6081523">.</span><span class="ident" id="6081524">Pos</span><span class="op" id="6081527">(</span><span class="op" id="6081528">)</span><span class="op" id="6081529">)</span><span class="op" id="6081530">,</span>&nbsp;<span class="ident" id="6081532">token</span><span class="op" id="6081537">.</span><span class="ident" id="6081538">ILLEGAL</span><span class="op" id="6081545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6081549">p</span><span class="op" id="6081550">.</span><span class="ident" id="6081551">comments</span>&nbsp;<span class="op" id="6081560">=</span>&nbsp;<span class="ident" id="6081562">p</span><span class="op" id="6081563">.</span><span class="ident" id="6081564">comments</span><span class="op" id="6081572">[</span><span class="num" id="6081573">0</span><span class="op" id="6081574">:</span><span class="num" id="6081575">1</span><span class="op" id="6081576">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6081580">//&nbsp;in&nbsp;debug&nbsp;mode,&nbsp;report&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6081613">p</span><span class="op" id="6081614">.</span><span class="ident" id="6081615">internalError</span><span class="op" id="6081628">(</span><span class="string" id="6081629">&#34;setComment&nbsp;found&nbsp;pending&nbsp;comments&#34;</span><span class="op" id="6081664">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6081667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6081670">p</span><span class="op" id="6081671">.</span><span class="ident" id="6081672">comments</span><span class="op" id="6081680">[</span><span class="num" id="6081681">0</span><span class="op" id="6081682">]</span>&nbsp;<span class="op" id="6081684">=</span>&nbsp;<span class="ident" id="6081686">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6081689">p</span><span class="op" id="6081690">.</span><span class="ident" id="6081691">cindex</span>&nbsp;<span class="op" id="6081698">=</span>&nbsp;<span class="num" id="6081700">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6081703">//&nbsp;don&#39;t&nbsp;overwrite&nbsp;any&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6081766">//&nbsp;(there&nbsp;may&nbsp;be&nbsp;a&nbsp;pending&nbsp;comment&nbsp;when&nbsp;a&nbsp;line&nbsp;comment&nbsp;is</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6081825">//&nbsp;immediately&nbsp;followed&nbsp;by&nbsp;a&nbsp;lead&nbsp;comment&nbsp;with&nbsp;no&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6081882">//&nbsp;tokens&nbsp;between)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6081902">if</span>&nbsp;<span class="ident" id="6081905">p</span><span class="op" id="6081906">.</span><span class="ident" id="6081907">commentOffset</span>&nbsp;<span class="op" id="6081921">==</span>&nbsp;<span class="ident" id="6081924">infinity</span>&nbsp;<span class="op" id="6081933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6081937">p</span><span class="op" id="6081938">.</span><span class="ident" id="6081939">nextComment</span><span class="op" id="6081950">(</span><span class="op" id="6081951">)</span>&nbsp;<span class="comment" id="6081953">//&nbsp;get&nbsp;comment&nbsp;ready&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6081983">}</span><br>
<span class="lineno">90</span><span class="op" id="6081985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6081988">type</span>&nbsp;<span class="ident" id="6081993">exprListMode</span>&nbsp;<span class="builtintype" id="6082006">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6082012">const</span>&nbsp;<span class="op" id="6082018">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082021">commaTerm</span>&nbsp;<span class="ident" id="6082031">exprListMode</span>&nbsp;<span class="op" id="6082044">=</span>&nbsp;<span class="num" id="6082046">1</span>&nbsp;<span class="op" id="6082048">&lt;&lt;</span>&nbsp;<span class="ident" id="6082051">iota</span>&nbsp;<span class="comment" id="6082056">//&nbsp;list&nbsp;is&nbsp;optionally&nbsp;terminated&nbsp;by&nbsp;a&nbsp;comma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082101">noIndent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6082136">//&nbsp;no&nbsp;extra&nbsp;indentation&nbsp;in&nbsp;multi-line&nbsp;lists</span><br>
<span class="lineno"></span><span class="op" id="6082180">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6082183">//&nbsp;If&nbsp;indent&nbsp;is&nbsp;set,&nbsp;a&nbsp;multi-line&nbsp;identifier&nbsp;list&nbsp;is&nbsp;indented&nbsp;after&nbsp;the</span><br>
<span class="lineno">100</span><span class="comment" id="6082255">//&nbsp;first&nbsp;linebreak&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="6082287">func</span>&nbsp;<span class="op" id="6082292">(</span><span class="ident" id="6082293">p</span>&nbsp;<span class="op" id="6082295">*</span><span class="ident" id="6082296">printer</span><span class="op" id="6082303">)</span>&nbsp;<span class="ident" id="6082305">identList</span><span class="op" id="6082314">(</span><span class="ident" id="6082315">list</span>&nbsp;<span class="op" id="6082320">[</span><span class="op" id="6082321">]</span><span class="op" id="6082322">*</span><span class="ident" id="6082323">ast</span><span class="op" id="6082326">.</span><span class="ident" id="6082327">Ident</span><span class="op" id="6082332">,</span>&nbsp;<span class="ident" id="6082334">indent</span>&nbsp;<span class="builtintype" id="6082341">bool</span><span class="op" id="6082345">)</span>&nbsp;<span class="op" id="6082347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6082350">//&nbsp;convert&nbsp;into&nbsp;an&nbsp;expression&nbsp;list&nbsp;so&nbsp;we&nbsp;can&nbsp;re-use&nbsp;exprList&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082423">xlist</span>&nbsp;<span class="op" id="6082429">:=</span>&nbsp;<span class="builtinfunc" id="6082432">make</span><span class="op" id="6082436">(</span><span class="op" id="6082437">[</span><span class="op" id="6082438">]</span><span class="ident" id="6082439">ast</span><span class="op" id="6082442">.</span><span class="ident" id="6082443">Expr</span><span class="op" id="6082447">,</span>&nbsp;<span class="builtinfunc" id="6082449">len</span><span class="op" id="6082452">(</span><span class="ident" id="6082453">list</span><span class="op" id="6082457">)</span><span class="op" id="6082458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6082461">for</span>&nbsp;<span class="ident" id="6082465">i</span><span class="op" id="6082466">,</span>&nbsp;<span class="ident" id="6082468">x</span>&nbsp;<span class="op" id="6082470">:=</span>&nbsp;<span class="keyword" id="6082473">range</span>&nbsp;<span class="ident" id="6082479">list</span>&nbsp;<span class="op" id="6082484">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082488">xlist</span><span class="op" id="6082493">[</span><span class="ident" id="6082494">i</span><span class="op" id="6082495">]</span>&nbsp;<span class="op" id="6082497">=</span>&nbsp;<span class="ident" id="6082499">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6082502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6082505">var</span>&nbsp;<span class="ident" id="6082509">mode</span>&nbsp;<span class="ident" id="6082514">exprListMode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6082528">if</span>&nbsp;<span class="op" id="6082531">!</span><span class="ident" id="6082532">indent</span>&nbsp;<span class="op" id="6082539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082543">mode</span>&nbsp;<span class="op" id="6082548">=</span>&nbsp;<span class="ident" id="6082550">noIndent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6082560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6082563">p</span><span class="op" id="6082564">.</span><span class="ident" id="6082565">exprList</span><span class="op" id="6082573">(</span><span class="ident" id="6082574">token</span><span class="op" id="6082579">.</span><span class="ident" id="6082580">NoPos</span><span class="op" id="6082585">,</span>&nbsp;<span class="ident" id="6082587">xlist</span><span class="op" id="6082592">,</span>&nbsp;<span class="num" id="6082594">1</span><span class="op" id="6082595">,</span>&nbsp;<span class="ident" id="6082597">mode</span><span class="op" id="6082601">,</span>&nbsp;<span class="ident" id="6082603">token</span><span class="op" id="6082608">.</span><span class="ident" id="6082609">NoPos</span><span class="op" id="6082614">)</span><br>
<span class="lineno"></span><span class="op" id="6082616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6082619">//&nbsp;Print&nbsp;a&nbsp;list&nbsp;of&nbsp;expressions.&nbsp;If&nbsp;the&nbsp;list&nbsp;spans&nbsp;multiple</span><br>
<span class="lineno">115</span><span class="comment" id="6082678">//&nbsp;source&nbsp;lines,&nbsp;the&nbsp;original&nbsp;line&nbsp;breaks&nbsp;are&nbsp;respected&nbsp;between</span><br>
<span class="lineno"></span><span class="comment" id="6082742">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="comment" id="6082758">//</span><br>
<span class="lineno"></span><span class="comment" id="6082761">//&nbsp;TODO(gri)&nbsp;Consider&nbsp;rewriting&nbsp;this&nbsp;to&nbsp;be&nbsp;independent&nbsp;of&nbsp;[]ast.Expr</span><br>
<span class="lineno"></span><span class="comment" id="6082830">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;use&nbsp;the&nbsp;algorithm&nbsp;for&nbsp;any&nbsp;kind&nbsp;of&nbsp;list</span><br>
<span class="lineno">120</span><span class="comment" id="6082897">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(e.g.,&nbsp;pass&nbsp;list&nbsp;via&nbsp;a&nbsp;channel&nbsp;over&nbsp;which&nbsp;to&nbsp;range).</span><br>
<span class="lineno"></span><span class="keyword" id="6082963">func</span>&nbsp;<span class="op" id="6082968">(</span><span class="ident" id="6082969">p</span>&nbsp;<span class="op" id="6082971">*</span><span class="ident" id="6082972">printer</span><span class="op" id="6082979">)</span>&nbsp;<span class="ident" id="6082981">exprList</span><span class="op" id="6082989">(</span><span class="ident" id="6082990">prev0</span>&nbsp;<span class="ident" id="6082996">token</span><span class="op" id="6083001">.</span><span class="ident" id="6083002">Pos</span><span class="op" id="6083005">,</span>&nbsp;<span class="ident" id="6083007">list</span>&nbsp;<span class="op" id="6083012">[</span><span class="op" id="6083013">]</span><span class="ident" id="6083014">ast</span><span class="op" id="6083017">.</span><span class="ident" id="6083018">Expr</span><span class="op" id="6083022">,</span>&nbsp;<span class="ident" id="6083024">depth</span>&nbsp;<span class="builtintype" id="6083030">int</span><span class="op" id="6083033">,</span>&nbsp;<span class="ident" id="6083035">mode</span>&nbsp;<span class="ident" id="6083040">exprListMode</span><span class="op" id="6083052">,</span>&nbsp;<span class="ident" id="6083054">next0</span>&nbsp;<span class="ident" id="6083060">token</span><span class="op" id="6083065">.</span><span class="ident" id="6083066">Pos</span><span class="op" id="6083069">)</span>&nbsp;<span class="op" id="6083071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6083074">if</span>&nbsp;<span class="builtinfunc" id="6083077">len</span><span class="op" id="6083080">(</span><span class="ident" id="6083081">list</span><span class="op" id="6083085">)</span>&nbsp;<span class="op" id="6083087">==</span>&nbsp;<span class="num" id="6083090">0</span>&nbsp;<span class="op" id="6083092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6083096">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6083104">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083108">prev</span>&nbsp;<span class="op" id="6083113">:=</span>&nbsp;<span class="ident" id="6083116">p</span><span class="op" id="6083117">.</span><span class="ident" id="6083118">posFor</span><span class="op" id="6083124">(</span><span class="ident" id="6083125">prev0</span><span class="op" id="6083130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083133">next</span>&nbsp;<span class="op" id="6083138">:=</span>&nbsp;<span class="ident" id="6083141">p</span><span class="op" id="6083142">.</span><span class="ident" id="6083143">posFor</span><span class="op" id="6083149">(</span><span class="ident" id="6083150">next0</span><span class="op" id="6083155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083158">line</span>&nbsp;<span class="op" id="6083163">:=</span>&nbsp;<span class="ident" id="6083166">p</span><span class="op" id="6083167">.</span><span class="ident" id="6083168">lineFor</span><span class="op" id="6083175">(</span><span class="ident" id="6083176">list</span><span class="op" id="6083180">[</span><span class="num" id="6083181">0</span><span class="op" id="6083182">]</span><span class="op" id="6083183">.</span><span class="ident" id="6083184">Pos</span><span class="op" id="6083187">(</span><span class="op" id="6083188">)</span><span class="op" id="6083189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083192">endLine</span>&nbsp;<span class="op" id="6083200">:=</span>&nbsp;<span class="ident" id="6083203">p</span><span class="op" id="6083204">.</span><span class="ident" id="6083205">lineFor</span><span class="op" id="6083212">(</span><span class="ident" id="6083213">list</span><span class="op" id="6083217">[</span><span class="builtinfunc" id="6083218">len</span><span class="op" id="6083221">(</span><span class="ident" id="6083222">list</span><span class="op" id="6083226">)</span><span class="op" id="6083227">-</span><span class="num" id="6083228">1</span><span class="op" id="6083229">]</span><span class="op" id="6083230">.</span><span class="ident" id="6083231">End</span><span class="op" id="6083234">(</span><span class="op" id="6083235">)</span><span class="op" id="6083236">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6083240">if</span>&nbsp;<span class="ident" id="6083243">prev</span><span class="op" id="6083247">.</span><span class="ident" id="6083248">IsValid</span><span class="op" id="6083255">(</span><span class="op" id="6083256">)</span>&nbsp;<span class="op" id="6083258">&amp;&amp;</span>&nbsp;<span class="ident" id="6083261">prev</span><span class="op" id="6083265">.</span><span class="ident" id="6083266">Line</span>&nbsp;<span class="op" id="6083271">==</span>&nbsp;<span class="ident" id="6083274">line</span>&nbsp;<span class="op" id="6083279">&amp;&amp;</span>&nbsp;<span class="ident" id="6083282">line</span>&nbsp;<span class="op" id="6083287">==</span>&nbsp;<span class="ident" id="6083290">endLine</span>&nbsp;<span class="op" id="6083298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6083302">//&nbsp;all&nbsp;list&nbsp;entries&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6083341">for</span>&nbsp;<span class="ident" id="6083345">i</span><span class="op" id="6083346">,</span>&nbsp;<span class="ident" id="6083348">x</span>&nbsp;<span class="op" id="6083350">:=</span>&nbsp;<span class="keyword" id="6083353">range</span>&nbsp;<span class="ident" id="6083359">list</span>&nbsp;<span class="op" id="6083364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6083369">if</span>&nbsp;<span class="ident" id="6083372">i</span>&nbsp;<span class="op" id="6083374">&gt;</span>&nbsp;<span class="num" id="6083376">0</span>&nbsp;<span class="op" id="6083378">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6083384">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6083441">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083493">p</span><span class="op" id="6083494">.</span><span class="builtinfunc" id="6083495">print</span><span class="op" id="6083500">(</span><span class="ident" id="6083501">x</span><span class="op" id="6083502">.</span><span class="ident" id="6083503">Pos</span><span class="op" id="6083506">(</span><span class="op" id="6083507">)</span><span class="op" id="6083508">,</span>&nbsp;<span class="ident" id="6083510">token</span><span class="op" id="6083515">.</span><span class="ident" id="6083516">COMMA</span><span class="op" id="6083521">,</span>&nbsp;<span class="ident" id="6083523">blank</span><span class="op" id="6083528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6083533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083538">p</span><span class="op" id="6083539">.</span><span class="ident" id="6083540">expr0</span><span class="op" id="6083545">(</span><span class="ident" id="6083546">x</span><span class="op" id="6083547">,</span>&nbsp;<span class="ident" id="6083549">depth</span><span class="op" id="6083554">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6083558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6083562">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6083570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6083574">//&nbsp;list&nbsp;entries&nbsp;span&nbsp;multiple&nbsp;lines;</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6083612">//&nbsp;use&nbsp;source&nbsp;code&nbsp;positions&nbsp;to&nbsp;guide&nbsp;line&nbsp;breaks</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6083664">//&nbsp;don&#39;t&nbsp;add&nbsp;extra&nbsp;indentation&nbsp;if&nbsp;noIndent&nbsp;is&nbsp;set;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6083716">//&nbsp;i.e.,&nbsp;pretend&nbsp;that&nbsp;the&nbsp;first&nbsp;line&nbsp;is&nbsp;already&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083774">ws</span>&nbsp;<span class="op" id="6083777">:=</span>&nbsp;<span class="ident" id="6083780">ignore</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6083788">if</span>&nbsp;<span class="ident" id="6083791">mode</span><span class="op" id="6083795">&amp;</span><span class="ident" id="6083796">noIndent</span>&nbsp;<span class="op" id="6083805">==</span>&nbsp;<span class="num" id="6083808">0</span>&nbsp;<span class="op" id="6083810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083814">ws</span>&nbsp;<span class="op" id="6083817">=</span>&nbsp;<span class="ident" id="6083819">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6083827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6083831">//&nbsp;the&nbsp;first&nbsp;linebreak&nbsp;is&nbsp;always&nbsp;a&nbsp;formfeed&nbsp;since&nbsp;this&nbsp;section&nbsp;must&nbsp;not</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6083904">//&nbsp;depend&nbsp;on&nbsp;any&nbsp;previous&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6083942">prevBreak</span>&nbsp;<span class="op" id="6083952">:=</span>&nbsp;<span class="op" id="6083955">-</span><span class="num" id="6083956">1</span>&nbsp;<span class="comment" id="6083958">//&nbsp;index&nbsp;of&nbsp;last&nbsp;expression&nbsp;that&nbsp;was&nbsp;followed&nbsp;by&nbsp;a&nbsp;linebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6084020">if</span>&nbsp;<span class="ident" id="6084023">prev</span><span class="op" id="6084027">.</span><span class="ident" id="6084028">IsValid</span><span class="op" id="6084035">(</span><span class="op" id="6084036">)</span>&nbsp;<span class="op" id="6084038">&amp;&amp;</span>&nbsp;<span class="ident" id="6084041">prev</span><span class="op" id="6084045">.</span><span class="ident" id="6084046">Line</span>&nbsp;<span class="op" id="6084051">&lt;</span>&nbsp;<span class="ident" id="6084053">line</span>&nbsp;<span class="op" id="6084058">&amp;&amp;</span>&nbsp;<span class="ident" id="6084061">p</span><span class="op" id="6084062">.</span><span class="ident" id="6084063">linebreak</span><span class="op" id="6084072">(</span><span class="ident" id="6084073">line</span><span class="op" id="6084077">,</span>&nbsp;<span class="num" id="6084079">0</span><span class="op" id="6084080">,</span>&nbsp;<span class="ident" id="6084082">ws</span><span class="op" id="6084084">,</span>&nbsp;<span class="builtintype" id="6084086">true</span><span class="op" id="6084090">)</span>&nbsp;<span class="op" id="6084092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6084096">ws</span>&nbsp;<span class="op" id="6084099">=</span>&nbsp;<span class="ident" id="6084101">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6084110">prevBreak</span>&nbsp;<span class="op" id="6084120">=</span>&nbsp;<span class="num" id="6084122">0</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6084125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6084129">//&nbsp;initialize&nbsp;expression/key&nbsp;size:&nbsp;a&nbsp;zero&nbsp;value&nbsp;indicates&nbsp;expr/key&nbsp;doesn&#39;t&nbsp;fit&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6084226">size</span>&nbsp;<span class="op" id="6084231">:=</span>&nbsp;<span class="num" id="6084234">0</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6084238">//&nbsp;print&nbsp;all&nbsp;list&nbsp;elements</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6084266">prevLine</span>&nbsp;<span class="op" id="6084275">:=</span>&nbsp;<span class="ident" id="6084278">prev</span><span class="op" id="6084282">.</span><span class="ident" id="6084283">Line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6084289">for</span>&nbsp;<span class="ident" id="6084293">i</span><span class="op" id="6084294">,</span>&nbsp;<span class="ident" id="6084296">x</span>&nbsp;<span class="op" id="6084298">:=</span>&nbsp;<span class="keyword" id="6084301">range</span>&nbsp;<span class="ident" id="6084307">list</span>&nbsp;<span class="op" id="6084312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6084316">line</span>&nbsp;<span class="op" id="6084321">=</span>&nbsp;<span class="ident" id="6084323">p</span><span class="op" id="6084324">.</span><span class="ident" id="6084325">lineFor</span><span class="op" id="6084332">(</span><span class="ident" id="6084333">x</span><span class="op" id="6084334">.</span><span class="ident" id="6084335">Pos</span><span class="op" id="6084338">(</span><span class="op" id="6084339">)</span><span class="op" id="6084340">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6084345">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;next&nbsp;linebreak,&nbsp;if&nbsp;any,&nbsp;needs&nbsp;to&nbsp;use&nbsp;formfeed:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6084414">//&nbsp;in&nbsp;general,&nbsp;use&nbsp;the&nbsp;entire&nbsp;node&nbsp;size&nbsp;to&nbsp;make&nbsp;the&nbsp;decision;&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6084482">//&nbsp;key:value&nbsp;expressions,&nbsp;use&nbsp;the&nbsp;key&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6084527">//&nbsp;TODO(gri)&nbsp;for&nbsp;a&nbsp;better&nbsp;result,&nbsp;should&nbsp;probably&nbsp;incorporate&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6084596">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;key&nbsp;and&nbsp;the&nbsp;node&nbsp;size&nbsp;into&nbsp;the&nbsp;decision&nbsp;process</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6084663">useFF</span>&nbsp;<span class="op" id="6084669">:=</span>&nbsp;<span class="builtintype" id="6084672">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6084680">//&nbsp;determine&nbsp;element&nbsp;size:&nbsp;all&nbsp;bets&nbsp;are&nbsp;off&nbsp;if&nbsp;we&nbsp;don&#39;t&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6084743">//&nbsp;position&nbsp;information&nbsp;for&nbsp;the&nbsp;previous&nbsp;and&nbsp;next&nbsp;token&nbsp;(likely</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6084809">//&nbsp;generated&nbsp;code&nbsp;-&nbsp;simply&nbsp;ignore&nbsp;the&nbsp;size&nbsp;in&nbsp;this&nbsp;case&nbsp;by&nbsp;setting</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6084878">//&nbsp;it&nbsp;to&nbsp;0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6084892">prevSize</span>&nbsp;<span class="op" id="6084901">:=</span>&nbsp;<span class="ident" id="6084904">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6084911">const</span>&nbsp;<span class="ident" id="6084917">infinity</span>&nbsp;<span class="op" id="6084926">=</span>&nbsp;<span class="num" id="6084928">1e6</span>&nbsp;<span class="comment" id="6084932">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;source&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6084965">size</span>&nbsp;<span class="op" id="6084970">=</span>&nbsp;<span class="ident" id="6084972">p</span><span class="op" id="6084973">.</span><span class="ident" id="6084974">nodeSize</span><span class="op" id="6084982">(</span><span class="ident" id="6084983">x</span><span class="op" id="6084984">,</span>&nbsp;<span class="ident" id="6084986">infinity</span><span class="op" id="6084994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6084998">pair</span><span class="op" id="6085002">,</span>&nbsp;<span class="ident" id="6085004">isPair</span>&nbsp;<span class="op" id="6085011">:=</span>&nbsp;<span class="ident" id="6085014">x</span><span class="op" id="6085015">.</span><span class="op" id="6085016">(</span><span class="op" id="6085017">*</span><span class="ident" id="6085018">ast</span><span class="op" id="6085021">.</span><span class="ident" id="6085022">KeyValueExpr</span><span class="op" id="6085034">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085038">if</span>&nbsp;<span class="ident" id="6085041">size</span>&nbsp;<span class="op" id="6085046">&lt;=</span>&nbsp;<span class="ident" id="6085049">infinity</span>&nbsp;<span class="op" id="6085058">&amp;&amp;</span>&nbsp;<span class="ident" id="6085061">prev</span><span class="op" id="6085065">.</span><span class="ident" id="6085066">IsValid</span><span class="op" id="6085073">(</span><span class="op" id="6085074">)</span>&nbsp;<span class="op" id="6085076">&amp;&amp;</span>&nbsp;<span class="ident" id="6085079">next</span><span class="op" id="6085083">.</span><span class="ident" id="6085084">IsValid</span><span class="op" id="6085091">(</span><span class="op" id="6085092">)</span>&nbsp;<span class="op" id="6085094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6085099">//&nbsp;x&nbsp;fits&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085129">if</span>&nbsp;<span class="ident" id="6085132">isPair</span>&nbsp;<span class="op" id="6085139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6085145">size</span>&nbsp;<span class="op" id="6085150">=</span>&nbsp;<span class="ident" id="6085152">p</span><span class="op" id="6085153">.</span><span class="ident" id="6085154">nodeSize</span><span class="op" id="6085162">(</span><span class="ident" id="6085163">pair</span><span class="op" id="6085167">.</span><span class="ident" id="6085168">Key</span><span class="op" id="6085171">,</span>&nbsp;<span class="ident" id="6085173">infinity</span><span class="op" id="6085181">)</span>&nbsp;<span class="comment" id="6085183">//&nbsp;size&nbsp;&lt;=&nbsp;infinity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6085206">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6085210">}</span>&nbsp;<span class="keyword" id="6085212">else</span>&nbsp;<span class="op" id="6085217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6085222">//&nbsp;size&nbsp;too&nbsp;large&nbsp;or&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;good&nbsp;layout&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6085284">size</span>&nbsp;<span class="op" id="6085289">=</span>&nbsp;<span class="num" id="6085291">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6085295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6085300">//&nbsp;if&nbsp;the&nbsp;previous&nbsp;line&nbsp;and&nbsp;the&nbsp;current&nbsp;line&nbsp;had&nbsp;single-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6085359">//&nbsp;line-expressions&nbsp;and&nbsp;the&nbsp;key&nbsp;sizes&nbsp;are&nbsp;small&nbsp;or&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6085416">//&nbsp;the&nbsp;ratio&nbsp;between&nbsp;the&nbsp;key&nbsp;sizes&nbsp;does&nbsp;not&nbsp;exceed&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6085471">//&nbsp;threshold,&nbsp;align&nbsp;columns&nbsp;and&nbsp;do&nbsp;not&nbsp;use&nbsp;formfeed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085525">if</span>&nbsp;<span class="ident" id="6085528">prevSize</span>&nbsp;<span class="op" id="6085537">&gt;</span>&nbsp;<span class="num" id="6085539">0</span>&nbsp;<span class="op" id="6085541">&amp;&amp;</span>&nbsp;<span class="ident" id="6085544">size</span>&nbsp;<span class="op" id="6085549">&gt;</span>&nbsp;<span class="num" id="6085551">0</span>&nbsp;<span class="op" id="6085553">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085558">const</span>&nbsp;<span class="ident" id="6085564">smallSize</span>&nbsp;<span class="op" id="6085574">=</span>&nbsp;<span class="num" id="6085576">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085582">if</span>&nbsp;<span class="ident" id="6085585">prevSize</span>&nbsp;<span class="op" id="6085594">&lt;=</span>&nbsp;<span class="ident" id="6085597">smallSize</span>&nbsp;<span class="op" id="6085607">&amp;&amp;</span>&nbsp;<span class="ident" id="6085610">size</span>&nbsp;<span class="op" id="6085615">&lt;=</span>&nbsp;<span class="ident" id="6085618">smallSize</span>&nbsp;<span class="op" id="6085628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6085634">useFF</span>&nbsp;<span class="op" id="6085640">=</span>&nbsp;<span class="builtintype" id="6085642">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6085651">}</span>&nbsp;<span class="keyword" id="6085653">else</span>&nbsp;<span class="op" id="6085658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085664">const</span>&nbsp;<span class="ident" id="6085670">r</span>&nbsp;<span class="op" id="6085672">=</span>&nbsp;<span class="num" id="6085674">4</span>&nbsp;<span class="comment" id="6085676">//&nbsp;threshold</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6085693">ratio</span>&nbsp;<span class="op" id="6085699">:=</span>&nbsp;<span class="builtintype" id="6085702">float64</span><span class="op" id="6085709">(</span><span class="ident" id="6085710">size</span><span class="op" id="6085714">)</span>&nbsp;<span class="op" id="6085716">/</span>&nbsp;<span class="builtintype" id="6085718">float64</span><span class="op" id="6085725">(</span><span class="ident" id="6085726">prevSize</span><span class="op" id="6085734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6085740">useFF</span>&nbsp;<span class="op" id="6085746">=</span>&nbsp;<span class="ident" id="6085748">ratio</span>&nbsp;<span class="op" id="6085754">&lt;=</span>&nbsp;<span class="num" id="6085757">1.0</span><span class="op" id="6085760">/</span><span class="ident" id="6085761">r</span>&nbsp;<span class="op" id="6085763">||</span>&nbsp;<span class="ident" id="6085766">r</span>&nbsp;<span class="op" id="6085768">&lt;=</span>&nbsp;<span class="ident" id="6085771">ratio</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6085780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6085784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6085789">needsLinebreak</span>&nbsp;<span class="op" id="6085804">:=</span>&nbsp;<span class="num" id="6085807">0</span>&nbsp;<span class="op" id="6085809">&lt;</span>&nbsp;<span class="ident" id="6085811">prevLine</span>&nbsp;<span class="op" id="6085820">&amp;&amp;</span>&nbsp;<span class="ident" id="6085823">prevLine</span>&nbsp;<span class="op" id="6085832">&lt;</span>&nbsp;<span class="ident" id="6085834">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6085841">if</span>&nbsp;<span class="ident" id="6085844">i</span>&nbsp;<span class="op" id="6085846">&gt;</span>&nbsp;<span class="num" id="6085848">0</span>&nbsp;<span class="op" id="6085850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6085855">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6085911">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6085967">//&nbsp;only&nbsp;if&nbsp;the&nbsp;expression&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086016">if</span>&nbsp;<span class="op" id="6086019">!</span><span class="ident" id="6086020">needsLinebreak</span>&nbsp;<span class="op" id="6086035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6086041">p</span><span class="op" id="6086042">.</span><span class="builtinfunc" id="6086043">print</span><span class="op" id="6086048">(</span><span class="ident" id="6086049">x</span><span class="op" id="6086050">.</span><span class="ident" id="6086051">Pos</span><span class="op" id="6086054">(</span><span class="op" id="6086055">)</span><span class="op" id="6086056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6086061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6086066">p</span><span class="op" id="6086067">.</span><span class="builtinfunc" id="6086068">print</span><span class="op" id="6086073">(</span><span class="ident" id="6086074">token</span><span class="op" id="6086079">.</span><span class="ident" id="6086080">COMMA</span><span class="op" id="6086085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6086090">needsBlank</span>&nbsp;<span class="op" id="6086101">:=</span>&nbsp;<span class="builtintype" id="6086104">true</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086112">if</span>&nbsp;<span class="ident" id="6086115">needsLinebreak</span>&nbsp;<span class="op" id="6086130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6086136">//&nbsp;lines&nbsp;are&nbsp;broken&nbsp;using&nbsp;newlines&nbsp;so&nbsp;comments&nbsp;remain&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6086202">//&nbsp;unless&nbsp;forceFF&nbsp;is&nbsp;set&nbsp;or&nbsp;there&nbsp;are&nbsp;multiple&nbsp;expressions&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6086268">//&nbsp;the&nbsp;same&nbsp;line&nbsp;in&nbsp;which&nbsp;case&nbsp;formfeed&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086320">if</span>&nbsp;<span class="ident" id="6086323">p</span><span class="op" id="6086324">.</span><span class="ident" id="6086325">linebreak</span><span class="op" id="6086334">(</span><span class="ident" id="6086335">line</span><span class="op" id="6086339">,</span>&nbsp;<span class="num" id="6086341">0</span><span class="op" id="6086342">,</span>&nbsp;<span class="ident" id="6086344">ws</span><span class="op" id="6086346">,</span>&nbsp;<span class="ident" id="6086348">useFF</span>&nbsp;<span class="op" id="6086354">||</span>&nbsp;<span class="ident" id="6086357">prevBreak</span><span class="op" id="6086366">+</span><span class="num" id="6086367">1</span>&nbsp;<span class="op" id="6086369">&lt;</span>&nbsp;<span class="ident" id="6086371">i</span><span class="op" id="6086372">)</span>&nbsp;<span class="op" id="6086374">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6086381">ws</span>&nbsp;<span class="op" id="6086384">=</span>&nbsp;<span class="ident" id="6086386">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6086398">prevBreak</span>&nbsp;<span class="op" id="6086408">=</span>&nbsp;<span class="ident" id="6086410">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6086417">needsBlank</span>&nbsp;<span class="op" id="6086428">=</span>&nbsp;<span class="builtintype" id="6086430">false</span>&nbsp;<span class="comment" id="6086436">//&nbsp;we&nbsp;got&nbsp;a&nbsp;line&nbsp;break&nbsp;instead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6086471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6086476">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086481">if</span>&nbsp;<span class="ident" id="6086484">needsBlank</span>&nbsp;<span class="op" id="6086495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6086501">p</span><span class="op" id="6086502">.</span><span class="builtinfunc" id="6086503">print</span><span class="op" id="6086508">(</span><span class="ident" id="6086509">blank</span><span class="op" id="6086514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6086519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6086523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6086528">if</span>&nbsp;<span class="builtinfunc" id="6086531">len</span><span class="op" id="6086534">(</span><span class="ident" id="6086535">list</span><span class="op" id="6086539">)</span>&nbsp;<span class="op" id="6086541">&gt;</span>&nbsp;<span class="num" id="6086543">1</span>&nbsp;<span class="op" id="6086545">&amp;&amp;</span>&nbsp;<span class="ident" id="6086548">isPair</span>&nbsp;<span class="op" id="6086555">&amp;&amp;</span>&nbsp;<span class="ident" id="6086558">size</span>&nbsp;<span class="op" id="6086563">&gt;</span>&nbsp;<span class="num" id="6086565">0</span>&nbsp;<span class="op" id="6086567">&amp;&amp;</span>&nbsp;<span class="ident" id="6086570">needsLinebreak</span>&nbsp;<span class="op" id="6086585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6086590">//&nbsp;we&nbsp;have&nbsp;a&nbsp;key:value&nbsp;expression&nbsp;that&nbsp;fits&nbsp;onto&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6086651">//&nbsp;and&nbsp;it&#39;s&nbsp;not&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;prior&nbsp;expression:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6086712">//&nbsp;use&nbsp;a&nbsp;column&nbsp;for&nbsp;the&nbsp;key&nbsp;such&nbsp;that&nbsp;consecutive&nbsp;entries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6086773">//&nbsp;can&nbsp;align&nbsp;if&nbsp;possible</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6086801">//&nbsp;(needsLinebreak&nbsp;is&nbsp;set&nbsp;if&nbsp;we&nbsp;started&nbsp;a&nbsp;new&nbsp;line&nbsp;before)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6086863">p</span><span class="op" id="6086864">.</span><span class="ident" id="6086865">expr</span><span class="op" id="6086869">(</span><span class="ident" id="6086870">pair</span><span class="op" id="6086874">.</span><span class="ident" id="6086875">Key</span><span class="op" id="6086878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6086883">p</span><span class="op" id="6086884">.</span><span class="builtinfunc" id="6086885">print</span><span class="op" id="6086890">(</span><span class="ident" id="6086891">pair</span><span class="op" id="6086895">.</span><span class="ident" id="6086896">Colon</span><span class="op" id="6086901">,</span>&nbsp;<span class="ident" id="6086903">token</span><span class="op" id="6086908">.</span><span class="ident" id="6086909">COLON</span><span class="op" id="6086914">,</span>&nbsp;<span class="ident" id="6086916">vtab</span><span class="op" id="6086920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6086925">p</span><span class="op" id="6086926">.</span><span class="ident" id="6086927">expr</span><span class="op" id="6086931">(</span><span class="ident" id="6086932">pair</span><span class="op" id="6086936">.</span><span class="ident" id="6086937">Value</span><span class="op" id="6086942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6086946">}</span>&nbsp;<span class="keyword" id="6086948">else</span>&nbsp;<span class="op" id="6086953">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6086958">p</span><span class="op" id="6086959">.</span><span class="ident" id="6086960">expr0</span><span class="op" id="6086965">(</span><span class="ident" id="6086966">x</span><span class="op" id="6086967">,</span>&nbsp;<span class="ident" id="6086969">depth</span><span class="op" id="6086974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6086978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6086983">prevLine</span>&nbsp;<span class="op" id="6086992">=</span>&nbsp;<span class="ident" id="6086994">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6087000">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087004">if</span>&nbsp;<span class="ident" id="6087007">mode</span><span class="op" id="6087011">&amp;</span><span class="ident" id="6087012">commaTerm</span>&nbsp;<span class="op" id="6087022">!=</span>&nbsp;<span class="num" id="6087025">0</span>&nbsp;<span class="op" id="6087027">&amp;&amp;</span>&nbsp;<span class="ident" id="6087030">next</span><span class="op" id="6087034">.</span><span class="ident" id="6087035">IsValid</span><span class="op" id="6087042">(</span><span class="op" id="6087043">)</span>&nbsp;<span class="op" id="6087045">&amp;&amp;</span>&nbsp;<span class="ident" id="6087048">p</span><span class="op" id="6087049">.</span><span class="ident" id="6087050">pos</span><span class="op" id="6087053">.</span><span class="ident" id="6087054">Line</span>&nbsp;<span class="op" id="6087059">&lt;</span>&nbsp;<span class="ident" id="6087061">next</span><span class="op" id="6087065">.</span><span class="ident" id="6087066">Line</span>&nbsp;<span class="op" id="6087071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6087075">//&nbsp;print&nbsp;a&nbsp;terminating&nbsp;comma&nbsp;if&nbsp;the&nbsp;next&nbsp;token&nbsp;is&nbsp;on&nbsp;a&nbsp;new&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087141">p</span><span class="op" id="6087142">.</span><span class="builtinfunc" id="6087143">print</span><span class="op" id="6087148">(</span><span class="ident" id="6087149">token</span><span class="op" id="6087154">.</span><span class="ident" id="6087155">COMMA</span><span class="op" id="6087160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087164">if</span>&nbsp;<span class="ident" id="6087167">ws</span>&nbsp;<span class="op" id="6087170">==</span>&nbsp;<span class="ident" id="6087173">ignore</span>&nbsp;<span class="op" id="6087180">&amp;&amp;</span>&nbsp;<span class="ident" id="6087183">mode</span><span class="op" id="6087187">&amp;</span><span class="ident" id="6087188">noIndent</span>&nbsp;<span class="op" id="6087197">==</span>&nbsp;<span class="num" id="6087200">0</span>&nbsp;<span class="op" id="6087202">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6087207">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087237">p</span><span class="op" id="6087238">.</span><span class="builtinfunc" id="6087239">print</span><span class="op" id="6087244">(</span><span class="ident" id="6087245">unindent</span><span class="op" id="6087253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6087257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087261">p</span><span class="op" id="6087262">.</span><span class="builtinfunc" id="6087263">print</span><span class="op" id="6087268">(</span><span class="ident" id="6087269">formfeed</span><span class="op" id="6087277">)</span>&nbsp;<span class="comment" id="6087279">//&nbsp;terminating&nbsp;comma&nbsp;needs&nbsp;a&nbsp;line&nbsp;break&nbsp;to&nbsp;look&nbsp;good</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087334">return</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6087342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087346">if</span>&nbsp;<span class="ident" id="6087349">ws</span>&nbsp;<span class="op" id="6087352">==</span>&nbsp;<span class="ident" id="6087355">ignore</span>&nbsp;<span class="op" id="6087362">&amp;&amp;</span>&nbsp;<span class="ident" id="6087365">mode</span><span class="op" id="6087369">&amp;</span><span class="ident" id="6087370">noIndent</span>&nbsp;<span class="op" id="6087379">==</span>&nbsp;<span class="num" id="6087382">0</span>&nbsp;<span class="op" id="6087384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6087388">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087417">p</span><span class="op" id="6087418">.</span><span class="builtinfunc" id="6087419">print</span><span class="op" id="6087424">(</span><span class="ident" id="6087425">unindent</span><span class="op" id="6087433">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6087436">}</span><br>
<span class="lineno"></span><span class="op" id="6087438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6087441">func</span>&nbsp;<span class="op" id="6087446">(</span><span class="ident" id="6087447">p</span>&nbsp;<span class="op" id="6087449">*</span><span class="ident" id="6087450">printer</span><span class="op" id="6087457">)</span>&nbsp;<span class="ident" id="6087459">parameters</span><span class="op" id="6087469">(</span><span class="ident" id="6087470">fields</span>&nbsp;<span class="op" id="6087477">*</span><span class="ident" id="6087478">ast</span><span class="op" id="6087481">.</span><span class="ident" id="6087482">FieldList</span><span class="op" id="6087491">)</span>&nbsp;<span class="op" id="6087493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087496">p</span><span class="op" id="6087497">.</span><span class="builtinfunc" id="6087498">print</span><span class="op" id="6087503">(</span><span class="ident" id="6087504">fields</span><span class="op" id="6087510">.</span><span class="ident" id="6087511">Opening</span><span class="op" id="6087518">,</span>&nbsp;<span class="ident" id="6087520">token</span><span class="op" id="6087525">.</span><span class="ident" id="6087526">LPAREN</span><span class="op" id="6087532">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087535">if</span>&nbsp;<span class="builtinfunc" id="6087538">len</span><span class="op" id="6087541">(</span><span class="ident" id="6087542">fields</span><span class="op" id="6087548">.</span><span class="ident" id="6087549">List</span><span class="op" id="6087553">)</span>&nbsp;<span class="op" id="6087555">&gt;</span>&nbsp;<span class="num" id="6087557">0</span>&nbsp;<span class="op" id="6087559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087563">prevLine</span>&nbsp;<span class="op" id="6087572">:=</span>&nbsp;<span class="ident" id="6087575">p</span><span class="op" id="6087576">.</span><span class="ident" id="6087577">lineFor</span><span class="op" id="6087584">(</span><span class="ident" id="6087585">fields</span><span class="op" id="6087591">.</span><span class="ident" id="6087592">Opening</span><span class="op" id="6087599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087603">ws</span>&nbsp;<span class="op" id="6087606">:=</span>&nbsp;<span class="ident" id="6087609">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087618">for</span>&nbsp;<span class="ident" id="6087622">i</span><span class="op" id="6087623">,</span>&nbsp;<span class="ident" id="6087625">par</span>&nbsp;<span class="op" id="6087629">:=</span>&nbsp;<span class="keyword" id="6087632">range</span>&nbsp;<span class="ident" id="6087638">fields</span><span class="op" id="6087644">.</span><span class="ident" id="6087645">List</span>&nbsp;<span class="op" id="6087650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6087655">//&nbsp;determine&nbsp;par&nbsp;begin&nbsp;and&nbsp;end&nbsp;line&nbsp;(may&nbsp;be&nbsp;different</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6087712">//&nbsp;if&nbsp;there&nbsp;are&nbsp;multiple&nbsp;parameter&nbsp;names&nbsp;for&nbsp;this&nbsp;par</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6087769">//&nbsp;or&nbsp;the&nbsp;type&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087810">var</span>&nbsp;<span class="ident" id="6087814">parLineBeg</span>&nbsp;<span class="builtintype" id="6087825">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087832">if</span>&nbsp;<span class="builtinfunc" id="6087835">len</span><span class="op" id="6087838">(</span><span class="ident" id="6087839">par</span><span class="op" id="6087842">.</span><span class="ident" id="6087843">Names</span><span class="op" id="6087848">)</span>&nbsp;<span class="op" id="6087850">&gt;</span>&nbsp;<span class="num" id="6087852">0</span>&nbsp;<span class="op" id="6087854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087860">parLineBeg</span>&nbsp;<span class="op" id="6087871">=</span>&nbsp;<span class="ident" id="6087873">p</span><span class="op" id="6087874">.</span><span class="ident" id="6087875">lineFor</span><span class="op" id="6087882">(</span><span class="ident" id="6087883">par</span><span class="op" id="6087886">.</span><span class="ident" id="6087887">Names</span><span class="op" id="6087892">[</span><span class="num" id="6087893">0</span><span class="op" id="6087894">]</span><span class="op" id="6087895">.</span><span class="ident" id="6087896">Pos</span><span class="op" id="6087899">(</span><span class="op" id="6087900">)</span><span class="op" id="6087901">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6087906">}</span>&nbsp;<span class="keyword" id="6087908">else</span>&nbsp;<span class="op" id="6087913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6087919">parLineBeg</span>&nbsp;<span class="op" id="6087930">=</span>&nbsp;<span class="ident" id="6087932">p</span><span class="op" id="6087933">.</span><span class="ident" id="6087934">lineFor</span><span class="op" id="6087941">(</span><span class="ident" id="6087942">par</span><span class="op" id="6087945">.</span><span class="ident" id="6087946">Type</span><span class="op" id="6087950">.</span><span class="ident" id="6087951">Pos</span><span class="op" id="6087954">(</span><span class="op" id="6087955">)</span><span class="op" id="6087956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6087961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6087966">var</span>&nbsp;<span class="ident" id="6087970">parLineEnd</span>&nbsp;<span class="op" id="6087981">=</span>&nbsp;<span class="ident" id="6087983">p</span><span class="op" id="6087984">.</span><span class="ident" id="6087985">lineFor</span><span class="op" id="6087992">(</span><span class="ident" id="6087993">par</span><span class="op" id="6087996">.</span><span class="ident" id="6087997">Type</span><span class="op" id="6088001">.</span><span class="ident" id="6088002">End</span><span class="op" id="6088005">(</span><span class="op" id="6088006">)</span><span class="op" id="6088007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6088012">//&nbsp;separating&nbsp;&#34;,&#34;&nbsp;if&nbsp;needed</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6088043">needsLinebreak</span>&nbsp;<span class="op" id="6088058">:=</span>&nbsp;<span class="num" id="6088061">0</span>&nbsp;<span class="op" id="6088063">&lt;</span>&nbsp;<span class="ident" id="6088065">prevLine</span>&nbsp;<span class="op" id="6088074">&amp;&amp;</span>&nbsp;<span class="ident" id="6088077">prevLine</span>&nbsp;<span class="op" id="6088086">&lt;</span>&nbsp;<span class="ident" id="6088088">parLineBeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088102">if</span>&nbsp;<span class="ident" id="6088105">i</span>&nbsp;<span class="op" id="6088107">&gt;</span>&nbsp;<span class="num" id="6088109">0</span>&nbsp;<span class="op" id="6088111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6088117">//&nbsp;use&nbsp;position&nbsp;of&nbsp;parameter&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6088173">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comma&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6088228">//&nbsp;only&nbsp;if&nbsp;the&nbsp;next&nbsp;parameter&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088282">if</span>&nbsp;<span class="op" id="6088285">!</span><span class="ident" id="6088286">needsLinebreak</span>&nbsp;<span class="op" id="6088301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6088308">p</span><span class="op" id="6088309">.</span><span class="builtinfunc" id="6088310">print</span><span class="op" id="6088315">(</span><span class="ident" id="6088316">par</span><span class="op" id="6088319">.</span><span class="ident" id="6088320">Pos</span><span class="op" id="6088323">(</span><span class="op" id="6088324">)</span><span class="op" id="6088325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6088331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6088337">p</span><span class="op" id="6088338">.</span><span class="builtinfunc" id="6088339">print</span><span class="op" id="6088344">(</span><span class="ident" id="6088345">token</span><span class="op" id="6088350">.</span><span class="ident" id="6088351">COMMA</span><span class="op" id="6088356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6088361">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6088366">//&nbsp;separator&nbsp;if&nbsp;needed&nbsp;(linebreak&nbsp;or&nbsp;blank)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088413">if</span>&nbsp;<span class="ident" id="6088416">needsLinebreak</span>&nbsp;<span class="op" id="6088431">&amp;&amp;</span>&nbsp;<span class="ident" id="6088434">p</span><span class="op" id="6088435">.</span><span class="ident" id="6088436">linebreak</span><span class="op" id="6088445">(</span><span class="ident" id="6088446">parLineBeg</span><span class="op" id="6088456">,</span>&nbsp;<span class="num" id="6088458">0</span><span class="op" id="6088459">,</span>&nbsp;<span class="ident" id="6088461">ws</span><span class="op" id="6088463">,</span>&nbsp;<span class="builtintype" id="6088465">true</span><span class="op" id="6088469">)</span>&nbsp;<span class="op" id="6088471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6088477">//&nbsp;break&nbsp;line&nbsp;if&nbsp;the&nbsp;opening&nbsp;&#34;(&#34;&nbsp;or&nbsp;previous&nbsp;parameter&nbsp;ended&nbsp;on&nbsp;a&nbsp;different&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6088562">ws</span>&nbsp;<span class="op" id="6088565">=</span>&nbsp;<span class="ident" id="6088567">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6088577">}</span>&nbsp;<span class="keyword" id="6088579">else</span>&nbsp;<span class="keyword" id="6088584">if</span>&nbsp;<span class="ident" id="6088587">i</span>&nbsp;<span class="op" id="6088589">&gt;</span>&nbsp;<span class="num" id="6088591">0</span>&nbsp;<span class="op" id="6088593">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6088599">p</span><span class="op" id="6088600">.</span><span class="builtinfunc" id="6088601">print</span><span class="op" id="6088606">(</span><span class="ident" id="6088607">blank</span><span class="op" id="6088612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6088617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6088622">//&nbsp;parameter&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6088644">if</span>&nbsp;<span class="builtinfunc" id="6088647">len</span><span class="op" id="6088650">(</span><span class="ident" id="6088651">par</span><span class="op" id="6088654">.</span><span class="ident" id="6088655">Names</span><span class="op" id="6088660">)</span>&nbsp;<span class="op" id="6088662">&gt;</span>&nbsp;<span class="num" id="6088664">0</span>&nbsp;<span class="op" id="6088666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6088672">//&nbsp;Very&nbsp;subtle:&nbsp;If&nbsp;we&nbsp;indented&nbsp;before&nbsp;(ws&nbsp;==&nbsp;ignore),&nbsp;identList</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6088740">//&nbsp;won&#39;t&nbsp;indent&nbsp;again.&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;(ws&nbsp;==&nbsp;indent),&nbsp;identList&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6088811">//&nbsp;indent&nbsp;if&nbsp;the&nbsp;identList&nbsp;spans&nbsp;multiple&nbsp;lines,&nbsp;and&nbsp;it&nbsp;will&nbsp;outdent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6088884">//&nbsp;again&nbsp;at&nbsp;the&nbsp;end&nbsp;(and&nbsp;still&nbsp;ws&nbsp;==&nbsp;indent).&nbsp;Thus,&nbsp;a&nbsp;subsequent&nbsp;indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6088960">//&nbsp;by&nbsp;a&nbsp;linebreak&nbsp;call&nbsp;after&nbsp;a&nbsp;type,&nbsp;or&nbsp;in&nbsp;the&nbsp;next&nbsp;multi-line&nbsp;identList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6089037">//&nbsp;will&nbsp;do&nbsp;the&nbsp;right&nbsp;thing.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089069">p</span><span class="op" id="6089070">.</span><span class="ident" id="6089071">identList</span><span class="op" id="6089080">(</span><span class="ident" id="6089081">par</span><span class="op" id="6089084">.</span><span class="ident" id="6089085">Names</span><span class="op" id="6089090">,</span>&nbsp;<span class="ident" id="6089092">ws</span>&nbsp;<span class="op" id="6089095">==</span>&nbsp;<span class="ident" id="6089098">indent</span><span class="op" id="6089104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089110">p</span><span class="op" id="6089111">.</span><span class="builtinfunc" id="6089112">print</span><span class="op" id="6089117">(</span><span class="ident" id="6089118">blank</span><span class="op" id="6089123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6089133">//&nbsp;parameter&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089154">p</span><span class="op" id="6089155">.</span><span class="ident" id="6089156">expr</span><span class="op" id="6089160">(</span><span class="ident" id="6089161">stripParensAlways</span><span class="op" id="6089178">(</span><span class="ident" id="6089179">par</span><span class="op" id="6089182">.</span><span class="ident" id="6089183">Type</span><span class="op" id="6089187">)</span><span class="op" id="6089188">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089193">prevLine</span>&nbsp;<span class="op" id="6089202">=</span>&nbsp;<span class="ident" id="6089204">parLineEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6089221">//&nbsp;if&nbsp;the&nbsp;closing&nbsp;&#34;)&#34;&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line&nbsp;from&nbsp;the&nbsp;last&nbsp;parameter,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6089292">//&nbsp;print&nbsp;an&nbsp;additional&nbsp;&#34;,&#34;&nbsp;and&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089336">if</span>&nbsp;<span class="ident" id="6089339">closing</span>&nbsp;<span class="op" id="6089347">:=</span>&nbsp;<span class="ident" id="6089350">p</span><span class="op" id="6089351">.</span><span class="ident" id="6089352">lineFor</span><span class="op" id="6089359">(</span><span class="ident" id="6089360">fields</span><span class="op" id="6089366">.</span><span class="ident" id="6089367">Closing</span><span class="op" id="6089374">)</span><span class="op" id="6089375">;</span>&nbsp;<span class="num" id="6089377">0</span>&nbsp;<span class="op" id="6089379">&lt;</span>&nbsp;<span class="ident" id="6089381">prevLine</span>&nbsp;<span class="op" id="6089390">&amp;&amp;</span>&nbsp;<span class="ident" id="6089393">prevLine</span>&nbsp;<span class="op" id="6089402">&lt;</span>&nbsp;<span class="ident" id="6089404">closing</span>&nbsp;<span class="op" id="6089412">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089417">p</span><span class="op" id="6089418">.</span><span class="builtinfunc" id="6089419">print</span><span class="op" id="6089424">(</span><span class="ident" id="6089425">token</span><span class="op" id="6089430">.</span><span class="ident" id="6089431">COMMA</span><span class="op" id="6089436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089441">p</span><span class="op" id="6089442">.</span><span class="ident" id="6089443">linebreak</span><span class="op" id="6089452">(</span><span class="ident" id="6089453">closing</span><span class="op" id="6089460">,</span>&nbsp;<span class="num" id="6089462">0</span><span class="op" id="6089463">,</span>&nbsp;<span class="ident" id="6089465">ignore</span><span class="op" id="6089471">,</span>&nbsp;<span class="builtintype" id="6089473">true</span><span class="op" id="6089477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6089485">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089514">if</span>&nbsp;<span class="ident" id="6089517">ws</span>&nbsp;<span class="op" id="6089520">==</span>&nbsp;<span class="ident" id="6089523">ignore</span>&nbsp;<span class="op" id="6089530">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089535">p</span><span class="op" id="6089536">.</span><span class="builtinfunc" id="6089537">print</span><span class="op" id="6089542">(</span><span class="ident" id="6089543">unindent</span><span class="op" id="6089551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089561">p</span><span class="op" id="6089562">.</span><span class="builtinfunc" id="6089563">print</span><span class="op" id="6089568">(</span><span class="ident" id="6089569">fields</span><span class="op" id="6089575">.</span><span class="ident" id="6089576">Closing</span><span class="op" id="6089583">,</span>&nbsp;<span class="ident" id="6089585">token</span><span class="op" id="6089590">.</span><span class="ident" id="6089591">RPAREN</span><span class="op" id="6089597">)</span><br>
<span class="lineno"></span><span class="op" id="6089599">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="6089602">func</span>&nbsp;<span class="op" id="6089607">(</span><span class="ident" id="6089608">p</span>&nbsp;<span class="op" id="6089610">*</span><span class="ident" id="6089611">printer</span><span class="op" id="6089618">)</span>&nbsp;<span class="ident" id="6089620">signature</span><span class="op" id="6089629">(</span><span class="ident" id="6089630">params</span><span class="op" id="6089636">,</span>&nbsp;<span class="ident" id="6089638">result</span>&nbsp;<span class="op" id="6089645">*</span><span class="ident" id="6089646">ast</span><span class="op" id="6089649">.</span><span class="ident" id="6089650">FieldList</span><span class="op" id="6089659">)</span>&nbsp;<span class="op" id="6089661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089664">if</span>&nbsp;<span class="ident" id="6089667">params</span>&nbsp;<span class="op" id="6089674">!=</span>&nbsp;<span class="ident" id="6089677">nil</span>&nbsp;<span class="op" id="6089681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089685">p</span><span class="op" id="6089686">.</span><span class="ident" id="6089687">parameters</span><span class="op" id="6089697">(</span><span class="ident" id="6089698">params</span><span class="op" id="6089704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089707">}</span>&nbsp;<span class="keyword" id="6089709">else</span>&nbsp;<span class="op" id="6089714">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089718">p</span><span class="op" id="6089719">.</span><span class="builtinfunc" id="6089720">print</span><span class="op" id="6089725">(</span><span class="ident" id="6089726">token</span><span class="op" id="6089731">.</span><span class="ident" id="6089732">LPAREN</span><span class="op" id="6089738">,</span>&nbsp;<span class="ident" id="6089740">token</span><span class="op" id="6089745">.</span><span class="ident" id="6089746">RPAREN</span><span class="op" id="6089752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089758">n</span>&nbsp;<span class="op" id="6089760">:=</span>&nbsp;<span class="ident" id="6089763">result</span><span class="op" id="6089769">.</span><span class="ident" id="6089770">NumFields</span><span class="op" id="6089779">(</span><span class="op" id="6089780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089783">if</span>&nbsp;<span class="ident" id="6089786">n</span>&nbsp;<span class="op" id="6089788">&gt;</span>&nbsp;<span class="num" id="6089790">0</span>&nbsp;<span class="op" id="6089792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6089796">//&nbsp;result&nbsp;!=&nbsp;nil</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089815">p</span><span class="op" id="6089816">.</span><span class="builtinfunc" id="6089817">print</span><span class="op" id="6089822">(</span><span class="ident" id="6089823">blank</span><span class="op" id="6089828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089832">if</span>&nbsp;<span class="ident" id="6089835">n</span>&nbsp;<span class="op" id="6089837">==</span>&nbsp;<span class="num" id="6089840">1</span>&nbsp;<span class="op" id="6089842">&amp;&amp;</span>&nbsp;<span class="ident" id="6089845">result</span><span class="op" id="6089851">.</span><span class="ident" id="6089852">List</span><span class="op" id="6089856">[</span><span class="num" id="6089857">0</span><span class="op" id="6089858">]</span><span class="op" id="6089859">.</span><span class="ident" id="6089860">Names</span>&nbsp;<span class="op" id="6089866">==</span>&nbsp;<span class="ident" id="6089869">nil</span>&nbsp;<span class="op" id="6089873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6089878">//&nbsp;single&nbsp;anonymous&nbsp;result;&nbsp;no&nbsp;()&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089917">p</span><span class="op" id="6089918">.</span><span class="ident" id="6089919">expr</span><span class="op" id="6089923">(</span><span class="ident" id="6089924">stripParensAlways</span><span class="op" id="6089941">(</span><span class="ident" id="6089942">result</span><span class="op" id="6089948">.</span><span class="ident" id="6089949">List</span><span class="op" id="6089953">[</span><span class="num" id="6089954">0</span><span class="op" id="6089955">]</span><span class="op" id="6089956">.</span><span class="ident" id="6089957">Type</span><span class="op" id="6089961">)</span><span class="op" id="6089962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6089967">return</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6089976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6089980">p</span><span class="op" id="6089981">.</span><span class="ident" id="6089982">parameters</span><span class="op" id="6089992">(</span><span class="ident" id="6089993">result</span><span class="op" id="6089999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6090002">}</span><br>
<span class="lineno"></span><span class="op" id="6090004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="6090007">func</span>&nbsp;<span class="ident" id="6090012">identListSize</span><span class="op" id="6090025">(</span><span class="ident" id="6090026">list</span>&nbsp;<span class="op" id="6090031">[</span><span class="op" id="6090032">]</span><span class="op" id="6090033">*</span><span class="ident" id="6090034">ast</span><span class="op" id="6090037">.</span><span class="ident" id="6090038">Ident</span><span class="op" id="6090043">,</span>&nbsp;<span class="ident" id="6090045">maxSize</span>&nbsp;<span class="builtintype" id="6090053">int</span><span class="op" id="6090056">)</span>&nbsp;<span class="op" id="6090058">(</span><span class="ident" id="6090059">size</span>&nbsp;<span class="builtintype" id="6090064">int</span><span class="op" id="6090067">)</span>&nbsp;<span class="op" id="6090069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6090072">for</span>&nbsp;<span class="ident" id="6090076">i</span><span class="op" id="6090077">,</span>&nbsp;<span class="ident" id="6090079">x</span>&nbsp;<span class="op" id="6090081">:=</span>&nbsp;<span class="keyword" id="6090084">range</span>&nbsp;<span class="ident" id="6090090">list</span>&nbsp;<span class="op" id="6090095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6090099">if</span>&nbsp;<span class="ident" id="6090102">i</span>&nbsp;<span class="op" id="6090104">&gt;</span>&nbsp;<span class="num" id="6090106">0</span>&nbsp;<span class="op" id="6090108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090113">size</span>&nbsp;<span class="op" id="6090118">+=</span>&nbsp;<span class="builtinfunc" id="6090121">len</span><span class="op" id="6090124">(</span><span class="string" id="6090125">&#34;,&nbsp;&#34;</span><span class="op" id="6090129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6090133">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090137">size</span>&nbsp;<span class="op" id="6090142">+=</span>&nbsp;<span class="ident" id="6090145">utf8</span><span class="op" id="6090149">.</span><span class="ident" id="6090150">RuneCountInString</span><span class="op" id="6090167">(</span><span class="ident" id="6090168">x</span><span class="op" id="6090169">.</span><span class="ident" id="6090170">Name</span><span class="op" id="6090174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6090178">if</span>&nbsp;<span class="ident" id="6090181">size</span>&nbsp;<span class="op" id="6090186">&gt;=</span>&nbsp;<span class="ident" id="6090189">maxSize</span>&nbsp;<span class="op" id="6090197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6090202">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6090210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6090213">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6090216">return</span><br>
<span class="lineno"></span><span class="op" id="6090223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6090226">func</span>&nbsp;<span class="op" id="6090231">(</span><span class="ident" id="6090232">p</span>&nbsp;<span class="op" id="6090234">*</span><span class="ident" id="6090235">printer</span><span class="op" id="6090242">)</span>&nbsp;<span class="ident" id="6090244">isOneLineFieldList</span><span class="op" id="6090262">(</span><span class="ident" id="6090263">list</span>&nbsp;<span class="op" id="6090268">[</span><span class="op" id="6090269">]</span><span class="op" id="6090270">*</span><span class="ident" id="6090271">ast</span><span class="op" id="6090274">.</span><span class="ident" id="6090275">Field</span><span class="op" id="6090280">)</span>&nbsp;<span class="builtintype" id="6090282">bool</span>&nbsp;<span class="op" id="6090287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6090290">if</span>&nbsp;<span class="builtinfunc" id="6090293">len</span><span class="op" id="6090296">(</span><span class="ident" id="6090297">list</span><span class="op" id="6090301">)</span>&nbsp;<span class="op" id="6090303">!=</span>&nbsp;<span class="num" id="6090306">1</span>&nbsp;<span class="op" id="6090308">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6090312">return</span>&nbsp;<span class="builtintype" id="6090319">false</span>&nbsp;<span class="comment" id="6090325">//&nbsp;allow&nbsp;only&nbsp;one&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6090350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090353">f</span>&nbsp;<span class="op" id="6090355">:=</span>&nbsp;<span class="ident" id="6090358">list</span><span class="op" id="6090362">[</span><span class="num" id="6090363">0</span><span class="op" id="6090364">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6090367">if</span>&nbsp;<span class="ident" id="6090370">f</span><span class="op" id="6090371">.</span><span class="ident" id="6090372">Tag</span>&nbsp;<span class="op" id="6090376">!=</span>&nbsp;<span class="ident" id="6090379">nil</span>&nbsp;<span class="op" id="6090383">||</span>&nbsp;<span class="ident" id="6090386">f</span><span class="op" id="6090387">.</span><span class="ident" id="6090388">Comment</span>&nbsp;<span class="op" id="6090396">!=</span>&nbsp;<span class="ident" id="6090399">nil</span>&nbsp;<span class="op" id="6090403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6090407">return</span>&nbsp;<span class="builtintype" id="6090414">false</span>&nbsp;<span class="comment" id="6090420">//&nbsp;don&#39;t&nbsp;allow&nbsp;tags&nbsp;or&nbsp;comments</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6090453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6090456">//&nbsp;only&nbsp;name(s)&nbsp;and&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6090482">const</span>&nbsp;<span class="ident" id="6090488">maxSize</span>&nbsp;<span class="op" id="6090496">=</span>&nbsp;<span class="num" id="6090498">30</span>&nbsp;<span class="comment" id="6090501">//&nbsp;adjust&nbsp;as&nbsp;appropriate,&nbsp;this&nbsp;is&nbsp;an&nbsp;approximate&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090557">namesSize</span>&nbsp;<span class="op" id="6090567">:=</span>&nbsp;<span class="ident" id="6090570">identListSize</span><span class="op" id="6090583">(</span><span class="ident" id="6090584">f</span><span class="op" id="6090585">.</span><span class="ident" id="6090586">Names</span><span class="op" id="6090591">,</span>&nbsp;<span class="ident" id="6090593">maxSize</span><span class="op" id="6090600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6090603">if</span>&nbsp;<span class="ident" id="6090606">namesSize</span>&nbsp;<span class="op" id="6090616">&gt;</span>&nbsp;<span class="num" id="6090618">0</span>&nbsp;<span class="op" id="6090620">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090624">namesSize</span>&nbsp;<span class="op" id="6090634">=</span>&nbsp;<span class="num" id="6090636">1</span>&nbsp;<span class="comment" id="6090638">//&nbsp;blank&nbsp;between&nbsp;names&nbsp;and&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6090672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090675">typeSize</span>&nbsp;<span class="op" id="6090684">:=</span>&nbsp;<span class="ident" id="6090687">p</span><span class="op" id="6090688">.</span><span class="ident" id="6090689">nodeSize</span><span class="op" id="6090697">(</span><span class="ident" id="6090698">f</span><span class="op" id="6090699">.</span><span class="ident" id="6090700">Type</span><span class="op" id="6090704">,</span>&nbsp;<span class="ident" id="6090706">maxSize</span><span class="op" id="6090713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6090716">return</span>&nbsp;<span class="ident" id="6090723">namesSize</span><span class="op" id="6090732">+</span><span class="ident" id="6090733">typeSize</span>&nbsp;<span class="op" id="6090742">&lt;=</span>&nbsp;<span class="ident" id="6090745">maxSize</span><br>
<span class="lineno"></span><span class="op" id="6090753">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="keyword" id="6090756">func</span>&nbsp;<span class="op" id="6090761">(</span><span class="ident" id="6090762">p</span>&nbsp;<span class="op" id="6090764">*</span><span class="ident" id="6090765">printer</span><span class="op" id="6090772">)</span>&nbsp;<span class="ident" id="6090774">setLineComment</span><span class="op" id="6090788">(</span><span class="ident" id="6090789">text</span>&nbsp;<span class="builtintype" id="6090794">string</span><span class="op" id="6090800">)</span>&nbsp;<span class="op" id="6090802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090805">p</span><span class="op" id="6090806">.</span><span class="ident" id="6090807">setComment</span><span class="op" id="6090817">(</span><span class="op" id="6090818">&amp;</span><span class="ident" id="6090819">ast</span><span class="op" id="6090822">.</span><span class="ident" id="6090823">CommentGroup</span><span class="op" id="6090835">{</span><span class="ident" id="6090836">List</span><span class="op" id="6090840">:</span>&nbsp;<span class="op" id="6090842">[</span><span class="op" id="6090843">]</span><span class="op" id="6090844">*</span><span class="ident" id="6090845">ast</span><span class="op" id="6090848">.</span><span class="ident" id="6090849">Comment</span><span class="op" id="6090856">{</span><span class="op" id="6090857">{</span><span class="ident" id="6090858">Slash</span><span class="op" id="6090863">:</span>&nbsp;<span class="ident" id="6090865">token</span><span class="op" id="6090870">.</span><span class="ident" id="6090871">NoPos</span><span class="op" id="6090876">,</span>&nbsp;<span class="ident" id="6090878">Text</span><span class="op" id="6090882">:</span>&nbsp;<span class="ident" id="6090884">text</span><span class="op" id="6090888">}</span><span class="op" id="6090889">}</span><span class="op" id="6090890">}</span><span class="op" id="6090891">)</span><br>
<span class="lineno"></span><span class="op" id="6090893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="6090896">func</span>&nbsp;<span class="op" id="6090901">(</span><span class="ident" id="6090902">p</span>&nbsp;<span class="op" id="6090904">*</span><span class="ident" id="6090905">printer</span><span class="op" id="6090912">)</span>&nbsp;<span class="ident" id="6090914">fieldList</span><span class="op" id="6090923">(</span><span class="ident" id="6090924">fields</span>&nbsp;<span class="op" id="6090931">*</span><span class="ident" id="6090932">ast</span><span class="op" id="6090935">.</span><span class="ident" id="6090936">FieldList</span><span class="op" id="6090945">,</span>&nbsp;<span class="ident" id="6090947">isStruct</span><span class="op" id="6090955">,</span>&nbsp;<span class="ident" id="6090957">isIncomplete</span>&nbsp;<span class="builtintype" id="6090970">bool</span><span class="op" id="6090974">)</span>&nbsp;<span class="op" id="6090976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6090979">lbrace</span>&nbsp;<span class="op" id="6090986">:=</span>&nbsp;<span class="ident" id="6090989">fields</span><span class="op" id="6090995">.</span><span class="ident" id="6090996">Opening</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091005">list</span>&nbsp;<span class="op" id="6091010">:=</span>&nbsp;<span class="ident" id="6091013">fields</span><span class="op" id="6091019">.</span><span class="ident" id="6091020">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091026">rbrace</span>&nbsp;<span class="op" id="6091033">:=</span>&nbsp;<span class="ident" id="6091036">fields</span><span class="op" id="6091042">.</span><span class="ident" id="6091043">Closing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091052">hasComments</span>&nbsp;<span class="op" id="6091064">:=</span>&nbsp;<span class="ident" id="6091067">isIncomplete</span>&nbsp;<span class="op" id="6091080">||</span>&nbsp;<span class="ident" id="6091083">p</span><span class="op" id="6091084">.</span><span class="ident" id="6091085">commentBefore</span><span class="op" id="6091098">(</span><span class="ident" id="6091099">p</span><span class="op" id="6091100">.</span><span class="ident" id="6091101">posFor</span><span class="op" id="6091107">(</span><span class="ident" id="6091108">rbrace</span><span class="op" id="6091114">)</span><span class="op" id="6091115">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091118">srcIsOneLine</span>&nbsp;<span class="op" id="6091131">:=</span>&nbsp;<span class="ident" id="6091134">lbrace</span><span class="op" id="6091140">.</span><span class="ident" id="6091141">IsValid</span><span class="op" id="6091148">(</span><span class="op" id="6091149">)</span>&nbsp;<span class="op" id="6091151">&amp;&amp;</span>&nbsp;<span class="ident" id="6091154">rbrace</span><span class="op" id="6091160">.</span><span class="ident" id="6091161">IsValid</span><span class="op" id="6091168">(</span><span class="op" id="6091169">)</span>&nbsp;<span class="op" id="6091171">&amp;&amp;</span>&nbsp;<span class="ident" id="6091174">p</span><span class="op" id="6091175">.</span><span class="ident" id="6091176">lineFor</span><span class="op" id="6091183">(</span><span class="ident" id="6091184">lbrace</span><span class="op" id="6091190">)</span>&nbsp;<span class="op" id="6091192">==</span>&nbsp;<span class="ident" id="6091195">p</span><span class="op" id="6091196">.</span><span class="ident" id="6091197">lineFor</span><span class="op" id="6091204">(</span><span class="ident" id="6091205">rbrace</span><span class="op" id="6091211">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091215">if</span>&nbsp;<span class="op" id="6091218">!</span><span class="ident" id="6091219">hasComments</span>&nbsp;<span class="op" id="6091231">&amp;&amp;</span>&nbsp;<span class="ident" id="6091234">srcIsOneLine</span>&nbsp;<span class="op" id="6091247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6091251">//&nbsp;possibly&nbsp;a&nbsp;one-line&nbsp;struct/interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091293">if</span>&nbsp;<span class="builtinfunc" id="6091296">len</span><span class="op" id="6091299">(</span><span class="ident" id="6091300">list</span><span class="op" id="6091304">)</span>&nbsp;<span class="op" id="6091306">==</span>&nbsp;<span class="num" id="6091309">0</span>&nbsp;<span class="op" id="6091311">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6091316">//&nbsp;no&nbsp;blank&nbsp;between&nbsp;keyword&nbsp;and&nbsp;{}&nbsp;in&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091367">p</span><span class="op" id="6091368">.</span><span class="builtinfunc" id="6091369">print</span><span class="op" id="6091374">(</span><span class="ident" id="6091375">lbrace</span><span class="op" id="6091381">,</span>&nbsp;<span class="ident" id="6091383">token</span><span class="op" id="6091388">.</span><span class="ident" id="6091389">LBRACE</span><span class="op" id="6091395">,</span>&nbsp;<span class="ident" id="6091397">rbrace</span><span class="op" id="6091403">,</span>&nbsp;<span class="ident" id="6091405">token</span><span class="op" id="6091410">.</span><span class="ident" id="6091411">RBRACE</span><span class="op" id="6091417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091422">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6091431">}</span>&nbsp;<span class="keyword" id="6091433">else</span>&nbsp;<span class="keyword" id="6091438">if</span>&nbsp;<span class="ident" id="6091441">isStruct</span>&nbsp;<span class="op" id="6091450">&amp;&amp;</span>&nbsp;<span class="ident" id="6091453">p</span><span class="op" id="6091454">.</span><span class="ident" id="6091455">isOneLineFieldList</span><span class="op" id="6091473">(</span><span class="ident" id="6091474">list</span><span class="op" id="6091478">)</span>&nbsp;<span class="op" id="6091480">{</span>&nbsp;<span class="comment" id="6091482">//&nbsp;for&nbsp;now&nbsp;ignore&nbsp;interfaces</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6091514">//&nbsp;small&nbsp;enough&nbsp;-&nbsp;print&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6091553">//&nbsp;(don&#39;t&nbsp;use&nbsp;identList&nbsp;and&nbsp;ignore&nbsp;source&nbsp;line&nbsp;breaks)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091611">p</span><span class="op" id="6091612">.</span><span class="builtinfunc" id="6091613">print</span><span class="op" id="6091618">(</span><span class="ident" id="6091619">lbrace</span><span class="op" id="6091625">,</span>&nbsp;<span class="ident" id="6091627">token</span><span class="op" id="6091632">.</span><span class="ident" id="6091633">LBRACE</span><span class="op" id="6091639">,</span>&nbsp;<span class="ident" id="6091641">blank</span><span class="op" id="6091646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091651">f</span>&nbsp;<span class="op" id="6091653">:=</span>&nbsp;<span class="ident" id="6091656">list</span><span class="op" id="6091660">[</span><span class="num" id="6091661">0</span><span class="op" id="6091662">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091667">for</span>&nbsp;<span class="ident" id="6091671">i</span><span class="op" id="6091672">,</span>&nbsp;<span class="ident" id="6091674">x</span>&nbsp;<span class="op" id="6091676">:=</span>&nbsp;<span class="keyword" id="6091679">range</span>&nbsp;<span class="ident" id="6091685">f</span><span class="op" id="6091686">.</span><span class="ident" id="6091687">Names</span>&nbsp;<span class="op" id="6091693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091699">if</span>&nbsp;<span class="ident" id="6091702">i</span>&nbsp;<span class="op" id="6091704">&gt;</span>&nbsp;<span class="num" id="6091706">0</span>&nbsp;<span class="op" id="6091708">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6091715">//&nbsp;no&nbsp;comments&nbsp;so&nbsp;no&nbsp;need&nbsp;for&nbsp;comma&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091765">p</span><span class="op" id="6091766">.</span><span class="builtinfunc" id="6091767">print</span><span class="op" id="6091772">(</span><span class="ident" id="6091773">token</span><span class="op" id="6091778">.</span><span class="ident" id="6091779">COMMA</span><span class="op" id="6091784">,</span>&nbsp;<span class="ident" id="6091786">blank</span><span class="op" id="6091791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6091797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091803">p</span><span class="op" id="6091804">.</span><span class="ident" id="6091805">expr</span><span class="op" id="6091809">(</span><span class="ident" id="6091810">x</span><span class="op" id="6091811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6091816">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091821">if</span>&nbsp;<span class="builtinfunc" id="6091824">len</span><span class="op" id="6091827">(</span><span class="ident" id="6091828">f</span><span class="op" id="6091829">.</span><span class="ident" id="6091830">Names</span><span class="op" id="6091835">)</span>&nbsp;<span class="op" id="6091837">&gt;</span>&nbsp;<span class="num" id="6091839">0</span>&nbsp;<span class="op" id="6091841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091847">p</span><span class="op" id="6091848">.</span><span class="builtinfunc" id="6091849">print</span><span class="op" id="6091854">(</span><span class="ident" id="6091855">blank</span><span class="op" id="6091860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6091865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091870">p</span><span class="op" id="6091871">.</span><span class="ident" id="6091872">expr</span><span class="op" id="6091876">(</span><span class="ident" id="6091877">f</span><span class="op" id="6091878">.</span><span class="ident" id="6091879">Type</span><span class="op" id="6091883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091888">p</span><span class="op" id="6091889">.</span><span class="builtinfunc" id="6091890">print</span><span class="op" id="6091895">(</span><span class="ident" id="6091896">blank</span><span class="op" id="6091901">,</span>&nbsp;<span class="ident" id="6091903">rbrace</span><span class="op" id="6091909">,</span>&nbsp;<span class="ident" id="6091911">token</span><span class="op" id="6091916">.</span><span class="ident" id="6091917">RBRACE</span><span class="op" id="6091923">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6091928">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6091937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6091940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6091943">//&nbsp;hasComments&nbsp;||&nbsp;!srcIsOneLine</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6091977">p</span><span class="op" id="6091978">.</span><span class="builtinfunc" id="6091979">print</span><span class="op" id="6091984">(</span><span class="ident" id="6091985">blank</span><span class="op" id="6091990">,</span>&nbsp;<span class="ident" id="6091992">lbrace</span><span class="op" id="6091998">,</span>&nbsp;<span class="ident" id="6092000">token</span><span class="op" id="6092005">.</span><span class="ident" id="6092006">LBRACE</span><span class="op" id="6092012">,</span>&nbsp;<span class="ident" id="6092014">indent</span><span class="op" id="6092020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092023">if</span>&nbsp;<span class="ident" id="6092026">hasComments</span>&nbsp;<span class="op" id="6092038">||</span>&nbsp;<span class="builtinfunc" id="6092041">len</span><span class="op" id="6092044">(</span><span class="ident" id="6092045">list</span><span class="op" id="6092049">)</span>&nbsp;<span class="op" id="6092051">&gt;</span>&nbsp;<span class="num" id="6092053">0</span>&nbsp;<span class="op" id="6092055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092059">p</span><span class="op" id="6092060">.</span><span class="builtinfunc" id="6092061">print</span><span class="op" id="6092066">(</span><span class="ident" id="6092067">formfeed</span><span class="op" id="6092075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092082">if</span>&nbsp;<span class="ident" id="6092085">isStruct</span>&nbsp;<span class="op" id="6092094">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092099">sep</span>&nbsp;<span class="op" id="6092103">:=</span>&nbsp;<span class="ident" id="6092106">vtab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092113">if</span>&nbsp;<span class="builtinfunc" id="6092116">len</span><span class="op" id="6092119">(</span><span class="ident" id="6092120">list</span><span class="op" id="6092124">)</span>&nbsp;<span class="op" id="6092126">==</span>&nbsp;<span class="num" id="6092129">1</span>&nbsp;<span class="op" id="6092131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092136">sep</span>&nbsp;<span class="op" id="6092140">=</span>&nbsp;<span class="ident" id="6092142">blank</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092154">var</span>&nbsp;<span class="ident" id="6092158">line</span>&nbsp;<span class="builtintype" id="6092163">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092169">for</span>&nbsp;<span class="ident" id="6092173">i</span><span class="op" id="6092174">,</span>&nbsp;<span class="ident" id="6092176">f</span>&nbsp;<span class="op" id="6092178">:=</span>&nbsp;<span class="keyword" id="6092181">range</span>&nbsp;<span class="ident" id="6092187">list</span>&nbsp;<span class="op" id="6092192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092197">if</span>&nbsp;<span class="ident" id="6092200">i</span>&nbsp;<span class="op" id="6092202">&gt;</span>&nbsp;<span class="num" id="6092204">0</span>&nbsp;<span class="op" id="6092206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092212">p</span><span class="op" id="6092213">.</span><span class="ident" id="6092214">linebreak</span><span class="op" id="6092223">(</span><span class="ident" id="6092224">p</span><span class="op" id="6092225">.</span><span class="ident" id="6092226">lineFor</span><span class="op" id="6092233">(</span><span class="ident" id="6092234">f</span><span class="op" id="6092235">.</span><span class="ident" id="6092236">Pos</span><span class="op" id="6092239">(</span><span class="op" id="6092240">)</span><span class="op" id="6092241">)</span><span class="op" id="6092242">,</span>&nbsp;<span class="num" id="6092244">1</span><span class="op" id="6092245">,</span>&nbsp;<span class="ident" id="6092247">ignore</span><span class="op" id="6092253">,</span>&nbsp;<span class="ident" id="6092255">p</span><span class="op" id="6092256">.</span><span class="ident" id="6092257">linesFrom</span><span class="op" id="6092266">(</span><span class="ident" id="6092267">line</span><span class="op" id="6092271">)</span>&nbsp;<span class="op" id="6092273">&gt;</span>&nbsp;<span class="num" id="6092275">0</span><span class="op" id="6092276">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092286">extraTabs</span>&nbsp;<span class="op" id="6092296">:=</span>&nbsp;<span class="num" id="6092299">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092304">p</span><span class="op" id="6092305">.</span><span class="ident" id="6092306">setComment</span><span class="op" id="6092316">(</span><span class="ident" id="6092317">f</span><span class="op" id="6092318">.</span><span class="ident" id="6092319">Doc</span><span class="op" id="6092322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092327">p</span><span class="op" id="6092328">.</span><span class="ident" id="6092329">recordLine</span><span class="op" id="6092339">(</span><span class="op" id="6092340">&amp;</span><span class="ident" id="6092341">line</span><span class="op" id="6092345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092350">if</span>&nbsp;<span class="builtinfunc" id="6092353">len</span><span class="op" id="6092356">(</span><span class="ident" id="6092357">f</span><span class="op" id="6092358">.</span><span class="ident" id="6092359">Names</span><span class="op" id="6092364">)</span>&nbsp;<span class="op" id="6092366">&gt;</span>&nbsp;<span class="num" id="6092368">0</span>&nbsp;<span class="op" id="6092370">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6092376">//&nbsp;named&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092396">p</span><span class="op" id="6092397">.</span><span class="ident" id="6092398">identList</span><span class="op" id="6092407">(</span><span class="ident" id="6092408">f</span><span class="op" id="6092409">.</span><span class="ident" id="6092410">Names</span><span class="op" id="6092415">,</span>&nbsp;<span class="builtintype" id="6092417">false</span><span class="op" id="6092422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092428">p</span><span class="op" id="6092429">.</span><span class="builtinfunc" id="6092430">print</span><span class="op" id="6092435">(</span><span class="ident" id="6092436">sep</span><span class="op" id="6092439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092445">p</span><span class="op" id="6092446">.</span><span class="ident" id="6092447">expr</span><span class="op" id="6092451">(</span><span class="ident" id="6092452">f</span><span class="op" id="6092453">.</span><span class="ident" id="6092454">Type</span><span class="op" id="6092458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092464">extraTabs</span>&nbsp;<span class="op" id="6092474">=</span>&nbsp;<span class="num" id="6092476">1</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092481">}</span>&nbsp;<span class="keyword" id="6092483">else</span>&nbsp;<span class="op" id="6092488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6092494">//&nbsp;anonymous&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092517">p</span><span class="op" id="6092518">.</span><span class="ident" id="6092519">expr</span><span class="op" id="6092523">(</span><span class="ident" id="6092524">f</span><span class="op" id="6092525">.</span><span class="ident" id="6092526">Type</span><span class="op" id="6092530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092536">extraTabs</span>&nbsp;<span class="op" id="6092546">=</span>&nbsp;<span class="num" id="6092548">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092553">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092558">if</span>&nbsp;<span class="ident" id="6092561">f</span><span class="op" id="6092562">.</span><span class="ident" id="6092563">Tag</span>&nbsp;<span class="op" id="6092567">!=</span>&nbsp;<span class="ident" id="6092570">nil</span>&nbsp;<span class="op" id="6092574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092580">if</span>&nbsp;<span class="builtinfunc" id="6092583">len</span><span class="op" id="6092586">(</span><span class="ident" id="6092587">f</span><span class="op" id="6092588">.</span><span class="ident" id="6092589">Names</span><span class="op" id="6092594">)</span>&nbsp;<span class="op" id="6092596">&gt;</span>&nbsp;<span class="num" id="6092598">0</span>&nbsp;<span class="op" id="6092600">&amp;&amp;</span>&nbsp;<span class="ident" id="6092603">sep</span>&nbsp;<span class="op" id="6092607">==</span>&nbsp;<span class="ident" id="6092610">vtab</span>&nbsp;<span class="op" id="6092615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092622">p</span><span class="op" id="6092623">.</span><span class="builtinfunc" id="6092624">print</span><span class="op" id="6092629">(</span><span class="ident" id="6092630">sep</span><span class="op" id="6092633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092645">p</span><span class="op" id="6092646">.</span><span class="builtinfunc" id="6092647">print</span><span class="op" id="6092652">(</span><span class="ident" id="6092653">sep</span><span class="op" id="6092656">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092662">p</span><span class="op" id="6092663">.</span><span class="ident" id="6092664">expr</span><span class="op" id="6092668">(</span><span class="ident" id="6092669">f</span><span class="op" id="6092670">.</span><span class="ident" id="6092671">Tag</span><span class="op" id="6092674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092680">extraTabs</span>&nbsp;<span class="op" id="6092690">=</span>&nbsp;<span class="num" id="6092692">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092702">if</span>&nbsp;<span class="ident" id="6092705">f</span><span class="op" id="6092706">.</span><span class="ident" id="6092707">Comment</span>&nbsp;<span class="op" id="6092715">!=</span>&nbsp;<span class="ident" id="6092718">nil</span>&nbsp;<span class="op" id="6092722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092728">for</span>&nbsp;<span class="op" id="6092732">;</span>&nbsp;<span class="ident" id="6092734">extraTabs</span>&nbsp;<span class="op" id="6092744">&gt;</span>&nbsp;<span class="num" id="6092746">0</span><span class="op" id="6092747">;</span>&nbsp;<span class="ident" id="6092749">extraTabs</span><span class="op" id="6092758">--</span>&nbsp;<span class="op" id="6092761">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092768">p</span><span class="op" id="6092769">.</span><span class="builtinfunc" id="6092770">print</span><span class="op" id="6092775">(</span><span class="ident" id="6092776">sep</span><span class="op" id="6092779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092791">p</span><span class="op" id="6092792">.</span><span class="ident" id="6092793">setComment</span><span class="op" id="6092803">(</span><span class="ident" id="6092804">f</span><span class="op" id="6092805">.</span><span class="ident" id="6092806">Comment</span><span class="op" id="6092813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092822">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092826">if</span>&nbsp;<span class="ident" id="6092829">isIncomplete</span>&nbsp;<span class="op" id="6092842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6092847">if</span>&nbsp;<span class="builtinfunc" id="6092850">len</span><span class="op" id="6092853">(</span><span class="ident" id="6092854">list</span><span class="op" id="6092858">)</span>&nbsp;<span class="op" id="6092860">&gt;</span>&nbsp;<span class="num" id="6092862">0</span>&nbsp;<span class="op" id="6092864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092870">p</span><span class="op" id="6092871">.</span><span class="builtinfunc" id="6092872">print</span><span class="op" id="6092877">(</span><span class="ident" id="6092878">formfeed</span><span class="op" id="6092886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6092891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092896">p</span><span class="op" id="6092897">.</span><span class="ident" id="6092898">flush</span><span class="op" id="6092903">(</span><span class="ident" id="6092904">p</span><span class="op" id="6092905">.</span><span class="ident" id="6092906">posFor</span><span class="op" id="6092912">(</span><span class="ident" id="6092913">rbrace</span><span class="op" id="6092919">)</span><span class="op" id="6092920">,</span>&nbsp;<span class="ident" id="6092922">token</span><span class="op" id="6092927">.</span><span class="ident" id="6092928">RBRACE</span><span class="op" id="6092934">)</span>&nbsp;<span class="comment" id="6092936">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6092988">p</span><span class="op" id="6092989">.</span><span class="ident" id="6092990">setLineComment</span><span class="op" id="6093004">(</span><span class="string" id="6093005">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;fields&#34;</span><span class="op" id="6093048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6093052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6093056">}</span>&nbsp;<span class="keyword" id="6093058">else</span>&nbsp;<span class="op" id="6093063">{</span>&nbsp;<span class="comment" id="6093065">//&nbsp;interface</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093081">var</span>&nbsp;<span class="ident" id="6093085">line</span>&nbsp;<span class="builtintype" id="6093090">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093096">for</span>&nbsp;<span class="ident" id="6093100">i</span><span class="op" id="6093101">,</span>&nbsp;<span class="ident" id="6093103">f</span>&nbsp;<span class="op" id="6093105">:=</span>&nbsp;<span class="keyword" id="6093108">range</span>&nbsp;<span class="ident" id="6093114">list</span>&nbsp;<span class="op" id="6093119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093124">if</span>&nbsp;<span class="ident" id="6093127">i</span>&nbsp;<span class="op" id="6093129">&gt;</span>&nbsp;<span class="num" id="6093131">0</span>&nbsp;<span class="op" id="6093133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093139">p</span><span class="op" id="6093140">.</span><span class="ident" id="6093141">linebreak</span><span class="op" id="6093150">(</span><span class="ident" id="6093151">p</span><span class="op" id="6093152">.</span><span class="ident" id="6093153">lineFor</span><span class="op" id="6093160">(</span><span class="ident" id="6093161">f</span><span class="op" id="6093162">.</span><span class="ident" id="6093163">Pos</span><span class="op" id="6093166">(</span><span class="op" id="6093167">)</span><span class="op" id="6093168">)</span><span class="op" id="6093169">,</span>&nbsp;<span class="num" id="6093171">1</span><span class="op" id="6093172">,</span>&nbsp;<span class="ident" id="6093174">ignore</span><span class="op" id="6093180">,</span>&nbsp;<span class="ident" id="6093182">p</span><span class="op" id="6093183">.</span><span class="ident" id="6093184">linesFrom</span><span class="op" id="6093193">(</span><span class="ident" id="6093194">line</span><span class="op" id="6093198">)</span>&nbsp;<span class="op" id="6093200">&gt;</span>&nbsp;<span class="num" id="6093202">0</span><span class="op" id="6093203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6093208">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093213">p</span><span class="op" id="6093214">.</span><span class="ident" id="6093215">setComment</span><span class="op" id="6093225">(</span><span class="ident" id="6093226">f</span><span class="op" id="6093227">.</span><span class="ident" id="6093228">Doc</span><span class="op" id="6093231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093236">p</span><span class="op" id="6093237">.</span><span class="ident" id="6093238">recordLine</span><span class="op" id="6093248">(</span><span class="op" id="6093249">&amp;</span><span class="ident" id="6093250">line</span><span class="op" id="6093254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093259">if</span>&nbsp;<span class="ident" id="6093262">ftyp</span><span class="op" id="6093266">,</span>&nbsp;<span class="ident" id="6093268">isFtyp</span>&nbsp;<span class="op" id="6093275">:=</span>&nbsp;<span class="ident" id="6093278">f</span><span class="op" id="6093279">.</span><span class="ident" id="6093280">Type</span><span class="op" id="6093284">.</span><span class="op" id="6093285">(</span><span class="op" id="6093286">*</span><span class="ident" id="6093287">ast</span><span class="op" id="6093290">.</span><span class="ident" id="6093291">FuncType</span><span class="op" id="6093299">)</span><span class="op" id="6093300">;</span>&nbsp;<span class="ident" id="6093302">isFtyp</span>&nbsp;<span class="op" id="6093309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6093315">//&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093329">p</span><span class="op" id="6093330">.</span><span class="ident" id="6093331">expr</span><span class="op" id="6093335">(</span><span class="ident" id="6093336">f</span><span class="op" id="6093337">.</span><span class="ident" id="6093338">Names</span><span class="op" id="6093343">[</span><span class="num" id="6093344">0</span><span class="op" id="6093345">]</span><span class="op" id="6093346">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093352">p</span><span class="op" id="6093353">.</span><span class="ident" id="6093354">signature</span><span class="op" id="6093363">(</span><span class="ident" id="6093364">ftyp</span><span class="op" id="6093368">.</span><span class="ident" id="6093369">Params</span><span class="op" id="6093375">,</span>&nbsp;<span class="ident" id="6093377">ftyp</span><span class="op" id="6093381">.</span><span class="ident" id="6093382">Results</span><span class="op" id="6093389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6093394">}</span>&nbsp;<span class="keyword" id="6093396">else</span>&nbsp;<span class="op" id="6093401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6093407">//&nbsp;embedded&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093433">p</span><span class="op" id="6093434">.</span><span class="ident" id="6093435">expr</span><span class="op" id="6093439">(</span><span class="ident" id="6093440">f</span><span class="op" id="6093441">.</span><span class="ident" id="6093442">Type</span><span class="op" id="6093446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6093451">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093456">p</span><span class="op" id="6093457">.</span><span class="ident" id="6093458">setComment</span><span class="op" id="6093468">(</span><span class="ident" id="6093469">f</span><span class="op" id="6093470">.</span><span class="ident" id="6093471">Comment</span><span class="op" id="6093478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6093482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093486">if</span>&nbsp;<span class="ident" id="6093489">isIncomplete</span>&nbsp;<span class="op" id="6093502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093507">if</span>&nbsp;<span class="builtinfunc" id="6093510">len</span><span class="op" id="6093513">(</span><span class="ident" id="6093514">list</span><span class="op" id="6093518">)</span>&nbsp;<span class="op" id="6093520">&gt;</span>&nbsp;<span class="num" id="6093522">0</span>&nbsp;<span class="op" id="6093524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093530">p</span><span class="op" id="6093531">.</span><span class="builtinfunc" id="6093532">print</span><span class="op" id="6093537">(</span><span class="ident" id="6093538">formfeed</span><span class="op" id="6093546">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6093551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093556">p</span><span class="op" id="6093557">.</span><span class="ident" id="6093558">flush</span><span class="op" id="6093563">(</span><span class="ident" id="6093564">p</span><span class="op" id="6093565">.</span><span class="ident" id="6093566">posFor</span><span class="op" id="6093572">(</span><span class="ident" id="6093573">rbrace</span><span class="op" id="6093579">)</span><span class="op" id="6093580">,</span>&nbsp;<span class="ident" id="6093582">token</span><span class="op" id="6093587">.</span><span class="ident" id="6093588">RBRACE</span><span class="op" id="6093594">)</span>&nbsp;<span class="comment" id="6093596">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093648">p</span><span class="op" id="6093649">.</span><span class="ident" id="6093650">setLineComment</span><span class="op" id="6093664">(</span><span class="string" id="6093665">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;methods&#34;</span><span class="op" id="6093709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6093713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6093717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093720">p</span><span class="op" id="6093721">.</span><span class="builtinfunc" id="6093722">print</span><span class="op" id="6093727">(</span><span class="ident" id="6093728">unindent</span><span class="op" id="6093736">,</span>&nbsp;<span class="ident" id="6093738">formfeed</span><span class="op" id="6093746">,</span>&nbsp;<span class="ident" id="6093748">rbrace</span><span class="op" id="6093754">,</span>&nbsp;<span class="ident" id="6093756">token</span><span class="op" id="6093761">.</span><span class="ident" id="6093762">RBRACE</span><span class="op" id="6093768">)</span><br>
<span class="lineno"></span><span class="op" id="6093770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6093773">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">505</span><span class="comment" id="6093853">//&nbsp;Expressions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6093869">func</span>&nbsp;<span class="ident" id="6093874">walkBinary</span><span class="op" id="6093884">(</span><span class="ident" id="6093885">e</span>&nbsp;<span class="op" id="6093887">*</span><span class="ident" id="6093888">ast</span><span class="op" id="6093891">.</span><span class="ident" id="6093892">BinaryExpr</span><span class="op" id="6093902">)</span>&nbsp;<span class="op" id="6093904">(</span><span class="ident" id="6093905">has4</span><span class="op" id="6093909">,</span>&nbsp;<span class="ident" id="6093911">has5</span>&nbsp;<span class="builtintype" id="6093916">bool</span><span class="op" id="6093920">,</span>&nbsp;<span class="ident" id="6093922">maxProblem</span>&nbsp;<span class="builtintype" id="6093933">int</span><span class="op" id="6093936">)</span>&nbsp;<span class="op" id="6093938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093941">switch</span>&nbsp;<span class="ident" id="6093948">e</span><span class="op" id="6093949">.</span><span class="ident" id="6093950">Op</span><span class="op" id="6093952">.</span><span class="ident" id="6093953">Precedence</span><span class="op" id="6093963">(</span><span class="op" id="6093964">)</span>&nbsp;<span class="op" id="6093966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093969">case</span>&nbsp;<span class="num" id="6093974">4</span><span class="op" id="6093975">:</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6093979">has4</span>&nbsp;<span class="op" id="6093984">=</span>&nbsp;<span class="builtintype" id="6093986">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6093992">case</span>&nbsp;<span class="num" id="6093997">5</span><span class="op" id="6093998">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094002">has5</span>&nbsp;<span class="op" id="6094007">=</span>&nbsp;<span class="builtintype" id="6094009">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094019">switch</span>&nbsp;<span class="ident" id="6094026">l</span>&nbsp;<span class="op" id="6094028">:=</span>&nbsp;<span class="ident" id="6094031">e</span><span class="op" id="6094032">.</span><span class="ident" id="6094033">X</span><span class="op" id="6094034">.</span><span class="op" id="6094035">(</span><span class="keyword" id="6094036">type</span><span class="op" id="6094040">)</span>&nbsp;<span class="op" id="6094042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094045">case</span>&nbsp;<span class="op" id="6094050">*</span><span class="ident" id="6094051">ast</span><span class="op" id="6094054">.</span><span class="ident" id="6094055">BinaryExpr</span><span class="op" id="6094065">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094069">if</span>&nbsp;<span class="ident" id="6094072">l</span><span class="op" id="6094073">.</span><span class="ident" id="6094074">Op</span><span class="op" id="6094076">.</span><span class="ident" id="6094077">Precedence</span><span class="op" id="6094087">(</span><span class="op" id="6094088">)</span>&nbsp;<span class="op" id="6094090">&lt;</span>&nbsp;<span class="ident" id="6094092">e</span><span class="op" id="6094093">.</span><span class="ident" id="6094094">Op</span><span class="op" id="6094096">.</span><span class="ident" id="6094097">Precedence</span><span class="op" id="6094107">(</span><span class="op" id="6094108">)</span>&nbsp;<span class="op" id="6094110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6094115">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6094146">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094202">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094214">h4</span><span class="op" id="6094216">,</span>&nbsp;<span class="ident" id="6094218">h5</span><span class="op" id="6094220">,</span>&nbsp;<span class="ident" id="6094222">mp</span>&nbsp;<span class="op" id="6094225">:=</span>&nbsp;<span class="ident" id="6094228">walkBinary</span><span class="op" id="6094238">(</span><span class="ident" id="6094239">l</span><span class="op" id="6094240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094244">has4</span>&nbsp;<span class="op" id="6094249">=</span>&nbsp;<span class="ident" id="6094251">has4</span>&nbsp;<span class="op" id="6094256">||</span>&nbsp;<span class="ident" id="6094259">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094264">has5</span>&nbsp;<span class="op" id="6094269">=</span>&nbsp;<span class="ident" id="6094271">has5</span>&nbsp;<span class="op" id="6094276">||</span>&nbsp;<span class="ident" id="6094279">h5</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094284">if</span>&nbsp;<span class="ident" id="6094287">maxProblem</span>&nbsp;<span class="op" id="6094298">&lt;</span>&nbsp;<span class="ident" id="6094300">mp</span>&nbsp;<span class="op" id="6094303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094308">maxProblem</span>&nbsp;<span class="op" id="6094319">=</span>&nbsp;<span class="ident" id="6094321">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094333">switch</span>&nbsp;<span class="ident" id="6094340">r</span>&nbsp;<span class="op" id="6094342">:=</span>&nbsp;<span class="ident" id="6094345">e</span><span class="op" id="6094346">.</span><span class="ident" id="6094347">Y</span><span class="op" id="6094348">.</span><span class="op" id="6094349">(</span><span class="keyword" id="6094350">type</span><span class="op" id="6094354">)</span>&nbsp;<span class="op" id="6094356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094359">case</span>&nbsp;<span class="op" id="6094364">*</span><span class="ident" id="6094365">ast</span><span class="op" id="6094368">.</span><span class="ident" id="6094369">BinaryExpr</span><span class="op" id="6094379">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094383">if</span>&nbsp;<span class="ident" id="6094386">r</span><span class="op" id="6094387">.</span><span class="ident" id="6094388">Op</span><span class="op" id="6094390">.</span><span class="ident" id="6094391">Precedence</span><span class="op" id="6094401">(</span><span class="op" id="6094402">)</span>&nbsp;<span class="op" id="6094404">&lt;=</span>&nbsp;<span class="ident" id="6094407">e</span><span class="op" id="6094408">.</span><span class="ident" id="6094409">Op</span><span class="op" id="6094411">.</span><span class="ident" id="6094412">Precedence</span><span class="op" id="6094422">(</span><span class="op" id="6094423">)</span>&nbsp;<span class="op" id="6094425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6094430">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6094461">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094517">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094529">h4</span><span class="op" id="6094531">,</span>&nbsp;<span class="ident" id="6094533">h5</span><span class="op" id="6094535">,</span>&nbsp;<span class="ident" id="6094537">mp</span>&nbsp;<span class="op" id="6094540">:=</span>&nbsp;<span class="ident" id="6094543">walkBinary</span><span class="op" id="6094553">(</span><span class="ident" id="6094554">r</span><span class="op" id="6094555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094559">has4</span>&nbsp;<span class="op" id="6094564">=</span>&nbsp;<span class="ident" id="6094566">has4</span>&nbsp;<span class="op" id="6094571">||</span>&nbsp;<span class="ident" id="6094574">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094579">has5</span>&nbsp;<span class="op" id="6094584">=</span>&nbsp;<span class="ident" id="6094586">has5</span>&nbsp;<span class="op" id="6094591">||</span>&nbsp;<span class="ident" id="6094594">h5</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094599">if</span>&nbsp;<span class="ident" id="6094602">maxProblem</span>&nbsp;<span class="op" id="6094613">&lt;</span>&nbsp;<span class="ident" id="6094615">mp</span>&nbsp;<span class="op" id="6094618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094623">maxProblem</span>&nbsp;<span class="op" id="6094634">=</span>&nbsp;<span class="ident" id="6094636">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094645">case</span>&nbsp;<span class="op" id="6094650">*</span><span class="ident" id="6094651">ast</span><span class="op" id="6094654">.</span><span class="ident" id="6094655">StarExpr</span><span class="op" id="6094663">:</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094667">if</span>&nbsp;<span class="ident" id="6094670">e</span><span class="op" id="6094671">.</span><span class="ident" id="6094672">Op</span>&nbsp;<span class="op" id="6094675">==</span>&nbsp;<span class="ident" id="6094678">token</span><span class="op" id="6094683">.</span><span class="ident" id="6094684">QUO</span>&nbsp;<span class="op" id="6094688">{</span>&nbsp;<span class="comment" id="6094690">//&nbsp;`*/`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094701">maxProblem</span>&nbsp;<span class="op" id="6094712">=</span>&nbsp;<span class="num" id="6094714">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094722">case</span>&nbsp;<span class="op" id="6094727">*</span><span class="ident" id="6094728">ast</span><span class="op" id="6094731">.</span><span class="ident" id="6094732">UnaryExpr</span><span class="op" id="6094741">:</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094745">switch</span>&nbsp;<span class="ident" id="6094752">e</span><span class="op" id="6094753">.</span><span class="ident" id="6094754">Op</span><span class="op" id="6094756">.</span><span class="ident" id="6094757">String</span><span class="op" id="6094763">(</span><span class="op" id="6094764">)</span>&nbsp;<span class="op" id="6094766">+</span>&nbsp;<span class="ident" id="6094768">r</span><span class="op" id="6094769">.</span><span class="ident" id="6094770">Op</span><span class="op" id="6094772">.</span><span class="ident" id="6094773">String</span><span class="op" id="6094779">(</span><span class="op" id="6094780">)</span>&nbsp;<span class="op" id="6094782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094786">case</span>&nbsp;<span class="string" id="6094791">&#34;/*&#34;</span><span class="op" id="6094795">,</span>&nbsp;<span class="string" id="6094797">&#34;&amp;&amp;&#34;</span><span class="op" id="6094801">,</span>&nbsp;<span class="string" id="6094803">&#34;&amp;^&#34;</span><span class="op" id="6094807">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094812">maxProblem</span>&nbsp;<span class="op" id="6094823">=</span>&nbsp;<span class="num" id="6094825">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094829">case</span>&nbsp;<span class="string" id="6094834">&#34;++&#34;</span><span class="op" id="6094838">,</span>&nbsp;<span class="string" id="6094840">&#34;--&#34;</span><span class="op" id="6094844">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094849">if</span>&nbsp;<span class="ident" id="6094852">maxProblem</span>&nbsp;<span class="op" id="6094863">&lt;</span>&nbsp;<span class="num" id="6094865">4</span>&nbsp;<span class="op" id="6094867">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094873">maxProblem</span>&nbsp;<span class="op" id="6094884">=</span>&nbsp;<span class="num" id="6094886">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6094898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6094901">return</span><br>
<span class="lineno">560</span><span class="op" id="6094908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6094911">func</span>&nbsp;<span class="ident" id="6094916">cutoff</span><span class="op" id="6094922">(</span><span class="ident" id="6094923">e</span>&nbsp;<span class="op" id="6094925">*</span><span class="ident" id="6094926">ast</span><span class="op" id="6094929">.</span><span class="ident" id="6094930">BinaryExpr</span><span class="op" id="6094940">,</span>&nbsp;<span class="ident" id="6094942">depth</span>&nbsp;<span class="builtintype" id="6094948">int</span><span class="op" id="6094951">)</span>&nbsp;<span class="builtintype" id="6094953">int</span>&nbsp;<span class="op" id="6094957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6094960">has4</span><span class="op" id="6094964">,</span>&nbsp;<span class="ident" id="6094966">has5</span><span class="op" id="6094970">,</span>&nbsp;<span class="ident" id="6094972">maxProblem</span>&nbsp;<span class="op" id="6094983">:=</span>&nbsp;<span class="ident" id="6094986">walkBinary</span><span class="op" id="6094996">(</span><span class="ident" id="6094997">e</span><span class="op" id="6094998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095001">if</span>&nbsp;<span class="ident" id="6095004">maxProblem</span>&nbsp;<span class="op" id="6095015">&gt;</span>&nbsp;<span class="num" id="6095017">0</span>&nbsp;<span class="op" id="6095019">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095023">return</span>&nbsp;<span class="ident" id="6095030">maxProblem</span>&nbsp;<span class="op" id="6095041">+</span>&nbsp;<span class="num" id="6095043">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6095046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095049">if</span>&nbsp;<span class="ident" id="6095052">has4</span>&nbsp;<span class="op" id="6095057">&amp;&amp;</span>&nbsp;<span class="ident" id="6095060">has5</span>&nbsp;<span class="op" id="6095065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095069">if</span>&nbsp;<span class="ident" id="6095072">depth</span>&nbsp;<span class="op" id="6095078">==</span>&nbsp;<span class="num" id="6095081">1</span>&nbsp;<span class="op" id="6095083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095088">return</span>&nbsp;<span class="num" id="6095095">5</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6095099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095103">return</span>&nbsp;<span class="num" id="6095110">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6095113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095116">if</span>&nbsp;<span class="ident" id="6095119">depth</span>&nbsp;<span class="op" id="6095125">==</span>&nbsp;<span class="num" id="6095128">1</span>&nbsp;<span class="op" id="6095130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095134">return</span>&nbsp;<span class="num" id="6095141">6</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6095144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095147">return</span>&nbsp;<span class="num" id="6095154">4</span><br>
<span class="lineno"></span><span class="op" id="6095156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6095159">func</span>&nbsp;<span class="ident" id="6095164">diffPrec</span><span class="op" id="6095172">(</span><span class="ident" id="6095173">expr</span>&nbsp;<span class="ident" id="6095178">ast</span><span class="op" id="6095181">.</span><span class="ident" id="6095182">Expr</span><span class="op" id="6095186">,</span>&nbsp;<span class="ident" id="6095188">prec</span>&nbsp;<span class="builtintype" id="6095193">int</span><span class="op" id="6095196">)</span>&nbsp;<span class="builtintype" id="6095198">int</span>&nbsp;<span class="op" id="6095202">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6095205">x</span><span class="op" id="6095206">,</span>&nbsp;<span class="ident" id="6095208">ok</span>&nbsp;<span class="op" id="6095211">:=</span>&nbsp;<span class="ident" id="6095214">expr</span><span class="op" id="6095218">.</span><span class="op" id="6095219">(</span><span class="op" id="6095220">*</span><span class="ident" id="6095221">ast</span><span class="op" id="6095224">.</span><span class="ident" id="6095225">BinaryExpr</span><span class="op" id="6095235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095238">if</span>&nbsp;<span class="op" id="6095241">!</span><span class="ident" id="6095242">ok</span>&nbsp;<span class="op" id="6095245">||</span>&nbsp;<span class="ident" id="6095248">prec</span>&nbsp;<span class="op" id="6095253">!=</span>&nbsp;<span class="ident" id="6095256">x</span><span class="op" id="6095257">.</span><span class="ident" id="6095258">Op</span><span class="op" id="6095260">.</span><span class="ident" id="6095261">Precedence</span><span class="op" id="6095271">(</span><span class="op" id="6095272">)</span>&nbsp;<span class="op" id="6095274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095278">return</span>&nbsp;<span class="num" id="6095285">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6095288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095291">return</span>&nbsp;<span class="num" id="6095298">0</span><br>
<span class="lineno">585</span><span class="op" id="6095300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6095303">func</span>&nbsp;<span class="ident" id="6095308">reduceDepth</span><span class="op" id="6095319">(</span><span class="ident" id="6095320">depth</span>&nbsp;<span class="builtintype" id="6095326">int</span><span class="op" id="6095329">)</span>&nbsp;<span class="builtintype" id="6095331">int</span>&nbsp;<span class="op" id="6095335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6095338">depth</span><span class="op" id="6095343">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095347">if</span>&nbsp;<span class="ident" id="6095350">depth</span>&nbsp;<span class="op" id="6095356">&lt;</span>&nbsp;<span class="num" id="6095358">1</span>&nbsp;<span class="op" id="6095360">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6095364">depth</span>&nbsp;<span class="op" id="6095370">=</span>&nbsp;<span class="num" id="6095372">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6095375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6095378">return</span>&nbsp;<span class="ident" id="6095385">depth</span><br>
<span class="lineno"></span><span class="op" id="6095391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="6095394">//&nbsp;Format&nbsp;the&nbsp;binary&nbsp;expression:&nbsp;decide&nbsp;the&nbsp;cutoff&nbsp;and&nbsp;then&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="6095462">//&nbsp;Let&#39;s&nbsp;call&nbsp;depth&nbsp;==&nbsp;1&nbsp;Normal&nbsp;mode,&nbsp;and&nbsp;depth&nbsp;&gt;&nbsp;1&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="6095528">//&nbsp;(Algorithm&nbsp;suggestion&nbsp;by&nbsp;Russ&nbsp;Cox.)</span><br>
<span class="lineno"></span><span class="comment" id="6095567">//</span><br>
<span class="lineno"></span><span class="comment" id="6095570">//&nbsp;The&nbsp;precedences&nbsp;are:</span><br>
<span class="lineno">600</span><span class="comment" id="6095594">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;/&nbsp;&nbsp;%&nbsp;&nbsp;&lt;&lt;&nbsp;&nbsp;&gt;&gt;&nbsp;&nbsp;&amp;&nbsp;&nbsp;&amp;^</span><br>
<span class="lineno"></span><span class="comment" id="6095634">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;-&nbsp;&nbsp;|&nbsp;&nbsp;^</span><br>
<span class="lineno"></span><span class="comment" id="6095662">//&nbsp;&nbsp;&nbsp;&nbsp3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&nbsp;&nbsp;!=&nbsp;&nbsp;&lt;&nbsp;&nbsp;&lt;=&nbsp;&nbsp;&gt;&nbsp;&nbsp;&gt;=</span><br>
<span class="lineno"></span><span class="comment" id="6095700">//&nbsp;&nbsp;&nbsp;&nbsp2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;</span><br>
<span class="lineno"></span><span class="comment" id="6095720">//&nbsp;&nbsp;&nbsp;&nbsp1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||</span><br>
<span class="lineno">605</span><span class="comment" id="6095740">//</span><br>
<span class="lineno"></span><span class="comment" id="6095743">//&nbsp;The&nbsp;only&nbsp;decision&nbsp;is&nbsp;whether&nbsp;there&nbsp;will&nbsp;be&nbsp;spaces&nbsp;around&nbsp;levels&nbsp;4&nbsp;and&nbsp;5.</span><br>
<span class="lineno"></span><span class="comment" id="6095819">//&nbsp;There&nbsp;are&nbsp;never&nbsp;spaces&nbsp;at&nbsp;level&nbsp;6&nbsp;(unary),&nbsp;and&nbsp;always&nbsp;spaces&nbsp;at&nbsp;levels&nbsp;3&nbsp;and&nbsp;below.</span><br>
<span class="lineno"></span><span class="comment" id="6095906">//</span><br>
<span class="lineno"></span><span class="comment" id="6095909">//&nbsp;To&nbsp;choose&nbsp;the&nbsp;cutoff,&nbsp;look&nbsp;at&nbsp;the&nbsp;whole&nbsp;expression&nbsp;but&nbsp;excluding&nbsp;primary</span><br>
<span class="lineno">610</span><span class="comment" id="6095985">//&nbsp;expressions&nbsp;(function&nbsp;calls,&nbsp;parenthesized&nbsp;exprs),&nbsp;and&nbsp;apply&nbsp;these&nbsp;rules:</span><br>
<span class="lineno"></span><span class="comment" id="6096062">//</span><br>
<span class="lineno"></span><span class="comment" id="6096065">//&nbsp;&nbsp;&nbsp;&nbsp1)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;binary&nbsp;operator&nbsp;with&nbsp;a&nbsp;right&nbsp;side&nbsp;unary&nbsp;operand</span><br>
<span class="lineno"></span><span class="comment" id="6096133">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;that&nbsp;would&nbsp;clash&nbsp;without&nbsp;a&nbsp;space,&nbsp;the&nbsp;cutoff&nbsp;must&nbsp;be&nbsp;(in&nbsp;order):</span><br>
<span class="lineno"></span><span class="comment" id="6096204">//</span><br>
<span class="lineno">615</span><span class="comment" id="6096207">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp/*&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="6096216">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="6096225">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&amp;^&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="6096234">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp++&nbsp;&nbsp;&nbsp;&nbsp5</span><br>
<span class="lineno"></span><span class="comment" id="6096243">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp--&nbsp;&nbsp;&nbsp;&nbsp5</span><br>
<span class="lineno">620</span><span class="comment" id="6096252">//</span><br>
<span class="lineno"></span><span class="comment" id="6096255">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Comparison&nbsp;operators&nbsp;always&nbsp;have&nbsp;spaces&nbsp;around&nbsp;them.)</span><br>
<span class="lineno"></span><span class="comment" id="6096321">//</span><br>
<span class="lineno"></span><span class="comment" id="6096324">//&nbsp;&nbsp;&nbsp;&nbsp2)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;mix&nbsp;of&nbsp;level&nbsp;5&nbsp;and&nbsp;level&nbsp;4&nbsp;operators,&nbsp;then&nbsp;the&nbsp;cutoff</span><br>
<span class="lineno"></span><span class="comment" id="6096398">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;is&nbsp;5&nbsp;(use&nbsp;spaces&nbsp;to&nbsp;distinguish&nbsp;precedence)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno">625</span><span class="comment" id="6096463">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="6096511">//</span><br>
<span class="lineno"></span><span class="comment" id="6096514">//&nbsp;&nbsp;&nbsp;&nbsp3)&nbsp;If&nbsp;there&nbsp;are&nbsp;no&nbsp;level&nbsp;4&nbsp;operators&nbsp;or&nbsp;no&nbsp;level&nbsp;5&nbsp;operators,&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6096588">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;cutoff&nbsp;is&nbsp;6&nbsp;(always&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno"></span><span class="comment" id="6096641">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno">630</span><span class="comment" id="6096689">//</span><br>
<span class="lineno"></span><span class="keyword" id="6096692">func</span>&nbsp;<span class="op" id="6096697">(</span><span class="ident" id="6096698">p</span>&nbsp;<span class="op" id="6096700">*</span><span class="ident" id="6096701">printer</span><span class="op" id="6096708">)</span>&nbsp;<span class="ident" id="6096710">binaryExpr</span><span class="op" id="6096720">(</span><span class="ident" id="6096721">x</span>&nbsp;<span class="op" id="6096723">*</span><span class="ident" id="6096724">ast</span><span class="op" id="6096727">.</span><span class="ident" id="6096728">BinaryExpr</span><span class="op" id="6096738">,</span>&nbsp;<span class="ident" id="6096740">prec1</span><span class="op" id="6096745">,</span>&nbsp;<span class="ident" id="6096747">cutoff</span><span class="op" id="6096753">,</span>&nbsp;<span class="ident" id="6096755">depth</span>&nbsp;<span class="builtintype" id="6096761">int</span><span class="op" id="6096764">)</span>&nbsp;<span class="op" id="6096766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096769">prec</span>&nbsp;<span class="op" id="6096774">:=</span>&nbsp;<span class="ident" id="6096777">x</span><span class="op" id="6096778">.</span><span class="ident" id="6096779">Op</span><span class="op" id="6096781">.</span><span class="ident" id="6096782">Precedence</span><span class="op" id="6096792">(</span><span class="op" id="6096793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6096796">if</span>&nbsp;<span class="ident" id="6096799">prec</span>&nbsp;<span class="op" id="6096804">&lt;</span>&nbsp;<span class="ident" id="6096806">prec1</span>&nbsp;<span class="op" id="6096812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6096816">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6096840">//&nbsp;Note:&nbsp;The&nbsp;parser&nbsp;inserts&nbsp;an&nbsp;ast.ParenExpr&nbsp;node;&nbsp;thus&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6096908">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can&nbsp;only&nbsp;occur&nbsp;if&nbsp;the&nbsp;AST&nbsp;is&nbsp;created&nbsp;in&nbsp;a&nbsp;different&nbsp;way.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6096976">p</span><span class="op" id="6096977">.</span><span class="builtinfunc" id="6096978">print</span><span class="op" id="6096983">(</span><span class="ident" id="6096984">token</span><span class="op" id="6096989">.</span><span class="ident" id="6096990">LPAREN</span><span class="op" id="6096996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097000">p</span><span class="op" id="6097001">.</span><span class="ident" id="6097002">expr0</span><span class="op" id="6097007">(</span><span class="ident" id="6097008">x</span><span class="op" id="6097009">,</span>&nbsp;<span class="ident" id="6097011">reduceDepth</span><span class="op" id="6097022">(</span><span class="ident" id="6097023">depth</span><span class="op" id="6097028">)</span><span class="op" id="6097029">)</span>&nbsp;<span class="comment" id="6097031">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097072">p</span><span class="op" id="6097073">.</span><span class="builtinfunc" id="6097074">print</span><span class="op" id="6097079">(</span><span class="ident" id="6097080">token</span><span class="op" id="6097085">.</span><span class="ident" id="6097086">RPAREN</span><span class="op" id="6097092">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097096">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6097104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097108">printBlank</span>&nbsp;<span class="op" id="6097119">:=</span>&nbsp;<span class="ident" id="6097122">prec</span>&nbsp;<span class="op" id="6097127">&lt;</span>&nbsp;<span class="ident" id="6097129">cutoff</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097138">ws</span>&nbsp;<span class="op" id="6097141">:=</span>&nbsp;<span class="ident" id="6097144">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097152">p</span><span class="op" id="6097153">.</span><span class="ident" id="6097154">expr1</span><span class="op" id="6097159">(</span><span class="ident" id="6097160">x</span><span class="op" id="6097161">.</span><span class="ident" id="6097162">X</span><span class="op" id="6097163">,</span>&nbsp;<span class="ident" id="6097165">prec</span><span class="op" id="6097169">,</span>&nbsp;<span class="ident" id="6097171">depth</span><span class="op" id="6097176">+</span><span class="ident" id="6097177">diffPrec</span><span class="op" id="6097185">(</span><span class="ident" id="6097186">x</span><span class="op" id="6097187">.</span><span class="ident" id="6097188">X</span><span class="op" id="6097189">,</span>&nbsp;<span class="ident" id="6097191">prec</span><span class="op" id="6097195">)</span><span class="op" id="6097196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097199">if</span>&nbsp;<span class="ident" id="6097202">printBlank</span>&nbsp;<span class="op" id="6097213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097217">p</span><span class="op" id="6097218">.</span><span class="builtinfunc" id="6097219">print</span><span class="op" id="6097224">(</span><span class="ident" id="6097225">blank</span><span class="op" id="6097230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6097233">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097236">xline</span>&nbsp;<span class="op" id="6097242">:=</span>&nbsp;<span class="ident" id="6097245">p</span><span class="op" id="6097246">.</span><span class="ident" id="6097247">pos</span><span class="op" id="6097250">.</span><span class="ident" id="6097251">Line</span>&nbsp;<span class="comment" id="6097256">//&nbsp;before&nbsp;the&nbsp;operator&nbsp;(it&nbsp;may&nbsp;be&nbsp;on&nbsp;the&nbsp;next&nbsp;line!)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097310">yline</span>&nbsp;<span class="op" id="6097316">:=</span>&nbsp;<span class="ident" id="6097319">p</span><span class="op" id="6097320">.</span><span class="ident" id="6097321">lineFor</span><span class="op" id="6097328">(</span><span class="ident" id="6097329">x</span><span class="op" id="6097330">.</span><span class="ident" id="6097331">Y</span><span class="op" id="6097332">.</span><span class="ident" id="6097333">Pos</span><span class="op" id="6097336">(</span><span class="op" id="6097337">)</span><span class="op" id="6097338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097341">p</span><span class="op" id="6097342">.</span><span class="builtinfunc" id="6097343">print</span><span class="op" id="6097348">(</span><span class="ident" id="6097349">x</span><span class="op" id="6097350">.</span><span class="ident" id="6097351">OpPos</span><span class="op" id="6097356">,</span>&nbsp;<span class="ident" id="6097358">x</span><span class="op" id="6097359">.</span><span class="ident" id="6097360">Op</span><span class="op" id="6097362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097365">if</span>&nbsp;<span class="ident" id="6097368">xline</span>&nbsp;<span class="op" id="6097374">!=</span>&nbsp;<span class="ident" id="6097377">yline</span>&nbsp;<span class="op" id="6097383">&amp;&amp;</span>&nbsp;<span class="ident" id="6097386">xline</span>&nbsp;<span class="op" id="6097392">&gt;</span>&nbsp;<span class="num" id="6097394">0</span>&nbsp;<span class="op" id="6097396">&amp;&amp;</span>&nbsp;<span class="ident" id="6097399">yline</span>&nbsp;<span class="op" id="6097405">&gt;</span>&nbsp;<span class="num" id="6097407">0</span>&nbsp;<span class="op" id="6097409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6097413">//&nbsp;at&nbsp;least&nbsp;one&nbsp;line&nbsp;break,&nbsp;but&nbsp;respect&nbsp;an&nbsp;extra&nbsp;empty&nbsp;line</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6097475">//&nbsp;in&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097494">if</span>&nbsp;<span class="ident" id="6097497">p</span><span class="op" id="6097498">.</span><span class="ident" id="6097499">linebreak</span><span class="op" id="6097508">(</span><span class="ident" id="6097509">yline</span><span class="op" id="6097514">,</span>&nbsp;<span class="num" id="6097516">1</span><span class="op" id="6097517">,</span>&nbsp;<span class="ident" id="6097519">ws</span><span class="op" id="6097521">,</span>&nbsp;<span class="builtintype" id="6097523">true</span><span class="op" id="6097527">)</span>&nbsp;<span class="op" id="6097529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097534">ws</span>&nbsp;<span class="op" id="6097537">=</span>&nbsp;<span class="ident" id="6097539">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097549">printBlank</span>&nbsp;<span class="op" id="6097560">=</span>&nbsp;<span class="builtintype" id="6097562">false</span>&nbsp;<span class="comment" id="6097568">//&nbsp;no&nbsp;blank&nbsp;after&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6097599">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6097602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097605">if</span>&nbsp;<span class="ident" id="6097608">printBlank</span>&nbsp;<span class="op" id="6097619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097623">p</span><span class="op" id="6097624">.</span><span class="builtinfunc" id="6097625">print</span><span class="op" id="6097630">(</span><span class="ident" id="6097631">blank</span><span class="op" id="6097636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6097639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097642">p</span><span class="op" id="6097643">.</span><span class="ident" id="6097644">expr1</span><span class="op" id="6097649">(</span><span class="ident" id="6097650">x</span><span class="op" id="6097651">.</span><span class="ident" id="6097652">Y</span><span class="op" id="6097653">,</span>&nbsp;<span class="ident" id="6097655">prec</span><span class="op" id="6097659">+</span><span class="num" id="6097660">1</span><span class="op" id="6097661">,</span>&nbsp;<span class="ident" id="6097663">depth</span><span class="op" id="6097668">+</span><span class="num" id="6097669">1</span><span class="op" id="6097670">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097673">if</span>&nbsp;<span class="ident" id="6097676">ws</span>&nbsp;<span class="op" id="6097679">==</span>&nbsp;<span class="ident" id="6097682">ignore</span>&nbsp;<span class="op" id="6097689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097693">p</span><span class="op" id="6097694">.</span><span class="builtinfunc" id="6097695">print</span><span class="op" id="6097700">(</span><span class="ident" id="6097701">unindent</span><span class="op" id="6097709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6097712">}</span><br>
<span class="lineno"></span><span class="op" id="6097714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="keyword" id="6097717">func</span>&nbsp;<span class="ident" id="6097722">isBinary</span><span class="op" id="6097730">(</span><span class="ident" id="6097731">expr</span>&nbsp;<span class="ident" id="6097736">ast</span><span class="op" id="6097739">.</span><span class="ident" id="6097740">Expr</span><span class="op" id="6097744">)</span>&nbsp;<span class="builtintype" id="6097746">bool</span>&nbsp;<span class="op" id="6097751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097754">_</span><span class="op" id="6097755">,</span>&nbsp;<span class="ident" id="6097757">ok</span>&nbsp;<span class="op" id="6097760">:=</span>&nbsp;<span class="ident" id="6097763">expr</span><span class="op" id="6097767">.</span><span class="op" id="6097768">(</span><span class="op" id="6097769">*</span><span class="ident" id="6097770">ast</span><span class="op" id="6097773">.</span><span class="ident" id="6097774">BinaryExpr</span><span class="op" id="6097784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097787">return</span>&nbsp;<span class="ident" id="6097794">ok</span><br>
<span class="lineno"></span><span class="op" id="6097797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="6097800">func</span>&nbsp;<span class="op" id="6097805">(</span><span class="ident" id="6097806">p</span>&nbsp;<span class="op" id="6097808">*</span><span class="ident" id="6097809">printer</span><span class="op" id="6097816">)</span>&nbsp;<span class="ident" id="6097818">expr1</span><span class="op" id="6097823">(</span><span class="ident" id="6097824">expr</span>&nbsp;<span class="ident" id="6097829">ast</span><span class="op" id="6097832">.</span><span class="ident" id="6097833">Expr</span><span class="op" id="6097837">,</span>&nbsp;<span class="ident" id="6097839">prec1</span><span class="op" id="6097844">,</span>&nbsp;<span class="ident" id="6097846">depth</span>&nbsp;<span class="builtintype" id="6097852">int</span><span class="op" id="6097855">)</span>&nbsp;<span class="op" id="6097857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097860">p</span><span class="op" id="6097861">.</span><span class="builtinfunc" id="6097862">print</span><span class="op" id="6097867">(</span><span class="ident" id="6097868">expr</span><span class="op" id="6097872">.</span><span class="ident" id="6097873">Pos</span><span class="op" id="6097876">(</span><span class="op" id="6097877">)</span><span class="op" id="6097878">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097882">switch</span>&nbsp;<span class="ident" id="6097889">x</span>&nbsp;<span class="op" id="6097891">:=</span>&nbsp;<span class="ident" id="6097894">expr</span><span class="op" id="6097898">.</span><span class="op" id="6097899">(</span><span class="keyword" id="6097900">type</span><span class="op" id="6097904">)</span>&nbsp;<span class="op" id="6097906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097909">case</span>&nbsp;<span class="op" id="6097914">*</span><span class="ident" id="6097915">ast</span><span class="op" id="6097918">.</span><span class="ident" id="6097919">BadExpr</span><span class="op" id="6097926">:</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097930">p</span><span class="op" id="6097931">.</span><span class="builtinfunc" id="6097932">print</span><span class="op" id="6097937">(</span><span class="string" id="6097938">&#34;BadExpr&#34;</span><span class="op" id="6097947">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097951">case</span>&nbsp;<span class="op" id="6097956">*</span><span class="ident" id="6097957">ast</span><span class="op" id="6097960">.</span><span class="ident" id="6097961">Ident</span><span class="op" id="6097966">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6097970">p</span><span class="op" id="6097971">.</span><span class="builtinfunc" id="6097972">print</span><span class="op" id="6097977">(</span><span class="ident" id="6097978">x</span><span class="op" id="6097979">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6097983">case</span>&nbsp;<span class="op" id="6097988">*</span><span class="ident" id="6097989">ast</span><span class="op" id="6097992">.</span><span class="ident" id="6097993">BinaryExpr</span><span class="op" id="6098003">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098007">if</span>&nbsp;<span class="ident" id="6098010">depth</span>&nbsp;<span class="op" id="6098016">&lt;</span>&nbsp;<span class="num" id="6098018">1</span>&nbsp;<span class="op" id="6098020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098025">p</span><span class="op" id="6098026">.</span><span class="ident" id="6098027">internalError</span><span class="op" id="6098040">(</span><span class="string" id="6098041">&#34;depth&nbsp;&lt;&nbsp;1:&#34;</span><span class="op" id="6098053">,</span>&nbsp;<span class="ident" id="6098055">depth</span><span class="op" id="6098060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098065">depth</span>&nbsp;<span class="op" id="6098071">=</span>&nbsp;<span class="num" id="6098073">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098077">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098081">p</span><span class="op" id="6098082">.</span><span class="ident" id="6098083">binaryExpr</span><span class="op" id="6098093">(</span><span class="ident" id="6098094">x</span><span class="op" id="6098095">,</span>&nbsp;<span class="ident" id="6098097">prec1</span><span class="op" id="6098102">,</span>&nbsp;<span class="ident" id="6098104">cutoff</span><span class="op" id="6098110">(</span><span class="ident" id="6098111">x</span><span class="op" id="6098112">,</span>&nbsp;<span class="ident" id="6098114">depth</span><span class="op" id="6098119">)</span><span class="op" id="6098120">,</span>&nbsp;<span class="ident" id="6098122">depth</span><span class="op" id="6098127">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098131">case</span>&nbsp;<span class="op" id="6098136">*</span><span class="ident" id="6098137">ast</span><span class="op" id="6098140">.</span><span class="ident" id="6098141">KeyValueExpr</span><span class="op" id="6098153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098157">p</span><span class="op" id="6098158">.</span><span class="ident" id="6098159">expr</span><span class="op" id="6098163">(</span><span class="ident" id="6098164">x</span><span class="op" id="6098165">.</span><span class="ident" id="6098166">Key</span><span class="op" id="6098169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098173">p</span><span class="op" id="6098174">.</span><span class="builtinfunc" id="6098175">print</span><span class="op" id="6098180">(</span><span class="ident" id="6098181">x</span><span class="op" id="6098182">.</span><span class="ident" id="6098183">Colon</span><span class="op" id="6098188">,</span>&nbsp;<span class="ident" id="6098190">token</span><span class="op" id="6098195">.</span><span class="ident" id="6098196">COLON</span><span class="op" id="6098201">,</span>&nbsp;<span class="ident" id="6098203">blank</span><span class="op" id="6098208">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098212">p</span><span class="op" id="6098213">.</span><span class="ident" id="6098214">expr</span><span class="op" id="6098218">(</span><span class="ident" id="6098219">x</span><span class="op" id="6098220">.</span><span class="ident" id="6098221">Value</span><span class="op" id="6098226">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098230">case</span>&nbsp;<span class="op" id="6098235">*</span><span class="ident" id="6098236">ast</span><span class="op" id="6098239">.</span><span class="ident" id="6098240">StarExpr</span><span class="op" id="6098248">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098252">const</span>&nbsp;<span class="ident" id="6098258">prec</span>&nbsp;<span class="op" id="6098263">=</span>&nbsp;<span class="ident" id="6098265">token</span><span class="op" id="6098270">.</span><span class="ident" id="6098271">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098283">if</span>&nbsp;<span class="ident" id="6098286">prec</span>&nbsp;<span class="op" id="6098291">&lt;</span>&nbsp;<span class="ident" id="6098293">prec1</span>&nbsp;<span class="op" id="6098299">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6098304">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098329">p</span><span class="op" id="6098330">.</span><span class="builtinfunc" id="6098331">print</span><span class="op" id="6098336">(</span><span class="ident" id="6098337">token</span><span class="op" id="6098342">.</span><span class="ident" id="6098343">LPAREN</span><span class="op" id="6098349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098354">p</span><span class="op" id="6098355">.</span><span class="builtinfunc" id="6098356">print</span><span class="op" id="6098361">(</span><span class="ident" id="6098362">token</span><span class="op" id="6098367">.</span><span class="ident" id="6098368">MUL</span><span class="op" id="6098371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098376">p</span><span class="op" id="6098377">.</span><span class="ident" id="6098378">expr</span><span class="op" id="6098382">(</span><span class="ident" id="6098383">x</span><span class="op" id="6098384">.</span><span class="ident" id="6098385">X</span><span class="op" id="6098386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098391">p</span><span class="op" id="6098392">.</span><span class="builtinfunc" id="6098393">print</span><span class="op" id="6098398">(</span><span class="ident" id="6098399">token</span><span class="op" id="6098404">.</span><span class="ident" id="6098405">RPAREN</span><span class="op" id="6098411">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098415">}</span>&nbsp;<span class="keyword" id="6098417">else</span>&nbsp;<span class="op" id="6098422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6098427">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098455">p</span><span class="op" id="6098456">.</span><span class="builtinfunc" id="6098457">print</span><span class="op" id="6098462">(</span><span class="ident" id="6098463">token</span><span class="op" id="6098468">.</span><span class="ident" id="6098469">MUL</span><span class="op" id="6098472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098477">p</span><span class="op" id="6098478">.</span><span class="ident" id="6098479">expr</span><span class="op" id="6098483">(</span><span class="ident" id="6098484">x</span><span class="op" id="6098485">.</span><span class="ident" id="6098486">X</span><span class="op" id="6098487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098491">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098495">case</span>&nbsp;<span class="op" id="6098500">*</span><span class="ident" id="6098501">ast</span><span class="op" id="6098504">.</span><span class="ident" id="6098505">UnaryExpr</span><span class="op" id="6098514">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098518">const</span>&nbsp;<span class="ident" id="6098524">prec</span>&nbsp;<span class="op" id="6098529">=</span>&nbsp;<span class="ident" id="6098531">token</span><span class="op" id="6098536">.</span><span class="ident" id="6098537">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098549">if</span>&nbsp;<span class="ident" id="6098552">prec</span>&nbsp;<span class="op" id="6098557">&lt;</span>&nbsp;<span class="ident" id="6098559">prec1</span>&nbsp;<span class="op" id="6098565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6098570">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098595">p</span><span class="op" id="6098596">.</span><span class="builtinfunc" id="6098597">print</span><span class="op" id="6098602">(</span><span class="ident" id="6098603">token</span><span class="op" id="6098608">.</span><span class="ident" id="6098609">LPAREN</span><span class="op" id="6098615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098620">p</span><span class="op" id="6098621">.</span><span class="ident" id="6098622">expr</span><span class="op" id="6098626">(</span><span class="ident" id="6098627">x</span><span class="op" id="6098628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098633">p</span><span class="op" id="6098634">.</span><span class="builtinfunc" id="6098635">print</span><span class="op" id="6098640">(</span><span class="ident" id="6098641">token</span><span class="op" id="6098646">.</span><span class="ident" id="6098647">RPAREN</span><span class="op" id="6098653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098657">}</span>&nbsp;<span class="keyword" id="6098659">else</span>&nbsp;<span class="op" id="6098664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6098669">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098697">p</span><span class="op" id="6098698">.</span><span class="builtinfunc" id="6098699">print</span><span class="op" id="6098704">(</span><span class="ident" id="6098705">x</span><span class="op" id="6098706">.</span><span class="ident" id="6098707">Op</span><span class="op" id="6098709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098714">if</span>&nbsp;<span class="ident" id="6098717">x</span><span class="op" id="6098718">.</span><span class="ident" id="6098719">Op</span>&nbsp;<span class="op" id="6098722">==</span>&nbsp;<span class="ident" id="6098725">token</span><span class="op" id="6098730">.</span><span class="ident" id="6098731">RANGE</span>&nbsp;<span class="op" id="6098737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6098743">//&nbsp;TODO(gri)&nbsp;Remove&nbsp;this&nbsp;code&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;reached.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098802">p</span><span class="op" id="6098803">.</span><span class="builtinfunc" id="6098804">print</span><span class="op" id="6098809">(</span><span class="ident" id="6098810">blank</span><span class="op" id="6098815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098820">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098825">p</span><span class="op" id="6098826">.</span><span class="ident" id="6098827">expr1</span><span class="op" id="6098832">(</span><span class="ident" id="6098833">x</span><span class="op" id="6098834">.</span><span class="ident" id="6098835">X</span><span class="op" id="6098836">,</span>&nbsp;<span class="ident" id="6098838">prec</span><span class="op" id="6098842">,</span>&nbsp;<span class="ident" id="6098844">depth</span><span class="op" id="6098849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6098853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098857">case</span>&nbsp;<span class="op" id="6098862">*</span><span class="ident" id="6098863">ast</span><span class="op" id="6098866">.</span><span class="ident" id="6098867">BasicLit</span><span class="op" id="6098875">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098879">p</span><span class="op" id="6098880">.</span><span class="builtinfunc" id="6098881">print</span><span class="op" id="6098886">(</span><span class="ident" id="6098887">x</span><span class="op" id="6098888">)</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098892">case</span>&nbsp;<span class="op" id="6098897">*</span><span class="ident" id="6098898">ast</span><span class="op" id="6098901">.</span><span class="ident" id="6098902">FuncLit</span><span class="op" id="6098909">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098913">p</span><span class="op" id="6098914">.</span><span class="ident" id="6098915">expr</span><span class="op" id="6098919">(</span><span class="ident" id="6098920">x</span><span class="op" id="6098921">.</span><span class="ident" id="6098922">Type</span><span class="op" id="6098926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6098930">p</span><span class="op" id="6098931">.</span><span class="ident" id="6098932">adjBlock</span><span class="op" id="6098940">(</span><span class="ident" id="6098941">p</span><span class="op" id="6098942">.</span><span class="ident" id="6098943">distanceFrom</span><span class="op" id="6098955">(</span><span class="ident" id="6098956">x</span><span class="op" id="6098957">.</span><span class="ident" id="6098958">Type</span><span class="op" id="6098962">.</span><span class="ident" id="6098963">Pos</span><span class="op" id="6098966">(</span><span class="op" id="6098967">)</span><span class="op" id="6098968">)</span><span class="op" id="6098969">,</span>&nbsp;<span class="ident" id="6098971">blank</span><span class="op" id="6098976">,</span>&nbsp;<span class="ident" id="6098978">x</span><span class="op" id="6098979">.</span><span class="ident" id="6098980">Body</span><span class="op" id="6098984">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6098988">case</span>&nbsp;<span class="op" id="6098993">*</span><span class="ident" id="6098994">ast</span><span class="op" id="6098997">.</span><span class="ident" id="6098998">ParenExpr</span><span class="op" id="6099007">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099011">if</span>&nbsp;<span class="ident" id="6099014">_</span><span class="op" id="6099015">,</span>&nbsp;<span class="ident" id="6099017">hasParens</span>&nbsp;<span class="op" id="6099027">:=</span>&nbsp;<span class="ident" id="6099030">x</span><span class="op" id="6099031">.</span><span class="ident" id="6099032">X</span><span class="op" id="6099033">.</span><span class="op" id="6099034">(</span><span class="op" id="6099035">*</span><span class="ident" id="6099036">ast</span><span class="op" id="6099039">.</span><span class="ident" id="6099040">ParenExpr</span><span class="op" id="6099049">)</span><span class="op" id="6099050">;</span>&nbsp;<span class="ident" id="6099052">hasParens</span>&nbsp;<span class="op" id="6099062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6099067">//&nbsp;don&#39;t&nbsp;print&nbsp;parentheses&nbsp;around&nbsp;an&nbsp;already&nbsp;parenthesized&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6099140">//&nbsp;TODO(gri)&nbsp;consider&nbsp;making&nbsp;this&nbsp;more&nbsp;general&nbsp;and&nbsp;incorporate&nbsp;precedence&nbsp;levels</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6099224">p</span><span class="op" id="6099225">.</span><span class="ident" id="6099226">expr0</span><span class="op" id="6099231">(</span><span class="ident" id="6099232">x</span><span class="op" id="6099233">.</span><span class="ident" id="6099234">X</span><span class="op" id="6099235">,</span>&nbsp;<span class="ident" id="6099237">depth</span><span class="op" id="6099242">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6099246">}</span>&nbsp;<span class="keyword" id="6099248">else</span>&nbsp;<span class="op" id="6099253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6099258">p</span><span class="op" id="6099259">.</span><span class="builtinfunc" id="6099260">print</span><span class="op" id="6099265">(</span><span class="ident" id="6099266">token</span><span class="op" id="6099271">.</span><span class="ident" id="6099272">LPAREN</span><span class="op" id="6099278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6099283">p</span><span class="op" id="6099284">.</span><span class="ident" id="6099285">expr0</span><span class="op" id="6099290">(</span><span class="ident" id="6099291">x</span><span class="op" id="6099292">.</span><span class="ident" id="6099293">X</span><span class="op" id="6099294">,</span>&nbsp;<span class="ident" id="6099296">reduceDepth</span><span class="op" id="6099307">(</span><span class="ident" id="6099308">depth</span><span class="op" id="6099313">)</span><span class="op" id="6099314">)</span>&nbsp;<span class="comment" id="6099316">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6099358">p</span><span class="op" id="6099359">.</span><span class="builtinfunc" id="6099360">print</span><span class="op" id="6099365">(</span><span class="ident" id="6099366">x</span><span class="op" id="6099367">.</span><span class="ident" id="6099368">Rparen</span><span class="op" id="6099374">,</span>&nbsp;<span class="ident" id="6099376">token</span><span class="op" id="6099381">.</span><span class="ident" id="6099382">RPAREN</span><span class="op" id="6099388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6099392">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099396">case</span>&nbsp;<span class="op" id="6099401">*</span><span class="ident" id="6099402">ast</span><span class="op" id="6099405">.</span><span class="ident" id="6099406">SelectorExpr</span><span class="op" id="6099418">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6099422">p</span><span class="op" id="6099423">.</span><span class="ident" id="6099424">expr1</span><span class="op" id="6099429">(</span><span class="ident" id="6099430">x</span><span class="op" id="6099431">.</span><span class="ident" id="6099432">X</span><span class="op" id="6099433">,</span>&nbsp;<span class="ident" id="6099435">token</span><span class="op" id="6099440">.</span><span class="ident" id="6099441">HighestPrec</span><span class="op" id="6099452">,</span>&nbsp;<span class="ident" id="6099454">depth</span><span class="op" id="6099459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6099463">p</span><span class="op" id="6099464">.</span><span class="builtinfunc" id="6099465">print</span><span class="op" id="6099470">(</span><span class="ident" id="6099471">token</span><span class="op" id="6099476">.</span><span class="ident" id="6099477">PERIOD</span><span class="op" id="6099483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099487">if</span>&nbsp;<span class="ident" id="6099490">line</span>&nbsp;<span class="op" id="6099495">:=</span>&nbsp;<span class="ident" id="6099498">p</span><span class="op" id="6099499">.</span><span class="ident" id="6099500">lineFor</span><span class="op" id="6099507">(</span><span class="ident" id="6099508">x</span><span class="op" id="6099509">.</span><span class="ident" id="6099510">Sel</span><span class="op" id="6099513">.</span><span class="ident" id="6099514">Pos</span><span class="op" id="6099517">(</span><span class="op" id="6099518">)</span><span class="op" id="6099519">)</span><span class="op" id="6099520">;</span>&nbsp;<span class="ident" id="6099522">p</span><span class="op" id="6099523">.</span><span class="ident" id="6099524">pos</span><span class="op" id="6099527">.</span><span class="ident" id="6099528">IsValid</span><span class="op" id="6099535">(</span><span class="op" id="6099536">)</span>&nbsp;<span class="op" id="6099538">&amp;&amp;</span>&nbsp;<span class="ident" id="6099541">p</span><span class="op" id="6099542">.</span><span class="ident" id="6099543">pos</span><span class="op" id="6099546">.</span><span class="ident" id="6099547">Line</span>&nbsp;<span class="op" id="6099552">&lt;</span>&nbsp;<span class="ident" id="6099554">line</span>&nbsp;<span class="op" id="6099559">{</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6099564">p</span><span class="op" id="6099565">.</span><span class="builtinfunc" id="6099566">print</span><span class="op" id="6099571">(</span><span class="ident" id="6099572">indent</span><span class="op" id="6099578">,</span>&nbsp;<span class="ident" id="6099580">newline</span><span class="op" id="6099587">,</span>&nbsp;<span class="ident" id="6099589">x</span><span class="op" id="6099590">.</span><span class="ident" id="6099591">Sel</span><span class="op" id="6099594">.</span><span class="ident" id="6099595">Pos</span><span class="op" id="6099598">(</span><span class="op" id="6099599">)</span><span class="op" id="6099600">,</span>&nbsp;<span class="ident" id="6099602">x</span><span class="op" id="6099603">.</span><span class="ident" id="6099604">Sel</span><span class="op" id="6099607">,</span>&nbsp;<span class="ident" id="6099609">unindent</span><span class="op" id="6099617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6099621">}</span>&nbsp;<span class="keyword" id="6099623">else</span>&nbsp;<span class="op" id="6099628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6099633">p</span><span class="op" id="6099634">.</span><span class="builtinfunc" id="6099635">print</span><span class="op" id="6099640">(</span><span class="ident" id="6099641">x</span><span class="op" id="6099642">.</span><span class="ident" id="6099643">Sel</span><span class="op" id="6099646">.</span><span class="ident" id="6099647">Pos</span><span class="op" id="6099650">(</span><span class="op" id="6099651">)</span><span class="op" id="6099652">,</span>&nbsp;<span class="ident" id="6099654">x</span><span class="op" id="6099655">.</span><span class="ident" id="6099656">Sel</span><span class="op" id="6099659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6099663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099667">case</span>&nbsp;<span class="op" id="6099672">*</span><span class="ident" id="6099673">ast</span><span class="op" id="6099676">.</span><span class="ident" id="6099677">TypeAssertExpr</span><span class="op" id="6099691">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6099695">p</span><span class="op" id="6099696">.</span><span class="ident" id="6099697">expr1</span><span class="op" id="6099702">(</span><span class="ident" id="6099703">x</span><span class="op" id="6099704">.</span><span class="ident" id="6099705">X</span><span class="op" id="6099706">,</span>&nbsp;<span class="ident" id="6099708">token</span><span class="op" id="6099713">.</span><span class="ident" id="6099714">HighestPrec</span><span class="op" id="6099725">,</span>&nbsp;<span class="ident" id="6099727">depth</span><span class="op" id="6099732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6099736">p</span><span class="op" id="6099737">.</span><span class="builtinfunc" id="6099738">print</span><span class="op" id="6099743">(</span><span class="ident" id="6099744">token</span><span class="op" id="6099749">.</span><span class="ident" id="6099750">PERIOD</span><span class="op" id="6099756">,</span>&nbsp;<span class="ident" id="6099758">x</span><span class="op" id="6099759">.</span><span class="ident" id="6099760">Lparen</span><span class="op" id="6099766">,</span>&nbsp;<span class="ident" id="6099768">token</span><span class="op" id="6099773">.</span><span class="ident" id="6099774">LPAREN</span><span class="op" id="6099780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099784">if</span>&nbsp;<span class="ident" id="6099787">x</span><span class="op" id="6099788">.</span><span class="ident" id="6099789">Type</span>&nbsp;<span class="op" id="6099794">!=</span>&nbsp;<span class="ident" id="6099797">nil</span>&nbsp;<span class="op" id="6099801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6099806">p</span><span class="op" id="6099807">.</span><span class="ident" id="6099808">expr</span><span class="op" id="6099812">(</span><span class="ident" id="6099813">x</span><span class="op" id="6099814">.</span><span class="ident" id="6099815">Type</span><span class="op" id="6099819">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6099823">}</span>&nbsp;<span class="keyword" id="6099825">else</span>&nbsp;<span class="op" id="6099830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6099835">p</span><span class="op" id="6099836">.</span><span class="builtinfunc" id="6099837">print</span><span class="op" id="6099842">(</span><span class="ident" id="6099843">token</span><span class="op" id="6099848">.</span><span class="ident" id="6099849">TYPE</span><span class="op" id="6099853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6099857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6099861">p</span><span class="op" id="6099862">.</span><span class="builtinfunc" id="6099863">print</span><span class="op" id="6099868">(</span><span class="ident" id="6099869">x</span><span class="op" id="6099870">.</span><span class="ident" id="6099871">Rparen</span><span class="op" id="6099877">,</span>&nbsp;<span class="ident" id="6099879">token</span><span class="op" id="6099884">.</span><span class="ident" id="6099885">RPAREN</span><span class="op" id="6099891">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6099895">case</span>&nbsp;<span class="op" id="6099900">*</span><span class="ident" id="6099901">ast</span><span class="op" id="6099904">.</span><span class="ident" id="6099905">IndexExpr</span><span class="op" id="6099914">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6099918">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6099994">p</span><span class="op" id="6099995">.</span><span class="ident" id="6099996">expr1</span><span class="op" id="6100001">(</span><span class="ident" id="6100002">x</span><span class="op" id="6100003">.</span><span class="ident" id="6100004">X</span><span class="op" id="6100005">,</span>&nbsp;<span class="ident" id="6100007">token</span><span class="op" id="6100012">.</span><span class="ident" id="6100013">HighestPrec</span><span class="op" id="6100024">,</span>&nbsp;<span class="num" id="6100026">1</span><span class="op" id="6100027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6100031">p</span><span class="op" id="6100032">.</span><span class="builtinfunc" id="6100033">print</span><span class="op" id="6100038">(</span><span class="ident" id="6100039">x</span><span class="op" id="6100040">.</span><span class="ident" id="6100041">Lbrack</span><span class="op" id="6100047">,</span>&nbsp;<span class="ident" id="6100049">token</span><span class="op" id="6100054">.</span><span class="ident" id="6100055">LBRACK</span><span class="op" id="6100061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6100065">p</span><span class="op" id="6100066">.</span><span class="ident" id="6100067">expr0</span><span class="op" id="6100072">(</span><span class="ident" id="6100073">x</span><span class="op" id="6100074">.</span><span class="ident" id="6100075">Index</span><span class="op" id="6100080">,</span>&nbsp;<span class="ident" id="6100082">depth</span><span class="op" id="6100087">+</span><span class="num" id="6100088">1</span><span class="op" id="6100089">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6100093">p</span><span class="op" id="6100094">.</span><span class="builtinfunc" id="6100095">print</span><span class="op" id="6100100">(</span><span class="ident" id="6100101">x</span><span class="op" id="6100102">.</span><span class="ident" id="6100103">Rbrack</span><span class="op" id="6100109">,</span>&nbsp;<span class="ident" id="6100111">token</span><span class="op" id="6100116">.</span><span class="ident" id="6100117">RBRACK</span><span class="op" id="6100123">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6100127">case</span>&nbsp;<span class="op" id="6100132">*</span><span class="ident" id="6100133">ast</span><span class="op" id="6100136">.</span><span class="ident" id="6100137">SliceExpr</span><span class="op" id="6100146">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6100150">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6100226">p</span><span class="op" id="6100227">.</span><span class="ident" id="6100228">expr1</span><span class="op" id="6100233">(</span><span class="ident" id="6100234">x</span><span class="op" id="6100235">.</span><span class="ident" id="6100236">X</span><span class="op" id="6100237">,</span>&nbsp;<span class="ident" id="6100239">token</span><span class="op" id="6100244">.</span><span class="ident" id="6100245">HighestPrec</span><span class="op" id="6100256">,</span>&nbsp;<span class="num" id="6100258">1</span><span class="op" id="6100259">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6100263">p</span><span class="op" id="6100264">.</span><span class="builtinfunc" id="6100265">print</span><span class="op" id="6100270">(</span><span class="ident" id="6100271">x</span><span class="op" id="6100272">.</span><span class="ident" id="6100273">Lbrack</span><span class="op" id="6100279">,</span>&nbsp;<span class="ident" id="6100281">token</span><span class="op" id="6100286">.</span><span class="ident" id="6100287">LBRACK</span><span class="op" id="6100293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6100297">indices</span>&nbsp;<span class="op" id="6100305">:=</span>&nbsp;<span class="op" id="6100308">[</span><span class="op" id="6100309">]</span><span class="ident" id="6100310">ast</span><span class="op" id="6100313">.</span><span class="ident" id="6100314">Expr</span><span class="op" id="6100318">{</span><span class="ident" id="6100319">x</span><span class="op" id="6100320">.</span><span class="ident" id="6100321">Low</span><span class="op" id="6100324">,</span>&nbsp;<span class="ident" id="6100326">x</span><span class="op" id="6100327">.</span><span class="ident" id="6100328">High</span><span class="op" id="6100332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6100336">if</span>&nbsp;<span class="ident" id="6100339">x</span><span class="op" id="6100340">.</span><span class="ident" id="6100341">Max</span>&nbsp;<span class="op" id="6100345">!=</span>&nbsp;<span class="ident" id="6100348">nil</span>&nbsp;<span class="op" id="6100352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6100357">indices</span>&nbsp;<span class="op" id="6100365">=</span>&nbsp;<span class="builtinfunc" id="6100367">append</span><span class="op" id="6100373">(</span><span class="ident" id="6100374">indices</span><span class="op" id="6100381">,</span>&nbsp;<span class="ident" id="6100383">x</span><span class="op" id="6100384">.</span><span class="ident" id="6100385">Max</span><span class="op" id="6100388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6100392">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6100396">for</span>&nbsp;<span class="ident" id="6100400">i</span><span class="op" id="6100401">,</span>&nbsp;<span class="ident" id="6100403">y</span>&nbsp;<span class="op" id="6100405">:=</span>&nbsp;<span class="keyword" id="6100408">range</span>&nbsp;<span class="ident" id="6100414">indices</span>&nbsp;<span class="op" id="6100422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6100427">if</span>&nbsp;<span class="ident" id="6100430">i</span>&nbsp;<span class="op" id="6100432">&gt;</span>&nbsp;<span class="num" id="6100434">0</span>&nbsp;<span class="op" id="6100436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6100442">//&nbsp;blanks&nbsp;around&nbsp;&#34;:&#34;&nbsp;if&nbsp;both&nbsp;sides&nbsp;exist&nbsp;and&nbsp;either&nbsp;side&nbsp;is&nbsp;a&nbsp;binary&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6100526">//&nbsp;TODO(gri)&nbsp;once&nbsp;we&nbsp;have&nbsp;committed&nbsp;a&nbsp;variant&nbsp;of&nbsp;a[i:j:k]&nbsp;we&nbsp;may&nbsp;want&nbsp;to&nbsp;fine-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6100609">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tune&nbsp;the&nbsp;formatting&nbsp;here</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6100651">x</span>&nbsp;<span class="op" id="6100653">:=</span>&nbsp;<span class="ident" id="6100656">indices</span><span class="op" id="6100663">[</span><span class="ident" id="6100664">i</span><span class="op" id="6100665">-</span><span class="num" id="6100666">1</span><span class="op" id="6100667">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6100673">if</span>&nbsp;<span class="ident" id="6100676">depth</span>&nbsp;<span class="op" id="6100682">&lt;=</span>&nbsp;<span class="num" id="6100685">1</span>&nbsp;<span class="op" id="6100687">&amp;&amp;</span>&nbsp;<span class="ident" id="6100690">x</span>&nbsp;<span class="op" id="6100692">!=</span>&nbsp;<span class="ident" id="6100695">nil</span>&nbsp;<span class="op" id="6100699">&amp;&amp;</span>&nbsp;<span class="ident" id="6100702">y</span>&nbsp;<span class="op" id="6100704">!=</span>&nbsp;<span class="ident" id="6100707">nil</span>&nbsp;<span class="op" id="6100711">&amp;&amp;</span>&nbsp;<span class="op" id="6100714">(</span><span class="ident" id="6100715">isBinary</span><span class="op" id="6100723">(</span><span class="ident" id="6100724">x</span><span class="op" id="6100725">)</span>&nbsp;<span class="op" id="6100727">||</span>&nbsp;<span class="ident" id="6100730">isBinary</span><span class="op" id="6100738">(</span><span class="ident" id="6100739">y</span><span class="op" id="6100740">)</span><span class="op" id="6100741">)</span>&nbsp;<span class="op" id="6100743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6100750">p</span><span class="op" id="6100751">.</span><span class="builtinfunc" id="6100752">print</span><span class="op" id="6100757">(</span><span class="ident" id="6100758">blank</span><span class="op" id="6100763">,</span>&nbsp;<span class="ident" id="6100765">token</span><span class="op" id="6100770">.</span><span class="ident" id="6100771">COLON</span><span class="op" id="6100776">,</span>&nbsp;<span class="ident" id="6100778">blank</span><span class="op" id="6100783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6100789">}</span>&nbsp;<span class="keyword" id="6100791">else</span>&nbsp;<span class="op" id="6100796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6100803">p</span><span class="op" id="6100804">.</span><span class="builtinfunc" id="6100805">print</span><span class="op" id="6100810">(</span><span class="ident" id="6100811">token</span><span class="op" id="6100816">.</span><span class="ident" id="6100817">COLON</span><span class="op" id="6100822">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6100828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6100833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6100838">if</span>&nbsp;<span class="ident" id="6100841">y</span>&nbsp;<span class="op" id="6100843">!=</span>&nbsp;<span class="ident" id="6100846">nil</span>&nbsp;<span class="op" id="6100850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6100856">p</span><span class="op" id="6100857">.</span><span class="ident" id="6100858">expr0</span><span class="op" id="6100863">(</span><span class="ident" id="6100864">y</span><span class="op" id="6100865">,</span>&nbsp;<span class="ident" id="6100867">depth</span><span class="op" id="6100872">+</span><span class="num" id="6100873">1</span><span class="op" id="6100874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6100879">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6100883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6100887">p</span><span class="op" id="6100888">.</span><span class="builtinfunc" id="6100889">print</span><span class="op" id="6100894">(</span><span class="ident" id="6100895">x</span><span class="op" id="6100896">.</span><span class="ident" id="6100897">Rbrack</span><span class="op" id="6100903">,</span>&nbsp;<span class="ident" id="6100905">token</span><span class="op" id="6100910">.</span><span class="ident" id="6100911">RBRACK</span><span class="op" id="6100917">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6100921">case</span>&nbsp;<span class="op" id="6100926">*</span><span class="ident" id="6100927">ast</span><span class="op" id="6100930">.</span><span class="ident" id="6100931">CallExpr</span><span class="op" id="6100939">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6100943">if</span>&nbsp;<span class="builtinfunc" id="6100946">len</span><span class="op" id="6100949">(</span><span class="ident" id="6100950">x</span><span class="op" id="6100951">.</span><span class="ident" id="6100952">Args</span><span class="op" id="6100956">)</span>&nbsp;<span class="op" id="6100958">&gt;</span>&nbsp;<span class="num" id="6100960">1</span>&nbsp;<span class="op" id="6100962">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6100967">depth</span><span class="op" id="6100972">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6100977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6100981">if</span>&nbsp;<span class="ident" id="6100984">_</span><span class="op" id="6100985">,</span>&nbsp;<span class="ident" id="6100987">ok</span>&nbsp;<span class="op" id="6100990">:=</span>&nbsp;<span class="ident" id="6100993">x</span><span class="op" id="6100994">.</span><span class="ident" id="6100995">Fun</span><span class="op" id="6100998">.</span><span class="op" id="6100999">(</span><span class="op" id="6101000">*</span><span class="ident" id="6101001">ast</span><span class="op" id="6101004">.</span><span class="ident" id="6101005">FuncType</span><span class="op" id="6101013">)</span><span class="op" id="6101014">;</span>&nbsp;<span class="ident" id="6101016">ok</span>&nbsp;<span class="op" id="6101019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6101024">//&nbsp;conversions&nbsp;to&nbsp;literal&nbsp;function&nbsp;types&nbsp;require&nbsp;parentheses&nbsp;around&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6101104">p</span><span class="op" id="6101105">.</span><span class="builtinfunc" id="6101106">print</span><span class="op" id="6101111">(</span><span class="ident" id="6101112">token</span><span class="op" id="6101117">.</span><span class="ident" id="6101118">LPAREN</span><span class="op" id="6101124">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6101129">p</span><span class="op" id="6101130">.</span><span class="ident" id="6101131">expr1</span><span class="op" id="6101136">(</span><span class="ident" id="6101137">x</span><span class="op" id="6101138">.</span><span class="ident" id="6101139">Fun</span><span class="op" id="6101142">,</span>&nbsp;<span class="ident" id="6101144">token</span><span class="op" id="6101149">.</span><span class="ident" id="6101150">HighestPrec</span><span class="op" id="6101161">,</span>&nbsp;<span class="ident" id="6101163">depth</span><span class="op" id="6101168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6101173">p</span><span class="op" id="6101174">.</span><span class="builtinfunc" id="6101175">print</span><span class="op" id="6101180">(</span><span class="ident" id="6101181">token</span><span class="op" id="6101186">.</span><span class="ident" id="6101187">RPAREN</span><span class="op" id="6101193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6101197">}</span>&nbsp;<span class="keyword" id="6101199">else</span>&nbsp;<span class="op" id="6101204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6101209">p</span><span class="op" id="6101210">.</span><span class="ident" id="6101211">expr1</span><span class="op" id="6101216">(</span><span class="ident" id="6101217">x</span><span class="op" id="6101218">.</span><span class="ident" id="6101219">Fun</span><span class="op" id="6101222">,</span>&nbsp;<span class="ident" id="6101224">token</span><span class="op" id="6101229">.</span><span class="ident" id="6101230">HighestPrec</span><span class="op" id="6101241">,</span>&nbsp;<span class="ident" id="6101243">depth</span><span class="op" id="6101248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6101252">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6101256">p</span><span class="op" id="6101257">.</span><span class="builtinfunc" id="6101258">print</span><span class="op" id="6101263">(</span><span class="ident" id="6101264">x</span><span class="op" id="6101265">.</span><span class="ident" id="6101266">Lparen</span><span class="op" id="6101272">,</span>&nbsp;<span class="ident" id="6101274">token</span><span class="op" id="6101279">.</span><span class="ident" id="6101280">LPAREN</span><span class="op" id="6101286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6101290">if</span>&nbsp;<span class="ident" id="6101293">x</span><span class="op" id="6101294">.</span><span class="ident" id="6101295">Ellipsis</span><span class="op" id="6101303">.</span><span class="ident" id="6101304">IsValid</span><span class="op" id="6101311">(</span><span class="op" id="6101312">)</span>&nbsp;<span class="op" id="6101314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6101319">p</span><span class="op" id="6101320">.</span><span class="ident" id="6101321">exprList</span><span class="op" id="6101329">(</span><span class="ident" id="6101330">x</span><span class="op" id="6101331">.</span><span class="ident" id="6101332">Lparen</span><span class="op" id="6101338">,</span>&nbsp;<span class="ident" id="6101340">x</span><span class="op" id="6101341">.</span><span class="ident" id="6101342">Args</span><span class="op" id="6101346">,</span>&nbsp;<span class="ident" id="6101348">depth</span><span class="op" id="6101353">,</span>&nbsp;<span class="num" id="6101355">0</span><span class="op" id="6101356">,</span>&nbsp;<span class="ident" id="6101358">x</span><span class="op" id="6101359">.</span><span class="ident" id="6101360">Ellipsis</span><span class="op" id="6101368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6101373">p</span><span class="op" id="6101374">.</span><span class="builtinfunc" id="6101375">print</span><span class="op" id="6101380">(</span><span class="ident" id="6101381">x</span><span class="op" id="6101382">.</span><span class="ident" id="6101383">Ellipsis</span><span class="op" id="6101391">,</span>&nbsp;<span class="ident" id="6101393">token</span><span class="op" id="6101398">.</span><span class="ident" id="6101399">ELLIPSIS</span><span class="op" id="6101407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6101412">if</span>&nbsp;<span class="ident" id="6101415">x</span><span class="op" id="6101416">.</span><span class="ident" id="6101417">Rparen</span><span class="op" id="6101423">.</span><span class="ident" id="6101424">IsValid</span><span class="op" id="6101431">(</span><span class="op" id="6101432">)</span>&nbsp;<span class="op" id="6101434">&amp;&amp;</span>&nbsp;<span class="ident" id="6101437">p</span><span class="op" id="6101438">.</span><span class="ident" id="6101439">lineFor</span><span class="op" id="6101446">(</span><span class="ident" id="6101447">x</span><span class="op" id="6101448">.</span><span class="ident" id="6101449">Ellipsis</span><span class="op" id="6101457">)</span>&nbsp;<span class="op" id="6101459">&lt;</span>&nbsp;<span class="ident" id="6101461">p</span><span class="op" id="6101462">.</span><span class="ident" id="6101463">lineFor</span><span class="op" id="6101470">(</span><span class="ident" id="6101471">x</span><span class="op" id="6101472">.</span><span class="ident" id="6101473">Rparen</span><span class="op" id="6101479">)</span>&nbsp;<span class="op" id="6101481">{</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6101487">p</span><span class="op" id="6101488">.</span><span class="builtinfunc" id="6101489">print</span><span class="op" id="6101494">(</span><span class="ident" id="6101495">token</span><span class="op" id="6101500">.</span><span class="ident" id="6101501">COMMA</span><span class="op" id="6101506">,</span>&nbsp;<span class="ident" id="6101508">formfeed</span><span class="op" id="6101516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6101521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6101525">}</span>&nbsp;<span class="keyword" id="6101527">else</span>&nbsp;<span class="op" id="6101532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6101537">p</span><span class="op" id="6101538">.</span><span class="ident" id="6101539">exprList</span><span class="op" id="6101547">(</span><span class="ident" id="6101548">x</span><span class="op" id="6101549">.</span><span class="ident" id="6101550">Lparen</span><span class="op" id="6101556">,</span>&nbsp;<span class="ident" id="6101558">x</span><span class="op" id="6101559">.</span><span class="ident" id="6101560">Args</span><span class="op" id="6101564">,</span>&nbsp;<span class="ident" id="6101566">depth</span><span class="op" id="6101571">,</span>&nbsp;<span class="ident" id="6101573">commaTerm</span><span class="op" id="6101582">,</span>&nbsp;<span class="ident" id="6101584">x</span><span class="op" id="6101585">.</span><span class="ident" id="6101586">Rparen</span><span class="op" id="6101592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6101596">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6101600">p</span><span class="op" id="6101601">.</span><span class="builtinfunc" id="6101602">print</span><span class="op" id="6101607">(</span><span class="ident" id="6101608">x</span><span class="op" id="6101609">.</span><span class="ident" id="6101610">Rparen</span><span class="op" id="6101616">,</span>&nbsp;<span class="ident" id="6101618">token</span><span class="op" id="6101623">.</span><span class="ident" id="6101624">RPAREN</span><span class="op" id="6101630">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6101634">case</span>&nbsp;<span class="op" id="6101639">*</span><span class="ident" id="6101640">ast</span><span class="op" id="6101643">.</span><span class="ident" id="6101644">CompositeLit</span><span class="op" id="6101656">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6101660">//&nbsp;composite&nbsp;literal&nbsp;elements&nbsp;that&nbsp;are&nbsp;composite&nbsp;literals&nbsp;themselves&nbsp;may&nbsp;have&nbsp;the&nbsp;type&nbsp;omitted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6101757">if</span>&nbsp;<span class="ident" id="6101760">x</span><span class="op" id="6101761">.</span><span class="ident" id="6101762">Type</span>&nbsp;<span class="op" id="6101767">!=</span>&nbsp;<span class="ident" id="6101770">nil</span>&nbsp;<span class="op" id="6101774">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6101779">p</span><span class="op" id="6101780">.</span><span class="ident" id="6101781">expr1</span><span class="op" id="6101786">(</span><span class="ident" id="6101787">x</span><span class="op" id="6101788">.</span><span class="ident" id="6101789">Type</span><span class="op" id="6101793">,</span>&nbsp;<span class="ident" id="6101795">token</span><span class="op" id="6101800">.</span><span class="ident" id="6101801">HighestPrec</span><span class="op" id="6101812">,</span>&nbsp;<span class="ident" id="6101814">depth</span><span class="op" id="6101819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6101823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6101827">p</span><span class="op" id="6101828">.</span><span class="builtinfunc" id="6101829">print</span><span class="op" id="6101834">(</span><span class="ident" id="6101835">x</span><span class="op" id="6101836">.</span><span class="ident" id="6101837">Lbrace</span><span class="op" id="6101843">,</span>&nbsp;<span class="ident" id="6101845">token</span><span class="op" id="6101850">.</span><span class="ident" id="6101851">LBRACE</span><span class="op" id="6101857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6101861">p</span><span class="op" id="6101862">.</span><span class="ident" id="6101863">exprList</span><span class="op" id="6101871">(</span><span class="ident" id="6101872">x</span><span class="op" id="6101873">.</span><span class="ident" id="6101874">Lbrace</span><span class="op" id="6101880">,</span>&nbsp;<span class="ident" id="6101882">x</span><span class="op" id="6101883">.</span><span class="ident" id="6101884">Elts</span><span class="op" id="6101888">,</span>&nbsp;<span class="num" id="6101890">1</span><span class="op" id="6101891">,</span>&nbsp;<span class="ident" id="6101893">commaTerm</span><span class="op" id="6101902">,</span>&nbsp;<span class="ident" id="6101904">x</span><span class="op" id="6101905">.</span><span class="ident" id="6101906">Rbrace</span><span class="op" id="6101912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6101916">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;line&nbsp;break&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6101981">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;as&nbsp;it&nbsp;might&nbsp;break&nbsp;the&nbsp;code&nbsp;if&nbsp;there</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6102045">//&nbsp;is&nbsp;no&nbsp;trailing&nbsp;&#39;,&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102069">mode</span>&nbsp;<span class="op" id="6102074">:=</span>&nbsp;<span class="ident" id="6102077">noExtraLinebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6102096">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;blank&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6102156">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;unless&nbsp;the&nbsp;literal&nbsp;is&nbsp;empty</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6102212">if</span>&nbsp;<span class="builtinfunc" id="6102215">len</span><span class="op" id="6102218">(</span><span class="ident" id="6102219">x</span><span class="op" id="6102220">.</span><span class="ident" id="6102221">Elts</span><span class="op" id="6102225">)</span>&nbsp;<span class="op" id="6102227">&gt;</span>&nbsp;<span class="num" id="6102229">0</span>&nbsp;<span class="op" id="6102231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102236">mode</span>&nbsp;<span class="op" id="6102241">|=</span>&nbsp;<span class="ident" id="6102244">noExtraBlank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6102259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102263">p</span><span class="op" id="6102264">.</span><span class="builtinfunc" id="6102265">print</span><span class="op" id="6102270">(</span><span class="ident" id="6102271">mode</span><span class="op" id="6102275">,</span>&nbsp;<span class="ident" id="6102277">x</span><span class="op" id="6102278">.</span><span class="ident" id="6102279">Rbrace</span><span class="op" id="6102285">,</span>&nbsp;<span class="ident" id="6102287">token</span><span class="op" id="6102292">.</span><span class="ident" id="6102293">RBRACE</span><span class="op" id="6102299">,</span>&nbsp;<span class="ident" id="6102301">mode</span><span class="op" id="6102305">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6102309">case</span>&nbsp;<span class="op" id="6102314">*</span><span class="ident" id="6102315">ast</span><span class="op" id="6102318">.</span><span class="ident" id="6102319">Ellipsis</span><span class="op" id="6102327">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102331">p</span><span class="op" id="6102332">.</span><span class="builtinfunc" id="6102333">print</span><span class="op" id="6102338">(</span><span class="ident" id="6102339">token</span><span class="op" id="6102344">.</span><span class="ident" id="6102345">ELLIPSIS</span><span class="op" id="6102353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6102357">if</span>&nbsp;<span class="ident" id="6102360">x</span><span class="op" id="6102361">.</span><span class="ident" id="6102362">Elt</span>&nbsp;<span class="op" id="6102366">!=</span>&nbsp;<span class="ident" id="6102369">nil</span>&nbsp;<span class="op" id="6102373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102378">p</span><span class="op" id="6102379">.</span><span class="ident" id="6102380">expr</span><span class="op" id="6102384">(</span><span class="ident" id="6102385">x</span><span class="op" id="6102386">.</span><span class="ident" id="6102387">Elt</span><span class="op" id="6102390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6102394">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6102398">case</span>&nbsp;<span class="op" id="6102403">*</span><span class="ident" id="6102404">ast</span><span class="op" id="6102407">.</span><span class="ident" id="6102408">ArrayType</span><span class="op" id="6102417">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102421">p</span><span class="op" id="6102422">.</span><span class="builtinfunc" id="6102423">print</span><span class="op" id="6102428">(</span><span class="ident" id="6102429">token</span><span class="op" id="6102434">.</span><span class="ident" id="6102435">LBRACK</span><span class="op" id="6102441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6102445">if</span>&nbsp;<span class="ident" id="6102448">x</span><span class="op" id="6102449">.</span><span class="ident" id="6102450">Len</span>&nbsp;<span class="op" id="6102454">!=</span>&nbsp;<span class="ident" id="6102457">nil</span>&nbsp;<span class="op" id="6102461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102466">p</span><span class="op" id="6102467">.</span><span class="ident" id="6102468">expr</span><span class="op" id="6102472">(</span><span class="ident" id="6102473">x</span><span class="op" id="6102474">.</span><span class="ident" id="6102475">Len</span><span class="op" id="6102478">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6102482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102486">p</span><span class="op" id="6102487">.</span><span class="builtinfunc" id="6102488">print</span><span class="op" id="6102493">(</span><span class="ident" id="6102494">token</span><span class="op" id="6102499">.</span><span class="ident" id="6102500">RBRACK</span><span class="op" id="6102506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102510">p</span><span class="op" id="6102511">.</span><span class="ident" id="6102512">expr</span><span class="op" id="6102516">(</span><span class="ident" id="6102517">x</span><span class="op" id="6102518">.</span><span class="ident" id="6102519">Elt</span><span class="op" id="6102522">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6102526">case</span>&nbsp;<span class="op" id="6102531">*</span><span class="ident" id="6102532">ast</span><span class="op" id="6102535">.</span><span class="ident" id="6102536">StructType</span><span class="op" id="6102546">:</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102550">p</span><span class="op" id="6102551">.</span><span class="builtinfunc" id="6102552">print</span><span class="op" id="6102557">(</span><span class="ident" id="6102558">token</span><span class="op" id="6102563">.</span><span class="ident" id="6102564">STRUCT</span><span class="op" id="6102570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102574">p</span><span class="op" id="6102575">.</span><span class="ident" id="6102576">fieldList</span><span class="op" id="6102585">(</span><span class="ident" id="6102586">x</span><span class="op" id="6102587">.</span><span class="ident" id="6102588">Fields</span><span class="op" id="6102594">,</span>&nbsp;<span class="builtintype" id="6102596">true</span><span class="op" id="6102600">,</span>&nbsp;<span class="ident" id="6102602">x</span><span class="op" id="6102603">.</span><span class="ident" id="6102604">Incomplete</span><span class="op" id="6102614">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6102618">case</span>&nbsp;<span class="op" id="6102623">*</span><span class="ident" id="6102624">ast</span><span class="op" id="6102627">.</span><span class="ident" id="6102628">FuncType</span><span class="op" id="6102636">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102640">p</span><span class="op" id="6102641">.</span><span class="builtinfunc" id="6102642">print</span><span class="op" id="6102647">(</span><span class="ident" id="6102648">token</span><span class="op" id="6102653">.</span><span class="ident" id="6102654">FUNC</span><span class="op" id="6102658">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102662">p</span><span class="op" id="6102663">.</span><span class="ident" id="6102664">signature</span><span class="op" id="6102673">(</span><span class="ident" id="6102674">x</span><span class="op" id="6102675">.</span><span class="ident" id="6102676">Params</span><span class="op" id="6102682">,</span>&nbsp;<span class="ident" id="6102684">x</span><span class="op" id="6102685">.</span><span class="ident" id="6102686">Results</span><span class="op" id="6102693">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6102697">case</span>&nbsp;<span class="op" id="6102702">*</span><span class="ident" id="6102703">ast</span><span class="op" id="6102706">.</span><span class="ident" id="6102707">InterfaceType</span><span class="op" id="6102720">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102724">p</span><span class="op" id="6102725">.</span><span class="builtinfunc" id="6102726">print</span><span class="op" id="6102731">(</span><span class="ident" id="6102732">token</span><span class="op" id="6102737">.</span><span class="ident" id="6102738">INTERFACE</span><span class="op" id="6102747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102751">p</span><span class="op" id="6102752">.</span><span class="ident" id="6102753">fieldList</span><span class="op" id="6102762">(</span><span class="ident" id="6102763">x</span><span class="op" id="6102764">.</span><span class="ident" id="6102765">Methods</span><span class="op" id="6102772">,</span>&nbsp;<span class="builtintype" id="6102774">false</span><span class="op" id="6102779">,</span>&nbsp;<span class="ident" id="6102781">x</span><span class="op" id="6102782">.</span><span class="ident" id="6102783">Incomplete</span><span class="op" id="6102793">)</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6102797">case</span>&nbsp;<span class="op" id="6102802">*</span><span class="ident" id="6102803">ast</span><span class="op" id="6102806">.</span><span class="ident" id="6102807">MapType</span><span class="op" id="6102814">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102818">p</span><span class="op" id="6102819">.</span><span class="builtinfunc" id="6102820">print</span><span class="op" id="6102825">(</span><span class="ident" id="6102826">token</span><span class="op" id="6102831">.</span><span class="ident" id="6102832">MAP</span><span class="op" id="6102835">,</span>&nbsp;<span class="ident" id="6102837">token</span><span class="op" id="6102842">.</span><span class="ident" id="6102843">LBRACK</span><span class="op" id="6102849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102853">p</span><span class="op" id="6102854">.</span><span class="ident" id="6102855">expr</span><span class="op" id="6102859">(</span><span class="ident" id="6102860">x</span><span class="op" id="6102861">.</span><span class="ident" id="6102862">Key</span><span class="op" id="6102865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102869">p</span><span class="op" id="6102870">.</span><span class="builtinfunc" id="6102871">print</span><span class="op" id="6102876">(</span><span class="ident" id="6102877">token</span><span class="op" id="6102882">.</span><span class="ident" id="6102883">RBRACK</span><span class="op" id="6102889">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102893">p</span><span class="op" id="6102894">.</span><span class="ident" id="6102895">expr</span><span class="op" id="6102899">(</span><span class="ident" id="6102900">x</span><span class="op" id="6102901">.</span><span class="ident" id="6102902">Value</span><span class="op" id="6102907">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6102911">case</span>&nbsp;<span class="op" id="6102916">*</span><span class="ident" id="6102917">ast</span><span class="op" id="6102920">.</span><span class="ident" id="6102921">ChanType</span><span class="op" id="6102929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6102933">switch</span>&nbsp;<span class="ident" id="6102940">x</span><span class="op" id="6102941">.</span><span class="ident" id="6102942">Dir</span>&nbsp;<span class="op" id="6102946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6102950">case</span>&nbsp;<span class="ident" id="6102955">ast</span><span class="op" id="6102958">.</span><span class="ident" id="6102959">SEND</span>&nbsp;<span class="op" id="6102964">|</span>&nbsp;<span class="ident" id="6102966">ast</span><span class="op" id="6102969">.</span><span class="ident" id="6102970">RECV</span><span class="op" id="6102974">:</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102979">p</span><span class="op" id="6102980">.</span><span class="builtinfunc" id="6102981">print</span><span class="op" id="6102986">(</span><span class="ident" id="6102987">token</span><span class="op" id="6102992">.</span><span class="ident" id="6102993">CHAN</span><span class="op" id="6102997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6103001">case</span>&nbsp;<span class="ident" id="6103006">ast</span><span class="op" id="6103009">.</span><span class="ident" id="6103010">RECV</span><span class="op" id="6103014">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103019">p</span><span class="op" id="6103020">.</span><span class="builtinfunc" id="6103021">print</span><span class="op" id="6103026">(</span><span class="ident" id="6103027">token</span><span class="op" id="6103032">.</span><span class="ident" id="6103033">ARROW</span><span class="op" id="6103038">,</span>&nbsp;<span class="ident" id="6103040">token</span><span class="op" id="6103045">.</span><span class="ident" id="6103046">CHAN</span><span class="op" id="6103050">)</span>&nbsp;<span class="comment" id="6103052">//&nbsp;x.Arrow&nbsp;and&nbsp;x.Pos()&nbsp;are&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6103090">case</span>&nbsp;<span class="ident" id="6103095">ast</span><span class="op" id="6103098">.</span><span class="ident" id="6103099">SEND</span><span class="op" id="6103103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103108">p</span><span class="op" id="6103109">.</span><span class="builtinfunc" id="6103110">print</span><span class="op" id="6103115">(</span><span class="ident" id="6103116">token</span><span class="op" id="6103121">.</span><span class="ident" id="6103122">CHAN</span><span class="op" id="6103126">,</span>&nbsp;<span class="ident" id="6103128">x</span><span class="op" id="6103129">.</span><span class="ident" id="6103130">Arrow</span><span class="op" id="6103135">,</span>&nbsp;<span class="ident" id="6103137">token</span><span class="op" id="6103142">.</span><span class="ident" id="6103143">ARROW</span><span class="op" id="6103148">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6103152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103156">p</span><span class="op" id="6103157">.</span><span class="builtinfunc" id="6103158">print</span><span class="op" id="6103163">(</span><span class="ident" id="6103164">blank</span><span class="op" id="6103169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103173">p</span><span class="op" id="6103174">.</span><span class="ident" id="6103175">expr</span><span class="op" id="6103179">(</span><span class="ident" id="6103180">x</span><span class="op" id="6103181">.</span><span class="ident" id="6103182">Value</span><span class="op" id="6103187">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6103191">default</span><span class="op" id="6103198">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6103202">panic</span><span class="op" id="6103207">(</span><span class="string" id="6103208">&#34;unreachable&#34;</span><span class="op" id="6103221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6103224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6103228">return</span><br>
<span class="lineno"></span><span class="op" id="6103235">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span><span class="keyword" id="6103238">func</span>&nbsp;<span class="op" id="6103243">(</span><span class="ident" id="6103244">p</span>&nbsp;<span class="op" id="6103246">*</span><span class="ident" id="6103247">printer</span><span class="op" id="6103254">)</span>&nbsp;<span class="ident" id="6103256">expr0</span><span class="op" id="6103261">(</span><span class="ident" id="6103262">x</span>&nbsp;<span class="ident" id="6103264">ast</span><span class="op" id="6103267">.</span><span class="ident" id="6103268">Expr</span><span class="op" id="6103272">,</span>&nbsp;<span class="ident" id="6103274">depth</span>&nbsp;<span class="builtintype" id="6103280">int</span><span class="op" id="6103283">)</span>&nbsp;<span class="op" id="6103285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103288">p</span><span class="op" id="6103289">.</span><span class="ident" id="6103290">expr1</span><span class="op" id="6103295">(</span><span class="ident" id="6103296">x</span><span class="op" id="6103297">,</span>&nbsp;<span class="ident" id="6103299">token</span><span class="op" id="6103304">.</span><span class="ident" id="6103305">LowestPrec</span><span class="op" id="6103315">,</span>&nbsp;<span class="ident" id="6103317">depth</span><span class="op" id="6103322">)</span><br>
<span class="lineno"></span><span class="op" id="6103324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span><span class="keyword" id="6103327">func</span>&nbsp;<span class="op" id="6103332">(</span><span class="ident" id="6103333">p</span>&nbsp;<span class="op" id="6103335">*</span><span class="ident" id="6103336">printer</span><span class="op" id="6103343">)</span>&nbsp;<span class="ident" id="6103345">expr</span><span class="op" id="6103349">(</span><span class="ident" id="6103350">x</span>&nbsp;<span class="ident" id="6103352">ast</span><span class="op" id="6103355">.</span><span class="ident" id="6103356">Expr</span><span class="op" id="6103360">)</span>&nbsp;<span class="op" id="6103362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6103365">const</span>&nbsp;<span class="ident" id="6103371">depth</span>&nbsp;<span class="op" id="6103377">=</span>&nbsp;<span class="num" id="6103379">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103382">p</span><span class="op" id="6103383">.</span><span class="ident" id="6103384">expr1</span><span class="op" id="6103389">(</span><span class="ident" id="6103390">x</span><span class="op" id="6103391">,</span>&nbsp;<span class="ident" id="6103393">token</span><span class="op" id="6103398">.</span><span class="ident" id="6103399">LowestPrec</span><span class="op" id="6103409">,</span>&nbsp;<span class="ident" id="6103411">depth</span><span class="op" id="6103416">)</span><br>
<span class="lineno"></span><span class="op" id="6103418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="6103421">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="6103501">//&nbsp;Statements</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6103516">//&nbsp;Print&nbsp;the&nbsp;statement&nbsp;list&nbsp;indented,&nbsp;but&nbsp;without&nbsp;a&nbsp;newline&nbsp;after&nbsp;the&nbsp;last&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="6103602">//&nbsp;Extra&nbsp;line&nbsp;breaks&nbsp;between&nbsp;statements&nbsp;in&nbsp;the&nbsp;source&nbsp;are&nbsp;respected&nbsp;but&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">905</span><span class="comment" id="6103686">//&nbsp;empty&nbsp;line&nbsp;is&nbsp;printed&nbsp;between&nbsp;statements.</span><br>
<span class="lineno"></span><span class="keyword" id="6103731">func</span>&nbsp;<span class="op" id="6103736">(</span><span class="ident" id="6103737">p</span>&nbsp;<span class="op" id="6103739">*</span><span class="ident" id="6103740">printer</span><span class="op" id="6103747">)</span>&nbsp;<span class="ident" id="6103749">stmtList</span><span class="op" id="6103757">(</span><span class="ident" id="6103758">list</span>&nbsp;<span class="op" id="6103763">[</span><span class="op" id="6103764">]</span><span class="ident" id="6103765">ast</span><span class="op" id="6103768">.</span><span class="ident" id="6103769">Stmt</span><span class="op" id="6103773">,</span>&nbsp;<span class="ident" id="6103775">nindent</span>&nbsp;<span class="builtintype" id="6103783">int</span><span class="op" id="6103786">,</span>&nbsp;<span class="ident" id="6103788">nextIsRBrace</span>&nbsp;<span class="builtintype" id="6103801">bool</span><span class="op" id="6103805">)</span>&nbsp;<span class="op" id="6103807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6103810">if</span>&nbsp;<span class="ident" id="6103813">nindent</span>&nbsp;<span class="op" id="6103821">&gt;</span>&nbsp;<span class="num" id="6103823">0</span>&nbsp;<span class="op" id="6103825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103829">p</span><span class="op" id="6103830">.</span><span class="builtinfunc" id="6103831">print</span><span class="op" id="6103836">(</span><span class="ident" id="6103837">indent</span><span class="op" id="6103843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6103846">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6103849">var</span>&nbsp;<span class="ident" id="6103853">line</span>&nbsp;<span class="builtintype" id="6103858">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103863">i</span>&nbsp;<span class="op" id="6103865">:=</span>&nbsp;<span class="num" id="6103868">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6103871">for</span>&nbsp;<span class="ident" id="6103875">_</span><span class="op" id="6103876">,</span>&nbsp;<span class="ident" id="6103878">s</span>&nbsp;<span class="op" id="6103880">:=</span>&nbsp;<span class="keyword" id="6103883">range</span>&nbsp;<span class="ident" id="6103889">list</span>&nbsp;<span class="op" id="6103894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6103898">//&nbsp;ignore&nbsp;empty&nbsp;statements&nbsp;(was&nbsp;issue&nbsp;3466)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6103944">if</span>&nbsp;<span class="ident" id="6103947">_</span><span class="op" id="6103948">,</span>&nbsp;<span class="ident" id="6103950">isEmpty</span>&nbsp;<span class="op" id="6103958">:=</span>&nbsp;<span class="ident" id="6103961">s</span><span class="op" id="6103962">.</span><span class="op" id="6103963">(</span><span class="op" id="6103964">*</span><span class="ident" id="6103965">ast</span><span class="op" id="6103968">.</span><span class="ident" id="6103969">EmptyStmt</span><span class="op" id="6103978">)</span><span class="op" id="6103979">;</span>&nbsp;<span class="op" id="6103981">!</span><span class="ident" id="6103982">isEmpty</span>&nbsp;<span class="op" id="6103990">{</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6103995">//&nbsp;nindent&nbsp;==&nbsp;0&nbsp;only&nbsp;for&nbsp;lists&nbsp;of&nbsp;switch/select&nbsp;case&nbsp;clauses;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6104060">//&nbsp;in&nbsp;those&nbsp;cases&nbsp;each&nbsp;clause&nbsp;is&nbsp;a&nbsp;new&nbsp;section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6104110">if</span>&nbsp;<span class="builtinfunc" id="6104113">len</span><span class="op" id="6104116">(</span><span class="ident" id="6104117">p</span><span class="op" id="6104118">.</span><span class="ident" id="6104119">output</span><span class="op" id="6104125">)</span>&nbsp;<span class="op" id="6104127">&gt;</span>&nbsp;<span class="num" id="6104129">0</span>&nbsp;<span class="op" id="6104131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6104137">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6104211">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104269">p</span><span class="op" id="6104270">.</span><span class="ident" id="6104271">linebreak</span><span class="op" id="6104280">(</span><span class="ident" id="6104281">p</span><span class="op" id="6104282">.</span><span class="ident" id="6104283">lineFor</span><span class="op" id="6104290">(</span><span class="ident" id="6104291">s</span><span class="op" id="6104292">.</span><span class="ident" id="6104293">Pos</span><span class="op" id="6104296">(</span><span class="op" id="6104297">)</span><span class="op" id="6104298">)</span><span class="op" id="6104299">,</span>&nbsp;<span class="num" id="6104301">1</span><span class="op" id="6104302">,</span>&nbsp;<span class="ident" id="6104304">ignore</span><span class="op" id="6104310">,</span>&nbsp;<span class="ident" id="6104312">i</span>&nbsp;<span class="op" id="6104314">==</span>&nbsp;<span class="num" id="6104317">0</span>&nbsp;<span class="op" id="6104319">||</span>&nbsp;<span class="ident" id="6104322">nindent</span>&nbsp;<span class="op" id="6104330">==</span>&nbsp;<span class="num" id="6104333">0</span>&nbsp;<span class="op" id="6104335">||</span>&nbsp;<span class="ident" id="6104338">p</span><span class="op" id="6104339">.</span><span class="ident" id="6104340">linesFrom</span><span class="op" id="6104349">(</span><span class="ident" id="6104350">line</span><span class="op" id="6104354">)</span>&nbsp;<span class="op" id="6104356">&gt;</span>&nbsp;<span class="num" id="6104358">0</span><span class="op" id="6104359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6104364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104369">p</span><span class="op" id="6104370">.</span><span class="ident" id="6104371">recordLine</span><span class="op" id="6104381">(</span><span class="op" id="6104382">&amp;</span><span class="ident" id="6104383">line</span><span class="op" id="6104387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104392">p</span><span class="op" id="6104393">.</span><span class="ident" id="6104394">stmt</span><span class="op" id="6104398">(</span><span class="ident" id="6104399">s</span><span class="op" id="6104400">,</span>&nbsp;<span class="ident" id="6104402">nextIsRBrace</span>&nbsp;<span class="op" id="6104415">&amp;&amp;</span>&nbsp;<span class="ident" id="6104418">i</span>&nbsp;<span class="op" id="6104420">==</span>&nbsp;<span class="builtinfunc" id="6104423">len</span><span class="op" id="6104426">(</span><span class="ident" id="6104427">list</span><span class="op" id="6104431">)</span><span class="op" id="6104432">-</span><span class="num" id="6104433">1</span><span class="op" id="6104434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6104439">//&nbsp;labeled&nbsp;statements&nbsp;put&nbsp;labels&nbsp;on&nbsp;a&nbsp;separate&nbsp;line,&nbsp;but&nbsp;here</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6104504">//&nbsp;we&nbsp;only&nbsp;care&nbsp;about&nbsp;the&nbsp;start&nbsp;line&nbsp;of&nbsp;the&nbsp;actual&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6104568">//&nbsp;without&nbsp;label&nbsp;-&nbsp;correct&nbsp;line&nbsp;for&nbsp;each&nbsp;label</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6104618">for</span>&nbsp;<span class="ident" id="6104622">t</span>&nbsp;<span class="op" id="6104624">:=</span>&nbsp;<span class="ident" id="6104627">s</span><span class="op" id="6104628">;</span>&nbsp;<span class="op" id="6104630">;</span>&nbsp;<span class="op" id="6104632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104638">lt</span><span class="op" id="6104640">,</span>&nbsp;<span class="ident" id="6104642">_</span>&nbsp;<span class="op" id="6104644">:=</span>&nbsp;<span class="ident" id="6104647">t</span><span class="op" id="6104648">.</span><span class="op" id="6104649">(</span><span class="op" id="6104650">*</span><span class="ident" id="6104651">ast</span><span class="op" id="6104654">.</span><span class="ident" id="6104655">LabeledStmt</span><span class="op" id="6104666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6104672">if</span>&nbsp;<span class="ident" id="6104675">lt</span>&nbsp;<span class="op" id="6104678">==</span>&nbsp;<span class="ident" id="6104681">nil</span>&nbsp;<span class="op" id="6104685">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6104692">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6104702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104708">line</span><span class="op" id="6104712">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104719">t</span>&nbsp;<span class="op" id="6104721">=</span>&nbsp;<span class="ident" id="6104723">lt</span><span class="op" id="6104725">.</span><span class="ident" id="6104726">Stmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6104734">}</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104739">i</span><span class="op" id="6104740">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6104745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6104748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6104751">if</span>&nbsp;<span class="ident" id="6104754">nindent</span>&nbsp;<span class="op" id="6104762">&gt;</span>&nbsp;<span class="num" id="6104764">0</span>&nbsp;<span class="op" id="6104766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104770">p</span><span class="op" id="6104771">.</span><span class="builtinfunc" id="6104772">print</span><span class="op" id="6104777">(</span><span class="ident" id="6104778">unindent</span><span class="op" id="6104786">)</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6104789">}</span><br>
<span class="lineno"></span><span class="op" id="6104791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6104794">//&nbsp;block&nbsp;prints&nbsp;an&nbsp;*ast.BlockStmt;&nbsp;it&nbsp;always&nbsp;spans&nbsp;at&nbsp;least&nbsp;two&nbsp;lines.</span><br>
<span class="lineno"></span><span class="keyword" id="6104865">func</span>&nbsp;<span class="op" id="6104870">(</span><span class="ident" id="6104871">p</span>&nbsp;<span class="op" id="6104873">*</span><span class="ident" id="6104874">printer</span><span class="op" id="6104881">)</span>&nbsp;<span class="ident" id="6104883">block</span><span class="op" id="6104888">(</span><span class="ident" id="6104889">b</span>&nbsp;<span class="op" id="6104891">*</span><span class="ident" id="6104892">ast</span><span class="op" id="6104895">.</span><span class="ident" id="6104896">BlockStmt</span><span class="op" id="6104905">,</span>&nbsp;<span class="ident" id="6104907">nindent</span>&nbsp;<span class="builtintype" id="6104915">int</span><span class="op" id="6104918">)</span>&nbsp;<span class="op" id="6104920">{</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104923">p</span><span class="op" id="6104924">.</span><span class="builtinfunc" id="6104925">print</span><span class="op" id="6104930">(</span><span class="ident" id="6104931">b</span><span class="op" id="6104932">.</span><span class="ident" id="6104933">Lbrace</span><span class="op" id="6104939">,</span>&nbsp;<span class="ident" id="6104941">token</span><span class="op" id="6104946">.</span><span class="ident" id="6104947">LBRACE</span><span class="op" id="6104953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104956">p</span><span class="op" id="6104957">.</span><span class="ident" id="6104958">stmtList</span><span class="op" id="6104966">(</span><span class="ident" id="6104967">b</span><span class="op" id="6104968">.</span><span class="ident" id="6104969">List</span><span class="op" id="6104973">,</span>&nbsp;<span class="ident" id="6104975">nindent</span><span class="op" id="6104982">,</span>&nbsp;<span class="builtintype" id="6104984">true</span><span class="op" id="6104988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104991">p</span><span class="op" id="6104992">.</span><span class="ident" id="6104993">linebreak</span><span class="op" id="6105002">(</span><span class="ident" id="6105003">p</span><span class="op" id="6105004">.</span><span class="ident" id="6105005">lineFor</span><span class="op" id="6105012">(</span><span class="ident" id="6105013">b</span><span class="op" id="6105014">.</span><span class="ident" id="6105015">Rbrace</span><span class="op" id="6105021">)</span><span class="op" id="6105022">,</span>&nbsp;<span class="num" id="6105024">1</span><span class="op" id="6105025">,</span>&nbsp;<span class="ident" id="6105027">ignore</span><span class="op" id="6105033">,</span>&nbsp;<span class="builtintype" id="6105035">true</span><span class="op" id="6105039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6105042">p</span><span class="op" id="6105043">.</span><span class="builtinfunc" id="6105044">print</span><span class="op" id="6105049">(</span><span class="ident" id="6105050">b</span><span class="op" id="6105051">.</span><span class="ident" id="6105052">Rbrace</span><span class="op" id="6105058">,</span>&nbsp;<span class="ident" id="6105060">token</span><span class="op" id="6105065">.</span><span class="ident" id="6105066">RBRACE</span><span class="op" id="6105072">)</span><br>
<span class="lineno"></span><span class="op" id="6105074">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span><span class="keyword" id="6105077">func</span>&nbsp;<span class="ident" id="6105082">isTypeName</span><span class="op" id="6105092">(</span><span class="ident" id="6105093">x</span>&nbsp;<span class="ident" id="6105095">ast</span><span class="op" id="6105098">.</span><span class="ident" id="6105099">Expr</span><span class="op" id="6105103">)</span>&nbsp;<span class="builtintype" id="6105105">bool</span>&nbsp;<span class="op" id="6105110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105113">switch</span>&nbsp;<span class="ident" id="6105120">t</span>&nbsp;<span class="op" id="6105122">:=</span>&nbsp;<span class="ident" id="6105125">x</span><span class="op" id="6105126">.</span><span class="op" id="6105127">(</span><span class="keyword" id="6105128">type</span><span class="op" id="6105132">)</span>&nbsp;<span class="op" id="6105134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105137">case</span>&nbsp;<span class="op" id="6105142">*</span><span class="ident" id="6105143">ast</span><span class="op" id="6105146">.</span><span class="ident" id="6105147">Ident</span><span class="op" id="6105152">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105156">return</span>&nbsp;<span class="builtintype" id="6105163">true</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105169">case</span>&nbsp;<span class="op" id="6105174">*</span><span class="ident" id="6105175">ast</span><span class="op" id="6105178">.</span><span class="ident" id="6105179">SelectorExpr</span><span class="op" id="6105191">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105195">return</span>&nbsp;<span class="ident" id="6105202">isTypeName</span><span class="op" id="6105212">(</span><span class="ident" id="6105213">t</span><span class="op" id="6105214">.</span><span class="ident" id="6105215">X</span><span class="op" id="6105216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6105219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105222">return</span>&nbsp;<span class="builtintype" id="6105229">false</span><br>
<span class="lineno"></span><span class="op" id="6105235">}</span><br>
<span class="lineno">960</span><br>
<span class="lineno"></span><span class="keyword" id="6105238">func</span>&nbsp;<span class="ident" id="6105243">stripParens</span><span class="op" id="6105254">(</span><span class="ident" id="6105255">x</span>&nbsp;<span class="ident" id="6105257">ast</span><span class="op" id="6105260">.</span><span class="ident" id="6105261">Expr</span><span class="op" id="6105265">)</span>&nbsp;<span class="ident" id="6105267">ast</span><span class="op" id="6105270">.</span><span class="ident" id="6105271">Expr</span>&nbsp;<span class="op" id="6105276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105279">if</span>&nbsp;<span class="ident" id="6105282">px</span><span class="op" id="6105284">,</span>&nbsp;<span class="ident" id="6105286">strip</span>&nbsp;<span class="op" id="6105292">:=</span>&nbsp;<span class="ident" id="6105295">x</span><span class="op" id="6105296">.</span><span class="op" id="6105297">(</span><span class="op" id="6105298">*</span><span class="ident" id="6105299">ast</span><span class="op" id="6105302">.</span><span class="ident" id="6105303">ParenExpr</span><span class="op" id="6105312">)</span><span class="op" id="6105313">;</span>&nbsp;<span class="ident" id="6105315">strip</span>&nbsp;<span class="op" id="6105321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6105325">//&nbsp;parentheses&nbsp;must&nbsp;not&nbsp;be&nbsp;stripped&nbsp;if&nbsp;there&nbsp;are&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6105380">//&nbsp;unparenthesized&nbsp;composite&nbsp;literals&nbsp;starting&nbsp;with</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6105434">//&nbsp;a&nbsp;type&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6105451">ast</span><span class="op" id="6105454">.</span><span class="ident" id="6105455">Inspect</span><span class="op" id="6105462">(</span><span class="ident" id="6105463">px</span><span class="op" id="6105465">.</span><span class="ident" id="6105466">X</span><span class="op" id="6105467">,</span>&nbsp;<span class="keyword" id="6105469">func</span><span class="op" id="6105473">(</span><span class="ident" id="6105474">node</span>&nbsp;<span class="ident" id="6105479">ast</span><span class="op" id="6105482">.</span><span class="ident" id="6105483">Node</span><span class="op" id="6105487">)</span>&nbsp;<span class="builtintype" id="6105489">bool</span>&nbsp;<span class="op" id="6105494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105499">switch</span>&nbsp;<span class="ident" id="6105506">x</span>&nbsp;<span class="op" id="6105508">:=</span>&nbsp;<span class="ident" id="6105511">node</span><span class="op" id="6105515">.</span><span class="op" id="6105516">(</span><span class="keyword" id="6105517">type</span><span class="op" id="6105521">)</span>&nbsp;<span class="op" id="6105523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105528">case</span>&nbsp;<span class="op" id="6105533">*</span><span class="ident" id="6105534">ast</span><span class="op" id="6105537">.</span><span class="ident" id="6105538">ParenExpr</span><span class="op" id="6105547">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6105553">//&nbsp;parentheses&nbsp;protect&nbsp;enclosed&nbsp;composite&nbsp;literals</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105608">return</span>&nbsp;<span class="builtintype" id="6105615">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105624">case</span>&nbsp;<span class="op" id="6105629">*</span><span class="ident" id="6105630">ast</span><span class="op" id="6105633">.</span><span class="ident" id="6105634">CompositeLit</span><span class="op" id="6105646">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105652">if</span>&nbsp;<span class="ident" id="6105655">isTypeName</span><span class="op" id="6105665">(</span><span class="ident" id="6105666">x</span><span class="op" id="6105667">.</span><span class="ident" id="6105668">Type</span><span class="op" id="6105672">)</span>&nbsp;<span class="op" id="6105674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6105681">strip</span>&nbsp;<span class="op" id="6105687">=</span>&nbsp;<span class="builtintype" id="6105689">false</span>&nbsp;<span class="comment" id="6105695">//&nbsp;do&nbsp;not&nbsp;strip&nbsp;parentheses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6105727">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105733">return</span>&nbsp;<span class="builtintype" id="6105740">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6105749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6105754">//&nbsp;in&nbsp;all&nbsp;other&nbsp;cases,&nbsp;keep&nbsp;inspecting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105796">return</span>&nbsp;<span class="builtintype" id="6105803">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6105810">}</span><span class="op" id="6105811">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105815">if</span>&nbsp;<span class="ident" id="6105818">strip</span>&nbsp;<span class="op" id="6105824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105829">return</span>&nbsp;<span class="ident" id="6105836">stripParens</span><span class="op" id="6105847">(</span><span class="ident" id="6105848">px</span><span class="op" id="6105850">.</span><span class="ident" id="6105851">X</span><span class="op" id="6105852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6105856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6105859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105862">return</span>&nbsp;<span class="ident" id="6105869">x</span><br>
<span class="lineno">985</span><span class="op" id="6105871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6105874">func</span>&nbsp;<span class="ident" id="6105879">stripParensAlways</span><span class="op" id="6105896">(</span><span class="ident" id="6105897">x</span>&nbsp;<span class="ident" id="6105899">ast</span><span class="op" id="6105902">.</span><span class="ident" id="6105903">Expr</span><span class="op" id="6105907">)</span>&nbsp;<span class="ident" id="6105909">ast</span><span class="op" id="6105912">.</span><span class="ident" id="6105913">Expr</span>&nbsp;<span class="op" id="6105918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105921">if</span>&nbsp;<span class="ident" id="6105924">x</span><span class="op" id="6105925">,</span>&nbsp;<span class="ident" id="6105927">ok</span>&nbsp;<span class="op" id="6105930">:=</span>&nbsp;<span class="ident" id="6105933">x</span><span class="op" id="6105934">.</span><span class="op" id="6105935">(</span><span class="op" id="6105936">*</span><span class="ident" id="6105937">ast</span><span class="op" id="6105940">.</span><span class="ident" id="6105941">ParenExpr</span><span class="op" id="6105950">)</span><span class="op" id="6105951">;</span>&nbsp;<span class="ident" id="6105953">ok</span>&nbsp;<span class="op" id="6105956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105960">return</span>&nbsp;<span class="ident" id="6105967">stripParensAlways</span><span class="op" id="6105984">(</span><span class="ident" id="6105985">x</span><span class="op" id="6105986">.</span><span class="ident" id="6105987">X</span><span class="op" id="6105988">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6105991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105994">return</span>&nbsp;<span class="ident" id="6106001">x</span><br>
<span class="lineno"></span><span class="op" id="6106003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6106006">func</span>&nbsp;<span class="op" id="6106011">(</span><span class="ident" id="6106012">p</span>&nbsp;<span class="op" id="6106014">*</span><span class="ident" id="6106015">printer</span><span class="op" id="6106022">)</span>&nbsp;<span class="ident" id="6106024">controlClause</span><span class="op" id="6106037">(</span><span class="ident" id="6106038">isForStmt</span>&nbsp;<span class="builtintype" id="6106048">bool</span><span class="op" id="6106052">,</span>&nbsp;<span class="ident" id="6106054">init</span>&nbsp;<span class="ident" id="6106059">ast</span><span class="op" id="6106062">.</span><span class="ident" id="6106063">Stmt</span><span class="op" id="6106067">,</span>&nbsp;<span class="ident" id="6106069">expr</span>&nbsp;<span class="ident" id="6106074">ast</span><span class="op" id="6106077">.</span><span class="ident" id="6106078">Expr</span><span class="op" id="6106082">,</span>&nbsp;<span class="ident" id="6106084">post</span>&nbsp;<span class="ident" id="6106089">ast</span><span class="op" id="6106092">.</span><span class="ident" id="6106093">Stmt</span><span class="op" id="6106097">)</span>&nbsp;<span class="op" id="6106099">{</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106102">p</span><span class="op" id="6106103">.</span><span class="builtinfunc" id="6106104">print</span><span class="op" id="6106109">(</span><span class="ident" id="6106110">blank</span><span class="op" id="6106115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106118">needsBlank</span>&nbsp;<span class="op" id="6106129">:=</span>&nbsp;<span class="builtintype" id="6106132">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106139">if</span>&nbsp;<span class="ident" id="6106142">init</span>&nbsp;<span class="op" id="6106147">==</span>&nbsp;<span class="ident" id="6106150">nil</span>&nbsp;<span class="op" id="6106154">&amp;&amp;</span>&nbsp;<span class="ident" id="6106157">post</span>&nbsp;<span class="op" id="6106162">==</span>&nbsp;<span class="ident" id="6106165">nil</span>&nbsp;<span class="op" id="6106169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6106173">//&nbsp;no&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106201">if</span>&nbsp;<span class="ident" id="6106204">expr</span>&nbsp;<span class="op" id="6106209">!=</span>&nbsp;<span class="ident" id="6106212">nil</span>&nbsp;<span class="op" id="6106216">{</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106221">p</span><span class="op" id="6106222">.</span><span class="ident" id="6106223">expr</span><span class="op" id="6106227">(</span><span class="ident" id="6106228">stripParens</span><span class="op" id="6106239">(</span><span class="ident" id="6106240">expr</span><span class="op" id="6106244">)</span><span class="op" id="6106245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106250">needsBlank</span>&nbsp;<span class="op" id="6106261">=</span>&nbsp;<span class="builtintype" id="6106263">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6106270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6106273">}</span>&nbsp;<span class="keyword" id="6106275">else</span>&nbsp;<span class="op" id="6106280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6106284">//&nbsp;all&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6106313">//&nbsp;(they&nbsp;are&nbsp;not&nbsp;separators,&nbsp;print&nbsp;them&nbsp;explicitly)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106367">if</span>&nbsp;<span class="ident" id="6106370">init</span>&nbsp;<span class="op" id="6106375">!=</span>&nbsp;<span class="ident" id="6106378">nil</span>&nbsp;<span class="op" id="6106382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106387">p</span><span class="op" id="6106388">.</span><span class="ident" id="6106389">stmt</span><span class="op" id="6106393">(</span><span class="ident" id="6106394">init</span><span class="op" id="6106398">,</span>&nbsp;<span class="builtintype" id="6106400">false</span><span class="op" id="6106405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6106409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106413">p</span><span class="op" id="6106414">.</span><span class="builtinfunc" id="6106415">print</span><span class="op" id="6106420">(</span><span class="ident" id="6106421">token</span><span class="op" id="6106426">.</span><span class="ident" id="6106427">SEMICOLON</span><span class="op" id="6106436">,</span>&nbsp;<span class="ident" id="6106438">blank</span><span class="op" id="6106443">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106447">if</span>&nbsp;<span class="ident" id="6106450">expr</span>&nbsp;<span class="op" id="6106455">!=</span>&nbsp;<span class="ident" id="6106458">nil</span>&nbsp;<span class="op" id="6106462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106467">p</span><span class="op" id="6106468">.</span><span class="ident" id="6106469">expr</span><span class="op" id="6106473">(</span><span class="ident" id="6106474">stripParens</span><span class="op" id="6106485">(</span><span class="ident" id="6106486">expr</span><span class="op" id="6106490">)</span><span class="op" id="6106491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106496">needsBlank</span>&nbsp;<span class="op" id="6106507">=</span>&nbsp;<span class="builtintype" id="6106509">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6106516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106520">if</span>&nbsp;<span class="ident" id="6106523">isForStmt</span>&nbsp;<span class="op" id="6106533">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106538">p</span><span class="op" id="6106539">.</span><span class="builtinfunc" id="6106540">print</span><span class="op" id="6106545">(</span><span class="ident" id="6106546">token</span><span class="op" id="6106551">.</span><span class="ident" id="6106552">SEMICOLON</span><span class="op" id="6106561">,</span>&nbsp;<span class="ident" id="6106563">blank</span><span class="op" id="6106568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106573">needsBlank</span>&nbsp;<span class="op" id="6106584">=</span>&nbsp;<span class="builtintype" id="6106586">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106595">if</span>&nbsp;<span class="ident" id="6106598">post</span>&nbsp;<span class="op" id="6106603">!=</span>&nbsp;<span class="ident" id="6106606">nil</span>&nbsp;<span class="op" id="6106610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106616">p</span><span class="op" id="6106617">.</span><span class="ident" id="6106618">stmt</span><span class="op" id="6106622">(</span><span class="ident" id="6106623">post</span><span class="op" id="6106627">,</span>&nbsp;<span class="builtintype" id="6106629">false</span><span class="op" id="6106634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106640">needsBlank</span>&nbsp;<span class="op" id="6106651">=</span>&nbsp;<span class="builtintype" id="6106653">true</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6106661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6106665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6106668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106671">if</span>&nbsp;<span class="ident" id="6106674">needsBlank</span>&nbsp;<span class="op" id="6106685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106689">p</span><span class="op" id="6106690">.</span><span class="builtinfunc" id="6106691">print</span><span class="op" id="6106696">(</span><span class="ident" id="6106697">blank</span><span class="op" id="6106702">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6106705">}</span><br>
<span class="lineno"></span><span class="op" id="6106707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6106710">//&nbsp;indentList&nbsp;reports&nbsp;whether&nbsp;an&nbsp;expression&nbsp;list&nbsp;would&nbsp;look&nbsp;better&nbsp;if&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="6106783">//&nbsp;were&nbsp;indented&nbsp;wholesale&nbsp;(starting&nbsp;with&nbsp;the&nbsp;very&nbsp;first&nbsp;element,&nbsp;rather</span><br>
<span class="lineno">1030</span><span class="comment" id="6106856">//&nbsp;than&nbsp;starting&nbsp;at&nbsp;the&nbsp;first&nbsp;line&nbsp;break).</span><br>
<span class="lineno"></span><span class="comment" id="6106899">//</span><br>
<span class="lineno"></span><span class="keyword" id="6106902">func</span>&nbsp;<span class="op" id="6106907">(</span><span class="ident" id="6106908">p</span>&nbsp;<span class="op" id="6106910">*</span><span class="ident" id="6106911">printer</span><span class="op" id="6106918">)</span>&nbsp;<span class="ident" id="6106920">indentList</span><span class="op" id="6106930">(</span><span class="ident" id="6106931">list</span>&nbsp;<span class="op" id="6106936">[</span><span class="op" id="6106937">]</span><span class="ident" id="6106938">ast</span><span class="op" id="6106941">.</span><span class="ident" id="6106942">Expr</span><span class="op" id="6106946">)</span>&nbsp;<span class="builtintype" id="6106948">bool</span>&nbsp;<span class="op" id="6106953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6106956">//&nbsp;Heuristic:&nbsp;indentList&nbsp;returns&nbsp;true&nbsp;if&nbsp;there&nbsp;are&nbsp;more&nbsp;than&nbsp;one&nbsp;multi-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6107029">//&nbsp;line&nbsp;element&nbsp;in&nbsp;the&nbsp;list,&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;any&nbsp;element&nbsp;that&nbsp;is&nbsp;not</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6107098">//&nbsp;starting&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ends.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107154">if</span>&nbsp;<span class="builtinfunc" id="6107157">len</span><span class="op" id="6107160">(</span><span class="ident" id="6107161">list</span><span class="op" id="6107165">)</span>&nbsp;<span class="op" id="6107167">&gt;=</span>&nbsp;<span class="num" id="6107170">2</span>&nbsp;<span class="op" id="6107172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107176">var</span>&nbsp;<span class="ident" id="6107180">b</span>&nbsp;<span class="op" id="6107182">=</span>&nbsp;<span class="ident" id="6107184">p</span><span class="op" id="6107185">.</span><span class="ident" id="6107186">lineFor</span><span class="op" id="6107193">(</span><span class="ident" id="6107194">list</span><span class="op" id="6107198">[</span><span class="num" id="6107199">0</span><span class="op" id="6107200">]</span><span class="op" id="6107201">.</span><span class="ident" id="6107202">Pos</span><span class="op" id="6107205">(</span><span class="op" id="6107206">)</span><span class="op" id="6107207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107211">var</span>&nbsp;<span class="ident" id="6107215">e</span>&nbsp;<span class="op" id="6107217">=</span>&nbsp;<span class="ident" id="6107219">p</span><span class="op" id="6107220">.</span><span class="ident" id="6107221">lineFor</span><span class="op" id="6107228">(</span><span class="ident" id="6107229">list</span><span class="op" id="6107233">[</span><span class="builtinfunc" id="6107234">len</span><span class="op" id="6107237">(</span><span class="ident" id="6107238">list</span><span class="op" id="6107242">)</span><span class="op" id="6107243">-</span><span class="num" id="6107244">1</span><span class="op" id="6107245">]</span><span class="op" id="6107246">.</span><span class="ident" id="6107247">End</span><span class="op" id="6107250">(</span><span class="op" id="6107251">)</span><span class="op" id="6107252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107256">if</span>&nbsp;<span class="num" id="6107259">0</span>&nbsp;<span class="op" id="6107261">&lt;</span>&nbsp;<span class="ident" id="6107263">b</span>&nbsp;<span class="op" id="6107265">&amp;&amp;</span>&nbsp;<span class="ident" id="6107268">b</span>&nbsp;<span class="op" id="6107270">&lt;</span>&nbsp;<span class="ident" id="6107272">e</span>&nbsp;<span class="op" id="6107274">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6107279">//&nbsp;list&nbsp;spans&nbsp;multiple&nbsp;lines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107311">n</span>&nbsp;<span class="op" id="6107313">:=</span>&nbsp;<span class="num" id="6107316">0</span>&nbsp;<span class="comment" id="6107318">//&nbsp;multi-line&nbsp;element&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107349">line</span>&nbsp;<span class="op" id="6107354">:=</span>&nbsp;<span class="ident" id="6107357">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107362">for</span>&nbsp;<span class="ident" id="6107366">_</span><span class="op" id="6107367">,</span>&nbsp;<span class="ident" id="6107369">x</span>&nbsp;<span class="op" id="6107371">:=</span>&nbsp;<span class="keyword" id="6107374">range</span>&nbsp;<span class="ident" id="6107380">list</span>&nbsp;<span class="op" id="6107385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107391">xb</span>&nbsp;<span class="op" id="6107394">:=</span>&nbsp;<span class="ident" id="6107397">p</span><span class="op" id="6107398">.</span><span class="ident" id="6107399">lineFor</span><span class="op" id="6107406">(</span><span class="ident" id="6107407">x</span><span class="op" id="6107408">.</span><span class="ident" id="6107409">Pos</span><span class="op" id="6107412">(</span><span class="op" id="6107413">)</span><span class="op" id="6107414">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107420">xe</span>&nbsp;<span class="op" id="6107423">:=</span>&nbsp;<span class="ident" id="6107426">p</span><span class="op" id="6107427">.</span><span class="ident" id="6107428">lineFor</span><span class="op" id="6107435">(</span><span class="ident" id="6107436">x</span><span class="op" id="6107437">.</span><span class="ident" id="6107438">End</span><span class="op" id="6107441">(</span><span class="op" id="6107442">)</span><span class="op" id="6107443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107449">if</span>&nbsp;<span class="ident" id="6107452">line</span>&nbsp;<span class="op" id="6107457">&lt;</span>&nbsp;<span class="ident" id="6107459">xb</span>&nbsp;<span class="op" id="6107462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6107469">//&nbsp;x&nbsp;is&nbsp;not&nbsp;starting&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6107507">//&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ended</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107546">return</span>&nbsp;<span class="builtintype" id="6107553">true</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6107562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107568">if</span>&nbsp;<span class="ident" id="6107571">xb</span>&nbsp;<span class="op" id="6107574">&lt;</span>&nbsp;<span class="ident" id="6107576">xe</span>&nbsp;<span class="op" id="6107579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6107586">//&nbsp;x&nbsp;is&nbsp;a&nbsp;multi-line&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107620">n</span><span class="op" id="6107621">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6107628">}</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107634">line</span>&nbsp;<span class="op" id="6107639">=</span>&nbsp;<span class="ident" id="6107641">xe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6107647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107652">return</span>&nbsp;<span class="ident" id="6107659">n</span>&nbsp;<span class="op" id="6107661">&gt;</span>&nbsp;<span class="num" id="6107663">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6107667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6107670">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107673">return</span>&nbsp;<span class="builtintype" id="6107680">false</span><br>
<span class="lineno"></span><span class="op" id="6107686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6107689">func</span>&nbsp;<span class="op" id="6107694">(</span><span class="ident" id="6107695">p</span>&nbsp;<span class="op" id="6107697">*</span><span class="ident" id="6107698">printer</span><span class="op" id="6107705">)</span>&nbsp;<span class="ident" id="6107707">stmt</span><span class="op" id="6107711">(</span><span class="ident" id="6107712">stmt</span>&nbsp;<span class="ident" id="6107717">ast</span><span class="op" id="6107720">.</span><span class="ident" id="6107721">Stmt</span><span class="op" id="6107725">,</span>&nbsp;<span class="ident" id="6107727">nextIsRBrace</span>&nbsp;<span class="builtintype" id="6107740">bool</span><span class="op" id="6107744">)</span>&nbsp;<span class="op" id="6107746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107749">p</span><span class="op" id="6107750">.</span><span class="builtinfunc" id="6107751">print</span><span class="op" id="6107756">(</span><span class="ident" id="6107757">stmt</span><span class="op" id="6107761">.</span><span class="ident" id="6107762">Pos</span><span class="op" id="6107765">(</span><span class="op" id="6107766">)</span><span class="op" id="6107767">)</span><br>
<span class="lineno">1065</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107771">switch</span>&nbsp;<span class="ident" id="6107778">s</span>&nbsp;<span class="op" id="6107780">:=</span>&nbsp;<span class="ident" id="6107783">stmt</span><span class="op" id="6107787">.</span><span class="op" id="6107788">(</span><span class="keyword" id="6107789">type</span><span class="op" id="6107793">)</span>&nbsp;<span class="op" id="6107795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107798">case</span>&nbsp;<span class="op" id="6107803">*</span><span class="ident" id="6107804">ast</span><span class="op" id="6107807">.</span><span class="ident" id="6107808">BadStmt</span><span class="op" id="6107815">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107819">p</span><span class="op" id="6107820">.</span><span class="builtinfunc" id="6107821">print</span><span class="op" id="6107826">(</span><span class="string" id="6107827">&#34;BadStmt&#34;</span><span class="op" id="6107836">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107840">case</span>&nbsp;<span class="op" id="6107845">*</span><span class="ident" id="6107846">ast</span><span class="op" id="6107849">.</span><span class="ident" id="6107850">DeclStmt</span><span class="op" id="6107858">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107862">p</span><span class="op" id="6107863">.</span><span class="ident" id="6107864">decl</span><span class="op" id="6107868">(</span><span class="ident" id="6107869">s</span><span class="op" id="6107870">.</span><span class="ident" id="6107871">Decl</span><span class="op" id="6107875">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107879">case</span>&nbsp;<span class="op" id="6107884">*</span><span class="ident" id="6107885">ast</span><span class="op" id="6107888">.</span><span class="ident" id="6107889">EmptyStmt</span><span class="op" id="6107898">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6107902">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno">1075</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107921">case</span>&nbsp;<span class="op" id="6107926">*</span><span class="ident" id="6107927">ast</span><span class="op" id="6107930">.</span><span class="ident" id="6107931">LabeledStmt</span><span class="op" id="6107942">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6107946">//&nbsp;a&nbsp;&#34;correcting&#34;&nbsp;unindent&nbsp;immediately&nbsp;following&nbsp;a&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6108010">//&nbsp;is&nbsp;applied&nbsp;before&nbsp;the&nbsp;line&nbsp;break&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6108071">//&nbsp;between&nbsp;(see&nbsp;writeWhitespace)</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108106">p</span><span class="op" id="6108107">.</span><span class="builtinfunc" id="6108108">print</span><span class="op" id="6108113">(</span><span class="ident" id="6108114">unindent</span><span class="op" id="6108122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108126">p</span><span class="op" id="6108127">.</span><span class="ident" id="6108128">expr</span><span class="op" id="6108132">(</span><span class="ident" id="6108133">s</span><span class="op" id="6108134">.</span><span class="ident" id="6108135">Label</span><span class="op" id="6108140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108144">p</span><span class="op" id="6108145">.</span><span class="builtinfunc" id="6108146">print</span><span class="op" id="6108151">(</span><span class="ident" id="6108152">s</span><span class="op" id="6108153">.</span><span class="ident" id="6108154">Colon</span><span class="op" id="6108159">,</span>&nbsp;<span class="ident" id="6108161">token</span><span class="op" id="6108166">.</span><span class="ident" id="6108167">COLON</span><span class="op" id="6108172">,</span>&nbsp;<span class="ident" id="6108174">indent</span><span class="op" id="6108180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108184">if</span>&nbsp;<span class="ident" id="6108187">e</span><span class="op" id="6108188">,</span>&nbsp;<span class="ident" id="6108190">isEmpty</span>&nbsp;<span class="op" id="6108198">:=</span>&nbsp;<span class="ident" id="6108201">s</span><span class="op" id="6108202">.</span><span class="ident" id="6108203">Stmt</span><span class="op" id="6108207">.</span><span class="op" id="6108208">(</span><span class="op" id="6108209">*</span><span class="ident" id="6108210">ast</span><span class="op" id="6108213">.</span><span class="ident" id="6108214">EmptyStmt</span><span class="op" id="6108223">)</span><span class="op" id="6108224">;</span>&nbsp;<span class="ident" id="6108226">isEmpty</span>&nbsp;<span class="op" id="6108234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108239">if</span>&nbsp;<span class="op" id="6108242">!</span><span class="ident" id="6108243">nextIsRBrace</span>&nbsp;<span class="op" id="6108256">{</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108262">p</span><span class="op" id="6108263">.</span><span class="builtinfunc" id="6108264">print</span><span class="op" id="6108269">(</span><span class="ident" id="6108270">newline</span><span class="op" id="6108277">,</span>&nbsp;<span class="ident" id="6108279">e</span><span class="op" id="6108280">.</span><span class="ident" id="6108281">Pos</span><span class="op" id="6108284">(</span><span class="op" id="6108285">)</span><span class="op" id="6108286">,</span>&nbsp;<span class="ident" id="6108288">token</span><span class="op" id="6108293">.</span><span class="ident" id="6108294">SEMICOLON</span><span class="op" id="6108303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108309">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6108318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6108322">}</span>&nbsp;<span class="keyword" id="6108324">else</span>&nbsp;<span class="op" id="6108329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108334">p</span><span class="op" id="6108335">.</span><span class="ident" id="6108336">linebreak</span><span class="op" id="6108345">(</span><span class="ident" id="6108346">p</span><span class="op" id="6108347">.</span><span class="ident" id="6108348">lineFor</span><span class="op" id="6108355">(</span><span class="ident" id="6108356">s</span><span class="op" id="6108357">.</span><span class="ident" id="6108358">Stmt</span><span class="op" id="6108362">.</span><span class="ident" id="6108363">Pos</span><span class="op" id="6108366">(</span><span class="op" id="6108367">)</span><span class="op" id="6108368">)</span><span class="op" id="6108369">,</span>&nbsp;<span class="num" id="6108371">1</span><span class="op" id="6108372">,</span>&nbsp;<span class="ident" id="6108374">ignore</span><span class="op" id="6108380">,</span>&nbsp;<span class="builtintype" id="6108382">true</span><span class="op" id="6108386">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6108390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108394">p</span><span class="op" id="6108395">.</span><span class="ident" id="6108396">stmt</span><span class="op" id="6108400">(</span><span class="ident" id="6108401">s</span><span class="op" id="6108402">.</span><span class="ident" id="6108403">Stmt</span><span class="op" id="6108407">,</span>&nbsp;<span class="ident" id="6108409">nextIsRBrace</span><span class="op" id="6108421">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108425">case</span>&nbsp;<span class="op" id="6108430">*</span><span class="ident" id="6108431">ast</span><span class="op" id="6108434">.</span><span class="ident" id="6108435">ExprStmt</span><span class="op" id="6108443">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108447">const</span>&nbsp;<span class="ident" id="6108453">depth</span>&nbsp;<span class="op" id="6108459">=</span>&nbsp;<span class="num" id="6108461">1</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108465">p</span><span class="op" id="6108466">.</span><span class="ident" id="6108467">expr0</span><span class="op" id="6108472">(</span><span class="ident" id="6108473">s</span><span class="op" id="6108474">.</span><span class="ident" id="6108475">X</span><span class="op" id="6108476">,</span>&nbsp;<span class="ident" id="6108478">depth</span><span class="op" id="6108483">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108487">case</span>&nbsp;<span class="op" id="6108492">*</span><span class="ident" id="6108493">ast</span><span class="op" id="6108496">.</span><span class="ident" id="6108497">SendStmt</span><span class="op" id="6108505">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108509">const</span>&nbsp;<span class="ident" id="6108515">depth</span>&nbsp;<span class="op" id="6108521">=</span>&nbsp;<span class="num" id="6108523">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108527">p</span><span class="op" id="6108528">.</span><span class="ident" id="6108529">expr0</span><span class="op" id="6108534">(</span><span class="ident" id="6108535">s</span><span class="op" id="6108536">.</span><span class="ident" id="6108537">Chan</span><span class="op" id="6108541">,</span>&nbsp;<span class="ident" id="6108543">depth</span><span class="op" id="6108548">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108552">p</span><span class="op" id="6108553">.</span><span class="builtinfunc" id="6108554">print</span><span class="op" id="6108559">(</span><span class="ident" id="6108560">blank</span><span class="op" id="6108565">,</span>&nbsp;<span class="ident" id="6108567">s</span><span class="op" id="6108568">.</span><span class="ident" id="6108569">Arrow</span><span class="op" id="6108574">,</span>&nbsp;<span class="ident" id="6108576">token</span><span class="op" id="6108581">.</span><span class="ident" id="6108582">ARROW</span><span class="op" id="6108587">,</span>&nbsp;<span class="ident" id="6108589">blank</span><span class="op" id="6108594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108598">p</span><span class="op" id="6108599">.</span><span class="ident" id="6108600">expr0</span><span class="op" id="6108605">(</span><span class="ident" id="6108606">s</span><span class="op" id="6108607">.</span><span class="ident" id="6108608">Value</span><span class="op" id="6108613">,</span>&nbsp;<span class="ident" id="6108615">depth</span><span class="op" id="6108620">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108624">case</span>&nbsp;<span class="op" id="6108629">*</span><span class="ident" id="6108630">ast</span><span class="op" id="6108633">.</span><span class="ident" id="6108634">IncDecStmt</span><span class="op" id="6108644">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108648">const</span>&nbsp;<span class="ident" id="6108654">depth</span>&nbsp;<span class="op" id="6108660">=</span>&nbsp;<span class="num" id="6108662">1</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108666">p</span><span class="op" id="6108667">.</span><span class="ident" id="6108668">expr0</span><span class="op" id="6108673">(</span><span class="ident" id="6108674">s</span><span class="op" id="6108675">.</span><span class="ident" id="6108676">X</span><span class="op" id="6108677">,</span>&nbsp;<span class="ident" id="6108679">depth</span><span class="op" id="6108684">+</span><span class="num" id="6108685">1</span><span class="op" id="6108686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108690">p</span><span class="op" id="6108691">.</span><span class="builtinfunc" id="6108692">print</span><span class="op" id="6108697">(</span><span class="ident" id="6108698">s</span><span class="op" id="6108699">.</span><span class="ident" id="6108700">TokPos</span><span class="op" id="6108706">,</span>&nbsp;<span class="ident" id="6108708">s</span><span class="op" id="6108709">.</span><span class="ident" id="6108710">Tok</span><span class="op" id="6108713">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108717">case</span>&nbsp;<span class="op" id="6108722">*</span><span class="ident" id="6108723">ast</span><span class="op" id="6108726">.</span><span class="ident" id="6108727">AssignStmt</span><span class="op" id="6108737">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108741">var</span>&nbsp;<span class="ident" id="6108745">depth</span>&nbsp;<span class="op" id="6108751">=</span>&nbsp;<span class="num" id="6108753">1</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108757">if</span>&nbsp;<span class="builtinfunc" id="6108760">len</span><span class="op" id="6108763">(</span><span class="ident" id="6108764">s</span><span class="op" id="6108765">.</span><span class="ident" id="6108766">Lhs</span><span class="op" id="6108769">)</span>&nbsp;<span class="op" id="6108771">&gt;</span>&nbsp;<span class="num" id="6108773">1</span>&nbsp;<span class="op" id="6108775">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6108778">len</span><span class="op" id="6108781">(</span><span class="ident" id="6108782">s</span><span class="op" id="6108783">.</span><span class="ident" id="6108784">Rhs</span><span class="op" id="6108787">)</span>&nbsp;<span class="op" id="6108789">&gt;</span>&nbsp;<span class="num" id="6108791">1</span>&nbsp;<span class="op" id="6108793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108798">depth</span><span class="op" id="6108803">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6108808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108812">p</span><span class="op" id="6108813">.</span><span class="ident" id="6108814">exprList</span><span class="op" id="6108822">(</span><span class="ident" id="6108823">s</span><span class="op" id="6108824">.</span><span class="ident" id="6108825">Pos</span><span class="op" id="6108828">(</span><span class="op" id="6108829">)</span><span class="op" id="6108830">,</span>&nbsp;<span class="ident" id="6108832">s</span><span class="op" id="6108833">.</span><span class="ident" id="6108834">Lhs</span><span class="op" id="6108837">,</span>&nbsp;<span class="ident" id="6108839">depth</span><span class="op" id="6108844">,</span>&nbsp;<span class="num" id="6108846">0</span><span class="op" id="6108847">,</span>&nbsp;<span class="ident" id="6108849">s</span><span class="op" id="6108850">.</span><span class="ident" id="6108851">TokPos</span><span class="op" id="6108857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108861">p</span><span class="op" id="6108862">.</span><span class="builtinfunc" id="6108863">print</span><span class="op" id="6108868">(</span><span class="ident" id="6108869">blank</span><span class="op" id="6108874">,</span>&nbsp;<span class="ident" id="6108876">s</span><span class="op" id="6108877">.</span><span class="ident" id="6108878">TokPos</span><span class="op" id="6108884">,</span>&nbsp;<span class="ident" id="6108886">s</span><span class="op" id="6108887">.</span><span class="ident" id="6108888">Tok</span><span class="op" id="6108891">,</span>&nbsp;<span class="ident" id="6108893">blank</span><span class="op" id="6108898">)</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108902">p</span><span class="op" id="6108903">.</span><span class="ident" id="6108904">exprList</span><span class="op" id="6108912">(</span><span class="ident" id="6108913">s</span><span class="op" id="6108914">.</span><span class="ident" id="6108915">TokPos</span><span class="op" id="6108921">,</span>&nbsp;<span class="ident" id="6108923">s</span><span class="op" id="6108924">.</span><span class="ident" id="6108925">Rhs</span><span class="op" id="6108928">,</span>&nbsp;<span class="ident" id="6108930">depth</span><span class="op" id="6108935">,</span>&nbsp;<span class="num" id="6108937">0</span><span class="op" id="6108938">,</span>&nbsp;<span class="ident" id="6108940">token</span><span class="op" id="6108945">.</span><span class="ident" id="6108946">NoPos</span><span class="op" id="6108951">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108955">case</span>&nbsp;<span class="op" id="6108960">*</span><span class="ident" id="6108961">ast</span><span class="op" id="6108964">.</span><span class="ident" id="6108965">GoStmt</span><span class="op" id="6108971">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108975">p</span><span class="op" id="6108976">.</span><span class="builtinfunc" id="6108977">print</span><span class="op" id="6108982">(</span><span class="ident" id="6108983">token</span><span class="op" id="6108988">.</span><span class="ident" id="6108989">GO</span><span class="op" id="6108991">,</span>&nbsp;<span class="ident" id="6108993">blank</span><span class="op" id="6108998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109002">p</span><span class="op" id="6109003">.</span><span class="ident" id="6109004">expr</span><span class="op" id="6109008">(</span><span class="ident" id="6109009">s</span><span class="op" id="6109010">.</span><span class="ident" id="6109011">Call</span><span class="op" id="6109015">)</span><br>
<span class="lineno">1120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109019">case</span>&nbsp;<span class="op" id="6109024">*</span><span class="ident" id="6109025">ast</span><span class="op" id="6109028">.</span><span class="ident" id="6109029">DeferStmt</span><span class="op" id="6109038">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109042">p</span><span class="op" id="6109043">.</span><span class="builtinfunc" id="6109044">print</span><span class="op" id="6109049">(</span><span class="ident" id="6109050">token</span><span class="op" id="6109055">.</span><span class="ident" id="6109056">DEFER</span><span class="op" id="6109061">,</span>&nbsp;<span class="ident" id="6109063">blank</span><span class="op" id="6109068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109072">p</span><span class="op" id="6109073">.</span><span class="ident" id="6109074">expr</span><span class="op" id="6109078">(</span><span class="ident" id="6109079">s</span><span class="op" id="6109080">.</span><span class="ident" id="6109081">Call</span><span class="op" id="6109085">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109089">case</span>&nbsp;<span class="op" id="6109094">*</span><span class="ident" id="6109095">ast</span><span class="op" id="6109098">.</span><span class="ident" id="6109099">ReturnStmt</span><span class="op" id="6109109">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109113">p</span><span class="op" id="6109114">.</span><span class="builtinfunc" id="6109115">print</span><span class="op" id="6109120">(</span><span class="ident" id="6109121">token</span><span class="op" id="6109126">.</span><span class="ident" id="6109127">RETURN</span><span class="op" id="6109133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109137">if</span>&nbsp;<span class="ident" id="6109140">s</span><span class="op" id="6109141">.</span><span class="ident" id="6109142">Results</span>&nbsp;<span class="op" id="6109150">!=</span>&nbsp;<span class="ident" id="6109153">nil</span>&nbsp;<span class="op" id="6109157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109162">p</span><span class="op" id="6109163">.</span><span class="builtinfunc" id="6109164">print</span><span class="op" id="6109169">(</span><span class="ident" id="6109170">blank</span><span class="op" id="6109175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6109180">//&nbsp;Use&nbsp;indentList&nbsp;heuristic&nbsp;to&nbsp;make&nbsp;corner&nbsp;cases&nbsp;look</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6109237">//&nbsp;better&nbsp;(issue&nbsp;1207).&nbsp;A&nbsp;more&nbsp;systematic&nbsp;approach&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6109297">//&nbsp;always&nbsp;indent,&nbsp;but&nbsp;this&nbsp;would&nbsp;cause&nbsp;significant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6109351">//&nbsp;reformatting&nbsp;of&nbsp;the&nbsp;code&nbsp;base&nbsp;and&nbsp;not&nbsp;necessarily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6109407">//&nbsp;lead&nbsp;to&nbsp;more&nbsp;nicely&nbsp;formatted&nbsp;code&nbsp;in&nbsp;general.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109460">if</span>&nbsp;<span class="ident" id="6109463">p</span><span class="op" id="6109464">.</span><span class="ident" id="6109465">indentList</span><span class="op" id="6109475">(</span><span class="ident" id="6109476">s</span><span class="op" id="6109477">.</span><span class="ident" id="6109478">Results</span><span class="op" id="6109485">)</span>&nbsp;<span class="op" id="6109487">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109493">p</span><span class="op" id="6109494">.</span><span class="builtinfunc" id="6109495">print</span><span class="op" id="6109500">(</span><span class="ident" id="6109501">indent</span><span class="op" id="6109507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109513">p</span><span class="op" id="6109514">.</span><span class="ident" id="6109515">exprList</span><span class="op" id="6109523">(</span><span class="ident" id="6109524">s</span><span class="op" id="6109525">.</span><span class="ident" id="6109526">Pos</span><span class="op" id="6109529">(</span><span class="op" id="6109530">)</span><span class="op" id="6109531">,</span>&nbsp;<span class="ident" id="6109533">s</span><span class="op" id="6109534">.</span><span class="ident" id="6109535">Results</span><span class="op" id="6109542">,</span>&nbsp;<span class="num" id="6109544">1</span><span class="op" id="6109545">,</span>&nbsp;<span class="ident" id="6109547">noIndent</span><span class="op" id="6109555">,</span>&nbsp;<span class="ident" id="6109557">token</span><span class="op" id="6109562">.</span><span class="ident" id="6109563">NoPos</span><span class="op" id="6109568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109574">p</span><span class="op" id="6109575">.</span><span class="builtinfunc" id="6109576">print</span><span class="op" id="6109581">(</span><span class="ident" id="6109582">unindent</span><span class="op" id="6109590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6109595">}</span>&nbsp;<span class="keyword" id="6109597">else</span>&nbsp;<span class="op" id="6109602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109608">p</span><span class="op" id="6109609">.</span><span class="ident" id="6109610">exprList</span><span class="op" id="6109618">(</span><span class="ident" id="6109619">s</span><span class="op" id="6109620">.</span><span class="ident" id="6109621">Pos</span><span class="op" id="6109624">(</span><span class="op" id="6109625">)</span><span class="op" id="6109626">,</span>&nbsp;<span class="ident" id="6109628">s</span><span class="op" id="6109629">.</span><span class="ident" id="6109630">Results</span><span class="op" id="6109637">,</span>&nbsp;<span class="num" id="6109639">1</span><span class="op" id="6109640">,</span>&nbsp;<span class="num" id="6109642">0</span><span class="op" id="6109643">,</span>&nbsp;<span class="ident" id="6109645">token</span><span class="op" id="6109650">.</span><span class="ident" id="6109651">NoPos</span><span class="op" id="6109656">)</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6109661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6109665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109669">case</span>&nbsp;<span class="op" id="6109674">*</span><span class="ident" id="6109675">ast</span><span class="op" id="6109678">.</span><span class="ident" id="6109679">BranchStmt</span><span class="op" id="6109689">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109693">p</span><span class="op" id="6109694">.</span><span class="builtinfunc" id="6109695">print</span><span class="op" id="6109700">(</span><span class="ident" id="6109701">s</span><span class="op" id="6109702">.</span><span class="ident" id="6109703">Tok</span><span class="op" id="6109706">)</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109710">if</span>&nbsp;<span class="ident" id="6109713">s</span><span class="op" id="6109714">.</span><span class="ident" id="6109715">Label</span>&nbsp;<span class="op" id="6109721">!=</span>&nbsp;<span class="ident" id="6109724">nil</span>&nbsp;<span class="op" id="6109728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109733">p</span><span class="op" id="6109734">.</span><span class="builtinfunc" id="6109735">print</span><span class="op" id="6109740">(</span><span class="ident" id="6109741">blank</span><span class="op" id="6109746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109751">p</span><span class="op" id="6109752">.</span><span class="ident" id="6109753">expr</span><span class="op" id="6109757">(</span><span class="ident" id="6109758">s</span><span class="op" id="6109759">.</span><span class="ident" id="6109760">Label</span><span class="op" id="6109765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6109769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109773">case</span>&nbsp;<span class="op" id="6109778">*</span><span class="ident" id="6109779">ast</span><span class="op" id="6109782">.</span><span class="ident" id="6109783">BlockStmt</span><span class="op" id="6109792">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109796">p</span><span class="op" id="6109797">.</span><span class="ident" id="6109798">block</span><span class="op" id="6109803">(</span><span class="ident" id="6109804">s</span><span class="op" id="6109805">,</span>&nbsp;<span class="num" id="6109807">1</span><span class="op" id="6109808">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109812">case</span>&nbsp;<span class="op" id="6109817">*</span><span class="ident" id="6109818">ast</span><span class="op" id="6109821">.</span><span class="ident" id="6109822">IfStmt</span><span class="op" id="6109828">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109832">p</span><span class="op" id="6109833">.</span><span class="builtinfunc" id="6109834">print</span><span class="op" id="6109839">(</span><span class="ident" id="6109840">token</span><span class="op" id="6109845">.</span><span class="ident" id="6109846">IF</span><span class="op" id="6109848">)</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109852">p</span><span class="op" id="6109853">.</span><span class="ident" id="6109854">controlClause</span><span class="op" id="6109867">(</span><span class="builtintype" id="6109868">false</span><span class="op" id="6109873">,</span>&nbsp;<span class="ident" id="6109875">s</span><span class="op" id="6109876">.</span><span class="ident" id="6109877">Init</span><span class="op" id="6109881">,</span>&nbsp;<span class="ident" id="6109883">s</span><span class="op" id="6109884">.</span><span class="ident" id="6109885">Cond</span><span class="op" id="6109889">,</span>&nbsp;<span class="ident" id="6109891">nil</span><span class="op" id="6109894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109898">p</span><span class="op" id="6109899">.</span><span class="ident" id="6109900">block</span><span class="op" id="6109905">(</span><span class="ident" id="6109906">s</span><span class="op" id="6109907">.</span><span class="ident" id="6109908">Body</span><span class="op" id="6109912">,</span>&nbsp;<span class="num" id="6109914">1</span><span class="op" id="6109915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109919">if</span>&nbsp;<span class="ident" id="6109922">s</span><span class="op" id="6109923">.</span><span class="ident" id="6109924">Else</span>&nbsp;<span class="op" id="6109929">!=</span>&nbsp;<span class="ident" id="6109932">nil</span>&nbsp;<span class="op" id="6109936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109941">p</span><span class="op" id="6109942">.</span><span class="builtinfunc" id="6109943">print</span><span class="op" id="6109948">(</span><span class="ident" id="6109949">blank</span><span class="op" id="6109954">,</span>&nbsp;<span class="ident" id="6109956">token</span><span class="op" id="6109961">.</span><span class="ident" id="6109962">ELSE</span><span class="op" id="6109966">,</span>&nbsp;<span class="ident" id="6109968">blank</span><span class="op" id="6109973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109978">switch</span>&nbsp;<span class="ident" id="6109985">s</span><span class="op" id="6109986">.</span><span class="ident" id="6109987">Else</span><span class="op" id="6109991">.</span><span class="op" id="6109992">(</span><span class="keyword" id="6109993">type</span><span class="op" id="6109997">)</span>&nbsp;<span class="op" id="6109999">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110004">case</span>&nbsp;<span class="op" id="6110009">*</span><span class="ident" id="6110010">ast</span><span class="op" id="6110013">.</span><span class="ident" id="6110014">BlockStmt</span><span class="op" id="6110023">,</span>&nbsp;<span class="op" id="6110025">*</span><span class="ident" id="6110026">ast</span><span class="op" id="6110029">.</span><span class="ident" id="6110030">IfStmt</span><span class="op" id="6110036">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110042">p</span><span class="op" id="6110043">.</span><span class="ident" id="6110044">stmt</span><span class="op" id="6110048">(</span><span class="ident" id="6110049">s</span><span class="op" id="6110050">.</span><span class="ident" id="6110051">Else</span><span class="op" id="6110055">,</span>&nbsp;<span class="ident" id="6110057">nextIsRBrace</span><span class="op" id="6110069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110074">default</span><span class="op" id="6110081">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110087">p</span><span class="op" id="6110088">.</span><span class="builtinfunc" id="6110089">print</span><span class="op" id="6110094">(</span><span class="ident" id="6110095">token</span><span class="op" id="6110100">.</span><span class="ident" id="6110101">LBRACE</span><span class="op" id="6110107">,</span>&nbsp;<span class="ident" id="6110109">indent</span><span class="op" id="6110115">,</span>&nbsp;<span class="ident" id="6110117">formfeed</span><span class="op" id="6110125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110131">p</span><span class="op" id="6110132">.</span><span class="ident" id="6110133">stmt</span><span class="op" id="6110137">(</span><span class="ident" id="6110138">s</span><span class="op" id="6110139">.</span><span class="ident" id="6110140">Else</span><span class="op" id="6110144">,</span>&nbsp;<span class="builtintype" id="6110146">true</span><span class="op" id="6110150">)</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110156">p</span><span class="op" id="6110157">.</span><span class="builtinfunc" id="6110158">print</span><span class="op" id="6110163">(</span><span class="ident" id="6110164">unindent</span><span class="op" id="6110172">,</span>&nbsp;<span class="ident" id="6110174">formfeed</span><span class="op" id="6110182">,</span>&nbsp;<span class="ident" id="6110184">token</span><span class="op" id="6110189">.</span><span class="ident" id="6110190">RBRACE</span><span class="op" id="6110196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6110201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6110205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110209">case</span>&nbsp;<span class="op" id="6110214">*</span><span class="ident" id="6110215">ast</span><span class="op" id="6110218">.</span><span class="ident" id="6110219">CaseClause</span><span class="op" id="6110229">:</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110233">if</span>&nbsp;<span class="ident" id="6110236">s</span><span class="op" id="6110237">.</span><span class="ident" id="6110238">List</span>&nbsp;<span class="op" id="6110243">!=</span>&nbsp;<span class="ident" id="6110246">nil</span>&nbsp;<span class="op" id="6110250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110255">p</span><span class="op" id="6110256">.</span><span class="builtinfunc" id="6110257">print</span><span class="op" id="6110262">(</span><span class="ident" id="6110263">token</span><span class="op" id="6110268">.</span><span class="ident" id="6110269">CASE</span><span class="op" id="6110273">,</span>&nbsp;<span class="ident" id="6110275">blank</span><span class="op" id="6110280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110285">p</span><span class="op" id="6110286">.</span><span class="ident" id="6110287">exprList</span><span class="op" id="6110295">(</span><span class="ident" id="6110296">s</span><span class="op" id="6110297">.</span><span class="ident" id="6110298">Pos</span><span class="op" id="6110301">(</span><span class="op" id="6110302">)</span><span class="op" id="6110303">,</span>&nbsp;<span class="ident" id="6110305">s</span><span class="op" id="6110306">.</span><span class="ident" id="6110307">List</span><span class="op" id="6110311">,</span>&nbsp;<span class="num" id="6110313">1</span><span class="op" id="6110314">,</span>&nbsp;<span class="num" id="6110316">0</span><span class="op" id="6110317">,</span>&nbsp;<span class="ident" id="6110319">s</span><span class="op" id="6110320">.</span><span class="ident" id="6110321">Colon</span><span class="op" id="6110326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6110330">}</span>&nbsp;<span class="keyword" id="6110332">else</span>&nbsp;<span class="op" id="6110337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110342">p</span><span class="op" id="6110343">.</span><span class="builtinfunc" id="6110344">print</span><span class="op" id="6110349">(</span><span class="ident" id="6110350">token</span><span class="op" id="6110355">.</span><span class="ident" id="6110356">DEFAULT</span><span class="op" id="6110363">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6110367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110371">p</span><span class="op" id="6110372">.</span><span class="builtinfunc" id="6110373">print</span><span class="op" id="6110378">(</span><span class="ident" id="6110379">s</span><span class="op" id="6110380">.</span><span class="ident" id="6110381">Colon</span><span class="op" id="6110386">,</span>&nbsp;<span class="ident" id="6110388">token</span><span class="op" id="6110393">.</span><span class="ident" id="6110394">COLON</span><span class="op" id="6110399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110403">p</span><span class="op" id="6110404">.</span><span class="ident" id="6110405">stmtList</span><span class="op" id="6110413">(</span><span class="ident" id="6110414">s</span><span class="op" id="6110415">.</span><span class="ident" id="6110416">Body</span><span class="op" id="6110420">,</span>&nbsp;<span class="num" id="6110422">1</span><span class="op" id="6110423">,</span>&nbsp;<span class="ident" id="6110425">nextIsRBrace</span><span class="op" id="6110437">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110441">case</span>&nbsp;<span class="op" id="6110446">*</span><span class="ident" id="6110447">ast</span><span class="op" id="6110450">.</span><span class="ident" id="6110451">SwitchStmt</span><span class="op" id="6110461">:</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110465">p</span><span class="op" id="6110466">.</span><span class="builtinfunc" id="6110467">print</span><span class="op" id="6110472">(</span><span class="ident" id="6110473">token</span><span class="op" id="6110478">.</span><span class="ident" id="6110479">SWITCH</span><span class="op" id="6110485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110489">p</span><span class="op" id="6110490">.</span><span class="ident" id="6110491">controlClause</span><span class="op" id="6110504">(</span><span class="builtintype" id="6110505">false</span><span class="op" id="6110510">,</span>&nbsp;<span class="ident" id="6110512">s</span><span class="op" id="6110513">.</span><span class="ident" id="6110514">Init</span><span class="op" id="6110518">,</span>&nbsp;<span class="ident" id="6110520">s</span><span class="op" id="6110521">.</span><span class="ident" id="6110522">Tag</span><span class="op" id="6110525">,</span>&nbsp;<span class="ident" id="6110527">nil</span><span class="op" id="6110530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110534">p</span><span class="op" id="6110535">.</span><span class="ident" id="6110536">block</span><span class="op" id="6110541">(</span><span class="ident" id="6110542">s</span><span class="op" id="6110543">.</span><span class="ident" id="6110544">Body</span><span class="op" id="6110548">,</span>&nbsp;<span class="num" id="6110550">0</span><span class="op" id="6110551">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110555">case</span>&nbsp;<span class="op" id="6110560">*</span><span class="ident" id="6110561">ast</span><span class="op" id="6110564">.</span><span class="ident" id="6110565">TypeSwitchStmt</span><span class="op" id="6110579">:</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110583">p</span><span class="op" id="6110584">.</span><span class="builtinfunc" id="6110585">print</span><span class="op" id="6110590">(</span><span class="ident" id="6110591">token</span><span class="op" id="6110596">.</span><span class="ident" id="6110597">SWITCH</span><span class="op" id="6110603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110607">if</span>&nbsp;<span class="ident" id="6110610">s</span><span class="op" id="6110611">.</span><span class="ident" id="6110612">Init</span>&nbsp;<span class="op" id="6110617">!=</span>&nbsp;<span class="ident" id="6110620">nil</span>&nbsp;<span class="op" id="6110624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110629">p</span><span class="op" id="6110630">.</span><span class="builtinfunc" id="6110631">print</span><span class="op" id="6110636">(</span><span class="ident" id="6110637">blank</span><span class="op" id="6110642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110647">p</span><span class="op" id="6110648">.</span><span class="ident" id="6110649">stmt</span><span class="op" id="6110653">(</span><span class="ident" id="6110654">s</span><span class="op" id="6110655">.</span><span class="ident" id="6110656">Init</span><span class="op" id="6110660">,</span>&nbsp;<span class="builtintype" id="6110662">false</span><span class="op" id="6110667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110672">p</span><span class="op" id="6110673">.</span><span class="builtinfunc" id="6110674">print</span><span class="op" id="6110679">(</span><span class="ident" id="6110680">token</span><span class="op" id="6110685">.</span><span class="ident" id="6110686">SEMICOLON</span><span class="op" id="6110695">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6110699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110703">p</span><span class="op" id="6110704">.</span><span class="builtinfunc" id="6110705">print</span><span class="op" id="6110710">(</span><span class="ident" id="6110711">blank</span><span class="op" id="6110716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110720">p</span><span class="op" id="6110721">.</span><span class="ident" id="6110722">stmt</span><span class="op" id="6110726">(</span><span class="ident" id="6110727">s</span><span class="op" id="6110728">.</span><span class="ident" id="6110729">Assign</span><span class="op" id="6110735">,</span>&nbsp;<span class="builtintype" id="6110737">false</span><span class="op" id="6110742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110746">p</span><span class="op" id="6110747">.</span><span class="builtinfunc" id="6110748">print</span><span class="op" id="6110753">(</span><span class="ident" id="6110754">blank</span><span class="op" id="6110759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110763">p</span><span class="op" id="6110764">.</span><span class="ident" id="6110765">block</span><span class="op" id="6110770">(</span><span class="ident" id="6110771">s</span><span class="op" id="6110772">.</span><span class="ident" id="6110773">Body</span><span class="op" id="6110777">,</span>&nbsp;<span class="num" id="6110779">0</span><span class="op" id="6110780">)</span><br>
<span class="lineno">1195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110784">case</span>&nbsp;<span class="op" id="6110789">*</span><span class="ident" id="6110790">ast</span><span class="op" id="6110793">.</span><span class="ident" id="6110794">CommClause</span><span class="op" id="6110804">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110808">if</span>&nbsp;<span class="ident" id="6110811">s</span><span class="op" id="6110812">.</span><span class="ident" id="6110813">Comm</span>&nbsp;<span class="op" id="6110818">!=</span>&nbsp;<span class="ident" id="6110821">nil</span>&nbsp;<span class="op" id="6110825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110830">p</span><span class="op" id="6110831">.</span><span class="builtinfunc" id="6110832">print</span><span class="op" id="6110837">(</span><span class="ident" id="6110838">token</span><span class="op" id="6110843">.</span><span class="ident" id="6110844">CASE</span><span class="op" id="6110848">,</span>&nbsp;<span class="ident" id="6110850">blank</span><span class="op" id="6110855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110860">p</span><span class="op" id="6110861">.</span><span class="ident" id="6110862">stmt</span><span class="op" id="6110866">(</span><span class="ident" id="6110867">s</span><span class="op" id="6110868">.</span><span class="ident" id="6110869">Comm</span><span class="op" id="6110873">,</span>&nbsp;<span class="builtintype" id="6110875">false</span><span class="op" id="6110880">)</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6110884">}</span>&nbsp;<span class="keyword" id="6110886">else</span>&nbsp;<span class="op" id="6110891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110896">p</span><span class="op" id="6110897">.</span><span class="builtinfunc" id="6110898">print</span><span class="op" id="6110903">(</span><span class="ident" id="6110904">token</span><span class="op" id="6110909">.</span><span class="ident" id="6110910">DEFAULT</span><span class="op" id="6110917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6110921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110925">p</span><span class="op" id="6110926">.</span><span class="builtinfunc" id="6110927">print</span><span class="op" id="6110932">(</span><span class="ident" id="6110933">s</span><span class="op" id="6110934">.</span><span class="ident" id="6110935">Colon</span><span class="op" id="6110940">,</span>&nbsp;<span class="ident" id="6110942">token</span><span class="op" id="6110947">.</span><span class="ident" id="6110948">COLON</span><span class="op" id="6110953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110957">p</span><span class="op" id="6110958">.</span><span class="ident" id="6110959">stmtList</span><span class="op" id="6110967">(</span><span class="ident" id="6110968">s</span><span class="op" id="6110969">.</span><span class="ident" id="6110970">Body</span><span class="op" id="6110974">,</span>&nbsp;<span class="num" id="6110976">1</span><span class="op" id="6110977">,</span>&nbsp;<span class="ident" id="6110979">nextIsRBrace</span><span class="op" id="6110991">)</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110995">case</span>&nbsp;<span class="op" id="6111000">*</span><span class="ident" id="6111001">ast</span><span class="op" id="6111004">.</span><span class="ident" id="6111005">SelectStmt</span><span class="op" id="6111015">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111019">p</span><span class="op" id="6111020">.</span><span class="builtinfunc" id="6111021">print</span><span class="op" id="6111026">(</span><span class="ident" id="6111027">token</span><span class="op" id="6111032">.</span><span class="ident" id="6111033">SELECT</span><span class="op" id="6111039">,</span>&nbsp;<span class="ident" id="6111041">blank</span><span class="op" id="6111046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111050">body</span>&nbsp;<span class="op" id="6111055">:=</span>&nbsp;<span class="ident" id="6111058">s</span><span class="op" id="6111059">.</span><span class="ident" id="6111060">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111067">if</span>&nbsp;<span class="builtinfunc" id="6111070">len</span><span class="op" id="6111073">(</span><span class="ident" id="6111074">body</span><span class="op" id="6111078">.</span><span class="ident" id="6111079">List</span><span class="op" id="6111083">)</span>&nbsp;<span class="op" id="6111085">==</span>&nbsp;<span class="num" id="6111088">0</span>&nbsp;<span class="op" id="6111090">&amp;&amp;</span>&nbsp;<span class="op" id="6111093">!</span><span class="ident" id="6111094">p</span><span class="op" id="6111095">.</span><span class="ident" id="6111096">commentBefore</span><span class="op" id="6111109">(</span><span class="ident" id="6111110">p</span><span class="op" id="6111111">.</span><span class="ident" id="6111112">posFor</span><span class="op" id="6111118">(</span><span class="ident" id="6111119">body</span><span class="op" id="6111123">.</span><span class="ident" id="6111124">Rbrace</span><span class="op" id="6111130">)</span><span class="op" id="6111131">)</span>&nbsp;<span class="op" id="6111133">{</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6111138">//&nbsp;print&nbsp;empty&nbsp;select&nbsp;statement&nbsp;w/o&nbsp;comments&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111198">p</span><span class="op" id="6111199">.</span><span class="builtinfunc" id="6111200">print</span><span class="op" id="6111205">(</span><span class="ident" id="6111206">body</span><span class="op" id="6111210">.</span><span class="ident" id="6111211">Lbrace</span><span class="op" id="6111217">,</span>&nbsp;<span class="ident" id="6111219">token</span><span class="op" id="6111224">.</span><span class="ident" id="6111225">LBRACE</span><span class="op" id="6111231">,</span>&nbsp;<span class="ident" id="6111233">body</span><span class="op" id="6111237">.</span><span class="ident" id="6111238">Rbrace</span><span class="op" id="6111244">,</span>&nbsp;<span class="ident" id="6111246">token</span><span class="op" id="6111251">.</span><span class="ident" id="6111252">RBRACE</span><span class="op" id="6111258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111262">}</span>&nbsp;<span class="keyword" id="6111264">else</span>&nbsp;<span class="op" id="6111269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111274">p</span><span class="op" id="6111275">.</span><span class="ident" id="6111276">block</span><span class="op" id="6111281">(</span><span class="ident" id="6111282">body</span><span class="op" id="6111286">,</span>&nbsp;<span class="num" id="6111288">0</span><span class="op" id="6111289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111293">}</span><br>
<span class="lineno">1215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111297">case</span>&nbsp;<span class="op" id="6111302">*</span><span class="ident" id="6111303">ast</span><span class="op" id="6111306">.</span><span class="ident" id="6111307">ForStmt</span><span class="op" id="6111314">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111318">p</span><span class="op" id="6111319">.</span><span class="builtinfunc" id="6111320">print</span><span class="op" id="6111325">(</span><span class="ident" id="6111326">token</span><span class="op" id="6111331">.</span><span class="ident" id="6111332">FOR</span><span class="op" id="6111335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111339">p</span><span class="op" id="6111340">.</span><span class="ident" id="6111341">controlClause</span><span class="op" id="6111354">(</span><span class="builtintype" id="6111355">true</span><span class="op" id="6111359">,</span>&nbsp;<span class="ident" id="6111361">s</span><span class="op" id="6111362">.</span><span class="ident" id="6111363">Init</span><span class="op" id="6111367">,</span>&nbsp;<span class="ident" id="6111369">s</span><span class="op" id="6111370">.</span><span class="ident" id="6111371">Cond</span><span class="op" id="6111375">,</span>&nbsp;<span class="ident" id="6111377">s</span><span class="op" id="6111378">.</span><span class="ident" id="6111379">Post</span><span class="op" id="6111383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111387">p</span><span class="op" id="6111388">.</span><span class="ident" id="6111389">block</span><span class="op" id="6111394">(</span><span class="ident" id="6111395">s</span><span class="op" id="6111396">.</span><span class="ident" id="6111397">Body</span><span class="op" id="6111401">,</span>&nbsp;<span class="num" id="6111403">1</span><span class="op" id="6111404">)</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111408">case</span>&nbsp;<span class="op" id="6111413">*</span><span class="ident" id="6111414">ast</span><span class="op" id="6111417">.</span><span class="ident" id="6111418">RangeStmt</span><span class="op" id="6111427">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111431">p</span><span class="op" id="6111432">.</span><span class="builtinfunc" id="6111433">print</span><span class="op" id="6111438">(</span><span class="ident" id="6111439">token</span><span class="op" id="6111444">.</span><span class="ident" id="6111445">FOR</span><span class="op" id="6111448">,</span>&nbsp;<span class="ident" id="6111450">blank</span><span class="op" id="6111455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111459">if</span>&nbsp;<span class="ident" id="6111462">s</span><span class="op" id="6111463">.</span><span class="ident" id="6111464">Key</span>&nbsp;<span class="op" id="6111468">!=</span>&nbsp;<span class="ident" id="6111471">nil</span>&nbsp;<span class="op" id="6111475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111480">p</span><span class="op" id="6111481">.</span><span class="ident" id="6111482">expr</span><span class="op" id="6111486">(</span><span class="ident" id="6111487">s</span><span class="op" id="6111488">.</span><span class="ident" id="6111489">Key</span><span class="op" id="6111492">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111497">if</span>&nbsp;<span class="ident" id="6111500">s</span><span class="op" id="6111501">.</span><span class="ident" id="6111502">Value</span>&nbsp;<span class="op" id="6111508">!=</span>&nbsp;<span class="ident" id="6111511">nil</span>&nbsp;<span class="op" id="6111515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6111521">//&nbsp;use&nbsp;position&nbsp;of&nbsp;value&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6111573">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111625">p</span><span class="op" id="6111626">.</span><span class="builtinfunc" id="6111627">print</span><span class="op" id="6111632">(</span><span class="ident" id="6111633">s</span><span class="op" id="6111634">.</span><span class="ident" id="6111635">Value</span><span class="op" id="6111640">.</span><span class="ident" id="6111641">Pos</span><span class="op" id="6111644">(</span><span class="op" id="6111645">)</span><span class="op" id="6111646">,</span>&nbsp;<span class="ident" id="6111648">token</span><span class="op" id="6111653">.</span><span class="ident" id="6111654">COMMA</span><span class="op" id="6111659">,</span>&nbsp;<span class="ident" id="6111661">blank</span><span class="op" id="6111666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111672">p</span><span class="op" id="6111673">.</span><span class="ident" id="6111674">expr</span><span class="op" id="6111678">(</span><span class="ident" id="6111679">s</span><span class="op" id="6111680">.</span><span class="ident" id="6111681">Value</span><span class="op" id="6111686">)</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111696">p</span><span class="op" id="6111697">.</span><span class="builtinfunc" id="6111698">print</span><span class="op" id="6111703">(</span><span class="ident" id="6111704">blank</span><span class="op" id="6111709">,</span>&nbsp;<span class="ident" id="6111711">s</span><span class="op" id="6111712">.</span><span class="ident" id="6111713">TokPos</span><span class="op" id="6111719">,</span>&nbsp;<span class="ident" id="6111721">s</span><span class="op" id="6111722">.</span><span class="ident" id="6111723">Tok</span><span class="op" id="6111726">,</span>&nbsp;<span class="ident" id="6111728">blank</span><span class="op" id="6111733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111741">p</span><span class="op" id="6111742">.</span><span class="builtinfunc" id="6111743">print</span><span class="op" id="6111748">(</span><span class="ident" id="6111749">token</span><span class="op" id="6111754">.</span><span class="ident" id="6111755">RANGE</span><span class="op" id="6111760">,</span>&nbsp;<span class="ident" id="6111762">blank</span><span class="op" id="6111767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111771">p</span><span class="op" id="6111772">.</span><span class="ident" id="6111773">expr</span><span class="op" id="6111777">(</span><span class="ident" id="6111778">stripParens</span><span class="op" id="6111789">(</span><span class="ident" id="6111790">s</span><span class="op" id="6111791">.</span><span class="ident" id="6111792">X</span><span class="op" id="6111793">)</span><span class="op" id="6111794">)</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111798">p</span><span class="op" id="6111799">.</span><span class="builtinfunc" id="6111800">print</span><span class="op" id="6111805">(</span><span class="ident" id="6111806">blank</span><span class="op" id="6111811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111815">p</span><span class="op" id="6111816">.</span><span class="ident" id="6111817">block</span><span class="op" id="6111822">(</span><span class="ident" id="6111823">s</span><span class="op" id="6111824">.</span><span class="ident" id="6111825">Body</span><span class="op" id="6111829">,</span>&nbsp;<span class="num" id="6111831">1</span><span class="op" id="6111832">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111836">default</span><span class="op" id="6111843">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6111847">panic</span><span class="op" id="6111852">(</span><span class="string" id="6111853">&#34;unreachable&#34;</span><span class="op" id="6111866">)</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111873">return</span><br>
<span class="lineno"></span><span class="op" id="6111880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1245</span><span class="comment" id="6111883">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="6111963">//&nbsp;Declarations</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6111980">//&nbsp;The&nbsp;keepTypeColumn&nbsp;function&nbsp;determines&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;of&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="6112056">//&nbsp;consecutive&nbsp;const&nbsp;or&nbsp;var&nbsp;declarations&nbsp;must&nbsp;be&nbsp;kept,&nbsp;or&nbsp;if&nbsp;initialization</span><br>
<span class="lineno">1250</span><span class="comment" id="6112132">//&nbsp;values&nbsp;(V)&nbsp;can&nbsp;be&nbsp;placed&nbsp;in&nbsp;the&nbsp;type&nbsp;column&nbsp;(T)&nbsp;instead.&nbsp;The&nbsp;i&#39;th&nbsp;entry</span><br>
<span class="lineno"></span><span class="comment" id="6112207">//&nbsp;in&nbsp;the&nbsp;result&nbsp;slice&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;in&nbsp;spec[i]&nbsp;must&nbsp;be&nbsp;kept.</span><br>
<span class="lineno"></span><span class="comment" id="6112282">//</span><br>
<span class="lineno"></span><span class="comment" id="6112285">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;declaration:</span><br>
<span class="lineno"></span><span class="comment" id="6112318">//</span><br>
<span class="lineno">1255</span><span class="comment" id="6112321">//&nbsp;&nbsp;&nbsp;&nbspconst&nbsp;(</span><br>
<span class="lineno"></span><span class="comment" id="6112332">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspfoobar&nbsp;int&nbsp;=&nbsp;42&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="6112363">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7&nbsp;&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="6112394">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspfoo</span><br>
<span class="lineno"></span><span class="comment" id="6112402">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bar&nbsp;=&nbsp;991</span><br>
<span class="lineno">1260</span><span class="comment" id="6112428">//&nbsp;&nbsp;&nbsp;&nbsp)</span><br>
<span class="lineno"></span><span class="comment" id="6112433">//</span><br>
<span class="lineno"></span><span class="comment" id="6112436">//&nbsp;leads&nbsp;to&nbsp;the&nbsp;type/values&nbsp;matrix&nbsp;below.&nbsp;A&nbsp;run&nbsp;of&nbsp;value&nbsp;columns&nbsp;(V)&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="6112509">//&nbsp;be&nbsp;moved&nbsp;into&nbsp;the&nbsp;type&nbsp;column&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;type&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="6112584">//&nbsp;in&nbsp;that&nbsp;column&nbsp;(we&nbsp;only&nbsp;move&nbsp;entire&nbsp;columns&nbsp;so&nbsp;that&nbsp;they&nbsp;align&nbsp;properly).</span><br>
<span class="lineno">1265</span><span class="comment" id="6112661">//</span><br>
<span class="lineno"></span><span class="comment" id="6112664">//&nbsp;&nbsp;&nbsp;&nbspmatrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatted&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result</span><br>
<span class="lineno"></span><span class="comment" id="6112702">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix</span><br>
<span class="lineno"></span><span class="comment" id="6112731">//&nbsp;&nbsp;&nbsp;&nbspT&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;a&nbsp;T&nbsp;and&nbsp;so&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="6112801">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno">1270</span><span class="comment" id="6112862">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="6112899">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;is&nbsp;moved&nbsp;into&nbsp;T&nbsp;column</span><br>
<span class="lineno"></span><span class="comment" id="6112965">//</span><br>
<span class="lineno"></span><span class="keyword" id="6112968">func</span>&nbsp;<span class="ident" id="6112973">keepTypeColumn</span><span class="op" id="6112987">(</span><span class="ident" id="6112988">specs</span>&nbsp;<span class="op" id="6112994">[</span><span class="op" id="6112995">]</span><span class="ident" id="6112996">ast</span><span class="op" id="6112999">.</span><span class="ident" id="6113000">Spec</span><span class="op" id="6113004">)</span>&nbsp;<span class="op" id="6113006">[</span><span class="op" id="6113007">]</span><span class="builtintype" id="6113008">bool</span>&nbsp;<span class="op" id="6113013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113016">m</span>&nbsp;<span class="op" id="6113018">:=</span>&nbsp;<span class="builtinfunc" id="6113021">make</span><span class="op" id="6113025">(</span><span class="op" id="6113026">[</span><span class="op" id="6113027">]</span><span class="builtintype" id="6113028">bool</span><span class="op" id="6113032">,</span>&nbsp;<span class="builtinfunc" id="6113034">len</span><span class="op" id="6113037">(</span><span class="ident" id="6113038">specs</span><span class="op" id="6113043">)</span><span class="op" id="6113044">)</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113048">populate</span>&nbsp;<span class="op" id="6113057">:=</span>&nbsp;<span class="keyword" id="6113060">func</span><span class="op" id="6113064">(</span><span class="ident" id="6113065">i</span><span class="op" id="6113066">,</span>&nbsp;<span class="ident" id="6113068">j</span>&nbsp;<span class="builtintype" id="6113070">int</span><span class="op" id="6113073">,</span>&nbsp;<span class="ident" id="6113075">keepType</span>&nbsp;<span class="builtintype" id="6113084">bool</span><span class="op" id="6113088">)</span>&nbsp;<span class="op" id="6113090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6113094">if</span>&nbsp;<span class="ident" id="6113097">keepType</span>&nbsp;<span class="op" id="6113106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6113111">for</span>&nbsp;<span class="op" id="6113115">;</span>&nbsp;<span class="ident" id="6113117">i</span>&nbsp;<span class="op" id="6113119">&lt;</span>&nbsp;<span class="ident" id="6113121">j</span><span class="op" id="6113122">;</span>&nbsp;<span class="ident" id="6113124">i</span><span class="op" id="6113125">++</span>&nbsp;<span class="op" id="6113128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113134">m</span><span class="op" id="6113135">[</span><span class="ident" id="6113136">i</span><span class="op" id="6113137">]</span>&nbsp;<span class="op" id="6113139">=</span>&nbsp;<span class="builtintype" id="6113141">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6113149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6113153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6113156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113160">i0</span>&nbsp;<span class="op" id="6113163">:=</span>&nbsp;<span class="op" id="6113166">-</span><span class="num" id="6113167">1</span>&nbsp;<span class="comment" id="6113169">//&nbsp;if&nbsp;i0&nbsp;&gt;=&nbsp;0&nbsp;we&nbsp;are&nbsp;in&nbsp;a&nbsp;run&nbsp;and&nbsp;i0&nbsp;is&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;run</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6113231">var</span>&nbsp;<span class="ident" id="6113235">keepType</span>&nbsp;<span class="builtintype" id="6113244">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6113250">for</span>&nbsp;<span class="ident" id="6113254">i</span><span class="op" id="6113255">,</span>&nbsp;<span class="ident" id="6113257">s</span>&nbsp;<span class="op" id="6113259">:=</span>&nbsp;<span class="keyword" id="6113262">range</span>&nbsp;<span class="ident" id="6113268">specs</span>&nbsp;<span class="op" id="6113274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113278">t</span>&nbsp;<span class="op" id="6113280">:=</span>&nbsp;<span class="ident" id="6113283">s</span><span class="op" id="6113284">.</span><span class="op" id="6113285">(</span><span class="op" id="6113286">*</span><span class="ident" id="6113287">ast</span><span class="op" id="6113290">.</span><span class="ident" id="6113291">ValueSpec</span><span class="op" id="6113300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6113304">if</span>&nbsp;<span class="ident" id="6113307">t</span><span class="op" id="6113308">.</span><span class="ident" id="6113309">Values</span>&nbsp;<span class="op" id="6113316">!=</span>&nbsp;<span class="ident" id="6113319">nil</span>&nbsp;<span class="op" id="6113323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6113328">if</span>&nbsp;<span class="ident" id="6113331">i0</span>&nbsp;<span class="op" id="6113334">&lt;</span>&nbsp;<span class="num" id="6113336">0</span>&nbsp;<span class="op" id="6113338">{</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6113344">//&nbsp;start&nbsp;of&nbsp;a&nbsp;run&nbsp;of&nbsp;ValueSpecs&nbsp;with&nbsp;non-nil&nbsp;Values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113400">i0</span>&nbsp;<span class="op" id="6113403">=</span>&nbsp;<span class="ident" id="6113405">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113411">keepType</span>&nbsp;<span class="op" id="6113420">=</span>&nbsp;<span class="builtintype" id="6113422">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6113431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6113435">}</span>&nbsp;<span class="keyword" id="6113437">else</span>&nbsp;<span class="op" id="6113442">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6113447">if</span>&nbsp;<span class="ident" id="6113450">i0</span>&nbsp;<span class="op" id="6113453">&gt;=</span>&nbsp;<span class="num" id="6113456">0</span>&nbsp;<span class="op" id="6113458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6113464">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113484">populate</span><span class="op" id="6113492">(</span><span class="ident" id="6113493">i0</span><span class="op" id="6113495">,</span>&nbsp;<span class="ident" id="6113497">i</span><span class="op" id="6113498">,</span>&nbsp;<span class="ident" id="6113500">keepType</span><span class="op" id="6113508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113514">i0</span>&nbsp;<span class="op" id="6113517">=</span>&nbsp;<span class="op" id="6113519">-</span><span class="num" id="6113520">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6113525">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6113529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6113533">if</span>&nbsp;<span class="ident" id="6113536">t</span><span class="op" id="6113537">.</span><span class="ident" id="6113538">Type</span>&nbsp;<span class="op" id="6113543">!=</span>&nbsp;<span class="ident" id="6113546">nil</span>&nbsp;<span class="op" id="6113550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113555">keepType</span>&nbsp;<span class="op" id="6113564">=</span>&nbsp;<span class="builtintype" id="6113566">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6113573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6113576">}</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6113579">if</span>&nbsp;<span class="ident" id="6113582">i0</span>&nbsp;<span class="op" id="6113585">&gt;=</span>&nbsp;<span class="num" id="6113588">0</span>&nbsp;<span class="op" id="6113590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6113594">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113612">populate</span><span class="op" id="6113620">(</span><span class="ident" id="6113621">i0</span><span class="op" id="6113623">,</span>&nbsp;<span class="builtinfunc" id="6113625">len</span><span class="op" id="6113628">(</span><span class="ident" id="6113629">specs</span><span class="op" id="6113634">)</span><span class="op" id="6113635">,</span>&nbsp;<span class="ident" id="6113637">keepType</span><span class="op" id="6113645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6113648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6113652">return</span>&nbsp;<span class="ident" id="6113659">m</span><br>
<span class="lineno"></span><span class="op" id="6113661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6113664">func</span>&nbsp;<span class="op" id="6113669">(</span><span class="ident" id="6113670">p</span>&nbsp;<span class="op" id="6113672">*</span><span class="ident" id="6113673">printer</span><span class="op" id="6113680">)</span>&nbsp;<span class="ident" id="6113682">valueSpec</span><span class="op" id="6113691">(</span><span class="ident" id="6113692">s</span>&nbsp;<span class="op" id="6113694">*</span><span class="ident" id="6113695">ast</span><span class="op" id="6113698">.</span><span class="ident" id="6113699">ValueSpec</span><span class="op" id="6113708">,</span>&nbsp;<span class="ident" id="6113710">keepType</span>&nbsp;<span class="builtintype" id="6113719">bool</span><span class="op" id="6113723">)</span>&nbsp;<span class="op" id="6113725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113728">p</span><span class="op" id="6113729">.</span><span class="ident" id="6113730">setComment</span><span class="op" id="6113740">(</span><span class="ident" id="6113741">s</span><span class="op" id="6113742">.</span><span class="ident" id="6113743">Doc</span><span class="op" id="6113746">)</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113749">p</span><span class="op" id="6113750">.</span><span class="ident" id="6113751">identList</span><span class="op" id="6113760">(</span><span class="ident" id="6113761">s</span><span class="op" id="6113762">.</span><span class="ident" id="6113763">Names</span><span class="op" id="6113768">,</span>&nbsp;<span class="builtintype" id="6113770">false</span><span class="op" id="6113775">)</span>&nbsp;<span class="comment" id="6113777">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113796">extraTabs</span>&nbsp;<span class="op" id="6113806">:=</span>&nbsp;<span class="num" id="6113809">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6113812">if</span>&nbsp;<span class="ident" id="6113815">s</span><span class="op" id="6113816">.</span><span class="ident" id="6113817">Type</span>&nbsp;<span class="op" id="6113822">!=</span>&nbsp;<span class="ident" id="6113825">nil</span>&nbsp;<span class="op" id="6113829">||</span>&nbsp;<span class="ident" id="6113832">keepType</span>&nbsp;<span class="op" id="6113841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113845">p</span><span class="op" id="6113846">.</span><span class="builtinfunc" id="6113847">print</span><span class="op" id="6113852">(</span><span class="ident" id="6113853">vtab</span><span class="op" id="6113857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113861">extraTabs</span><span class="op" id="6113870">--</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6113874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6113877">if</span>&nbsp;<span class="ident" id="6113880">s</span><span class="op" id="6113881">.</span><span class="ident" id="6113882">Type</span>&nbsp;<span class="op" id="6113887">!=</span>&nbsp;<span class="ident" id="6113890">nil</span>&nbsp;<span class="op" id="6113894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113898">p</span><span class="op" id="6113899">.</span><span class="ident" id="6113900">expr</span><span class="op" id="6113904">(</span><span class="ident" id="6113905">s</span><span class="op" id="6113906">.</span><span class="ident" id="6113907">Type</span><span class="op" id="6113911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6113914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6113917">if</span>&nbsp;<span class="ident" id="6113920">s</span><span class="op" id="6113921">.</span><span class="ident" id="6113922">Values</span>&nbsp;<span class="op" id="6113929">!=</span>&nbsp;<span class="ident" id="6113932">nil</span>&nbsp;<span class="op" id="6113936">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113940">p</span><span class="op" id="6113941">.</span><span class="builtinfunc" id="6113942">print</span><span class="op" id="6113947">(</span><span class="ident" id="6113948">vtab</span><span class="op" id="6113952">,</span>&nbsp;<span class="ident" id="6113954">token</span><span class="op" id="6113959">.</span><span class="ident" id="6113960">ASSIGN</span><span class="op" id="6113966">,</span>&nbsp;<span class="ident" id="6113968">blank</span><span class="op" id="6113973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113977">p</span><span class="op" id="6113978">.</span><span class="ident" id="6113979">exprList</span><span class="op" id="6113987">(</span><span class="ident" id="6113988">token</span><span class="op" id="6113993">.</span><span class="ident" id="6113994">NoPos</span><span class="op" id="6113999">,</span>&nbsp;<span class="ident" id="6114001">s</span><span class="op" id="6114002">.</span><span class="ident" id="6114003">Values</span><span class="op" id="6114009">,</span>&nbsp;<span class="num" id="6114011">1</span><span class="op" id="6114012">,</span>&nbsp;<span class="num" id="6114014">0</span><span class="op" id="6114015">,</span>&nbsp;<span class="ident" id="6114017">token</span><span class="op" id="6114022">.</span><span class="ident" id="6114023">NoPos</span><span class="op" id="6114028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114032">extraTabs</span><span class="op" id="6114041">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6114045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6114048">if</span>&nbsp;<span class="ident" id="6114051">s</span><span class="op" id="6114052">.</span><span class="ident" id="6114053">Comment</span>&nbsp;<span class="op" id="6114061">!=</span>&nbsp;<span class="ident" id="6114064">nil</span>&nbsp;<span class="op" id="6114068">{</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6114072">for</span>&nbsp;<span class="op" id="6114076">;</span>&nbsp;<span class="ident" id="6114078">extraTabs</span>&nbsp;<span class="op" id="6114088">&gt;</span>&nbsp;<span class="num" id="6114090">0</span><span class="op" id="6114091">;</span>&nbsp;<span class="ident" id="6114093">extraTabs</span><span class="op" id="6114102">--</span>&nbsp;<span class="op" id="6114105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114110">p</span><span class="op" id="6114111">.</span><span class="builtinfunc" id="6114112">print</span><span class="op" id="6114117">(</span><span class="ident" id="6114118">vtab</span><span class="op" id="6114122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6114126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114130">p</span><span class="op" id="6114131">.</span><span class="ident" id="6114132">setComment</span><span class="op" id="6114142">(</span><span class="ident" id="6114143">s</span><span class="op" id="6114144">.</span><span class="ident" id="6114145">Comment</span><span class="op" id="6114152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6114155">}</span><br>
<span class="lineno">1335</span><span class="op" id="6114157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6114160">//&nbsp;The&nbsp;parameter&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;specs&nbsp;in&nbsp;the&nbsp;group.&nbsp;If&nbsp;doIndent&nbsp;is&nbsp;set,</span><br>
<span class="lineno"></span><span class="comment" id="6114236">//&nbsp;multi-line&nbsp;identifier&nbsp;lists&nbsp;in&nbsp;the&nbsp;spec&nbsp;are&nbsp;indented&nbsp;when&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="6114307">//&nbsp;linebreak&nbsp;is&nbsp;encountered.</span><br>
<span class="lineno">1340</span><span class="comment" id="6114336">//</span><br>
<span class="lineno"></span><span class="keyword" id="6114339">func</span>&nbsp;<span class="op" id="6114344">(</span><span class="ident" id="6114345">p</span>&nbsp;<span class="op" id="6114347">*</span><span class="ident" id="6114348">printer</span><span class="op" id="6114355">)</span>&nbsp;<span class="ident" id="6114357">spec</span><span class="op" id="6114361">(</span><span class="ident" id="6114362">spec</span>&nbsp;<span class="ident" id="6114367">ast</span><span class="op" id="6114370">.</span><span class="ident" id="6114371">Spec</span><span class="op" id="6114375">,</span>&nbsp;<span class="ident" id="6114377">n</span>&nbsp;<span class="builtintype" id="6114379">int</span><span class="op" id="6114382">,</span>&nbsp;<span class="ident" id="6114384">doIndent</span>&nbsp;<span class="builtintype" id="6114393">bool</span><span class="op" id="6114397">)</span>&nbsp;<span class="op" id="6114399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6114402">switch</span>&nbsp;<span class="ident" id="6114409">s</span>&nbsp;<span class="op" id="6114411">:=</span>&nbsp;<span class="ident" id="6114414">spec</span><span class="op" id="6114418">.</span><span class="op" id="6114419">(</span><span class="keyword" id="6114420">type</span><span class="op" id="6114424">)</span>&nbsp;<span class="op" id="6114426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6114429">case</span>&nbsp;<span class="op" id="6114434">*</span><span class="ident" id="6114435">ast</span><span class="op" id="6114438">.</span><span class="ident" id="6114439">ImportSpec</span><span class="op" id="6114449">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114453">p</span><span class="op" id="6114454">.</span><span class="ident" id="6114455">setComment</span><span class="op" id="6114465">(</span><span class="ident" id="6114466">s</span><span class="op" id="6114467">.</span><span class="ident" id="6114468">Doc</span><span class="op" id="6114471">)</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6114475">if</span>&nbsp;<span class="ident" id="6114478">s</span><span class="op" id="6114479">.</span><span class="ident" id="6114480">Name</span>&nbsp;<span class="op" id="6114485">!=</span>&nbsp;<span class="ident" id="6114488">nil</span>&nbsp;<span class="op" id="6114492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114497">p</span><span class="op" id="6114498">.</span><span class="ident" id="6114499">expr</span><span class="op" id="6114503">(</span><span class="ident" id="6114504">s</span><span class="op" id="6114505">.</span><span class="ident" id="6114506">Name</span><span class="op" id="6114510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114515">p</span><span class="op" id="6114516">.</span><span class="builtinfunc" id="6114517">print</span><span class="op" id="6114522">(</span><span class="ident" id="6114523">blank</span><span class="op" id="6114528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6114532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114536">p</span><span class="op" id="6114537">.</span><span class="ident" id="6114538">expr</span><span class="op" id="6114542">(</span><span class="ident" id="6114543">s</span><span class="op" id="6114544">.</span><span class="ident" id="6114545">Path</span><span class="op" id="6114549">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114553">p</span><span class="op" id="6114554">.</span><span class="ident" id="6114555">setComment</span><span class="op" id="6114565">(</span><span class="ident" id="6114566">s</span><span class="op" id="6114567">.</span><span class="ident" id="6114568">Comment</span><span class="op" id="6114575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114579">p</span><span class="op" id="6114580">.</span><span class="builtinfunc" id="6114581">print</span><span class="op" id="6114586">(</span><span class="ident" id="6114587">s</span><span class="op" id="6114588">.</span><span class="ident" id="6114589">EndPos</span><span class="op" id="6114595">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6114599">case</span>&nbsp;<span class="op" id="6114604">*</span><span class="ident" id="6114605">ast</span><span class="op" id="6114608">.</span><span class="ident" id="6114609">ValueSpec</span><span class="op" id="6114618">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6114622">if</span>&nbsp;<span class="ident" id="6114625">n</span>&nbsp;<span class="op" id="6114627">!=</span>&nbsp;<span class="num" id="6114630">1</span>&nbsp;<span class="op" id="6114632">{</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114637">p</span><span class="op" id="6114638">.</span><span class="ident" id="6114639">internalError</span><span class="op" id="6114652">(</span><span class="string" id="6114653">&#34;expected&nbsp;n&nbsp;=&nbsp;1;&nbsp;got&#34;</span><span class="op" id="6114674">,</span>&nbsp;<span class="ident" id="6114676">n</span><span class="op" id="6114677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6114681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114685">p</span><span class="op" id="6114686">.</span><span class="ident" id="6114687">setComment</span><span class="op" id="6114697">(</span><span class="ident" id="6114698">s</span><span class="op" id="6114699">.</span><span class="ident" id="6114700">Doc</span><span class="op" id="6114703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114707">p</span><span class="op" id="6114708">.</span><span class="ident" id="6114709">identList</span><span class="op" id="6114718">(</span><span class="ident" id="6114719">s</span><span class="op" id="6114720">.</span><span class="ident" id="6114721">Names</span><span class="op" id="6114726">,</span>&nbsp;<span class="ident" id="6114728">doIndent</span><span class="op" id="6114736">)</span>&nbsp;<span class="comment" id="6114738">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6114758">if</span>&nbsp;<span class="ident" id="6114761">s</span><span class="op" id="6114762">.</span><span class="ident" id="6114763">Type</span>&nbsp;<span class="op" id="6114768">!=</span>&nbsp;<span class="ident" id="6114771">nil</span>&nbsp;<span class="op" id="6114775">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114780">p</span><span class="op" id="6114781">.</span><span class="builtinfunc" id="6114782">print</span><span class="op" id="6114787">(</span><span class="ident" id="6114788">blank</span><span class="op" id="6114793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114798">p</span><span class="op" id="6114799">.</span><span class="ident" id="6114800">expr</span><span class="op" id="6114804">(</span><span class="ident" id="6114805">s</span><span class="op" id="6114806">.</span><span class="ident" id="6114807">Type</span><span class="op" id="6114811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6114815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6114819">if</span>&nbsp;<span class="ident" id="6114822">s</span><span class="op" id="6114823">.</span><span class="ident" id="6114824">Values</span>&nbsp;<span class="op" id="6114831">!=</span>&nbsp;<span class="ident" id="6114834">nil</span>&nbsp;<span class="op" id="6114838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114843">p</span><span class="op" id="6114844">.</span><span class="builtinfunc" id="6114845">print</span><span class="op" id="6114850">(</span><span class="ident" id="6114851">blank</span><span class="op" id="6114856">,</span>&nbsp;<span class="ident" id="6114858">token</span><span class="op" id="6114863">.</span><span class="ident" id="6114864">ASSIGN</span><span class="op" id="6114870">,</span>&nbsp;<span class="ident" id="6114872">blank</span><span class="op" id="6114877">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114882">p</span><span class="op" id="6114883">.</span><span class="ident" id="6114884">exprList</span><span class="op" id="6114892">(</span><span class="ident" id="6114893">token</span><span class="op" id="6114898">.</span><span class="ident" id="6114899">NoPos</span><span class="op" id="6114904">,</span>&nbsp;<span class="ident" id="6114906">s</span><span class="op" id="6114907">.</span><span class="ident" id="6114908">Values</span><span class="op" id="6114914">,</span>&nbsp;<span class="num" id="6114916">1</span><span class="op" id="6114917">,</span>&nbsp;<span class="num" id="6114919">0</span><span class="op" id="6114920">,</span>&nbsp;<span class="ident" id="6114922">token</span><span class="op" id="6114927">.</span><span class="ident" id="6114928">NoPos</span><span class="op" id="6114933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6114937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114941">p</span><span class="op" id="6114942">.</span><span class="ident" id="6114943">setComment</span><span class="op" id="6114953">(</span><span class="ident" id="6114954">s</span><span class="op" id="6114955">.</span><span class="ident" id="6114956">Comment</span><span class="op" id="6114963">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6114967">case</span>&nbsp;<span class="op" id="6114972">*</span><span class="ident" id="6114973">ast</span><span class="op" id="6114976">.</span><span class="ident" id="6114977">TypeSpec</span><span class="op" id="6114985">:</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114989">p</span><span class="op" id="6114990">.</span><span class="ident" id="6114991">setComment</span><span class="op" id="6115001">(</span><span class="ident" id="6115002">s</span><span class="op" id="6115003">.</span><span class="ident" id="6115004">Doc</span><span class="op" id="6115007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115011">p</span><span class="op" id="6115012">.</span><span class="ident" id="6115013">expr</span><span class="op" id="6115017">(</span><span class="ident" id="6115018">s</span><span class="op" id="6115019">.</span><span class="ident" id="6115020">Name</span><span class="op" id="6115024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6115028">if</span>&nbsp;<span class="ident" id="6115031">n</span>&nbsp;<span class="op" id="6115033">==</span>&nbsp;<span class="num" id="6115036">1</span>&nbsp;<span class="op" id="6115038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115043">p</span><span class="op" id="6115044">.</span><span class="builtinfunc" id="6115045">print</span><span class="op" id="6115050">(</span><span class="ident" id="6115051">blank</span><span class="op" id="6115056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6115060">}</span>&nbsp;<span class="keyword" id="6115062">else</span>&nbsp;<span class="op" id="6115067">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115072">p</span><span class="op" id="6115073">.</span><span class="builtinfunc" id="6115074">print</span><span class="op" id="6115079">(</span><span class="ident" id="6115080">vtab</span><span class="op" id="6115084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6115088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115092">p</span><span class="op" id="6115093">.</span><span class="ident" id="6115094">expr</span><span class="op" id="6115098">(</span><span class="ident" id="6115099">s</span><span class="op" id="6115100">.</span><span class="ident" id="6115101">Type</span><span class="op" id="6115105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115109">p</span><span class="op" id="6115110">.</span><span class="ident" id="6115111">setComment</span><span class="op" id="6115121">(</span><span class="ident" id="6115122">s</span><span class="op" id="6115123">.</span><span class="ident" id="6115124">Comment</span><span class="op" id="6115131">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6115135">default</span><span class="op" id="6115142">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6115146">panic</span><span class="op" id="6115151">(</span><span class="string" id="6115152">&#34;unreachable&#34;</span><span class="op" id="6115165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6115168">}</span><br>
<span class="lineno"></span><span class="op" id="6115170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1385</span><span class="keyword" id="6115173">func</span>&nbsp;<span class="op" id="6115178">(</span><span class="ident" id="6115179">p</span>&nbsp;<span class="op" id="6115181">*</span><span class="ident" id="6115182">printer</span><span class="op" id="6115189">)</span>&nbsp;<span class="ident" id="6115191">genDecl</span><span class="op" id="6115198">(</span><span class="ident" id="6115199">d</span>&nbsp;<span class="op" id="6115201">*</span><span class="ident" id="6115202">ast</span><span class="op" id="6115205">.</span><span class="ident" id="6115206">GenDecl</span><span class="op" id="6115213">)</span>&nbsp;<span class="op" id="6115215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115218">p</span><span class="op" id="6115219">.</span><span class="ident" id="6115220">setComment</span><span class="op" id="6115230">(</span><span class="ident" id="6115231">d</span><span class="op" id="6115232">.</span><span class="ident" id="6115233">Doc</span><span class="op" id="6115236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115239">p</span><span class="op" id="6115240">.</span><span class="builtinfunc" id="6115241">print</span><span class="op" id="6115246">(</span><span class="ident" id="6115247">d</span><span class="op" id="6115248">.</span><span class="ident" id="6115249">Pos</span><span class="op" id="6115252">(</span><span class="op" id="6115253">)</span><span class="op" id="6115254">,</span>&nbsp;<span class="ident" id="6115256">d</span><span class="op" id="6115257">.</span><span class="ident" id="6115258">Tok</span><span class="op" id="6115261">,</span>&nbsp;<span class="ident" id="6115263">blank</span><span class="op" id="6115268">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6115272">if</span>&nbsp;<span class="ident" id="6115275">d</span><span class="op" id="6115276">.</span><span class="ident" id="6115277">Lparen</span><span class="op" id="6115283">.</span><span class="ident" id="6115284">IsValid</span><span class="op" id="6115291">(</span><span class="op" id="6115292">)</span>&nbsp;<span class="op" id="6115294">{</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6115298">//&nbsp;group&nbsp;of&nbsp;parenthesized&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115339">p</span><span class="op" id="6115340">.</span><span class="builtinfunc" id="6115341">print</span><span class="op" id="6115346">(</span><span class="ident" id="6115347">d</span><span class="op" id="6115348">.</span><span class="ident" id="6115349">Lparen</span><span class="op" id="6115355">,</span>&nbsp;<span class="ident" id="6115357">token</span><span class="op" id="6115362">.</span><span class="ident" id="6115363">LPAREN</span><span class="op" id="6115369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6115373">if</span>&nbsp;<span class="ident" id="6115376">n</span>&nbsp;<span class="op" id="6115378">:=</span>&nbsp;<span class="builtinfunc" id="6115381">len</span><span class="op" id="6115384">(</span><span class="ident" id="6115385">d</span><span class="op" id="6115386">.</span><span class="ident" id="6115387">Specs</span><span class="op" id="6115392">)</span><span class="op" id="6115393">;</span>&nbsp;<span class="ident" id="6115395">n</span>&nbsp;<span class="op" id="6115397">&gt;</span>&nbsp;<span class="num" id="6115399">0</span>&nbsp;<span class="op" id="6115401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115406">p</span><span class="op" id="6115407">.</span><span class="builtinfunc" id="6115408">print</span><span class="op" id="6115413">(</span><span class="ident" id="6115414">indent</span><span class="op" id="6115420">,</span>&nbsp;<span class="ident" id="6115422">formfeed</span><span class="op" id="6115430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6115435">if</span>&nbsp;<span class="ident" id="6115438">n</span>&nbsp;<span class="op" id="6115440">&gt;</span>&nbsp;<span class="num" id="6115442">1</span>&nbsp;<span class="op" id="6115444">&amp;&amp;</span>&nbsp;<span class="op" id="6115447">(</span><span class="ident" id="6115448">d</span><span class="op" id="6115449">.</span><span class="ident" id="6115450">Tok</span>&nbsp;<span class="op" id="6115454">==</span>&nbsp;<span class="ident" id="6115457">token</span><span class="op" id="6115462">.</span><span class="ident" id="6115463">CONST</span>&nbsp;<span class="op" id="6115469">||</span>&nbsp;<span class="ident" id="6115472">d</span><span class="op" id="6115473">.</span><span class="ident" id="6115474">Tok</span>&nbsp;<span class="op" id="6115478">==</span>&nbsp;<span class="ident" id="6115481">token</span><span class="op" id="6115486">.</span><span class="ident" id="6115487">VAR</span><span class="op" id="6115490">)</span>&nbsp;<span class="op" id="6115492">{</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6115498">//&nbsp;two&nbsp;or&nbsp;more&nbsp;grouped&nbsp;const/var&nbsp;declarations:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6115549">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115598">keepType</span>&nbsp;<span class="op" id="6115607">:=</span>&nbsp;<span class="ident" id="6115610">keepTypeColumn</span><span class="op" id="6115624">(</span><span class="ident" id="6115625">d</span><span class="op" id="6115626">.</span><span class="ident" id="6115627">Specs</span><span class="op" id="6115632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6115638">var</span>&nbsp;<span class="ident" id="6115642">line</span>&nbsp;<span class="builtintype" id="6115647">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6115655">for</span>&nbsp;<span class="ident" id="6115659">i</span><span class="op" id="6115660">,</span>&nbsp;<span class="ident" id="6115662">s</span>&nbsp;<span class="op" id="6115664">:=</span>&nbsp;<span class="keyword" id="6115667">range</span>&nbsp;<span class="ident" id="6115673">d</span><span class="op" id="6115674">.</span><span class="ident" id="6115675">Specs</span>&nbsp;<span class="op" id="6115681">{</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6115688">if</span>&nbsp;<span class="ident" id="6115691">i</span>&nbsp;<span class="op" id="6115693">&gt;</span>&nbsp;<span class="num" id="6115695">0</span>&nbsp;<span class="op" id="6115697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115705">p</span><span class="op" id="6115706">.</span><span class="ident" id="6115707">linebreak</span><span class="op" id="6115716">(</span><span class="ident" id="6115717">p</span><span class="op" id="6115718">.</span><span class="ident" id="6115719">lineFor</span><span class="op" id="6115726">(</span><span class="ident" id="6115727">s</span><span class="op" id="6115728">.</span><span class="ident" id="6115729">Pos</span><span class="op" id="6115732">(</span><span class="op" id="6115733">)</span><span class="op" id="6115734">)</span><span class="op" id="6115735">,</span>&nbsp;<span class="num" id="6115737">1</span><span class="op" id="6115738">,</span>&nbsp;<span class="ident" id="6115740">ignore</span><span class="op" id="6115746">,</span>&nbsp;<span class="ident" id="6115748">p</span><span class="op" id="6115749">.</span><span class="ident" id="6115750">linesFrom</span><span class="op" id="6115759">(</span><span class="ident" id="6115760">line</span><span class="op" id="6115764">)</span>&nbsp;<span class="op" id="6115766">&gt;</span>&nbsp;<span class="num" id="6115768">0</span><span class="op" id="6115769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6115776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115783">p</span><span class="op" id="6115784">.</span><span class="ident" id="6115785">recordLine</span><span class="op" id="6115795">(</span><span class="op" id="6115796">&amp;</span><span class="ident" id="6115797">line</span><span class="op" id="6115801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115808">p</span><span class="op" id="6115809">.</span><span class="ident" id="6115810">valueSpec</span><span class="op" id="6115819">(</span><span class="ident" id="6115820">s</span><span class="op" id="6115821">.</span><span class="op" id="6115822">(</span><span class="op" id="6115823">*</span><span class="ident" id="6115824">ast</span><span class="op" id="6115827">.</span><span class="ident" id="6115828">ValueSpec</span><span class="op" id="6115837">)</span><span class="op" id="6115838">,</span>&nbsp;<span class="ident" id="6115840">keepType</span><span class="op" id="6115848">[</span><span class="ident" id="6115849">i</span><span class="op" id="6115850">]</span><span class="op" id="6115851">)</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6115857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6115862">}</span>&nbsp;<span class="keyword" id="6115864">else</span>&nbsp;<span class="op" id="6115869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6115875">var</span>&nbsp;<span class="ident" id="6115879">line</span>&nbsp;<span class="builtintype" id="6115884">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6115892">for</span>&nbsp;<span class="ident" id="6115896">i</span><span class="op" id="6115897">,</span>&nbsp;<span class="ident" id="6115899">s</span>&nbsp;<span class="op" id="6115901">:=</span>&nbsp;<span class="keyword" id="6115904">range</span>&nbsp;<span class="ident" id="6115910">d</span><span class="op" id="6115911">.</span><span class="ident" id="6115912">Specs</span>&nbsp;<span class="op" id="6115918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6115925">if</span>&nbsp;<span class="ident" id="6115928">i</span>&nbsp;<span class="op" id="6115930">&gt;</span>&nbsp;<span class="num" id="6115932">0</span>&nbsp;<span class="op" id="6115934">{</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115942">p</span><span class="op" id="6115943">.</span><span class="ident" id="6115944">linebreak</span><span class="op" id="6115953">(</span><span class="ident" id="6115954">p</span><span class="op" id="6115955">.</span><span class="ident" id="6115956">lineFor</span><span class="op" id="6115963">(</span><span class="ident" id="6115964">s</span><span class="op" id="6115965">.</span><span class="ident" id="6115966">Pos</span><span class="op" id="6115969">(</span><span class="op" id="6115970">)</span><span class="op" id="6115971">)</span><span class="op" id="6115972">,</span>&nbsp;<span class="num" id="6115974">1</span><span class="op" id="6115975">,</span>&nbsp;<span class="ident" id="6115977">ignore</span><span class="op" id="6115983">,</span>&nbsp;<span class="ident" id="6115985">p</span><span class="op" id="6115986">.</span><span class="ident" id="6115987">linesFrom</span><span class="op" id="6115996">(</span><span class="ident" id="6115997">line</span><span class="op" id="6116001">)</span>&nbsp;<span class="op" id="6116003">&gt;</span>&nbsp;<span class="num" id="6116005">0</span><span class="op" id="6116006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6116013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6116020">p</span><span class="op" id="6116021">.</span><span class="ident" id="6116022">recordLine</span><span class="op" id="6116032">(</span><span class="op" id="6116033">&amp;</span><span class="ident" id="6116034">line</span><span class="op" id="6116038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6116045">p</span><span class="op" id="6116046">.</span><span class="ident" id="6116047">spec</span><span class="op" id="6116051">(</span><span class="ident" id="6116052">s</span><span class="op" id="6116053">,</span>&nbsp;<span class="ident" id="6116055">n</span><span class="op" id="6116056">,</span>&nbsp;<span class="builtintype" id="6116058">false</span><span class="op" id="6116063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6116069">}</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6116074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6116079">p</span><span class="op" id="6116080">.</span><span class="builtinfunc" id="6116081">print</span><span class="op" id="6116086">(</span><span class="ident" id="6116087">unindent</span><span class="op" id="6116095">,</span>&nbsp;<span class="ident" id="6116097">formfeed</span><span class="op" id="6116105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6116109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6116113">p</span><span class="op" id="6116114">.</span><span class="builtinfunc" id="6116115">print</span><span class="op" id="6116120">(</span><span class="ident" id="6116121">d</span><span class="op" id="6116122">.</span><span class="ident" id="6116123">Rparen</span><span class="op" id="6116129">,</span>&nbsp;<span class="ident" id="6116131">token</span><span class="op" id="6116136">.</span><span class="ident" id="6116137">RPAREN</span><span class="op" id="6116143">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6116147">}</span>&nbsp;<span class="keyword" id="6116149">else</span>&nbsp;<span class="op" id="6116154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6116158">//&nbsp;single&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6116182">p</span><span class="op" id="6116183">.</span><span class="ident" id="6116184">spec</span><span class="op" id="6116188">(</span><span class="ident" id="6116189">d</span><span class="op" id="6116190">.</span><span class="ident" id="6116191">Specs</span><span class="op" id="6116196">[</span><span class="num" id="6116197">0</span><span class="op" id="6116198">]</span><span class="op" id="6116199">,</span>&nbsp;<span class="num" id="6116201">1</span><span class="op" id="6116202">,</span>&nbsp;<span class="builtintype" id="6116204">true</span><span class="op" id="6116208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6116211">}</span><br>
<span class="lineno"></span><span class="op" id="6116213">}</span><br>
<span class="lineno">1425</span><br>
<span class="lineno"></span><span class="comment" id="6116216">//&nbsp;nodeSize&nbsp;determines&nbsp;the&nbsp;size&nbsp;of&nbsp;n&nbsp;in&nbsp;chars&nbsp;after&nbsp;formatting.</span><br>
<span class="lineno"></span><span class="comment" id="6116280">//&nbsp;The&nbsp;result&nbsp;is&nbsp;&lt;=&nbsp;maxSize&nbsp;if&nbsp;the&nbsp;node&nbsp;fits&nbsp;on&nbsp;one&nbsp;line&nbsp;with&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="6116345">//&nbsp;most&nbsp;maxSize&nbsp;chars&nbsp;and&nbsp;the&nbsp;formatted&nbsp;output&nbsp;doesn&#39;t&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="6116408">//&nbsp;any&nbsp;control&nbsp;chars.&nbsp;Otherwise,&nbsp;the&nbsp;result&nbsp;is&nbsp;&gt;&nbsp;maxSize.</span><br>
<span class="lineno">1430</span><span class="comment" id="6116466">//</span><br>
<span class="lineno"></span><span class="keyword" id="6116469">func</span>&nbsp;<span class="op" id="6116474">(</span><span class="ident" id="6116475">p</span>&nbsp;<span class="op" id="6116477">*</span><span class="ident" id="6116478">printer</span><span class="op" id="6116485">)</span>&nbsp;<span class="ident" id="6116487">nodeSize</span><span class="op" id="6116495">(</span><span class="ident" id="6116496">n</span>&nbsp;<span class="ident" id="6116498">ast</span><span class="op" id="6116501">.</span><span class="ident" id="6116502">Node</span><span class="op" id="6116506">,</span>&nbsp;<span class="ident" id="6116508">maxSize</span>&nbsp;<span class="builtintype" id="6116516">int</span><span class="op" id="6116519">)</span>&nbsp;<span class="op" id="6116521">(</span><span class="ident" id="6116522">size</span>&nbsp;<span class="builtintype" id="6116527">int</span><span class="op" id="6116530">)</span>&nbsp;<span class="op" id="6116532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6116535">//&nbsp;nodeSize&nbsp;invokes&nbsp;the&nbsp;printer,&nbsp;which&nbsp;may&nbsp;invoke&nbsp;nodeSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6116595">//&nbsp;recursively.&nbsp;For&nbsp;deep&nbsp;composite&nbsp;literal&nbsp;nests,&nbsp;this&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6116655">//&nbsp;lead&nbsp;to&nbsp;an&nbsp;exponential&nbsp;algorithm.&nbsp;Remember&nbsp;previous</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6116711">//&nbsp;results&nbsp;to&nbsp;prune&nbsp;the&nbsp;recursion&nbsp;(was&nbsp;issue&nbsp;1628).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116764">if</span>&nbsp;<span class="ident" id="6116767">size</span><span class="op" id="6116771">,</span>&nbsp;<span class="ident" id="6116773">found</span>&nbsp;<span class="op" id="6116779">:=</span>&nbsp;<span class="ident" id="6116782">p</span><span class="op" id="6116783">.</span><span class="ident" id="6116784">nodeSizes</span><span class="op" id="6116793">[</span><span class="ident" id="6116794">n</span><span class="op" id="6116795">]</span><span class="op" id="6116796">;</span>&nbsp;<span class="ident" id="6116798">found</span>&nbsp;<span class="op" id="6116804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116808">return</span>&nbsp;<span class="ident" id="6116815">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6116821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6116825">size</span>&nbsp;<span class="op" id="6116830">=</span>&nbsp;<span class="ident" id="6116832">maxSize</span>&nbsp;<span class="op" id="6116840">+</span>&nbsp;<span class="num" id="6116842">1</span>&nbsp;<span class="comment" id="6116844">//&nbsp;assume&nbsp;n&nbsp;doesn&#39;t&nbsp;fit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6116869">p</span><span class="op" id="6116870">.</span><span class="ident" id="6116871">nodeSizes</span><span class="op" id="6116880">[</span><span class="ident" id="6116881">n</span><span class="op" id="6116882">]</span>&nbsp;<span class="op" id="6116884">=</span>&nbsp;<span class="ident" id="6116886">size</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6116893">//&nbsp;nodeSize&nbsp;computation&nbsp;must&nbsp;be&nbsp;independent&nbsp;of&nbsp;particular</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6116952">//&nbsp;style&nbsp;so&nbsp;that&nbsp;we&nbsp;always&nbsp;get&nbsp;the&nbsp;same&nbsp;decision;&nbsp;print</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6117009">//&nbsp;in&nbsp;RawFormat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117026">cfg</span>&nbsp;<span class="op" id="6117030">:=</span>&nbsp;<span class="ident" id="6117033">Config</span><span class="op" id="6117039">{</span><span class="ident" id="6117040">Mode</span><span class="op" id="6117044">:</span>&nbsp;<span class="ident" id="6117046">RawFormat</span><span class="op" id="6117055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117058">var</span>&nbsp;<span class="ident" id="6117062">buf</span>&nbsp;<span class="ident" id="6117066">bytes</span><span class="op" id="6117071">.</span><span class="ident" id="6117072">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117080">if</span>&nbsp;<span class="ident" id="6117083">err</span>&nbsp;<span class="op" id="6117087">:=</span>&nbsp;<span class="ident" id="6117090">cfg</span><span class="op" id="6117093">.</span><span class="ident" id="6117094">fprint</span><span class="op" id="6117100">(</span><span class="op" id="6117101">&amp;</span><span class="ident" id="6117102">buf</span><span class="op" id="6117105">,</span>&nbsp;<span class="ident" id="6117107">p</span><span class="op" id="6117108">.</span><span class="ident" id="6117109">fset</span><span class="op" id="6117113">,</span>&nbsp;<span class="ident" id="6117115">n</span><span class="op" id="6117116">,</span>&nbsp;<span class="ident" id="6117118">p</span><span class="op" id="6117119">.</span><span class="ident" id="6117120">nodeSizes</span><span class="op" id="6117129">)</span><span class="op" id="6117130">;</span>&nbsp;<span class="ident" id="6117132">err</span>&nbsp;<span class="op" id="6117136">!=</span>&nbsp;<span class="ident" id="6117139">nil</span>&nbsp;<span class="op" id="6117143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117147">return</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6117155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117158">if</span>&nbsp;<span class="ident" id="6117161">buf</span><span class="op" id="6117164">.</span><span class="ident" id="6117165">Len</span><span class="op" id="6117168">(</span><span class="op" id="6117169">)</span>&nbsp;<span class="op" id="6117171">&lt;=</span>&nbsp;<span class="ident" id="6117174">maxSize</span>&nbsp;<span class="op" id="6117182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117186">for</span>&nbsp;<span class="ident" id="6117190">_</span><span class="op" id="6117191">,</span>&nbsp;<span class="ident" id="6117193">ch</span>&nbsp;<span class="op" id="6117196">:=</span>&nbsp;<span class="keyword" id="6117199">range</span>&nbsp;<span class="ident" id="6117205">buf</span><span class="op" id="6117208">.</span><span class="ident" id="6117209">Bytes</span><span class="op" id="6117214">(</span><span class="op" id="6117215">)</span>&nbsp;<span class="op" id="6117217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117222">if</span>&nbsp;<span class="ident" id="6117225">ch</span>&nbsp;<span class="op" id="6117228">&lt;</span>&nbsp;<span class="string" id="6117230">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6117234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117240">return</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6117250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6117254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117258">size</span>&nbsp;<span class="op" id="6117263">=</span>&nbsp;<span class="ident" id="6117265">buf</span><span class="op" id="6117268">.</span><span class="ident" id="6117269">Len</span><span class="op" id="6117272">(</span><span class="op" id="6117273">)</span>&nbsp;<span class="comment" id="6117275">//&nbsp;n&nbsp;fits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117287">p</span><span class="op" id="6117288">.</span><span class="ident" id="6117289">nodeSizes</span><span class="op" id="6117298">[</span><span class="ident" id="6117299">n</span><span class="op" id="6117300">]</span>&nbsp;<span class="op" id="6117302">=</span>&nbsp;<span class="ident" id="6117304">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6117310">}</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117313">return</span><br>
<span class="lineno"></span><span class="op" id="6117320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6117323">//&nbsp;bodySize&nbsp;is&nbsp;like&nbsp;nodeSize&nbsp;but&nbsp;it&nbsp;is&nbsp;specialized&nbsp;for&nbsp;*ast.BlockStmt&#39;s.</span><br>
<span class="lineno"></span><span class="keyword" id="6117396">func</span>&nbsp;<span class="op" id="6117401">(</span><span class="ident" id="6117402">p</span>&nbsp;<span class="op" id="6117404">*</span><span class="ident" id="6117405">printer</span><span class="op" id="6117412">)</span>&nbsp;<span class="ident" id="6117414">bodySize</span><span class="op" id="6117422">(</span><span class="ident" id="6117423">b</span>&nbsp;<span class="op" id="6117425">*</span><span class="ident" id="6117426">ast</span><span class="op" id="6117429">.</span><span class="ident" id="6117430">BlockStmt</span><span class="op" id="6117439">,</span>&nbsp;<span class="ident" id="6117441">maxSize</span>&nbsp;<span class="builtintype" id="6117449">int</span><span class="op" id="6117452">)</span>&nbsp;<span class="builtintype" id="6117454">int</span>&nbsp;<span class="op" id="6117458">{</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117461">pos1</span>&nbsp;<span class="op" id="6117466">:=</span>&nbsp;<span class="ident" id="6117469">b</span><span class="op" id="6117470">.</span><span class="ident" id="6117471">Pos</span><span class="op" id="6117474">(</span><span class="op" id="6117475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117478">pos2</span>&nbsp;<span class="op" id="6117483">:=</span>&nbsp;<span class="ident" id="6117486">b</span><span class="op" id="6117487">.</span><span class="ident" id="6117488">Rbrace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117496">if</span>&nbsp;<span class="ident" id="6117499">pos1</span><span class="op" id="6117503">.</span><span class="ident" id="6117504">IsValid</span><span class="op" id="6117511">(</span><span class="op" id="6117512">)</span>&nbsp;<span class="op" id="6117514">&amp;&amp;</span>&nbsp;<span class="ident" id="6117517">pos2</span><span class="op" id="6117521">.</span><span class="ident" id="6117522">IsValid</span><span class="op" id="6117529">(</span><span class="op" id="6117530">)</span>&nbsp;<span class="op" id="6117532">&amp;&amp;</span>&nbsp;<span class="ident" id="6117535">p</span><span class="op" id="6117536">.</span><span class="ident" id="6117537">lineFor</span><span class="op" id="6117544">(</span><span class="ident" id="6117545">pos1</span><span class="op" id="6117549">)</span>&nbsp;<span class="op" id="6117551">!=</span>&nbsp;<span class="ident" id="6117554">p</span><span class="op" id="6117555">.</span><span class="ident" id="6117556">lineFor</span><span class="op" id="6117563">(</span><span class="ident" id="6117564">pos2</span><span class="op" id="6117568">)</span>&nbsp;<span class="op" id="6117570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6117574">//&nbsp;opening&nbsp;and&nbsp;closing&nbsp;brace&nbsp;are&nbsp;on&nbsp;different&nbsp;lines&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117656">return</span>&nbsp;<span class="ident" id="6117663">maxSize</span>&nbsp;<span class="op" id="6117671">+</span>&nbsp;<span class="num" id="6117673">1</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6117676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117679">if</span>&nbsp;<span class="builtinfunc" id="6117682">len</span><span class="op" id="6117685">(</span><span class="ident" id="6117686">b</span><span class="op" id="6117687">.</span><span class="ident" id="6117688">List</span><span class="op" id="6117692">)</span>&nbsp;<span class="op" id="6117694">&gt;</span>&nbsp;<span class="num" id="6117696">5</span>&nbsp;<span class="op" id="6117698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6117702">//&nbsp;too&nbsp;many&nbsp;statements&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117755">return</span>&nbsp;<span class="ident" id="6117762">maxSize</span>&nbsp;<span class="op" id="6117770">+</span>&nbsp;<span class="num" id="6117772">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6117775">}</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6117778">//&nbsp;otherwise,&nbsp;estimate&nbsp;body&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117812">bodySize</span>&nbsp;<span class="op" id="6117821">:=</span>&nbsp;<span class="ident" id="6117824">p</span><span class="op" id="6117825">.</span><span class="ident" id="6117826">commentSizeBefore</span><span class="op" id="6117843">(</span><span class="ident" id="6117844">p</span><span class="op" id="6117845">.</span><span class="ident" id="6117846">posFor</span><span class="op" id="6117852">(</span><span class="ident" id="6117853">pos2</span><span class="op" id="6117857">)</span><span class="op" id="6117858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117861">for</span>&nbsp;<span class="ident" id="6117865">i</span><span class="op" id="6117866">,</span>&nbsp;<span class="ident" id="6117868">s</span>&nbsp;<span class="op" id="6117870">:=</span>&nbsp;<span class="keyword" id="6117873">range</span>&nbsp;<span class="ident" id="6117879">b</span><span class="op" id="6117880">.</span><span class="ident" id="6117881">List</span>&nbsp;<span class="op" id="6117886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117890">if</span>&nbsp;<span class="ident" id="6117893">bodySize</span>&nbsp;<span class="op" id="6117902">&gt;</span>&nbsp;<span class="ident" id="6117904">maxSize</span>&nbsp;<span class="op" id="6117912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117917">break</span>&nbsp;<span class="comment" id="6117923">//&nbsp;no&nbsp;need&nbsp;to&nbsp;continue</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6117948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117952">if</span>&nbsp;<span class="ident" id="6117955">i</span>&nbsp;<span class="op" id="6117957">&gt;</span>&nbsp;<span class="num" id="6117959">0</span>&nbsp;<span class="op" id="6117961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117966">bodySize</span>&nbsp;<span class="op" id="6117975">+=</span>&nbsp;<span class="num" id="6117978">2</span>&nbsp;<span class="comment" id="6117980">//&nbsp;space&nbsp;for&nbsp;a&nbsp;semicolon&nbsp;and&nbsp;blank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6118017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118021">bodySize</span>&nbsp;<span class="op" id="6118030">+=</span>&nbsp;<span class="ident" id="6118033">p</span><span class="op" id="6118034">.</span><span class="ident" id="6118035">nodeSize</span><span class="op" id="6118043">(</span><span class="ident" id="6118044">s</span><span class="op" id="6118045">,</span>&nbsp;<span class="ident" id="6118047">maxSize</span><span class="op" id="6118054">)</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6118057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118060">return</span>&nbsp;<span class="ident" id="6118067">bodySize</span><br>
<span class="lineno"></span><span class="op" id="6118076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6118079">//&nbsp;adjBlock&nbsp;prints&nbsp;an&nbsp;&#34;adjacent&#34;&nbsp;block&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;or&nbsp;function&nbsp;body)&nbsp;following</span><br>
<span class="lineno">1490</span><span class="comment" id="6118164">//&nbsp;a&nbsp;header&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;control&nbsp;clause&nbsp;or&nbsp;function&nbsp;signature)&nbsp;of&nbsp;given&nbsp;headerSize.</span><br>
<span class="lineno"></span><span class="comment" id="6118253">//&nbsp;If&nbsp;the&nbsp;header&#39;s&nbsp;and&nbsp;block&#39;s&nbsp;size&nbsp;are&nbsp;&#34;small&nbsp;enough&#34;&nbsp;and&nbsp;the&nbsp;block&nbsp;is&nbsp;&#34;simple&nbsp;enough&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="6118342">//&nbsp;the&nbsp;block&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;without&nbsp;line&nbsp;breaks,&nbsp;spaced&nbsp;from&nbsp;the&nbsp;header</span><br>
<span class="lineno"></span><span class="comment" id="6118431">//&nbsp;by&nbsp;sep.&nbsp;Otherwise&nbsp;the&nbsp;block&#39;s&nbsp;opening&nbsp;&#34;{&#34;&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;followed&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6118520">//&nbsp;lines&nbsp;for&nbsp;the&nbsp;block&#39;s&nbsp;statements&nbsp;and&nbsp;its&nbsp;closing&nbsp;&#34;}&#34;.</span><br>
<span class="lineno">1495</span><span class="comment" id="6118577">//</span><br>
<span class="lineno"></span><span class="keyword" id="6118580">func</span>&nbsp;<span class="op" id="6118585">(</span><span class="ident" id="6118586">p</span>&nbsp;<span class="op" id="6118588">*</span><span class="ident" id="6118589">printer</span><span class="op" id="6118596">)</span>&nbsp;<span class="ident" id="6118598">adjBlock</span><span class="op" id="6118606">(</span><span class="ident" id="6118607">headerSize</span>&nbsp;<span class="builtintype" id="6118618">int</span><span class="op" id="6118621">,</span>&nbsp;<span class="ident" id="6118623">sep</span>&nbsp;<span class="ident" id="6118627">whiteSpace</span><span class="op" id="6118637">,</span>&nbsp;<span class="ident" id="6118639">b</span>&nbsp;<span class="op" id="6118641">*</span><span class="ident" id="6118642">ast</span><span class="op" id="6118645">.</span><span class="ident" id="6118646">BlockStmt</span><span class="op" id="6118655">)</span>&nbsp;<span class="op" id="6118657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118660">if</span>&nbsp;<span class="ident" id="6118663">b</span>&nbsp;<span class="op" id="6118665">==</span>&nbsp;<span class="ident" id="6118668">nil</span>&nbsp;<span class="op" id="6118672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118676">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6118684">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118688">const</span>&nbsp;<span class="ident" id="6118694">maxSize</span>&nbsp;<span class="op" id="6118702">=</span>&nbsp;<span class="num" id="6118704">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118709">if</span>&nbsp;<span class="ident" id="6118712">headerSize</span><span class="op" id="6118722">+</span><span class="ident" id="6118723">p</span><span class="op" id="6118724">.</span><span class="ident" id="6118725">bodySize</span><span class="op" id="6118733">(</span><span class="ident" id="6118734">b</span><span class="op" id="6118735">,</span>&nbsp;<span class="ident" id="6118737">maxSize</span><span class="op" id="6118744">)</span>&nbsp;<span class="op" id="6118746">&lt;=</span>&nbsp;<span class="ident" id="6118749">maxSize</span>&nbsp;<span class="op" id="6118757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118761">p</span><span class="op" id="6118762">.</span><span class="builtinfunc" id="6118763">print</span><span class="op" id="6118768">(</span><span class="ident" id="6118769">sep</span><span class="op" id="6118772">,</span>&nbsp;<span class="ident" id="6118774">b</span><span class="op" id="6118775">.</span><span class="ident" id="6118776">Lbrace</span><span class="op" id="6118782">,</span>&nbsp;<span class="ident" id="6118784">token</span><span class="op" id="6118789">.</span><span class="ident" id="6118790">LBRACE</span><span class="op" id="6118796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118800">if</span>&nbsp;<span class="builtinfunc" id="6118803">len</span><span class="op" id="6118806">(</span><span class="ident" id="6118807">b</span><span class="op" id="6118808">.</span><span class="ident" id="6118809">List</span><span class="op" id="6118813">)</span>&nbsp;<span class="op" id="6118815">&gt;</span>&nbsp;<span class="num" id="6118817">0</span>&nbsp;<span class="op" id="6118819">{</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118824">p</span><span class="op" id="6118825">.</span><span class="builtinfunc" id="6118826">print</span><span class="op" id="6118831">(</span><span class="ident" id="6118832">blank</span><span class="op" id="6118837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118842">for</span>&nbsp;<span class="ident" id="6118846">i</span><span class="op" id="6118847">,</span>&nbsp;<span class="ident" id="6118849">s</span>&nbsp;<span class="op" id="6118851">:=</span>&nbsp;<span class="keyword" id="6118854">range</span>&nbsp;<span class="ident" id="6118860">b</span><span class="op" id="6118861">.</span><span class="ident" id="6118862">List</span>&nbsp;<span class="op" id="6118867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118873">if</span>&nbsp;<span class="ident" id="6118876">i</span>&nbsp;<span class="op" id="6118878">&gt;</span>&nbsp;<span class="num" id="6118880">0</span>&nbsp;<span class="op" id="6118882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118889">p</span><span class="op" id="6118890">.</span><span class="builtinfunc" id="6118891">print</span><span class="op" id="6118896">(</span><span class="ident" id="6118897">token</span><span class="op" id="6118902">.</span><span class="ident" id="6118903">SEMICOLON</span><span class="op" id="6118912">,</span>&nbsp;<span class="ident" id="6118914">blank</span><span class="op" id="6118919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6118925">}</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118931">p</span><span class="op" id="6118932">.</span><span class="ident" id="6118933">stmt</span><span class="op" id="6118937">(</span><span class="ident" id="6118938">s</span><span class="op" id="6118939">,</span>&nbsp;<span class="ident" id="6118941">i</span>&nbsp;<span class="op" id="6118943">==</span>&nbsp;<span class="builtinfunc" id="6118946">len</span><span class="op" id="6118949">(</span><span class="ident" id="6118950">b</span><span class="op" id="6118951">.</span><span class="ident" id="6118952">List</span><span class="op" id="6118956">)</span><span class="op" id="6118957">-</span><span class="num" id="6118958">1</span><span class="op" id="6118959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6118964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118969">p</span><span class="op" id="6118970">.</span><span class="builtinfunc" id="6118971">print</span><span class="op" id="6118976">(</span><span class="ident" id="6118977">blank</span><span class="op" id="6118982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6118986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118990">p</span><span class="op" id="6118991">.</span><span class="builtinfunc" id="6118992">print</span><span class="op" id="6118997">(</span><span class="ident" id="6118998">noExtraLinebreak</span><span class="op" id="6119014">,</span>&nbsp;<span class="ident" id="6119016">b</span><span class="op" id="6119017">.</span><span class="ident" id="6119018">Rbrace</span><span class="op" id="6119024">,</span>&nbsp;<span class="ident" id="6119026">token</span><span class="op" id="6119031">.</span><span class="ident" id="6119032">RBRACE</span><span class="op" id="6119038">,</span>&nbsp;<span class="ident" id="6119040">noExtraLinebreak</span><span class="op" id="6119056">)</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119060">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6119068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119072">if</span>&nbsp;<span class="ident" id="6119075">sep</span>&nbsp;<span class="op" id="6119079">!=</span>&nbsp;<span class="ident" id="6119082">ignore</span>&nbsp;<span class="op" id="6119089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119093">p</span><span class="op" id="6119094">.</span><span class="builtinfunc" id="6119095">print</span><span class="op" id="6119100">(</span><span class="ident" id="6119101">blank</span><span class="op" id="6119106">)</span>&nbsp;<span class="comment" id="6119108">//&nbsp;always&nbsp;use&nbsp;blank</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6119129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119132">p</span><span class="op" id="6119133">.</span><span class="ident" id="6119134">block</span><span class="op" id="6119139">(</span><span class="ident" id="6119140">b</span><span class="op" id="6119141">,</span>&nbsp;<span class="num" id="6119143">1</span><span class="op" id="6119144">)</span><br>
<span class="lineno"></span><span class="op" id="6119146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6119149">//&nbsp;distanceFrom&nbsp;returns&nbsp;the&nbsp;column&nbsp;difference&nbsp;between&nbsp;from&nbsp;and&nbsp;p.pos&nbsp;(the&nbsp;current</span><br>
<span class="lineno">1525</span><span class="comment" id="6119231">//&nbsp;estimated&nbsp;position)&nbsp;if&nbsp;both&nbsp;are&nbsp;on&nbsp;the&nbsp;same&nbsp;line;&nbsp;if&nbsp;they&nbsp;are&nbsp;on&nbsp;different&nbsp;lines</span><br>
<span class="lineno"></span><span class="comment" id="6119315">//&nbsp;(or&nbsp;unknown)&nbsp;the&nbsp;result&nbsp;is&nbsp;infinity.</span><br>
<span class="lineno"></span><span class="keyword" id="6119355">func</span>&nbsp;<span class="op" id="6119360">(</span><span class="ident" id="6119361">p</span>&nbsp;<span class="op" id="6119363">*</span><span class="ident" id="6119364">printer</span><span class="op" id="6119371">)</span>&nbsp;<span class="ident" id="6119373">distanceFrom</span><span class="op" id="6119385">(</span><span class="ident" id="6119386">from</span>&nbsp;<span class="ident" id="6119391">token</span><span class="op" id="6119396">.</span><span class="ident" id="6119397">Pos</span><span class="op" id="6119400">)</span>&nbsp;<span class="builtintype" id="6119402">int</span>&nbsp;<span class="op" id="6119406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119409">if</span>&nbsp;<span class="ident" id="6119412">from</span><span class="op" id="6119416">.</span><span class="ident" id="6119417">IsValid</span><span class="op" id="6119424">(</span><span class="op" id="6119425">)</span>&nbsp;<span class="op" id="6119427">&amp;&amp;</span>&nbsp;<span class="ident" id="6119430">p</span><span class="op" id="6119431">.</span><span class="ident" id="6119432">pos</span><span class="op" id="6119435">.</span><span class="ident" id="6119436">IsValid</span><span class="op" id="6119443">(</span><span class="op" id="6119444">)</span>&nbsp;<span class="op" id="6119446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119450">if</span>&nbsp;<span class="ident" id="6119453">f</span>&nbsp;<span class="op" id="6119455">:=</span>&nbsp;<span class="ident" id="6119458">p</span><span class="op" id="6119459">.</span><span class="ident" id="6119460">posFor</span><span class="op" id="6119466">(</span><span class="ident" id="6119467">from</span><span class="op" id="6119471">)</span><span class="op" id="6119472">;</span>&nbsp;<span class="ident" id="6119474">f</span><span class="op" id="6119475">.</span><span class="ident" id="6119476">Line</span>&nbsp;<span class="op" id="6119481">==</span>&nbsp;<span class="ident" id="6119484">p</span><span class="op" id="6119485">.</span><span class="ident" id="6119486">pos</span><span class="op" id="6119489">.</span><span class="ident" id="6119490">Line</span>&nbsp;<span class="op" id="6119495">{</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119500">return</span>&nbsp;<span class="ident" id="6119507">p</span><span class="op" id="6119508">.</span><span class="ident" id="6119509">pos</span><span class="op" id="6119512">.</span><span class="ident" id="6119513">Column</span>&nbsp;<span class="op" id="6119520">-</span>&nbsp;<span class="ident" id="6119522">f</span><span class="op" id="6119523">.</span><span class="ident" id="6119524">Column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6119533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6119536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119539">return</span>&nbsp;<span class="ident" id="6119546">infinity</span><br>
<span class="lineno"></span><span class="op" id="6119555">}</span><br>
<span class="lineno">1535</span><br>
<span class="lineno"></span><span class="keyword" id="6119558">func</span>&nbsp;<span class="op" id="6119563">(</span><span class="ident" id="6119564">p</span>&nbsp;<span class="op" id="6119566">*</span><span class="ident" id="6119567">printer</span><span class="op" id="6119574">)</span>&nbsp;<span class="ident" id="6119576">funcDecl</span><span class="op" id="6119584">(</span><span class="ident" id="6119585">d</span>&nbsp;<span class="op" id="6119587">*</span><span class="ident" id="6119588">ast</span><span class="op" id="6119591">.</span><span class="ident" id="6119592">FuncDecl</span><span class="op" id="6119600">)</span>&nbsp;<span class="op" id="6119602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119605">p</span><span class="op" id="6119606">.</span><span class="ident" id="6119607">setComment</span><span class="op" id="6119617">(</span><span class="ident" id="6119618">d</span><span class="op" id="6119619">.</span><span class="ident" id="6119620">Doc</span><span class="op" id="6119623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119626">p</span><span class="op" id="6119627">.</span><span class="builtinfunc" id="6119628">print</span><span class="op" id="6119633">(</span><span class="ident" id="6119634">d</span><span class="op" id="6119635">.</span><span class="ident" id="6119636">Pos</span><span class="op" id="6119639">(</span><span class="op" id="6119640">)</span><span class="op" id="6119641">,</span>&nbsp;<span class="ident" id="6119643">token</span><span class="op" id="6119648">.</span><span class="ident" id="6119649">FUNC</span><span class="op" id="6119653">,</span>&nbsp;<span class="ident" id="6119655">blank</span><span class="op" id="6119660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119663">if</span>&nbsp;<span class="ident" id="6119666">d</span><span class="op" id="6119667">.</span><span class="ident" id="6119668">Recv</span>&nbsp;<span class="op" id="6119673">!=</span>&nbsp;<span class="ident" id="6119676">nil</span>&nbsp;<span class="op" id="6119680">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119684">p</span><span class="op" id="6119685">.</span><span class="ident" id="6119686">parameters</span><span class="op" id="6119696">(</span><span class="ident" id="6119697">d</span><span class="op" id="6119698">.</span><span class="ident" id="6119699">Recv</span><span class="op" id="6119703">)</span>&nbsp;<span class="comment" id="6119705">//&nbsp;method:&nbsp;print&nbsp;receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119733">p</span><span class="op" id="6119734">.</span><span class="builtinfunc" id="6119735">print</span><span class="op" id="6119740">(</span><span class="ident" id="6119741">blank</span><span class="op" id="6119746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6119749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119752">p</span><span class="op" id="6119753">.</span><span class="ident" id="6119754">expr</span><span class="op" id="6119758">(</span><span class="ident" id="6119759">d</span><span class="op" id="6119760">.</span><span class="ident" id="6119761">Name</span><span class="op" id="6119765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119768">p</span><span class="op" id="6119769">.</span><span class="ident" id="6119770">signature</span><span class="op" id="6119779">(</span><span class="ident" id="6119780">d</span><span class="op" id="6119781">.</span><span class="ident" id="6119782">Type</span><span class="op" id="6119786">.</span><span class="ident" id="6119787">Params</span><span class="op" id="6119793">,</span>&nbsp;<span class="ident" id="6119795">d</span><span class="op" id="6119796">.</span><span class="ident" id="6119797">Type</span><span class="op" id="6119801">.</span><span class="ident" id="6119802">Results</span><span class="op" id="6119809">)</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119812">p</span><span class="op" id="6119813">.</span><span class="ident" id="6119814">adjBlock</span><span class="op" id="6119822">(</span><span class="ident" id="6119823">p</span><span class="op" id="6119824">.</span><span class="ident" id="6119825">distanceFrom</span><span class="op" id="6119837">(</span><span class="ident" id="6119838">d</span><span class="op" id="6119839">.</span><span class="ident" id="6119840">Pos</span><span class="op" id="6119843">(</span><span class="op" id="6119844">)</span><span class="op" id="6119845">)</span><span class="op" id="6119846">,</span>&nbsp;<span class="ident" id="6119848">vtab</span><span class="op" id="6119852">,</span>&nbsp;<span class="ident" id="6119854">d</span><span class="op" id="6119855">.</span><span class="ident" id="6119856">Body</span><span class="op" id="6119860">)</span><br>
<span class="lineno"></span><span class="op" id="6119862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6119865">func</span>&nbsp;<span class="op" id="6119870">(</span><span class="ident" id="6119871">p</span>&nbsp;<span class="op" id="6119873">*</span><span class="ident" id="6119874">printer</span><span class="op" id="6119881">)</span>&nbsp;<span class="ident" id="6119883">decl</span><span class="op" id="6119887">(</span><span class="ident" id="6119888">decl</span>&nbsp;<span class="ident" id="6119893">ast</span><span class="op" id="6119896">.</span><span class="ident" id="6119897">Decl</span><span class="op" id="6119901">)</span>&nbsp;<span class="op" id="6119903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119906">switch</span>&nbsp;<span class="ident" id="6119913">d</span>&nbsp;<span class="op" id="6119915">:=</span>&nbsp;<span class="ident" id="6119918">decl</span><span class="op" id="6119922">.</span><span class="op" id="6119923">(</span><span class="keyword" id="6119924">type</span><span class="op" id="6119928">)</span>&nbsp;<span class="op" id="6119930">{</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119933">case</span>&nbsp;<span class="op" id="6119938">*</span><span class="ident" id="6119939">ast</span><span class="op" id="6119942">.</span><span class="ident" id="6119943">BadDecl</span><span class="op" id="6119950">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119954">p</span><span class="op" id="6119955">.</span><span class="builtinfunc" id="6119956">print</span><span class="op" id="6119961">(</span><span class="ident" id="6119962">d</span><span class="op" id="6119963">.</span><span class="ident" id="6119964">Pos</span><span class="op" id="6119967">(</span><span class="op" id="6119968">)</span><span class="op" id="6119969">,</span>&nbsp;<span class="string" id="6119971">&#34;BadDecl&#34;</span><span class="op" id="6119980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119983">case</span>&nbsp;<span class="op" id="6119988">*</span><span class="ident" id="6119989">ast</span><span class="op" id="6119992">.</span><span class="ident" id="6119993">GenDecl</span><span class="op" id="6120000">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120004">p</span><span class="op" id="6120005">.</span><span class="ident" id="6120006">genDecl</span><span class="op" id="6120013">(</span><span class="ident" id="6120014">d</span><span class="op" id="6120015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120018">case</span>&nbsp;<span class="op" id="6120023">*</span><span class="ident" id="6120024">ast</span><span class="op" id="6120027">.</span><span class="ident" id="6120028">FuncDecl</span><span class="op" id="6120036">:</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120040">p</span><span class="op" id="6120041">.</span><span class="ident" id="6120042">funcDecl</span><span class="op" id="6120050">(</span><span class="ident" id="6120051">d</span><span class="op" id="6120052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120055">default</span><span class="op" id="6120062">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6120066">panic</span><span class="op" id="6120071">(</span><span class="string" id="6120072">&#34;unreachable&#34;</span><span class="op" id="6120085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120088">}</span><br>
<span class="lineno"></span><span class="op" id="6120090">}</span><br>
<span class="lineno">1560</span><br>
<span class="lineno"></span><span class="comment" id="6120093">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="6120173">//&nbsp;Files</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6120183">func</span>&nbsp;<span class="ident" id="6120188">declToken</span><span class="op" id="6120197">(</span><span class="ident" id="6120198">decl</span>&nbsp;<span class="ident" id="6120203">ast</span><span class="op" id="6120206">.</span><span class="ident" id="6120207">Decl</span><span class="op" id="6120211">)</span>&nbsp;<span class="op" id="6120213">(</span><span class="ident" id="6120214">tok</span>&nbsp;<span class="ident" id="6120218">token</span><span class="op" id="6120223">.</span><span class="ident" id="6120224">Token</span><span class="op" id="6120229">)</span>&nbsp;<span class="op" id="6120231">{</span><br>
<span class="lineno">1565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120234">tok</span>&nbsp;<span class="op" id="6120238">=</span>&nbsp;<span class="ident" id="6120240">token</span><span class="op" id="6120245">.</span><span class="ident" id="6120246">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120255">switch</span>&nbsp;<span class="ident" id="6120262">d</span>&nbsp;<span class="op" id="6120264">:=</span>&nbsp;<span class="ident" id="6120267">decl</span><span class="op" id="6120271">.</span><span class="op" id="6120272">(</span><span class="keyword" id="6120273">type</span><span class="op" id="6120277">)</span>&nbsp;<span class="op" id="6120279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120282">case</span>&nbsp;<span class="op" id="6120287">*</span><span class="ident" id="6120288">ast</span><span class="op" id="6120291">.</span><span class="ident" id="6120292">GenDecl</span><span class="op" id="6120299">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120303">tok</span>&nbsp;<span class="op" id="6120307">=</span>&nbsp;<span class="ident" id="6120309">d</span><span class="op" id="6120310">.</span><span class="ident" id="6120311">Tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120316">case</span>&nbsp;<span class="op" id="6120321">*</span><span class="ident" id="6120322">ast</span><span class="op" id="6120325">.</span><span class="ident" id="6120326">FuncDecl</span><span class="op" id="6120334">:</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120338">tok</span>&nbsp;<span class="op" id="6120342">=</span>&nbsp;<span class="ident" id="6120344">token</span><span class="op" id="6120349">.</span><span class="ident" id="6120350">FUNC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120359">return</span><br>
<span class="lineno"></span><span class="op" id="6120366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1575</span><span class="keyword" id="6120369">func</span>&nbsp;<span class="op" id="6120374">(</span><span class="ident" id="6120375">p</span>&nbsp;<span class="op" id="6120377">*</span><span class="ident" id="6120378">printer</span><span class="op" id="6120385">)</span>&nbsp;<span class="ident" id="6120387">declList</span><span class="op" id="6120395">(</span><span class="ident" id="6120396">list</span>&nbsp;<span class="op" id="6120401">[</span><span class="op" id="6120402">]</span><span class="ident" id="6120403">ast</span><span class="op" id="6120406">.</span><span class="ident" id="6120407">Decl</span><span class="op" id="6120411">)</span>&nbsp;<span class="op" id="6120413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120416">tok</span>&nbsp;<span class="op" id="6120420">:=</span>&nbsp;<span class="ident" id="6120423">token</span><span class="op" id="6120428">.</span><span class="ident" id="6120429">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120438">for</span>&nbsp;<span class="ident" id="6120442">_</span><span class="op" id="6120443">,</span>&nbsp;<span class="ident" id="6120445">d</span>&nbsp;<span class="op" id="6120447">:=</span>&nbsp;<span class="keyword" id="6120450">range</span>&nbsp;<span class="ident" id="6120456">list</span>&nbsp;<span class="op" id="6120461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120465">prev</span>&nbsp;<span class="op" id="6120470">:=</span>&nbsp;<span class="ident" id="6120473">tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120479">tok</span>&nbsp;<span class="op" id="6120483">=</span>&nbsp;<span class="ident" id="6120485">declToken</span><span class="op" id="6120494">(</span><span class="ident" id="6120495">d</span><span class="op" id="6120496">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6120500">//&nbsp;If&nbsp;the&nbsp;declaration&nbsp;token&nbsp;changed&nbsp;(e.g.,&nbsp;from&nbsp;CONST&nbsp;to&nbsp;TYPE)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6120565">//&nbsp;or&nbsp;the&nbsp;next&nbsp;declaration&nbsp;has&nbsp;documentation&nbsp;associated&nbsp;with&nbsp;it,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6120632">//&nbsp;print&nbsp;an&nbsp;empty&nbsp;line&nbsp;between&nbsp;top-level&nbsp;declarations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6120689">//&nbsp;(because&nbsp;p.linebreak&nbsp;is&nbsp;called&nbsp;with&nbsp;the&nbsp;position&nbsp;of&nbsp;d,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6120755">//&nbsp;is&nbsp;past&nbsp;any&nbsp;documentation,&nbsp;the&nbsp;minimum&nbsp;requirement&nbsp;is&nbsp;satisfied</span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6120824">//&nbsp;even&nbsp;w/o&nbsp;the&nbsp;extra&nbsp;getDoc(d)&nbsp;nil-check&nbsp;-&nbsp;leave&nbsp;it&nbsp;in&nbsp;case&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6120891">//&nbsp;linebreak&nbsp;logic&nbsp;improves&nbsp;-&nbsp;there&#39;s&nbsp;already&nbsp;a&nbsp;TODO).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120948">if</span>&nbsp;<span class="builtinfunc" id="6120951">len</span><span class="op" id="6120954">(</span><span class="ident" id="6120955">p</span><span class="op" id="6120956">.</span><span class="ident" id="6120957">output</span><span class="op" id="6120963">)</span>&nbsp;<span class="op" id="6120965">&gt;</span>&nbsp;<span class="num" id="6120967">0</span>&nbsp;<span class="op" id="6120969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6120974">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6121047">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121104">min</span>&nbsp;<span class="op" id="6121108">:=</span>&nbsp;<span class="num" id="6121111">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121116">if</span>&nbsp;<span class="ident" id="6121119">prev</span>&nbsp;<span class="op" id="6121124">!=</span>&nbsp;<span class="ident" id="6121127">tok</span>&nbsp;<span class="op" id="6121131">||</span>&nbsp;<span class="ident" id="6121134">getDoc</span><span class="op" id="6121140">(</span><span class="ident" id="6121141">d</span><span class="op" id="6121142">)</span>&nbsp;<span class="op" id="6121144">!=</span>&nbsp;<span class="ident" id="6121147">nil</span>&nbsp;<span class="op" id="6121151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121157">min</span>&nbsp;<span class="op" id="6121161">=</span>&nbsp;<span class="num" id="6121163">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6121168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121173">p</span><span class="op" id="6121174">.</span><span class="ident" id="6121175">linebreak</span><span class="op" id="6121184">(</span><span class="ident" id="6121185">p</span><span class="op" id="6121186">.</span><span class="ident" id="6121187">lineFor</span><span class="op" id="6121194">(</span><span class="ident" id="6121195">d</span><span class="op" id="6121196">.</span><span class="ident" id="6121197">Pos</span><span class="op" id="6121200">(</span><span class="op" id="6121201">)</span><span class="op" id="6121202">)</span><span class="op" id="6121203">,</span>&nbsp;<span class="ident" id="6121205">min</span><span class="op" id="6121208">,</span>&nbsp;<span class="ident" id="6121210">ignore</span><span class="op" id="6121216">,</span>&nbsp;<span class="builtintype" id="6121218">false</span><span class="op" id="6121223">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6121227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121231">p</span><span class="op" id="6121232">.</span><span class="ident" id="6121233">decl</span><span class="op" id="6121237">(</span><span class="ident" id="6121238">d</span><span class="op" id="6121239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6121242">}</span><br>
<span class="lineno"></span><span class="op" id="6121244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1600</span><span class="keyword" id="6121247">func</span>&nbsp;<span class="op" id="6121252">(</span><span class="ident" id="6121253">p</span>&nbsp;<span class="op" id="6121255">*</span><span class="ident" id="6121256">printer</span><span class="op" id="6121263">)</span>&nbsp;<span class="ident" id="6121265">file</span><span class="op" id="6121269">(</span><span class="ident" id="6121270">src</span>&nbsp;<span class="op" id="6121274">*</span><span class="ident" id="6121275">ast</span><span class="op" id="6121278">.</span><span class="ident" id="6121279">File</span><span class="op" id="6121283">)</span>&nbsp;<span class="op" id="6121285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121288">p</span><span class="op" id="6121289">.</span><span class="ident" id="6121290">setComment</span><span class="op" id="6121300">(</span><span class="ident" id="6121301">src</span><span class="op" id="6121304">.</span><span class="ident" id="6121305">Doc</span><span class="op" id="6121308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121311">p</span><span class="op" id="6121312">.</span><span class="builtinfunc" id="6121313">print</span><span class="op" id="6121318">(</span><span class="ident" id="6121319">src</span><span class="op" id="6121322">.</span><span class="ident" id="6121323">Pos</span><span class="op" id="6121326">(</span><span class="op" id="6121327">)</span><span class="op" id="6121328">,</span>&nbsp;<span class="ident" id="6121330">token</span><span class="op" id="6121335">.</span><span class="ident" id="6121336">PACKAGE</span><span class="op" id="6121343">,</span>&nbsp;<span class="ident" id="6121345">blank</span><span class="op" id="6121350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121353">p</span><span class="op" id="6121354">.</span><span class="ident" id="6121355">expr</span><span class="op" id="6121359">(</span><span class="ident" id="6121360">src</span><span class="op" id="6121363">.</span><span class="ident" id="6121364">Name</span><span class="op" id="6121368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121371">p</span><span class="op" id="6121372">.</span><span class="ident" id="6121373">declList</span><span class="op" id="6121381">(</span><span class="ident" id="6121382">src</span><span class="op" id="6121385">.</span><span class="ident" id="6121386">Decls</span><span class="op" id="6121391">)</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121394">p</span><span class="op" id="6121395">.</span><span class="builtinfunc" id="6121396">print</span><span class="op" id="6121401">(</span><span class="ident" id="6121402">newline</span><span class="op" id="6121409">)</span><br>
<span class="lineno"></span><span class="op" id="6121411">}</span>
</div>
</body>
</html>
