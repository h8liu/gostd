<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html" class="current">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3862744">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3862799">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3862853">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3862904">//&nbsp;DNS&nbsp;packet&nbsp;assembly.&nbsp;&nbsp;See&nbsp;RFC&nbsp;1035.</span><br>
<span class="lineno"></span><span class="comment" id="3862943">//</span><br>
<span class="lineno"></span><span class="comment" id="3862946">//&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;name&nbsp;resolution&nbsp;during&nbsp;Dial.</span><br>
<span class="lineno"></span><span class="comment" id="3863006">//&nbsp;It&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;blazing&nbsp;fast.</span><br>
<span class="lineno"></span><span class="comment" id="3863045">//</span><br>
<span class="lineno">10</span><span class="comment" id="3863048">//&nbsp;Each&nbsp;message&nbsp;structure&nbsp;has&nbsp;a&nbsp;Walk&nbsp;method&nbsp;that&nbsp;is&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3863108">//&nbsp;a&nbsp;generic&nbsp;pack/unpack&nbsp;routine.&nbsp;Thus,&nbsp;if&nbsp;in&nbsp;the&nbsp;future&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="3863173">//&nbsp;to&nbsp;define&nbsp;new&nbsp;message&nbsp;structs,&nbsp;no&nbsp;new&nbsp;pack/unpack/printing&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="3863240">//&nbsp;needs&nbsp;to&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="3863264">//</span><br>
<span class="lineno">15</span><span class="comment" id="3863267">//&nbsp;The&nbsp;first&nbsp;half&nbsp;of&nbsp;this&nbsp;file&nbsp;defines&nbsp;the&nbsp;DNS&nbsp;message&nbsp;formats.</span><br>
<span class="lineno"></span><span class="comment" id="3863331">//&nbsp;The&nbsp;second&nbsp;half&nbsp;implements&nbsp;the&nbsp;conversion&nbsp;to&nbsp;and&nbsp;from&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="3863401">//&nbsp;A&nbsp;few&nbsp;of&nbsp;the&nbsp;structure&nbsp;elements&nbsp;have&nbsp;string&nbsp;tags&nbsp;to&nbsp;aid&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3863464">//&nbsp;generic&nbsp;pack/unpack&nbsp;routines.</span><br>
<span class="lineno"></span><span class="comment" id="3863497">//</span><br>
<span class="lineno">20</span><span class="comment" id="3863500">//&nbsp;TODO(rsc):&nbsp;&nbsp;There&nbsp;are&nbsp;enough&nbsp;names&nbsp;defined&nbsp;in&nbsp;this&nbsp;file&nbsp;that&nbsp;they&#39;re&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3863576">//&nbsp;prefixed&nbsp;with&nbsp;dns.&nbsp;&nbsp;Perhaps&nbsp;put&nbsp;this&nbsp;in&nbsp;its&nbsp;own&nbsp;package&nbsp;later.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3863643">package</span>&nbsp;<span class="ident" id="3863651">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3863656">//&nbsp;Packet&nbsp;formats</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3863675">//&nbsp;Wire&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3863694">const</span>&nbsp;<span class="op" id="3863700">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3863703">//&nbsp;valid&nbsp;dnsRR_Header.Rrtype&nbsp;and&nbsp;dnsQuestion.qtype</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3863755">dnsTypeA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3863768">=</span>&nbsp;<span class="num" id="3863770">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3863773">dnsTypeNS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3863786">=</span>&nbsp;<span class="num" id="3863788">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3863791">dnsTypeMD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3863804">=</span>&nbsp;<span class="num" id="3863806">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3863809">dnsTypeMF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3863822">=</span>&nbsp;<span class="num" id="3863824">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3863827">dnsTypeCNAME</span>&nbsp;<span class="op" id="3863840">=</span>&nbsp;<span class="num" id="3863842">5</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3863845">dnsTypeSOA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3863858">=</span>&nbsp;<span class="num" id="3863860">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3863863">dnsTypeMB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3863876">=</span>&nbsp;<span class="num" id="3863878">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3863881">dnsTypeMG</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3863894">=</span>&nbsp;<span class="num" id="3863896">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3863899">dnsTypeMR</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3863912">=</span>&nbsp;<span class="num" id="3863914">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3863917">dnsTypeNULL</span>&nbsp;&nbsp;<span class="op" id="3863930">=</span>&nbsp;<span class="num" id="3863932">10</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3863936">dnsTypeWKS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3863949">=</span>&nbsp;<span class="num" id="3863951">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3863955">dnsTypePTR</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3863968">=</span>&nbsp;<span class="num" id="3863970">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3863974">dnsTypeHINFO</span>&nbsp;<span class="op" id="3863987">=</span>&nbsp;<span class="num" id="3863989">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3863993">dnsTypeMINFO</span>&nbsp;<span class="op" id="3864006">=</span>&nbsp;<span class="num" id="3864008">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864012">dnsTypeMX</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3864025">=</span>&nbsp;<span class="num" id="3864027">15</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864031">dnsTypeTXT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3864044">=</span>&nbsp;<span class="num" id="3864046">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864050">dnsTypeAAAA</span>&nbsp;&nbsp;<span class="op" id="3864063">=</span>&nbsp;<span class="num" id="3864065">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864069">dnsTypeSRV</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3864082">=</span>&nbsp;<span class="num" id="3864084">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3864089">//&nbsp;valid&nbsp;dnsQuestion.qtype&nbsp;only</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864122">dnsTypeAXFR</span>&nbsp;&nbsp;<span class="op" id="3864135">=</span>&nbsp;<span class="num" id="3864137">252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864142">dnsTypeMAILB</span>&nbsp;<span class="op" id="3864155">=</span>&nbsp;<span class="num" id="3864157">253</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864162">dnsTypeMAILA</span>&nbsp;<span class="op" id="3864175">=</span>&nbsp;<span class="num" id="3864177">254</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864182">dnsTypeALL</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3864195">=</span>&nbsp;<span class="num" id="3864197">255</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3864203">//&nbsp;valid&nbsp;dnsQuestion.qclass</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864232">dnsClassINET</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3864247">=</span>&nbsp;<span class="num" id="3864249">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864252">dnsClassCSNET</span>&nbsp;&nbsp;<span class="op" id="3864267">=</span>&nbsp;<span class="num" id="3864269">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864272">dnsClassCHAOS</span>&nbsp;&nbsp;<span class="op" id="3864287">=</span>&nbsp;<span class="num" id="3864289">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864292">dnsClassHESIOD</span>&nbsp;<span class="op" id="3864307">=</span>&nbsp;<span class="num" id="3864309">4</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864312">dnsClassANY</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3864327">=</span>&nbsp;<span class="num" id="3864329">255</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3864335">//&nbsp;dnsMsg.rcode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864352">dnsRcodeSuccess</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3864375">=</span>&nbsp;<span class="num" id="3864377">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864380">dnsRcodeFormatError</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3864403">=</span>&nbsp;<span class="num" id="3864405">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864408">dnsRcodeServerFailure</span>&nbsp;&nbsp;<span class="op" id="3864431">=</span>&nbsp;<span class="num" id="3864433">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864436">dnsRcodeNameError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3864459">=</span>&nbsp;<span class="num" id="3864461">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864464">dnsRcodeNotImplemented</span>&nbsp;<span class="op" id="3864487">=</span>&nbsp;<span class="num" id="3864489">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3864492">dnsRcodeRefused</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3864515">=</span>&nbsp;<span class="num" id="3864517">5</span><br>
<span class="lineno"></span><span class="op" id="3864519">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="3864522">//&nbsp;A&nbsp;dnsStruct&nbsp;describes&nbsp;how&nbsp;to&nbsp;iterate&nbsp;over&nbsp;its&nbsp;fields&nbsp;to&nbsp;emulate</span><br>
<span class="lineno"></span><span class="comment" id="3864589">//&nbsp;reflective&nbsp;marshalling.</span><br>
<span class="lineno"></span><span class="keyword" id="3864616">type</span>&nbsp;<span class="ident" id="3864621">dnsStruct</span>&nbsp;<span class="keyword" id="3864631">interface</span>&nbsp;<span class="op" id="3864641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3864644">//&nbsp;Walk&nbsp;iterates&nbsp;over&nbsp;fields&nbsp;of&nbsp;a&nbsp;structure&nbsp;and&nbsp;calls&nbsp;f</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3864701">//&nbsp;with&nbsp;a&nbsp;reference&nbsp;to&nbsp;that&nbsp;field,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3864759">//&nbsp;and&nbsp;a&nbsp;tag&nbsp;(&#34;&#34;,&nbsp;&#34;domain&#34;,&nbsp;&#34;ipv4&#34;,&nbsp;&#34;ipv6&#34;)&nbsp;specifying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3864815">//&nbsp;particular&nbsp;encodings.&nbsp;Possible&nbsp;concrete&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3864865">//&nbsp;for&nbsp;v&nbsp;are&nbsp;*uint16,&nbsp;*uint32,&nbsp;*string,&nbsp;or&nbsp;[]byte,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3864921">//&nbsp;*int,&nbsp;*bool&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;dnsMsgHdr.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3864963">//&nbsp;Whenever&nbsp;f&nbsp;returns&nbsp;false,&nbsp;Walk&nbsp;must&nbsp;stop&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3865019">//&nbsp;false,&nbsp;and&nbsp;otherwise&nbsp;return&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865057">Walk</span><span class="op" id="3865061">(</span><span class="ident" id="3865062">f</span>&nbsp;<span class="keyword" id="3865064">func</span><span class="op" id="3865068">(</span><span class="ident" id="3865069">v</span>&nbsp;<span class="keyword" id="3865071">interface</span><span class="op" id="3865080">{</span><span class="op" id="3865081">}</span><span class="op" id="3865082">,</span>&nbsp;<span class="ident" id="3865084">name</span><span class="op" id="3865088">,</span>&nbsp;<span class="ident" id="3865090">tag</span>&nbsp;<span class="builtintype" id="3865094">string</span><span class="op" id="3865100">)</span>&nbsp;<span class="op" id="3865102">(</span><span class="ident" id="3865103">ok</span>&nbsp;<span class="builtintype" id="3865106">bool</span><span class="op" id="3865110">)</span><span class="op" id="3865111">)</span>&nbsp;<span class="op" id="3865113">(</span><span class="ident" id="3865114">ok</span>&nbsp;<span class="builtintype" id="3865117">bool</span><span class="op" id="3865121">)</span><br>
<span class="lineno"></span><span class="op" id="3865123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3865126">//&nbsp;The&nbsp;wire&nbsp;format&nbsp;for&nbsp;the&nbsp;DNS&nbsp;packet&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3865172">type</span>&nbsp;<span class="ident" id="3865177">dnsHeader</span>&nbsp;<span class="keyword" id="3865187">struct</span>&nbsp;<span class="op" id="3865194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865197">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3865232">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865240">Bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3865275">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865283">Qdcount</span><span class="op" id="3865290">,</span>&nbsp;<span class="ident" id="3865292">Ancount</span><span class="op" id="3865299">,</span>&nbsp;<span class="ident" id="3865301">Nscount</span><span class="op" id="3865308">,</span>&nbsp;<span class="ident" id="3865310">Arcount</span>&nbsp;<span class="builtintype" id="3865318">uint16</span><br>
<span class="lineno">90</span><span class="op" id="3865325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3865328">func</span>&nbsp;<span class="op" id="3865333">(</span><span class="ident" id="3865334">h</span>&nbsp;<span class="op" id="3865336">*</span><span class="ident" id="3865337">dnsHeader</span><span class="op" id="3865346">)</span>&nbsp;<span class="ident" id="3865348">Walk</span><span class="op" id="3865352">(</span><span class="ident" id="3865353">f</span>&nbsp;<span class="keyword" id="3865355">func</span><span class="op" id="3865359">(</span><span class="ident" id="3865360">v</span>&nbsp;<span class="keyword" id="3865362">interface</span><span class="op" id="3865371">{</span><span class="op" id="3865372">}</span><span class="op" id="3865373">,</span>&nbsp;<span class="ident" id="3865375">name</span><span class="op" id="3865379">,</span>&nbsp;<span class="ident" id="3865381">tag</span>&nbsp;<span class="builtintype" id="3865385">string</span><span class="op" id="3865391">)</span>&nbsp;<span class="builtintype" id="3865393">bool</span><span class="op" id="3865397">)</span>&nbsp;<span class="builtintype" id="3865399">bool</span>&nbsp;<span class="op" id="3865404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3865407">return</span>&nbsp;<span class="ident" id="3865414">f</span><span class="op" id="3865415">(</span><span class="op" id="3865416">&amp;</span><span class="ident" id="3865417">h</span><span class="op" id="3865418">.</span><span class="ident" id="3865419">Id</span><span class="op" id="3865421">,</span>&nbsp;<span class="string" id="3865423">&#34;Id&#34;</span><span class="op" id="3865427">,</span>&nbsp;<span class="string" id="3865429">&#34;&#34;</span><span class="op" id="3865431">)</span>&nbsp;<span class="op" id="3865433">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865438">f</span><span class="op" id="3865439">(</span><span class="op" id="3865440">&amp;</span><span class="ident" id="3865441">h</span><span class="op" id="3865442">.</span><span class="ident" id="3865443">Bits</span><span class="op" id="3865447">,</span>&nbsp;<span class="string" id="3865449">&#34;Bits&#34;</span><span class="op" id="3865455">,</span>&nbsp;<span class="string" id="3865457">&#34;&#34;</span><span class="op" id="3865459">)</span>&nbsp;<span class="op" id="3865461">&amp;&amp;</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865466">f</span><span class="op" id="3865467">(</span><span class="op" id="3865468">&amp;</span><span class="ident" id="3865469">h</span><span class="op" id="3865470">.</span><span class="ident" id="3865471">Qdcount</span><span class="op" id="3865478">,</span>&nbsp;<span class="string" id="3865480">&#34;Qdcount&#34;</span><span class="op" id="3865489">,</span>&nbsp;<span class="string" id="3865491">&#34;&#34;</span><span class="op" id="3865493">)</span>&nbsp;<span class="op" id="3865495">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865500">f</span><span class="op" id="3865501">(</span><span class="op" id="3865502">&amp;</span><span class="ident" id="3865503">h</span><span class="op" id="3865504">.</span><span class="ident" id="3865505">Ancount</span><span class="op" id="3865512">,</span>&nbsp;<span class="string" id="3865514">&#34;Ancount&#34;</span><span class="op" id="3865523">,</span>&nbsp;<span class="string" id="3865525">&#34;&#34;</span><span class="op" id="3865527">)</span>&nbsp;<span class="op" id="3865529">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865534">f</span><span class="op" id="3865535">(</span><span class="op" id="3865536">&amp;</span><span class="ident" id="3865537">h</span><span class="op" id="3865538">.</span><span class="ident" id="3865539">Nscount</span><span class="op" id="3865546">,</span>&nbsp;<span class="string" id="3865548">&#34;Nscount&#34;</span><span class="op" id="3865557">,</span>&nbsp;<span class="string" id="3865559">&#34;&#34;</span><span class="op" id="3865561">)</span>&nbsp;<span class="op" id="3865563">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865568">f</span><span class="op" id="3865569">(</span><span class="op" id="3865570">&amp;</span><span class="ident" id="3865571">h</span><span class="op" id="3865572">.</span><span class="ident" id="3865573">Arcount</span><span class="op" id="3865580">,</span>&nbsp;<span class="string" id="3865582">&#34;Arcount&#34;</span><span class="op" id="3865591">,</span>&nbsp;<span class="string" id="3865593">&#34;&#34;</span><span class="op" id="3865595">)</span><br>
<span class="lineno"></span><span class="op" id="3865597">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="3865600">const</span>&nbsp;<span class="op" id="3865606">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3865609">//&nbsp;dnsHeader.Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865628">_QR</span>&nbsp;<span class="op" id="3865632">=</span>&nbsp;<span class="num" id="3865634">1</span>&nbsp;<span class="op" id="3865636">&lt;&lt;</span>&nbsp;<span class="num" id="3865639">15</span>&nbsp;<span class="comment" id="3865642">//&nbsp;query/response&nbsp;(response=1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865674">_AA</span>&nbsp;<span class="op" id="3865678">=</span>&nbsp;<span class="num" id="3865680">1</span>&nbsp;<span class="op" id="3865682">&lt;&lt;</span>&nbsp;<span class="num" id="3865685">10</span>&nbsp;<span class="comment" id="3865688">//&nbsp;authoritative</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865706">_TC</span>&nbsp;<span class="op" id="3865710">=</span>&nbsp;<span class="num" id="3865712">1</span>&nbsp;<span class="op" id="3865714">&lt;&lt;</span>&nbsp;<span class="num" id="3865717">9</span>&nbsp;&nbsp;<span class="comment" id="3865720">//&nbsp;truncated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865734">_RD</span>&nbsp;<span class="op" id="3865738">=</span>&nbsp;<span class="num" id="3865740">1</span>&nbsp;<span class="op" id="3865742">&lt;&lt;</span>&nbsp;<span class="num" id="3865745">8</span>&nbsp;&nbsp;<span class="comment" id="3865748">//&nbsp;recursion&nbsp;desired</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865770">_RA</span>&nbsp;<span class="op" id="3865774">=</span>&nbsp;<span class="num" id="3865776">1</span>&nbsp;<span class="op" id="3865778">&lt;&lt;</span>&nbsp;<span class="num" id="3865781">7</span>&nbsp;&nbsp;<span class="comment" id="3865784">//&nbsp;recursion&nbsp;available</span><br>
<span class="lineno"></span><span class="op" id="3865807">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="3865810">//&nbsp;DNS&nbsp;queries.</span><br>
<span class="lineno"></span><span class="keyword" id="3865826">type</span>&nbsp;<span class="ident" id="3865831">dnsQuestion</span>&nbsp;<span class="keyword" id="3865843">struct</span>&nbsp;<span class="op" id="3865850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865853">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3865860">string</span>&nbsp;<span class="string" id="3865867">`net:&#34;domain-name&#34;`</span>&nbsp;<span class="comment" id="3865887">//&nbsp;`net:&#34;domain-name&#34;`&nbsp;specifies&nbsp;encoding;&nbsp;see&nbsp;packers&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865949">Qtype</span>&nbsp;&nbsp;<span class="builtintype" id="3865956">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3865964">Qclass</span>&nbsp;<span class="builtintype" id="3865971">uint16</span><br>
<span class="lineno">115</span><span class="op" id="3865978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3865981">func</span>&nbsp;<span class="op" id="3865986">(</span><span class="ident" id="3865987">q</span>&nbsp;<span class="op" id="3865989">*</span><span class="ident" id="3865990">dnsQuestion</span><span class="op" id="3866001">)</span>&nbsp;<span class="ident" id="3866003">Walk</span><span class="op" id="3866007">(</span><span class="ident" id="3866008">f</span>&nbsp;<span class="keyword" id="3866010">func</span><span class="op" id="3866014">(</span><span class="ident" id="3866015">v</span>&nbsp;<span class="keyword" id="3866017">interface</span><span class="op" id="3866026">{</span><span class="op" id="3866027">}</span><span class="op" id="3866028">,</span>&nbsp;<span class="ident" id="3866030">name</span><span class="op" id="3866034">,</span>&nbsp;<span class="ident" id="3866036">tag</span>&nbsp;<span class="builtintype" id="3866040">string</span><span class="op" id="3866046">)</span>&nbsp;<span class="builtintype" id="3866048">bool</span><span class="op" id="3866052">)</span>&nbsp;<span class="builtintype" id="3866054">bool</span>&nbsp;<span class="op" id="3866059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3866062">return</span>&nbsp;<span class="ident" id="3866069">f</span><span class="op" id="3866070">(</span><span class="op" id="3866071">&amp;</span><span class="ident" id="3866072">q</span><span class="op" id="3866073">.</span><span class="ident" id="3866074">Name</span><span class="op" id="3866078">,</span>&nbsp;<span class="string" id="3866080">&#34;Name&#34;</span><span class="op" id="3866086">,</span>&nbsp;<span class="string" id="3866088">&#34;domain&#34;</span><span class="op" id="3866096">)</span>&nbsp;<span class="op" id="3866098">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3866103">f</span><span class="op" id="3866104">(</span><span class="op" id="3866105">&amp;</span><span class="ident" id="3866106">q</span><span class="op" id="3866107">.</span><span class="ident" id="3866108">Qtype</span><span class="op" id="3866113">,</span>&nbsp;<span class="string" id="3866115">&#34;Qtype&#34;</span><span class="op" id="3866122">,</span>&nbsp;<span class="string" id="3866124">&#34;&#34;</span><span class="op" id="3866126">)</span>&nbsp;<span class="op" id="3866128">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3866133">f</span><span class="op" id="3866134">(</span><span class="op" id="3866135">&amp;</span><span class="ident" id="3866136">q</span><span class="op" id="3866137">.</span><span class="ident" id="3866138">Qclass</span><span class="op" id="3866144">,</span>&nbsp;<span class="string" id="3866146">&#34;Qclass&#34;</span><span class="op" id="3866154">,</span>&nbsp;<span class="string" id="3866156">&#34;&#34;</span><span class="op" id="3866158">)</span><br>
<span class="lineno"></span><span class="op" id="3866160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3866163">//&nbsp;DNS&nbsp;responses&nbsp;(resource&nbsp;records).</span><br>
<span class="lineno"></span><span class="comment" id="3866200">//&nbsp;There&nbsp;are&nbsp;many&nbsp;types&nbsp;of&nbsp;messages,</span><br>
<span class="lineno">125</span><span class="comment" id="3866237">//&nbsp;but&nbsp;they&nbsp;all&nbsp;share&nbsp;the&nbsp;same&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3866276">type</span>&nbsp;<span class="ident" id="3866281">dnsRR_Header</span>&nbsp;<span class="keyword" id="3866294">struct</span>&nbsp;<span class="op" id="3866301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3866304">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3866313">string</span>&nbsp;<span class="string" id="3866320">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3866341">Rrtype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3866350">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3866358">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3866367">uint16</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3866375">Ttl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3866384">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3866392">Rdlength</span>&nbsp;<span class="builtintype" id="3866401">uint16</span>&nbsp;<span class="comment" id="3866408">//&nbsp;length&nbsp;of&nbsp;data&nbsp;after&nbsp;header</span><br>
<span class="lineno"></span><span class="op" id="3866439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3866442">func</span>&nbsp;<span class="op" id="3866447">(</span><span class="ident" id="3866448">h</span>&nbsp;<span class="op" id="3866450">*</span><span class="ident" id="3866451">dnsRR_Header</span><span class="op" id="3866463">)</span>&nbsp;<span class="ident" id="3866465">Header</span><span class="op" id="3866471">(</span><span class="op" id="3866472">)</span>&nbsp;<span class="op" id="3866474">*</span><span class="ident" id="3866475">dnsRR_Header</span>&nbsp;<span class="op" id="3866488">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3866491">return</span>&nbsp;<span class="ident" id="3866498">h</span><br>
<span class="lineno"></span><span class="op" id="3866500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3866503">func</span>&nbsp;<span class="op" id="3866508">(</span><span class="ident" id="3866509">h</span>&nbsp;<span class="op" id="3866511">*</span><span class="ident" id="3866512">dnsRR_Header</span><span class="op" id="3866524">)</span>&nbsp;<span class="ident" id="3866526">Walk</span><span class="op" id="3866530">(</span><span class="ident" id="3866531">f</span>&nbsp;<span class="keyword" id="3866533">func</span><span class="op" id="3866537">(</span><span class="ident" id="3866538">v</span>&nbsp;<span class="keyword" id="3866540">interface</span><span class="op" id="3866549">{</span><span class="op" id="3866550">}</span><span class="op" id="3866551">,</span>&nbsp;<span class="ident" id="3866553">name</span><span class="op" id="3866557">,</span>&nbsp;<span class="ident" id="3866559">tag</span>&nbsp;<span class="builtintype" id="3866563">string</span><span class="op" id="3866569">)</span>&nbsp;<span class="builtintype" id="3866571">bool</span><span class="op" id="3866575">)</span>&nbsp;<span class="builtintype" id="3866577">bool</span>&nbsp;<span class="op" id="3866582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3866585">return</span>&nbsp;<span class="ident" id="3866592">f</span><span class="op" id="3866593">(</span><span class="op" id="3866594">&amp;</span><span class="ident" id="3866595">h</span><span class="op" id="3866596">.</span><span class="ident" id="3866597">Name</span><span class="op" id="3866601">,</span>&nbsp;<span class="string" id="3866603">&#34;Name&#34;</span><span class="op" id="3866609">,</span>&nbsp;<span class="string" id="3866611">&#34;domain&#34;</span><span class="op" id="3866619">)</span>&nbsp;<span class="op" id="3866621">&amp;&amp;</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3866626">f</span><span class="op" id="3866627">(</span><span class="op" id="3866628">&amp;</span><span class="ident" id="3866629">h</span><span class="op" id="3866630">.</span><span class="ident" id="3866631">Rrtype</span><span class="op" id="3866637">,</span>&nbsp;<span class="string" id="3866639">&#34;Rrtype&#34;</span><span class="op" id="3866647">,</span>&nbsp;<span class="string" id="3866649">&#34;&#34;</span><span class="op" id="3866651">)</span>&nbsp;<span class="op" id="3866653">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3866658">f</span><span class="op" id="3866659">(</span><span class="op" id="3866660">&amp;</span><span class="ident" id="3866661">h</span><span class="op" id="3866662">.</span><span class="ident" id="3866663">Class</span><span class="op" id="3866668">,</span>&nbsp;<span class="string" id="3866670">&#34;Class&#34;</span><span class="op" id="3866677">,</span>&nbsp;<span class="string" id="3866679">&#34;&#34;</span><span class="op" id="3866681">)</span>&nbsp;<span class="op" id="3866683">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3866688">f</span><span class="op" id="3866689">(</span><span class="op" id="3866690">&amp;</span><span class="ident" id="3866691">h</span><span class="op" id="3866692">.</span><span class="ident" id="3866693">Ttl</span><span class="op" id="3866696">,</span>&nbsp;<span class="string" id="3866698">&#34;Ttl&#34;</span><span class="op" id="3866703">,</span>&nbsp;<span class="string" id="3866705">&#34;&#34;</span><span class="op" id="3866707">)</span>&nbsp;<span class="op" id="3866709">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3866714">f</span><span class="op" id="3866715">(</span><span class="op" id="3866716">&amp;</span><span class="ident" id="3866717">h</span><span class="op" id="3866718">.</span><span class="ident" id="3866719">Rdlength</span><span class="op" id="3866727">,</span>&nbsp;<span class="string" id="3866729">&#34;Rdlength&#34;</span><span class="op" id="3866739">,</span>&nbsp;<span class="string" id="3866741">&#34;&#34;</span><span class="op" id="3866743">)</span><br>
<span class="lineno"></span><span class="op" id="3866745">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="3866748">type</span>&nbsp;<span class="ident" id="3866753">dnsRR</span>&nbsp;<span class="keyword" id="3866759">interface</span>&nbsp;<span class="op" id="3866769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3866772">dnsStruct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3866783">Header</span><span class="op" id="3866789">(</span><span class="op" id="3866790">)</span>&nbsp;<span class="op" id="3866792">*</span><span class="ident" id="3866793">dnsRR_Header</span><br>
<span class="lineno"></span><span class="op" id="3866806">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="3866809">//&nbsp;Specific&nbsp;DNS&nbsp;RR&nbsp;formats&nbsp;for&nbsp;each&nbsp;query&nbsp;type.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3866858">type</span>&nbsp;<span class="ident" id="3866863">dnsRR_CNAME</span>&nbsp;<span class="keyword" id="3866875">struct</span>&nbsp;<span class="op" id="3866882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3866885">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3866891">dnsRR_Header</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3866905">Cname</span>&nbsp;<span class="builtintype" id="3866911">string</span>&nbsp;<span class="string" id="3866918">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3866938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3866941">func</span>&nbsp;<span class="op" id="3866946">(</span><span class="ident" id="3866947">rr</span>&nbsp;<span class="op" id="3866950">*</span><span class="ident" id="3866951">dnsRR_CNAME</span><span class="op" id="3866962">)</span>&nbsp;<span class="ident" id="3866964">Header</span><span class="op" id="3866970">(</span><span class="op" id="3866971">)</span>&nbsp;<span class="op" id="3866973">*</span><span class="ident" id="3866974">dnsRR_Header</span>&nbsp;<span class="op" id="3866987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3866990">return</span>&nbsp;<span class="op" id="3866997">&amp;</span><span class="ident" id="3866998">rr</span><span class="op" id="3867000">.</span><span class="ident" id="3867001">Hdr</span><br>
<span class="lineno">160</span><span class="op" id="3867005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3867008">func</span>&nbsp;<span class="op" id="3867013">(</span><span class="ident" id="3867014">rr</span>&nbsp;<span class="op" id="3867017">*</span><span class="ident" id="3867018">dnsRR_CNAME</span><span class="op" id="3867029">)</span>&nbsp;<span class="ident" id="3867031">Walk</span><span class="op" id="3867035">(</span><span class="ident" id="3867036">f</span>&nbsp;<span class="keyword" id="3867038">func</span><span class="op" id="3867042">(</span><span class="ident" id="3867043">v</span>&nbsp;<span class="keyword" id="3867045">interface</span><span class="op" id="3867054">{</span><span class="op" id="3867055">}</span><span class="op" id="3867056">,</span>&nbsp;<span class="ident" id="3867058">name</span><span class="op" id="3867062">,</span>&nbsp;<span class="ident" id="3867064">tag</span>&nbsp;<span class="builtintype" id="3867068">string</span><span class="op" id="3867074">)</span>&nbsp;<span class="builtintype" id="3867076">bool</span><span class="op" id="3867080">)</span>&nbsp;<span class="builtintype" id="3867082">bool</span>&nbsp;<span class="op" id="3867087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3867090">return</span>&nbsp;<span class="ident" id="3867097">rr</span><span class="op" id="3867099">.</span><span class="ident" id="3867100">Hdr</span><span class="op" id="3867103">.</span><span class="ident" id="3867104">Walk</span><span class="op" id="3867108">(</span><span class="ident" id="3867109">f</span><span class="op" id="3867110">)</span>&nbsp;<span class="op" id="3867112">&amp;&amp;</span>&nbsp;<span class="ident" id="3867115">f</span><span class="op" id="3867116">(</span><span class="op" id="3867117">&amp;</span><span class="ident" id="3867118">rr</span><span class="op" id="3867120">.</span><span class="ident" id="3867121">Cname</span><span class="op" id="3867126">,</span>&nbsp;<span class="string" id="3867128">&#34;Cname&#34;</span><span class="op" id="3867135">,</span>&nbsp;<span class="string" id="3867137">&#34;domain&#34;</span><span class="op" id="3867145">)</span><br>
<span class="lineno"></span><span class="op" id="3867147">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="3867150">type</span>&nbsp;<span class="ident" id="3867155">dnsRR_HINFO</span>&nbsp;<span class="keyword" id="3867167">struct</span>&nbsp;<span class="op" id="3867174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3867177">Hdr</span>&nbsp;<span class="ident" id="3867181">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3867195">Cpu</span>&nbsp;<span class="builtintype" id="3867199">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3867207">Os</span>&nbsp;&nbsp;<span class="builtintype" id="3867211">string</span><br>
<span class="lineno">170</span><span class="op" id="3867218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3867221">func</span>&nbsp;<span class="op" id="3867226">(</span><span class="ident" id="3867227">rr</span>&nbsp;<span class="op" id="3867230">*</span><span class="ident" id="3867231">dnsRR_HINFO</span><span class="op" id="3867242">)</span>&nbsp;<span class="ident" id="3867244">Header</span><span class="op" id="3867250">(</span><span class="op" id="3867251">)</span>&nbsp;<span class="op" id="3867253">*</span><span class="ident" id="3867254">dnsRR_Header</span>&nbsp;<span class="op" id="3867267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3867270">return</span>&nbsp;<span class="op" id="3867277">&amp;</span><span class="ident" id="3867278">rr</span><span class="op" id="3867280">.</span><span class="ident" id="3867281">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3867285">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="3867288">func</span>&nbsp;<span class="op" id="3867293">(</span><span class="ident" id="3867294">rr</span>&nbsp;<span class="op" id="3867297">*</span><span class="ident" id="3867298">dnsRR_HINFO</span><span class="op" id="3867309">)</span>&nbsp;<span class="ident" id="3867311">Walk</span><span class="op" id="3867315">(</span><span class="ident" id="3867316">f</span>&nbsp;<span class="keyword" id="3867318">func</span><span class="op" id="3867322">(</span><span class="ident" id="3867323">v</span>&nbsp;<span class="keyword" id="3867325">interface</span><span class="op" id="3867334">{</span><span class="op" id="3867335">}</span><span class="op" id="3867336">,</span>&nbsp;<span class="ident" id="3867338">name</span><span class="op" id="3867342">,</span>&nbsp;<span class="ident" id="3867344">tag</span>&nbsp;<span class="builtintype" id="3867348">string</span><span class="op" id="3867354">)</span>&nbsp;<span class="builtintype" id="3867356">bool</span><span class="op" id="3867360">)</span>&nbsp;<span class="builtintype" id="3867362">bool</span>&nbsp;<span class="op" id="3867367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3867370">return</span>&nbsp;<span class="ident" id="3867377">rr</span><span class="op" id="3867379">.</span><span class="ident" id="3867380">Hdr</span><span class="op" id="3867383">.</span><span class="ident" id="3867384">Walk</span><span class="op" id="3867388">(</span><span class="ident" id="3867389">f</span><span class="op" id="3867390">)</span>&nbsp;<span class="op" id="3867392">&amp;&amp;</span>&nbsp;<span class="ident" id="3867395">f</span><span class="op" id="3867396">(</span><span class="op" id="3867397">&amp;</span><span class="ident" id="3867398">rr</span><span class="op" id="3867400">.</span><span class="ident" id="3867401">Cpu</span><span class="op" id="3867404">,</span>&nbsp;<span class="string" id="3867406">&#34;Cpu&#34;</span><span class="op" id="3867411">,</span>&nbsp;<span class="string" id="3867413">&#34;&#34;</span><span class="op" id="3867415">)</span>&nbsp;<span class="op" id="3867417">&amp;&amp;</span>&nbsp;<span class="ident" id="3867420">f</span><span class="op" id="3867421">(</span><span class="op" id="3867422">&amp;</span><span class="ident" id="3867423">rr</span><span class="op" id="3867425">.</span><span class="ident" id="3867426">Os</span><span class="op" id="3867428">,</span>&nbsp;<span class="string" id="3867430">&#34;Os&#34;</span><span class="op" id="3867434">,</span>&nbsp;<span class="string" id="3867436">&#34;&#34;</span><span class="op" id="3867438">)</span><br>
<span class="lineno"></span><span class="op" id="3867440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="3867443">type</span>&nbsp;<span class="ident" id="3867448">dnsRR_MB</span>&nbsp;<span class="keyword" id="3867457">struct</span>&nbsp;<span class="op" id="3867464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3867467">Hdr</span>&nbsp;<span class="ident" id="3867471">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3867485">Mb</span>&nbsp;&nbsp;<span class="builtintype" id="3867489">string</span>&nbsp;<span class="string" id="3867496">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3867516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3867519">func</span>&nbsp;<span class="op" id="3867524">(</span><span class="ident" id="3867525">rr</span>&nbsp;<span class="op" id="3867528">*</span><span class="ident" id="3867529">dnsRR_MB</span><span class="op" id="3867537">)</span>&nbsp;<span class="ident" id="3867539">Header</span><span class="op" id="3867545">(</span><span class="op" id="3867546">)</span>&nbsp;<span class="op" id="3867548">*</span><span class="ident" id="3867549">dnsRR_Header</span>&nbsp;<span class="op" id="3867562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3867565">return</span>&nbsp;<span class="op" id="3867572">&amp;</span><span class="ident" id="3867573">rr</span><span class="op" id="3867575">.</span><span class="ident" id="3867576">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3867580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3867583">func</span>&nbsp;<span class="op" id="3867588">(</span><span class="ident" id="3867589">rr</span>&nbsp;<span class="op" id="3867592">*</span><span class="ident" id="3867593">dnsRR_MB</span><span class="op" id="3867601">)</span>&nbsp;<span class="ident" id="3867603">Walk</span><span class="op" id="3867607">(</span><span class="ident" id="3867608">f</span>&nbsp;<span class="keyword" id="3867610">func</span><span class="op" id="3867614">(</span><span class="ident" id="3867615">v</span>&nbsp;<span class="keyword" id="3867617">interface</span><span class="op" id="3867626">{</span><span class="op" id="3867627">}</span><span class="op" id="3867628">,</span>&nbsp;<span class="ident" id="3867630">name</span><span class="op" id="3867634">,</span>&nbsp;<span class="ident" id="3867636">tag</span>&nbsp;<span class="builtintype" id="3867640">string</span><span class="op" id="3867646">)</span>&nbsp;<span class="builtintype" id="3867648">bool</span><span class="op" id="3867652">)</span>&nbsp;<span class="builtintype" id="3867654">bool</span>&nbsp;<span class="op" id="3867659">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3867662">return</span>&nbsp;<span class="ident" id="3867669">rr</span><span class="op" id="3867671">.</span><span class="ident" id="3867672">Hdr</span><span class="op" id="3867675">.</span><span class="ident" id="3867676">Walk</span><span class="op" id="3867680">(</span><span class="ident" id="3867681">f</span><span class="op" id="3867682">)</span>&nbsp;<span class="op" id="3867684">&amp;&amp;</span>&nbsp;<span class="ident" id="3867687">f</span><span class="op" id="3867688">(</span><span class="op" id="3867689">&amp;</span><span class="ident" id="3867690">rr</span><span class="op" id="3867692">.</span><span class="ident" id="3867693">Mb</span><span class="op" id="3867695">,</span>&nbsp;<span class="string" id="3867697">&#34;Mb&#34;</span><span class="op" id="3867701">,</span>&nbsp;<span class="string" id="3867703">&#34;domain&#34;</span><span class="op" id="3867711">)</span><br>
<span class="lineno"></span><span class="op" id="3867713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3867716">type</span>&nbsp;<span class="ident" id="3867721">dnsRR_MG</span>&nbsp;<span class="keyword" id="3867730">struct</span>&nbsp;<span class="op" id="3867737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3867740">Hdr</span>&nbsp;<span class="ident" id="3867744">dnsRR_Header</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3867758">Mg</span>&nbsp;&nbsp;<span class="builtintype" id="3867762">string</span>&nbsp;<span class="string" id="3867769">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3867789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3867792">func</span>&nbsp;<span class="op" id="3867797">(</span><span class="ident" id="3867798">rr</span>&nbsp;<span class="op" id="3867801">*</span><span class="ident" id="3867802">dnsRR_MG</span><span class="op" id="3867810">)</span>&nbsp;<span class="ident" id="3867812">Header</span><span class="op" id="3867818">(</span><span class="op" id="3867819">)</span>&nbsp;<span class="op" id="3867821">*</span><span class="ident" id="3867822">dnsRR_Header</span>&nbsp;<span class="op" id="3867835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3867838">return</span>&nbsp;<span class="op" id="3867845">&amp;</span><span class="ident" id="3867846">rr</span><span class="op" id="3867848">.</span><span class="ident" id="3867849">Hdr</span><br>
<span class="lineno">200</span><span class="op" id="3867853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3867856">func</span>&nbsp;<span class="op" id="3867861">(</span><span class="ident" id="3867862">rr</span>&nbsp;<span class="op" id="3867865">*</span><span class="ident" id="3867866">dnsRR_MG</span><span class="op" id="3867874">)</span>&nbsp;<span class="ident" id="3867876">Walk</span><span class="op" id="3867880">(</span><span class="ident" id="3867881">f</span>&nbsp;<span class="keyword" id="3867883">func</span><span class="op" id="3867887">(</span><span class="ident" id="3867888">v</span>&nbsp;<span class="keyword" id="3867890">interface</span><span class="op" id="3867899">{</span><span class="op" id="3867900">}</span><span class="op" id="3867901">,</span>&nbsp;<span class="ident" id="3867903">name</span><span class="op" id="3867907">,</span>&nbsp;<span class="ident" id="3867909">tag</span>&nbsp;<span class="builtintype" id="3867913">string</span><span class="op" id="3867919">)</span>&nbsp;<span class="builtintype" id="3867921">bool</span><span class="op" id="3867925">)</span>&nbsp;<span class="builtintype" id="3867927">bool</span>&nbsp;<span class="op" id="3867932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3867935">return</span>&nbsp;<span class="ident" id="3867942">rr</span><span class="op" id="3867944">.</span><span class="ident" id="3867945">Hdr</span><span class="op" id="3867948">.</span><span class="ident" id="3867949">Walk</span><span class="op" id="3867953">(</span><span class="ident" id="3867954">f</span><span class="op" id="3867955">)</span>&nbsp;<span class="op" id="3867957">&amp;&amp;</span>&nbsp;<span class="ident" id="3867960">f</span><span class="op" id="3867961">(</span><span class="op" id="3867962">&amp;</span><span class="ident" id="3867963">rr</span><span class="op" id="3867965">.</span><span class="ident" id="3867966">Mg</span><span class="op" id="3867968">,</span>&nbsp;<span class="string" id="3867970">&#34;Mg&#34;</span><span class="op" id="3867974">,</span>&nbsp;<span class="string" id="3867976">&#34;domain&#34;</span><span class="op" id="3867984">)</span><br>
<span class="lineno"></span><span class="op" id="3867986">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="3867989">type</span>&nbsp;<span class="ident" id="3867994">dnsRR_MINFO</span>&nbsp;<span class="keyword" id="3868006">struct</span>&nbsp;<span class="op" id="3868013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3868016">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3868022">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3868036">Rmail</span>&nbsp;<span class="builtintype" id="3868042">string</span>&nbsp;<span class="string" id="3868049">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3868070">Email</span>&nbsp;<span class="builtintype" id="3868076">string</span>&nbsp;<span class="string" id="3868083">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">210</span><span class="op" id="3868103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3868106">func</span>&nbsp;<span class="op" id="3868111">(</span><span class="ident" id="3868112">rr</span>&nbsp;<span class="op" id="3868115">*</span><span class="ident" id="3868116">dnsRR_MINFO</span><span class="op" id="3868127">)</span>&nbsp;<span class="ident" id="3868129">Header</span><span class="op" id="3868135">(</span><span class="op" id="3868136">)</span>&nbsp;<span class="op" id="3868138">*</span><span class="ident" id="3868139">dnsRR_Header</span>&nbsp;<span class="op" id="3868152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3868155">return</span>&nbsp;<span class="op" id="3868162">&amp;</span><span class="ident" id="3868163">rr</span><span class="op" id="3868165">.</span><span class="ident" id="3868166">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3868170">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="3868173">func</span>&nbsp;<span class="op" id="3868178">(</span><span class="ident" id="3868179">rr</span>&nbsp;<span class="op" id="3868182">*</span><span class="ident" id="3868183">dnsRR_MINFO</span><span class="op" id="3868194">)</span>&nbsp;<span class="ident" id="3868196">Walk</span><span class="op" id="3868200">(</span><span class="ident" id="3868201">f</span>&nbsp;<span class="keyword" id="3868203">func</span><span class="op" id="3868207">(</span><span class="ident" id="3868208">v</span>&nbsp;<span class="keyword" id="3868210">interface</span><span class="op" id="3868219">{</span><span class="op" id="3868220">}</span><span class="op" id="3868221">,</span>&nbsp;<span class="ident" id="3868223">name</span><span class="op" id="3868227">,</span>&nbsp;<span class="ident" id="3868229">tag</span>&nbsp;<span class="builtintype" id="3868233">string</span><span class="op" id="3868239">)</span>&nbsp;<span class="builtintype" id="3868241">bool</span><span class="op" id="3868245">)</span>&nbsp;<span class="builtintype" id="3868247">bool</span>&nbsp;<span class="op" id="3868252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3868255">return</span>&nbsp;<span class="ident" id="3868262">rr</span><span class="op" id="3868264">.</span><span class="ident" id="3868265">Hdr</span><span class="op" id="3868268">.</span><span class="ident" id="3868269">Walk</span><span class="op" id="3868273">(</span><span class="ident" id="3868274">f</span><span class="op" id="3868275">)</span>&nbsp;<span class="op" id="3868277">&amp;&amp;</span>&nbsp;<span class="ident" id="3868280">f</span><span class="op" id="3868281">(</span><span class="op" id="3868282">&amp;</span><span class="ident" id="3868283">rr</span><span class="op" id="3868285">.</span><span class="ident" id="3868286">Rmail</span><span class="op" id="3868291">,</span>&nbsp;<span class="string" id="3868293">&#34;Rmail&#34;</span><span class="op" id="3868300">,</span>&nbsp;<span class="string" id="3868302">&#34;domain&#34;</span><span class="op" id="3868310">)</span>&nbsp;<span class="op" id="3868312">&amp;&amp;</span>&nbsp;<span class="ident" id="3868315">f</span><span class="op" id="3868316">(</span><span class="op" id="3868317">&amp;</span><span class="ident" id="3868318">rr</span><span class="op" id="3868320">.</span><span class="ident" id="3868321">Email</span><span class="op" id="3868326">,</span>&nbsp;<span class="string" id="3868328">&#34;Email&#34;</span><span class="op" id="3868335">,</span>&nbsp;<span class="string" id="3868337">&#34;domain&#34;</span><span class="op" id="3868345">)</span><br>
<span class="lineno"></span><span class="op" id="3868347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3868350">type</span>&nbsp;<span class="ident" id="3868355">dnsRR_MR</span>&nbsp;<span class="keyword" id="3868364">struct</span>&nbsp;<span class="op" id="3868371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3868374">Hdr</span>&nbsp;<span class="ident" id="3868378">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3868392">Mr</span>&nbsp;&nbsp;<span class="builtintype" id="3868396">string</span>&nbsp;<span class="string" id="3868403">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3868423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="3868426">func</span>&nbsp;<span class="op" id="3868431">(</span><span class="ident" id="3868432">rr</span>&nbsp;<span class="op" id="3868435">*</span><span class="ident" id="3868436">dnsRR_MR</span><span class="op" id="3868444">)</span>&nbsp;<span class="ident" id="3868446">Header</span><span class="op" id="3868452">(</span><span class="op" id="3868453">)</span>&nbsp;<span class="op" id="3868455">*</span><span class="ident" id="3868456">dnsRR_Header</span>&nbsp;<span class="op" id="3868469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3868472">return</span>&nbsp;<span class="op" id="3868479">&amp;</span><span class="ident" id="3868480">rr</span><span class="op" id="3868482">.</span><span class="ident" id="3868483">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3868487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3868490">func</span>&nbsp;<span class="op" id="3868495">(</span><span class="ident" id="3868496">rr</span>&nbsp;<span class="op" id="3868499">*</span><span class="ident" id="3868500">dnsRR_MR</span><span class="op" id="3868508">)</span>&nbsp;<span class="ident" id="3868510">Walk</span><span class="op" id="3868514">(</span><span class="ident" id="3868515">f</span>&nbsp;<span class="keyword" id="3868517">func</span><span class="op" id="3868521">(</span><span class="ident" id="3868522">v</span>&nbsp;<span class="keyword" id="3868524">interface</span><span class="op" id="3868533">{</span><span class="op" id="3868534">}</span><span class="op" id="3868535">,</span>&nbsp;<span class="ident" id="3868537">name</span><span class="op" id="3868541">,</span>&nbsp;<span class="ident" id="3868543">tag</span>&nbsp;<span class="builtintype" id="3868547">string</span><span class="op" id="3868553">)</span>&nbsp;<span class="builtintype" id="3868555">bool</span><span class="op" id="3868559">)</span>&nbsp;<span class="builtintype" id="3868561">bool</span>&nbsp;<span class="op" id="3868566">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3868569">return</span>&nbsp;<span class="ident" id="3868576">rr</span><span class="op" id="3868578">.</span><span class="ident" id="3868579">Hdr</span><span class="op" id="3868582">.</span><span class="ident" id="3868583">Walk</span><span class="op" id="3868587">(</span><span class="ident" id="3868588">f</span><span class="op" id="3868589">)</span>&nbsp;<span class="op" id="3868591">&amp;&amp;</span>&nbsp;<span class="ident" id="3868594">f</span><span class="op" id="3868595">(</span><span class="op" id="3868596">&amp;</span><span class="ident" id="3868597">rr</span><span class="op" id="3868599">.</span><span class="ident" id="3868600">Mr</span><span class="op" id="3868602">,</span>&nbsp;<span class="string" id="3868604">&#34;Mr&#34;</span><span class="op" id="3868608">,</span>&nbsp;<span class="string" id="3868610">&#34;domain&#34;</span><span class="op" id="3868618">)</span><br>
<span class="lineno"></span><span class="op" id="3868620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3868623">type</span>&nbsp;<span class="ident" id="3868628">dnsRR_MX</span>&nbsp;<span class="keyword" id="3868637">struct</span>&nbsp;<span class="op" id="3868644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3868647">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3868652">dnsRR_Header</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3868666">Pref</span>&nbsp;<span class="builtintype" id="3868671">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3868679">Mx</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3868684">string</span>&nbsp;<span class="string" id="3868691">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3868711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3868714">func</span>&nbsp;<span class="op" id="3868719">(</span><span class="ident" id="3868720">rr</span>&nbsp;<span class="op" id="3868723">*</span><span class="ident" id="3868724">dnsRR_MX</span><span class="op" id="3868732">)</span>&nbsp;<span class="ident" id="3868734">Header</span><span class="op" id="3868740">(</span><span class="op" id="3868741">)</span>&nbsp;<span class="op" id="3868743">*</span><span class="ident" id="3868744">dnsRR_Header</span>&nbsp;<span class="op" id="3868757">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3868760">return</span>&nbsp;<span class="op" id="3868767">&amp;</span><span class="ident" id="3868768">rr</span><span class="op" id="3868770">.</span><span class="ident" id="3868771">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3868775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3868778">func</span>&nbsp;<span class="op" id="3868783">(</span><span class="ident" id="3868784">rr</span>&nbsp;<span class="op" id="3868787">*</span><span class="ident" id="3868788">dnsRR_MX</span><span class="op" id="3868796">)</span>&nbsp;<span class="ident" id="3868798">Walk</span><span class="op" id="3868802">(</span><span class="ident" id="3868803">f</span>&nbsp;<span class="keyword" id="3868805">func</span><span class="op" id="3868809">(</span><span class="ident" id="3868810">v</span>&nbsp;<span class="keyword" id="3868812">interface</span><span class="op" id="3868821">{</span><span class="op" id="3868822">}</span><span class="op" id="3868823">,</span>&nbsp;<span class="ident" id="3868825">name</span><span class="op" id="3868829">,</span>&nbsp;<span class="ident" id="3868831">tag</span>&nbsp;<span class="builtintype" id="3868835">string</span><span class="op" id="3868841">)</span>&nbsp;<span class="builtintype" id="3868843">bool</span><span class="op" id="3868847">)</span>&nbsp;<span class="builtintype" id="3868849">bool</span>&nbsp;<span class="op" id="3868854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3868857">return</span>&nbsp;<span class="ident" id="3868864">rr</span><span class="op" id="3868866">.</span><span class="ident" id="3868867">Hdr</span><span class="op" id="3868870">.</span><span class="ident" id="3868871">Walk</span><span class="op" id="3868875">(</span><span class="ident" id="3868876">f</span><span class="op" id="3868877">)</span>&nbsp;<span class="op" id="3868879">&amp;&amp;</span>&nbsp;<span class="ident" id="3868882">f</span><span class="op" id="3868883">(</span><span class="op" id="3868884">&amp;</span><span class="ident" id="3868885">rr</span><span class="op" id="3868887">.</span><span class="ident" id="3868888">Pref</span><span class="op" id="3868892">,</span>&nbsp;<span class="string" id="3868894">&#34;Pref&#34;</span><span class="op" id="3868900">,</span>&nbsp;<span class="string" id="3868902">&#34;&#34;</span><span class="op" id="3868904">)</span>&nbsp;<span class="op" id="3868906">&amp;&amp;</span>&nbsp;<span class="ident" id="3868909">f</span><span class="op" id="3868910">(</span><span class="op" id="3868911">&amp;</span><span class="ident" id="3868912">rr</span><span class="op" id="3868914">.</span><span class="ident" id="3868915">Mx</span><span class="op" id="3868917">,</span>&nbsp;<span class="string" id="3868919">&#34;Mx&#34;</span><span class="op" id="3868923">,</span>&nbsp;<span class="string" id="3868925">&#34;domain&#34;</span><span class="op" id="3868933">)</span><br>
<span class="lineno">245</span><span class="op" id="3868935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3868938">type</span>&nbsp;<span class="ident" id="3868943">dnsRR_NS</span>&nbsp;<span class="keyword" id="3868952">struct</span>&nbsp;<span class="op" id="3868959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3868962">Hdr</span>&nbsp;<span class="ident" id="3868966">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3868980">Ns</span>&nbsp;&nbsp;<span class="builtintype" id="3868984">string</span>&nbsp;<span class="string" id="3868991">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">250</span><span class="op" id="3869011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3869014">func</span>&nbsp;<span class="op" id="3869019">(</span><span class="ident" id="3869020">rr</span>&nbsp;<span class="op" id="3869023">*</span><span class="ident" id="3869024">dnsRR_NS</span><span class="op" id="3869032">)</span>&nbsp;<span class="ident" id="3869034">Header</span><span class="op" id="3869040">(</span><span class="op" id="3869041">)</span>&nbsp;<span class="op" id="3869043">*</span><span class="ident" id="3869044">dnsRR_Header</span>&nbsp;<span class="op" id="3869057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3869060">return</span>&nbsp;<span class="op" id="3869067">&amp;</span><span class="ident" id="3869068">rr</span><span class="op" id="3869070">.</span><span class="ident" id="3869071">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3869075">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="3869078">func</span>&nbsp;<span class="op" id="3869083">(</span><span class="ident" id="3869084">rr</span>&nbsp;<span class="op" id="3869087">*</span><span class="ident" id="3869088">dnsRR_NS</span><span class="op" id="3869096">)</span>&nbsp;<span class="ident" id="3869098">Walk</span><span class="op" id="3869102">(</span><span class="ident" id="3869103">f</span>&nbsp;<span class="keyword" id="3869105">func</span><span class="op" id="3869109">(</span><span class="ident" id="3869110">v</span>&nbsp;<span class="keyword" id="3869112">interface</span><span class="op" id="3869121">{</span><span class="op" id="3869122">}</span><span class="op" id="3869123">,</span>&nbsp;<span class="ident" id="3869125">name</span><span class="op" id="3869129">,</span>&nbsp;<span class="ident" id="3869131">tag</span>&nbsp;<span class="builtintype" id="3869135">string</span><span class="op" id="3869141">)</span>&nbsp;<span class="builtintype" id="3869143">bool</span><span class="op" id="3869147">)</span>&nbsp;<span class="builtintype" id="3869149">bool</span>&nbsp;<span class="op" id="3869154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3869157">return</span>&nbsp;<span class="ident" id="3869164">rr</span><span class="op" id="3869166">.</span><span class="ident" id="3869167">Hdr</span><span class="op" id="3869170">.</span><span class="ident" id="3869171">Walk</span><span class="op" id="3869175">(</span><span class="ident" id="3869176">f</span><span class="op" id="3869177">)</span>&nbsp;<span class="op" id="3869179">&amp;&amp;</span>&nbsp;<span class="ident" id="3869182">f</span><span class="op" id="3869183">(</span><span class="op" id="3869184">&amp;</span><span class="ident" id="3869185">rr</span><span class="op" id="3869187">.</span><span class="ident" id="3869188">Ns</span><span class="op" id="3869190">,</span>&nbsp;<span class="string" id="3869192">&#34;Ns&#34;</span><span class="op" id="3869196">,</span>&nbsp;<span class="string" id="3869198">&#34;domain&#34;</span><span class="op" id="3869206">)</span><br>
<span class="lineno"></span><span class="op" id="3869208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="3869211">type</span>&nbsp;<span class="ident" id="3869216">dnsRR_PTR</span>&nbsp;<span class="keyword" id="3869226">struct</span>&nbsp;<span class="op" id="3869233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3869236">Hdr</span>&nbsp;<span class="ident" id="3869240">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3869254">Ptr</span>&nbsp;<span class="builtintype" id="3869258">string</span>&nbsp;<span class="string" id="3869265">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3869285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="3869288">func</span>&nbsp;<span class="op" id="3869293">(</span><span class="ident" id="3869294">rr</span>&nbsp;<span class="op" id="3869297">*</span><span class="ident" id="3869298">dnsRR_PTR</span><span class="op" id="3869307">)</span>&nbsp;<span class="ident" id="3869309">Header</span><span class="op" id="3869315">(</span><span class="op" id="3869316">)</span>&nbsp;<span class="op" id="3869318">*</span><span class="ident" id="3869319">dnsRR_Header</span>&nbsp;<span class="op" id="3869332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3869335">return</span>&nbsp;<span class="op" id="3869342">&amp;</span><span class="ident" id="3869343">rr</span><span class="op" id="3869345">.</span><span class="ident" id="3869346">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3869350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3869353">func</span>&nbsp;<span class="op" id="3869358">(</span><span class="ident" id="3869359">rr</span>&nbsp;<span class="op" id="3869362">*</span><span class="ident" id="3869363">dnsRR_PTR</span><span class="op" id="3869372">)</span>&nbsp;<span class="ident" id="3869374">Walk</span><span class="op" id="3869378">(</span><span class="ident" id="3869379">f</span>&nbsp;<span class="keyword" id="3869381">func</span><span class="op" id="3869385">(</span><span class="ident" id="3869386">v</span>&nbsp;<span class="keyword" id="3869388">interface</span><span class="op" id="3869397">{</span><span class="op" id="3869398">}</span><span class="op" id="3869399">,</span>&nbsp;<span class="ident" id="3869401">name</span><span class="op" id="3869405">,</span>&nbsp;<span class="ident" id="3869407">tag</span>&nbsp;<span class="builtintype" id="3869411">string</span><span class="op" id="3869417">)</span>&nbsp;<span class="builtintype" id="3869419">bool</span><span class="op" id="3869423">)</span>&nbsp;<span class="builtintype" id="3869425">bool</span>&nbsp;<span class="op" id="3869430">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3869433">return</span>&nbsp;<span class="ident" id="3869440">rr</span><span class="op" id="3869442">.</span><span class="ident" id="3869443">Hdr</span><span class="op" id="3869446">.</span><span class="ident" id="3869447">Walk</span><span class="op" id="3869451">(</span><span class="ident" id="3869452">f</span><span class="op" id="3869453">)</span>&nbsp;<span class="op" id="3869455">&amp;&amp;</span>&nbsp;<span class="ident" id="3869458">f</span><span class="op" id="3869459">(</span><span class="op" id="3869460">&amp;</span><span class="ident" id="3869461">rr</span><span class="op" id="3869463">.</span><span class="ident" id="3869464">Ptr</span><span class="op" id="3869467">,</span>&nbsp;<span class="string" id="3869469">&#34;Ptr&#34;</span><span class="op" id="3869474">,</span>&nbsp;<span class="string" id="3869476">&#34;domain&#34;</span><span class="op" id="3869484">)</span><br>
<span class="lineno"></span><span class="op" id="3869486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3869489">type</span>&nbsp;<span class="ident" id="3869494">dnsRR_SOA</span>&nbsp;<span class="keyword" id="3869504">struct</span>&nbsp;<span class="op" id="3869511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3869514">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3869522">dnsRR_Header</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3869536">Ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3869544">string</span>&nbsp;<span class="string" id="3869551">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3869572">Mbox</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3869580">string</span>&nbsp;<span class="string" id="3869587">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3869608">Serial</span>&nbsp;&nbsp;<span class="builtintype" id="3869616">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3869624">Refresh</span>&nbsp;<span class="builtintype" id="3869632">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3869640">Retry</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3869648">uint32</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3869656">Expire</span>&nbsp;&nbsp;<span class="builtintype" id="3869664">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3869672">Minttl</span>&nbsp;&nbsp;<span class="builtintype" id="3869680">uint32</span><br>
<span class="lineno"></span><span class="op" id="3869687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3869690">func</span>&nbsp;<span class="op" id="3869695">(</span><span class="ident" id="3869696">rr</span>&nbsp;<span class="op" id="3869699">*</span><span class="ident" id="3869700">dnsRR_SOA</span><span class="op" id="3869709">)</span>&nbsp;<span class="ident" id="3869711">Header</span><span class="op" id="3869717">(</span><span class="op" id="3869718">)</span>&nbsp;<span class="op" id="3869720">*</span><span class="ident" id="3869721">dnsRR_Header</span>&nbsp;<span class="op" id="3869734">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3869737">return</span>&nbsp;<span class="op" id="3869744">&amp;</span><span class="ident" id="3869745">rr</span><span class="op" id="3869747">.</span><span class="ident" id="3869748">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3869752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3869755">func</span>&nbsp;<span class="op" id="3869760">(</span><span class="ident" id="3869761">rr</span>&nbsp;<span class="op" id="3869764">*</span><span class="ident" id="3869765">dnsRR_SOA</span><span class="op" id="3869774">)</span>&nbsp;<span class="ident" id="3869776">Walk</span><span class="op" id="3869780">(</span><span class="ident" id="3869781">f</span>&nbsp;<span class="keyword" id="3869783">func</span><span class="op" id="3869787">(</span><span class="ident" id="3869788">v</span>&nbsp;<span class="keyword" id="3869790">interface</span><span class="op" id="3869799">{</span><span class="op" id="3869800">}</span><span class="op" id="3869801">,</span>&nbsp;<span class="ident" id="3869803">name</span><span class="op" id="3869807">,</span>&nbsp;<span class="ident" id="3869809">tag</span>&nbsp;<span class="builtintype" id="3869813">string</span><span class="op" id="3869819">)</span>&nbsp;<span class="builtintype" id="3869821">bool</span><span class="op" id="3869825">)</span>&nbsp;<span class="builtintype" id="3869827">bool</span>&nbsp;<span class="op" id="3869832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3869835">return</span>&nbsp;<span class="ident" id="3869842">rr</span><span class="op" id="3869844">.</span><span class="ident" id="3869845">Hdr</span><span class="op" id="3869848">.</span><span class="ident" id="3869849">Walk</span><span class="op" id="3869853">(</span><span class="ident" id="3869854">f</span><span class="op" id="3869855">)</span>&nbsp;<span class="op" id="3869857">&amp;&amp;</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3869862">f</span><span class="op" id="3869863">(</span><span class="op" id="3869864">&amp;</span><span class="ident" id="3869865">rr</span><span class="op" id="3869867">.</span><span class="ident" id="3869868">Ns</span><span class="op" id="3869870">,</span>&nbsp;<span class="string" id="3869872">&#34;Ns&#34;</span><span class="op" id="3869876">,</span>&nbsp;<span class="string" id="3869878">&#34;domain&#34;</span><span class="op" id="3869886">)</span>&nbsp;<span class="op" id="3869888">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3869893">f</span><span class="op" id="3869894">(</span><span class="op" id="3869895">&amp;</span><span class="ident" id="3869896">rr</span><span class="op" id="3869898">.</span><span class="ident" id="3869899">Mbox</span><span class="op" id="3869903">,</span>&nbsp;<span class="string" id="3869905">&#34;Mbox&#34;</span><span class="op" id="3869911">,</span>&nbsp;<span class="string" id="3869913">&#34;domain&#34;</span><span class="op" id="3869921">)</span>&nbsp;<span class="op" id="3869923">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3869928">f</span><span class="op" id="3869929">(</span><span class="op" id="3869930">&amp;</span><span class="ident" id="3869931">rr</span><span class="op" id="3869933">.</span><span class="ident" id="3869934">Serial</span><span class="op" id="3869940">,</span>&nbsp;<span class="string" id="3869942">&#34;Serial&#34;</span><span class="op" id="3869950">,</span>&nbsp;<span class="string" id="3869952">&#34;&#34;</span><span class="op" id="3869954">)</span>&nbsp;<span class="op" id="3869956">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3869961">f</span><span class="op" id="3869962">(</span><span class="op" id="3869963">&amp;</span><span class="ident" id="3869964">rr</span><span class="op" id="3869966">.</span><span class="ident" id="3869967">Refresh</span><span class="op" id="3869974">,</span>&nbsp;<span class="string" id="3869976">&#34;Refresh&#34;</span><span class="op" id="3869985">,</span>&nbsp;<span class="string" id="3869987">&#34;&#34;</span><span class="op" id="3869989">)</span>&nbsp;<span class="op" id="3869991">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3869996">f</span><span class="op" id="3869997">(</span><span class="op" id="3869998">&amp;</span><span class="ident" id="3869999">rr</span><span class="op" id="3870001">.</span><span class="ident" id="3870002">Retry</span><span class="op" id="3870007">,</span>&nbsp;<span class="string" id="3870009">&#34;Retry&#34;</span><span class="op" id="3870016">,</span>&nbsp;<span class="string" id="3870018">&#34;&#34;</span><span class="op" id="3870020">)</span>&nbsp;<span class="op" id="3870022">&amp;&amp;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3870027">f</span><span class="op" id="3870028">(</span><span class="op" id="3870029">&amp;</span><span class="ident" id="3870030">rr</span><span class="op" id="3870032">.</span><span class="ident" id="3870033">Expire</span><span class="op" id="3870039">,</span>&nbsp;<span class="string" id="3870041">&#34;Expire&#34;</span><span class="op" id="3870049">,</span>&nbsp;<span class="string" id="3870051">&#34;&#34;</span><span class="op" id="3870053">)</span>&nbsp;<span class="op" id="3870055">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3870060">f</span><span class="op" id="3870061">(</span><span class="op" id="3870062">&amp;</span><span class="ident" id="3870063">rr</span><span class="op" id="3870065">.</span><span class="ident" id="3870066">Minttl</span><span class="op" id="3870072">,</span>&nbsp;<span class="string" id="3870074">&#34;Minttl&#34;</span><span class="op" id="3870082">,</span>&nbsp;<span class="string" id="3870084">&#34;&#34;</span><span class="op" id="3870086">)</span><br>
<span class="lineno"></span><span class="op" id="3870088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3870091">type</span>&nbsp;<span class="ident" id="3870096">dnsRR_TXT</span>&nbsp;<span class="keyword" id="3870106">struct</span>&nbsp;<span class="op" id="3870113">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3870116">Hdr</span>&nbsp;<span class="ident" id="3870120">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3870134">Txt</span>&nbsp;<span class="builtintype" id="3870138">string</span>&nbsp;<span class="comment" id="3870145">//&nbsp;not&nbsp;domain&nbsp;name</span><br>
<span class="lineno"></span><span class="op" id="3870164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3870167">func</span>&nbsp;<span class="op" id="3870172">(</span><span class="ident" id="3870173">rr</span>&nbsp;<span class="op" id="3870176">*</span><span class="ident" id="3870177">dnsRR_TXT</span><span class="op" id="3870186">)</span>&nbsp;<span class="ident" id="3870188">Header</span><span class="op" id="3870194">(</span><span class="op" id="3870195">)</span>&nbsp;<span class="op" id="3870197">*</span><span class="ident" id="3870198">dnsRR_Header</span>&nbsp;<span class="op" id="3870211">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3870214">return</span>&nbsp;<span class="op" id="3870221">&amp;</span><span class="ident" id="3870222">rr</span><span class="op" id="3870224">.</span><span class="ident" id="3870225">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3870229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3870232">func</span>&nbsp;<span class="op" id="3870237">(</span><span class="ident" id="3870238">rr</span>&nbsp;<span class="op" id="3870241">*</span><span class="ident" id="3870242">dnsRR_TXT</span><span class="op" id="3870251">)</span>&nbsp;<span class="ident" id="3870253">Walk</span><span class="op" id="3870257">(</span><span class="ident" id="3870258">f</span>&nbsp;<span class="keyword" id="3870260">func</span><span class="op" id="3870264">(</span><span class="ident" id="3870265">v</span>&nbsp;<span class="keyword" id="3870267">interface</span><span class="op" id="3870276">{</span><span class="op" id="3870277">}</span><span class="op" id="3870278">,</span>&nbsp;<span class="ident" id="3870280">name</span><span class="op" id="3870284">,</span>&nbsp;<span class="ident" id="3870286">tag</span>&nbsp;<span class="builtintype" id="3870290">string</span><span class="op" id="3870296">)</span>&nbsp;<span class="builtintype" id="3870298">bool</span><span class="op" id="3870302">)</span>&nbsp;<span class="builtintype" id="3870304">bool</span>&nbsp;<span class="op" id="3870309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3870312">return</span>&nbsp;<span class="ident" id="3870319">rr</span><span class="op" id="3870321">.</span><span class="ident" id="3870322">Hdr</span><span class="op" id="3870325">.</span><span class="ident" id="3870326">Walk</span><span class="op" id="3870330">(</span><span class="ident" id="3870331">f</span><span class="op" id="3870332">)</span>&nbsp;<span class="op" id="3870334">&amp;&amp;</span>&nbsp;<span class="ident" id="3870337">f</span><span class="op" id="3870338">(</span><span class="op" id="3870339">&amp;</span><span class="ident" id="3870340">rr</span><span class="op" id="3870342">.</span><span class="ident" id="3870343">Txt</span><span class="op" id="3870346">,</span>&nbsp;<span class="string" id="3870348">&#34;Txt&#34;</span><span class="op" id="3870353">,</span>&nbsp;<span class="string" id="3870355">&#34;&#34;</span><span class="op" id="3870357">)</span><br>
<span class="lineno">310</span><span class="op" id="3870359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3870362">type</span>&nbsp;<span class="ident" id="3870367">dnsRR_SRV</span>&nbsp;<span class="keyword" id="3870377">struct</span>&nbsp;<span class="op" id="3870384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3870387">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3870396">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3870410">Priority</span>&nbsp;<span class="builtintype" id="3870419">uint16</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3870427">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3870436">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3870444">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3870453">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3870461">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3870470">string</span>&nbsp;<span class="string" id="3870477">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3870497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="3870500">func</span>&nbsp;<span class="op" id="3870505">(</span><span class="ident" id="3870506">rr</span>&nbsp;<span class="op" id="3870509">*</span><span class="ident" id="3870510">dnsRR_SRV</span><span class="op" id="3870519">)</span>&nbsp;<span class="ident" id="3870521">Header</span><span class="op" id="3870527">(</span><span class="op" id="3870528">)</span>&nbsp;<span class="op" id="3870530">*</span><span class="ident" id="3870531">dnsRR_Header</span>&nbsp;<span class="op" id="3870544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3870547">return</span>&nbsp;<span class="op" id="3870554">&amp;</span><span class="ident" id="3870555">rr</span><span class="op" id="3870557">.</span><span class="ident" id="3870558">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3870562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3870565">func</span>&nbsp;<span class="op" id="3870570">(</span><span class="ident" id="3870571">rr</span>&nbsp;<span class="op" id="3870574">*</span><span class="ident" id="3870575">dnsRR_SRV</span><span class="op" id="3870584">)</span>&nbsp;<span class="ident" id="3870586">Walk</span><span class="op" id="3870590">(</span><span class="ident" id="3870591">f</span>&nbsp;<span class="keyword" id="3870593">func</span><span class="op" id="3870597">(</span><span class="ident" id="3870598">v</span>&nbsp;<span class="keyword" id="3870600">interface</span><span class="op" id="3870609">{</span><span class="op" id="3870610">}</span><span class="op" id="3870611">,</span>&nbsp;<span class="ident" id="3870613">name</span><span class="op" id="3870617">,</span>&nbsp;<span class="ident" id="3870619">tag</span>&nbsp;<span class="builtintype" id="3870623">string</span><span class="op" id="3870629">)</span>&nbsp;<span class="builtintype" id="3870631">bool</span><span class="op" id="3870635">)</span>&nbsp;<span class="builtintype" id="3870637">bool</span>&nbsp;<span class="op" id="3870642">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3870645">return</span>&nbsp;<span class="ident" id="3870652">rr</span><span class="op" id="3870654">.</span><span class="ident" id="3870655">Hdr</span><span class="op" id="3870658">.</span><span class="ident" id="3870659">Walk</span><span class="op" id="3870663">(</span><span class="ident" id="3870664">f</span><span class="op" id="3870665">)</span>&nbsp;<span class="op" id="3870667">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3870672">f</span><span class="op" id="3870673">(</span><span class="op" id="3870674">&amp;</span><span class="ident" id="3870675">rr</span><span class="op" id="3870677">.</span><span class="ident" id="3870678">Priority</span><span class="op" id="3870686">,</span>&nbsp;<span class="string" id="3870688">&#34;Priority&#34;</span><span class="op" id="3870698">,</span>&nbsp;<span class="string" id="3870700">&#34;&#34;</span><span class="op" id="3870702">)</span>&nbsp;<span class="op" id="3870704">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3870709">f</span><span class="op" id="3870710">(</span><span class="op" id="3870711">&amp;</span><span class="ident" id="3870712">rr</span><span class="op" id="3870714">.</span><span class="ident" id="3870715">Weight</span><span class="op" id="3870721">,</span>&nbsp;<span class="string" id="3870723">&#34;Weight&#34;</span><span class="op" id="3870731">,</span>&nbsp;<span class="string" id="3870733">&#34;&#34;</span><span class="op" id="3870735">)</span>&nbsp;<span class="op" id="3870737">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3870742">f</span><span class="op" id="3870743">(</span><span class="op" id="3870744">&amp;</span><span class="ident" id="3870745">rr</span><span class="op" id="3870747">.</span><span class="ident" id="3870748">Port</span><span class="op" id="3870752">,</span>&nbsp;<span class="string" id="3870754">&#34;Port&#34;</span><span class="op" id="3870760">,</span>&nbsp;<span class="string" id="3870762">&#34;&#34;</span><span class="op" id="3870764">)</span>&nbsp;<span class="op" id="3870766">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3870771">f</span><span class="op" id="3870772">(</span><span class="op" id="3870773">&amp;</span><span class="ident" id="3870774">rr</span><span class="op" id="3870776">.</span><span class="ident" id="3870777">Target</span><span class="op" id="3870783">,</span>&nbsp;<span class="string" id="3870785">&#34;Target&#34;</span><span class="op" id="3870793">,</span>&nbsp;<span class="string" id="3870795">&#34;domain&#34;</span><span class="op" id="3870803">)</span><br>
<span class="lineno">330</span><span class="op" id="3870805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3870808">type</span>&nbsp;<span class="ident" id="3870813">dnsRR_A</span>&nbsp;<span class="keyword" id="3870821">struct</span>&nbsp;<span class="op" id="3870828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3870831">Hdr</span>&nbsp;<span class="ident" id="3870835">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3870849">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3870853">uint32</span>&nbsp;<span class="string" id="3870860">`net:&#34;ipv4&#34;`</span><br>
<span class="lineno">335</span><span class="op" id="3870873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3870876">func</span>&nbsp;<span class="op" id="3870881">(</span><span class="ident" id="3870882">rr</span>&nbsp;<span class="op" id="3870885">*</span><span class="ident" id="3870886">dnsRR_A</span><span class="op" id="3870893">)</span>&nbsp;<span class="ident" id="3870895">Header</span><span class="op" id="3870901">(</span><span class="op" id="3870902">)</span>&nbsp;<span class="op" id="3870904">*</span><span class="ident" id="3870905">dnsRR_Header</span>&nbsp;<span class="op" id="3870918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3870921">return</span>&nbsp;<span class="op" id="3870928">&amp;</span><span class="ident" id="3870929">rr</span><span class="op" id="3870931">.</span><span class="ident" id="3870932">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3870936">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="3870939">func</span>&nbsp;<span class="op" id="3870944">(</span><span class="ident" id="3870945">rr</span>&nbsp;<span class="op" id="3870948">*</span><span class="ident" id="3870949">dnsRR_A</span><span class="op" id="3870956">)</span>&nbsp;<span class="ident" id="3870958">Walk</span><span class="op" id="3870962">(</span><span class="ident" id="3870963">f</span>&nbsp;<span class="keyword" id="3870965">func</span><span class="op" id="3870969">(</span><span class="ident" id="3870970">v</span>&nbsp;<span class="keyword" id="3870972">interface</span><span class="op" id="3870981">{</span><span class="op" id="3870982">}</span><span class="op" id="3870983">,</span>&nbsp;<span class="ident" id="3870985">name</span><span class="op" id="3870989">,</span>&nbsp;<span class="ident" id="3870991">tag</span>&nbsp;<span class="builtintype" id="3870995">string</span><span class="op" id="3871001">)</span>&nbsp;<span class="builtintype" id="3871003">bool</span><span class="op" id="3871007">)</span>&nbsp;<span class="builtintype" id="3871009">bool</span>&nbsp;<span class="op" id="3871014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3871017">return</span>&nbsp;<span class="ident" id="3871024">rr</span><span class="op" id="3871026">.</span><span class="ident" id="3871027">Hdr</span><span class="op" id="3871030">.</span><span class="ident" id="3871031">Walk</span><span class="op" id="3871035">(</span><span class="ident" id="3871036">f</span><span class="op" id="3871037">)</span>&nbsp;<span class="op" id="3871039">&amp;&amp;</span>&nbsp;<span class="ident" id="3871042">f</span><span class="op" id="3871043">(</span><span class="op" id="3871044">&amp;</span><span class="ident" id="3871045">rr</span><span class="op" id="3871047">.</span><span class="ident" id="3871048">A</span><span class="op" id="3871049">,</span>&nbsp;<span class="string" id="3871051">&#34;A&#34;</span><span class="op" id="3871054">,</span>&nbsp;<span class="string" id="3871056">&#34;ipv4&#34;</span><span class="op" id="3871062">)</span><br>
<span class="lineno"></span><span class="op" id="3871064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="3871067">type</span>&nbsp;<span class="ident" id="3871072">dnsRR_AAAA</span>&nbsp;<span class="keyword" id="3871083">struct</span>&nbsp;<span class="op" id="3871090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3871093">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3871098">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3871112">AAAA</span>&nbsp;<span class="op" id="3871117">[</span><span class="num" id="3871118">16</span><span class="op" id="3871120">]</span><span class="builtintype" id="3871121">byte</span>&nbsp;<span class="string" id="3871126">`net:&#34;ipv6&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3871139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="3871142">func</span>&nbsp;<span class="op" id="3871147">(</span><span class="ident" id="3871148">rr</span>&nbsp;<span class="op" id="3871151">*</span><span class="ident" id="3871152">dnsRR_AAAA</span><span class="op" id="3871162">)</span>&nbsp;<span class="ident" id="3871164">Header</span><span class="op" id="3871170">(</span><span class="op" id="3871171">)</span>&nbsp;<span class="op" id="3871173">*</span><span class="ident" id="3871174">dnsRR_Header</span>&nbsp;<span class="op" id="3871187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3871190">return</span>&nbsp;<span class="op" id="3871197">&amp;</span><span class="ident" id="3871198">rr</span><span class="op" id="3871200">.</span><span class="ident" id="3871201">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3871205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3871208">func</span>&nbsp;<span class="op" id="3871213">(</span><span class="ident" id="3871214">rr</span>&nbsp;<span class="op" id="3871217">*</span><span class="ident" id="3871218">dnsRR_AAAA</span><span class="op" id="3871228">)</span>&nbsp;<span class="ident" id="3871230">Walk</span><span class="op" id="3871234">(</span><span class="ident" id="3871235">f</span>&nbsp;<span class="keyword" id="3871237">func</span><span class="op" id="3871241">(</span><span class="ident" id="3871242">v</span>&nbsp;<span class="keyword" id="3871244">interface</span><span class="op" id="3871253">{</span><span class="op" id="3871254">}</span><span class="op" id="3871255">,</span>&nbsp;<span class="ident" id="3871257">name</span><span class="op" id="3871261">,</span>&nbsp;<span class="ident" id="3871263">tag</span>&nbsp;<span class="builtintype" id="3871267">string</span><span class="op" id="3871273">)</span>&nbsp;<span class="builtintype" id="3871275">bool</span><span class="op" id="3871279">)</span>&nbsp;<span class="builtintype" id="3871281">bool</span>&nbsp;<span class="op" id="3871286">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3871289">return</span>&nbsp;<span class="ident" id="3871296">rr</span><span class="op" id="3871298">.</span><span class="ident" id="3871299">Hdr</span><span class="op" id="3871302">.</span><span class="ident" id="3871303">Walk</span><span class="op" id="3871307">(</span><span class="ident" id="3871308">f</span><span class="op" id="3871309">)</span>&nbsp;<span class="op" id="3871311">&amp;&amp;</span>&nbsp;<span class="ident" id="3871314">f</span><span class="op" id="3871315">(</span><span class="ident" id="3871316">rr</span><span class="op" id="3871318">.</span><span class="ident" id="3871319">AAAA</span><span class="op" id="3871323">[</span><span class="op" id="3871324">:</span><span class="op" id="3871325">]</span><span class="op" id="3871326">,</span>&nbsp;<span class="string" id="3871328">&#34;AAAA&#34;</span><span class="op" id="3871334">,</span>&nbsp;<span class="string" id="3871336">&#34;ipv6&#34;</span><span class="op" id="3871342">)</span><br>
<span class="lineno"></span><span class="op" id="3871344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3871347">//&nbsp;Packing&nbsp;and&nbsp;unpacking.</span><br>
<span class="lineno"></span><span class="comment" id="3871373">//</span><br>
<span class="lineno">360</span><span class="comment" id="3871376">//&nbsp;All&nbsp;the&nbsp;packers&nbsp;and&nbsp;unpackers&nbsp;take&nbsp;a&nbsp;(msg&nbsp;[]byte,&nbsp;off&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="3871438">//&nbsp;and&nbsp;return&nbsp;(off1&nbsp;int,&nbsp;ok&nbsp;bool).&nbsp;&nbsp;If&nbsp;they&nbsp;return&nbsp;ok==false,&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="3871505">//&nbsp;also&nbsp;return&nbsp;off1==len(msg),&nbsp;so&nbsp;that&nbsp;the&nbsp;next&nbsp;unpacker&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3871567">//&nbsp;also&nbsp;fail.&nbsp;&nbsp;This&nbsp;lets&nbsp;us&nbsp;avoid&nbsp;checks&nbsp;of&nbsp;ok&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3871633">//&nbsp;packing&nbsp;sequence.</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="3871655">//&nbsp;Map&nbsp;of&nbsp;constructors&nbsp;for&nbsp;each&nbsp;RR&nbsp;wire&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3871701">var</span>&nbsp;<span class="ident" id="3871705">rr_mk</span>&nbsp;<span class="op" id="3871711">=</span>&nbsp;<span class="keyword" id="3871713">map</span><span class="op" id="3871716">[</span><span class="builtintype" id="3871717">int</span><span class="op" id="3871720">]</span><span class="keyword" id="3871721">func</span><span class="op" id="3871725">(</span><span class="op" id="3871726">)</span>&nbsp;<span class="ident" id="3871728">dnsRR</span><span class="op" id="3871733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3871736">dnsTypeCNAME</span><span class="op" id="3871748">:</span>&nbsp;<span class="keyword" id="3871750">func</span><span class="op" id="3871754">(</span><span class="op" id="3871755">)</span>&nbsp;<span class="ident" id="3871757">dnsRR</span>&nbsp;<span class="op" id="3871763">{</span>&nbsp;<span class="keyword" id="3871765">return</span>&nbsp;<span class="builtinfunc" id="3871772">new</span><span class="op" id="3871775">(</span><span class="ident" id="3871776">dnsRR_CNAME</span><span class="op" id="3871787">)</span>&nbsp;<span class="op" id="3871789">}</span><span class="op" id="3871790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3871793">dnsTypeHINFO</span><span class="op" id="3871805">:</span>&nbsp;<span class="keyword" id="3871807">func</span><span class="op" id="3871811">(</span><span class="op" id="3871812">)</span>&nbsp;<span class="ident" id="3871814">dnsRR</span>&nbsp;<span class="op" id="3871820">{</span>&nbsp;<span class="keyword" id="3871822">return</span>&nbsp;<span class="builtinfunc" id="3871829">new</span><span class="op" id="3871832">(</span><span class="ident" id="3871833">dnsRR_HINFO</span><span class="op" id="3871844">)</span>&nbsp;<span class="op" id="3871846">}</span><span class="op" id="3871847">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3871850">dnsTypeMB</span><span class="op" id="3871859">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3871864">func</span><span class="op" id="3871868">(</span><span class="op" id="3871869">)</span>&nbsp;<span class="ident" id="3871871">dnsRR</span>&nbsp;<span class="op" id="3871877">{</span>&nbsp;<span class="keyword" id="3871879">return</span>&nbsp;<span class="builtinfunc" id="3871886">new</span><span class="op" id="3871889">(</span><span class="ident" id="3871890">dnsRR_MB</span><span class="op" id="3871898">)</span>&nbsp;<span class="op" id="3871900">}</span><span class="op" id="3871901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3871904">dnsTypeMG</span><span class="op" id="3871913">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3871918">func</span><span class="op" id="3871922">(</span><span class="op" id="3871923">)</span>&nbsp;<span class="ident" id="3871925">dnsRR</span>&nbsp;<span class="op" id="3871931">{</span>&nbsp;<span class="keyword" id="3871933">return</span>&nbsp;<span class="builtinfunc" id="3871940">new</span><span class="op" id="3871943">(</span><span class="ident" id="3871944">dnsRR_MG</span><span class="op" id="3871952">)</span>&nbsp;<span class="op" id="3871954">}</span><span class="op" id="3871955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3871958">dnsTypeMINFO</span><span class="op" id="3871970">:</span>&nbsp;<span class="keyword" id="3871972">func</span><span class="op" id="3871976">(</span><span class="op" id="3871977">)</span>&nbsp;<span class="ident" id="3871979">dnsRR</span>&nbsp;<span class="op" id="3871985">{</span>&nbsp;<span class="keyword" id="3871987">return</span>&nbsp;<span class="builtinfunc" id="3871994">new</span><span class="op" id="3871997">(</span><span class="ident" id="3871998">dnsRR_MINFO</span><span class="op" id="3872009">)</span>&nbsp;<span class="op" id="3872011">}</span><span class="op" id="3872012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3872015">dnsTypeMR</span><span class="op" id="3872024">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3872029">func</span><span class="op" id="3872033">(</span><span class="op" id="3872034">)</span>&nbsp;<span class="ident" id="3872036">dnsRR</span>&nbsp;<span class="op" id="3872042">{</span>&nbsp;<span class="keyword" id="3872044">return</span>&nbsp;<span class="builtinfunc" id="3872051">new</span><span class="op" id="3872054">(</span><span class="ident" id="3872055">dnsRR_MR</span><span class="op" id="3872063">)</span>&nbsp;<span class="op" id="3872065">}</span><span class="op" id="3872066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3872069">dnsTypeMX</span><span class="op" id="3872078">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3872083">func</span><span class="op" id="3872087">(</span><span class="op" id="3872088">)</span>&nbsp;<span class="ident" id="3872090">dnsRR</span>&nbsp;<span class="op" id="3872096">{</span>&nbsp;<span class="keyword" id="3872098">return</span>&nbsp;<span class="builtinfunc" id="3872105">new</span><span class="op" id="3872108">(</span><span class="ident" id="3872109">dnsRR_MX</span><span class="op" id="3872117">)</span>&nbsp;<span class="op" id="3872119">}</span><span class="op" id="3872120">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3872123">dnsTypeNS</span><span class="op" id="3872132">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3872137">func</span><span class="op" id="3872141">(</span><span class="op" id="3872142">)</span>&nbsp;<span class="ident" id="3872144">dnsRR</span>&nbsp;<span class="op" id="3872150">{</span>&nbsp;<span class="keyword" id="3872152">return</span>&nbsp;<span class="builtinfunc" id="3872159">new</span><span class="op" id="3872162">(</span><span class="ident" id="3872163">dnsRR_NS</span><span class="op" id="3872171">)</span>&nbsp;<span class="op" id="3872173">}</span><span class="op" id="3872174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3872177">dnsTypePTR</span><span class="op" id="3872187">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3872191">func</span><span class="op" id="3872195">(</span><span class="op" id="3872196">)</span>&nbsp;<span class="ident" id="3872198">dnsRR</span>&nbsp;<span class="op" id="3872204">{</span>&nbsp;<span class="keyword" id="3872206">return</span>&nbsp;<span class="builtinfunc" id="3872213">new</span><span class="op" id="3872216">(</span><span class="ident" id="3872217">dnsRR_PTR</span><span class="op" id="3872226">)</span>&nbsp;<span class="op" id="3872228">}</span><span class="op" id="3872229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3872232">dnsTypeSOA</span><span class="op" id="3872242">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3872246">func</span><span class="op" id="3872250">(</span><span class="op" id="3872251">)</span>&nbsp;<span class="ident" id="3872253">dnsRR</span>&nbsp;<span class="op" id="3872259">{</span>&nbsp;<span class="keyword" id="3872261">return</span>&nbsp;<span class="builtinfunc" id="3872268">new</span><span class="op" id="3872271">(</span><span class="ident" id="3872272">dnsRR_SOA</span><span class="op" id="3872281">)</span>&nbsp;<span class="op" id="3872283">}</span><span class="op" id="3872284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3872287">dnsTypeTXT</span><span class="op" id="3872297">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3872301">func</span><span class="op" id="3872305">(</span><span class="op" id="3872306">)</span>&nbsp;<span class="ident" id="3872308">dnsRR</span>&nbsp;<span class="op" id="3872314">{</span>&nbsp;<span class="keyword" id="3872316">return</span>&nbsp;<span class="builtinfunc" id="3872323">new</span><span class="op" id="3872326">(</span><span class="ident" id="3872327">dnsRR_TXT</span><span class="op" id="3872336">)</span>&nbsp;<span class="op" id="3872338">}</span><span class="op" id="3872339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3872342">dnsTypeSRV</span><span class="op" id="3872352">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3872356">func</span><span class="op" id="3872360">(</span><span class="op" id="3872361">)</span>&nbsp;<span class="ident" id="3872363">dnsRR</span>&nbsp;<span class="op" id="3872369">{</span>&nbsp;<span class="keyword" id="3872371">return</span>&nbsp;<span class="builtinfunc" id="3872378">new</span><span class="op" id="3872381">(</span><span class="ident" id="3872382">dnsRR_SRV</span><span class="op" id="3872391">)</span>&nbsp;<span class="op" id="3872393">}</span><span class="op" id="3872394">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3872397">dnsTypeA</span><span class="op" id="3872405">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3872411">func</span><span class="op" id="3872415">(</span><span class="op" id="3872416">)</span>&nbsp;<span class="ident" id="3872418">dnsRR</span>&nbsp;<span class="op" id="3872424">{</span>&nbsp;<span class="keyword" id="3872426">return</span>&nbsp;<span class="builtinfunc" id="3872433">new</span><span class="op" id="3872436">(</span><span class="ident" id="3872437">dnsRR_A</span><span class="op" id="3872444">)</span>&nbsp;<span class="op" id="3872446">}</span><span class="op" id="3872447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3872450">dnsTypeAAAA</span><span class="op" id="3872461">:</span>&nbsp;&nbsp;<span class="keyword" id="3872464">func</span><span class="op" id="3872468">(</span><span class="op" id="3872469">)</span>&nbsp;<span class="ident" id="3872471">dnsRR</span>&nbsp;<span class="op" id="3872477">{</span>&nbsp;<span class="keyword" id="3872479">return</span>&nbsp;<span class="builtinfunc" id="3872486">new</span><span class="op" id="3872489">(</span><span class="ident" id="3872490">dnsRR_AAAA</span><span class="op" id="3872500">)</span>&nbsp;<span class="op" id="3872502">}</span><span class="op" id="3872503">,</span><br>
<span class="lineno"></span><span class="op" id="3872505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3872508">//&nbsp;Pack&nbsp;a&nbsp;domain&nbsp;name&nbsp;s&nbsp;into&nbsp;msg[off:].</span><br>
<span class="lineno">385</span><span class="comment" id="3872548">//&nbsp;Domain&nbsp;names&nbsp;are&nbsp;a&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="3872598">//&nbsp;split&nbsp;at&nbsp;the&nbsp;dots.&nbsp;&nbsp;They&nbsp;end&nbsp;with&nbsp;a&nbsp;zero-length&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3872657">func</span>&nbsp;<span class="ident" id="3872662">packDomainName</span><span class="op" id="3872676">(</span><span class="ident" id="3872677">s</span>&nbsp;<span class="builtintype" id="3872679">string</span><span class="op" id="3872685">,</span>&nbsp;<span class="ident" id="3872687">msg</span>&nbsp;<span class="op" id="3872691">[</span><span class="op" id="3872692">]</span><span class="builtintype" id="3872693">byte</span><span class="op" id="3872697">,</span>&nbsp;<span class="ident" id="3872699">off</span>&nbsp;<span class="builtintype" id="3872703">int</span><span class="op" id="3872706">)</span>&nbsp;<span class="op" id="3872708">(</span><span class="ident" id="3872709">off1</span>&nbsp;<span class="builtintype" id="3872714">int</span><span class="op" id="3872717">,</span>&nbsp;<span class="ident" id="3872719">ok</span>&nbsp;<span class="builtintype" id="3872722">bool</span><span class="op" id="3872726">)</span>&nbsp;<span class="op" id="3872728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3872731">//&nbsp;Add&nbsp;trailing&nbsp;dot&nbsp;to&nbsp;canonicalize&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3872774">if</span>&nbsp;<span class="ident" id="3872777">n</span>&nbsp;<span class="op" id="3872779">:=</span>&nbsp;<span class="builtinfunc" id="3872782">len</span><span class="op" id="3872785">(</span><span class="ident" id="3872786">s</span><span class="op" id="3872787">)</span><span class="op" id="3872788">;</span>&nbsp;<span class="ident" id="3872790">n</span>&nbsp;<span class="op" id="3872792">==</span>&nbsp;<span class="num" id="3872795">0</span>&nbsp;<span class="op" id="3872797">||</span>&nbsp;<span class="ident" id="3872800">s</span><span class="op" id="3872801">[</span><span class="ident" id="3872802">n</span><span class="op" id="3872803">-</span><span class="num" id="3872804">1</span><span class="op" id="3872805">]</span>&nbsp;<span class="op" id="3872807">!=</span>&nbsp;<span class="string" id="3872810">&#39;.&#39;</span>&nbsp;<span class="op" id="3872814">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3872818">s</span>&nbsp;<span class="op" id="3872820">+=</span>&nbsp;<span class="string" id="3872823">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3872828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3872832">//&nbsp;Each&nbsp;dot&nbsp;ends&nbsp;a&nbsp;segment&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3872873">//&nbsp;We&nbsp;trade&nbsp;each&nbsp;dot&nbsp;byte&nbsp;for&nbsp;a&nbsp;length&nbsp;byte.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3872919">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;trailing&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3872954">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;have&nbsp;all&nbsp;the&nbsp;space&nbsp;we&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3873000">tot</span>&nbsp;<span class="op" id="3873004">:=</span>&nbsp;<span class="builtinfunc" id="3873007">len</span><span class="op" id="3873010">(</span><span class="ident" id="3873011">s</span><span class="op" id="3873012">)</span>&nbsp;<span class="op" id="3873014">+</span>&nbsp;<span class="num" id="3873016">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3873019">if</span>&nbsp;<span class="ident" id="3873022">off</span><span class="op" id="3873025">+</span><span class="ident" id="3873026">tot</span>&nbsp;<span class="op" id="3873030">&gt;</span>&nbsp;<span class="builtinfunc" id="3873032">len</span><span class="op" id="3873035">(</span><span class="ident" id="3873036">msg</span><span class="op" id="3873039">)</span>&nbsp;<span class="op" id="3873041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3873045">return</span>&nbsp;<span class="builtinfunc" id="3873052">len</span><span class="op" id="3873055">(</span><span class="ident" id="3873056">msg</span><span class="op" id="3873059">)</span><span class="op" id="3873060">,</span>&nbsp;<span class="builtintype" id="3873062">false</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3873069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3873073">//&nbsp;Emit&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings,&nbsp;chopping&nbsp;at&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3873129">begin</span>&nbsp;<span class="op" id="3873135">:=</span>&nbsp;<span class="num" id="3873138">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3873141">for</span>&nbsp;<span class="ident" id="3873145">i</span>&nbsp;<span class="op" id="3873147">:=</span>&nbsp;<span class="num" id="3873150">0</span><span class="op" id="3873151">;</span>&nbsp;<span class="ident" id="3873153">i</span>&nbsp;<span class="op" id="3873155">&lt;</span>&nbsp;<span class="builtinfunc" id="3873157">len</span><span class="op" id="3873160">(</span><span class="ident" id="3873161">s</span><span class="op" id="3873162">)</span><span class="op" id="3873163">;</span>&nbsp;<span class="ident" id="3873165">i</span><span class="op" id="3873166">++</span>&nbsp;<span class="op" id="3873169">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3873173">if</span>&nbsp;<span class="ident" id="3873176">s</span><span class="op" id="3873177">[</span><span class="ident" id="3873178">i</span><span class="op" id="3873179">]</span>&nbsp;<span class="op" id="3873181">==</span>&nbsp;<span class="string" id="3873184">&#39;.&#39;</span>&nbsp;<span class="op" id="3873188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3873193">if</span>&nbsp;<span class="ident" id="3873196">i</span><span class="op" id="3873197">-</span><span class="ident" id="3873198">begin</span>&nbsp;<span class="op" id="3873204">&gt;=</span>&nbsp;<span class="num" id="3873207">1</span><span class="op" id="3873208">&lt;&lt;</span><span class="num" id="3873210">6</span>&nbsp;<span class="op" id="3873212">{</span>&nbsp;<span class="comment" id="3873214">//&nbsp;top&nbsp;two&nbsp;bits&nbsp;of&nbsp;length&nbsp;must&nbsp;be&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3873258">return</span>&nbsp;<span class="builtinfunc" id="3873265">len</span><span class="op" id="3873268">(</span><span class="ident" id="3873269">msg</span><span class="op" id="3873272">)</span><span class="op" id="3873273">,</span>&nbsp;<span class="builtintype" id="3873275">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3873284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3873289">msg</span><span class="op" id="3873292">[</span><span class="ident" id="3873293">off</span><span class="op" id="3873296">]</span>&nbsp;<span class="op" id="3873298">=</span>&nbsp;<span class="builtintype" id="3873300">byte</span><span class="op" id="3873304">(</span><span class="ident" id="3873305">i</span>&nbsp;<span class="op" id="3873307">-</span>&nbsp;<span class="ident" id="3873309">begin</span><span class="op" id="3873314">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3873319">off</span><span class="op" id="3873322">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3873328">for</span>&nbsp;<span class="ident" id="3873332">j</span>&nbsp;<span class="op" id="3873334">:=</span>&nbsp;<span class="ident" id="3873337">begin</span><span class="op" id="3873342">;</span>&nbsp;<span class="ident" id="3873344">j</span>&nbsp;<span class="op" id="3873346">&lt;</span>&nbsp;<span class="ident" id="3873348">i</span><span class="op" id="3873349">;</span>&nbsp;<span class="ident" id="3873351">j</span><span class="op" id="3873352">++</span>&nbsp;<span class="op" id="3873355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3873361">msg</span><span class="op" id="3873364">[</span><span class="ident" id="3873365">off</span><span class="op" id="3873368">]</span>&nbsp;<span class="op" id="3873370">=</span>&nbsp;<span class="ident" id="3873372">s</span><span class="op" id="3873373">[</span><span class="ident" id="3873374">j</span><span class="op" id="3873375">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3873381">off</span><span class="op" id="3873384">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3873390">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3873395">begin</span>&nbsp;<span class="op" id="3873401">=</span>&nbsp;<span class="ident" id="3873403">i</span>&nbsp;<span class="op" id="3873405">+</span>&nbsp;<span class="num" id="3873407">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3873411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3873414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3873417">msg</span><span class="op" id="3873420">[</span><span class="ident" id="3873421">off</span><span class="op" id="3873424">]</span>&nbsp;<span class="op" id="3873426">=</span>&nbsp;<span class="num" id="3873428">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3873431">off</span><span class="op" id="3873434">++</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3873438">return</span>&nbsp;<span class="ident" id="3873445">off</span><span class="op" id="3873448">,</span>&nbsp;<span class="builtintype" id="3873450">true</span><br>
<span class="lineno"></span><span class="op" id="3873455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3873458">//&nbsp;Unpack&nbsp;a&nbsp;domain&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="3873483">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;simple&nbsp;sequences&nbsp;of&nbsp;counted&nbsp;strings&nbsp;above,</span><br>
<span class="lineno">425</span><span class="comment" id="3873548">//&nbsp;domain&nbsp;names&nbsp;are&nbsp;allowed&nbsp;to&nbsp;refer&nbsp;to&nbsp;strings&nbsp;elsewhere&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3873613">//&nbsp;packet,&nbsp;to&nbsp;avoid&nbsp;repeating&nbsp;common&nbsp;suffixes&nbsp;when&nbsp;returning</span><br>
<span class="lineno"></span><span class="comment" id="3873674">//&nbsp;many&nbsp;entries&nbsp;in&nbsp;a&nbsp;single&nbsp;domain.&nbsp;&nbsp;The&nbsp;pointers&nbsp;are&nbsp;marked</span><br>
<span class="lineno"></span><span class="comment" id="3873735">//&nbsp;by&nbsp;a&nbsp;length&nbsp;byte&nbsp;with&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;set.&nbsp;&nbsp;Ignoring&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="3873798">//&nbsp;two&nbsp;bits,&nbsp;that&nbsp;byte&nbsp;and&nbsp;the&nbsp;next&nbsp;give&nbsp;a&nbsp;14&nbsp;bit&nbsp;offset&nbsp;from&nbsp;msg[0]</span><br>
<span class="lineno">430</span><span class="comment" id="3873867">//&nbsp;where&nbsp;we&nbsp;should&nbsp;pick&nbsp;up&nbsp;the&nbsp;trail.</span><br>
<span class="lineno"></span><span class="comment" id="3873905">//&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;jump&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;packet,</span><br>
<span class="lineno"></span><span class="comment" id="3873954">//&nbsp;we&nbsp;return&nbsp;off1&nbsp;==&nbsp;the&nbsp;offset&nbsp;after&nbsp;the&nbsp;first&nbsp;pointer&nbsp;we&nbsp;found,</span><br>
<span class="lineno"></span><span class="comment" id="3874020">//&nbsp;which&nbsp;is&nbsp;where&nbsp;the&nbsp;next&nbsp;record&nbsp;will&nbsp;start.</span><br>
<span class="lineno"></span><span class="comment" id="3874066">//&nbsp;In&nbsp;theory,&nbsp;the&nbsp;pointers&nbsp;are&nbsp;only&nbsp;allowed&nbsp;to&nbsp;jump&nbsp;backward.</span><br>
<span class="lineno">435</span><span class="comment" id="3874128">//&nbsp;We&nbsp;let&nbsp;them&nbsp;jump&nbsp;anywhere&nbsp;and&nbsp;stop&nbsp;jumping&nbsp;after&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span><span class="keyword" id="3874189">func</span>&nbsp;<span class="ident" id="3874194">unpackDomainName</span><span class="op" id="3874210">(</span><span class="ident" id="3874211">msg</span>&nbsp;<span class="op" id="3874215">[</span><span class="op" id="3874216">]</span><span class="builtintype" id="3874217">byte</span><span class="op" id="3874221">,</span>&nbsp;<span class="ident" id="3874223">off</span>&nbsp;<span class="builtintype" id="3874227">int</span><span class="op" id="3874230">)</span>&nbsp;<span class="op" id="3874232">(</span><span class="ident" id="3874233">s</span>&nbsp;<span class="builtintype" id="3874235">string</span><span class="op" id="3874241">,</span>&nbsp;<span class="ident" id="3874243">off1</span>&nbsp;<span class="builtintype" id="3874248">int</span><span class="op" id="3874251">,</span>&nbsp;<span class="ident" id="3874253">ok</span>&nbsp;<span class="builtintype" id="3874256">bool</span><span class="op" id="3874260">)</span>&nbsp;<span class="op" id="3874262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874265">s</span>&nbsp;<span class="op" id="3874267">=</span>&nbsp;<span class="string" id="3874269">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874273">ptr</span>&nbsp;<span class="op" id="3874277">:=</span>&nbsp;<span class="num" id="3874280">0</span>&nbsp;<span class="comment" id="3874282">//&nbsp;number&nbsp;of&nbsp;pointers&nbsp;followed</span><br>
<span class="lineno"></span><span class="ident" id="3874313">Loop</span><span class="op" id="3874317">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874320">for</span>&nbsp;<span class="op" id="3874324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874328">if</span>&nbsp;<span class="ident" id="3874331">off</span>&nbsp;<span class="op" id="3874335">&gt;=</span>&nbsp;<span class="builtinfunc" id="3874338">len</span><span class="op" id="3874341">(</span><span class="ident" id="3874342">msg</span><span class="op" id="3874345">)</span>&nbsp;<span class="op" id="3874347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874352">return</span>&nbsp;<span class="string" id="3874359">&#34;&#34;</span><span class="op" id="3874361">,</span>&nbsp;<span class="builtinfunc" id="3874363">len</span><span class="op" id="3874366">(</span><span class="ident" id="3874367">msg</span><span class="op" id="3874370">)</span><span class="op" id="3874371">,</span>&nbsp;<span class="builtintype" id="3874373">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3874381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874385">c</span>&nbsp;<span class="op" id="3874387">:=</span>&nbsp;<span class="builtintype" id="3874390">int</span><span class="op" id="3874393">(</span><span class="ident" id="3874394">msg</span><span class="op" id="3874397">[</span><span class="ident" id="3874398">off</span><span class="op" id="3874401">]</span><span class="op" id="3874402">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874406">off</span><span class="op" id="3874409">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874414">switch</span>&nbsp;<span class="ident" id="3874421">c</span>&nbsp;<span class="op" id="3874423">&amp;</span>&nbsp;<span class="num" id="3874425">0xC0</span>&nbsp;<span class="op" id="3874430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874434">case</span>&nbsp;<span class="num" id="3874439">0x00</span><span class="op" id="3874443">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874448">if</span>&nbsp;<span class="ident" id="3874451">c</span>&nbsp;<span class="op" id="3874453">==</span>&nbsp;<span class="num" id="3874456">0x00</span>&nbsp;<span class="op" id="3874461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3874467">//&nbsp;end&nbsp;of&nbsp;name</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874486">break</span>&nbsp;<span class="ident" id="3874492">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3874500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3874505">//&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874526">if</span>&nbsp;<span class="ident" id="3874529">off</span><span class="op" id="3874532">+</span><span class="ident" id="3874533">c</span>&nbsp;<span class="op" id="3874535">&gt;</span>&nbsp;<span class="builtinfunc" id="3874537">len</span><span class="op" id="3874540">(</span><span class="ident" id="3874541">msg</span><span class="op" id="3874544">)</span>&nbsp;<span class="op" id="3874546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874552">return</span>&nbsp;<span class="string" id="3874559">&#34;&#34;</span><span class="op" id="3874561">,</span>&nbsp;<span class="builtinfunc" id="3874563">len</span><span class="op" id="3874566">(</span><span class="ident" id="3874567">msg</span><span class="op" id="3874570">)</span><span class="op" id="3874571">,</span>&nbsp;<span class="builtintype" id="3874573">false</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3874582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874587">s</span>&nbsp;<span class="op" id="3874589">+=</span>&nbsp;<span class="builtintype" id="3874592">string</span><span class="op" id="3874598">(</span><span class="ident" id="3874599">msg</span><span class="op" id="3874602">[</span><span class="ident" id="3874603">off</span><span class="op" id="3874606">:</span><span class="ident" id="3874607">off</span><span class="op" id="3874610">+</span><span class="ident" id="3874611">c</span><span class="op" id="3874612">]</span><span class="op" id="3874613">)</span>&nbsp;<span class="op" id="3874615">+</span>&nbsp;<span class="string" id="3874617">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874624">off</span>&nbsp;<span class="op" id="3874628">+=</span>&nbsp;<span class="ident" id="3874631">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874635">case</span>&nbsp;<span class="num" id="3874640">0xC0</span><span class="op" id="3874644">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3874649">//&nbsp;pointer&nbsp;to&nbsp;somewhere&nbsp;else&nbsp;in&nbsp;msg.</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3874689">//&nbsp;remember&nbsp;location&nbsp;after&nbsp;first&nbsp;ptr,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3874730">//&nbsp;since&nbsp;that&#39;s&nbsp;how&nbsp;many&nbsp;bytes&nbsp;we&nbsp;consumed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3874777">//&nbsp;also,&nbsp;don&#39;t&nbsp;follow&nbsp;too&nbsp;many&nbsp;pointers&nbsp;--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3874823">//&nbsp;maybe&nbsp;there&#39;s&nbsp;a&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874851">if</span>&nbsp;<span class="ident" id="3874854">off</span>&nbsp;<span class="op" id="3874858">&gt;=</span>&nbsp;<span class="builtinfunc" id="3874861">len</span><span class="op" id="3874864">(</span><span class="ident" id="3874865">msg</span><span class="op" id="3874868">)</span>&nbsp;<span class="op" id="3874870">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874876">return</span>&nbsp;<span class="string" id="3874883">&#34;&#34;</span><span class="op" id="3874885">,</span>&nbsp;<span class="builtinfunc" id="3874887">len</span><span class="op" id="3874890">(</span><span class="ident" id="3874891">msg</span><span class="op" id="3874894">)</span><span class="op" id="3874895">,</span>&nbsp;<span class="builtintype" id="3874897">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3874906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874911">c1</span>&nbsp;<span class="op" id="3874914">:=</span>&nbsp;<span class="ident" id="3874917">msg</span><span class="op" id="3874920">[</span><span class="ident" id="3874921">off</span><span class="op" id="3874924">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874929">off</span><span class="op" id="3874932">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874938">if</span>&nbsp;<span class="ident" id="3874941">ptr</span>&nbsp;<span class="op" id="3874945">==</span>&nbsp;<span class="num" id="3874948">0</span>&nbsp;<span class="op" id="3874950">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874956">off1</span>&nbsp;<span class="op" id="3874961">=</span>&nbsp;<span class="ident" id="3874963">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3874970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874975">if</span>&nbsp;<span class="ident" id="3874978">ptr</span><span class="op" id="3874981">++</span><span class="op" id="3874983">;</span>&nbsp;<span class="ident" id="3874985">ptr</span>&nbsp;<span class="op" id="3874989">&gt;</span>&nbsp;<span class="num" id="3874991">10</span>&nbsp;<span class="op" id="3874994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875000">return</span>&nbsp;<span class="string" id="3875007">&#34;&#34;</span><span class="op" id="3875009">,</span>&nbsp;<span class="builtinfunc" id="3875011">len</span><span class="op" id="3875014">(</span><span class="ident" id="3875015">msg</span><span class="op" id="3875018">)</span><span class="op" id="3875019">,</span>&nbsp;<span class="builtintype" id="3875021">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3875030">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875035">off</span>&nbsp;<span class="op" id="3875039">=</span>&nbsp;<span class="op" id="3875041">(</span><span class="ident" id="3875042">c</span><span class="op" id="3875043">^</span><span class="num" id="3875044">0xC0</span><span class="op" id="3875048">)</span><span class="op" id="3875049">&lt;&lt;</span><span class="num" id="3875051">8</span>&nbsp;<span class="op" id="3875053">|</span>&nbsp;<span class="builtintype" id="3875055">int</span><span class="op" id="3875058">(</span><span class="ident" id="3875059">c1</span><span class="op" id="3875061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875065">default</span><span class="op" id="3875072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3875077">//&nbsp;0x80&nbsp;and&nbsp;0x40&nbsp;are&nbsp;reserved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875110">return</span>&nbsp;<span class="string" id="3875117">&#34;&#34;</span><span class="op" id="3875119">,</span>&nbsp;<span class="builtinfunc" id="3875121">len</span><span class="op" id="3875124">(</span><span class="ident" id="3875125">msg</span><span class="op" id="3875128">)</span><span class="op" id="3875129">,</span>&nbsp;<span class="builtintype" id="3875131">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3875139">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3875142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875145">if</span>&nbsp;<span class="ident" id="3875148">ptr</span>&nbsp;<span class="op" id="3875152">==</span>&nbsp;<span class="num" id="3875155">0</span>&nbsp;<span class="op" id="3875157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875161">off1</span>&nbsp;<span class="op" id="3875166">=</span>&nbsp;<span class="ident" id="3875168">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3875173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875176">return</span>&nbsp;<span class="ident" id="3875183">s</span><span class="op" id="3875184">,</span>&nbsp;<span class="ident" id="3875186">off1</span><span class="op" id="3875190">,</span>&nbsp;<span class="builtintype" id="3875192">true</span><br>
<span class="lineno">485</span><span class="op" id="3875197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3875200">//&nbsp;packStruct&nbsp;packs&nbsp;a&nbsp;structure&nbsp;into&nbsp;msg&nbsp;at&nbsp;specified&nbsp;offset&nbsp;off,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3875270">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3875331">func</span>&nbsp;<span class="ident" id="3875336">packStruct</span><span class="op" id="3875346">(</span><span class="ident" id="3875347">any</span>&nbsp;<span class="ident" id="3875351">dnsStruct</span><span class="op" id="3875360">,</span>&nbsp;<span class="ident" id="3875362">msg</span>&nbsp;<span class="op" id="3875366">[</span><span class="op" id="3875367">]</span><span class="builtintype" id="3875368">byte</span><span class="op" id="3875372">,</span>&nbsp;<span class="ident" id="3875374">off</span>&nbsp;<span class="builtintype" id="3875378">int</span><span class="op" id="3875381">)</span>&nbsp;<span class="op" id="3875383">(</span><span class="ident" id="3875384">off1</span>&nbsp;<span class="builtintype" id="3875389">int</span><span class="op" id="3875392">,</span>&nbsp;<span class="ident" id="3875394">ok</span>&nbsp;<span class="builtintype" id="3875397">bool</span><span class="op" id="3875401">)</span>&nbsp;<span class="op" id="3875403">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875406">ok</span>&nbsp;<span class="op" id="3875409">=</span>&nbsp;<span class="ident" id="3875411">any</span><span class="op" id="3875414">.</span><span class="ident" id="3875415">Walk</span><span class="op" id="3875419">(</span><span class="keyword" id="3875420">func</span><span class="op" id="3875424">(</span><span class="ident" id="3875425">field</span>&nbsp;<span class="keyword" id="3875431">interface</span><span class="op" id="3875440">{</span><span class="op" id="3875441">}</span><span class="op" id="3875442">,</span>&nbsp;<span class="ident" id="3875444">name</span><span class="op" id="3875448">,</span>&nbsp;<span class="ident" id="3875450">tag</span>&nbsp;<span class="builtintype" id="3875454">string</span><span class="op" id="3875460">)</span>&nbsp;<span class="builtintype" id="3875462">bool</span>&nbsp;<span class="op" id="3875467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875471">switch</span>&nbsp;<span class="ident" id="3875478">fv</span>&nbsp;<span class="op" id="3875481">:=</span>&nbsp;<span class="ident" id="3875484">field</span><span class="op" id="3875489">.</span><span class="op" id="3875490">(</span><span class="keyword" id="3875491">type</span><span class="op" id="3875495">)</span>&nbsp;<span class="op" id="3875497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875501">default</span><span class="op" id="3875508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3875513">println</span><span class="op" id="3875520">(</span><span class="string" id="3875521">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3875553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875558">return</span>&nbsp;<span class="builtintype" id="3875565">false</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875573">case</span>&nbsp;<span class="op" id="3875578">*</span><span class="builtintype" id="3875579">uint16</span><span class="op" id="3875585">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875590">i</span>&nbsp;<span class="op" id="3875592">:=</span>&nbsp;<span class="op" id="3875595">*</span><span class="ident" id="3875596">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875602">if</span>&nbsp;<span class="ident" id="3875605">off</span><span class="op" id="3875608">+</span><span class="num" id="3875609">2</span>&nbsp;<span class="op" id="3875611">&gt;</span>&nbsp;<span class="builtinfunc" id="3875613">len</span><span class="op" id="3875616">(</span><span class="ident" id="3875617">msg</span><span class="op" id="3875620">)</span>&nbsp;<span class="op" id="3875622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875628">return</span>&nbsp;<span class="builtintype" id="3875635">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3875644">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875649">msg</span><span class="op" id="3875652">[</span><span class="ident" id="3875653">off</span><span class="op" id="3875656">]</span>&nbsp;<span class="op" id="3875658">=</span>&nbsp;<span class="builtintype" id="3875660">byte</span><span class="op" id="3875664">(</span><span class="ident" id="3875665">i</span>&nbsp;<span class="op" id="3875667">&gt;&gt;</span>&nbsp;<span class="num" id="3875670">8</span><span class="op" id="3875671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875676">msg</span><span class="op" id="3875679">[</span><span class="ident" id="3875680">off</span><span class="op" id="3875683">+</span><span class="num" id="3875684">1</span><span class="op" id="3875685">]</span>&nbsp;<span class="op" id="3875687">=</span>&nbsp;<span class="builtintype" id="3875689">byte</span><span class="op" id="3875693">(</span><span class="ident" id="3875694">i</span><span class="op" id="3875695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875700">off</span>&nbsp;<span class="op" id="3875704">+=</span>&nbsp;<span class="num" id="3875707">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875711">case</span>&nbsp;<span class="op" id="3875716">*</span><span class="builtintype" id="3875717">uint32</span><span class="op" id="3875723">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875728">i</span>&nbsp;<span class="op" id="3875730">:=</span>&nbsp;<span class="op" id="3875733">*</span><span class="ident" id="3875734">fv</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875740">msg</span><span class="op" id="3875743">[</span><span class="ident" id="3875744">off</span><span class="op" id="3875747">]</span>&nbsp;<span class="op" id="3875749">=</span>&nbsp;<span class="builtintype" id="3875751">byte</span><span class="op" id="3875755">(</span><span class="ident" id="3875756">i</span>&nbsp;<span class="op" id="3875758">&gt;&gt;</span>&nbsp;<span class="num" id="3875761">24</span><span class="op" id="3875763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875768">msg</span><span class="op" id="3875771">[</span><span class="ident" id="3875772">off</span><span class="op" id="3875775">+</span><span class="num" id="3875776">1</span><span class="op" id="3875777">]</span>&nbsp;<span class="op" id="3875779">=</span>&nbsp;<span class="builtintype" id="3875781">byte</span><span class="op" id="3875785">(</span><span class="ident" id="3875786">i</span>&nbsp;<span class="op" id="3875788">&gt;&gt;</span>&nbsp;<span class="num" id="3875791">16</span><span class="op" id="3875793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875798">msg</span><span class="op" id="3875801">[</span><span class="ident" id="3875802">off</span><span class="op" id="3875805">+</span><span class="num" id="3875806">2</span><span class="op" id="3875807">]</span>&nbsp;<span class="op" id="3875809">=</span>&nbsp;<span class="builtintype" id="3875811">byte</span><span class="op" id="3875815">(</span><span class="ident" id="3875816">i</span>&nbsp;<span class="op" id="3875818">&gt;&gt;</span>&nbsp;<span class="num" id="3875821">8</span><span class="op" id="3875822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875827">msg</span><span class="op" id="3875830">[</span><span class="ident" id="3875831">off</span><span class="op" id="3875834">+</span><span class="num" id="3875835">3</span><span class="op" id="3875836">]</span>&nbsp;<span class="op" id="3875838">=</span>&nbsp;<span class="builtintype" id="3875840">byte</span><span class="op" id="3875844">(</span><span class="ident" id="3875845">i</span><span class="op" id="3875846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875851">off</span>&nbsp;<span class="op" id="3875855">+=</span>&nbsp;<span class="num" id="3875858">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875862">case</span>&nbsp;<span class="op" id="3875867">[</span><span class="op" id="3875868">]</span><span class="builtintype" id="3875869">byte</span><span class="op" id="3875873">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875878">n</span>&nbsp;<span class="op" id="3875880">:=</span>&nbsp;<span class="builtinfunc" id="3875883">len</span><span class="op" id="3875886">(</span><span class="ident" id="3875887">fv</span><span class="op" id="3875889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875894">if</span>&nbsp;<span class="ident" id="3875897">off</span><span class="op" id="3875900">+</span><span class="ident" id="3875901">n</span>&nbsp;<span class="op" id="3875903">&gt;</span>&nbsp;<span class="builtinfunc" id="3875905">len</span><span class="op" id="3875908">(</span><span class="ident" id="3875909">msg</span><span class="op" id="3875912">)</span>&nbsp;<span class="op" id="3875914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875920">return</span>&nbsp;<span class="builtintype" id="3875927">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3875936">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3875941">copy</span><span class="op" id="3875945">(</span><span class="ident" id="3875946">msg</span><span class="op" id="3875949">[</span><span class="ident" id="3875950">off</span><span class="op" id="3875953">:</span><span class="ident" id="3875954">off</span><span class="op" id="3875957">+</span><span class="ident" id="3875958">n</span><span class="op" id="3875959">]</span><span class="op" id="3875960">,</span>&nbsp;<span class="ident" id="3875962">fv</span><span class="op" id="3875964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875969">off</span>&nbsp;<span class="op" id="3875973">+=</span>&nbsp;<span class="ident" id="3875976">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875980">case</span>&nbsp;<span class="op" id="3875985">*</span><span class="builtintype" id="3875986">string</span><span class="op" id="3875992">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875997">s</span>&nbsp;<span class="op" id="3875999">:=</span>&nbsp;<span class="op" id="3876002">*</span><span class="ident" id="3876003">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876009">switch</span>&nbsp;<span class="ident" id="3876016">tag</span>&nbsp;<span class="op" id="3876020">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876025">default</span><span class="op" id="3876032">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3876038">println</span><span class="op" id="3876045">(</span><span class="string" id="3876046">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3876076">,</span>&nbsp;<span class="ident" id="3876078">tag</span><span class="op" id="3876081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876087">return</span>&nbsp;<span class="builtintype" id="3876094">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876103">case</span>&nbsp;<span class="string" id="3876108">&#34;domain&#34;</span><span class="op" id="3876116">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876122">off</span><span class="op" id="3876125">,</span>&nbsp;<span class="ident" id="3876127">ok</span>&nbsp;<span class="op" id="3876130">=</span>&nbsp;<span class="ident" id="3876132">packDomainName</span><span class="op" id="3876146">(</span><span class="ident" id="3876147">s</span><span class="op" id="3876148">,</span>&nbsp;<span class="ident" id="3876150">msg</span><span class="op" id="3876153">,</span>&nbsp;<span class="ident" id="3876155">off</span><span class="op" id="3876158">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876164">if</span>&nbsp;<span class="op" id="3876167">!</span><span class="ident" id="3876168">ok</span>&nbsp;<span class="op" id="3876171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876178">return</span>&nbsp;<span class="builtintype" id="3876185">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876200">case</span>&nbsp;<span class="string" id="3876205">&#34;&#34;</span><span class="op" id="3876207">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3876213">//&nbsp;Counted&nbsp;string:&nbsp;1&nbsp;byte&nbsp;length.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876251">if</span>&nbsp;<span class="builtinfunc" id="3876254">len</span><span class="op" id="3876257">(</span><span class="ident" id="3876258">s</span><span class="op" id="3876259">)</span>&nbsp;<span class="op" id="3876261">&gt;</span>&nbsp;<span class="num" id="3876263">255</span>&nbsp;<span class="op" id="3876267">||</span>&nbsp;<span class="ident" id="3876270">off</span><span class="op" id="3876273">+</span><span class="num" id="3876274">1</span><span class="op" id="3876275">+</span><span class="builtinfunc" id="3876276">len</span><span class="op" id="3876279">(</span><span class="ident" id="3876280">s</span><span class="op" id="3876281">)</span>&nbsp;<span class="op" id="3876283">&gt;</span>&nbsp;<span class="builtinfunc" id="3876285">len</span><span class="op" id="3876288">(</span><span class="ident" id="3876289">msg</span><span class="op" id="3876292">)</span>&nbsp;<span class="op" id="3876294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876301">return</span>&nbsp;<span class="builtintype" id="3876308">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876324">msg</span><span class="op" id="3876327">[</span><span class="ident" id="3876328">off</span><span class="op" id="3876331">]</span>&nbsp;<span class="op" id="3876333">=</span>&nbsp;<span class="builtintype" id="3876335">byte</span><span class="op" id="3876339">(</span><span class="builtinfunc" id="3876340">len</span><span class="op" id="3876343">(</span><span class="ident" id="3876344">s</span><span class="op" id="3876345">)</span><span class="op" id="3876346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876352">off</span><span class="op" id="3876355">++</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876362">off</span>&nbsp;<span class="op" id="3876366">+=</span>&nbsp;<span class="builtinfunc" id="3876369">copy</span><span class="op" id="3876373">(</span><span class="ident" id="3876374">msg</span><span class="op" id="3876377">[</span><span class="ident" id="3876378">off</span><span class="op" id="3876381">:</span><span class="op" id="3876382">]</span><span class="op" id="3876383">,</span>&nbsp;<span class="ident" id="3876385">s</span><span class="op" id="3876386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876399">return</span>&nbsp;<span class="builtintype" id="3876406">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876412">}</span><span class="op" id="3876413">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876416">if</span>&nbsp;<span class="op" id="3876419">!</span><span class="ident" id="3876420">ok</span>&nbsp;<span class="op" id="3876423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876427">return</span>&nbsp;<span class="builtinfunc" id="3876434">len</span><span class="op" id="3876437">(</span><span class="ident" id="3876438">msg</span><span class="op" id="3876441">)</span><span class="op" id="3876442">,</span>&nbsp;<span class="builtintype" id="3876444">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876454">return</span>&nbsp;<span class="ident" id="3876461">off</span><span class="op" id="3876464">,</span>&nbsp;<span class="builtintype" id="3876466">true</span><br>
<span class="lineno"></span><span class="op" id="3876471">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="3876474">//&nbsp;unpackStruct&nbsp;decodes&nbsp;msg[off:] into&nbsp;the&nbsp;given&nbsp;structure,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3876539">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3876600">func</span>&nbsp;<span class="ident" id="3876605">unpackStruct</span><span class="op" id="3876617">(</span><span class="ident" id="3876618">any</span>&nbsp;<span class="ident" id="3876622">dnsStruct</span><span class="op" id="3876631">,</span>&nbsp;<span class="ident" id="3876633">msg</span>&nbsp;<span class="op" id="3876637">[</span><span class="op" id="3876638">]</span><span class="builtintype" id="3876639">byte</span><span class="op" id="3876643">,</span>&nbsp;<span class="ident" id="3876645">off</span>&nbsp;<span class="builtintype" id="3876649">int</span><span class="op" id="3876652">)</span>&nbsp;<span class="op" id="3876654">(</span><span class="ident" id="3876655">off1</span>&nbsp;<span class="builtintype" id="3876660">int</span><span class="op" id="3876663">,</span>&nbsp;<span class="ident" id="3876665">ok</span>&nbsp;<span class="builtintype" id="3876668">bool</span><span class="op" id="3876672">)</span>&nbsp;<span class="op" id="3876674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876677">ok</span>&nbsp;<span class="op" id="3876680">=</span>&nbsp;<span class="ident" id="3876682">any</span><span class="op" id="3876685">.</span><span class="ident" id="3876686">Walk</span><span class="op" id="3876690">(</span><span class="keyword" id="3876691">func</span><span class="op" id="3876695">(</span><span class="ident" id="3876696">field</span>&nbsp;<span class="keyword" id="3876702">interface</span><span class="op" id="3876711">{</span><span class="op" id="3876712">}</span><span class="op" id="3876713">,</span>&nbsp;<span class="ident" id="3876715">name</span><span class="op" id="3876719">,</span>&nbsp;<span class="ident" id="3876721">tag</span>&nbsp;<span class="builtintype" id="3876725">string</span><span class="op" id="3876731">)</span>&nbsp;<span class="builtintype" id="3876733">bool</span>&nbsp;<span class="op" id="3876738">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876742">switch</span>&nbsp;<span class="ident" id="3876749">fv</span>&nbsp;<span class="op" id="3876752">:=</span>&nbsp;<span class="ident" id="3876755">field</span><span class="op" id="3876760">.</span><span class="op" id="3876761">(</span><span class="keyword" id="3876762">type</span><span class="op" id="3876766">)</span>&nbsp;<span class="op" id="3876768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876772">default</span><span class="op" id="3876779">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3876784">println</span><span class="op" id="3876791">(</span><span class="string" id="3876792">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3876824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876829">return</span>&nbsp;<span class="builtintype" id="3876836">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876844">case</span>&nbsp;<span class="op" id="3876849">*</span><span class="builtintype" id="3876850">uint16</span><span class="op" id="3876856">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876861">if</span>&nbsp;<span class="ident" id="3876864">off</span><span class="op" id="3876867">+</span><span class="num" id="3876868">2</span>&nbsp;<span class="op" id="3876870">&gt;</span>&nbsp;<span class="builtinfunc" id="3876872">len</span><span class="op" id="3876875">(</span><span class="ident" id="3876876">msg</span><span class="op" id="3876879">)</span>&nbsp;<span class="op" id="3876881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876887">return</span>&nbsp;<span class="builtintype" id="3876894">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876908">*</span><span class="ident" id="3876909">fv</span>&nbsp;<span class="op" id="3876912">=</span>&nbsp;<span class="builtintype" id="3876914">uint16</span><span class="op" id="3876920">(</span><span class="ident" id="3876921">msg</span><span class="op" id="3876924">[</span><span class="ident" id="3876925">off</span><span class="op" id="3876928">]</span><span class="op" id="3876929">)</span><span class="op" id="3876930">&lt;&lt;</span><span class="num" id="3876932">8</span>&nbsp;<span class="op" id="3876934">|</span>&nbsp;<span class="builtintype" id="3876936">uint16</span><span class="op" id="3876942">(</span><span class="ident" id="3876943">msg</span><span class="op" id="3876946">[</span><span class="ident" id="3876947">off</span><span class="op" id="3876950">+</span><span class="num" id="3876951">1</span><span class="op" id="3876952">]</span><span class="op" id="3876953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876958">off</span>&nbsp;<span class="op" id="3876962">+=</span>&nbsp;<span class="num" id="3876965">2</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876969">case</span>&nbsp;<span class="op" id="3876974">*</span><span class="builtintype" id="3876975">uint32</span><span class="op" id="3876981">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876986">if</span>&nbsp;<span class="ident" id="3876989">off</span><span class="op" id="3876992">+</span><span class="num" id="3876993">4</span>&nbsp;<span class="op" id="3876995">&gt;</span>&nbsp;<span class="builtinfunc" id="3876997">len</span><span class="op" id="3877000">(</span><span class="ident" id="3877001">msg</span><span class="op" id="3877004">)</span>&nbsp;<span class="op" id="3877006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877012">return</span>&nbsp;<span class="builtintype" id="3877019">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3877028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3877033">*</span><span class="ident" id="3877034">fv</span>&nbsp;<span class="op" id="3877037">=</span>&nbsp;<span class="builtintype" id="3877039">uint32</span><span class="op" id="3877045">(</span><span class="ident" id="3877046">msg</span><span class="op" id="3877049">[</span><span class="ident" id="3877050">off</span><span class="op" id="3877053">]</span><span class="op" id="3877054">)</span><span class="op" id="3877055">&lt;&lt;</span><span class="num" id="3877057">24</span>&nbsp;<span class="op" id="3877060">|</span>&nbsp;<span class="builtintype" id="3877062">uint32</span><span class="op" id="3877068">(</span><span class="ident" id="3877069">msg</span><span class="op" id="3877072">[</span><span class="ident" id="3877073">off</span><span class="op" id="3877076">+</span><span class="num" id="3877077">1</span><span class="op" id="3877078">]</span><span class="op" id="3877079">)</span><span class="op" id="3877080">&lt;&lt;</span><span class="num" id="3877082">16</span>&nbsp;<span class="op" id="3877085">|</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3877091">uint32</span><span class="op" id="3877097">(</span><span class="ident" id="3877098">msg</span><span class="op" id="3877101">[</span><span class="ident" id="3877102">off</span><span class="op" id="3877105">+</span><span class="num" id="3877106">2</span><span class="op" id="3877107">]</span><span class="op" id="3877108">)</span><span class="op" id="3877109">&lt;&lt;</span><span class="num" id="3877111">8</span>&nbsp;<span class="op" id="3877113">|</span>&nbsp;<span class="builtintype" id="3877115">uint32</span><span class="op" id="3877121">(</span><span class="ident" id="3877122">msg</span><span class="op" id="3877125">[</span><span class="ident" id="3877126">off</span><span class="op" id="3877129">+</span><span class="num" id="3877130">3</span><span class="op" id="3877131">]</span><span class="op" id="3877132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877137">off</span>&nbsp;<span class="op" id="3877141">+=</span>&nbsp;<span class="num" id="3877144">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877148">case</span>&nbsp;<span class="op" id="3877153">[</span><span class="op" id="3877154">]</span><span class="builtintype" id="3877155">byte</span><span class="op" id="3877159">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877164">n</span>&nbsp;<span class="op" id="3877166">:=</span>&nbsp;<span class="builtinfunc" id="3877169">len</span><span class="op" id="3877172">(</span><span class="ident" id="3877173">fv</span><span class="op" id="3877175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877180">if</span>&nbsp;<span class="ident" id="3877183">off</span><span class="op" id="3877186">+</span><span class="ident" id="3877187">n</span>&nbsp;<span class="op" id="3877189">&gt;</span>&nbsp;<span class="builtinfunc" id="3877191">len</span><span class="op" id="3877194">(</span><span class="ident" id="3877195">msg</span><span class="op" id="3877198">)</span>&nbsp;<span class="op" id="3877200">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877206">return</span>&nbsp;<span class="builtintype" id="3877213">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3877222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3877227">copy</span><span class="op" id="3877231">(</span><span class="ident" id="3877232">fv</span><span class="op" id="3877234">,</span>&nbsp;<span class="ident" id="3877236">msg</span><span class="op" id="3877239">[</span><span class="ident" id="3877240">off</span><span class="op" id="3877243">:</span><span class="ident" id="3877244">off</span><span class="op" id="3877247">+</span><span class="ident" id="3877248">n</span><span class="op" id="3877249">]</span><span class="op" id="3877250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877255">off</span>&nbsp;<span class="op" id="3877259">+=</span>&nbsp;<span class="ident" id="3877262">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877266">case</span>&nbsp;<span class="op" id="3877271">*</span><span class="builtintype" id="3877272">string</span><span class="op" id="3877278">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877283">var</span>&nbsp;<span class="ident" id="3877287">s</span>&nbsp;<span class="builtintype" id="3877289">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877299">switch</span>&nbsp;<span class="ident" id="3877306">tag</span>&nbsp;<span class="op" id="3877310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877315">default</span><span class="op" id="3877322">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3877328">println</span><span class="op" id="3877335">(</span><span class="string" id="3877336">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3877366">,</span>&nbsp;<span class="ident" id="3877368">tag</span><span class="op" id="3877371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877377">return</span>&nbsp;<span class="builtintype" id="3877384">false</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877393">case</span>&nbsp;<span class="string" id="3877398">&#34;domain&#34;</span><span class="op" id="3877406">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877412">s</span><span class="op" id="3877413">,</span>&nbsp;<span class="ident" id="3877415">off</span><span class="op" id="3877418">,</span>&nbsp;<span class="ident" id="3877420">ok</span>&nbsp;<span class="op" id="3877423">=</span>&nbsp;<span class="ident" id="3877425">unpackDomainName</span><span class="op" id="3877441">(</span><span class="ident" id="3877442">msg</span><span class="op" id="3877445">,</span>&nbsp;<span class="ident" id="3877447">off</span><span class="op" id="3877450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877456">if</span>&nbsp;<span class="op" id="3877459">!</span><span class="ident" id="3877460">ok</span>&nbsp;<span class="op" id="3877463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877470">return</span>&nbsp;<span class="builtintype" id="3877477">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3877487">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877492">case</span>&nbsp;<span class="string" id="3877497">&#34;&#34;</span><span class="op" id="3877499">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877505">if</span>&nbsp;<span class="ident" id="3877508">off</span>&nbsp;<span class="op" id="3877512">&gt;=</span>&nbsp;<span class="builtinfunc" id="3877515">len</span><span class="op" id="3877518">(</span><span class="ident" id="3877519">msg</span><span class="op" id="3877522">)</span>&nbsp;<span class="op" id="3877524">||</span>&nbsp;<span class="ident" id="3877527">off</span><span class="op" id="3877530">+</span><span class="num" id="3877531">1</span><span class="op" id="3877532">+</span><span class="builtintype" id="3877533">int</span><span class="op" id="3877536">(</span><span class="ident" id="3877537">msg</span><span class="op" id="3877540">[</span><span class="ident" id="3877541">off</span><span class="op" id="3877544">]</span><span class="op" id="3877545">)</span>&nbsp;<span class="op" id="3877547">&gt;</span>&nbsp;<span class="builtinfunc" id="3877549">len</span><span class="op" id="3877552">(</span><span class="ident" id="3877553">msg</span><span class="op" id="3877556">)</span>&nbsp;<span class="op" id="3877558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877565">return</span>&nbsp;<span class="builtintype" id="3877572">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3877582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877588">n</span>&nbsp;<span class="op" id="3877590">:=</span>&nbsp;<span class="builtintype" id="3877593">int</span><span class="op" id="3877596">(</span><span class="ident" id="3877597">msg</span><span class="op" id="3877600">[</span><span class="ident" id="3877601">off</span><span class="op" id="3877604">]</span><span class="op" id="3877605">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877611">off</span><span class="op" id="3877614">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877621">b</span>&nbsp;<span class="op" id="3877623">:=</span>&nbsp;<span class="builtinfunc" id="3877626">make</span><span class="op" id="3877630">(</span><span class="op" id="3877631">[</span><span class="op" id="3877632">]</span><span class="builtintype" id="3877633">byte</span><span class="op" id="3877637">,</span>&nbsp;<span class="ident" id="3877639">n</span><span class="op" id="3877640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877646">for</span>&nbsp;<span class="ident" id="3877650">i</span>&nbsp;<span class="op" id="3877652">:=</span>&nbsp;<span class="num" id="3877655">0</span><span class="op" id="3877656">;</span>&nbsp;<span class="ident" id="3877658">i</span>&nbsp;<span class="op" id="3877660">&lt;</span>&nbsp;<span class="ident" id="3877662">n</span><span class="op" id="3877663">;</span>&nbsp;<span class="ident" id="3877665">i</span><span class="op" id="3877666">++</span>&nbsp;<span class="op" id="3877669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877676">b</span><span class="op" id="3877677">[</span><span class="ident" id="3877678">i</span><span class="op" id="3877679">]</span>&nbsp;<span class="op" id="3877681">=</span>&nbsp;<span class="ident" id="3877683">msg</span><span class="op" id="3877686">[</span><span class="ident" id="3877687">off</span><span class="op" id="3877690">+</span><span class="ident" id="3877691">i</span><span class="op" id="3877692">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3877698">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877704">off</span>&nbsp;<span class="op" id="3877708">+=</span>&nbsp;<span class="ident" id="3877711">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877717">s</span>&nbsp;<span class="op" id="3877719">=</span>&nbsp;<span class="builtintype" id="3877721">string</span><span class="op" id="3877727">(</span><span class="ident" id="3877728">b</span><span class="op" id="3877729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3877734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3877739">*</span><span class="ident" id="3877740">fv</span>&nbsp;<span class="op" id="3877743">=</span>&nbsp;<span class="ident" id="3877745">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3877749">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877753">return</span>&nbsp;<span class="builtintype" id="3877760">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3877766">}</span><span class="op" id="3877767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877770">if</span>&nbsp;<span class="op" id="3877773">!</span><span class="ident" id="3877774">ok</span>&nbsp;<span class="op" id="3877777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877781">return</span>&nbsp;<span class="builtinfunc" id="3877788">len</span><span class="op" id="3877791">(</span><span class="ident" id="3877792">msg</span><span class="op" id="3877795">)</span><span class="op" id="3877796">,</span>&nbsp;<span class="builtintype" id="3877798">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3877805">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877808">return</span>&nbsp;<span class="ident" id="3877815">off</span><span class="op" id="3877818">,</span>&nbsp;<span class="builtintype" id="3877820">true</span><br>
<span class="lineno"></span><span class="op" id="3877825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3877828">//&nbsp;Generic&nbsp;struct&nbsp;printer.&nbsp;Prints&nbsp;fields&nbsp;with&nbsp;tag&nbsp;&#34;ipv4&#34;&nbsp;or&nbsp;&#34;ipv6&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3877895">//&nbsp;as&nbsp;IP&nbsp;addresses.</span><br>
<span class="lineno">610</span><span class="keyword" id="3877915">func</span>&nbsp;<span class="ident" id="3877920">printStruct</span><span class="op" id="3877931">(</span><span class="ident" id="3877932">any</span>&nbsp;<span class="ident" id="3877936">dnsStruct</span><span class="op" id="3877945">)</span>&nbsp;<span class="builtintype" id="3877947">string</span>&nbsp;<span class="op" id="3877954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877957">s</span>&nbsp;<span class="op" id="3877959">:=</span>&nbsp;<span class="string" id="3877962">&#34;{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877967">i</span>&nbsp;<span class="op" id="3877969">:=</span>&nbsp;<span class="num" id="3877972">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877975">any</span><span class="op" id="3877978">.</span><span class="ident" id="3877979">Walk</span><span class="op" id="3877983">(</span><span class="keyword" id="3877984">func</span><span class="op" id="3877988">(</span><span class="ident" id="3877989">val</span>&nbsp;<span class="keyword" id="3877993">interface</span><span class="op" id="3878002">{</span><span class="op" id="3878003">}</span><span class="op" id="3878004">,</span>&nbsp;<span class="ident" id="3878006">name</span><span class="op" id="3878010">,</span>&nbsp;<span class="ident" id="3878012">tag</span>&nbsp;<span class="builtintype" id="3878016">string</span><span class="op" id="3878022">)</span>&nbsp;<span class="builtintype" id="3878024">bool</span>&nbsp;<span class="op" id="3878029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878033">i</span><span class="op" id="3878034">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878039">if</span>&nbsp;<span class="ident" id="3878042">i</span>&nbsp;<span class="op" id="3878044">&gt;</span>&nbsp;<span class="num" id="3878046">1</span>&nbsp;<span class="op" id="3878048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878053">s</span>&nbsp;<span class="op" id="3878055">+=</span>&nbsp;<span class="string" id="3878058">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3878065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878069">s</span>&nbsp;<span class="op" id="3878071">+=</span>&nbsp;<span class="ident" id="3878074">name</span>&nbsp;<span class="op" id="3878079">+</span>&nbsp;<span class="string" id="3878081">&#34;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878087">switch</span>&nbsp;<span class="ident" id="3878094">tag</span>&nbsp;<span class="op" id="3878098">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878102">case</span>&nbsp;<span class="string" id="3878107">&#34;ipv4&#34;</span><span class="op" id="3878113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878118">i</span>&nbsp;<span class="op" id="3878120">:=</span>&nbsp;<span class="op" id="3878123">*</span><span class="ident" id="3878124">val</span><span class="op" id="3878127">.</span><span class="op" id="3878128">(</span><span class="op" id="3878129">*</span><span class="builtintype" id="3878130">uint32</span><span class="op" id="3878136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878141">s</span>&nbsp;<span class="op" id="3878143">+=</span>&nbsp;<span class="ident" id="3878146">IPv4</span><span class="op" id="3878150">(</span><span class="builtintype" id="3878151">byte</span><span class="op" id="3878155">(</span><span class="ident" id="3878156">i</span><span class="op" id="3878157">&gt;&gt;</span><span class="num" id="3878159">24</span><span class="op" id="3878161">)</span><span class="op" id="3878162">,</span>&nbsp;<span class="builtintype" id="3878164">byte</span><span class="op" id="3878168">(</span><span class="ident" id="3878169">i</span><span class="op" id="3878170">&gt;&gt;</span><span class="num" id="3878172">16</span><span class="op" id="3878174">)</span><span class="op" id="3878175">,</span>&nbsp;<span class="builtintype" id="3878177">byte</span><span class="op" id="3878181">(</span><span class="ident" id="3878182">i</span><span class="op" id="3878183">&gt;&gt;</span><span class="num" id="3878185">8</span><span class="op" id="3878186">)</span><span class="op" id="3878187">,</span>&nbsp;<span class="builtintype" id="3878189">byte</span><span class="op" id="3878193">(</span><span class="ident" id="3878194">i</span><span class="op" id="3878195">)</span><span class="op" id="3878196">)</span><span class="op" id="3878197">.</span><span class="ident" id="3878198">String</span><span class="op" id="3878204">(</span><span class="op" id="3878205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878209">case</span>&nbsp;<span class="string" id="3878214">&#34;ipv6&#34;</span><span class="op" id="3878220">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878225">i</span>&nbsp;<span class="op" id="3878227">:=</span>&nbsp;<span class="ident" id="3878230">val</span><span class="op" id="3878233">.</span><span class="op" id="3878234">(</span><span class="op" id="3878235">[</span><span class="op" id="3878236">]</span><span class="builtintype" id="3878237">byte</span><span class="op" id="3878241">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878246">s</span>&nbsp;<span class="op" id="3878248">+=</span>&nbsp;<span class="ident" id="3878251">IP</span><span class="op" id="3878253">(</span><span class="ident" id="3878254">i</span><span class="op" id="3878255">)</span><span class="op" id="3878256">.</span><span class="ident" id="3878257">String</span><span class="op" id="3878263">(</span><span class="op" id="3878264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878268">default</span><span class="op" id="3878275">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878280">var</span>&nbsp;<span class="ident" id="3878284">i</span>&nbsp;<span class="ident" id="3878286">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878295">switch</span>&nbsp;<span class="ident" id="3878302">v</span>&nbsp;<span class="op" id="3878304">:=</span>&nbsp;<span class="ident" id="3878307">val</span><span class="op" id="3878310">.</span><span class="op" id="3878311">(</span><span class="keyword" id="3878312">type</span><span class="op" id="3878316">)</span>&nbsp;<span class="op" id="3878318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878323">default</span><span class="op" id="3878330">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878336">//&nbsp;can&#39;t&nbsp;really&nbsp;happen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878364">s</span>&nbsp;<span class="op" id="3878366">+=</span>&nbsp;<span class="string" id="3878369">&#34;&lt;unknown&nbsp;type&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878390">return</span>&nbsp;<span class="builtintype" id="3878397">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878405">case</span>&nbsp;<span class="op" id="3878410">*</span><span class="builtintype" id="3878411">string</span><span class="op" id="3878417">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878423">s</span>&nbsp;<span class="op" id="3878425">+=</span>&nbsp;<span class="op" id="3878428">*</span><span class="ident" id="3878429">v</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878435">return</span>&nbsp;<span class="builtintype" id="3878442">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878450">case</span>&nbsp;<span class="op" id="3878455">[</span><span class="op" id="3878456">]</span><span class="builtintype" id="3878457">byte</span><span class="op" id="3878461">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878467">s</span>&nbsp;<span class="op" id="3878469">+=</span>&nbsp;<span class="builtintype" id="3878472">string</span><span class="op" id="3878478">(</span><span class="ident" id="3878479">v</span><span class="op" id="3878480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878486">return</span>&nbsp;<span class="builtintype" id="3878493">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878501">case</span>&nbsp;<span class="op" id="3878506">*</span><span class="builtintype" id="3878507">bool</span><span class="op" id="3878511">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878517">if</span>&nbsp;<span class="op" id="3878520">*</span><span class="ident" id="3878521">v</span>&nbsp;<span class="op" id="3878523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878530">s</span>&nbsp;<span class="op" id="3878532">+=</span>&nbsp;<span class="string" id="3878535">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3878546">}</span>&nbsp;<span class="keyword" id="3878548">else</span>&nbsp;<span class="op" id="3878553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878560">s</span>&nbsp;<span class="op" id="3878562">+=</span>&nbsp;<span class="string" id="3878565">&#34;false&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3878577">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878583">return</span>&nbsp;<span class="builtintype" id="3878590">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878598">case</span>&nbsp;<span class="op" id="3878603">*</span><span class="builtintype" id="3878604">int</span><span class="op" id="3878607">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878613">i</span>&nbsp;<span class="op" id="3878615">=</span>&nbsp;<span class="ident" id="3878617">int64</span><span class="op" id="3878622">(</span><span class="op" id="3878623">*</span><span class="ident" id="3878624">v</span><span class="op" id="3878625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878630">case</span>&nbsp;<span class="op" id="3878635">*</span><span class="builtintype" id="3878636">uint</span><span class="op" id="3878640">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878646">i</span>&nbsp;<span class="op" id="3878648">=</span>&nbsp;<span class="ident" id="3878650">int64</span><span class="op" id="3878655">(</span><span class="op" id="3878656">*</span><span class="ident" id="3878657">v</span><span class="op" id="3878658">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878663">case</span>&nbsp;<span class="op" id="3878668">*</span><span class="builtintype" id="3878669">uint8</span><span class="op" id="3878674">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878680">i</span>&nbsp;<span class="op" id="3878682">=</span>&nbsp;<span class="ident" id="3878684">int64</span><span class="op" id="3878689">(</span><span class="op" id="3878690">*</span><span class="ident" id="3878691">v</span><span class="op" id="3878692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878697">case</span>&nbsp;<span class="op" id="3878702">*</span><span class="builtintype" id="3878703">uint16</span><span class="op" id="3878709">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878715">i</span>&nbsp;<span class="op" id="3878717">=</span>&nbsp;<span class="ident" id="3878719">int64</span><span class="op" id="3878724">(</span><span class="op" id="3878725">*</span><span class="ident" id="3878726">v</span><span class="op" id="3878727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878732">case</span>&nbsp;<span class="op" id="3878737">*</span><span class="builtintype" id="3878738">uint32</span><span class="op" id="3878744">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878750">i</span>&nbsp;<span class="op" id="3878752">=</span>&nbsp;<span class="ident" id="3878754">int64</span><span class="op" id="3878759">(</span><span class="op" id="3878760">*</span><span class="ident" id="3878761">v</span><span class="op" id="3878762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878767">case</span>&nbsp;<span class="op" id="3878772">*</span><span class="ident" id="3878773">uint64</span><span class="op" id="3878779">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878785">i</span>&nbsp;<span class="op" id="3878787">=</span>&nbsp;<span class="ident" id="3878789">int64</span><span class="op" id="3878794">(</span><span class="op" id="3878795">*</span><span class="ident" id="3878796">v</span><span class="op" id="3878797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878802">case</span>&nbsp;<span class="op" id="3878807">*</span><span class="builtintype" id="3878808">uintptr</span><span class="op" id="3878815">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878821">i</span>&nbsp;<span class="op" id="3878823">=</span>&nbsp;<span class="ident" id="3878825">int64</span><span class="op" id="3878830">(</span><span class="op" id="3878831">*</span><span class="ident" id="3878832">v</span><span class="op" id="3878833">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3878838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878843">s</span>&nbsp;<span class="op" id="3878845">+=</span>&nbsp;<span class="ident" id="3878848">itoa</span><span class="op" id="3878852">(</span><span class="builtintype" id="3878853">int</span><span class="op" id="3878856">(</span><span class="ident" id="3878857">i</span><span class="op" id="3878858">)</span><span class="op" id="3878859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3878863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878867">return</span>&nbsp;<span class="builtintype" id="3878874">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3878880">}</span><span class="op" id="3878881">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878884">s</span>&nbsp;<span class="op" id="3878886">+=</span>&nbsp;<span class="string" id="3878889">&#34;}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878894">return</span>&nbsp;<span class="ident" id="3878901">s</span><br>
<span class="lineno"></span><span class="op" id="3878903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3878906">//&nbsp;Resource&nbsp;record&nbsp;packer.</span><br>
<span class="lineno">670</span><span class="keyword" id="3878933">func</span>&nbsp;<span class="ident" id="3878938">packRR</span><span class="op" id="3878944">(</span><span class="ident" id="3878945">rr</span>&nbsp;<span class="ident" id="3878948">dnsRR</span><span class="op" id="3878953">,</span>&nbsp;<span class="ident" id="3878955">msg</span>&nbsp;<span class="op" id="3878959">[</span><span class="op" id="3878960">]</span><span class="builtintype" id="3878961">byte</span><span class="op" id="3878965">,</span>&nbsp;<span class="ident" id="3878967">off</span>&nbsp;<span class="builtintype" id="3878971">int</span><span class="op" id="3878974">)</span>&nbsp;<span class="op" id="3878976">(</span><span class="ident" id="3878977">off2</span>&nbsp;<span class="builtintype" id="3878982">int</span><span class="op" id="3878985">,</span>&nbsp;<span class="ident" id="3878987">ok</span>&nbsp;<span class="builtintype" id="3878990">bool</span><span class="op" id="3878994">)</span>&nbsp;<span class="op" id="3878996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878999">var</span>&nbsp;<span class="ident" id="3879003">off1</span>&nbsp;<span class="builtintype" id="3879008">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879013">//&nbsp;pack&nbsp;twice,&nbsp;once&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879056">//&nbsp;and&nbsp;again&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879093">//&nbsp;a&nbsp;bit&nbsp;inefficient&nbsp;but&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879149">//&nbsp;off1&nbsp;is&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879175">//&nbsp;off2&nbsp;is&nbsp;end&nbsp;of&nbsp;rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879197">off1</span><span class="op" id="3879201">,</span>&nbsp;<span class="ident" id="3879203">ok</span>&nbsp;<span class="op" id="3879206">=</span>&nbsp;<span class="ident" id="3879208">packStruct</span><span class="op" id="3879218">(</span><span class="ident" id="3879219">rr</span><span class="op" id="3879221">.</span><span class="ident" id="3879222">Header</span><span class="op" id="3879228">(</span><span class="op" id="3879229">)</span><span class="op" id="3879230">,</span>&nbsp;<span class="ident" id="3879232">msg</span><span class="op" id="3879235">,</span>&nbsp;<span class="ident" id="3879237">off</span><span class="op" id="3879240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879243">off2</span><span class="op" id="3879247">,</span>&nbsp;<span class="ident" id="3879249">ok</span>&nbsp;<span class="op" id="3879252">=</span>&nbsp;<span class="ident" id="3879254">packStruct</span><span class="op" id="3879264">(</span><span class="ident" id="3879265">rr</span><span class="op" id="3879267">,</span>&nbsp;<span class="ident" id="3879269">msg</span><span class="op" id="3879272">,</span>&nbsp;<span class="ident" id="3879274">off</span><span class="op" id="3879277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879280">if</span>&nbsp;<span class="op" id="3879283">!</span><span class="ident" id="3879284">ok</span>&nbsp;<span class="op" id="3879287">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879291">return</span>&nbsp;<span class="builtinfunc" id="3879298">len</span><span class="op" id="3879301">(</span><span class="ident" id="3879302">msg</span><span class="op" id="3879305">)</span><span class="op" id="3879306">,</span>&nbsp;<span class="builtintype" id="3879308">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3879315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879318">//&nbsp;pack&nbsp;a&nbsp;third&nbsp;time;&nbsp;redo&nbsp;header&nbsp;with&nbsp;correct&nbsp;data&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879378">rr</span><span class="op" id="3879380">.</span><span class="ident" id="3879381">Header</span><span class="op" id="3879387">(</span><span class="op" id="3879388">)</span><span class="op" id="3879389">.</span><span class="ident" id="3879390">Rdlength</span>&nbsp;<span class="op" id="3879399">=</span>&nbsp;<span class="builtintype" id="3879401">uint16</span><span class="op" id="3879407">(</span><span class="ident" id="3879408">off2</span>&nbsp;<span class="op" id="3879413">-</span>&nbsp;<span class="ident" id="3879415">off1</span><span class="op" id="3879419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879422">packStruct</span><span class="op" id="3879432">(</span><span class="ident" id="3879433">rr</span><span class="op" id="3879435">.</span><span class="ident" id="3879436">Header</span><span class="op" id="3879442">(</span><span class="op" id="3879443">)</span><span class="op" id="3879444">,</span>&nbsp;<span class="ident" id="3879446">msg</span><span class="op" id="3879449">,</span>&nbsp;<span class="ident" id="3879451">off</span><span class="op" id="3879454">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879457">return</span>&nbsp;<span class="ident" id="3879464">off2</span><span class="op" id="3879468">,</span>&nbsp;<span class="builtintype" id="3879470">true</span><br>
<span class="lineno"></span><span class="op" id="3879475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3879478">//&nbsp;Resource&nbsp;record&nbsp;unpacker.</span><br>
<span class="lineno"></span><span class="keyword" id="3879507">func</span>&nbsp;<span class="ident" id="3879512">unpackRR</span><span class="op" id="3879520">(</span><span class="ident" id="3879521">msg</span>&nbsp;<span class="op" id="3879525">[</span><span class="op" id="3879526">]</span><span class="builtintype" id="3879527">byte</span><span class="op" id="3879531">,</span>&nbsp;<span class="ident" id="3879533">off</span>&nbsp;<span class="builtintype" id="3879537">int</span><span class="op" id="3879540">)</span>&nbsp;<span class="op" id="3879542">(</span><span class="ident" id="3879543">rr</span>&nbsp;<span class="ident" id="3879546">dnsRR</span><span class="op" id="3879551">,</span>&nbsp;<span class="ident" id="3879553">off1</span>&nbsp;<span class="builtintype" id="3879558">int</span><span class="op" id="3879561">,</span>&nbsp;<span class="ident" id="3879563">ok</span>&nbsp;<span class="builtintype" id="3879566">bool</span><span class="op" id="3879570">)</span>&nbsp;<span class="op" id="3879572">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879575">//&nbsp;unpack&nbsp;just&nbsp;the&nbsp;header,&nbsp;to&nbsp;find&nbsp;the&nbsp;rr&nbsp;type&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879634">var</span>&nbsp;<span class="ident" id="3879638">h</span>&nbsp;<span class="ident" id="3879640">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879654">off0</span>&nbsp;<span class="op" id="3879659">:=</span>&nbsp;<span class="ident" id="3879662">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879667">if</span>&nbsp;<span class="ident" id="3879670">off</span><span class="op" id="3879673">,</span>&nbsp;<span class="ident" id="3879675">ok</span>&nbsp;<span class="op" id="3879678">=</span>&nbsp;<span class="ident" id="3879680">unpackStruct</span><span class="op" id="3879692">(</span><span class="op" id="3879693">&amp;</span><span class="ident" id="3879694">h</span><span class="op" id="3879695">,</span>&nbsp;<span class="ident" id="3879697">msg</span><span class="op" id="3879700">,</span>&nbsp;<span class="ident" id="3879702">off</span><span class="op" id="3879705">)</span><span class="op" id="3879706">;</span>&nbsp;<span class="op" id="3879708">!</span><span class="ident" id="3879709">ok</span>&nbsp;<span class="op" id="3879712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879716">return</span>&nbsp;<span class="builtintype" id="3879723">nil</span><span class="op" id="3879726">,</span>&nbsp;<span class="builtinfunc" id="3879728">len</span><span class="op" id="3879731">(</span><span class="ident" id="3879732">msg</span><span class="op" id="3879735">)</span><span class="op" id="3879736">,</span>&nbsp;<span class="builtintype" id="3879738">false</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3879745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879748">end</span>&nbsp;<span class="op" id="3879752">:=</span>&nbsp;<span class="ident" id="3879755">off</span>&nbsp;<span class="op" id="3879759">+</span>&nbsp;<span class="builtintype" id="3879761">int</span><span class="op" id="3879764">(</span><span class="ident" id="3879765">h</span><span class="op" id="3879766">.</span><span class="ident" id="3879767">Rdlength</span><span class="op" id="3879775">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879779">//&nbsp;make&nbsp;an&nbsp;rr&nbsp;of&nbsp;that&nbsp;type&nbsp;and&nbsp;re-unpack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879822">//&nbsp;again&nbsp;inefficient&nbsp;but&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879873">mk</span><span class="op" id="3879875">,</span>&nbsp;<span class="ident" id="3879877">known</span>&nbsp;<span class="op" id="3879883">:=</span>&nbsp;<span class="ident" id="3879886">rr_mk</span><span class="op" id="3879891">[</span><span class="builtintype" id="3879892">int</span><span class="op" id="3879895">(</span><span class="ident" id="3879896">h</span><span class="op" id="3879897">.</span><span class="ident" id="3879898">Rrtype</span><span class="op" id="3879904">)</span><span class="op" id="3879905">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879908">if</span>&nbsp;<span class="op" id="3879911">!</span><span class="ident" id="3879912">known</span>&nbsp;<span class="op" id="3879918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879922">return</span>&nbsp;<span class="op" id="3879929">&amp;</span><span class="ident" id="3879930">h</span><span class="op" id="3879931">,</span>&nbsp;<span class="ident" id="3879933">end</span><span class="op" id="3879936">,</span>&nbsp;<span class="builtintype" id="3879938">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3879944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879947">rr</span>&nbsp;<span class="op" id="3879950">=</span>&nbsp;<span class="ident" id="3879952">mk</span><span class="op" id="3879954">(</span><span class="op" id="3879955">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879958">off</span><span class="op" id="3879961">,</span>&nbsp;<span class="ident" id="3879963">ok</span>&nbsp;<span class="op" id="3879966">=</span>&nbsp;<span class="ident" id="3879968">unpackStruct</span><span class="op" id="3879980">(</span><span class="ident" id="3879981">rr</span><span class="op" id="3879983">,</span>&nbsp;<span class="ident" id="3879985">msg</span><span class="op" id="3879988">,</span>&nbsp;<span class="ident" id="3879990">off0</span><span class="op" id="3879994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879997">if</span>&nbsp;<span class="ident" id="3880000">off</span>&nbsp;<span class="op" id="3880004">!=</span>&nbsp;<span class="ident" id="3880007">end</span>&nbsp;<span class="op" id="3880011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3880015">return</span>&nbsp;<span class="op" id="3880022">&amp;</span><span class="ident" id="3880023">h</span><span class="op" id="3880024">,</span>&nbsp;<span class="ident" id="3880026">end</span><span class="op" id="3880029">,</span>&nbsp;<span class="builtintype" id="3880031">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3880037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3880040">return</span>&nbsp;<span class="ident" id="3880047">rr</span><span class="op" id="3880049">,</span>&nbsp;<span class="ident" id="3880051">off</span><span class="op" id="3880054">,</span>&nbsp;<span class="ident" id="3880056">ok</span><br>
<span class="lineno">710</span><span class="op" id="3880059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3880062">//&nbsp;Usable&nbsp;representation&nbsp;of&nbsp;a&nbsp;DNS&nbsp;packet.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3880105">//&nbsp;A&nbsp;manually-unpacked&nbsp;version&nbsp;of&nbsp;(id,&nbsp;bits).</span><br>
<span class="lineno">715</span><span class="comment" id="3880151">//&nbsp;This&nbsp;is&nbsp;in&nbsp;its&nbsp;own&nbsp;struct&nbsp;for&nbsp;easy&nbsp;printing.</span><br>
<span class="lineno"></span><span class="keyword" id="3880199">type</span>&nbsp;<span class="ident" id="3880204">dnsMsgHdr</span>&nbsp;<span class="keyword" id="3880214">struct</span>&nbsp;<span class="op" id="3880221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880224">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3880244">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880252">response</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3880272">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880278">opcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3880298">int</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880303">authoritative</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3880323">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880329">truncated</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3880349">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880355">recursion_desired</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3880375">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880381">recursion_available</span>&nbsp;<span class="builtintype" id="3880401">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880407">rcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3880427">int</span><br>
<span class="lineno">725</span><span class="op" id="3880431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3880434">func</span>&nbsp;<span class="op" id="3880439">(</span><span class="ident" id="3880440">h</span>&nbsp;<span class="op" id="3880442">*</span><span class="ident" id="3880443">dnsMsgHdr</span><span class="op" id="3880452">)</span>&nbsp;<span class="ident" id="3880454">Walk</span><span class="op" id="3880458">(</span><span class="ident" id="3880459">f</span>&nbsp;<span class="keyword" id="3880461">func</span><span class="op" id="3880465">(</span><span class="ident" id="3880466">v</span>&nbsp;<span class="keyword" id="3880468">interface</span><span class="op" id="3880477">{</span><span class="op" id="3880478">}</span><span class="op" id="3880479">,</span>&nbsp;<span class="ident" id="3880481">name</span><span class="op" id="3880485">,</span>&nbsp;<span class="ident" id="3880487">tag</span>&nbsp;<span class="builtintype" id="3880491">string</span><span class="op" id="3880497">)</span>&nbsp;<span class="builtintype" id="3880499">bool</span><span class="op" id="3880503">)</span>&nbsp;<span class="builtintype" id="3880505">bool</span>&nbsp;<span class="op" id="3880510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3880513">return</span>&nbsp;<span class="ident" id="3880520">f</span><span class="op" id="3880521">(</span><span class="op" id="3880522">&amp;</span><span class="ident" id="3880523">h</span><span class="op" id="3880524">.</span><span class="ident" id="3880525">id</span><span class="op" id="3880527">,</span>&nbsp;<span class="string" id="3880529">&#34;id&#34;</span><span class="op" id="3880533">,</span>&nbsp;<span class="string" id="3880535">&#34;&#34;</span><span class="op" id="3880537">)</span>&nbsp;<span class="op" id="3880539">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880544">f</span><span class="op" id="3880545">(</span><span class="op" id="3880546">&amp;</span><span class="ident" id="3880547">h</span><span class="op" id="3880548">.</span><span class="ident" id="3880549">response</span><span class="op" id="3880557">,</span>&nbsp;<span class="string" id="3880559">&#34;response&#34;</span><span class="op" id="3880569">,</span>&nbsp;<span class="string" id="3880571">&#34;&#34;</span><span class="op" id="3880573">)</span>&nbsp;<span class="op" id="3880575">&amp;&amp;</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880580">f</span><span class="op" id="3880581">(</span><span class="op" id="3880582">&amp;</span><span class="ident" id="3880583">h</span><span class="op" id="3880584">.</span><span class="ident" id="3880585">opcode</span><span class="op" id="3880591">,</span>&nbsp;<span class="string" id="3880593">&#34;opcode&#34;</span><span class="op" id="3880601">,</span>&nbsp;<span class="string" id="3880603">&#34;&#34;</span><span class="op" id="3880605">)</span>&nbsp;<span class="op" id="3880607">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880612">f</span><span class="op" id="3880613">(</span><span class="op" id="3880614">&amp;</span><span class="ident" id="3880615">h</span><span class="op" id="3880616">.</span><span class="ident" id="3880617">authoritative</span><span class="op" id="3880630">,</span>&nbsp;<span class="string" id="3880632">&#34;authoritative&#34;</span><span class="op" id="3880647">,</span>&nbsp;<span class="string" id="3880649">&#34;&#34;</span><span class="op" id="3880651">)</span>&nbsp;<span class="op" id="3880653">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880658">f</span><span class="op" id="3880659">(</span><span class="op" id="3880660">&amp;</span><span class="ident" id="3880661">h</span><span class="op" id="3880662">.</span><span class="ident" id="3880663">truncated</span><span class="op" id="3880672">,</span>&nbsp;<span class="string" id="3880674">&#34;truncated&#34;</span><span class="op" id="3880685">,</span>&nbsp;<span class="string" id="3880687">&#34;&#34;</span><span class="op" id="3880689">)</span>&nbsp;<span class="op" id="3880691">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880696">f</span><span class="op" id="3880697">(</span><span class="op" id="3880698">&amp;</span><span class="ident" id="3880699">h</span><span class="op" id="3880700">.</span><span class="ident" id="3880701">recursion_desired</span><span class="op" id="3880718">,</span>&nbsp;<span class="string" id="3880720">&#34;recursion_desired&#34;</span><span class="op" id="3880739">,</span>&nbsp;<span class="string" id="3880741">&#34;&#34;</span><span class="op" id="3880743">)</span>&nbsp;<span class="op" id="3880745">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880750">f</span><span class="op" id="3880751">(</span><span class="op" id="3880752">&amp;</span><span class="ident" id="3880753">h</span><span class="op" id="3880754">.</span><span class="ident" id="3880755">recursion_available</span><span class="op" id="3880774">,</span>&nbsp;<span class="string" id="3880776">&#34;recursion_available&#34;</span><span class="op" id="3880797">,</span>&nbsp;<span class="string" id="3880799">&#34;&#34;</span><span class="op" id="3880801">)</span>&nbsp;<span class="op" id="3880803">&amp;&amp;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880808">f</span><span class="op" id="3880809">(</span><span class="op" id="3880810">&amp;</span><span class="ident" id="3880811">h</span><span class="op" id="3880812">.</span><span class="ident" id="3880813">rcode</span><span class="op" id="3880818">,</span>&nbsp;<span class="string" id="3880820">&#34;rcode&#34;</span><span class="op" id="3880827">,</span>&nbsp;<span class="string" id="3880829">&#34;&#34;</span><span class="op" id="3880831">)</span><br>
<span class="lineno"></span><span class="op" id="3880833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3880836">type</span>&nbsp;<span class="ident" id="3880841">dnsMsg</span>&nbsp;<span class="keyword" id="3880848">struct</span>&nbsp;<span class="op" id="3880855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880858">dnsMsgHdr</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880869">question</span>&nbsp;<span class="op" id="3880878">[</span><span class="op" id="3880879">]</span><span class="ident" id="3880880">dnsQuestion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880893">answer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3880902">[</span><span class="op" id="3880903">]</span><span class="ident" id="3880904">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880911">ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3880920">[</span><span class="op" id="3880921">]</span><span class="ident" id="3880922">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880929">extra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3880938">[</span><span class="op" id="3880939">]</span><span class="ident" id="3880940">dnsRR</span><br>
<span class="lineno"></span><span class="op" id="3880946">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span><span class="keyword" id="3880949">func</span>&nbsp;<span class="op" id="3880954">(</span><span class="ident" id="3880955">dns</span>&nbsp;<span class="op" id="3880959">*</span><span class="ident" id="3880960">dnsMsg</span><span class="op" id="3880966">)</span>&nbsp;<span class="ident" id="3880968">Pack</span><span class="op" id="3880972">(</span><span class="op" id="3880973">)</span>&nbsp;<span class="op" id="3880975">(</span><span class="ident" id="3880976">msg</span>&nbsp;<span class="op" id="3880980">[</span><span class="op" id="3880981">]</span><span class="builtintype" id="3880982">byte</span><span class="op" id="3880986">,</span>&nbsp;<span class="ident" id="3880988">ok</span>&nbsp;<span class="builtintype" id="3880991">bool</span><span class="op" id="3880995">)</span>&nbsp;<span class="op" id="3880997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881000">var</span>&nbsp;<span class="ident" id="3881004">dh</span>&nbsp;<span class="ident" id="3881007">dnsHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3881019">//&nbsp;Convert&nbsp;convenient&nbsp;dnsMsg&nbsp;into&nbsp;wire-like&nbsp;dnsHeader.</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881075">dh</span><span class="op" id="3881077">.</span><span class="ident" id="3881078">Id</span>&nbsp;<span class="op" id="3881081">=</span>&nbsp;<span class="ident" id="3881083">dns</span><span class="op" id="3881086">.</span><span class="ident" id="3881087">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881091">dh</span><span class="op" id="3881093">.</span><span class="ident" id="3881094">Bits</span>&nbsp;<span class="op" id="3881099">=</span>&nbsp;<span class="builtintype" id="3881101">uint16</span><span class="op" id="3881107">(</span><span class="ident" id="3881108">dns</span><span class="op" id="3881111">.</span><span class="ident" id="3881112">opcode</span><span class="op" id="3881118">)</span><span class="op" id="3881119">&lt;&lt;</span><span class="num" id="3881121">11</span>&nbsp;<span class="op" id="3881124">|</span>&nbsp;<span class="builtintype" id="3881126">uint16</span><span class="op" id="3881132">(</span><span class="ident" id="3881133">dns</span><span class="op" id="3881136">.</span><span class="ident" id="3881137">rcode</span><span class="op" id="3881142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881145">if</span>&nbsp;<span class="ident" id="3881148">dns</span><span class="op" id="3881151">.</span><span class="ident" id="3881152">recursion_available</span>&nbsp;<span class="op" id="3881172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881176">dh</span><span class="op" id="3881178">.</span><span class="ident" id="3881179">Bits</span>&nbsp;<span class="op" id="3881184">|=</span>&nbsp;<span class="ident" id="3881187">_RA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3881192">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881195">if</span>&nbsp;<span class="ident" id="3881198">dns</span><span class="op" id="3881201">.</span><span class="ident" id="3881202">recursion_desired</span>&nbsp;<span class="op" id="3881220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881224">dh</span><span class="op" id="3881226">.</span><span class="ident" id="3881227">Bits</span>&nbsp;<span class="op" id="3881232">|=</span>&nbsp;<span class="ident" id="3881235">_RD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3881240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881243">if</span>&nbsp;<span class="ident" id="3881246">dns</span><span class="op" id="3881249">.</span><span class="ident" id="3881250">truncated</span>&nbsp;<span class="op" id="3881260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881264">dh</span><span class="op" id="3881266">.</span><span class="ident" id="3881267">Bits</span>&nbsp;<span class="op" id="3881272">|=</span>&nbsp;<span class="ident" id="3881275">_TC</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3881280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881283">if</span>&nbsp;<span class="ident" id="3881286">dns</span><span class="op" id="3881289">.</span><span class="ident" id="3881290">authoritative</span>&nbsp;<span class="op" id="3881304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881308">dh</span><span class="op" id="3881310">.</span><span class="ident" id="3881311">Bits</span>&nbsp;<span class="op" id="3881316">|=</span>&nbsp;<span class="ident" id="3881319">_AA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3881324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881327">if</span>&nbsp;<span class="ident" id="3881330">dns</span><span class="op" id="3881333">.</span><span class="ident" id="3881334">response</span>&nbsp;<span class="op" id="3881343">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881347">dh</span><span class="op" id="3881349">.</span><span class="ident" id="3881350">Bits</span>&nbsp;<span class="op" id="3881355">|=</span>&nbsp;<span class="ident" id="3881358">_QR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3881363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3881367">//&nbsp;Prepare&nbsp;variable&nbsp;sized&nbsp;arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881402">question</span>&nbsp;<span class="op" id="3881411">:=</span>&nbsp;<span class="ident" id="3881414">dns</span><span class="op" id="3881417">.</span><span class="ident" id="3881418">question</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881428">answer</span>&nbsp;<span class="op" id="3881435">:=</span>&nbsp;<span class="ident" id="3881438">dns</span><span class="op" id="3881441">.</span><span class="ident" id="3881442">answer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881450">ns</span>&nbsp;<span class="op" id="3881453">:=</span>&nbsp;<span class="ident" id="3881456">dns</span><span class="op" id="3881459">.</span><span class="ident" id="3881460">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881464">extra</span>&nbsp;<span class="op" id="3881470">:=</span>&nbsp;<span class="ident" id="3881473">dns</span><span class="op" id="3881476">.</span><span class="ident" id="3881477">extra</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881485">dh</span><span class="op" id="3881487">.</span><span class="ident" id="3881488">Qdcount</span>&nbsp;<span class="op" id="3881496">=</span>&nbsp;<span class="builtintype" id="3881498">uint16</span><span class="op" id="3881504">(</span><span class="builtinfunc" id="3881505">len</span><span class="op" id="3881508">(</span><span class="ident" id="3881509">question</span><span class="op" id="3881517">)</span><span class="op" id="3881518">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881521">dh</span><span class="op" id="3881523">.</span><span class="ident" id="3881524">Ancount</span>&nbsp;<span class="op" id="3881532">=</span>&nbsp;<span class="builtintype" id="3881534">uint16</span><span class="op" id="3881540">(</span><span class="builtinfunc" id="3881541">len</span><span class="op" id="3881544">(</span><span class="ident" id="3881545">answer</span><span class="op" id="3881551">)</span><span class="op" id="3881552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881555">dh</span><span class="op" id="3881557">.</span><span class="ident" id="3881558">Nscount</span>&nbsp;<span class="op" id="3881566">=</span>&nbsp;<span class="builtintype" id="3881568">uint16</span><span class="op" id="3881574">(</span><span class="builtinfunc" id="3881575">len</span><span class="op" id="3881578">(</span><span class="ident" id="3881579">ns</span><span class="op" id="3881581">)</span><span class="op" id="3881582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881585">dh</span><span class="op" id="3881587">.</span><span class="ident" id="3881588">Arcount</span>&nbsp;<span class="op" id="3881596">=</span>&nbsp;<span class="builtintype" id="3881598">uint16</span><span class="op" id="3881604">(</span><span class="builtinfunc" id="3881605">len</span><span class="op" id="3881608">(</span><span class="ident" id="3881609">extra</span><span class="op" id="3881614">)</span><span class="op" id="3881615">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3881619">//&nbsp;Could&nbsp;work&nbsp;harder&nbsp;to&nbsp;calculate&nbsp;message&nbsp;size,</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3881668">//&nbsp;but&nbsp;this&nbsp;is&nbsp;far&nbsp;more&nbsp;than&nbsp;we&nbsp;need&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3881714">//&nbsp;big&nbsp;enough&nbsp;to&nbsp;hurt&nbsp;the&nbsp;allocator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881752">msg</span>&nbsp;<span class="op" id="3881756">=</span>&nbsp;<span class="builtinfunc" id="3881758">make</span><span class="op" id="3881762">(</span><span class="op" id="3881763">[</span><span class="op" id="3881764">]</span><span class="builtintype" id="3881765">byte</span><span class="op" id="3881769">,</span>&nbsp;<span class="num" id="3881771">2000</span><span class="op" id="3881775">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3881779">//&nbsp;Pack&nbsp;it&nbsp;in:&nbsp;header&nbsp;and&nbsp;then&nbsp;the&nbsp;pieces.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881823">off</span>&nbsp;<span class="op" id="3881827">:=</span>&nbsp;<span class="num" id="3881830">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881833">off</span><span class="op" id="3881836">,</span>&nbsp;<span class="ident" id="3881838">ok</span>&nbsp;<span class="op" id="3881841">=</span>&nbsp;<span class="ident" id="3881843">packStruct</span><span class="op" id="3881853">(</span><span class="op" id="3881854">&amp;</span><span class="ident" id="3881855">dh</span><span class="op" id="3881857">,</span>&nbsp;<span class="ident" id="3881859">msg</span><span class="op" id="3881862">,</span>&nbsp;<span class="ident" id="3881864">off</span><span class="op" id="3881867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881870">for</span>&nbsp;<span class="ident" id="3881874">i</span>&nbsp;<span class="op" id="3881876">:=</span>&nbsp;<span class="num" id="3881879">0</span><span class="op" id="3881880">;</span>&nbsp;<span class="ident" id="3881882">i</span>&nbsp;<span class="op" id="3881884">&lt;</span>&nbsp;<span class="builtinfunc" id="3881886">len</span><span class="op" id="3881889">(</span><span class="ident" id="3881890">question</span><span class="op" id="3881898">)</span><span class="op" id="3881899">;</span>&nbsp;<span class="ident" id="3881901">i</span><span class="op" id="3881902">++</span>&nbsp;<span class="op" id="3881905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881909">off</span><span class="op" id="3881912">,</span>&nbsp;<span class="ident" id="3881914">ok</span>&nbsp;<span class="op" id="3881917">=</span>&nbsp;<span class="ident" id="3881919">packStruct</span><span class="op" id="3881929">(</span><span class="op" id="3881930">&amp;</span><span class="ident" id="3881931">question</span><span class="op" id="3881939">[</span><span class="ident" id="3881940">i</span><span class="op" id="3881941">]</span><span class="op" id="3881942">,</span>&nbsp;<span class="ident" id="3881944">msg</span><span class="op" id="3881947">,</span>&nbsp;<span class="ident" id="3881949">off</span><span class="op" id="3881952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3881955">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881958">for</span>&nbsp;<span class="ident" id="3881962">i</span>&nbsp;<span class="op" id="3881964">:=</span>&nbsp;<span class="num" id="3881967">0</span><span class="op" id="3881968">;</span>&nbsp;<span class="ident" id="3881970">i</span>&nbsp;<span class="op" id="3881972">&lt;</span>&nbsp;<span class="builtinfunc" id="3881974">len</span><span class="op" id="3881977">(</span><span class="ident" id="3881978">answer</span><span class="op" id="3881984">)</span><span class="op" id="3881985">;</span>&nbsp;<span class="ident" id="3881987">i</span><span class="op" id="3881988">++</span>&nbsp;<span class="op" id="3881991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881995">off</span><span class="op" id="3881998">,</span>&nbsp;<span class="ident" id="3882000">ok</span>&nbsp;<span class="op" id="3882003">=</span>&nbsp;<span class="ident" id="3882005">packRR</span><span class="op" id="3882011">(</span><span class="ident" id="3882012">answer</span><span class="op" id="3882018">[</span><span class="ident" id="3882019">i</span><span class="op" id="3882020">]</span><span class="op" id="3882021">,</span>&nbsp;<span class="ident" id="3882023">msg</span><span class="op" id="3882026">,</span>&nbsp;<span class="ident" id="3882028">off</span><span class="op" id="3882031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3882034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882037">for</span>&nbsp;<span class="ident" id="3882041">i</span>&nbsp;<span class="op" id="3882043">:=</span>&nbsp;<span class="num" id="3882046">0</span><span class="op" id="3882047">;</span>&nbsp;<span class="ident" id="3882049">i</span>&nbsp;<span class="op" id="3882051">&lt;</span>&nbsp;<span class="builtinfunc" id="3882053">len</span><span class="op" id="3882056">(</span><span class="ident" id="3882057">ns</span><span class="op" id="3882059">)</span><span class="op" id="3882060">;</span>&nbsp;<span class="ident" id="3882062">i</span><span class="op" id="3882063">++</span>&nbsp;<span class="op" id="3882066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882070">off</span><span class="op" id="3882073">,</span>&nbsp;<span class="ident" id="3882075">ok</span>&nbsp;<span class="op" id="3882078">=</span>&nbsp;<span class="ident" id="3882080">packRR</span><span class="op" id="3882086">(</span><span class="ident" id="3882087">ns</span><span class="op" id="3882089">[</span><span class="ident" id="3882090">i</span><span class="op" id="3882091">]</span><span class="op" id="3882092">,</span>&nbsp;<span class="ident" id="3882094">msg</span><span class="op" id="3882097">,</span>&nbsp;<span class="ident" id="3882099">off</span><span class="op" id="3882102">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3882105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882108">for</span>&nbsp;<span class="ident" id="3882112">i</span>&nbsp;<span class="op" id="3882114">:=</span>&nbsp;<span class="num" id="3882117">0</span><span class="op" id="3882118">;</span>&nbsp;<span class="ident" id="3882120">i</span>&nbsp;<span class="op" id="3882122">&lt;</span>&nbsp;<span class="builtinfunc" id="3882124">len</span><span class="op" id="3882127">(</span><span class="ident" id="3882128">extra</span><span class="op" id="3882133">)</span><span class="op" id="3882134">;</span>&nbsp;<span class="ident" id="3882136">i</span><span class="op" id="3882137">++</span>&nbsp;<span class="op" id="3882140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882144">off</span><span class="op" id="3882147">,</span>&nbsp;<span class="ident" id="3882149">ok</span>&nbsp;<span class="op" id="3882152">=</span>&nbsp;<span class="ident" id="3882154">packRR</span><span class="op" id="3882160">(</span><span class="ident" id="3882161">extra</span><span class="op" id="3882166">[</span><span class="ident" id="3882167">i</span><span class="op" id="3882168">]</span><span class="op" id="3882169">,</span>&nbsp;<span class="ident" id="3882171">msg</span><span class="op" id="3882174">,</span>&nbsp;<span class="ident" id="3882176">off</span><span class="op" id="3882179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3882182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882185">if</span>&nbsp;<span class="op" id="3882188">!</span><span class="ident" id="3882189">ok</span>&nbsp;<span class="op" id="3882192">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882196">return</span>&nbsp;<span class="builtintype" id="3882203">nil</span><span class="op" id="3882206">,</span>&nbsp;<span class="builtintype" id="3882208">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3882215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882218">return</span>&nbsp;<span class="ident" id="3882225">msg</span><span class="op" id="3882228">[</span><span class="num" id="3882229">0</span><span class="op" id="3882230">:</span><span class="ident" id="3882231">off</span><span class="op" id="3882234">]</span><span class="op" id="3882235">,</span>&nbsp;<span class="builtintype" id="3882237">true</span><br>
<span class="lineno"></span><span class="op" id="3882242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="keyword" id="3882245">func</span>&nbsp;<span class="op" id="3882250">(</span><span class="ident" id="3882251">dns</span>&nbsp;<span class="op" id="3882255">*</span><span class="ident" id="3882256">dnsMsg</span><span class="op" id="3882262">)</span>&nbsp;<span class="ident" id="3882264">Unpack</span><span class="op" id="3882270">(</span><span class="ident" id="3882271">msg</span>&nbsp;<span class="op" id="3882275">[</span><span class="op" id="3882276">]</span><span class="builtintype" id="3882277">byte</span><span class="op" id="3882281">)</span>&nbsp;<span class="builtintype" id="3882283">bool</span>&nbsp;<span class="op" id="3882288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3882291">//&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882303">var</span>&nbsp;<span class="ident" id="3882307">dh</span>&nbsp;<span class="ident" id="3882310">dnsHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882321">off</span>&nbsp;<span class="op" id="3882325">:=</span>&nbsp;<span class="num" id="3882328">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882331">var</span>&nbsp;<span class="ident" id="3882335">ok</span>&nbsp;<span class="builtintype" id="3882338">bool</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882344">if</span>&nbsp;<span class="ident" id="3882347">off</span><span class="op" id="3882350">,</span>&nbsp;<span class="ident" id="3882352">ok</span>&nbsp;<span class="op" id="3882355">=</span>&nbsp;<span class="ident" id="3882357">unpackStruct</span><span class="op" id="3882369">(</span><span class="op" id="3882370">&amp;</span><span class="ident" id="3882371">dh</span><span class="op" id="3882373">,</span>&nbsp;<span class="ident" id="3882375">msg</span><span class="op" id="3882378">,</span>&nbsp;<span class="ident" id="3882380">off</span><span class="op" id="3882383">)</span><span class="op" id="3882384">;</span>&nbsp;<span class="op" id="3882386">!</span><span class="ident" id="3882387">ok</span>&nbsp;<span class="op" id="3882390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882394">return</span>&nbsp;<span class="builtintype" id="3882401">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3882408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882411">dns</span><span class="op" id="3882414">.</span><span class="ident" id="3882415">id</span>&nbsp;<span class="op" id="3882418">=</span>&nbsp;<span class="ident" id="3882420">dh</span><span class="op" id="3882422">.</span><span class="ident" id="3882423">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882427">dns</span><span class="op" id="3882430">.</span><span class="ident" id="3882431">response</span>&nbsp;<span class="op" id="3882440">=</span>&nbsp;<span class="op" id="3882442">(</span><span class="ident" id="3882443">dh</span><span class="op" id="3882445">.</span><span class="ident" id="3882446">Bits</span>&nbsp;<span class="op" id="3882451">&amp;</span>&nbsp;<span class="ident" id="3882453">_QR</span><span class="op" id="3882456">)</span>&nbsp;<span class="op" id="3882458">!=</span>&nbsp;<span class="num" id="3882461">0</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882464">dns</span><span class="op" id="3882467">.</span><span class="ident" id="3882468">opcode</span>&nbsp;<span class="op" id="3882475">=</span>&nbsp;<span class="builtintype" id="3882477">int</span><span class="op" id="3882480">(</span><span class="ident" id="3882481">dh</span><span class="op" id="3882483">.</span><span class="ident" id="3882484">Bits</span><span class="op" id="3882488">&gt;&gt;</span><span class="num" id="3882490">11</span><span class="op" id="3882492">)</span>&nbsp;<span class="op" id="3882494">&amp;</span>&nbsp;<span class="num" id="3882496">0xF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882501">dns</span><span class="op" id="3882504">.</span><span class="ident" id="3882505">authoritative</span>&nbsp;<span class="op" id="3882519">=</span>&nbsp;<span class="op" id="3882521">(</span><span class="ident" id="3882522">dh</span><span class="op" id="3882524">.</span><span class="ident" id="3882525">Bits</span>&nbsp;<span class="op" id="3882530">&amp;</span>&nbsp;<span class="ident" id="3882532">_AA</span><span class="op" id="3882535">)</span>&nbsp;<span class="op" id="3882537">!=</span>&nbsp;<span class="num" id="3882540">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882543">dns</span><span class="op" id="3882546">.</span><span class="ident" id="3882547">truncated</span>&nbsp;<span class="op" id="3882557">=</span>&nbsp;<span class="op" id="3882559">(</span><span class="ident" id="3882560">dh</span><span class="op" id="3882562">.</span><span class="ident" id="3882563">Bits</span>&nbsp;<span class="op" id="3882568">&amp;</span>&nbsp;<span class="ident" id="3882570">_TC</span><span class="op" id="3882573">)</span>&nbsp;<span class="op" id="3882575">!=</span>&nbsp;<span class="num" id="3882578">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882581">dns</span><span class="op" id="3882584">.</span><span class="ident" id="3882585">recursion_desired</span>&nbsp;<span class="op" id="3882603">=</span>&nbsp;<span class="op" id="3882605">(</span><span class="ident" id="3882606">dh</span><span class="op" id="3882608">.</span><span class="ident" id="3882609">Bits</span>&nbsp;<span class="op" id="3882614">&amp;</span>&nbsp;<span class="ident" id="3882616">_RD</span><span class="op" id="3882619">)</span>&nbsp;<span class="op" id="3882621">!=</span>&nbsp;<span class="num" id="3882624">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882627">dns</span><span class="op" id="3882630">.</span><span class="ident" id="3882631">recursion_available</span>&nbsp;<span class="op" id="3882651">=</span>&nbsp;<span class="op" id="3882653">(</span><span class="ident" id="3882654">dh</span><span class="op" id="3882656">.</span><span class="ident" id="3882657">Bits</span>&nbsp;<span class="op" id="3882662">&amp;</span>&nbsp;<span class="ident" id="3882664">_RA</span><span class="op" id="3882667">)</span>&nbsp;<span class="op" id="3882669">!=</span>&nbsp;<span class="num" id="3882672">0</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882675">dns</span><span class="op" id="3882678">.</span><span class="ident" id="3882679">rcode</span>&nbsp;<span class="op" id="3882685">=</span>&nbsp;<span class="builtintype" id="3882687">int</span><span class="op" id="3882690">(</span><span class="ident" id="3882691">dh</span><span class="op" id="3882693">.</span><span class="ident" id="3882694">Bits</span>&nbsp;<span class="op" id="3882699">&amp;</span>&nbsp;<span class="num" id="3882701">0xF</span><span class="op" id="3882704">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3882708">//&nbsp;Arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882720">dns</span><span class="op" id="3882723">.</span><span class="ident" id="3882724">question</span>&nbsp;<span class="op" id="3882733">=</span>&nbsp;<span class="builtinfunc" id="3882735">make</span><span class="op" id="3882739">(</span><span class="op" id="3882740">[</span><span class="op" id="3882741">]</span><span class="ident" id="3882742">dnsQuestion</span><span class="op" id="3882753">,</span>&nbsp;<span class="ident" id="3882755">dh</span><span class="op" id="3882757">.</span><span class="ident" id="3882758">Qdcount</span><span class="op" id="3882765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882768">dns</span><span class="op" id="3882771">.</span><span class="ident" id="3882772">answer</span>&nbsp;<span class="op" id="3882779">=</span>&nbsp;<span class="builtinfunc" id="3882781">make</span><span class="op" id="3882785">(</span><span class="op" id="3882786">[</span><span class="op" id="3882787">]</span><span class="ident" id="3882788">dnsRR</span><span class="op" id="3882793">,</span>&nbsp;<span class="num" id="3882795">0</span><span class="op" id="3882796">,</span>&nbsp;<span class="ident" id="3882798">dh</span><span class="op" id="3882800">.</span><span class="ident" id="3882801">Ancount</span><span class="op" id="3882808">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882811">dns</span><span class="op" id="3882814">.</span><span class="ident" id="3882815">ns</span>&nbsp;<span class="op" id="3882818">=</span>&nbsp;<span class="builtinfunc" id="3882820">make</span><span class="op" id="3882824">(</span><span class="op" id="3882825">[</span><span class="op" id="3882826">]</span><span class="ident" id="3882827">dnsRR</span><span class="op" id="3882832">,</span>&nbsp;<span class="num" id="3882834">0</span><span class="op" id="3882835">,</span>&nbsp;<span class="ident" id="3882837">dh</span><span class="op" id="3882839">.</span><span class="ident" id="3882840">Nscount</span><span class="op" id="3882847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882850">dns</span><span class="op" id="3882853">.</span><span class="ident" id="3882854">extra</span>&nbsp;<span class="op" id="3882860">=</span>&nbsp;<span class="builtinfunc" id="3882862">make</span><span class="op" id="3882866">(</span><span class="op" id="3882867">[</span><span class="op" id="3882868">]</span><span class="ident" id="3882869">dnsRR</span><span class="op" id="3882874">,</span>&nbsp;<span class="num" id="3882876">0</span><span class="op" id="3882877">,</span>&nbsp;<span class="ident" id="3882879">dh</span><span class="op" id="3882881">.</span><span class="ident" id="3882882">Arcount</span><span class="op" id="3882889">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882893">var</span>&nbsp;<span class="ident" id="3882897">rec</span>&nbsp;<span class="ident" id="3882901">dnsRR</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882909">for</span>&nbsp;<span class="ident" id="3882913">i</span>&nbsp;<span class="op" id="3882915">:=</span>&nbsp;<span class="num" id="3882918">0</span><span class="op" id="3882919">;</span>&nbsp;<span class="ident" id="3882921">i</span>&nbsp;<span class="op" id="3882923">&lt;</span>&nbsp;<span class="builtinfunc" id="3882925">len</span><span class="op" id="3882928">(</span><span class="ident" id="3882929">dns</span><span class="op" id="3882932">.</span><span class="ident" id="3882933">question</span><span class="op" id="3882941">)</span><span class="op" id="3882942">;</span>&nbsp;<span class="ident" id="3882944">i</span><span class="op" id="3882945">++</span>&nbsp;<span class="op" id="3882948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882952">off</span><span class="op" id="3882955">,</span>&nbsp;<span class="ident" id="3882957">ok</span>&nbsp;<span class="op" id="3882960">=</span>&nbsp;<span class="ident" id="3882962">unpackStruct</span><span class="op" id="3882974">(</span><span class="op" id="3882975">&amp;</span><span class="ident" id="3882976">dns</span><span class="op" id="3882979">.</span><span class="ident" id="3882980">question</span><span class="op" id="3882988">[</span><span class="ident" id="3882989">i</span><span class="op" id="3882990">]</span><span class="op" id="3882991">,</span>&nbsp;<span class="ident" id="3882993">msg</span><span class="op" id="3882996">,</span>&nbsp;<span class="ident" id="3882998">off</span><span class="op" id="3883001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3883004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883007">for</span>&nbsp;<span class="ident" id="3883011">i</span>&nbsp;<span class="op" id="3883013">:=</span>&nbsp;<span class="num" id="3883016">0</span><span class="op" id="3883017">;</span>&nbsp;<span class="ident" id="3883019">i</span>&nbsp;<span class="op" id="3883021">&lt;</span>&nbsp;<span class="builtintype" id="3883023">int</span><span class="op" id="3883026">(</span><span class="ident" id="3883027">dh</span><span class="op" id="3883029">.</span><span class="ident" id="3883030">Ancount</span><span class="op" id="3883037">)</span><span class="op" id="3883038">;</span>&nbsp;<span class="ident" id="3883040">i</span><span class="op" id="3883041">++</span>&nbsp;<span class="op" id="3883044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883048">rec</span><span class="op" id="3883051">,</span>&nbsp;<span class="ident" id="3883053">off</span><span class="op" id="3883056">,</span>&nbsp;<span class="ident" id="3883058">ok</span>&nbsp;<span class="op" id="3883061">=</span>&nbsp;<span class="ident" id="3883063">unpackRR</span><span class="op" id="3883071">(</span><span class="ident" id="3883072">msg</span><span class="op" id="3883075">,</span>&nbsp;<span class="ident" id="3883077">off</span><span class="op" id="3883080">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883084">if</span>&nbsp;<span class="op" id="3883087">!</span><span class="ident" id="3883088">ok</span>&nbsp;<span class="op" id="3883091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883096">return</span>&nbsp;<span class="builtintype" id="3883103">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3883111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883115">dns</span><span class="op" id="3883118">.</span><span class="ident" id="3883119">answer</span>&nbsp;<span class="op" id="3883126">=</span>&nbsp;<span class="builtinfunc" id="3883128">append</span><span class="op" id="3883134">(</span><span class="ident" id="3883135">dns</span><span class="op" id="3883138">.</span><span class="ident" id="3883139">answer</span><span class="op" id="3883145">,</span>&nbsp;<span class="ident" id="3883147">rec</span><span class="op" id="3883150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3883153">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883156">for</span>&nbsp;<span class="ident" id="3883160">i</span>&nbsp;<span class="op" id="3883162">:=</span>&nbsp;<span class="num" id="3883165">0</span><span class="op" id="3883166">;</span>&nbsp;<span class="ident" id="3883168">i</span>&nbsp;<span class="op" id="3883170">&lt;</span>&nbsp;<span class="builtintype" id="3883172">int</span><span class="op" id="3883175">(</span><span class="ident" id="3883176">dh</span><span class="op" id="3883178">.</span><span class="ident" id="3883179">Nscount</span><span class="op" id="3883186">)</span><span class="op" id="3883187">;</span>&nbsp;<span class="ident" id="3883189">i</span><span class="op" id="3883190">++</span>&nbsp;<span class="op" id="3883193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883197">rec</span><span class="op" id="3883200">,</span>&nbsp;<span class="ident" id="3883202">off</span><span class="op" id="3883205">,</span>&nbsp;<span class="ident" id="3883207">ok</span>&nbsp;<span class="op" id="3883210">=</span>&nbsp;<span class="ident" id="3883212">unpackRR</span><span class="op" id="3883220">(</span><span class="ident" id="3883221">msg</span><span class="op" id="3883224">,</span>&nbsp;<span class="ident" id="3883226">off</span><span class="op" id="3883229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883233">if</span>&nbsp;<span class="op" id="3883236">!</span><span class="ident" id="3883237">ok</span>&nbsp;<span class="op" id="3883240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883245">return</span>&nbsp;<span class="builtintype" id="3883252">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3883260">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883264">dns</span><span class="op" id="3883267">.</span><span class="ident" id="3883268">ns</span>&nbsp;<span class="op" id="3883271">=</span>&nbsp;<span class="builtinfunc" id="3883273">append</span><span class="op" id="3883279">(</span><span class="ident" id="3883280">dns</span><span class="op" id="3883283">.</span><span class="ident" id="3883284">ns</span><span class="op" id="3883286">,</span>&nbsp;<span class="ident" id="3883288">rec</span><span class="op" id="3883291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3883294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883297">for</span>&nbsp;<span class="ident" id="3883301">i</span>&nbsp;<span class="op" id="3883303">:=</span>&nbsp;<span class="num" id="3883306">0</span><span class="op" id="3883307">;</span>&nbsp;<span class="ident" id="3883309">i</span>&nbsp;<span class="op" id="3883311">&lt;</span>&nbsp;<span class="builtintype" id="3883313">int</span><span class="op" id="3883316">(</span><span class="ident" id="3883317">dh</span><span class="op" id="3883319">.</span><span class="ident" id="3883320">Arcount</span><span class="op" id="3883327">)</span><span class="op" id="3883328">;</span>&nbsp;<span class="ident" id="3883330">i</span><span class="op" id="3883331">++</span>&nbsp;<span class="op" id="3883334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883338">rec</span><span class="op" id="3883341">,</span>&nbsp;<span class="ident" id="3883343">off</span><span class="op" id="3883346">,</span>&nbsp;<span class="ident" id="3883348">ok</span>&nbsp;<span class="op" id="3883351">=</span>&nbsp;<span class="ident" id="3883353">unpackRR</span><span class="op" id="3883361">(</span><span class="ident" id="3883362">msg</span><span class="op" id="3883365">,</span>&nbsp;<span class="ident" id="3883367">off</span><span class="op" id="3883370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883374">if</span>&nbsp;<span class="op" id="3883377">!</span><span class="ident" id="3883378">ok</span>&nbsp;<span class="op" id="3883381">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883386">return</span>&nbsp;<span class="builtintype" id="3883393">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3883401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883405">dns</span><span class="op" id="3883408">.</span><span class="ident" id="3883409">extra</span>&nbsp;<span class="op" id="3883415">=</span>&nbsp;<span class="builtinfunc" id="3883417">append</span><span class="op" id="3883423">(</span><span class="ident" id="3883424">dns</span><span class="op" id="3883427">.</span><span class="ident" id="3883428">extra</span><span class="op" id="3883433">,</span>&nbsp;<span class="ident" id="3883435">rec</span><span class="op" id="3883438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3883441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3883444">//&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;off&nbsp;!=&nbsp;len(msg)&nbsp;{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3883469">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;println(&#34;extra&nbsp;bytes&nbsp;in&nbsp;dns&nbsp;packet&#34;,&nbsp;off,&nbsp;&#34;&lt;&#34;,&nbsp;len(msg));</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3883532">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883538">return</span>&nbsp;<span class="builtintype" id="3883545">true</span><br>
<span class="lineno"></span><span class="op" id="3883550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3883553">func</span>&nbsp;<span class="op" id="3883558">(</span><span class="ident" id="3883559">dns</span>&nbsp;<span class="op" id="3883563">*</span><span class="ident" id="3883564">dnsMsg</span><span class="op" id="3883570">)</span>&nbsp;<span class="ident" id="3883572">String</span><span class="op" id="3883578">(</span><span class="op" id="3883579">)</span>&nbsp;<span class="builtintype" id="3883581">string</span>&nbsp;<span class="op" id="3883588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883591">s</span>&nbsp;<span class="op" id="3883593">:=</span>&nbsp;<span class="string" id="3883596">&#34;DNS:&nbsp;&#34;</span>&nbsp;<span class="op" id="3883604">+</span>&nbsp;<span class="ident" id="3883606">printStruct</span><span class="op" id="3883617">(</span><span class="op" id="3883618">&amp;</span><span class="ident" id="3883619">dns</span><span class="op" id="3883622">.</span><span class="ident" id="3883623">dnsMsgHdr</span><span class="op" id="3883632">)</span>&nbsp;<span class="op" id="3883634">+</span>&nbsp;<span class="string" id="3883636">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883642">if</span>&nbsp;<span class="builtinfunc" id="3883645">len</span><span class="op" id="3883648">(</span><span class="ident" id="3883649">dns</span><span class="op" id="3883652">.</span><span class="ident" id="3883653">question</span><span class="op" id="3883661">)</span>&nbsp;<span class="op" id="3883663">&gt;</span>&nbsp;<span class="num" id="3883665">0</span>&nbsp;<span class="op" id="3883667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883671">s</span>&nbsp;<span class="op" id="3883673">+=</span>&nbsp;<span class="string" id="3883676">&#34;--&nbsp;Questions\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883695">for</span>&nbsp;<span class="ident" id="3883699">i</span>&nbsp;<span class="op" id="3883701">:=</span>&nbsp;<span class="num" id="3883704">0</span><span class="op" id="3883705">;</span>&nbsp;<span class="ident" id="3883707">i</span>&nbsp;<span class="op" id="3883709">&lt;</span>&nbsp;<span class="builtinfunc" id="3883711">len</span><span class="op" id="3883714">(</span><span class="ident" id="3883715">dns</span><span class="op" id="3883718">.</span><span class="ident" id="3883719">question</span><span class="op" id="3883727">)</span><span class="op" id="3883728">;</span>&nbsp;<span class="ident" id="3883730">i</span><span class="op" id="3883731">++</span>&nbsp;<span class="op" id="3883734">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883739">s</span>&nbsp;<span class="op" id="3883741">+=</span>&nbsp;<span class="ident" id="3883744">printStruct</span><span class="op" id="3883755">(</span><span class="op" id="3883756">&amp;</span><span class="ident" id="3883757">dns</span><span class="op" id="3883760">.</span><span class="ident" id="3883761">question</span><span class="op" id="3883769">[</span><span class="ident" id="3883770">i</span><span class="op" id="3883771">]</span><span class="op" id="3883772">)</span>&nbsp;<span class="op" id="3883774">+</span>&nbsp;<span class="string" id="3883776">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3883783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3883786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883789">if</span>&nbsp;<span class="builtinfunc" id="3883792">len</span><span class="op" id="3883795">(</span><span class="ident" id="3883796">dns</span><span class="op" id="3883799">.</span><span class="ident" id="3883800">answer</span><span class="op" id="3883806">)</span>&nbsp;<span class="op" id="3883808">&gt;</span>&nbsp;<span class="num" id="3883810">0</span>&nbsp;<span class="op" id="3883812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883816">s</span>&nbsp;<span class="op" id="3883818">+=</span>&nbsp;<span class="string" id="3883821">&#34;--&nbsp;Answers\n&#34;</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883838">for</span>&nbsp;<span class="ident" id="3883842">i</span>&nbsp;<span class="op" id="3883844">:=</span>&nbsp;<span class="num" id="3883847">0</span><span class="op" id="3883848">;</span>&nbsp;<span class="ident" id="3883850">i</span>&nbsp;<span class="op" id="3883852">&lt;</span>&nbsp;<span class="builtinfunc" id="3883854">len</span><span class="op" id="3883857">(</span><span class="ident" id="3883858">dns</span><span class="op" id="3883861">.</span><span class="ident" id="3883862">answer</span><span class="op" id="3883868">)</span><span class="op" id="3883869">;</span>&nbsp;<span class="ident" id="3883871">i</span><span class="op" id="3883872">++</span>&nbsp;<span class="op" id="3883875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883880">s</span>&nbsp;<span class="op" id="3883882">+=</span>&nbsp;<span class="ident" id="3883885">printStruct</span><span class="op" id="3883896">(</span><span class="ident" id="3883897">dns</span><span class="op" id="3883900">.</span><span class="ident" id="3883901">answer</span><span class="op" id="3883907">[</span><span class="ident" id="3883908">i</span><span class="op" id="3883909">]</span><span class="op" id="3883910">)</span>&nbsp;<span class="op" id="3883912">+</span>&nbsp;<span class="string" id="3883914">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3883921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3883924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883927">if</span>&nbsp;<span class="builtinfunc" id="3883930">len</span><span class="op" id="3883933">(</span><span class="ident" id="3883934">dns</span><span class="op" id="3883937">.</span><span class="ident" id="3883938">ns</span><span class="op" id="3883940">)</span>&nbsp;<span class="op" id="3883942">&gt;</span>&nbsp;<span class="num" id="3883944">0</span>&nbsp;<span class="op" id="3883946">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883950">s</span>&nbsp;<span class="op" id="3883952">+=</span>&nbsp;<span class="string" id="3883955">&#34;--&nbsp;Name&nbsp;servers\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883977">for</span>&nbsp;<span class="ident" id="3883981">i</span>&nbsp;<span class="op" id="3883983">:=</span>&nbsp;<span class="num" id="3883986">0</span><span class="op" id="3883987">;</span>&nbsp;<span class="ident" id="3883989">i</span>&nbsp;<span class="op" id="3883991">&lt;</span>&nbsp;<span class="builtinfunc" id="3883993">len</span><span class="op" id="3883996">(</span><span class="ident" id="3883997">dns</span><span class="op" id="3884000">.</span><span class="ident" id="3884001">ns</span><span class="op" id="3884003">)</span><span class="op" id="3884004">;</span>&nbsp;<span class="ident" id="3884006">i</span><span class="op" id="3884007">++</span>&nbsp;<span class="op" id="3884010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3884015">s</span>&nbsp;<span class="op" id="3884017">+=</span>&nbsp;<span class="ident" id="3884020">printStruct</span><span class="op" id="3884031">(</span><span class="ident" id="3884032">dns</span><span class="op" id="3884035">.</span><span class="ident" id="3884036">ns</span><span class="op" id="3884038">[</span><span class="ident" id="3884039">i</span><span class="op" id="3884040">]</span><span class="op" id="3884041">)</span>&nbsp;<span class="op" id="3884043">+</span>&nbsp;<span class="string" id="3884045">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3884052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3884055">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3884058">if</span>&nbsp;<span class="builtinfunc" id="3884061">len</span><span class="op" id="3884064">(</span><span class="ident" id="3884065">dns</span><span class="op" id="3884068">.</span><span class="ident" id="3884069">extra</span><span class="op" id="3884074">)</span>&nbsp;<span class="op" id="3884076">&gt;</span>&nbsp;<span class="num" id="3884078">0</span>&nbsp;<span class="op" id="3884080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3884084">s</span>&nbsp;<span class="op" id="3884086">+=</span>&nbsp;<span class="string" id="3884089">&#34;--&nbsp;Extra\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3884104">for</span>&nbsp;<span class="ident" id="3884108">i</span>&nbsp;<span class="op" id="3884110">:=</span>&nbsp;<span class="num" id="3884113">0</span><span class="op" id="3884114">;</span>&nbsp;<span class="ident" id="3884116">i</span>&nbsp;<span class="op" id="3884118">&lt;</span>&nbsp;<span class="builtinfunc" id="3884120">len</span><span class="op" id="3884123">(</span><span class="ident" id="3884124">dns</span><span class="op" id="3884127">.</span><span class="ident" id="3884128">extra</span><span class="op" id="3884133">)</span><span class="op" id="3884134">;</span>&nbsp;<span class="ident" id="3884136">i</span><span class="op" id="3884137">++</span>&nbsp;<span class="op" id="3884140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3884145">s</span>&nbsp;<span class="op" id="3884147">+=</span>&nbsp;<span class="ident" id="3884150">printStruct</span><span class="op" id="3884161">(</span><span class="ident" id="3884162">dns</span><span class="op" id="3884165">.</span><span class="ident" id="3884166">extra</span><span class="op" id="3884171">[</span><span class="ident" id="3884172">i</span><span class="op" id="3884173">]</span><span class="op" id="3884174">)</span>&nbsp;<span class="op" id="3884176">+</span>&nbsp;<span class="string" id="3884178">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3884185">}</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3884188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3884191">return</span>&nbsp;<span class="ident" id="3884198">s</span><br>
<span class="lineno"></span><span class="op" id="3884200">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
