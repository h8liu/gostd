<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html" class="current">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3910998">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3911053">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3911107">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3911158">package</span>&nbsp;<span class="ident" id="3911166">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3911172">import</span>&nbsp;<span class="op" id="3911179">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3911182">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3911196">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3911213">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3911223">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="3911234">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3911237">//&nbsp;pkcs1PrivateKey&nbsp;is&nbsp;a&nbsp;structure&nbsp;which&nbsp;mirrors&nbsp;the&nbsp;PKCS#1&nbsp;ASN.1&nbsp;for&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno">15</span><span class="keyword" id="3911326">type</span>&nbsp;<span class="ident" id="3911331">pkcs1PrivateKey</span>&nbsp;<span class="keyword" id="3911347">struct</span>&nbsp;<span class="op" id="3911354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3911357">Version</span>&nbsp;<span class="builtintype" id="3911365">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3911370">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3911378">*</span><span class="ident" id="3911379">big</span><span class="op" id="3911382">.</span><span class="ident" id="3911383">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3911388">E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3911396">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3911401">D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3911409">*</span><span class="ident" id="3911410">big</span><span class="op" id="3911413">.</span><span class="ident" id="3911414">Int</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3911419">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3911427">*</span><span class="ident" id="3911428">big</span><span class="op" id="3911431">.</span><span class="ident" id="3911432">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3911437">Q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3911445">*</span><span class="ident" id="3911446">big</span><span class="op" id="3911449">.</span><span class="ident" id="3911450">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3911455">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values,&nbsp;if&nbsp;present,&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3911528">Dp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3911533">*</span><span class="ident" id="3911534">big</span><span class="op" id="3911537">.</span><span class="ident" id="3911538">Int</span>&nbsp;<span class="string" id="3911542">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3911561">Dq</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3911566">*</span><span class="ident" id="3911567">big</span><span class="op" id="3911570">.</span><span class="ident" id="3911571">Int</span>&nbsp;<span class="string" id="3911575">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3911594">Qinv</span>&nbsp;<span class="op" id="3911599">*</span><span class="ident" id="3911600">big</span><span class="op" id="3911603">.</span><span class="ident" id="3911604">Int</span>&nbsp;<span class="string" id="3911608">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3911628">AdditionalPrimes</span>&nbsp;<span class="op" id="3911645">[</span><span class="op" id="3911646">]</span><span class="ident" id="3911647">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="string" id="3911671">`asn1:&#34;optional,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3911699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="3911702">type</span>&nbsp;<span class="ident" id="3911707">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="keyword" id="3911731">struct</span>&nbsp;<span class="op" id="3911738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3911741">Prime</span>&nbsp;<span class="op" id="3911747">*</span><span class="ident" id="3911748">big</span><span class="op" id="3911751">.</span><span class="ident" id="3911752">Int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3911758">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3911818">Exp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3911824">*</span><span class="ident" id="3911825">big</span><span class="op" id="3911828">.</span><span class="ident" id="3911829">Int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3911834">Coeff</span>&nbsp;<span class="op" id="3911840">*</span><span class="ident" id="3911841">big</span><span class="op" id="3911844">.</span><span class="ident" id="3911845">Int</span><br>
<span class="lineno"></span><span class="op" id="3911849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3911852">//&nbsp;ParsePKCS1PrivateKey&nbsp;returns&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key&nbsp;from&nbsp;its&nbsp;ASN.1&nbsp;PKCS#1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="3911943">func</span>&nbsp;<span class="ident" id="3911948">ParsePKCS1PrivateKey</span><span class="op" id="3911968">(</span><span class="ident" id="3911969">der</span>&nbsp;<span class="op" id="3911973">[</span><span class="op" id="3911974">]</span><span class="builtintype" id="3911975">byte</span><span class="op" id="3911979">)</span>&nbsp;<span class="op" id="3911981">(</span><span class="ident" id="3911982">key</span>&nbsp;<span class="op" id="3911986">*</span><span class="ident" id="3911987">rsa</span><span class="op" id="3911990">.</span><span class="ident" id="3911991">PrivateKey</span><span class="op" id="3912001">,</span>&nbsp;<span class="ident" id="3912003">err</span>&nbsp;<span class="builtintype" id="3912007">error</span><span class="op" id="3912012">)</span>&nbsp;<span class="op" id="3912014">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3912017">var</span>&nbsp;<span class="ident" id="3912021">priv</span>&nbsp;<span class="ident" id="3912026">pkcs1PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3912043">rest</span><span class="op" id="3912047">,</span>&nbsp;<span class="ident" id="3912049">err</span>&nbsp;<span class="op" id="3912053">:=</span>&nbsp;<span class="ident" id="3912056">asn1</span><span class="op" id="3912060">.</span><span class="ident" id="3912061">Unmarshal</span><span class="op" id="3912070">(</span><span class="ident" id="3912071">der</span><span class="op" id="3912074">,</span>&nbsp;<span class="op" id="3912076">&amp;</span><span class="ident" id="3912077">priv</span><span class="op" id="3912081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3912084">if</span>&nbsp;<span class="builtinfunc" id="3912087">len</span><span class="op" id="3912090">(</span><span class="ident" id="3912091">rest</span><span class="op" id="3912095">)</span>&nbsp;<span class="op" id="3912097">&gt;</span>&nbsp;<span class="num" id="3912099">0</span>&nbsp;<span class="op" id="3912101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3912105">err</span>&nbsp;<span class="op" id="3912109">=</span>&nbsp;<span class="ident" id="3912111">asn1</span><span class="op" id="3912115">.</span><span class="ident" id="3912116">SyntaxError</span><span class="op" id="3912127">{</span><span class="ident" id="3912128">Msg</span><span class="op" id="3912131">:</span>&nbsp;<span class="string" id="3912133">&#34;trailing&nbsp;data&#34;</span><span class="op" id="3912148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3912152">return</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3912160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3912163">if</span>&nbsp;<span class="ident" id="3912166">err</span>&nbsp;<span class="op" id="3912170">!=</span>&nbsp;<span class="builtintype" id="3912173">nil</span>&nbsp;<span class="op" id="3912177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3912181">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3912189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3912193">if</span>&nbsp;<span class="ident" id="3912196">priv</span><span class="op" id="3912200">.</span><span class="ident" id="3912201">Version</span>&nbsp;<span class="op" id="3912209">&gt;</span>&nbsp;<span class="num" id="3912211">1</span>&nbsp;<span class="op" id="3912213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3912217">return</span>&nbsp;<span class="builtintype" id="3912224">nil</span><span class="op" id="3912227">,</span>&nbsp;<span class="ident" id="3912229">errors</span><span class="op" id="3912235">.</span><span class="ident" id="3912236">New</span><span class="op" id="3912239">(</span><span class="string" id="3912240">&#34;x509:&nbsp;unsupported&nbsp;private&nbsp;key&nbsp;version&#34;</span><span class="op" id="3912279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3912282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3912286">if</span>&nbsp;<span class="ident" id="3912289">priv</span><span class="op" id="3912293">.</span><span class="ident" id="3912294">N</span><span class="op" id="3912295">.</span><span class="ident" id="3912296">Sign</span><span class="op" id="3912300">(</span><span class="op" id="3912301">)</span>&nbsp;<span class="op" id="3912303">&lt;=</span>&nbsp;<span class="num" id="3912306">0</span>&nbsp;<span class="op" id="3912308">||</span>&nbsp;<span class="ident" id="3912311">priv</span><span class="op" id="3912315">.</span><span class="ident" id="3912316">D</span><span class="op" id="3912317">.</span><span class="ident" id="3912318">Sign</span><span class="op" id="3912322">(</span><span class="op" id="3912323">)</span>&nbsp;<span class="op" id="3912325">&lt;=</span>&nbsp;<span class="num" id="3912328">0</span>&nbsp;<span class="op" id="3912330">||</span>&nbsp;<span class="ident" id="3912333">priv</span><span class="op" id="3912337">.</span><span class="ident" id="3912338">P</span><span class="op" id="3912339">.</span><span class="ident" id="3912340">Sign</span><span class="op" id="3912344">(</span><span class="op" id="3912345">)</span>&nbsp;<span class="op" id="3912347">&lt;=</span>&nbsp;<span class="num" id="3912350">0</span>&nbsp;<span class="op" id="3912352">||</span>&nbsp;<span class="ident" id="3912355">priv</span><span class="op" id="3912359">.</span><span class="ident" id="3912360">Q</span><span class="op" id="3912361">.</span><span class="ident" id="3912362">Sign</span><span class="op" id="3912366">(</span><span class="op" id="3912367">)</span>&nbsp;<span class="op" id="3912369">&lt;=</span>&nbsp;<span class="num" id="3912372">0</span>&nbsp;<span class="op" id="3912374">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3912378">return</span>&nbsp;<span class="builtintype" id="3912385">nil</span><span class="op" id="3912388">,</span>&nbsp;<span class="ident" id="3912390">errors</span><span class="op" id="3912396">.</span><span class="ident" id="3912397">New</span><span class="op" id="3912400">(</span><span class="string" id="3912401">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;value&#34;</span><span class="op" id="3912452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3912455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3912459">key</span>&nbsp;<span class="op" id="3912463">=</span>&nbsp;<span class="builtinfunc" id="3912465">new</span><span class="op" id="3912468">(</span><span class="ident" id="3912469">rsa</span><span class="op" id="3912472">.</span><span class="ident" id="3912473">PrivateKey</span><span class="op" id="3912483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3912486">key</span><span class="op" id="3912489">.</span><span class="ident" id="3912490">PublicKey</span>&nbsp;<span class="op" id="3912500">=</span>&nbsp;<span class="ident" id="3912502">rsa</span><span class="op" id="3912505">.</span><span class="ident" id="3912506">PublicKey</span><span class="op" id="3912515">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3912519">E</span><span class="op" id="3912520">:</span>&nbsp;<span class="ident" id="3912522">priv</span><span class="op" id="3912526">.</span><span class="ident" id="3912527">E</span><span class="op" id="3912528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3912532">N</span><span class="op" id="3912533">:</span>&nbsp;<span class="ident" id="3912535">priv</span><span class="op" id="3912539">.</span><span class="ident" id="3912540">N</span><span class="op" id="3912541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3912544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3912548">key</span><span class="op" id="3912551">.</span><span class="ident" id="3912552">D</span>&nbsp;<span class="op" id="3912554">=</span>&nbsp;<span class="ident" id="3912556">priv</span><span class="op" id="3912560">.</span><span class="ident" id="3912561">D</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3912564">key</span><span class="op" id="3912567">.</span><span class="ident" id="3912568">Primes</span>&nbsp;<span class="op" id="3912575">=</span>&nbsp;<span class="builtinfunc" id="3912577">make</span><span class="op" id="3912581">(</span><span class="op" id="3912582">[</span><span class="op" id="3912583">]</span><span class="op" id="3912584">*</span><span class="ident" id="3912585">big</span><span class="op" id="3912588">.</span><span class="ident" id="3912589">Int</span><span class="op" id="3912592">,</span>&nbsp;<span class="num" id="3912594">2</span><span class="op" id="3912595">+</span><span class="builtinfunc" id="3912596">len</span><span class="op" id="3912599">(</span><span class="ident" id="3912600">priv</span><span class="op" id="3912604">.</span><span class="ident" id="3912605">AdditionalPrimes</span><span class="op" id="3912621">)</span><span class="op" id="3912622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3912625">key</span><span class="op" id="3912628">.</span><span class="ident" id="3912629">Primes</span><span class="op" id="3912635">[</span><span class="num" id="3912636">0</span><span class="op" id="3912637">]</span>&nbsp;<span class="op" id="3912639">=</span>&nbsp;<span class="ident" id="3912641">priv</span><span class="op" id="3912645">.</span><span class="ident" id="3912646">P</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3912649">key</span><span class="op" id="3912652">.</span><span class="ident" id="3912653">Primes</span><span class="op" id="3912659">[</span><span class="num" id="3912660">1</span><span class="op" id="3912661">]</span>&nbsp;<span class="op" id="3912663">=</span>&nbsp;<span class="ident" id="3912665">priv</span><span class="op" id="3912669">.</span><span class="ident" id="3912670">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3912673">for</span>&nbsp;<span class="ident" id="3912677">i</span><span class="op" id="3912678">,</span>&nbsp;<span class="ident" id="3912680">a</span>&nbsp;<span class="op" id="3912682">:=</span>&nbsp;<span class="keyword" id="3912685">range</span>&nbsp;<span class="ident" id="3912691">priv</span><span class="op" id="3912695">.</span><span class="ident" id="3912696">AdditionalPrimes</span>&nbsp;<span class="op" id="3912713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3912717">if</span>&nbsp;<span class="ident" id="3912720">a</span><span class="op" id="3912721">.</span><span class="ident" id="3912722">Prime</span><span class="op" id="3912727">.</span><span class="ident" id="3912728">Sign</span><span class="op" id="3912732">(</span><span class="op" id="3912733">)</span>&nbsp;<span class="op" id="3912735">&lt;=</span>&nbsp;<span class="num" id="3912738">0</span>&nbsp;<span class="op" id="3912740">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3912745">return</span>&nbsp;<span class="builtintype" id="3912752">nil</span><span class="op" id="3912755">,</span>&nbsp;<span class="ident" id="3912757">errors</span><span class="op" id="3912763">.</span><span class="ident" id="3912764">New</span><span class="op" id="3912767">(</span><span class="string" id="3912768">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;prime&#34;</span><span class="op" id="3912819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3912823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3912827">key</span><span class="op" id="3912830">.</span><span class="ident" id="3912831">Primes</span><span class="op" id="3912837">[</span><span class="ident" id="3912838">i</span><span class="op" id="3912839">+</span><span class="num" id="3912840">2</span><span class="op" id="3912841">]</span>&nbsp;<span class="op" id="3912843">=</span>&nbsp;<span class="ident" id="3912845">a</span><span class="op" id="3912846">.</span><span class="ident" id="3912847">Prime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3912855">//&nbsp;We&nbsp;ignore&nbsp;the&nbsp;other&nbsp;two&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3912918">//&nbsp;them&nbsp;as&nbsp;needed.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3912938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3912942">err</span>&nbsp;<span class="op" id="3912946">=</span>&nbsp;<span class="ident" id="3912948">key</span><span class="op" id="3912951">.</span><span class="ident" id="3912952">Validate</span><span class="op" id="3912960">(</span><span class="op" id="3912961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3912964">if</span>&nbsp;<span class="ident" id="3912967">err</span>&nbsp;<span class="op" id="3912971">!=</span>&nbsp;<span class="builtintype" id="3912974">nil</span>&nbsp;<span class="op" id="3912978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3912982">return</span>&nbsp;<span class="builtintype" id="3912989">nil</span><span class="op" id="3912992">,</span>&nbsp;<span class="ident" id="3912994">err</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3912999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913002">key</span><span class="op" id="3913005">.</span><span class="ident" id="3913006">Precompute</span><span class="op" id="3913016">(</span><span class="op" id="3913017">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3913021">return</span><br>
<span class="lineno"></span><span class="op" id="3913028">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="3913031">//&nbsp;MarshalPKCS1PrivateKey&nbsp;converts&nbsp;a&nbsp;private&nbsp;key&nbsp;to&nbsp;ASN.1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="3913107">func</span>&nbsp;<span class="ident" id="3913112">MarshalPKCS1PrivateKey</span><span class="op" id="3913134">(</span><span class="ident" id="3913135">key</span>&nbsp;<span class="op" id="3913139">*</span><span class="ident" id="3913140">rsa</span><span class="op" id="3913143">.</span><span class="ident" id="3913144">PrivateKey</span><span class="op" id="3913154">)</span>&nbsp;<span class="op" id="3913156">[</span><span class="op" id="3913157">]</span><span class="builtintype" id="3913158">byte</span>&nbsp;<span class="op" id="3913163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913166">key</span><span class="op" id="3913169">.</span><span class="ident" id="3913170">Precompute</span><span class="op" id="3913180">(</span><span class="op" id="3913181">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913185">version</span>&nbsp;<span class="op" id="3913193">:=</span>&nbsp;<span class="num" id="3913196">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3913199">if</span>&nbsp;<span class="builtinfunc" id="3913202">len</span><span class="op" id="3913205">(</span><span class="ident" id="3913206">key</span><span class="op" id="3913209">.</span><span class="ident" id="3913210">Primes</span><span class="op" id="3913216">)</span>&nbsp;<span class="op" id="3913218">&gt;</span>&nbsp;<span class="num" id="3913220">2</span>&nbsp;<span class="op" id="3913222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913226">version</span>&nbsp;<span class="op" id="3913234">=</span>&nbsp;<span class="num" id="3913236">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3913239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913243">priv</span>&nbsp;<span class="op" id="3913248">:=</span>&nbsp;<span class="ident" id="3913251">pkcs1PrivateKey</span><span class="op" id="3913266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913270">Version</span><span class="op" id="3913277">:</span>&nbsp;<span class="ident" id="3913279">version</span><span class="op" id="3913286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913290">N</span><span class="op" id="3913291">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913299">key</span><span class="op" id="3913302">.</span><span class="ident" id="3913303">N</span><span class="op" id="3913304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913308">E</span><span class="op" id="3913309">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913317">key</span><span class="op" id="3913320">.</span><span class="ident" id="3913321">PublicKey</span><span class="op" id="3913330">.</span><span class="ident" id="3913331">E</span><span class="op" id="3913332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913336">D</span><span class="op" id="3913337">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913345">key</span><span class="op" id="3913348">.</span><span class="ident" id="3913349">D</span><span class="op" id="3913350">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913354">P</span><span class="op" id="3913355">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913363">key</span><span class="op" id="3913366">.</span><span class="ident" id="3913367">Primes</span><span class="op" id="3913373">[</span><span class="num" id="3913374">0</span><span class="op" id="3913375">]</span><span class="op" id="3913376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913380">Q</span><span class="op" id="3913381">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913389">key</span><span class="op" id="3913392">.</span><span class="ident" id="3913393">Primes</span><span class="op" id="3913399">[</span><span class="num" id="3913400">1</span><span class="op" id="3913401">]</span><span class="op" id="3913402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913406">Dp</span><span class="op" id="3913408">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913415">key</span><span class="op" id="3913418">.</span><span class="ident" id="3913419">Precomputed</span><span class="op" id="3913430">.</span><span class="ident" id="3913431">Dp</span><span class="op" id="3913433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913437">Dq</span><span class="op" id="3913439">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913446">key</span><span class="op" id="3913449">.</span><span class="ident" id="3913450">Precomputed</span><span class="op" id="3913461">.</span><span class="ident" id="3913462">Dq</span><span class="op" id="3913464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913468">Qinv</span><span class="op" id="3913472">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913477">key</span><span class="op" id="3913480">.</span><span class="ident" id="3913481">Precomputed</span><span class="op" id="3913492">.</span><span class="ident" id="3913493">Qinv</span><span class="op" id="3913497">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3913500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913504">priv</span><span class="op" id="3913508">.</span><span class="ident" id="3913509">AdditionalPrimes</span>&nbsp;<span class="op" id="3913526">=</span>&nbsp;<span class="builtinfunc" id="3913528">make</span><span class="op" id="3913532">(</span><span class="op" id="3913533">[</span><span class="op" id="3913534">]</span><span class="ident" id="3913535">pkcs1AdditionalRSAPrime</span><span class="op" id="3913558">,</span>&nbsp;<span class="builtinfunc" id="3913560">len</span><span class="op" id="3913563">(</span><span class="ident" id="3913564">key</span><span class="op" id="3913567">.</span><span class="ident" id="3913568">Precomputed</span><span class="op" id="3913579">.</span><span class="ident" id="3913580">CRTValues</span><span class="op" id="3913589">)</span><span class="op" id="3913590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3913593">for</span>&nbsp;<span class="ident" id="3913597">i</span><span class="op" id="3913598">,</span>&nbsp;<span class="ident" id="3913600">values</span>&nbsp;<span class="op" id="3913607">:=</span>&nbsp;<span class="keyword" id="3913610">range</span>&nbsp;<span class="ident" id="3913616">key</span><span class="op" id="3913619">.</span><span class="ident" id="3913620">Precomputed</span><span class="op" id="3913631">.</span><span class="ident" id="3913632">CRTValues</span>&nbsp;<span class="op" id="3913642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913646">priv</span><span class="op" id="3913650">.</span><span class="ident" id="3913651">AdditionalPrimes</span><span class="op" id="3913667">[</span><span class="ident" id="3913668">i</span><span class="op" id="3913669">]</span><span class="op" id="3913670">.</span><span class="ident" id="3913671">Prime</span>&nbsp;<span class="op" id="3913677">=</span>&nbsp;<span class="ident" id="3913679">key</span><span class="op" id="3913682">.</span><span class="ident" id="3913683">Primes</span><span class="op" id="3913689">[</span><span class="num" id="3913690">2</span><span class="op" id="3913691">+</span><span class="ident" id="3913692">i</span><span class="op" id="3913693">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913697">priv</span><span class="op" id="3913701">.</span><span class="ident" id="3913702">AdditionalPrimes</span><span class="op" id="3913718">[</span><span class="ident" id="3913719">i</span><span class="op" id="3913720">]</span><span class="op" id="3913721">.</span><span class="ident" id="3913722">Exp</span>&nbsp;<span class="op" id="3913726">=</span>&nbsp;<span class="ident" id="3913728">values</span><span class="op" id="3913734">.</span><span class="ident" id="3913735">Exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913741">priv</span><span class="op" id="3913745">.</span><span class="ident" id="3913746">AdditionalPrimes</span><span class="op" id="3913762">[</span><span class="ident" id="3913763">i</span><span class="op" id="3913764">]</span><span class="op" id="3913765">.</span><span class="ident" id="3913766">Coeff</span>&nbsp;<span class="op" id="3913772">=</span>&nbsp;<span class="ident" id="3913774">values</span><span class="op" id="3913780">.</span><span class="ident" id="3913781">Coeff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3913788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913792">b</span><span class="op" id="3913793">,</span>&nbsp;<span class="ident" id="3913795">_</span>&nbsp;<span class="op" id="3913797">:=</span>&nbsp;<span class="ident" id="3913800">asn1</span><span class="op" id="3913804">.</span><span class="ident" id="3913805">Marshal</span><span class="op" id="3913812">(</span><span class="ident" id="3913813">priv</span><span class="op" id="3913817">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3913820">return</span>&nbsp;<span class="ident" id="3913827">b</span><br>
<span class="lineno"></span><span class="op" id="3913829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3913832">//&nbsp;rsaPublicKey&nbsp;reflects&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;a&nbsp;PKCS#1&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3913901">type</span>&nbsp;<span class="ident" id="3913906">rsaPublicKey</span>&nbsp;<span class="keyword" id="3913919">struct</span>&nbsp;<span class="op" id="3913926">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913929">N</span>&nbsp;<span class="op" id="3913931">*</span><span class="ident" id="3913932">big</span><span class="op" id="3913935">.</span><span class="ident" id="3913936">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913941">E</span>&nbsp;<span class="builtintype" id="3913943">int</span><br>
<span class="lineno"></span><span class="op" id="3913947">}</span>
</div>
</body>
</html>
