<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html" class="current">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8196182">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8196237">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8196291">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8196342">package</span>&nbsp;<span class="ident" id="8196350">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8196356">import</span>&nbsp;<span class="op" id="8196363">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8196366">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8196377">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8196383">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8196393">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8196396">//&nbsp;TODO(mattn):</span><br>
<span class="lineno"></span><span class="comment" id="8196412">//&nbsp;&nbsp;&nbsp;&nbsptest&nbsp;ProxyAuth</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8196431">var</span>&nbsp;<span class="ident" id="8196435">UseProxyTests</span>&nbsp;<span class="op" id="8196449">=</span>&nbsp;<span class="op" id="8196451">[</span><span class="op" id="8196452">]</span><span class="keyword" id="8196453">struct</span>&nbsp;<span class="op" id="8196460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196463">host</span>&nbsp;&nbsp;<span class="builtintype" id="8196469">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196477">match</span>&nbsp;<span class="builtintype" id="8196483">bool</span><br>
<span class="lineno"></span><span class="op" id="8196488">}</span><span class="op" id="8196489">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8196492">//&nbsp;Never&nbsp;proxy&nbsp;localhost:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196519">{</span><span class="string" id="8196520">&#34;localhost:80&#34;</span><span class="op" id="8196534">,</span>&nbsp;<span class="builtintype" id="8196536">false</span><span class="op" id="8196541">}</span><span class="op" id="8196542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196545">{</span><span class="string" id="8196546">&#34;127.0.0.1&#34;</span><span class="op" id="8196557">,</span>&nbsp;<span class="builtintype" id="8196559">false</span><span class="op" id="8196564">}</span><span class="op" id="8196565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196568">{</span><span class="string" id="8196569">&#34;127.0.0.2&#34;</span><span class="op" id="8196580">,</span>&nbsp;<span class="builtintype" id="8196582">false</span><span class="op" id="8196587">}</span><span class="op" id="8196588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196591">{</span><span class="string" id="8196592">&#34;[::1]&#34;</span><span class="op" id="8196599">,</span>&nbsp;<span class="builtintype" id="8196601">false</span><span class="op" id="8196606">}</span><span class="op" id="8196607">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196610">{</span><span class="string" id="8196611">&#34;[::2]&#34;</span><span class="op" id="8196618">,</span>&nbsp;<span class="builtintype" id="8196620">true</span><span class="op" id="8196624">}</span><span class="op" id="8196625">,</span>&nbsp;<span class="comment" id="8196627">//&nbsp;not&nbsp;a&nbsp;loopback&nbsp;address</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196655">{</span><span class="string" id="8196656">&#34;barbaz.net&#34;</span><span class="op" id="8196668">,</span>&nbsp;<span class="builtintype" id="8196670">false</span><span class="op" id="8196675">}</span><span class="op" id="8196676">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8196682">//&nbsp;match&nbsp;as&nbsp;.barbaz.net</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196707">{</span><span class="string" id="8196708">&#34;foobar.com&#34;</span><span class="op" id="8196720">,</span>&nbsp;<span class="builtintype" id="8196722">false</span><span class="op" id="8196727">}</span><span class="op" id="8196728">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8196734">//&nbsp;have&nbsp;a&nbsp;port&nbsp;but&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196760">{</span><span class="string" id="8196761">&#34;foofoobar.com&#34;</span><span class="op" id="8196776">,</span>&nbsp;<span class="builtintype" id="8196778">true</span><span class="op" id="8196782">}</span><span class="op" id="8196783">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="8196787">//&nbsp;not&nbsp;match&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;foobar.com</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196825">{</span><span class="string" id="8196826">&#34;baz.com&#34;</span><span class="op" id="8196835">,</span>&nbsp;<span class="builtintype" id="8196837">true</span><span class="op" id="8196841">}</span><span class="op" id="8196842">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8196852">//&nbsp;not&nbsp;match&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;barbaz.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196890">{</span><span class="string" id="8196891">&#34;localhost.net&#34;</span><span class="op" id="8196906">,</span>&nbsp;<span class="builtintype" id="8196908">true</span><span class="op" id="8196912">}</span><span class="op" id="8196913">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="8196917">//&nbsp;not&nbsp;match&nbsp;as&nbsp;suffix&nbsp;of&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196952">{</span><span class="string" id="8196953">&#34;local.localhost&#34;</span><span class="op" id="8196970">,</span>&nbsp;<span class="builtintype" id="8196972">true</span><span class="op" id="8196976">}</span><span class="op" id="8196977">,</span>&nbsp;<span class="comment" id="8196979">//&nbsp;not&nbsp;match&nbsp;as&nbsp;prefix&nbsp;as&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197014">{</span><span class="string" id="8197015">&#34;barbarbaz.net&#34;</span><span class="op" id="8197030">,</span>&nbsp;<span class="builtintype" id="8197032">true</span><span class="op" id="8197036">}</span><span class="op" id="8197037">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="8197041">//&nbsp;not&nbsp;match&nbsp;because&nbsp;NO_PROXY&nbsp;have&nbsp;a&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197083">{</span><span class="string" id="8197084">&#34;www.foobar.com&#34;</span><span class="op" id="8197100">,</span>&nbsp;<span class="builtintype" id="8197102">false</span><span class="op" id="8197107">}</span><span class="op" id="8197108">,</span>&nbsp;<span class="comment" id="8197110">//&nbsp;match&nbsp;because&nbsp;NO_PROXY&nbsp;includes&nbsp;&#34;foobar.com&#34;</span><br>
<span class="lineno">35</span><span class="op" id="8197158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8197161">func</span>&nbsp;<span class="ident" id="8197166">TestUseProxy</span><span class="op" id="8197178">(</span><span class="ident" id="8197179">t</span>&nbsp;<span class="op" id="8197181">*</span><span class="ident" id="8197182">testing</span><span class="op" id="8197189">.</span><span class="ident" id="8197190">T</span><span class="op" id="8197191">)</span>&nbsp;<span class="op" id="8197193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197196">ResetProxyEnv</span><span class="op" id="8197209">(</span><span class="op" id="8197210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197213">os</span><span class="op" id="8197215">.</span><span class="ident" id="8197216">Setenv</span><span class="op" id="8197222">(</span><span class="string" id="8197223">&#34;NO_PROXY&#34;</span><span class="op" id="8197233">,</span>&nbsp;<span class="string" id="8197235">&#34;foobar.com,&nbsp;.barbaz.net&#34;</span><span class="op" id="8197260">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8197263">for</span>&nbsp;<span class="ident" id="8197267">_</span><span class="op" id="8197268">,</span>&nbsp;<span class="ident" id="8197270">test</span>&nbsp;<span class="op" id="8197275">:=</span>&nbsp;<span class="keyword" id="8197278">range</span>&nbsp;<span class="ident" id="8197284">UseProxyTests</span>&nbsp;<span class="op" id="8197298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8197302">if</span>&nbsp;<span class="ident" id="8197305">useProxy</span><span class="op" id="8197313">(</span><span class="ident" id="8197314">test</span><span class="op" id="8197318">.</span><span class="ident" id="8197319">host</span><span class="op" id="8197323">+</span><span class="string" id="8197324">&#34;:80&#34;</span><span class="op" id="8197329">)</span>&nbsp;<span class="op" id="8197331">!=</span>&nbsp;<span class="ident" id="8197334">test</span><span class="op" id="8197338">.</span><span class="ident" id="8197339">match</span>&nbsp;<span class="op" id="8197345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197350">t</span><span class="op" id="8197351">.</span><span class="ident" id="8197352">Errorf</span><span class="op" id="8197358">(</span><span class="string" id="8197359">&#34;useProxy(%v)&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8197387">,</span>&nbsp;<span class="ident" id="8197389">test</span><span class="op" id="8197393">.</span><span class="ident" id="8197394">host</span><span class="op" id="8197398">,</span>&nbsp;<span class="op" id="8197400">!</span><span class="ident" id="8197401">test</span><span class="op" id="8197405">.</span><span class="ident" id="8197406">match</span><span class="op" id="8197411">,</span>&nbsp;<span class="ident" id="8197413">test</span><span class="op" id="8197417">.</span><span class="ident" id="8197418">match</span><span class="op" id="8197423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197430">}</span><br>
<span class="lineno">45</span><span class="op" id="8197432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8197435">var</span>&nbsp;<span class="ident" id="8197439">cacheKeysTests</span>&nbsp;<span class="op" id="8197454">=</span>&nbsp;<span class="op" id="8197456">[</span><span class="op" id="8197457">]</span><span class="keyword" id="8197458">struct</span>&nbsp;<span class="op" id="8197465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197468">proxy</span>&nbsp;&nbsp;<span class="builtintype" id="8197475">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197483">scheme</span>&nbsp;<span class="builtintype" id="8197490">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197498">addr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8197505">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197513">key</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8197520">string</span><br>
<span class="lineno"></span><span class="op" id="8197527">}</span><span class="op" id="8197528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197531">{</span><span class="string" id="8197532">&#34;&#34;</span><span class="op" id="8197534">,</span>&nbsp;<span class="string" id="8197536">&#34;http&#34;</span><span class="op" id="8197542">,</span>&nbsp;<span class="string" id="8197544">&#34;foo.com&#34;</span><span class="op" id="8197553">,</span>&nbsp;<span class="string" id="8197555">&#34;|http|foo.com&#34;</span><span class="op" id="8197570">}</span><span class="op" id="8197571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197574">{</span><span class="string" id="8197575">&#34;&#34;</span><span class="op" id="8197577">,</span>&nbsp;<span class="string" id="8197579">&#34;https&#34;</span><span class="op" id="8197586">,</span>&nbsp;<span class="string" id="8197588">&#34;foo.com&#34;</span><span class="op" id="8197597">,</span>&nbsp;<span class="string" id="8197599">&#34;|https|foo.com&#34;</span><span class="op" id="8197615">}</span><span class="op" id="8197616">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197619">{</span><span class="string" id="8197620">&#34;http://foo.com&#34;</span><span class="op" id="8197636">,</span>&nbsp;<span class="string" id="8197638">&#34;http&#34;</span><span class="op" id="8197644">,</span>&nbsp;<span class="string" id="8197646">&#34;foo.com&#34;</span><span class="op" id="8197655">,</span>&nbsp;<span class="string" id="8197657">&#34;http://foo.com|http|&#34;</span><span class="op" id="8197679">}</span><span class="op" id="8197680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197683">{</span><span class="string" id="8197684">&#34;http://foo.com&#34;</span><span class="op" id="8197700">,</span>&nbsp;<span class="string" id="8197702">&#34;https&#34;</span><span class="op" id="8197709">,</span>&nbsp;<span class="string" id="8197711">&#34;foo.com&#34;</span><span class="op" id="8197720">,</span>&nbsp;<span class="string" id="8197722">&#34;http://foo.com|https|foo.com&#34;</span><span class="op" id="8197752">}</span><span class="op" id="8197753">,</span><br>
<span class="lineno"></span><span class="op" id="8197755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8197758">func</span>&nbsp;<span class="ident" id="8197763">TestCacheKeys</span><span class="op" id="8197776">(</span><span class="ident" id="8197777">t</span>&nbsp;<span class="op" id="8197779">*</span><span class="ident" id="8197780">testing</span><span class="op" id="8197787">.</span><span class="ident" id="8197788">T</span><span class="op" id="8197789">)</span>&nbsp;<span class="op" id="8197791">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8197794">for</span>&nbsp;<span class="ident" id="8197798">_</span><span class="op" id="8197799">,</span>&nbsp;<span class="ident" id="8197801">tt</span>&nbsp;<span class="op" id="8197804">:=</span>&nbsp;<span class="keyword" id="8197807">range</span>&nbsp;<span class="ident" id="8197813">cacheKeysTests</span>&nbsp;<span class="op" id="8197828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8197832">var</span>&nbsp;<span class="ident" id="8197836">proxy</span>&nbsp;<span class="op" id="8197842">*</span><span class="ident" id="8197843">url</span><span class="op" id="8197846">.</span><span class="ident" id="8197847">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8197853">if</span>&nbsp;<span class="ident" id="8197856">tt</span><span class="op" id="8197858">.</span><span class="ident" id="8197859">proxy</span>&nbsp;<span class="op" id="8197865">!=</span>&nbsp;<span class="string" id="8197868">&#34;&#34;</span>&nbsp;<span class="op" id="8197871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197876">u</span><span class="op" id="8197877">,</span>&nbsp;<span class="ident" id="8197879">err</span>&nbsp;<span class="op" id="8197883">:=</span>&nbsp;<span class="ident" id="8197886">url</span><span class="op" id="8197889">.</span><span class="ident" id="8197890">Parse</span><span class="op" id="8197895">(</span><span class="ident" id="8197896">tt</span><span class="op" id="8197898">.</span><span class="ident" id="8197899">proxy</span><span class="op" id="8197904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8197909">if</span>&nbsp;<span class="ident" id="8197912">err</span>&nbsp;<span class="op" id="8197916">!=</span>&nbsp;<span class="ident" id="8197919">nil</span>&nbsp;<span class="op" id="8197923">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197929">t</span><span class="op" id="8197930">.</span><span class="ident" id="8197931">Fatal</span><span class="op" id="8197936">(</span><span class="ident" id="8197937">err</span><span class="op" id="8197940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197950">proxy</span>&nbsp;<span class="op" id="8197956">=</span>&nbsp;<span class="ident" id="8197958">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197966">cm</span>&nbsp;<span class="op" id="8197969">:=</span>&nbsp;<span class="ident" id="8197972">connectMethod</span><span class="op" id="8197985">{</span><span class="ident" id="8197986">proxy</span><span class="op" id="8197991">,</span>&nbsp;<span class="ident" id="8197993">tt</span><span class="op" id="8197995">.</span><span class="ident" id="8197996">scheme</span><span class="op" id="8198002">,</span>&nbsp;<span class="ident" id="8198004">tt</span><span class="op" id="8198006">.</span><span class="ident" id="8198007">addr</span><span class="op" id="8198011">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8198015">if</span>&nbsp;<span class="ident" id="8198018">got</span>&nbsp;<span class="op" id="8198022">:=</span>&nbsp;<span class="ident" id="8198025">cm</span><span class="op" id="8198027">.</span><span class="ident" id="8198028">key</span><span class="op" id="8198031">(</span><span class="op" id="8198032">)</span><span class="op" id="8198033">.</span><span class="ident" id="8198034">String</span><span class="op" id="8198040">(</span><span class="op" id="8198041">)</span><span class="op" id="8198042">;</span>&nbsp;<span class="ident" id="8198044">got</span>&nbsp;<span class="op" id="8198048">!=</span>&nbsp;<span class="ident" id="8198051">tt</span><span class="op" id="8198053">.</span><span class="ident" id="8198054">key</span>&nbsp;<span class="op" id="8198058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8198063">t</span><span class="op" id="8198064">.</span><span class="ident" id="8198065">Fatalf</span><span class="op" id="8198071">(</span><span class="string" id="8198072">&#34;{%q,&nbsp;%q,&nbsp;%q}&nbsp;cache&nbsp;key&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8198110">,</span>&nbsp;<span class="ident" id="8198112">tt</span><span class="op" id="8198114">.</span><span class="ident" id="8198115">proxy</span><span class="op" id="8198120">,</span>&nbsp;<span class="ident" id="8198122">tt</span><span class="op" id="8198124">.</span><span class="ident" id="8198125">scheme</span><span class="op" id="8198131">,</span>&nbsp;<span class="ident" id="8198133">tt</span><span class="op" id="8198135">.</span><span class="ident" id="8198136">addr</span><span class="op" id="8198140">,</span>&nbsp;<span class="ident" id="8198142">got</span><span class="op" id="8198145">,</span>&nbsp;<span class="ident" id="8198147">tt</span><span class="op" id="8198149">.</span><span class="ident" id="8198150">key</span><span class="op" id="8198153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8198157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8198160">}</span><br>
<span class="lineno"></span><span class="op" id="8198162">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="8198165">func</span>&nbsp;<span class="ident" id="8198170">ResetProxyEnv</span><span class="op" id="8198183">(</span><span class="op" id="8198184">)</span>&nbsp;<span class="op" id="8198186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8198189">for</span>&nbsp;<span class="ident" id="8198193">_</span><span class="op" id="8198194">,</span>&nbsp;<span class="ident" id="8198196">v</span>&nbsp;<span class="op" id="8198198">:=</span>&nbsp;<span class="keyword" id="8198201">range</span>&nbsp;<span class="op" id="8198207">[</span><span class="op" id="8198208">]</span><span class="builtintype" id="8198209">string</span><span class="op" id="8198215">{</span><span class="string" id="8198216">&#34;HTTP_PROXY&#34;</span><span class="op" id="8198228">,</span>&nbsp;<span class="string" id="8198230">&#34;http_proxy&#34;</span><span class="op" id="8198242">,</span>&nbsp;<span class="string" id="8198244">&#34;NO_PROXY&#34;</span><span class="op" id="8198254">,</span>&nbsp;<span class="string" id="8198256">&#34;no_proxy&#34;</span><span class="op" id="8198266">}</span>&nbsp;<span class="op" id="8198268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8198272">os</span><span class="op" id="8198274">.</span><span class="ident" id="8198275">Setenv</span><span class="op" id="8198281">(</span><span class="ident" id="8198282">v</span><span class="op" id="8198283">,</span>&nbsp;<span class="string" id="8198285">&#34;&#34;</span><span class="op" id="8198287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8198290">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8198293">ResetCachedEnvironment</span><span class="op" id="8198315">(</span><span class="op" id="8198316">)</span><br>
<span class="lineno"></span><span class="op" id="8198318">}</span>
</div>
</body>
</html>
