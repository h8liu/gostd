<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4008607">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4008663">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4008717">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4008768">package</span>&nbsp;<span class="ident" id="4008776">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4008786">//&nbsp;This&nbsp;is&nbsp;a&nbsp;constant-time,&nbsp;32-bit&nbsp;implementation&nbsp;of&nbsp;P224.&nbsp;See&nbsp;FIPS&nbsp;186-3,</span><br>
<span class="lineno"></span><span class="comment" id="4008861">//&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><span class="comment" id="4008879">//</span><br>
<span class="lineno">10</span><span class="comment" id="4008882">//&nbsp;See&nbsp;http://www.imperialviolet.org/2010/12/04/ecc.html&nbsp;([1])&nbsp;for&nbsp;background.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4008962">import</span>&nbsp;<span class="op" id="4008969">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4008972">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4008983">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4008986">var</span>&nbsp;<span class="ident" id="4008990">p224</span>&nbsp;<span class="ident" id="4008995">p224Curve</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4009006">type</span>&nbsp;<span class="ident" id="4009011">p224Curve</span>&nbsp;<span class="keyword" id="4009021">struct</span>&nbsp;<span class="op" id="4009028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4009031">*</span><span class="ident" id="4009032">CurveParams</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009045">gx</span><span class="op" id="4009047">,</span>&nbsp;<span class="ident" id="4009049">gy</span><span class="op" id="4009051">,</span>&nbsp;<span class="ident" id="4009053">b</span>&nbsp;<span class="ident" id="4009055">p224FieldElement</span><br>
<span class="lineno"></span><span class="op" id="4009072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4009075">func</span>&nbsp;<span class="ident" id="4009080">initP224</span><span class="op" id="4009088">(</span><span class="op" id="4009089">)</span>&nbsp;<span class="op" id="4009091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4009094">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009128">p224</span><span class="op" id="4009132">.</span><span class="ident" id="4009133">CurveParams</span>&nbsp;<span class="op" id="4009145">=</span>&nbsp;<span class="builtinfunc" id="4009147">new</span><span class="op" id="4009150">(</span><span class="ident" id="4009151">CurveParams</span><span class="op" id="4009162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009165">p224</span><span class="op" id="4009169">.</span><span class="ident" id="4009170">P</span><span class="op" id="4009171">,</span>&nbsp;<span class="ident" id="4009173">_</span>&nbsp;<span class="op" id="4009175">=</span>&nbsp;<span class="builtinfunc" id="4009177">new</span><span class="op" id="4009180">(</span><span class="ident" id="4009181">big</span><span class="op" id="4009184">.</span><span class="ident" id="4009185">Int</span><span class="op" id="4009188">)</span><span class="op" id="4009189">.</span><span class="ident" id="4009190">SetString</span><span class="op" id="4009199">(</span><span class="string" id="4009200">&#34;26959946667150639794667015087019630673557916260026308143510066298881&#34;</span><span class="op" id="4009270">,</span>&nbsp;<span class="num" id="4009272">10</span><span class="op" id="4009274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009277">p224</span><span class="op" id="4009281">.</span><span class="ident" id="4009282">N</span><span class="op" id="4009283">,</span>&nbsp;<span class="ident" id="4009285">_</span>&nbsp;<span class="op" id="4009287">=</span>&nbsp;<span class="builtinfunc" id="4009289">new</span><span class="op" id="4009292">(</span><span class="ident" id="4009293">big</span><span class="op" id="4009296">.</span><span class="ident" id="4009297">Int</span><span class="op" id="4009300">)</span><span class="op" id="4009301">.</span><span class="ident" id="4009302">SetString</span><span class="op" id="4009311">(</span><span class="string" id="4009312">&#34;26959946667150639794667015087019625940457807714424391721682722368061&#34;</span><span class="op" id="4009382">,</span>&nbsp;<span class="num" id="4009384">10</span><span class="op" id="4009386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009389">p224</span><span class="op" id="4009393">.</span><span class="ident" id="4009394">B</span><span class="op" id="4009395">,</span>&nbsp;<span class="ident" id="4009397">_</span>&nbsp;<span class="op" id="4009399">=</span>&nbsp;<span class="builtinfunc" id="4009401">new</span><span class="op" id="4009404">(</span><span class="ident" id="4009405">big</span><span class="op" id="4009408">.</span><span class="ident" id="4009409">Int</span><span class="op" id="4009412">)</span><span class="op" id="4009413">.</span><span class="ident" id="4009414">SetString</span><span class="op" id="4009423">(</span><span class="string" id="4009424">&#34;b4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4&#34;</span><span class="op" id="4009482">,</span>&nbsp;<span class="num" id="4009484">16</span><span class="op" id="4009486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009489">p224</span><span class="op" id="4009493">.</span><span class="ident" id="4009494">Gx</span><span class="op" id="4009496">,</span>&nbsp;<span class="ident" id="4009498">_</span>&nbsp;<span class="op" id="4009500">=</span>&nbsp;<span class="builtinfunc" id="4009502">new</span><span class="op" id="4009505">(</span><span class="ident" id="4009506">big</span><span class="op" id="4009509">.</span><span class="ident" id="4009510">Int</span><span class="op" id="4009513">)</span><span class="op" id="4009514">.</span><span class="ident" id="4009515">SetString</span><span class="op" id="4009524">(</span><span class="string" id="4009525">&#34;b70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21&#34;</span><span class="op" id="4009583">,</span>&nbsp;<span class="num" id="4009585">16</span><span class="op" id="4009587">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009590">p224</span><span class="op" id="4009594">.</span><span class="ident" id="4009595">Gy</span><span class="op" id="4009597">,</span>&nbsp;<span class="ident" id="4009599">_</span>&nbsp;<span class="op" id="4009601">=</span>&nbsp;<span class="builtinfunc" id="4009603">new</span><span class="op" id="4009606">(</span><span class="ident" id="4009607">big</span><span class="op" id="4009610">.</span><span class="ident" id="4009611">Int</span><span class="op" id="4009614">)</span><span class="op" id="4009615">.</span><span class="ident" id="4009616">SetString</span><span class="op" id="4009625">(</span><span class="string" id="4009626">&#34;bd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34&#34;</span><span class="op" id="4009684">,</span>&nbsp;<span class="num" id="4009686">16</span><span class="op" id="4009688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009691">p224</span><span class="op" id="4009695">.</span><span class="ident" id="4009696">BitSize</span>&nbsp;<span class="op" id="4009704">=</span>&nbsp;<span class="num" id="4009706">224</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009712">p224FromBig</span><span class="op" id="4009723">(</span><span class="op" id="4009724">&amp;</span><span class="ident" id="4009725">p224</span><span class="op" id="4009729">.</span><span class="ident" id="4009730">gx</span><span class="op" id="4009732">,</span>&nbsp;<span class="ident" id="4009734">p224</span><span class="op" id="4009738">.</span><span class="ident" id="4009739">Gx</span><span class="op" id="4009741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009744">p224FromBig</span><span class="op" id="4009755">(</span><span class="op" id="4009756">&amp;</span><span class="ident" id="4009757">p224</span><span class="op" id="4009761">.</span><span class="ident" id="4009762">gy</span><span class="op" id="4009764">,</span>&nbsp;<span class="ident" id="4009766">p224</span><span class="op" id="4009770">.</span><span class="ident" id="4009771">Gy</span><span class="op" id="4009773">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009776">p224FromBig</span><span class="op" id="4009787">(</span><span class="op" id="4009788">&amp;</span><span class="ident" id="4009789">p224</span><span class="op" id="4009793">.</span><span class="ident" id="4009794">b</span><span class="op" id="4009795">,</span>&nbsp;<span class="ident" id="4009797">p224</span><span class="op" id="4009801">.</span><span class="ident" id="4009802">B</span><span class="op" id="4009803">)</span><br>
<span class="lineno"></span><span class="op" id="4009805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4009808">//&nbsp;P224&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-224&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2)</span><br>
<span class="lineno"></span><span class="keyword" id="4009887">func</span>&nbsp;<span class="ident" id="4009892">P224</span><span class="op" id="4009896">(</span><span class="op" id="4009897">)</span>&nbsp;<span class="ident" id="4009899">Curve</span>&nbsp;<span class="op" id="4009905">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009908">initonce</span><span class="op" id="4009916">.</span><span class="ident" id="4009917">Do</span><span class="op" id="4009919">(</span><span class="ident" id="4009920">initAll</span><span class="op" id="4009927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009930">return</span>&nbsp;<span class="ident" id="4009937">p224</span><br>
<span class="lineno"></span><span class="op" id="4009942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4009945">func</span>&nbsp;<span class="op" id="4009950">(</span><span class="ident" id="4009951">curve</span>&nbsp;<span class="ident" id="4009957">p224Curve</span><span class="op" id="4009966">)</span>&nbsp;<span class="ident" id="4009968">Params</span><span class="op" id="4009974">(</span><span class="op" id="4009975">)</span>&nbsp;<span class="op" id="4009977">*</span><span class="ident" id="4009978">CurveParams</span>&nbsp;<span class="op" id="4009990">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009993">return</span>&nbsp;<span class="ident" id="4010000">curve</span><span class="op" id="4010005">.</span><span class="ident" id="4010006">CurveParams</span><br>
<span class="lineno"></span><span class="op" id="4010018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4010021">func</span>&nbsp;<span class="op" id="4010026">(</span><span class="ident" id="4010027">curve</span>&nbsp;<span class="ident" id="4010033">p224Curve</span><span class="op" id="4010042">)</span>&nbsp;<span class="ident" id="4010044">IsOnCurve</span><span class="op" id="4010053">(</span><span class="ident" id="4010054">bigX</span><span class="op" id="4010058">,</span>&nbsp;<span class="ident" id="4010060">bigY</span>&nbsp;<span class="op" id="4010065">*</span><span class="ident" id="4010066">big</span><span class="op" id="4010069">.</span><span class="ident" id="4010070">Int</span><span class="op" id="4010073">)</span>&nbsp;<span class="builtintype" id="4010075">bool</span>&nbsp;<span class="op" id="4010080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010083">var</span>&nbsp;<span class="ident" id="4010087">x</span><span class="op" id="4010088">,</span>&nbsp;<span class="ident" id="4010090">y</span>&nbsp;<span class="ident" id="4010092">p224FieldElement</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010110">p224FromBig</span><span class="op" id="4010121">(</span><span class="op" id="4010122">&amp;</span><span class="ident" id="4010123">x</span><span class="op" id="4010124">,</span>&nbsp;<span class="ident" id="4010126">bigX</span><span class="op" id="4010130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010133">p224FromBig</span><span class="op" id="4010144">(</span><span class="op" id="4010145">&amp;</span><span class="ident" id="4010146">y</span><span class="op" id="4010147">,</span>&nbsp;<span class="ident" id="4010149">bigY</span><span class="op" id="4010153">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4010157">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010180">var</span>&nbsp;<span class="ident" id="4010184">tmp</span>&nbsp;<span class="ident" id="4010188">p224LargeFieldElement</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010211">var</span>&nbsp;<span class="ident" id="4010215">x3</span>&nbsp;<span class="ident" id="4010218">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010236">p224Square</span><span class="op" id="4010246">(</span><span class="op" id="4010247">&amp;</span><span class="ident" id="4010248">x3</span><span class="op" id="4010250">,</span>&nbsp;<span class="op" id="4010252">&amp;</span><span class="ident" id="4010253">x</span><span class="op" id="4010254">,</span>&nbsp;<span class="op" id="4010256">&amp;</span><span class="ident" id="4010257">tmp</span><span class="op" id="4010260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010263">p224Mul</span><span class="op" id="4010270">(</span><span class="op" id="4010271">&amp;</span><span class="ident" id="4010272">x3</span><span class="op" id="4010274">,</span>&nbsp;<span class="op" id="4010276">&amp;</span><span class="ident" id="4010277">x3</span><span class="op" id="4010279">,</span>&nbsp;<span class="op" id="4010281">&amp;</span><span class="ident" id="4010282">x</span><span class="op" id="4010283">,</span>&nbsp;<span class="op" id="4010285">&amp;</span><span class="ident" id="4010286">tmp</span><span class="op" id="4010289">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010293">for</span>&nbsp;<span class="ident" id="4010297">i</span>&nbsp;<span class="op" id="4010299">:=</span>&nbsp;<span class="num" id="4010302">0</span><span class="op" id="4010303">;</span>&nbsp;<span class="ident" id="4010305">i</span>&nbsp;<span class="op" id="4010307">&lt;</span>&nbsp;<span class="num" id="4010309">8</span><span class="op" id="4010310">;</span>&nbsp;<span class="ident" id="4010312">i</span><span class="op" id="4010313">++</span>&nbsp;<span class="op" id="4010316">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010320">x</span><span class="op" id="4010321">[</span><span class="ident" id="4010322">i</span><span class="op" id="4010323">]</span>&nbsp;<span class="op" id="4010325">*=</span>&nbsp;<span class="num" id="4010328">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010334">p224Sub</span><span class="op" id="4010341">(</span><span class="op" id="4010342">&amp;</span><span class="ident" id="4010343">x3</span><span class="op" id="4010345">,</span>&nbsp;<span class="op" id="4010347">&amp;</span><span class="ident" id="4010348">x3</span><span class="op" id="4010350">,</span>&nbsp;<span class="op" id="4010352">&amp;</span><span class="ident" id="4010353">x</span><span class="op" id="4010354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010357">p224Reduce</span><span class="op" id="4010367">(</span><span class="op" id="4010368">&amp;</span><span class="ident" id="4010369">x3</span><span class="op" id="4010371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010374">p224Add</span><span class="op" id="4010381">(</span><span class="op" id="4010382">&amp;</span><span class="ident" id="4010383">x3</span><span class="op" id="4010385">,</span>&nbsp;<span class="op" id="4010387">&amp;</span><span class="ident" id="4010388">x3</span><span class="op" id="4010390">,</span>&nbsp;<span class="op" id="4010392">&amp;</span><span class="ident" id="4010393">curve</span><span class="op" id="4010398">.</span><span class="ident" id="4010399">b</span><span class="op" id="4010400">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010403">p224Contract</span><span class="op" id="4010415">(</span><span class="op" id="4010416">&amp;</span><span class="ident" id="4010417">x3</span><span class="op" id="4010419">,</span>&nbsp;<span class="op" id="4010421">&amp;</span><span class="ident" id="4010422">x3</span><span class="op" id="4010424">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010428">p224Square</span><span class="op" id="4010438">(</span><span class="op" id="4010439">&amp;</span><span class="ident" id="4010440">y</span><span class="op" id="4010441">,</span>&nbsp;<span class="op" id="4010443">&amp;</span><span class="ident" id="4010444">y</span><span class="op" id="4010445">,</span>&nbsp;<span class="op" id="4010447">&amp;</span><span class="ident" id="4010448">tmp</span><span class="op" id="4010451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010454">p224Contract</span><span class="op" id="4010466">(</span><span class="op" id="4010467">&amp;</span><span class="ident" id="4010468">y</span><span class="op" id="4010469">,</span>&nbsp;<span class="op" id="4010471">&amp;</span><span class="ident" id="4010472">y</span><span class="op" id="4010473">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010477">for</span>&nbsp;<span class="ident" id="4010481">i</span>&nbsp;<span class="op" id="4010483">:=</span>&nbsp;<span class="num" id="4010486">0</span><span class="op" id="4010487">;</span>&nbsp;<span class="ident" id="4010489">i</span>&nbsp;<span class="op" id="4010491">&lt;</span>&nbsp;<span class="num" id="4010493">8</span><span class="op" id="4010494">;</span>&nbsp;<span class="ident" id="4010496">i</span><span class="op" id="4010497">++</span>&nbsp;<span class="op" id="4010500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010504">if</span>&nbsp;<span class="ident" id="4010507">y</span><span class="op" id="4010508">[</span><span class="ident" id="4010509">i</span><span class="op" id="4010510">]</span>&nbsp;<span class="op" id="4010512">!=</span>&nbsp;<span class="ident" id="4010515">x3</span><span class="op" id="4010517">[</span><span class="ident" id="4010518">i</span><span class="op" id="4010519">]</span>&nbsp;<span class="op" id="4010521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010526">return</span>&nbsp;<span class="builtintype" id="4010533">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010544">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010547">return</span>&nbsp;<span class="builtintype" id="4010554">true</span><br>
<span class="lineno"></span><span class="op" id="4010559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4010562">func</span>&nbsp;<span class="op" id="4010567">(</span><span class="ident" id="4010568">p224Curve</span><span class="op" id="4010577">)</span>&nbsp;<span class="ident" id="4010579">Add</span><span class="op" id="4010582">(</span><span class="ident" id="4010583">bigX1</span><span class="op" id="4010588">,</span>&nbsp;<span class="ident" id="4010590">bigY1</span><span class="op" id="4010595">,</span>&nbsp;<span class="ident" id="4010597">bigX2</span><span class="op" id="4010602">,</span>&nbsp;<span class="ident" id="4010604">bigY2</span>&nbsp;<span class="op" id="4010610">*</span><span class="ident" id="4010611">big</span><span class="op" id="4010614">.</span><span class="ident" id="4010615">Int</span><span class="op" id="4010618">)</span>&nbsp;<span class="op" id="4010620">(</span><span class="ident" id="4010621">x</span><span class="op" id="4010622">,</span>&nbsp;<span class="ident" id="4010624">y</span>&nbsp;<span class="op" id="4010626">*</span><span class="ident" id="4010627">big</span><span class="op" id="4010630">.</span><span class="ident" id="4010631">Int</span><span class="op" id="4010634">)</span>&nbsp;<span class="op" id="4010636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010639">var</span>&nbsp;<span class="ident" id="4010643">x1</span><span class="op" id="4010645">,</span>&nbsp;<span class="ident" id="4010647">y1</span><span class="op" id="4010649">,</span>&nbsp;<span class="ident" id="4010651">z1</span><span class="op" id="4010653">,</span>&nbsp;<span class="ident" id="4010655">x2</span><span class="op" id="4010657">,</span>&nbsp;<span class="ident" id="4010659">y2</span><span class="op" id="4010661">,</span>&nbsp;<span class="ident" id="4010663">z2</span><span class="op" id="4010665">,</span>&nbsp;<span class="ident" id="4010667">x3</span><span class="op" id="4010669">,</span>&nbsp;<span class="ident" id="4010671">y3</span><span class="op" id="4010673">,</span>&nbsp;<span class="ident" id="4010675">z3</span>&nbsp;<span class="ident" id="4010678">p224FieldElement</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010697">p224FromBig</span><span class="op" id="4010708">(</span><span class="op" id="4010709">&amp;</span><span class="ident" id="4010710">x1</span><span class="op" id="4010712">,</span>&nbsp;<span class="ident" id="4010714">bigX1</span><span class="op" id="4010719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010722">p224FromBig</span><span class="op" id="4010733">(</span><span class="op" id="4010734">&amp;</span><span class="ident" id="4010735">y1</span><span class="op" id="4010737">,</span>&nbsp;<span class="ident" id="4010739">bigY1</span><span class="op" id="4010744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010747">if</span>&nbsp;<span class="ident" id="4010750">bigX1</span><span class="op" id="4010755">.</span><span class="ident" id="4010756">Sign</span><span class="op" id="4010760">(</span><span class="op" id="4010761">)</span>&nbsp;<span class="op" id="4010763">!=</span>&nbsp;<span class="num" id="4010766">0</span>&nbsp;<span class="op" id="4010768">||</span>&nbsp;<span class="ident" id="4010771">bigY1</span><span class="op" id="4010776">.</span><span class="ident" id="4010777">Sign</span><span class="op" id="4010781">(</span><span class="op" id="4010782">)</span>&nbsp;<span class="op" id="4010784">!=</span>&nbsp;<span class="num" id="4010787">0</span>&nbsp;<span class="op" id="4010789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010793">z1</span><span class="op" id="4010795">[</span><span class="num" id="4010796">0</span><span class="op" id="4010797">]</span>&nbsp;<span class="op" id="4010799">=</span>&nbsp;<span class="num" id="4010801">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010807">p224FromBig</span><span class="op" id="4010818">(</span><span class="op" id="4010819">&amp;</span><span class="ident" id="4010820">x2</span><span class="op" id="4010822">,</span>&nbsp;<span class="ident" id="4010824">bigX2</span><span class="op" id="4010829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010832">p224FromBig</span><span class="op" id="4010843">(</span><span class="op" id="4010844">&amp;</span><span class="ident" id="4010845">y2</span><span class="op" id="4010847">,</span>&nbsp;<span class="ident" id="4010849">bigY2</span><span class="op" id="4010854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010857">if</span>&nbsp;<span class="ident" id="4010860">bigX2</span><span class="op" id="4010865">.</span><span class="ident" id="4010866">Sign</span><span class="op" id="4010870">(</span><span class="op" id="4010871">)</span>&nbsp;<span class="op" id="4010873">!=</span>&nbsp;<span class="num" id="4010876">0</span>&nbsp;<span class="op" id="4010878">||</span>&nbsp;<span class="ident" id="4010881">bigY2</span><span class="op" id="4010886">.</span><span class="ident" id="4010887">Sign</span><span class="op" id="4010891">(</span><span class="op" id="4010892">)</span>&nbsp;<span class="op" id="4010894">!=</span>&nbsp;<span class="num" id="4010897">0</span>&nbsp;<span class="op" id="4010899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010903">z2</span><span class="op" id="4010905">[</span><span class="num" id="4010906">0</span><span class="op" id="4010907">]</span>&nbsp;<span class="op" id="4010909">=</span>&nbsp;<span class="num" id="4010911">1</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010918">p224AddJacobian</span><span class="op" id="4010933">(</span><span class="op" id="4010934">&amp;</span><span class="ident" id="4010935">x3</span><span class="op" id="4010937">,</span>&nbsp;<span class="op" id="4010939">&amp;</span><span class="ident" id="4010940">y3</span><span class="op" id="4010942">,</span>&nbsp;<span class="op" id="4010944">&amp;</span><span class="ident" id="4010945">z3</span><span class="op" id="4010947">,</span>&nbsp;<span class="op" id="4010949">&amp;</span><span class="ident" id="4010950">x1</span><span class="op" id="4010952">,</span>&nbsp;<span class="op" id="4010954">&amp;</span><span class="ident" id="4010955">y1</span><span class="op" id="4010957">,</span>&nbsp;<span class="op" id="4010959">&amp;</span><span class="ident" id="4010960">z1</span><span class="op" id="4010962">,</span>&nbsp;<span class="op" id="4010964">&amp;</span><span class="ident" id="4010965">x2</span><span class="op" id="4010967">,</span>&nbsp;<span class="op" id="4010969">&amp;</span><span class="ident" id="4010970">y2</span><span class="op" id="4010972">,</span>&nbsp;<span class="op" id="4010974">&amp;</span><span class="ident" id="4010975">z2</span><span class="op" id="4010977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010980">return</span>&nbsp;<span class="ident" id="4010987">p224ToAffine</span><span class="op" id="4010999">(</span><span class="op" id="4011000">&amp;</span><span class="ident" id="4011001">x3</span><span class="op" id="4011003">,</span>&nbsp;<span class="op" id="4011005">&amp;</span><span class="ident" id="4011006">y3</span><span class="op" id="4011008">,</span>&nbsp;<span class="op" id="4011010">&amp;</span><span class="ident" id="4011011">z3</span><span class="op" id="4011013">)</span><br>
<span class="lineno"></span><span class="op" id="4011015">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4011018">func</span>&nbsp;<span class="op" id="4011023">(</span><span class="ident" id="4011024">p224Curve</span><span class="op" id="4011033">)</span>&nbsp;<span class="ident" id="4011035">Double</span><span class="op" id="4011041">(</span><span class="ident" id="4011042">bigX1</span><span class="op" id="4011047">,</span>&nbsp;<span class="ident" id="4011049">bigY1</span>&nbsp;<span class="op" id="4011055">*</span><span class="ident" id="4011056">big</span><span class="op" id="4011059">.</span><span class="ident" id="4011060">Int</span><span class="op" id="4011063">)</span>&nbsp;<span class="op" id="4011065">(</span><span class="ident" id="4011066">x</span><span class="op" id="4011067">,</span>&nbsp;<span class="ident" id="4011069">y</span>&nbsp;<span class="op" id="4011071">*</span><span class="ident" id="4011072">big</span><span class="op" id="4011075">.</span><span class="ident" id="4011076">Int</span><span class="op" id="4011079">)</span>&nbsp;<span class="op" id="4011081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011084">var</span>&nbsp;<span class="ident" id="4011088">x1</span><span class="op" id="4011090">,</span>&nbsp;<span class="ident" id="4011092">y1</span><span class="op" id="4011094">,</span>&nbsp;<span class="ident" id="4011096">z1</span><span class="op" id="4011098">,</span>&nbsp;<span class="ident" id="4011100">x2</span><span class="op" id="4011102">,</span>&nbsp;<span class="ident" id="4011104">y2</span><span class="op" id="4011106">,</span>&nbsp;<span class="ident" id="4011108">z2</span>&nbsp;<span class="ident" id="4011111">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011130">p224FromBig</span><span class="op" id="4011141">(</span><span class="op" id="4011142">&amp;</span><span class="ident" id="4011143">x1</span><span class="op" id="4011145">,</span>&nbsp;<span class="ident" id="4011147">bigX1</span><span class="op" id="4011152">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011155">p224FromBig</span><span class="op" id="4011166">(</span><span class="op" id="4011167">&amp;</span><span class="ident" id="4011168">y1</span><span class="op" id="4011170">,</span>&nbsp;<span class="ident" id="4011172">bigY1</span><span class="op" id="4011177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011180">z1</span><span class="op" id="4011182">[</span><span class="num" id="4011183">0</span><span class="op" id="4011184">]</span>&nbsp;<span class="op" id="4011186">=</span>&nbsp;<span class="num" id="4011188">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011192">p224DoubleJacobian</span><span class="op" id="4011210">(</span><span class="op" id="4011211">&amp;</span><span class="ident" id="4011212">x2</span><span class="op" id="4011214">,</span>&nbsp;<span class="op" id="4011216">&amp;</span><span class="ident" id="4011217">y2</span><span class="op" id="4011219">,</span>&nbsp;<span class="op" id="4011221">&amp;</span><span class="ident" id="4011222">z2</span><span class="op" id="4011224">,</span>&nbsp;<span class="op" id="4011226">&amp;</span><span class="ident" id="4011227">x1</span><span class="op" id="4011229">,</span>&nbsp;<span class="op" id="4011231">&amp;</span><span class="ident" id="4011232">y1</span><span class="op" id="4011234">,</span>&nbsp;<span class="op" id="4011236">&amp;</span><span class="ident" id="4011237">z1</span><span class="op" id="4011239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011242">return</span>&nbsp;<span class="ident" id="4011249">p224ToAffine</span><span class="op" id="4011261">(</span><span class="op" id="4011262">&amp;</span><span class="ident" id="4011263">x2</span><span class="op" id="4011265">,</span>&nbsp;<span class="op" id="4011267">&amp;</span><span class="ident" id="4011268">y2</span><span class="op" id="4011270">,</span>&nbsp;<span class="op" id="4011272">&amp;</span><span class="ident" id="4011273">z2</span><span class="op" id="4011275">)</span><br>
<span class="lineno">105</span><span class="op" id="4011277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4011280">func</span>&nbsp;<span class="op" id="4011285">(</span><span class="ident" id="4011286">p224Curve</span><span class="op" id="4011295">)</span>&nbsp;<span class="ident" id="4011297">ScalarMult</span><span class="op" id="4011307">(</span><span class="ident" id="4011308">bigX1</span><span class="op" id="4011313">,</span>&nbsp;<span class="ident" id="4011315">bigY1</span>&nbsp;<span class="op" id="4011321">*</span><span class="ident" id="4011322">big</span><span class="op" id="4011325">.</span><span class="ident" id="4011326">Int</span><span class="op" id="4011329">,</span>&nbsp;<span class="ident" id="4011331">scalar</span>&nbsp;<span class="op" id="4011338">[</span><span class="op" id="4011339">]</span><span class="builtintype" id="4011340">byte</span><span class="op" id="4011344">)</span>&nbsp;<span class="op" id="4011346">(</span><span class="ident" id="4011347">x</span><span class="op" id="4011348">,</span>&nbsp;<span class="ident" id="4011350">y</span>&nbsp;<span class="op" id="4011352">*</span><span class="ident" id="4011353">big</span><span class="op" id="4011356">.</span><span class="ident" id="4011357">Int</span><span class="op" id="4011360">)</span>&nbsp;<span class="op" id="4011362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011365">var</span>&nbsp;<span class="ident" id="4011369">x1</span><span class="op" id="4011371">,</span>&nbsp;<span class="ident" id="4011373">y1</span><span class="op" id="4011375">,</span>&nbsp;<span class="ident" id="4011377">z1</span><span class="op" id="4011379">,</span>&nbsp;<span class="ident" id="4011381">x2</span><span class="op" id="4011383">,</span>&nbsp;<span class="ident" id="4011385">y2</span><span class="op" id="4011387">,</span>&nbsp;<span class="ident" id="4011389">z2</span>&nbsp;<span class="ident" id="4011392">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011411">p224FromBig</span><span class="op" id="4011422">(</span><span class="op" id="4011423">&amp;</span><span class="ident" id="4011424">x1</span><span class="op" id="4011426">,</span>&nbsp;<span class="ident" id="4011428">bigX1</span><span class="op" id="4011433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011436">p224FromBig</span><span class="op" id="4011447">(</span><span class="op" id="4011448">&amp;</span><span class="ident" id="4011449">y1</span><span class="op" id="4011451">,</span>&nbsp;<span class="ident" id="4011453">bigY1</span><span class="op" id="4011458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011461">z1</span><span class="op" id="4011463">[</span><span class="num" id="4011464">0</span><span class="op" id="4011465">]</span>&nbsp;<span class="op" id="4011467">=</span>&nbsp;<span class="num" id="4011469">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011473">p224ScalarMult</span><span class="op" id="4011487">(</span><span class="op" id="4011488">&amp;</span><span class="ident" id="4011489">x2</span><span class="op" id="4011491">,</span>&nbsp;<span class="op" id="4011493">&amp;</span><span class="ident" id="4011494">y2</span><span class="op" id="4011496">,</span>&nbsp;<span class="op" id="4011498">&amp;</span><span class="ident" id="4011499">z2</span><span class="op" id="4011501">,</span>&nbsp;<span class="op" id="4011503">&amp;</span><span class="ident" id="4011504">x1</span><span class="op" id="4011506">,</span>&nbsp;<span class="op" id="4011508">&amp;</span><span class="ident" id="4011509">y1</span><span class="op" id="4011511">,</span>&nbsp;<span class="op" id="4011513">&amp;</span><span class="ident" id="4011514">z1</span><span class="op" id="4011516">,</span>&nbsp;<span class="ident" id="4011518">scalar</span><span class="op" id="4011524">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011527">return</span>&nbsp;<span class="ident" id="4011534">p224ToAffine</span><span class="op" id="4011546">(</span><span class="op" id="4011547">&amp;</span><span class="ident" id="4011548">x2</span><span class="op" id="4011550">,</span>&nbsp;<span class="op" id="4011552">&amp;</span><span class="ident" id="4011553">y2</span><span class="op" id="4011555">,</span>&nbsp;<span class="op" id="4011557">&amp;</span><span class="ident" id="4011558">z2</span><span class="op" id="4011560">)</span><br>
<span class="lineno"></span><span class="op" id="4011562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4011565">func</span>&nbsp;<span class="op" id="4011570">(</span><span class="ident" id="4011571">curve</span>&nbsp;<span class="ident" id="4011577">p224Curve</span><span class="op" id="4011586">)</span>&nbsp;<span class="ident" id="4011588">ScalarBaseMult</span><span class="op" id="4011602">(</span><span class="ident" id="4011603">scalar</span>&nbsp;<span class="op" id="4011610">[</span><span class="op" id="4011611">]</span><span class="builtintype" id="4011612">byte</span><span class="op" id="4011616">)</span>&nbsp;<span class="op" id="4011618">(</span><span class="ident" id="4011619">x</span><span class="op" id="4011620">,</span>&nbsp;<span class="ident" id="4011622">y</span>&nbsp;<span class="op" id="4011624">*</span><span class="ident" id="4011625">big</span><span class="op" id="4011628">.</span><span class="ident" id="4011629">Int</span><span class="op" id="4011632">)</span>&nbsp;<span class="op" id="4011634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011637">var</span>&nbsp;<span class="ident" id="4011641">z1</span><span class="op" id="4011643">,</span>&nbsp;<span class="ident" id="4011645">x2</span><span class="op" id="4011647">,</span>&nbsp;<span class="ident" id="4011649">y2</span><span class="op" id="4011651">,</span>&nbsp;<span class="ident" id="4011653">z2</span>&nbsp;<span class="ident" id="4011656">p224FieldElement</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011675">z1</span><span class="op" id="4011677">[</span><span class="num" id="4011678">0</span><span class="op" id="4011679">]</span>&nbsp;<span class="op" id="4011681">=</span>&nbsp;<span class="num" id="4011683">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011686">p224ScalarMult</span><span class="op" id="4011700">(</span><span class="op" id="4011701">&amp;</span><span class="ident" id="4011702">x2</span><span class="op" id="4011704">,</span>&nbsp;<span class="op" id="4011706">&amp;</span><span class="ident" id="4011707">y2</span><span class="op" id="4011709">,</span>&nbsp;<span class="op" id="4011711">&amp;</span><span class="ident" id="4011712">z2</span><span class="op" id="4011714">,</span>&nbsp;<span class="op" id="4011716">&amp;</span><span class="ident" id="4011717">curve</span><span class="op" id="4011722">.</span><span class="ident" id="4011723">gx</span><span class="op" id="4011725">,</span>&nbsp;<span class="op" id="4011727">&amp;</span><span class="ident" id="4011728">curve</span><span class="op" id="4011733">.</span><span class="ident" id="4011734">gy</span><span class="op" id="4011736">,</span>&nbsp;<span class="op" id="4011738">&amp;</span><span class="ident" id="4011739">z1</span><span class="op" id="4011741">,</span>&nbsp;<span class="ident" id="4011743">scalar</span><span class="op" id="4011749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011752">return</span>&nbsp;<span class="ident" id="4011759">p224ToAffine</span><span class="op" id="4011771">(</span><span class="op" id="4011772">&amp;</span><span class="ident" id="4011773">x2</span><span class="op" id="4011775">,</span>&nbsp;<span class="op" id="4011777">&amp;</span><span class="ident" id="4011778">y2</span><span class="op" id="4011780">,</span>&nbsp;<span class="op" id="4011782">&amp;</span><span class="ident" id="4011783">z2</span><span class="op" id="4011785">)</span><br>
<span class="lineno"></span><span class="op" id="4011787">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4011790">//&nbsp;Field&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4011818">//</span><br>
<span class="lineno"></span><span class="comment" id="4011821">//&nbsp;The&nbsp;field&nbsp;that&nbsp;we&#39;re&nbsp;dealing&nbsp;with&nbsp;is&nbsp;ℤ/pℤ&nbsp;where&nbsp;p&nbsp;=&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;+&nbsp;1.</span><br>
<span class="lineno"></span><span class="comment" id="4011900">//</span><br>
<span class="lineno">130</span><span class="comment" id="4011903">//&nbsp;Field&nbsp;elements&nbsp;are&nbsp;represented&nbsp;by&nbsp;a&nbsp;FieldElement,&nbsp;which&nbsp;is&nbsp;a&nbsp;typedef&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4011981">//&nbsp;array&nbsp;of&nbsp;8&nbsp;uint32&#39;s.&nbsp;The&nbsp;value&nbsp;of&nbsp;a&nbsp;FieldElement,&nbsp;a,&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="4012041">//&nbsp;&nbsp;&nbsp;a[0]&nbsp;+&nbsp;2**28·a[1]&nbsp;+&nbsp;2**56·a[1]&nbsp;+&nbsp;...&nbsp;+&nbsp;2**196·a[7]</span><br>
<span class="lineno"></span><span class="comment" id="4012100">//</span><br>
<span class="lineno"></span><span class="comment" id="4012103">//&nbsp;Using&nbsp;28-bit&nbsp;limbs&nbsp;means&nbsp;that&nbsp;there&#39;s&nbsp;only&nbsp;4&nbsp;bits&nbsp;of&nbsp;headroom,&nbsp;which&nbsp;is&nbsp;less</span><br>
<span class="lineno">135</span><span class="comment" id="4012183">//&nbsp;than&nbsp;we&nbsp;would&nbsp;really&nbsp;like.&nbsp;But&nbsp;it&nbsp;has&nbsp;the&nbsp;useful&nbsp;feature&nbsp;that&nbsp;we&nbsp;hit&nbsp;2**224</span><br>
<span class="lineno"></span><span class="comment" id="4012262">//&nbsp;exactly,&nbsp;making&nbsp;the&nbsp;reflections&nbsp;during&nbsp;a&nbsp;reduce&nbsp;much&nbsp;nicer.</span><br>
<span class="lineno"></span><span class="keyword" id="4012325">type</span>&nbsp;<span class="ident" id="4012330">p224FieldElement</span>&nbsp;<span class="op" id="4012347">[</span><span class="num" id="4012348">8</span><span class="op" id="4012349">]</span><span class="builtintype" id="4012350">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4012358">//&nbsp;p224P&nbsp;is&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;field,&nbsp;represented&nbsp;as&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno">140</span><span class="keyword" id="4012429">var</span>&nbsp;<span class="ident" id="4012433">p224P</span>&nbsp;<span class="op" id="4012439">=</span>&nbsp;<span class="op" id="4012441">[</span><span class="num" id="4012442">8</span><span class="op" id="4012443">]</span><span class="builtintype" id="4012444">uint32</span><span class="op" id="4012450">{</span><span class="num" id="4012451">1</span><span class="op" id="4012452">,</span>&nbsp;<span class="num" id="4012454">0</span><span class="op" id="4012455">,</span>&nbsp;<span class="num" id="4012457">0</span><span class="op" id="4012458">,</span>&nbsp;<span class="num" id="4012460">0xffff000</span><span class="op" id="4012469">,</span>&nbsp;<span class="num" id="4012471">0xfffffff</span><span class="op" id="4012480">,</span>&nbsp;<span class="num" id="4012482">0xfffffff</span><span class="op" id="4012491">,</span>&nbsp;<span class="num" id="4012493">0xfffffff</span><span class="op" id="4012502">,</span>&nbsp;<span class="num" id="4012504">0xfffffff</span><span class="op" id="4012513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4012516">//&nbsp;p224IsZero&nbsp;returns&nbsp;1&nbsp;if&nbsp;a&nbsp;==&nbsp;0&nbsp;mod&nbsp;p&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="4012573">//</span><br>
<span class="lineno"></span><span class="comment" id="4012576">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">145</span><span class="keyword" id="4012592">func</span>&nbsp;<span class="ident" id="4012597">p224IsZero</span><span class="op" id="4012607">(</span><span class="ident" id="4012608">a</span>&nbsp;<span class="op" id="4012610">*</span><span class="ident" id="4012611">p224FieldElement</span><span class="op" id="4012627">)</span>&nbsp;<span class="builtintype" id="4012629">uint32</span>&nbsp;<span class="op" id="4012636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4012639">//&nbsp;Since&nbsp;a&nbsp;p224FieldElement&nbsp;contains&nbsp;224&nbsp;bits&nbsp;there&nbsp;are&nbsp;two&nbsp;possible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4012709">//&nbsp;representations&nbsp;of&nbsp;0:&nbsp;0&nbsp;and&nbsp;p.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012744">var</span>&nbsp;<span class="ident" id="4012748">minimal</span>&nbsp;<span class="ident" id="4012756">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012774">p224Contract</span><span class="op" id="4012786">(</span><span class="op" id="4012787">&amp;</span><span class="ident" id="4012788">minimal</span><span class="op" id="4012795">,</span>&nbsp;<span class="ident" id="4012797">a</span><span class="op" id="4012798">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012802">var</span>&nbsp;<span class="ident" id="4012806">isZero</span><span class="op" id="4012812">,</span>&nbsp;<span class="ident" id="4012814">isP</span>&nbsp;<span class="builtintype" id="4012818">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012826">for</span>&nbsp;<span class="ident" id="4012830">i</span><span class="op" id="4012831">,</span>&nbsp;<span class="ident" id="4012833">v</span>&nbsp;<span class="op" id="4012835">:=</span>&nbsp;<span class="keyword" id="4012838">range</span>&nbsp;<span class="ident" id="4012844">minimal</span>&nbsp;<span class="op" id="4012852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012856">isZero</span>&nbsp;<span class="op" id="4012863">|=</span>&nbsp;<span class="ident" id="4012866">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012870">isP</span>&nbsp;<span class="op" id="4012874">|=</span>&nbsp;<span class="ident" id="4012877">v</span>&nbsp;<span class="op" id="4012879">-</span>&nbsp;<span class="ident" id="4012881">p224P</span><span class="op" id="4012886">[</span><span class="ident" id="4012887">i</span><span class="op" id="4012888">]</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4012891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4012895">//&nbsp;If&nbsp;either&nbsp;isZero&nbsp;or&nbsp;isP&nbsp;is&nbsp;0,&nbsp;then&nbsp;we&nbsp;should&nbsp;return&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012954">isZero</span>&nbsp;<span class="op" id="4012961">|=</span>&nbsp;<span class="ident" id="4012964">isZero</span>&nbsp;<span class="op" id="4012971">&gt;&gt;</span>&nbsp;<span class="num" id="4012974">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012978">isZero</span>&nbsp;<span class="op" id="4012985">|=</span>&nbsp;<span class="ident" id="4012988">isZero</span>&nbsp;<span class="op" id="4012995">&gt;&gt;</span>&nbsp;<span class="num" id="4012998">8</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013001">isZero</span>&nbsp;<span class="op" id="4013008">|=</span>&nbsp;<span class="ident" id="4013011">isZero</span>&nbsp;<span class="op" id="4013018">&gt;&gt;</span>&nbsp;<span class="num" id="4013021">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013024">isZero</span>&nbsp;<span class="op" id="4013031">|=</span>&nbsp;<span class="ident" id="4013034">isZero</span>&nbsp;<span class="op" id="4013041">&gt;&gt;</span>&nbsp;<span class="num" id="4013044">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013047">isZero</span>&nbsp;<span class="op" id="4013054">|=</span>&nbsp;<span class="ident" id="4013057">isZero</span>&nbsp;<span class="op" id="4013064">&gt;&gt;</span>&nbsp;<span class="num" id="4013067">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013071">isP</span>&nbsp;<span class="op" id="4013075">|=</span>&nbsp;<span class="ident" id="4013078">isP</span>&nbsp;<span class="op" id="4013082">&gt;&gt;</span>&nbsp;<span class="num" id="4013085">16</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013089">isP</span>&nbsp;<span class="op" id="4013093">|=</span>&nbsp;<span class="ident" id="4013096">isP</span>&nbsp;<span class="op" id="4013100">&gt;&gt;</span>&nbsp;<span class="num" id="4013103">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013106">isP</span>&nbsp;<span class="op" id="4013110">|=</span>&nbsp;<span class="ident" id="4013113">isP</span>&nbsp;<span class="op" id="4013117">&gt;&gt;</span>&nbsp;<span class="num" id="4013120">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013123">isP</span>&nbsp;<span class="op" id="4013127">|=</span>&nbsp;<span class="ident" id="4013130">isP</span>&nbsp;<span class="op" id="4013134">&gt;&gt;</span>&nbsp;<span class="num" id="4013137">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013140">isP</span>&nbsp;<span class="op" id="4013144">|=</span>&nbsp;<span class="ident" id="4013147">isP</span>&nbsp;<span class="op" id="4013151">&gt;&gt;</span>&nbsp;<span class="num" id="4013154">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4013158">//&nbsp;For&nbsp;isZero&nbsp;and&nbsp;isP,&nbsp;the&nbsp;LSB&nbsp;is&nbsp;0&nbsp;iff&nbsp;all&nbsp;the&nbsp;bits&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013222">result</span>&nbsp;<span class="op" id="4013229">:=</span>&nbsp;<span class="ident" id="4013232">isZero</span>&nbsp;<span class="op" id="4013239">&amp;</span>&nbsp;<span class="ident" id="4013241">isP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013246">result</span>&nbsp;<span class="op" id="4013253">=</span>&nbsp;<span class="op" id="4013255">(</span><span class="op" id="4013256">^</span><span class="ident" id="4013257">result</span><span class="op" id="4013263">)</span>&nbsp;<span class="op" id="4013265">&amp;</span>&nbsp;<span class="num" id="4013267">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013271">return</span>&nbsp;<span class="ident" id="4013278">result</span><br>
<span class="lineno">175</span><span class="op" id="4013285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4013288">//&nbsp;p224Add&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b</span><br>
<span class="lineno"></span><span class="comment" id="4013319">//</span><br>
<span class="lineno"></span><span class="comment" id="4013322">//&nbsp;a[i]&nbsp;+&nbsp;b[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno">180</span><span class="keyword" id="4013345">func</span>&nbsp;<span class="ident" id="4013350">p224Add</span><span class="op" id="4013357">(</span><span class="ident" id="4013358">out</span><span class="op" id="4013361">,</span>&nbsp;<span class="ident" id="4013363">a</span><span class="op" id="4013364">,</span>&nbsp;<span class="ident" id="4013366">b</span>&nbsp;<span class="op" id="4013368">*</span><span class="ident" id="4013369">p224FieldElement</span><span class="op" id="4013385">)</span>&nbsp;<span class="op" id="4013387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013390">for</span>&nbsp;<span class="ident" id="4013394">i</span>&nbsp;<span class="op" id="4013396">:=</span>&nbsp;<span class="num" id="4013399">0</span><span class="op" id="4013400">;</span>&nbsp;<span class="ident" id="4013402">i</span>&nbsp;<span class="op" id="4013404">&lt;</span>&nbsp;<span class="num" id="4013406">8</span><span class="op" id="4013407">;</span>&nbsp;<span class="ident" id="4013409">i</span><span class="op" id="4013410">++</span>&nbsp;<span class="op" id="4013413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013417">out</span><span class="op" id="4013420">[</span><span class="ident" id="4013421">i</span><span class="op" id="4013422">]</span>&nbsp;<span class="op" id="4013424">=</span>&nbsp;<span class="ident" id="4013426">a</span><span class="op" id="4013427">[</span><span class="ident" id="4013428">i</span><span class="op" id="4013429">]</span>&nbsp;<span class="op" id="4013431">+</span>&nbsp;<span class="ident" id="4013433">b</span><span class="op" id="4013434">[</span><span class="ident" id="4013435">i</span><span class="op" id="4013436">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4013439">}</span><br>
<span class="lineno"></span><span class="op" id="4013441">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="4013444">const</span>&nbsp;<span class="ident" id="4013450">two31p3</span>&nbsp;<span class="op" id="4013458">=</span>&nbsp;<span class="num" id="4013460">1</span><span class="op" id="4013461">&lt;&lt;</span><span class="num" id="4013463">31</span>&nbsp;<span class="op" id="4013466">+</span>&nbsp;<span class="num" id="4013468">1</span><span class="op" id="4013469">&lt;&lt;</span><span class="num" id="4013471">3</span><br>
<span class="lineno"></span><span class="keyword" id="4013473">const</span>&nbsp;<span class="ident" id="4013479">two31m3</span>&nbsp;<span class="op" id="4013487">=</span>&nbsp;<span class="num" id="4013489">1</span><span class="op" id="4013490">&lt;&lt;</span><span class="num" id="4013492">31</span>&nbsp;<span class="op" id="4013495">-</span>&nbsp;<span class="num" id="4013497">1</span><span class="op" id="4013498">&lt;&lt;</span><span class="num" id="4013500">3</span><br>
<span class="lineno"></span><span class="keyword" id="4013502">const</span>&nbsp;<span class="ident" id="4013508">two31m15m3</span>&nbsp;<span class="op" id="4013519">=</span>&nbsp;<span class="num" id="4013521">1</span><span class="op" id="4013522">&lt;&lt;</span><span class="num" id="4013524">31</span>&nbsp;<span class="op" id="4013527">-</span>&nbsp;<span class="num" id="4013529">1</span><span class="op" id="4013530">&lt;&lt;</span><span class="num" id="4013532">15</span>&nbsp;<span class="op" id="4013535">-</span>&nbsp;<span class="num" id="4013537">1</span><span class="op" id="4013538">&lt;&lt;</span><span class="num" id="4013540">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4013543">//&nbsp;p224ZeroModP31&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;31&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs&nbsp;so&nbsp;that&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="4013620">//&nbsp;subtract&nbsp;smaller&nbsp;amounts&nbsp;without&nbsp;underflow.&nbsp;See&nbsp;the&nbsp;section&nbsp;&#34;Subtraction&#34;&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4013700">//&nbsp;[1]&nbsp;for&nbsp;reasoning.</span><br>
<span class="lineno"></span><span class="keyword" id="4013722">var</span>&nbsp;<span class="ident" id="4013726">p224ZeroModP31</span>&nbsp;<span class="op" id="4013741">=</span>&nbsp;<span class="op" id="4013743">[</span><span class="op" id="4013744">]</span><span class="builtintype" id="4013745">uint32</span><span class="op" id="4013751">{</span><span class="ident" id="4013752">two31p3</span><span class="op" id="4013759">,</span>&nbsp;<span class="ident" id="4013761">two31m3</span><span class="op" id="4013768">,</span>&nbsp;<span class="ident" id="4013770">two31m3</span><span class="op" id="4013777">,</span>&nbsp;<span class="ident" id="4013779">two31m15m3</span><span class="op" id="4013789">,</span>&nbsp;<span class="ident" id="4013791">two31m3</span><span class="op" id="4013798">,</span>&nbsp;<span class="ident" id="4013800">two31m3</span><span class="op" id="4013807">,</span>&nbsp;<span class="ident" id="4013809">two31m3</span><span class="op" id="4013816">,</span>&nbsp;<span class="ident" id="4013818">two31m3</span><span class="op" id="4013825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="4013828">//&nbsp;p224Sub&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a-b</span><br>
<span class="lineno"></span><span class="comment" id="4013859">//</span><br>
<span class="lineno"></span><span class="comment" id="4013862">//&nbsp;a[i],&nbsp;b[i]&nbsp;&lt;&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4013884">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno"></span><span class="keyword" id="4013902">func</span>&nbsp;<span class="ident" id="4013907">p224Sub</span><span class="op" id="4013914">(</span><span class="ident" id="4013915">out</span><span class="op" id="4013918">,</span>&nbsp;<span class="ident" id="4013920">a</span><span class="op" id="4013921">,</span>&nbsp;<span class="ident" id="4013923">b</span>&nbsp;<span class="op" id="4013925">*</span><span class="ident" id="4013926">p224FieldElement</span><span class="op" id="4013942">)</span>&nbsp;<span class="op" id="4013944">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013947">for</span>&nbsp;<span class="ident" id="4013951">i</span>&nbsp;<span class="op" id="4013953">:=</span>&nbsp;<span class="num" id="4013956">0</span><span class="op" id="4013957">;</span>&nbsp;<span class="ident" id="4013959">i</span>&nbsp;<span class="op" id="4013961">&lt;</span>&nbsp;<span class="num" id="4013963">8</span><span class="op" id="4013964">;</span>&nbsp;<span class="ident" id="4013966">i</span><span class="op" id="4013967">++</span>&nbsp;<span class="op" id="4013970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013974">out</span><span class="op" id="4013977">[</span><span class="ident" id="4013978">i</span><span class="op" id="4013979">]</span>&nbsp;<span class="op" id="4013981">=</span>&nbsp;<span class="ident" id="4013983">a</span><span class="op" id="4013984">[</span><span class="ident" id="4013985">i</span><span class="op" id="4013986">]</span>&nbsp;<span class="op" id="4013988">+</span>&nbsp;<span class="ident" id="4013990">p224ZeroModP31</span><span class="op" id="4014004">[</span><span class="ident" id="4014005">i</span><span class="op" id="4014006">]</span>&nbsp;<span class="op" id="4014008">-</span>&nbsp;<span class="ident" id="4014010">b</span><span class="op" id="4014011">[</span><span class="ident" id="4014012">i</span><span class="op" id="4014013">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4014016">}</span><br>
<span class="lineno"></span><span class="op" id="4014018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="4014021">//&nbsp;LargeFieldElement&nbsp;also&nbsp;represents&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;field.&nbsp;The&nbsp;limbs&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4014097">//&nbsp;still&nbsp;spaced&nbsp;28-bits&nbsp;apart&nbsp;and&nbsp;in&nbsp;little-endian&nbsp;order.&nbsp;So&nbsp;the&nbsp;limbs&nbsp;are&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4014175">//&nbsp;0,&nbsp;28,&nbsp;56,&nbsp;...,&nbsp;392&nbsp;bits,&nbsp;each&nbsp;64-bits&nbsp;wide.</span><br>
<span class="lineno"></span><span class="keyword" id="4014223">type</span>&nbsp;<span class="ident" id="4014228">p224LargeFieldElement</span>&nbsp;<span class="op" id="4014250">[</span><span class="num" id="4014251">15</span><span class="op" id="4014253">]</span><span class="ident" id="4014254">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="4014262">const</span>&nbsp;<span class="ident" id="4014268">two63p35</span>&nbsp;<span class="op" id="4014277">=</span>&nbsp;<span class="num" id="4014279">1</span><span class="op" id="4014280">&lt;&lt;</span><span class="num" id="4014282">63</span>&nbsp;<span class="op" id="4014285">+</span>&nbsp;<span class="num" id="4014287">1</span><span class="op" id="4014288">&lt;&lt;</span><span class="num" id="4014290">35</span><br>
<span class="lineno"></span><span class="keyword" id="4014293">const</span>&nbsp;<span class="ident" id="4014299">two63m35</span>&nbsp;<span class="op" id="4014308">=</span>&nbsp;<span class="num" id="4014310">1</span><span class="op" id="4014311">&lt;&lt;</span><span class="num" id="4014313">63</span>&nbsp;<span class="op" id="4014316">-</span>&nbsp;<span class="num" id="4014318">1</span><span class="op" id="4014319">&lt;&lt;</span><span class="num" id="4014321">35</span><br>
<span class="lineno"></span><span class="keyword" id="4014324">const</span>&nbsp;<span class="ident" id="4014330">two63m35m19</span>&nbsp;<span class="op" id="4014342">=</span>&nbsp;<span class="num" id="4014344">1</span><span class="op" id="4014345">&lt;&lt;</span><span class="num" id="4014347">63</span>&nbsp;<span class="op" id="4014350">-</span>&nbsp;<span class="num" id="4014352">1</span><span class="op" id="4014353">&lt;&lt;</span><span class="num" id="4014355">35</span>&nbsp;<span class="op" id="4014358">-</span>&nbsp;<span class="num" id="4014360">1</span><span class="op" id="4014361">&lt;&lt;</span><span class="num" id="4014363">19</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4014367">//&nbsp;p224ZeroModP63&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;63&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs.&nbsp;See&nbsp;the&nbsp;section</span><br>
<span class="lineno">215</span><span class="comment" id="4014446">//&nbsp;&#34;Subtraction&#34;&nbsp;in&nbsp;[1]&nbsp;for&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="4014479">var</span>&nbsp;<span class="ident" id="4014483">p224ZeroModP63</span>&nbsp;<span class="op" id="4014498">=</span>&nbsp;<span class="op" id="4014500">[</span><span class="num" id="4014501">8</span><span class="op" id="4014502">]</span><span class="ident" id="4014503">uint64</span><span class="op" id="4014509">{</span><span class="ident" id="4014510">two63p35</span><span class="op" id="4014518">,</span>&nbsp;<span class="ident" id="4014520">two63m35</span><span class="op" id="4014528">,</span>&nbsp;<span class="ident" id="4014530">two63m35</span><span class="op" id="4014538">,</span>&nbsp;<span class="ident" id="4014540">two63m35</span><span class="op" id="4014548">,</span>&nbsp;<span class="ident" id="4014550">two63m35m19</span><span class="op" id="4014561">,</span>&nbsp;<span class="ident" id="4014563">two63m35</span><span class="op" id="4014571">,</span>&nbsp;<span class="ident" id="4014573">two63m35</span><span class="op" id="4014581">,</span>&nbsp;<span class="ident" id="4014583">two63m35</span><span class="op" id="4014591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4014594">const</span>&nbsp;<span class="ident" id="4014600">bottom12Bits</span>&nbsp;<span class="op" id="4014613">=</span>&nbsp;<span class="num" id="4014615">0xfff</span><br>
<span class="lineno"></span><span class="keyword" id="4014621">const</span>&nbsp;<span class="ident" id="4014627">bottom28Bits</span>&nbsp;<span class="op" id="4014640">=</span>&nbsp;<span class="num" id="4014642">0xfffffff</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="4014653">//&nbsp;p224Mul&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*b</span><br>
<span class="lineno"></span><span class="comment" id="4014684">//</span><br>
<span class="lineno"></span><span class="comment" id="4014687">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29,&nbsp;b[i]&nbsp;&lt;&nbsp;2**30&nbsp;(or&nbsp;vice&nbsp;versa)</span><br>
<span class="lineno"></span><span class="comment" id="4014733">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">225</span><span class="keyword" id="4014751">func</span>&nbsp;<span class="ident" id="4014756">p224Mul</span><span class="op" id="4014763">(</span><span class="ident" id="4014764">out</span><span class="op" id="4014767">,</span>&nbsp;<span class="ident" id="4014769">a</span><span class="op" id="4014770">,</span>&nbsp;<span class="ident" id="4014772">b</span>&nbsp;<span class="op" id="4014774">*</span><span class="ident" id="4014775">p224FieldElement</span><span class="op" id="4014791">,</span>&nbsp;<span class="ident" id="4014793">tmp</span>&nbsp;<span class="op" id="4014797">*</span><span class="ident" id="4014798">p224LargeFieldElement</span><span class="op" id="4014819">)</span>&nbsp;<span class="op" id="4014821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014824">for</span>&nbsp;<span class="ident" id="4014828">i</span>&nbsp;<span class="op" id="4014830">:=</span>&nbsp;<span class="num" id="4014833">0</span><span class="op" id="4014834">;</span>&nbsp;<span class="ident" id="4014836">i</span>&nbsp;<span class="op" id="4014838">&lt;</span>&nbsp;<span class="num" id="4014840">15</span><span class="op" id="4014842">;</span>&nbsp;<span class="ident" id="4014844">i</span><span class="op" id="4014845">++</span>&nbsp;<span class="op" id="4014848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014852">tmp</span><span class="op" id="4014855">[</span><span class="ident" id="4014856">i</span><span class="op" id="4014857">]</span>&nbsp;<span class="op" id="4014859">=</span>&nbsp;<span class="num" id="4014861">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4014864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014868">for</span>&nbsp;<span class="ident" id="4014872">i</span>&nbsp;<span class="op" id="4014874">:=</span>&nbsp;<span class="num" id="4014877">0</span><span class="op" id="4014878">;</span>&nbsp;<span class="ident" id="4014880">i</span>&nbsp;<span class="op" id="4014882">&lt;</span>&nbsp;<span class="num" id="4014884">8</span><span class="op" id="4014885">;</span>&nbsp;<span class="ident" id="4014887">i</span><span class="op" id="4014888">++</span>&nbsp;<span class="op" id="4014891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014895">for</span>&nbsp;<span class="ident" id="4014899">j</span>&nbsp;<span class="op" id="4014901">:=</span>&nbsp;<span class="num" id="4014904">0</span><span class="op" id="4014905">;</span>&nbsp;<span class="ident" id="4014907">j</span>&nbsp;<span class="op" id="4014909">&lt;</span>&nbsp;<span class="num" id="4014911">8</span><span class="op" id="4014912">;</span>&nbsp;<span class="ident" id="4014914">j</span><span class="op" id="4014915">++</span>&nbsp;<span class="op" id="4014918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014923">tmp</span><span class="op" id="4014926">[</span><span class="ident" id="4014927">i</span><span class="op" id="4014928">+</span><span class="ident" id="4014929">j</span><span class="op" id="4014930">]</span>&nbsp;<span class="op" id="4014932">+=</span>&nbsp;<span class="ident" id="4014935">uint64</span><span class="op" id="4014941">(</span><span class="ident" id="4014942">a</span><span class="op" id="4014943">[</span><span class="ident" id="4014944">i</span><span class="op" id="4014945">]</span><span class="op" id="4014946">)</span>&nbsp;<span class="op" id="4014948">*</span>&nbsp;<span class="ident" id="4014950">uint64</span><span class="op" id="4014956">(</span><span class="ident" id="4014957">b</span><span class="op" id="4014958">[</span><span class="ident" id="4014959">j</span><span class="op" id="4014960">]</span><span class="op" id="4014961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4014965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4014968">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014972">p224ReduceLarge</span><span class="op" id="4014987">(</span><span class="ident" id="4014988">out</span><span class="op" id="4014991">,</span>&nbsp;<span class="ident" id="4014993">tmp</span><span class="op" id="4014996">)</span><br>
<span class="lineno"></span><span class="op" id="4014998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4015001">//&nbsp;Square&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*a</span><br>
<span class="lineno">240</span><span class="comment" id="4015031">//</span><br>
<span class="lineno"></span><span class="comment" id="4015034">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4015050">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="keyword" id="4015068">func</span>&nbsp;<span class="ident" id="4015073">p224Square</span><span class="op" id="4015083">(</span><span class="ident" id="4015084">out</span><span class="op" id="4015087">,</span>&nbsp;<span class="ident" id="4015089">a</span>&nbsp;<span class="op" id="4015091">*</span><span class="ident" id="4015092">p224FieldElement</span><span class="op" id="4015108">,</span>&nbsp;<span class="ident" id="4015110">tmp</span>&nbsp;<span class="op" id="4015114">*</span><span class="ident" id="4015115">p224LargeFieldElement</span><span class="op" id="4015136">)</span>&nbsp;<span class="op" id="4015138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015141">for</span>&nbsp;<span class="ident" id="4015145">i</span>&nbsp;<span class="op" id="4015147">:=</span>&nbsp;<span class="num" id="4015150">0</span><span class="op" id="4015151">;</span>&nbsp;<span class="ident" id="4015153">i</span>&nbsp;<span class="op" id="4015155">&lt;</span>&nbsp;<span class="num" id="4015157">15</span><span class="op" id="4015159">;</span>&nbsp;<span class="ident" id="4015161">i</span><span class="op" id="4015162">++</span>&nbsp;<span class="op" id="4015165">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015169">tmp</span><span class="op" id="4015172">[</span><span class="ident" id="4015173">i</span><span class="op" id="4015174">]</span>&nbsp;<span class="op" id="4015176">=</span>&nbsp;<span class="num" id="4015178">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015185">for</span>&nbsp;<span class="ident" id="4015189">i</span>&nbsp;<span class="op" id="4015191">:=</span>&nbsp;<span class="num" id="4015194">0</span><span class="op" id="4015195">;</span>&nbsp;<span class="ident" id="4015197">i</span>&nbsp;<span class="op" id="4015199">&lt;</span>&nbsp;<span class="num" id="4015201">8</span><span class="op" id="4015202">;</span>&nbsp;<span class="ident" id="4015204">i</span><span class="op" id="4015205">++</span>&nbsp;<span class="op" id="4015208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015212">for</span>&nbsp;<span class="ident" id="4015216">j</span>&nbsp;<span class="op" id="4015218">:=</span>&nbsp;<span class="num" id="4015221">0</span><span class="op" id="4015222">;</span>&nbsp;<span class="ident" id="4015224">j</span>&nbsp;<span class="op" id="4015226">&lt;=</span>&nbsp;<span class="ident" id="4015229">i</span><span class="op" id="4015230">;</span>&nbsp;<span class="ident" id="4015232">j</span><span class="op" id="4015233">++</span>&nbsp;<span class="op" id="4015236">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015241">r</span>&nbsp;<span class="op" id="4015243">:=</span>&nbsp;<span class="ident" id="4015246">uint64</span><span class="op" id="4015252">(</span><span class="ident" id="4015253">a</span><span class="op" id="4015254">[</span><span class="ident" id="4015255">i</span><span class="op" id="4015256">]</span><span class="op" id="4015257">)</span>&nbsp;<span class="op" id="4015259">*</span>&nbsp;<span class="ident" id="4015261">uint64</span><span class="op" id="4015267">(</span><span class="ident" id="4015268">a</span><span class="op" id="4015269">[</span><span class="ident" id="4015270">j</span><span class="op" id="4015271">]</span><span class="op" id="4015272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015277">if</span>&nbsp;<span class="ident" id="4015280">i</span>&nbsp;<span class="op" id="4015282">==</span>&nbsp;<span class="ident" id="4015285">j</span>&nbsp;<span class="op" id="4015287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015293">tmp</span><span class="op" id="4015296">[</span><span class="ident" id="4015297">i</span><span class="op" id="4015298">+</span><span class="ident" id="4015299">j</span><span class="op" id="4015300">]</span>&nbsp;<span class="op" id="4015302">+=</span>&nbsp;<span class="ident" id="4015305">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015310">}</span>&nbsp;<span class="keyword" id="4015312">else</span>&nbsp;<span class="op" id="4015317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015323">tmp</span><span class="op" id="4015326">[</span><span class="ident" id="4015327">i</span><span class="op" id="4015328">+</span><span class="ident" id="4015329">j</span><span class="op" id="4015330">]</span>&nbsp;<span class="op" id="4015332">+=</span>&nbsp;<span class="ident" id="4015335">r</span>&nbsp;<span class="op" id="4015337">&lt;&lt;</span>&nbsp;<span class="num" id="4015340">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015356">p224ReduceLarge</span><span class="op" id="4015371">(</span><span class="ident" id="4015372">out</span><span class="op" id="4015375">,</span>&nbsp;<span class="ident" id="4015377">tmp</span><span class="op" id="4015380">)</span><br>
<span class="lineno">260</span><span class="op" id="4015382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4015385">//&nbsp;ReduceLarge&nbsp;converts&nbsp;a&nbsp;p224LargeFieldElement&nbsp;to&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno"></span><span class="comment" id="4015456">//</span><br>
<span class="lineno"></span><span class="comment" id="4015459">//&nbsp;in[i]&nbsp;&lt;&nbsp;2**62</span><br>
<span class="lineno">265</span><span class="keyword" id="4015476">func</span>&nbsp;<span class="ident" id="4015481">p224ReduceLarge</span><span class="op" id="4015496">(</span><span class="ident" id="4015497">out</span>&nbsp;<span class="op" id="4015501">*</span><span class="ident" id="4015502">p224FieldElement</span><span class="op" id="4015518">,</span>&nbsp;<span class="ident" id="4015520">in</span>&nbsp;<span class="op" id="4015523">*</span><span class="ident" id="4015524">p224LargeFieldElement</span><span class="op" id="4015545">)</span>&nbsp;<span class="op" id="4015547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015550">for</span>&nbsp;<span class="ident" id="4015554">i</span>&nbsp;<span class="op" id="4015556">:=</span>&nbsp;<span class="num" id="4015559">0</span><span class="op" id="4015560">;</span>&nbsp;<span class="ident" id="4015562">i</span>&nbsp;<span class="op" id="4015564">&lt;</span>&nbsp;<span class="num" id="4015566">8</span><span class="op" id="4015567">;</span>&nbsp;<span class="ident" id="4015569">i</span><span class="op" id="4015570">++</span>&nbsp;<span class="op" id="4015573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015577">in</span><span class="op" id="4015579">[</span><span class="ident" id="4015580">i</span><span class="op" id="4015581">]</span>&nbsp;<span class="op" id="4015583">+=</span>&nbsp;<span class="ident" id="4015586">p224ZeroModP63</span><span class="op" id="4015600">[</span><span class="ident" id="4015601">i</span><span class="op" id="4015602">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4015609">//&nbsp;Eliminate&nbsp;the&nbsp;coefficients&nbsp;at&nbsp;2**224&nbsp;and&nbsp;greater.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015663">for</span>&nbsp;<span class="ident" id="4015667">i</span>&nbsp;<span class="op" id="4015669">:=</span>&nbsp;<span class="num" id="4015672">14</span><span class="op" id="4015674">;</span>&nbsp;<span class="ident" id="4015676">i</span>&nbsp;<span class="op" id="4015678">&gt;=</span>&nbsp;<span class="num" id="4015681">8</span><span class="op" id="4015682">;</span>&nbsp;<span class="ident" id="4015684">i</span><span class="op" id="4015685">--</span>&nbsp;<span class="op" id="4015688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015692">in</span><span class="op" id="4015694">[</span><span class="ident" id="4015695">i</span><span class="op" id="4015696">-</span><span class="num" id="4015697">8</span><span class="op" id="4015698">]</span>&nbsp;<span class="op" id="4015700">-=</span>&nbsp;<span class="ident" id="4015703">in</span><span class="op" id="4015705">[</span><span class="ident" id="4015706">i</span><span class="op" id="4015707">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015711">in</span><span class="op" id="4015713">[</span><span class="ident" id="4015714">i</span><span class="op" id="4015715">-</span><span class="num" id="4015716">5</span><span class="op" id="4015717">]</span>&nbsp;<span class="op" id="4015719">+=</span>&nbsp;<span class="op" id="4015722">(</span><span class="ident" id="4015723">in</span><span class="op" id="4015725">[</span><span class="ident" id="4015726">i</span><span class="op" id="4015727">]</span>&nbsp;<span class="op" id="4015729">&amp;</span>&nbsp;<span class="num" id="4015731">0xffff</span><span class="op" id="4015737">)</span>&nbsp;<span class="op" id="4015739">&lt;&lt;</span>&nbsp;<span class="num" id="4015742">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015747">in</span><span class="op" id="4015749">[</span><span class="ident" id="4015750">i</span><span class="op" id="4015751">-</span><span class="num" id="4015752">4</span><span class="op" id="4015753">]</span>&nbsp;<span class="op" id="4015755">+=</span>&nbsp;<span class="ident" id="4015758">in</span><span class="op" id="4015760">[</span><span class="ident" id="4015761">i</span><span class="op" id="4015762">]</span>&nbsp;<span class="op" id="4015764">&gt;&gt;</span>&nbsp;<span class="num" id="4015767">16</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015774">in</span><span class="op" id="4015776">[</span><span class="num" id="4015777">8</span><span class="op" id="4015778">]</span>&nbsp;<span class="op" id="4015780">=</span>&nbsp;<span class="num" id="4015782">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4015785">//&nbsp;in[0..8]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4015807">//&nbsp;As&nbsp;the&nbsp;values&nbsp;become&nbsp;small&nbsp;enough,&nbsp;we&nbsp;start&nbsp;to&nbsp;store&nbsp;them&nbsp;in&nbsp;|out|</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4015878">//&nbsp;and&nbsp;use&nbsp;32-bit&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015909">for</span>&nbsp;<span class="ident" id="4015913">i</span>&nbsp;<span class="op" id="4015915">:=</span>&nbsp;<span class="num" id="4015918">1</span><span class="op" id="4015919">;</span>&nbsp;<span class="ident" id="4015921">i</span>&nbsp;<span class="op" id="4015923">&lt;</span>&nbsp;<span class="num" id="4015925">8</span><span class="op" id="4015926">;</span>&nbsp;<span class="ident" id="4015928">i</span><span class="op" id="4015929">++</span>&nbsp;<span class="op" id="4015932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015936">in</span><span class="op" id="4015938">[</span><span class="ident" id="4015939">i</span><span class="op" id="4015940">+</span><span class="num" id="4015941">1</span><span class="op" id="4015942">]</span>&nbsp;<span class="op" id="4015944">+=</span>&nbsp;<span class="ident" id="4015947">in</span><span class="op" id="4015949">[</span><span class="ident" id="4015950">i</span><span class="op" id="4015951">]</span>&nbsp;<span class="op" id="4015953">&gt;&gt;</span>&nbsp;<span class="num" id="4015956">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015961">out</span><span class="op" id="4015964">[</span><span class="ident" id="4015965">i</span><span class="op" id="4015966">]</span>&nbsp;<span class="op" id="4015968">=</span>&nbsp;<span class="builtintype" id="4015970">uint32</span><span class="op" id="4015976">(</span><span class="ident" id="4015977">in</span><span class="op" id="4015979">[</span><span class="ident" id="4015980">i</span><span class="op" id="4015981">]</span>&nbsp;<span class="op" id="4015983">&amp;</span>&nbsp;<span class="ident" id="4015985">bottom28Bits</span><span class="op" id="4015997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4016000">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016003">in</span><span class="op" id="4016005">[</span><span class="num" id="4016006">0</span><span class="op" id="4016007">]</span>&nbsp;<span class="op" id="4016009">-=</span>&nbsp;<span class="ident" id="4016012">in</span><span class="op" id="4016014">[</span><span class="num" id="4016015">8</span><span class="op" id="4016016">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016019">out</span><span class="op" id="4016022">[</span><span class="num" id="4016023">3</span><span class="op" id="4016024">]</span>&nbsp;<span class="op" id="4016026">+=</span>&nbsp;<span class="builtintype" id="4016029">uint32</span><span class="op" id="4016035">(</span><span class="ident" id="4016036">in</span><span class="op" id="4016038">[</span><span class="num" id="4016039">8</span><span class="op" id="4016040">]</span><span class="op" id="4016041">&amp;</span><span class="num" id="4016042">0xffff</span><span class="op" id="4016048">)</span>&nbsp;<span class="op" id="4016050">&lt;&lt;</span>&nbsp;<span class="num" id="4016053">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016057">out</span><span class="op" id="4016060">[</span><span class="num" id="4016061">4</span><span class="op" id="4016062">]</span>&nbsp;<span class="op" id="4016064">+=</span>&nbsp;<span class="builtintype" id="4016067">uint32</span><span class="op" id="4016073">(</span><span class="ident" id="4016074">in</span><span class="op" id="4016076">[</span><span class="num" id="4016077">8</span><span class="op" id="4016078">]</span>&nbsp;<span class="op" id="4016080">&gt;&gt;</span>&nbsp;<span class="num" id="4016083">16</span><span class="op" id="4016085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016088">//&nbsp;in[0]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016106">//&nbsp;out[3]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016125">//&nbsp;out[4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016144">//&nbsp;out[1,2,5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016171">out</span><span class="op" id="4016174">[</span><span class="num" id="4016175">0</span><span class="op" id="4016176">]</span>&nbsp;<span class="op" id="4016178">=</span>&nbsp;<span class="builtintype" id="4016180">uint32</span><span class="op" id="4016186">(</span><span class="ident" id="4016187">in</span><span class="op" id="4016189">[</span><span class="num" id="4016190">0</span><span class="op" id="4016191">]</span>&nbsp;<span class="op" id="4016193">&amp;</span>&nbsp;<span class="ident" id="4016195">bottom28Bits</span><span class="op" id="4016207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016210">out</span><span class="op" id="4016213">[</span><span class="num" id="4016214">1</span><span class="op" id="4016215">]</span>&nbsp;<span class="op" id="4016217">+=</span>&nbsp;<span class="builtintype" id="4016220">uint32</span><span class="op" id="4016226">(</span><span class="op" id="4016227">(</span><span class="ident" id="4016228">in</span><span class="op" id="4016230">[</span><span class="num" id="4016231">0</span><span class="op" id="4016232">]</span>&nbsp;<span class="op" id="4016234">&gt;&gt;</span>&nbsp;<span class="num" id="4016237">28</span><span class="op" id="4016239">)</span>&nbsp;<span class="op" id="4016241">&amp;</span>&nbsp;<span class="ident" id="4016243">bottom28Bits</span><span class="op" id="4016255">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016258">out</span><span class="op" id="4016261">[</span><span class="num" id="4016262">2</span><span class="op" id="4016263">]</span>&nbsp;<span class="op" id="4016265">+=</span>&nbsp;<span class="builtintype" id="4016268">uint32</span><span class="op" id="4016274">(</span><span class="ident" id="4016275">in</span><span class="op" id="4016277">[</span><span class="num" id="4016278">0</span><span class="op" id="4016279">]</span>&nbsp;<span class="op" id="4016281">&gt;&gt;</span>&nbsp;<span class="num" id="4016284">56</span><span class="op" id="4016286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016289">//&nbsp;out[0]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016308">//&nbsp;out[1..4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016330">//&nbsp;out[5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="op" id="4016351">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="4016354">//&nbsp;Reduce&nbsp;reduces&nbsp;the&nbsp;coefficients&nbsp;of&nbsp;a&nbsp;to&nbsp;smaller&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="comment" id="4016413">//</span><br>
<span class="lineno"></span><span class="comment" id="4016416">//&nbsp;On&nbsp;entry:&nbsp;a[i]&nbsp;&lt;&nbsp;2**31&nbsp;+&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4016450">//&nbsp;On&nbsp;exit:&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">305</span><span class="keyword" id="4016475">func</span>&nbsp;<span class="ident" id="4016480">p224Reduce</span><span class="op" id="4016490">(</span><span class="ident" id="4016491">a</span>&nbsp;<span class="op" id="4016493">*</span><span class="ident" id="4016494">p224FieldElement</span><span class="op" id="4016510">)</span>&nbsp;<span class="op" id="4016512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4016515">for</span>&nbsp;<span class="ident" id="4016519">i</span>&nbsp;<span class="op" id="4016521">:=</span>&nbsp;<span class="num" id="4016524">0</span><span class="op" id="4016525">;</span>&nbsp;<span class="ident" id="4016527">i</span>&nbsp;<span class="op" id="4016529">&lt;</span>&nbsp;<span class="num" id="4016531">7</span><span class="op" id="4016532">;</span>&nbsp;<span class="ident" id="4016534">i</span><span class="op" id="4016535">++</span>&nbsp;<span class="op" id="4016538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016542">a</span><span class="op" id="4016543">[</span><span class="ident" id="4016544">i</span><span class="op" id="4016545">+</span><span class="num" id="4016546">1</span><span class="op" id="4016547">]</span>&nbsp;<span class="op" id="4016549">+=</span>&nbsp;<span class="ident" id="4016552">a</span><span class="op" id="4016553">[</span><span class="ident" id="4016554">i</span><span class="op" id="4016555">]</span>&nbsp;<span class="op" id="4016557">&gt;&gt;</span>&nbsp;<span class="num" id="4016560">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016565">a</span><span class="op" id="4016566">[</span><span class="ident" id="4016567">i</span><span class="op" id="4016568">]</span>&nbsp;<span class="op" id="4016570">&amp;=</span>&nbsp;<span class="ident" id="4016573">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4016587">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016590">top</span>&nbsp;<span class="op" id="4016594">:=</span>&nbsp;<span class="ident" id="4016597">a</span><span class="op" id="4016598">[</span><span class="num" id="4016599">7</span><span class="op" id="4016600">]</span>&nbsp;<span class="op" id="4016602">&gt;&gt;</span>&nbsp;<span class="num" id="4016605">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016609">a</span><span class="op" id="4016610">[</span><span class="num" id="4016611">7</span><span class="op" id="4016612">]</span>&nbsp;<span class="op" id="4016614">&amp;=</span>&nbsp;<span class="ident" id="4016617">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016632">//&nbsp;top&nbsp;&lt;&nbsp;2**4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016647">mask</span>&nbsp;<span class="op" id="4016652">:=</span>&nbsp;<span class="ident" id="4016655">top</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016660">mask</span>&nbsp;<span class="op" id="4016665">|=</span>&nbsp;<span class="ident" id="4016668">mask</span>&nbsp;<span class="op" id="4016673">&gt;&gt;</span>&nbsp;<span class="num" id="4016676">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016679">mask</span>&nbsp;<span class="op" id="4016684">|=</span>&nbsp;<span class="ident" id="4016687">mask</span>&nbsp;<span class="op" id="4016692">&gt;&gt;</span>&nbsp;<span class="num" id="4016695">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016698">mask</span>&nbsp;<span class="op" id="4016703">&lt;&lt;=</span>&nbsp;<span class="num" id="4016707">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016711">mask</span>&nbsp;<span class="op" id="4016716">=</span>&nbsp;<span class="builtintype" id="4016718">uint32</span><span class="op" id="4016724">(</span><span class="builtintype" id="4016725">int32</span><span class="op" id="4016730">(</span><span class="ident" id="4016731">mask</span><span class="op" id="4016735">)</span>&nbsp;<span class="op" id="4016737">&gt;&gt;</span>&nbsp;<span class="num" id="4016740">31</span><span class="op" id="4016742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016745">//&nbsp;Mask&nbsp;is&nbsp;all&nbsp;ones&nbsp;if&nbsp;top&nbsp;!=&nbsp;0,&nbsp;all&nbsp;zero&nbsp;otherwise</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016799">a</span><span class="op" id="4016800">[</span><span class="num" id="4016801">0</span><span class="op" id="4016802">]</span>&nbsp;<span class="op" id="4016804">-=</span>&nbsp;<span class="ident" id="4016807">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016812">a</span><span class="op" id="4016813">[</span><span class="num" id="4016814">3</span><span class="op" id="4016815">]</span>&nbsp;<span class="op" id="4016817">+=</span>&nbsp;<span class="ident" id="4016820">top</span>&nbsp;<span class="op" id="4016824">&lt;&lt;</span>&nbsp;<span class="num" id="4016827">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016832">//&nbsp;We&nbsp;may&nbsp;have&nbsp;just&nbsp;made&nbsp;a[0]&nbsp;negative&nbsp;but,&nbsp;if&nbsp;we&nbsp;did,&nbsp;then&nbsp;we&nbsp;must</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016901">//&nbsp;have&nbsp;added&nbsp;something&nbsp;to&nbsp;a[3],&nbsp;this&nbsp;it&#39;s&nbsp;&gt;&nbsp;2**12.&nbsp;Therefore&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4016971">//&nbsp;carry&nbsp;down&nbsp;to&nbsp;a[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4016995">a</span><span class="op" id="4016996">[</span><span class="num" id="4016997">3</span><span class="op" id="4016998">]</span>&nbsp;<span class="op" id="4017000">-=</span>&nbsp;<span class="num" id="4017003">1</span>&nbsp;<span class="op" id="4017005">&amp;</span>&nbsp;<span class="ident" id="4017007">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017013">a</span><span class="op" id="4017014">[</span><span class="num" id="4017015">2</span><span class="op" id="4017016">]</span>&nbsp;<span class="op" id="4017018">+=</span>&nbsp;<span class="ident" id="4017021">mask</span>&nbsp;<span class="op" id="4017026">&amp;</span>&nbsp;<span class="op" id="4017028">(</span><span class="num" id="4017029">1</span><span class="op" id="4017030">&lt;&lt;</span><span class="num" id="4017032">28</span>&nbsp;<span class="op" id="4017035">-</span>&nbsp;<span class="num" id="4017037">1</span><span class="op" id="4017038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017041">a</span><span class="op" id="4017042">[</span><span class="num" id="4017043">1</span><span class="op" id="4017044">]</span>&nbsp;<span class="op" id="4017046">+=</span>&nbsp;<span class="ident" id="4017049">mask</span>&nbsp;<span class="op" id="4017054">&amp;</span>&nbsp;<span class="op" id="4017056">(</span><span class="num" id="4017057">1</span><span class="op" id="4017058">&lt;&lt;</span><span class="num" id="4017060">28</span>&nbsp;<span class="op" id="4017063">-</span>&nbsp;<span class="num" id="4017065">1</span><span class="op" id="4017066">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017069">a</span><span class="op" id="4017070">[</span><span class="num" id="4017071">0</span><span class="op" id="4017072">]</span>&nbsp;<span class="op" id="4017074">+=</span>&nbsp;<span class="ident" id="4017077">mask</span>&nbsp;<span class="op" id="4017082">&amp;</span>&nbsp;<span class="op" id="4017084">(</span><span class="num" id="4017085">1</span>&nbsp;<span class="op" id="4017087">&lt;&lt;</span>&nbsp;<span class="num" id="4017090">28</span><span class="op" id="4017092">)</span><br>
<span class="lineno"></span><span class="op" id="4017094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4017097">//&nbsp;p224Invert&nbsp;calculates&nbsp;*out&nbsp;=&nbsp;in**-1&nbsp;by&nbsp;computing&nbsp;in**(2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1),</span><br>
<span class="lineno"></span><span class="comment" id="4017175">//&nbsp;i.e.&nbsp;Fermat&#39;s&nbsp;little&nbsp;theorem.</span><br>
<span class="lineno">335</span><span class="keyword" id="4017208">func</span>&nbsp;<span class="ident" id="4017213">p224Invert</span><span class="op" id="4017223">(</span><span class="ident" id="4017224">out</span><span class="op" id="4017227">,</span>&nbsp;<span class="ident" id="4017229">in</span>&nbsp;<span class="op" id="4017232">*</span><span class="ident" id="4017233">p224FieldElement</span><span class="op" id="4017249">)</span>&nbsp;<span class="op" id="4017251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017254">var</span>&nbsp;<span class="ident" id="4017258">f1</span><span class="op" id="4017260">,</span>&nbsp;<span class="ident" id="4017262">f2</span><span class="op" id="4017264">,</span>&nbsp;<span class="ident" id="4017266">f3</span><span class="op" id="4017268">,</span>&nbsp;<span class="ident" id="4017270">f4</span>&nbsp;<span class="ident" id="4017273">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017291">var</span>&nbsp;<span class="ident" id="4017295">c</span>&nbsp;<span class="ident" id="4017297">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017321">p224Square</span><span class="op" id="4017331">(</span><span class="op" id="4017332">&amp;</span><span class="ident" id="4017333">f1</span><span class="op" id="4017335">,</span>&nbsp;<span class="ident" id="4017337">in</span><span class="op" id="4017339">,</span>&nbsp;<span class="op" id="4017341">&amp;</span><span class="ident" id="4017342">c</span><span class="op" id="4017343">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4017348">//&nbsp;2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017354">p224Mul</span><span class="op" id="4017361">(</span><span class="op" id="4017362">&amp;</span><span class="ident" id="4017363">f1</span><span class="op" id="4017365">,</span>&nbsp;<span class="op" id="4017367">&amp;</span><span class="ident" id="4017368">f1</span><span class="op" id="4017370">,</span>&nbsp;<span class="ident" id="4017372">in</span><span class="op" id="4017374">,</span>&nbsp;<span class="op" id="4017376">&amp;</span><span class="ident" id="4017377">c</span><span class="op" id="4017378">)</span>&nbsp;&nbsp;<span class="comment" id="4017381">//&nbsp;2**2&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017394">p224Square</span><span class="op" id="4017404">(</span><span class="op" id="4017405">&amp;</span><span class="ident" id="4017406">f1</span><span class="op" id="4017408">,</span>&nbsp;<span class="op" id="4017410">&amp;</span><span class="ident" id="4017411">f1</span><span class="op" id="4017413">,</span>&nbsp;<span class="op" id="4017415">&amp;</span><span class="ident" id="4017416">c</span><span class="op" id="4017417">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4017421">//&nbsp;2**3&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017434">p224Mul</span><span class="op" id="4017441">(</span><span class="op" id="4017442">&amp;</span><span class="ident" id="4017443">f1</span><span class="op" id="4017445">,</span>&nbsp;<span class="op" id="4017447">&amp;</span><span class="ident" id="4017448">f1</span><span class="op" id="4017450">,</span>&nbsp;<span class="ident" id="4017452">in</span><span class="op" id="4017454">,</span>&nbsp;<span class="op" id="4017456">&amp;</span><span class="ident" id="4017457">c</span><span class="op" id="4017458">)</span>&nbsp;&nbsp;<span class="comment" id="4017461">//&nbsp;2**3&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017474">p224Square</span><span class="op" id="4017484">(</span><span class="op" id="4017485">&amp;</span><span class="ident" id="4017486">f2</span><span class="op" id="4017488">,</span>&nbsp;<span class="op" id="4017490">&amp;</span><span class="ident" id="4017491">f1</span><span class="op" id="4017493">,</span>&nbsp;<span class="op" id="4017495">&amp;</span><span class="ident" id="4017496">c</span><span class="op" id="4017497">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4017501">//&nbsp;2**4&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017514">p224Square</span><span class="op" id="4017524">(</span><span class="op" id="4017525">&amp;</span><span class="ident" id="4017526">f2</span><span class="op" id="4017528">,</span>&nbsp;<span class="op" id="4017530">&amp;</span><span class="ident" id="4017531">f2</span><span class="op" id="4017533">,</span>&nbsp;<span class="op" id="4017535">&amp;</span><span class="ident" id="4017536">c</span><span class="op" id="4017537">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4017541">//&nbsp;2**5&nbsp;-&nbsp;4</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017554">p224Square</span><span class="op" id="4017564">(</span><span class="op" id="4017565">&amp;</span><span class="ident" id="4017566">f2</span><span class="op" id="4017568">,</span>&nbsp;<span class="op" id="4017570">&amp;</span><span class="ident" id="4017571">f2</span><span class="op" id="4017573">,</span>&nbsp;<span class="op" id="4017575">&amp;</span><span class="ident" id="4017576">c</span><span class="op" id="4017577">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4017581">//&nbsp;2**6&nbsp;-&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017594">p224Mul</span><span class="op" id="4017601">(</span><span class="op" id="4017602">&amp;</span><span class="ident" id="4017603">f1</span><span class="op" id="4017605">,</span>&nbsp;<span class="op" id="4017607">&amp;</span><span class="ident" id="4017608">f1</span><span class="op" id="4017610">,</span>&nbsp;<span class="op" id="4017612">&amp;</span><span class="ident" id="4017613">f2</span><span class="op" id="4017615">,</span>&nbsp;<span class="op" id="4017617">&amp;</span><span class="ident" id="4017618">c</span><span class="op" id="4017619">)</span>&nbsp;<span class="comment" id="4017621">//&nbsp;2**6&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017634">p224Square</span><span class="op" id="4017644">(</span><span class="op" id="4017645">&amp;</span><span class="ident" id="4017646">f2</span><span class="op" id="4017648">,</span>&nbsp;<span class="op" id="4017650">&amp;</span><span class="ident" id="4017651">f1</span><span class="op" id="4017653">,</span>&nbsp;<span class="op" id="4017655">&amp;</span><span class="ident" id="4017656">c</span><span class="op" id="4017657">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4017661">//&nbsp;2**7&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017674">for</span>&nbsp;<span class="ident" id="4017678">i</span>&nbsp;<span class="op" id="4017680">:=</span>&nbsp;<span class="num" id="4017683">0</span><span class="op" id="4017684">;</span>&nbsp;<span class="ident" id="4017686">i</span>&nbsp;<span class="op" id="4017688">&lt;</span>&nbsp;<span class="num" id="4017690">5</span><span class="op" id="4017691">;</span>&nbsp;<span class="ident" id="4017693">i</span><span class="op" id="4017694">++</span>&nbsp;<span class="op" id="4017697">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4017701">//&nbsp;2**12&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017719">p224Square</span><span class="op" id="4017729">(</span><span class="op" id="4017730">&amp;</span><span class="ident" id="4017731">f2</span><span class="op" id="4017733">,</span>&nbsp;<span class="op" id="4017735">&amp;</span><span class="ident" id="4017736">f2</span><span class="op" id="4017738">,</span>&nbsp;<span class="op" id="4017740">&amp;</span><span class="ident" id="4017741">c</span><span class="op" id="4017742">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017748">p224Mul</span><span class="op" id="4017755">(</span><span class="op" id="4017756">&amp;</span><span class="ident" id="4017757">f2</span><span class="op" id="4017759">,</span>&nbsp;<span class="op" id="4017761">&amp;</span><span class="ident" id="4017762">f2</span><span class="op" id="4017764">,</span>&nbsp;<span class="op" id="4017766">&amp;</span><span class="ident" id="4017767">f1</span><span class="op" id="4017769">,</span>&nbsp;<span class="op" id="4017771">&amp;</span><span class="ident" id="4017772">c</span><span class="op" id="4017773">)</span>&nbsp;<span class="comment" id="4017775">//&nbsp;2**12&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017789">p224Square</span><span class="op" id="4017799">(</span><span class="op" id="4017800">&amp;</span><span class="ident" id="4017801">f3</span><span class="op" id="4017803">,</span>&nbsp;<span class="op" id="4017805">&amp;</span><span class="ident" id="4017806">f2</span><span class="op" id="4017808">,</span>&nbsp;<span class="op" id="4017810">&amp;</span><span class="ident" id="4017811">c</span><span class="op" id="4017812">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4017816">//&nbsp;2**13&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017830">for</span>&nbsp;<span class="ident" id="4017834">i</span>&nbsp;<span class="op" id="4017836">:=</span>&nbsp;<span class="num" id="4017839">0</span><span class="op" id="4017840">;</span>&nbsp;<span class="ident" id="4017842">i</span>&nbsp;<span class="op" id="4017844">&lt;</span>&nbsp;<span class="num" id="4017846">11</span><span class="op" id="4017848">;</span>&nbsp;<span class="ident" id="4017850">i</span><span class="op" id="4017851">++</span>&nbsp;<span class="op" id="4017854">{</span>&nbsp;&nbsp;<span class="comment" id="4017857">//&nbsp;2**24&nbsp;-&nbsp;2**12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017876">p224Square</span><span class="op" id="4017886">(</span><span class="op" id="4017887">&amp;</span><span class="ident" id="4017888">f3</span><span class="op" id="4017890">,</span>&nbsp;<span class="op" id="4017892">&amp;</span><span class="ident" id="4017893">f3</span><span class="op" id="4017895">,</span>&nbsp;<span class="op" id="4017897">&amp;</span><span class="ident" id="4017898">c</span><span class="op" id="4017899">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017905">p224Mul</span><span class="op" id="4017912">(</span><span class="op" id="4017913">&amp;</span><span class="ident" id="4017914">f2</span><span class="op" id="4017916">,</span>&nbsp;<span class="op" id="4017918">&amp;</span><span class="ident" id="4017919">f3</span><span class="op" id="4017921">,</span>&nbsp;<span class="op" id="4017923">&amp;</span><span class="ident" id="4017924">f2</span><span class="op" id="4017926">,</span>&nbsp;<span class="op" id="4017928">&amp;</span><span class="ident" id="4017929">c</span><span class="op" id="4017930">)</span>&nbsp;<span class="comment" id="4017932">//&nbsp;2**24&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017946">p224Square</span><span class="op" id="4017956">(</span><span class="op" id="4017957">&amp;</span><span class="ident" id="4017958">f3</span><span class="op" id="4017960">,</span>&nbsp;<span class="op" id="4017962">&amp;</span><span class="ident" id="4017963">f2</span><span class="op" id="4017965">,</span>&nbsp;<span class="op" id="4017967">&amp;</span><span class="ident" id="4017968">c</span><span class="op" id="4017969">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4017973">//&nbsp;2**25&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017987">for</span>&nbsp;<span class="ident" id="4017991">i</span>&nbsp;<span class="op" id="4017993">:=</span>&nbsp;<span class="num" id="4017996">0</span><span class="op" id="4017997">;</span>&nbsp;<span class="ident" id="4017999">i</span>&nbsp;<span class="op" id="4018001">&lt;</span>&nbsp;<span class="num" id="4018003">23</span><span class="op" id="4018005">;</span>&nbsp;<span class="ident" id="4018007">i</span><span class="op" id="4018008">++</span>&nbsp;<span class="op" id="4018011">{</span>&nbsp;&nbsp;<span class="comment" id="4018014">//&nbsp;2**48&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018033">p224Square</span><span class="op" id="4018043">(</span><span class="op" id="4018044">&amp;</span><span class="ident" id="4018045">f3</span><span class="op" id="4018047">,</span>&nbsp;<span class="op" id="4018049">&amp;</span><span class="ident" id="4018050">f3</span><span class="op" id="4018052">,</span>&nbsp;<span class="op" id="4018054">&amp;</span><span class="ident" id="4018055">c</span><span class="op" id="4018056">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018062">p224Mul</span><span class="op" id="4018069">(</span><span class="op" id="4018070">&amp;</span><span class="ident" id="4018071">f3</span><span class="op" id="4018073">,</span>&nbsp;<span class="op" id="4018075">&amp;</span><span class="ident" id="4018076">f3</span><span class="op" id="4018078">,</span>&nbsp;<span class="op" id="4018080">&amp;</span><span class="ident" id="4018081">f2</span><span class="op" id="4018083">,</span>&nbsp;<span class="op" id="4018085">&amp;</span><span class="ident" id="4018086">c</span><span class="op" id="4018087">)</span>&nbsp;<span class="comment" id="4018089">//&nbsp;2**48&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018103">p224Square</span><span class="op" id="4018113">(</span><span class="op" id="4018114">&amp;</span><span class="ident" id="4018115">f4</span><span class="op" id="4018117">,</span>&nbsp;<span class="op" id="4018119">&amp;</span><span class="ident" id="4018120">f3</span><span class="op" id="4018122">,</span>&nbsp;<span class="op" id="4018124">&amp;</span><span class="ident" id="4018125">c</span><span class="op" id="4018126">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4018130">//&nbsp;2**49&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018144">for</span>&nbsp;<span class="ident" id="4018148">i</span>&nbsp;<span class="op" id="4018150">:=</span>&nbsp;<span class="num" id="4018153">0</span><span class="op" id="4018154">;</span>&nbsp;<span class="ident" id="4018156">i</span>&nbsp;<span class="op" id="4018158">&lt;</span>&nbsp;<span class="num" id="4018160">47</span><span class="op" id="4018162">;</span>&nbsp;<span class="ident" id="4018164">i</span><span class="op" id="4018165">++</span>&nbsp;<span class="op" id="4018168">{</span>&nbsp;&nbsp;<span class="comment" id="4018171">//&nbsp;2**96&nbsp;-&nbsp;2**48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018190">p224Square</span><span class="op" id="4018200">(</span><span class="op" id="4018201">&amp;</span><span class="ident" id="4018202">f4</span><span class="op" id="4018204">,</span>&nbsp;<span class="op" id="4018206">&amp;</span><span class="ident" id="4018207">f4</span><span class="op" id="4018209">,</span>&nbsp;<span class="op" id="4018211">&amp;</span><span class="ident" id="4018212">c</span><span class="op" id="4018213">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018219">p224Mul</span><span class="op" id="4018226">(</span><span class="op" id="4018227">&amp;</span><span class="ident" id="4018228">f3</span><span class="op" id="4018230">,</span>&nbsp;<span class="op" id="4018232">&amp;</span><span class="ident" id="4018233">f3</span><span class="op" id="4018235">,</span>&nbsp;<span class="op" id="4018237">&amp;</span><span class="ident" id="4018238">f4</span><span class="op" id="4018240">,</span>&nbsp;<span class="op" id="4018242">&amp;</span><span class="ident" id="4018243">c</span><span class="op" id="4018244">)</span>&nbsp;<span class="comment" id="4018246">//&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018260">p224Square</span><span class="op" id="4018270">(</span><span class="op" id="4018271">&amp;</span><span class="ident" id="4018272">f4</span><span class="op" id="4018274">,</span>&nbsp;<span class="op" id="4018276">&amp;</span><span class="ident" id="4018277">f3</span><span class="op" id="4018279">,</span>&nbsp;<span class="op" id="4018281">&amp;</span><span class="ident" id="4018282">c</span><span class="op" id="4018283">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4018287">//&nbsp;2**97&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018301">for</span>&nbsp;<span class="ident" id="4018305">i</span>&nbsp;<span class="op" id="4018307">:=</span>&nbsp;<span class="num" id="4018310">0</span><span class="op" id="4018311">;</span>&nbsp;<span class="ident" id="4018313">i</span>&nbsp;<span class="op" id="4018315">&lt;</span>&nbsp;<span class="num" id="4018317">23</span><span class="op" id="4018319">;</span>&nbsp;<span class="ident" id="4018321">i</span><span class="op" id="4018322">++</span>&nbsp;<span class="op" id="4018325">{</span>&nbsp;&nbsp;<span class="comment" id="4018328">//&nbsp;2**120&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018348">p224Square</span><span class="op" id="4018358">(</span><span class="op" id="4018359">&amp;</span><span class="ident" id="4018360">f4</span><span class="op" id="4018362">,</span>&nbsp;<span class="op" id="4018364">&amp;</span><span class="ident" id="4018365">f4</span><span class="op" id="4018367">,</span>&nbsp;<span class="op" id="4018369">&amp;</span><span class="ident" id="4018370">c</span><span class="op" id="4018371">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018377">p224Mul</span><span class="op" id="4018384">(</span><span class="op" id="4018385">&amp;</span><span class="ident" id="4018386">f2</span><span class="op" id="4018388">,</span>&nbsp;<span class="op" id="4018390">&amp;</span><span class="ident" id="4018391">f4</span><span class="op" id="4018393">,</span>&nbsp;<span class="op" id="4018395">&amp;</span><span class="ident" id="4018396">f2</span><span class="op" id="4018398">,</span>&nbsp;<span class="op" id="4018400">&amp;</span><span class="ident" id="4018401">c</span><span class="op" id="4018402">)</span>&nbsp;<span class="comment" id="4018404">//&nbsp;2**120&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018419">for</span>&nbsp;<span class="ident" id="4018423">i</span>&nbsp;<span class="op" id="4018425">:=</span>&nbsp;<span class="num" id="4018428">0</span><span class="op" id="4018429">;</span>&nbsp;<span class="ident" id="4018431">i</span>&nbsp;<span class="op" id="4018433">&lt;</span>&nbsp;<span class="num" id="4018435">6</span><span class="op" id="4018436">;</span>&nbsp;<span class="ident" id="4018438">i</span><span class="op" id="4018439">++</span>&nbsp;<span class="op" id="4018442">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4018446">//&nbsp;2**126&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018465">p224Square</span><span class="op" id="4018475">(</span><span class="op" id="4018476">&amp;</span><span class="ident" id="4018477">f2</span><span class="op" id="4018479">,</span>&nbsp;<span class="op" id="4018481">&amp;</span><span class="ident" id="4018482">f2</span><span class="op" id="4018484">,</span>&nbsp;<span class="op" id="4018486">&amp;</span><span class="ident" id="4018487">c</span><span class="op" id="4018488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018491">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018494">p224Mul</span><span class="op" id="4018501">(</span><span class="op" id="4018502">&amp;</span><span class="ident" id="4018503">f1</span><span class="op" id="4018505">,</span>&nbsp;<span class="op" id="4018507">&amp;</span><span class="ident" id="4018508">f1</span><span class="op" id="4018510">,</span>&nbsp;<span class="op" id="4018512">&amp;</span><span class="ident" id="4018513">f2</span><span class="op" id="4018515">,</span>&nbsp;<span class="op" id="4018517">&amp;</span><span class="ident" id="4018518">c</span><span class="op" id="4018519">)</span>&nbsp;<span class="comment" id="4018521">//&nbsp;2**126&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018536">p224Square</span><span class="op" id="4018546">(</span><span class="op" id="4018547">&amp;</span><span class="ident" id="4018548">f1</span><span class="op" id="4018550">,</span>&nbsp;<span class="op" id="4018552">&amp;</span><span class="ident" id="4018553">f1</span><span class="op" id="4018555">,</span>&nbsp;<span class="op" id="4018557">&amp;</span><span class="ident" id="4018558">c</span><span class="op" id="4018559">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4018563">//&nbsp;2**127&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018578">p224Mul</span><span class="op" id="4018585">(</span><span class="op" id="4018586">&amp;</span><span class="ident" id="4018587">f1</span><span class="op" id="4018589">,</span>&nbsp;<span class="op" id="4018591">&amp;</span><span class="ident" id="4018592">f1</span><span class="op" id="4018594">,</span>&nbsp;<span class="ident" id="4018596">in</span><span class="op" id="4018598">,</span>&nbsp;<span class="op" id="4018600">&amp;</span><span class="ident" id="4018601">c</span><span class="op" id="4018602">)</span>&nbsp;&nbsp;<span class="comment" id="4018605">//&nbsp;2**127&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018620">for</span>&nbsp;<span class="ident" id="4018624">i</span>&nbsp;<span class="op" id="4018626">:=</span>&nbsp;<span class="num" id="4018629">0</span><span class="op" id="4018630">;</span>&nbsp;<span class="ident" id="4018632">i</span>&nbsp;<span class="op" id="4018634">&lt;</span>&nbsp;<span class="num" id="4018636">97</span><span class="op" id="4018638">;</span>&nbsp;<span class="ident" id="4018640">i</span><span class="op" id="4018641">++</span>&nbsp;<span class="op" id="4018644">{</span>&nbsp;&nbsp;<span class="comment" id="4018647">//&nbsp;2**224&nbsp;-&nbsp;2**97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018667">p224Square</span><span class="op" id="4018677">(</span><span class="op" id="4018678">&amp;</span><span class="ident" id="4018679">f1</span><span class="op" id="4018681">,</span>&nbsp;<span class="op" id="4018683">&amp;</span><span class="ident" id="4018684">f1</span><span class="op" id="4018686">,</span>&nbsp;<span class="op" id="4018688">&amp;</span><span class="ident" id="4018689">c</span><span class="op" id="4018690">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018696">p224Mul</span><span class="op" id="4018703">(</span><span class="ident" id="4018704">out</span><span class="op" id="4018707">,</span>&nbsp;<span class="op" id="4018709">&amp;</span><span class="ident" id="4018710">f1</span><span class="op" id="4018712">,</span>&nbsp;<span class="op" id="4018714">&amp;</span><span class="ident" id="4018715">f3</span><span class="op" id="4018717">,</span>&nbsp;<span class="op" id="4018719">&amp;</span><span class="ident" id="4018720">c</span><span class="op" id="4018721">)</span>&nbsp;<span class="comment" id="4018723">//&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span><span class="op" id="4018745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4018748">//&nbsp;p224Contract&nbsp;converts&nbsp;a&nbsp;FieldElement&nbsp;to&nbsp;its&nbsp;unique,&nbsp;minimal&nbsp;form.</span><br>
<span class="lineno">385</span><span class="comment" id="4018817">//</span><br>
<span class="lineno"></span><span class="comment" id="4018820">//&nbsp;On&nbsp;entry,&nbsp;in[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4018847">//&nbsp;On&nbsp;exit,&nbsp;in[i]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="keyword" id="4018873">func</span>&nbsp;<span class="ident" id="4018878">p224Contract</span><span class="op" id="4018890">(</span><span class="ident" id="4018891">out</span><span class="op" id="4018894">,</span>&nbsp;<span class="ident" id="4018896">in</span>&nbsp;<span class="op" id="4018899">*</span><span class="ident" id="4018900">p224FieldElement</span><span class="op" id="4018916">)</span>&nbsp;<span class="op" id="4018918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4018921">copy</span><span class="op" id="4018925">(</span><span class="ident" id="4018926">out</span><span class="op" id="4018929">[</span><span class="op" id="4018930">:</span><span class="op" id="4018931">]</span><span class="op" id="4018932">,</span>&nbsp;<span class="ident" id="4018934">in</span><span class="op" id="4018936">[</span><span class="op" id="4018937">:</span><span class="op" id="4018938">]</span><span class="op" id="4018939">)</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018943">for</span>&nbsp;<span class="ident" id="4018947">i</span>&nbsp;<span class="op" id="4018949">:=</span>&nbsp;<span class="num" id="4018952">0</span><span class="op" id="4018953">;</span>&nbsp;<span class="ident" id="4018955">i</span>&nbsp;<span class="op" id="4018957">&lt;</span>&nbsp;<span class="num" id="4018959">7</span><span class="op" id="4018960">;</span>&nbsp;<span class="ident" id="4018962">i</span><span class="op" id="4018963">++</span>&nbsp;<span class="op" id="4018966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018970">out</span><span class="op" id="4018973">[</span><span class="ident" id="4018974">i</span><span class="op" id="4018975">+</span><span class="num" id="4018976">1</span><span class="op" id="4018977">]</span>&nbsp;<span class="op" id="4018979">+=</span>&nbsp;<span class="ident" id="4018982">out</span><span class="op" id="4018985">[</span><span class="ident" id="4018986">i</span><span class="op" id="4018987">]</span>&nbsp;<span class="op" id="4018989">&gt;&gt;</span>&nbsp;<span class="num" id="4018992">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018997">out</span><span class="op" id="4019000">[</span><span class="ident" id="4019001">i</span><span class="op" id="4019002">]</span>&nbsp;<span class="op" id="4019004">&amp;=</span>&nbsp;<span class="ident" id="4019007">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019021">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019024">top</span>&nbsp;<span class="op" id="4019028">:=</span>&nbsp;<span class="ident" id="4019031">out</span><span class="op" id="4019034">[</span><span class="num" id="4019035">7</span><span class="op" id="4019036">]</span>&nbsp;<span class="op" id="4019038">&gt;&gt;</span>&nbsp;<span class="num" id="4019041">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019045">out</span><span class="op" id="4019048">[</span><span class="num" id="4019049">7</span><span class="op" id="4019050">]</span>&nbsp;<span class="op" id="4019052">&amp;=</span>&nbsp;<span class="ident" id="4019055">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019070">out</span><span class="op" id="4019073">[</span><span class="num" id="4019074">0</span><span class="op" id="4019075">]</span>&nbsp;<span class="op" id="4019077">-=</span>&nbsp;<span class="ident" id="4019080">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019085">out</span><span class="op" id="4019088">[</span><span class="num" id="4019089">3</span><span class="op" id="4019090">]</span>&nbsp;<span class="op" id="4019092">+=</span>&nbsp;<span class="ident" id="4019095">top</span>&nbsp;<span class="op" id="4019099">&lt;&lt;</span>&nbsp;<span class="num" id="4019102">12</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4019107">//&nbsp;We&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[i]&nbsp;negative.&nbsp;So&nbsp;we&nbsp;carry&nbsp;down.&nbsp;If&nbsp;we&nbsp;made</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4019179">//&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is&nbsp;sufficiently&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4019249">//&nbsp;because&nbsp;we&nbsp;just&nbsp;added&nbsp;to&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019282">for</span>&nbsp;<span class="ident" id="4019286">i</span>&nbsp;<span class="op" id="4019288">:=</span>&nbsp;<span class="num" id="4019291">0</span><span class="op" id="4019292">;</span>&nbsp;<span class="ident" id="4019294">i</span>&nbsp;<span class="op" id="4019296">&lt;</span>&nbsp;<span class="num" id="4019298">3</span><span class="op" id="4019299">;</span>&nbsp;<span class="ident" id="4019301">i</span><span class="op" id="4019302">++</span>&nbsp;<span class="op" id="4019305">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019309">mask</span>&nbsp;<span class="op" id="4019314">:=</span>&nbsp;<span class="builtintype" id="4019317">uint32</span><span class="op" id="4019323">(</span><span class="builtintype" id="4019324">int32</span><span class="op" id="4019329">(</span><span class="ident" id="4019330">out</span><span class="op" id="4019333">[</span><span class="ident" id="4019334">i</span><span class="op" id="4019335">]</span><span class="op" id="4019336">)</span>&nbsp;<span class="op" id="4019338">&gt;&gt;</span>&nbsp;<span class="num" id="4019341">31</span><span class="op" id="4019343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019347">out</span><span class="op" id="4019350">[</span><span class="ident" id="4019351">i</span><span class="op" id="4019352">]</span>&nbsp;<span class="op" id="4019354">+=</span>&nbsp;<span class="op" id="4019357">(</span><span class="num" id="4019358">1</span>&nbsp;<span class="op" id="4019360">&lt;&lt;</span>&nbsp;<span class="num" id="4019363">28</span><span class="op" id="4019365">)</span>&nbsp;<span class="op" id="4019367">&amp;</span>&nbsp;<span class="ident" id="4019369">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019376">out</span><span class="op" id="4019379">[</span><span class="ident" id="4019380">i</span><span class="op" id="4019381">+</span><span class="num" id="4019382">1</span><span class="op" id="4019383">]</span>&nbsp;<span class="op" id="4019385">-=</span>&nbsp;<span class="num" id="4019388">1</span>&nbsp;<span class="op" id="4019390">&amp;</span>&nbsp;<span class="ident" id="4019392">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4019402">//&nbsp;We&nbsp;might&nbsp;have&nbsp;pushed&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;so&nbsp;we&nbsp;perform&nbsp;another,&nbsp;partial,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4019477">//&nbsp;carry&nbsp;chain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019494">for</span>&nbsp;<span class="ident" id="4019498">i</span>&nbsp;<span class="op" id="4019500">:=</span>&nbsp;<span class="num" id="4019503">3</span><span class="op" id="4019504">;</span>&nbsp;<span class="ident" id="4019506">i</span>&nbsp;<span class="op" id="4019508">&lt;</span>&nbsp;<span class="num" id="4019510">7</span><span class="op" id="4019511">;</span>&nbsp;<span class="ident" id="4019513">i</span><span class="op" id="4019514">++</span>&nbsp;<span class="op" id="4019517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019521">out</span><span class="op" id="4019524">[</span><span class="ident" id="4019525">i</span><span class="op" id="4019526">+</span><span class="num" id="4019527">1</span><span class="op" id="4019528">]</span>&nbsp;<span class="op" id="4019530">+=</span>&nbsp;<span class="ident" id="4019533">out</span><span class="op" id="4019536">[</span><span class="ident" id="4019537">i</span><span class="op" id="4019538">]</span>&nbsp;<span class="op" id="4019540">&gt;&gt;</span>&nbsp;<span class="num" id="4019543">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019548">out</span><span class="op" id="4019551">[</span><span class="ident" id="4019552">i</span><span class="op" id="4019553">]</span>&nbsp;<span class="op" id="4019555">&amp;=</span>&nbsp;<span class="ident" id="4019558">bottom28Bits</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019575">top</span>&nbsp;<span class="op" id="4019579">=</span>&nbsp;<span class="ident" id="4019581">out</span><span class="op" id="4019584">[</span><span class="num" id="4019585">7</span><span class="op" id="4019586">]</span>&nbsp;<span class="op" id="4019588">&gt;&gt;</span>&nbsp;<span class="num" id="4019591">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019595">out</span><span class="op" id="4019598">[</span><span class="num" id="4019599">7</span><span class="op" id="4019600">]</span>&nbsp;<span class="op" id="4019602">&amp;=</span>&nbsp;<span class="ident" id="4019605">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4019620">//&nbsp;Eliminate&nbsp;top&nbsp;while&nbsp;maintaining&nbsp;the&nbsp;same&nbsp;value&nbsp;mod&nbsp;p.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019678">out</span><span class="op" id="4019681">[</span><span class="num" id="4019682">0</span><span class="op" id="4019683">]</span>&nbsp;<span class="op" id="4019685">-=</span>&nbsp;<span class="ident" id="4019688">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019693">out</span><span class="op" id="4019696">[</span><span class="num" id="4019697">3</span><span class="op" id="4019698">]</span>&nbsp;<span class="op" id="4019700">+=</span>&nbsp;<span class="ident" id="4019703">top</span>&nbsp;<span class="op" id="4019707">&lt;&lt;</span>&nbsp;<span class="num" id="4019710">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4019715">//&nbsp;There&nbsp;are&nbsp;two&nbsp;cases&nbsp;to&nbsp;consider&nbsp;for&nbsp;out[3]:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4019763">//&nbsp;&nbsp;&nbsp;1)&nbsp;The&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top,&nbsp;we&nbsp;didn&#39;t&nbsp;push&nbsp;out[3]&nbsp;over</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4019838">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2**28.&nbsp;In&nbsp;this&nbsp;case,&nbsp;the&nbsp;partial&nbsp;carry&nbsp;chain&nbsp;didn&#39;t&nbsp;change&nbsp;any&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4019917">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;top&nbsp;is&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4019943">//&nbsp;&nbsp;&nbsp;2)&nbsp;We&nbsp;did&nbsp;push&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;the&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020021">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;first&nbsp;value&nbsp;of&nbsp;top&nbsp;was&nbsp;in&nbsp;[0..16),&nbsp;therefore,&nbsp;prior&nbsp;to&nbsp;eliminating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020101">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;first&nbsp;top,&nbsp;0xfff1000&nbsp;&lt;=&nbsp;out[3]&nbsp;&lt;=&nbsp;0xfffffff.&nbsp;Therefore,&nbsp;after</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020176">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflowing&nbsp;and&nbsp;being&nbsp;reduced&nbsp;by&nbsp;the&nbsp;second&nbsp;carry&nbsp;chain,&nbsp;out[3]&nbsp;&lt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020252">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xf000.&nbsp;Thus&nbsp;it&nbsp;cannot&nbsp;have&nbsp;overflowed&nbsp;when&nbsp;we&nbsp;eliminated&nbsp;top&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020331">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020354">//&nbsp;Again,&nbsp;we&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[0]&nbsp;negative,&nbsp;so&nbsp;do&nbsp;the&nbsp;same&nbsp;carry&nbsp;down.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020431">//&nbsp;As&nbsp;before,&nbsp;if&nbsp;we&nbsp;made&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020501">//&nbsp;sufficiently&nbsp;positive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020528">for</span>&nbsp;<span class="ident" id="4020532">i</span>&nbsp;<span class="op" id="4020534">:=</span>&nbsp;<span class="num" id="4020537">0</span><span class="op" id="4020538">;</span>&nbsp;<span class="ident" id="4020540">i</span>&nbsp;<span class="op" id="4020542">&lt;</span>&nbsp;<span class="num" id="4020544">3</span><span class="op" id="4020545">;</span>&nbsp;<span class="ident" id="4020547">i</span><span class="op" id="4020548">++</span>&nbsp;<span class="op" id="4020551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020555">mask</span>&nbsp;<span class="op" id="4020560">:=</span>&nbsp;<span class="builtintype" id="4020563">uint32</span><span class="op" id="4020569">(</span><span class="builtintype" id="4020570">int32</span><span class="op" id="4020575">(</span><span class="ident" id="4020576">out</span><span class="op" id="4020579">[</span><span class="ident" id="4020580">i</span><span class="op" id="4020581">]</span><span class="op" id="4020582">)</span>&nbsp;<span class="op" id="4020584">&gt;&gt;</span>&nbsp;<span class="num" id="4020587">31</span><span class="op" id="4020589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020593">out</span><span class="op" id="4020596">[</span><span class="ident" id="4020597">i</span><span class="op" id="4020598">]</span>&nbsp;<span class="op" id="4020600">+=</span>&nbsp;<span class="op" id="4020603">(</span><span class="num" id="4020604">1</span>&nbsp;<span class="op" id="4020606">&lt;&lt;</span>&nbsp;<span class="num" id="4020609">28</span><span class="op" id="4020611">)</span>&nbsp;<span class="op" id="4020613">&amp;</span>&nbsp;<span class="ident" id="4020615">mask</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020622">out</span><span class="op" id="4020625">[</span><span class="ident" id="4020626">i</span><span class="op" id="4020627">+</span><span class="num" id="4020628">1</span><span class="op" id="4020629">]</span>&nbsp;<span class="op" id="4020631">-=</span>&nbsp;<span class="num" id="4020634">1</span>&nbsp;<span class="op" id="4020636">&amp;</span>&nbsp;<span class="ident" id="4020638">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4020644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020648">//&nbsp;Now&nbsp;we&nbsp;see&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p&nbsp;and,&nbsp;if&nbsp;so,&nbsp;subtract&nbsp;p.</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020709">//&nbsp;First&nbsp;we&nbsp;build&nbsp;a&nbsp;mask&nbsp;from&nbsp;the&nbsp;top&nbsp;four&nbsp;limbs,&nbsp;which&nbsp;must&nbsp;all&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020778">//&nbsp;equal&nbsp;to&nbsp;bottom28Bits&nbsp;if&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p.&nbsp;If&nbsp;top4AllOnes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020847">//&nbsp;ends&nbsp;up&nbsp;with&nbsp;any&nbsp;zero&nbsp;bits&nbsp;in&nbsp;the&nbsp;bottom&nbsp;28&nbsp;bits,&nbsp;then&nbsp;this&nbsp;wasn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020918">//&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020928">top4AllOnes</span>&nbsp;<span class="op" id="4020940">:=</span>&nbsp;<span class="builtintype" id="4020943">uint32</span><span class="op" id="4020949">(</span><span class="num" id="4020950">0xffffffff</span><span class="op" id="4020960">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020963">for</span>&nbsp;<span class="ident" id="4020967">i</span>&nbsp;<span class="op" id="4020969">:=</span>&nbsp;<span class="num" id="4020972">4</span><span class="op" id="4020973">;</span>&nbsp;<span class="ident" id="4020975">i</span>&nbsp;<span class="op" id="4020977">&lt;</span>&nbsp;<span class="num" id="4020979">8</span><span class="op" id="4020980">;</span>&nbsp;<span class="ident" id="4020982">i</span><span class="op" id="4020983">++</span>&nbsp;<span class="op" id="4020986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020990">top4AllOnes</span>&nbsp;<span class="op" id="4021002">&amp;=</span>&nbsp;<span class="ident" id="4021005">out</span><span class="op" id="4021008">[</span><span class="ident" id="4021009">i</span><span class="op" id="4021010">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4021013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021016">top4AllOnes</span>&nbsp;<span class="op" id="4021028">|=</span>&nbsp;<span class="num" id="4021031">0xf0000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021043">//&nbsp;Now&nbsp;we&nbsp;replicate&nbsp;any&nbsp;zero&nbsp;bits&nbsp;to&nbsp;all&nbsp;the&nbsp;bits&nbsp;in&nbsp;top4AllOnes.</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021110">top4AllOnes</span>&nbsp;<span class="op" id="4021122">&amp;=</span>&nbsp;<span class="ident" id="4021125">top4AllOnes</span>&nbsp;<span class="op" id="4021137">&gt;&gt;</span>&nbsp;<span class="num" id="4021140">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021144">top4AllOnes</span>&nbsp;<span class="op" id="4021156">&amp;=</span>&nbsp;<span class="ident" id="4021159">top4AllOnes</span>&nbsp;<span class="op" id="4021171">&gt;&gt;</span>&nbsp;<span class="num" id="4021174">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021177">top4AllOnes</span>&nbsp;<span class="op" id="4021189">&amp;=</span>&nbsp;<span class="ident" id="4021192">top4AllOnes</span>&nbsp;<span class="op" id="4021204">&gt;&gt;</span>&nbsp;<span class="num" id="4021207">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021210">top4AllOnes</span>&nbsp;<span class="op" id="4021222">&amp;=</span>&nbsp;<span class="ident" id="4021225">top4AllOnes</span>&nbsp;<span class="op" id="4021237">&gt;&gt;</span>&nbsp;<span class="num" id="4021240">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021243">top4AllOnes</span>&nbsp;<span class="op" id="4021255">&amp;=</span>&nbsp;<span class="ident" id="4021258">top4AllOnes</span>&nbsp;<span class="op" id="4021270">&gt;&gt;</span>&nbsp;<span class="num" id="4021273">1</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021276">top4AllOnes</span>&nbsp;<span class="op" id="4021288">=</span>&nbsp;<span class="builtintype" id="4021290">uint32</span><span class="op" id="4021296">(</span><span class="builtintype" id="4021297">int32</span><span class="op" id="4021302">(</span><span class="ident" id="4021303">top4AllOnes</span><span class="op" id="4021314">&lt;&lt;</span><span class="num" id="4021316">31</span><span class="op" id="4021318">)</span>&nbsp;<span class="op" id="4021320">&gt;&gt;</span>&nbsp;<span class="num" id="4021323">31</span><span class="op" id="4021325">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021329">//&nbsp;Now&nbsp;we&nbsp;test&nbsp;whether&nbsp;the&nbsp;bottom&nbsp;three&nbsp;limbs&nbsp;are&nbsp;non-zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021390">bottom3NonZero</span>&nbsp;<span class="op" id="4021405">:=</span>&nbsp;<span class="ident" id="4021408">out</span><span class="op" id="4021411">[</span><span class="num" id="4021412">0</span><span class="op" id="4021413">]</span>&nbsp;<span class="op" id="4021415">|</span>&nbsp;<span class="ident" id="4021417">out</span><span class="op" id="4021420">[</span><span class="num" id="4021421">1</span><span class="op" id="4021422">]</span>&nbsp;<span class="op" id="4021424">|</span>&nbsp;<span class="ident" id="4021426">out</span><span class="op" id="4021429">[</span><span class="num" id="4021430">2</span><span class="op" id="4021431">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021434">bottom3NonZero</span>&nbsp;<span class="op" id="4021449">|=</span>&nbsp;<span class="ident" id="4021452">bottom3NonZero</span>&nbsp;<span class="op" id="4021467">&gt;&gt;</span>&nbsp;<span class="num" id="4021470">16</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021474">bottom3NonZero</span>&nbsp;<span class="op" id="4021489">|=</span>&nbsp;<span class="ident" id="4021492">bottom3NonZero</span>&nbsp;<span class="op" id="4021507">&gt;&gt;</span>&nbsp;<span class="num" id="4021510">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021513">bottom3NonZero</span>&nbsp;<span class="op" id="4021528">|=</span>&nbsp;<span class="ident" id="4021531">bottom3NonZero</span>&nbsp;<span class="op" id="4021546">&gt;&gt;</span>&nbsp;<span class="num" id="4021549">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021552">bottom3NonZero</span>&nbsp;<span class="op" id="4021567">|=</span>&nbsp;<span class="ident" id="4021570">bottom3NonZero</span>&nbsp;<span class="op" id="4021585">&gt;&gt;</span>&nbsp;<span class="num" id="4021588">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021591">bottom3NonZero</span>&nbsp;<span class="op" id="4021606">|=</span>&nbsp;<span class="ident" id="4021609">bottom3NonZero</span>&nbsp;<span class="op" id="4021624">&gt;&gt;</span>&nbsp;<span class="num" id="4021627">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021630">bottom3NonZero</span>&nbsp;<span class="op" id="4021645">=</span>&nbsp;<span class="builtintype" id="4021647">uint32</span><span class="op" id="4021653">(</span><span class="builtintype" id="4021654">int32</span><span class="op" id="4021659">(</span><span class="ident" id="4021660">bottom3NonZero</span><span class="op" id="4021674">&lt;&lt;</span><span class="num" id="4021676">31</span><span class="op" id="4021678">)</span>&nbsp;<span class="op" id="4021680">&gt;&gt;</span>&nbsp;<span class="num" id="4021683">31</span><span class="op" id="4021685">)</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021689">//&nbsp;Everything&nbsp;depends&nbsp;on&nbsp;the&nbsp;value&nbsp;of&nbsp;out[3].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021736">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&gt;&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021813">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;=&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;and&nbsp;bottom3NonZero&nbsp;!=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021886">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021924">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&lt;&nbsp;0xffff000,&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&lt;&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021980">n</span>&nbsp;<span class="op" id="4021982">:=</span>&nbsp;<span class="ident" id="4021985">out</span><span class="op" id="4021988">[</span><span class="num" id="4021989">3</span><span class="op" id="4021990">]</span>&nbsp;<span class="op" id="4021992">-</span>&nbsp;<span class="num" id="4021994">0xffff000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022005">out3Equal</span>&nbsp;<span class="op" id="4022015">:=</span>&nbsp;<span class="ident" id="4022018">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022021">out3Equal</span>&nbsp;<span class="op" id="4022031">|=</span>&nbsp;<span class="ident" id="4022034">out3Equal</span>&nbsp;<span class="op" id="4022044">&gt;&gt;</span>&nbsp;<span class="num" id="4022047">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022051">out3Equal</span>&nbsp;<span class="op" id="4022061">|=</span>&nbsp;<span class="ident" id="4022064">out3Equal</span>&nbsp;<span class="op" id="4022074">&gt;&gt;</span>&nbsp;<span class="num" id="4022077">8</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022080">out3Equal</span>&nbsp;<span class="op" id="4022090">|=</span>&nbsp;<span class="ident" id="4022093">out3Equal</span>&nbsp;<span class="op" id="4022103">&gt;&gt;</span>&nbsp;<span class="num" id="4022106">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022109">out3Equal</span>&nbsp;<span class="op" id="4022119">|=</span>&nbsp;<span class="ident" id="4022122">out3Equal</span>&nbsp;<span class="op" id="4022132">&gt;&gt;</span>&nbsp;<span class="num" id="4022135">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022138">out3Equal</span>&nbsp;<span class="op" id="4022148">|=</span>&nbsp;<span class="ident" id="4022151">out3Equal</span>&nbsp;<span class="op" id="4022161">&gt;&gt;</span>&nbsp;<span class="num" id="4022164">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022167">out3Equal</span>&nbsp;<span class="op" id="4022177">=</span>&nbsp;<span class="op" id="4022179">^</span><span class="builtintype" id="4022180">uint32</span><span class="op" id="4022186">(</span><span class="builtintype" id="4022187">int32</span><span class="op" id="4022192">(</span><span class="ident" id="4022193">out3Equal</span><span class="op" id="4022202">&lt;&lt;</span><span class="num" id="4022204">31</span><span class="op" id="4022206">)</span>&nbsp;<span class="op" id="4022208">&gt;&gt;</span>&nbsp;<span class="num" id="4022211">31</span><span class="op" id="4022213">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4022217">//&nbsp;If&nbsp;out[3]&nbsp;&gt;&nbsp;0xffff000&nbsp;then&nbsp;n&#39;s&nbsp;MSB&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022270">out3GT</span>&nbsp;<span class="op" id="4022277">:=</span>&nbsp;<span class="op" id="4022280">^</span><span class="builtintype" id="4022281">uint32</span><span class="op" id="4022287">(</span><span class="builtintype" id="4022288">int32</span><span class="op" id="4022293">(</span><span class="ident" id="4022294">n</span><span class="op" id="4022295">)</span>&nbsp;<span class="op" id="4022297">&gt;&gt;</span>&nbsp;<span class="num" id="4022300">31</span><span class="op" id="4022302">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022306">mask</span>&nbsp;<span class="op" id="4022311">:=</span>&nbsp;<span class="ident" id="4022314">top4AllOnes</span>&nbsp;<span class="op" id="4022326">&amp;</span>&nbsp;<span class="op" id="4022328">(</span><span class="op" id="4022329">(</span><span class="ident" id="4022330">out3Equal</span>&nbsp;<span class="op" id="4022340">&amp;</span>&nbsp;<span class="ident" id="4022342">bottom3NonZero</span><span class="op" id="4022356">)</span>&nbsp;<span class="op" id="4022358">|</span>&nbsp;<span class="ident" id="4022360">out3GT</span><span class="op" id="4022366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022369">out</span><span class="op" id="4022372">[</span><span class="num" id="4022373">0</span><span class="op" id="4022374">]</span>&nbsp;<span class="op" id="4022376">-=</span>&nbsp;<span class="num" id="4022379">1</span>&nbsp;<span class="op" id="4022381">&amp;</span>&nbsp;<span class="ident" id="4022383">mask</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022389">out</span><span class="op" id="4022392">[</span><span class="num" id="4022393">3</span><span class="op" id="4022394">]</span>&nbsp;<span class="op" id="4022396">-=</span>&nbsp;<span class="num" id="4022399">0xffff000</span>&nbsp;<span class="op" id="4022409">&amp;</span>&nbsp;<span class="ident" id="4022411">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022417">out</span><span class="op" id="4022420">[</span><span class="num" id="4022421">4</span><span class="op" id="4022422">]</span>&nbsp;<span class="op" id="4022424">-=</span>&nbsp;<span class="num" id="4022427">0xfffffff</span>&nbsp;<span class="op" id="4022437">&amp;</span>&nbsp;<span class="ident" id="4022439">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022445">out</span><span class="op" id="4022448">[</span><span class="num" id="4022449">5</span><span class="op" id="4022450">]</span>&nbsp;<span class="op" id="4022452">-=</span>&nbsp;<span class="num" id="4022455">0xfffffff</span>&nbsp;<span class="op" id="4022465">&amp;</span>&nbsp;<span class="ident" id="4022467">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022473">out</span><span class="op" id="4022476">[</span><span class="num" id="4022477">6</span><span class="op" id="4022478">]</span>&nbsp;<span class="op" id="4022480">-=</span>&nbsp;<span class="num" id="4022483">0xfffffff</span>&nbsp;<span class="op" id="4022493">&amp;</span>&nbsp;<span class="ident" id="4022495">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022501">out</span><span class="op" id="4022504">[</span><span class="num" id="4022505">7</span><span class="op" id="4022506">]</span>&nbsp;<span class="op" id="4022508">-=</span>&nbsp;<span class="num" id="4022511">0xfffffff</span>&nbsp;<span class="op" id="4022521">&amp;</span>&nbsp;<span class="ident" id="4022523">mask</span><br>
<span class="lineno">495</span><span class="op" id="4022528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4022531">//&nbsp;Group&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4022559">//</span><br>
<span class="lineno"></span><span class="comment" id="4022562">//&nbsp;These&nbsp;functions&nbsp;deal&nbsp;with&nbsp;group&nbsp;elements.&nbsp;The&nbsp;group&nbsp;is&nbsp;an&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno">500</span><span class="comment" id="4022638">//&nbsp;group&nbsp;with&nbsp;a&nbsp;=&nbsp;-3&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4022698">//&nbsp;p224AddJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b&nbsp;where&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="4022751">func</span>&nbsp;<span class="ident" id="4022756">p224AddJacobian</span><span class="op" id="4022771">(</span><span class="ident" id="4022772">x3</span><span class="op" id="4022774">,</span>&nbsp;<span class="ident" id="4022776">y3</span><span class="op" id="4022778">,</span>&nbsp;<span class="ident" id="4022780">z3</span><span class="op" id="4022782">,</span>&nbsp;<span class="ident" id="4022784">x1</span><span class="op" id="4022786">,</span>&nbsp;<span class="ident" id="4022788">y1</span><span class="op" id="4022790">,</span>&nbsp;<span class="ident" id="4022792">z1</span><span class="op" id="4022794">,</span>&nbsp;<span class="ident" id="4022796">x2</span><span class="op" id="4022798">,</span>&nbsp;<span class="ident" id="4022800">y2</span><span class="op" id="4022802">,</span>&nbsp;<span class="ident" id="4022804">z2</span>&nbsp;<span class="op" id="4022807">*</span><span class="ident" id="4022808">p224FieldElement</span><span class="op" id="4022824">)</span>&nbsp;<span class="op" id="4022826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4022829">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-p224Add-2007-bl</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4022923">var</span>&nbsp;<span class="ident" id="4022927">z1z1</span><span class="op" id="4022931">,</span>&nbsp;<span class="ident" id="4022933">z2z2</span><span class="op" id="4022937">,</span>&nbsp;<span class="ident" id="4022939">u1</span><span class="op" id="4022941">,</span>&nbsp;<span class="ident" id="4022943">u2</span><span class="op" id="4022945">,</span>&nbsp;<span class="ident" id="4022947">s1</span><span class="op" id="4022949">,</span>&nbsp;<span class="ident" id="4022951">s2</span><span class="op" id="4022953">,</span>&nbsp;<span class="ident" id="4022955">h</span><span class="op" id="4022956">,</span>&nbsp;<span class="ident" id="4022958">i</span><span class="op" id="4022959">,</span>&nbsp;<span class="ident" id="4022961">j</span><span class="op" id="4022962">,</span>&nbsp;<span class="ident" id="4022964">r</span><span class="op" id="4022965">,</span>&nbsp;<span class="ident" id="4022967">v</span>&nbsp;<span class="ident" id="4022969">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4022987">var</span>&nbsp;<span class="ident" id="4022991">c</span>&nbsp;<span class="ident" id="4022993">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023017">z1IsZero</span>&nbsp;<span class="op" id="4023026">:=</span>&nbsp;<span class="ident" id="4023029">p224IsZero</span><span class="op" id="4023039">(</span><span class="ident" id="4023040">z1</span><span class="op" id="4023042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023045">z2IsZero</span>&nbsp;<span class="op" id="4023054">:=</span>&nbsp;<span class="ident" id="4023057">p224IsZero</span><span class="op" id="4023067">(</span><span class="ident" id="4023068">z2</span><span class="op" id="4023070">)</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023074">//&nbsp;Z1Z1&nbsp;=&nbsp;Z1²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023090">p224Square</span><span class="op" id="4023100">(</span><span class="op" id="4023101">&amp;</span><span class="ident" id="4023102">z1z1</span><span class="op" id="4023106">,</span>&nbsp;<span class="ident" id="4023108">z1</span><span class="op" id="4023110">,</span>&nbsp;<span class="op" id="4023112">&amp;</span><span class="ident" id="4023113">c</span><span class="op" id="4023114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023117">//&nbsp;Z2Z2&nbsp;=&nbsp;Z2²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023133">p224Square</span><span class="op" id="4023143">(</span><span class="op" id="4023144">&amp;</span><span class="ident" id="4023145">z2z2</span><span class="op" id="4023149">,</span>&nbsp;<span class="ident" id="4023151">z2</span><span class="op" id="4023153">,</span>&nbsp;<span class="op" id="4023155">&amp;</span><span class="ident" id="4023156">c</span><span class="op" id="4023157">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023160">//&nbsp;U1&nbsp;=&nbsp;X1*Z2Z2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023177">p224Mul</span><span class="op" id="4023184">(</span><span class="op" id="4023185">&amp;</span><span class="ident" id="4023186">u1</span><span class="op" id="4023188">,</span>&nbsp;<span class="ident" id="4023190">x1</span><span class="op" id="4023192">,</span>&nbsp;<span class="op" id="4023194">&amp;</span><span class="ident" id="4023195">z2z2</span><span class="op" id="4023199">,</span>&nbsp;<span class="op" id="4023201">&amp;</span><span class="ident" id="4023202">c</span><span class="op" id="4023203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023206">//&nbsp;U2&nbsp;=&nbsp;X2*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023223">p224Mul</span><span class="op" id="4023230">(</span><span class="op" id="4023231">&amp;</span><span class="ident" id="4023232">u2</span><span class="op" id="4023234">,</span>&nbsp;<span class="ident" id="4023236">x2</span><span class="op" id="4023238">,</span>&nbsp;<span class="op" id="4023240">&amp;</span><span class="ident" id="4023241">z1z1</span><span class="op" id="4023245">,</span>&nbsp;<span class="op" id="4023247">&amp;</span><span class="ident" id="4023248">c</span><span class="op" id="4023249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023252">//&nbsp;S1&nbsp;=&nbsp;Y1*Z2*Z2Z2</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023272">p224Mul</span><span class="op" id="4023279">(</span><span class="op" id="4023280">&amp;</span><span class="ident" id="4023281">s1</span><span class="op" id="4023283">,</span>&nbsp;<span class="ident" id="4023285">z2</span><span class="op" id="4023287">,</span>&nbsp;<span class="op" id="4023289">&amp;</span><span class="ident" id="4023290">z2z2</span><span class="op" id="4023294">,</span>&nbsp;<span class="op" id="4023296">&amp;</span><span class="ident" id="4023297">c</span><span class="op" id="4023298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023301">p224Mul</span><span class="op" id="4023308">(</span><span class="op" id="4023309">&amp;</span><span class="ident" id="4023310">s1</span><span class="op" id="4023312">,</span>&nbsp;<span class="ident" id="4023314">y1</span><span class="op" id="4023316">,</span>&nbsp;<span class="op" id="4023318">&amp;</span><span class="ident" id="4023319">s1</span><span class="op" id="4023321">,</span>&nbsp;<span class="op" id="4023323">&amp;</span><span class="ident" id="4023324">c</span><span class="op" id="4023325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023328">//&nbsp;S2&nbsp;=&nbsp;Y2*Z1*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023348">p224Mul</span><span class="op" id="4023355">(</span><span class="op" id="4023356">&amp;</span><span class="ident" id="4023357">s2</span><span class="op" id="4023359">,</span>&nbsp;<span class="ident" id="4023361">z1</span><span class="op" id="4023363">,</span>&nbsp;<span class="op" id="4023365">&amp;</span><span class="ident" id="4023366">z1z1</span><span class="op" id="4023370">,</span>&nbsp;<span class="op" id="4023372">&amp;</span><span class="ident" id="4023373">c</span><span class="op" id="4023374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023377">p224Mul</span><span class="op" id="4023384">(</span><span class="op" id="4023385">&amp;</span><span class="ident" id="4023386">s2</span><span class="op" id="4023388">,</span>&nbsp;<span class="ident" id="4023390">y2</span><span class="op" id="4023392">,</span>&nbsp;<span class="op" id="4023394">&amp;</span><span class="ident" id="4023395">s2</span><span class="op" id="4023397">,</span>&nbsp;<span class="op" id="4023399">&amp;</span><span class="ident" id="4023400">c</span><span class="op" id="4023401">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023404">//&nbsp;H&nbsp;=&nbsp;U2-U1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023418">p224Sub</span><span class="op" id="4023425">(</span><span class="op" id="4023426">&amp;</span><span class="ident" id="4023427">h</span><span class="op" id="4023428">,</span>&nbsp;<span class="op" id="4023430">&amp;</span><span class="ident" id="4023431">u2</span><span class="op" id="4023433">,</span>&nbsp;<span class="op" id="4023435">&amp;</span><span class="ident" id="4023436">u1</span><span class="op" id="4023438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023441">p224Reduce</span><span class="op" id="4023451">(</span><span class="op" id="4023452">&amp;</span><span class="ident" id="4023453">h</span><span class="op" id="4023454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023457">xEqual</span>&nbsp;<span class="op" id="4023464">:=</span>&nbsp;<span class="ident" id="4023467">p224IsZero</span><span class="op" id="4023477">(</span><span class="op" id="4023478">&amp;</span><span class="ident" id="4023479">h</span><span class="op" id="4023480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023483">//&nbsp;I&nbsp;=&nbsp;(2*H)²</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023499">for</span>&nbsp;<span class="ident" id="4023503">j</span>&nbsp;<span class="op" id="4023505">:=</span>&nbsp;<span class="num" id="4023508">0</span><span class="op" id="4023509">;</span>&nbsp;<span class="ident" id="4023511">j</span>&nbsp;<span class="op" id="4023513">&lt;</span>&nbsp;<span class="num" id="4023515">8</span><span class="op" id="4023516">;</span>&nbsp;<span class="ident" id="4023518">j</span><span class="op" id="4023519">++</span>&nbsp;<span class="op" id="4023522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023526">i</span><span class="op" id="4023527">[</span><span class="ident" id="4023528">j</span><span class="op" id="4023529">]</span>&nbsp;<span class="op" id="4023531">=</span>&nbsp;<span class="ident" id="4023533">h</span><span class="op" id="4023534">[</span><span class="ident" id="4023535">j</span><span class="op" id="4023536">]</span>&nbsp;<span class="op" id="4023538">&lt;&lt;</span>&nbsp;<span class="num" id="4023541">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023547">p224Reduce</span><span class="op" id="4023557">(</span><span class="op" id="4023558">&amp;</span><span class="ident" id="4023559">i</span><span class="op" id="4023560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023563">p224Square</span><span class="op" id="4023573">(</span><span class="op" id="4023574">&amp;</span><span class="ident" id="4023575">i</span><span class="op" id="4023576">,</span>&nbsp;<span class="op" id="4023578">&amp;</span><span class="ident" id="4023579">i</span><span class="op" id="4023580">,</span>&nbsp;<span class="op" id="4023582">&amp;</span><span class="ident" id="4023583">c</span><span class="op" id="4023584">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023587">//&nbsp;J&nbsp;=&nbsp;H*I</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023599">p224Mul</span><span class="op" id="4023606">(</span><span class="op" id="4023607">&amp;</span><span class="ident" id="4023608">j</span><span class="op" id="4023609">,</span>&nbsp;<span class="op" id="4023611">&amp;</span><span class="ident" id="4023612">h</span><span class="op" id="4023613">,</span>&nbsp;<span class="op" id="4023615">&amp;</span><span class="ident" id="4023616">i</span><span class="op" id="4023617">,</span>&nbsp;<span class="op" id="4023619">&amp;</span><span class="ident" id="4023620">c</span><span class="op" id="4023621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023624">//&nbsp;r&nbsp;=&nbsp;2*(S2-S1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023642">p224Sub</span><span class="op" id="4023649">(</span><span class="op" id="4023650">&amp;</span><span class="ident" id="4023651">r</span><span class="op" id="4023652">,</span>&nbsp;<span class="op" id="4023654">&amp;</span><span class="ident" id="4023655">s2</span><span class="op" id="4023657">,</span>&nbsp;<span class="op" id="4023659">&amp;</span><span class="ident" id="4023660">s1</span><span class="op" id="4023662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023665">p224Reduce</span><span class="op" id="4023675">(</span><span class="op" id="4023676">&amp;</span><span class="ident" id="4023677">r</span><span class="op" id="4023678">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023681">yEqual</span>&nbsp;<span class="op" id="4023688">:=</span>&nbsp;<span class="ident" id="4023691">p224IsZero</span><span class="op" id="4023701">(</span><span class="op" id="4023702">&amp;</span><span class="ident" id="4023703">r</span><span class="op" id="4023704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023707">if</span>&nbsp;<span class="ident" id="4023710">xEqual</span>&nbsp;<span class="op" id="4023717">==</span>&nbsp;<span class="num" id="4023720">1</span>&nbsp;<span class="op" id="4023722">&amp;&amp;</span>&nbsp;<span class="ident" id="4023725">yEqual</span>&nbsp;<span class="op" id="4023732">==</span>&nbsp;<span class="num" id="4023735">1</span>&nbsp;<span class="op" id="4023737">&amp;&amp;</span>&nbsp;<span class="ident" id="4023740">z1IsZero</span>&nbsp;<span class="op" id="4023749">==</span>&nbsp;<span class="num" id="4023752">0</span>&nbsp;<span class="op" id="4023754">&amp;&amp;</span>&nbsp;<span class="ident" id="4023757">z2IsZero</span>&nbsp;<span class="op" id="4023766">==</span>&nbsp;<span class="num" id="4023769">0</span>&nbsp;<span class="op" id="4023771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023775">p224DoubleJacobian</span><span class="op" id="4023793">(</span><span class="ident" id="4023794">x3</span><span class="op" id="4023796">,</span>&nbsp;<span class="ident" id="4023798">y3</span><span class="op" id="4023800">,</span>&nbsp;<span class="ident" id="4023802">z3</span><span class="op" id="4023804">,</span>&nbsp;<span class="ident" id="4023806">x1</span><span class="op" id="4023808">,</span>&nbsp;<span class="ident" id="4023810">y1</span><span class="op" id="4023812">,</span>&nbsp;<span class="ident" id="4023814">z1</span><span class="op" id="4023816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023820">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023828">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023831">for</span>&nbsp;<span class="ident" id="4023835">i</span>&nbsp;<span class="op" id="4023837">:=</span>&nbsp;<span class="num" id="4023840">0</span><span class="op" id="4023841">;</span>&nbsp;<span class="ident" id="4023843">i</span>&nbsp;<span class="op" id="4023845">&lt;</span>&nbsp;<span class="num" id="4023847">8</span><span class="op" id="4023848">;</span>&nbsp;<span class="ident" id="4023850">i</span><span class="op" id="4023851">++</span>&nbsp;<span class="op" id="4023854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023858">r</span><span class="op" id="4023859">[</span><span class="ident" id="4023860">i</span><span class="op" id="4023861">]</span>&nbsp;<span class="op" id="4023863">&lt;&lt;=</span>&nbsp;<span class="num" id="4023867">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023873">p224Reduce</span><span class="op" id="4023883">(</span><span class="op" id="4023884">&amp;</span><span class="ident" id="4023885">r</span><span class="op" id="4023886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023889">//&nbsp;V&nbsp;=&nbsp;U1*I</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023902">p224Mul</span><span class="op" id="4023909">(</span><span class="op" id="4023910">&amp;</span><span class="ident" id="4023911">v</span><span class="op" id="4023912">,</span>&nbsp;<span class="op" id="4023914">&amp;</span><span class="ident" id="4023915">u1</span><span class="op" id="4023917">,</span>&nbsp;<span class="op" id="4023919">&amp;</span><span class="ident" id="4023920">i</span><span class="op" id="4023921">,</span>&nbsp;<span class="op" id="4023923">&amp;</span><span class="ident" id="4023924">c</span><span class="op" id="4023925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023928">//&nbsp;Z3&nbsp;=&nbsp;((Z1+Z2)²-Z1Z1-Z2Z2)*H</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023961">p224Add</span><span class="op" id="4023968">(</span><span class="op" id="4023969">&amp;</span><span class="ident" id="4023970">z1z1</span><span class="op" id="4023974">,</span>&nbsp;<span class="op" id="4023976">&amp;</span><span class="ident" id="4023977">z1z1</span><span class="op" id="4023981">,</span>&nbsp;<span class="op" id="4023983">&amp;</span><span class="ident" id="4023984">z2z2</span><span class="op" id="4023988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023991">p224Add</span><span class="op" id="4023998">(</span><span class="op" id="4023999">&amp;</span><span class="ident" id="4024000">z2z2</span><span class="op" id="4024004">,</span>&nbsp;<span class="ident" id="4024006">z1</span><span class="op" id="4024008">,</span>&nbsp;<span class="ident" id="4024010">z2</span><span class="op" id="4024012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024015">p224Reduce</span><span class="op" id="4024025">(</span><span class="op" id="4024026">&amp;</span><span class="ident" id="4024027">z2z2</span><span class="op" id="4024031">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024034">p224Square</span><span class="op" id="4024044">(</span><span class="op" id="4024045">&amp;</span><span class="ident" id="4024046">z2z2</span><span class="op" id="4024050">,</span>&nbsp;<span class="op" id="4024052">&amp;</span><span class="ident" id="4024053">z2z2</span><span class="op" id="4024057">,</span>&nbsp;<span class="op" id="4024059">&amp;</span><span class="ident" id="4024060">c</span><span class="op" id="4024061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024064">p224Sub</span><span class="op" id="4024071">(</span><span class="ident" id="4024072">z3</span><span class="op" id="4024074">,</span>&nbsp;<span class="op" id="4024076">&amp;</span><span class="ident" id="4024077">z2z2</span><span class="op" id="4024081">,</span>&nbsp;<span class="op" id="4024083">&amp;</span><span class="ident" id="4024084">z1z1</span><span class="op" id="4024088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024091">p224Reduce</span><span class="op" id="4024101">(</span><span class="ident" id="4024102">z3</span><span class="op" id="4024104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024107">p224Mul</span><span class="op" id="4024114">(</span><span class="ident" id="4024115">z3</span><span class="op" id="4024117">,</span>&nbsp;<span class="ident" id="4024119">z3</span><span class="op" id="4024121">,</span>&nbsp;<span class="op" id="4024123">&amp;</span><span class="ident" id="4024124">h</span><span class="op" id="4024125">,</span>&nbsp;<span class="op" id="4024127">&amp;</span><span class="ident" id="4024128">c</span><span class="op" id="4024129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4024132">//&nbsp;X3&nbsp;=&nbsp;r²-J-2*V</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024151">for</span>&nbsp;<span class="ident" id="4024155">i</span>&nbsp;<span class="op" id="4024157">:=</span>&nbsp;<span class="num" id="4024160">0</span><span class="op" id="4024161">;</span>&nbsp;<span class="ident" id="4024163">i</span>&nbsp;<span class="op" id="4024165">&lt;</span>&nbsp;<span class="num" id="4024167">8</span><span class="op" id="4024168">;</span>&nbsp;<span class="ident" id="4024170">i</span><span class="op" id="4024171">++</span>&nbsp;<span class="op" id="4024174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024178">z1z1</span><span class="op" id="4024182">[</span><span class="ident" id="4024183">i</span><span class="op" id="4024184">]</span>&nbsp;<span class="op" id="4024186">=</span>&nbsp;<span class="ident" id="4024188">v</span><span class="op" id="4024189">[</span><span class="ident" id="4024190">i</span><span class="op" id="4024191">]</span>&nbsp;<span class="op" id="4024193">&lt;&lt;</span>&nbsp;<span class="num" id="4024196">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024202">p224Add</span><span class="op" id="4024209">(</span><span class="op" id="4024210">&amp;</span><span class="ident" id="4024211">z1z1</span><span class="op" id="4024215">,</span>&nbsp;<span class="op" id="4024217">&amp;</span><span class="ident" id="4024218">j</span><span class="op" id="4024219">,</span>&nbsp;<span class="op" id="4024221">&amp;</span><span class="ident" id="4024222">z1z1</span><span class="op" id="4024226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024229">p224Reduce</span><span class="op" id="4024239">(</span><span class="op" id="4024240">&amp;</span><span class="ident" id="4024241">z1z1</span><span class="op" id="4024245">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024248">p224Square</span><span class="op" id="4024258">(</span><span class="ident" id="4024259">x3</span><span class="op" id="4024261">,</span>&nbsp;<span class="op" id="4024263">&amp;</span><span class="ident" id="4024264">r</span><span class="op" id="4024265">,</span>&nbsp;<span class="op" id="4024267">&amp;</span><span class="ident" id="4024268">c</span><span class="op" id="4024269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024272">p224Sub</span><span class="op" id="4024279">(</span><span class="ident" id="4024280">x3</span><span class="op" id="4024282">,</span>&nbsp;<span class="ident" id="4024284">x3</span><span class="op" id="4024286">,</span>&nbsp;<span class="op" id="4024288">&amp;</span><span class="ident" id="4024289">z1z1</span><span class="op" id="4024293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024296">p224Reduce</span><span class="op" id="4024306">(</span><span class="ident" id="4024307">x3</span><span class="op" id="4024309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4024312">//&nbsp;Y3&nbsp;=&nbsp;r*(V-X3)-2*S1*J</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024337">for</span>&nbsp;<span class="ident" id="4024341">i</span>&nbsp;<span class="op" id="4024343">:=</span>&nbsp;<span class="num" id="4024346">0</span><span class="op" id="4024347">;</span>&nbsp;<span class="ident" id="4024349">i</span>&nbsp;<span class="op" id="4024351">&lt;</span>&nbsp;<span class="num" id="4024353">8</span><span class="op" id="4024354">;</span>&nbsp;<span class="ident" id="4024356">i</span><span class="op" id="4024357">++</span>&nbsp;<span class="op" id="4024360">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024364">s1</span><span class="op" id="4024366">[</span><span class="ident" id="4024367">i</span><span class="op" id="4024368">]</span>&nbsp;<span class="op" id="4024370">&lt;&lt;=</span>&nbsp;<span class="num" id="4024374">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024380">p224Mul</span><span class="op" id="4024387">(</span><span class="op" id="4024388">&amp;</span><span class="ident" id="4024389">s1</span><span class="op" id="4024391">,</span>&nbsp;<span class="op" id="4024393">&amp;</span><span class="ident" id="4024394">s1</span><span class="op" id="4024396">,</span>&nbsp;<span class="op" id="4024398">&amp;</span><span class="ident" id="4024399">j</span><span class="op" id="4024400">,</span>&nbsp;<span class="op" id="4024402">&amp;</span><span class="ident" id="4024403">c</span><span class="op" id="4024404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024407">p224Sub</span><span class="op" id="4024414">(</span><span class="op" id="4024415">&amp;</span><span class="ident" id="4024416">z1z1</span><span class="op" id="4024420">,</span>&nbsp;<span class="op" id="4024422">&amp;</span><span class="ident" id="4024423">v</span><span class="op" id="4024424">,</span>&nbsp;<span class="ident" id="4024426">x3</span><span class="op" id="4024428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024431">p224Reduce</span><span class="op" id="4024441">(</span><span class="op" id="4024442">&amp;</span><span class="ident" id="4024443">z1z1</span><span class="op" id="4024447">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024450">p224Mul</span><span class="op" id="4024457">(</span><span class="op" id="4024458">&amp;</span><span class="ident" id="4024459">z1z1</span><span class="op" id="4024463">,</span>&nbsp;<span class="op" id="4024465">&amp;</span><span class="ident" id="4024466">z1z1</span><span class="op" id="4024470">,</span>&nbsp;<span class="op" id="4024472">&amp;</span><span class="ident" id="4024473">r</span><span class="op" id="4024474">,</span>&nbsp;<span class="op" id="4024476">&amp;</span><span class="ident" id="4024477">c</span><span class="op" id="4024478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024481">p224Sub</span><span class="op" id="4024488">(</span><span class="ident" id="4024489">y3</span><span class="op" id="4024491">,</span>&nbsp;<span class="op" id="4024493">&amp;</span><span class="ident" id="4024494">z1z1</span><span class="op" id="4024498">,</span>&nbsp;<span class="op" id="4024500">&amp;</span><span class="ident" id="4024501">s1</span><span class="op" id="4024503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024506">p224Reduce</span><span class="op" id="4024516">(</span><span class="ident" id="4024517">y3</span><span class="op" id="4024519">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024523">p224CopyConditional</span><span class="op" id="4024542">(</span><span class="ident" id="4024543">x3</span><span class="op" id="4024545">,</span>&nbsp;<span class="ident" id="4024547">x2</span><span class="op" id="4024549">,</span>&nbsp;<span class="ident" id="4024551">z1IsZero</span><span class="op" id="4024559">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024562">p224CopyConditional</span><span class="op" id="4024581">(</span><span class="ident" id="4024582">x3</span><span class="op" id="4024584">,</span>&nbsp;<span class="ident" id="4024586">x1</span><span class="op" id="4024588">,</span>&nbsp;<span class="ident" id="4024590">z2IsZero</span><span class="op" id="4024598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024601">p224CopyConditional</span><span class="op" id="4024620">(</span><span class="ident" id="4024621">y3</span><span class="op" id="4024623">,</span>&nbsp;<span class="ident" id="4024625">y2</span><span class="op" id="4024627">,</span>&nbsp;<span class="ident" id="4024629">z1IsZero</span><span class="op" id="4024637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024640">p224CopyConditional</span><span class="op" id="4024659">(</span><span class="ident" id="4024660">y3</span><span class="op" id="4024662">,</span>&nbsp;<span class="ident" id="4024664">y1</span><span class="op" id="4024666">,</span>&nbsp;<span class="ident" id="4024668">z2IsZero</span><span class="op" id="4024676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024679">p224CopyConditional</span><span class="op" id="4024698">(</span><span class="ident" id="4024699">z3</span><span class="op" id="4024701">,</span>&nbsp;<span class="ident" id="4024703">z2</span><span class="op" id="4024705">,</span>&nbsp;<span class="ident" id="4024707">z1IsZero</span><span class="op" id="4024715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024718">p224CopyConditional</span><span class="op" id="4024737">(</span><span class="ident" id="4024738">z3</span><span class="op" id="4024740">,</span>&nbsp;<span class="ident" id="4024742">z1</span><span class="op" id="4024744">,</span>&nbsp;<span class="ident" id="4024746">z2IsZero</span><span class="op" id="4024754">)</span><br>
<span class="lineno">585</span><span class="op" id="4024756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4024759">//&nbsp;p224DoubleJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+a.</span><br>
<span class="lineno"></span><span class="keyword" id="4024802">func</span>&nbsp;<span class="ident" id="4024807">p224DoubleJacobian</span><span class="op" id="4024825">(</span><span class="ident" id="4024826">x3</span><span class="op" id="4024828">,</span>&nbsp;<span class="ident" id="4024830">y3</span><span class="op" id="4024832">,</span>&nbsp;<span class="ident" id="4024834">z3</span><span class="op" id="4024836">,</span>&nbsp;<span class="ident" id="4024838">x1</span><span class="op" id="4024840">,</span>&nbsp;<span class="ident" id="4024842">y1</span><span class="op" id="4024844">,</span>&nbsp;<span class="ident" id="4024846">z1</span>&nbsp;<span class="op" id="4024849">*</span><span class="ident" id="4024850">p224FieldElement</span><span class="op" id="4024866">)</span>&nbsp;<span class="op" id="4024868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024871">var</span>&nbsp;<span class="ident" id="4024875">delta</span><span class="op" id="4024880">,</span>&nbsp;<span class="ident" id="4024882">gamma</span><span class="op" id="4024887">,</span>&nbsp;<span class="ident" id="4024889">beta</span><span class="op" id="4024893">,</span>&nbsp;<span class="ident" id="4024895">alpha</span><span class="op" id="4024900">,</span>&nbsp;<span class="ident" id="4024902">t</span>&nbsp;<span class="ident" id="4024904">p224FieldElement</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024922">var</span>&nbsp;<span class="ident" id="4024926">c</span>&nbsp;<span class="ident" id="4024928">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024952">p224Square</span><span class="op" id="4024962">(</span><span class="op" id="4024963">&amp;</span><span class="ident" id="4024964">delta</span><span class="op" id="4024969">,</span>&nbsp;<span class="ident" id="4024971">z1</span><span class="op" id="4024973">,</span>&nbsp;<span class="op" id="4024975">&amp;</span><span class="ident" id="4024976">c</span><span class="op" id="4024977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024980">p224Square</span><span class="op" id="4024990">(</span><span class="op" id="4024991">&amp;</span><span class="ident" id="4024992">gamma</span><span class="op" id="4024997">,</span>&nbsp;<span class="ident" id="4024999">y1</span><span class="op" id="4025001">,</span>&nbsp;<span class="op" id="4025003">&amp;</span><span class="ident" id="4025004">c</span><span class="op" id="4025005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025008">p224Mul</span><span class="op" id="4025015">(</span><span class="op" id="4025016">&amp;</span><span class="ident" id="4025017">beta</span><span class="op" id="4025021">,</span>&nbsp;<span class="ident" id="4025023">x1</span><span class="op" id="4025025">,</span>&nbsp;<span class="op" id="4025027">&amp;</span><span class="ident" id="4025028">gamma</span><span class="op" id="4025033">,</span>&nbsp;<span class="op" id="4025035">&amp;</span><span class="ident" id="4025036">c</span><span class="op" id="4025037">)</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4025041">//&nbsp;alpha&nbsp;=&nbsp;3*(X1-delta)*(X1+delta)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025077">p224Add</span><span class="op" id="4025084">(</span><span class="op" id="4025085">&amp;</span><span class="ident" id="4025086">t</span><span class="op" id="4025087">,</span>&nbsp;<span class="ident" id="4025089">x1</span><span class="op" id="4025091">,</span>&nbsp;<span class="op" id="4025093">&amp;</span><span class="ident" id="4025094">delta</span><span class="op" id="4025099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025102">for</span>&nbsp;<span class="ident" id="4025106">i</span>&nbsp;<span class="op" id="4025108">:=</span>&nbsp;<span class="num" id="4025111">0</span><span class="op" id="4025112">;</span>&nbsp;<span class="ident" id="4025114">i</span>&nbsp;<span class="op" id="4025116">&lt;</span>&nbsp;<span class="num" id="4025118">8</span><span class="op" id="4025119">;</span>&nbsp;<span class="ident" id="4025121">i</span><span class="op" id="4025122">++</span>&nbsp;<span class="op" id="4025125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025129">t</span><span class="op" id="4025130">[</span><span class="ident" id="4025131">i</span><span class="op" id="4025132">]</span>&nbsp;<span class="op" id="4025134">+=</span>&nbsp;<span class="ident" id="4025137">t</span><span class="op" id="4025138">[</span><span class="ident" id="4025139">i</span><span class="op" id="4025140">]</span>&nbsp;<span class="op" id="4025142">&lt;&lt;</span>&nbsp;<span class="num" id="4025145">1</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025151">p224Reduce</span><span class="op" id="4025161">(</span><span class="op" id="4025162">&amp;</span><span class="ident" id="4025163">t</span><span class="op" id="4025164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025167">p224Sub</span><span class="op" id="4025174">(</span><span class="op" id="4025175">&amp;</span><span class="ident" id="4025176">alpha</span><span class="op" id="4025181">,</span>&nbsp;<span class="ident" id="4025183">x1</span><span class="op" id="4025185">,</span>&nbsp;<span class="op" id="4025187">&amp;</span><span class="ident" id="4025188">delta</span><span class="op" id="4025193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025196">p224Reduce</span><span class="op" id="4025206">(</span><span class="op" id="4025207">&amp;</span><span class="ident" id="4025208">alpha</span><span class="op" id="4025213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025216">p224Mul</span><span class="op" id="4025223">(</span><span class="op" id="4025224">&amp;</span><span class="ident" id="4025225">alpha</span><span class="op" id="4025230">,</span>&nbsp;<span class="op" id="4025232">&amp;</span><span class="ident" id="4025233">alpha</span><span class="op" id="4025238">,</span>&nbsp;<span class="op" id="4025240">&amp;</span><span class="ident" id="4025241">t</span><span class="op" id="4025242">,</span>&nbsp;<span class="op" id="4025244">&amp;</span><span class="ident" id="4025245">c</span><span class="op" id="4025246">)</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4025250">//&nbsp;Z3&nbsp;=&nbsp;(Y1+Z1)²-gamma-delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025281">p224Add</span><span class="op" id="4025288">(</span><span class="ident" id="4025289">z3</span><span class="op" id="4025291">,</span>&nbsp;<span class="ident" id="4025293">y1</span><span class="op" id="4025295">,</span>&nbsp;<span class="ident" id="4025297">z1</span><span class="op" id="4025299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025302">p224Reduce</span><span class="op" id="4025312">(</span><span class="ident" id="4025313">z3</span><span class="op" id="4025315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025318">p224Square</span><span class="op" id="4025328">(</span><span class="ident" id="4025329">z3</span><span class="op" id="4025331">,</span>&nbsp;<span class="ident" id="4025333">z3</span><span class="op" id="4025335">,</span>&nbsp;<span class="op" id="4025337">&amp;</span><span class="ident" id="4025338">c</span><span class="op" id="4025339">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025342">p224Sub</span><span class="op" id="4025349">(</span><span class="ident" id="4025350">z3</span><span class="op" id="4025352">,</span>&nbsp;<span class="ident" id="4025354">z3</span><span class="op" id="4025356">,</span>&nbsp;<span class="op" id="4025358">&amp;</span><span class="ident" id="4025359">gamma</span><span class="op" id="4025364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025367">p224Reduce</span><span class="op" id="4025377">(</span><span class="ident" id="4025378">z3</span><span class="op" id="4025380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025383">p224Sub</span><span class="op" id="4025390">(</span><span class="ident" id="4025391">z3</span><span class="op" id="4025393">,</span>&nbsp;<span class="ident" id="4025395">z3</span><span class="op" id="4025397">,</span>&nbsp;<span class="op" id="4025399">&amp;</span><span class="ident" id="4025400">delta</span><span class="op" id="4025405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025408">p224Reduce</span><span class="op" id="4025418">(</span><span class="ident" id="4025419">z3</span><span class="op" id="4025421">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4025425">//&nbsp;X3&nbsp;=&nbsp;alpha²-8*beta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025449">for</span>&nbsp;<span class="ident" id="4025453">i</span>&nbsp;<span class="op" id="4025455">:=</span>&nbsp;<span class="num" id="4025458">0</span><span class="op" id="4025459">;</span>&nbsp;<span class="ident" id="4025461">i</span>&nbsp;<span class="op" id="4025463">&lt;</span>&nbsp;<span class="num" id="4025465">8</span><span class="op" id="4025466">;</span>&nbsp;<span class="ident" id="4025468">i</span><span class="op" id="4025469">++</span>&nbsp;<span class="op" id="4025472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025476">delta</span><span class="op" id="4025481">[</span><span class="ident" id="4025482">i</span><span class="op" id="4025483">]</span>&nbsp;<span class="op" id="4025485">=</span>&nbsp;<span class="ident" id="4025487">beta</span><span class="op" id="4025491">[</span><span class="ident" id="4025492">i</span><span class="op" id="4025493">]</span>&nbsp;<span class="op" id="4025495">&lt;&lt;</span>&nbsp;<span class="num" id="4025498">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025504">p224Reduce</span><span class="op" id="4025514">(</span><span class="op" id="4025515">&amp;</span><span class="ident" id="4025516">delta</span><span class="op" id="4025521">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025524">p224Square</span><span class="op" id="4025534">(</span><span class="ident" id="4025535">x3</span><span class="op" id="4025537">,</span>&nbsp;<span class="op" id="4025539">&amp;</span><span class="ident" id="4025540">alpha</span><span class="op" id="4025545">,</span>&nbsp;<span class="op" id="4025547">&amp;</span><span class="ident" id="4025548">c</span><span class="op" id="4025549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025552">p224Sub</span><span class="op" id="4025559">(</span><span class="ident" id="4025560">x3</span><span class="op" id="4025562">,</span>&nbsp;<span class="ident" id="4025564">x3</span><span class="op" id="4025566">,</span>&nbsp;<span class="op" id="4025568">&amp;</span><span class="ident" id="4025569">delta</span><span class="op" id="4025574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025577">p224Reduce</span><span class="op" id="4025587">(</span><span class="ident" id="4025588">x3</span><span class="op" id="4025590">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4025594">//&nbsp;Y3&nbsp;=&nbsp;alpha*(4*beta-X3)-8*gamma²</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025631">for</span>&nbsp;<span class="ident" id="4025635">i</span>&nbsp;<span class="op" id="4025637">:=</span>&nbsp;<span class="num" id="4025640">0</span><span class="op" id="4025641">;</span>&nbsp;<span class="ident" id="4025643">i</span>&nbsp;<span class="op" id="4025645">&lt;</span>&nbsp;<span class="num" id="4025647">8</span><span class="op" id="4025648">;</span>&nbsp;<span class="ident" id="4025650">i</span><span class="op" id="4025651">++</span>&nbsp;<span class="op" id="4025654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025658">beta</span><span class="op" id="4025662">[</span><span class="ident" id="4025663">i</span><span class="op" id="4025664">]</span>&nbsp;<span class="op" id="4025666">&lt;&lt;=</span>&nbsp;<span class="num" id="4025670">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025676">p224Sub</span><span class="op" id="4025683">(</span><span class="op" id="4025684">&amp;</span><span class="ident" id="4025685">beta</span><span class="op" id="4025689">,</span>&nbsp;<span class="op" id="4025691">&amp;</span><span class="ident" id="4025692">beta</span><span class="op" id="4025696">,</span>&nbsp;<span class="ident" id="4025698">x3</span><span class="op" id="4025700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025703">p224Reduce</span><span class="op" id="4025713">(</span><span class="op" id="4025714">&amp;</span><span class="ident" id="4025715">beta</span><span class="op" id="4025719">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025722">p224Square</span><span class="op" id="4025732">(</span><span class="op" id="4025733">&amp;</span><span class="ident" id="4025734">gamma</span><span class="op" id="4025739">,</span>&nbsp;<span class="op" id="4025741">&amp;</span><span class="ident" id="4025742">gamma</span><span class="op" id="4025747">,</span>&nbsp;<span class="op" id="4025749">&amp;</span><span class="ident" id="4025750">c</span><span class="op" id="4025751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025754">for</span>&nbsp;<span class="ident" id="4025758">i</span>&nbsp;<span class="op" id="4025760">:=</span>&nbsp;<span class="num" id="4025763">0</span><span class="op" id="4025764">;</span>&nbsp;<span class="ident" id="4025766">i</span>&nbsp;<span class="op" id="4025768">&lt;</span>&nbsp;<span class="num" id="4025770">8</span><span class="op" id="4025771">;</span>&nbsp;<span class="ident" id="4025773">i</span><span class="op" id="4025774">++</span>&nbsp;<span class="op" id="4025777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025781">gamma</span><span class="op" id="4025786">[</span><span class="ident" id="4025787">i</span><span class="op" id="4025788">]</span>&nbsp;<span class="op" id="4025790">&lt;&lt;=</span>&nbsp;<span class="num" id="4025794">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025800">p224Reduce</span><span class="op" id="4025810">(</span><span class="op" id="4025811">&amp;</span><span class="ident" id="4025812">gamma</span><span class="op" id="4025817">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025820">p224Mul</span><span class="op" id="4025827">(</span><span class="ident" id="4025828">y3</span><span class="op" id="4025830">,</span>&nbsp;<span class="op" id="4025832">&amp;</span><span class="ident" id="4025833">alpha</span><span class="op" id="4025838">,</span>&nbsp;<span class="op" id="4025840">&amp;</span><span class="ident" id="4025841">beta</span><span class="op" id="4025845">,</span>&nbsp;<span class="op" id="4025847">&amp;</span><span class="ident" id="4025848">c</span><span class="op" id="4025849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025852">p224Sub</span><span class="op" id="4025859">(</span><span class="ident" id="4025860">y3</span><span class="op" id="4025862">,</span>&nbsp;<span class="ident" id="4025864">y3</span><span class="op" id="4025866">,</span>&nbsp;<span class="op" id="4025868">&amp;</span><span class="ident" id="4025869">gamma</span><span class="op" id="4025874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025877">p224Reduce</span><span class="op" id="4025887">(</span><span class="ident" id="4025888">y3</span><span class="op" id="4025890">)</span><br>
<span class="lineno"></span><span class="op" id="4025892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span><span class="comment" id="4025895">//&nbsp;p224CopyConditional&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in&nbsp;iff&nbsp;the&nbsp;least-significant-bit&nbsp;of&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="4025975">//&nbsp;is&nbsp;true,&nbsp;and&nbsp;it&nbsp;runs&nbsp;in&nbsp;constant&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4026017">func</span>&nbsp;<span class="ident" id="4026022">p224CopyConditional</span><span class="op" id="4026041">(</span><span class="ident" id="4026042">out</span><span class="op" id="4026045">,</span>&nbsp;<span class="ident" id="4026047">in</span>&nbsp;<span class="op" id="4026050">*</span><span class="ident" id="4026051">p224FieldElement</span><span class="op" id="4026067">,</span>&nbsp;<span class="ident" id="4026069">control</span>&nbsp;<span class="builtintype" id="4026077">uint32</span><span class="op" id="4026083">)</span>&nbsp;<span class="op" id="4026085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026088">control</span>&nbsp;<span class="op" id="4026096">&lt;&lt;=</span>&nbsp;<span class="num" id="4026100">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026104">control</span>&nbsp;<span class="op" id="4026112">=</span>&nbsp;<span class="builtintype" id="4026114">uint32</span><span class="op" id="4026120">(</span><span class="builtintype" id="4026121">int32</span><span class="op" id="4026126">(</span><span class="ident" id="4026127">control</span><span class="op" id="4026134">)</span>&nbsp;<span class="op" id="4026136">&gt;&gt;</span>&nbsp;<span class="num" id="4026139">31</span><span class="op" id="4026141">)</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026145">for</span>&nbsp;<span class="ident" id="4026149">i</span>&nbsp;<span class="op" id="4026151">:=</span>&nbsp;<span class="num" id="4026154">0</span><span class="op" id="4026155">;</span>&nbsp;<span class="ident" id="4026157">i</span>&nbsp;<span class="op" id="4026159">&lt;</span>&nbsp;<span class="num" id="4026161">8</span><span class="op" id="4026162">;</span>&nbsp;<span class="ident" id="4026164">i</span><span class="op" id="4026165">++</span>&nbsp;<span class="op" id="4026168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026172">out</span><span class="op" id="4026175">[</span><span class="ident" id="4026176">i</span><span class="op" id="4026177">]</span>&nbsp;<span class="op" id="4026179">^=</span>&nbsp;<span class="op" id="4026182">(</span><span class="ident" id="4026183">out</span><span class="op" id="4026186">[</span><span class="ident" id="4026187">i</span><span class="op" id="4026188">]</span>&nbsp;<span class="op" id="4026190">^</span>&nbsp;<span class="ident" id="4026192">in</span><span class="op" id="4026194">[</span><span class="ident" id="4026195">i</span><span class="op" id="4026196">]</span><span class="op" id="4026197">)</span>&nbsp;<span class="op" id="4026199">&amp;</span>&nbsp;<span class="ident" id="4026201">control</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026210">}</span><br>
<span class="lineno"></span><span class="op" id="4026212">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span><span class="keyword" id="4026215">func</span>&nbsp;<span class="ident" id="4026220">p224ScalarMult</span><span class="op" id="4026234">(</span><span class="ident" id="4026235">outX</span><span class="op" id="4026239">,</span>&nbsp;<span class="ident" id="4026241">outY</span><span class="op" id="4026245">,</span>&nbsp;<span class="ident" id="4026247">outZ</span><span class="op" id="4026251">,</span>&nbsp;<span class="ident" id="4026253">inX</span><span class="op" id="4026256">,</span>&nbsp;<span class="ident" id="4026258">inY</span><span class="op" id="4026261">,</span>&nbsp;<span class="ident" id="4026263">inZ</span>&nbsp;<span class="op" id="4026267">*</span><span class="ident" id="4026268">p224FieldElement</span><span class="op" id="4026284">,</span>&nbsp;<span class="ident" id="4026286">scalar</span>&nbsp;<span class="op" id="4026293">[</span><span class="op" id="4026294">]</span><span class="builtintype" id="4026295">byte</span><span class="op" id="4026299">)</span>&nbsp;<span class="op" id="4026301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026304">var</span>&nbsp;<span class="ident" id="4026308">xx</span><span class="op" id="4026310">,</span>&nbsp;<span class="ident" id="4026312">yy</span><span class="op" id="4026314">,</span>&nbsp;<span class="ident" id="4026316">zz</span>&nbsp;<span class="ident" id="4026319">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026337">for</span>&nbsp;<span class="ident" id="4026341">i</span>&nbsp;<span class="op" id="4026343">:=</span>&nbsp;<span class="num" id="4026346">0</span><span class="op" id="4026347">;</span>&nbsp;<span class="ident" id="4026349">i</span>&nbsp;<span class="op" id="4026351">&lt;</span>&nbsp;<span class="num" id="4026353">8</span><span class="op" id="4026354">;</span>&nbsp;<span class="ident" id="4026356">i</span><span class="op" id="4026357">++</span>&nbsp;<span class="op" id="4026360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026364">outX</span><span class="op" id="4026368">[</span><span class="ident" id="4026369">i</span><span class="op" id="4026370">]</span>&nbsp;<span class="op" id="4026372">=</span>&nbsp;<span class="num" id="4026374">0</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026378">outY</span><span class="op" id="4026382">[</span><span class="ident" id="4026383">i</span><span class="op" id="4026384">]</span>&nbsp;<span class="op" id="4026386">=</span>&nbsp;<span class="num" id="4026388">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026392">outZ</span><span class="op" id="4026396">[</span><span class="ident" id="4026397">i</span><span class="op" id="4026398">]</span>&nbsp;<span class="op" id="4026400">=</span>&nbsp;<span class="num" id="4026402">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026409">for</span>&nbsp;<span class="ident" id="4026413">_</span><span class="op" id="4026414">,</span>&nbsp;<span class="builtintype" id="4026416">byte</span>&nbsp;<span class="op" id="4026421">:=</span>&nbsp;<span class="keyword" id="4026424">range</span>&nbsp;<span class="ident" id="4026430">scalar</span>&nbsp;<span class="op" id="4026437">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026441">for</span>&nbsp;<span class="ident" id="4026445">bitNum</span>&nbsp;<span class="op" id="4026452">:=</span>&nbsp;<span class="builtintype" id="4026455">uint</span><span class="op" id="4026459">(</span><span class="num" id="4026460">0</span><span class="op" id="4026461">)</span><span class="op" id="4026462">;</span>&nbsp;<span class="ident" id="4026464">bitNum</span>&nbsp;<span class="op" id="4026471">&lt;</span>&nbsp;<span class="num" id="4026473">8</span><span class="op" id="4026474">;</span>&nbsp;<span class="ident" id="4026476">bitNum</span><span class="op" id="4026482">++</span>&nbsp;<span class="op" id="4026485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026490">p224DoubleJacobian</span><span class="op" id="4026508">(</span><span class="ident" id="4026509">outX</span><span class="op" id="4026513">,</span>&nbsp;<span class="ident" id="4026515">outY</span><span class="op" id="4026519">,</span>&nbsp;<span class="ident" id="4026521">outZ</span><span class="op" id="4026525">,</span>&nbsp;<span class="ident" id="4026527">outX</span><span class="op" id="4026531">,</span>&nbsp;<span class="ident" id="4026533">outY</span><span class="op" id="4026537">,</span>&nbsp;<span class="ident" id="4026539">outZ</span><span class="op" id="4026543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026548">bit</span>&nbsp;<span class="op" id="4026552">:=</span>&nbsp;<span class="builtintype" id="4026555">uint32</span><span class="op" id="4026561">(</span><span class="op" id="4026562">(</span><span class="builtintype" id="4026563">byte</span>&nbsp;<span class="op" id="4026568">&gt;&gt;</span>&nbsp;<span class="op" id="4026571">(</span><span class="num" id="4026572">7</span>&nbsp;<span class="op" id="4026574">-</span>&nbsp;<span class="ident" id="4026576">bitNum</span><span class="op" id="4026582">)</span><span class="op" id="4026583">)</span>&nbsp;<span class="op" id="4026585">&amp;</span>&nbsp;<span class="num" id="4026587">1</span><span class="op" id="4026588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026593">p224AddJacobian</span><span class="op" id="4026608">(</span><span class="op" id="4026609">&amp;</span><span class="ident" id="4026610">xx</span><span class="op" id="4026612">,</span>&nbsp;<span class="op" id="4026614">&amp;</span><span class="ident" id="4026615">yy</span><span class="op" id="4026617">,</span>&nbsp;<span class="op" id="4026619">&amp;</span><span class="ident" id="4026620">zz</span><span class="op" id="4026622">,</span>&nbsp;<span class="ident" id="4026624">inX</span><span class="op" id="4026627">,</span>&nbsp;<span class="ident" id="4026629">inY</span><span class="op" id="4026632">,</span>&nbsp;<span class="ident" id="4026634">inZ</span><span class="op" id="4026637">,</span>&nbsp;<span class="ident" id="4026639">outX</span><span class="op" id="4026643">,</span>&nbsp;<span class="ident" id="4026645">outY</span><span class="op" id="4026649">,</span>&nbsp;<span class="ident" id="4026651">outZ</span><span class="op" id="4026655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026660">p224CopyConditional</span><span class="op" id="4026679">(</span><span class="ident" id="4026680">outX</span><span class="op" id="4026684">,</span>&nbsp;<span class="op" id="4026686">&amp;</span><span class="ident" id="4026687">xx</span><span class="op" id="4026689">,</span>&nbsp;<span class="ident" id="4026691">bit</span><span class="op" id="4026694">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026699">p224CopyConditional</span><span class="op" id="4026718">(</span><span class="ident" id="4026719">outY</span><span class="op" id="4026723">,</span>&nbsp;<span class="op" id="4026725">&amp;</span><span class="ident" id="4026726">yy</span><span class="op" id="4026728">,</span>&nbsp;<span class="ident" id="4026730">bit</span><span class="op" id="4026733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026738">p224CopyConditional</span><span class="op" id="4026757">(</span><span class="ident" id="4026758">outZ</span><span class="op" id="4026762">,</span>&nbsp;<span class="op" id="4026764">&amp;</span><span class="ident" id="4026765">zz</span><span class="op" id="4026767">,</span>&nbsp;<span class="ident" id="4026769">bit</span><span class="op" id="4026772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4026779">}</span><br>
<span class="lineno"></span><span class="op" id="4026781">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="4026784">//&nbsp;p224ToAffine&nbsp;converts&nbsp;from&nbsp;Jacobian&nbsp;to&nbsp;affine&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4026839">func</span>&nbsp;<span class="ident" id="4026844">p224ToAffine</span><span class="op" id="4026856">(</span><span class="ident" id="4026857">x</span><span class="op" id="4026858">,</span>&nbsp;<span class="ident" id="4026860">y</span><span class="op" id="4026861">,</span>&nbsp;<span class="ident" id="4026863">z</span>&nbsp;<span class="op" id="4026865">*</span><span class="ident" id="4026866">p224FieldElement</span><span class="op" id="4026882">)</span>&nbsp;<span class="op" id="4026884">(</span><span class="op" id="4026885">*</span><span class="ident" id="4026886">big</span><span class="op" id="4026889">.</span><span class="ident" id="4026890">Int</span><span class="op" id="4026893">,</span>&nbsp;<span class="op" id="4026895">*</span><span class="ident" id="4026896">big</span><span class="op" id="4026899">.</span><span class="ident" id="4026900">Int</span><span class="op" id="4026903">)</span>&nbsp;<span class="op" id="4026905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026908">var</span>&nbsp;<span class="ident" id="4026912">zinv</span><span class="op" id="4026916">,</span>&nbsp;<span class="ident" id="4026918">zinvsq</span><span class="op" id="4026924">,</span>&nbsp;<span class="ident" id="4026926">outx</span><span class="op" id="4026930">,</span>&nbsp;<span class="ident" id="4026932">outy</span>&nbsp;<span class="ident" id="4026937">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026955">var</span>&nbsp;<span class="ident" id="4026959">tmp</span>&nbsp;<span class="ident" id="4026963">p224LargeFieldElement</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026987">if</span>&nbsp;<span class="ident" id="4026990">isPointAtInfinity</span>&nbsp;<span class="op" id="4027008">:=</span>&nbsp;<span class="ident" id="4027011">p224IsZero</span><span class="op" id="4027021">(</span><span class="ident" id="4027022">z</span><span class="op" id="4027023">)</span><span class="op" id="4027024">;</span>&nbsp;<span class="ident" id="4027026">isPointAtInfinity</span>&nbsp;<span class="op" id="4027044">==</span>&nbsp;<span class="num" id="4027047">1</span>&nbsp;<span class="op" id="4027049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027053">return</span>&nbsp;<span class="builtinfunc" id="4027060">new</span><span class="op" id="4027063">(</span><span class="ident" id="4027064">big</span><span class="op" id="4027067">.</span><span class="ident" id="4027068">Int</span><span class="op" id="4027071">)</span><span class="op" id="4027072">,</span>&nbsp;<span class="builtinfunc" id="4027074">new</span><span class="op" id="4027077">(</span><span class="ident" id="4027078">big</span><span class="op" id="4027081">.</span><span class="ident" id="4027082">Int</span><span class="op" id="4027085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027092">p224Invert</span><span class="op" id="4027102">(</span><span class="op" id="4027103">&amp;</span><span class="ident" id="4027104">zinv</span><span class="op" id="4027108">,</span>&nbsp;<span class="ident" id="4027110">z</span><span class="op" id="4027111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027114">p224Square</span><span class="op" id="4027124">(</span><span class="op" id="4027125">&amp;</span><span class="ident" id="4027126">zinvsq</span><span class="op" id="4027132">,</span>&nbsp;<span class="op" id="4027134">&amp;</span><span class="ident" id="4027135">zinv</span><span class="op" id="4027139">,</span>&nbsp;<span class="op" id="4027141">&amp;</span><span class="ident" id="4027142">tmp</span><span class="op" id="4027145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027148">p224Mul</span><span class="op" id="4027155">(</span><span class="ident" id="4027156">x</span><span class="op" id="4027157">,</span>&nbsp;<span class="ident" id="4027159">x</span><span class="op" id="4027160">,</span>&nbsp;<span class="op" id="4027162">&amp;</span><span class="ident" id="4027163">zinvsq</span><span class="op" id="4027169">,</span>&nbsp;<span class="op" id="4027171">&amp;</span><span class="ident" id="4027172">tmp</span><span class="op" id="4027175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027178">p224Mul</span><span class="op" id="4027185">(</span><span class="op" id="4027186">&amp;</span><span class="ident" id="4027187">zinvsq</span><span class="op" id="4027193">,</span>&nbsp;<span class="op" id="4027195">&amp;</span><span class="ident" id="4027196">zinvsq</span><span class="op" id="4027202">,</span>&nbsp;<span class="op" id="4027204">&amp;</span><span class="ident" id="4027205">zinv</span><span class="op" id="4027209">,</span>&nbsp;<span class="op" id="4027211">&amp;</span><span class="ident" id="4027212">tmp</span><span class="op" id="4027215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027218">p224Mul</span><span class="op" id="4027225">(</span><span class="ident" id="4027226">y</span><span class="op" id="4027227">,</span>&nbsp;<span class="ident" id="4027229">y</span><span class="op" id="4027230">,</span>&nbsp;<span class="op" id="4027232">&amp;</span><span class="ident" id="4027233">zinvsq</span><span class="op" id="4027239">,</span>&nbsp;<span class="op" id="4027241">&amp;</span><span class="ident" id="4027242">tmp</span><span class="op" id="4027245">)</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027249">p224Contract</span><span class="op" id="4027261">(</span><span class="op" id="4027262">&amp;</span><span class="ident" id="4027263">outx</span><span class="op" id="4027267">,</span>&nbsp;<span class="ident" id="4027269">x</span><span class="op" id="4027270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027273">p224Contract</span><span class="op" id="4027285">(</span><span class="op" id="4027286">&amp;</span><span class="ident" id="4027287">outy</span><span class="op" id="4027291">,</span>&nbsp;<span class="ident" id="4027293">y</span><span class="op" id="4027294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027297">return</span>&nbsp;<span class="ident" id="4027304">p224ToBig</span><span class="op" id="4027313">(</span><span class="op" id="4027314">&amp;</span><span class="ident" id="4027315">outx</span><span class="op" id="4027319">)</span><span class="op" id="4027320">,</span>&nbsp;<span class="ident" id="4027322">p224ToBig</span><span class="op" id="4027331">(</span><span class="op" id="4027332">&amp;</span><span class="ident" id="4027333">outy</span><span class="op" id="4027337">)</span><br>
<span class="lineno"></span><span class="op" id="4027339">}</span><br>
<span class="lineno">690</span><br>
<span class="lineno"></span><span class="comment" id="4027342">//&nbsp;get28BitsFromEnd&nbsp;returns&nbsp;the&nbsp;least-significant&nbsp;28&nbsp;bits&nbsp;from&nbsp;buf&gt;&gt;shift,</span><br>
<span class="lineno"></span><span class="comment" id="4027417">//&nbsp;where&nbsp;buf&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;big-endian&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4027469">func</span>&nbsp;<span class="ident" id="4027474">get28BitsFromEnd</span><span class="op" id="4027490">(</span><span class="ident" id="4027491">buf</span>&nbsp;<span class="op" id="4027495">[</span><span class="op" id="4027496">]</span><span class="builtintype" id="4027497">byte</span><span class="op" id="4027501">,</span>&nbsp;<span class="ident" id="4027503">shift</span>&nbsp;<span class="builtintype" id="4027509">uint</span><span class="op" id="4027513">)</span>&nbsp;<span class="op" id="4027515">(</span><span class="builtintype" id="4027516">uint32</span><span class="op" id="4027522">,</span>&nbsp;<span class="op" id="4027524">[</span><span class="op" id="4027525">]</span><span class="builtintype" id="4027526">byte</span><span class="op" id="4027530">)</span>&nbsp;<span class="op" id="4027532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027535">var</span>&nbsp;<span class="ident" id="4027539">ret</span>&nbsp;<span class="builtintype" id="4027543">uint32</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027552">for</span>&nbsp;<span class="ident" id="4027556">i</span>&nbsp;<span class="op" id="4027558">:=</span>&nbsp;<span class="builtintype" id="4027561">uint</span><span class="op" id="4027565">(</span><span class="num" id="4027566">0</span><span class="op" id="4027567">)</span><span class="op" id="4027568">;</span>&nbsp;<span class="ident" id="4027570">i</span>&nbsp;<span class="op" id="4027572">&lt;</span>&nbsp;<span class="num" id="4027574">4</span><span class="op" id="4027575">;</span>&nbsp;<span class="ident" id="4027577">i</span><span class="op" id="4027578">++</span>&nbsp;<span class="op" id="4027581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027585">var</span>&nbsp;<span class="ident" id="4027589">b</span>&nbsp;<span class="builtintype" id="4027591">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027598">if</span>&nbsp;<span class="ident" id="4027601">l</span>&nbsp;<span class="op" id="4027603">:=</span>&nbsp;<span class="builtinfunc" id="4027606">len</span><span class="op" id="4027609">(</span><span class="ident" id="4027610">buf</span><span class="op" id="4027613">)</span><span class="op" id="4027614">;</span>&nbsp;<span class="ident" id="4027616">l</span>&nbsp;<span class="op" id="4027618">&gt;</span>&nbsp;<span class="num" id="4027620">0</span>&nbsp;<span class="op" id="4027622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027627">b</span>&nbsp;<span class="op" id="4027629">=</span>&nbsp;<span class="ident" id="4027631">buf</span><span class="op" id="4027634">[</span><span class="ident" id="4027635">l</span><span class="op" id="4027636">-</span><span class="num" id="4027637">1</span><span class="op" id="4027638">]</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4027643">//&nbsp;We&nbsp;don&#39;t&nbsp;remove&nbsp;the&nbsp;byte&nbsp;if&nbsp;we&#39;re&nbsp;about&nbsp;to&nbsp;return&nbsp;and&nbsp;we&#39;re&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4027713">//&nbsp;reading&nbsp;all&nbsp;of&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027738">if</span>&nbsp;<span class="ident" id="4027741">i</span>&nbsp;<span class="op" id="4027743">!=</span>&nbsp;<span class="num" id="4027746">3</span>&nbsp;<span class="op" id="4027748">||</span>&nbsp;<span class="ident" id="4027751">shift</span>&nbsp;<span class="op" id="4027757">==</span>&nbsp;<span class="num" id="4027760">4</span>&nbsp;<span class="op" id="4027762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027768">buf</span>&nbsp;<span class="op" id="4027772">=</span>&nbsp;<span class="ident" id="4027774">buf</span><span class="op" id="4027777">[</span><span class="op" id="4027778">:</span><span class="ident" id="4027779">l</span><span class="op" id="4027780">-</span><span class="num" id="4027781">1</span><span class="op" id="4027782">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027787">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027795">ret</span>&nbsp;<span class="op" id="4027799">|=</span>&nbsp;<span class="builtintype" id="4027802">uint32</span><span class="op" id="4027808">(</span><span class="ident" id="4027809">b</span><span class="op" id="4027810">)</span>&nbsp;<span class="op" id="4027812">&lt;&lt;</span>&nbsp;<span class="op" id="4027815">(</span><span class="num" id="4027816">8</span>&nbsp;<span class="op" id="4027818">*</span>&nbsp;<span class="ident" id="4027820">i</span><span class="op" id="4027821">)</span>&nbsp;<span class="op" id="4027823">&gt;&gt;</span>&nbsp;<span class="ident" id="4027826">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027836">ret</span>&nbsp;<span class="op" id="4027840">&amp;=</span>&nbsp;<span class="ident" id="4027843">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027857">return</span>&nbsp;<span class="ident" id="4027864">ret</span><span class="op" id="4027867">,</span>&nbsp;<span class="ident" id="4027869">buf</span><br>
<span class="lineno">710</span><span class="op" id="4027873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4027876">//&nbsp;p224FromBig&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in.</span><br>
<span class="lineno"></span><span class="keyword" id="4027908">func</span>&nbsp;<span class="ident" id="4027913">p224FromBig</span><span class="op" id="4027924">(</span><span class="ident" id="4027925">out</span>&nbsp;<span class="op" id="4027929">*</span><span class="ident" id="4027930">p224FieldElement</span><span class="op" id="4027946">,</span>&nbsp;<span class="ident" id="4027948">in</span>&nbsp;<span class="op" id="4027951">*</span><span class="ident" id="4027952">big</span><span class="op" id="4027955">.</span><span class="ident" id="4027956">Int</span><span class="op" id="4027959">)</span>&nbsp;<span class="op" id="4027961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027964">bytes</span>&nbsp;<span class="op" id="4027970">:=</span>&nbsp;<span class="ident" id="4027973">in</span><span class="op" id="4027975">.</span><span class="ident" id="4027976">Bytes</span><span class="op" id="4027981">(</span><span class="op" id="4027982">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027985">out</span><span class="op" id="4027988">[</span><span class="num" id="4027989">0</span><span class="op" id="4027990">]</span><span class="op" id="4027991">,</span>&nbsp;<span class="ident" id="4027993">bytes</span>&nbsp;<span class="op" id="4027999">=</span>&nbsp;<span class="ident" id="4028001">get28BitsFromEnd</span><span class="op" id="4028017">(</span><span class="ident" id="4028018">bytes</span><span class="op" id="4028023">,</span>&nbsp;<span class="num" id="4028025">0</span><span class="op" id="4028026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028029">out</span><span class="op" id="4028032">[</span><span class="num" id="4028033">1</span><span class="op" id="4028034">]</span><span class="op" id="4028035">,</span>&nbsp;<span class="ident" id="4028037">bytes</span>&nbsp;<span class="op" id="4028043">=</span>&nbsp;<span class="ident" id="4028045">get28BitsFromEnd</span><span class="op" id="4028061">(</span><span class="ident" id="4028062">bytes</span><span class="op" id="4028067">,</span>&nbsp;<span class="num" id="4028069">4</span><span class="op" id="4028070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028073">out</span><span class="op" id="4028076">[</span><span class="num" id="4028077">2</span><span class="op" id="4028078">]</span><span class="op" id="4028079">,</span>&nbsp;<span class="ident" id="4028081">bytes</span>&nbsp;<span class="op" id="4028087">=</span>&nbsp;<span class="ident" id="4028089">get28BitsFromEnd</span><span class="op" id="4028105">(</span><span class="ident" id="4028106">bytes</span><span class="op" id="4028111">,</span>&nbsp;<span class="num" id="4028113">0</span><span class="op" id="4028114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028117">out</span><span class="op" id="4028120">[</span><span class="num" id="4028121">3</span><span class="op" id="4028122">]</span><span class="op" id="4028123">,</span>&nbsp;<span class="ident" id="4028125">bytes</span>&nbsp;<span class="op" id="4028131">=</span>&nbsp;<span class="ident" id="4028133">get28BitsFromEnd</span><span class="op" id="4028149">(</span><span class="ident" id="4028150">bytes</span><span class="op" id="4028155">,</span>&nbsp;<span class="num" id="4028157">4</span><span class="op" id="4028158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028161">out</span><span class="op" id="4028164">[</span><span class="num" id="4028165">4</span><span class="op" id="4028166">]</span><span class="op" id="4028167">,</span>&nbsp;<span class="ident" id="4028169">bytes</span>&nbsp;<span class="op" id="4028175">=</span>&nbsp;<span class="ident" id="4028177">get28BitsFromEnd</span><span class="op" id="4028193">(</span><span class="ident" id="4028194">bytes</span><span class="op" id="4028199">,</span>&nbsp;<span class="num" id="4028201">0</span><span class="op" id="4028202">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028205">out</span><span class="op" id="4028208">[</span><span class="num" id="4028209">5</span><span class="op" id="4028210">]</span><span class="op" id="4028211">,</span>&nbsp;<span class="ident" id="4028213">bytes</span>&nbsp;<span class="op" id="4028219">=</span>&nbsp;<span class="ident" id="4028221">get28BitsFromEnd</span><span class="op" id="4028237">(</span><span class="ident" id="4028238">bytes</span><span class="op" id="4028243">,</span>&nbsp;<span class="num" id="4028245">4</span><span class="op" id="4028246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028249">out</span><span class="op" id="4028252">[</span><span class="num" id="4028253">6</span><span class="op" id="4028254">]</span><span class="op" id="4028255">,</span>&nbsp;<span class="ident" id="4028257">bytes</span>&nbsp;<span class="op" id="4028263">=</span>&nbsp;<span class="ident" id="4028265">get28BitsFromEnd</span><span class="op" id="4028281">(</span><span class="ident" id="4028282">bytes</span><span class="op" id="4028287">,</span>&nbsp;<span class="num" id="4028289">0</span><span class="op" id="4028290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028293">out</span><span class="op" id="4028296">[</span><span class="num" id="4028297">7</span><span class="op" id="4028298">]</span><span class="op" id="4028299">,</span>&nbsp;<span class="ident" id="4028301">bytes</span>&nbsp;<span class="op" id="4028307">=</span>&nbsp;<span class="ident" id="4028309">get28BitsFromEnd</span><span class="op" id="4028325">(</span><span class="ident" id="4028326">bytes</span><span class="op" id="4028331">,</span>&nbsp;<span class="num" id="4028333">4</span><span class="op" id="4028334">)</span><br>
<span class="lineno"></span><span class="op" id="4028336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="comment" id="4028339">//&nbsp;p224ToBig&nbsp;returns&nbsp;in&nbsp;as&nbsp;a&nbsp;big.Int.</span><br>
<span class="lineno"></span><span class="keyword" id="4028377">func</span>&nbsp;<span class="ident" id="4028382">p224ToBig</span><span class="op" id="4028391">(</span><span class="ident" id="4028392">in</span>&nbsp;<span class="op" id="4028395">*</span><span class="ident" id="4028396">p224FieldElement</span><span class="op" id="4028412">)</span>&nbsp;<span class="op" id="4028414">*</span><span class="ident" id="4028415">big</span><span class="op" id="4028418">.</span><span class="ident" id="4028419">Int</span>&nbsp;<span class="op" id="4028423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028426">var</span>&nbsp;<span class="ident" id="4028430">buf</span>&nbsp;<span class="op" id="4028434">[</span><span class="num" id="4028435">28</span><span class="op" id="4028437">]</span><span class="builtintype" id="4028438">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028444">buf</span><span class="op" id="4028447">[</span><span class="num" id="4028448">27</span><span class="op" id="4028450">]</span>&nbsp;<span class="op" id="4028452">=</span>&nbsp;<span class="builtintype" id="4028454">byte</span><span class="op" id="4028458">(</span><span class="ident" id="4028459">in</span><span class="op" id="4028461">[</span><span class="num" id="4028462">0</span><span class="op" id="4028463">]</span><span class="op" id="4028464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028467">buf</span><span class="op" id="4028470">[</span><span class="num" id="4028471">26</span><span class="op" id="4028473">]</span>&nbsp;<span class="op" id="4028475">=</span>&nbsp;<span class="builtintype" id="4028477">byte</span><span class="op" id="4028481">(</span><span class="ident" id="4028482">in</span><span class="op" id="4028484">[</span><span class="num" id="4028485">0</span><span class="op" id="4028486">]</span>&nbsp;<span class="op" id="4028488">&gt;&gt;</span>&nbsp;<span class="num" id="4028491">8</span><span class="op" id="4028492">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028495">buf</span><span class="op" id="4028498">[</span><span class="num" id="4028499">25</span><span class="op" id="4028501">]</span>&nbsp;<span class="op" id="4028503">=</span>&nbsp;<span class="builtintype" id="4028505">byte</span><span class="op" id="4028509">(</span><span class="ident" id="4028510">in</span><span class="op" id="4028512">[</span><span class="num" id="4028513">0</span><span class="op" id="4028514">]</span>&nbsp;<span class="op" id="4028516">&gt;&gt;</span>&nbsp;<span class="num" id="4028519">16</span><span class="op" id="4028521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028524">buf</span><span class="op" id="4028527">[</span><span class="num" id="4028528">24</span><span class="op" id="4028530">]</span>&nbsp;<span class="op" id="4028532">=</span>&nbsp;<span class="builtintype" id="4028534">byte</span><span class="op" id="4028538">(</span><span class="op" id="4028539">(</span><span class="op" id="4028540">(</span><span class="ident" id="4028541">in</span><span class="op" id="4028543">[</span><span class="num" id="4028544">0</span><span class="op" id="4028545">]</span>&nbsp;<span class="op" id="4028547">&gt;&gt;</span>&nbsp;<span class="num" id="4028550">24</span><span class="op" id="4028552">)</span>&nbsp;<span class="op" id="4028554">&amp;</span>&nbsp;<span class="num" id="4028556">0x0f</span><span class="op" id="4028560">)</span>&nbsp;<span class="op" id="4028562">|</span>&nbsp;<span class="op" id="4028564">(</span><span class="ident" id="4028565">in</span><span class="op" id="4028567">[</span><span class="num" id="4028568">1</span><span class="op" id="4028569">]</span><span class="op" id="4028570">&lt;&lt;</span><span class="num" id="4028572">4</span><span class="op" id="4028573">)</span><span class="op" id="4028574">&amp;</span><span class="num" id="4028575">0xf0</span><span class="op" id="4028579">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028583">buf</span><span class="op" id="4028586">[</span><span class="num" id="4028587">23</span><span class="op" id="4028589">]</span>&nbsp;<span class="op" id="4028591">=</span>&nbsp;<span class="builtintype" id="4028593">byte</span><span class="op" id="4028597">(</span><span class="ident" id="4028598">in</span><span class="op" id="4028600">[</span><span class="num" id="4028601">1</span><span class="op" id="4028602">]</span>&nbsp;<span class="op" id="4028604">&gt;&gt;</span>&nbsp;<span class="num" id="4028607">4</span><span class="op" id="4028608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028611">buf</span><span class="op" id="4028614">[</span><span class="num" id="4028615">22</span><span class="op" id="4028617">]</span>&nbsp;<span class="op" id="4028619">=</span>&nbsp;<span class="builtintype" id="4028621">byte</span><span class="op" id="4028625">(</span><span class="ident" id="4028626">in</span><span class="op" id="4028628">[</span><span class="num" id="4028629">1</span><span class="op" id="4028630">]</span>&nbsp;<span class="op" id="4028632">&gt;&gt;</span>&nbsp;<span class="num" id="4028635">12</span><span class="op" id="4028637">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028640">buf</span><span class="op" id="4028643">[</span><span class="num" id="4028644">21</span><span class="op" id="4028646">]</span>&nbsp;<span class="op" id="4028648">=</span>&nbsp;<span class="builtintype" id="4028650">byte</span><span class="op" id="4028654">(</span><span class="ident" id="4028655">in</span><span class="op" id="4028657">[</span><span class="num" id="4028658">1</span><span class="op" id="4028659">]</span>&nbsp;<span class="op" id="4028661">&gt;&gt;</span>&nbsp;<span class="num" id="4028664">20</span><span class="op" id="4028666">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028670">buf</span><span class="op" id="4028673">[</span><span class="num" id="4028674">20</span><span class="op" id="4028676">]</span>&nbsp;<span class="op" id="4028678">=</span>&nbsp;<span class="builtintype" id="4028680">byte</span><span class="op" id="4028684">(</span><span class="ident" id="4028685">in</span><span class="op" id="4028687">[</span><span class="num" id="4028688">2</span><span class="op" id="4028689">]</span><span class="op" id="4028690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028693">buf</span><span class="op" id="4028696">[</span><span class="num" id="4028697">19</span><span class="op" id="4028699">]</span>&nbsp;<span class="op" id="4028701">=</span>&nbsp;<span class="builtintype" id="4028703">byte</span><span class="op" id="4028707">(</span><span class="ident" id="4028708">in</span><span class="op" id="4028710">[</span><span class="num" id="4028711">2</span><span class="op" id="4028712">]</span>&nbsp;<span class="op" id="4028714">&gt;&gt;</span>&nbsp;<span class="num" id="4028717">8</span><span class="op" id="4028718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028721">buf</span><span class="op" id="4028724">[</span><span class="num" id="4028725">18</span><span class="op" id="4028727">]</span>&nbsp;<span class="op" id="4028729">=</span>&nbsp;<span class="builtintype" id="4028731">byte</span><span class="op" id="4028735">(</span><span class="ident" id="4028736">in</span><span class="op" id="4028738">[</span><span class="num" id="4028739">2</span><span class="op" id="4028740">]</span>&nbsp;<span class="op" id="4028742">&gt;&gt;</span>&nbsp;<span class="num" id="4028745">16</span><span class="op" id="4028747">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028750">buf</span><span class="op" id="4028753">[</span><span class="num" id="4028754">17</span><span class="op" id="4028756">]</span>&nbsp;<span class="op" id="4028758">=</span>&nbsp;<span class="builtintype" id="4028760">byte</span><span class="op" id="4028764">(</span><span class="op" id="4028765">(</span><span class="op" id="4028766">(</span><span class="ident" id="4028767">in</span><span class="op" id="4028769">[</span><span class="num" id="4028770">2</span><span class="op" id="4028771">]</span>&nbsp;<span class="op" id="4028773">&gt;&gt;</span>&nbsp;<span class="num" id="4028776">24</span><span class="op" id="4028778">)</span>&nbsp;<span class="op" id="4028780">&amp;</span>&nbsp;<span class="num" id="4028782">0x0f</span><span class="op" id="4028786">)</span>&nbsp;<span class="op" id="4028788">|</span>&nbsp;<span class="op" id="4028790">(</span><span class="ident" id="4028791">in</span><span class="op" id="4028793">[</span><span class="num" id="4028794">3</span><span class="op" id="4028795">]</span><span class="op" id="4028796">&lt;&lt;</span><span class="num" id="4028798">4</span><span class="op" id="4028799">)</span><span class="op" id="4028800">&amp;</span><span class="num" id="4028801">0xf0</span><span class="op" id="4028805">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028809">buf</span><span class="op" id="4028812">[</span><span class="num" id="4028813">16</span><span class="op" id="4028815">]</span>&nbsp;<span class="op" id="4028817">=</span>&nbsp;<span class="builtintype" id="4028819">byte</span><span class="op" id="4028823">(</span><span class="ident" id="4028824">in</span><span class="op" id="4028826">[</span><span class="num" id="4028827">3</span><span class="op" id="4028828">]</span>&nbsp;<span class="op" id="4028830">&gt;&gt;</span>&nbsp;<span class="num" id="4028833">4</span><span class="op" id="4028834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028837">buf</span><span class="op" id="4028840">[</span><span class="num" id="4028841">15</span><span class="op" id="4028843">]</span>&nbsp;<span class="op" id="4028845">=</span>&nbsp;<span class="builtintype" id="4028847">byte</span><span class="op" id="4028851">(</span><span class="ident" id="4028852">in</span><span class="op" id="4028854">[</span><span class="num" id="4028855">3</span><span class="op" id="4028856">]</span>&nbsp;<span class="op" id="4028858">&gt;&gt;</span>&nbsp;<span class="num" id="4028861">12</span><span class="op" id="4028863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028866">buf</span><span class="op" id="4028869">[</span><span class="num" id="4028870">14</span><span class="op" id="4028872">]</span>&nbsp;<span class="op" id="4028874">=</span>&nbsp;<span class="builtintype" id="4028876">byte</span><span class="op" id="4028880">(</span><span class="ident" id="4028881">in</span><span class="op" id="4028883">[</span><span class="num" id="4028884">3</span><span class="op" id="4028885">]</span>&nbsp;<span class="op" id="4028887">&gt;&gt;</span>&nbsp;<span class="num" id="4028890">20</span><span class="op" id="4028892">)</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028896">buf</span><span class="op" id="4028899">[</span><span class="num" id="4028900">13</span><span class="op" id="4028902">]</span>&nbsp;<span class="op" id="4028904">=</span>&nbsp;<span class="builtintype" id="4028906">byte</span><span class="op" id="4028910">(</span><span class="ident" id="4028911">in</span><span class="op" id="4028913">[</span><span class="num" id="4028914">4</span><span class="op" id="4028915">]</span><span class="op" id="4028916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028919">buf</span><span class="op" id="4028922">[</span><span class="num" id="4028923">12</span><span class="op" id="4028925">]</span>&nbsp;<span class="op" id="4028927">=</span>&nbsp;<span class="builtintype" id="4028929">byte</span><span class="op" id="4028933">(</span><span class="ident" id="4028934">in</span><span class="op" id="4028936">[</span><span class="num" id="4028937">4</span><span class="op" id="4028938">]</span>&nbsp;<span class="op" id="4028940">&gt;&gt;</span>&nbsp;<span class="num" id="4028943">8</span><span class="op" id="4028944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028947">buf</span><span class="op" id="4028950">[</span><span class="num" id="4028951">11</span><span class="op" id="4028953">]</span>&nbsp;<span class="op" id="4028955">=</span>&nbsp;<span class="builtintype" id="4028957">byte</span><span class="op" id="4028961">(</span><span class="ident" id="4028962">in</span><span class="op" id="4028964">[</span><span class="num" id="4028965">4</span><span class="op" id="4028966">]</span>&nbsp;<span class="op" id="4028968">&gt;&gt;</span>&nbsp;<span class="num" id="4028971">16</span><span class="op" id="4028973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028976">buf</span><span class="op" id="4028979">[</span><span class="num" id="4028980">10</span><span class="op" id="4028982">]</span>&nbsp;<span class="op" id="4028984">=</span>&nbsp;<span class="builtintype" id="4028986">byte</span><span class="op" id="4028990">(</span><span class="op" id="4028991">(</span><span class="op" id="4028992">(</span><span class="ident" id="4028993">in</span><span class="op" id="4028995">[</span><span class="num" id="4028996">4</span><span class="op" id="4028997">]</span>&nbsp;<span class="op" id="4028999">&gt;&gt;</span>&nbsp;<span class="num" id="4029002">24</span><span class="op" id="4029004">)</span>&nbsp;<span class="op" id="4029006">&amp;</span>&nbsp;<span class="num" id="4029008">0x0f</span><span class="op" id="4029012">)</span>&nbsp;<span class="op" id="4029014">|</span>&nbsp;<span class="op" id="4029016">(</span><span class="ident" id="4029017">in</span><span class="op" id="4029019">[</span><span class="num" id="4029020">5</span><span class="op" id="4029021">]</span><span class="op" id="4029022">&lt;&lt;</span><span class="num" id="4029024">4</span><span class="op" id="4029025">)</span><span class="op" id="4029026">&amp;</span><span class="num" id="4029027">0xf0</span><span class="op" id="4029031">)</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029035">buf</span><span class="op" id="4029038">[</span><span class="num" id="4029039">9</span><span class="op" id="4029040">]</span>&nbsp;<span class="op" id="4029042">=</span>&nbsp;<span class="builtintype" id="4029044">byte</span><span class="op" id="4029048">(</span><span class="ident" id="4029049">in</span><span class="op" id="4029051">[</span><span class="num" id="4029052">5</span><span class="op" id="4029053">]</span>&nbsp;<span class="op" id="4029055">&gt;&gt;</span>&nbsp;<span class="num" id="4029058">4</span><span class="op" id="4029059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029062">buf</span><span class="op" id="4029065">[</span><span class="num" id="4029066">8</span><span class="op" id="4029067">]</span>&nbsp;<span class="op" id="4029069">=</span>&nbsp;<span class="builtintype" id="4029071">byte</span><span class="op" id="4029075">(</span><span class="ident" id="4029076">in</span><span class="op" id="4029078">[</span><span class="num" id="4029079">5</span><span class="op" id="4029080">]</span>&nbsp;<span class="op" id="4029082">&gt;&gt;</span>&nbsp;<span class="num" id="4029085">12</span><span class="op" id="4029087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029090">buf</span><span class="op" id="4029093">[</span><span class="num" id="4029094">7</span><span class="op" id="4029095">]</span>&nbsp;<span class="op" id="4029097">=</span>&nbsp;<span class="builtintype" id="4029099">byte</span><span class="op" id="4029103">(</span><span class="ident" id="4029104">in</span><span class="op" id="4029106">[</span><span class="num" id="4029107">5</span><span class="op" id="4029108">]</span>&nbsp;<span class="op" id="4029110">&gt;&gt;</span>&nbsp;<span class="num" id="4029113">20</span><span class="op" id="4029115">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029119">buf</span><span class="op" id="4029122">[</span><span class="num" id="4029123">6</span><span class="op" id="4029124">]</span>&nbsp;<span class="op" id="4029126">=</span>&nbsp;<span class="builtintype" id="4029128">byte</span><span class="op" id="4029132">(</span><span class="ident" id="4029133">in</span><span class="op" id="4029135">[</span><span class="num" id="4029136">6</span><span class="op" id="4029137">]</span><span class="op" id="4029138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029141">buf</span><span class="op" id="4029144">[</span><span class="num" id="4029145">5</span><span class="op" id="4029146">]</span>&nbsp;<span class="op" id="4029148">=</span>&nbsp;<span class="builtintype" id="4029150">byte</span><span class="op" id="4029154">(</span><span class="ident" id="4029155">in</span><span class="op" id="4029157">[</span><span class="num" id="4029158">6</span><span class="op" id="4029159">]</span>&nbsp;<span class="op" id="4029161">&gt;&gt;</span>&nbsp;<span class="num" id="4029164">8</span><span class="op" id="4029165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029168">buf</span><span class="op" id="4029171">[</span><span class="num" id="4029172">4</span><span class="op" id="4029173">]</span>&nbsp;<span class="op" id="4029175">=</span>&nbsp;<span class="builtintype" id="4029177">byte</span><span class="op" id="4029181">(</span><span class="ident" id="4029182">in</span><span class="op" id="4029184">[</span><span class="num" id="4029185">6</span><span class="op" id="4029186">]</span>&nbsp;<span class="op" id="4029188">&gt;&gt;</span>&nbsp;<span class="num" id="4029191">16</span><span class="op" id="4029193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029196">buf</span><span class="op" id="4029199">[</span><span class="num" id="4029200">3</span><span class="op" id="4029201">]</span>&nbsp;<span class="op" id="4029203">=</span>&nbsp;<span class="builtintype" id="4029205">byte</span><span class="op" id="4029209">(</span><span class="op" id="4029210">(</span><span class="op" id="4029211">(</span><span class="ident" id="4029212">in</span><span class="op" id="4029214">[</span><span class="num" id="4029215">6</span><span class="op" id="4029216">]</span>&nbsp;<span class="op" id="4029218">&gt;&gt;</span>&nbsp;<span class="num" id="4029221">24</span><span class="op" id="4029223">)</span>&nbsp;<span class="op" id="4029225">&amp;</span>&nbsp;<span class="num" id="4029227">0x0f</span><span class="op" id="4029231">)</span>&nbsp;<span class="op" id="4029233">|</span>&nbsp;<span class="op" id="4029235">(</span><span class="ident" id="4029236">in</span><span class="op" id="4029238">[</span><span class="num" id="4029239">7</span><span class="op" id="4029240">]</span><span class="op" id="4029241">&lt;&lt;</span><span class="num" id="4029243">4</span><span class="op" id="4029244">)</span><span class="op" id="4029245">&amp;</span><span class="num" id="4029246">0xf0</span><span class="op" id="4029250">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029254">buf</span><span class="op" id="4029257">[</span><span class="num" id="4029258">2</span><span class="op" id="4029259">]</span>&nbsp;<span class="op" id="4029261">=</span>&nbsp;<span class="builtintype" id="4029263">byte</span><span class="op" id="4029267">(</span><span class="ident" id="4029268">in</span><span class="op" id="4029270">[</span><span class="num" id="4029271">7</span><span class="op" id="4029272">]</span>&nbsp;<span class="op" id="4029274">&gt;&gt;</span>&nbsp;<span class="num" id="4029277">4</span><span class="op" id="4029278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029281">buf</span><span class="op" id="4029284">[</span><span class="num" id="4029285">1</span><span class="op" id="4029286">]</span>&nbsp;<span class="op" id="4029288">=</span>&nbsp;<span class="builtintype" id="4029290">byte</span><span class="op" id="4029294">(</span><span class="ident" id="4029295">in</span><span class="op" id="4029297">[</span><span class="num" id="4029298">7</span><span class="op" id="4029299">]</span>&nbsp;<span class="op" id="4029301">&gt;&gt;</span>&nbsp;<span class="num" id="4029304">12</span><span class="op" id="4029306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029309">buf</span><span class="op" id="4029312">[</span><span class="num" id="4029313">0</span><span class="op" id="4029314">]</span>&nbsp;<span class="op" id="4029316">=</span>&nbsp;<span class="builtintype" id="4029318">byte</span><span class="op" id="4029322">(</span><span class="ident" id="4029323">in</span><span class="op" id="4029325">[</span><span class="num" id="4029326">7</span><span class="op" id="4029327">]</span>&nbsp;<span class="op" id="4029329">&gt;&gt;</span>&nbsp;<span class="num" id="4029332">20</span><span class="op" id="4029334">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029338">return</span>&nbsp;<span class="builtinfunc" id="4029345">new</span><span class="op" id="4029348">(</span><span class="ident" id="4029349">big</span><span class="op" id="4029352">.</span><span class="ident" id="4029353">Int</span><span class="op" id="4029356">)</span><span class="op" id="4029357">.</span><span class="ident" id="4029358">SetBytes</span><span class="op" id="4029366">(</span><span class="ident" id="4029367">buf</span><span class="op" id="4029370">[</span><span class="op" id="4029371">:</span><span class="op" id="4029372">]</span><span class="op" id="4029373">)</span><br>
<span class="lineno">765</span><span class="op" id="4029375">}</span>
</div>
</body>
</html>
