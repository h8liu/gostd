<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html" class="current">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3302141">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3302197">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3302251">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3302302">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3302380">package</span>&nbsp;<span class="ident" id="3302388">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3302393">import</span>&nbsp;<span class="op" id="3302400">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3302403">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3302414">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3302421">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3302424">//&nbsp;BUG(mikio):&nbsp;On&nbsp;every&nbsp;POSIX&nbsp;platform,&nbsp;reads&nbsp;from&nbsp;the&nbsp;&#34;ip4&#34;&nbsp;network</span><br>
<span class="lineno">15</span><span class="comment" id="3302493">//&nbsp;using&nbsp;the&nbsp;ReadFrom&nbsp;or&nbsp;ReadFromIP&nbsp;method&nbsp;might&nbsp;not&nbsp;return&nbsp;a&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="3302564">//&nbsp;IPv4&nbsp;packet,&nbsp;including&nbsp;its&nbsp;header,&nbsp;even&nbsp;if&nbsp;there&nbsp;is&nbsp;space</span><br>
<span class="lineno"></span><span class="comment" id="3302625">//&nbsp;available.&nbsp;This&nbsp;can&nbsp;occur&nbsp;even&nbsp;in&nbsp;cases&nbsp;where&nbsp;Read&nbsp;or&nbsp;ReadMsgIP</span><br>
<span class="lineno"></span><span class="comment" id="3302692">//&nbsp;could&nbsp;return&nbsp;a&nbsp;complete&nbsp;packet.&nbsp;For&nbsp;this&nbsp;reason,&nbsp;it&nbsp;is&nbsp;recommended</span><br>
<span class="lineno"></span><span class="comment" id="3302762">//&nbsp;that&nbsp;you&nbsp;do&nbsp;not&nbsp;uses&nbsp;these&nbsp;methods&nbsp;if&nbsp;it&nbsp;is&nbsp;important&nbsp;to&nbsp;receive&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="3302832">//&nbsp;full&nbsp;packet.</span><br>
<span class="lineno"></span><span class="comment" id="3302848">//</span><br>
<span class="lineno"></span><span class="comment" id="3302851">//&nbsp;The&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines&nbsp;make&nbsp;it&nbsp;impossible&nbsp;for&nbsp;us&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3302917">//&nbsp;change&nbsp;the&nbsp;behavior&nbsp;of&nbsp;these&nbsp;methods;&nbsp;use&nbsp;Read&nbsp;or&nbsp;ReadMsgIP</span><br>
<span class="lineno"></span><span class="comment" id="3302980">//&nbsp;instead.</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="3302993">func</span>&nbsp;<span class="ident" id="3302998">sockaddrToIP</span><span class="op" id="3303010">(</span><span class="ident" id="3303011">sa</span>&nbsp;<span class="ident" id="3303014"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3303021">.</span><span class="ident" id="3303022"><a href="/gostd/syscall/syscall_unix.go.html#2547075">Sockaddr</a></span><span class="op" id="3303030">)</span>&nbsp;<span class="ident" id="3303032"><a href="/gostd/net/net.go.html#3334179">Addr</a></span>&nbsp;<span class="op" id="3303037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303040">switch</span>&nbsp;<span class="ident" id="3303047">sa</span>&nbsp;<span class="op" id="3303050">:=</span>&nbsp;<span class="ident" id="3303053"><a href="/gostd/net/iprawsock_posix.go.html#3303011">sa</a></span><span class="op" id="3303055">.</span><span class="op" id="3303056">(</span><span class="keyword" id="3303057">type</span><span class="op" id="3303061">)</span>&nbsp;<span class="op" id="3303063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303066">case</span>&nbsp;<span class="op" id="3303071">*</span><span class="ident" id="3303072"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3303079">.</span><span class="ident" id="3303080"><a href="/gostd/syscall/syscall_unix.go.html#2547205">SockaddrInet4</a></span><span class="op" id="3303093">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303097">return</span>&nbsp;<span class="op" id="3303104">&amp;</span><span class="ident" id="3303105"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3303111">{</span><span class="ident" id="3303112"><a href="/gostd/net/iprawsock.go.html#3301135">IP</a></span><span class="op" id="3303114">:</span>&nbsp;<span class="ident" id="3303116"><a href="/gostd/net/iprawsock_posix.go.html#3303047">sa</a></span><span class="op" id="3303118">.</span><span class="ident" id="3303119"><a href="/gostd/syscall/syscall_unix.go.html#2547239">Addr</a></span><span class="op" id="3303123">[</span><span class="num" id="3303124">0</span><span class="op" id="3303125">:</span><span class="op" id="3303126">]</span><span class="op" id="3303127">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303130">case</span>&nbsp;<span class="op" id="3303135">*</span><span class="ident" id="3303136"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3303143">.</span><span class="ident" id="3303144"><a href="/gostd/syscall/syscall_unix.go.html#2547283">SockaddrInet6</a></span><span class="op" id="3303157">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303161">return</span>&nbsp;<span class="op" id="3303168">&amp;</span><span class="ident" id="3303169"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3303175">{</span><span class="ident" id="3303176"><a href="/gostd/net/iprawsock.go.html#3301135">IP</a></span><span class="op" id="3303178">:</span>&nbsp;<span class="ident" id="3303180"><a href="/gostd/net/iprawsock_posix.go.html#3303047">sa</a></span><span class="op" id="3303182">.</span><span class="ident" id="3303183"><a href="/gostd/syscall/syscall_unix.go.html#2547334">Addr</a></span><span class="op" id="3303187">[</span><span class="num" id="3303188">0</span><span class="op" id="3303189">:</span><span class="op" id="3303190">]</span><span class="op" id="3303191">,</span>&nbsp;<span class="ident" id="3303193"><a href="/gostd/net/iprawsock.go.html#3301144">Zone</a></span><span class="op" id="3303197">:</span>&nbsp;<span class="ident" id="3303199"><a href="/gostd/net/ipsock.go.html#3317149">zoneToString</a></span><span class="op" id="3303211">(</span><span class="builtintype" id="3303212">int</span><span class="op" id="3303215">(</span><span class="ident" id="3303216"><a href="/gostd/net/iprawsock_posix.go.html#3303047">sa</a></span><span class="op" id="3303218">.</span><span class="ident" id="3303219"><a href="/gostd/syscall/syscall_unix.go.html#2547319">ZoneId</a></span><span class="op" id="3303225">)</span><span class="op" id="3303226">)</span><span class="op" id="3303227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3303230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303233">return</span>&nbsp;<span class="builtintype" id="3303240">nil</span><br>
<span class="lineno"></span><span class="op" id="3303244">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="3303247">func</span>&nbsp;<span class="op" id="3303252">(</span><span class="ident" id="3303253">a</span>&nbsp;<span class="op" id="3303255">*</span><span class="ident" id="3303256"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3303262">)</span>&nbsp;<span class="ident" id="3303264">family</span><span class="op" id="3303270">(</span><span class="op" id="3303271">)</span>&nbsp;<span class="builtintype" id="3303273">int</span>&nbsp;<span class="op" id="3303277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303280">if</span>&nbsp;<span class="ident" id="3303283"><a href="/gostd/net/iprawsock_posix.go.html#3303253">a</a></span>&nbsp;<span class="op" id="3303285">==</span>&nbsp;<span class="builtintype" id="3303288">nil</span>&nbsp;<span class="op" id="3303292">||</span>&nbsp;<span class="builtinfunc" id="3303295">len</span><span class="op" id="3303298">(</span><span class="ident" id="3303299"><a href="/gostd/net/iprawsock_posix.go.html#3303253">a</a></span><span class="op" id="3303300">.</span><span class="ident" id="3303301"><a href="/gostd/net/iprawsock.go.html#3301135">IP</a></span><span class="op" id="3303303">)</span>&nbsp;<span class="op" id="3303305">&lt;=</span>&nbsp;<span class="ident" id="3303308"><a href="/gostd/net/ip.go.html#3285851">IPv4len</a></span>&nbsp;<span class="op" id="3303316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303320">return</span>&nbsp;<span class="ident" id="3303327"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3303334">.</span><span class="ident" id="3303335"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2551244">AF_INET</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3303344">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303347">if</span>&nbsp;<span class="ident" id="3303350"><a href="/gostd/net/iprawsock_posix.go.html#3303253">a</a></span><span class="op" id="3303351">.</span><span class="ident" id="3303352"><a href="/gostd/net/iprawsock.go.html#3301135">IP</a></span><span class="op" id="3303354">.</span><span class="ident" id="3303355"><a href="/gostd/net/ip.go.html#3290039">To4</a></span><span class="op" id="3303358">(</span><span class="op" id="3303359">)</span>&nbsp;<span class="op" id="3303361">!=</span>&nbsp;<span class="builtintype" id="3303364">nil</span>&nbsp;<span class="op" id="3303368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303372">return</span>&nbsp;<span class="ident" id="3303379"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3303386">.</span><span class="ident" id="3303387"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2551244">AF_INET</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3303396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303399">return</span>&nbsp;<span class="ident" id="3303406"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3303413">.</span><span class="ident" id="3303414"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2551284">AF_INET6</a></span><br>
<span class="lineno"></span><span class="op" id="3303423">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="3303426">func</span>&nbsp;<span class="op" id="3303431">(</span><span class="ident" id="3303432">a</span>&nbsp;<span class="op" id="3303434">*</span><span class="ident" id="3303435"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3303441">)</span>&nbsp;<span class="ident" id="3303443">isWildcard</span><span class="op" id="3303453">(</span><span class="op" id="3303454">)</span>&nbsp;<span class="builtintype" id="3303456">bool</span>&nbsp;<span class="op" id="3303461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303464">if</span>&nbsp;<span class="ident" id="3303467"><a href="/gostd/net/iprawsock_posix.go.html#3303432">a</a></span>&nbsp;<span class="op" id="3303469">==</span>&nbsp;<span class="builtintype" id="3303472">nil</span>&nbsp;<span class="op" id="3303476">||</span>&nbsp;<span class="ident" id="3303479"><a href="/gostd/net/iprawsock_posix.go.html#3303432">a</a></span><span class="op" id="3303480">.</span><span class="ident" id="3303481"><a href="/gostd/net/iprawsock.go.html#3301135">IP</a></span>&nbsp;<span class="op" id="3303484">==</span>&nbsp;<span class="builtintype" id="3303487">nil</span>&nbsp;<span class="op" id="3303491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303495">return</span>&nbsp;<span class="builtintype" id="3303502">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3303508">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303511">return</span>&nbsp;<span class="ident" id="3303518"><a href="/gostd/net/iprawsock_posix.go.html#3303432">a</a></span><span class="op" id="3303519">.</span><span class="ident" id="3303520"><a href="/gostd/net/iprawsock.go.html#3301135">IP</a></span><span class="op" id="3303522">.</span><span class="ident" id="3303523"><a href="/gostd/net/ip.go.html#3288341">IsUnspecified</a></span><span class="op" id="3303536">(</span><span class="op" id="3303537">)</span><br>
<span class="lineno"></span><span class="op" id="3303539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3303542">func</span>&nbsp;<span class="op" id="3303547">(</span><span class="ident" id="3303548">a</span>&nbsp;<span class="op" id="3303550">*</span><span class="ident" id="3303551"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3303557">)</span>&nbsp;<span class="ident" id="3303559">sockaddr</span><span class="op" id="3303567">(</span><span class="ident" id="3303568">family</span>&nbsp;<span class="builtintype" id="3303575">int</span><span class="op" id="3303578">)</span>&nbsp;<span class="op" id="3303580">(</span><span class="ident" id="3303581"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3303588">.</span><span class="ident" id="3303589"><a href="/gostd/syscall/syscall_unix.go.html#2547075">Sockaddr</a></span><span class="op" id="3303597">,</span>&nbsp;<span class="builtintype" id="3303599">error</span><span class="op" id="3303604">)</span>&nbsp;<span class="op" id="3303606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303609">if</span>&nbsp;<span class="ident" id="3303612"><a href="/gostd/net/iprawsock_posix.go.html#3303548">a</a></span>&nbsp;<span class="op" id="3303614">==</span>&nbsp;<span class="builtintype" id="3303617">nil</span>&nbsp;<span class="op" id="3303621">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303625">return</span>&nbsp;<span class="builtintype" id="3303632">nil</span><span class="op" id="3303635">,</span>&nbsp;<span class="builtintype" id="3303637">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3303642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3303645">return</span>&nbsp;<span class="ident" id="3303652"><a href="/gostd/net/ipsock_posix.go.html#3322112">ipToSockaddr</a></span><span class="op" id="3303664">(</span><span class="ident" id="3303665"><a href="/gostd/net/iprawsock_posix.go.html#3303568">family</a></span><span class="op" id="3303671">,</span>&nbsp;<span class="ident" id="3303673"><a href="/gostd/net/iprawsock_posix.go.html#3303548">a</a></span><span class="op" id="3303674">.</span><span class="ident" id="3303675"><a href="/gostd/net/iprawsock.go.html#3301135">IP</a></span><span class="op" id="3303677">,</span>&nbsp;<span class="num" id="3303679">0</span><span class="op" id="3303680">,</span>&nbsp;<span class="ident" id="3303682"><a href="/gostd/net/iprawsock_posix.go.html#3303548">a</a></span><span class="op" id="3303683">.</span><span class="ident" id="3303684"><a href="/gostd/net/iprawsock.go.html#3301144">Zone</a></span><span class="op" id="3303688">)</span><br>
<span class="lineno"></span><span class="op" id="3303690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="3303693">//&nbsp;IPConn&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;Conn&nbsp;and&nbsp;PacketConn&nbsp;interfaces</span><br>
<span class="lineno"></span><span class="comment" id="3303763">//&nbsp;for&nbsp;IP&nbsp;network&nbsp;connections.</span><br>
<span class="lineno"></span><span class="keyword" id="3303794">type</span>&nbsp;<span class="ident" id="3303799">IPConn</span>&nbsp;<span class="keyword" id="3303806">struct</span>&nbsp;<span class="op" id="3303813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3303816"><a href="/gostd/net/net.go.html#3336184">conn</a></span><br>
<span class="lineno"></span><span class="op" id="3303821">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3303824">func</span>&nbsp;<span class="ident" id="3303829">newIPConn</span><span class="op" id="3303838">(</span><span class="ident" id="3303839">fd</span>&nbsp;<span class="op" id="3303842">*</span><span class="ident" id="3303843"><a href="/gostd/net/fd_unix.go.html#3257361">netFD</a></span><span class="op" id="3303848">)</span>&nbsp;<span class="op" id="3303850">*</span><span class="ident" id="3303851"><a href="/gostd/net/iprawsock_posix.go.html#3303799">IPConn</a></span>&nbsp;<span class="op" id="3303858">{</span>&nbsp;<span class="keyword" id="3303860">return</span>&nbsp;<span class="op" id="3303867">&amp;</span><span class="ident" id="3303868"><a href="/gostd/net/iprawsock_posix.go.html#3303799">IPConn</a></span><span class="op" id="3303874">{</span><span class="ident" id="3303875"><a href="/gostd/net/net.go.html#3336184">conn</a></span><span class="op" id="3303879">{</span><span class="ident" id="3303880"><a href="/gostd/net/iprawsock_posix.go.html#3303839">fd</a></span><span class="op" id="3303882">}</span><span class="op" id="3303883">}</span>&nbsp;<span class="op" id="3303885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3303888">//&nbsp;ReadFromIP&nbsp;reads&nbsp;an&nbsp;IP&nbsp;packet&nbsp;from&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b.</span><br>
<span class="lineno"></span><span class="comment" id="3303957">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b&nbsp;and&nbsp;the&nbsp;return&nbsp;address</span><br>
<span class="lineno">70</span><span class="comment" id="3304028">//&nbsp;that&nbsp;was&nbsp;on&nbsp;the&nbsp;packet.</span><br>
<span class="lineno"></span><span class="comment" id="3304055">//</span><br>
<span class="lineno"></span><span class="comment" id="3304058">//&nbsp;ReadFromIP&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;an&nbsp;error&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="3304121">//&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3304188">//&nbsp;SetReadDeadline.</span><br>
<span class="lineno">75</span><span class="keyword" id="3304208">func</span>&nbsp;<span class="op" id="3304213">(</span><span class="ident" id="3304214">c</span>&nbsp;<span class="op" id="3304216">*</span><span class="ident" id="3304217"><a href="/gostd/net/iprawsock_posix.go.html#3303799">IPConn</a></span><span class="op" id="3304223">)</span>&nbsp;<span class="ident" id="3304225">ReadFromIP</span><span class="op" id="3304235">(</span><span class="ident" id="3304236">b</span>&nbsp;<span class="op" id="3304238">[</span><span class="op" id="3304239">]</span><span class="builtintype" id="3304240">byte</span><span class="op" id="3304244">)</span>&nbsp;<span class="op" id="3304246">(</span><span class="builtintype" id="3304247">int</span><span class="op" id="3304250">,</span>&nbsp;<span class="op" id="3304252">*</span><span class="ident" id="3304253"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3304259">,</span>&nbsp;<span class="builtintype" id="3304261">error</span><span class="op" id="3304266">)</span>&nbsp;<span class="op" id="3304268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304271">if</span>&nbsp;<span class="op" id="3304274">!</span><span class="ident" id="3304275"><a href="/gostd/net/iprawsock_posix.go.html#3304214">c</a></span><span class="op" id="3304276">.</span><span class="ident" id="3304277"><a href="/gostd/net/net.go.html#3336227">ok</a></span><span class="op" id="3304279">(</span><span class="op" id="3304280">)</span>&nbsp;<span class="op" id="3304282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304286">return</span>&nbsp;<span class="num" id="3304293">0</span><span class="op" id="3304294">,</span>&nbsp;<span class="builtintype" id="3304296">nil</span><span class="op" id="3304299">,</span>&nbsp;<span class="ident" id="3304301"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3304308">.</span><span class="ident" id="3304309"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3304320">//&nbsp;TODO(cw,rsc):&nbsp;consider&nbsp;using&nbsp;readv&nbsp;if&nbsp;we&nbsp;know&nbsp;the&nbsp;family</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3304381">//&nbsp;type&nbsp;to&nbsp;avoid&nbsp;the&nbsp;header&nbsp;trim/copy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304420">var</span>&nbsp;<span class="ident" id="3304424">addr</span>&nbsp;<span class="op" id="3304429">*</span><span class="ident" id="3304430"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304438">n</span><span class="op" id="3304439">,</span>&nbsp;<span class="ident" id="3304441">sa</span><span class="op" id="3304443">,</span>&nbsp;<span class="ident" id="3304445">err</span>&nbsp;<span class="op" id="3304449">:=</span>&nbsp;<span class="ident" id="3304452"><a href="/gostd/net/iprawsock_posix.go.html#3304214">c</a></span><span class="op" id="3304453">.</span><span class="ident" id="3304454"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3304456">.</span><span class="ident" id="3304457"><a href="/gostd/net/fd_unix.go.html#3262995">readFrom</a></span><span class="op" id="3304465">(</span><span class="ident" id="3304466"><a href="/gostd/net/iprawsock_posix.go.html#3304236">b</a></span><span class="op" id="3304467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304470">switch</span>&nbsp;<span class="ident" id="3304477">sa</span>&nbsp;<span class="op" id="3304480">:=</span>&nbsp;<span class="ident" id="3304483"><a href="/gostd/net/iprawsock_posix.go.html#3304441">sa</a></span><span class="op" id="3304485">.</span><span class="op" id="3304486">(</span><span class="keyword" id="3304487">type</span><span class="op" id="3304491">)</span>&nbsp;<span class="op" id="3304493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304496">case</span>&nbsp;<span class="op" id="3304501">*</span><span class="ident" id="3304502"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3304509">.</span><span class="ident" id="3304510"><a href="/gostd/syscall/syscall_unix.go.html#2547205">SockaddrInet4</a></span><span class="op" id="3304523">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304527"><a href="/gostd/net/iprawsock_posix.go.html#3304424">addr</a></span>&nbsp;<span class="op" id="3304532">=</span>&nbsp;<span class="op" id="3304534">&amp;</span><span class="ident" id="3304535"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3304541">{</span><span class="ident" id="3304542"><a href="/gostd/net/iprawsock.go.html#3301135">IP</a></span><span class="op" id="3304544">:</span>&nbsp;<span class="ident" id="3304546"><a href="/gostd/net/iprawsock_posix.go.html#3304477">sa</a></span><span class="op" id="3304548">.</span><span class="ident" id="3304549"><a href="/gostd/syscall/syscall_unix.go.html#2547239">Addr</a></span><span class="op" id="3304553">[</span><span class="num" id="3304554">0</span><span class="op" id="3304555">:</span><span class="op" id="3304556">]</span><span class="op" id="3304557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304561">if</span>&nbsp;<span class="builtinfunc" id="3304564">len</span><span class="op" id="3304567">(</span><span class="ident" id="3304568"><a href="/gostd/net/iprawsock_posix.go.html#3304236">b</a></span><span class="op" id="3304569">)</span>&nbsp;<span class="op" id="3304571">&gt;=</span>&nbsp;<span class="ident" id="3304574"><a href="/gostd/net/ip.go.html#3285851">IPv4len</a></span>&nbsp;<span class="op" id="3304582">{</span>&nbsp;<span class="comment" id="3304584">//&nbsp;discard&nbsp;ipv4&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304610">hsize</span>&nbsp;<span class="op" id="3304616">:=</span>&nbsp;<span class="op" id="3304619">(</span><span class="builtintype" id="3304620">int</span><span class="op" id="3304623">(</span><span class="ident" id="3304624"><a href="/gostd/net/iprawsock_posix.go.html#3304236">b</a></span><span class="op" id="3304625">[</span><span class="num" id="3304626">0</span><span class="op" id="3304627">]</span><span class="op" id="3304628">)</span>&nbsp;<span class="op" id="3304630">&amp;</span>&nbsp;<span class="num" id="3304632">0xf</span><span class="op" id="3304635">)</span>&nbsp;<span class="op" id="3304637">*</span>&nbsp;<span class="num" id="3304639">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3304644">copy</span><span class="op" id="3304648">(</span><span class="ident" id="3304649"><a href="/gostd/net/iprawsock_posix.go.html#3304236">b</a></span><span class="op" id="3304650">,</span>&nbsp;<span class="ident" id="3304652"><a href="/gostd/net/iprawsock_posix.go.html#3304236">b</a></span><span class="op" id="3304653">[</span><span class="ident" id="3304654"><a href="/gostd/net/iprawsock_posix.go.html#3304610">hsize</a></span><span class="op" id="3304659">:</span><span class="op" id="3304660">]</span><span class="op" id="3304661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304666"><a href="/gostd/net/iprawsock_posix.go.html#3304438">n</a></span>&nbsp;<span class="op" id="3304668">-=</span>&nbsp;<span class="ident" id="3304671"><a href="/gostd/net/iprawsock_posix.go.html#3304610">hsize</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304682">case</span>&nbsp;<span class="op" id="3304687">*</span><span class="ident" id="3304688"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3304695">.</span><span class="ident" id="3304696"><a href="/gostd/syscall/syscall_unix.go.html#2547283">SockaddrInet6</a></span><span class="op" id="3304709">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304713"><a href="/gostd/net/iprawsock_posix.go.html#3304424">addr</a></span>&nbsp;<span class="op" id="3304718">=</span>&nbsp;<span class="op" id="3304720">&amp;</span><span class="ident" id="3304721"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3304727">{</span><span class="ident" id="3304728"><a href="/gostd/net/iprawsock.go.html#3301135">IP</a></span><span class="op" id="3304730">:</span>&nbsp;<span class="ident" id="3304732"><a href="/gostd/net/iprawsock_posix.go.html#3304477">sa</a></span><span class="op" id="3304734">.</span><span class="ident" id="3304735"><a href="/gostd/syscall/syscall_unix.go.html#2547334">Addr</a></span><span class="op" id="3304739">[</span><span class="num" id="3304740">0</span><span class="op" id="3304741">:</span><span class="op" id="3304742">]</span><span class="op" id="3304743">,</span>&nbsp;<span class="ident" id="3304745"><a href="/gostd/net/iprawsock.go.html#3301144">Zone</a></span><span class="op" id="3304749">:</span>&nbsp;<span class="ident" id="3304751"><a href="/gostd/net/ipsock.go.html#3317149">zoneToString</a></span><span class="op" id="3304763">(</span><span class="builtintype" id="3304764">int</span><span class="op" id="3304767">(</span><span class="ident" id="3304768"><a href="/gostd/net/iprawsock_posix.go.html#3304477">sa</a></span><span class="op" id="3304770">.</span><span class="ident" id="3304771"><a href="/gostd/syscall/syscall_unix.go.html#2547319">ZoneId</a></span><span class="op" id="3304777">)</span><span class="op" id="3304778">)</span><span class="op" id="3304779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304785">return</span>&nbsp;<span class="ident" id="3304792"><a href="/gostd/net/iprawsock_posix.go.html#3304438">n</a></span><span class="op" id="3304793">,</span>&nbsp;<span class="ident" id="3304795"><a href="/gostd/net/iprawsock_posix.go.html#3304424">addr</a></span><span class="op" id="3304799">,</span>&nbsp;<span class="ident" id="3304801"><a href="/gostd/net/iprawsock_posix.go.html#3304445">err</a></span><br>
<span class="lineno">95</span><span class="op" id="3304805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3304808">//&nbsp;ReadFrom&nbsp;implements&nbsp;the&nbsp;PacketConn&nbsp;ReadFrom&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3304863">func</span>&nbsp;<span class="op" id="3304868">(</span><span class="ident" id="3304869">c</span>&nbsp;<span class="op" id="3304871">*</span><span class="ident" id="3304872"><a href="/gostd/net/iprawsock_posix.go.html#3303799">IPConn</a></span><span class="op" id="3304878">)</span>&nbsp;<span class="ident" id="3304880">ReadFrom</span><span class="op" id="3304888">(</span><span class="ident" id="3304889">b</span>&nbsp;<span class="op" id="3304891">[</span><span class="op" id="3304892">]</span><span class="builtintype" id="3304893">byte</span><span class="op" id="3304897">)</span>&nbsp;<span class="op" id="3304899">(</span><span class="builtintype" id="3304900">int</span><span class="op" id="3304903">,</span>&nbsp;<span class="ident" id="3304905"><a href="/gostd/net/net.go.html#3334179">Addr</a></span><span class="op" id="3304909">,</span>&nbsp;<span class="builtintype" id="3304911">error</span><span class="op" id="3304916">)</span>&nbsp;<span class="op" id="3304918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304921">if</span>&nbsp;<span class="op" id="3304924">!</span><span class="ident" id="3304925"><a href="/gostd/net/iprawsock_posix.go.html#3304869">c</a></span><span class="op" id="3304926">.</span><span class="ident" id="3304927"><a href="/gostd/net/net.go.html#3336227">ok</a></span><span class="op" id="3304929">(</span><span class="op" id="3304930">)</span>&nbsp;<span class="op" id="3304932">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3304936">return</span>&nbsp;<span class="num" id="3304943">0</span><span class="op" id="3304944">,</span>&nbsp;<span class="builtintype" id="3304946">nil</span><span class="op" id="3304949">,</span>&nbsp;<span class="ident" id="3304951"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3304958">.</span><span class="ident" id="3304959"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3304970">n</span><span class="op" id="3304971">,</span>&nbsp;<span class="ident" id="3304973">addr</span><span class="op" id="3304977">,</span>&nbsp;<span class="ident" id="3304979">err</span>&nbsp;<span class="op" id="3304983">:=</span>&nbsp;<span class="ident" id="3304986"><a href="/gostd/net/iprawsock_posix.go.html#3304869">c</a></span><span class="op" id="3304987">.</span><span class="ident" id="3304988"><a href="/gostd/net/iprawsock_posix.go.html#3304225">ReadFromIP</a></span><span class="op" id="3304998">(</span><span class="ident" id="3304999"><a href="/gostd/net/iprawsock_posix.go.html#3304889">b</a></span><span class="op" id="3305000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305003">return</span>&nbsp;<span class="ident" id="3305010"><a href="/gostd/net/iprawsock_posix.go.html#3304970">n</a></span><span class="op" id="3305011">,</span>&nbsp;<span class="ident" id="3305013"><a href="/gostd/net/iprawsock_posix.go.html#3304973">addr</a></span><span class="op" id="3305017">.</span><span class="ident" id="3305018"><a href="/gostd/net/iprawsock.go.html#3301466">toAddr</a></span><span class="op" id="3305024">(</span><span class="op" id="3305025">)</span><span class="op" id="3305026">,</span>&nbsp;<span class="ident" id="3305028"><a href="/gostd/net/iprawsock_posix.go.html#3304979">err</a></span><br>
<span class="lineno"></span><span class="op" id="3305032">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="3305035">//&nbsp;ReadMsgIP&nbsp;reads&nbsp;a&nbsp;packet&nbsp;from&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b&nbsp;and&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3305106">//&nbsp;associated&nbsp;out-of-band&nbsp;data&nbsp;into&nbsp;oob.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3305173">//&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b,&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;oob,&nbsp;the&nbsp;flags</span><br>
<span class="lineno"></span><span class="comment" id="3305244">//&nbsp;that&nbsp;were&nbsp;set&nbsp;on&nbsp;the&nbsp;packet&nbsp;and&nbsp;the&nbsp;source&nbsp;address&nbsp;of&nbsp;the&nbsp;packet.</span><br>
<span class="lineno">110</span><span class="keyword" id="3305313">func</span>&nbsp;<span class="op" id="3305318">(</span><span class="ident" id="3305319">c</span>&nbsp;<span class="op" id="3305321">*</span><span class="ident" id="3305322"><a href="/gostd/net/iprawsock_posix.go.html#3303799">IPConn</a></span><span class="op" id="3305328">)</span>&nbsp;<span class="ident" id="3305330">ReadMsgIP</span><span class="op" id="3305339">(</span><span class="ident" id="3305340">b</span><span class="op" id="3305341">,</span>&nbsp;<span class="ident" id="3305343">oob</span>&nbsp;<span class="op" id="3305347">[</span><span class="op" id="3305348">]</span><span class="builtintype" id="3305349">byte</span><span class="op" id="3305353">)</span>&nbsp;<span class="op" id="3305355">(</span><span class="ident" id="3305356">n</span><span class="op" id="3305357">,</span>&nbsp;<span class="ident" id="3305359">oobn</span><span class="op" id="3305363">,</span>&nbsp;<span class="ident" id="3305365">flags</span>&nbsp;<span class="builtintype" id="3305371">int</span><span class="op" id="3305374">,</span>&nbsp;<span class="ident" id="3305376">addr</span>&nbsp;<span class="op" id="3305381">*</span><span class="ident" id="3305382"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3305388">,</span>&nbsp;<span class="ident" id="3305390">err</span>&nbsp;<span class="builtintype" id="3305394">error</span><span class="op" id="3305399">)</span>&nbsp;<span class="op" id="3305401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305404">if</span>&nbsp;<span class="op" id="3305407">!</span><span class="ident" id="3305408"><a href="/gostd/net/iprawsock_posix.go.html#3305319">c</a></span><span class="op" id="3305409">.</span><span class="ident" id="3305410"><a href="/gostd/net/net.go.html#3336227">ok</a></span><span class="op" id="3305412">(</span><span class="op" id="3305413">)</span>&nbsp;<span class="op" id="3305415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305419">return</span>&nbsp;<span class="num" id="3305426">0</span><span class="op" id="3305427">,</span>&nbsp;<span class="num" id="3305429">0</span><span class="op" id="3305430">,</span>&nbsp;<span class="num" id="3305432">0</span><span class="op" id="3305433">,</span>&nbsp;<span class="builtintype" id="3305435">nil</span><span class="op" id="3305438">,</span>&nbsp;<span class="ident" id="3305440"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3305447">.</span><span class="ident" id="3305448"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3305456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305459">var</span>&nbsp;<span class="ident" id="3305463">sa</span>&nbsp;<span class="ident" id="3305466"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3305473">.</span><span class="ident" id="3305474"><a href="/gostd/syscall/syscall_unix.go.html#2547075">Sockaddr</a></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3305484"><a href="/gostd/net/iprawsock_posix.go.html#3305356">n</a></span><span class="op" id="3305485">,</span>&nbsp;<span class="ident" id="3305487"><a href="/gostd/net/iprawsock_posix.go.html#3305359">oobn</a></span><span class="op" id="3305491">,</span>&nbsp;<span class="ident" id="3305493"><a href="/gostd/net/iprawsock_posix.go.html#3305365">flags</a></span><span class="op" id="3305498">,</span>&nbsp;<span class="ident" id="3305500"><a href="/gostd/net/iprawsock_posix.go.html#3305463">sa</a></span><span class="op" id="3305502">,</span>&nbsp;<span class="ident" id="3305504"><a href="/gostd/net/iprawsock_posix.go.html#3305390">err</a></span>&nbsp;<span class="op" id="3305508">=</span>&nbsp;<span class="ident" id="3305510"><a href="/gostd/net/iprawsock_posix.go.html#3305319">c</a></span><span class="op" id="3305511">.</span><span class="ident" id="3305512"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3305514">.</span><span class="ident" id="3305515"><a href="/gostd/net/fd_unix.go.html#3263587">readMsg</a></span><span class="op" id="3305522">(</span><span class="ident" id="3305523"><a href="/gostd/net/iprawsock_posix.go.html#3305340">b</a></span><span class="op" id="3305524">,</span>&nbsp;<span class="ident" id="3305526"><a href="/gostd/net/iprawsock_posix.go.html#3305343">oob</a></span><span class="op" id="3305529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305532">switch</span>&nbsp;<span class="ident" id="3305539">sa</span>&nbsp;<span class="op" id="3305542">:=</span>&nbsp;<span class="ident" id="3305545"><a href="/gostd/net/iprawsock_posix.go.html#3305463">sa</a></span><span class="op" id="3305547">.</span><span class="op" id="3305548">(</span><span class="keyword" id="3305549">type</span><span class="op" id="3305553">)</span>&nbsp;<span class="op" id="3305555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305558">case</span>&nbsp;<span class="op" id="3305563">*</span><span class="ident" id="3305564"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3305571">.</span><span class="ident" id="3305572"><a href="/gostd/syscall/syscall_unix.go.html#2547205">SockaddrInet4</a></span><span class="op" id="3305585">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3305589"><a href="/gostd/net/iprawsock_posix.go.html#3305376">addr</a></span>&nbsp;<span class="op" id="3305594">=</span>&nbsp;<span class="op" id="3305596">&amp;</span><span class="ident" id="3305597"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3305603">{</span><span class="ident" id="3305604"><a href="/gostd/net/iprawsock.go.html#3301135">IP</a></span><span class="op" id="3305606">:</span>&nbsp;<span class="ident" id="3305608"><a href="/gostd/net/iprawsock_posix.go.html#3305539">sa</a></span><span class="op" id="3305610">.</span><span class="ident" id="3305611"><a href="/gostd/syscall/syscall_unix.go.html#2547239">Addr</a></span><span class="op" id="3305615">[</span><span class="num" id="3305616">0</span><span class="op" id="3305617">:</span><span class="op" id="3305618">]</span><span class="op" id="3305619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305622">case</span>&nbsp;<span class="op" id="3305627">*</span><span class="ident" id="3305628"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3305635">.</span><span class="ident" id="3305636"><a href="/gostd/syscall/syscall_unix.go.html#2547283">SockaddrInet6</a></span><span class="op" id="3305649">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3305653"><a href="/gostd/net/iprawsock_posix.go.html#3305376">addr</a></span>&nbsp;<span class="op" id="3305658">=</span>&nbsp;<span class="op" id="3305660">&amp;</span><span class="ident" id="3305661"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3305667">{</span><span class="ident" id="3305668"><a href="/gostd/net/iprawsock.go.html#3301135">IP</a></span><span class="op" id="3305670">:</span>&nbsp;<span class="ident" id="3305672"><a href="/gostd/net/iprawsock_posix.go.html#3305539">sa</a></span><span class="op" id="3305674">.</span><span class="ident" id="3305675"><a href="/gostd/syscall/syscall_unix.go.html#2547334">Addr</a></span><span class="op" id="3305679">[</span><span class="num" id="3305680">0</span><span class="op" id="3305681">:</span><span class="op" id="3305682">]</span><span class="op" id="3305683">,</span>&nbsp;<span class="ident" id="3305685"><a href="/gostd/net/iprawsock.go.html#3301144">Zone</a></span><span class="op" id="3305689">:</span>&nbsp;<span class="ident" id="3305691"><a href="/gostd/net/ipsock.go.html#3317149">zoneToString</a></span><span class="op" id="3305703">(</span><span class="builtintype" id="3305704">int</span><span class="op" id="3305707">(</span><span class="ident" id="3305708"><a href="/gostd/net/iprawsock_posix.go.html#3305539">sa</a></span><span class="op" id="3305710">.</span><span class="ident" id="3305711"><a href="/gostd/syscall/syscall_unix.go.html#2547319">ZoneId</a></span><span class="op" id="3305717">)</span><span class="op" id="3305718">)</span><span class="op" id="3305719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3305722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3305725">return</span><br>
<span class="lineno"></span><span class="op" id="3305732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="3305735">//&nbsp;WriteToIP&nbsp;writes&nbsp;an&nbsp;IP&nbsp;packet&nbsp;to&nbsp;addr&nbsp;via&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload</span><br>
<span class="lineno"></span><span class="comment" id="3305803">//&nbsp;from&nbsp;b.</span><br>
<span class="lineno"></span><span class="comment" id="3305814">//</span><br>
<span class="lineno"></span><span class="comment" id="3305817">//&nbsp;WriteToIP&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;an&nbsp;error&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="3305879">//&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and</span><br>
<span class="lineno">130</span><span class="comment" id="3305946">//&nbsp;SetWriteDeadline.&nbsp;&nbsp;On&nbsp;packet-oriented&nbsp;connections,&nbsp;write&nbsp;timeouts</span><br>
<span class="lineno"></span><span class="comment" id="3306015">//&nbsp;are&nbsp;rare.</span><br>
<span class="lineno"></span><span class="keyword" id="3306028">func</span>&nbsp;<span class="op" id="3306033">(</span><span class="ident" id="3306034">c</span>&nbsp;<span class="op" id="3306036">*</span><span class="ident" id="3306037"><a href="/gostd/net/iprawsock_posix.go.html#3303799">IPConn</a></span><span class="op" id="3306043">)</span>&nbsp;<span class="ident" id="3306045">WriteToIP</span><span class="op" id="3306054">(</span><span class="ident" id="3306055">b</span>&nbsp;<span class="op" id="3306057">[</span><span class="op" id="3306058">]</span><span class="builtintype" id="3306059">byte</span><span class="op" id="3306063">,</span>&nbsp;<span class="ident" id="3306065">addr</span>&nbsp;<span class="op" id="3306070">*</span><span class="ident" id="3306071"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3306077">)</span>&nbsp;<span class="op" id="3306079">(</span><span class="builtintype" id="3306080">int</span><span class="op" id="3306083">,</span>&nbsp;<span class="builtintype" id="3306085">error</span><span class="op" id="3306090">)</span>&nbsp;<span class="op" id="3306092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3306095">if</span>&nbsp;<span class="op" id="3306098">!</span><span class="ident" id="3306099"><a href="/gostd/net/iprawsock_posix.go.html#3306034">c</a></span><span class="op" id="3306100">.</span><span class="ident" id="3306101"><a href="/gostd/net/net.go.html#3336227">ok</a></span><span class="op" id="3306103">(</span><span class="op" id="3306104">)</span>&nbsp;<span class="op" id="3306106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3306110">return</span>&nbsp;<span class="num" id="3306117">0</span><span class="op" id="3306118">,</span>&nbsp;<span class="ident" id="3306120"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3306127">.</span><span class="ident" id="3306128"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3306136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3306139">if</span>&nbsp;<span class="ident" id="3306142"><a href="/gostd/net/iprawsock_posix.go.html#3306034">c</a></span><span class="op" id="3306143">.</span><span class="ident" id="3306144"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3306146">.</span><span class="ident" id="3306147"><a href="/gostd/net/fd_unix.go.html#3257544">isConnected</a></span>&nbsp;<span class="op" id="3306159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3306163">return</span>&nbsp;<span class="num" id="3306170">0</span><span class="op" id="3306171">,</span>&nbsp;<span class="op" id="3306173">&amp;</span><span class="ident" id="3306174"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3306181">{</span><span class="ident" id="3306182"><a href="/gostd/net/net.go.html#3341659">Op</a></span><span class="op" id="3306184">:</span>&nbsp;<span class="string" id="3306186">&#34;write&#34;</span><span class="op" id="3306193">,</span>&nbsp;<span class="ident" id="3306195"><a href="/gostd/net/net.go.html#3341758">Net</a></span><span class="op" id="3306198">:</span>&nbsp;<span class="ident" id="3306200"><a href="/gostd/net/iprawsock_posix.go.html#3306034">c</a></span><span class="op" id="3306201">.</span><span class="ident" id="3306202"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3306204">.</span><span class="ident" id="3306205"><a href="/gostd/net/fd_unix.go.html#3257562">net</a></span><span class="op" id="3306208">,</span>&nbsp;<span class="ident" id="3306210"><a href="/gostd/net/net.go.html#3341833">Addr</a></span><span class="op" id="3306214">:</span>&nbsp;<span class="ident" id="3306216"><a href="/gostd/net/iprawsock_posix.go.html#3306065">addr</a></span><span class="op" id="3306220">,</span>&nbsp;<span class="ident" id="3306222"><a href="/gostd/net/net.go.html#3341902">Err</a></span><span class="op" id="3306225">:</span>&nbsp;<span class="ident" id="3306227"><a href="/gostd/net/net.go.html#3341315">ErrWriteToConnected</a></span><span class="op" id="3306246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3306249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3306252">if</span>&nbsp;<span class="ident" id="3306255"><a href="/gostd/net/iprawsock_posix.go.html#3306065">addr</a></span>&nbsp;<span class="op" id="3306260">==</span>&nbsp;<span class="builtintype" id="3306263">nil</span>&nbsp;<span class="op" id="3306267">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3306271">return</span>&nbsp;<span class="num" id="3306278">0</span><span class="op" id="3306279">,</span>&nbsp;<span class="op" id="3306281">&amp;</span><span class="ident" id="3306282"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3306289">{</span><span class="ident" id="3306290"><a href="/gostd/net/net.go.html#3341659">Op</a></span><span class="op" id="3306292">:</span>&nbsp;<span class="string" id="3306294">&#34;write&#34;</span><span class="op" id="3306301">,</span>&nbsp;<span class="ident" id="3306303"><a href="/gostd/net/net.go.html#3341758">Net</a></span><span class="op" id="3306306">:</span>&nbsp;<span class="ident" id="3306308"><a href="/gostd/net/iprawsock_posix.go.html#3306034">c</a></span><span class="op" id="3306309">.</span><span class="ident" id="3306310"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3306312">.</span><span class="ident" id="3306313"><a href="/gostd/net/fd_unix.go.html#3257562">net</a></span><span class="op" id="3306316">,</span>&nbsp;<span class="ident" id="3306318"><a href="/gostd/net/net.go.html#3341833">Addr</a></span><span class="op" id="3306322">:</span>&nbsp;<span class="builtintype" id="3306324">nil</span><span class="op" id="3306327">,</span>&nbsp;<span class="ident" id="3306329"><a href="/gostd/net/net.go.html#3341902">Err</a></span><span class="op" id="3306332">:</span>&nbsp;<span class="ident" id="3306334"><a href="/gostd/net/net.go.html#3341102">errMissingAddress</a></span><span class="op" id="3306351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3306354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3306357">sa</span><span class="op" id="3306359">,</span>&nbsp;<span class="ident" id="3306361">err</span>&nbsp;<span class="op" id="3306365">:=</span>&nbsp;<span class="ident" id="3306368"><a href="/gostd/net/iprawsock_posix.go.html#3306065">addr</a></span><span class="op" id="3306372">.</span><span class="ident" id="3306373"><a href="/gostd/net/iprawsock_posix.go.html#3303559">sockaddr</a></span><span class="op" id="3306381">(</span><span class="ident" id="3306382"><a href="/gostd/net/iprawsock_posix.go.html#3306034">c</a></span><span class="op" id="3306383">.</span><span class="ident" id="3306384"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3306386">.</span><span class="ident" id="3306387"><a href="/gostd/net/fd_unix.go.html#3257510">family</a></span><span class="op" id="3306393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3306396">if</span>&nbsp;<span class="ident" id="3306399"><a href="/gostd/net/iprawsock_posix.go.html#3306361">err</a></span>&nbsp;<span class="op" id="3306403">!=</span>&nbsp;<span class="builtintype" id="3306406">nil</span>&nbsp;<span class="op" id="3306410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3306414">return</span>&nbsp;<span class="num" id="3306421">0</span><span class="op" id="3306422">,</span>&nbsp;<span class="op" id="3306424">&amp;</span><span class="ident" id="3306425"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3306432">{</span><span class="string" id="3306433">&#34;write&#34;</span><span class="op" id="3306440">,</span>&nbsp;<span class="ident" id="3306442"><a href="/gostd/net/iprawsock_posix.go.html#3306034">c</a></span><span class="op" id="3306443">.</span><span class="ident" id="3306444"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3306446">.</span><span class="ident" id="3306447"><a href="/gostd/net/fd_unix.go.html#3257562">net</a></span><span class="op" id="3306450">,</span>&nbsp;<span class="ident" id="3306452"><a href="/gostd/net/iprawsock_posix.go.html#3306065">addr</a></span><span class="op" id="3306456">,</span>&nbsp;<span class="ident" id="3306458"><a href="/gostd/net/iprawsock_posix.go.html#3306361">err</a></span><span class="op" id="3306461">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3306464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3306467">return</span>&nbsp;<span class="ident" id="3306474"><a href="/gostd/net/iprawsock_posix.go.html#3306034">c</a></span><span class="op" id="3306475">.</span><span class="ident" id="3306476"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3306478">.</span><span class="ident" id="3306479"><a href="/gostd/net/fd_unix.go.html#3265101">writeTo</a></span><span class="op" id="3306486">(</span><span class="ident" id="3306487"><a href="/gostd/net/iprawsock_posix.go.html#3306055">b</a></span><span class="op" id="3306488">,</span>&nbsp;<span class="ident" id="3306490"><a href="/gostd/net/iprawsock_posix.go.html#3306357">sa</a></span><span class="op" id="3306492">)</span><br>
<span class="lineno"></span><span class="op" id="3306494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3306497">//&nbsp;WriteTo&nbsp;implements&nbsp;the&nbsp;PacketConn&nbsp;WriteTo&nbsp;method.</span><br>
<span class="lineno">150</span><span class="keyword" id="3306550">func</span>&nbsp;<span class="op" id="3306555">(</span><span class="ident" id="3306556">c</span>&nbsp;<span class="op" id="3306558">*</span><span class="ident" id="3306559"><a href="/gostd/net/iprawsock_posix.go.html#3303799">IPConn</a></span><span class="op" id="3306565">)</span>&nbsp;<span class="ident" id="3306567">WriteTo</span><span class="op" id="3306574">(</span><span class="ident" id="3306575">b</span>&nbsp;<span class="op" id="3306577">[</span><span class="op" id="3306578">]</span><span class="builtintype" id="3306579">byte</span><span class="op" id="3306583">,</span>&nbsp;<span class="ident" id="3306585">addr</span>&nbsp;<span class="ident" id="3306590"><a href="/gostd/net/net.go.html#3334179">Addr</a></span><span class="op" id="3306594">)</span>&nbsp;<span class="op" id="3306596">(</span><span class="builtintype" id="3306597">int</span><span class="op" id="3306600">,</span>&nbsp;<span class="builtintype" id="3306602">error</span><span class="op" id="3306607">)</span>&nbsp;<span class="op" id="3306609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3306612">if</span>&nbsp;<span class="op" id="3306615">!</span><span class="ident" id="3306616"><a href="/gostd/net/iprawsock_posix.go.html#3306556">c</a></span><span class="op" id="3306617">.</span><span class="ident" id="3306618"><a href="/gostd/net/net.go.html#3336227">ok</a></span><span class="op" id="3306620">(</span><span class="op" id="3306621">)</span>&nbsp;<span class="op" id="3306623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3306627">return</span>&nbsp;<span class="num" id="3306634">0</span><span class="op" id="3306635">,</span>&nbsp;<span class="ident" id="3306637"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3306644">.</span><span class="ident" id="3306645"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3306653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3306656">a</span><span class="op" id="3306657">,</span>&nbsp;<span class="ident" id="3306659">ok</span>&nbsp;<span class="op" id="3306662">:=</span>&nbsp;<span class="ident" id="3306665"><a href="/gostd/net/iprawsock_posix.go.html#3306585">addr</a></span><span class="op" id="3306669">.</span><span class="op" id="3306670">(</span><span class="op" id="3306671">*</span><span class="ident" id="3306672"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3306678">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3306681">if</span>&nbsp;<span class="op" id="3306684">!</span><span class="ident" id="3306685"><a href="/gostd/net/iprawsock_posix.go.html#3306659">ok</a></span>&nbsp;<span class="op" id="3306688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3306692">return</span>&nbsp;<span class="num" id="3306699">0</span><span class="op" id="3306700">,</span>&nbsp;<span class="op" id="3306702">&amp;</span><span class="ident" id="3306703"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3306710">{</span><span class="string" id="3306711">&#34;write&#34;</span><span class="op" id="3306718">,</span>&nbsp;<span class="ident" id="3306720"><a href="/gostd/net/iprawsock_posix.go.html#3306556">c</a></span><span class="op" id="3306721">.</span><span class="ident" id="3306722"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3306724">.</span><span class="ident" id="3306725"><a href="/gostd/net/fd_unix.go.html#3257562">net</a></span><span class="op" id="3306728">,</span>&nbsp;<span class="ident" id="3306730"><a href="/gostd/net/iprawsock_posix.go.html#3306585">addr</a></span><span class="op" id="3306734">,</span>&nbsp;<span class="ident" id="3306736"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3306743">.</span><span class="ident" id="3306744"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><span class="op" id="3306750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3306753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3306756">return</span>&nbsp;<span class="ident" id="3306763"><a href="/gostd/net/iprawsock_posix.go.html#3306556">c</a></span><span class="op" id="3306764">.</span><span class="ident" id="3306765"><a href="/gostd/net/iprawsock_posix.go.html#3306045">WriteToIP</a></span><span class="op" id="3306774">(</span><span class="ident" id="3306775"><a href="/gostd/net/iprawsock_posix.go.html#3306575">b</a></span><span class="op" id="3306776">,</span>&nbsp;<span class="ident" id="3306778"><a href="/gostd/net/iprawsock_posix.go.html#3306656">a</a></span><span class="op" id="3306779">)</span><br>
<span class="lineno"></span><span class="op" id="3306781">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="3306784">//&nbsp;WriteMsgIP&nbsp;writes&nbsp;a&nbsp;packet&nbsp;to&nbsp;addr&nbsp;via&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="3306854">//&nbsp;b&nbsp;and&nbsp;the&nbsp;associated&nbsp;out-of-band&nbsp;data&nbsp;from&nbsp;oob.&nbsp;&nbsp;It&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3306921">//&nbsp;number&nbsp;of&nbsp;payload&nbsp;and&nbsp;out-of-band&nbsp;bytes&nbsp;written.</span><br>
<span class="lineno"></span><span class="keyword" id="3306973">func</span>&nbsp;<span class="op" id="3306978">(</span><span class="ident" id="3306979">c</span>&nbsp;<span class="op" id="3306981">*</span><span class="ident" id="3306982"><a href="/gostd/net/iprawsock_posix.go.html#3303799">IPConn</a></span><span class="op" id="3306988">)</span>&nbsp;<span class="ident" id="3306990">WriteMsgIP</span><span class="op" id="3307000">(</span><span class="ident" id="3307001">b</span><span class="op" id="3307002">,</span>&nbsp;<span class="ident" id="3307004">oob</span>&nbsp;<span class="op" id="3307008">[</span><span class="op" id="3307009">]</span><span class="builtintype" id="3307010">byte</span><span class="op" id="3307014">,</span>&nbsp;<span class="ident" id="3307016">addr</span>&nbsp;<span class="op" id="3307021">*</span><span class="ident" id="3307022"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3307028">)</span>&nbsp;<span class="op" id="3307030">(</span><span class="ident" id="3307031">n</span><span class="op" id="3307032">,</span>&nbsp;<span class="ident" id="3307034">oobn</span>&nbsp;<span class="builtintype" id="3307039">int</span><span class="op" id="3307042">,</span>&nbsp;<span class="ident" id="3307044">err</span>&nbsp;<span class="builtintype" id="3307048">error</span><span class="op" id="3307053">)</span>&nbsp;<span class="op" id="3307055">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307058">if</span>&nbsp;<span class="op" id="3307061">!</span><span class="ident" id="3307062"><a href="/gostd/net/iprawsock_posix.go.html#3306979">c</a></span><span class="op" id="3307063">.</span><span class="ident" id="3307064"><a href="/gostd/net/net.go.html#3336227">ok</a></span><span class="op" id="3307066">(</span><span class="op" id="3307067">)</span>&nbsp;<span class="op" id="3307069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307073">return</span>&nbsp;<span class="num" id="3307080">0</span><span class="op" id="3307081">,</span>&nbsp;<span class="num" id="3307083">0</span><span class="op" id="3307084">,</span>&nbsp;<span class="ident" id="3307086"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3307093">.</span><span class="ident" id="3307094"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3307102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307105">if</span>&nbsp;<span class="ident" id="3307108"><a href="/gostd/net/iprawsock_posix.go.html#3306979">c</a></span><span class="op" id="3307109">.</span><span class="ident" id="3307110"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3307112">.</span><span class="ident" id="3307113"><a href="/gostd/net/fd_unix.go.html#3257544">isConnected</a></span>&nbsp;<span class="op" id="3307125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307129">return</span>&nbsp;<span class="num" id="3307136">0</span><span class="op" id="3307137">,</span>&nbsp;<span class="num" id="3307139">0</span><span class="op" id="3307140">,</span>&nbsp;<span class="op" id="3307142">&amp;</span><span class="ident" id="3307143"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3307150">{</span><span class="ident" id="3307151"><a href="/gostd/net/net.go.html#3341659">Op</a></span><span class="op" id="3307153">:</span>&nbsp;<span class="string" id="3307155">&#34;write&#34;</span><span class="op" id="3307162">,</span>&nbsp;<span class="ident" id="3307164"><a href="/gostd/net/net.go.html#3341758">Net</a></span><span class="op" id="3307167">:</span>&nbsp;<span class="ident" id="3307169"><a href="/gostd/net/iprawsock_posix.go.html#3306979">c</a></span><span class="op" id="3307170">.</span><span class="ident" id="3307171"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3307173">.</span><span class="ident" id="3307174"><a href="/gostd/net/fd_unix.go.html#3257562">net</a></span><span class="op" id="3307177">,</span>&nbsp;<span class="ident" id="3307179"><a href="/gostd/net/net.go.html#3341833">Addr</a></span><span class="op" id="3307183">:</span>&nbsp;<span class="ident" id="3307185"><a href="/gostd/net/iprawsock_posix.go.html#3307016">addr</a></span><span class="op" id="3307189">,</span>&nbsp;<span class="ident" id="3307191"><a href="/gostd/net/net.go.html#3341902">Err</a></span><span class="op" id="3307194">:</span>&nbsp;<span class="ident" id="3307196"><a href="/gostd/net/net.go.html#3341315">ErrWriteToConnected</a></span><span class="op" id="3307215">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3307218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307221">if</span>&nbsp;<span class="ident" id="3307224"><a href="/gostd/net/iprawsock_posix.go.html#3307016">addr</a></span>&nbsp;<span class="op" id="3307229">==</span>&nbsp;<span class="builtintype" id="3307232">nil</span>&nbsp;<span class="op" id="3307236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307240">return</span>&nbsp;<span class="num" id="3307247">0</span><span class="op" id="3307248">,</span>&nbsp;<span class="num" id="3307250">0</span><span class="op" id="3307251">,</span>&nbsp;<span class="op" id="3307253">&amp;</span><span class="ident" id="3307254"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3307261">{</span><span class="ident" id="3307262"><a href="/gostd/net/net.go.html#3341659">Op</a></span><span class="op" id="3307264">:</span>&nbsp;<span class="string" id="3307266">&#34;write&#34;</span><span class="op" id="3307273">,</span>&nbsp;<span class="ident" id="3307275"><a href="/gostd/net/net.go.html#3341758">Net</a></span><span class="op" id="3307278">:</span>&nbsp;<span class="ident" id="3307280"><a href="/gostd/net/iprawsock_posix.go.html#3306979">c</a></span><span class="op" id="3307281">.</span><span class="ident" id="3307282"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3307284">.</span><span class="ident" id="3307285"><a href="/gostd/net/fd_unix.go.html#3257562">net</a></span><span class="op" id="3307288">,</span>&nbsp;<span class="ident" id="3307290"><a href="/gostd/net/net.go.html#3341833">Addr</a></span><span class="op" id="3307294">:</span>&nbsp;<span class="builtintype" id="3307296">nil</span><span class="op" id="3307299">,</span>&nbsp;<span class="ident" id="3307301"><a href="/gostd/net/net.go.html#3341902">Err</a></span><span class="op" id="3307304">:</span>&nbsp;<span class="ident" id="3307306"><a href="/gostd/net/net.go.html#3341102">errMissingAddress</a></span><span class="op" id="3307323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3307326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3307329">sa</span><span class="op" id="3307331">,</span>&nbsp;<span class="ident" id="3307333"><a href="/gostd/net/iprawsock_posix.go.html#3307044">err</a></span>&nbsp;<span class="op" id="3307337">:=</span>&nbsp;<span class="ident" id="3307340"><a href="/gostd/net/iprawsock_posix.go.html#3307016">addr</a></span><span class="op" id="3307344">.</span><span class="ident" id="3307345"><a href="/gostd/net/iprawsock_posix.go.html#3303559">sockaddr</a></span><span class="op" id="3307353">(</span><span class="ident" id="3307354"><a href="/gostd/net/iprawsock_posix.go.html#3306979">c</a></span><span class="op" id="3307355">.</span><span class="ident" id="3307356"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3307358">.</span><span class="ident" id="3307359"><a href="/gostd/net/fd_unix.go.html#3257510">family</a></span><span class="op" id="3307365">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307368">if</span>&nbsp;<span class="ident" id="3307371"><a href="/gostd/net/iprawsock_posix.go.html#3307044">err</a></span>&nbsp;<span class="op" id="3307375">!=</span>&nbsp;<span class="builtintype" id="3307378">nil</span>&nbsp;<span class="op" id="3307382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307386">return</span>&nbsp;<span class="num" id="3307393">0</span><span class="op" id="3307394">,</span>&nbsp;<span class="num" id="3307396">0</span><span class="op" id="3307397">,</span>&nbsp;<span class="op" id="3307399">&amp;</span><span class="ident" id="3307400"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3307407">{</span><span class="string" id="3307408">&#34;write&#34;</span><span class="op" id="3307415">,</span>&nbsp;<span class="ident" id="3307417"><a href="/gostd/net/iprawsock_posix.go.html#3306979">c</a></span><span class="op" id="3307418">.</span><span class="ident" id="3307419"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3307421">.</span><span class="ident" id="3307422"><a href="/gostd/net/fd_unix.go.html#3257562">net</a></span><span class="op" id="3307425">,</span>&nbsp;<span class="ident" id="3307427"><a href="/gostd/net/iprawsock_posix.go.html#3307016">addr</a></span><span class="op" id="3307431">,</span>&nbsp;<span class="ident" id="3307433"><a href="/gostd/net/iprawsock_posix.go.html#3307044">err</a></span><span class="op" id="3307436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3307439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307442">return</span>&nbsp;<span class="ident" id="3307449"><a href="/gostd/net/iprawsock_posix.go.html#3306979">c</a></span><span class="op" id="3307450">.</span><span class="ident" id="3307451"><a href="/gostd/net/net.go.html#3336199">fd</a></span><span class="op" id="3307453">.</span><span class="ident" id="3307454"><a href="/gostd/net/fd_unix.go.html#3265622">writeMsg</a></span><span class="op" id="3307462">(</span><span class="ident" id="3307463"><a href="/gostd/net/iprawsock_posix.go.html#3307001">b</a></span><span class="op" id="3307464">,</span>&nbsp;<span class="ident" id="3307466"><a href="/gostd/net/iprawsock_posix.go.html#3307004">oob</a></span><span class="op" id="3307469">,</span>&nbsp;<span class="ident" id="3307471"><a href="/gostd/net/iprawsock_posix.go.html#3307329">sa</a></span><span class="op" id="3307473">)</span><br>
<span class="lineno"></span><span class="op" id="3307475">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="3307478">//&nbsp;DialIP&nbsp;connects&nbsp;to&nbsp;the&nbsp;remote&nbsp;address&nbsp;raddr&nbsp;on&nbsp;the&nbsp;network&nbsp;protocol</span><br>
<span class="lineno"></span><span class="comment" id="3307549">//&nbsp;netProto,&nbsp;which&nbsp;must&nbsp;be&nbsp;&#34;ip&#34;,&nbsp;&#34;ip4&#34;,&nbsp;or&nbsp;&#34;ip6&#34;&nbsp;followed&nbsp;by&nbsp;a&nbsp;colon</span><br>
<span class="lineno"></span><span class="comment" id="3307618">//&nbsp;and&nbsp;a&nbsp;protocol&nbsp;number&nbsp;or&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3307652">func</span>&nbsp;<span class="ident" id="3307657">DialIP</span><span class="op" id="3307663">(</span><span class="ident" id="3307664">netProto</span>&nbsp;<span class="builtintype" id="3307673">string</span><span class="op" id="3307679">,</span>&nbsp;<span class="ident" id="3307681">laddr</span><span class="op" id="3307686">,</span>&nbsp;<span class="ident" id="3307688">raddr</span>&nbsp;<span class="op" id="3307694">*</span><span class="ident" id="3307695"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3307701">)</span>&nbsp;<span class="op" id="3307703">(</span><span class="op" id="3307704">*</span><span class="ident" id="3307705"><a href="/gostd/net/iprawsock_posix.go.html#3303799">IPConn</a></span><span class="op" id="3307711">,</span>&nbsp;<span class="builtintype" id="3307713">error</span><span class="op" id="3307718">)</span>&nbsp;<span class="op" id="3307720">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307723">return</span>&nbsp;<span class="ident" id="3307730"><a href="/gostd/net/iprawsock_posix.go.html#3307781">dialIP</a></span><span class="op" id="3307736">(</span><span class="ident" id="3307737"><a href="/gostd/net/iprawsock_posix.go.html#3307664">netProto</a></span><span class="op" id="3307745">,</span>&nbsp;<span class="ident" id="3307747"><a href="/gostd/net/iprawsock_posix.go.html#3307681">laddr</a></span><span class="op" id="3307752">,</span>&nbsp;<span class="ident" id="3307754"><a href="/gostd/net/iprawsock_posix.go.html#3307688">raddr</a></span><span class="op" id="3307759">,</span>&nbsp;<span class="ident" id="3307761"><a href="/gostd/net/net.go.html#3342276">noDeadline</a></span><span class="op" id="3307771">)</span><br>
<span class="lineno"></span><span class="op" id="3307773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3307776">func</span>&nbsp;<span class="ident" id="3307781">dialIP</span><span class="op" id="3307787">(</span><span class="ident" id="3307788">netProto</span>&nbsp;<span class="builtintype" id="3307797">string</span><span class="op" id="3307803">,</span>&nbsp;<span class="ident" id="3307805">laddr</span><span class="op" id="3307810">,</span>&nbsp;<span class="ident" id="3307812">raddr</span>&nbsp;<span class="op" id="3307818">*</span><span class="ident" id="3307819"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3307825">,</span>&nbsp;<span class="ident" id="3307827">deadline</span>&nbsp;<span class="ident" id="3307836"><a href="/gostd/net/iprawsock_posix.go.html#3302414">time</a></span><span class="op" id="3307840">.</span><span class="ident" id="3307841"><a href="/gostd/time/time.go.html#2722087">Time</a></span><span class="op" id="3307845">)</span>&nbsp;<span class="op" id="3307847">(</span><span class="op" id="3307848">*</span><span class="ident" id="3307849"><a href="/gostd/net/iprawsock_posix.go.html#3303799">IPConn</a></span><span class="op" id="3307855">,</span>&nbsp;<span class="builtintype" id="3307857">error</span><span class="op" id="3307862">)</span>&nbsp;<span class="op" id="3307864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3307867">net</span><span class="op" id="3307870">,</span>&nbsp;<span class="ident" id="3307872">proto</span><span class="op" id="3307877">,</span>&nbsp;<span class="ident" id="3307879">err</span>&nbsp;<span class="op" id="3307883">:=</span>&nbsp;<span class="ident" id="3307886"><a href="/gostd/net/dial.go.html#3201440">parseNetwork</a></span><span class="op" id="3307898">(</span><span class="ident" id="3307899"><a href="/gostd/net/iprawsock_posix.go.html#3307788">netProto</a></span><span class="op" id="3307907">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307910">if</span>&nbsp;<span class="ident" id="3307913"><a href="/gostd/net/iprawsock_posix.go.html#3307879">err</a></span>&nbsp;<span class="op" id="3307917">!=</span>&nbsp;<span class="builtintype" id="3307920">nil</span>&nbsp;<span class="op" id="3307924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3307928">return</span>&nbsp;<span class="builtintype" id="3307935">nil</span><span class="op" id="3307938">,</span>&nbsp;<span class="op" id="3307940">&amp;</span><span class="ident" id="3307941"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3307948">{</span><span class="ident" id="3307949"><a href="/gostd/net/net.go.html#3341659">Op</a></span><span class="op" id="3307951">:</span>&nbsp;<span class="string" id="3307953">&#34;dial&#34;</span><span class="op" id="3307959">,</span>&nbsp;<span class="ident" id="3307961"><a href="/gostd/net/net.go.html#3341758">Net</a></span><span class="op" id="3307964">:</span>&nbsp;<span class="ident" id="3307966"><a href="/gostd/net/iprawsock_posix.go.html#3307788">netProto</a></span><span class="op" id="3307974">,</span>&nbsp;<span class="ident" id="3307976"><a href="/gostd/net/net.go.html#3341833">Addr</a></span><span class="op" id="3307980">:</span>&nbsp;<span class="ident" id="3307982"><a href="/gostd/net/iprawsock_posix.go.html#3307812">raddr</a></span><span class="op" id="3307987">,</span>&nbsp;<span class="ident" id="3307989"><a href="/gostd/net/net.go.html#3341902">Err</a></span><span class="op" id="3307992">:</span>&nbsp;<span class="ident" id="3307994"><a href="/gostd/net/iprawsock_posix.go.html#3307879">err</a></span><span class="op" id="3307997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3308000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308003">switch</span>&nbsp;<span class="ident" id="3308010"><a href="/gostd/net/iprawsock_posix.go.html#3307867">net</a></span>&nbsp;<span class="op" id="3308014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308017">case</span>&nbsp;<span class="string" id="3308022">&#34;ip&#34;</span><span class="op" id="3308026">,</span>&nbsp;<span class="string" id="3308028">&#34;ip4&#34;</span><span class="op" id="3308033">,</span>&nbsp;<span class="string" id="3308035">&#34;ip6&#34;</span><span class="op" id="3308040">:</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308043">default</span><span class="op" id="3308050">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308054">return</span>&nbsp;<span class="builtintype" id="3308061">nil</span><span class="op" id="3308064">,</span>&nbsp;<span class="op" id="3308066">&amp;</span><span class="ident" id="3308067"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3308074">{</span><span class="ident" id="3308075"><a href="/gostd/net/net.go.html#3341659">Op</a></span><span class="op" id="3308077">:</span>&nbsp;<span class="string" id="3308079">&#34;dial&#34;</span><span class="op" id="3308085">,</span>&nbsp;<span class="ident" id="3308087"><a href="/gostd/net/net.go.html#3341758">Net</a></span><span class="op" id="3308090">:</span>&nbsp;<span class="ident" id="3308092"><a href="/gostd/net/iprawsock_posix.go.html#3307788">netProto</a></span><span class="op" id="3308100">,</span>&nbsp;<span class="ident" id="3308102"><a href="/gostd/net/net.go.html#3341833">Addr</a></span><span class="op" id="3308106">:</span>&nbsp;<span class="ident" id="3308108"><a href="/gostd/net/iprawsock_posix.go.html#3307812">raddr</a></span><span class="op" id="3308113">,</span>&nbsp;<span class="ident" id="3308115"><a href="/gostd/net/net.go.html#3341902">Err</a></span><span class="op" id="3308118">:</span>&nbsp;<span class="ident" id="3308120"><a href="/gostd/net/net.go.html#3342949">UnknownNetworkError</a></span><span class="op" id="3308139">(</span><span class="ident" id="3308140"><a href="/gostd/net/iprawsock_posix.go.html#3307788">netProto</a></span><span class="op" id="3308148">)</span><span class="op" id="3308149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3308152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308155">if</span>&nbsp;<span class="ident" id="3308158"><a href="/gostd/net/iprawsock_posix.go.html#3307812">raddr</a></span>&nbsp;<span class="op" id="3308164">==</span>&nbsp;<span class="builtintype" id="3308167">nil</span>&nbsp;<span class="op" id="3308171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308175">return</span>&nbsp;<span class="builtintype" id="3308182">nil</span><span class="op" id="3308185">,</span>&nbsp;<span class="op" id="3308187">&amp;</span><span class="ident" id="3308188"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3308195">{</span><span class="ident" id="3308196"><a href="/gostd/net/net.go.html#3341659">Op</a></span><span class="op" id="3308198">:</span>&nbsp;<span class="string" id="3308200">&#34;dial&#34;</span><span class="op" id="3308206">,</span>&nbsp;<span class="ident" id="3308208"><a href="/gostd/net/net.go.html#3341758">Net</a></span><span class="op" id="3308211">:</span>&nbsp;<span class="ident" id="3308213"><a href="/gostd/net/iprawsock_posix.go.html#3307788">netProto</a></span><span class="op" id="3308221">,</span>&nbsp;<span class="ident" id="3308223"><a href="/gostd/net/net.go.html#3341833">Addr</a></span><span class="op" id="3308227">:</span>&nbsp;<span class="builtintype" id="3308229">nil</span><span class="op" id="3308232">,</span>&nbsp;<span class="ident" id="3308234"><a href="/gostd/net/net.go.html#3341902">Err</a></span><span class="op" id="3308237">:</span>&nbsp;<span class="ident" id="3308239"><a href="/gostd/net/net.go.html#3341102">errMissingAddress</a></span><span class="op" id="3308256">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3308259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308262">fd</span><span class="op" id="3308264">,</span>&nbsp;<span class="ident" id="3308266"><a href="/gostd/net/iprawsock_posix.go.html#3307879">err</a></span>&nbsp;<span class="op" id="3308270">:=</span>&nbsp;<span class="ident" id="3308273"><a href="/gostd/net/ipsock_posix.go.html#3321835">internetSocket</a></span><span class="op" id="3308287">(</span><span class="ident" id="3308288"><a href="/gostd/net/iprawsock_posix.go.html#3307867">net</a></span><span class="op" id="3308291">,</span>&nbsp;<span class="ident" id="3308293"><a href="/gostd/net/iprawsock_posix.go.html#3307805">laddr</a></span><span class="op" id="3308298">,</span>&nbsp;<span class="ident" id="3308300"><a href="/gostd/net/iprawsock_posix.go.html#3307812">raddr</a></span><span class="op" id="3308305">,</span>&nbsp;<span class="ident" id="3308307"><a href="/gostd/net/iprawsock_posix.go.html#3307827">deadline</a></span><span class="op" id="3308315">,</span>&nbsp;<span class="ident" id="3308317"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3308324">.</span><span class="ident" id="3308325"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2591910">SOCK_RAW</a></span><span class="op" id="3308333">,</span>&nbsp;<span class="ident" id="3308335"><a href="/gostd/net/iprawsock_posix.go.html#3307872">proto</a></span><span class="op" id="3308340">,</span>&nbsp;<span class="string" id="3308342">&#34;dial&#34;</span><span class="op" id="3308348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308351">if</span>&nbsp;<span class="ident" id="3308354"><a href="/gostd/net/iprawsock_posix.go.html#3307879">err</a></span>&nbsp;<span class="op" id="3308358">!=</span>&nbsp;<span class="builtintype" id="3308361">nil</span>&nbsp;<span class="op" id="3308365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308369">return</span>&nbsp;<span class="builtintype" id="3308376">nil</span><span class="op" id="3308379">,</span>&nbsp;<span class="op" id="3308381">&amp;</span><span class="ident" id="3308382"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3308389">{</span><span class="ident" id="3308390"><a href="/gostd/net/net.go.html#3341659">Op</a></span><span class="op" id="3308392">:</span>&nbsp;<span class="string" id="3308394">&#34;dial&#34;</span><span class="op" id="3308400">,</span>&nbsp;<span class="ident" id="3308402"><a href="/gostd/net/net.go.html#3341758">Net</a></span><span class="op" id="3308405">:</span>&nbsp;<span class="ident" id="3308407"><a href="/gostd/net/iprawsock_posix.go.html#3307788">netProto</a></span><span class="op" id="3308415">,</span>&nbsp;<span class="ident" id="3308417"><a href="/gostd/net/net.go.html#3341833">Addr</a></span><span class="op" id="3308421">:</span>&nbsp;<span class="ident" id="3308423"><a href="/gostd/net/iprawsock_posix.go.html#3307812">raddr</a></span><span class="op" id="3308428">,</span>&nbsp;<span class="ident" id="3308430"><a href="/gostd/net/net.go.html#3341902">Err</a></span><span class="op" id="3308433">:</span>&nbsp;<span class="ident" id="3308435"><a href="/gostd/net/iprawsock_posix.go.html#3307879">err</a></span><span class="op" id="3308438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3308441">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308444">return</span>&nbsp;<span class="ident" id="3308451"><a href="/gostd/net/iprawsock_posix.go.html#3303829">newIPConn</a></span><span class="op" id="3308460">(</span><span class="ident" id="3308461"><a href="/gostd/net/iprawsock_posix.go.html#3308262">fd</a></span><span class="op" id="3308463">)</span><span class="op" id="3308464">,</span>&nbsp;<span class="builtintype" id="3308466">nil</span><br>
<span class="lineno"></span><span class="op" id="3308470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3308473">//&nbsp;ListenIP&nbsp;listens&nbsp;for&nbsp;incoming&nbsp;IP&nbsp;packets&nbsp;addressed&nbsp;to&nbsp;the&nbsp;local</span><br>
<span class="lineno"></span><span class="comment" id="3308540">//&nbsp;address&nbsp;laddr.&nbsp;&nbsp;The&nbsp;returned&nbsp;connection&#39;s&nbsp;ReadFrom&nbsp;and&nbsp;WriteTo</span><br>
<span class="lineno">210</span><span class="comment" id="3308606">//&nbsp;methods&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;receive&nbsp;and&nbsp;send&nbsp;IP&nbsp;packets&nbsp;with&nbsp;per-packet</span><br>
<span class="lineno"></span><span class="comment" id="3308676">//&nbsp;addressing.</span><br>
<span class="lineno"></span><span class="keyword" id="3308691">func</span>&nbsp;<span class="ident" id="3308696">ListenIP</span><span class="op" id="3308704">(</span><span class="ident" id="3308705">netProto</span>&nbsp;<span class="builtintype" id="3308714">string</span><span class="op" id="3308720">,</span>&nbsp;<span class="ident" id="3308722">laddr</span>&nbsp;<span class="op" id="3308728">*</span><span class="ident" id="3308729"><a href="/gostd/net/iprawsock.go.html#3301118">IPAddr</a></span><span class="op" id="3308735">)</span>&nbsp;<span class="op" id="3308737">(</span><span class="op" id="3308738">*</span><span class="ident" id="3308739"><a href="/gostd/net/iprawsock_posix.go.html#3303799">IPConn</a></span><span class="op" id="3308745">,</span>&nbsp;<span class="builtintype" id="3308747">error</span><span class="op" id="3308752">)</span>&nbsp;<span class="op" id="3308754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3308757">net</span><span class="op" id="3308760">,</span>&nbsp;<span class="ident" id="3308762">proto</span><span class="op" id="3308767">,</span>&nbsp;<span class="ident" id="3308769">err</span>&nbsp;<span class="op" id="3308773">:=</span>&nbsp;<span class="ident" id="3308776"><a href="/gostd/net/dial.go.html#3201440">parseNetwork</a></span><span class="op" id="3308788">(</span><span class="ident" id="3308789"><a href="/gostd/net/iprawsock_posix.go.html#3308705">netProto</a></span><span class="op" id="3308797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308800">if</span>&nbsp;<span class="ident" id="3308803"><a href="/gostd/net/iprawsock_posix.go.html#3308769">err</a></span>&nbsp;<span class="op" id="3308807">!=</span>&nbsp;<span class="builtintype" id="3308810">nil</span>&nbsp;<span class="op" id="3308814">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308818">return</span>&nbsp;<span class="builtintype" id="3308825">nil</span><span class="op" id="3308828">,</span>&nbsp;<span class="op" id="3308830">&amp;</span><span class="ident" id="3308831"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3308838">{</span><span class="ident" id="3308839"><a href="/gostd/net/net.go.html#3341659">Op</a></span><span class="op" id="3308841">:</span>&nbsp;<span class="string" id="3308843">&#34;dial&#34;</span><span class="op" id="3308849">,</span>&nbsp;<span class="ident" id="3308851"><a href="/gostd/net/net.go.html#3341758">Net</a></span><span class="op" id="3308854">:</span>&nbsp;<span class="ident" id="3308856"><a href="/gostd/net/iprawsock_posix.go.html#3308705">netProto</a></span><span class="op" id="3308864">,</span>&nbsp;<span class="ident" id="3308866"><a href="/gostd/net/net.go.html#3341833">Addr</a></span><span class="op" id="3308870">:</span>&nbsp;<span class="ident" id="3308872"><a href="/gostd/net/iprawsock_posix.go.html#3308722">laddr</a></span><span class="op" id="3308877">,</span>&nbsp;<span class="ident" id="3308879"><a href="/gostd/net/net.go.html#3341902">Err</a></span><span class="op" id="3308882">:</span>&nbsp;<span class="ident" id="3308884"><a href="/gostd/net/iprawsock_posix.go.html#3308769">err</a></span><span class="op" id="3308887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3308890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308893">switch</span>&nbsp;<span class="ident" id="3308900"><a href="/gostd/net/iprawsock_posix.go.html#3308757">net</a></span>&nbsp;<span class="op" id="3308904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308907">case</span>&nbsp;<span class="string" id="3308912">&#34;ip&#34;</span><span class="op" id="3308916">,</span>&nbsp;<span class="string" id="3308918">&#34;ip4&#34;</span><span class="op" id="3308923">,</span>&nbsp;<span class="string" id="3308925">&#34;ip6&#34;</span><span class="op" id="3308930">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308933">default</span><span class="op" id="3308940">:</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3308944">return</span>&nbsp;<span class="builtintype" id="3308951">nil</span><span class="op" id="3308954">,</span>&nbsp;<span class="op" id="3308956">&amp;</span><span class="ident" id="3308957"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3308964">{</span><span class="ident" id="3308965"><a href="/gostd/net/net.go.html#3341659">Op</a></span><span class="op" id="3308967">:</span>&nbsp;<span class="string" id="3308969">&#34;listen&#34;</span><span class="op" id="3308977">,</span>&nbsp;<span class="ident" id="3308979"><a href="/gostd/net/net.go.html#3341758">Net</a></span><span class="op" id="3308982">:</span>&nbsp;<span class="ident" id="3308984"><a href="/gostd/net/iprawsock_posix.go.html#3308705">netProto</a></span><span class="op" id="3308992">,</span>&nbsp;<span class="ident" id="3308994"><a href="/gostd/net/net.go.html#3341833">Addr</a></span><span class="op" id="3308998">:</span>&nbsp;<span class="ident" id="3309000"><a href="/gostd/net/iprawsock_posix.go.html#3308722">laddr</a></span><span class="op" id="3309005">,</span>&nbsp;<span class="ident" id="3309007"><a href="/gostd/net/net.go.html#3341902">Err</a></span><span class="op" id="3309010">:</span>&nbsp;<span class="ident" id="3309012"><a href="/gostd/net/net.go.html#3342949">UnknownNetworkError</a></span><span class="op" id="3309031">(</span><span class="ident" id="3309032"><a href="/gostd/net/iprawsock_posix.go.html#3308705">netProto</a></span><span class="op" id="3309040">)</span><span class="op" id="3309041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3309044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3309047">fd</span><span class="op" id="3309049">,</span>&nbsp;<span class="ident" id="3309051"><a href="/gostd/net/iprawsock_posix.go.html#3308769">err</a></span>&nbsp;<span class="op" id="3309055">:=</span>&nbsp;<span class="ident" id="3309058"><a href="/gostd/net/ipsock_posix.go.html#3321835">internetSocket</a></span><span class="op" id="3309072">(</span><span class="ident" id="3309073"><a href="/gostd/net/iprawsock_posix.go.html#3308757">net</a></span><span class="op" id="3309076">,</span>&nbsp;<span class="ident" id="3309078"><a href="/gostd/net/iprawsock_posix.go.html#3308722">laddr</a></span><span class="op" id="3309083">,</span>&nbsp;<span class="builtintype" id="3309085">nil</span><span class="op" id="3309088">,</span>&nbsp;<span class="ident" id="3309090"><a href="/gostd/net/net.go.html#3342276">noDeadline</a></span><span class="op" id="3309100">,</span>&nbsp;<span class="ident" id="3309102"><a href="/gostd/net/iprawsock_posix.go.html#3302403">syscall</a></span><span class="op" id="3309109">.</span><span class="ident" id="3309110"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2591910">SOCK_RAW</a></span><span class="op" id="3309118">,</span>&nbsp;<span class="ident" id="3309120"><a href="/gostd/net/iprawsock_posix.go.html#3308762">proto</a></span><span class="op" id="3309125">,</span>&nbsp;<span class="string" id="3309127">&#34;listen&#34;</span><span class="op" id="3309135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309138">if</span>&nbsp;<span class="ident" id="3309141"><a href="/gostd/net/iprawsock_posix.go.html#3308769">err</a></span>&nbsp;<span class="op" id="3309145">!=</span>&nbsp;<span class="builtintype" id="3309148">nil</span>&nbsp;<span class="op" id="3309152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309156">return</span>&nbsp;<span class="builtintype" id="3309163">nil</span><span class="op" id="3309166">,</span>&nbsp;<span class="op" id="3309168">&amp;</span><span class="ident" id="3309169"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="3309176">{</span><span class="ident" id="3309177"><a href="/gostd/net/net.go.html#3341659">Op</a></span><span class="op" id="3309179">:</span>&nbsp;<span class="string" id="3309181">&#34;listen&#34;</span><span class="op" id="3309189">,</span>&nbsp;<span class="ident" id="3309191"><a href="/gostd/net/net.go.html#3341758">Net</a></span><span class="op" id="3309194">:</span>&nbsp;<span class="ident" id="3309196"><a href="/gostd/net/iprawsock_posix.go.html#3308705">netProto</a></span><span class="op" id="3309204">,</span>&nbsp;<span class="ident" id="3309206"><a href="/gostd/net/net.go.html#3341833">Addr</a></span><span class="op" id="3309210">:</span>&nbsp;<span class="ident" id="3309212"><a href="/gostd/net/iprawsock_posix.go.html#3308722">laddr</a></span><span class="op" id="3309217">,</span>&nbsp;<span class="ident" id="3309219"><a href="/gostd/net/net.go.html#3341902">Err</a></span><span class="op" id="3309222">:</span>&nbsp;<span class="ident" id="3309224"><a href="/gostd/net/iprawsock_posix.go.html#3308769">err</a></span><span class="op" id="3309227">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3309230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3309233">return</span>&nbsp;<span class="ident" id="3309240"><a href="/gostd/net/iprawsock_posix.go.html#3303829">newIPConn</a></span><span class="op" id="3309249">(</span><span class="ident" id="3309250"><a href="/gostd/net/iprawsock_posix.go.html#3309047">fd</a></span><span class="op" id="3309252">)</span><span class="op" id="3309253">,</span>&nbsp;<span class="builtintype" id="3309255">nil</span><br>
<span class="lineno"></span><span class="op" id="3309259">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
