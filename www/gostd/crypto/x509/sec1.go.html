<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html" class="current">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4694414">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4694469">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4694523">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4694574">package</span>&nbsp;<span class="ident" id="4694582">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4694588">import</span>&nbsp;<span class="op" id="4694595">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4694598">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4694614">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4694633">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4694650">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4694660">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4694667">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4694678">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4694681">const</span>&nbsp;<span class="ident" id="4694687">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4694704">=</span>&nbsp;<span class="num" id="4694706">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4694709">//&nbsp;ecPrivateKey&nbsp;reflects&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4694781">//&nbsp;References:</span><br>
<span class="lineno">20</span><span class="comment" id="4694796">//&nbsp;&nbsp;&nbsp;RFC5915</span><br>
<span class="lineno"></span><span class="comment" id="4694809">//&nbsp;&nbsp;&nbsp;SEC1&nbsp;-&nbsp;http://www.secg.org/download/aid-780/sec1-v2.pdf</span><br>
<span class="lineno"></span><span class="comment" id="4694870">//&nbsp;Per&nbsp;RFC5915&nbsp;the&nbsp;NamedCurveOID&nbsp;is&nbsp;marked&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL,&nbsp;however&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4694943">//&nbsp;most&nbsp;cases&nbsp;it&nbsp;is&nbsp;not.</span><br>
<span class="lineno"></span><span class="keyword" id="4694968">type</span>&nbsp;<span class="ident" id="4694973">ecPrivateKey</span>&nbsp;<span class="keyword" id="4694986">struct</span>&nbsp;<span class="op" id="4694993">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4694996">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4695010">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695015">PrivateKey</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4695029">[</span><span class="op" id="4695030">]</span><span class="builtintype" id="4695031">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695037">NamedCurveOID</span>&nbsp;<span class="ident" id="4695051">asn1</span><span class="op" id="4695055">.</span><span class="ident" id="4695056">ObjectIdentifier</span>&nbsp;<span class="string" id="4695073">`asn1:&#34;optional,explicit,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695107">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695121">asn1</span><span class="op" id="4695125">.</span><span class="ident" id="4695126">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4695143">`asn1:&#34;optional,explicit,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4695176">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4695179">//&nbsp;ParseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4695254">func</span>&nbsp;<span class="ident" id="4695259">ParseECPrivateKey</span><span class="op" id="4695276">(</span><span class="ident" id="4695277">der</span>&nbsp;<span class="op" id="4695281">[</span><span class="op" id="4695282">]</span><span class="builtintype" id="4695283">byte</span><span class="op" id="4695287">)</span>&nbsp;<span class="op" id="4695289">(</span><span class="ident" id="4695290">key</span>&nbsp;<span class="op" id="4695294">*</span><span class="ident" id="4695295">ecdsa</span><span class="op" id="4695300">.</span><span class="ident" id="4695301">PrivateKey</span><span class="op" id="4695311">,</span>&nbsp;<span class="ident" id="4695313">err</span>&nbsp;<span class="builtintype" id="4695317">error</span><span class="op" id="4695322">)</span>&nbsp;<span class="op" id="4695324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4695327">return</span>&nbsp;<span class="ident" id="4695334">parseECPrivateKey</span><span class="op" id="4695351">(</span><span class="ident" id="4695352">nil</span><span class="op" id="4695355">,</span>&nbsp;<span class="ident" id="4695357">der</span><span class="op" id="4695360">)</span><br>
<span class="lineno"></span><span class="op" id="4695362">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4695365">//&nbsp;MarshalECPrivateKey&nbsp;marshals&nbsp;an&nbsp;EC&nbsp;private&nbsp;key&nbsp;into&nbsp;ASN.1,&nbsp;DER&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="4695439">func</span>&nbsp;<span class="ident" id="4695444">MarshalECPrivateKey</span><span class="op" id="4695463">(</span><span class="ident" id="4695464">key</span>&nbsp;<span class="op" id="4695468">*</span><span class="ident" id="4695469">ecdsa</span><span class="op" id="4695474">.</span><span class="ident" id="4695475">PrivateKey</span><span class="op" id="4695485">)</span>&nbsp;<span class="op" id="4695487">(</span><span class="op" id="4695488">[</span><span class="op" id="4695489">]</span><span class="builtintype" id="4695490">byte</span><span class="op" id="4695494">,</span>&nbsp;<span class="builtintype" id="4695496">error</span><span class="op" id="4695501">)</span>&nbsp;<span class="op" id="4695503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695506">oid</span><span class="op" id="4695509">,</span>&nbsp;<span class="ident" id="4695511">ok</span>&nbsp;<span class="op" id="4695514">:=</span>&nbsp;<span class="ident" id="4695517">oidFromNamedCurve</span><span class="op" id="4695534">(</span><span class="ident" id="4695535">key</span><span class="op" id="4695538">.</span><span class="ident" id="4695539">Curve</span><span class="op" id="4695544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4695547">if</span>&nbsp;<span class="op" id="4695550">!</span><span class="ident" id="4695551">ok</span>&nbsp;<span class="op" id="4695554">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4695558">return</span>&nbsp;<span class="ident" id="4695565">nil</span><span class="op" id="4695568">,</span>&nbsp;<span class="ident" id="4695570">errors</span><span class="op" id="4695576">.</span><span class="ident" id="4695577">New</span><span class="op" id="4695580">(</span><span class="string" id="4695581">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4695611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4695614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4695617">return</span>&nbsp;<span class="ident" id="4695624">asn1</span><span class="op" id="4695628">.</span><span class="ident" id="4695629">Marshal</span><span class="op" id="4695636">(</span><span class="ident" id="4695637">ecPrivateKey</span><span class="op" id="4695649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695653">Version</span><span class="op" id="4695660">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4695668">1</span><span class="op" id="4695669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695673">PrivateKey</span><span class="op" id="4695683">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695688">key</span><span class="op" id="4695691">.</span><span class="ident" id="4695692">D</span><span class="op" id="4695693">.</span><span class="ident" id="4695694">Bytes</span><span class="op" id="4695699">(</span><span class="op" id="4695700">)</span><span class="op" id="4695701">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695705">NamedCurveOID</span><span class="op" id="4695718">:</span>&nbsp;<span class="ident" id="4695720">oid</span><span class="op" id="4695723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4695727">PublicKey</span><span class="op" id="4695736">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695742">asn1</span><span class="op" id="4695746">.</span><span class="ident" id="4695747">BitString</span><span class="op" id="4695756">{</span><span class="ident" id="4695757">Bytes</span><span class="op" id="4695762">:</span>&nbsp;<span class="ident" id="4695764">elliptic</span><span class="op" id="4695772">.</span><span class="ident" id="4695773">Marshal</span><span class="op" id="4695780">(</span><span class="ident" id="4695781">key</span><span class="op" id="4695784">.</span><span class="ident" id="4695785">Curve</span><span class="op" id="4695790">,</span>&nbsp;<span class="ident" id="4695792">key</span><span class="op" id="4695795">.</span><span class="ident" id="4695796">X</span><span class="op" id="4695797">,</span>&nbsp;<span class="ident" id="4695799">key</span><span class="op" id="4695802">.</span><span class="ident" id="4695803">Y</span><span class="op" id="4695804">)</span><span class="op" id="4695805">}</span><span class="op" id="4695806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4695809">}</span><span class="op" id="4695810">)</span><br>
<span class="lineno"></span><span class="op" id="4695812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4695815">//&nbsp;parseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4695890">//&nbsp;The&nbsp;OID&nbsp;for&nbsp;the&nbsp;named&nbsp;curve&nbsp;may&nbsp;be&nbsp;provided&nbsp;from&nbsp;another&nbsp;source&nbsp;(such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4695966">//&nbsp;the&nbsp;PKCS8&nbsp;container)&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;provided&nbsp;then&nbsp;use&nbsp;this&nbsp;instead&nbsp;of&nbsp;the&nbsp;OID</span><br>
<span class="lineno"></span><span class="comment" id="4696043">//&nbsp;that&nbsp;may&nbsp;exist&nbsp;in&nbsp;the&nbsp;EC&nbsp;private&nbsp;key&nbsp;structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4696094">func</span>&nbsp;<span class="ident" id="4696099">parseECPrivateKey</span><span class="op" id="4696116">(</span><span class="ident" id="4696117">namedCurveOID</span>&nbsp;<span class="op" id="4696131">*</span><span class="ident" id="4696132">asn1</span><span class="op" id="4696136">.</span><span class="ident" id="4696137">ObjectIdentifier</span><span class="op" id="4696153">,</span>&nbsp;<span class="ident" id="4696155">der</span>&nbsp;<span class="op" id="4696159">[</span><span class="op" id="4696160">]</span><span class="builtintype" id="4696161">byte</span><span class="op" id="4696165">)</span>&nbsp;<span class="op" id="4696167">(</span><span class="ident" id="4696168">key</span>&nbsp;<span class="op" id="4696172">*</span><span class="ident" id="4696173">ecdsa</span><span class="op" id="4696178">.</span><span class="ident" id="4696179">PrivateKey</span><span class="op" id="4696189">,</span>&nbsp;<span class="ident" id="4696191">err</span>&nbsp;<span class="builtintype" id="4696195">error</span><span class="op" id="4696200">)</span>&nbsp;<span class="op" id="4696202">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696205">var</span>&nbsp;<span class="ident" id="4696209">privKey</span>&nbsp;<span class="ident" id="4696217">ecPrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696231">if</span>&nbsp;<span class="ident" id="4696234">_</span><span class="op" id="4696235">,</span>&nbsp;<span class="ident" id="4696237">err</span>&nbsp;<span class="op" id="4696241">:=</span>&nbsp;<span class="ident" id="4696244">asn1</span><span class="op" id="4696248">.</span><span class="ident" id="4696249">Unmarshal</span><span class="op" id="4696258">(</span><span class="ident" id="4696259">der</span><span class="op" id="4696262">,</span>&nbsp;<span class="op" id="4696264">&amp;</span><span class="ident" id="4696265">privKey</span><span class="op" id="4696272">)</span><span class="op" id="4696273">;</span>&nbsp;<span class="ident" id="4696275">err</span>&nbsp;<span class="op" id="4696279">!=</span>&nbsp;<span class="ident" id="4696282">nil</span>&nbsp;<span class="op" id="4696286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696290">return</span>&nbsp;<span class="ident" id="4696297">nil</span><span class="op" id="4696300">,</span>&nbsp;<span class="ident" id="4696302">errors</span><span class="op" id="4696308">.</span><span class="ident" id="4696309">New</span><span class="op" id="4696312">(</span><span class="string" id="4696313">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key:&nbsp;&#34;</span>&nbsp;<span class="op" id="4696354">+</span>&nbsp;<span class="ident" id="4696356">err</span><span class="op" id="4696359">.</span><span class="ident" id="4696360">Error</span><span class="op" id="4696365">(</span><span class="op" id="4696366">)</span><span class="op" id="4696367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4696370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696373">if</span>&nbsp;<span class="ident" id="4696376">privKey</span><span class="op" id="4696383">.</span><span class="ident" id="4696384">Version</span>&nbsp;<span class="op" id="4696392">!=</span>&nbsp;<span class="ident" id="4696395">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4696412">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696416">return</span>&nbsp;<span class="ident" id="4696423">nil</span><span class="op" id="4696426">,</span>&nbsp;<span class="ident" id="4696428">fmt</span><span class="op" id="4696431">.</span><span class="ident" id="4696432">Errorf</span><span class="op" id="4696438">(</span><span class="string" id="4696439">&#34;x509:&nbsp;unknown&nbsp;EC&nbsp;private&nbsp;key&nbsp;version&nbsp;%d&#34;</span><span class="op" id="4696480">,</span>&nbsp;<span class="ident" id="4696482">privKey</span><span class="op" id="4696489">.</span><span class="ident" id="4696490">Version</span><span class="op" id="4696497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4696500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696504">var</span>&nbsp;<span class="ident" id="4696508">curve</span>&nbsp;<span class="ident" id="4696514">elliptic</span><span class="op" id="4696522">.</span><span class="ident" id="4696523">Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696530">if</span>&nbsp;<span class="ident" id="4696533">namedCurveOID</span>&nbsp;<span class="op" id="4696547">!=</span>&nbsp;<span class="ident" id="4696550">nil</span>&nbsp;<span class="op" id="4696554">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696558">curve</span>&nbsp;<span class="op" id="4696564">=</span>&nbsp;<span class="ident" id="4696566">namedCurveFromOID</span><span class="op" id="4696583">(</span><span class="op" id="4696584">*</span><span class="ident" id="4696585">namedCurveOID</span><span class="op" id="4696598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4696601">}</span>&nbsp;<span class="keyword" id="4696603">else</span>&nbsp;<span class="op" id="4696608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696612">curve</span>&nbsp;<span class="op" id="4696618">=</span>&nbsp;<span class="ident" id="4696620">namedCurveFromOID</span><span class="op" id="4696637">(</span><span class="ident" id="4696638">privKey</span><span class="op" id="4696645">.</span><span class="ident" id="4696646">NamedCurveOID</span><span class="op" id="4696659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4696662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696665">if</span>&nbsp;<span class="ident" id="4696668">curve</span>&nbsp;<span class="op" id="4696674">==</span>&nbsp;<span class="ident" id="4696677">nil</span>&nbsp;<span class="op" id="4696681">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696685">return</span>&nbsp;<span class="ident" id="4696692">nil</span><span class="op" id="4696695">,</span>&nbsp;<span class="ident" id="4696697">errors</span><span class="op" id="4696703">.</span><span class="ident" id="4696704">New</span><span class="op" id="4696707">(</span><span class="string" id="4696708">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4696738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4696741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696745">k</span>&nbsp;<span class="op" id="4696747">:=</span>&nbsp;<span class="builtinfunc" id="4696750">new</span><span class="op" id="4696753">(</span><span class="ident" id="4696754">big</span><span class="op" id="4696757">.</span><span class="ident" id="4696758">Int</span><span class="op" id="4696761">)</span><span class="op" id="4696762">.</span><span class="ident" id="4696763">SetBytes</span><span class="op" id="4696771">(</span><span class="ident" id="4696772">privKey</span><span class="op" id="4696779">.</span><span class="ident" id="4696780">PrivateKey</span><span class="op" id="4696790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696793">if</span>&nbsp;<span class="ident" id="4696796">k</span><span class="op" id="4696797">.</span><span class="ident" id="4696798">Cmp</span><span class="op" id="4696801">(</span><span class="ident" id="4696802">curve</span><span class="op" id="4696807">.</span><span class="ident" id="4696808">Params</span><span class="op" id="4696814">(</span><span class="op" id="4696815">)</span><span class="op" id="4696816">.</span><span class="ident" id="4696817">N</span><span class="op" id="4696818">)</span>&nbsp;<span class="op" id="4696820">&gt;=</span>&nbsp;<span class="num" id="4696823">0</span>&nbsp;<span class="op" id="4696825">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4696829">return</span>&nbsp;<span class="ident" id="4696836">nil</span><span class="op" id="4696839">,</span>&nbsp;<span class="ident" id="4696841">errors</span><span class="op" id="4696847">.</span><span class="ident" id="4696848">New</span><span class="op" id="4696851">(</span><span class="string" id="4696852">&#34;x509:&nbsp;invalid&nbsp;elliptic&nbsp;curve&nbsp;private&nbsp;key&nbsp;value&#34;</span><span class="op" id="4696900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4696903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696906">priv</span>&nbsp;<span class="op" id="4696911">:=</span>&nbsp;<span class="builtinfunc" id="4696914">new</span><span class="op" id="4696917">(</span><span class="ident" id="4696918">ecdsa</span><span class="op" id="4696923">.</span><span class="ident" id="4696924">PrivateKey</span><span class="op" id="4696934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696937">priv</span><span class="op" id="4696941">.</span><span class="ident" id="4696942">Curve</span>&nbsp;<span class="op" id="4696948">=</span>&nbsp;<span class="ident" id="4696950">curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696957">priv</span><span class="op" id="4696961">.</span><span class="ident" id="4696962">D</span>&nbsp;<span class="op" id="4696964">=</span>&nbsp;<span class="ident" id="4696966">k</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4696969">priv</span><span class="op" id="4696973">.</span><span class="ident" id="4696974">X</span><span class="op" id="4696975">,</span>&nbsp;<span class="ident" id="4696977">priv</span><span class="op" id="4696981">.</span><span class="ident" id="4696982">Y</span>&nbsp;<span class="op" id="4696984">=</span>&nbsp;<span class="ident" id="4696986">curve</span><span class="op" id="4696991">.</span><span class="ident" id="4696992">ScalarBaseMult</span><span class="op" id="4697006">(</span><span class="ident" id="4697007">privKey</span><span class="op" id="4697014">.</span><span class="ident" id="4697015">PrivateKey</span><span class="op" id="4697025">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4697029">return</span>&nbsp;<span class="ident" id="4697036">priv</span><span class="op" id="4697040">,</span>&nbsp;<span class="ident" id="4697042">nil</span><br>
<span class="lineno"></span><span class="op" id="4697046">}</span>
</div>
</body>
</html>
