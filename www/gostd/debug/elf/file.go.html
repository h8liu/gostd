<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/elf</h2>
<ul>
<li><a href="/gostd/debug/elf/elf.go.html">elf.go</a></li>
<li><a href="/gostd/debug/elf/elf_test.go.html">elf_test.go</a></li>
<li><a href="/gostd/debug/elf/file.go.html" class="current">file.go</a></li>
<li><a href="/gostd/debug/elf/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/elf/symbols_test.go.html">symbols_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6249048">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6249104">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6249158">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6249209">//&nbsp;Package&nbsp;elf&nbsp;implements&nbsp;access&nbsp;to&nbsp;ELF&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="6249263">package</span>&nbsp;<span class="ident" id="6249271">elf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6249276">import</span>&nbsp;<span class="op" id="6249283">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6249286">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6249295">&#34;debug/dwarf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6249310">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6249329">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6249339">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6249346">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6249352">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="6249357">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6249360">//&nbsp;TODO:&nbsp;error&nbsp;reporting&nbsp;detail</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="6249393">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Internal&nbsp;ELF&nbsp;representation<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6249432">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;an&nbsp;ELF&nbsp;file&nbsp;header.</span><br>
<span class="lineno">25</span><span class="keyword" id="6249479">type</span>&nbsp;<span class="ident" id="6249484">FileHeader</span>&nbsp;<span class="keyword" id="6249495">struct</span>&nbsp;<span class="op" id="6249502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249505">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249516">Class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249523">Data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249534">Data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249540">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249551">Version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249560">OSABI</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249571">OSABI</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249578">ABIVersion</span>&nbsp;<span class="builtintype" id="6249589">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249596">ByteOrder</span>&nbsp;&nbsp;<span class="ident" id="6249607">binary</span><span class="op" id="6249613">.</span><span class="ident" id="6249614">ByteOrder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249625">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249636">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249642">Machine</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249653">Machine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249662">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249673">uint64</span><br>
<span class="lineno">35</span><span class="op" id="6249680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6249683">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6249722">type</span>&nbsp;<span class="ident" id="6249727">File</span>&nbsp;<span class="keyword" id="6249732">struct</span>&nbsp;<span class="op" id="6249739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249742">FileHeader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249754">Sections</span>&nbsp;&nbsp;<span class="op" id="6249764">[</span><span class="op" id="6249765">]</span><span class="op" id="6249766">*</span><span class="ident" id="6249767">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249776">Progs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6249786">[</span><span class="op" id="6249787">]</span><span class="op" id="6249788">*</span><span class="ident" id="6249789">Prog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249795">closer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249805">io</span><span class="op" id="6249807">.</span><span class="ident" id="6249808">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249816">gnuNeed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6249826">[</span><span class="op" id="6249827">]</span><span class="ident" id="6249828">verneed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249837">gnuVersym</span>&nbsp;<span class="op" id="6249847">[</span><span class="op" id="6249848">]</span><span class="builtintype" id="6249849">byte</span><br>
<span class="lineno">45</span><span class="op" id="6249854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6249857">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6249916">type</span>&nbsp;<span class="ident" id="6249921">SectionHeader</span>&nbsp;<span class="keyword" id="6249935">struct</span>&nbsp;<span class="op" id="6249942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249945">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6249955">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249963">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249973">SectionType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249986">Flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6249996">SectionFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6250009">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6250019">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6250027">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6250037">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6250045">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6250055">uint64</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6250063">Link</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6250073">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6250081">Info</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6250091">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6250099">Addralign</span>&nbsp;<span class="ident" id="6250109">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6250117">Entsize</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6250127">uint64</span><br>
<span class="lineno"></span><span class="op" id="6250134">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="6250137">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;an&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6250194">type</span>&nbsp;<span class="ident" id="6250199">Section</span>&nbsp;<span class="keyword" id="6250207">struct</span>&nbsp;<span class="op" id="6250214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6250217">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6250233">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6250271">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6250311">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6250346">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6250394">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6250444">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6250468">io</span><span class="op" id="6250470">.</span><span class="ident" id="6250471">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6250481">sr</span>&nbsp;<span class="op" id="6250484">*</span><span class="ident" id="6250485">io</span><span class="op" id="6250487">.</span><span class="ident" id="6250488">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6250502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="6250505">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6250564">func</span>&nbsp;<span class="op" id="6250569">(</span><span class="ident" id="6250570">s</span>&nbsp;<span class="op" id="6250572">*</span><span class="ident" id="6250573">Section</span><span class="op" id="6250580">)</span>&nbsp;<span class="ident" id="6250582">Data</span><span class="op" id="6250586">(</span><span class="op" id="6250587">)</span>&nbsp;<span class="op" id="6250589">(</span><span class="op" id="6250590">[</span><span class="op" id="6250591">]</span><span class="builtintype" id="6250592">byte</span><span class="op" id="6250596">,</span>&nbsp;<span class="builtintype" id="6250598">error</span><span class="op" id="6250603">)</span>&nbsp;<span class="op" id="6250605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6250608">dat</span>&nbsp;<span class="op" id="6250612">:=</span>&nbsp;<span class="builtinfunc" id="6250615">make</span><span class="op" id="6250619">(</span><span class="op" id="6250620">[</span><span class="op" id="6250621">]</span><span class="builtintype" id="6250622">byte</span><span class="op" id="6250626">,</span>&nbsp;<span class="ident" id="6250628">s</span><span class="op" id="6250629">.</span><span class="ident" id="6250630">sr</span><span class="op" id="6250632">.</span><span class="ident" id="6250633">Size</span><span class="op" id="6250637">(</span><span class="op" id="6250638">)</span><span class="op" id="6250639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6250642">n</span><span class="op" id="6250643">,</span>&nbsp;<span class="ident" id="6250645">err</span>&nbsp;<span class="op" id="6250649">:=</span>&nbsp;<span class="ident" id="6250652">s</span><span class="op" id="6250653">.</span><span class="ident" id="6250654">sr</span><span class="op" id="6250656">.</span><span class="ident" id="6250657">ReadAt</span><span class="op" id="6250663">(</span><span class="ident" id="6250664">dat</span><span class="op" id="6250667">,</span>&nbsp;<span class="num" id="6250669">0</span><span class="op" id="6250670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6250673">if</span>&nbsp;<span class="ident" id="6250676">n</span>&nbsp;<span class="op" id="6250678">==</span>&nbsp;<span class="builtinfunc" id="6250681">len</span><span class="op" id="6250684">(</span><span class="ident" id="6250685">dat</span><span class="op" id="6250688">)</span>&nbsp;<span class="op" id="6250690">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6250694">err</span>&nbsp;<span class="op" id="6250698">=</span>&nbsp;<span class="builtintype" id="6250700">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6250705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6250708">return</span>&nbsp;<span class="ident" id="6250715">dat</span><span class="op" id="6250718">[</span><span class="num" id="6250719">0</span><span class="op" id="6250720">:</span><span class="ident" id="6250721">n</span><span class="op" id="6250722">]</span><span class="op" id="6250723">,</span>&nbsp;<span class="ident" id="6250725">err</span><br>
<span class="lineno"></span><span class="op" id="6250729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="6250732">//&nbsp;stringTable&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;string&nbsp;table&nbsp;given&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6250795">//&nbsp;specified&nbsp;link&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="6250820">func</span>&nbsp;<span class="op" id="6250825">(</span><span class="ident" id="6250826">f</span>&nbsp;<span class="op" id="6250828">*</span><span class="ident" id="6250829">File</span><span class="op" id="6250833">)</span>&nbsp;<span class="ident" id="6250835">stringTable</span><span class="op" id="6250846">(</span><span class="ident" id="6250847">link</span>&nbsp;<span class="builtintype" id="6250852">uint32</span><span class="op" id="6250858">)</span>&nbsp;<span class="op" id="6250860">(</span><span class="op" id="6250861">[</span><span class="op" id="6250862">]</span><span class="builtintype" id="6250863">byte</span><span class="op" id="6250867">,</span>&nbsp;<span class="builtintype" id="6250869">error</span><span class="op" id="6250874">)</span>&nbsp;<span class="op" id="6250876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6250879">if</span>&nbsp;<span class="ident" id="6250882">link</span>&nbsp;<span class="op" id="6250887">&lt;=</span>&nbsp;<span class="num" id="6250890">0</span>&nbsp;<span class="op" id="6250892">||</span>&nbsp;<span class="ident" id="6250895">link</span>&nbsp;<span class="op" id="6250900">&gt;=</span>&nbsp;<span class="builtintype" id="6250903">uint32</span><span class="op" id="6250909">(</span><span class="builtinfunc" id="6250910">len</span><span class="op" id="6250913">(</span><span class="ident" id="6250914">f</span><span class="op" id="6250915">.</span><span class="ident" id="6250916">Sections</span><span class="op" id="6250924">)</span><span class="op" id="6250925">)</span>&nbsp;<span class="op" id="6250927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6250931">return</span>&nbsp;<span class="builtintype" id="6250938">nil</span><span class="op" id="6250941">,</span>&nbsp;<span class="ident" id="6250943">errors</span><span class="op" id="6250949">.</span><span class="ident" id="6250950">New</span><span class="op" id="6250953">(</span><span class="string" id="6250954">&#34;section&nbsp;has&nbsp;invalid&nbsp;string&nbsp;table&nbsp;link&#34;</span><span class="op" id="6250993">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6250996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6250999">return</span>&nbsp;<span class="ident" id="6251006">f</span><span class="op" id="6251007">.</span><span class="ident" id="6251008">Sections</span><span class="op" id="6251016">[</span><span class="ident" id="6251017">link</span><span class="op" id="6251021">]</span><span class="op" id="6251022">.</span><span class="ident" id="6251023">Data</span><span class="op" id="6251027">(</span><span class="op" id="6251028">)</span><br>
<span class="lineno"></span><span class="op" id="6251030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6251033">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno">95</span><span class="keyword" id="6251091">func</span>&nbsp;<span class="op" id="6251096">(</span><span class="ident" id="6251097">s</span>&nbsp;<span class="op" id="6251099">*</span><span class="ident" id="6251100">Section</span><span class="op" id="6251107">)</span>&nbsp;<span class="ident" id="6251109">Open</span><span class="op" id="6251113">(</span><span class="op" id="6251114">)</span>&nbsp;<span class="ident" id="6251116">io</span><span class="op" id="6251118">.</span><span class="ident" id="6251119">ReadSeeker</span>&nbsp;<span class="op" id="6251130">{</span>&nbsp;<span class="keyword" id="6251132">return</span>&nbsp;<span class="ident" id="6251139">io</span><span class="op" id="6251141">.</span><span class="ident" id="6251142">NewSectionReader</span><span class="op" id="6251158">(</span><span class="ident" id="6251159">s</span><span class="op" id="6251160">.</span><span class="ident" id="6251161">sr</span><span class="op" id="6251163">,</span>&nbsp;<span class="num" id="6251165">0</span><span class="op" id="6251166">,</span>&nbsp;<span class="num" id="6251168">1</span><span class="op" id="6251169">&lt;&lt;</span><span class="num" id="6251171">63</span><span class="op" id="6251173">-</span><span class="num" id="6251174">1</span><span class="op" id="6251175">)</span>&nbsp;<span class="op" id="6251177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6251180">//&nbsp;A&nbsp;ProgHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6251236">type</span>&nbsp;<span class="ident" id="6251241">ProgHeader</span>&nbsp;<span class="keyword" id="6251252">struct</span>&nbsp;<span class="op" id="6251259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6251262">Type</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6251269">ProgType</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6251279">Flags</span>&nbsp;&nbsp;<span class="ident" id="6251286">ProgFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6251296">Off</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6251303">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6251311">Vaddr</span>&nbsp;&nbsp;<span class="ident" id="6251318">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6251326">Paddr</span>&nbsp;&nbsp;<span class="ident" id="6251333">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6251341">Filesz</span>&nbsp;<span class="ident" id="6251348">uint64</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6251356">Memsz</span>&nbsp;&nbsp;<span class="ident" id="6251363">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6251371">Align</span>&nbsp;&nbsp;<span class="ident" id="6251378">uint64</span><br>
<span class="lineno"></span><span class="op" id="6251385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6251388">//&nbsp;A&nbsp;Prog&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header&nbsp;in&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno">110</span><span class="keyword" id="6251455">type</span>&nbsp;<span class="ident" id="6251460">Prog</span>&nbsp;<span class="keyword" id="6251465">struct</span>&nbsp;<span class="op" id="6251472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6251475">ProgHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6251488">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6251526">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6251566">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6251601">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6251649">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6251699">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6251723">io</span><span class="op" id="6251725">.</span><span class="ident" id="6251726">ReaderAt</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6251736">sr</span>&nbsp;<span class="op" id="6251739">*</span><span class="ident" id="6251740">io</span><span class="op" id="6251742">.</span><span class="ident" id="6251743">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6251757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6251760">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;program&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="6251823">func</span>&nbsp;<span class="op" id="6251828">(</span><span class="ident" id="6251829">p</span>&nbsp;<span class="op" id="6251831">*</span><span class="ident" id="6251832">Prog</span><span class="op" id="6251836">)</span>&nbsp;<span class="ident" id="6251838">Open</span><span class="op" id="6251842">(</span><span class="op" id="6251843">)</span>&nbsp;<span class="ident" id="6251845">io</span><span class="op" id="6251847">.</span><span class="ident" id="6251848">ReadSeeker</span>&nbsp;<span class="op" id="6251859">{</span>&nbsp;<span class="keyword" id="6251861">return</span>&nbsp;<span class="ident" id="6251868">io</span><span class="op" id="6251870">.</span><span class="ident" id="6251871">NewSectionReader</span><span class="op" id="6251887">(</span><span class="ident" id="6251888">p</span><span class="op" id="6251889">.</span><span class="ident" id="6251890">sr</span><span class="op" id="6251892">,</span>&nbsp;<span class="num" id="6251894">0</span><span class="op" id="6251895">,</span>&nbsp;<span class="num" id="6251897">1</span><span class="op" id="6251898">&lt;&lt;</span><span class="num" id="6251900">63</span><span class="op" id="6251902">-</span><span class="num" id="6251903">1</span><span class="op" id="6251904">)</span>&nbsp;<span class="op" id="6251906">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="6251909">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;an&nbsp;ELF&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6251973">type</span>&nbsp;<span class="ident" id="6251978">Symbol</span>&nbsp;<span class="keyword" id="6251985">struct</span>&nbsp;<span class="op" id="6251992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6251995">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6252007">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6252015">Info</span><span class="op" id="6252019">,</span>&nbsp;<span class="ident" id="6252021">Other</span>&nbsp;<span class="builtintype" id="6252027">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6252033">Section</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6252045">SectionIndex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6252059">Value</span><span class="op" id="6252064">,</span>&nbsp;<span class="ident" id="6252066">Size</span>&nbsp;<span class="ident" id="6252071">uint64</span><br>
<span class="lineno"></span><span class="op" id="6252078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6252081">/*<br>
<span class="lineno">135</span>&nbsp;*&nbsp;ELF&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6252103">type</span>&nbsp;<span class="ident" id="6252108">FormatError</span>&nbsp;<span class="keyword" id="6252120">struct</span>&nbsp;<span class="op" id="6252127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6252130">off</span>&nbsp;<span class="ident" id="6252134">int64</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6252141">msg</span>&nbsp;<span class="builtintype" id="6252145">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6252153">val</span>&nbsp;<span class="keyword" id="6252157">interface</span><span class="op" id="6252166">{</span><span class="op" id="6252167">}</span><br>
<span class="lineno"></span><span class="op" id="6252169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6252172">func</span>&nbsp;<span class="op" id="6252177">(</span><span class="ident" id="6252178">e</span>&nbsp;<span class="op" id="6252180">*</span><span class="ident" id="6252181">FormatError</span><span class="op" id="6252192">)</span>&nbsp;<span class="ident" id="6252194">Error</span><span class="op" id="6252199">(</span><span class="op" id="6252200">)</span>&nbsp;<span class="builtintype" id="6252202">string</span>&nbsp;<span class="op" id="6252209">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6252212">msg</span>&nbsp;<span class="op" id="6252216">:=</span>&nbsp;<span class="ident" id="6252219">e</span><span class="op" id="6252220">.</span><span class="ident" id="6252221">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6252226">if</span>&nbsp;<span class="ident" id="6252229">e</span><span class="op" id="6252230">.</span><span class="ident" id="6252231">val</span>&nbsp;<span class="op" id="6252235">!=</span>&nbsp;<span class="builtintype" id="6252238">nil</span>&nbsp;<span class="op" id="6252242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6252246">msg</span>&nbsp;<span class="op" id="6252250">+=</span>&nbsp;<span class="ident" id="6252253">fmt</span><span class="op" id="6252256">.</span><span class="ident" id="6252257">Sprintf</span><span class="op" id="6252264">(</span><span class="string" id="6252265">&#34;&nbsp;&#39;%v&#39;&nbsp;&#34;</span><span class="op" id="6252273">,</span>&nbsp;<span class="ident" id="6252275">e</span><span class="op" id="6252276">.</span><span class="ident" id="6252277">val</span><span class="op" id="6252280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6252283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6252286">msg</span>&nbsp;<span class="op" id="6252290">+=</span>&nbsp;<span class="ident" id="6252293">fmt</span><span class="op" id="6252296">.</span><span class="ident" id="6252297">Sprintf</span><span class="op" id="6252304">(</span><span class="string" id="6252305">&#34;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="6252328">,</span>&nbsp;<span class="ident" id="6252330">e</span><span class="op" id="6252331">.</span><span class="ident" id="6252332">off</span><span class="op" id="6252335">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6252338">return</span>&nbsp;<span class="ident" id="6252345">msg</span><br>
<span class="lineno"></span><span class="op" id="6252349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6252352">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="6252437">func</span>&nbsp;<span class="ident" id="6252442">Open</span><span class="op" id="6252446">(</span><span class="ident" id="6252447">name</span>&nbsp;<span class="builtintype" id="6252452">string</span><span class="op" id="6252458">)</span>&nbsp;<span class="op" id="6252460">(</span><span class="op" id="6252461">*</span><span class="ident" id="6252462">File</span><span class="op" id="6252466">,</span>&nbsp;<span class="builtintype" id="6252468">error</span><span class="op" id="6252473">)</span>&nbsp;<span class="op" id="6252475">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6252478">f</span><span class="op" id="6252479">,</span>&nbsp;<span class="ident" id="6252481">err</span>&nbsp;<span class="op" id="6252485">:=</span>&nbsp;<span class="ident" id="6252488">os</span><span class="op" id="6252490">.</span><span class="ident" id="6252491">Open</span><span class="op" id="6252495">(</span><span class="ident" id="6252496">name</span><span class="op" id="6252500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6252503">if</span>&nbsp;<span class="ident" id="6252506">err</span>&nbsp;<span class="op" id="6252510">!=</span>&nbsp;<span class="builtintype" id="6252513">nil</span>&nbsp;<span class="op" id="6252517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6252521">return</span>&nbsp;<span class="builtintype" id="6252528">nil</span><span class="op" id="6252531">,</span>&nbsp;<span class="ident" id="6252533">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6252538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6252541">ff</span><span class="op" id="6252543">,</span>&nbsp;<span class="ident" id="6252545">err</span>&nbsp;<span class="op" id="6252549">:=</span>&nbsp;<span class="ident" id="6252552">NewFile</span><span class="op" id="6252559">(</span><span class="ident" id="6252560">f</span><span class="op" id="6252561">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6252564">if</span>&nbsp;<span class="ident" id="6252567">err</span>&nbsp;<span class="op" id="6252571">!=</span>&nbsp;<span class="builtintype" id="6252574">nil</span>&nbsp;<span class="op" id="6252578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6252582">f</span><span class="op" id="6252583">.</span><span class="ident" id="6252584">Close</span><span class="op" id="6252589">(</span><span class="op" id="6252590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6252594">return</span>&nbsp;<span class="builtintype" id="6252601">nil</span><span class="op" id="6252604">,</span>&nbsp;<span class="ident" id="6252606">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6252611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6252614">ff</span><span class="op" id="6252616">.</span><span class="ident" id="6252617">closer</span>&nbsp;<span class="op" id="6252624">=</span>&nbsp;<span class="ident" id="6252626">f</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6252629">return</span>&nbsp;<span class="ident" id="6252636">ff</span><span class="op" id="6252638">,</span>&nbsp;<span class="builtintype" id="6252640">nil</span><br>
<span class="lineno"></span><span class="op" id="6252644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6252647">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="6252673">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno">170</span><span class="comment" id="6252740">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="6252764">func</span>&nbsp;<span class="op" id="6252769">(</span><span class="ident" id="6252770">f</span>&nbsp;<span class="op" id="6252772">*</span><span class="ident" id="6252773">File</span><span class="op" id="6252777">)</span>&nbsp;<span class="ident" id="6252779">Close</span><span class="op" id="6252784">(</span><span class="op" id="6252785">)</span>&nbsp;<span class="builtintype" id="6252787">error</span>&nbsp;<span class="op" id="6252793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6252796">var</span>&nbsp;<span class="ident" id="6252800">err</span>&nbsp;<span class="builtintype" id="6252804">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6252811">if</span>&nbsp;<span class="ident" id="6252814">f</span><span class="op" id="6252815">.</span><span class="ident" id="6252816">closer</span>&nbsp;<span class="op" id="6252823">!=</span>&nbsp;<span class="builtintype" id="6252826">nil</span>&nbsp;<span class="op" id="6252830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6252834">err</span>&nbsp;<span class="op" id="6252838">=</span>&nbsp;<span class="ident" id="6252840">f</span><span class="op" id="6252841">.</span><span class="ident" id="6252842">closer</span><span class="op" id="6252848">.</span><span class="ident" id="6252849">Close</span><span class="op" id="6252854">(</span><span class="op" id="6252855">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6252859">f</span><span class="op" id="6252860">.</span><span class="ident" id="6252861">closer</span>&nbsp;<span class="op" id="6252868">=</span>&nbsp;<span class="builtintype" id="6252870">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6252875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6252878">return</span>&nbsp;<span class="ident" id="6252885">err</span><br>
<span class="lineno"></span><span class="op" id="6252889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="6252892">//&nbsp;SectionByType&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;in&nbsp;f&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6252949">//&nbsp;given&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6253000">func</span>&nbsp;<span class="op" id="6253005">(</span><span class="ident" id="6253006">f</span>&nbsp;<span class="op" id="6253008">*</span><span class="ident" id="6253009">File</span><span class="op" id="6253013">)</span>&nbsp;<span class="ident" id="6253015">SectionByType</span><span class="op" id="6253028">(</span><span class="ident" id="6253029">typ</span>&nbsp;<span class="ident" id="6253033">SectionType</span><span class="op" id="6253044">)</span>&nbsp;<span class="op" id="6253046">*</span><span class="ident" id="6253047">Section</span>&nbsp;<span class="op" id="6253055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253058">for</span>&nbsp;<span class="ident" id="6253062">_</span><span class="op" id="6253063">,</span>&nbsp;<span class="ident" id="6253065">s</span>&nbsp;<span class="op" id="6253067">:=</span>&nbsp;<span class="keyword" id="6253070">range</span>&nbsp;<span class="ident" id="6253076">f</span><span class="op" id="6253077">.</span><span class="ident" id="6253078">Sections</span>&nbsp;<span class="op" id="6253087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253091">if</span>&nbsp;<span class="ident" id="6253094">s</span><span class="op" id="6253095">.</span><span class="ident" id="6253096">Type</span>&nbsp;<span class="op" id="6253101">==</span>&nbsp;<span class="ident" id="6253104">typ</span>&nbsp;<span class="op" id="6253108">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253113">return</span>&nbsp;<span class="ident" id="6253120">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6253124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6253127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253130">return</span>&nbsp;<span class="builtintype" id="6253137">nil</span><br>
<span class="lineno"></span><span class="op" id="6253141">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="6253144">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;an&nbsp;ELF&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="6253227">//&nbsp;The&nbsp;ELF&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="6253297">func</span>&nbsp;<span class="ident" id="6253302">NewFile</span><span class="op" id="6253309">(</span><span class="ident" id="6253310">r</span>&nbsp;<span class="ident" id="6253312">io</span><span class="op" id="6253314">.</span><span class="ident" id="6253315">ReaderAt</span><span class="op" id="6253323">)</span>&nbsp;<span class="op" id="6253325">(</span><span class="op" id="6253326">*</span><span class="ident" id="6253327">File</span><span class="op" id="6253331">,</span>&nbsp;<span class="builtintype" id="6253333">error</span><span class="op" id="6253338">)</span>&nbsp;<span class="op" id="6253340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6253343">sr</span>&nbsp;<span class="op" id="6253346">:=</span>&nbsp;<span class="ident" id="6253349">io</span><span class="op" id="6253351">.</span><span class="ident" id="6253352">NewSectionReader</span><span class="op" id="6253368">(</span><span class="ident" id="6253369">r</span><span class="op" id="6253370">,</span>&nbsp;<span class="num" id="6253372">0</span><span class="op" id="6253373">,</span>&nbsp;<span class="num" id="6253375">1</span><span class="op" id="6253376">&lt;&lt;</span><span class="num" id="6253378">63</span><span class="op" id="6253380">-</span><span class="num" id="6253381">1</span><span class="op" id="6253382">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6253385">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;ELF&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253420">var</span>&nbsp;<span class="ident" id="6253424">ident</span>&nbsp;<span class="op" id="6253430">[</span><span class="num" id="6253431">16</span><span class="op" id="6253433">]</span><span class="builtintype" id="6253434">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253441">if</span>&nbsp;<span class="ident" id="6253444">_</span><span class="op" id="6253445">,</span>&nbsp;<span class="ident" id="6253447">err</span>&nbsp;<span class="op" id="6253451">:=</span>&nbsp;<span class="ident" id="6253454">r</span><span class="op" id="6253455">.</span><span class="ident" id="6253456">ReadAt</span><span class="op" id="6253462">(</span><span class="ident" id="6253463">ident</span><span class="op" id="6253468">[</span><span class="num" id="6253469">0</span><span class="op" id="6253470">:</span><span class="op" id="6253471">]</span><span class="op" id="6253472">,</span>&nbsp;<span class="num" id="6253474">0</span><span class="op" id="6253475">)</span><span class="op" id="6253476">;</span>&nbsp;<span class="ident" id="6253478">err</span>&nbsp;<span class="op" id="6253482">!=</span>&nbsp;<span class="builtintype" id="6253485">nil</span>&nbsp;<span class="op" id="6253489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253493">return</span>&nbsp;<span class="builtintype" id="6253500">nil</span><span class="op" id="6253503">,</span>&nbsp;<span class="ident" id="6253505">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6253510">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253513">if</span>&nbsp;<span class="ident" id="6253516">ident</span><span class="op" id="6253521">[</span><span class="num" id="6253522">0</span><span class="op" id="6253523">]</span>&nbsp;<span class="op" id="6253525">!=</span>&nbsp;<span class="string" id="6253528">&#39;\x7f&#39;</span>&nbsp;<span class="op" id="6253535">||</span>&nbsp;<span class="ident" id="6253538">ident</span><span class="op" id="6253543">[</span><span class="num" id="6253544">1</span><span class="op" id="6253545">]</span>&nbsp;<span class="op" id="6253547">!=</span>&nbsp;<span class="string" id="6253550">&#39;E&#39;</span>&nbsp;<span class="op" id="6253554">||</span>&nbsp;<span class="ident" id="6253557">ident</span><span class="op" id="6253562">[</span><span class="num" id="6253563">2</span><span class="op" id="6253564">]</span>&nbsp;<span class="op" id="6253566">!=</span>&nbsp;<span class="string" id="6253569">&#39;L&#39;</span>&nbsp;<span class="op" id="6253573">||</span>&nbsp;<span class="ident" id="6253576">ident</span><span class="op" id="6253581">[</span><span class="num" id="6253582">3</span><span class="op" id="6253583">]</span>&nbsp;<span class="op" id="6253585">!=</span>&nbsp;<span class="string" id="6253588">&#39;F&#39;</span>&nbsp;<span class="op" id="6253592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253596">return</span>&nbsp;<span class="builtintype" id="6253603">nil</span><span class="op" id="6253606">,</span>&nbsp;<span class="op" id="6253608">&amp;</span><span class="ident" id="6253609">FormatError</span><span class="op" id="6253620">{</span><span class="num" id="6253621">0</span><span class="op" id="6253622">,</span>&nbsp;<span class="string" id="6253624">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="6253642">,</span>&nbsp;<span class="ident" id="6253644">ident</span><span class="op" id="6253649">[</span><span class="num" id="6253650">0</span><span class="op" id="6253651">:</span><span class="num" id="6253652">4</span><span class="op" id="6253653">]</span><span class="op" id="6253654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6253657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6253661">f</span>&nbsp;<span class="op" id="6253663">:=</span>&nbsp;<span class="builtinfunc" id="6253666">new</span><span class="op" id="6253669">(</span><span class="ident" id="6253670">File</span><span class="op" id="6253674">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6253677">f</span><span class="op" id="6253678">.</span><span class="ident" id="6253679">Class</span>&nbsp;<span class="op" id="6253685">=</span>&nbsp;<span class="ident" id="6253687">Class</span><span class="op" id="6253692">(</span><span class="ident" id="6253693">ident</span><span class="op" id="6253698">[</span><span class="ident" id="6253699">EI_CLASS</span><span class="op" id="6253707">]</span><span class="op" id="6253708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253711">switch</span>&nbsp;<span class="ident" id="6253718">f</span><span class="op" id="6253719">.</span><span class="ident" id="6253720">Class</span>&nbsp;<span class="op" id="6253726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253729">case</span>&nbsp;<span class="ident" id="6253734">ELFCLASS32</span><span class="op" id="6253744">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253747">case</span>&nbsp;<span class="ident" id="6253752">ELFCLASS64</span><span class="op" id="6253762">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6253766">//&nbsp;ok</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253773">default</span><span class="op" id="6253780">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253784">return</span>&nbsp;<span class="builtintype" id="6253791">nil</span><span class="op" id="6253794">,</span>&nbsp;<span class="op" id="6253796">&amp;</span><span class="ident" id="6253797">FormatError</span><span class="op" id="6253808">{</span><span class="num" id="6253809">0</span><span class="op" id="6253810">,</span>&nbsp;<span class="string" id="6253812">&#34;unknown&nbsp;ELF&nbsp;class&#34;</span><span class="op" id="6253831">,</span>&nbsp;<span class="ident" id="6253833">f</span><span class="op" id="6253834">.</span><span class="ident" id="6253835">Class</span><span class="op" id="6253840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6253843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6253847">f</span><span class="op" id="6253848">.</span><span class="ident" id="6253849">Data</span>&nbsp;<span class="op" id="6253854">=</span>&nbsp;<span class="ident" id="6253856">Data</span><span class="op" id="6253860">(</span><span class="ident" id="6253861">ident</span><span class="op" id="6253866">[</span><span class="ident" id="6253867">EI_DATA</span><span class="op" id="6253874">]</span><span class="op" id="6253875">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253878">switch</span>&nbsp;<span class="ident" id="6253885">f</span><span class="op" id="6253886">.</span><span class="ident" id="6253887">Data</span>&nbsp;<span class="op" id="6253892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253895">case</span>&nbsp;<span class="ident" id="6253900">ELFDATA2LSB</span><span class="op" id="6253911">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6253915">f</span><span class="op" id="6253916">.</span><span class="ident" id="6253917">ByteOrder</span>&nbsp;<span class="op" id="6253927">=</span>&nbsp;<span class="ident" id="6253929">binary</span><span class="op" id="6253935">.</span><span class="ident" id="6253936">LittleEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6253950">case</span>&nbsp;<span class="ident" id="6253955">ELFDATA2MSB</span><span class="op" id="6253966">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6253970">f</span><span class="op" id="6253971">.</span><span class="ident" id="6253972">ByteOrder</span>&nbsp;<span class="op" id="6253982">=</span>&nbsp;<span class="ident" id="6253984">binary</span><span class="op" id="6253990">.</span><span class="ident" id="6253991">BigEndian</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6254002">default</span><span class="op" id="6254009">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6254013">return</span>&nbsp;<span class="builtintype" id="6254020">nil</span><span class="op" id="6254023">,</span>&nbsp;<span class="op" id="6254025">&amp;</span><span class="ident" id="6254026">FormatError</span><span class="op" id="6254037">{</span><span class="num" id="6254038">0</span><span class="op" id="6254039">,</span>&nbsp;<span class="string" id="6254041">&#34;unknown&nbsp;ELF&nbsp;data&nbsp;encoding&#34;</span><span class="op" id="6254068">,</span>&nbsp;<span class="ident" id="6254070">f</span><span class="op" id="6254071">.</span><span class="ident" id="6254072">Data</span><span class="op" id="6254076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6254079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254083">f</span><span class="op" id="6254084">.</span><span class="ident" id="6254085">Version</span>&nbsp;<span class="op" id="6254093">=</span>&nbsp;<span class="ident" id="6254095">Version</span><span class="op" id="6254102">(</span><span class="ident" id="6254103">ident</span><span class="op" id="6254108">[</span><span class="ident" id="6254109">EI_VERSION</span><span class="op" id="6254119">]</span><span class="op" id="6254120">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6254123">if</span>&nbsp;<span class="ident" id="6254126">f</span><span class="op" id="6254127">.</span><span class="ident" id="6254128">Version</span>&nbsp;<span class="op" id="6254136">!=</span>&nbsp;<span class="ident" id="6254139">EV_CURRENT</span>&nbsp;<span class="op" id="6254150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6254154">return</span>&nbsp;<span class="builtintype" id="6254161">nil</span><span class="op" id="6254164">,</span>&nbsp;<span class="op" id="6254166">&amp;</span><span class="ident" id="6254167">FormatError</span><span class="op" id="6254178">{</span><span class="num" id="6254179">0</span><span class="op" id="6254180">,</span>&nbsp;<span class="string" id="6254182">&#34;unknown&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="6254203">,</span>&nbsp;<span class="ident" id="6254205">f</span><span class="op" id="6254206">.</span><span class="ident" id="6254207">Version</span><span class="op" id="6254214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6254217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254221">f</span><span class="op" id="6254222">.</span><span class="ident" id="6254223">OSABI</span>&nbsp;<span class="op" id="6254229">=</span>&nbsp;<span class="ident" id="6254231">OSABI</span><span class="op" id="6254236">(</span><span class="ident" id="6254237">ident</span><span class="op" id="6254242">[</span><span class="ident" id="6254243">EI_OSABI</span><span class="op" id="6254251">]</span><span class="op" id="6254252">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254255">f</span><span class="op" id="6254256">.</span><span class="ident" id="6254257">ABIVersion</span>&nbsp;<span class="op" id="6254268">=</span>&nbsp;<span class="ident" id="6254270">ident</span><span class="op" id="6254275">[</span><span class="ident" id="6254276">EI_ABIVERSION</span><span class="op" id="6254289">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6254293">//&nbsp;Read&nbsp;ELF&nbsp;file&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6254318">var</span>&nbsp;<span class="ident" id="6254322">phoff</span>&nbsp;<span class="ident" id="6254328">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6254335">var</span>&nbsp;<span class="ident" id="6254339">phentsize</span><span class="op" id="6254348">,</span>&nbsp;<span class="ident" id="6254350">phnum</span>&nbsp;<span class="builtintype" id="6254356">int</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6254361">var</span>&nbsp;<span class="ident" id="6254365">shoff</span>&nbsp;<span class="ident" id="6254371">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6254378">var</span>&nbsp;<span class="ident" id="6254382">shentsize</span><span class="op" id="6254391">,</span>&nbsp;<span class="ident" id="6254393">shnum</span><span class="op" id="6254398">,</span>&nbsp;<span class="ident" id="6254400">shstrndx</span>&nbsp;<span class="builtintype" id="6254409">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254414">shstrndx</span>&nbsp;<span class="op" id="6254423">=</span>&nbsp;<span class="op" id="6254425">-</span><span class="num" id="6254426">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6254429">switch</span>&nbsp;<span class="ident" id="6254436">f</span><span class="op" id="6254437">.</span><span class="ident" id="6254438">Class</span>&nbsp;<span class="op" id="6254444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6254447">case</span>&nbsp;<span class="ident" id="6254452">ELFCLASS32</span><span class="op" id="6254462">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254466">hdr</span>&nbsp;<span class="op" id="6254470">:=</span>&nbsp;<span class="builtinfunc" id="6254473">new</span><span class="op" id="6254476">(</span><span class="ident" id="6254477">Header32</span><span class="op" id="6254485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254489">sr</span><span class="op" id="6254491">.</span><span class="ident" id="6254492">Seek</span><span class="op" id="6254496">(</span><span class="num" id="6254497">0</span><span class="op" id="6254498">,</span>&nbsp;<span class="ident" id="6254500">os</span><span class="op" id="6254502">.</span><span class="ident" id="6254503">SEEK_SET</span><span class="op" id="6254511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6254515">if</span>&nbsp;<span class="ident" id="6254518">err</span>&nbsp;<span class="op" id="6254522">:=</span>&nbsp;<span class="ident" id="6254525">binary</span><span class="op" id="6254531">.</span><span class="ident" id="6254532">Read</span><span class="op" id="6254536">(</span><span class="ident" id="6254537">sr</span><span class="op" id="6254539">,</span>&nbsp;<span class="ident" id="6254541">f</span><span class="op" id="6254542">.</span><span class="ident" id="6254543">ByteOrder</span><span class="op" id="6254552">,</span>&nbsp;<span class="ident" id="6254554">hdr</span><span class="op" id="6254557">)</span><span class="op" id="6254558">;</span>&nbsp;<span class="ident" id="6254560">err</span>&nbsp;<span class="op" id="6254564">!=</span>&nbsp;<span class="builtintype" id="6254567">nil</span>&nbsp;<span class="op" id="6254571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6254576">return</span>&nbsp;<span class="builtintype" id="6254583">nil</span><span class="op" id="6254586">,</span>&nbsp;<span class="ident" id="6254588">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6254594">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254598">f</span><span class="op" id="6254599">.</span><span class="ident" id="6254600">Type</span>&nbsp;<span class="op" id="6254605">=</span>&nbsp;<span class="ident" id="6254607">Type</span><span class="op" id="6254611">(</span><span class="ident" id="6254612">hdr</span><span class="op" id="6254615">.</span><span class="ident" id="6254616">Type</span><span class="op" id="6254620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254624">f</span><span class="op" id="6254625">.</span><span class="ident" id="6254626">Machine</span>&nbsp;<span class="op" id="6254634">=</span>&nbsp;<span class="ident" id="6254636">Machine</span><span class="op" id="6254643">(</span><span class="ident" id="6254644">hdr</span><span class="op" id="6254647">.</span><span class="ident" id="6254648">Machine</span><span class="op" id="6254655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254659">f</span><span class="op" id="6254660">.</span><span class="ident" id="6254661">Entry</span>&nbsp;<span class="op" id="6254667">=</span>&nbsp;<span class="ident" id="6254669">uint64</span><span class="op" id="6254675">(</span><span class="ident" id="6254676">hdr</span><span class="op" id="6254679">.</span><span class="ident" id="6254680">Entry</span><span class="op" id="6254685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6254689">if</span>&nbsp;<span class="ident" id="6254692">v</span>&nbsp;<span class="op" id="6254694">:=</span>&nbsp;<span class="ident" id="6254697">Version</span><span class="op" id="6254704">(</span><span class="ident" id="6254705">hdr</span><span class="op" id="6254708">.</span><span class="ident" id="6254709">Version</span><span class="op" id="6254716">)</span><span class="op" id="6254717">;</span>&nbsp;<span class="ident" id="6254719">v</span>&nbsp;<span class="op" id="6254721">!=</span>&nbsp;<span class="ident" id="6254724">f</span><span class="op" id="6254725">.</span><span class="ident" id="6254726">Version</span>&nbsp;<span class="op" id="6254734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6254739">return</span>&nbsp;<span class="builtintype" id="6254746">nil</span><span class="op" id="6254749">,</span>&nbsp;<span class="op" id="6254751">&amp;</span><span class="ident" id="6254752">FormatError</span><span class="op" id="6254763">{</span><span class="num" id="6254764">0</span><span class="op" id="6254765">,</span>&nbsp;<span class="string" id="6254767">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="6254791">,</span>&nbsp;<span class="ident" id="6254793">v</span><span class="op" id="6254794">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6254798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254802">phoff</span>&nbsp;<span class="op" id="6254808">=</span>&nbsp;<span class="ident" id="6254810">int64</span><span class="op" id="6254815">(</span><span class="ident" id="6254816">hdr</span><span class="op" id="6254819">.</span><span class="ident" id="6254820">Phoff</span><span class="op" id="6254825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254829">phentsize</span>&nbsp;<span class="op" id="6254839">=</span>&nbsp;<span class="builtintype" id="6254841">int</span><span class="op" id="6254844">(</span><span class="ident" id="6254845">hdr</span><span class="op" id="6254848">.</span><span class="ident" id="6254849">Phentsize</span><span class="op" id="6254858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254862">phnum</span>&nbsp;<span class="op" id="6254868">=</span>&nbsp;<span class="builtintype" id="6254870">int</span><span class="op" id="6254873">(</span><span class="ident" id="6254874">hdr</span><span class="op" id="6254877">.</span><span class="ident" id="6254878">Phnum</span><span class="op" id="6254883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254887">shoff</span>&nbsp;<span class="op" id="6254893">=</span>&nbsp;<span class="ident" id="6254895">int64</span><span class="op" id="6254900">(</span><span class="ident" id="6254901">hdr</span><span class="op" id="6254904">.</span><span class="ident" id="6254905">Shoff</span><span class="op" id="6254910">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254914">shentsize</span>&nbsp;<span class="op" id="6254924">=</span>&nbsp;<span class="builtintype" id="6254926">int</span><span class="op" id="6254929">(</span><span class="ident" id="6254930">hdr</span><span class="op" id="6254933">.</span><span class="ident" id="6254934">Shentsize</span><span class="op" id="6254943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254947">shnum</span>&nbsp;<span class="op" id="6254953">=</span>&nbsp;<span class="builtintype" id="6254955">int</span><span class="op" id="6254958">(</span><span class="ident" id="6254959">hdr</span><span class="op" id="6254962">.</span><span class="ident" id="6254963">Shnum</span><span class="op" id="6254968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254972">shstrndx</span>&nbsp;<span class="op" id="6254981">=</span>&nbsp;<span class="builtintype" id="6254983">int</span><span class="op" id="6254986">(</span><span class="ident" id="6254987">hdr</span><span class="op" id="6254990">.</span><span class="ident" id="6254991">Shstrndx</span><span class="op" id="6254999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6255002">case</span>&nbsp;<span class="ident" id="6255007">ELFCLASS64</span><span class="op" id="6255017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255021">hdr</span>&nbsp;<span class="op" id="6255025">:=</span>&nbsp;<span class="builtinfunc" id="6255028">new</span><span class="op" id="6255031">(</span><span class="ident" id="6255032">Header64</span><span class="op" id="6255040">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255044">sr</span><span class="op" id="6255046">.</span><span class="ident" id="6255047">Seek</span><span class="op" id="6255051">(</span><span class="num" id="6255052">0</span><span class="op" id="6255053">,</span>&nbsp;<span class="ident" id="6255055">os</span><span class="op" id="6255057">.</span><span class="ident" id="6255058">SEEK_SET</span><span class="op" id="6255066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6255070">if</span>&nbsp;<span class="ident" id="6255073">err</span>&nbsp;<span class="op" id="6255077">:=</span>&nbsp;<span class="ident" id="6255080">binary</span><span class="op" id="6255086">.</span><span class="ident" id="6255087">Read</span><span class="op" id="6255091">(</span><span class="ident" id="6255092">sr</span><span class="op" id="6255094">,</span>&nbsp;<span class="ident" id="6255096">f</span><span class="op" id="6255097">.</span><span class="ident" id="6255098">ByteOrder</span><span class="op" id="6255107">,</span>&nbsp;<span class="ident" id="6255109">hdr</span><span class="op" id="6255112">)</span><span class="op" id="6255113">;</span>&nbsp;<span class="ident" id="6255115">err</span>&nbsp;<span class="op" id="6255119">!=</span>&nbsp;<span class="builtintype" id="6255122">nil</span>&nbsp;<span class="op" id="6255126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6255131">return</span>&nbsp;<span class="builtintype" id="6255138">nil</span><span class="op" id="6255141">,</span>&nbsp;<span class="ident" id="6255143">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6255149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255153">f</span><span class="op" id="6255154">.</span><span class="ident" id="6255155">Type</span>&nbsp;<span class="op" id="6255160">=</span>&nbsp;<span class="ident" id="6255162">Type</span><span class="op" id="6255166">(</span><span class="ident" id="6255167">hdr</span><span class="op" id="6255170">.</span><span class="ident" id="6255171">Type</span><span class="op" id="6255175">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255179">f</span><span class="op" id="6255180">.</span><span class="ident" id="6255181">Machine</span>&nbsp;<span class="op" id="6255189">=</span>&nbsp;<span class="ident" id="6255191">Machine</span><span class="op" id="6255198">(</span><span class="ident" id="6255199">hdr</span><span class="op" id="6255202">.</span><span class="ident" id="6255203">Machine</span><span class="op" id="6255210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255214">f</span><span class="op" id="6255215">.</span><span class="ident" id="6255216">Entry</span>&nbsp;<span class="op" id="6255222">=</span>&nbsp;<span class="ident" id="6255224">uint64</span><span class="op" id="6255230">(</span><span class="ident" id="6255231">hdr</span><span class="op" id="6255234">.</span><span class="ident" id="6255235">Entry</span><span class="op" id="6255240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6255244">if</span>&nbsp;<span class="ident" id="6255247">v</span>&nbsp;<span class="op" id="6255249">:=</span>&nbsp;<span class="ident" id="6255252">Version</span><span class="op" id="6255259">(</span><span class="ident" id="6255260">hdr</span><span class="op" id="6255263">.</span><span class="ident" id="6255264">Version</span><span class="op" id="6255271">)</span><span class="op" id="6255272">;</span>&nbsp;<span class="ident" id="6255274">v</span>&nbsp;<span class="op" id="6255276">!=</span>&nbsp;<span class="ident" id="6255279">f</span><span class="op" id="6255280">.</span><span class="ident" id="6255281">Version</span>&nbsp;<span class="op" id="6255289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6255294">return</span>&nbsp;<span class="builtintype" id="6255301">nil</span><span class="op" id="6255304">,</span>&nbsp;<span class="op" id="6255306">&amp;</span><span class="ident" id="6255307">FormatError</span><span class="op" id="6255318">{</span><span class="num" id="6255319">0</span><span class="op" id="6255320">,</span>&nbsp;<span class="string" id="6255322">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="6255346">,</span>&nbsp;<span class="ident" id="6255348">v</span><span class="op" id="6255349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6255353">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255357">phoff</span>&nbsp;<span class="op" id="6255363">=</span>&nbsp;<span class="ident" id="6255365">int64</span><span class="op" id="6255370">(</span><span class="ident" id="6255371">hdr</span><span class="op" id="6255374">.</span><span class="ident" id="6255375">Phoff</span><span class="op" id="6255380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255384">phentsize</span>&nbsp;<span class="op" id="6255394">=</span>&nbsp;<span class="builtintype" id="6255396">int</span><span class="op" id="6255399">(</span><span class="ident" id="6255400">hdr</span><span class="op" id="6255403">.</span><span class="ident" id="6255404">Phentsize</span><span class="op" id="6255413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255417">phnum</span>&nbsp;<span class="op" id="6255423">=</span>&nbsp;<span class="builtintype" id="6255425">int</span><span class="op" id="6255428">(</span><span class="ident" id="6255429">hdr</span><span class="op" id="6255432">.</span><span class="ident" id="6255433">Phnum</span><span class="op" id="6255438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255442">shoff</span>&nbsp;<span class="op" id="6255448">=</span>&nbsp;<span class="ident" id="6255450">int64</span><span class="op" id="6255455">(</span><span class="ident" id="6255456">hdr</span><span class="op" id="6255459">.</span><span class="ident" id="6255460">Shoff</span><span class="op" id="6255465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255469">shentsize</span>&nbsp;<span class="op" id="6255479">=</span>&nbsp;<span class="builtintype" id="6255481">int</span><span class="op" id="6255484">(</span><span class="ident" id="6255485">hdr</span><span class="op" id="6255488">.</span><span class="ident" id="6255489">Shentsize</span><span class="op" id="6255498">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255502">shnum</span>&nbsp;<span class="op" id="6255508">=</span>&nbsp;<span class="builtintype" id="6255510">int</span><span class="op" id="6255513">(</span><span class="ident" id="6255514">hdr</span><span class="op" id="6255517">.</span><span class="ident" id="6255518">Shnum</span><span class="op" id="6255523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255527">shstrndx</span>&nbsp;<span class="op" id="6255536">=</span>&nbsp;<span class="builtintype" id="6255538">int</span><span class="op" id="6255541">(</span><span class="ident" id="6255542">hdr</span><span class="op" id="6255545">.</span><span class="ident" id="6255546">Shstrndx</span><span class="op" id="6255554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6255557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6255561">if</span>&nbsp;<span class="ident" id="6255564">shnum</span>&nbsp;<span class="op" id="6255570">&gt;</span>&nbsp;<span class="num" id="6255572">0</span>&nbsp;<span class="op" id="6255574">&amp;&amp;</span>&nbsp;<span class="ident" id="6255577">shoff</span>&nbsp;<span class="op" id="6255583">&gt;</span>&nbsp;<span class="num" id="6255585">0</span>&nbsp;<span class="op" id="6255587">&amp;&amp;</span>&nbsp;<span class="op" id="6255590">(</span><span class="ident" id="6255591">shstrndx</span>&nbsp;<span class="op" id="6255600">&lt;</span>&nbsp;<span class="num" id="6255602">0</span>&nbsp;<span class="op" id="6255604">||</span>&nbsp;<span class="ident" id="6255607">shstrndx</span>&nbsp;<span class="op" id="6255616">&gt;=</span>&nbsp;<span class="ident" id="6255619">shnum</span><span class="op" id="6255624">)</span>&nbsp;<span class="op" id="6255626">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6255630">return</span>&nbsp;<span class="builtintype" id="6255637">nil</span><span class="op" id="6255640">,</span>&nbsp;<span class="op" id="6255642">&amp;</span><span class="ident" id="6255643">FormatError</span><span class="op" id="6255654">{</span><span class="num" id="6255655">0</span><span class="op" id="6255656">,</span>&nbsp;<span class="string" id="6255658">&#34;invalid&nbsp;ELF&nbsp;shstrndx&#34;</span><span class="op" id="6255680">,</span>&nbsp;<span class="ident" id="6255682">shstrndx</span><span class="op" id="6255690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6255693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6255697">//&nbsp;Read&nbsp;program&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255722">f</span><span class="op" id="6255723">.</span><span class="ident" id="6255724">Progs</span>&nbsp;<span class="op" id="6255730">=</span>&nbsp;<span class="builtinfunc" id="6255732">make</span><span class="op" id="6255736">(</span><span class="op" id="6255737">[</span><span class="op" id="6255738">]</span><span class="op" id="6255739">*</span><span class="ident" id="6255740">Prog</span><span class="op" id="6255744">,</span>&nbsp;<span class="ident" id="6255746">phnum</span><span class="op" id="6255751">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6255754">for</span>&nbsp;<span class="ident" id="6255758">i</span>&nbsp;<span class="op" id="6255760">:=</span>&nbsp;<span class="num" id="6255763">0</span><span class="op" id="6255764">;</span>&nbsp;<span class="ident" id="6255766">i</span>&nbsp;<span class="op" id="6255768">&lt;</span>&nbsp;<span class="ident" id="6255770">phnum</span><span class="op" id="6255775">;</span>&nbsp;<span class="ident" id="6255777">i</span><span class="op" id="6255778">++</span>&nbsp;<span class="op" id="6255781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255785">off</span>&nbsp;<span class="op" id="6255789">:=</span>&nbsp;<span class="ident" id="6255792">phoff</span>&nbsp;<span class="op" id="6255798">+</span>&nbsp;<span class="ident" id="6255800">int64</span><span class="op" id="6255805">(</span><span class="ident" id="6255806">i</span><span class="op" id="6255807">)</span><span class="op" id="6255808">*</span><span class="ident" id="6255809">int64</span><span class="op" id="6255814">(</span><span class="ident" id="6255815">phentsize</span><span class="op" id="6255824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255828">sr</span><span class="op" id="6255830">.</span><span class="ident" id="6255831">Seek</span><span class="op" id="6255835">(</span><span class="ident" id="6255836">off</span><span class="op" id="6255839">,</span>&nbsp;<span class="ident" id="6255841">os</span><span class="op" id="6255843">.</span><span class="ident" id="6255844">SEEK_SET</span><span class="op" id="6255852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255856">p</span>&nbsp;<span class="op" id="6255858">:=</span>&nbsp;<span class="builtinfunc" id="6255861">new</span><span class="op" id="6255864">(</span><span class="ident" id="6255865">Prog</span><span class="op" id="6255869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6255873">switch</span>&nbsp;<span class="ident" id="6255880">f</span><span class="op" id="6255881">.</span><span class="ident" id="6255882">Class</span>&nbsp;<span class="op" id="6255888">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6255892">case</span>&nbsp;<span class="ident" id="6255897">ELFCLASS32</span><span class="op" id="6255907">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255912">ph</span>&nbsp;<span class="op" id="6255915">:=</span>&nbsp;<span class="builtinfunc" id="6255918">new</span><span class="op" id="6255921">(</span><span class="ident" id="6255922">Prog32</span><span class="op" id="6255928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6255933">if</span>&nbsp;<span class="ident" id="6255936">err</span>&nbsp;<span class="op" id="6255940">:=</span>&nbsp;<span class="ident" id="6255943">binary</span><span class="op" id="6255949">.</span><span class="ident" id="6255950">Read</span><span class="op" id="6255954">(</span><span class="ident" id="6255955">sr</span><span class="op" id="6255957">,</span>&nbsp;<span class="ident" id="6255959">f</span><span class="op" id="6255960">.</span><span class="ident" id="6255961">ByteOrder</span><span class="op" id="6255970">,</span>&nbsp;<span class="ident" id="6255972">ph</span><span class="op" id="6255974">)</span><span class="op" id="6255975">;</span>&nbsp;<span class="ident" id="6255977">err</span>&nbsp;<span class="op" id="6255981">!=</span>&nbsp;<span class="builtintype" id="6255984">nil</span>&nbsp;<span class="op" id="6255988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6255994">return</span>&nbsp;<span class="builtintype" id="6256001">nil</span><span class="op" id="6256004">,</span>&nbsp;<span class="ident" id="6256006">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6256013">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256018">p</span><span class="op" id="6256019">.</span><span class="ident" id="6256020">ProgHeader</span>&nbsp;<span class="op" id="6256031">=</span>&nbsp;<span class="ident" id="6256033">ProgHeader</span><span class="op" id="6256043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256049">Type</span><span class="op" id="6256053">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6256057">ProgType</span><span class="op" id="6256065">(</span><span class="ident" id="6256066">ph</span><span class="op" id="6256068">.</span><span class="ident" id="6256069">Type</span><span class="op" id="6256073">)</span><span class="op" id="6256074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256080">Flags</span><span class="op" id="6256085">:</span>&nbsp;&nbsp;<span class="ident" id="6256088">ProgFlag</span><span class="op" id="6256096">(</span><span class="ident" id="6256097">ph</span><span class="op" id="6256099">.</span><span class="ident" id="6256100">Flags</span><span class="op" id="6256105">)</span><span class="op" id="6256106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256112">Off</span><span class="op" id="6256115">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256120">uint64</span><span class="op" id="6256126">(</span><span class="ident" id="6256127">ph</span><span class="op" id="6256129">.</span><span class="ident" id="6256130">Off</span><span class="op" id="6256133">)</span><span class="op" id="6256134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256140">Vaddr</span><span class="op" id="6256145">:</span>&nbsp;&nbsp;<span class="ident" id="6256148">uint64</span><span class="op" id="6256154">(</span><span class="ident" id="6256155">ph</span><span class="op" id="6256157">.</span><span class="ident" id="6256158">Vaddr</span><span class="op" id="6256163">)</span><span class="op" id="6256164">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256170">Paddr</span><span class="op" id="6256175">:</span>&nbsp;&nbsp;<span class="ident" id="6256178">uint64</span><span class="op" id="6256184">(</span><span class="ident" id="6256185">ph</span><span class="op" id="6256187">.</span><span class="ident" id="6256188">Paddr</span><span class="op" id="6256193">)</span><span class="op" id="6256194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256200">Filesz</span><span class="op" id="6256206">:</span>&nbsp;<span class="ident" id="6256208">uint64</span><span class="op" id="6256214">(</span><span class="ident" id="6256215">ph</span><span class="op" id="6256217">.</span><span class="ident" id="6256218">Filesz</span><span class="op" id="6256224">)</span><span class="op" id="6256225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256231">Memsz</span><span class="op" id="6256236">:</span>&nbsp;&nbsp;<span class="ident" id="6256239">uint64</span><span class="op" id="6256245">(</span><span class="ident" id="6256246">ph</span><span class="op" id="6256248">.</span><span class="ident" id="6256249">Memsz</span><span class="op" id="6256254">)</span><span class="op" id="6256255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256261">Align</span><span class="op" id="6256266">:</span>&nbsp;&nbsp;<span class="ident" id="6256269">uint64</span><span class="op" id="6256275">(</span><span class="ident" id="6256276">ph</span><span class="op" id="6256278">.</span><span class="ident" id="6256279">Align</span><span class="op" id="6256284">)</span><span class="op" id="6256285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6256290">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6256294">case</span>&nbsp;<span class="ident" id="6256299">ELFCLASS64</span><span class="op" id="6256309">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256314">ph</span>&nbsp;<span class="op" id="6256317">:=</span>&nbsp;<span class="builtinfunc" id="6256320">new</span><span class="op" id="6256323">(</span><span class="ident" id="6256324">Prog64</span><span class="op" id="6256330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6256335">if</span>&nbsp;<span class="ident" id="6256338">err</span>&nbsp;<span class="op" id="6256342">:=</span>&nbsp;<span class="ident" id="6256345">binary</span><span class="op" id="6256351">.</span><span class="ident" id="6256352">Read</span><span class="op" id="6256356">(</span><span class="ident" id="6256357">sr</span><span class="op" id="6256359">,</span>&nbsp;<span class="ident" id="6256361">f</span><span class="op" id="6256362">.</span><span class="ident" id="6256363">ByteOrder</span><span class="op" id="6256372">,</span>&nbsp;<span class="ident" id="6256374">ph</span><span class="op" id="6256376">)</span><span class="op" id="6256377">;</span>&nbsp;<span class="ident" id="6256379">err</span>&nbsp;<span class="op" id="6256383">!=</span>&nbsp;<span class="builtintype" id="6256386">nil</span>&nbsp;<span class="op" id="6256390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6256396">return</span>&nbsp;<span class="builtintype" id="6256403">nil</span><span class="op" id="6256406">,</span>&nbsp;<span class="ident" id="6256408">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6256415">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256420">p</span><span class="op" id="6256421">.</span><span class="ident" id="6256422">ProgHeader</span>&nbsp;<span class="op" id="6256433">=</span>&nbsp;<span class="ident" id="6256435">ProgHeader</span><span class="op" id="6256445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256451">Type</span><span class="op" id="6256455">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6256459">ProgType</span><span class="op" id="6256467">(</span><span class="ident" id="6256468">ph</span><span class="op" id="6256470">.</span><span class="ident" id="6256471">Type</span><span class="op" id="6256475">)</span><span class="op" id="6256476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256482">Flags</span><span class="op" id="6256487">:</span>&nbsp;&nbsp;<span class="ident" id="6256490">ProgFlag</span><span class="op" id="6256498">(</span><span class="ident" id="6256499">ph</span><span class="op" id="6256501">.</span><span class="ident" id="6256502">Flags</span><span class="op" id="6256507">)</span><span class="op" id="6256508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256514">Off</span><span class="op" id="6256517">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256522">uint64</span><span class="op" id="6256528">(</span><span class="ident" id="6256529">ph</span><span class="op" id="6256531">.</span><span class="ident" id="6256532">Off</span><span class="op" id="6256535">)</span><span class="op" id="6256536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256542">Vaddr</span><span class="op" id="6256547">:</span>&nbsp;&nbsp;<span class="ident" id="6256550">uint64</span><span class="op" id="6256556">(</span><span class="ident" id="6256557">ph</span><span class="op" id="6256559">.</span><span class="ident" id="6256560">Vaddr</span><span class="op" id="6256565">)</span><span class="op" id="6256566">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256572">Paddr</span><span class="op" id="6256577">:</span>&nbsp;&nbsp;<span class="ident" id="6256580">uint64</span><span class="op" id="6256586">(</span><span class="ident" id="6256587">ph</span><span class="op" id="6256589">.</span><span class="ident" id="6256590">Paddr</span><span class="op" id="6256595">)</span><span class="op" id="6256596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256602">Filesz</span><span class="op" id="6256608">:</span>&nbsp;<span class="ident" id="6256610">uint64</span><span class="op" id="6256616">(</span><span class="ident" id="6256617">ph</span><span class="op" id="6256619">.</span><span class="ident" id="6256620">Filesz</span><span class="op" id="6256626">)</span><span class="op" id="6256627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256633">Memsz</span><span class="op" id="6256638">:</span>&nbsp;&nbsp;<span class="ident" id="6256641">uint64</span><span class="op" id="6256647">(</span><span class="ident" id="6256648">ph</span><span class="op" id="6256650">.</span><span class="ident" id="6256651">Memsz</span><span class="op" id="6256656">)</span><span class="op" id="6256657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256663">Align</span><span class="op" id="6256668">:</span>&nbsp;&nbsp;<span class="ident" id="6256671">uint64</span><span class="op" id="6256677">(</span><span class="ident" id="6256678">ph</span><span class="op" id="6256680">.</span><span class="ident" id="6256681">Align</span><span class="op" id="6256686">)</span><span class="op" id="6256687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6256692">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6256696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256700">p</span><span class="op" id="6256701">.</span><span class="ident" id="6256702">sr</span>&nbsp;<span class="op" id="6256705">=</span>&nbsp;<span class="ident" id="6256707">io</span><span class="op" id="6256709">.</span><span class="ident" id="6256710">NewSectionReader</span><span class="op" id="6256726">(</span><span class="ident" id="6256727">r</span><span class="op" id="6256728">,</span>&nbsp;<span class="ident" id="6256730">int64</span><span class="op" id="6256735">(</span><span class="ident" id="6256736">p</span><span class="op" id="6256737">.</span><span class="ident" id="6256738">Off</span><span class="op" id="6256741">)</span><span class="op" id="6256742">,</span>&nbsp;<span class="ident" id="6256744">int64</span><span class="op" id="6256749">(</span><span class="ident" id="6256750">p</span><span class="op" id="6256751">.</span><span class="ident" id="6256752">Filesz</span><span class="op" id="6256758">)</span><span class="op" id="6256759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256763">p</span><span class="op" id="6256764">.</span><span class="ident" id="6256765">ReaderAt</span>&nbsp;<span class="op" id="6256774">=</span>&nbsp;<span class="ident" id="6256776">p</span><span class="op" id="6256777">.</span><span class="ident" id="6256778">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256783">f</span><span class="op" id="6256784">.</span><span class="ident" id="6256785">Progs</span><span class="op" id="6256790">[</span><span class="ident" id="6256791">i</span><span class="op" id="6256792">]</span>&nbsp;<span class="op" id="6256794">=</span>&nbsp;<span class="ident" id="6256796">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6256799">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256803">//&nbsp;Read&nbsp;section&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256828">f</span><span class="op" id="6256829">.</span><span class="ident" id="6256830">Sections</span>&nbsp;<span class="op" id="6256839">=</span>&nbsp;<span class="builtinfunc" id="6256841">make</span><span class="op" id="6256845">(</span><span class="op" id="6256846">[</span><span class="op" id="6256847">]</span><span class="op" id="6256848">*</span><span class="ident" id="6256849">Section</span><span class="op" id="6256856">,</span>&nbsp;<span class="ident" id="6256858">shnum</span><span class="op" id="6256863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256866">names</span>&nbsp;<span class="op" id="6256872">:=</span>&nbsp;<span class="builtinfunc" id="6256875">make</span><span class="op" id="6256879">(</span><span class="op" id="6256880">[</span><span class="op" id="6256881">]</span><span class="builtintype" id="6256882">uint32</span><span class="op" id="6256888">,</span>&nbsp;<span class="ident" id="6256890">shnum</span><span class="op" id="6256895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6256898">for</span>&nbsp;<span class="ident" id="6256902">i</span>&nbsp;<span class="op" id="6256904">:=</span>&nbsp;<span class="num" id="6256907">0</span><span class="op" id="6256908">;</span>&nbsp;<span class="ident" id="6256910">i</span>&nbsp;<span class="op" id="6256912">&lt;</span>&nbsp;<span class="ident" id="6256914">shnum</span><span class="op" id="6256919">;</span>&nbsp;<span class="ident" id="6256921">i</span><span class="op" id="6256922">++</span>&nbsp;<span class="op" id="6256925">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256929">off</span>&nbsp;<span class="op" id="6256933">:=</span>&nbsp;<span class="ident" id="6256936">shoff</span>&nbsp;<span class="op" id="6256942">+</span>&nbsp;<span class="ident" id="6256944">int64</span><span class="op" id="6256949">(</span><span class="ident" id="6256950">i</span><span class="op" id="6256951">)</span><span class="op" id="6256952">*</span><span class="ident" id="6256953">int64</span><span class="op" id="6256958">(</span><span class="ident" id="6256959">shentsize</span><span class="op" id="6256968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256972">sr</span><span class="op" id="6256974">.</span><span class="ident" id="6256975">Seek</span><span class="op" id="6256979">(</span><span class="ident" id="6256980">off</span><span class="op" id="6256983">,</span>&nbsp;<span class="ident" id="6256985">os</span><span class="op" id="6256987">.</span><span class="ident" id="6256988">SEEK_SET</span><span class="op" id="6256996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257000">s</span>&nbsp;<span class="op" id="6257002">:=</span>&nbsp;<span class="builtinfunc" id="6257005">new</span><span class="op" id="6257008">(</span><span class="ident" id="6257009">Section</span><span class="op" id="6257016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6257020">switch</span>&nbsp;<span class="ident" id="6257027">f</span><span class="op" id="6257028">.</span><span class="ident" id="6257029">Class</span>&nbsp;<span class="op" id="6257035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6257039">case</span>&nbsp;<span class="ident" id="6257044">ELFCLASS32</span><span class="op" id="6257054">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257059">sh</span>&nbsp;<span class="op" id="6257062">:=</span>&nbsp;<span class="builtinfunc" id="6257065">new</span><span class="op" id="6257068">(</span><span class="ident" id="6257069">Section32</span><span class="op" id="6257078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6257083">if</span>&nbsp;<span class="ident" id="6257086">err</span>&nbsp;<span class="op" id="6257090">:=</span>&nbsp;<span class="ident" id="6257093">binary</span><span class="op" id="6257099">.</span><span class="ident" id="6257100">Read</span><span class="op" id="6257104">(</span><span class="ident" id="6257105">sr</span><span class="op" id="6257107">,</span>&nbsp;<span class="ident" id="6257109">f</span><span class="op" id="6257110">.</span><span class="ident" id="6257111">ByteOrder</span><span class="op" id="6257120">,</span>&nbsp;<span class="ident" id="6257122">sh</span><span class="op" id="6257124">)</span><span class="op" id="6257125">;</span>&nbsp;<span class="ident" id="6257127">err</span>&nbsp;<span class="op" id="6257131">!=</span>&nbsp;<span class="builtintype" id="6257134">nil</span>&nbsp;<span class="op" id="6257138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6257144">return</span>&nbsp;<span class="builtintype" id="6257151">nil</span><span class="op" id="6257154">,</span>&nbsp;<span class="ident" id="6257156">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6257163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257168">names</span><span class="op" id="6257173">[</span><span class="ident" id="6257174">i</span><span class="op" id="6257175">]</span>&nbsp;<span class="op" id="6257177">=</span>&nbsp;<span class="ident" id="6257179">sh</span><span class="op" id="6257181">.</span><span class="ident" id="6257182">Name</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257190">s</span><span class="op" id="6257191">.</span><span class="ident" id="6257192">SectionHeader</span>&nbsp;<span class="op" id="6257206">=</span>&nbsp;<span class="ident" id="6257208">SectionHeader</span><span class="op" id="6257221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257227">Type</span><span class="op" id="6257231">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257238">SectionType</span><span class="op" id="6257249">(</span><span class="ident" id="6257250">sh</span><span class="op" id="6257252">.</span><span class="ident" id="6257253">Type</span><span class="op" id="6257257">)</span><span class="op" id="6257258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257264">Flags</span><span class="op" id="6257269">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257275">SectionFlag</span><span class="op" id="6257286">(</span><span class="ident" id="6257287">sh</span><span class="op" id="6257289">.</span><span class="ident" id="6257290">Flags</span><span class="op" id="6257295">)</span><span class="op" id="6257296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257302">Addr</span><span class="op" id="6257306">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257313">uint64</span><span class="op" id="6257319">(</span><span class="ident" id="6257320">sh</span><span class="op" id="6257322">.</span><span class="ident" id="6257323">Addr</span><span class="op" id="6257327">)</span><span class="op" id="6257328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257334">Offset</span><span class="op" id="6257340">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257345">uint64</span><span class="op" id="6257351">(</span><span class="ident" id="6257352">sh</span><span class="op" id="6257354">.</span><span class="ident" id="6257355">Off</span><span class="op" id="6257358">)</span><span class="op" id="6257359">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257365">Size</span><span class="op" id="6257369">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257376">uint64</span><span class="op" id="6257382">(</span><span class="ident" id="6257383">sh</span><span class="op" id="6257385">.</span><span class="ident" id="6257386">Size</span><span class="op" id="6257390">)</span><span class="op" id="6257391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257397">Link</span><span class="op" id="6257401">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6257408">uint32</span><span class="op" id="6257414">(</span><span class="ident" id="6257415">sh</span><span class="op" id="6257417">.</span><span class="ident" id="6257418">Link</span><span class="op" id="6257422">)</span><span class="op" id="6257423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257429">Info</span><span class="op" id="6257433">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6257440">uint32</span><span class="op" id="6257446">(</span><span class="ident" id="6257447">sh</span><span class="op" id="6257449">.</span><span class="ident" id="6257450">Info</span><span class="op" id="6257454">)</span><span class="op" id="6257455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257461">Addralign</span><span class="op" id="6257470">:</span>&nbsp;<span class="ident" id="6257472">uint64</span><span class="op" id="6257478">(</span><span class="ident" id="6257479">sh</span><span class="op" id="6257481">.</span><span class="ident" id="6257482">Addralign</span><span class="op" id="6257491">)</span><span class="op" id="6257492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257498">Entsize</span><span class="op" id="6257505">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6257509">uint64</span><span class="op" id="6257515">(</span><span class="ident" id="6257516">sh</span><span class="op" id="6257518">.</span><span class="ident" id="6257519">Entsize</span><span class="op" id="6257526">)</span><span class="op" id="6257527">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6257532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6257536">case</span>&nbsp;<span class="ident" id="6257541">ELFCLASS64</span><span class="op" id="6257551">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257556">sh</span>&nbsp;<span class="op" id="6257559">:=</span>&nbsp;<span class="builtinfunc" id="6257562">new</span><span class="op" id="6257565">(</span><span class="ident" id="6257566">Section64</span><span class="op" id="6257575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6257580">if</span>&nbsp;<span class="ident" id="6257583">err</span>&nbsp;<span class="op" id="6257587">:=</span>&nbsp;<span class="ident" id="6257590">binary</span><span class="op" id="6257596">.</span><span class="ident" id="6257597">Read</span><span class="op" id="6257601">(</span><span class="ident" id="6257602">sr</span><span class="op" id="6257604">,</span>&nbsp;<span class="ident" id="6257606">f</span><span class="op" id="6257607">.</span><span class="ident" id="6257608">ByteOrder</span><span class="op" id="6257617">,</span>&nbsp;<span class="ident" id="6257619">sh</span><span class="op" id="6257621">)</span><span class="op" id="6257622">;</span>&nbsp;<span class="ident" id="6257624">err</span>&nbsp;<span class="op" id="6257628">!=</span>&nbsp;<span class="builtintype" id="6257631">nil</span>&nbsp;<span class="op" id="6257635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6257641">return</span>&nbsp;<span class="builtintype" id="6257648">nil</span><span class="op" id="6257651">,</span>&nbsp;<span class="ident" id="6257653">err</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6257660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257665">names</span><span class="op" id="6257670">[</span><span class="ident" id="6257671">i</span><span class="op" id="6257672">]</span>&nbsp;<span class="op" id="6257674">=</span>&nbsp;<span class="ident" id="6257676">sh</span><span class="op" id="6257678">.</span><span class="ident" id="6257679">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257687">s</span><span class="op" id="6257688">.</span><span class="ident" id="6257689">SectionHeader</span>&nbsp;<span class="op" id="6257703">=</span>&nbsp;<span class="ident" id="6257705">SectionHeader</span><span class="op" id="6257718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257724">Type</span><span class="op" id="6257728">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257735">SectionType</span><span class="op" id="6257746">(</span><span class="ident" id="6257747">sh</span><span class="op" id="6257749">.</span><span class="ident" id="6257750">Type</span><span class="op" id="6257754">)</span><span class="op" id="6257755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257761">Flags</span><span class="op" id="6257766">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257772">SectionFlag</span><span class="op" id="6257783">(</span><span class="ident" id="6257784">sh</span><span class="op" id="6257786">.</span><span class="ident" id="6257787">Flags</span><span class="op" id="6257792">)</span><span class="op" id="6257793">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257799">Offset</span><span class="op" id="6257805">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257810">uint64</span><span class="op" id="6257816">(</span><span class="ident" id="6257817">sh</span><span class="op" id="6257819">.</span><span class="ident" id="6257820">Off</span><span class="op" id="6257823">)</span><span class="op" id="6257824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257830">Size</span><span class="op" id="6257834">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257841">uint64</span><span class="op" id="6257847">(</span><span class="ident" id="6257848">sh</span><span class="op" id="6257850">.</span><span class="ident" id="6257851">Size</span><span class="op" id="6257855">)</span><span class="op" id="6257856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257862">Addr</span><span class="op" id="6257866">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257873">uint64</span><span class="op" id="6257879">(</span><span class="ident" id="6257880">sh</span><span class="op" id="6257882">.</span><span class="ident" id="6257883">Addr</span><span class="op" id="6257887">)</span><span class="op" id="6257888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257894">Link</span><span class="op" id="6257898">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6257905">uint32</span><span class="op" id="6257911">(</span><span class="ident" id="6257912">sh</span><span class="op" id="6257914">.</span><span class="ident" id="6257915">Link</span><span class="op" id="6257919">)</span><span class="op" id="6257920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257926">Info</span><span class="op" id="6257930">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6257937">uint32</span><span class="op" id="6257943">(</span><span class="ident" id="6257944">sh</span><span class="op" id="6257946">.</span><span class="ident" id="6257947">Info</span><span class="op" id="6257951">)</span><span class="op" id="6257952">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257958">Addralign</span><span class="op" id="6257967">:</span>&nbsp;<span class="ident" id="6257969">uint64</span><span class="op" id="6257975">(</span><span class="ident" id="6257976">sh</span><span class="op" id="6257978">.</span><span class="ident" id="6257979">Addralign</span><span class="op" id="6257988">)</span><span class="op" id="6257989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257995">Entsize</span><span class="op" id="6258002">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6258006">uint64</span><span class="op" id="6258012">(</span><span class="ident" id="6258013">sh</span><span class="op" id="6258015">.</span><span class="ident" id="6258016">Entsize</span><span class="op" id="6258023">)</span><span class="op" id="6258024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6258029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6258033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6258037">s</span><span class="op" id="6258038">.</span><span class="ident" id="6258039">sr</span>&nbsp;<span class="op" id="6258042">=</span>&nbsp;<span class="ident" id="6258044">io</span><span class="op" id="6258046">.</span><span class="ident" id="6258047">NewSectionReader</span><span class="op" id="6258063">(</span><span class="ident" id="6258064">r</span><span class="op" id="6258065">,</span>&nbsp;<span class="ident" id="6258067">int64</span><span class="op" id="6258072">(</span><span class="ident" id="6258073">s</span><span class="op" id="6258074">.</span><span class="ident" id="6258075">Offset</span><span class="op" id="6258081">)</span><span class="op" id="6258082">,</span>&nbsp;<span class="ident" id="6258084">int64</span><span class="op" id="6258089">(</span><span class="ident" id="6258090">s</span><span class="op" id="6258091">.</span><span class="ident" id="6258092">Size</span><span class="op" id="6258096">)</span><span class="op" id="6258097">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6258101">s</span><span class="op" id="6258102">.</span><span class="ident" id="6258103">ReaderAt</span>&nbsp;<span class="op" id="6258112">=</span>&nbsp;<span class="ident" id="6258114">s</span><span class="op" id="6258115">.</span><span class="ident" id="6258116">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6258121">f</span><span class="op" id="6258122">.</span><span class="ident" id="6258123">Sections</span><span class="op" id="6258131">[</span><span class="ident" id="6258132">i</span><span class="op" id="6258133">]</span>&nbsp;<span class="op" id="6258135">=</span>&nbsp;<span class="ident" id="6258137">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6258140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258144">if</span>&nbsp;<span class="builtinfunc" id="6258147">len</span><span class="op" id="6258150">(</span><span class="ident" id="6258151">f</span><span class="op" id="6258152">.</span><span class="ident" id="6258153">Sections</span><span class="op" id="6258161">)</span>&nbsp;<span class="op" id="6258163">==</span>&nbsp;<span class="num" id="6258166">0</span>&nbsp;<span class="op" id="6258168">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258172">return</span>&nbsp;<span class="ident" id="6258179">f</span><span class="op" id="6258180">,</span>&nbsp;<span class="builtintype" id="6258182">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6258187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6258191">//&nbsp;Load&nbsp;section&nbsp;header&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6258229">shstrtab</span><span class="op" id="6258237">,</span>&nbsp;<span class="ident" id="6258239">err</span>&nbsp;<span class="op" id="6258243">:=</span>&nbsp;<span class="ident" id="6258246">f</span><span class="op" id="6258247">.</span><span class="ident" id="6258248">Sections</span><span class="op" id="6258256">[</span><span class="ident" id="6258257">shstrndx</span><span class="op" id="6258265">]</span><span class="op" id="6258266">.</span><span class="ident" id="6258267">Data</span><span class="op" id="6258271">(</span><span class="op" id="6258272">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258275">if</span>&nbsp;<span class="ident" id="6258278">err</span>&nbsp;<span class="op" id="6258282">!=</span>&nbsp;<span class="builtintype" id="6258285">nil</span>&nbsp;<span class="op" id="6258289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258293">return</span>&nbsp;<span class="builtintype" id="6258300">nil</span><span class="op" id="6258303">,</span>&nbsp;<span class="ident" id="6258305">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6258310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258313">for</span>&nbsp;<span class="ident" id="6258317">i</span><span class="op" id="6258318">,</span>&nbsp;<span class="ident" id="6258320">s</span>&nbsp;<span class="op" id="6258322">:=</span>&nbsp;<span class="keyword" id="6258325">range</span>&nbsp;<span class="ident" id="6258331">f</span><span class="op" id="6258332">.</span><span class="ident" id="6258333">Sections</span>&nbsp;<span class="op" id="6258342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258346">var</span>&nbsp;<span class="ident" id="6258350">ok</span>&nbsp;<span class="builtintype" id="6258353">bool</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6258360">s</span><span class="op" id="6258361">.</span><span class="ident" id="6258362">Name</span><span class="op" id="6258366">,</span>&nbsp;<span class="ident" id="6258368">ok</span>&nbsp;<span class="op" id="6258371">=</span>&nbsp;<span class="ident" id="6258373">getString</span><span class="op" id="6258382">(</span><span class="ident" id="6258383">shstrtab</span><span class="op" id="6258391">,</span>&nbsp;<span class="builtintype" id="6258393">int</span><span class="op" id="6258396">(</span><span class="ident" id="6258397">names</span><span class="op" id="6258402">[</span><span class="ident" id="6258403">i</span><span class="op" id="6258404">]</span><span class="op" id="6258405">)</span><span class="op" id="6258406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258410">if</span>&nbsp;<span class="op" id="6258413">!</span><span class="ident" id="6258414">ok</span>&nbsp;<span class="op" id="6258417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258422">return</span>&nbsp;<span class="builtintype" id="6258429">nil</span><span class="op" id="6258432">,</span>&nbsp;<span class="op" id="6258434">&amp;</span><span class="ident" id="6258435">FormatError</span><span class="op" id="6258446">{</span><span class="ident" id="6258447">shoff</span>&nbsp;<span class="op" id="6258453">+</span>&nbsp;<span class="ident" id="6258455">int64</span><span class="op" id="6258460">(</span><span class="ident" id="6258461">i</span><span class="op" id="6258462">*</span><span class="ident" id="6258463">shentsize</span><span class="op" id="6258472">)</span><span class="op" id="6258473">,</span>&nbsp;<span class="string" id="6258475">&#34;bad&nbsp;section&nbsp;name&nbsp;index&#34;</span><span class="op" id="6258499">,</span>&nbsp;<span class="ident" id="6258501">names</span><span class="op" id="6258506">[</span><span class="ident" id="6258507">i</span><span class="op" id="6258508">]</span><span class="op" id="6258509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6258513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6258516">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258520">return</span>&nbsp;<span class="ident" id="6258527">f</span><span class="op" id="6258528">,</span>&nbsp;<span class="builtintype" id="6258530">nil</span><br>
<span class="lineno"></span><span class="op" id="6258534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6258537">//&nbsp;getSymbols&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;Symbols&nbsp;from&nbsp;parsing&nbsp;the&nbsp;symbol&nbsp;table</span><br>
<span class="lineno">395</span><span class="comment" id="6258608">//&nbsp;with&nbsp;the&nbsp;given&nbsp;type,&nbsp;along&nbsp;with&nbsp;the&nbsp;associated&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="6258672">func</span>&nbsp;<span class="op" id="6258677">(</span><span class="ident" id="6258678">f</span>&nbsp;<span class="op" id="6258680">*</span><span class="ident" id="6258681">File</span><span class="op" id="6258685">)</span>&nbsp;<span class="ident" id="6258687">getSymbols</span><span class="op" id="6258697">(</span><span class="ident" id="6258698">typ</span>&nbsp;<span class="ident" id="6258702">SectionType</span><span class="op" id="6258713">)</span>&nbsp;<span class="op" id="6258715">(</span><span class="op" id="6258716">[</span><span class="op" id="6258717">]</span><span class="ident" id="6258718">Symbol</span><span class="op" id="6258724">,</span>&nbsp;<span class="op" id="6258726">[</span><span class="op" id="6258727">]</span><span class="builtintype" id="6258728">byte</span><span class="op" id="6258732">,</span>&nbsp;<span class="builtintype" id="6258734">error</span><span class="op" id="6258739">)</span>&nbsp;<span class="op" id="6258741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258744">switch</span>&nbsp;<span class="ident" id="6258751">f</span><span class="op" id="6258752">.</span><span class="ident" id="6258753">Class</span>&nbsp;<span class="op" id="6258759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258762">case</span>&nbsp;<span class="ident" id="6258767">ELFCLASS64</span><span class="op" id="6258777">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258781">return</span>&nbsp;<span class="ident" id="6258788">f</span><span class="op" id="6258789">.</span><span class="ident" id="6258790">getSymbols64</span><span class="op" id="6258802">(</span><span class="ident" id="6258803">typ</span><span class="op" id="6258806">)</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258810">case</span>&nbsp;<span class="ident" id="6258815">ELFCLASS32</span><span class="op" id="6258825">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258829">return</span>&nbsp;<span class="ident" id="6258836">f</span><span class="op" id="6258837">.</span><span class="ident" id="6258838">getSymbols32</span><span class="op" id="6258850">(</span><span class="ident" id="6258851">typ</span><span class="op" id="6258854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6258857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258861">return</span>&nbsp;<span class="builtintype" id="6258868">nil</span><span class="op" id="6258871">,</span>&nbsp;<span class="builtintype" id="6258873">nil</span><span class="op" id="6258876">,</span>&nbsp;<span class="ident" id="6258878">errors</span><span class="op" id="6258884">.</span><span class="ident" id="6258885">New</span><span class="op" id="6258888">(</span><span class="string" id="6258889">&#34;not&nbsp;implemented&#34;</span><span class="op" id="6258906">)</span><br>
<span class="lineno"></span><span class="op" id="6258908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6258911">//&nbsp;ErrNoSymbols&nbsp;is&nbsp;returned&nbsp;by&nbsp;File.Symbols&nbsp;and&nbsp;File.DynamicSymbols</span><br>
<span class="lineno"></span><span class="comment" id="6258979">//&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section&nbsp;in&nbsp;the&nbsp;File.</span><br>
<span class="lineno">410</span><span class="keyword" id="6259023">var</span>&nbsp;<span class="ident" id="6259027">ErrNoSymbols</span>&nbsp;<span class="op" id="6259040">=</span>&nbsp;<span class="ident" id="6259042">errors</span><span class="op" id="6259048">.</span><span class="ident" id="6259049">New</span><span class="op" id="6259052">(</span><span class="string" id="6259053">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6259072">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6259075">func</span>&nbsp;<span class="op" id="6259080">(</span><span class="ident" id="6259081">f</span>&nbsp;<span class="op" id="6259083">*</span><span class="ident" id="6259084">File</span><span class="op" id="6259088">)</span>&nbsp;<span class="ident" id="6259090">getSymbols32</span><span class="op" id="6259102">(</span><span class="ident" id="6259103">typ</span>&nbsp;<span class="ident" id="6259107">SectionType</span><span class="op" id="6259118">)</span>&nbsp;<span class="op" id="6259120">(</span><span class="op" id="6259121">[</span><span class="op" id="6259122">]</span><span class="ident" id="6259123">Symbol</span><span class="op" id="6259129">,</span>&nbsp;<span class="op" id="6259131">[</span><span class="op" id="6259132">]</span><span class="builtintype" id="6259133">byte</span><span class="op" id="6259137">,</span>&nbsp;<span class="builtintype" id="6259139">error</span><span class="op" id="6259144">)</span>&nbsp;<span class="op" id="6259146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6259149">symtabSection</span>&nbsp;<span class="op" id="6259163">:=</span>&nbsp;<span class="ident" id="6259166">f</span><span class="op" id="6259167">.</span><span class="ident" id="6259168">SectionByType</span><span class="op" id="6259181">(</span><span class="ident" id="6259182">typ</span><span class="op" id="6259185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6259188">if</span>&nbsp;<span class="ident" id="6259191">symtabSection</span>&nbsp;<span class="op" id="6259205">==</span>&nbsp;<span class="builtintype" id="6259208">nil</span>&nbsp;<span class="op" id="6259212">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6259216">return</span>&nbsp;<span class="builtintype" id="6259223">nil</span><span class="op" id="6259226">,</span>&nbsp;<span class="builtintype" id="6259228">nil</span><span class="op" id="6259231">,</span>&nbsp;<span class="ident" id="6259233">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6259247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6259251">data</span><span class="op" id="6259255">,</span>&nbsp;<span class="ident" id="6259257">err</span>&nbsp;<span class="op" id="6259261">:=</span>&nbsp;<span class="ident" id="6259264">symtabSection</span><span class="op" id="6259277">.</span><span class="ident" id="6259278">Data</span><span class="op" id="6259282">(</span><span class="op" id="6259283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6259286">if</span>&nbsp;<span class="ident" id="6259289">err</span>&nbsp;<span class="op" id="6259293">!=</span>&nbsp;<span class="builtintype" id="6259296">nil</span>&nbsp;<span class="op" id="6259300">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6259304">return</span>&nbsp;<span class="builtintype" id="6259311">nil</span><span class="op" id="6259314">,</span>&nbsp;<span class="builtintype" id="6259316">nil</span><span class="op" id="6259319">,</span>&nbsp;<span class="ident" id="6259321">errors</span><span class="op" id="6259327">.</span><span class="ident" id="6259328">New</span><span class="op" id="6259331">(</span><span class="string" id="6259332">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6259360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6259363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6259366">symtab</span>&nbsp;<span class="op" id="6259373">:=</span>&nbsp;<span class="ident" id="6259376">bytes</span><span class="op" id="6259381">.</span><span class="ident" id="6259382">NewReader</span><span class="op" id="6259391">(</span><span class="ident" id="6259392">data</span><span class="op" id="6259396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6259399">if</span>&nbsp;<span class="ident" id="6259402">symtab</span><span class="op" id="6259408">.</span><span class="ident" id="6259409">Len</span><span class="op" id="6259412">(</span><span class="op" id="6259413">)</span><span class="op" id="6259414">%</span><span class="ident" id="6259415">Sym32Size</span>&nbsp;<span class="op" id="6259425">!=</span>&nbsp;<span class="num" id="6259428">0</span>&nbsp;<span class="op" id="6259430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6259434">return</span>&nbsp;<span class="builtintype" id="6259441">nil</span><span class="op" id="6259444">,</span>&nbsp;<span class="builtintype" id="6259446">nil</span><span class="op" id="6259449">,</span>&nbsp;<span class="ident" id="6259451">errors</span><span class="op" id="6259457">.</span><span class="ident" id="6259458">New</span><span class="op" id="6259461">(</span><span class="string" id="6259462">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;SymSize&#34;</span><span class="op" id="6259517">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6259520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6259524">strdata</span><span class="op" id="6259531">,</span>&nbsp;<span class="ident" id="6259533">err</span>&nbsp;<span class="op" id="6259537">:=</span>&nbsp;<span class="ident" id="6259540">f</span><span class="op" id="6259541">.</span><span class="ident" id="6259542">stringTable</span><span class="op" id="6259553">(</span><span class="ident" id="6259554">symtabSection</span><span class="op" id="6259567">.</span><span class="ident" id="6259568">Link</span><span class="op" id="6259572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6259575">if</span>&nbsp;<span class="ident" id="6259578">err</span>&nbsp;<span class="op" id="6259582">!=</span>&nbsp;<span class="builtintype" id="6259585">nil</span>&nbsp;<span class="op" id="6259589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6259593">return</span>&nbsp;<span class="builtintype" id="6259600">nil</span><span class="op" id="6259603">,</span>&nbsp;<span class="builtintype" id="6259605">nil</span><span class="op" id="6259608">,</span>&nbsp;<span class="ident" id="6259610">errors</span><span class="op" id="6259616">.</span><span class="ident" id="6259617">New</span><span class="op" id="6259620">(</span><span class="string" id="6259621">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="6259655">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6259658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6259662">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6259696">var</span>&nbsp;<span class="ident" id="6259700">skip</span>&nbsp;<span class="op" id="6259705">[</span><span class="ident" id="6259706">Sym32Size</span><span class="op" id="6259715">]</span><span class="builtintype" id="6259716">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6259722">symtab</span><span class="op" id="6259728">.</span><span class="ident" id="6259729">Read</span><span class="op" id="6259733">(</span><span class="ident" id="6259734">skip</span><span class="op" id="6259738">[</span><span class="op" id="6259739">:</span><span class="op" id="6259740">]</span><span class="op" id="6259741">)</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6259745">symbols</span>&nbsp;<span class="op" id="6259753">:=</span>&nbsp;<span class="builtinfunc" id="6259756">make</span><span class="op" id="6259760">(</span><span class="op" id="6259761">[</span><span class="op" id="6259762">]</span><span class="ident" id="6259763">Symbol</span><span class="op" id="6259769">,</span>&nbsp;<span class="ident" id="6259771">symtab</span><span class="op" id="6259777">.</span><span class="ident" id="6259778">Len</span><span class="op" id="6259781">(</span><span class="op" id="6259782">)</span><span class="op" id="6259783">/</span><span class="ident" id="6259784">Sym32Size</span><span class="op" id="6259793">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6259797">i</span>&nbsp;<span class="op" id="6259799">:=</span>&nbsp;<span class="num" id="6259802">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6259805">var</span>&nbsp;<span class="ident" id="6259809">sym</span>&nbsp;<span class="ident" id="6259813">Sym32</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6259820">for</span>&nbsp;<span class="ident" id="6259824">symtab</span><span class="op" id="6259830">.</span><span class="ident" id="6259831">Len</span><span class="op" id="6259834">(</span><span class="op" id="6259835">)</span>&nbsp;<span class="op" id="6259837">&gt;</span>&nbsp;<span class="num" id="6259839">0</span>&nbsp;<span class="op" id="6259841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6259845">binary</span><span class="op" id="6259851">.</span><span class="ident" id="6259852">Read</span><span class="op" id="6259856">(</span><span class="ident" id="6259857">symtab</span><span class="op" id="6259863">,</span>&nbsp;<span class="ident" id="6259865">f</span><span class="op" id="6259866">.</span><span class="ident" id="6259867">ByteOrder</span><span class="op" id="6259876">,</span>&nbsp;<span class="op" id="6259878">&amp;</span><span class="ident" id="6259879">sym</span><span class="op" id="6259882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6259886">str</span><span class="op" id="6259889">,</span>&nbsp;<span class="ident" id="6259891">_</span>&nbsp;<span class="op" id="6259893">:=</span>&nbsp;<span class="ident" id="6259896">getString</span><span class="op" id="6259905">(</span><span class="ident" id="6259906">strdata</span><span class="op" id="6259913">,</span>&nbsp;<span class="builtintype" id="6259915">int</span><span class="op" id="6259918">(</span><span class="ident" id="6259919">sym</span><span class="op" id="6259922">.</span><span class="ident" id="6259923">Name</span><span class="op" id="6259927">)</span><span class="op" id="6259928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6259932">symbols</span><span class="op" id="6259939">[</span><span class="ident" id="6259940">i</span><span class="op" id="6259941">]</span><span class="op" id="6259942">.</span><span class="ident" id="6259943">Name</span>&nbsp;<span class="op" id="6259948">=</span>&nbsp;<span class="ident" id="6259950">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6259956">symbols</span><span class="op" id="6259963">[</span><span class="ident" id="6259964">i</span><span class="op" id="6259965">]</span><span class="op" id="6259966">.</span><span class="ident" id="6259967">Info</span>&nbsp;<span class="op" id="6259972">=</span>&nbsp;<span class="ident" id="6259974">sym</span><span class="op" id="6259977">.</span><span class="ident" id="6259978">Info</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6259985">symbols</span><span class="op" id="6259992">[</span><span class="ident" id="6259993">i</span><span class="op" id="6259994">]</span><span class="op" id="6259995">.</span><span class="ident" id="6259996">Other</span>&nbsp;<span class="op" id="6260002">=</span>&nbsp;<span class="ident" id="6260004">sym</span><span class="op" id="6260007">.</span><span class="ident" id="6260008">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6260016">symbols</span><span class="op" id="6260023">[</span><span class="ident" id="6260024">i</span><span class="op" id="6260025">]</span><span class="op" id="6260026">.</span><span class="ident" id="6260027">Section</span>&nbsp;<span class="op" id="6260035">=</span>&nbsp;<span class="ident" id="6260037">SectionIndex</span><span class="op" id="6260049">(</span><span class="ident" id="6260050">sym</span><span class="op" id="6260053">.</span><span class="ident" id="6260054">Shndx</span><span class="op" id="6260059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6260063">symbols</span><span class="op" id="6260070">[</span><span class="ident" id="6260071">i</span><span class="op" id="6260072">]</span><span class="op" id="6260073">.</span><span class="ident" id="6260074">Value</span>&nbsp;<span class="op" id="6260080">=</span>&nbsp;<span class="ident" id="6260082">uint64</span><span class="op" id="6260088">(</span><span class="ident" id="6260089">sym</span><span class="op" id="6260092">.</span><span class="ident" id="6260093">Value</span><span class="op" id="6260098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6260102">symbols</span><span class="op" id="6260109">[</span><span class="ident" id="6260110">i</span><span class="op" id="6260111">]</span><span class="op" id="6260112">.</span><span class="ident" id="6260113">Size</span>&nbsp;<span class="op" id="6260118">=</span>&nbsp;<span class="ident" id="6260120">uint64</span><span class="op" id="6260126">(</span><span class="ident" id="6260127">sym</span><span class="op" id="6260130">.</span><span class="ident" id="6260131">Size</span><span class="op" id="6260135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6260139">i</span><span class="op" id="6260140">++</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6260144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6260148">return</span>&nbsp;<span class="ident" id="6260155">symbols</span><span class="op" id="6260162">,</span>&nbsp;<span class="ident" id="6260164">strdata</span><span class="op" id="6260171">,</span>&nbsp;<span class="builtintype" id="6260173">nil</span><br>
<span class="lineno"></span><span class="op" id="6260177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="keyword" id="6260180">func</span>&nbsp;<span class="op" id="6260185">(</span><span class="ident" id="6260186">f</span>&nbsp;<span class="op" id="6260188">*</span><span class="ident" id="6260189">File</span><span class="op" id="6260193">)</span>&nbsp;<span class="ident" id="6260195">getSymbols64</span><span class="op" id="6260207">(</span><span class="ident" id="6260208">typ</span>&nbsp;<span class="ident" id="6260212">SectionType</span><span class="op" id="6260223">)</span>&nbsp;<span class="op" id="6260225">(</span><span class="op" id="6260226">[</span><span class="op" id="6260227">]</span><span class="ident" id="6260228">Symbol</span><span class="op" id="6260234">,</span>&nbsp;<span class="op" id="6260236">[</span><span class="op" id="6260237">]</span><span class="builtintype" id="6260238">byte</span><span class="op" id="6260242">,</span>&nbsp;<span class="builtintype" id="6260244">error</span><span class="op" id="6260249">)</span>&nbsp;<span class="op" id="6260251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6260254">symtabSection</span>&nbsp;<span class="op" id="6260268">:=</span>&nbsp;<span class="ident" id="6260271">f</span><span class="op" id="6260272">.</span><span class="ident" id="6260273">SectionByType</span><span class="op" id="6260286">(</span><span class="ident" id="6260287">typ</span><span class="op" id="6260290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6260293">if</span>&nbsp;<span class="ident" id="6260296">symtabSection</span>&nbsp;<span class="op" id="6260310">==</span>&nbsp;<span class="builtintype" id="6260313">nil</span>&nbsp;<span class="op" id="6260317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6260321">return</span>&nbsp;<span class="builtintype" id="6260328">nil</span><span class="op" id="6260331">,</span>&nbsp;<span class="builtintype" id="6260333">nil</span><span class="op" id="6260336">,</span>&nbsp;<span class="ident" id="6260338">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6260352">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6260356">data</span><span class="op" id="6260360">,</span>&nbsp;<span class="ident" id="6260362">err</span>&nbsp;<span class="op" id="6260366">:=</span>&nbsp;<span class="ident" id="6260369">symtabSection</span><span class="op" id="6260382">.</span><span class="ident" id="6260383">Data</span><span class="op" id="6260387">(</span><span class="op" id="6260388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6260391">if</span>&nbsp;<span class="ident" id="6260394">err</span>&nbsp;<span class="op" id="6260398">!=</span>&nbsp;<span class="builtintype" id="6260401">nil</span>&nbsp;<span class="op" id="6260405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6260409">return</span>&nbsp;<span class="builtintype" id="6260416">nil</span><span class="op" id="6260419">,</span>&nbsp;<span class="builtintype" id="6260421">nil</span><span class="op" id="6260424">,</span>&nbsp;<span class="ident" id="6260426">errors</span><span class="op" id="6260432">.</span><span class="ident" id="6260433">New</span><span class="op" id="6260436">(</span><span class="string" id="6260437">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6260465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6260468">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6260471">symtab</span>&nbsp;<span class="op" id="6260478">:=</span>&nbsp;<span class="ident" id="6260481">bytes</span><span class="op" id="6260486">.</span><span class="ident" id="6260487">NewReader</span><span class="op" id="6260496">(</span><span class="ident" id="6260497">data</span><span class="op" id="6260501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6260504">if</span>&nbsp;<span class="ident" id="6260507">symtab</span><span class="op" id="6260513">.</span><span class="ident" id="6260514">Len</span><span class="op" id="6260517">(</span><span class="op" id="6260518">)</span><span class="op" id="6260519">%</span><span class="ident" id="6260520">Sym64Size</span>&nbsp;<span class="op" id="6260530">!=</span>&nbsp;<span class="num" id="6260533">0</span>&nbsp;<span class="op" id="6260535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6260539">return</span>&nbsp;<span class="builtintype" id="6260546">nil</span><span class="op" id="6260549">,</span>&nbsp;<span class="builtintype" id="6260551">nil</span><span class="op" id="6260554">,</span>&nbsp;<span class="ident" id="6260556">errors</span><span class="op" id="6260562">.</span><span class="ident" id="6260563">New</span><span class="op" id="6260566">(</span><span class="string" id="6260567">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;Sym64Size&#34;</span><span class="op" id="6260624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6260627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6260631">strdata</span><span class="op" id="6260638">,</span>&nbsp;<span class="ident" id="6260640">err</span>&nbsp;<span class="op" id="6260644">:=</span>&nbsp;<span class="ident" id="6260647">f</span><span class="op" id="6260648">.</span><span class="ident" id="6260649">stringTable</span><span class="op" id="6260660">(</span><span class="ident" id="6260661">symtabSection</span><span class="op" id="6260674">.</span><span class="ident" id="6260675">Link</span><span class="op" id="6260679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6260682">if</span>&nbsp;<span class="ident" id="6260685">err</span>&nbsp;<span class="op" id="6260689">!=</span>&nbsp;<span class="builtintype" id="6260692">nil</span>&nbsp;<span class="op" id="6260696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6260700">return</span>&nbsp;<span class="builtintype" id="6260707">nil</span><span class="op" id="6260710">,</span>&nbsp;<span class="builtintype" id="6260712">nil</span><span class="op" id="6260715">,</span>&nbsp;<span class="ident" id="6260717">errors</span><span class="op" id="6260723">.</span><span class="ident" id="6260724">New</span><span class="op" id="6260727">(</span><span class="string" id="6260728">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="6260762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6260765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6260769">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6260803">var</span>&nbsp;<span class="ident" id="6260807">skip</span>&nbsp;<span class="op" id="6260812">[</span><span class="ident" id="6260813">Sym64Size</span><span class="op" id="6260822">]</span><span class="builtintype" id="6260823">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6260829">symtab</span><span class="op" id="6260835">.</span><span class="ident" id="6260836">Read</span><span class="op" id="6260840">(</span><span class="ident" id="6260841">skip</span><span class="op" id="6260845">[</span><span class="op" id="6260846">:</span><span class="op" id="6260847">]</span><span class="op" id="6260848">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6260852">symbols</span>&nbsp;<span class="op" id="6260860">:=</span>&nbsp;<span class="builtinfunc" id="6260863">make</span><span class="op" id="6260867">(</span><span class="op" id="6260868">[</span><span class="op" id="6260869">]</span><span class="ident" id="6260870">Symbol</span><span class="op" id="6260876">,</span>&nbsp;<span class="ident" id="6260878">symtab</span><span class="op" id="6260884">.</span><span class="ident" id="6260885">Len</span><span class="op" id="6260888">(</span><span class="op" id="6260889">)</span><span class="op" id="6260890">/</span><span class="ident" id="6260891">Sym64Size</span><span class="op" id="6260900">)</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6260904">i</span>&nbsp;<span class="op" id="6260906">:=</span>&nbsp;<span class="num" id="6260909">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6260912">var</span>&nbsp;<span class="ident" id="6260916">sym</span>&nbsp;<span class="ident" id="6260920">Sym64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6260927">for</span>&nbsp;<span class="ident" id="6260931">symtab</span><span class="op" id="6260937">.</span><span class="ident" id="6260938">Len</span><span class="op" id="6260941">(</span><span class="op" id="6260942">)</span>&nbsp;<span class="op" id="6260944">&gt;</span>&nbsp;<span class="num" id="6260946">0</span>&nbsp;<span class="op" id="6260948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6260952">binary</span><span class="op" id="6260958">.</span><span class="ident" id="6260959">Read</span><span class="op" id="6260963">(</span><span class="ident" id="6260964">symtab</span><span class="op" id="6260970">,</span>&nbsp;<span class="ident" id="6260972">f</span><span class="op" id="6260973">.</span><span class="ident" id="6260974">ByteOrder</span><span class="op" id="6260983">,</span>&nbsp;<span class="op" id="6260985">&amp;</span><span class="ident" id="6260986">sym</span><span class="op" id="6260989">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6260993">str</span><span class="op" id="6260996">,</span>&nbsp;<span class="ident" id="6260998">_</span>&nbsp;<span class="op" id="6261000">:=</span>&nbsp;<span class="ident" id="6261003">getString</span><span class="op" id="6261012">(</span><span class="ident" id="6261013">strdata</span><span class="op" id="6261020">,</span>&nbsp;<span class="builtintype" id="6261022">int</span><span class="op" id="6261025">(</span><span class="ident" id="6261026">sym</span><span class="op" id="6261029">.</span><span class="ident" id="6261030">Name</span><span class="op" id="6261034">)</span><span class="op" id="6261035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6261039">symbols</span><span class="op" id="6261046">[</span><span class="ident" id="6261047">i</span><span class="op" id="6261048">]</span><span class="op" id="6261049">.</span><span class="ident" id="6261050">Name</span>&nbsp;<span class="op" id="6261055">=</span>&nbsp;<span class="ident" id="6261057">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6261063">symbols</span><span class="op" id="6261070">[</span><span class="ident" id="6261071">i</span><span class="op" id="6261072">]</span><span class="op" id="6261073">.</span><span class="ident" id="6261074">Info</span>&nbsp;<span class="op" id="6261079">=</span>&nbsp;<span class="ident" id="6261081">sym</span><span class="op" id="6261084">.</span><span class="ident" id="6261085">Info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6261092">symbols</span><span class="op" id="6261099">[</span><span class="ident" id="6261100">i</span><span class="op" id="6261101">]</span><span class="op" id="6261102">.</span><span class="ident" id="6261103">Other</span>&nbsp;<span class="op" id="6261109">=</span>&nbsp;<span class="ident" id="6261111">sym</span><span class="op" id="6261114">.</span><span class="ident" id="6261115">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6261123">symbols</span><span class="op" id="6261130">[</span><span class="ident" id="6261131">i</span><span class="op" id="6261132">]</span><span class="op" id="6261133">.</span><span class="ident" id="6261134">Section</span>&nbsp;<span class="op" id="6261142">=</span>&nbsp;<span class="ident" id="6261144">SectionIndex</span><span class="op" id="6261156">(</span><span class="ident" id="6261157">sym</span><span class="op" id="6261160">.</span><span class="ident" id="6261161">Shndx</span><span class="op" id="6261166">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6261170">symbols</span><span class="op" id="6261177">[</span><span class="ident" id="6261178">i</span><span class="op" id="6261179">]</span><span class="op" id="6261180">.</span><span class="ident" id="6261181">Value</span>&nbsp;<span class="op" id="6261187">=</span>&nbsp;<span class="ident" id="6261189">sym</span><span class="op" id="6261192">.</span><span class="ident" id="6261193">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6261201">symbols</span><span class="op" id="6261208">[</span><span class="ident" id="6261209">i</span><span class="op" id="6261210">]</span><span class="op" id="6261211">.</span><span class="ident" id="6261212">Size</span>&nbsp;<span class="op" id="6261217">=</span>&nbsp;<span class="ident" id="6261219">sym</span><span class="op" id="6261222">.</span><span class="ident" id="6261223">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6261230">i</span><span class="op" id="6261231">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6261235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6261239">return</span>&nbsp;<span class="ident" id="6261246">symbols</span><span class="op" id="6261253">,</span>&nbsp;<span class="ident" id="6261255">strdata</span><span class="op" id="6261262">,</span>&nbsp;<span class="builtintype" id="6261264">nil</span><br>
<span class="lineno"></span><span class="op" id="6261268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6261271">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;an&nbsp;ELF&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="6261328">func</span>&nbsp;<span class="ident" id="6261333">getString</span><span class="op" id="6261342">(</span><span class="ident" id="6261343">section</span>&nbsp;<span class="op" id="6261351">[</span><span class="op" id="6261352">]</span><span class="builtintype" id="6261353">byte</span><span class="op" id="6261357">,</span>&nbsp;<span class="ident" id="6261359">start</span>&nbsp;<span class="builtintype" id="6261365">int</span><span class="op" id="6261368">)</span>&nbsp;<span class="op" id="6261370">(</span><span class="builtintype" id="6261371">string</span><span class="op" id="6261377">,</span>&nbsp;<span class="builtintype" id="6261379">bool</span><span class="op" id="6261383">)</span>&nbsp;<span class="op" id="6261385">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6261388">if</span>&nbsp;<span class="ident" id="6261391">start</span>&nbsp;<span class="op" id="6261397">&lt;</span>&nbsp;<span class="num" id="6261399">0</span>&nbsp;<span class="op" id="6261401">||</span>&nbsp;<span class="ident" id="6261404">start</span>&nbsp;<span class="op" id="6261410">&gt;=</span>&nbsp;<span class="builtinfunc" id="6261413">len</span><span class="op" id="6261416">(</span><span class="ident" id="6261417">section</span><span class="op" id="6261424">)</span>&nbsp;<span class="op" id="6261426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6261430">return</span>&nbsp;<span class="string" id="6261437">&#34;&#34;</span><span class="op" id="6261439">,</span>&nbsp;<span class="builtintype" id="6261441">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6261448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6261452">for</span>&nbsp;<span class="ident" id="6261456">end</span>&nbsp;<span class="op" id="6261460">:=</span>&nbsp;<span class="ident" id="6261463">start</span><span class="op" id="6261468">;</span>&nbsp;<span class="ident" id="6261470">end</span>&nbsp;<span class="op" id="6261474">&lt;</span>&nbsp;<span class="builtinfunc" id="6261476">len</span><span class="op" id="6261479">(</span><span class="ident" id="6261480">section</span><span class="op" id="6261487">)</span><span class="op" id="6261488">;</span>&nbsp;<span class="ident" id="6261490">end</span><span class="op" id="6261493">++</span>&nbsp;<span class="op" id="6261496">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6261500">if</span>&nbsp;<span class="ident" id="6261503">section</span><span class="op" id="6261510">[</span><span class="ident" id="6261511">end</span><span class="op" id="6261514">]</span>&nbsp;<span class="op" id="6261516">==</span>&nbsp;<span class="num" id="6261519">0</span>&nbsp;<span class="op" id="6261521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6261526">return</span>&nbsp;<span class="builtintype" id="6261533">string</span><span class="op" id="6261539">(</span><span class="ident" id="6261540">section</span><span class="op" id="6261547">[</span><span class="ident" id="6261548">start</span><span class="op" id="6261553">:</span><span class="ident" id="6261554">end</span><span class="op" id="6261557">]</span><span class="op" id="6261558">)</span><span class="op" id="6261559">,</span>&nbsp;<span class="builtintype" id="6261561">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6261568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6261571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6261574">return</span>&nbsp;<span class="string" id="6261581">&#34;&#34;</span><span class="op" id="6261583">,</span>&nbsp;<span class="builtintype" id="6261585">false</span><br>
<span class="lineno">510</span><span class="op" id="6261591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6261594">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="6261662">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="6261681">func</span>&nbsp;<span class="op" id="6261686">(</span><span class="ident" id="6261687">f</span>&nbsp;<span class="op" id="6261689">*</span><span class="ident" id="6261690">File</span><span class="op" id="6261694">)</span>&nbsp;<span class="ident" id="6261696">Section</span><span class="op" id="6261703">(</span><span class="ident" id="6261704">name</span>&nbsp;<span class="builtintype" id="6261709">string</span><span class="op" id="6261715">)</span>&nbsp;<span class="op" id="6261717">*</span><span class="ident" id="6261718">Section</span>&nbsp;<span class="op" id="6261726">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6261729">for</span>&nbsp;<span class="ident" id="6261733">_</span><span class="op" id="6261734">,</span>&nbsp;<span class="ident" id="6261736">s</span>&nbsp;<span class="op" id="6261738">:=</span>&nbsp;<span class="keyword" id="6261741">range</span>&nbsp;<span class="ident" id="6261747">f</span><span class="op" id="6261748">.</span><span class="ident" id="6261749">Sections</span>&nbsp;<span class="op" id="6261758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6261762">if</span>&nbsp;<span class="ident" id="6261765">s</span><span class="op" id="6261766">.</span><span class="ident" id="6261767">Name</span>&nbsp;<span class="op" id="6261772">==</span>&nbsp;<span class="ident" id="6261775">name</span>&nbsp;<span class="op" id="6261780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6261785">return</span>&nbsp;<span class="ident" id="6261792">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6261796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6261799">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6261802">return</span>&nbsp;<span class="builtintype" id="6261809">nil</span><br>
<span class="lineno"></span><span class="op" id="6261813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6261816">//&nbsp;applyRelocations&nbsp;applies&nbsp;relocations&nbsp;to&nbsp;dst.&nbsp;rels&nbsp;is&nbsp;a&nbsp;relocations&nbsp;section</span><br>
<span class="lineno"></span><span class="comment" id="6261894">//&nbsp;in&nbsp;RELA&nbsp;format.</span><br>
<span class="lineno">525</span><span class="keyword" id="6261913">func</span>&nbsp;<span class="op" id="6261918">(</span><span class="ident" id="6261919">f</span>&nbsp;<span class="op" id="6261921">*</span><span class="ident" id="6261922">File</span><span class="op" id="6261926">)</span>&nbsp;<span class="ident" id="6261928">applyRelocations</span><span class="op" id="6261944">(</span><span class="ident" id="6261945">dst</span>&nbsp;<span class="op" id="6261949">[</span><span class="op" id="6261950">]</span><span class="builtintype" id="6261951">byte</span><span class="op" id="6261955">,</span>&nbsp;<span class="ident" id="6261957">rels</span>&nbsp;<span class="op" id="6261962">[</span><span class="op" id="6261963">]</span><span class="builtintype" id="6261964">byte</span><span class="op" id="6261968">)</span>&nbsp;<span class="builtintype" id="6261970">error</span>&nbsp;<span class="op" id="6261976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6261979">if</span>&nbsp;<span class="ident" id="6261982">f</span><span class="op" id="6261983">.</span><span class="ident" id="6261984">Class</span>&nbsp;<span class="op" id="6261990">==</span>&nbsp;<span class="ident" id="6261993">ELFCLASS64</span>&nbsp;<span class="op" id="6262004">&amp;&amp;</span>&nbsp;<span class="ident" id="6262007">f</span><span class="op" id="6262008">.</span><span class="ident" id="6262009">Machine</span>&nbsp;<span class="op" id="6262017">==</span>&nbsp;<span class="ident" id="6262020">EM_X86_64</span>&nbsp;<span class="op" id="6262030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6262034">return</span>&nbsp;<span class="ident" id="6262041">f</span><span class="op" id="6262042">.</span><span class="ident" id="6262043">applyRelocationsAMD64</span><span class="op" id="6262064">(</span><span class="ident" id="6262065">dst</span><span class="op" id="6262068">,</span>&nbsp;<span class="ident" id="6262070">rels</span><span class="op" id="6262074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6262077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6262080">if</span>&nbsp;<span class="ident" id="6262083">f</span><span class="op" id="6262084">.</span><span class="ident" id="6262085">Class</span>&nbsp;<span class="op" id="6262091">==</span>&nbsp;<span class="ident" id="6262094">ELFCLASS32</span>&nbsp;<span class="op" id="6262105">&amp;&amp;</span>&nbsp;<span class="ident" id="6262108">f</span><span class="op" id="6262109">.</span><span class="ident" id="6262110">Machine</span>&nbsp;<span class="op" id="6262118">==</span>&nbsp;<span class="ident" id="6262121">EM_386</span>&nbsp;<span class="op" id="6262128">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6262132">return</span>&nbsp;<span class="ident" id="6262139">f</span><span class="op" id="6262140">.</span><span class="ident" id="6262141">applyRelocations386</span><span class="op" id="6262160">(</span><span class="ident" id="6262161">dst</span><span class="op" id="6262164">,</span>&nbsp;<span class="ident" id="6262166">rels</span><span class="op" id="6262170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6262173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6262176">if</span>&nbsp;<span class="ident" id="6262179">f</span><span class="op" id="6262180">.</span><span class="ident" id="6262181">Class</span>&nbsp;<span class="op" id="6262187">==</span>&nbsp;<span class="ident" id="6262190">ELFCLASS64</span>&nbsp;<span class="op" id="6262201">&amp;&amp;</span>&nbsp;<span class="ident" id="6262204">f</span><span class="op" id="6262205">.</span><span class="ident" id="6262206">Machine</span>&nbsp;<span class="op" id="6262214">==</span>&nbsp;<span class="ident" id="6262217">EM_AARCH64</span>&nbsp;<span class="op" id="6262228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6262232">return</span>&nbsp;<span class="ident" id="6262239">f</span><span class="op" id="6262240">.</span><span class="ident" id="6262241">applyRelocationsARM64</span><span class="op" id="6262262">(</span><span class="ident" id="6262263">dst</span><span class="op" id="6262266">,</span>&nbsp;<span class="ident" id="6262268">rels</span><span class="op" id="6262272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6262275">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6262279">return</span>&nbsp;<span class="ident" id="6262286">errors</span><span class="op" id="6262292">.</span><span class="ident" id="6262293">New</span><span class="op" id="6262296">(</span><span class="string" id="6262297">&#34;not&nbsp;implemented&#34;</span><span class="op" id="6262314">)</span><br>
<span class="lineno"></span><span class="op" id="6262316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6262319">func</span>&nbsp;<span class="op" id="6262324">(</span><span class="ident" id="6262325">f</span>&nbsp;<span class="op" id="6262327">*</span><span class="ident" id="6262328">File</span><span class="op" id="6262332">)</span>&nbsp;<span class="ident" id="6262334">applyRelocationsAMD64</span><span class="op" id="6262355">(</span><span class="ident" id="6262356">dst</span>&nbsp;<span class="op" id="6262360">[</span><span class="op" id="6262361">]</span><span class="builtintype" id="6262362">byte</span><span class="op" id="6262366">,</span>&nbsp;<span class="ident" id="6262368">rels</span>&nbsp;<span class="op" id="6262373">[</span><span class="op" id="6262374">]</span><span class="builtintype" id="6262375">byte</span><span class="op" id="6262379">)</span>&nbsp;<span class="builtintype" id="6262381">error</span>&nbsp;<span class="op" id="6262387">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6262390">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6262420">if</span>&nbsp;<span class="builtinfunc" id="6262423">len</span><span class="op" id="6262426">(</span><span class="ident" id="6262427">rels</span><span class="op" id="6262431">)</span><span class="op" id="6262432">%</span><span class="num" id="6262433">24</span>&nbsp;<span class="op" id="6262436">!=</span>&nbsp;<span class="num" id="6262439">0</span>&nbsp;<span class="op" id="6262441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6262445">return</span>&nbsp;<span class="ident" id="6262452">errors</span><span class="op" id="6262458">.</span><span class="ident" id="6262459">New</span><span class="op" id="6262462">(</span><span class="string" id="6262463">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="6262517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6262520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6262524">symbols</span><span class="op" id="6262531">,</span>&nbsp;<span class="ident" id="6262533">_</span><span class="op" id="6262534">,</span>&nbsp;<span class="ident" id="6262536">err</span>&nbsp;<span class="op" id="6262540">:=</span>&nbsp;<span class="ident" id="6262543">f</span><span class="op" id="6262544">.</span><span class="ident" id="6262545">getSymbols</span><span class="op" id="6262555">(</span><span class="ident" id="6262556">SHT_SYMTAB</span><span class="op" id="6262566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6262569">if</span>&nbsp;<span class="ident" id="6262572">err</span>&nbsp;<span class="op" id="6262576">!=</span>&nbsp;<span class="builtintype" id="6262579">nil</span>&nbsp;<span class="op" id="6262583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6262587">return</span>&nbsp;<span class="ident" id="6262594">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6262599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6262603">b</span>&nbsp;<span class="op" id="6262605">:=</span>&nbsp;<span class="ident" id="6262608">bytes</span><span class="op" id="6262613">.</span><span class="ident" id="6262614">NewReader</span><span class="op" id="6262623">(</span><span class="ident" id="6262624">rels</span><span class="op" id="6262628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6262631">var</span>&nbsp;<span class="ident" id="6262635">rela</span>&nbsp;<span class="ident" id="6262640">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6262649">for</span>&nbsp;<span class="ident" id="6262653">b</span><span class="op" id="6262654">.</span><span class="ident" id="6262655">Len</span><span class="op" id="6262658">(</span><span class="op" id="6262659">)</span>&nbsp;<span class="op" id="6262661">&gt;</span>&nbsp;<span class="num" id="6262663">0</span>&nbsp;<span class="op" id="6262665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6262669">binary</span><span class="op" id="6262675">.</span><span class="ident" id="6262676">Read</span><span class="op" id="6262680">(</span><span class="ident" id="6262681">b</span><span class="op" id="6262682">,</span>&nbsp;<span class="ident" id="6262684">f</span><span class="op" id="6262685">.</span><span class="ident" id="6262686">ByteOrder</span><span class="op" id="6262695">,</span>&nbsp;<span class="op" id="6262697">&amp;</span><span class="ident" id="6262698">rela</span><span class="op" id="6262702">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6262706">symNo</span>&nbsp;<span class="op" id="6262712">:=</span>&nbsp;<span class="ident" id="6262715">rela</span><span class="op" id="6262719">.</span><span class="ident" id="6262720">Info</span>&nbsp;<span class="op" id="6262725">&gt;&gt;</span>&nbsp;<span class="num" id="6262728">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6262733">t</span>&nbsp;<span class="op" id="6262735">:=</span>&nbsp;<span class="ident" id="6262738">R_X86_64</span><span class="op" id="6262746">(</span><span class="ident" id="6262747">rela</span><span class="op" id="6262751">.</span><span class="ident" id="6262752">Info</span>&nbsp;<span class="op" id="6262757">&amp;</span>&nbsp;<span class="num" id="6262759">0xffff</span><span class="op" id="6262765">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6262770">if</span>&nbsp;<span class="ident" id="6262773">symNo</span>&nbsp;<span class="op" id="6262779">==</span>&nbsp;<span class="num" id="6262782">0</span>&nbsp;<span class="op" id="6262784">||</span>&nbsp;<span class="ident" id="6262787">symNo</span>&nbsp;<span class="op" id="6262793">&gt;</span>&nbsp;<span class="ident" id="6262795">uint64</span><span class="op" id="6262801">(</span><span class="builtinfunc" id="6262802">len</span><span class="op" id="6262805">(</span><span class="ident" id="6262806">symbols</span><span class="op" id="6262813">)</span><span class="op" id="6262814">)</span>&nbsp;<span class="op" id="6262816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6262821">continue</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6262832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6262836">sym</span>&nbsp;<span class="op" id="6262840">:=</span>&nbsp;<span class="op" id="6262843">&amp;</span><span class="ident" id="6262844">symbols</span><span class="op" id="6262851">[</span><span class="ident" id="6262852">symNo</span><span class="op" id="6262857">-</span><span class="num" id="6262858">1</span><span class="op" id="6262859">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6262863">if</span>&nbsp;<span class="ident" id="6262866">SymType</span><span class="op" id="6262873">(</span><span class="ident" id="6262874">sym</span><span class="op" id="6262877">.</span><span class="ident" id="6262878">Info</span><span class="op" id="6262882">&amp;</span><span class="num" id="6262883">0xf</span><span class="op" id="6262886">)</span>&nbsp;<span class="op" id="6262888">!=</span>&nbsp;<span class="ident" id="6262891">STT_SECTION</span>&nbsp;<span class="op" id="6262903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6262908">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6262963">continue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6262974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6262979">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6263032">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6263087">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6263134">switch</span>&nbsp;<span class="ident" id="6263141">t</span>&nbsp;<span class="op" id="6263143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6263147">case</span>&nbsp;<span class="ident" id="6263152">R_X86_64_64</span><span class="op" id="6263163">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6263168">if</span>&nbsp;<span class="ident" id="6263171">rela</span><span class="op" id="6263175">.</span><span class="ident" id="6263176">Off</span><span class="op" id="6263179">+</span><span class="num" id="6263180">8</span>&nbsp;<span class="op" id="6263182">&gt;=</span>&nbsp;<span class="ident" id="6263185">uint64</span><span class="op" id="6263191">(</span><span class="builtinfunc" id="6263192">len</span><span class="op" id="6263195">(</span><span class="ident" id="6263196">dst</span><span class="op" id="6263199">)</span><span class="op" id="6263200">)</span>&nbsp;<span class="op" id="6263202">||</span>&nbsp;<span class="ident" id="6263205">rela</span><span class="op" id="6263209">.</span><span class="ident" id="6263210">Addend</span>&nbsp;<span class="op" id="6263217">&lt;</span>&nbsp;<span class="num" id="6263219">0</span>&nbsp;<span class="op" id="6263221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6263227">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6263239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6263244">f</span><span class="op" id="6263245">.</span><span class="ident" id="6263246">ByteOrder</span><span class="op" id="6263255">.</span><span class="ident" id="6263256">PutUint64</span><span class="op" id="6263265">(</span><span class="ident" id="6263266">dst</span><span class="op" id="6263269">[</span><span class="ident" id="6263270">rela</span><span class="op" id="6263274">.</span><span class="ident" id="6263275">Off</span><span class="op" id="6263278">:</span><span class="ident" id="6263279">rela</span><span class="op" id="6263283">.</span><span class="ident" id="6263284">Off</span><span class="op" id="6263287">+</span><span class="num" id="6263288">8</span><span class="op" id="6263289">]</span><span class="op" id="6263290">,</span>&nbsp;<span class="ident" id="6263292">uint64</span><span class="op" id="6263298">(</span><span class="ident" id="6263299">rela</span><span class="op" id="6263303">.</span><span class="ident" id="6263304">Addend</span><span class="op" id="6263310">)</span><span class="op" id="6263311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6263315">case</span>&nbsp;<span class="ident" id="6263320">R_X86_64_32</span><span class="op" id="6263331">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6263336">if</span>&nbsp;<span class="ident" id="6263339">rela</span><span class="op" id="6263343">.</span><span class="ident" id="6263344">Off</span><span class="op" id="6263347">+</span><span class="num" id="6263348">4</span>&nbsp;<span class="op" id="6263350">&gt;=</span>&nbsp;<span class="ident" id="6263353">uint64</span><span class="op" id="6263359">(</span><span class="builtinfunc" id="6263360">len</span><span class="op" id="6263363">(</span><span class="ident" id="6263364">dst</span><span class="op" id="6263367">)</span><span class="op" id="6263368">)</span>&nbsp;<span class="op" id="6263370">||</span>&nbsp;<span class="ident" id="6263373">rela</span><span class="op" id="6263377">.</span><span class="ident" id="6263378">Addend</span>&nbsp;<span class="op" id="6263385">&lt;</span>&nbsp;<span class="num" id="6263387">0</span>&nbsp;<span class="op" id="6263389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6263395">continue</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6263407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6263412">f</span><span class="op" id="6263413">.</span><span class="ident" id="6263414">ByteOrder</span><span class="op" id="6263423">.</span><span class="ident" id="6263424">PutUint32</span><span class="op" id="6263433">(</span><span class="ident" id="6263434">dst</span><span class="op" id="6263437">[</span><span class="ident" id="6263438">rela</span><span class="op" id="6263442">.</span><span class="ident" id="6263443">Off</span><span class="op" id="6263446">:</span><span class="ident" id="6263447">rela</span><span class="op" id="6263451">.</span><span class="ident" id="6263452">Off</span><span class="op" id="6263455">+</span><span class="num" id="6263456">4</span><span class="op" id="6263457">]</span><span class="op" id="6263458">,</span>&nbsp;<span class="builtintype" id="6263460">uint32</span><span class="op" id="6263466">(</span><span class="ident" id="6263467">rela</span><span class="op" id="6263471">.</span><span class="ident" id="6263472">Addend</span><span class="op" id="6263478">)</span><span class="op" id="6263479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6263483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6263486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6263490">return</span>&nbsp;<span class="builtintype" id="6263497">nil</span><br>
<span class="lineno"></span><span class="op" id="6263501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6263504">func</span>&nbsp;<span class="op" id="6263509">(</span><span class="ident" id="6263510">f</span>&nbsp;<span class="op" id="6263512">*</span><span class="ident" id="6263513">File</span><span class="op" id="6263517">)</span>&nbsp;<span class="ident" id="6263519">applyRelocations386</span><span class="op" id="6263538">(</span><span class="ident" id="6263539">dst</span>&nbsp;<span class="op" id="6263543">[</span><span class="op" id="6263544">]</span><span class="builtintype" id="6263545">byte</span><span class="op" id="6263549">,</span>&nbsp;<span class="ident" id="6263551">rels</span>&nbsp;<span class="op" id="6263556">[</span><span class="op" id="6263557">]</span><span class="builtintype" id="6263558">byte</span><span class="op" id="6263562">)</span>&nbsp;<span class="builtintype" id="6263564">error</span>&nbsp;<span class="op" id="6263570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6263573">//&nbsp;8&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rel32.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6263601">if</span>&nbsp;<span class="builtinfunc" id="6263604">len</span><span class="op" id="6263607">(</span><span class="ident" id="6263608">rels</span><span class="op" id="6263612">)</span><span class="op" id="6263613">%</span><span class="num" id="6263614">8</span>&nbsp;<span class="op" id="6263616">!=</span>&nbsp;<span class="num" id="6263619">0</span>&nbsp;<span class="op" id="6263621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6263625">return</span>&nbsp;<span class="ident" id="6263632">errors</span><span class="op" id="6263638">.</span><span class="ident" id="6263639">New</span><span class="op" id="6263642">(</span><span class="string" id="6263643">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&#34;</span><span class="op" id="6263696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6263699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6263703">symbols</span><span class="op" id="6263710">,</span>&nbsp;<span class="ident" id="6263712">_</span><span class="op" id="6263713">,</span>&nbsp;<span class="ident" id="6263715">err</span>&nbsp;<span class="op" id="6263719">:=</span>&nbsp;<span class="ident" id="6263722">f</span><span class="op" id="6263723">.</span><span class="ident" id="6263724">getSymbols</span><span class="op" id="6263734">(</span><span class="ident" id="6263735">SHT_SYMTAB</span><span class="op" id="6263745">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6263748">if</span>&nbsp;<span class="ident" id="6263751">err</span>&nbsp;<span class="op" id="6263755">!=</span>&nbsp;<span class="builtintype" id="6263758">nil</span>&nbsp;<span class="op" id="6263762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6263766">return</span>&nbsp;<span class="ident" id="6263773">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6263778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6263782">b</span>&nbsp;<span class="op" id="6263784">:=</span>&nbsp;<span class="ident" id="6263787">bytes</span><span class="op" id="6263792">.</span><span class="ident" id="6263793">NewReader</span><span class="op" id="6263802">(</span><span class="ident" id="6263803">rels</span><span class="op" id="6263807">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6263810">var</span>&nbsp;<span class="ident" id="6263814">rel</span>&nbsp;<span class="ident" id="6263818">Rel32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6263826">for</span>&nbsp;<span class="ident" id="6263830">b</span><span class="op" id="6263831">.</span><span class="ident" id="6263832">Len</span><span class="op" id="6263835">(</span><span class="op" id="6263836">)</span>&nbsp;<span class="op" id="6263838">&gt;</span>&nbsp;<span class="num" id="6263840">0</span>&nbsp;<span class="op" id="6263842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6263846">binary</span><span class="op" id="6263852">.</span><span class="ident" id="6263853">Read</span><span class="op" id="6263857">(</span><span class="ident" id="6263858">b</span><span class="op" id="6263859">,</span>&nbsp;<span class="ident" id="6263861">f</span><span class="op" id="6263862">.</span><span class="ident" id="6263863">ByteOrder</span><span class="op" id="6263872">,</span>&nbsp;<span class="op" id="6263874">&amp;</span><span class="ident" id="6263875">rel</span><span class="op" id="6263878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6263882">symNo</span>&nbsp;<span class="op" id="6263888">:=</span>&nbsp;<span class="ident" id="6263891">rel</span><span class="op" id="6263894">.</span><span class="ident" id="6263895">Info</span>&nbsp;<span class="op" id="6263900">&gt;&gt;</span>&nbsp;<span class="num" id="6263903">8</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6263907">t</span>&nbsp;<span class="op" id="6263909">:=</span>&nbsp;<span class="ident" id="6263912">R_386</span><span class="op" id="6263917">(</span><span class="ident" id="6263918">rel</span><span class="op" id="6263921">.</span><span class="ident" id="6263922">Info</span>&nbsp;<span class="op" id="6263927">&amp;</span>&nbsp;<span class="num" id="6263929">0xff</span><span class="op" id="6263933">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6263938">if</span>&nbsp;<span class="ident" id="6263941">symNo</span>&nbsp;<span class="op" id="6263947">==</span>&nbsp;<span class="num" id="6263950">0</span>&nbsp;<span class="op" id="6263952">||</span>&nbsp;<span class="ident" id="6263955">symNo</span>&nbsp;<span class="op" id="6263961">&gt;</span>&nbsp;<span class="builtintype" id="6263963">uint32</span><span class="op" id="6263969">(</span><span class="builtinfunc" id="6263970">len</span><span class="op" id="6263973">(</span><span class="ident" id="6263974">symbols</span><span class="op" id="6263981">)</span><span class="op" id="6263982">)</span>&nbsp;<span class="op" id="6263984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6263989">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6264000">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6264004">sym</span>&nbsp;<span class="op" id="6264008">:=</span>&nbsp;<span class="op" id="6264011">&amp;</span><span class="ident" id="6264012">symbols</span><span class="op" id="6264019">[</span><span class="ident" id="6264020">symNo</span><span class="op" id="6264025">-</span><span class="num" id="6264026">1</span><span class="op" id="6264027">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6264032">if</span>&nbsp;<span class="ident" id="6264035">t</span>&nbsp;<span class="op" id="6264037">==</span>&nbsp;<span class="ident" id="6264040">R_386_32</span>&nbsp;<span class="op" id="6264049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6264054">if</span>&nbsp;<span class="ident" id="6264057">rel</span><span class="op" id="6264060">.</span><span class="ident" id="6264061">Off</span><span class="op" id="6264064">+</span><span class="num" id="6264065">4</span>&nbsp;<span class="op" id="6264067">&gt;=</span>&nbsp;<span class="builtintype" id="6264070">uint32</span><span class="op" id="6264076">(</span><span class="builtinfunc" id="6264077">len</span><span class="op" id="6264080">(</span><span class="ident" id="6264081">dst</span><span class="op" id="6264084">)</span><span class="op" id="6264085">)</span>&nbsp;<span class="op" id="6264087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6264093">continue</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6264105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6264110">val</span>&nbsp;<span class="op" id="6264114">:=</span>&nbsp;<span class="ident" id="6264117">f</span><span class="op" id="6264118">.</span><span class="ident" id="6264119">ByteOrder</span><span class="op" id="6264128">.</span><span class="ident" id="6264129">Uint32</span><span class="op" id="6264135">(</span><span class="ident" id="6264136">dst</span><span class="op" id="6264139">[</span><span class="ident" id="6264140">rel</span><span class="op" id="6264143">.</span><span class="ident" id="6264144">Off</span>&nbsp;<span class="op" id="6264148">:</span>&nbsp;<span class="ident" id="6264150">rel</span><span class="op" id="6264153">.</span><span class="ident" id="6264154">Off</span><span class="op" id="6264157">+</span><span class="num" id="6264158">4</span><span class="op" id="6264159">]</span><span class="op" id="6264160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6264165">val</span>&nbsp;<span class="op" id="6264169">+=</span>&nbsp;<span class="builtintype" id="6264172">uint32</span><span class="op" id="6264178">(</span><span class="ident" id="6264179">sym</span><span class="op" id="6264182">.</span><span class="ident" id="6264183">Value</span><span class="op" id="6264188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6264193">f</span><span class="op" id="6264194">.</span><span class="ident" id="6264195">ByteOrder</span><span class="op" id="6264204">.</span><span class="ident" id="6264205">PutUint32</span><span class="op" id="6264214">(</span><span class="ident" id="6264215">dst</span><span class="op" id="6264218">[</span><span class="ident" id="6264219">rel</span><span class="op" id="6264222">.</span><span class="ident" id="6264223">Off</span><span class="op" id="6264226">:</span><span class="ident" id="6264227">rel</span><span class="op" id="6264230">.</span><span class="ident" id="6264231">Off</span><span class="op" id="6264234">+</span><span class="num" id="6264235">4</span><span class="op" id="6264236">]</span><span class="op" id="6264237">,</span>&nbsp;<span class="ident" id="6264239">val</span><span class="op" id="6264242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6264246">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6264249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6264253">return</span>&nbsp;<span class="builtintype" id="6264260">nil</span><br>
<span class="lineno"></span><span class="op" id="6264264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="keyword" id="6264267">func</span>&nbsp;<span class="op" id="6264272">(</span><span class="ident" id="6264273">f</span>&nbsp;<span class="op" id="6264275">*</span><span class="ident" id="6264276">File</span><span class="op" id="6264280">)</span>&nbsp;<span class="ident" id="6264282">applyRelocationsARM64</span><span class="op" id="6264303">(</span><span class="ident" id="6264304">dst</span>&nbsp;<span class="op" id="6264308">[</span><span class="op" id="6264309">]</span><span class="builtintype" id="6264310">byte</span><span class="op" id="6264314">,</span>&nbsp;<span class="ident" id="6264316">rels</span>&nbsp;<span class="op" id="6264321">[</span><span class="op" id="6264322">]</span><span class="builtintype" id="6264323">byte</span><span class="op" id="6264327">)</span>&nbsp;<span class="builtintype" id="6264329">error</span>&nbsp;<span class="op" id="6264335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6264338">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6264368">if</span>&nbsp;<span class="builtinfunc" id="6264371">len</span><span class="op" id="6264374">(</span><span class="ident" id="6264375">rels</span><span class="op" id="6264379">)</span><span class="op" id="6264380">%</span><span class="num" id="6264381">24</span>&nbsp;<span class="op" id="6264384">!=</span>&nbsp;<span class="num" id="6264387">0</span>&nbsp;<span class="op" id="6264389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6264393">return</span>&nbsp;<span class="ident" id="6264400">errors</span><span class="op" id="6264406">.</span><span class="ident" id="6264407">New</span><span class="op" id="6264410">(</span><span class="string" id="6264411">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="6264465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6264468">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6264472">symbols</span><span class="op" id="6264479">,</span>&nbsp;<span class="ident" id="6264481">_</span><span class="op" id="6264482">,</span>&nbsp;<span class="ident" id="6264484">err</span>&nbsp;<span class="op" id="6264488">:=</span>&nbsp;<span class="ident" id="6264491">f</span><span class="op" id="6264492">.</span><span class="ident" id="6264493">getSymbols</span><span class="op" id="6264503">(</span><span class="ident" id="6264504">SHT_SYMTAB</span><span class="op" id="6264514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6264517">if</span>&nbsp;<span class="ident" id="6264520">err</span>&nbsp;<span class="op" id="6264524">!=</span>&nbsp;<span class="builtintype" id="6264527">nil</span>&nbsp;<span class="op" id="6264531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6264535">return</span>&nbsp;<span class="ident" id="6264542">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6264547">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6264551">b</span>&nbsp;<span class="op" id="6264553">:=</span>&nbsp;<span class="ident" id="6264556">bytes</span><span class="op" id="6264561">.</span><span class="ident" id="6264562">NewReader</span><span class="op" id="6264571">(</span><span class="ident" id="6264572">rels</span><span class="op" id="6264576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6264579">var</span>&nbsp;<span class="ident" id="6264583">rela</span>&nbsp;<span class="ident" id="6264588">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6264597">for</span>&nbsp;<span class="ident" id="6264601">b</span><span class="op" id="6264602">.</span><span class="ident" id="6264603">Len</span><span class="op" id="6264606">(</span><span class="op" id="6264607">)</span>&nbsp;<span class="op" id="6264609">&gt;</span>&nbsp;<span class="num" id="6264611">0</span>&nbsp;<span class="op" id="6264613">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6264617">binary</span><span class="op" id="6264623">.</span><span class="ident" id="6264624">Read</span><span class="op" id="6264628">(</span><span class="ident" id="6264629">b</span><span class="op" id="6264630">,</span>&nbsp;<span class="ident" id="6264632">f</span><span class="op" id="6264633">.</span><span class="ident" id="6264634">ByteOrder</span><span class="op" id="6264643">,</span>&nbsp;<span class="op" id="6264645">&amp;</span><span class="ident" id="6264646">rela</span><span class="op" id="6264650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6264654">symNo</span>&nbsp;<span class="op" id="6264660">:=</span>&nbsp;<span class="ident" id="6264663">rela</span><span class="op" id="6264667">.</span><span class="ident" id="6264668">Info</span>&nbsp;<span class="op" id="6264673">&gt;&gt;</span>&nbsp;<span class="num" id="6264676">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6264681">t</span>&nbsp;<span class="op" id="6264683">:=</span>&nbsp;<span class="ident" id="6264686">R_AARCH64</span><span class="op" id="6264695">(</span><span class="ident" id="6264696">rela</span><span class="op" id="6264700">.</span><span class="ident" id="6264701">Info</span>&nbsp;<span class="op" id="6264706">&amp;</span>&nbsp;<span class="num" id="6264708">0xffff</span><span class="op" id="6264714">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6264719">if</span>&nbsp;<span class="ident" id="6264722">symNo</span>&nbsp;<span class="op" id="6264728">==</span>&nbsp;<span class="num" id="6264731">0</span>&nbsp;<span class="op" id="6264733">||</span>&nbsp;<span class="ident" id="6264736">symNo</span>&nbsp;<span class="op" id="6264742">&gt;</span>&nbsp;<span class="ident" id="6264744">uint64</span><span class="op" id="6264750">(</span><span class="builtinfunc" id="6264751">len</span><span class="op" id="6264754">(</span><span class="ident" id="6264755">symbols</span><span class="op" id="6264762">)</span><span class="op" id="6264763">)</span>&nbsp;<span class="op" id="6264765">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6264770">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6264781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6264785">sym</span>&nbsp;<span class="op" id="6264789">:=</span>&nbsp;<span class="op" id="6264792">&amp;</span><span class="ident" id="6264793">symbols</span><span class="op" id="6264800">[</span><span class="ident" id="6264801">symNo</span><span class="op" id="6264806">-</span><span class="num" id="6264807">1</span><span class="op" id="6264808">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6264812">if</span>&nbsp;<span class="ident" id="6264815">SymType</span><span class="op" id="6264822">(</span><span class="ident" id="6264823">sym</span><span class="op" id="6264826">.</span><span class="ident" id="6264827">Info</span><span class="op" id="6264831">&amp;</span><span class="num" id="6264832">0xf</span><span class="op" id="6264835">)</span>&nbsp;<span class="op" id="6264837">!=</span>&nbsp;<span class="ident" id="6264840">STT_SECTION</span>&nbsp;<span class="op" id="6264852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6264857">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6264912">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6264923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6264928">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6264981">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6265036">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6265083">switch</span>&nbsp;<span class="ident" id="6265090">t</span>&nbsp;<span class="op" id="6265092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6265096">case</span>&nbsp;<span class="ident" id="6265101">R_AARCH64_ABS64</span><span class="op" id="6265116">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6265121">if</span>&nbsp;<span class="ident" id="6265124">rela</span><span class="op" id="6265128">.</span><span class="ident" id="6265129">Off</span><span class="op" id="6265132">+</span><span class="num" id="6265133">8</span>&nbsp;<span class="op" id="6265135">&gt;=</span>&nbsp;<span class="ident" id="6265138">uint64</span><span class="op" id="6265144">(</span><span class="builtinfunc" id="6265145">len</span><span class="op" id="6265148">(</span><span class="ident" id="6265149">dst</span><span class="op" id="6265152">)</span><span class="op" id="6265153">)</span>&nbsp;<span class="op" id="6265155">||</span>&nbsp;<span class="ident" id="6265158">rela</span><span class="op" id="6265162">.</span><span class="ident" id="6265163">Addend</span>&nbsp;<span class="op" id="6265170">&lt;</span>&nbsp;<span class="num" id="6265172">0</span>&nbsp;<span class="op" id="6265174">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6265180">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6265192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6265197">f</span><span class="op" id="6265198">.</span><span class="ident" id="6265199">ByteOrder</span><span class="op" id="6265208">.</span><span class="ident" id="6265209">PutUint64</span><span class="op" id="6265218">(</span><span class="ident" id="6265219">dst</span><span class="op" id="6265222">[</span><span class="ident" id="6265223">rela</span><span class="op" id="6265227">.</span><span class="ident" id="6265228">Off</span><span class="op" id="6265231">:</span><span class="ident" id="6265232">rela</span><span class="op" id="6265236">.</span><span class="ident" id="6265237">Off</span><span class="op" id="6265240">+</span><span class="num" id="6265241">8</span><span class="op" id="6265242">]</span><span class="op" id="6265243">,</span>&nbsp;<span class="ident" id="6265245">uint64</span><span class="op" id="6265251">(</span><span class="ident" id="6265252">rela</span><span class="op" id="6265256">.</span><span class="ident" id="6265257">Addend</span><span class="op" id="6265263">)</span><span class="op" id="6265264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6265268">case</span>&nbsp;<span class="ident" id="6265273">R_AARCH64_ABS32</span><span class="op" id="6265288">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6265293">if</span>&nbsp;<span class="ident" id="6265296">rela</span><span class="op" id="6265300">.</span><span class="ident" id="6265301">Off</span><span class="op" id="6265304">+</span><span class="num" id="6265305">4</span>&nbsp;<span class="op" id="6265307">&gt;=</span>&nbsp;<span class="ident" id="6265310">uint64</span><span class="op" id="6265316">(</span><span class="builtinfunc" id="6265317">len</span><span class="op" id="6265320">(</span><span class="ident" id="6265321">dst</span><span class="op" id="6265324">)</span><span class="op" id="6265325">)</span>&nbsp;<span class="op" id="6265327">||</span>&nbsp;<span class="ident" id="6265330">rela</span><span class="op" id="6265334">.</span><span class="ident" id="6265335">Addend</span>&nbsp;<span class="op" id="6265342">&lt;</span>&nbsp;<span class="num" id="6265344">0</span>&nbsp;<span class="op" id="6265346">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6265352">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6265364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6265369">f</span><span class="op" id="6265370">.</span><span class="ident" id="6265371">ByteOrder</span><span class="op" id="6265380">.</span><span class="ident" id="6265381">PutUint32</span><span class="op" id="6265390">(</span><span class="ident" id="6265391">dst</span><span class="op" id="6265394">[</span><span class="ident" id="6265395">rela</span><span class="op" id="6265399">.</span><span class="ident" id="6265400">Off</span><span class="op" id="6265403">:</span><span class="ident" id="6265404">rela</span><span class="op" id="6265408">.</span><span class="ident" id="6265409">Off</span><span class="op" id="6265412">+</span><span class="num" id="6265413">4</span><span class="op" id="6265414">]</span><span class="op" id="6265415">,</span>&nbsp;<span class="builtintype" id="6265417">uint32</span><span class="op" id="6265423">(</span><span class="ident" id="6265424">rela</span><span class="op" id="6265428">.</span><span class="ident" id="6265429">Addend</span><span class="op" id="6265435">)</span><span class="op" id="6265436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6265440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6265443">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6265447">return</span>&nbsp;<span class="builtintype" id="6265454">nil</span><br>
<span class="lineno"></span><span class="op" id="6265458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6265461">func</span>&nbsp;<span class="op" id="6265466">(</span><span class="ident" id="6265467">f</span>&nbsp;<span class="op" id="6265469">*</span><span class="ident" id="6265470">File</span><span class="op" id="6265474">)</span>&nbsp;<span class="ident" id="6265476">DWARF</span><span class="op" id="6265481">(</span><span class="op" id="6265482">)</span>&nbsp;<span class="op" id="6265484">(</span><span class="op" id="6265485">*</span><span class="ident" id="6265486">dwarf</span><span class="op" id="6265491">.</span><span class="ident" id="6265492">Data</span><span class="op" id="6265496">,</span>&nbsp;<span class="builtintype" id="6265498">error</span><span class="op" id="6265503">)</span>&nbsp;<span class="op" id="6265505">{</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6265508">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6265559">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6265614">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6265673">var</span>&nbsp;<span class="ident" id="6265677">names</span>&nbsp;<span class="op" id="6265683">=</span>&nbsp;<span class="op" id="6265685">[</span><span class="op" id="6265686">...</span><span class="op" id="6265689">]</span><span class="builtintype" id="6265690">string</span><span class="op" id="6265696">{</span><span class="string" id="6265697">&#34;abbrev&#34;</span><span class="op" id="6265705">,</span>&nbsp;<span class="string" id="6265707">&#34;info&#34;</span><span class="op" id="6265713">,</span>&nbsp;<span class="string" id="6265715">&#34;str&#34;</span><span class="op" id="6265720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6265723">var</span>&nbsp;<span class="ident" id="6265727">dat</span>&nbsp;<span class="op" id="6265731">[</span><span class="builtinfunc" id="6265732">len</span><span class="op" id="6265735">(</span><span class="ident" id="6265736">names</span><span class="op" id="6265741">)</span><span class="op" id="6265742">]</span><span class="op" id="6265743">[</span><span class="op" id="6265744">]</span><span class="builtintype" id="6265745">byte</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6265751">for</span>&nbsp;<span class="ident" id="6265755">i</span><span class="op" id="6265756">,</span>&nbsp;<span class="ident" id="6265758">name</span>&nbsp;<span class="op" id="6265763">:=</span>&nbsp;<span class="keyword" id="6265766">range</span>&nbsp;<span class="ident" id="6265772">names</span>&nbsp;<span class="op" id="6265778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6265782">name</span>&nbsp;<span class="op" id="6265787">=</span>&nbsp;<span class="string" id="6265789">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="6265799">+</span>&nbsp;<span class="ident" id="6265801">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6265808">s</span>&nbsp;<span class="op" id="6265810">:=</span>&nbsp;<span class="ident" id="6265813">f</span><span class="op" id="6265814">.</span><span class="ident" id="6265815">Section</span><span class="op" id="6265822">(</span><span class="ident" id="6265823">name</span><span class="op" id="6265827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6265831">if</span>&nbsp;<span class="ident" id="6265834">s</span>&nbsp;<span class="op" id="6265836">==</span>&nbsp;<span class="builtintype" id="6265839">nil</span>&nbsp;<span class="op" id="6265843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6265848">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6265859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6265863">b</span><span class="op" id="6265864">,</span>&nbsp;<span class="ident" id="6265866">err</span>&nbsp;<span class="op" id="6265870">:=</span>&nbsp;<span class="ident" id="6265873">s</span><span class="op" id="6265874">.</span><span class="ident" id="6265875">Data</span><span class="op" id="6265879">(</span><span class="op" id="6265880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6265884">if</span>&nbsp;<span class="ident" id="6265887">err</span>&nbsp;<span class="op" id="6265891">!=</span>&nbsp;<span class="builtintype" id="6265894">nil</span>&nbsp;<span class="op" id="6265898">&amp;&amp;</span>&nbsp;<span class="ident" id="6265901">uint64</span><span class="op" id="6265907">(</span><span class="builtinfunc" id="6265908">len</span><span class="op" id="6265911">(</span><span class="ident" id="6265912">b</span><span class="op" id="6265913">)</span><span class="op" id="6265914">)</span>&nbsp;<span class="op" id="6265916">&lt;</span>&nbsp;<span class="ident" id="6265918">s</span><span class="op" id="6265919">.</span><span class="ident" id="6265920">Size</span>&nbsp;<span class="op" id="6265925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6265930">return</span>&nbsp;<span class="builtintype" id="6265937">nil</span><span class="op" id="6265940">,</span>&nbsp;<span class="ident" id="6265942">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6265948">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6265952">dat</span><span class="op" id="6265955">[</span><span class="ident" id="6265956">i</span><span class="op" id="6265957">]</span>&nbsp;<span class="op" id="6265959">=</span>&nbsp;<span class="ident" id="6265961">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6265964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6265968">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;relocation&nbsp;table&nbsp;for&nbsp;.debug_info,&nbsp;we&nbsp;have&nbsp;to&nbsp;process&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6266041">//&nbsp;now&nbsp;otherwise&nbsp;the&nbsp;data&nbsp;in&nbsp;.debug_info&nbsp;is&nbsp;invalid&nbsp;for&nbsp;x86-64&nbsp;objects.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6266114">rela</span>&nbsp;<span class="op" id="6266119">:=</span>&nbsp;<span class="ident" id="6266122">f</span><span class="op" id="6266123">.</span><span class="ident" id="6266124">Section</span><span class="op" id="6266131">(</span><span class="string" id="6266132">&#34;.rela.debug_info&#34;</span><span class="op" id="6266150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6266153">if</span>&nbsp;<span class="ident" id="6266156">rela</span>&nbsp;<span class="op" id="6266161">!=</span>&nbsp;<span class="builtintype" id="6266164">nil</span>&nbsp;<span class="op" id="6266168">&amp;&amp;</span>&nbsp;<span class="ident" id="6266171">rela</span><span class="op" id="6266175">.</span><span class="ident" id="6266176">Type</span>&nbsp;<span class="op" id="6266181">==</span>&nbsp;<span class="ident" id="6266184">SHT_RELA</span>&nbsp;<span class="op" id="6266193">&amp;&amp;</span>&nbsp;<span class="op" id="6266196">(</span><span class="ident" id="6266197">f</span><span class="op" id="6266198">.</span><span class="ident" id="6266199">Machine</span>&nbsp;<span class="op" id="6266207">==</span>&nbsp;<span class="ident" id="6266210">EM_X86_64</span>&nbsp;<span class="op" id="6266220">||</span>&nbsp;<span class="ident" id="6266223">f</span><span class="op" id="6266224">.</span><span class="ident" id="6266225">Machine</span>&nbsp;<span class="op" id="6266233">==</span>&nbsp;<span class="ident" id="6266236">EM_AARCH64</span><span class="op" id="6266246">)</span>&nbsp;<span class="op" id="6266248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6266252">data</span><span class="op" id="6266256">,</span>&nbsp;<span class="ident" id="6266258">err</span>&nbsp;<span class="op" id="6266262">:=</span>&nbsp;<span class="ident" id="6266265">rela</span><span class="op" id="6266269">.</span><span class="ident" id="6266270">Data</span><span class="op" id="6266274">(</span><span class="op" id="6266275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6266279">if</span>&nbsp;<span class="ident" id="6266282">err</span>&nbsp;<span class="op" id="6266286">!=</span>&nbsp;<span class="builtintype" id="6266289">nil</span>&nbsp;<span class="op" id="6266293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6266298">return</span>&nbsp;<span class="builtintype" id="6266305">nil</span><span class="op" id="6266308">,</span>&nbsp;<span class="ident" id="6266310">err</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6266316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6266320">err</span>&nbsp;<span class="op" id="6266324">=</span>&nbsp;<span class="ident" id="6266326">f</span><span class="op" id="6266327">.</span><span class="ident" id="6266328">applyRelocations</span><span class="op" id="6266344">(</span><span class="ident" id="6266345">dat</span><span class="op" id="6266348">[</span><span class="num" id="6266349">1</span><span class="op" id="6266350">]</span><span class="op" id="6266351">,</span>&nbsp;<span class="ident" id="6266353">data</span><span class="op" id="6266357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6266361">if</span>&nbsp;<span class="ident" id="6266364">err</span>&nbsp;<span class="op" id="6266368">!=</span>&nbsp;<span class="builtintype" id="6266371">nil</span>&nbsp;<span class="op" id="6266375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6266380">return</span>&nbsp;<span class="builtintype" id="6266387">nil</span><span class="op" id="6266390">,</span>&nbsp;<span class="ident" id="6266392">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6266398">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6266401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6266405">//&nbsp;When&nbsp;using&nbsp;clang&nbsp;we&nbsp;need&nbsp;to&nbsp;process&nbsp;relocations&nbsp;even&nbsp;for&nbsp;386.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6266471">rel</span>&nbsp;<span class="op" id="6266475">:=</span>&nbsp;<span class="ident" id="6266478">f</span><span class="op" id="6266479">.</span><span class="ident" id="6266480">Section</span><span class="op" id="6266487">(</span><span class="string" id="6266488">&#34;.rel.debug_info&#34;</span><span class="op" id="6266505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6266508">if</span>&nbsp;<span class="ident" id="6266511">rel</span>&nbsp;<span class="op" id="6266515">!=</span>&nbsp;<span class="builtintype" id="6266518">nil</span>&nbsp;<span class="op" id="6266522">&amp;&amp;</span>&nbsp;<span class="ident" id="6266525">rel</span><span class="op" id="6266528">.</span><span class="ident" id="6266529">Type</span>&nbsp;<span class="op" id="6266534">==</span>&nbsp;<span class="ident" id="6266537">SHT_REL</span>&nbsp;<span class="op" id="6266545">&amp;&amp;</span>&nbsp;<span class="ident" id="6266548">f</span><span class="op" id="6266549">.</span><span class="ident" id="6266550">Machine</span>&nbsp;<span class="op" id="6266558">==</span>&nbsp;<span class="ident" id="6266561">EM_386</span>&nbsp;<span class="op" id="6266568">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6266572">data</span><span class="op" id="6266576">,</span>&nbsp;<span class="ident" id="6266578">err</span>&nbsp;<span class="op" id="6266582">:=</span>&nbsp;<span class="ident" id="6266585">rel</span><span class="op" id="6266588">.</span><span class="ident" id="6266589">Data</span><span class="op" id="6266593">(</span><span class="op" id="6266594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6266598">if</span>&nbsp;<span class="ident" id="6266601">err</span>&nbsp;<span class="op" id="6266605">!=</span>&nbsp;<span class="builtintype" id="6266608">nil</span>&nbsp;<span class="op" id="6266612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6266617">return</span>&nbsp;<span class="builtintype" id="6266624">nil</span><span class="op" id="6266627">,</span>&nbsp;<span class="ident" id="6266629">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6266635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6266639">err</span>&nbsp;<span class="op" id="6266643">=</span>&nbsp;<span class="ident" id="6266645">f</span><span class="op" id="6266646">.</span><span class="ident" id="6266647">applyRelocations</span><span class="op" id="6266663">(</span><span class="ident" id="6266664">dat</span><span class="op" id="6266667">[</span><span class="num" id="6266668">1</span><span class="op" id="6266669">]</span><span class="op" id="6266670">,</span>&nbsp;<span class="ident" id="6266672">data</span><span class="op" id="6266676">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6266680">if</span>&nbsp;<span class="ident" id="6266683">err</span>&nbsp;<span class="op" id="6266687">!=</span>&nbsp;<span class="builtintype" id="6266690">nil</span>&nbsp;<span class="op" id="6266694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6266699">return</span>&nbsp;<span class="builtintype" id="6266706">nil</span><span class="op" id="6266709">,</span>&nbsp;<span class="ident" id="6266711">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6266717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6266720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6266724">abbrev</span><span class="op" id="6266730">,</span>&nbsp;<span class="ident" id="6266732">info</span><span class="op" id="6266736">,</span>&nbsp;<span class="ident" id="6266738">str</span>&nbsp;<span class="op" id="6266742">:=</span>&nbsp;<span class="ident" id="6266745">dat</span><span class="op" id="6266748">[</span><span class="num" id="6266749">0</span><span class="op" id="6266750">]</span><span class="op" id="6266751">,</span>&nbsp;<span class="ident" id="6266753">dat</span><span class="op" id="6266756">[</span><span class="num" id="6266757">1</span><span class="op" id="6266758">]</span><span class="op" id="6266759">,</span>&nbsp;<span class="ident" id="6266761">dat</span><span class="op" id="6266764">[</span><span class="num" id="6266765">2</span><span class="op" id="6266766">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6266769">d</span><span class="op" id="6266770">,</span>&nbsp;<span class="ident" id="6266772">err</span>&nbsp;<span class="op" id="6266776">:=</span>&nbsp;<span class="ident" id="6266779">dwarf</span><span class="op" id="6266784">.</span><span class="ident" id="6266785">New</span><span class="op" id="6266788">(</span><span class="ident" id="6266789">abbrev</span><span class="op" id="6266795">,</span>&nbsp;<span class="builtintype" id="6266797">nil</span><span class="op" id="6266800">,</span>&nbsp;<span class="builtintype" id="6266802">nil</span><span class="op" id="6266805">,</span>&nbsp;<span class="ident" id="6266807">info</span><span class="op" id="6266811">,</span>&nbsp;<span class="builtintype" id="6266813">nil</span><span class="op" id="6266816">,</span>&nbsp;<span class="builtintype" id="6266818">nil</span><span class="op" id="6266821">,</span>&nbsp;<span class="builtintype" id="6266823">nil</span><span class="op" id="6266826">,</span>&nbsp;<span class="ident" id="6266828">str</span><span class="op" id="6266831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6266834">if</span>&nbsp;<span class="ident" id="6266837">err</span>&nbsp;<span class="op" id="6266841">!=</span>&nbsp;<span class="builtintype" id="6266844">nil</span>&nbsp;<span class="op" id="6266848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6266852">return</span>&nbsp;<span class="builtintype" id="6266859">nil</span><span class="op" id="6266862">,</span>&nbsp;<span class="ident" id="6266864">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6266869">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6266873">//&nbsp;Look&nbsp;for&nbsp;DWARF4&nbsp;.debug_types&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6266916">for</span>&nbsp;<span class="ident" id="6266920">i</span><span class="op" id="6266921">,</span>&nbsp;<span class="ident" id="6266923">s</span>&nbsp;<span class="op" id="6266925">:=</span>&nbsp;<span class="keyword" id="6266928">range</span>&nbsp;<span class="ident" id="6266934">f</span><span class="op" id="6266935">.</span><span class="ident" id="6266936">Sections</span>&nbsp;<span class="op" id="6266945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6266949">if</span>&nbsp;<span class="ident" id="6266952">s</span><span class="op" id="6266953">.</span><span class="ident" id="6266954">Name</span>&nbsp;<span class="op" id="6266959">==</span>&nbsp;<span class="string" id="6266962">&#34;.debug_types&#34;</span>&nbsp;<span class="op" id="6266977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6266982">b</span><span class="op" id="6266983">,</span>&nbsp;<span class="ident" id="6266985">err</span>&nbsp;<span class="op" id="6266989">:=</span>&nbsp;<span class="ident" id="6266992">s</span><span class="op" id="6266993">.</span><span class="ident" id="6266994">Data</span><span class="op" id="6266998">(</span><span class="op" id="6266999">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6267004">if</span>&nbsp;<span class="ident" id="6267007">err</span>&nbsp;<span class="op" id="6267011">!=</span>&nbsp;<span class="builtintype" id="6267014">nil</span>&nbsp;<span class="op" id="6267018">&amp;&amp;</span>&nbsp;<span class="ident" id="6267021">uint64</span><span class="op" id="6267027">(</span><span class="builtinfunc" id="6267028">len</span><span class="op" id="6267031">(</span><span class="ident" id="6267032">b</span><span class="op" id="6267033">)</span><span class="op" id="6267034">)</span>&nbsp;<span class="op" id="6267036">&lt;</span>&nbsp;<span class="ident" id="6267038">s</span><span class="op" id="6267039">.</span><span class="ident" id="6267040">Size</span>&nbsp;<span class="op" id="6267045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6267051">return</span>&nbsp;<span class="builtintype" id="6267058">nil</span><span class="op" id="6267061">,</span>&nbsp;<span class="ident" id="6267063">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6267070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6267076">for</span>&nbsp;<span class="ident" id="6267080">_</span><span class="op" id="6267081">,</span>&nbsp;<span class="ident" id="6267083">r</span>&nbsp;<span class="op" id="6267085">:=</span>&nbsp;<span class="keyword" id="6267088">range</span>&nbsp;<span class="ident" id="6267094">f</span><span class="op" id="6267095">.</span><span class="ident" id="6267096">Sections</span>&nbsp;<span class="op" id="6267105">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6267111">if</span>&nbsp;<span class="ident" id="6267114">r</span><span class="op" id="6267115">.</span><span class="ident" id="6267116">Type</span>&nbsp;<span class="op" id="6267121">!=</span>&nbsp;<span class="ident" id="6267124">SHT_RELA</span>&nbsp;<span class="op" id="6267133">&amp;&amp;</span>&nbsp;<span class="ident" id="6267136">r</span><span class="op" id="6267137">.</span><span class="ident" id="6267138">Type</span>&nbsp;<span class="op" id="6267143">!=</span>&nbsp;<span class="ident" id="6267146">SHT_REL</span>&nbsp;<span class="op" id="6267154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6267161">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6267174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6267180">if</span>&nbsp;<span class="builtintype" id="6267183">int</span><span class="op" id="6267186">(</span><span class="ident" id="6267187">r</span><span class="op" id="6267188">.</span><span class="ident" id="6267189">Info</span><span class="op" id="6267193">)</span>&nbsp;<span class="op" id="6267195">!=</span>&nbsp;<span class="ident" id="6267198">i</span>&nbsp;<span class="op" id="6267200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6267207">continue</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6267220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6267226">rd</span><span class="op" id="6267228">,</span>&nbsp;<span class="ident" id="6267230">err</span>&nbsp;<span class="op" id="6267234">:=</span>&nbsp;<span class="ident" id="6267237">r</span><span class="op" id="6267238">.</span><span class="ident" id="6267239">Data</span><span class="op" id="6267243">(</span><span class="op" id="6267244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6267250">if</span>&nbsp;<span class="ident" id="6267253">err</span>&nbsp;<span class="op" id="6267257">!=</span>&nbsp;<span class="builtintype" id="6267260">nil</span>&nbsp;<span class="op" id="6267264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6267271">return</span>&nbsp;<span class="builtintype" id="6267278">nil</span><span class="op" id="6267281">,</span>&nbsp;<span class="ident" id="6267283">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6267291">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6267297">err</span>&nbsp;<span class="op" id="6267301">=</span>&nbsp;<span class="ident" id="6267303">f</span><span class="op" id="6267304">.</span><span class="ident" id="6267305">applyRelocations</span><span class="op" id="6267321">(</span><span class="ident" id="6267322">b</span><span class="op" id="6267323">,</span>&nbsp;<span class="ident" id="6267325">rd</span><span class="op" id="6267327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6267333">if</span>&nbsp;<span class="ident" id="6267336">err</span>&nbsp;<span class="op" id="6267340">!=</span>&nbsp;<span class="builtintype" id="6267343">nil</span>&nbsp;<span class="op" id="6267347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6267354">return</span>&nbsp;<span class="builtintype" id="6267361">nil</span><span class="op" id="6267364">,</span>&nbsp;<span class="ident" id="6267366">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6267374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6267379">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6267385">err</span>&nbsp;<span class="op" id="6267389">=</span>&nbsp;<span class="ident" id="6267391">d</span><span class="op" id="6267392">.</span><span class="ident" id="6267393">AddTypes</span><span class="op" id="6267401">(</span><span class="ident" id="6267402">fmt</span><span class="op" id="6267405">.</span><span class="ident" id="6267406">Sprintf</span><span class="op" id="6267413">(</span><span class="string" id="6267414">&#34;types-%d&#34;</span><span class="op" id="6267424">,</span>&nbsp;<span class="ident" id="6267426">i</span><span class="op" id="6267427">)</span><span class="op" id="6267428">,</span>&nbsp;<span class="ident" id="6267430">b</span><span class="op" id="6267431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6267436">if</span>&nbsp;<span class="ident" id="6267439">err</span>&nbsp;<span class="op" id="6267443">!=</span>&nbsp;<span class="builtintype" id="6267446">nil</span>&nbsp;<span class="op" id="6267450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6267456">return</span>&nbsp;<span class="builtintype" id="6267463">nil</span><span class="op" id="6267466">,</span>&nbsp;<span class="ident" id="6267468">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6267475">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6267479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6267482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6267486">return</span>&nbsp;<span class="ident" id="6267493">d</span><span class="op" id="6267494">,</span>&nbsp;<span class="builtintype" id="6267496">nil</span><br>
<span class="lineno"></span><span class="op" id="6267500">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="6267503">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="6267586">//&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="6267607">//</span><br>
<span class="lineno"></span><span class="comment" id="6267610">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Go&nbsp;1.0,&nbsp;Symbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno">765</span><span class="comment" id="6267686">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="6267760">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="6267806">func</span>&nbsp;<span class="op" id="6267811">(</span><span class="ident" id="6267812">f</span>&nbsp;<span class="op" id="6267814">*</span><span class="ident" id="6267815">File</span><span class="op" id="6267819">)</span>&nbsp;<span class="ident" id="6267821">Symbols</span><span class="op" id="6267828">(</span><span class="op" id="6267829">)</span>&nbsp;<span class="op" id="6267831">(</span><span class="op" id="6267832">[</span><span class="op" id="6267833">]</span><span class="ident" id="6267834">Symbol</span><span class="op" id="6267840">,</span>&nbsp;<span class="builtintype" id="6267842">error</span><span class="op" id="6267847">)</span>&nbsp;<span class="op" id="6267849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6267852">sym</span><span class="op" id="6267855">,</span>&nbsp;<span class="ident" id="6267857">_</span><span class="op" id="6267858">,</span>&nbsp;<span class="ident" id="6267860">err</span>&nbsp;<span class="op" id="6267864">:=</span>&nbsp;<span class="ident" id="6267867">f</span><span class="op" id="6267868">.</span><span class="ident" id="6267869">getSymbols</span><span class="op" id="6267879">(</span><span class="ident" id="6267880">SHT_SYMTAB</span><span class="op" id="6267890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6267893">return</span>&nbsp;<span class="ident" id="6267900">sym</span><span class="op" id="6267903">,</span>&nbsp;<span class="ident" id="6267905">err</span><br>
<span class="lineno">770</span><span class="op" id="6267909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6267912">//&nbsp;DynamicSymbols&nbsp;returns&nbsp;the&nbsp;dynamic&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="6267982">//&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="6268031">//</span><br>
<span class="lineno">775</span><span class="comment" id="6268034">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Symbols,&nbsp;DynamicSymbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="6268118">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="6268192">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="6268238">func</span>&nbsp;<span class="op" id="6268243">(</span><span class="ident" id="6268244">f</span>&nbsp;<span class="op" id="6268246">*</span><span class="ident" id="6268247">File</span><span class="op" id="6268251">)</span>&nbsp;<span class="ident" id="6268253">DynamicSymbols</span><span class="op" id="6268267">(</span><span class="op" id="6268268">)</span>&nbsp;<span class="op" id="6268270">(</span><span class="op" id="6268271">[</span><span class="op" id="6268272">]</span><span class="ident" id="6268273">Symbol</span><span class="op" id="6268279">,</span>&nbsp;<span class="builtintype" id="6268281">error</span><span class="op" id="6268286">)</span>&nbsp;<span class="op" id="6268288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6268291">sym</span><span class="op" id="6268294">,</span>&nbsp;<span class="ident" id="6268296">_</span><span class="op" id="6268297">,</span>&nbsp;<span class="ident" id="6268299">err</span>&nbsp;<span class="op" id="6268303">:=</span>&nbsp;<span class="ident" id="6268306">f</span><span class="op" id="6268307">.</span><span class="ident" id="6268308">getSymbols</span><span class="op" id="6268318">(</span><span class="ident" id="6268319">SHT_DYNSYM</span><span class="op" id="6268329">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6268332">return</span>&nbsp;<span class="ident" id="6268339">sym</span><span class="op" id="6268342">,</span>&nbsp;<span class="ident" id="6268344">err</span><br>
<span class="lineno"></span><span class="op" id="6268348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6268351">type</span>&nbsp;<span class="ident" id="6268356">ImportedSymbol</span>&nbsp;<span class="keyword" id="6268371">struct</span>&nbsp;<span class="op" id="6268378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6268381">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6268389">string</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6268397">Version</span>&nbsp;<span class="builtintype" id="6268405">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6268413">Library</span>&nbsp;<span class="builtintype" id="6268421">string</span><br>
<span class="lineno"></span><span class="op" id="6268428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6268431">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno">790</span><span class="comment" id="6268483">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6268538">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="6268592">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="6268628">func</span>&nbsp;<span class="op" id="6268633">(</span><span class="ident" id="6268634">f</span>&nbsp;<span class="op" id="6268636">*</span><span class="ident" id="6268637">File</span><span class="op" id="6268641">)</span>&nbsp;<span class="ident" id="6268643">ImportedSymbols</span><span class="op" id="6268658">(</span><span class="op" id="6268659">)</span>&nbsp;<span class="op" id="6268661">(</span><span class="op" id="6268662">[</span><span class="op" id="6268663">]</span><span class="ident" id="6268664">ImportedSymbol</span><span class="op" id="6268678">,</span>&nbsp;<span class="builtintype" id="6268680">error</span><span class="op" id="6268685">)</span>&nbsp;<span class="op" id="6268687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6268690">sym</span><span class="op" id="6268693">,</span>&nbsp;<span class="ident" id="6268695">str</span><span class="op" id="6268698">,</span>&nbsp;<span class="ident" id="6268700">err</span>&nbsp;<span class="op" id="6268704">:=</span>&nbsp;<span class="ident" id="6268707">f</span><span class="op" id="6268708">.</span><span class="ident" id="6268709">getSymbols</span><span class="op" id="6268719">(</span><span class="ident" id="6268720">SHT_DYNSYM</span><span class="op" id="6268730">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6268733">if</span>&nbsp;<span class="ident" id="6268736">err</span>&nbsp;<span class="op" id="6268740">!=</span>&nbsp;<span class="builtintype" id="6268743">nil</span>&nbsp;<span class="op" id="6268747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6268751">return</span>&nbsp;<span class="builtintype" id="6268758">nil</span><span class="op" id="6268761">,</span>&nbsp;<span class="ident" id="6268763">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6268768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6268771">f</span><span class="op" id="6268772">.</span><span class="ident" id="6268773">gnuVersionInit</span><span class="op" id="6268787">(</span><span class="ident" id="6268788">str</span><span class="op" id="6268791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6268794">var</span>&nbsp;<span class="ident" id="6268798">all</span>&nbsp;<span class="op" id="6268802">[</span><span class="op" id="6268803">]</span><span class="ident" id="6268804">ImportedSymbol</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6268820">for</span>&nbsp;<span class="ident" id="6268824">i</span><span class="op" id="6268825">,</span>&nbsp;<span class="ident" id="6268827">s</span>&nbsp;<span class="op" id="6268829">:=</span>&nbsp;<span class="keyword" id="6268832">range</span>&nbsp;<span class="ident" id="6268838">sym</span>&nbsp;<span class="op" id="6268842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6268846">if</span>&nbsp;<span class="ident" id="6268849">ST_BIND</span><span class="op" id="6268856">(</span><span class="ident" id="6268857">s</span><span class="op" id="6268858">.</span><span class="ident" id="6268859">Info</span><span class="op" id="6268863">)</span>&nbsp;<span class="op" id="6268865">==</span>&nbsp;<span class="ident" id="6268868">STB_GLOBAL</span>&nbsp;<span class="op" id="6268879">&amp;&amp;</span>&nbsp;<span class="ident" id="6268882">s</span><span class="op" id="6268883">.</span><span class="ident" id="6268884">Section</span>&nbsp;<span class="op" id="6268892">==</span>&nbsp;<span class="ident" id="6268895">SHN_UNDEF</span>&nbsp;<span class="op" id="6268905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6268910">all</span>&nbsp;<span class="op" id="6268914">=</span>&nbsp;<span class="builtinfunc" id="6268916">append</span><span class="op" id="6268922">(</span><span class="ident" id="6268923">all</span><span class="op" id="6268926">,</span>&nbsp;<span class="ident" id="6268928">ImportedSymbol</span><span class="op" id="6268942">{</span><span class="ident" id="6268943">Name</span><span class="op" id="6268947">:</span>&nbsp;<span class="ident" id="6268949">s</span><span class="op" id="6268950">.</span><span class="ident" id="6268951">Name</span><span class="op" id="6268955">}</span><span class="op" id="6268956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6268961">f</span><span class="op" id="6268962">.</span><span class="ident" id="6268963">gnuVersion</span><span class="op" id="6268973">(</span><span class="ident" id="6268974">i</span><span class="op" id="6268975">,</span>&nbsp;<span class="op" id="6268977">&amp;</span><span class="ident" id="6268978">all</span><span class="op" id="6268981">[</span><span class="builtinfunc" id="6268982">len</span><span class="op" id="6268985">(</span><span class="ident" id="6268986">all</span><span class="op" id="6268989">)</span><span class="op" id="6268990">-</span><span class="num" id="6268991">1</span><span class="op" id="6268992">]</span><span class="op" id="6268993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6268997">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6269000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6269003">return</span>&nbsp;<span class="ident" id="6269010">all</span><span class="op" id="6269013">,</span>&nbsp;<span class="builtintype" id="6269015">nil</span><br>
<span class="lineno"></span><span class="op" id="6269019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6269022">type</span>&nbsp;<span class="ident" id="6269027">verneed</span>&nbsp;<span class="keyword" id="6269035">struct</span>&nbsp;<span class="op" id="6269042">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6269045">File</span>&nbsp;<span class="builtintype" id="6269050">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6269058">Name</span>&nbsp;<span class="builtintype" id="6269063">string</span><br>
<span class="lineno"></span><span class="op" id="6269070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6269073">//&nbsp;gnuVersionInit&nbsp;parses&nbsp;the&nbsp;GNU&nbsp;version&nbsp;tables</span><br>
<span class="lineno">815</span><span class="comment" id="6269121">//&nbsp;for&nbsp;use&nbsp;by&nbsp;calls&nbsp;to&nbsp;gnuVersion.</span><br>
<span class="lineno"></span><span class="keyword" id="6269156">func</span>&nbsp;<span class="op" id="6269161">(</span><span class="ident" id="6269162">f</span>&nbsp;<span class="op" id="6269164">*</span><span class="ident" id="6269165">File</span><span class="op" id="6269169">)</span>&nbsp;<span class="ident" id="6269171">gnuVersionInit</span><span class="op" id="6269185">(</span><span class="ident" id="6269186">str</span>&nbsp;<span class="op" id="6269190">[</span><span class="op" id="6269191">]</span><span class="builtintype" id="6269192">byte</span><span class="op" id="6269196">)</span>&nbsp;<span class="op" id="6269198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6269201">//&nbsp;Accumulate&nbsp;verneed&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6269237">vn</span>&nbsp;<span class="op" id="6269240">:=</span>&nbsp;<span class="ident" id="6269243">f</span><span class="op" id="6269244">.</span><span class="ident" id="6269245">SectionByType</span><span class="op" id="6269258">(</span><span class="ident" id="6269259">SHT_GNU_VERNEED</span><span class="op" id="6269274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6269277">if</span>&nbsp;<span class="ident" id="6269280">vn</span>&nbsp;<span class="op" id="6269283">==</span>&nbsp;<span class="builtintype" id="6269286">nil</span>&nbsp;<span class="op" id="6269290">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6269294">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6269302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6269305">d</span><span class="op" id="6269306">,</span>&nbsp;<span class="ident" id="6269308">_</span>&nbsp;<span class="op" id="6269310">:=</span>&nbsp;<span class="ident" id="6269313">vn</span><span class="op" id="6269315">.</span><span class="ident" id="6269316">Data</span><span class="op" id="6269320">(</span><span class="op" id="6269321">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6269325">var</span>&nbsp;<span class="ident" id="6269329">need</span>&nbsp;<span class="op" id="6269334">[</span><span class="op" id="6269335">]</span><span class="ident" id="6269336">verneed</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6269345">i</span>&nbsp;<span class="op" id="6269347">:=</span>&nbsp;<span class="num" id="6269350">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6269353">for</span>&nbsp;<span class="op" id="6269357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6269361">if</span>&nbsp;<span class="ident" id="6269364">i</span><span class="op" id="6269365">+</span><span class="num" id="6269366">16</span>&nbsp;<span class="op" id="6269369">&gt;</span>&nbsp;<span class="builtinfunc" id="6269371">len</span><span class="op" id="6269374">(</span><span class="ident" id="6269375">d</span><span class="op" id="6269376">)</span>&nbsp;<span class="op" id="6269378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6269383">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6269391">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6269395">vers</span>&nbsp;<span class="op" id="6269400">:=</span>&nbsp;<span class="ident" id="6269403">f</span><span class="op" id="6269404">.</span><span class="ident" id="6269405">ByteOrder</span><span class="op" id="6269414">.</span><span class="ident" id="6269415">Uint16</span><span class="op" id="6269421">(</span><span class="ident" id="6269422">d</span><span class="op" id="6269423">[</span><span class="ident" id="6269424">i</span>&nbsp;<span class="op" id="6269426">:</span>&nbsp;<span class="ident" id="6269428">i</span><span class="op" id="6269429">+</span><span class="num" id="6269430">2</span><span class="op" id="6269431">]</span><span class="op" id="6269432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6269436">if</span>&nbsp;<span class="ident" id="6269439">vers</span>&nbsp;<span class="op" id="6269444">!=</span>&nbsp;<span class="num" id="6269447">1</span>&nbsp;<span class="op" id="6269449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6269454">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6269462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6269466">cnt</span>&nbsp;<span class="op" id="6269470">:=</span>&nbsp;<span class="ident" id="6269473">f</span><span class="op" id="6269474">.</span><span class="ident" id="6269475">ByteOrder</span><span class="op" id="6269484">.</span><span class="ident" id="6269485">Uint16</span><span class="op" id="6269491">(</span><span class="ident" id="6269492">d</span><span class="op" id="6269493">[</span><span class="ident" id="6269494">i</span><span class="op" id="6269495">+</span><span class="num" id="6269496">2</span>&nbsp;<span class="op" id="6269498">:</span>&nbsp;<span class="ident" id="6269500">i</span><span class="op" id="6269501">+</span><span class="num" id="6269502">4</span><span class="op" id="6269503">]</span><span class="op" id="6269504">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6269508">fileoff</span>&nbsp;<span class="op" id="6269516">:=</span>&nbsp;<span class="ident" id="6269519">f</span><span class="op" id="6269520">.</span><span class="ident" id="6269521">ByteOrder</span><span class="op" id="6269530">.</span><span class="ident" id="6269531">Uint32</span><span class="op" id="6269537">(</span><span class="ident" id="6269538">d</span><span class="op" id="6269539">[</span><span class="ident" id="6269540">i</span><span class="op" id="6269541">+</span><span class="num" id="6269542">4</span>&nbsp;<span class="op" id="6269544">:</span>&nbsp;<span class="ident" id="6269546">i</span><span class="op" id="6269547">+</span><span class="num" id="6269548">8</span><span class="op" id="6269549">]</span><span class="op" id="6269550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6269554">aux</span>&nbsp;<span class="op" id="6269558">:=</span>&nbsp;<span class="ident" id="6269561">f</span><span class="op" id="6269562">.</span><span class="ident" id="6269563">ByteOrder</span><span class="op" id="6269572">.</span><span class="ident" id="6269573">Uint32</span><span class="op" id="6269579">(</span><span class="ident" id="6269580">d</span><span class="op" id="6269581">[</span><span class="ident" id="6269582">i</span><span class="op" id="6269583">+</span><span class="num" id="6269584">8</span>&nbsp;<span class="op" id="6269586">:</span>&nbsp;<span class="ident" id="6269588">i</span><span class="op" id="6269589">+</span><span class="num" id="6269590">12</span><span class="op" id="6269592">]</span><span class="op" id="6269593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6269597">next</span>&nbsp;<span class="op" id="6269602">:=</span>&nbsp;<span class="ident" id="6269605">f</span><span class="op" id="6269606">.</span><span class="ident" id="6269607">ByteOrder</span><span class="op" id="6269616">.</span><span class="ident" id="6269617">Uint32</span><span class="op" id="6269623">(</span><span class="ident" id="6269624">d</span><span class="op" id="6269625">[</span><span class="ident" id="6269626">i</span><span class="op" id="6269627">+</span><span class="num" id="6269628">12</span>&nbsp;<span class="op" id="6269631">:</span>&nbsp;<span class="ident" id="6269633">i</span><span class="op" id="6269634">+</span><span class="num" id="6269635">16</span><span class="op" id="6269637">]</span><span class="op" id="6269638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6269642">file</span><span class="op" id="6269646">,</span>&nbsp;<span class="ident" id="6269648">_</span>&nbsp;<span class="op" id="6269650">:=</span>&nbsp;<span class="ident" id="6269653">getString</span><span class="op" id="6269662">(</span><span class="ident" id="6269663">str</span><span class="op" id="6269666">,</span>&nbsp;<span class="builtintype" id="6269668">int</span><span class="op" id="6269671">(</span><span class="ident" id="6269672">fileoff</span><span class="op" id="6269679">)</span><span class="op" id="6269680">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6269685">var</span>&nbsp;<span class="ident" id="6269689">name</span>&nbsp;<span class="builtintype" id="6269694">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6269703">j</span>&nbsp;<span class="op" id="6269705">:=</span>&nbsp;<span class="ident" id="6269708">i</span>&nbsp;<span class="op" id="6269710">+</span>&nbsp;<span class="builtintype" id="6269712">int</span><span class="op" id="6269715">(</span><span class="ident" id="6269716">aux</span><span class="op" id="6269719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6269723">for</span>&nbsp;<span class="ident" id="6269727">c</span>&nbsp;<span class="op" id="6269729">:=</span>&nbsp;<span class="num" id="6269732">0</span><span class="op" id="6269733">;</span>&nbsp;<span class="ident" id="6269735">c</span>&nbsp;<span class="op" id="6269737">&lt;</span>&nbsp;<span class="builtintype" id="6269739">int</span><span class="op" id="6269742">(</span><span class="ident" id="6269743">cnt</span><span class="op" id="6269746">)</span><span class="op" id="6269747">;</span>&nbsp;<span class="ident" id="6269749">c</span><span class="op" id="6269750">++</span>&nbsp;<span class="op" id="6269753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6269758">if</span>&nbsp;<span class="ident" id="6269761">j</span><span class="op" id="6269762">+</span><span class="num" id="6269763">16</span>&nbsp;<span class="op" id="6269766">&gt;</span>&nbsp;<span class="builtinfunc" id="6269768">len</span><span class="op" id="6269771">(</span><span class="ident" id="6269772">d</span><span class="op" id="6269773">)</span>&nbsp;<span class="op" id="6269775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6269781">break</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6269790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6269795">//&nbsp;hash&nbsp;:=&nbsp;f.ByteOrder.Uint32(d[j:j+4])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6269838">//&nbsp;flags&nbsp;:=&nbsp;f.ByteOrder.Uint16(d[j+4:j+6])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6269884">other</span>&nbsp;<span class="op" id="6269890">:=</span>&nbsp;<span class="ident" id="6269893">f</span><span class="op" id="6269894">.</span><span class="ident" id="6269895">ByteOrder</span><span class="op" id="6269904">.</span><span class="ident" id="6269905">Uint16</span><span class="op" id="6269911">(</span><span class="ident" id="6269912">d</span><span class="op" id="6269913">[</span><span class="ident" id="6269914">j</span><span class="op" id="6269915">+</span><span class="num" id="6269916">6</span>&nbsp;<span class="op" id="6269918">:</span>&nbsp;<span class="ident" id="6269920">j</span><span class="op" id="6269921">+</span><span class="num" id="6269922">8</span><span class="op" id="6269923">]</span><span class="op" id="6269924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6269929">nameoff</span>&nbsp;<span class="op" id="6269937">:=</span>&nbsp;<span class="ident" id="6269940">f</span><span class="op" id="6269941">.</span><span class="ident" id="6269942">ByteOrder</span><span class="op" id="6269951">.</span><span class="ident" id="6269952">Uint32</span><span class="op" id="6269958">(</span><span class="ident" id="6269959">d</span><span class="op" id="6269960">[</span><span class="ident" id="6269961">j</span><span class="op" id="6269962">+</span><span class="num" id="6269963">8</span>&nbsp;<span class="op" id="6269965">:</span>&nbsp;<span class="ident" id="6269967">j</span><span class="op" id="6269968">+</span><span class="num" id="6269969">12</span><span class="op" id="6269971">]</span><span class="op" id="6269972">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6269977">next</span>&nbsp;<span class="op" id="6269982">:=</span>&nbsp;<span class="ident" id="6269985">f</span><span class="op" id="6269986">.</span><span class="ident" id="6269987">ByteOrder</span><span class="op" id="6269996">.</span><span class="ident" id="6269997">Uint32</span><span class="op" id="6270003">(</span><span class="ident" id="6270004">d</span><span class="op" id="6270005">[</span><span class="ident" id="6270006">j</span><span class="op" id="6270007">+</span><span class="num" id="6270008">12</span>&nbsp;<span class="op" id="6270011">:</span>&nbsp;<span class="ident" id="6270013">j</span><span class="op" id="6270014">+</span><span class="num" id="6270015">16</span><span class="op" id="6270017">]</span><span class="op" id="6270018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270023">name</span><span class="op" id="6270027">,</span>&nbsp;<span class="ident" id="6270029">_</span>&nbsp;<span class="op" id="6270031">=</span>&nbsp;<span class="ident" id="6270033">getString</span><span class="op" id="6270042">(</span><span class="ident" id="6270043">str</span><span class="op" id="6270046">,</span>&nbsp;<span class="builtintype" id="6270048">int</span><span class="op" id="6270051">(</span><span class="ident" id="6270052">nameoff</span><span class="op" id="6270059">)</span><span class="op" id="6270060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270065">ndx</span>&nbsp;<span class="op" id="6270069">:=</span>&nbsp;<span class="builtintype" id="6270072">int</span><span class="op" id="6270075">(</span><span class="ident" id="6270076">other</span><span class="op" id="6270081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6270086">if</span>&nbsp;<span class="ident" id="6270089">ndx</span>&nbsp;<span class="op" id="6270093">&gt;=</span>&nbsp;<span class="builtinfunc" id="6270096">len</span><span class="op" id="6270099">(</span><span class="ident" id="6270100">need</span><span class="op" id="6270104">)</span>&nbsp;<span class="op" id="6270106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270112">a</span>&nbsp;<span class="op" id="6270114">:=</span>&nbsp;<span class="builtinfunc" id="6270117">make</span><span class="op" id="6270121">(</span><span class="op" id="6270122">[</span><span class="op" id="6270123">]</span><span class="ident" id="6270124">verneed</span><span class="op" id="6270131">,</span>&nbsp;<span class="num" id="6270133">2</span><span class="op" id="6270134">*</span><span class="op" id="6270135">(</span><span class="ident" id="6270136">ndx</span><span class="op" id="6270139">+</span><span class="num" id="6270140">1</span><span class="op" id="6270141">)</span><span class="op" id="6270142">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6270148">copy</span><span class="op" id="6270152">(</span><span class="ident" id="6270153">a</span><span class="op" id="6270154">,</span>&nbsp;<span class="ident" id="6270156">need</span><span class="op" id="6270160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270166">need</span>&nbsp;<span class="op" id="6270171">=</span>&nbsp;<span class="ident" id="6270173">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6270178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270184">need</span><span class="op" id="6270188">[</span><span class="ident" id="6270189">ndx</span><span class="op" id="6270192">]</span>&nbsp;<span class="op" id="6270194">=</span>&nbsp;<span class="ident" id="6270196">verneed</span><span class="op" id="6270203">{</span><span class="ident" id="6270204">file</span><span class="op" id="6270208">,</span>&nbsp;<span class="ident" id="6270210">name</span><span class="op" id="6270214">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6270219">if</span>&nbsp;<span class="ident" id="6270222">next</span>&nbsp;<span class="op" id="6270227">==</span>&nbsp;<span class="num" id="6270230">0</span>&nbsp;<span class="op" id="6270232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6270238">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6270247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270252">j</span>&nbsp;<span class="op" id="6270254">+=</span>&nbsp;<span class="builtintype" id="6270257">int</span><span class="op" id="6270260">(</span><span class="ident" id="6270261">next</span><span class="op" id="6270265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6270269">}</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6270274">if</span>&nbsp;<span class="ident" id="6270277">next</span>&nbsp;<span class="op" id="6270282">==</span>&nbsp;<span class="num" id="6270285">0</span>&nbsp;<span class="op" id="6270287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6270292">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6270300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270304">i</span>&nbsp;<span class="op" id="6270306">+=</span>&nbsp;<span class="builtintype" id="6270309">int</span><span class="op" id="6270312">(</span><span class="ident" id="6270313">next</span><span class="op" id="6270317">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6270320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6270324">//&nbsp;Versym&nbsp;parallels&nbsp;symbol&nbsp;table,&nbsp;indexing&nbsp;into&nbsp;verneed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270382">vs</span>&nbsp;<span class="op" id="6270385">:=</span>&nbsp;<span class="ident" id="6270388">f</span><span class="op" id="6270389">.</span><span class="ident" id="6270390">SectionByType</span><span class="op" id="6270403">(</span><span class="ident" id="6270404">SHT_GNU_VERSYM</span><span class="op" id="6270418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6270421">if</span>&nbsp;<span class="ident" id="6270424">vs</span>&nbsp;<span class="op" id="6270427">==</span>&nbsp;<span class="builtintype" id="6270430">nil</span>&nbsp;<span class="op" id="6270434">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6270438">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6270446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270449">d</span><span class="op" id="6270450">,</span>&nbsp;<span class="ident" id="6270452">_</span>&nbsp;<span class="op" id="6270454">=</span>&nbsp;<span class="ident" id="6270456">vs</span><span class="op" id="6270458">.</span><span class="ident" id="6270459">Data</span><span class="op" id="6270463">(</span><span class="op" id="6270464">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270468">f</span><span class="op" id="6270469">.</span><span class="ident" id="6270470">gnuNeed</span>&nbsp;<span class="op" id="6270478">=</span>&nbsp;<span class="ident" id="6270480">need</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270486">f</span><span class="op" id="6270487">.</span><span class="ident" id="6270488">gnuVersym</span>&nbsp;<span class="op" id="6270498">=</span>&nbsp;<span class="ident" id="6270500">d</span><br>
<span class="lineno"></span><span class="op" id="6270502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6270505">//&nbsp;gnuVersion&nbsp;adds&nbsp;Library&nbsp;and&nbsp;Version&nbsp;information&nbsp;to&nbsp;sym,</span><br>
<span class="lineno"></span><span class="comment" id="6270564">//&nbsp;which&nbsp;came&nbsp;from&nbsp;offset&nbsp;i&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">885</span><span class="keyword" id="6270613">func</span>&nbsp;<span class="op" id="6270618">(</span><span class="ident" id="6270619">f</span>&nbsp;<span class="op" id="6270621">*</span><span class="ident" id="6270622">File</span><span class="op" id="6270626">)</span>&nbsp;<span class="ident" id="6270628">gnuVersion</span><span class="op" id="6270638">(</span><span class="ident" id="6270639">i</span>&nbsp;<span class="builtintype" id="6270641">int</span><span class="op" id="6270644">,</span>&nbsp;<span class="ident" id="6270646">sym</span>&nbsp;<span class="op" id="6270650">*</span><span class="ident" id="6270651">ImportedSymbol</span><span class="op" id="6270665">)</span>&nbsp;<span class="op" id="6270667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6270670">//&nbsp;Each&nbsp;entry&nbsp;is&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270699">i</span>&nbsp;<span class="op" id="6270701">=</span>&nbsp;<span class="op" id="6270703">(</span><span class="ident" id="6270704">i</span>&nbsp;<span class="op" id="6270706">+</span>&nbsp;<span class="num" id="6270708">1</span><span class="op" id="6270709">)</span>&nbsp;<span class="op" id="6270711">*</span>&nbsp;<span class="num" id="6270713">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6270716">if</span>&nbsp;<span class="ident" id="6270719">i</span>&nbsp;<span class="op" id="6270721">&gt;=</span>&nbsp;<span class="builtinfunc" id="6270724">len</span><span class="op" id="6270727">(</span><span class="ident" id="6270728">f</span><span class="op" id="6270729">.</span><span class="ident" id="6270730">gnuVersym</span><span class="op" id="6270739">)</span>&nbsp;<span class="op" id="6270741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6270745">return</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6270753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270756">j</span>&nbsp;<span class="op" id="6270758">:=</span>&nbsp;<span class="builtintype" id="6270761">int</span><span class="op" id="6270764">(</span><span class="ident" id="6270765">f</span><span class="op" id="6270766">.</span><span class="ident" id="6270767">ByteOrder</span><span class="op" id="6270776">.</span><span class="ident" id="6270777">Uint16</span><span class="op" id="6270783">(</span><span class="ident" id="6270784">f</span><span class="op" id="6270785">.</span><span class="ident" id="6270786">gnuVersym</span><span class="op" id="6270795">[</span><span class="ident" id="6270796">i</span><span class="op" id="6270797">:</span><span class="op" id="6270798">]</span><span class="op" id="6270799">)</span><span class="op" id="6270800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6270803">if</span>&nbsp;<span class="ident" id="6270806">j</span>&nbsp;<span class="op" id="6270808">&lt;</span>&nbsp;<span class="num" id="6270810">2</span>&nbsp;<span class="op" id="6270812">||</span>&nbsp;<span class="ident" id="6270815">j</span>&nbsp;<span class="op" id="6270817">&gt;=</span>&nbsp;<span class="builtinfunc" id="6270820">len</span><span class="op" id="6270823">(</span><span class="ident" id="6270824">f</span><span class="op" id="6270825">.</span><span class="ident" id="6270826">gnuNeed</span><span class="op" id="6270833">)</span>&nbsp;<span class="op" id="6270835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6270839">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6270847">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270850">n</span>&nbsp;<span class="op" id="6270852">:=</span>&nbsp;<span class="op" id="6270855">&amp;</span><span class="ident" id="6270856">f</span><span class="op" id="6270857">.</span><span class="ident" id="6270858">gnuNeed</span><span class="op" id="6270865">[</span><span class="ident" id="6270866">j</span><span class="op" id="6270867">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270870">sym</span><span class="op" id="6270873">.</span><span class="ident" id="6270874">Library</span>&nbsp;<span class="op" id="6270882">=</span>&nbsp;<span class="ident" id="6270884">n</span><span class="op" id="6270885">.</span><span class="ident" id="6270886">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270892">sym</span><span class="op" id="6270895">.</span><span class="ident" id="6270896">Version</span>&nbsp;<span class="op" id="6270904">=</span>&nbsp;<span class="ident" id="6270906">n</span><span class="op" id="6270907">.</span><span class="ident" id="6270908">Name</span><br>
<span class="lineno"></span><span class="op" id="6270913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="6270916">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="6270972">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6271027">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="6271075">func</span>&nbsp;<span class="op" id="6271080">(</span><span class="ident" id="6271081">f</span>&nbsp;<span class="op" id="6271083">*</span><span class="ident" id="6271084">File</span><span class="op" id="6271088">)</span>&nbsp;<span class="ident" id="6271090">ImportedLibraries</span><span class="op" id="6271107">(</span><span class="op" id="6271108">)</span>&nbsp;<span class="op" id="6271110">(</span><span class="op" id="6271111">[</span><span class="op" id="6271112">]</span><span class="builtintype" id="6271113">string</span><span class="op" id="6271119">,</span>&nbsp;<span class="builtintype" id="6271121">error</span><span class="op" id="6271126">)</span>&nbsp;<span class="op" id="6271128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271131">return</span>&nbsp;<span class="ident" id="6271138">f</span><span class="op" id="6271139">.</span><span class="ident" id="6271140">DynString</span><span class="op" id="6271149">(</span><span class="ident" id="6271150">DT_NEEDED</span><span class="op" id="6271159">)</span><br>
<span class="lineno">905</span><span class="op" id="6271161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6271164">//&nbsp;DynString&nbsp;returns&nbsp;the&nbsp;strings&nbsp;listed&nbsp;for&nbsp;the&nbsp;given&nbsp;tag&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;dynamic</span><br>
<span class="lineno"></span><span class="comment" id="6271244">//&nbsp;section.</span><br>
<span class="lineno"></span><span class="comment" id="6271256">//</span><br>
<span class="lineno">910</span><span class="comment" id="6271259">//&nbsp;The&nbsp;tag&nbsp;must&nbsp;be&nbsp;one&nbsp;that&nbsp;takes&nbsp;string&nbsp;values:&nbsp;DT_NEEDED,&nbsp;DT_SONAME,&nbsp;DT_RPATH,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6271343">//&nbsp;DT_RUNPATH.</span><br>
<span class="lineno"></span><span class="keyword" id="6271358">func</span>&nbsp;<span class="op" id="6271363">(</span><span class="ident" id="6271364">f</span>&nbsp;<span class="op" id="6271366">*</span><span class="ident" id="6271367">File</span><span class="op" id="6271371">)</span>&nbsp;<span class="ident" id="6271373">DynString</span><span class="op" id="6271382">(</span><span class="ident" id="6271383">tag</span>&nbsp;<span class="ident" id="6271387">DynTag</span><span class="op" id="6271393">)</span>&nbsp;<span class="op" id="6271395">(</span><span class="op" id="6271396">[</span><span class="op" id="6271397">]</span><span class="builtintype" id="6271398">string</span><span class="op" id="6271404">,</span>&nbsp;<span class="builtintype" id="6271406">error</span><span class="op" id="6271411">)</span>&nbsp;<span class="op" id="6271413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271416">switch</span>&nbsp;<span class="ident" id="6271423">tag</span>&nbsp;<span class="op" id="6271427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271430">case</span>&nbsp;<span class="ident" id="6271435">DT_NEEDED</span><span class="op" id="6271444">,</span>&nbsp;<span class="ident" id="6271446">DT_SONAME</span><span class="op" id="6271455">,</span>&nbsp;<span class="ident" id="6271457">DT_RPATH</span><span class="op" id="6271465">,</span>&nbsp;<span class="ident" id="6271467">DT_RUNPATH</span><span class="op" id="6271477">:</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271480">default</span><span class="op" id="6271487">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271491">return</span>&nbsp;<span class="builtintype" id="6271498">nil</span><span class="op" id="6271501">,</span>&nbsp;<span class="ident" id="6271503">fmt</span><span class="op" id="6271506">.</span><span class="ident" id="6271507">Errorf</span><span class="op" id="6271513">(</span><span class="string" id="6271514">&#34;non-string-valued&nbsp;tag&nbsp;%v&#34;</span><span class="op" id="6271540">,</span>&nbsp;<span class="ident" id="6271542">tag</span><span class="op" id="6271545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6271548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6271551">ds</span>&nbsp;<span class="op" id="6271554">:=</span>&nbsp;<span class="ident" id="6271557">f</span><span class="op" id="6271558">.</span><span class="ident" id="6271559">SectionByType</span><span class="op" id="6271572">(</span><span class="ident" id="6271573">SHT_DYNAMIC</span><span class="op" id="6271584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271587">if</span>&nbsp;<span class="ident" id="6271590">ds</span>&nbsp;<span class="op" id="6271593">==</span>&nbsp;<span class="builtintype" id="6271596">nil</span>&nbsp;<span class="op" id="6271600">{</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6271604">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271638">return</span>&nbsp;<span class="builtintype" id="6271645">nil</span><span class="op" id="6271648">,</span>&nbsp;<span class="builtintype" id="6271650">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6271655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6271658">d</span><span class="op" id="6271659">,</span>&nbsp;<span class="ident" id="6271661">err</span>&nbsp;<span class="op" id="6271665">:=</span>&nbsp;<span class="ident" id="6271668">ds</span><span class="op" id="6271670">.</span><span class="ident" id="6271671">Data</span><span class="op" id="6271675">(</span><span class="op" id="6271676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271679">if</span>&nbsp;<span class="ident" id="6271682">err</span>&nbsp;<span class="op" id="6271686">!=</span>&nbsp;<span class="builtintype" id="6271689">nil</span>&nbsp;<span class="op" id="6271693">{</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271697">return</span>&nbsp;<span class="builtintype" id="6271704">nil</span><span class="op" id="6271707">,</span>&nbsp;<span class="ident" id="6271709">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6271714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6271717">str</span><span class="op" id="6271720">,</span>&nbsp;<span class="ident" id="6271722">err</span>&nbsp;<span class="op" id="6271726">:=</span>&nbsp;<span class="ident" id="6271729">f</span><span class="op" id="6271730">.</span><span class="ident" id="6271731">stringTable</span><span class="op" id="6271742">(</span><span class="ident" id="6271743">ds</span><span class="op" id="6271745">.</span><span class="ident" id="6271746">Link</span><span class="op" id="6271750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271753">if</span>&nbsp;<span class="ident" id="6271756">err</span>&nbsp;<span class="op" id="6271760">!=</span>&nbsp;<span class="builtintype" id="6271763">nil</span>&nbsp;<span class="op" id="6271767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271771">return</span>&nbsp;<span class="builtintype" id="6271778">nil</span><span class="op" id="6271781">,</span>&nbsp;<span class="ident" id="6271783">err</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6271788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271791">var</span>&nbsp;<span class="ident" id="6271795">all</span>&nbsp;<span class="op" id="6271799">[</span><span class="op" id="6271800">]</span><span class="builtintype" id="6271801">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271809">for</span>&nbsp;<span class="builtinfunc" id="6271813">len</span><span class="op" id="6271816">(</span><span class="ident" id="6271817">d</span><span class="op" id="6271818">)</span>&nbsp;<span class="op" id="6271820">&gt;</span>&nbsp;<span class="num" id="6271822">0</span>&nbsp;<span class="op" id="6271824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271828">var</span>&nbsp;<span class="ident" id="6271832">t</span>&nbsp;<span class="ident" id="6271834">DynTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271843">var</span>&nbsp;<span class="ident" id="6271847">v</span>&nbsp;<span class="ident" id="6271849">uint64</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271858">switch</span>&nbsp;<span class="ident" id="6271865">f</span><span class="op" id="6271866">.</span><span class="ident" id="6271867">Class</span>&nbsp;<span class="op" id="6271873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271877">case</span>&nbsp;<span class="ident" id="6271882">ELFCLASS32</span><span class="op" id="6271892">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6271897">t</span>&nbsp;<span class="op" id="6271899">=</span>&nbsp;<span class="ident" id="6271901">DynTag</span><span class="op" id="6271907">(</span><span class="ident" id="6271908">f</span><span class="op" id="6271909">.</span><span class="ident" id="6271910">ByteOrder</span><span class="op" id="6271919">.</span><span class="ident" id="6271920">Uint32</span><span class="op" id="6271926">(</span><span class="ident" id="6271927">d</span><span class="op" id="6271928">[</span><span class="num" id="6271929">0</span><span class="op" id="6271930">:</span><span class="num" id="6271931">4</span><span class="op" id="6271932">]</span><span class="op" id="6271933">)</span><span class="op" id="6271934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6271939">v</span>&nbsp;<span class="op" id="6271941">=</span>&nbsp;<span class="ident" id="6271943">uint64</span><span class="op" id="6271949">(</span><span class="ident" id="6271950">f</span><span class="op" id="6271951">.</span><span class="ident" id="6271952">ByteOrder</span><span class="op" id="6271961">.</span><span class="ident" id="6271962">Uint32</span><span class="op" id="6271968">(</span><span class="ident" id="6271969">d</span><span class="op" id="6271970">[</span><span class="num" id="6271971">4</span><span class="op" id="6271972">:</span><span class="num" id="6271973">8</span><span class="op" id="6271974">]</span><span class="op" id="6271975">)</span><span class="op" id="6271976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6271981">d</span>&nbsp;<span class="op" id="6271983">=</span>&nbsp;<span class="ident" id="6271985">d</span><span class="op" id="6271986">[</span><span class="num" id="6271987">8</span><span class="op" id="6271988">:</span><span class="op" id="6271989">]</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6271993">case</span>&nbsp;<span class="ident" id="6271998">ELFCLASS64</span><span class="op" id="6272008">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6272013">t</span>&nbsp;<span class="op" id="6272015">=</span>&nbsp;<span class="ident" id="6272017">DynTag</span><span class="op" id="6272023">(</span><span class="ident" id="6272024">f</span><span class="op" id="6272025">.</span><span class="ident" id="6272026">ByteOrder</span><span class="op" id="6272035">.</span><span class="ident" id="6272036">Uint64</span><span class="op" id="6272042">(</span><span class="ident" id="6272043">d</span><span class="op" id="6272044">[</span><span class="num" id="6272045">0</span><span class="op" id="6272046">:</span><span class="num" id="6272047">8</span><span class="op" id="6272048">]</span><span class="op" id="6272049">)</span><span class="op" id="6272050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6272055">v</span>&nbsp;<span class="op" id="6272057">=</span>&nbsp;<span class="ident" id="6272059">f</span><span class="op" id="6272060">.</span><span class="ident" id="6272061">ByteOrder</span><span class="op" id="6272070">.</span><span class="ident" id="6272071">Uint64</span><span class="op" id="6272077">(</span><span class="ident" id="6272078">d</span><span class="op" id="6272079">[</span><span class="num" id="6272080">8</span><span class="op" id="6272081">:</span><span class="num" id="6272082">16</span><span class="op" id="6272084">]</span><span class="op" id="6272085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6272090">d</span>&nbsp;<span class="op" id="6272092">=</span>&nbsp;<span class="ident" id="6272094">d</span><span class="op" id="6272095">[</span><span class="num" id="6272096">16</span><span class="op" id="6272098">:</span><span class="op" id="6272099">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6272103">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6272107">if</span>&nbsp;<span class="ident" id="6272110">t</span>&nbsp;<span class="op" id="6272112">==</span>&nbsp;<span class="ident" id="6272115">tag</span>&nbsp;<span class="op" id="6272119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6272124">s</span><span class="op" id="6272125">,</span>&nbsp;<span class="ident" id="6272127">ok</span>&nbsp;<span class="op" id="6272130">:=</span>&nbsp;<span class="ident" id="6272133">getString</span><span class="op" id="6272142">(</span><span class="ident" id="6272143">str</span><span class="op" id="6272146">,</span>&nbsp;<span class="builtintype" id="6272148">int</span><span class="op" id="6272151">(</span><span class="ident" id="6272152">v</span><span class="op" id="6272153">)</span><span class="op" id="6272154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6272159">if</span>&nbsp;<span class="ident" id="6272162">ok</span>&nbsp;<span class="op" id="6272165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6272171">all</span>&nbsp;<span class="op" id="6272175">=</span>&nbsp;<span class="builtinfunc" id="6272177">append</span><span class="op" id="6272183">(</span><span class="ident" id="6272184">all</span><span class="op" id="6272187">,</span>&nbsp;<span class="ident" id="6272189">s</span><span class="op" id="6272190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6272195">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6272199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6272202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6272205">return</span>&nbsp;<span class="ident" id="6272212">all</span><span class="op" id="6272215">,</span>&nbsp;<span class="builtintype" id="6272217">nil</span><br>
<span class="lineno"></span><span class="op" id="6272221">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
