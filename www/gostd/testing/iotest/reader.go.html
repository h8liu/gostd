<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing/iotest</h2>
<ul>
<li><a href="/gostd/testing/iotest/logger.go.html">logger.go</a></li>
<li><a href="/gostd/testing/iotest/reader.go.html">reader.go</a></li>
<li><a href="/gostd/testing/iotest/writer.go.html">writer.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6344583">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6344638">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6344692">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6344743">//&nbsp;Package&nbsp;iotest&nbsp;implements&nbsp;Readers&nbsp;and&nbsp;Writers&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="6344819">package</span>&nbsp;<span class="ident" id="6344827">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6344835">import</span>&nbsp;<span class="op" id="6344842">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6344845">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6344855">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="6344860">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6344863">//&nbsp;OneByteReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements</span><br>
<span class="lineno"></span><span class="comment" id="6344913">//&nbsp;each&nbsp;non-empty&nbsp;Read&nbsp;by&nbsp;reading&nbsp;one&nbsp;byte&nbsp;from&nbsp;r.</span><br>
<span class="lineno">15</span><span class="keyword" id="6344964">func</span>&nbsp;<span class="ident" id="6344969">OneByteReader</span><span class="op" id="6344982">(</span><span class="ident" id="6344983">r</span>&nbsp;<span class="ident" id="6344985">io</span><span class="op" id="6344987">.</span><span class="ident" id="6344988">Reader</span><span class="op" id="6344994">)</span>&nbsp;<span class="ident" id="6344996">io</span><span class="op" id="6344998">.</span><span class="ident" id="6344999">Reader</span>&nbsp;<span class="op" id="6345006">{</span>&nbsp;<span class="keyword" id="6345008">return</span>&nbsp;<span class="op" id="6345015">&amp;</span><span class="ident" id="6345016">oneByteReader</span><span class="op" id="6345029">{</span><span class="ident" id="6345030">r</span><span class="op" id="6345031">}</span>&nbsp;<span class="op" id="6345033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6345036">type</span>&nbsp;<span class="ident" id="6345041">oneByteReader</span>&nbsp;<span class="keyword" id="6345055">struct</span>&nbsp;<span class="op" id="6345062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345065">r</span>&nbsp;<span class="ident" id="6345067">io</span><span class="op" id="6345069">.</span><span class="ident" id="6345070">Reader</span><br>
<span class="lineno"></span><span class="op" id="6345077">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="6345080">func</span>&nbsp;<span class="op" id="6345085">(</span><span class="ident" id="6345086">r</span>&nbsp;<span class="op" id="6345088">*</span><span class="ident" id="6345089">oneByteReader</span><span class="op" id="6345102">)</span>&nbsp;<span class="ident" id="6345104">Read</span><span class="op" id="6345108">(</span><span class="ident" id="6345109">p</span>&nbsp;<span class="op" id="6345111">[</span><span class="op" id="6345112">]</span><span class="builtintype" id="6345113">byte</span><span class="op" id="6345117">)</span>&nbsp;<span class="op" id="6345119">(</span><span class="builtintype" id="6345120">int</span><span class="op" id="6345123">,</span>&nbsp;<span class="builtintype" id="6345125">error</span><span class="op" id="6345130">)</span>&nbsp;<span class="op" id="6345132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345135">if</span>&nbsp;<span class="builtinfunc" id="6345138">len</span><span class="op" id="6345141">(</span><span class="ident" id="6345142">p</span><span class="op" id="6345143">)</span>&nbsp;<span class="op" id="6345145">==</span>&nbsp;<span class="num" id="6345148">0</span>&nbsp;<span class="op" id="6345150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345154">return</span>&nbsp;<span class="num" id="6345161">0</span><span class="op" id="6345162">,</span>&nbsp;<span class="ident" id="6345164">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345169">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345172">return</span>&nbsp;<span class="ident" id="6345179">r</span><span class="op" id="6345180">.</span><span class="ident" id="6345181">r</span><span class="op" id="6345182">.</span><span class="ident" id="6345183">Read</span><span class="op" id="6345187">(</span><span class="ident" id="6345188">p</span><span class="op" id="6345189">[</span><span class="num" id="6345190">0</span><span class="op" id="6345191">:</span><span class="num" id="6345192">1</span><span class="op" id="6345193">]</span><span class="op" id="6345194">)</span><br>
<span class="lineno"></span><span class="op" id="6345196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6345199">//&nbsp;HalfReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="6345251">//&nbsp;by&nbsp;reading&nbsp;half&nbsp;as&nbsp;many&nbsp;requested&nbsp;bytes&nbsp;from&nbsp;r.</span><br>
<span class="lineno">30</span><span class="keyword" id="6345302">func</span>&nbsp;<span class="ident" id="6345307">HalfReader</span><span class="op" id="6345317">(</span><span class="ident" id="6345318">r</span>&nbsp;<span class="ident" id="6345320">io</span><span class="op" id="6345322">.</span><span class="ident" id="6345323">Reader</span><span class="op" id="6345329">)</span>&nbsp;<span class="ident" id="6345331">io</span><span class="op" id="6345333">.</span><span class="ident" id="6345334">Reader</span>&nbsp;<span class="op" id="6345341">{</span>&nbsp;<span class="keyword" id="6345343">return</span>&nbsp;<span class="op" id="6345350">&amp;</span><span class="ident" id="6345351">halfReader</span><span class="op" id="6345361">{</span><span class="ident" id="6345362">r</span><span class="op" id="6345363">}</span>&nbsp;<span class="op" id="6345365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6345368">type</span>&nbsp;<span class="ident" id="6345373">halfReader</span>&nbsp;<span class="keyword" id="6345384">struct</span>&nbsp;<span class="op" id="6345391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345394">r</span>&nbsp;<span class="ident" id="6345396">io</span><span class="op" id="6345398">.</span><span class="ident" id="6345399">Reader</span><br>
<span class="lineno"></span><span class="op" id="6345406">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="6345409">func</span>&nbsp;<span class="op" id="6345414">(</span><span class="ident" id="6345415">r</span>&nbsp;<span class="op" id="6345417">*</span><span class="ident" id="6345418">halfReader</span><span class="op" id="6345428">)</span>&nbsp;<span class="ident" id="6345430">Read</span><span class="op" id="6345434">(</span><span class="ident" id="6345435">p</span>&nbsp;<span class="op" id="6345437">[</span><span class="op" id="6345438">]</span><span class="builtintype" id="6345439">byte</span><span class="op" id="6345443">)</span>&nbsp;<span class="op" id="6345445">(</span><span class="builtintype" id="6345446">int</span><span class="op" id="6345449">,</span>&nbsp;<span class="builtintype" id="6345451">error</span><span class="op" id="6345456">)</span>&nbsp;<span class="op" id="6345458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345461">return</span>&nbsp;<span class="ident" id="6345468">r</span><span class="op" id="6345469">.</span><span class="ident" id="6345470">r</span><span class="op" id="6345471">.</span><span class="ident" id="6345472">Read</span><span class="op" id="6345476">(</span><span class="ident" id="6345477">p</span><span class="op" id="6345478">[</span><span class="num" id="6345479">0</span>&nbsp;<span class="op" id="6345481">:</span>&nbsp;<span class="op" id="6345483">(</span><span class="builtinfunc" id="6345484">len</span><span class="op" id="6345487">(</span><span class="ident" id="6345488">p</span><span class="op" id="6345489">)</span><span class="op" id="6345490">+</span><span class="num" id="6345491">1</span><span class="op" id="6345492">)</span><span class="op" id="6345493">/</span><span class="num" id="6345494">2</span><span class="op" id="6345495">]</span><span class="op" id="6345496">)</span><br>
<span class="lineno"></span><span class="op" id="6345498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="6345501">//&nbsp;DataErrReader&nbsp;changes&nbsp;the&nbsp;way&nbsp;errors&nbsp;are&nbsp;handled&nbsp;by&nbsp;a&nbsp;Reader.&nbsp;Normally,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6345578">//&nbsp;Reader&nbsp;returns&nbsp;an&nbsp;error&nbsp;(typically&nbsp;EOF)&nbsp;from&nbsp;the&nbsp;first&nbsp;Read&nbsp;call&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6345656">//&nbsp;last&nbsp;piece&nbsp;of&nbsp;data&nbsp;is&nbsp;read.&nbsp;DataErrReader&nbsp;wraps&nbsp;a&nbsp;Reader&nbsp;and&nbsp;changes&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="6345732">//&nbsp;behavior&nbsp;so&nbsp;the&nbsp;final&nbsp;error&nbsp;is&nbsp;returned&nbsp;along&nbsp;with&nbsp;the&nbsp;final&nbsp;data,&nbsp;instead</span><br>
<span class="lineno"></span><span class="comment" id="6345810">//&nbsp;of&nbsp;in&nbsp;the&nbsp;first&nbsp;call&nbsp;after&nbsp;the&nbsp;final&nbsp;data.</span><br>
<span class="lineno">45</span><span class="keyword" id="6345856">func</span>&nbsp;<span class="ident" id="6345861">DataErrReader</span><span class="op" id="6345874">(</span><span class="ident" id="6345875">r</span>&nbsp;<span class="ident" id="6345877">io</span><span class="op" id="6345879">.</span><span class="ident" id="6345880">Reader</span><span class="op" id="6345886">)</span>&nbsp;<span class="ident" id="6345888">io</span><span class="op" id="6345890">.</span><span class="ident" id="6345891">Reader</span>&nbsp;<span class="op" id="6345898">{</span>&nbsp;<span class="keyword" id="6345900">return</span>&nbsp;<span class="op" id="6345907">&amp;</span><span class="ident" id="6345908">dataErrReader</span><span class="op" id="6345921">{</span><span class="ident" id="6345922">r</span><span class="op" id="6345923">,</span>&nbsp;<span class="ident" id="6345925">nil</span><span class="op" id="6345928">,</span>&nbsp;<span class="builtinfunc" id="6345930">make</span><span class="op" id="6345934">(</span><span class="op" id="6345935">[</span><span class="op" id="6345936">]</span><span class="builtintype" id="6345937">byte</span><span class="op" id="6345941">,</span>&nbsp;<span class="num" id="6345943">1024</span><span class="op" id="6345947">)</span><span class="op" id="6345948">}</span>&nbsp;<span class="op" id="6345950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6345953">type</span>&nbsp;<span class="ident" id="6345958">dataErrReader</span>&nbsp;<span class="keyword" id="6345972">struct</span>&nbsp;<span class="op" id="6345979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345982">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6345989">io</span><span class="op" id="6345991">.</span><span class="ident" id="6345992">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346000">unread</span>&nbsp;<span class="op" id="6346007">[</span><span class="op" id="6346008">]</span><span class="builtintype" id="6346009">byte</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346015">data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6346022">[</span><span class="op" id="6346023">]</span><span class="builtintype" id="6346024">byte</span><br>
<span class="lineno"></span><span class="op" id="6346029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6346032">func</span>&nbsp;<span class="op" id="6346037">(</span><span class="ident" id="6346038">r</span>&nbsp;<span class="op" id="6346040">*</span><span class="ident" id="6346041">dataErrReader</span><span class="op" id="6346054">)</span>&nbsp;<span class="ident" id="6346056">Read</span><span class="op" id="6346060">(</span><span class="ident" id="6346061">p</span>&nbsp;<span class="op" id="6346063">[</span><span class="op" id="6346064">]</span><span class="builtintype" id="6346065">byte</span><span class="op" id="6346069">)</span>&nbsp;<span class="op" id="6346071">(</span><span class="ident" id="6346072">n</span>&nbsp;<span class="builtintype" id="6346074">int</span><span class="op" id="6346077">,</span>&nbsp;<span class="ident" id="6346079">err</span>&nbsp;<span class="builtintype" id="6346083">error</span><span class="op" id="6346088">)</span>&nbsp;<span class="op" id="6346090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6346093">//&nbsp;loop&nbsp;because&nbsp;first&nbsp;call&nbsp;needs&nbsp;two&nbsp;reads:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6346138">//&nbsp;one&nbsp;to&nbsp;get&nbsp;data&nbsp;and&nbsp;a&nbsp;second&nbsp;to&nbsp;look&nbsp;for&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346193">for</span>&nbsp;<span class="op" id="6346197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346201">if</span>&nbsp;<span class="builtinfunc" id="6346204">len</span><span class="op" id="6346207">(</span><span class="ident" id="6346208">r</span><span class="op" id="6346209">.</span><span class="ident" id="6346210">unread</span><span class="op" id="6346216">)</span>&nbsp;<span class="op" id="6346218">==</span>&nbsp;<span class="num" id="6346221">0</span>&nbsp;<span class="op" id="6346223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346228">n1</span><span class="op" id="6346230">,</span>&nbsp;<span class="ident" id="6346232">err1</span>&nbsp;<span class="op" id="6346237">:=</span>&nbsp;<span class="ident" id="6346240">r</span><span class="op" id="6346241">.</span><span class="ident" id="6346242">r</span><span class="op" id="6346243">.</span><span class="ident" id="6346244">Read</span><span class="op" id="6346248">(</span><span class="ident" id="6346249">r</span><span class="op" id="6346250">.</span><span class="ident" id="6346251">data</span><span class="op" id="6346255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346260">r</span><span class="op" id="6346261">.</span><span class="ident" id="6346262">unread</span>&nbsp;<span class="op" id="6346269">=</span>&nbsp;<span class="ident" id="6346271">r</span><span class="op" id="6346272">.</span><span class="ident" id="6346273">data</span><span class="op" id="6346277">[</span><span class="num" id="6346278">0</span><span class="op" id="6346279">:</span><span class="ident" id="6346280">n1</span><span class="op" id="6346282">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346287">err</span>&nbsp;<span class="op" id="6346291">=</span>&nbsp;<span class="ident" id="6346293">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346304">if</span>&nbsp;<span class="ident" id="6346307">n</span>&nbsp;<span class="op" id="6346309">&gt;</span>&nbsp;<span class="num" id="6346311">0</span>&nbsp;<span class="op" id="6346313">||</span>&nbsp;<span class="ident" id="6346316">err</span>&nbsp;<span class="op" id="6346320">!=</span>&nbsp;<span class="ident" id="6346323">nil</span>&nbsp;<span class="op" id="6346327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346332">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346340">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346344">n</span>&nbsp;<span class="op" id="6346346">=</span>&nbsp;<span class="builtinfunc" id="6346348">copy</span><span class="op" id="6346352">(</span><span class="ident" id="6346353">p</span><span class="op" id="6346354">,</span>&nbsp;<span class="ident" id="6346356">r</span><span class="op" id="6346357">.</span><span class="ident" id="6346358">unread</span><span class="op" id="6346364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346368">r</span><span class="op" id="6346369">.</span><span class="ident" id="6346370">unread</span>&nbsp;<span class="op" id="6346377">=</span>&nbsp;<span class="ident" id="6346379">r</span><span class="op" id="6346380">.</span><span class="ident" id="6346381">unread</span><span class="op" id="6346387">[</span><span class="ident" id="6346388">n</span><span class="op" id="6346389">:</span><span class="op" id="6346390">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346396">return</span><br>
<span class="lineno"></span><span class="op" id="6346403">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="6346406">var</span>&nbsp;<span class="ident" id="6346410">ErrTimeout</span>&nbsp;<span class="op" id="6346421">=</span>&nbsp;<span class="ident" id="6346423">errors</span><span class="op" id="6346429">.</span><span class="ident" id="6346430">New</span><span class="op" id="6346433">(</span><span class="string" id="6346434">&#34;timeout&#34;</span><span class="op" id="6346443">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6346446">//&nbsp;TimeoutReader&nbsp;returns&nbsp;ErrTimeout&nbsp;on&nbsp;the&nbsp;second&nbsp;read</span><br>
<span class="lineno"></span><span class="comment" id="6346501">//&nbsp;with&nbsp;no&nbsp;data.&nbsp;&nbsp;Subsequent&nbsp;calls&nbsp;to&nbsp;read&nbsp;succeed.</span><br>
<span class="lineno">75</span><span class="keyword" id="6346553">func</span>&nbsp;<span class="ident" id="6346558">TimeoutReader</span><span class="op" id="6346571">(</span><span class="ident" id="6346572">r</span>&nbsp;<span class="ident" id="6346574">io</span><span class="op" id="6346576">.</span><span class="ident" id="6346577">Reader</span><span class="op" id="6346583">)</span>&nbsp;<span class="ident" id="6346585">io</span><span class="op" id="6346587">.</span><span class="ident" id="6346588">Reader</span>&nbsp;<span class="op" id="6346595">{</span>&nbsp;<span class="keyword" id="6346597">return</span>&nbsp;<span class="op" id="6346604">&amp;</span><span class="ident" id="6346605">timeoutReader</span><span class="op" id="6346618">{</span><span class="ident" id="6346619">r</span><span class="op" id="6346620">,</span>&nbsp;<span class="num" id="6346622">0</span><span class="op" id="6346623">}</span>&nbsp;<span class="op" id="6346625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6346628">type</span>&nbsp;<span class="ident" id="6346633">timeoutReader</span>&nbsp;<span class="keyword" id="6346647">struct</span>&nbsp;<span class="op" id="6346654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346657">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6346663">io</span><span class="op" id="6346665">.</span><span class="ident" id="6346666">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346674">count</span>&nbsp;<span class="builtintype" id="6346680">int</span><br>
<span class="lineno">80</span><span class="op" id="6346684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6346687">func</span>&nbsp;<span class="op" id="6346692">(</span><span class="ident" id="6346693">r</span>&nbsp;<span class="op" id="6346695">*</span><span class="ident" id="6346696">timeoutReader</span><span class="op" id="6346709">)</span>&nbsp;<span class="ident" id="6346711">Read</span><span class="op" id="6346715">(</span><span class="ident" id="6346716">p</span>&nbsp;<span class="op" id="6346718">[</span><span class="op" id="6346719">]</span><span class="builtintype" id="6346720">byte</span><span class="op" id="6346724">)</span>&nbsp;<span class="op" id="6346726">(</span><span class="builtintype" id="6346727">int</span><span class="op" id="6346730">,</span>&nbsp;<span class="builtintype" id="6346732">error</span><span class="op" id="6346737">)</span>&nbsp;<span class="op" id="6346739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346742">r</span><span class="op" id="6346743">.</span><span class="ident" id="6346744">count</span><span class="op" id="6346749">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346753">if</span>&nbsp;<span class="ident" id="6346756">r</span><span class="op" id="6346757">.</span><span class="ident" id="6346758">count</span>&nbsp;<span class="op" id="6346764">==</span>&nbsp;<span class="num" id="6346767">2</span>&nbsp;<span class="op" id="6346769">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346773">return</span>&nbsp;<span class="num" id="6346780">0</span><span class="op" id="6346781">,</span>&nbsp;<span class="ident" id="6346783">ErrTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346798">return</span>&nbsp;<span class="ident" id="6346805">r</span><span class="op" id="6346806">.</span><span class="ident" id="6346807">r</span><span class="op" id="6346808">.</span><span class="ident" id="6346809">Read</span><span class="op" id="6346813">(</span><span class="ident" id="6346814">p</span><span class="op" id="6346815">)</span><br>
<span class="lineno"></span><span class="op" id="6346817">}</span>
</div>
</body>
</html>
