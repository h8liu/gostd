<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/md5</h2>
<ul>
<li><a href="/gostd/crypto/md5/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5.go.html">md5.go</a></li>
<li><a href="/gostd/crypto/md5/md5_test.go.html">md5_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5block.go.html">md5block.go</a></li>
<li><a href="/gostd/crypto/md5/md5block_decl.go.html">md5block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4332395">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4332450">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4332504">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4332555">//go:generate&nbsp;go&nbsp;run&nbsp;gen.go&nbsp;-full&nbsp;-output&nbsp;md5block.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4332610">//&nbsp;Package&nbsp;md5&nbsp;implements&nbsp;the&nbsp;MD5&nbsp;hash&nbsp;algorithm&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;1321.</span><br>
<span class="lineno"></span><span class="keyword" id="4332683">package</span>&nbsp;<span class="ident" id="4332691">md5</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4332696">import</span>&nbsp;<span class="op" id="4332703">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4332706">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4332716">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4332723">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4332726">func</span>&nbsp;<span class="ident" id="4332731">init</span><span class="op" id="4332735">(</span><span class="op" id="4332736">)</span>&nbsp;<span class="op" id="4332738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332741">crypto</span><span class="op" id="4332747">.</span><span class="ident" id="4332748">RegisterHash</span><span class="op" id="4332760">(</span><span class="ident" id="4332761">crypto</span><span class="op" id="4332767">.</span><span class="ident" id="4332768">MD5</span><span class="op" id="4332771">,</span>&nbsp;<span class="ident" id="4332773">New</span><span class="op" id="4332776">)</span><br>
<span class="lineno"></span><span class="op" id="4332778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4332781">//&nbsp;The&nbsp;size&nbsp;of&nbsp;an&nbsp;MD5&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4332822">const</span>&nbsp;<span class="ident" id="4332828">Size</span>&nbsp;<span class="op" id="4332833">=</span>&nbsp;<span class="num" id="4332835">16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4332839">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;MD5&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4332873">const</span>&nbsp;<span class="ident" id="4332879">BlockSize</span>&nbsp;<span class="op" id="4332889">=</span>&nbsp;<span class="num" id="4332891">64</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="4332895">const</span>&nbsp;<span class="op" id="4332901">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332904">chunk</span>&nbsp;<span class="op" id="4332910">=</span>&nbsp;<span class="num" id="4332912">64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332916">init0</span>&nbsp;<span class="op" id="4332922">=</span>&nbsp;<span class="num" id="4332924">0x67452301</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332936">init1</span>&nbsp;<span class="op" id="4332942">=</span>&nbsp;<span class="num" id="4332944">0xEFCDAB89</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332956">init2</span>&nbsp;<span class="op" id="4332962">=</span>&nbsp;<span class="num" id="4332964">0x98BADCFE</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4332976">init3</span>&nbsp;<span class="op" id="4332982">=</span>&nbsp;<span class="num" id="4332984">0x10325476</span><br>
<span class="lineno"></span><span class="op" id="4332995">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4332998">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4333057">type</span>&nbsp;<span class="ident" id="4333062">digest</span>&nbsp;<span class="keyword" id="4333069">struct</span>&nbsp;<span class="op" id="4333076">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333079">s</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4333083">[</span><span class="num" id="4333084">4</span><span class="op" id="4333085">]</span><span class="builtintype" id="4333086">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333094">x</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4333098">[</span><span class="ident" id="4333099">chunk</span><span class="op" id="4333104">]</span><span class="builtintype" id="4333105">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333111">nx</span>&nbsp;&nbsp;<span class="builtintype" id="4333115">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4333120">len</span>&nbsp;<span class="ident" id="4333124">uint64</span><br>
<span class="lineno"></span><span class="op" id="4333131">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4333134">func</span>&nbsp;<span class="op" id="4333139">(</span><span class="ident" id="4333140">d</span>&nbsp;<span class="op" id="4333142">*</span><span class="ident" id="4333143">digest</span><span class="op" id="4333149">)</span>&nbsp;<span class="ident" id="4333151">Reset</span><span class="op" id="4333156">(</span><span class="op" id="4333157">)</span>&nbsp;<span class="op" id="4333159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333162">d</span><span class="op" id="4333163">.</span><span class="ident" id="4333164">s</span><span class="op" id="4333165">[</span><span class="num" id="4333166">0</span><span class="op" id="4333167">]</span>&nbsp;<span class="op" id="4333169">=</span>&nbsp;<span class="ident" id="4333171">init0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333178">d</span><span class="op" id="4333179">.</span><span class="ident" id="4333180">s</span><span class="op" id="4333181">[</span><span class="num" id="4333182">1</span><span class="op" id="4333183">]</span>&nbsp;<span class="op" id="4333185">=</span>&nbsp;<span class="ident" id="4333187">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333194">d</span><span class="op" id="4333195">.</span><span class="ident" id="4333196">s</span><span class="op" id="4333197">[</span><span class="num" id="4333198">2</span><span class="op" id="4333199">]</span>&nbsp;<span class="op" id="4333201">=</span>&nbsp;<span class="ident" id="4333203">init2</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333210">d</span><span class="op" id="4333211">.</span><span class="ident" id="4333212">s</span><span class="op" id="4333213">[</span><span class="num" id="4333214">3</span><span class="op" id="4333215">]</span>&nbsp;<span class="op" id="4333217">=</span>&nbsp;<span class="ident" id="4333219">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333226">d</span><span class="op" id="4333227">.</span><span class="ident" id="4333228">nx</span>&nbsp;<span class="op" id="4333231">=</span>&nbsp;<span class="num" id="4333233">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333236">d</span><span class="op" id="4333237">.</span><span class="builtinfunc" id="4333238">len</span>&nbsp;<span class="op" id="4333242">=</span>&nbsp;<span class="num" id="4333244">0</span><br>
<span class="lineno"></span><span class="op" id="4333246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4333249">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;MD5&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4333308">func</span>&nbsp;<span class="ident" id="4333313">New</span><span class="op" id="4333316">(</span><span class="op" id="4333317">)</span>&nbsp;<span class="ident" id="4333319">hash</span><span class="op" id="4333323">.</span><span class="ident" id="4333324">Hash</span>&nbsp;<span class="op" id="4333329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333332">d</span>&nbsp;<span class="op" id="4333334">:=</span>&nbsp;<span class="builtinfunc" id="4333337">new</span><span class="op" id="4333340">(</span><span class="ident" id="4333341">digest</span><span class="op" id="4333347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333350">d</span><span class="op" id="4333351">.</span><span class="ident" id="4333352">Reset</span><span class="op" id="4333357">(</span><span class="op" id="4333358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4333361">return</span>&nbsp;<span class="ident" id="4333368">d</span><br>
<span class="lineno">55</span><span class="op" id="4333370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4333373">func</span>&nbsp;<span class="op" id="4333378">(</span><span class="ident" id="4333379">d</span>&nbsp;<span class="op" id="4333381">*</span><span class="ident" id="4333382">digest</span><span class="op" id="4333388">)</span>&nbsp;<span class="ident" id="4333390">Size</span><span class="op" id="4333394">(</span><span class="op" id="4333395">)</span>&nbsp;<span class="builtintype" id="4333397">int</span>&nbsp;<span class="op" id="4333401">{</span>&nbsp;<span class="keyword" id="4333403">return</span>&nbsp;<span class="ident" id="4333410">Size</span>&nbsp;<span class="op" id="4333415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4333418">func</span>&nbsp;<span class="op" id="4333423">(</span><span class="ident" id="4333424">d</span>&nbsp;<span class="op" id="4333426">*</span><span class="ident" id="4333427">digest</span><span class="op" id="4333433">)</span>&nbsp;<span class="ident" id="4333435">BlockSize</span><span class="op" id="4333444">(</span><span class="op" id="4333445">)</span>&nbsp;<span class="builtintype" id="4333447">int</span>&nbsp;<span class="op" id="4333451">{</span>&nbsp;<span class="keyword" id="4333453">return</span>&nbsp;<span class="ident" id="4333460">BlockSize</span>&nbsp;<span class="op" id="4333470">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="4333473">func</span>&nbsp;<span class="op" id="4333478">(</span><span class="ident" id="4333479">d</span>&nbsp;<span class="op" id="4333481">*</span><span class="ident" id="4333482">digest</span><span class="op" id="4333488">)</span>&nbsp;<span class="ident" id="4333490">Write</span><span class="op" id="4333495">(</span><span class="ident" id="4333496">p</span>&nbsp;<span class="op" id="4333498">[</span><span class="op" id="4333499">]</span><span class="builtintype" id="4333500">byte</span><span class="op" id="4333504">)</span>&nbsp;<span class="op" id="4333506">(</span><span class="ident" id="4333507">nn</span>&nbsp;<span class="builtintype" id="4333510">int</span><span class="op" id="4333513">,</span>&nbsp;<span class="ident" id="4333515">err</span>&nbsp;<span class="builtintype" id="4333519">error</span><span class="op" id="4333524">)</span>&nbsp;<span class="op" id="4333526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333529">nn</span>&nbsp;<span class="op" id="4333532">=</span>&nbsp;<span class="builtinfunc" id="4333534">len</span><span class="op" id="4333537">(</span><span class="ident" id="4333538">p</span><span class="op" id="4333539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333542">d</span><span class="op" id="4333543">.</span><span class="builtinfunc" id="4333544">len</span>&nbsp;<span class="op" id="4333548">+=</span>&nbsp;<span class="ident" id="4333551">uint64</span><span class="op" id="4333557">(</span><span class="ident" id="4333558">nn</span><span class="op" id="4333560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4333563">if</span>&nbsp;<span class="ident" id="4333566">d</span><span class="op" id="4333567">.</span><span class="ident" id="4333568">nx</span>&nbsp;<span class="op" id="4333571">&gt;</span>&nbsp;<span class="num" id="4333573">0</span>&nbsp;<span class="op" id="4333575">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333579">n</span>&nbsp;<span class="op" id="4333581">:=</span>&nbsp;<span class="builtinfunc" id="4333584">len</span><span class="op" id="4333587">(</span><span class="ident" id="4333588">p</span><span class="op" id="4333589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4333593">if</span>&nbsp;<span class="ident" id="4333596">n</span>&nbsp;<span class="op" id="4333598">&gt;</span>&nbsp;<span class="ident" id="4333600">chunk</span><span class="op" id="4333605">-</span><span class="ident" id="4333606">d</span><span class="op" id="4333607">.</span><span class="ident" id="4333608">nx</span>&nbsp;<span class="op" id="4333611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333616">n</span>&nbsp;<span class="op" id="4333618">=</span>&nbsp;<span class="ident" id="4333620">chunk</span>&nbsp;<span class="op" id="4333626">-</span>&nbsp;<span class="ident" id="4333628">d</span><span class="op" id="4333629">.</span><span class="ident" id="4333630">nx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4333635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4333639">for</span>&nbsp;<span class="ident" id="4333643">i</span>&nbsp;<span class="op" id="4333645">:=</span>&nbsp;<span class="num" id="4333648">0</span><span class="op" id="4333649">;</span>&nbsp;<span class="ident" id="4333651">i</span>&nbsp;<span class="op" id="4333653">&lt;</span>&nbsp;<span class="ident" id="4333655">n</span><span class="op" id="4333656">;</span>&nbsp;<span class="ident" id="4333658">i</span><span class="op" id="4333659">++</span>&nbsp;<span class="op" id="4333662">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333667">d</span><span class="op" id="4333668">.</span><span class="ident" id="4333669">x</span><span class="op" id="4333670">[</span><span class="ident" id="4333671">d</span><span class="op" id="4333672">.</span><span class="ident" id="4333673">nx</span><span class="op" id="4333675">+</span><span class="ident" id="4333676">i</span><span class="op" id="4333677">]</span>&nbsp;<span class="op" id="4333679">=</span>&nbsp;<span class="ident" id="4333681">p</span><span class="op" id="4333682">[</span><span class="ident" id="4333683">i</span><span class="op" id="4333684">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4333688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333692">d</span><span class="op" id="4333693">.</span><span class="ident" id="4333694">nx</span>&nbsp;<span class="op" id="4333697">+=</span>&nbsp;<span class="ident" id="4333700">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4333704">if</span>&nbsp;<span class="ident" id="4333707">d</span><span class="op" id="4333708">.</span><span class="ident" id="4333709">nx</span>&nbsp;<span class="op" id="4333712">==</span>&nbsp;<span class="ident" id="4333715">chunk</span>&nbsp;<span class="op" id="4333721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333726">block</span><span class="op" id="4333731">(</span><span class="ident" id="4333732">d</span><span class="op" id="4333733">,</span>&nbsp;<span class="ident" id="4333735">d</span><span class="op" id="4333736">.</span><span class="ident" id="4333737">x</span><span class="op" id="4333738">[</span><span class="num" id="4333739">0</span><span class="op" id="4333740">:</span><span class="ident" id="4333741">chunk</span><span class="op" id="4333746">]</span><span class="op" id="4333747">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333752">d</span><span class="op" id="4333753">.</span><span class="ident" id="4333754">nx</span>&nbsp;<span class="op" id="4333757">=</span>&nbsp;<span class="num" id="4333759">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4333763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333767">p</span>&nbsp;<span class="op" id="4333769">=</span>&nbsp;<span class="ident" id="4333771">p</span><span class="op" id="4333772">[</span><span class="ident" id="4333773">n</span><span class="op" id="4333774">:</span><span class="op" id="4333775">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4333778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4333781">if</span>&nbsp;<span class="builtinfunc" id="4333784">len</span><span class="op" id="4333787">(</span><span class="ident" id="4333788">p</span><span class="op" id="4333789">)</span>&nbsp;<span class="op" id="4333791">&gt;=</span>&nbsp;<span class="ident" id="4333794">chunk</span>&nbsp;<span class="op" id="4333800">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333804">n</span>&nbsp;<span class="op" id="4333806">:=</span>&nbsp;<span class="builtinfunc" id="4333809">len</span><span class="op" id="4333812">(</span><span class="ident" id="4333813">p</span><span class="op" id="4333814">)</span>&nbsp;<span class="op" id="4333816">&amp;^</span>&nbsp;<span class="op" id="4333819">(</span><span class="ident" id="4333820">chunk</span>&nbsp;<span class="op" id="4333826">-</span>&nbsp;<span class="num" id="4333828">1</span><span class="op" id="4333829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333833">block</span><span class="op" id="4333838">(</span><span class="ident" id="4333839">d</span><span class="op" id="4333840">,</span>&nbsp;<span class="ident" id="4333842">p</span><span class="op" id="4333843">[</span><span class="op" id="4333844">:</span><span class="ident" id="4333845">n</span><span class="op" id="4333846">]</span><span class="op" id="4333847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333851">p</span>&nbsp;<span class="op" id="4333853">=</span>&nbsp;<span class="ident" id="4333855">p</span><span class="op" id="4333856">[</span><span class="ident" id="4333857">n</span><span class="op" id="4333858">:</span><span class="op" id="4333859">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4333862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4333865">if</span>&nbsp;<span class="builtinfunc" id="4333868">len</span><span class="op" id="4333871">(</span><span class="ident" id="4333872">p</span><span class="op" id="4333873">)</span>&nbsp;<span class="op" id="4333875">&gt;</span>&nbsp;<span class="num" id="4333877">0</span>&nbsp;<span class="op" id="4333879">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333883">d</span><span class="op" id="4333884">.</span><span class="ident" id="4333885">nx</span>&nbsp;<span class="op" id="4333888">=</span>&nbsp;<span class="builtinfunc" id="4333890">copy</span><span class="op" id="4333894">(</span><span class="ident" id="4333895">d</span><span class="op" id="4333896">.</span><span class="ident" id="4333897">x</span><span class="op" id="4333898">[</span><span class="op" id="4333899">:</span><span class="op" id="4333900">]</span><span class="op" id="4333901">,</span>&nbsp;<span class="ident" id="4333903">p</span><span class="op" id="4333904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4333907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4333910">return</span><br>
<span class="lineno"></span><span class="op" id="4333917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="4333920">func</span>&nbsp;<span class="op" id="4333925">(</span><span class="ident" id="4333926">d0</span>&nbsp;<span class="op" id="4333929">*</span><span class="ident" id="4333930">digest</span><span class="op" id="4333936">)</span>&nbsp;<span class="ident" id="4333938">Sum</span><span class="op" id="4333941">(</span><span class="ident" id="4333942">in</span>&nbsp;<span class="op" id="4333945">[</span><span class="op" id="4333946">]</span><span class="builtintype" id="4333947">byte</span><span class="op" id="4333951">)</span>&nbsp;<span class="op" id="4333953">[</span><span class="op" id="4333954">]</span><span class="builtintype" id="4333955">byte</span>&nbsp;<span class="op" id="4333960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4333963">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334030">d</span>&nbsp;<span class="op" id="4334032">:=</span>&nbsp;<span class="op" id="4334035">*</span><span class="ident" id="4334036">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334040">hash</span>&nbsp;<span class="op" id="4334045">:=</span>&nbsp;<span class="ident" id="4334048">d</span><span class="op" id="4334049">.</span><span class="ident" id="4334050">checkSum</span><span class="op" id="4334058">(</span><span class="op" id="4334059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334062">return</span>&nbsp;<span class="builtinfunc" id="4334069">append</span><span class="op" id="4334075">(</span><span class="ident" id="4334076">in</span><span class="op" id="4334078">,</span>&nbsp;<span class="ident" id="4334080">hash</span><span class="op" id="4334084">[</span><span class="op" id="4334085">:</span><span class="op" id="4334086">]</span><span class="op" id="4334087">...</span><span class="op" id="4334090">)</span><br>
<span class="lineno">95</span><span class="op" id="4334092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4334095">func</span>&nbsp;<span class="op" id="4334100">(</span><span class="ident" id="4334101">d</span>&nbsp;<span class="op" id="4334103">*</span><span class="ident" id="4334104">digest</span><span class="op" id="4334110">)</span>&nbsp;<span class="ident" id="4334112">checkSum</span><span class="op" id="4334120">(</span><span class="op" id="4334121">)</span>&nbsp;<span class="op" id="4334123">[</span><span class="ident" id="4334124">Size</span><span class="op" id="4334128">]</span><span class="builtintype" id="4334129">byte</span>&nbsp;<span class="op" id="4334134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4334137">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4334197">len</span>&nbsp;<span class="op" id="4334201">:=</span>&nbsp;<span class="ident" id="4334204">d</span><span class="op" id="4334205">.</span><span class="builtinfunc" id="4334206">len</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334211">var</span>&nbsp;<span class="ident" id="4334215">tmp</span>&nbsp;<span class="op" id="4334219">[</span><span class="num" id="4334220">64</span><span class="op" id="4334222">]</span><span class="builtintype" id="4334223">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334229">tmp</span><span class="op" id="4334232">[</span><span class="num" id="4334233">0</span><span class="op" id="4334234">]</span>&nbsp;<span class="op" id="4334236">=</span>&nbsp;<span class="num" id="4334238">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334244">if</span>&nbsp;<span class="builtinfunc" id="4334247">len</span><span class="op" id="4334250">%</span><span class="num" id="4334251">64</span>&nbsp;<span class="op" id="4334254">&lt;</span>&nbsp;<span class="num" id="4334256">56</span>&nbsp;<span class="op" id="4334259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334263">d</span><span class="op" id="4334264">.</span><span class="ident" id="4334265">Write</span><span class="op" id="4334270">(</span><span class="ident" id="4334271">tmp</span><span class="op" id="4334274">[</span><span class="num" id="4334275">0</span>&nbsp;<span class="op" id="4334277">:</span>&nbsp;<span class="num" id="4334279">56</span><span class="op" id="4334281">-</span><span class="builtinfunc" id="4334282">len</span><span class="op" id="4334285">%</span><span class="num" id="4334286">64</span><span class="op" id="4334288">]</span><span class="op" id="4334289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4334292">}</span>&nbsp;<span class="keyword" id="4334294">else</span>&nbsp;<span class="op" id="4334299">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334303">d</span><span class="op" id="4334304">.</span><span class="ident" id="4334305">Write</span><span class="op" id="4334310">(</span><span class="ident" id="4334311">tmp</span><span class="op" id="4334314">[</span><span class="num" id="4334315">0</span>&nbsp;<span class="op" id="4334317">:</span>&nbsp;<span class="num" id="4334319">64</span><span class="op" id="4334321">+</span><span class="num" id="4334322">56</span><span class="op" id="4334324">-</span><span class="builtinfunc" id="4334325">len</span><span class="op" id="4334328">%</span><span class="num" id="4334329">64</span><span class="op" id="4334331">]</span><span class="op" id="4334332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4334335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4334339">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4334359">len</span>&nbsp;<span class="op" id="4334363">&lt;&lt;=</span>&nbsp;<span class="num" id="4334367">3</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334370">for</span>&nbsp;<span class="ident" id="4334374">i</span>&nbsp;<span class="op" id="4334376">:=</span>&nbsp;<span class="builtintype" id="4334379">uint</span><span class="op" id="4334383">(</span><span class="num" id="4334384">0</span><span class="op" id="4334385">)</span><span class="op" id="4334386">;</span>&nbsp;<span class="ident" id="4334388">i</span>&nbsp;<span class="op" id="4334390">&lt;</span>&nbsp;<span class="num" id="4334392">8</span><span class="op" id="4334393">;</span>&nbsp;<span class="ident" id="4334395">i</span><span class="op" id="4334396">++</span>&nbsp;<span class="op" id="4334399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334403">tmp</span><span class="op" id="4334406">[</span><span class="ident" id="4334407">i</span><span class="op" id="4334408">]</span>&nbsp;<span class="op" id="4334410">=</span>&nbsp;<span class="builtintype" id="4334412">byte</span><span class="op" id="4334416">(</span><span class="builtinfunc" id="4334417">len</span>&nbsp;<span class="op" id="4334421">&gt;&gt;</span>&nbsp;<span class="op" id="4334424">(</span><span class="num" id="4334425">8</span>&nbsp;<span class="op" id="4334427">*</span>&nbsp;<span class="ident" id="4334429">i</span><span class="op" id="4334430">)</span><span class="op" id="4334431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4334434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334437">d</span><span class="op" id="4334438">.</span><span class="ident" id="4334439">Write</span><span class="op" id="4334444">(</span><span class="ident" id="4334445">tmp</span><span class="op" id="4334448">[</span><span class="num" id="4334449">0</span><span class="op" id="4334450">:</span><span class="num" id="4334451">8</span><span class="op" id="4334452">]</span><span class="op" id="4334453">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334457">if</span>&nbsp;<span class="ident" id="4334460">d</span><span class="op" id="4334461">.</span><span class="ident" id="4334462">nx</span>&nbsp;<span class="op" id="4334465">!=</span>&nbsp;<span class="num" id="4334468">0</span>&nbsp;<span class="op" id="4334470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4334474">panic</span><span class="op" id="4334479">(</span><span class="string" id="4334480">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4334491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4334494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334498">var</span>&nbsp;<span class="ident" id="4334502">digest</span>&nbsp;<span class="op" id="4334509">[</span><span class="ident" id="4334510">Size</span><span class="op" id="4334514">]</span><span class="builtintype" id="4334515">byte</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334521">for</span>&nbsp;<span class="ident" id="4334525">i</span><span class="op" id="4334526">,</span>&nbsp;<span class="ident" id="4334528">s</span>&nbsp;<span class="op" id="4334530">:=</span>&nbsp;<span class="keyword" id="4334533">range</span>&nbsp;<span class="ident" id="4334539">d</span><span class="op" id="4334540">.</span><span class="ident" id="4334541">s</span>&nbsp;<span class="op" id="4334543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334547">digest</span><span class="op" id="4334553">[</span><span class="ident" id="4334554">i</span><span class="op" id="4334555">*</span><span class="num" id="4334556">4</span><span class="op" id="4334557">]</span>&nbsp;<span class="op" id="4334559">=</span>&nbsp;<span class="builtintype" id="4334561">byte</span><span class="op" id="4334565">(</span><span class="ident" id="4334566">s</span><span class="op" id="4334567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334571">digest</span><span class="op" id="4334577">[</span><span class="ident" id="4334578">i</span><span class="op" id="4334579">*</span><span class="num" id="4334580">4</span><span class="op" id="4334581">+</span><span class="num" id="4334582">1</span><span class="op" id="4334583">]</span>&nbsp;<span class="op" id="4334585">=</span>&nbsp;<span class="builtintype" id="4334587">byte</span><span class="op" id="4334591">(</span><span class="ident" id="4334592">s</span>&nbsp;<span class="op" id="4334594">&gt;&gt;</span>&nbsp;<span class="num" id="4334597">8</span><span class="op" id="4334598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334602">digest</span><span class="op" id="4334608">[</span><span class="ident" id="4334609">i</span><span class="op" id="4334610">*</span><span class="num" id="4334611">4</span><span class="op" id="4334612">+</span><span class="num" id="4334613">2</span><span class="op" id="4334614">]</span>&nbsp;<span class="op" id="4334616">=</span>&nbsp;<span class="builtintype" id="4334618">byte</span><span class="op" id="4334622">(</span><span class="ident" id="4334623">s</span>&nbsp;<span class="op" id="4334625">&gt;&gt;</span>&nbsp;<span class="num" id="4334628">16</span><span class="op" id="4334630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334634">digest</span><span class="op" id="4334640">[</span><span class="ident" id="4334641">i</span><span class="op" id="4334642">*</span><span class="num" id="4334643">4</span><span class="op" id="4334644">+</span><span class="num" id="4334645">3</span><span class="op" id="4334646">]</span>&nbsp;<span class="op" id="4334648">=</span>&nbsp;<span class="builtintype" id="4334650">byte</span><span class="op" id="4334654">(</span><span class="ident" id="4334655">s</span>&nbsp;<span class="op" id="4334657">&gt;&gt;</span>&nbsp;<span class="num" id="4334660">24</span><span class="op" id="4334662">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4334665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334669">return</span>&nbsp;<span class="ident" id="4334676">digest</span><br>
<span class="lineno"></span><span class="op" id="4334683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="4334686">//&nbsp;Sum&nbsp;returns&nbsp;the&nbsp;MD5&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4334731">func</span>&nbsp;<span class="ident" id="4334736">Sum</span><span class="op" id="4334739">(</span><span class="ident" id="4334740">data</span>&nbsp;<span class="op" id="4334745">[</span><span class="op" id="4334746">]</span><span class="builtintype" id="4334747">byte</span><span class="op" id="4334751">)</span>&nbsp;<span class="op" id="4334753">[</span><span class="ident" id="4334754">Size</span><span class="op" id="4334758">]</span><span class="builtintype" id="4334759">byte</span>&nbsp;<span class="op" id="4334764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334767">var</span>&nbsp;<span class="ident" id="4334771">d</span>&nbsp;<span class="ident" id="4334773">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334781">d</span><span class="op" id="4334782">.</span><span class="ident" id="4334783">Reset</span><span class="op" id="4334788">(</span><span class="op" id="4334789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334792">d</span><span class="op" id="4334793">.</span><span class="ident" id="4334794">Write</span><span class="op" id="4334799">(</span><span class="ident" id="4334800">data</span><span class="op" id="4334804">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334807">return</span>&nbsp;<span class="ident" id="4334814">d</span><span class="op" id="4334815">.</span><span class="ident" id="4334816">checkSum</span><span class="op" id="4334824">(</span><span class="op" id="4334825">)</span><br>
<span class="lineno"></span><span class="op" id="4334827">}</span>
</div>
</body>
</html>
