<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html" class="current">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="942138">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="942193">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="942247">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="942298">//&nbsp;The&nbsp;race&nbsp;detector&nbsp;does&nbsp;not&nbsp;understand&nbsp;ParFor&nbsp;synchronization.</span><br>
<span class="lineno"></span><span class="comment" id="942363">//&nbsp;+build&nbsp;!race</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="942380">package</span>&nbsp;<span class="ident" id="942388">runtime_test</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="942402">import</span>&nbsp;<span class="op" id="942409">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="942412">.</span>&nbsp;<span class="string" id="942414">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="942425">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="942436">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="942445">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="942448">var</span>&nbsp;<span class="ident" id="942452">gdata</span>&nbsp;<span class="op" id="942458">[</span><span class="op" id="942459">]</span><span class="ident" id="942460">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="942468">//&nbsp;Simple&nbsp;serial&nbsp;sanity&nbsp;test&nbsp;for&nbsp;parallelfor.</span><br>
<span class="lineno"></span><span class="keyword" id="942514">func</span>&nbsp;<span class="ident" id="942519">TestParFor</span><span class="op" id="942529">(</span><span class="ident" id="942530">t</span>&nbsp;<span class="op" id="942532">*</span><span class="ident" id="942533">testing</span><span class="op" id="942540">.</span><span class="ident" id="942541">T</span><span class="op" id="942542">)</span>&nbsp;<span class="op" id="942544">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="942547">const</span>&nbsp;<span class="ident" id="942553">P</span>&nbsp;<span class="op" id="942555">=</span>&nbsp;<span class="num" id="942557">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="942560">const</span>&nbsp;<span class="ident" id="942566">N</span>&nbsp;<span class="op" id="942568">=</span>&nbsp;<span class="num" id="942570">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="942574">data</span>&nbsp;<span class="op" id="942579">:=</span>&nbsp;<span class="builtinfunc" id="942582">make</span><span class="op" id="942586">(</span><span class="op" id="942587">[</span><span class="op" id="942588">]</span><span class="ident" id="942589">uint64</span><span class="op" id="942595">,</span>&nbsp;<span class="ident" id="942597">N</span><span class="op" id="942598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="942601">for</span>&nbsp;<span class="ident" id="942605">i</span>&nbsp;<span class="op" id="942607">:=</span>&nbsp;<span class="ident" id="942610">uint64</span><span class="op" id="942616">(</span><span class="num" id="942617">0</span><span class="op" id="942618">)</span><span class="op" id="942619">;</span>&nbsp;<span class="ident" id="942621">i</span>&nbsp;<span class="op" id="942623">&lt;</span>&nbsp;<span class="ident" id="942625">N</span><span class="op" id="942626">;</span>&nbsp;<span class="ident" id="942628">i</span><span class="op" id="942629">++</span>&nbsp;<span class="op" id="942632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="942636">data</span><span class="op" id="942640">[</span><span class="ident" id="942641">i</span><span class="op" id="942642">]</span>&nbsp;<span class="op" id="942644">=</span>&nbsp;<span class="ident" id="942646">i</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="942649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="942652">desc</span>&nbsp;<span class="op" id="942657">:=</span>&nbsp;<span class="ident" id="942660">NewParFor</span><span class="op" id="942669">(</span><span class="ident" id="942670">P</span><span class="op" id="942671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="942674">//&nbsp;Avoid&nbsp;making&nbsp;func&nbsp;a&nbsp;closure:&nbsp;parfor&nbsp;cannot&nbsp;invoke&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="942734">//&nbsp;Since&nbsp;it&nbsp;doesn&#39;t&nbsp;happen&nbsp;in&nbsp;the&nbsp;C&nbsp;code,&nbsp;it&#39;s&nbsp;not&nbsp;worth&nbsp;doing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="942798">//&nbsp;just&nbsp;for&nbsp;the&nbsp;test.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="942821">gdata</span>&nbsp;<span class="op" id="942827">=</span>&nbsp;<span class="ident" id="942829">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="942835">ParForSetup</span><span class="op" id="942846">(</span><span class="ident" id="942847">desc</span><span class="op" id="942851">,</span>&nbsp;<span class="ident" id="942853">P</span><span class="op" id="942854">,</span>&nbsp;<span class="ident" id="942856">N</span><span class="op" id="942857">,</span>&nbsp;<span class="ident" id="942859">nil</span><span class="op" id="942862">,</span>&nbsp;<span class="builtintype" id="942864">true</span><span class="op" id="942868">,</span>&nbsp;<span class="keyword" id="942870">func</span><span class="op" id="942874">(</span><span class="ident" id="942875">desc</span>&nbsp;<span class="op" id="942880">*</span><span class="ident" id="942881">ParFor</span><span class="op" id="942887">,</span>&nbsp;<span class="ident" id="942889">i</span>&nbsp;<span class="builtintype" id="942891">uint32</span><span class="op" id="942897">)</span>&nbsp;<span class="op" id="942899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="942903">data</span>&nbsp;<span class="op" id="942908">:=</span>&nbsp;<span class="ident" id="942911">gdata</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="942919">data</span><span class="op" id="942923">[</span><span class="ident" id="942924">i</span><span class="op" id="942925">]</span>&nbsp;<span class="op" id="942927">=</span>&nbsp;<span class="ident" id="942929">data</span><span class="op" id="942933">[</span><span class="ident" id="942934">i</span><span class="op" id="942935">]</span><span class="op" id="942936">*</span><span class="ident" id="942937">data</span><span class="op" id="942941">[</span><span class="ident" id="942942">i</span><span class="op" id="942943">]</span>&nbsp;<span class="op" id="942945">+</span>&nbsp;<span class="num" id="942947">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="942950">}</span><span class="op" id="942951">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="942954">ParForDo</span><span class="op" id="942962">(</span><span class="ident" id="942963">desc</span><span class="op" id="942967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="942970">for</span>&nbsp;<span class="ident" id="942974">i</span>&nbsp;<span class="op" id="942976">:=</span>&nbsp;<span class="ident" id="942979">uint64</span><span class="op" id="942985">(</span><span class="num" id="942986">0</span><span class="op" id="942987">)</span><span class="op" id="942988">;</span>&nbsp;<span class="ident" id="942990">i</span>&nbsp;<span class="op" id="942992">&lt;</span>&nbsp;<span class="ident" id="942994">N</span><span class="op" id="942995">;</span>&nbsp;<span class="ident" id="942997">i</span><span class="op" id="942998">++</span>&nbsp;<span class="op" id="943001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="943005">if</span>&nbsp;<span class="ident" id="943008">data</span><span class="op" id="943012">[</span><span class="ident" id="943013">i</span><span class="op" id="943014">]</span>&nbsp;<span class="op" id="943016">!=</span>&nbsp;<span class="ident" id="943019">i</span><span class="op" id="943020">*</span><span class="ident" id="943021">i</span><span class="op" id="943022">+</span><span class="num" id="943023">1</span>&nbsp;<span class="op" id="943025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="943030">t</span><span class="op" id="943031">.</span><span class="ident" id="943032">Fatalf</span><span class="op" id="943038">(</span><span class="string" id="943039">&#34;Wrong&nbsp;element&nbsp;%d:&nbsp;%d&#34;</span><span class="op" id="943061">,</span>&nbsp;<span class="ident" id="943063">i</span><span class="op" id="943064">,</span>&nbsp;<span class="ident" id="943066">data</span><span class="op" id="943070">[</span><span class="ident" id="943071">i</span><span class="op" id="943072">]</span><span class="op" id="943073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="943077">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="943080">}</span><br>
<span class="lineno"></span><span class="op" id="943082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="943085">//&nbsp;Test&nbsp;that&nbsp;nonblocking&nbsp;parallelfor&nbsp;does&nbsp;not&nbsp;block.</span><br>
<span class="lineno"></span><span class="keyword" id="943138">func</span>&nbsp;<span class="ident" id="943143">TestParFor2</span><span class="op" id="943154">(</span><span class="ident" id="943155">t</span>&nbsp;<span class="op" id="943157">*</span><span class="ident" id="943158">testing</span><span class="op" id="943165">.</span><span class="ident" id="943166">T</span><span class="op" id="943167">)</span>&nbsp;<span class="op" id="943169">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="943172">const</span>&nbsp;<span class="ident" id="943178">P</span>&nbsp;<span class="op" id="943180">=</span>&nbsp;<span class="num" id="943182">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="943185">const</span>&nbsp;<span class="ident" id="943191">N</span>&nbsp;<span class="op" id="943193">=</span>&nbsp;<span class="num" id="943195">1003</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="943201">data</span>&nbsp;<span class="op" id="943206">:=</span>&nbsp;<span class="builtinfunc" id="943209">make</span><span class="op" id="943213">(</span><span class="op" id="943214">[</span><span class="op" id="943215">]</span><span class="ident" id="943216">uint64</span><span class="op" id="943222">,</span>&nbsp;<span class="ident" id="943224">N</span><span class="op" id="943225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="943228">for</span>&nbsp;<span class="ident" id="943232">i</span>&nbsp;<span class="op" id="943234">:=</span>&nbsp;<span class="ident" id="943237">uint64</span><span class="op" id="943243">(</span><span class="num" id="943244">0</span><span class="op" id="943245">)</span><span class="op" id="943246">;</span>&nbsp;<span class="ident" id="943248">i</span>&nbsp;<span class="op" id="943250">&lt;</span>&nbsp;<span class="ident" id="943252">N</span><span class="op" id="943253">;</span>&nbsp;<span class="ident" id="943255">i</span><span class="op" id="943256">++</span>&nbsp;<span class="op" id="943259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="943263">data</span><span class="op" id="943267">[</span><span class="ident" id="943268">i</span><span class="op" id="943269">]</span>&nbsp;<span class="op" id="943271">=</span>&nbsp;<span class="ident" id="943273">i</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="943276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="943279">desc</span>&nbsp;<span class="op" id="943284">:=</span>&nbsp;<span class="ident" id="943287">NewParFor</span><span class="op" id="943296">(</span><span class="ident" id="943297">P</span><span class="op" id="943298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="943301">ParForSetup</span><span class="op" id="943312">(</span><span class="ident" id="943313">desc</span><span class="op" id="943317">,</span>&nbsp;<span class="ident" id="943319">P</span><span class="op" id="943320">,</span>&nbsp;<span class="ident" id="943322">N</span><span class="op" id="943323">,</span>&nbsp;<span class="op" id="943325">(</span><span class="op" id="943326">*</span><span class="builtintype" id="943327">byte</span><span class="op" id="943331">)</span><span class="op" id="943332">(</span><span class="ident" id="943333">unsafe</span><span class="op" id="943339">.</span><span class="ident" id="943340">Pointer</span><span class="op" id="943347">(</span><span class="op" id="943348">&amp;</span><span class="ident" id="943349">data</span><span class="op" id="943353">)</span><span class="op" id="943354">)</span><span class="op" id="943355">,</span>&nbsp;<span class="builtintype" id="943357">false</span><span class="op" id="943362">,</span>&nbsp;<span class="keyword" id="943364">func</span><span class="op" id="943368">(</span><span class="ident" id="943369">desc</span>&nbsp;<span class="op" id="943374">*</span><span class="ident" id="943375">ParFor</span><span class="op" id="943381">,</span>&nbsp;<span class="ident" id="943383">i</span>&nbsp;<span class="builtintype" id="943385">uint32</span><span class="op" id="943391">)</span>&nbsp;<span class="op" id="943393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="943397">d</span>&nbsp;<span class="op" id="943399">:=</span>&nbsp;<span class="op" id="943402">*</span><span class="op" id="943403">(</span><span class="op" id="943404">*</span><span class="op" id="943405">[</span><span class="op" id="943406">]</span><span class="ident" id="943407">uint64</span><span class="op" id="943413">)</span><span class="op" id="943414">(</span><span class="ident" id="943415">unsafe</span><span class="op" id="943421">.</span><span class="ident" id="943422">Pointer</span><span class="op" id="943429">(</span><span class="ident" id="943430">desc</span><span class="op" id="943434">.</span><span class="ident" id="943435">Ctx</span><span class="op" id="943438">)</span><span class="op" id="943439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="943443">d</span><span class="op" id="943444">[</span><span class="ident" id="943445">i</span><span class="op" id="943446">]</span>&nbsp;<span class="op" id="943448">=</span>&nbsp;<span class="ident" id="943450">d</span><span class="op" id="943451">[</span><span class="ident" id="943452">i</span><span class="op" id="943453">]</span><span class="op" id="943454">*</span><span class="ident" id="943455">d</span><span class="op" id="943456">[</span><span class="ident" id="943457">i</span><span class="op" id="943458">]</span>&nbsp;<span class="op" id="943460">+</span>&nbsp;<span class="num" id="943462">1</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="943465">}</span><span class="op" id="943466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="943469">for</span>&nbsp;<span class="ident" id="943473">p</span>&nbsp;<span class="op" id="943475">:=</span>&nbsp;<span class="num" id="943478">0</span><span class="op" id="943479">;</span>&nbsp;<span class="ident" id="943481">p</span>&nbsp;<span class="op" id="943483">&lt;</span>&nbsp;<span class="ident" id="943485">P</span><span class="op" id="943486">;</span>&nbsp;<span class="ident" id="943488">p</span><span class="op" id="943489">++</span>&nbsp;<span class="op" id="943492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="943496">ParForDo</span><span class="op" id="943504">(</span><span class="ident" id="943505">desc</span><span class="op" id="943509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="943512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="943515">for</span>&nbsp;<span class="ident" id="943519">i</span>&nbsp;<span class="op" id="943521">:=</span>&nbsp;<span class="ident" id="943524">uint64</span><span class="op" id="943530">(</span><span class="num" id="943531">0</span><span class="op" id="943532">)</span><span class="op" id="943533">;</span>&nbsp;<span class="ident" id="943535">i</span>&nbsp;<span class="op" id="943537">&lt;</span>&nbsp;<span class="ident" id="943539">N</span><span class="op" id="943540">;</span>&nbsp;<span class="ident" id="943542">i</span><span class="op" id="943543">++</span>&nbsp;<span class="op" id="943546">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="943550">if</span>&nbsp;<span class="ident" id="943553">data</span><span class="op" id="943557">[</span><span class="ident" id="943558">i</span><span class="op" id="943559">]</span>&nbsp;<span class="op" id="943561">!=</span>&nbsp;<span class="ident" id="943564">i</span><span class="op" id="943565">*</span><span class="ident" id="943566">i</span><span class="op" id="943567">+</span><span class="num" id="943568">1</span>&nbsp;<span class="op" id="943570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="943575">t</span><span class="op" id="943576">.</span><span class="ident" id="943577">Fatalf</span><span class="op" id="943583">(</span><span class="string" id="943584">&#34;Wrong&nbsp;element&nbsp;%d:&nbsp;%d&#34;</span><span class="op" id="943606">,</span>&nbsp;<span class="ident" id="943608">i</span><span class="op" id="943609">,</span>&nbsp;<span class="ident" id="943611">data</span><span class="op" id="943615">[</span><span class="ident" id="943616">i</span><span class="op" id="943617">]</span><span class="op" id="943618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="943622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="943625">}</span><br>
<span class="lineno"></span><span class="op" id="943627">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="943630">//&nbsp;Test&nbsp;that&nbsp;iterations&nbsp;are&nbsp;properly&nbsp;distributed.</span><br>
<span class="lineno"></span><span class="keyword" id="943680">func</span>&nbsp;<span class="ident" id="943685">TestParForSetup</span><span class="op" id="943700">(</span><span class="ident" id="943701">t</span>&nbsp;<span class="op" id="943703">*</span><span class="ident" id="943704">testing</span><span class="op" id="943711">.</span><span class="ident" id="943712">T</span><span class="op" id="943713">)</span>&nbsp;<span class="op" id="943715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="943718">const</span>&nbsp;<span class="ident" id="943724">P</span>&nbsp;<span class="op" id="943726">=</span>&nbsp;<span class="num" id="943728">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="943732">const</span>&nbsp;<span class="ident" id="943738">N</span>&nbsp;<span class="op" id="943740">=</span>&nbsp;<span class="num" id="943742">101</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="943747">desc</span>&nbsp;<span class="op" id="943752">:=</span>&nbsp;<span class="ident" id="943755">NewParFor</span><span class="op" id="943764">(</span><span class="ident" id="943765">P</span><span class="op" id="943766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="943769">for</span>&nbsp;<span class="ident" id="943773">n</span>&nbsp;<span class="op" id="943775">:=</span>&nbsp;<span class="builtintype" id="943778">uint32</span><span class="op" id="943784">(</span><span class="num" id="943785">0</span><span class="op" id="943786">)</span><span class="op" id="943787">;</span>&nbsp;<span class="ident" id="943789">n</span>&nbsp;<span class="op" id="943791">&lt;</span>&nbsp;<span class="ident" id="943793">N</span><span class="op" id="943794">;</span>&nbsp;<span class="ident" id="943796">n</span><span class="op" id="943797">++</span>&nbsp;<span class="op" id="943800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="943804">for</span>&nbsp;<span class="ident" id="943808">p</span>&nbsp;<span class="op" id="943810">:=</span>&nbsp;<span class="builtintype" id="943813">uint32</span><span class="op" id="943819">(</span><span class="num" id="943820">1</span><span class="op" id="943821">)</span><span class="op" id="943822">;</span>&nbsp;<span class="ident" id="943824">p</span>&nbsp;<span class="op" id="943826">&lt;=</span>&nbsp;<span class="ident" id="943829">P</span><span class="op" id="943830">;</span>&nbsp;<span class="ident" id="943832">p</span><span class="op" id="943833">++</span>&nbsp;<span class="op" id="943836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="943841">ParForSetup</span><span class="op" id="943852">(</span><span class="ident" id="943853">desc</span><span class="op" id="943857">,</span>&nbsp;<span class="ident" id="943859">p</span><span class="op" id="943860">,</span>&nbsp;<span class="ident" id="943862">n</span><span class="op" id="943863">,</span>&nbsp;<span class="ident" id="943865">nil</span><span class="op" id="943868">,</span>&nbsp;<span class="builtintype" id="943870">true</span><span class="op" id="943874">,</span>&nbsp;<span class="keyword" id="943876">func</span><span class="op" id="943880">(</span><span class="ident" id="943881">desc</span>&nbsp;<span class="op" id="943886">*</span><span class="ident" id="943887">ParFor</span><span class="op" id="943893">,</span>&nbsp;<span class="ident" id="943895">i</span>&nbsp;<span class="builtintype" id="943897">uint32</span><span class="op" id="943903">)</span>&nbsp;<span class="op" id="943905">{</span><span class="op" id="943906">}</span><span class="op" id="943907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="943912">sum</span>&nbsp;<span class="op" id="943916">:=</span>&nbsp;<span class="builtintype" id="943919">uint32</span><span class="op" id="943925">(</span><span class="num" id="943926">0</span><span class="op" id="943927">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="943932">size0</span>&nbsp;<span class="op" id="943938">:=</span>&nbsp;<span class="builtintype" id="943941">uint32</span><span class="op" id="943947">(</span><span class="num" id="943948">0</span><span class="op" id="943949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="943954">end0</span>&nbsp;<span class="op" id="943959">:=</span>&nbsp;<span class="builtintype" id="943962">uint32</span><span class="op" id="943968">(</span><span class="num" id="943969">0</span><span class="op" id="943970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="943975">for</span>&nbsp;<span class="ident" id="943979">i</span>&nbsp;<span class="op" id="943981">:=</span>&nbsp;<span class="builtintype" id="943984">uint32</span><span class="op" id="943990">(</span><span class="num" id="943991">0</span><span class="op" id="943992">)</span><span class="op" id="943993">;</span>&nbsp;<span class="ident" id="943995">i</span>&nbsp;<span class="op" id="943997">&lt;</span>&nbsp;<span class="ident" id="943999">p</span><span class="op" id="944000">;</span>&nbsp;<span class="ident" id="944002">i</span><span class="op" id="944003">++</span>&nbsp;<span class="op" id="944006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944012">begin</span><span class="op" id="944017">,</span>&nbsp;<span class="ident" id="944019">end</span>&nbsp;<span class="op" id="944023">:=</span>&nbsp;<span class="ident" id="944026">ParForIters</span><span class="op" id="944037">(</span><span class="ident" id="944038">desc</span><span class="op" id="944042">,</span>&nbsp;<span class="ident" id="944044">i</span><span class="op" id="944045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944051">size</span>&nbsp;<span class="op" id="944056">:=</span>&nbsp;<span class="ident" id="944059">end</span>&nbsp;<span class="op" id="944063">-</span>&nbsp;<span class="ident" id="944065">begin</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944075">sum</span>&nbsp;<span class="op" id="944079">+=</span>&nbsp;<span class="ident" id="944082">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="944091">if</span>&nbsp;<span class="ident" id="944094">i</span>&nbsp;<span class="op" id="944096">==</span>&nbsp;<span class="num" id="944099">0</span>&nbsp;<span class="op" id="944101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944108">size0</span>&nbsp;<span class="op" id="944114">=</span>&nbsp;<span class="ident" id="944116">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="944126">if</span>&nbsp;<span class="ident" id="944129">begin</span>&nbsp;<span class="op" id="944135">!=</span>&nbsp;<span class="num" id="944138">0</span>&nbsp;<span class="op" id="944140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944148">t</span><span class="op" id="944149">.</span><span class="ident" id="944150">Fatalf</span><span class="op" id="944156">(</span><span class="string" id="944157">&#34;incorrect&nbsp;begin:&nbsp;%d&nbsp;(n=%d,&nbsp;p=%d)&#34;</span><span class="op" id="944191">,</span>&nbsp;<span class="ident" id="944193">begin</span><span class="op" id="944198">,</span>&nbsp;<span class="ident" id="944200">n</span><span class="op" id="944201">,</span>&nbsp;<span class="ident" id="944203">p</span><span class="op" id="944204">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="944211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="944217">}</span>&nbsp;<span class="keyword" id="944219">else</span>&nbsp;<span class="op" id="944224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="944231">if</span>&nbsp;<span class="ident" id="944234">size</span>&nbsp;<span class="op" id="944239">!=</span>&nbsp;<span class="ident" id="944242">size0</span>&nbsp;<span class="op" id="944248">&amp;&amp;</span>&nbsp;<span class="ident" id="944251">size</span>&nbsp;<span class="op" id="944256">!=</span>&nbsp;<span class="ident" id="944259">size0</span><span class="op" id="944264">+</span><span class="num" id="944265">1</span>&nbsp;<span class="op" id="944267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944275">t</span><span class="op" id="944276">.</span><span class="ident" id="944277">Fatalf</span><span class="op" id="944283">(</span><span class="string" id="944284">&#34;incorrect&nbsp;size:&nbsp;%d/%d&nbsp;(n=%d,&nbsp;p=%d)&#34;</span><span class="op" id="944320">,</span>&nbsp;<span class="ident" id="944322">size</span><span class="op" id="944326">,</span>&nbsp;<span class="ident" id="944328">size0</span><span class="op" id="944333">,</span>&nbsp;<span class="ident" id="944335">n</span><span class="op" id="944336">,</span>&nbsp;<span class="ident" id="944338">p</span><span class="op" id="944339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="944346">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="944353">if</span>&nbsp;<span class="ident" id="944356">begin</span>&nbsp;<span class="op" id="944362">!=</span>&nbsp;<span class="ident" id="944365">end0</span>&nbsp;<span class="op" id="944370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944378">t</span><span class="op" id="944379">.</span><span class="ident" id="944380">Fatalf</span><span class="op" id="944386">(</span><span class="string" id="944387">&#34;incorrect&nbsp;begin/end:&nbsp;%d/%d&nbsp;(n=%d,&nbsp;p=%d)&#34;</span><span class="op" id="944428">,</span>&nbsp;<span class="ident" id="944430">begin</span><span class="op" id="944435">,</span>&nbsp;<span class="ident" id="944437">end0</span><span class="op" id="944441">,</span>&nbsp;<span class="ident" id="944443">n</span><span class="op" id="944444">,</span>&nbsp;<span class="ident" id="944446">p</span><span class="op" id="944447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="944454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="944460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944466">end0</span>&nbsp;<span class="op" id="944471">=</span>&nbsp;<span class="ident" id="944473">end</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="944480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="944485">if</span>&nbsp;<span class="ident" id="944488">sum</span>&nbsp;<span class="op" id="944492">!=</span>&nbsp;<span class="ident" id="944495">n</span>&nbsp;<span class="op" id="944497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944503">t</span><span class="op" id="944504">.</span><span class="ident" id="944505">Fatalf</span><span class="op" id="944511">(</span><span class="string" id="944512">&#34;incorrect&nbsp;sum:&nbsp;%d/%d&nbsp;(p=%d)&#34;</span><span class="op" id="944541">,</span>&nbsp;<span class="ident" id="944543">sum</span><span class="op" id="944546">,</span>&nbsp;<span class="ident" id="944548">n</span><span class="op" id="944549">,</span>&nbsp;<span class="ident" id="944551">p</span><span class="op" id="944552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="944557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="944561">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="944564">}</span><br>
<span class="lineno"></span><span class="op" id="944566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="944569">//&nbsp;Test&nbsp;parallel&nbsp;parallelfor.</span><br>
<span class="lineno"></span><span class="keyword" id="944599">func</span>&nbsp;<span class="ident" id="944604">TestParForParallel</span><span class="op" id="944622">(</span><span class="ident" id="944623">t</span>&nbsp;<span class="op" id="944625">*</span><span class="ident" id="944626">testing</span><span class="op" id="944633">.</span><span class="ident" id="944634">T</span><span class="op" id="944635">)</span>&nbsp;<span class="op" id="944637">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944640">N</span>&nbsp;<span class="op" id="944642">:=</span>&nbsp;<span class="ident" id="944645">uint64</span><span class="op" id="944651">(</span><span class="num" id="944652">1e7</span><span class="op" id="944655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="944658">if</span>&nbsp;<span class="ident" id="944661">testing</span><span class="op" id="944668">.</span><span class="ident" id="944669">Short</span><span class="op" id="944674">(</span><span class="op" id="944675">)</span>&nbsp;<span class="op" id="944677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944681">N</span>&nbsp;<span class="op" id="944683">/=</span>&nbsp;<span class="num" id="944686">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="944690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944693">data</span>&nbsp;<span class="op" id="944698">:=</span>&nbsp;<span class="builtinfunc" id="944701">make</span><span class="op" id="944705">(</span><span class="op" id="944706">[</span><span class="op" id="944707">]</span><span class="ident" id="944708">uint64</span><span class="op" id="944714">,</span>&nbsp;<span class="ident" id="944716">N</span><span class="op" id="944717">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="944720">for</span>&nbsp;<span class="ident" id="944724">i</span>&nbsp;<span class="op" id="944726">:=</span>&nbsp;<span class="ident" id="944729">uint64</span><span class="op" id="944735">(</span><span class="num" id="944736">0</span><span class="op" id="944737">)</span><span class="op" id="944738">;</span>&nbsp;<span class="ident" id="944740">i</span>&nbsp;<span class="op" id="944742">&lt;</span>&nbsp;<span class="ident" id="944744">N</span><span class="op" id="944745">;</span>&nbsp;<span class="ident" id="944747">i</span><span class="op" id="944748">++</span>&nbsp;<span class="op" id="944751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944755">data</span><span class="op" id="944759">[</span><span class="ident" id="944760">i</span><span class="op" id="944761">]</span>&nbsp;<span class="op" id="944763">=</span>&nbsp;<span class="ident" id="944765">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="944768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944771">P</span>&nbsp;<span class="op" id="944773">:=</span>&nbsp;<span class="ident" id="944776">GOMAXPROCS</span><span class="op" id="944786">(</span><span class="op" id="944787">-</span><span class="num" id="944788">1</span><span class="op" id="944789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944792">c</span>&nbsp;<span class="op" id="944794">:=</span>&nbsp;<span class="builtinfunc" id="944797">make</span><span class="op" id="944801">(</span><span class="keyword" id="944802">chan</span>&nbsp;<span class="builtintype" id="944807">bool</span><span class="op" id="944811">,</span>&nbsp;<span class="ident" id="944813">P</span><span class="op" id="944814">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944817">desc</span>&nbsp;<span class="op" id="944822">:=</span>&nbsp;<span class="ident" id="944825">NewParFor</span><span class="op" id="944834">(</span><span class="builtintype" id="944835">uint32</span><span class="op" id="944841">(</span><span class="ident" id="944842">P</span><span class="op" id="944843">)</span><span class="op" id="944844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944847">gdata</span>&nbsp;<span class="op" id="944853">=</span>&nbsp;<span class="ident" id="944855">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944861">ParForSetup</span><span class="op" id="944872">(</span><span class="ident" id="944873">desc</span><span class="op" id="944877">,</span>&nbsp;<span class="builtintype" id="944879">uint32</span><span class="op" id="944885">(</span><span class="ident" id="944886">P</span><span class="op" id="944887">)</span><span class="op" id="944888">,</span>&nbsp;<span class="builtintype" id="944890">uint32</span><span class="op" id="944896">(</span><span class="ident" id="944897">N</span><span class="op" id="944898">)</span><span class="op" id="944899">,</span>&nbsp;<span class="ident" id="944901">nil</span><span class="op" id="944904">,</span>&nbsp;<span class="builtintype" id="944906">false</span><span class="op" id="944911">,</span>&nbsp;<span class="keyword" id="944913">func</span><span class="op" id="944917">(</span><span class="ident" id="944918">desc</span>&nbsp;<span class="op" id="944923">*</span><span class="ident" id="944924">ParFor</span><span class="op" id="944930">,</span>&nbsp;<span class="ident" id="944932">i</span>&nbsp;<span class="builtintype" id="944934">uint32</span><span class="op" id="944940">)</span>&nbsp;<span class="op" id="944942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944946">data</span>&nbsp;<span class="op" id="944951">:=</span>&nbsp;<span class="ident" id="944954">gdata</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="944962">data</span><span class="op" id="944966">[</span><span class="ident" id="944967">i</span><span class="op" id="944968">]</span>&nbsp;<span class="op" id="944970">=</span>&nbsp;<span class="ident" id="944972">data</span><span class="op" id="944976">[</span><span class="ident" id="944977">i</span><span class="op" id="944978">]</span><span class="op" id="944979">*</span><span class="ident" id="944980">data</span><span class="op" id="944984">[</span><span class="ident" id="944985">i</span><span class="op" id="944986">]</span>&nbsp;<span class="op" id="944988">+</span>&nbsp;<span class="num" id="944990">1</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="944993">}</span><span class="op" id="944994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="944997">for</span>&nbsp;<span class="ident" id="945001">p</span>&nbsp;<span class="op" id="945003">:=</span>&nbsp;<span class="num" id="945006">1</span><span class="op" id="945007">;</span>&nbsp;<span class="ident" id="945009">p</span>&nbsp;<span class="op" id="945011">&lt;</span>&nbsp;<span class="ident" id="945013">P</span><span class="op" id="945014">;</span>&nbsp;<span class="ident" id="945016">p</span><span class="op" id="945017">++</span>&nbsp;<span class="op" id="945020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="945024">go</span>&nbsp;<span class="keyword" id="945027">func</span><span class="op" id="945031">(</span><span class="op" id="945032">)</span>&nbsp;<span class="op" id="945034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="945039">ParForDo</span><span class="op" id="945047">(</span><span class="ident" id="945048">desc</span><span class="op" id="945052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="945057">c</span>&nbsp;<span class="op" id="945059">&lt;-</span>&nbsp;<span class="builtintype" id="945062">true</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="945069">}</span><span class="op" id="945070">(</span><span class="op" id="945071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="945074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="945077">ParForDo</span><span class="op" id="945085">(</span><span class="ident" id="945086">desc</span><span class="op" id="945090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="945093">for</span>&nbsp;<span class="ident" id="945097">p</span>&nbsp;<span class="op" id="945099">:=</span>&nbsp;<span class="num" id="945102">1</span><span class="op" id="945103">;</span>&nbsp;<span class="ident" id="945105">p</span>&nbsp;<span class="op" id="945107">&lt;</span>&nbsp;<span class="ident" id="945109">P</span><span class="op" id="945110">;</span>&nbsp;<span class="ident" id="945112">p</span><span class="op" id="945113">++</span>&nbsp;<span class="op" id="945116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="945120">&lt;-</span><span class="ident" id="945122">c</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="945125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="945128">for</span>&nbsp;<span class="ident" id="945132">i</span>&nbsp;<span class="op" id="945134">:=</span>&nbsp;<span class="ident" id="945137">uint64</span><span class="op" id="945143">(</span><span class="num" id="945144">0</span><span class="op" id="945145">)</span><span class="op" id="945146">;</span>&nbsp;<span class="ident" id="945148">i</span>&nbsp;<span class="op" id="945150">&lt;</span>&nbsp;<span class="ident" id="945152">N</span><span class="op" id="945153">;</span>&nbsp;<span class="ident" id="945155">i</span><span class="op" id="945156">++</span>&nbsp;<span class="op" id="945159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="945163">if</span>&nbsp;<span class="ident" id="945166">data</span><span class="op" id="945170">[</span><span class="ident" id="945171">i</span><span class="op" id="945172">]</span>&nbsp;<span class="op" id="945174">!=</span>&nbsp;<span class="ident" id="945177">i</span><span class="op" id="945178">*</span><span class="ident" id="945179">i</span><span class="op" id="945180">+</span><span class="num" id="945181">1</span>&nbsp;<span class="op" id="945183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="945188">t</span><span class="op" id="945189">.</span><span class="ident" id="945190">Fatalf</span><span class="op" id="945196">(</span><span class="string" id="945197">&#34;Wrong&nbsp;element&nbsp;%d:&nbsp;%d&#34;</span><span class="op" id="945219">,</span>&nbsp;<span class="ident" id="945221">i</span><span class="op" id="945222">,</span>&nbsp;<span class="ident" id="945224">data</span><span class="op" id="945228">[</span><span class="ident" id="945229">i</span><span class="op" id="945230">]</span><span class="op" id="945231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="945235">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="945238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="945242">data</span><span class="op" id="945246">,</span>&nbsp;<span class="ident" id="945248">desc</span>&nbsp;<span class="op" id="945253">=</span>&nbsp;<span class="ident" id="945255">nil</span><span class="op" id="945258">,</span>&nbsp;<span class="ident" id="945260">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="945265">GC</span><span class="op" id="945267">(</span><span class="op" id="945268">)</span><br>
<span class="lineno"></span><span class="op" id="945270">}</span>
</div>
</body>
</html>
