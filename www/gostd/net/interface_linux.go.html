<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html" class="current">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3754392">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3754448">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3754502">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3754553">package</span>&nbsp;<span class="ident" id="3754561">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3754566">import</span>&nbsp;<span class="op" id="3754573">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3754576">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3754582">&#34;syscall&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3754593">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="3754602">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3754605">//&nbsp;If&nbsp;the&nbsp;ifindex&nbsp;is&nbsp;zero,&nbsp;interfaceTable&nbsp;returns&nbsp;mappings&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3754671">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;mapping&nbsp;of&nbsp;a&nbsp;specific</span><br>
<span class="lineno">15</span><span class="comment" id="3754740">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3754754">func</span>&nbsp;<span class="ident" id="3754759">interfaceTable</span><span class="op" id="3754773">(</span><span class="ident" id="3754774">ifindex</span>&nbsp;<span class="builtintype" id="3754782">int</span><span class="op" id="3754785">)</span>&nbsp;<span class="op" id="3754787">(</span><span class="op" id="3754788">[</span><span class="op" id="3754789">]</span><span class="ident" id="3754790">Interface</span><span class="op" id="3754799">,</span>&nbsp;<span class="builtintype" id="3754801">error</span><span class="op" id="3754806">)</span>&nbsp;<span class="op" id="3754808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3754811">tab</span><span class="op" id="3754814">,</span>&nbsp;<span class="ident" id="3754816">err</span>&nbsp;<span class="op" id="3754820">:=</span>&nbsp;<span class="ident" id="3754823">syscall</span><span class="op" id="3754830">.</span><span class="ident" id="3754831">NetlinkRIB</span><span class="op" id="3754841">(</span><span class="ident" id="3754842">syscall</span><span class="op" id="3754849">.</span><span class="ident" id="3754850">RTM_GETLINK</span><span class="op" id="3754861">,</span>&nbsp;<span class="ident" id="3754863">syscall</span><span class="op" id="3754870">.</span><span class="ident" id="3754871">AF_UNSPEC</span><span class="op" id="3754880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3754883">if</span>&nbsp;<span class="ident" id="3754886">err</span>&nbsp;<span class="op" id="3754890">!=</span>&nbsp;<span class="builtintype" id="3754893">nil</span>&nbsp;<span class="op" id="3754897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3754901">return</span>&nbsp;<span class="builtintype" id="3754908">nil</span><span class="op" id="3754911">,</span>&nbsp;<span class="ident" id="3754913">os</span><span class="op" id="3754915">.</span><span class="ident" id="3754916">NewSyscallError</span><span class="op" id="3754931">(</span><span class="string" id="3754932">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3754945">,</span>&nbsp;<span class="ident" id="3754947">err</span><span class="op" id="3754950">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3754953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3754956">msgs</span><span class="op" id="3754960">,</span>&nbsp;<span class="ident" id="3754962">err</span>&nbsp;<span class="op" id="3754966">:=</span>&nbsp;<span class="ident" id="3754969">syscall</span><span class="op" id="3754976">.</span><span class="ident" id="3754977">ParseNetlinkMessage</span><span class="op" id="3754996">(</span><span class="ident" id="3754997">tab</span><span class="op" id="3755000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755003">if</span>&nbsp;<span class="ident" id="3755006">err</span>&nbsp;<span class="op" id="3755010">!=</span>&nbsp;<span class="builtintype" id="3755013">nil</span>&nbsp;<span class="op" id="3755017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755021">return</span>&nbsp;<span class="builtintype" id="3755028">nil</span><span class="op" id="3755031">,</span>&nbsp;<span class="ident" id="3755033">os</span><span class="op" id="3755035">.</span><span class="ident" id="3755036">NewSyscallError</span><span class="op" id="3755051">(</span><span class="string" id="3755052">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3755069">,</span>&nbsp;<span class="ident" id="3755071">err</span><span class="op" id="3755074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3755077">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755080">var</span>&nbsp;<span class="ident" id="3755084">ift</span>&nbsp;<span class="op" id="3755088">[</span><span class="op" id="3755089">]</span><span class="ident" id="3755090">Interface</span><br>
<span class="lineno"></span><span class="ident" id="3755100">loop</span><span class="op" id="3755104">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755107">for</span>&nbsp;<span class="ident" id="3755111">_</span><span class="op" id="3755112">,</span>&nbsp;<span class="ident" id="3755114">m</span>&nbsp;<span class="op" id="3755116">:=</span>&nbsp;<span class="keyword" id="3755119">range</span>&nbsp;<span class="ident" id="3755125">msgs</span>&nbsp;<span class="op" id="3755130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755134">switch</span>&nbsp;<span class="ident" id="3755141">m</span><span class="op" id="3755142">.</span><span class="ident" id="3755143">Header</span><span class="op" id="3755149">.</span><span class="ident" id="3755150">Type</span>&nbsp;<span class="op" id="3755155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755159">case</span>&nbsp;<span class="ident" id="3755164">syscall</span><span class="op" id="3755171">.</span><span class="ident" id="3755172">NLMSG_DONE</span><span class="op" id="3755182">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755187">break</span>&nbsp;<span class="ident" id="3755193">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755200">case</span>&nbsp;<span class="ident" id="3755205">syscall</span><span class="op" id="3755212">.</span><span class="ident" id="3755213">RTM_NEWLINK</span><span class="op" id="3755224">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3755229">ifim</span>&nbsp;<span class="op" id="3755234">:=</span>&nbsp;<span class="op" id="3755237">(</span><span class="op" id="3755238">*</span><span class="ident" id="3755239">syscall</span><span class="op" id="3755246">.</span><span class="ident" id="3755247">IfInfomsg</span><span class="op" id="3755256">)</span><span class="op" id="3755257">(</span><span class="ident" id="3755258">unsafe</span><span class="op" id="3755264">.</span><span class="ident" id="3755265">Pointer</span><span class="op" id="3755272">(</span><span class="op" id="3755273">&amp;</span><span class="ident" id="3755274">m</span><span class="op" id="3755275">.</span><span class="ident" id="3755276">Data</span><span class="op" id="3755280">[</span><span class="num" id="3755281">0</span><span class="op" id="3755282">]</span><span class="op" id="3755283">)</span><span class="op" id="3755284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755289">if</span>&nbsp;<span class="ident" id="3755292">ifindex</span>&nbsp;<span class="op" id="3755300">==</span>&nbsp;<span class="num" id="3755303">0</span>&nbsp;<span class="op" id="3755305">||</span>&nbsp;<span class="ident" id="3755308">ifindex</span>&nbsp;<span class="op" id="3755316">==</span>&nbsp;<span class="builtintype" id="3755319">int</span><span class="op" id="3755322">(</span><span class="ident" id="3755323">ifim</span><span class="op" id="3755327">.</span><span class="ident" id="3755328">Index</span><span class="op" id="3755333">)</span>&nbsp;<span class="op" id="3755335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3755341">attrs</span><span class="op" id="3755346">,</span>&nbsp;<span class="ident" id="3755348">err</span>&nbsp;<span class="op" id="3755352">:=</span>&nbsp;<span class="ident" id="3755355">syscall</span><span class="op" id="3755362">.</span><span class="ident" id="3755363">ParseNetlinkRouteAttr</span><span class="op" id="3755384">(</span><span class="op" id="3755385">&amp;</span><span class="ident" id="3755386">m</span><span class="op" id="3755387">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755393">if</span>&nbsp;<span class="ident" id="3755396">err</span>&nbsp;<span class="op" id="3755400">!=</span>&nbsp;<span class="builtintype" id="3755403">nil</span>&nbsp;<span class="op" id="3755407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755414">return</span>&nbsp;<span class="builtintype" id="3755421">nil</span><span class="op" id="3755424">,</span>&nbsp;<span class="ident" id="3755426">os</span><span class="op" id="3755428">.</span><span class="ident" id="3755429">NewSyscallError</span><span class="op" id="3755444">(</span><span class="string" id="3755445">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3755464">,</span>&nbsp;<span class="ident" id="3755466">err</span><span class="op" id="3755469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3755475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3755481">ift</span>&nbsp;<span class="op" id="3755485">=</span>&nbsp;<span class="builtinfunc" id="3755487">append</span><span class="op" id="3755493">(</span><span class="ident" id="3755494">ift</span><span class="op" id="3755497">,</span>&nbsp;<span class="op" id="3755499">*</span><span class="ident" id="3755500">newLink</span><span class="op" id="3755507">(</span><span class="ident" id="3755508">ifim</span><span class="op" id="3755512">,</span>&nbsp;<span class="ident" id="3755514">attrs</span><span class="op" id="3755519">)</span><span class="op" id="3755520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755526">if</span>&nbsp;<span class="ident" id="3755529">ifindex</span>&nbsp;<span class="op" id="3755537">==</span>&nbsp;<span class="builtintype" id="3755540">int</span><span class="op" id="3755543">(</span><span class="ident" id="3755544">ifim</span><span class="op" id="3755548">.</span><span class="ident" id="3755549">Index</span><span class="op" id="3755554">)</span>&nbsp;<span class="op" id="3755556">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755563">break</span>&nbsp;<span class="ident" id="3755569">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3755578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3755583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3755587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3755590">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755593">return</span>&nbsp;<span class="ident" id="3755600">ift</span><span class="op" id="3755603">,</span>&nbsp;<span class="builtintype" id="3755605">nil</span><br>
<span class="lineno"></span><span class="op" id="3755609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3755612">const</span>&nbsp;<span class="op" id="3755618">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3755621">//&nbsp;See&nbsp;linux/if_arp.h.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3755645">//&nbsp;Note&nbsp;that&nbsp;Linux&nbsp;doesn&#39;t&nbsp;support&nbsp;IPv4&nbsp;over&nbsp;IPv6&nbsp;tunneling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3755707">sysARPHardwareIPv4IPv4</span>&nbsp;<span class="op" id="3755730">=</span>&nbsp;<span class="num" id="3755732">768</span>&nbsp;<span class="comment" id="3755736">//&nbsp;IPv4&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3755765">sysARPHardwareIPv6IPv6</span>&nbsp;<span class="op" id="3755788">=</span>&nbsp;<span class="num" id="3755790">769</span>&nbsp;<span class="comment" id="3755794">//&nbsp;IPv6&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3755823">sysARPHardwareIPv6IPv4</span>&nbsp;<span class="op" id="3755846">=</span>&nbsp;<span class="num" id="3755848">776</span>&nbsp;<span class="comment" id="3755852">//&nbsp;IPv6&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3755881">sysARPHardwareGREIPv4</span>&nbsp;&nbsp;<span class="op" id="3755904">=</span>&nbsp;<span class="num" id="3755906">778</span>&nbsp;<span class="comment" id="3755910">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3755947">sysARPHardwareGREIPv6</span>&nbsp;&nbsp;<span class="op" id="3755970">=</span>&nbsp;<span class="num" id="3755972">823</span>&nbsp;<span class="comment" id="3755976">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span><span class="op" id="3756012">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3756015">func</span>&nbsp;<span class="ident" id="3756020">newLink</span><span class="op" id="3756027">(</span><span class="ident" id="3756028">ifim</span>&nbsp;<span class="op" id="3756033">*</span><span class="ident" id="3756034">syscall</span><span class="op" id="3756041">.</span><span class="ident" id="3756042">IfInfomsg</span><span class="op" id="3756051">,</span>&nbsp;<span class="ident" id="3756053">attrs</span>&nbsp;<span class="op" id="3756059">[</span><span class="op" id="3756060">]</span><span class="ident" id="3756061">syscall</span><span class="op" id="3756068">.</span><span class="ident" id="3756069">NetlinkRouteAttr</span><span class="op" id="3756085">)</span>&nbsp;<span class="op" id="3756087">*</span><span class="ident" id="3756088">Interface</span>&nbsp;<span class="op" id="3756098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3756101">ifi</span>&nbsp;<span class="op" id="3756105">:=</span>&nbsp;<span class="op" id="3756108">&amp;</span><span class="ident" id="3756109">Interface</span><span class="op" id="3756118">{</span><span class="ident" id="3756119">Index</span><span class="op" id="3756124">:</span>&nbsp;<span class="builtintype" id="3756126">int</span><span class="op" id="3756129">(</span><span class="ident" id="3756130">ifim</span><span class="op" id="3756134">.</span><span class="ident" id="3756135">Index</span><span class="op" id="3756140">)</span><span class="op" id="3756141">,</span>&nbsp;<span class="ident" id="3756143">Flags</span><span class="op" id="3756148">:</span>&nbsp;<span class="ident" id="3756150">linkFlags</span><span class="op" id="3756159">(</span><span class="ident" id="3756160">ifim</span><span class="op" id="3756164">.</span><span class="ident" id="3756165">Flags</span><span class="op" id="3756170">)</span><span class="op" id="3756171">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756174">for</span>&nbsp;<span class="ident" id="3756178">_</span><span class="op" id="3756179">,</span>&nbsp;<span class="ident" id="3756181">a</span>&nbsp;<span class="op" id="3756183">:=</span>&nbsp;<span class="keyword" id="3756186">range</span>&nbsp;<span class="ident" id="3756192">attrs</span>&nbsp;<span class="op" id="3756198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756202">switch</span>&nbsp;<span class="ident" id="3756209">a</span><span class="op" id="3756210">.</span><span class="ident" id="3756211">Attr</span><span class="op" id="3756215">.</span><span class="ident" id="3756216">Type</span>&nbsp;<span class="op" id="3756221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756225">case</span>&nbsp;<span class="ident" id="3756230">syscall</span><span class="op" id="3756237">.</span><span class="ident" id="3756238">IFLA_ADDRESS</span><span class="op" id="3756250">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3756255">//&nbsp;We&nbsp;never&nbsp;return&nbsp;any&nbsp;/32&nbsp;or&nbsp;/128&nbsp;IP&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3756304">//&nbsp;prefix&nbsp;on&nbsp;any&nbsp;IP&nbsp;tunnel&nbsp;interface&nbsp;as&nbsp;the</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3756351">//&nbsp;hardware&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756375">switch</span>&nbsp;<span class="builtinfunc" id="3756382">len</span><span class="op" id="3756385">(</span><span class="ident" id="3756386">a</span><span class="op" id="3756387">.</span><span class="ident" id="3756388">Value</span><span class="op" id="3756393">)</span>&nbsp;<span class="op" id="3756395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756400">case</span>&nbsp;<span class="ident" id="3756405">IPv4len</span><span class="op" id="3756412">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756418">switch</span>&nbsp;<span class="ident" id="3756425">ifim</span><span class="op" id="3756429">.</span><span class="ident" id="3756430">Type</span>&nbsp;<span class="op" id="3756435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756441">case</span>&nbsp;<span class="ident" id="3756446">sysARPHardwareIPv4IPv4</span><span class="op" id="3756468">,</span>&nbsp;<span class="ident" id="3756470">sysARPHardwareGREIPv4</span><span class="op" id="3756491">,</span>&nbsp;<span class="ident" id="3756493">sysARPHardwareIPv6IPv4</span><span class="op" id="3756515">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756522">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3756535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756540">case</span>&nbsp;<span class="ident" id="3756545">IPv6len</span><span class="op" id="3756552">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756558">switch</span>&nbsp;<span class="ident" id="3756565">ifim</span><span class="op" id="3756569">.</span><span class="ident" id="3756570">Type</span>&nbsp;<span class="op" id="3756575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756581">case</span>&nbsp;<span class="ident" id="3756586">sysARPHardwareIPv6IPv6</span><span class="op" id="3756608">,</span>&nbsp;<span class="ident" id="3756610">sysARPHardwareGREIPv6</span><span class="op" id="3756631">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756638">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3756651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3756656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756661">var</span>&nbsp;<span class="ident" id="3756665">nonzero</span>&nbsp;<span class="builtintype" id="3756673">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756681">for</span>&nbsp;<span class="ident" id="3756685">_</span><span class="op" id="3756686">,</span>&nbsp;<span class="ident" id="3756688">b</span>&nbsp;<span class="op" id="3756690">:=</span>&nbsp;<span class="keyword" id="3756693">range</span>&nbsp;<span class="ident" id="3756699">a</span><span class="op" id="3756700">.</span><span class="ident" id="3756701">Value</span>&nbsp;<span class="op" id="3756707">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756713">if</span>&nbsp;<span class="ident" id="3756716">b</span>&nbsp;<span class="op" id="3756718">!=</span>&nbsp;<span class="num" id="3756721">0</span>&nbsp;<span class="op" id="3756723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3756730">nonzero</span>&nbsp;<span class="op" id="3756738">=</span>&nbsp;<span class="builtintype" id="3756740">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756750">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3756760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3756765">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756770">if</span>&nbsp;<span class="ident" id="3756773">nonzero</span>&nbsp;<span class="op" id="3756781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3756787">ifi</span><span class="op" id="3756790">.</span><span class="ident" id="3756791">HardwareAddr</span>&nbsp;<span class="op" id="3756804">=</span>&nbsp;<span class="ident" id="3756806">a</span><span class="op" id="3756807">.</span><span class="ident" id="3756808">Value</span><span class="op" id="3756813">[</span><span class="op" id="3756814">:</span><span class="op" id="3756815">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3756820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756824">case</span>&nbsp;<span class="ident" id="3756829">syscall</span><span class="op" id="3756836">.</span><span class="ident" id="3756837">IFLA_IFNAME</span><span class="op" id="3756848">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3756853">ifi</span><span class="op" id="3756856">.</span><span class="ident" id="3756857">Name</span>&nbsp;<span class="op" id="3756862">=</span>&nbsp;<span class="builtintype" id="3756864">string</span><span class="op" id="3756870">(</span><span class="ident" id="3756871">a</span><span class="op" id="3756872">.</span><span class="ident" id="3756873">Value</span><span class="op" id="3756878">[</span><span class="op" id="3756879">:</span><span class="builtinfunc" id="3756880">len</span><span class="op" id="3756883">(</span><span class="ident" id="3756884">a</span><span class="op" id="3756885">.</span><span class="ident" id="3756886">Value</span><span class="op" id="3756891">)</span><span class="op" id="3756892">-</span><span class="num" id="3756893">1</span><span class="op" id="3756894">]</span><span class="op" id="3756895">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756899">case</span>&nbsp;<span class="ident" id="3756904">syscall</span><span class="op" id="3756911">.</span><span class="ident" id="3756912">IFLA_MTU</span><span class="op" id="3756920">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3756925">ifi</span><span class="op" id="3756928">.</span><span class="ident" id="3756929">MTU</span>&nbsp;<span class="op" id="3756933">=</span>&nbsp;<span class="builtintype" id="3756935">int</span><span class="op" id="3756938">(</span><span class="op" id="3756939">*</span><span class="op" id="3756940">(</span><span class="op" id="3756941">*</span><span class="builtintype" id="3756942">uint32</span><span class="op" id="3756948">)</span><span class="op" id="3756949">(</span><span class="ident" id="3756950">unsafe</span><span class="op" id="3756956">.</span><span class="ident" id="3756957">Pointer</span><span class="op" id="3756964">(</span><span class="op" id="3756965">&amp;</span><span class="ident" id="3756966">a</span><span class="op" id="3756967">.</span><span class="ident" id="3756968">Value</span><span class="op" id="3756973">[</span><span class="op" id="3756974">:</span><span class="num" id="3756975">4</span><span class="op" id="3756976">]</span><span class="op" id="3756977">[</span><span class="num" id="3756978">0</span><span class="op" id="3756979">]</span><span class="op" id="3756980">)</span><span class="op" id="3756981">)</span><span class="op" id="3756982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3756986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3756989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3756992">return</span>&nbsp;<span class="ident" id="3756999">ifi</span><br>
<span class="lineno">95</span><span class="op" id="3757003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3757006">func</span>&nbsp;<span class="ident" id="3757011">linkFlags</span><span class="op" id="3757020">(</span><span class="ident" id="3757021">rawFlags</span>&nbsp;<span class="builtintype" id="3757030">uint32</span><span class="op" id="3757036">)</span>&nbsp;<span class="ident" id="3757038">Flags</span>&nbsp;<span class="op" id="3757044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3757047">var</span>&nbsp;<span class="ident" id="3757051">f</span>&nbsp;<span class="ident" id="3757053">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3757060">if</span>&nbsp;<span class="ident" id="3757063">rawFlags</span><span class="op" id="3757071">&amp;</span><span class="ident" id="3757072">syscall</span><span class="op" id="3757079">.</span><span class="ident" id="3757080">IFF_UP</span>&nbsp;<span class="op" id="3757087">!=</span>&nbsp;<span class="num" id="3757090">0</span>&nbsp;<span class="op" id="3757092">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3757096">f</span>&nbsp;<span class="op" id="3757098">|=</span>&nbsp;<span class="ident" id="3757101">FlagUp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3757109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3757112">if</span>&nbsp;<span class="ident" id="3757115">rawFlags</span><span class="op" id="3757123">&amp;</span><span class="ident" id="3757124">syscall</span><span class="op" id="3757131">.</span><span class="ident" id="3757132">IFF_BROADCAST</span>&nbsp;<span class="op" id="3757146">!=</span>&nbsp;<span class="num" id="3757149">0</span>&nbsp;<span class="op" id="3757151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3757155">f</span>&nbsp;<span class="op" id="3757157">|=</span>&nbsp;<span class="ident" id="3757160">FlagBroadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3757175">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3757178">if</span>&nbsp;<span class="ident" id="3757181">rawFlags</span><span class="op" id="3757189">&amp;</span><span class="ident" id="3757190">syscall</span><span class="op" id="3757197">.</span><span class="ident" id="3757198">IFF_LOOPBACK</span>&nbsp;<span class="op" id="3757211">!=</span>&nbsp;<span class="num" id="3757214">0</span>&nbsp;<span class="op" id="3757216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3757220">f</span>&nbsp;<span class="op" id="3757222">|=</span>&nbsp;<span class="ident" id="3757225">FlagLoopback</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3757239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3757242">if</span>&nbsp;<span class="ident" id="3757245">rawFlags</span><span class="op" id="3757253">&amp;</span><span class="ident" id="3757254">syscall</span><span class="op" id="3757261">.</span><span class="ident" id="3757262">IFF_POINTOPOINT</span>&nbsp;<span class="op" id="3757278">!=</span>&nbsp;<span class="num" id="3757281">0</span>&nbsp;<span class="op" id="3757283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3757287">f</span>&nbsp;<span class="op" id="3757289">|=</span>&nbsp;<span class="ident" id="3757292">FlagPointToPoint</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3757310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3757313">if</span>&nbsp;<span class="ident" id="3757316">rawFlags</span><span class="op" id="3757324">&amp;</span><span class="ident" id="3757325">syscall</span><span class="op" id="3757332">.</span><span class="ident" id="3757333">IFF_MULTICAST</span>&nbsp;<span class="op" id="3757347">!=</span>&nbsp;<span class="num" id="3757350">0</span>&nbsp;<span class="op" id="3757352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3757356">f</span>&nbsp;<span class="op" id="3757358">|=</span>&nbsp;<span class="ident" id="3757361">FlagMulticast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3757376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3757379">return</span>&nbsp;<span class="ident" id="3757386">f</span><br>
<span class="lineno">115</span><span class="op" id="3757388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3757391">//&nbsp;If&nbsp;the&nbsp;ifi&nbsp;is&nbsp;nil,&nbsp;interfaceAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3757458">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno"></span><span class="comment" id="3757528">//&nbsp;interface.</span><br>
<span class="lineno">120</span><span class="keyword" id="3757542">func</span>&nbsp;<span class="ident" id="3757547">interfaceAddrTable</span><span class="op" id="3757565">(</span><span class="ident" id="3757566">ifi</span>&nbsp;<span class="op" id="3757570">*</span><span class="ident" id="3757571">Interface</span><span class="op" id="3757580">)</span>&nbsp;<span class="op" id="3757582">(</span><span class="op" id="3757583">[</span><span class="op" id="3757584">]</span><span class="ident" id="3757585">Addr</span><span class="op" id="3757589">,</span>&nbsp;<span class="builtintype" id="3757591">error</span><span class="op" id="3757596">)</span>&nbsp;<span class="op" id="3757598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3757601">tab</span><span class="op" id="3757604">,</span>&nbsp;<span class="ident" id="3757606">err</span>&nbsp;<span class="op" id="3757610">:=</span>&nbsp;<span class="ident" id="3757613">syscall</span><span class="op" id="3757620">.</span><span class="ident" id="3757621">NetlinkRIB</span><span class="op" id="3757631">(</span><span class="ident" id="3757632">syscall</span><span class="op" id="3757639">.</span><span class="ident" id="3757640">RTM_GETADDR</span><span class="op" id="3757651">,</span>&nbsp;<span class="ident" id="3757653">syscall</span><span class="op" id="3757660">.</span><span class="ident" id="3757661">AF_UNSPEC</span><span class="op" id="3757670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3757673">if</span>&nbsp;<span class="ident" id="3757676">err</span>&nbsp;<span class="op" id="3757680">!=</span>&nbsp;<span class="builtintype" id="3757683">nil</span>&nbsp;<span class="op" id="3757687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3757691">return</span>&nbsp;<span class="builtintype" id="3757698">nil</span><span class="op" id="3757701">,</span>&nbsp;<span class="ident" id="3757703">os</span><span class="op" id="3757705">.</span><span class="ident" id="3757706">NewSyscallError</span><span class="op" id="3757721">(</span><span class="string" id="3757722">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3757735">,</span>&nbsp;<span class="ident" id="3757737">err</span><span class="op" id="3757740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3757743">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3757746">msgs</span><span class="op" id="3757750">,</span>&nbsp;<span class="ident" id="3757752">err</span>&nbsp;<span class="op" id="3757756">:=</span>&nbsp;<span class="ident" id="3757759">syscall</span><span class="op" id="3757766">.</span><span class="ident" id="3757767">ParseNetlinkMessage</span><span class="op" id="3757786">(</span><span class="ident" id="3757787">tab</span><span class="op" id="3757790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3757793">if</span>&nbsp;<span class="ident" id="3757796">err</span>&nbsp;<span class="op" id="3757800">!=</span>&nbsp;<span class="builtintype" id="3757803">nil</span>&nbsp;<span class="op" id="3757807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3757811">return</span>&nbsp;<span class="builtintype" id="3757818">nil</span><span class="op" id="3757821">,</span>&nbsp;<span class="ident" id="3757823">os</span><span class="op" id="3757825">.</span><span class="ident" id="3757826">NewSyscallError</span><span class="op" id="3757841">(</span><span class="string" id="3757842">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3757859">,</span>&nbsp;<span class="ident" id="3757861">err</span><span class="op" id="3757864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3757867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3757870">var</span>&nbsp;<span class="ident" id="3757874">ift</span>&nbsp;<span class="op" id="3757878">[</span><span class="op" id="3757879">]</span><span class="ident" id="3757880">Interface</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3757891">if</span>&nbsp;<span class="ident" id="3757894">ifi</span>&nbsp;<span class="op" id="3757898">==</span>&nbsp;<span class="builtintype" id="3757901">nil</span>&nbsp;<span class="op" id="3757905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3757909">var</span>&nbsp;<span class="ident" id="3757913">err</span>&nbsp;<span class="builtintype" id="3757917">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3757925">ift</span><span class="op" id="3757928">,</span>&nbsp;<span class="ident" id="3757930">err</span>&nbsp;<span class="op" id="3757934">=</span>&nbsp;<span class="ident" id="3757936">interfaceTable</span><span class="op" id="3757950">(</span><span class="num" id="3757951">0</span><span class="op" id="3757952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3757956">if</span>&nbsp;<span class="ident" id="3757959">err</span>&nbsp;<span class="op" id="3757963">!=</span>&nbsp;<span class="builtintype" id="3757966">nil</span>&nbsp;<span class="op" id="3757970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3757975">return</span>&nbsp;<span class="builtintype" id="3757982">nil</span><span class="op" id="3757985">,</span>&nbsp;<span class="ident" id="3757987">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3757993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3757996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3757999">ifat</span><span class="op" id="3758003">,</span>&nbsp;<span class="ident" id="3758005">err</span>&nbsp;<span class="op" id="3758009">:=</span>&nbsp;<span class="ident" id="3758012">addrTable</span><span class="op" id="3758021">(</span><span class="ident" id="3758022">ift</span><span class="op" id="3758025">,</span>&nbsp;<span class="ident" id="3758027">ifi</span><span class="op" id="3758030">,</span>&nbsp;<span class="ident" id="3758032">msgs</span><span class="op" id="3758036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758039">if</span>&nbsp;<span class="ident" id="3758042">err</span>&nbsp;<span class="op" id="3758046">!=</span>&nbsp;<span class="builtintype" id="3758049">nil</span>&nbsp;<span class="op" id="3758053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758057">return</span>&nbsp;<span class="builtintype" id="3758064">nil</span><span class="op" id="3758067">,</span>&nbsp;<span class="ident" id="3758069">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3758074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758077">return</span>&nbsp;<span class="ident" id="3758084">ifat</span><span class="op" id="3758088">,</span>&nbsp;<span class="builtintype" id="3758090">nil</span><br>
<span class="lineno"></span><span class="op" id="3758094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3758097">func</span>&nbsp;<span class="ident" id="3758102">addrTable</span><span class="op" id="3758111">(</span><span class="ident" id="3758112">ift</span>&nbsp;<span class="op" id="3758116">[</span><span class="op" id="3758117">]</span><span class="ident" id="3758118">Interface</span><span class="op" id="3758127">,</span>&nbsp;<span class="ident" id="3758129">ifi</span>&nbsp;<span class="op" id="3758133">*</span><span class="ident" id="3758134">Interface</span><span class="op" id="3758143">,</span>&nbsp;<span class="ident" id="3758145">msgs</span>&nbsp;<span class="op" id="3758150">[</span><span class="op" id="3758151">]</span><span class="ident" id="3758152">syscall</span><span class="op" id="3758159">.</span><span class="ident" id="3758160">NetlinkMessage</span><span class="op" id="3758174">)</span>&nbsp;<span class="op" id="3758176">(</span><span class="op" id="3758177">[</span><span class="op" id="3758178">]</span><span class="ident" id="3758179">Addr</span><span class="op" id="3758183">,</span>&nbsp;<span class="builtintype" id="3758185">error</span><span class="op" id="3758190">)</span>&nbsp;<span class="op" id="3758192">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758195">var</span>&nbsp;<span class="ident" id="3758199">ifat</span>&nbsp;<span class="op" id="3758204">[</span><span class="op" id="3758205">]</span><span class="ident" id="3758206">Addr</span><br>
<span class="lineno"></span><span class="ident" id="3758211">loop</span><span class="op" id="3758215">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758218">for</span>&nbsp;<span class="ident" id="3758222">_</span><span class="op" id="3758223">,</span>&nbsp;<span class="ident" id="3758225">m</span>&nbsp;<span class="op" id="3758227">:=</span>&nbsp;<span class="keyword" id="3758230">range</span>&nbsp;<span class="ident" id="3758236">msgs</span>&nbsp;<span class="op" id="3758241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758245">switch</span>&nbsp;<span class="ident" id="3758252">m</span><span class="op" id="3758253">.</span><span class="ident" id="3758254">Header</span><span class="op" id="3758260">.</span><span class="ident" id="3758261">Type</span>&nbsp;<span class="op" id="3758266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758270">case</span>&nbsp;<span class="ident" id="3758275">syscall</span><span class="op" id="3758282">.</span><span class="ident" id="3758283">NLMSG_DONE</span><span class="op" id="3758293">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758298">break</span>&nbsp;<span class="ident" id="3758304">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758311">case</span>&nbsp;<span class="ident" id="3758316">syscall</span><span class="op" id="3758323">.</span><span class="ident" id="3758324">RTM_NEWADDR</span><span class="op" id="3758335">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3758340">ifam</span>&nbsp;<span class="op" id="3758345">:=</span>&nbsp;<span class="op" id="3758348">(</span><span class="op" id="3758349">*</span><span class="ident" id="3758350">syscall</span><span class="op" id="3758357">.</span><span class="ident" id="3758358">IfAddrmsg</span><span class="op" id="3758367">)</span><span class="op" id="3758368">(</span><span class="ident" id="3758369">unsafe</span><span class="op" id="3758375">.</span><span class="ident" id="3758376">Pointer</span><span class="op" id="3758383">(</span><span class="op" id="3758384">&amp;</span><span class="ident" id="3758385">m</span><span class="op" id="3758386">.</span><span class="ident" id="3758387">Data</span><span class="op" id="3758391">[</span><span class="num" id="3758392">0</span><span class="op" id="3758393">]</span><span class="op" id="3758394">)</span><span class="op" id="3758395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758400">if</span>&nbsp;<span class="builtinfunc" id="3758403">len</span><span class="op" id="3758406">(</span><span class="ident" id="3758407">ift</span><span class="op" id="3758410">)</span>&nbsp;<span class="op" id="3758412">!=</span>&nbsp;<span class="num" id="3758415">0</span>&nbsp;<span class="op" id="3758417">||</span>&nbsp;<span class="ident" id="3758420">ifi</span><span class="op" id="3758423">.</span><span class="ident" id="3758424">Index</span>&nbsp;<span class="op" id="3758430">==</span>&nbsp;<span class="builtintype" id="3758433">int</span><span class="op" id="3758436">(</span><span class="ident" id="3758437">ifam</span><span class="op" id="3758441">.</span><span class="ident" id="3758442">Index</span><span class="op" id="3758447">)</span>&nbsp;<span class="op" id="3758449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758455">if</span>&nbsp;<span class="builtinfunc" id="3758458">len</span><span class="op" id="3758461">(</span><span class="ident" id="3758462">ift</span><span class="op" id="3758465">)</span>&nbsp;<span class="op" id="3758467">!=</span>&nbsp;<span class="num" id="3758470">0</span>&nbsp;<span class="op" id="3758472">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758479">var</span>&nbsp;<span class="ident" id="3758483">err</span>&nbsp;<span class="builtintype" id="3758487">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3758498">ifi</span><span class="op" id="3758501">,</span>&nbsp;<span class="ident" id="3758503">err</span>&nbsp;<span class="op" id="3758507">=</span>&nbsp;<span class="ident" id="3758509">interfaceByIndex</span><span class="op" id="3758525">(</span><span class="ident" id="3758526">ift</span><span class="op" id="3758529">,</span>&nbsp;<span class="builtintype" id="3758531">int</span><span class="op" id="3758534">(</span><span class="ident" id="3758535">ifam</span><span class="op" id="3758539">.</span><span class="ident" id="3758540">Index</span><span class="op" id="3758545">)</span><span class="op" id="3758546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758553">if</span>&nbsp;<span class="ident" id="3758556">err</span>&nbsp;<span class="op" id="3758560">!=</span>&nbsp;<span class="builtintype" id="3758563">nil</span>&nbsp;<span class="op" id="3758567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758575">return</span>&nbsp;<span class="builtintype" id="3758582">nil</span><span class="op" id="3758585">,</span>&nbsp;<span class="ident" id="3758587">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3758596">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3758602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3758608">attrs</span><span class="op" id="3758613">,</span>&nbsp;<span class="ident" id="3758615">err</span>&nbsp;<span class="op" id="3758619">:=</span>&nbsp;<span class="ident" id="3758622">syscall</span><span class="op" id="3758629">.</span><span class="ident" id="3758630">ParseNetlinkRouteAttr</span><span class="op" id="3758651">(</span><span class="op" id="3758652">&amp;</span><span class="ident" id="3758653">m</span><span class="op" id="3758654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758660">if</span>&nbsp;<span class="ident" id="3758663">err</span>&nbsp;<span class="op" id="3758667">!=</span>&nbsp;<span class="builtintype" id="3758670">nil</span>&nbsp;<span class="op" id="3758674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758681">return</span>&nbsp;<span class="builtintype" id="3758688">nil</span><span class="op" id="3758691">,</span>&nbsp;<span class="ident" id="3758693">os</span><span class="op" id="3758695">.</span><span class="ident" id="3758696">NewSyscallError</span><span class="op" id="3758711">(</span><span class="string" id="3758712">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3758731">,</span>&nbsp;<span class="ident" id="3758733">err</span><span class="op" id="3758736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3758742">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3758748">ifa</span>&nbsp;<span class="op" id="3758752">:=</span>&nbsp;<span class="ident" id="3758755">newAddr</span><span class="op" id="3758762">(</span><span class="ident" id="3758763">ifi</span><span class="op" id="3758766">,</span>&nbsp;<span class="ident" id="3758768">ifam</span><span class="op" id="3758772">,</span>&nbsp;<span class="ident" id="3758774">attrs</span><span class="op" id="3758779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758785">if</span>&nbsp;<span class="ident" id="3758788">ifa</span>&nbsp;<span class="op" id="3758792">!=</span>&nbsp;<span class="builtintype" id="3758795">nil</span>&nbsp;<span class="op" id="3758799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3758806">ifat</span>&nbsp;<span class="op" id="3758811">=</span>&nbsp;<span class="builtinfunc" id="3758813">append</span><span class="op" id="3758819">(</span><span class="ident" id="3758820">ifat</span><span class="op" id="3758824">,</span>&nbsp;<span class="ident" id="3758826">ifa</span><span class="op" id="3758829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3758835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3758840">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3758844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3758847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758850">return</span>&nbsp;<span class="ident" id="3758857">ifat</span><span class="op" id="3758861">,</span>&nbsp;<span class="builtintype" id="3758863">nil</span><br>
<span class="lineno"></span><span class="op" id="3758867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="3758870">func</span>&nbsp;<span class="ident" id="3758875">newAddr</span><span class="op" id="3758882">(</span><span class="ident" id="3758883">ifi</span>&nbsp;<span class="op" id="3758887">*</span><span class="ident" id="3758888">Interface</span><span class="op" id="3758897">,</span>&nbsp;<span class="ident" id="3758899">ifam</span>&nbsp;<span class="op" id="3758904">*</span><span class="ident" id="3758905">syscall</span><span class="op" id="3758912">.</span><span class="ident" id="3758913">IfAddrmsg</span><span class="op" id="3758922">,</span>&nbsp;<span class="ident" id="3758924">attrs</span>&nbsp;<span class="op" id="3758930">[</span><span class="op" id="3758931">]</span><span class="ident" id="3758932">syscall</span><span class="op" id="3758939">.</span><span class="ident" id="3758940">NetlinkRouteAttr</span><span class="op" id="3758956">)</span>&nbsp;<span class="ident" id="3758958">Addr</span>&nbsp;<span class="op" id="3758963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3758966">var</span>&nbsp;<span class="ident" id="3758970">ipPointToPoint</span>&nbsp;<span class="builtintype" id="3758985">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3758991">//&nbsp;Seems&nbsp;like&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;whether&nbsp;the&nbsp;IP&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3759052">//&nbsp;stack&nbsp;consists&nbsp;of&nbsp;IP&nbsp;point-to-point&nbsp;numbered&nbsp;or&nbsp;unnumbered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3759115">//&nbsp;addressing&nbsp;over&nbsp;point-to-point&nbsp;link&nbsp;encapsulation.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3759170">if</span>&nbsp;<span class="ident" id="3759173">ifi</span><span class="op" id="3759176">.</span><span class="ident" id="3759177">Flags</span><span class="op" id="3759182">&amp;</span><span class="ident" id="3759183">FlagPointToPoint</span>&nbsp;<span class="op" id="3759200">!=</span>&nbsp;<span class="num" id="3759203">0</span>&nbsp;<span class="op" id="3759205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3759209">for</span>&nbsp;<span class="ident" id="3759213">_</span><span class="op" id="3759214">,</span>&nbsp;<span class="ident" id="3759216">a</span>&nbsp;<span class="op" id="3759218">:=</span>&nbsp;<span class="keyword" id="3759221">range</span>&nbsp;<span class="ident" id="3759227">attrs</span>&nbsp;<span class="op" id="3759233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3759238">if</span>&nbsp;<span class="ident" id="3759241">a</span><span class="op" id="3759242">.</span><span class="ident" id="3759243">Attr</span><span class="op" id="3759247">.</span><span class="ident" id="3759248">Type</span>&nbsp;<span class="op" id="3759253">==</span>&nbsp;<span class="ident" id="3759256">syscall</span><span class="op" id="3759263">.</span><span class="ident" id="3759264">IFA_LOCAL</span>&nbsp;<span class="op" id="3759274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3759280">ipPointToPoint</span>&nbsp;<span class="op" id="3759295">=</span>&nbsp;<span class="builtintype" id="3759297">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3759306">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3759315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3759319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3759322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3759325">for</span>&nbsp;<span class="ident" id="3759329">_</span><span class="op" id="3759330">,</span>&nbsp;<span class="ident" id="3759332">a</span>&nbsp;<span class="op" id="3759334">:=</span>&nbsp;<span class="keyword" id="3759337">range</span>&nbsp;<span class="ident" id="3759343">attrs</span>&nbsp;<span class="op" id="3759349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3759353">if</span>&nbsp;<span class="ident" id="3759356">ipPointToPoint</span>&nbsp;<span class="op" id="3759371">&amp;&amp;</span>&nbsp;<span class="ident" id="3759374">a</span><span class="op" id="3759375">.</span><span class="ident" id="3759376">Attr</span><span class="op" id="3759380">.</span><span class="ident" id="3759381">Type</span>&nbsp;<span class="op" id="3759386">==</span>&nbsp;<span class="ident" id="3759389">syscall</span><span class="op" id="3759396">.</span><span class="ident" id="3759397">IFA_ADDRESS</span>&nbsp;<span class="op" id="3759409">||</span>&nbsp;<span class="op" id="3759412">!</span><span class="ident" id="3759413">ipPointToPoint</span>&nbsp;<span class="op" id="3759428">&amp;&amp;</span>&nbsp;<span class="ident" id="3759431">a</span><span class="op" id="3759432">.</span><span class="ident" id="3759433">Attr</span><span class="op" id="3759437">.</span><span class="ident" id="3759438">Type</span>&nbsp;<span class="op" id="3759443">==</span>&nbsp;<span class="ident" id="3759446">syscall</span><span class="op" id="3759453">.</span><span class="ident" id="3759454">IFA_LOCAL</span>&nbsp;<span class="op" id="3759464">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3759469">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3759480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3759484">switch</span>&nbsp;<span class="ident" id="3759491">ifam</span><span class="op" id="3759495">.</span><span class="ident" id="3759496">Family</span>&nbsp;<span class="op" id="3759503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3759507">case</span>&nbsp;<span class="ident" id="3759512">syscall</span><span class="op" id="3759519">.</span><span class="ident" id="3759520">AF_INET</span><span class="op" id="3759527">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3759532">return</span>&nbsp;<span class="op" id="3759539">&amp;</span><span class="ident" id="3759540">IPNet</span><span class="op" id="3759545">{</span><span class="ident" id="3759546">IP</span><span class="op" id="3759548">:</span>&nbsp;<span class="ident" id="3759550">IPv4</span><span class="op" id="3759554">(</span><span class="ident" id="3759555">a</span><span class="op" id="3759556">.</span><span class="ident" id="3759557">Value</span><span class="op" id="3759562">[</span><span class="num" id="3759563">0</span><span class="op" id="3759564">]</span><span class="op" id="3759565">,</span>&nbsp;<span class="ident" id="3759567">a</span><span class="op" id="3759568">.</span><span class="ident" id="3759569">Value</span><span class="op" id="3759574">[</span><span class="num" id="3759575">1</span><span class="op" id="3759576">]</span><span class="op" id="3759577">,</span>&nbsp;<span class="ident" id="3759579">a</span><span class="op" id="3759580">.</span><span class="ident" id="3759581">Value</span><span class="op" id="3759586">[</span><span class="num" id="3759587">2</span><span class="op" id="3759588">]</span><span class="op" id="3759589">,</span>&nbsp;<span class="ident" id="3759591">a</span><span class="op" id="3759592">.</span><span class="ident" id="3759593">Value</span><span class="op" id="3759598">[</span><span class="num" id="3759599">3</span><span class="op" id="3759600">]</span><span class="op" id="3759601">)</span><span class="op" id="3759602">,</span>&nbsp;<span class="ident" id="3759604">Mask</span><span class="op" id="3759608">:</span>&nbsp;<span class="ident" id="3759610">CIDRMask</span><span class="op" id="3759618">(</span><span class="builtintype" id="3759619">int</span><span class="op" id="3759622">(</span><span class="ident" id="3759623">ifam</span><span class="op" id="3759627">.</span><span class="ident" id="3759628">Prefixlen</span><span class="op" id="3759637">)</span><span class="op" id="3759638">,</span>&nbsp;<span class="num" id="3759640">8</span><span class="op" id="3759641">*</span><span class="ident" id="3759642">IPv4len</span><span class="op" id="3759649">)</span><span class="op" id="3759650">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3759654">case</span>&nbsp;<span class="ident" id="3759659">syscall</span><span class="op" id="3759666">.</span><span class="ident" id="3759667">AF_INET6</span><span class="op" id="3759675">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3759680">ifa</span>&nbsp;<span class="op" id="3759684">:=</span>&nbsp;<span class="op" id="3759687">&amp;</span><span class="ident" id="3759688">IPNet</span><span class="op" id="3759693">{</span><span class="ident" id="3759694">IP</span><span class="op" id="3759696">:</span>&nbsp;<span class="builtinfunc" id="3759698">make</span><span class="op" id="3759702">(</span><span class="ident" id="3759703">IP</span><span class="op" id="3759705">,</span>&nbsp;<span class="ident" id="3759707">IPv6len</span><span class="op" id="3759714">)</span><span class="op" id="3759715">,</span>&nbsp;<span class="ident" id="3759717">Mask</span><span class="op" id="3759721">:</span>&nbsp;<span class="ident" id="3759723">CIDRMask</span><span class="op" id="3759731">(</span><span class="builtintype" id="3759732">int</span><span class="op" id="3759735">(</span><span class="ident" id="3759736">ifam</span><span class="op" id="3759740">.</span><span class="ident" id="3759741">Prefixlen</span><span class="op" id="3759750">)</span><span class="op" id="3759751">,</span>&nbsp;<span class="num" id="3759753">8</span><span class="op" id="3759754">*</span><span class="ident" id="3759755">IPv6len</span><span class="op" id="3759762">)</span><span class="op" id="3759763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3759768">copy</span><span class="op" id="3759772">(</span><span class="ident" id="3759773">ifa</span><span class="op" id="3759776">.</span><span class="ident" id="3759777">IP</span><span class="op" id="3759779">,</span>&nbsp;<span class="ident" id="3759781">a</span><span class="op" id="3759782">.</span><span class="ident" id="3759783">Value</span><span class="op" id="3759788">[</span><span class="op" id="3759789">:</span><span class="op" id="3759790">]</span><span class="op" id="3759791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3759796">return</span>&nbsp;<span class="ident" id="3759803">ifa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3759809">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3759812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3759815">return</span>&nbsp;<span class="builtintype" id="3759822">nil</span><br>
<span class="lineno"></span><span class="op" id="3759826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3759829">//&nbsp;interfaceMulticastAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno">205</span><span class="comment" id="3759893">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3759907">func</span>&nbsp;<span class="ident" id="3759912">interfaceMulticastAddrTable</span><span class="op" id="3759939">(</span><span class="ident" id="3759940">ifi</span>&nbsp;<span class="op" id="3759944">*</span><span class="ident" id="3759945">Interface</span><span class="op" id="3759954">)</span>&nbsp;<span class="op" id="3759956">(</span><span class="op" id="3759957">[</span><span class="op" id="3759958">]</span><span class="ident" id="3759959">Addr</span><span class="op" id="3759963">,</span>&nbsp;<span class="builtintype" id="3759965">error</span><span class="op" id="3759970">)</span>&nbsp;<span class="op" id="3759972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3759975">ifmat4</span>&nbsp;<span class="op" id="3759982">:=</span>&nbsp;<span class="ident" id="3759985">parseProcNetIGMP</span><span class="op" id="3760001">(</span><span class="string" id="3760002">&#34;/proc/net/igmp&#34;</span><span class="op" id="3760018">,</span>&nbsp;<span class="ident" id="3760020">ifi</span><span class="op" id="3760023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3760026">ifmat6</span>&nbsp;<span class="op" id="3760033">:=</span>&nbsp;<span class="ident" id="3760036">parseProcNetIGMP6</span><span class="op" id="3760053">(</span><span class="string" id="3760054">&#34;/proc/net/igmp6&#34;</span><span class="op" id="3760071">,</span>&nbsp;<span class="ident" id="3760073">ifi</span><span class="op" id="3760076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3760079">return</span>&nbsp;<span class="builtinfunc" id="3760086">append</span><span class="op" id="3760092">(</span><span class="ident" id="3760093">ifmat4</span><span class="op" id="3760099">,</span>&nbsp;<span class="ident" id="3760101">ifmat6</span><span class="op" id="3760107">...</span><span class="op" id="3760110">)</span><span class="op" id="3760111">,</span>&nbsp;<span class="builtintype" id="3760113">nil</span><br>
<span class="lineno">210</span><span class="op" id="3760117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3760120">func</span>&nbsp;<span class="ident" id="3760125">parseProcNetIGMP</span><span class="op" id="3760141">(</span><span class="ident" id="3760142">path</span>&nbsp;<span class="builtintype" id="3760147">string</span><span class="op" id="3760153">,</span>&nbsp;<span class="ident" id="3760155">ifi</span>&nbsp;<span class="op" id="3760159">*</span><span class="ident" id="3760160">Interface</span><span class="op" id="3760169">)</span>&nbsp;<span class="op" id="3760171">[</span><span class="op" id="3760172">]</span><span class="ident" id="3760173">Addr</span>&nbsp;<span class="op" id="3760178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3760181">fd</span><span class="op" id="3760183">,</span>&nbsp;<span class="ident" id="3760185">err</span>&nbsp;<span class="op" id="3760189">:=</span>&nbsp;<span class="ident" id="3760192">open</span><span class="op" id="3760196">(</span><span class="ident" id="3760197">path</span><span class="op" id="3760201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3760204">if</span>&nbsp;<span class="ident" id="3760207">err</span>&nbsp;<span class="op" id="3760211">!=</span>&nbsp;<span class="builtintype" id="3760214">nil</span>&nbsp;<span class="op" id="3760218">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3760222">return</span>&nbsp;<span class="builtintype" id="3760229">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3760234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3760237">defer</span>&nbsp;<span class="ident" id="3760243">fd</span><span class="op" id="3760245">.</span><span class="builtinfunc" id="3760246">close</span><span class="op" id="3760251">(</span><span class="op" id="3760252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3760255">var</span>&nbsp;<span class="op" id="3760259">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3760263">ifmat</span>&nbsp;<span class="op" id="3760269">[</span><span class="op" id="3760270">]</span><span class="ident" id="3760271">Addr</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3760278">name</span>&nbsp;&nbsp;<span class="builtintype" id="3760284">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3760292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3760295">fd</span><span class="op" id="3760297">.</span><span class="ident" id="3760298">readLine</span><span class="op" id="3760306">(</span><span class="op" id="3760307">)</span>&nbsp;<span class="comment" id="3760309">//&nbsp;skip&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3760329">b</span>&nbsp;<span class="op" id="3760331">:=</span>&nbsp;<span class="builtinfunc" id="3760334">make</span><span class="op" id="3760338">(</span><span class="op" id="3760339">[</span><span class="op" id="3760340">]</span><span class="builtintype" id="3760341">byte</span><span class="op" id="3760345">,</span>&nbsp;<span class="ident" id="3760347">IPv4len</span><span class="op" id="3760354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3760357">for</span>&nbsp;<span class="ident" id="3760361">l</span><span class="op" id="3760362">,</span>&nbsp;<span class="ident" id="3760364">ok</span>&nbsp;<span class="op" id="3760367">:=</span>&nbsp;<span class="ident" id="3760370">fd</span><span class="op" id="3760372">.</span><span class="ident" id="3760373">readLine</span><span class="op" id="3760381">(</span><span class="op" id="3760382">)</span><span class="op" id="3760383">;</span>&nbsp;<span class="ident" id="3760385">ok</span><span class="op" id="3760387">;</span>&nbsp;<span class="ident" id="3760389">l</span><span class="op" id="3760390">,</span>&nbsp;<span class="ident" id="3760392">ok</span>&nbsp;<span class="op" id="3760395">=</span>&nbsp;<span class="ident" id="3760397">fd</span><span class="op" id="3760399">.</span><span class="ident" id="3760400">readLine</span><span class="op" id="3760408">(</span><span class="op" id="3760409">)</span>&nbsp;<span class="op" id="3760411">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3760415">f</span>&nbsp;<span class="op" id="3760417">:=</span>&nbsp;<span class="ident" id="3760420">splitAtBytes</span><span class="op" id="3760432">(</span><span class="ident" id="3760433">l</span><span class="op" id="3760434">,</span>&nbsp;<span class="string" id="3760436">&#34;&nbsp;:\r\t\n&#34;</span><span class="op" id="3760446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3760450">if</span>&nbsp;<span class="builtinfunc" id="3760453">len</span><span class="op" id="3760456">(</span><span class="ident" id="3760457">f</span><span class="op" id="3760458">)</span>&nbsp;<span class="op" id="3760460">&lt;</span>&nbsp;<span class="num" id="3760462">4</span>&nbsp;<span class="op" id="3760464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3760469">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3760480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3760484">switch</span>&nbsp;<span class="op" id="3760491">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3760495">case</span>&nbsp;<span class="ident" id="3760500">l</span><span class="op" id="3760501">[</span><span class="num" id="3760502">0</span><span class="op" id="3760503">]</span>&nbsp;<span class="op" id="3760505">!=</span>&nbsp;<span class="string" id="3760508">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3760512">&amp;&amp;</span>&nbsp;<span class="ident" id="3760515">l</span><span class="op" id="3760516">[</span><span class="num" id="3760517">0</span><span class="op" id="3760518">]</span>&nbsp;<span class="op" id="3760520">!=</span>&nbsp;<span class="string" id="3760523">&#39;\t&#39;</span><span class="op" id="3760527">:</span>&nbsp;<span class="comment" id="3760529">//&nbsp;new&nbsp;interface&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3760554">name</span>&nbsp;<span class="op" id="3760559">=</span>&nbsp;<span class="ident" id="3760561">f</span><span class="op" id="3760562">[</span><span class="num" id="3760563">1</span><span class="op" id="3760564">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3760568">case</span>&nbsp;<span class="builtinfunc" id="3760573">len</span><span class="op" id="3760576">(</span><span class="ident" id="3760577">f</span><span class="op" id="3760578">[</span><span class="num" id="3760579">0</span><span class="op" id="3760580">]</span><span class="op" id="3760581">)</span>&nbsp;<span class="op" id="3760583">==</span>&nbsp;<span class="num" id="3760586">8</span><span class="op" id="3760587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3760592">if</span>&nbsp;<span class="ident" id="3760595">ifi</span>&nbsp;<span class="op" id="3760599">==</span>&nbsp;<span class="builtintype" id="3760602">nil</span>&nbsp;<span class="op" id="3760606">||</span>&nbsp;<span class="ident" id="3760609">name</span>&nbsp;<span class="op" id="3760614">==</span>&nbsp;<span class="ident" id="3760617">ifi</span><span class="op" id="3760620">.</span><span class="ident" id="3760621">Name</span>&nbsp;<span class="op" id="3760626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3760632">//&nbsp;The&nbsp;Linux&nbsp;kernel&nbsp;puts&nbsp;the&nbsp;IP</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3760668">//&nbsp;address&nbsp;in&nbsp;/proc/net/igmp&nbsp;in&nbsp;native</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3760711">//&nbsp;endianness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3760730">for</span>&nbsp;<span class="ident" id="3760734">i</span>&nbsp;<span class="op" id="3760736">:=</span>&nbsp;<span class="num" id="3760739">0</span><span class="op" id="3760740">;</span>&nbsp;<span class="ident" id="3760742">i</span><span class="op" id="3760743">+</span><span class="num" id="3760744">1</span>&nbsp;<span class="op" id="3760746">&lt;</span>&nbsp;<span class="builtinfunc" id="3760748">len</span><span class="op" id="3760751">(</span><span class="ident" id="3760752">f</span><span class="op" id="3760753">[</span><span class="num" id="3760754">0</span><span class="op" id="3760755">]</span><span class="op" id="3760756">)</span><span class="op" id="3760757">;</span>&nbsp;<span class="ident" id="3760759">i</span>&nbsp;<span class="op" id="3760761">+=</span>&nbsp;<span class="num" id="3760764">2</span>&nbsp;<span class="op" id="3760766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3760773">b</span><span class="op" id="3760774">[</span><span class="ident" id="3760775">i</span><span class="op" id="3760776">/</span><span class="num" id="3760777">2</span><span class="op" id="3760778">]</span><span class="op" id="3760779">,</span>&nbsp;<span class="ident" id="3760781">_</span>&nbsp;<span class="op" id="3760783">=</span>&nbsp;<span class="ident" id="3760785">xtoi2</span><span class="op" id="3760790">(</span><span class="ident" id="3760791">f</span><span class="op" id="3760792">[</span><span class="num" id="3760793">0</span><span class="op" id="3760794">]</span><span class="op" id="3760795">[</span><span class="ident" id="3760796">i</span><span class="op" id="3760797">:</span><span class="ident" id="3760798">i</span><span class="op" id="3760799">+</span><span class="num" id="3760800">2</span><span class="op" id="3760801">]</span><span class="op" id="3760802">,</span>&nbsp;<span class="num" id="3760804">0</span><span class="op" id="3760805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3760811">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3760817">i</span>&nbsp;<span class="op" id="3760819">:=</span>&nbsp;<span class="op" id="3760822">*</span><span class="op" id="3760823">(</span><span class="op" id="3760824">*</span><span class="builtintype" id="3760825">uint32</span><span class="op" id="3760831">)</span><span class="op" id="3760832">(</span><span class="ident" id="3760833">unsafe</span><span class="op" id="3760839">.</span><span class="ident" id="3760840">Pointer</span><span class="op" id="3760847">(</span><span class="op" id="3760848">&amp;</span><span class="ident" id="3760849">b</span><span class="op" id="3760850">[</span><span class="op" id="3760851">:</span><span class="num" id="3760852">4</span><span class="op" id="3760853">]</span><span class="op" id="3760854">[</span><span class="num" id="3760855">0</span><span class="op" id="3760856">]</span><span class="op" id="3760857">)</span><span class="op" id="3760858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3760864">ifma</span>&nbsp;<span class="op" id="3760869">:=</span>&nbsp;<span class="ident" id="3760872">IPAddr</span><span class="op" id="3760878">{</span><span class="ident" id="3760879">IP</span><span class="op" id="3760881">:</span>&nbsp;<span class="ident" id="3760883">IPv4</span><span class="op" id="3760887">(</span><span class="builtintype" id="3760888">byte</span><span class="op" id="3760892">(</span><span class="ident" id="3760893">i</span><span class="op" id="3760894">&gt;&gt;</span><span class="num" id="3760896">24</span><span class="op" id="3760898">)</span><span class="op" id="3760899">,</span>&nbsp;<span class="builtintype" id="3760901">byte</span><span class="op" id="3760905">(</span><span class="ident" id="3760906">i</span><span class="op" id="3760907">&gt;&gt;</span><span class="num" id="3760909">16</span><span class="op" id="3760911">)</span><span class="op" id="3760912">,</span>&nbsp;<span class="builtintype" id="3760914">byte</span><span class="op" id="3760918">(</span><span class="ident" id="3760919">i</span><span class="op" id="3760920">&gt;&gt;</span><span class="num" id="3760922">8</span><span class="op" id="3760923">)</span><span class="op" id="3760924">,</span>&nbsp;<span class="builtintype" id="3760926">byte</span><span class="op" id="3760930">(</span><span class="ident" id="3760931">i</span><span class="op" id="3760932">)</span><span class="op" id="3760933">)</span><span class="op" id="3760934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3760940">ifmat</span>&nbsp;<span class="op" id="3760946">=</span>&nbsp;<span class="builtinfunc" id="3760948">append</span><span class="op" id="3760954">(</span><span class="ident" id="3760955">ifmat</span><span class="op" id="3760960">,</span>&nbsp;<span class="ident" id="3760962">ifma</span><span class="op" id="3760966">.</span><span class="ident" id="3760967">toAddr</span><span class="op" id="3760973">(</span><span class="op" id="3760974">)</span><span class="op" id="3760975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3760980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3760984">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3760987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3760990">return</span>&nbsp;<span class="ident" id="3760997">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3761003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3761006">func</span>&nbsp;<span class="ident" id="3761011">parseProcNetIGMP6</span><span class="op" id="3761028">(</span><span class="ident" id="3761029">path</span>&nbsp;<span class="builtintype" id="3761034">string</span><span class="op" id="3761040">,</span>&nbsp;<span class="ident" id="3761042">ifi</span>&nbsp;<span class="op" id="3761046">*</span><span class="ident" id="3761047">Interface</span><span class="op" id="3761056">)</span>&nbsp;<span class="op" id="3761058">[</span><span class="op" id="3761059">]</span><span class="ident" id="3761060">Addr</span>&nbsp;<span class="op" id="3761065">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3761068">fd</span><span class="op" id="3761070">,</span>&nbsp;<span class="ident" id="3761072">err</span>&nbsp;<span class="op" id="3761076">:=</span>&nbsp;<span class="ident" id="3761079">open</span><span class="op" id="3761083">(</span><span class="ident" id="3761084">path</span><span class="op" id="3761088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3761091">if</span>&nbsp;<span class="ident" id="3761094">err</span>&nbsp;<span class="op" id="3761098">!=</span>&nbsp;<span class="builtintype" id="3761101">nil</span>&nbsp;<span class="op" id="3761105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3761109">return</span>&nbsp;<span class="builtintype" id="3761116">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3761121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3761124">defer</span>&nbsp;<span class="ident" id="3761130">fd</span><span class="op" id="3761132">.</span><span class="builtinfunc" id="3761133">close</span><span class="op" id="3761138">(</span><span class="op" id="3761139">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3761142">var</span>&nbsp;<span class="ident" id="3761146">ifmat</span>&nbsp;<span class="op" id="3761152">[</span><span class="op" id="3761153">]</span><span class="ident" id="3761154">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3761160">b</span>&nbsp;<span class="op" id="3761162">:=</span>&nbsp;<span class="builtinfunc" id="3761165">make</span><span class="op" id="3761169">(</span><span class="op" id="3761170">[</span><span class="op" id="3761171">]</span><span class="builtintype" id="3761172">byte</span><span class="op" id="3761176">,</span>&nbsp;<span class="ident" id="3761178">IPv6len</span><span class="op" id="3761185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3761188">for</span>&nbsp;<span class="ident" id="3761192">l</span><span class="op" id="3761193">,</span>&nbsp;<span class="ident" id="3761195">ok</span>&nbsp;<span class="op" id="3761198">:=</span>&nbsp;<span class="ident" id="3761201">fd</span><span class="op" id="3761203">.</span><span class="ident" id="3761204">readLine</span><span class="op" id="3761212">(</span><span class="op" id="3761213">)</span><span class="op" id="3761214">;</span>&nbsp;<span class="ident" id="3761216">ok</span><span class="op" id="3761218">;</span>&nbsp;<span class="ident" id="3761220">l</span><span class="op" id="3761221">,</span>&nbsp;<span class="ident" id="3761223">ok</span>&nbsp;<span class="op" id="3761226">=</span>&nbsp;<span class="ident" id="3761228">fd</span><span class="op" id="3761230">.</span><span class="ident" id="3761231">readLine</span><span class="op" id="3761239">(</span><span class="op" id="3761240">)</span>&nbsp;<span class="op" id="3761242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3761246">f</span>&nbsp;<span class="op" id="3761248">:=</span>&nbsp;<span class="ident" id="3761251">splitAtBytes</span><span class="op" id="3761263">(</span><span class="ident" id="3761264">l</span><span class="op" id="3761265">,</span>&nbsp;<span class="string" id="3761267">&#34;&nbsp;\r\t\n&#34;</span><span class="op" id="3761276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3761280">if</span>&nbsp;<span class="builtinfunc" id="3761283">len</span><span class="op" id="3761286">(</span><span class="ident" id="3761287">f</span><span class="op" id="3761288">)</span>&nbsp;<span class="op" id="3761290">&lt;</span>&nbsp;<span class="num" id="3761292">6</span>&nbsp;<span class="op" id="3761294">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3761299">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3761310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3761314">if</span>&nbsp;<span class="ident" id="3761317">ifi</span>&nbsp;<span class="op" id="3761321">==</span>&nbsp;<span class="builtintype" id="3761324">nil</span>&nbsp;<span class="op" id="3761328">||</span>&nbsp;<span class="ident" id="3761331">f</span><span class="op" id="3761332">[</span><span class="num" id="3761333">1</span><span class="op" id="3761334">]</span>&nbsp;<span class="op" id="3761336">==</span>&nbsp;<span class="ident" id="3761339">ifi</span><span class="op" id="3761342">.</span><span class="ident" id="3761343">Name</span>&nbsp;<span class="op" id="3761348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3761353">for</span>&nbsp;<span class="ident" id="3761357">i</span>&nbsp;<span class="op" id="3761359">:=</span>&nbsp;<span class="num" id="3761362">0</span><span class="op" id="3761363">;</span>&nbsp;<span class="ident" id="3761365">i</span><span class="op" id="3761366">+</span><span class="num" id="3761367">1</span>&nbsp;<span class="op" id="3761369">&lt;</span>&nbsp;<span class="builtinfunc" id="3761371">len</span><span class="op" id="3761374">(</span><span class="ident" id="3761375">f</span><span class="op" id="3761376">[</span><span class="num" id="3761377">2</span><span class="op" id="3761378">]</span><span class="op" id="3761379">)</span><span class="op" id="3761380">;</span>&nbsp;<span class="ident" id="3761382">i</span>&nbsp;<span class="op" id="3761384">+=</span>&nbsp;<span class="num" id="3761387">2</span>&nbsp;<span class="op" id="3761389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3761395">b</span><span class="op" id="3761396">[</span><span class="ident" id="3761397">i</span><span class="op" id="3761398">/</span><span class="num" id="3761399">2</span><span class="op" id="3761400">]</span><span class="op" id="3761401">,</span>&nbsp;<span class="ident" id="3761403">_</span>&nbsp;<span class="op" id="3761405">=</span>&nbsp;<span class="ident" id="3761407">xtoi2</span><span class="op" id="3761412">(</span><span class="ident" id="3761413">f</span><span class="op" id="3761414">[</span><span class="num" id="3761415">2</span><span class="op" id="3761416">]</span><span class="op" id="3761417">[</span><span class="ident" id="3761418">i</span><span class="op" id="3761419">:</span><span class="ident" id="3761420">i</span><span class="op" id="3761421">+</span><span class="num" id="3761422">2</span><span class="op" id="3761423">]</span><span class="op" id="3761424">,</span>&nbsp;<span class="num" id="3761426">0</span><span class="op" id="3761427">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3761432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3761437">ifma</span>&nbsp;<span class="op" id="3761442">:=</span>&nbsp;<span class="ident" id="3761445">IPAddr</span><span class="op" id="3761451">{</span><span class="ident" id="3761452">IP</span><span class="op" id="3761454">:</span>&nbsp;<span class="ident" id="3761456">IP</span><span class="op" id="3761458">{</span><span class="ident" id="3761459">b</span><span class="op" id="3761460">[</span><span class="num" id="3761461">0</span><span class="op" id="3761462">]</span><span class="op" id="3761463">,</span>&nbsp;<span class="ident" id="3761465">b</span><span class="op" id="3761466">[</span><span class="num" id="3761467">1</span><span class="op" id="3761468">]</span><span class="op" id="3761469">,</span>&nbsp;<span class="ident" id="3761471">b</span><span class="op" id="3761472">[</span><span class="num" id="3761473">2</span><span class="op" id="3761474">]</span><span class="op" id="3761475">,</span>&nbsp;<span class="ident" id="3761477">b</span><span class="op" id="3761478">[</span><span class="num" id="3761479">3</span><span class="op" id="3761480">]</span><span class="op" id="3761481">,</span>&nbsp;<span class="ident" id="3761483">b</span><span class="op" id="3761484">[</span><span class="num" id="3761485">4</span><span class="op" id="3761486">]</span><span class="op" id="3761487">,</span>&nbsp;<span class="ident" id="3761489">b</span><span class="op" id="3761490">[</span><span class="num" id="3761491">5</span><span class="op" id="3761492">]</span><span class="op" id="3761493">,</span>&nbsp;<span class="ident" id="3761495">b</span><span class="op" id="3761496">[</span><span class="num" id="3761497">6</span><span class="op" id="3761498">]</span><span class="op" id="3761499">,</span>&nbsp;<span class="ident" id="3761501">b</span><span class="op" id="3761502">[</span><span class="num" id="3761503">7</span><span class="op" id="3761504">]</span><span class="op" id="3761505">,</span>&nbsp;<span class="ident" id="3761507">b</span><span class="op" id="3761508">[</span><span class="num" id="3761509">8</span><span class="op" id="3761510">]</span><span class="op" id="3761511">,</span>&nbsp;<span class="ident" id="3761513">b</span><span class="op" id="3761514">[</span><span class="num" id="3761515">9</span><span class="op" id="3761516">]</span><span class="op" id="3761517">,</span>&nbsp;<span class="ident" id="3761519">b</span><span class="op" id="3761520">[</span><span class="num" id="3761521">10</span><span class="op" id="3761523">]</span><span class="op" id="3761524">,</span>&nbsp;<span class="ident" id="3761526">b</span><span class="op" id="3761527">[</span><span class="num" id="3761528">11</span><span class="op" id="3761530">]</span><span class="op" id="3761531">,</span>&nbsp;<span class="ident" id="3761533">b</span><span class="op" id="3761534">[</span><span class="num" id="3761535">12</span><span class="op" id="3761537">]</span><span class="op" id="3761538">,</span>&nbsp;<span class="ident" id="3761540">b</span><span class="op" id="3761541">[</span><span class="num" id="3761542">13</span><span class="op" id="3761544">]</span><span class="op" id="3761545">,</span>&nbsp;<span class="ident" id="3761547">b</span><span class="op" id="3761548">[</span><span class="num" id="3761549">14</span><span class="op" id="3761551">]</span><span class="op" id="3761552">,</span>&nbsp;<span class="ident" id="3761554">b</span><span class="op" id="3761555">[</span><span class="num" id="3761556">15</span><span class="op" id="3761558">]</span><span class="op" id="3761559">}</span><span class="op" id="3761560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3761565">ifmat</span>&nbsp;<span class="op" id="3761571">=</span>&nbsp;<span class="builtinfunc" id="3761573">append</span><span class="op" id="3761579">(</span><span class="ident" id="3761580">ifmat</span><span class="op" id="3761585">,</span>&nbsp;<span class="ident" id="3761587">ifma</span><span class="op" id="3761591">.</span><span class="ident" id="3761592">toAddr</span><span class="op" id="3761598">(</span><span class="op" id="3761599">)</span><span class="op" id="3761600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3761604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3761607">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3761610">return</span>&nbsp;<span class="ident" id="3761617">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3761623">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
