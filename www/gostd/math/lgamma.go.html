<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html" class="current">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2176549">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2176604">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2176658">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2176709">package</span>&nbsp;<span class="ident" id="2176717">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2176723">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2176779">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2176833">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_lgamma_r.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2176890">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2176945">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2176975">//</span><br>
<span class="lineno"></span><span class="comment" id="2176978">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2177034">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2177103">//</span><br>
<span class="lineno"></span><span class="comment" id="2177106">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2177165">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2177221">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2177278">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2177295">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2177351">//</span><br>
<span class="lineno">25</span><span class="comment" id="2177354">//&nbsp;__ieee754_lgamma_r(x,&nbsp;signgamp)</span><br>
<span class="lineno"></span><span class="comment" id="2177389">//&nbsp;Reentrant&nbsp;version&nbsp;of&nbsp;the&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2177449">//&nbsp;with&nbsp;user&nbsp;provided&nbsp;pointer&nbsp;for&nbsp;the&nbsp;sign&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2177505">//</span><br>
<span class="lineno"></span><span class="comment" id="2177508">//&nbsp;Method:</span><br>
<span class="lineno">30</span><span class="comment" id="2177519">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction&nbsp;for&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;=&nbsp;8</span><br>
<span class="lineno"></span><span class="comment" id="2177561">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Since&nbsp;gamma(1+s)=s*gamma(s),&nbsp;for&nbsp;x&nbsp;in&nbsp;[0,8],&nbsp;we&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="2177621">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reduce&nbsp;x&nbsp;to&nbsp;a&nbsp;number&nbsp;in&nbsp;[1.5,2.5]&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2177666">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1+s)&nbsp;=&nbsp;log(s)&nbsp;+&nbsp;lgamma(s)</span><br>
<span class="lineno"></span><span class="comment" id="2177715">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;example,</span><br>
<span class="lineno">35</span><span class="comment" id="2177736">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(7.3)&nbsp;=&nbsp;log(6.3)&nbsp;+&nbsp;lgamma(6.3)</span><br>
<span class="lineno"></span><span class="comment" id="2177789">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3)&nbsp;+&nbsp;lgamma(5.3)</span><br>
<span class="lineno"></span><span class="comment" id="2177846">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3*4.3*3.3*2.3)&nbsp;+&nbsp;lgamma(2.3)</span><br>
<span class="lineno"></span><span class="comment" id="2177915">//&nbsp;&nbsp;&nbsp;2.&nbsp;Polynomial&nbsp;approximation&nbsp;of&nbsp;lgamma&nbsp;around&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="2177969">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;(ymin=1.461632144968362245)&nbsp;to&nbsp;maintain&nbsp;monotonicity.</span><br>
<span class="lineno">40</span><span class="comment" id="2178039">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;[ymin-0.23,&nbsp;ymin+0.27]&nbsp;(i.e.,&nbsp;[1.23164,1.73163]),&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="2178104">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;x-ymin;</span><br>
<span class="lineno"></span><span class="comment" id="2178136">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;-1.214862905358496078218&nbsp;+&nbsp;z**2*poly(z)</span><br>
<span class="lineno"></span><span class="comment" id="2178204">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;poly(z)&nbsp;is&nbsp;a&nbsp;14&nbsp;degree&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="comment" id="2178255">//&nbsp;&nbsp;&nbsp;2.&nbsp;Rational&nbsp;approximation&nbsp;in&nbsp;the&nbsp;primary&nbsp;interval&nbsp;[2,3]</span><br>
<span class="lineno">45</span><span class="comment" id="2178316">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;the&nbsp;following&nbsp;approximation:</span><br>
<span class="lineno"></span><span class="comment" id="2178360">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;x-2.0;</span><br>
<span class="lineno"></span><span class="comment" id="2178387">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;0.5*s&nbsp;+&nbsp;s*P(s)/Q(s)</span><br>
<span class="lineno"></span><span class="comment" id="2178435">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;accuracy</span><br>
<span class="lineno"></span><span class="comment" id="2178457">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P/Q&nbsp;-&nbsp;(lgamma(x)-0.5s)|&nbsp;&lt;&nbsp;2**-61.71</span><br>
<span class="lineno">50</span><span class="comment" id="2178510">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Our&nbsp;algorithms&nbsp;are&nbsp;based&nbsp;on&nbsp;the&nbsp;following&nbsp;observation</span><br>
<span class="lineno"></span><span class="comment" id="2178572">//</span><br>
<span class="lineno"></span><span class="comment" id="2178575">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeta(2)-1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;zeta(3)-1&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno"></span><span class="comment" id="2178639">//&nbsp;lgamma(2+s)&nbsp;=&nbsp;s*(1-Euler)&nbsp;+&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;-&nbsp;&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2178709">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno">55</span><span class="comment" id="2178764">//</span><br>
<span class="lineno"></span><span class="comment" id="2178767">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;Euler&nbsp;=&nbsp;0.5772156649...&nbsp;is&nbsp;the&nbsp;Euler&nbsp;constant,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2178834">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;very&nbsp;close&nbsp;to&nbsp;0.5.</span><br>
<span class="lineno"></span><span class="comment" id="2178864">//</span><br>
<span class="lineno"></span><span class="comment" id="2178867">//&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&gt;=8,&nbsp;we&nbsp;have</span><br>
<span class="lineno">60</span><span class="comment" id="2178893">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)log(x)-x+0.5*log(2pi)+1/(12x)-1/(360x**3)+....</span><br>
<span class="lineno"></span><span class="comment" id="2178965">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(better&nbsp;formula:</span><br>
<span class="lineno"></span><span class="comment" id="2178990">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)*(log(x)-1)-.5*(log(2pi)-1)&nbsp;+&nbsp;...)</span><br>
<span class="lineno"></span><span class="comment" id="2179053">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;1/x,&nbsp;then&nbsp;we&nbsp;approximation</span><br>
<span class="lineno"></span><span class="comment" id="2179096">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(z)&nbsp;=&nbsp;lgamma(x)&nbsp;-&nbsp;(x-0.5)(log(x)-1)</span><br>
<span class="lineno">65</span><span class="comment" id="2179149">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2179160">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11</span><br>
<span class="lineno"></span><span class="comment" id="2179221">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;=&nbsp;w0&nbsp;+&nbsp;w1*z&nbsp;+&nbsp;w2*z&nbsp;&nbsp;+&nbsp;w3*z&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;w6*z</span><br>
<span class="lineno"></span><span class="comment" id="2179280">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2179294">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|w&nbsp;-&nbsp;f(z)|&nbsp;&lt;&nbsp;2**-58.74</span><br>
<span class="lineno">70</span><span class="comment" id="2179333">//</span><br>
<span class="lineno"></span><span class="comment" id="2179336">//&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;negative&nbsp;x,&nbsp;since&nbsp;(G&nbsp;is&nbsp;gamma&nbsp;function)</span><br>
<span class="lineno"></span><span class="comment" id="2179388">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*G(-x)*G(x)&nbsp;=&nbsp;pi/sin(pi*x),</span><br>
<span class="lineno"></span><span class="comment" id="2179434">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2179450">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(x)&nbsp;=&nbsp;pi/(sin(pi*x)*(-x)*G(-x))</span><br>
<span class="lineno">75</span><span class="comment" id="2179499">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since&nbsp;G(-x)&nbsp;is&nbsp;positive,&nbsp;sign(G(x))&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;for&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2179569">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hence,&nbsp;for&nbsp;x&lt;0,&nbsp;signgam&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2179623">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;log(|Gamma(x)|)</span><br>
<span class="lineno"></span><span class="comment" id="2179667">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(pi/(|x*sin(pi*x)|))&nbsp;-&nbsp;lgamma(-x);</span><br>
<span class="lineno"></span><span class="comment" id="2179733">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;one&nbsp;should&nbsp;avoid&nbsp;computing&nbsp;pi*(-x)&nbsp;directly&nbsp;in&nbsp;the</span><br>
<span class="lineno">80</span><span class="comment" id="2179798">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;computation&nbsp;of&nbsp;sin(pi*(-x)).</span><br>
<span class="lineno"></span><span class="comment" id="2179841">//</span><br>
<span class="lineno"></span><span class="comment" id="2179844">//&nbsp;&nbsp;&nbsp;5.&nbsp;Special&nbsp;Cases</span><br>
<span class="lineno"></span><span class="comment" id="2179866">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(2+s)&nbsp;~&nbsp;s*(1-Euler)&nbsp;for&nbsp;tiny&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2179919">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1)=lgamma(2)=0</span><br>
<span class="lineno">85</span><span class="comment" id="2179957">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;~&nbsp;-log(x)&nbsp;for&nbsp;tiny&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2180004">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(0)&nbsp;=&nbsp;lgamma(inf)&nbsp;=&nbsp;inf</span><br>
<span class="lineno"></span><span class="comment" id="2180050">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(-integer)&nbsp;=&nbsp;+-inf</span><br>
<span class="lineno"></span><span class="comment" id="2180091">//</span><br>
<span class="lineno"></span><span class="comment" id="2180094">//</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="2180098">var</span>&nbsp;<span class="ident" id="2180102">_lgamA</span>&nbsp;<span class="op" id="2180109">=</span>&nbsp;<span class="op" id="2180111">[</span><span class="op" id="2180112">...</span><span class="op" id="2180115">]</span><span class="builtintype" id="2180116">float64</span><span class="op" id="2180123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180126">7.72156649015328655494e-02</span><span class="op" id="2180152">,</span>&nbsp;<span class="comment" id="2180154">//&nbsp;0x3FB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180177">3.22467033424113591611e-01</span><span class="op" id="2180203">,</span>&nbsp;<span class="comment" id="2180205">//&nbsp;0x3FD4A34CC4A60FAD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180228">6.73523010531292681824e-02</span><span class="op" id="2180254">,</span>&nbsp;<span class="comment" id="2180256">//&nbsp;0x3FB13E001A5562A7</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180279">2.05808084325167332806e-02</span><span class="op" id="2180305">,</span>&nbsp;<span class="comment" id="2180307">//&nbsp;0x3F951322AC92547B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180330">7.38555086081402883957e-03</span><span class="op" id="2180356">,</span>&nbsp;<span class="comment" id="2180358">//&nbsp;0x3F7E404FB68FEFE8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180381">2.89051383673415629091e-03</span><span class="op" id="2180407">,</span>&nbsp;<span class="comment" id="2180409">//&nbsp;0x3F67ADD8CCB7926B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180432">1.19270763183362067845e-03</span><span class="op" id="2180458">,</span>&nbsp;<span class="comment" id="2180460">//&nbsp;0x3F538A94116F3F5D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180483">5.10069792153511336608e-04</span><span class="op" id="2180509">,</span>&nbsp;<span class="comment" id="2180511">//&nbsp;0x3F40B6C689B99C00</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180534">2.20862790713908385557e-04</span><span class="op" id="2180560">,</span>&nbsp;<span class="comment" id="2180562">//&nbsp;0x3F2CF2ECED10E54D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180585">1.08011567247583939954e-04</span><span class="op" id="2180611">,</span>&nbsp;<span class="comment" id="2180613">//&nbsp;0x3F1C5088987DFB07</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180636">2.52144565451257326939e-05</span><span class="op" id="2180662">,</span>&nbsp;<span class="comment" id="2180664">//&nbsp;0x3EFA7074428CFA52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180687">4.48640949618915160150e-05</span><span class="op" id="2180713">,</span>&nbsp;<span class="comment" id="2180715">//&nbsp;0x3F07858E90A45837</span><br>
<span class="lineno"></span><span class="op" id="2180737">}</span><br>
<span class="lineno">105</span><span class="keyword" id="2180739">var</span>&nbsp;<span class="ident" id="2180743">_lgamR</span>&nbsp;<span class="op" id="2180750">=</span>&nbsp;<span class="op" id="2180752">[</span><span class="op" id="2180753">...</span><span class="op" id="2180756">]</span><span class="builtintype" id="2180757">float64</span><span class="op" id="2180764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180767">1.0</span><span class="op" id="2180770">,</span>&nbsp;<span class="comment" id="2180772">//&nbsp;placeholder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180788">1.39200533467621045958e+00</span><span class="op" id="2180814">,</span>&nbsp;<span class="comment" id="2180816">//&nbsp;0x3FF645A762C4AB74</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180839">7.21935547567138069525e-01</span><span class="op" id="2180865">,</span>&nbsp;<span class="comment" id="2180867">//&nbsp;0x3FE71A1893D3DCDC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180890">1.71933865632803078993e-01</span><span class="op" id="2180916">,</span>&nbsp;<span class="comment" id="2180918">//&nbsp;0x3FC601EDCCFBDF27</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180941">1.86459191715652901344e-02</span><span class="op" id="2180967">,</span>&nbsp;<span class="comment" id="2180969">//&nbsp;0x3F9317EA742ED475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2180992">7.77942496381893596434e-04</span><span class="op" id="2181018">,</span>&nbsp;<span class="comment" id="2181020">//&nbsp;0x3F497DDACA41A95B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2181043">7.32668430744625636189e-06</span><span class="op" id="2181069">,</span>&nbsp;<span class="comment" id="2181071">//&nbsp;0x3EDEBAF7A5B38140</span><br>
<span class="lineno"></span><span class="op" id="2181093">}</span><br>
<span class="lineno"></span><span class="keyword" id="2181095">var</span>&nbsp;<span class="ident" id="2181099">_lgamS</span>&nbsp;<span class="op" id="2181106">=</span>&nbsp;<span class="op" id="2181108">[</span><span class="op" id="2181109">...</span><span class="op" id="2181112">]</span><span class="builtintype" id="2181113">float64</span><span class="op" id="2181120">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181123">-</span><span class="num" id="2181124">7.72156649015328655494e-02</span><span class="op" id="2181150">,</span>&nbsp;<span class="comment" id="2181152">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2181175">2.14982415960608852501e-01</span><span class="op" id="2181201">,</span>&nbsp;&nbsp;<span class="comment" id="2181204">//&nbsp;0x3FCB848B36E20878</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2181227">3.25778796408930981787e-01</span><span class="op" id="2181253">,</span>&nbsp;&nbsp;<span class="comment" id="2181256">//&nbsp;0x3FD4D98F4F139F59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2181279">1.46350472652464452805e-01</span><span class="op" id="2181305">,</span>&nbsp;&nbsp;<span class="comment" id="2181308">//&nbsp;0x3FC2BB9CBEE5F2F7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2181331">2.66422703033638609560e-02</span><span class="op" id="2181357">,</span>&nbsp;&nbsp;<span class="comment" id="2181360">//&nbsp;0x3F9B481C7E939961</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2181383">1.84028451407337715652e-03</span><span class="op" id="2181409">,</span>&nbsp;&nbsp;<span class="comment" id="2181412">//&nbsp;0x3F5E26B67368F239</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2181435">3.19475326584100867617e-05</span><span class="op" id="2181461">,</span>&nbsp;&nbsp;<span class="comment" id="2181464">//&nbsp;0x3F00BFECDD17E945</span><br>
<span class="lineno"></span><span class="op" id="2181486">}</span><br>
<span class="lineno"></span><span class="keyword" id="2181488">var</span>&nbsp;<span class="ident" id="2181492">_lgamT</span>&nbsp;<span class="op" id="2181499">=</span>&nbsp;<span class="op" id="2181501">[</span><span class="op" id="2181502">...</span><span class="op" id="2181505">]</span><span class="builtintype" id="2181506">float64</span><span class="op" id="2181513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2181516">4.83836122723810047042e-01</span><span class="op" id="2181542">,</span>&nbsp;&nbsp;<span class="comment" id="2181545">//&nbsp;0x3FDEF72BC8EE38A2</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181568">-</span><span class="num" id="2181569">1.47587722994593911752e-01</span><span class="op" id="2181595">,</span>&nbsp;<span class="comment" id="2181597">//&nbsp;0xBFC2E4278DC6C509</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2181620">6.46249402391333854778e-02</span><span class="op" id="2181646">,</span>&nbsp;&nbsp;<span class="comment" id="2181649">//&nbsp;0x3FB08B4294D5419B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181672">-</span><span class="num" id="2181673">3.27885410759859649565e-02</span><span class="op" id="2181699">,</span>&nbsp;<span class="comment" id="2181701">//&nbsp;0xBFA0C9A8DF35B713</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2181724">1.79706750811820387126e-02</span><span class="op" id="2181750">,</span>&nbsp;&nbsp;<span class="comment" id="2181753">//&nbsp;0x3F9266E7970AF9EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181776">-</span><span class="num" id="2181777">1.03142241298341437450e-02</span><span class="op" id="2181803">,</span>&nbsp;<span class="comment" id="2181805">//&nbsp;0xBF851F9FBA91EC6A</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2181828">6.10053870246291332635e-03</span><span class="op" id="2181854">,</span>&nbsp;&nbsp;<span class="comment" id="2181857">//&nbsp;0x3F78FCE0E370E344</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181880">-</span><span class="num" id="2181881">3.68452016781138256760e-03</span><span class="op" id="2181907">,</span>&nbsp;<span class="comment" id="2181909">//&nbsp;0xBF6E2EFFB3E914D7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2181932">2.25964780900612472250e-03</span><span class="op" id="2181958">,</span>&nbsp;&nbsp;<span class="comment" id="2181961">//&nbsp;0x3F6282D32E15C915</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181984">-</span><span class="num" id="2181985">1.40346469989232843813e-03</span><span class="op" id="2182011">,</span>&nbsp;<span class="comment" id="2182013">//&nbsp;0xBF56FE8EBF2D1AF1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2182036">8.81081882437654011382e-04</span><span class="op" id="2182062">,</span>&nbsp;&nbsp;<span class="comment" id="2182065">//&nbsp;0x3F4CDF0CEF61A8E9</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182088">-</span><span class="num" id="2182089">5.38595305356740546715e-04</span><span class="op" id="2182115">,</span>&nbsp;<span class="comment" id="2182117">//&nbsp;0xBF41A6109C73E0EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2182140">3.15632070903625950361e-04</span><span class="op" id="2182166">,</span>&nbsp;&nbsp;<span class="comment" id="2182169">//&nbsp;0x3F34AF6D6C0EBBF7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182192">-</span><span class="num" id="2182193">3.12754168375120860518e-04</span><span class="op" id="2182219">,</span>&nbsp;<span class="comment" id="2182221">//&nbsp;0xBF347F24ECC38C38</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2182244">3.35529192635519073543e-04</span><span class="op" id="2182270">,</span>&nbsp;&nbsp;<span class="comment" id="2182273">//&nbsp;0x3F35FD3EE8C2D3F4</span><br>
<span class="lineno"></span><span class="op" id="2182295">}</span><br>
<span class="lineno">140</span><span class="keyword" id="2182297">var</span>&nbsp;<span class="ident" id="2182301">_lgamU</span>&nbsp;<span class="op" id="2182308">=</span>&nbsp;<span class="op" id="2182310">[</span><span class="op" id="2182311">...</span><span class="op" id="2182314">]</span><span class="builtintype" id="2182315">float64</span><span class="op" id="2182322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182325">-</span><span class="num" id="2182326">7.72156649015328655494e-02</span><span class="op" id="2182352">,</span>&nbsp;<span class="comment" id="2182354">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2182377">6.32827064025093366517e-01</span><span class="op" id="2182403">,</span>&nbsp;&nbsp;<span class="comment" id="2182406">//&nbsp;0x3FE4401E8B005DFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2182429">1.45492250137234768737e+00</span><span class="op" id="2182455">,</span>&nbsp;&nbsp;<span class="comment" id="2182458">//&nbsp;0x3FF7475CD119BD6F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2182481">9.77717527963372745603e-01</span><span class="op" id="2182507">,</span>&nbsp;&nbsp;<span class="comment" id="2182510">//&nbsp;0x3FEF497644EA8450</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2182533">2.28963728064692451092e-01</span><span class="op" id="2182559">,</span>&nbsp;&nbsp;<span class="comment" id="2182562">//&nbsp;0x3FCD4EAEF6010924</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2182585">1.33810918536787660377e-02</span><span class="op" id="2182611">,</span>&nbsp;&nbsp;<span class="comment" id="2182614">//&nbsp;0x3F8B678BBF2BAB09</span><br>
<span class="lineno"></span><span class="op" id="2182636">}</span><br>
<span class="lineno"></span><span class="keyword" id="2182638">var</span>&nbsp;<span class="ident" id="2182642">_lgamV</span>&nbsp;<span class="op" id="2182649">=</span>&nbsp;<span class="op" id="2182651">[</span><span class="op" id="2182652">...</span><span class="op" id="2182655">]</span><span class="builtintype" id="2182656">float64</span><span class="op" id="2182663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2182666">1.0</span><span class="op" id="2182669">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2182672">2.45597793713041134822e+00</span><span class="op" id="2182698">,</span>&nbsp;<span class="comment" id="2182700">//&nbsp;0x4003A5D7C2BD619C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2182723">2.12848976379893395361e+00</span><span class="op" id="2182749">,</span>&nbsp;<span class="comment" id="2182751">//&nbsp;0x40010725A42B18F5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2182774">7.69285150456672783825e-01</span><span class="op" id="2182800">,</span>&nbsp;<span class="comment" id="2182802">//&nbsp;0x3FE89DFBE45050AF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2182825">1.04222645593369134254e-01</span><span class="op" id="2182851">,</span>&nbsp;<span class="comment" id="2182853">//&nbsp;0x3FBAAE55D6537C88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2182876">3.21709242282423911810e-03</span><span class="op" id="2182902">,</span>&nbsp;<span class="comment" id="2182904">//&nbsp;0x3F6A5ABB57D0CF61</span><br>
<span class="lineno">155</span><span class="op" id="2182926">}</span><br>
<span class="lineno"></span><span class="keyword" id="2182928">var</span>&nbsp;<span class="ident" id="2182932">_lgamW</span>&nbsp;<span class="op" id="2182939">=</span>&nbsp;<span class="op" id="2182941">[</span><span class="op" id="2182942">...</span><span class="op" id="2182945">]</span><span class="builtintype" id="2182946">float64</span><span class="op" id="2182953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2182956">4.18938533204672725052e-01</span><span class="op" id="2182982">,</span>&nbsp;&nbsp;<span class="comment" id="2182985">//&nbsp;0x3FDACFE390C97D69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2183008">8.33333333333329678849e-02</span><span class="op" id="2183034">,</span>&nbsp;&nbsp;<span class="comment" id="2183037">//&nbsp;0x3FB555555555553B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2183060">-</span><span class="num" id="2183061">2.77777777728775536470e-03</span><span class="op" id="2183087">,</span>&nbsp;<span class="comment" id="2183089">//&nbsp;0xBF66C16C16B02E5C</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2183112">7.93650558643019558500e-04</span><span class="op" id="2183138">,</span>&nbsp;&nbsp;<span class="comment" id="2183141">//&nbsp;0x3F4A019F98CF38B6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2183164">-</span><span class="num" id="2183165">5.95187557450339963135e-04</span><span class="op" id="2183191">,</span>&nbsp;<span class="comment" id="2183193">//&nbsp;0xBF4380CB8C0FE741</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2183216">8.36339918996282139126e-04</span><span class="op" id="2183242">,</span>&nbsp;&nbsp;<span class="comment" id="2183245">//&nbsp;0x3F4B67BA4CDAD5D1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2183268">-</span><span class="num" id="2183269">1.63092934096575273989e-03</span><span class="op" id="2183295">,</span>&nbsp;<span class="comment" id="2183297">//&nbsp;0xBF5AB89D0B9E43E4</span><br>
<span class="lineno"></span><span class="op" id="2183319">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="2183322">//&nbsp;Lgamma&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;and&nbsp;sign&nbsp;(-1&nbsp;or&nbsp;+1)&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2183395">//</span><br>
<span class="lineno"></span><span class="comment" id="2183398">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2183420">//&nbsp;&nbsp;&nbsp;&nbspLgamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno">170</span><span class="comment" id="2183443">//&nbsp;&nbsp;&nbsp;&nbspLgamma(0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2183463">//&nbsp;&nbsp;&nbsp;&nbspLgamma(-integer)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2183490">//&nbsp;&nbsp;&nbsp;&nbspLgamma(-Inf)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2183513">//&nbsp;&nbsp;&nbsp;&nbspLgamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2183534">func</span>&nbsp;<span class="ident" id="2183539">Lgamma</span><span class="op" id="2183545">(</span><span class="ident" id="2183546">x</span>&nbsp;<span class="builtintype" id="2183548">float64</span><span class="op" id="2183555">)</span>&nbsp;<span class="op" id="2183557">(</span><span class="ident" id="2183558">lgamma</span>&nbsp;<span class="builtintype" id="2183565">float64</span><span class="op" id="2183572">,</span>&nbsp;<span class="ident" id="2183574">sign</span>&nbsp;<span class="builtintype" id="2183579">int</span><span class="op" id="2183582">)</span>&nbsp;<span class="op" id="2183584">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183587">const</span>&nbsp;<span class="op" id="2183593">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183597">Ymin</span>&nbsp;&nbsp;<span class="op" id="2183603">=</span>&nbsp;<span class="num" id="2183605">1.461632144968362245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183628">Two52</span>&nbsp;<span class="op" id="2183634">=</span>&nbsp;<span class="num" id="2183636">1</span>&nbsp;<span class="op" id="2183638">&lt;&lt;</span>&nbsp;<span class="num" id="2183641">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2183664">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183700">Two53</span>&nbsp;<span class="op" id="2183706">=</span>&nbsp;<span class="num" id="2183708">1</span>&nbsp;<span class="op" id="2183710">&lt;&lt;</span>&nbsp;<span class="num" id="2183713">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2183736">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183772">Two58</span>&nbsp;<span class="op" id="2183778">=</span>&nbsp;<span class="num" id="2183780">1</span>&nbsp;<span class="op" id="2183782">&lt;&lt;</span>&nbsp;<span class="num" id="2183785">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2183808">//&nbsp;0x4390000000000000&nbsp;~2.8823e+17</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183844">Tiny</span>&nbsp;&nbsp;<span class="op" id="2183850">=</span>&nbsp;<span class="num" id="2183852">1.0</span>&nbsp;<span class="op" id="2183856">/</span>&nbsp;<span class="op" id="2183858">(</span><span class="num" id="2183859">1</span>&nbsp;<span class="op" id="2183861">&lt;&lt;</span>&nbsp;<span class="num" id="2183864">70</span><span class="op" id="2183866">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2183880">//&nbsp;0x3b90000000000000&nbsp;~8.47033e-22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183917">Tc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2183923">=</span>&nbsp;<span class="num" id="2183925">1.46163214496836224576e+00</span>&nbsp;&nbsp;<span class="comment" id="2183953">//&nbsp;0x3FF762D86356BE3F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183977">Tf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2183983">=</span>&nbsp;<span class="op" id="2183985">-</span><span class="num" id="2183986">1.21486290535849611461e-01</span>&nbsp;<span class="comment" id="2184013">//&nbsp;0xBFBF19B9BCC38A42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2184037">//&nbsp;Tt&nbsp;=&nbsp;-(tail&nbsp;of&nbsp;Tf)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184061">Tt</span>&nbsp;<span class="op" id="2184064">=</span>&nbsp;<span class="op" id="2184066">-</span><span class="num" id="2184067">3.63867699703950536541e-18</span>&nbsp;<span class="comment" id="2184094">//&nbsp;0xBC50C7CAA48A971F</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2184120">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184138">sign</span>&nbsp;<span class="op" id="2184143">=</span>&nbsp;<span class="num" id="2184145">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184148">switch</span>&nbsp;<span class="op" id="2184155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184158">case</span>&nbsp;<span class="ident" id="2184163">IsNaN</span><span class="op" id="2184168">(</span><span class="ident" id="2184169">x</span><span class="op" id="2184170">)</span><span class="op" id="2184171">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184175">lgamma</span>&nbsp;<span class="op" id="2184182">=</span>&nbsp;<span class="ident" id="2184184">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184188">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184196">case</span>&nbsp;<span class="ident" id="2184201">IsInf</span><span class="op" id="2184206">(</span><span class="ident" id="2184207">x</span><span class="op" id="2184208">,</span>&nbsp;<span class="num" id="2184210">0</span><span class="op" id="2184211">)</span><span class="op" id="2184212">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184216">lgamma</span>&nbsp;<span class="op" id="2184223">=</span>&nbsp;<span class="ident" id="2184225">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184229">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184237">case</span>&nbsp;<span class="ident" id="2184242">x</span>&nbsp;<span class="op" id="2184244">==</span>&nbsp;<span class="num" id="2184247">0</span><span class="op" id="2184248">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184252">lgamma</span>&nbsp;<span class="op" id="2184259">=</span>&nbsp;<span class="ident" id="2184261">Inf</span><span class="op" id="2184264">(</span><span class="num" id="2184265">1</span><span class="op" id="2184266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184270">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184282">neg</span>&nbsp;<span class="op" id="2184286">:=</span>&nbsp;<span class="builtintype" id="2184289">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184296">if</span>&nbsp;<span class="ident" id="2184299">x</span>&nbsp;<span class="op" id="2184301">&lt;</span>&nbsp;<span class="num" id="2184303">0</span>&nbsp;<span class="op" id="2184305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184309">x</span>&nbsp;<span class="op" id="2184311">=</span>&nbsp;<span class="op" id="2184313">-</span><span class="ident" id="2184314">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184318">neg</span>&nbsp;<span class="op" id="2184322">=</span>&nbsp;<span class="builtintype" id="2184324">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184330">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184334">if</span>&nbsp;<span class="ident" id="2184337">x</span>&nbsp;<span class="op" id="2184339">&lt;</span>&nbsp;<span class="ident" id="2184341">Tiny</span>&nbsp;<span class="op" id="2184346">{</span>&nbsp;<span class="comment" id="2184348">//&nbsp;if&nbsp;|x|&nbsp;&lt;&nbsp;2**-70,&nbsp;return&nbsp;-log(|x|)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184387">if</span>&nbsp;<span class="ident" id="2184390">neg</span>&nbsp;<span class="op" id="2184394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184399">sign</span>&nbsp;<span class="op" id="2184404">=</span>&nbsp;<span class="op" id="2184406">-</span><span class="num" id="2184407">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184411">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184415">lgamma</span>&nbsp;<span class="op" id="2184422">=</span>&nbsp;<span class="op" id="2184424">-</span><span class="ident" id="2184425">Log</span><span class="op" id="2184428">(</span><span class="ident" id="2184429">x</span><span class="op" id="2184430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184434">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184445">var</span>&nbsp;<span class="ident" id="2184449">nadj</span>&nbsp;<span class="builtintype" id="2184454">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184463">if</span>&nbsp;<span class="ident" id="2184466">neg</span>&nbsp;<span class="op" id="2184470">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184474">if</span>&nbsp;<span class="ident" id="2184477">x</span>&nbsp;<span class="op" id="2184479">&gt;=</span>&nbsp;<span class="ident" id="2184482">Two52</span>&nbsp;<span class="op" id="2184488">{</span>&nbsp;<span class="comment" id="2184490">//&nbsp;|x|&nbsp;&gt;=&nbsp;2**52,&nbsp;must&nbsp;be&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184527">lgamma</span>&nbsp;<span class="op" id="2184534">=</span>&nbsp;<span class="ident" id="2184536">Inf</span><span class="op" id="2184539">(</span><span class="num" id="2184540">1</span><span class="op" id="2184541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184546">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184559">t</span>&nbsp;<span class="op" id="2184561">:=</span>&nbsp;<span class="ident" id="2184564">sinPi</span><span class="op" id="2184569">(</span><span class="ident" id="2184570">x</span><span class="op" id="2184571">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184575">if</span>&nbsp;<span class="ident" id="2184578">t</span>&nbsp;<span class="op" id="2184580">==</span>&nbsp;<span class="num" id="2184583">0</span>&nbsp;<span class="op" id="2184585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184590">lgamma</span>&nbsp;<span class="op" id="2184597">=</span>&nbsp;<span class="ident" id="2184599">Inf</span><span class="op" id="2184602">(</span><span class="num" id="2184603">1</span><span class="op" id="2184604">)</span>&nbsp;<span class="comment" id="2184606">//&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184621">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184634">nadj</span>&nbsp;<span class="op" id="2184639">=</span>&nbsp;<span class="ident" id="2184641">Log</span><span class="op" id="2184644">(</span><span class="ident" id="2184645">Pi</span>&nbsp;<span class="op" id="2184648">/</span>&nbsp;<span class="ident" id="2184650">Abs</span><span class="op" id="2184653">(</span><span class="ident" id="2184654">t</span><span class="op" id="2184655">*</span><span class="ident" id="2184656">x</span><span class="op" id="2184657">)</span><span class="op" id="2184658">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184662">if</span>&nbsp;<span class="ident" id="2184665">t</span>&nbsp;<span class="op" id="2184667">&lt;</span>&nbsp;<span class="num" id="2184669">0</span>&nbsp;<span class="op" id="2184671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184676">sign</span>&nbsp;<span class="op" id="2184681">=</span>&nbsp;<span class="op" id="2184683">-</span><span class="num" id="2184684">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184695">switch</span>&nbsp;<span class="op" id="2184702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184705">case</span>&nbsp;<span class="ident" id="2184710">x</span>&nbsp;<span class="op" id="2184712">==</span>&nbsp;<span class="num" id="2184715">1</span>&nbsp;<span class="op" id="2184717">||</span>&nbsp;<span class="ident" id="2184720">x</span>&nbsp;<span class="op" id="2184722">==</span>&nbsp;<span class="num" id="2184725">2</span><span class="op" id="2184726">:</span>&nbsp;<span class="comment" id="2184728">//&nbsp;purge&nbsp;off&nbsp;1&nbsp;and&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184751">lgamma</span>&nbsp;<span class="op" id="2184758">=</span>&nbsp;<span class="num" id="2184760">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184764">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184772">case</span>&nbsp;<span class="ident" id="2184777">x</span>&nbsp;<span class="op" id="2184779">&lt;</span>&nbsp;<span class="num" id="2184781">2</span><span class="op" id="2184782">:</span>&nbsp;<span class="comment" id="2184784">//&nbsp;use&nbsp;lgamma(x)&nbsp;=&nbsp;lgamma(x+1)&nbsp;-&nbsp;log(x)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184826">var</span>&nbsp;<span class="ident" id="2184830">y</span>&nbsp;<span class="builtintype" id="2184832">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184842">var</span>&nbsp;<span class="ident" id="2184846">i</span>&nbsp;<span class="builtintype" id="2184848">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184854">if</span>&nbsp;<span class="ident" id="2184857">x</span>&nbsp;<span class="op" id="2184859">&lt;=</span>&nbsp;<span class="num" id="2184862">0.9</span>&nbsp;<span class="op" id="2184866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184871">lgamma</span>&nbsp;<span class="op" id="2184878">=</span>&nbsp;<span class="op" id="2184880">-</span><span class="ident" id="2184881">Log</span><span class="op" id="2184884">(</span><span class="ident" id="2184885">x</span><span class="op" id="2184886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184891">switch</span>&nbsp;<span class="op" id="2184898">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184903">case</span>&nbsp;<span class="ident" id="2184908">x</span>&nbsp;<span class="op" id="2184910">&gt;=</span>&nbsp;<span class="op" id="2184913">(</span><span class="ident" id="2184914">Ymin</span>&nbsp;<span class="op" id="2184919">-</span>&nbsp;<span class="num" id="2184921">1</span>&nbsp;<span class="op" id="2184923">+</span>&nbsp;<span class="num" id="2184925">0.27</span><span class="op" id="2184929">)</span><span class="op" id="2184930">:</span>&nbsp;<span class="comment" id="2184932">//&nbsp;0.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;&nbsp;0.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184959">y</span>&nbsp;<span class="op" id="2184961">=</span>&nbsp;<span class="num" id="2184963">1</span>&nbsp;<span class="op" id="2184965">-</span>&nbsp;<span class="ident" id="2184967">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184973">i</span>&nbsp;<span class="op" id="2184975">=</span>&nbsp;<span class="num" id="2184977">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184982">case</span>&nbsp;<span class="ident" id="2184987">x</span>&nbsp;<span class="op" id="2184989">&gt;=</span>&nbsp;<span class="op" id="2184992">(</span><span class="ident" id="2184993">Ymin</span>&nbsp;<span class="op" id="2184998">-</span>&nbsp;<span class="num" id="2185000">1</span>&nbsp;<span class="op" id="2185002">-</span>&nbsp;<span class="num" id="2185004">0.27</span><span class="op" id="2185008">)</span><span class="op" id="2185009">:</span>&nbsp;<span class="comment" id="2185011">//&nbsp;0.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;0.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185039">y</span>&nbsp;<span class="op" id="2185041">=</span>&nbsp;<span class="ident" id="2185043">x</span>&nbsp;<span class="op" id="2185045">-</span>&nbsp;<span class="op" id="2185047">(</span><span class="ident" id="2185048">Tc</span>&nbsp;<span class="op" id="2185051">-</span>&nbsp;<span class="num" id="2185053">1</span><span class="op" id="2185054">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185060">i</span>&nbsp;<span class="op" id="2185062">=</span>&nbsp;<span class="num" id="2185064">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185069">default</span><span class="op" id="2185076">:</span>&nbsp;<span class="comment" id="2185078">//&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;0.2316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185100">y</span>&nbsp;<span class="op" id="2185102">=</span>&nbsp;<span class="ident" id="2185104">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185110">i</span>&nbsp;<span class="op" id="2185112">=</span>&nbsp;<span class="num" id="2185114">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2185119">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2185123">}</span>&nbsp;<span class="keyword" id="2185125">else</span>&nbsp;<span class="op" id="2185130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185135">lgamma</span>&nbsp;<span class="op" id="2185142">=</span>&nbsp;<span class="num" id="2185144">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185149">switch</span>&nbsp;<span class="op" id="2185156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185161">case</span>&nbsp;<span class="ident" id="2185166">x</span>&nbsp;<span class="op" id="2185168">&gt;=</span>&nbsp;<span class="op" id="2185171">(</span><span class="ident" id="2185172">Ymin</span>&nbsp;<span class="op" id="2185177">+</span>&nbsp;<span class="num" id="2185179">0.27</span><span class="op" id="2185183">)</span><span class="op" id="2185184">:</span>&nbsp;<span class="comment" id="2185186">//&nbsp;1.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185209">y</span>&nbsp;<span class="op" id="2185211">=</span>&nbsp;<span class="num" id="2185213">2</span>&nbsp;<span class="op" id="2185215">-</span>&nbsp;<span class="ident" id="2185217">x</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185223">i</span>&nbsp;<span class="op" id="2185225">=</span>&nbsp;<span class="num" id="2185227">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185232">case</span>&nbsp;<span class="ident" id="2185237">x</span>&nbsp;<span class="op" id="2185239">&gt;=</span>&nbsp;<span class="op" id="2185242">(</span><span class="ident" id="2185243">Ymin</span>&nbsp;<span class="op" id="2185248">-</span>&nbsp;<span class="num" id="2185250">0.27</span><span class="op" id="2185254">)</span><span class="op" id="2185255">:</span>&nbsp;<span class="comment" id="2185257">//&nbsp;1.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;1.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185285">y</span>&nbsp;<span class="op" id="2185287">=</span>&nbsp;<span class="ident" id="2185289">x</span>&nbsp;<span class="op" id="2185291">-</span>&nbsp;<span class="ident" id="2185293">Tc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185300">i</span>&nbsp;<span class="op" id="2185302">=</span>&nbsp;<span class="num" id="2185304">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185309">default</span><span class="op" id="2185316">:</span>&nbsp;<span class="comment" id="2185318">//&nbsp;0.9&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;1.2316</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185342">y</span>&nbsp;<span class="op" id="2185344">=</span>&nbsp;<span class="ident" id="2185346">x</span>&nbsp;<span class="op" id="2185348">-</span>&nbsp;<span class="num" id="2185350">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185356">i</span>&nbsp;<span class="op" id="2185358">=</span>&nbsp;<span class="num" id="2185360">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2185365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2185369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185373">switch</span>&nbsp;<span class="ident" id="2185380">i</span>&nbsp;<span class="op" id="2185382">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185386">case</span>&nbsp;<span class="num" id="2185391">0</span><span class="op" id="2185392">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185397">z</span>&nbsp;<span class="op" id="2185399">:=</span>&nbsp;<span class="ident" id="2185402">y</span>&nbsp;<span class="op" id="2185404">*</span>&nbsp;<span class="ident" id="2185406">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185411">p1</span>&nbsp;<span class="op" id="2185414">:=</span>&nbsp;<span class="ident" id="2185417">_lgamA</span><span class="op" id="2185423">[</span><span class="num" id="2185424">0</span><span class="op" id="2185425">]</span>&nbsp;<span class="op" id="2185427">+</span>&nbsp;<span class="ident" id="2185429">z</span><span class="op" id="2185430">*</span><span class="op" id="2185431">(</span><span class="ident" id="2185432">_lgamA</span><span class="op" id="2185438">[</span><span class="num" id="2185439">2</span><span class="op" id="2185440">]</span><span class="op" id="2185441">+</span><span class="ident" id="2185442">z</span><span class="op" id="2185443">*</span><span class="op" id="2185444">(</span><span class="ident" id="2185445">_lgamA</span><span class="op" id="2185451">[</span><span class="num" id="2185452">4</span><span class="op" id="2185453">]</span><span class="op" id="2185454">+</span><span class="ident" id="2185455">z</span><span class="op" id="2185456">*</span><span class="op" id="2185457">(</span><span class="ident" id="2185458">_lgamA</span><span class="op" id="2185464">[</span><span class="num" id="2185465">6</span><span class="op" id="2185466">]</span><span class="op" id="2185467">+</span><span class="ident" id="2185468">z</span><span class="op" id="2185469">*</span><span class="op" id="2185470">(</span><span class="ident" id="2185471">_lgamA</span><span class="op" id="2185477">[</span><span class="num" id="2185478">8</span><span class="op" id="2185479">]</span><span class="op" id="2185480">+</span><span class="ident" id="2185481">z</span><span class="op" id="2185482">*</span><span class="ident" id="2185483">_lgamA</span><span class="op" id="2185489">[</span><span class="num" id="2185490">10</span><span class="op" id="2185492">]</span><span class="op" id="2185493">)</span><span class="op" id="2185494">)</span><span class="op" id="2185495">)</span><span class="op" id="2185496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185501">p2</span>&nbsp;<span class="op" id="2185504">:=</span>&nbsp;<span class="ident" id="2185507">z</span>&nbsp;<span class="op" id="2185509">*</span>&nbsp;<span class="op" id="2185511">(</span><span class="ident" id="2185512">_lgamA</span><span class="op" id="2185518">[</span><span class="num" id="2185519">1</span><span class="op" id="2185520">]</span>&nbsp;<span class="op" id="2185522">+</span>&nbsp;<span class="ident" id="2185524">z</span><span class="op" id="2185525">*</span><span class="op" id="2185526">(</span><span class="op" id="2185527">+</span><span class="ident" id="2185528">_lgamA</span><span class="op" id="2185534">[</span><span class="num" id="2185535">3</span><span class="op" id="2185536">]</span><span class="op" id="2185537">+</span><span class="ident" id="2185538">z</span><span class="op" id="2185539">*</span><span class="op" id="2185540">(</span><span class="ident" id="2185541">_lgamA</span><span class="op" id="2185547">[</span><span class="num" id="2185548">5</span><span class="op" id="2185549">]</span><span class="op" id="2185550">+</span><span class="ident" id="2185551">z</span><span class="op" id="2185552">*</span><span class="op" id="2185553">(</span><span class="ident" id="2185554">_lgamA</span><span class="op" id="2185560">[</span><span class="num" id="2185561">7</span><span class="op" id="2185562">]</span><span class="op" id="2185563">+</span><span class="ident" id="2185564">z</span><span class="op" id="2185565">*</span><span class="op" id="2185566">(</span><span class="ident" id="2185567">_lgamA</span><span class="op" id="2185573">[</span><span class="num" id="2185574">9</span><span class="op" id="2185575">]</span><span class="op" id="2185576">+</span><span class="ident" id="2185577">z</span><span class="op" id="2185578">*</span><span class="ident" id="2185579">_lgamA</span><span class="op" id="2185585">[</span><span class="num" id="2185586">11</span><span class="op" id="2185588">]</span><span class="op" id="2185589">)</span><span class="op" id="2185590">)</span><span class="op" id="2185591">)</span><span class="op" id="2185592">)</span><span class="op" id="2185593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185598">p</span>&nbsp;<span class="op" id="2185600">:=</span>&nbsp;<span class="ident" id="2185603">y</span><span class="op" id="2185604">*</span><span class="ident" id="2185605">p1</span>&nbsp;<span class="op" id="2185608">+</span>&nbsp;<span class="ident" id="2185610">p2</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185616">lgamma</span>&nbsp;<span class="op" id="2185623">+=</span>&nbsp;<span class="op" id="2185626">(</span><span class="ident" id="2185627">p</span>&nbsp;<span class="op" id="2185629">-</span>&nbsp;<span class="num" id="2185631">0.5</span><span class="op" id="2185634">*</span><span class="ident" id="2185635">y</span><span class="op" id="2185636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185640">case</span>&nbsp;<span class="num" id="2185645">1</span><span class="op" id="2185646">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185651">z</span>&nbsp;<span class="op" id="2185653">:=</span>&nbsp;<span class="ident" id="2185656">y</span>&nbsp;<span class="op" id="2185658">*</span>&nbsp;<span class="ident" id="2185660">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185665">w</span>&nbsp;<span class="op" id="2185667">:=</span>&nbsp;<span class="ident" id="2185670">z</span>&nbsp;<span class="op" id="2185672">*</span>&nbsp;<span class="ident" id="2185674">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185679">p1</span>&nbsp;<span class="op" id="2185682">:=</span>&nbsp;<span class="ident" id="2185685">_lgamT</span><span class="op" id="2185691">[</span><span class="num" id="2185692">0</span><span class="op" id="2185693">]</span>&nbsp;<span class="op" id="2185695">+</span>&nbsp;<span class="ident" id="2185697">w</span><span class="op" id="2185698">*</span><span class="op" id="2185699">(</span><span class="ident" id="2185700">_lgamT</span><span class="op" id="2185706">[</span><span class="num" id="2185707">3</span><span class="op" id="2185708">]</span><span class="op" id="2185709">+</span><span class="ident" id="2185710">w</span><span class="op" id="2185711">*</span><span class="op" id="2185712">(</span><span class="ident" id="2185713">_lgamT</span><span class="op" id="2185719">[</span><span class="num" id="2185720">6</span><span class="op" id="2185721">]</span><span class="op" id="2185722">+</span><span class="ident" id="2185723">w</span><span class="op" id="2185724">*</span><span class="op" id="2185725">(</span><span class="ident" id="2185726">_lgamT</span><span class="op" id="2185732">[</span><span class="num" id="2185733">9</span><span class="op" id="2185734">]</span><span class="op" id="2185735">+</span><span class="ident" id="2185736">w</span><span class="op" id="2185737">*</span><span class="ident" id="2185738">_lgamT</span><span class="op" id="2185744">[</span><span class="num" id="2185745">12</span><span class="op" id="2185747">]</span><span class="op" id="2185748">)</span><span class="op" id="2185749">)</span><span class="op" id="2185750">)</span>&nbsp;<span class="comment" id="2185752">//&nbsp;parallel&nbsp;comp</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185772">p2</span>&nbsp;<span class="op" id="2185775">:=</span>&nbsp;<span class="ident" id="2185778">_lgamT</span><span class="op" id="2185784">[</span><span class="num" id="2185785">1</span><span class="op" id="2185786">]</span>&nbsp;<span class="op" id="2185788">+</span>&nbsp;<span class="ident" id="2185790">w</span><span class="op" id="2185791">*</span><span class="op" id="2185792">(</span><span class="ident" id="2185793">_lgamT</span><span class="op" id="2185799">[</span><span class="num" id="2185800">4</span><span class="op" id="2185801">]</span><span class="op" id="2185802">+</span><span class="ident" id="2185803">w</span><span class="op" id="2185804">*</span><span class="op" id="2185805">(</span><span class="ident" id="2185806">_lgamT</span><span class="op" id="2185812">[</span><span class="num" id="2185813">7</span><span class="op" id="2185814">]</span><span class="op" id="2185815">+</span><span class="ident" id="2185816">w</span><span class="op" id="2185817">*</span><span class="op" id="2185818">(</span><span class="ident" id="2185819">_lgamT</span><span class="op" id="2185825">[</span><span class="num" id="2185826">10</span><span class="op" id="2185828">]</span><span class="op" id="2185829">+</span><span class="ident" id="2185830">w</span><span class="op" id="2185831">*</span><span class="ident" id="2185832">_lgamT</span><span class="op" id="2185838">[</span><span class="num" id="2185839">13</span><span class="op" id="2185841">]</span><span class="op" id="2185842">)</span><span class="op" id="2185843">)</span><span class="op" id="2185844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185849">p3</span>&nbsp;<span class="op" id="2185852">:=</span>&nbsp;<span class="ident" id="2185855">_lgamT</span><span class="op" id="2185861">[</span><span class="num" id="2185862">2</span><span class="op" id="2185863">]</span>&nbsp;<span class="op" id="2185865">+</span>&nbsp;<span class="ident" id="2185867">w</span><span class="op" id="2185868">*</span><span class="op" id="2185869">(</span><span class="ident" id="2185870">_lgamT</span><span class="op" id="2185876">[</span><span class="num" id="2185877">5</span><span class="op" id="2185878">]</span><span class="op" id="2185879">+</span><span class="ident" id="2185880">w</span><span class="op" id="2185881">*</span><span class="op" id="2185882">(</span><span class="ident" id="2185883">_lgamT</span><span class="op" id="2185889">[</span><span class="num" id="2185890">8</span><span class="op" id="2185891">]</span><span class="op" id="2185892">+</span><span class="ident" id="2185893">w</span><span class="op" id="2185894">*</span><span class="op" id="2185895">(</span><span class="ident" id="2185896">_lgamT</span><span class="op" id="2185902">[</span><span class="num" id="2185903">11</span><span class="op" id="2185905">]</span><span class="op" id="2185906">+</span><span class="ident" id="2185907">w</span><span class="op" id="2185908">*</span><span class="ident" id="2185909">_lgamT</span><span class="op" id="2185915">[</span><span class="num" id="2185916">14</span><span class="op" id="2185918">]</span><span class="op" id="2185919">)</span><span class="op" id="2185920">)</span><span class="op" id="2185921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185926">p</span>&nbsp;<span class="op" id="2185928">:=</span>&nbsp;<span class="ident" id="2185931">z</span><span class="op" id="2185932">*</span><span class="ident" id="2185933">p1</span>&nbsp;<span class="op" id="2185936">-</span>&nbsp;<span class="op" id="2185938">(</span><span class="ident" id="2185939">Tt</span>&nbsp;<span class="op" id="2185942">-</span>&nbsp;<span class="ident" id="2185944">w</span><span class="op" id="2185945">*</span><span class="op" id="2185946">(</span><span class="ident" id="2185947">p2</span><span class="op" id="2185949">+</span><span class="ident" id="2185950">y</span><span class="op" id="2185951">*</span><span class="ident" id="2185952">p3</span><span class="op" id="2185954">)</span><span class="op" id="2185955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185960">lgamma</span>&nbsp;<span class="op" id="2185967">+=</span>&nbsp;<span class="op" id="2185970">(</span><span class="ident" id="2185971">Tf</span>&nbsp;<span class="op" id="2185974">+</span>&nbsp;<span class="ident" id="2185976">p</span><span class="op" id="2185977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185981">case</span>&nbsp;<span class="num" id="2185986">2</span><span class="op" id="2185987">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185992">p1</span>&nbsp;<span class="op" id="2185995">:=</span>&nbsp;<span class="ident" id="2185998">y</span>&nbsp;<span class="op" id="2186000">*</span>&nbsp;<span class="op" id="2186002">(</span><span class="ident" id="2186003">_lgamU</span><span class="op" id="2186009">[</span><span class="num" id="2186010">0</span><span class="op" id="2186011">]</span>&nbsp;<span class="op" id="2186013">+</span>&nbsp;<span class="ident" id="2186015">y</span><span class="op" id="2186016">*</span><span class="op" id="2186017">(</span><span class="ident" id="2186018">_lgamU</span><span class="op" id="2186024">[</span><span class="num" id="2186025">1</span><span class="op" id="2186026">]</span><span class="op" id="2186027">+</span><span class="ident" id="2186028">y</span><span class="op" id="2186029">*</span><span class="op" id="2186030">(</span><span class="ident" id="2186031">_lgamU</span><span class="op" id="2186037">[</span><span class="num" id="2186038">2</span><span class="op" id="2186039">]</span><span class="op" id="2186040">+</span><span class="ident" id="2186041">y</span><span class="op" id="2186042">*</span><span class="op" id="2186043">(</span><span class="ident" id="2186044">_lgamU</span><span class="op" id="2186050">[</span><span class="num" id="2186051">3</span><span class="op" id="2186052">]</span><span class="op" id="2186053">+</span><span class="ident" id="2186054">y</span><span class="op" id="2186055">*</span><span class="op" id="2186056">(</span><span class="ident" id="2186057">_lgamU</span><span class="op" id="2186063">[</span><span class="num" id="2186064">4</span><span class="op" id="2186065">]</span><span class="op" id="2186066">+</span><span class="ident" id="2186067">y</span><span class="op" id="2186068">*</span><span class="ident" id="2186069">_lgamU</span><span class="op" id="2186075">[</span><span class="num" id="2186076">5</span><span class="op" id="2186077">]</span><span class="op" id="2186078">)</span><span class="op" id="2186079">)</span><span class="op" id="2186080">)</span><span class="op" id="2186081">)</span><span class="op" id="2186082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186087">p2</span>&nbsp;<span class="op" id="2186090">:=</span>&nbsp;<span class="num" id="2186093">1</span>&nbsp;<span class="op" id="2186095">+</span>&nbsp;<span class="ident" id="2186097">y</span><span class="op" id="2186098">*</span><span class="op" id="2186099">(</span><span class="ident" id="2186100">_lgamV</span><span class="op" id="2186106">[</span><span class="num" id="2186107">1</span><span class="op" id="2186108">]</span><span class="op" id="2186109">+</span><span class="ident" id="2186110">y</span><span class="op" id="2186111">*</span><span class="op" id="2186112">(</span><span class="ident" id="2186113">_lgamV</span><span class="op" id="2186119">[</span><span class="num" id="2186120">2</span><span class="op" id="2186121">]</span><span class="op" id="2186122">+</span><span class="ident" id="2186123">y</span><span class="op" id="2186124">*</span><span class="op" id="2186125">(</span><span class="ident" id="2186126">_lgamV</span><span class="op" id="2186132">[</span><span class="num" id="2186133">3</span><span class="op" id="2186134">]</span><span class="op" id="2186135">+</span><span class="ident" id="2186136">y</span><span class="op" id="2186137">*</span><span class="op" id="2186138">(</span><span class="ident" id="2186139">_lgamV</span><span class="op" id="2186145">[</span><span class="num" id="2186146">4</span><span class="op" id="2186147">]</span><span class="op" id="2186148">+</span><span class="ident" id="2186149">y</span><span class="op" id="2186150">*</span><span class="ident" id="2186151">_lgamV</span><span class="op" id="2186157">[</span><span class="num" id="2186158">5</span><span class="op" id="2186159">]</span><span class="op" id="2186160">)</span><span class="op" id="2186161">)</span><span class="op" id="2186162">)</span><span class="op" id="2186163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186168">lgamma</span>&nbsp;<span class="op" id="2186175">+=</span>&nbsp;<span class="op" id="2186178">(</span><span class="op" id="2186179">-</span><span class="num" id="2186180">0.5</span><span class="op" id="2186183">*</span><span class="ident" id="2186184">y</span>&nbsp;<span class="op" id="2186186">+</span>&nbsp;<span class="ident" id="2186188">p1</span><span class="op" id="2186190">/</span><span class="ident" id="2186191">p2</span><span class="op" id="2186193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2186197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186200">case</span>&nbsp;<span class="ident" id="2186205">x</span>&nbsp;<span class="op" id="2186207">&lt;</span>&nbsp;<span class="num" id="2186209">8</span><span class="op" id="2186210">:</span>&nbsp;<span class="comment" id="2186212">//&nbsp;2&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;8</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186228">i</span>&nbsp;<span class="op" id="2186230">:=</span>&nbsp;<span class="builtintype" id="2186233">int</span><span class="op" id="2186236">(</span><span class="ident" id="2186237">x</span><span class="op" id="2186238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186242">y</span>&nbsp;<span class="op" id="2186244">:=</span>&nbsp;<span class="ident" id="2186247">x</span>&nbsp;<span class="op" id="2186249">-</span>&nbsp;<span class="builtintype" id="2186251">float64</span><span class="op" id="2186258">(</span><span class="ident" id="2186259">i</span><span class="op" id="2186260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186264">p</span>&nbsp;<span class="op" id="2186266">:=</span>&nbsp;<span class="ident" id="2186269">y</span>&nbsp;<span class="op" id="2186271">*</span>&nbsp;<span class="op" id="2186273">(</span><span class="ident" id="2186274">_lgamS</span><span class="op" id="2186280">[</span><span class="num" id="2186281">0</span><span class="op" id="2186282">]</span>&nbsp;<span class="op" id="2186284">+</span>&nbsp;<span class="ident" id="2186286">y</span><span class="op" id="2186287">*</span><span class="op" id="2186288">(</span><span class="ident" id="2186289">_lgamS</span><span class="op" id="2186295">[</span><span class="num" id="2186296">1</span><span class="op" id="2186297">]</span><span class="op" id="2186298">+</span><span class="ident" id="2186299">y</span><span class="op" id="2186300">*</span><span class="op" id="2186301">(</span><span class="ident" id="2186302">_lgamS</span><span class="op" id="2186308">[</span><span class="num" id="2186309">2</span><span class="op" id="2186310">]</span><span class="op" id="2186311">+</span><span class="ident" id="2186312">y</span><span class="op" id="2186313">*</span><span class="op" id="2186314">(</span><span class="ident" id="2186315">_lgamS</span><span class="op" id="2186321">[</span><span class="num" id="2186322">3</span><span class="op" id="2186323">]</span><span class="op" id="2186324">+</span><span class="ident" id="2186325">y</span><span class="op" id="2186326">*</span><span class="op" id="2186327">(</span><span class="ident" id="2186328">_lgamS</span><span class="op" id="2186334">[</span><span class="num" id="2186335">4</span><span class="op" id="2186336">]</span><span class="op" id="2186337">+</span><span class="ident" id="2186338">y</span><span class="op" id="2186339">*</span><span class="op" id="2186340">(</span><span class="ident" id="2186341">_lgamS</span><span class="op" id="2186347">[</span><span class="num" id="2186348">5</span><span class="op" id="2186349">]</span><span class="op" id="2186350">+</span><span class="ident" id="2186351">y</span><span class="op" id="2186352">*</span><span class="ident" id="2186353">_lgamS</span><span class="op" id="2186359">[</span><span class="num" id="2186360">6</span><span class="op" id="2186361">]</span><span class="op" id="2186362">)</span><span class="op" id="2186363">)</span><span class="op" id="2186364">)</span><span class="op" id="2186365">)</span><span class="op" id="2186366">)</span><span class="op" id="2186367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186371">q</span>&nbsp;<span class="op" id="2186373">:=</span>&nbsp;<span class="num" id="2186376">1</span>&nbsp;<span class="op" id="2186378">+</span>&nbsp;<span class="ident" id="2186380">y</span><span class="op" id="2186381">*</span><span class="op" id="2186382">(</span><span class="ident" id="2186383">_lgamR</span><span class="op" id="2186389">[</span><span class="num" id="2186390">1</span><span class="op" id="2186391">]</span><span class="op" id="2186392">+</span><span class="ident" id="2186393">y</span><span class="op" id="2186394">*</span><span class="op" id="2186395">(</span><span class="ident" id="2186396">_lgamR</span><span class="op" id="2186402">[</span><span class="num" id="2186403">2</span><span class="op" id="2186404">]</span><span class="op" id="2186405">+</span><span class="ident" id="2186406">y</span><span class="op" id="2186407">*</span><span class="op" id="2186408">(</span><span class="ident" id="2186409">_lgamR</span><span class="op" id="2186415">[</span><span class="num" id="2186416">3</span><span class="op" id="2186417">]</span><span class="op" id="2186418">+</span><span class="ident" id="2186419">y</span><span class="op" id="2186420">*</span><span class="op" id="2186421">(</span><span class="ident" id="2186422">_lgamR</span><span class="op" id="2186428">[</span><span class="num" id="2186429">4</span><span class="op" id="2186430">]</span><span class="op" id="2186431">+</span><span class="ident" id="2186432">y</span><span class="op" id="2186433">*</span><span class="op" id="2186434">(</span><span class="ident" id="2186435">_lgamR</span><span class="op" id="2186441">[</span><span class="num" id="2186442">5</span><span class="op" id="2186443">]</span><span class="op" id="2186444">+</span><span class="ident" id="2186445">y</span><span class="op" id="2186446">*</span><span class="ident" id="2186447">_lgamR</span><span class="op" id="2186453">[</span><span class="num" id="2186454">6</span><span class="op" id="2186455">]</span><span class="op" id="2186456">)</span><span class="op" id="2186457">)</span><span class="op" id="2186458">)</span><span class="op" id="2186459">)</span><span class="op" id="2186460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186464">lgamma</span>&nbsp;<span class="op" id="2186471">=</span>&nbsp;<span class="num" id="2186473">0.5</span><span class="op" id="2186476">*</span><span class="ident" id="2186477">y</span>&nbsp;<span class="op" id="2186479">+</span>&nbsp;<span class="ident" id="2186481">p</span><span class="op" id="2186482">/</span><span class="ident" id="2186483">q</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186487">z</span>&nbsp;<span class="op" id="2186489">:=</span>&nbsp;<span class="num" id="2186492">1.0</span>&nbsp;<span class="comment" id="2186496">//&nbsp;Lgamma(1+s)&nbsp;=&nbsp;Log(s)&nbsp;+&nbsp;Lgamma(s)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186534">switch</span>&nbsp;<span class="ident" id="2186541">i</span>&nbsp;<span class="op" id="2186543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186547">case</span>&nbsp;<span class="num" id="2186552">7</span><span class="op" id="2186553">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186558">z</span>&nbsp;<span class="op" id="2186560">*=</span>&nbsp;<span class="op" id="2186563">(</span><span class="ident" id="2186564">y</span>&nbsp;<span class="op" id="2186566">+</span>&nbsp;<span class="num" id="2186568">6</span><span class="op" id="2186569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186574">fallthrough</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186588">case</span>&nbsp;<span class="num" id="2186593">6</span><span class="op" id="2186594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186599">z</span>&nbsp;<span class="op" id="2186601">*=</span>&nbsp;<span class="op" id="2186604">(</span><span class="ident" id="2186605">y</span>&nbsp;<span class="op" id="2186607">+</span>&nbsp;<span class="num" id="2186609">5</span><span class="op" id="2186610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186615">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186629">case</span>&nbsp;<span class="num" id="2186634">5</span><span class="op" id="2186635">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186640">z</span>&nbsp;<span class="op" id="2186642">*=</span>&nbsp;<span class="op" id="2186645">(</span><span class="ident" id="2186646">y</span>&nbsp;<span class="op" id="2186648">+</span>&nbsp;<span class="num" id="2186650">4</span><span class="op" id="2186651">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186656">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186670">case</span>&nbsp;<span class="num" id="2186675">4</span><span class="op" id="2186676">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186681">z</span>&nbsp;<span class="op" id="2186683">*=</span>&nbsp;<span class="op" id="2186686">(</span><span class="ident" id="2186687">y</span>&nbsp;<span class="op" id="2186689">+</span>&nbsp;<span class="num" id="2186691">3</span><span class="op" id="2186692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186697">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186711">case</span>&nbsp;<span class="num" id="2186716">3</span><span class="op" id="2186717">:</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186722">z</span>&nbsp;<span class="op" id="2186724">*=</span>&nbsp;<span class="op" id="2186727">(</span><span class="ident" id="2186728">y</span>&nbsp;<span class="op" id="2186730">+</span>&nbsp;<span class="num" id="2186732">2</span><span class="op" id="2186733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186738">lgamma</span>&nbsp;<span class="op" id="2186745">+=</span>&nbsp;<span class="ident" id="2186748">Log</span><span class="op" id="2186751">(</span><span class="ident" id="2186752">z</span><span class="op" id="2186753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2186757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186760">case</span>&nbsp;<span class="ident" id="2186765">x</span>&nbsp;<span class="op" id="2186767">&lt;</span>&nbsp;<span class="ident" id="2186769">Two58</span><span class="op" id="2186774">:</span>&nbsp;<span class="comment" id="2186776">//&nbsp;8&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2**58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186796">t</span>&nbsp;<span class="op" id="2186798">:=</span>&nbsp;<span class="ident" id="2186801">Log</span><span class="op" id="2186804">(</span><span class="ident" id="2186805">x</span><span class="op" id="2186806">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186810">z</span>&nbsp;<span class="op" id="2186812">:=</span>&nbsp;<span class="num" id="2186815">1</span>&nbsp;<span class="op" id="2186817">/</span>&nbsp;<span class="ident" id="2186819">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186823">y</span>&nbsp;<span class="op" id="2186825">:=</span>&nbsp;<span class="ident" id="2186828">z</span>&nbsp;<span class="op" id="2186830">*</span>&nbsp;<span class="ident" id="2186832">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186836">w</span>&nbsp;<span class="op" id="2186838">:=</span>&nbsp;<span class="ident" id="2186841">_lgamW</span><span class="op" id="2186847">[</span><span class="num" id="2186848">0</span><span class="op" id="2186849">]</span>&nbsp;<span class="op" id="2186851">+</span>&nbsp;<span class="ident" id="2186853">z</span><span class="op" id="2186854">*</span><span class="op" id="2186855">(</span><span class="ident" id="2186856">_lgamW</span><span class="op" id="2186862">[</span><span class="num" id="2186863">1</span><span class="op" id="2186864">]</span><span class="op" id="2186865">+</span><span class="ident" id="2186866">y</span><span class="op" id="2186867">*</span><span class="op" id="2186868">(</span><span class="ident" id="2186869">_lgamW</span><span class="op" id="2186875">[</span><span class="num" id="2186876">2</span><span class="op" id="2186877">]</span><span class="op" id="2186878">+</span><span class="ident" id="2186879">y</span><span class="op" id="2186880">*</span><span class="op" id="2186881">(</span><span class="ident" id="2186882">_lgamW</span><span class="op" id="2186888">[</span><span class="num" id="2186889">3</span><span class="op" id="2186890">]</span><span class="op" id="2186891">+</span><span class="ident" id="2186892">y</span><span class="op" id="2186893">*</span><span class="op" id="2186894">(</span><span class="ident" id="2186895">_lgamW</span><span class="op" id="2186901">[</span><span class="num" id="2186902">4</span><span class="op" id="2186903">]</span><span class="op" id="2186904">+</span><span class="ident" id="2186905">y</span><span class="op" id="2186906">*</span><span class="op" id="2186907">(</span><span class="ident" id="2186908">_lgamW</span><span class="op" id="2186914">[</span><span class="num" id="2186915">5</span><span class="op" id="2186916">]</span><span class="op" id="2186917">+</span><span class="ident" id="2186918">y</span><span class="op" id="2186919">*</span><span class="ident" id="2186920">_lgamW</span><span class="op" id="2186926">[</span><span class="num" id="2186927">6</span><span class="op" id="2186928">]</span><span class="op" id="2186929">)</span><span class="op" id="2186930">)</span><span class="op" id="2186931">)</span><span class="op" id="2186932">)</span><span class="op" id="2186933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186937">lgamma</span>&nbsp;<span class="op" id="2186944">=</span>&nbsp;<span class="op" id="2186946">(</span><span class="ident" id="2186947">x</span><span class="op" id="2186948">-</span><span class="num" id="2186949">0.5</span><span class="op" id="2186952">)</span><span class="op" id="2186953">*</span><span class="op" id="2186954">(</span><span class="ident" id="2186955">t</span><span class="op" id="2186956">-</span><span class="num" id="2186957">1</span><span class="op" id="2186958">)</span>&nbsp;<span class="op" id="2186960">+</span>&nbsp;<span class="ident" id="2186962">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186965">default</span><span class="op" id="2186972">:</span>&nbsp;<span class="comment" id="2186974">//&nbsp;2**58&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;Inf</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186997">lgamma</span>&nbsp;<span class="op" id="2187004">=</span>&nbsp;<span class="ident" id="2187006">x</span>&nbsp;<span class="op" id="2187008">*</span>&nbsp;<span class="op" id="2187010">(</span><span class="ident" id="2187011">Log</span><span class="op" id="2187014">(</span><span class="ident" id="2187015">x</span><span class="op" id="2187016">)</span>&nbsp;<span class="op" id="2187018">-</span>&nbsp;<span class="num" id="2187020">1</span><span class="op" id="2187021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187027">if</span>&nbsp;<span class="ident" id="2187030">neg</span>&nbsp;<span class="op" id="2187034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187038">lgamma</span>&nbsp;<span class="op" id="2187045">=</span>&nbsp;<span class="ident" id="2187047">nadj</span>&nbsp;<span class="op" id="2187052">-</span>&nbsp;<span class="ident" id="2187054">lgamma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187062">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187065">return</span><br>
<span class="lineno"></span><span class="op" id="2187072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2187075">//&nbsp;sinPi(x)&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;negative&nbsp;x</span><br>
<span class="lineno"></span><span class="keyword" id="2187123">func</span>&nbsp;<span class="ident" id="2187128">sinPi</span><span class="op" id="2187133">(</span><span class="ident" id="2187134">x</span>&nbsp;<span class="builtintype" id="2187136">float64</span><span class="op" id="2187143">)</span>&nbsp;<span class="builtintype" id="2187145">float64</span>&nbsp;<span class="op" id="2187153">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187156">const</span>&nbsp;<span class="op" id="2187162">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187166">Two52</span>&nbsp;<span class="op" id="2187172">=</span>&nbsp;<span class="num" id="2187174">1</span>&nbsp;<span class="op" id="2187176">&lt;&lt;</span>&nbsp;<span class="num" id="2187179">52</span>&nbsp;<span class="comment" id="2187182">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187218">Two53</span>&nbsp;<span class="op" id="2187224">=</span>&nbsp;<span class="num" id="2187226">1</span>&nbsp;<span class="op" id="2187228">&lt;&lt;</span>&nbsp;<span class="num" id="2187231">53</span>&nbsp;<span class="comment" id="2187234">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187272">if</span>&nbsp;<span class="ident" id="2187275">x</span>&nbsp;<span class="op" id="2187277">&lt;</span>&nbsp;<span class="num" id="2187279">0.25</span>&nbsp;<span class="op" id="2187284">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187288">return</span>&nbsp;<span class="op" id="2187295">-</span><span class="ident" id="2187296">Sin</span><span class="op" id="2187299">(</span><span class="ident" id="2187300">Pi</span>&nbsp;<span class="op" id="2187303">*</span>&nbsp;<span class="ident" id="2187305">x</span><span class="op" id="2187306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2187313">//&nbsp;argument&nbsp;reduction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187336">z</span>&nbsp;<span class="op" id="2187338">:=</span>&nbsp;<span class="ident" id="2187341">Floor</span><span class="op" id="2187346">(</span><span class="ident" id="2187347">x</span><span class="op" id="2187348">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187351">var</span>&nbsp;<span class="ident" id="2187355">n</span>&nbsp;<span class="builtintype" id="2187357">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187362">if</span>&nbsp;<span class="ident" id="2187365">z</span>&nbsp;<span class="op" id="2187367">!=</span>&nbsp;<span class="ident" id="2187370">x</span>&nbsp;<span class="op" id="2187372">{</span>&nbsp;<span class="comment" id="2187374">//&nbsp;inexact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187387">x</span>&nbsp;<span class="op" id="2187389">=</span>&nbsp;<span class="ident" id="2187391">Mod</span><span class="op" id="2187394">(</span><span class="ident" id="2187395">x</span><span class="op" id="2187396">,</span>&nbsp;<span class="num" id="2187398">2</span><span class="op" id="2187399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187403">n</span>&nbsp;<span class="op" id="2187405">=</span>&nbsp;<span class="builtintype" id="2187407">int</span><span class="op" id="2187410">(</span><span class="ident" id="2187411">x</span>&nbsp;<span class="op" id="2187413">*</span>&nbsp;<span class="num" id="2187415">4</span><span class="op" id="2187416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187419">}</span>&nbsp;<span class="keyword" id="2187421">else</span>&nbsp;<span class="op" id="2187426">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187430">if</span>&nbsp;<span class="ident" id="2187433">x</span>&nbsp;<span class="op" id="2187435">&gt;=</span>&nbsp;<span class="ident" id="2187438">Two53</span>&nbsp;<span class="op" id="2187444">{</span>&nbsp;<span class="comment" id="2187446">//&nbsp;x&nbsp;must&nbsp;be&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187467">x</span>&nbsp;<span class="op" id="2187469">=</span>&nbsp;<span class="num" id="2187471">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187476">n</span>&nbsp;<span class="op" id="2187478">=</span>&nbsp;<span class="num" id="2187480">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187484">}</span>&nbsp;<span class="keyword" id="2187486">else</span>&nbsp;<span class="op" id="2187491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187496">if</span>&nbsp;<span class="ident" id="2187499">x</span>&nbsp;<span class="op" id="2187501">&lt;</span>&nbsp;<span class="ident" id="2187503">Two52</span>&nbsp;<span class="op" id="2187509">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187515">z</span>&nbsp;<span class="op" id="2187517">=</span>&nbsp;<span class="ident" id="2187519">x</span>&nbsp;<span class="op" id="2187521">+</span>&nbsp;<span class="ident" id="2187523">Two52</span>&nbsp;<span class="comment" id="2187529">//&nbsp;exact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187546">n</span>&nbsp;<span class="op" id="2187548">=</span>&nbsp;<span class="builtintype" id="2187550">int</span><span class="op" id="2187553">(</span><span class="num" id="2187554">1</span>&nbsp;<span class="op" id="2187556">&amp;</span>&nbsp;<span class="ident" id="2187558">Float64bits</span><span class="op" id="2187569">(</span><span class="ident" id="2187570">z</span><span class="op" id="2187571">)</span><span class="op" id="2187572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187577">x</span>&nbsp;<span class="op" id="2187579">=</span>&nbsp;<span class="builtintype" id="2187581">float64</span><span class="op" id="2187588">(</span><span class="ident" id="2187589">n</span><span class="op" id="2187590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187595">n</span>&nbsp;<span class="op" id="2187597">&lt;&lt;=</span>&nbsp;<span class="num" id="2187601">2</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187611">switch</span>&nbsp;<span class="ident" id="2187618">n</span>&nbsp;<span class="op" id="2187620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187623">case</span>&nbsp;<span class="num" id="2187628">0</span><span class="op" id="2187629">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187633">x</span>&nbsp;<span class="op" id="2187635">=</span>&nbsp;<span class="ident" id="2187637">Sin</span><span class="op" id="2187640">(</span><span class="ident" id="2187641">Pi</span>&nbsp;<span class="op" id="2187644">*</span>&nbsp;<span class="ident" id="2187646">x</span><span class="op" id="2187647">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187650">case</span>&nbsp;<span class="num" id="2187655">1</span><span class="op" id="2187656">,</span>&nbsp;<span class="num" id="2187658">2</span><span class="op" id="2187659">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187663">x</span>&nbsp;<span class="op" id="2187665">=</span>&nbsp;<span class="ident" id="2187667">Cos</span><span class="op" id="2187670">(</span><span class="ident" id="2187671">Pi</span>&nbsp;<span class="op" id="2187674">*</span>&nbsp;<span class="op" id="2187676">(</span><span class="num" id="2187677">0.5</span>&nbsp;<span class="op" id="2187681">-</span>&nbsp;<span class="ident" id="2187683">x</span><span class="op" id="2187684">)</span><span class="op" id="2187685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187688">case</span>&nbsp;<span class="num" id="2187693">3</span><span class="op" id="2187694">,</span>&nbsp;<span class="num" id="2187696">4</span><span class="op" id="2187697">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187701">x</span>&nbsp;<span class="op" id="2187703">=</span>&nbsp;<span class="ident" id="2187705">Sin</span><span class="op" id="2187708">(</span><span class="ident" id="2187709">Pi</span>&nbsp;<span class="op" id="2187712">*</span>&nbsp;<span class="op" id="2187714">(</span><span class="num" id="2187715">1</span>&nbsp;<span class="op" id="2187717">-</span>&nbsp;<span class="ident" id="2187719">x</span><span class="op" id="2187720">)</span><span class="op" id="2187721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187724">case</span>&nbsp;<span class="num" id="2187729">5</span><span class="op" id="2187730">,</span>&nbsp;<span class="num" id="2187732">6</span><span class="op" id="2187733">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187737">x</span>&nbsp;<span class="op" id="2187739">=</span>&nbsp;<span class="op" id="2187741">-</span><span class="ident" id="2187742">Cos</span><span class="op" id="2187745">(</span><span class="ident" id="2187746">Pi</span>&nbsp;<span class="op" id="2187749">*</span>&nbsp;<span class="op" id="2187751">(</span><span class="ident" id="2187752">x</span>&nbsp;<span class="op" id="2187754">-</span>&nbsp;<span class="num" id="2187756">1.5</span><span class="op" id="2187759">)</span><span class="op" id="2187760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187763">default</span><span class="op" id="2187770">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187774">x</span>&nbsp;<span class="op" id="2187776">=</span>&nbsp;<span class="ident" id="2187778">Sin</span><span class="op" id="2187781">(</span><span class="ident" id="2187782">Pi</span>&nbsp;<span class="op" id="2187785">*</span>&nbsp;<span class="op" id="2187787">(</span><span class="ident" id="2187788">x</span>&nbsp;<span class="op" id="2187790">-</span>&nbsp;<span class="num" id="2187792">2</span><span class="op" id="2187793">)</span><span class="op" id="2187794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187800">return</span>&nbsp;<span class="op" id="2187807">-</span><span class="ident" id="2187808">x</span><br>
<span class="lineno">365</span><span class="op" id="2187810">}</span>
</div>
</body>
</html>
