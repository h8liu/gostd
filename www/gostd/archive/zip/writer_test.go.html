<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>archive/zip</h2>
<ul>
<li><a href="/gostd/archive/zip/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/archive/zip/reader.go.html">reader.go</a></li>
<li><a href="/gostd/archive/zip/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/archive/zip/register.go.html">register.go</a></li>
<li><a href="/gostd/archive/zip/struct.go.html">struct.go</a></li>
<li><a href="/gostd/archive/zip/writer.go.html">writer.go</a></li>
<li><a href="/gostd/archive/zip/writer_test.go.html" class="current">writer_test.go</a></li>
<li><a href="/gostd/archive/zip/zip_test.go.html">zip_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7417816">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7417871">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7417925">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7417976">package</span>&nbsp;<span class="ident" id="7417984">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7417989">import</span>&nbsp;<span class="op" id="7417996">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417999">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418008">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418014">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418027">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418040">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418046">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7418056">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="7418059">//&nbsp;TODO(adg):&nbsp;a&nbsp;more&nbsp;sophisticated&nbsp;test&nbsp;suite</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7418106">type</span>&nbsp;<span class="ident" id="7418111">WriteTest</span>&nbsp;<span class="keyword" id="7418121">struct</span>&nbsp;<span class="op" id="7418128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418131">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7418138">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418146">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7418153">[</span><span class="op" id="7418154">]</span><span class="builtintype" id="7418155">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418161">Method</span>&nbsp;<span class="builtintype" id="7418168">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418176">Mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7418183">os</span><span class="op" id="7418185">.</span><span class="ident" id="7418186">FileMode</span><br>
<span class="lineno"></span><span class="op" id="7418195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="7418198">var</span>&nbsp;<span class="ident" id="7418202">writeTests</span>&nbsp;<span class="op" id="7418213">=</span>&nbsp;<span class="op" id="7418215">[</span><span class="op" id="7418216">]</span><span class="ident" id="7418217">WriteTest</span><span class="op" id="7418226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7418229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418233">Name</span><span class="op" id="7418237">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7418241">&#34;foo&#34;</span><span class="op" id="7418246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418250">Data</span><span class="op" id="7418254">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7418258">[</span><span class="op" id="7418259">]</span><span class="builtintype" id="7418260">byte</span><span class="op" id="7418264">(</span><span class="string" id="7418265">&#34;Rabbits,&nbsp;guinea&nbsp;pigs,&nbsp;gophers,&nbsp;marsupial&nbsp;rats,&nbsp;and&nbsp;quolls.&#34;</span><span class="op" id="7418325">)</span><span class="op" id="7418326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418330">Method</span><span class="op" id="7418336">:</span>&nbsp;<span class="ident" id="7418338">Store</span><span class="op" id="7418343">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418347">Mode</span><span class="op" id="7418351">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7418355">0666</span><span class="op" id="7418359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7418362">}</span><span class="op" id="7418363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7418366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418370">Name</span><span class="op" id="7418374">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7418378">&#34;bar&#34;</span><span class="op" id="7418383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418387">Data</span><span class="op" id="7418391">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7418395">nil</span><span class="op" id="7418398">,</span>&nbsp;<span class="comment" id="7418400">//&nbsp;large&nbsp;data&nbsp;set&nbsp;in&nbsp;the&nbsp;test</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418432">Method</span><span class="op" id="7418438">:</span>&nbsp;<span class="ident" id="7418440">Deflate</span><span class="op" id="7418447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418451">Mode</span><span class="op" id="7418455">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7418459">0644</span><span class="op" id="7418463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7418466">}</span><span class="op" id="7418467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7418470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418474">Name</span><span class="op" id="7418478">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7418482">&#34;setuid&#34;</span><span class="op" id="7418490">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418494">Data</span><span class="op" id="7418498">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7418502">[</span><span class="op" id="7418503">]</span><span class="builtintype" id="7418504">byte</span><span class="op" id="7418508">(</span><span class="string" id="7418509">&#34;setuid&nbsp;file&#34;</span><span class="op" id="7418522">)</span><span class="op" id="7418523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418527">Method</span><span class="op" id="7418533">:</span>&nbsp;<span class="ident" id="7418535">Deflate</span><span class="op" id="7418542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418546">Mode</span><span class="op" id="7418550">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7418554">0755</span>&nbsp;<span class="op" id="7418559">|</span>&nbsp;<span class="ident" id="7418561">os</span><span class="op" id="7418563">.</span><span class="ident" id="7418564">ModeSetuid</span><span class="op" id="7418574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7418577">}</span><span class="op" id="7418578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7418581">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418585">Name</span><span class="op" id="7418589">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7418593">&#34;setgid&#34;</span><span class="op" id="7418601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418605">Data</span><span class="op" id="7418609">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7418613">[</span><span class="op" id="7418614">]</span><span class="builtintype" id="7418615">byte</span><span class="op" id="7418619">(</span><span class="string" id="7418620">&#34;setgid&nbsp;file&#34;</span><span class="op" id="7418633">)</span><span class="op" id="7418634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418638">Method</span><span class="op" id="7418644">:</span>&nbsp;<span class="ident" id="7418646">Deflate</span><span class="op" id="7418653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418657">Mode</span><span class="op" id="7418661">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7418665">0755</span>&nbsp;<span class="op" id="7418670">|</span>&nbsp;<span class="ident" id="7418672">os</span><span class="op" id="7418674">.</span><span class="ident" id="7418675">ModeSetgid</span><span class="op" id="7418685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7418688">}</span><span class="op" id="7418689">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7418692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418696">Name</span><span class="op" id="7418700">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7418704">&#34;symlink&#34;</span><span class="op" id="7418713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418717">Data</span><span class="op" id="7418721">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7418725">[</span><span class="op" id="7418726">]</span><span class="builtintype" id="7418727">byte</span><span class="op" id="7418731">(</span><span class="string" id="7418732">&#34;../link/target&#34;</span><span class="op" id="7418748">)</span><span class="op" id="7418749">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418753">Method</span><span class="op" id="7418759">:</span>&nbsp;<span class="ident" id="7418761">Deflate</span><span class="op" id="7418768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418772">Mode</span><span class="op" id="7418776">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7418780">0755</span>&nbsp;<span class="op" id="7418785">|</span>&nbsp;<span class="ident" id="7418787">os</span><span class="op" id="7418789">.</span><span class="ident" id="7418790">ModeSymlink</span><span class="op" id="7418801">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7418804">}</span><span class="op" id="7418805">,</span><br>
<span class="lineno"></span><span class="op" id="7418807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7418810">func</span>&nbsp;<span class="ident" id="7418815">TestWriter</span><span class="op" id="7418825">(</span><span class="ident" id="7418826">t</span>&nbsp;<span class="op" id="7418828">*</span><span class="ident" id="7418829">testing</span><span class="op" id="7418836">.</span><span class="ident" id="7418837">T</span><span class="op" id="7418838">)</span>&nbsp;<span class="op" id="7418840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418843">largeData</span>&nbsp;<span class="op" id="7418853">:=</span>&nbsp;<span class="builtinfunc" id="7418856">make</span><span class="op" id="7418860">(</span><span class="op" id="7418861">[</span><span class="op" id="7418862">]</span><span class="builtintype" id="7418863">byte</span><span class="op" id="7418867">,</span>&nbsp;<span class="num" id="7418869">1</span><span class="op" id="7418870">&lt;&lt;</span><span class="num" id="7418872">17</span><span class="op" id="7418874">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7418877">for</span>&nbsp;<span class="ident" id="7418881">i</span>&nbsp;<span class="op" id="7418883">:=</span>&nbsp;<span class="keyword" id="7418886">range</span>&nbsp;<span class="ident" id="7418892">largeData</span>&nbsp;<span class="op" id="7418902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418906">largeData</span><span class="op" id="7418915">[</span><span class="ident" id="7418916">i</span><span class="op" id="7418917">]</span>&nbsp;<span class="op" id="7418919">=</span>&nbsp;<span class="builtintype" id="7418921">byte</span><span class="op" id="7418925">(</span><span class="ident" id="7418926">rand</span><span class="op" id="7418930">.</span><span class="ident" id="7418931">Int</span><span class="op" id="7418934">(</span><span class="op" id="7418935">)</span><span class="op" id="7418936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7418939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418942">writeTests</span><span class="op" id="7418952">[</span><span class="num" id="7418953">1</span><span class="op" id="7418954">]</span><span class="op" id="7418955">.</span><span class="ident" id="7418956">Data</span>&nbsp;<span class="op" id="7418961">=</span>&nbsp;<span class="ident" id="7418963">largeData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7418974">defer</span>&nbsp;<span class="keyword" id="7418980">func</span><span class="op" id="7418984">(</span><span class="op" id="7418985">)</span>&nbsp;<span class="op" id="7418987">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418991">writeTests</span><span class="op" id="7419001">[</span><span class="num" id="7419002">1</span><span class="op" id="7419003">]</span><span class="op" id="7419004">.</span><span class="ident" id="7419005">Data</span>&nbsp;<span class="op" id="7419010">=</span>&nbsp;<span class="builtintype" id="7419012">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419017">}</span><span class="op" id="7419018">(</span><span class="op" id="7419019">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7419023">//&nbsp;write&nbsp;a&nbsp;zip&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419044">buf</span>&nbsp;<span class="op" id="7419048">:=</span>&nbsp;<span class="builtinfunc" id="7419051">new</span><span class="op" id="7419054">(</span><span class="ident" id="7419055">bytes</span><span class="op" id="7419060">.</span><span class="ident" id="7419061">Buffer</span><span class="op" id="7419067">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419070">w</span>&nbsp;<span class="op" id="7419072">:=</span>&nbsp;<span class="ident" id="7419075">NewWriter</span><span class="op" id="7419084">(</span><span class="ident" id="7419085">buf</span><span class="op" id="7419088">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419092">for</span>&nbsp;<span class="ident" id="7419096">_</span><span class="op" id="7419097">,</span>&nbsp;<span class="ident" id="7419099">wt</span>&nbsp;<span class="op" id="7419102">:=</span>&nbsp;<span class="keyword" id="7419105">range</span>&nbsp;<span class="ident" id="7419111">writeTests</span>&nbsp;<span class="op" id="7419122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419126">testCreate</span><span class="op" id="7419136">(</span><span class="ident" id="7419137">t</span><span class="op" id="7419138">,</span>&nbsp;<span class="ident" id="7419140">w</span><span class="op" id="7419141">,</span>&nbsp;<span class="op" id="7419143">&amp;</span><span class="ident" id="7419144">wt</span><span class="op" id="7419146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419149">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419153">if</span>&nbsp;<span class="ident" id="7419156">err</span>&nbsp;<span class="op" id="7419160">:=</span>&nbsp;<span class="ident" id="7419163">w</span><span class="op" id="7419164">.</span><span class="ident" id="7419165">Close</span><span class="op" id="7419170">(</span><span class="op" id="7419171">)</span><span class="op" id="7419172">;</span>&nbsp;<span class="ident" id="7419174">err</span>&nbsp;<span class="op" id="7419178">!=</span>&nbsp;<span class="builtintype" id="7419181">nil</span>&nbsp;<span class="op" id="7419185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419189">t</span><span class="op" id="7419190">.</span><span class="ident" id="7419191">Fatal</span><span class="op" id="7419196">(</span><span class="ident" id="7419197">err</span><span class="op" id="7419200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7419207">//&nbsp;read&nbsp;it&nbsp;back</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419224">r</span><span class="op" id="7419225">,</span>&nbsp;<span class="ident" id="7419227">err</span>&nbsp;<span class="op" id="7419231">:=</span>&nbsp;<span class="ident" id="7419234">NewReader</span><span class="op" id="7419243">(</span><span class="ident" id="7419244">bytes</span><span class="op" id="7419249">.</span><span class="ident" id="7419250">NewReader</span><span class="op" id="7419259">(</span><span class="ident" id="7419260">buf</span><span class="op" id="7419263">.</span><span class="ident" id="7419264">Bytes</span><span class="op" id="7419269">(</span><span class="op" id="7419270">)</span><span class="op" id="7419271">)</span><span class="op" id="7419272">,</span>&nbsp;<span class="ident" id="7419274">int64</span><span class="op" id="7419279">(</span><span class="ident" id="7419280">buf</span><span class="op" id="7419283">.</span><span class="ident" id="7419284">Len</span><span class="op" id="7419287">(</span><span class="op" id="7419288">)</span><span class="op" id="7419289">)</span><span class="op" id="7419290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419293">if</span>&nbsp;<span class="ident" id="7419296">err</span>&nbsp;<span class="op" id="7419300">!=</span>&nbsp;<span class="builtintype" id="7419303">nil</span>&nbsp;<span class="op" id="7419307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419311">t</span><span class="op" id="7419312">.</span><span class="ident" id="7419313">Fatal</span><span class="op" id="7419318">(</span><span class="ident" id="7419319">err</span><span class="op" id="7419322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419325">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419328">for</span>&nbsp;<span class="ident" id="7419332">i</span><span class="op" id="7419333">,</span>&nbsp;<span class="ident" id="7419335">wt</span>&nbsp;<span class="op" id="7419338">:=</span>&nbsp;<span class="keyword" id="7419341">range</span>&nbsp;<span class="ident" id="7419347">writeTests</span>&nbsp;<span class="op" id="7419358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419362">testReadFile</span><span class="op" id="7419374">(</span><span class="ident" id="7419375">t</span><span class="op" id="7419376">,</span>&nbsp;<span class="ident" id="7419378">r</span><span class="op" id="7419379">.</span><span class="ident" id="7419380">File</span><span class="op" id="7419384">[</span><span class="ident" id="7419385">i</span><span class="op" id="7419386">]</span><span class="op" id="7419387">,</span>&nbsp;<span class="op" id="7419389">&amp;</span><span class="ident" id="7419390">wt</span><span class="op" id="7419392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419395">}</span><br>
<span class="lineno"></span><span class="op" id="7419397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7419400">func</span>&nbsp;<span class="ident" id="7419405">TestWriterFlush</span><span class="op" id="7419420">(</span><span class="ident" id="7419421">t</span>&nbsp;<span class="op" id="7419423">*</span><span class="ident" id="7419424">testing</span><span class="op" id="7419431">.</span><span class="ident" id="7419432">T</span><span class="op" id="7419433">)</span>&nbsp;<span class="op" id="7419435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419438">var</span>&nbsp;<span class="ident" id="7419442">buf</span>&nbsp;<span class="ident" id="7419446">bytes</span><span class="op" id="7419451">.</span><span class="ident" id="7419452">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419460">w</span>&nbsp;<span class="op" id="7419462">:=</span>&nbsp;<span class="ident" id="7419465">NewWriter</span><span class="op" id="7419474">(</span><span class="keyword" id="7419475">struct</span><span class="op" id="7419481">{</span>&nbsp;<span class="ident" id="7419483">io</span><span class="op" id="7419485">.</span><span class="ident" id="7419486">Writer</span>&nbsp;<span class="op" id="7419493">}</span><span class="op" id="7419494">{</span><span class="op" id="7419495">&amp;</span><span class="ident" id="7419496">buf</span><span class="op" id="7419499">}</span><span class="op" id="7419500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419503">_</span><span class="op" id="7419504">,</span>&nbsp;<span class="ident" id="7419506">err</span>&nbsp;<span class="op" id="7419510">:=</span>&nbsp;<span class="ident" id="7419513">w</span><span class="op" id="7419514">.</span><span class="ident" id="7419515">Create</span><span class="op" id="7419521">(</span><span class="string" id="7419522">&#34;foo&#34;</span><span class="op" id="7419527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419530">if</span>&nbsp;<span class="ident" id="7419533">err</span>&nbsp;<span class="op" id="7419537">!=</span>&nbsp;<span class="builtintype" id="7419540">nil</span>&nbsp;<span class="op" id="7419544">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419548">t</span><span class="op" id="7419549">.</span><span class="ident" id="7419550">Fatal</span><span class="op" id="7419555">(</span><span class="ident" id="7419556">err</span><span class="op" id="7419559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419565">if</span>&nbsp;<span class="ident" id="7419568">buf</span><span class="op" id="7419571">.</span><span class="ident" id="7419572">Len</span><span class="op" id="7419575">(</span><span class="op" id="7419576">)</span>&nbsp;<span class="op" id="7419578">&gt;</span>&nbsp;<span class="num" id="7419580">0</span>&nbsp;<span class="op" id="7419582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419586">t</span><span class="op" id="7419587">.</span><span class="ident" id="7419588">Fatalf</span><span class="op" id="7419594">(</span><span class="string" id="7419595">&#34;Unexpected&nbsp;%d&nbsp;bytes&nbsp;already&nbsp;in&nbsp;buffer&#34;</span><span class="op" id="7419634">,</span>&nbsp;<span class="ident" id="7419636">buf</span><span class="op" id="7419639">.</span><span class="ident" id="7419640">Len</span><span class="op" id="7419643">(</span><span class="op" id="7419644">)</span><span class="op" id="7419645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419648">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419651">if</span>&nbsp;<span class="ident" id="7419654">err</span>&nbsp;<span class="op" id="7419658">:=</span>&nbsp;<span class="ident" id="7419661">w</span><span class="op" id="7419662">.</span><span class="ident" id="7419663">Flush</span><span class="op" id="7419668">(</span><span class="op" id="7419669">)</span><span class="op" id="7419670">;</span>&nbsp;<span class="ident" id="7419672">err</span>&nbsp;<span class="op" id="7419676">!=</span>&nbsp;<span class="builtintype" id="7419679">nil</span>&nbsp;<span class="op" id="7419683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419687">t</span><span class="op" id="7419688">.</span><span class="ident" id="7419689">Fatal</span><span class="op" id="7419694">(</span><span class="ident" id="7419695">err</span><span class="op" id="7419698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419704">if</span>&nbsp;<span class="ident" id="7419707">buf</span><span class="op" id="7419710">.</span><span class="ident" id="7419711">Len</span><span class="op" id="7419714">(</span><span class="op" id="7419715">)</span>&nbsp;<span class="op" id="7419717">==</span>&nbsp;<span class="num" id="7419720">0</span>&nbsp;<span class="op" id="7419722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419726">t</span><span class="op" id="7419727">.</span><span class="ident" id="7419728">Fatal</span><span class="op" id="7419733">(</span><span class="string" id="7419734">&#34;No&nbsp;bytes&nbsp;written&nbsp;after&nbsp;Flush&#34;</span><span class="op" id="7419764">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419767">}</span><br>
<span class="lineno"></span><span class="op" id="7419769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7419772">func</span>&nbsp;<span class="ident" id="7419777">testCreate</span><span class="op" id="7419787">(</span><span class="ident" id="7419788">t</span>&nbsp;<span class="op" id="7419790">*</span><span class="ident" id="7419791">testing</span><span class="op" id="7419798">.</span><span class="ident" id="7419799">T</span><span class="op" id="7419800">,</span>&nbsp;<span class="ident" id="7419802">w</span>&nbsp;<span class="op" id="7419804">*</span><span class="ident" id="7419805">Writer</span><span class="op" id="7419811">,</span>&nbsp;<span class="ident" id="7419813">wt</span>&nbsp;<span class="op" id="7419816">*</span><span class="ident" id="7419817">WriteTest</span><span class="op" id="7419826">)</span>&nbsp;<span class="op" id="7419828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419831">header</span>&nbsp;<span class="op" id="7419838">:=</span>&nbsp;<span class="op" id="7419841">&amp;</span><span class="ident" id="7419842">FileHeader</span><span class="op" id="7419852">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419856">Name</span><span class="op" id="7419860">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7419864">wt</span><span class="op" id="7419866">.</span><span class="ident" id="7419867">Name</span><span class="op" id="7419871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419875">Method</span><span class="op" id="7419881">:</span>&nbsp;<span class="ident" id="7419883">wt</span><span class="op" id="7419885">.</span><span class="ident" id="7419886">Method</span><span class="op" id="7419892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419898">if</span>&nbsp;<span class="ident" id="7419901">wt</span><span class="op" id="7419903">.</span><span class="ident" id="7419904">Mode</span>&nbsp;<span class="op" id="7419909">!=</span>&nbsp;<span class="num" id="7419912">0</span>&nbsp;<span class="op" id="7419914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419918">header</span><span class="op" id="7419924">.</span><span class="ident" id="7419925">SetMode</span><span class="op" id="7419932">(</span><span class="ident" id="7419933">wt</span><span class="op" id="7419935">.</span><span class="ident" id="7419936">Mode</span><span class="op" id="7419940">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419946">f</span><span class="op" id="7419947">,</span>&nbsp;<span class="ident" id="7419949">err</span>&nbsp;<span class="op" id="7419953">:=</span>&nbsp;<span class="ident" id="7419956">w</span><span class="op" id="7419957">.</span><span class="ident" id="7419958">CreateHeader</span><span class="op" id="7419970">(</span><span class="ident" id="7419971">header</span><span class="op" id="7419977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419980">if</span>&nbsp;<span class="ident" id="7419983">err</span>&nbsp;<span class="op" id="7419987">!=</span>&nbsp;<span class="builtintype" id="7419990">nil</span>&nbsp;<span class="op" id="7419994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419998">t</span><span class="op" id="7419999">.</span><span class="ident" id="7420000">Fatal</span><span class="op" id="7420005">(</span><span class="ident" id="7420006">err</span><span class="op" id="7420009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7420012">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420015">_</span><span class="op" id="7420016">,</span>&nbsp;<span class="ident" id="7420018">err</span>&nbsp;<span class="op" id="7420022">=</span>&nbsp;<span class="ident" id="7420024">f</span><span class="op" id="7420025">.</span><span class="ident" id="7420026">Write</span><span class="op" id="7420031">(</span><span class="ident" id="7420032">wt</span><span class="op" id="7420034">.</span><span class="ident" id="7420035">Data</span><span class="op" id="7420039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7420042">if</span>&nbsp;<span class="ident" id="7420045">err</span>&nbsp;<span class="op" id="7420049">!=</span>&nbsp;<span class="builtintype" id="7420052">nil</span>&nbsp;<span class="op" id="7420056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420060">t</span><span class="op" id="7420061">.</span><span class="ident" id="7420062">Fatal</span><span class="op" id="7420067">(</span><span class="ident" id="7420068">err</span><span class="op" id="7420071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7420074">}</span><br>
<span class="lineno"></span><span class="op" id="7420076">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="7420079">func</span>&nbsp;<span class="ident" id="7420084">testReadFile</span><span class="op" id="7420096">(</span><span class="ident" id="7420097">t</span>&nbsp;<span class="op" id="7420099">*</span><span class="ident" id="7420100">testing</span><span class="op" id="7420107">.</span><span class="ident" id="7420108">T</span><span class="op" id="7420109">,</span>&nbsp;<span class="ident" id="7420111">f</span>&nbsp;<span class="op" id="7420113">*</span><span class="ident" id="7420114">File</span><span class="op" id="7420118">,</span>&nbsp;<span class="ident" id="7420120">wt</span>&nbsp;<span class="op" id="7420123">*</span><span class="ident" id="7420124">WriteTest</span><span class="op" id="7420133">)</span>&nbsp;<span class="op" id="7420135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7420138">if</span>&nbsp;<span class="ident" id="7420141">f</span><span class="op" id="7420142">.</span><span class="ident" id="7420143">Name</span>&nbsp;<span class="op" id="7420148">!=</span>&nbsp;<span class="ident" id="7420151">wt</span><span class="op" id="7420153">.</span><span class="ident" id="7420154">Name</span>&nbsp;<span class="op" id="7420159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420163">t</span><span class="op" id="7420164">.</span><span class="ident" id="7420165">Fatalf</span><span class="op" id="7420171">(</span><span class="string" id="7420172">&#34;File&nbsp;name:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7420200">,</span>&nbsp;<span class="ident" id="7420202">f</span><span class="op" id="7420203">.</span><span class="ident" id="7420204">Name</span><span class="op" id="7420208">,</span>&nbsp;<span class="ident" id="7420210">wt</span><span class="op" id="7420212">.</span><span class="ident" id="7420213">Name</span><span class="op" id="7420217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7420220">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420223">testFileMode</span><span class="op" id="7420235">(</span><span class="ident" id="7420236">t</span><span class="op" id="7420237">,</span>&nbsp;<span class="ident" id="7420239">wt</span><span class="op" id="7420241">.</span><span class="ident" id="7420242">Name</span><span class="op" id="7420246">,</span>&nbsp;<span class="ident" id="7420248">f</span><span class="op" id="7420249">,</span>&nbsp;<span class="ident" id="7420251">wt</span><span class="op" id="7420253">.</span><span class="ident" id="7420254">Mode</span><span class="op" id="7420258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420261">rc</span><span class="op" id="7420263">,</span>&nbsp;<span class="ident" id="7420265">err</span>&nbsp;<span class="op" id="7420269">:=</span>&nbsp;<span class="ident" id="7420272">f</span><span class="op" id="7420273">.</span><span class="ident" id="7420274">Open</span><span class="op" id="7420278">(</span><span class="op" id="7420279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7420282">if</span>&nbsp;<span class="ident" id="7420285">err</span>&nbsp;<span class="op" id="7420289">!=</span>&nbsp;<span class="builtintype" id="7420292">nil</span>&nbsp;<span class="op" id="7420296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420300">t</span><span class="op" id="7420301">.</span><span class="ident" id="7420302">Fatal</span><span class="op" id="7420307">(</span><span class="string" id="7420308">&#34;opening:&#34;</span><span class="op" id="7420318">,</span>&nbsp;<span class="ident" id="7420320">err</span><span class="op" id="7420323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7420326">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420329">b</span><span class="op" id="7420330">,</span>&nbsp;<span class="ident" id="7420332">err</span>&nbsp;<span class="op" id="7420336">:=</span>&nbsp;<span class="ident" id="7420339">ioutil</span><span class="op" id="7420345">.</span><span class="ident" id="7420346">ReadAll</span><span class="op" id="7420353">(</span><span class="ident" id="7420354">rc</span><span class="op" id="7420356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7420359">if</span>&nbsp;<span class="ident" id="7420362">err</span>&nbsp;<span class="op" id="7420366">!=</span>&nbsp;<span class="builtintype" id="7420369">nil</span>&nbsp;<span class="op" id="7420373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420377">t</span><span class="op" id="7420378">.</span><span class="ident" id="7420379">Fatal</span><span class="op" id="7420384">(</span><span class="string" id="7420385">&#34;reading:&#34;</span><span class="op" id="7420395">,</span>&nbsp;<span class="ident" id="7420397">err</span><span class="op" id="7420400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7420403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420406">err</span>&nbsp;<span class="op" id="7420410">=</span>&nbsp;<span class="ident" id="7420412">rc</span><span class="op" id="7420414">.</span><span class="ident" id="7420415">Close</span><span class="op" id="7420420">(</span><span class="op" id="7420421">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7420424">if</span>&nbsp;<span class="ident" id="7420427">err</span>&nbsp;<span class="op" id="7420431">!=</span>&nbsp;<span class="builtintype" id="7420434">nil</span>&nbsp;<span class="op" id="7420438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420442">t</span><span class="op" id="7420443">.</span><span class="ident" id="7420444">Fatal</span><span class="op" id="7420449">(</span><span class="string" id="7420450">&#34;closing:&#34;</span><span class="op" id="7420460">,</span>&nbsp;<span class="ident" id="7420462">err</span><span class="op" id="7420465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7420468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7420471">if</span>&nbsp;<span class="op" id="7420474">!</span><span class="ident" id="7420475">bytes</span><span class="op" id="7420480">.</span><span class="ident" id="7420481">Equal</span><span class="op" id="7420486">(</span><span class="ident" id="7420487">b</span><span class="op" id="7420488">,</span>&nbsp;<span class="ident" id="7420490">wt</span><span class="op" id="7420492">.</span><span class="ident" id="7420493">Data</span><span class="op" id="7420497">)</span>&nbsp;<span class="op" id="7420499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420503">t</span><span class="op" id="7420504">.</span><span class="ident" id="7420505">Errorf</span><span class="op" id="7420511">(</span><span class="string" id="7420512">&#34;File&nbsp;contents&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7420539">,</span>&nbsp;<span class="ident" id="7420541">b</span><span class="op" id="7420542">,</span>&nbsp;<span class="ident" id="7420544">wt</span><span class="op" id="7420546">.</span><span class="ident" id="7420547">Data</span><span class="op" id="7420551">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7420554">}</span><br>
<span class="lineno"></span><span class="op" id="7420556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7420559">func</span>&nbsp;<span class="ident" id="7420564">BenchmarkCompressedZipGarbage</span><span class="op" id="7420593">(</span><span class="ident" id="7420594">b</span>&nbsp;<span class="op" id="7420596">*</span><span class="ident" id="7420597">testing</span><span class="op" id="7420604">.</span><span class="ident" id="7420605">B</span><span class="op" id="7420606">)</span>&nbsp;<span class="op" id="7420608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420611">b</span><span class="op" id="7420612">.</span><span class="ident" id="7420613">ReportAllocs</span><span class="op" id="7420625">(</span><span class="op" id="7420626">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7420629">var</span>&nbsp;<span class="ident" id="7420633">buf</span>&nbsp;<span class="ident" id="7420637">bytes</span><span class="op" id="7420642">.</span><span class="ident" id="7420643">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420651">bigBuf</span>&nbsp;<span class="op" id="7420658">:=</span>&nbsp;<span class="ident" id="7420661">bytes</span><span class="op" id="7420666">.</span><span class="ident" id="7420667">Repeat</span><span class="op" id="7420673">(</span><span class="op" id="7420674">[</span><span class="op" id="7420675">]</span><span class="builtintype" id="7420676">byte</span><span class="op" id="7420680">(</span><span class="string" id="7420681">&#34;a&#34;</span><span class="op" id="7420684">)</span><span class="op" id="7420685">,</span>&nbsp;<span class="num" id="7420687">1</span><span class="op" id="7420688">&lt;&lt;</span><span class="num" id="7420690">20</span><span class="op" id="7420692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7420695">for</span>&nbsp;<span class="ident" id="7420699">i</span>&nbsp;<span class="op" id="7420701">:=</span>&nbsp;<span class="num" id="7420704">0</span><span class="op" id="7420705">;</span>&nbsp;<span class="ident" id="7420707">i</span>&nbsp;<span class="op" id="7420709">&lt;</span>&nbsp;<span class="ident" id="7420711">b</span><span class="op" id="7420712">.</span><span class="ident" id="7420713">N</span><span class="op" id="7420714">;</span>&nbsp;<span class="ident" id="7420716">i</span><span class="op" id="7420717">++</span>&nbsp;<span class="op" id="7420720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420724">buf</span><span class="op" id="7420727">.</span><span class="ident" id="7420728">Reset</span><span class="op" id="7420733">(</span><span class="op" id="7420734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420738">zw</span>&nbsp;<span class="op" id="7420741">:=</span>&nbsp;<span class="ident" id="7420744">NewWriter</span><span class="op" id="7420753">(</span><span class="op" id="7420754">&amp;</span><span class="ident" id="7420755">buf</span><span class="op" id="7420758">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7420762">for</span>&nbsp;<span class="ident" id="7420766">j</span>&nbsp;<span class="op" id="7420768">:=</span>&nbsp;<span class="num" id="7420771">0</span><span class="op" id="7420772">;</span>&nbsp;<span class="ident" id="7420774">j</span>&nbsp;<span class="op" id="7420776">&lt;</span>&nbsp;<span class="num" id="7420778">3</span><span class="op" id="7420779">;</span>&nbsp;<span class="ident" id="7420781">j</span><span class="op" id="7420782">++</span>&nbsp;<span class="op" id="7420785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420790">w</span><span class="op" id="7420791">,</span>&nbsp;<span class="ident" id="7420793">_</span>&nbsp;<span class="op" id="7420795">:=</span>&nbsp;<span class="ident" id="7420798">zw</span><span class="op" id="7420800">.</span><span class="ident" id="7420801">CreateHeader</span><span class="op" id="7420813">(</span><span class="op" id="7420814">&amp;</span><span class="ident" id="7420815">FileHeader</span><span class="op" id="7420825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420831">Name</span><span class="op" id="7420835">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7420839">&#34;foo&#34;</span><span class="op" id="7420844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420850">Method</span><span class="op" id="7420856">:</span>&nbsp;<span class="ident" id="7420858">Deflate</span><span class="op" id="7420865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7420870">}</span><span class="op" id="7420871">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420876">w</span><span class="op" id="7420877">.</span><span class="ident" id="7420878">Write</span><span class="op" id="7420883">(</span><span class="ident" id="7420884">bigBuf</span><span class="op" id="7420890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7420894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420898">zw</span><span class="op" id="7420900">.</span><span class="ident" id="7420901">Close</span><span class="op" id="7420906">(</span><span class="op" id="7420907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7420910">}</span><br>
<span class="lineno"></span><span class="op" id="7420912">}</span>
</div>
</body>
</html>
