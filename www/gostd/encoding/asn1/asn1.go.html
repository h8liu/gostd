<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/asn1</h2>
<ul>
<li><a href="/gostd/encoding/asn1/asn1.go.html" class="current">asn1.go</a></li>
<li><a href="/gostd/encoding/asn1/asn1_test.go.html">asn1_test.go</a></li>
<li><a href="/gostd/encoding/asn1/common.go.html">common.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal_test.go.html">marshal_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4183683">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4183738">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4183792">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4183843">//&nbsp;Package&nbsp;asn1&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structures,</span><br>
<span class="lineno"></span><span class="comment" id="4183916">//&nbsp;as&nbsp;defined&nbsp;in&nbsp;ITU-T&nbsp;Rec&nbsp;X.690.</span><br>
<span class="lineno"></span><span class="comment" id="4183950">//</span><br>
<span class="lineno"></span><span class="comment" id="4183953">//&nbsp;See&nbsp;also&nbsp;``A&nbsp;Layman&#39;s&nbsp;Guide&nbsp;to&nbsp;a&nbsp;Subset&nbsp;of&nbsp;ASN.1,&nbsp;BER,&nbsp;and&nbsp;DER,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="4184022">//&nbsp;http://luca.ntop.org/Teaching/Appunti/asn1.html.</span><br>
<span class="lineno">10</span><span class="keyword" id="4184074">package</span>&nbsp;<span class="ident" id="4184082">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4184088">//&nbsp;ASN.1&nbsp;is&nbsp;a&nbsp;syntax&nbsp;for&nbsp;specifying&nbsp;abstract&nbsp;objects&nbsp;and&nbsp;BER,&nbsp;DER,&nbsp;PER,&nbsp;XER&nbsp;etc</span><br>
<span class="lineno"></span><span class="comment" id="4184168">//&nbsp;are&nbsp;different&nbsp;encoding&nbsp;formats&nbsp;for&nbsp;those&nbsp;objects.&nbsp;Here,&nbsp;we&#39;ll&nbsp;be&nbsp;dealing</span><br>
<span class="lineno"></span><span class="comment" id="4184244">//&nbsp;with&nbsp;DER,&nbsp;the&nbsp;Distinguished&nbsp;Encoding&nbsp;Rules.&nbsp;DER&nbsp;is&nbsp;used&nbsp;in&nbsp;X.509&nbsp;because</span><br>
<span class="lineno">15</span><span class="comment" id="4184320">//&nbsp;it&#39;s&nbsp;fast&nbsp;to&nbsp;parse&nbsp;and,&nbsp;unlike&nbsp;BER,&nbsp;has&nbsp;a&nbsp;unique&nbsp;encoding&nbsp;for&nbsp;every&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="4184399">//&nbsp;When&nbsp;calculating&nbsp;hashes&nbsp;over&nbsp;objects,&nbsp;it&#39;s&nbsp;important&nbsp;that&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="4184474">//&nbsp;bytes&nbsp;be&nbsp;the&nbsp;same&nbsp;at&nbsp;both&nbsp;ends&nbsp;and&nbsp;DER&nbsp;removes&nbsp;this&nbsp;margin&nbsp;of&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4184546">//</span><br>
<span class="lineno"></span><span class="comment" id="4184549">//&nbsp;ASN.1&nbsp;is&nbsp;very&nbsp;complex&nbsp;and&nbsp;this&nbsp;package&nbsp;doesn&#39;t&nbsp;attempt&nbsp;to&nbsp;implement</span><br>
<span class="lineno">20</span><span class="comment" id="4184620">//&nbsp;everything&nbsp;by&nbsp;any&nbsp;means.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4184649">import</span>&nbsp;<span class="op" id="4184656">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4184659">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4184666">&#34;math/big&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4184678">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4184689">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4184700">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4184707">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="4184710">//&nbsp;A&nbsp;StructuralError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;valid,&nbsp;but&nbsp;the&nbsp;Go&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4184786">//&nbsp;which&nbsp;is&nbsp;receiving&nbsp;it&nbsp;doesn&#39;t&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="4184826">type</span>&nbsp;<span class="ident" id="4184831">StructuralError</span>&nbsp;<span class="keyword" id="4184847">struct</span>&nbsp;<span class="op" id="4184854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4184857">Msg</span>&nbsp;<span class="builtintype" id="4184861">string</span><br>
<span class="lineno"></span><span class="op" id="4184868">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="4184871">func</span>&nbsp;<span class="op" id="4184876">(</span><span class="ident" id="4184877">e</span>&nbsp;<span class="ident" id="4184879">StructuralError</span><span class="op" id="4184894">)</span>&nbsp;<span class="ident" id="4184896">Error</span><span class="op" id="4184901">(</span><span class="op" id="4184902">)</span>&nbsp;<span class="builtintype" id="4184904">string</span>&nbsp;<span class="op" id="4184911">{</span>&nbsp;<span class="keyword" id="4184913">return</span>&nbsp;<span class="string" id="4184920">&#34;asn1:&nbsp;structure&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4184946">+</span>&nbsp;<span class="ident" id="4184948">e</span><span class="op" id="4184949">.</span><span class="ident" id="4184950">Msg</span>&nbsp;<span class="op" id="4184954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4184957">//&nbsp;A&nbsp;SyntaxError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="4185015">type</span>&nbsp;<span class="ident" id="4185020">SyntaxError</span>&nbsp;<span class="keyword" id="4185032">struct</span>&nbsp;<span class="op" id="4185039">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185042">Msg</span>&nbsp;<span class="builtintype" id="4185046">string</span><br>
<span class="lineno"></span><span class="op" id="4185053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4185056">func</span>&nbsp;<span class="op" id="4185061">(</span><span class="ident" id="4185062">e</span>&nbsp;<span class="ident" id="4185064">SyntaxError</span><span class="op" id="4185075">)</span>&nbsp;<span class="ident" id="4185077">Error</span><span class="op" id="4185082">(</span><span class="op" id="4185083">)</span>&nbsp;<span class="builtintype" id="4185085">string</span>&nbsp;<span class="op" id="4185092">{</span>&nbsp;<span class="keyword" id="4185094">return</span>&nbsp;<span class="string" id="4185101">&#34;asn1:&nbsp;syntax&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4185124">+</span>&nbsp;<span class="ident" id="4185126">e</span><span class="op" id="4185127">.</span><span class="ident" id="4185128">Msg</span>&nbsp;<span class="op" id="4185132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4185135">//&nbsp;We&nbsp;start&nbsp;by&nbsp;dealing&nbsp;with&nbsp;each&nbsp;of&nbsp;the&nbsp;primitive&nbsp;types&nbsp;in&nbsp;turn.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4185201">//&nbsp;BOOLEAN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4185213">func</span>&nbsp;<span class="ident" id="4185218">parseBool</span><span class="op" id="4185227">(</span><span class="ident" id="4185228">bytes</span>&nbsp;<span class="op" id="4185234">[</span><span class="op" id="4185235">]</span><span class="builtintype" id="4185236">byte</span><span class="op" id="4185240">)</span>&nbsp;<span class="op" id="4185242">(</span><span class="ident" id="4185243">ret</span>&nbsp;<span class="builtintype" id="4185247">bool</span><span class="op" id="4185251">,</span>&nbsp;<span class="ident" id="4185253">err</span>&nbsp;<span class="builtintype" id="4185257">error</span><span class="op" id="4185262">)</span>&nbsp;<span class="op" id="4185264">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4185267">if</span>&nbsp;<span class="builtinfunc" id="4185270">len</span><span class="op" id="4185273">(</span><span class="ident" id="4185274">bytes</span><span class="op" id="4185279">)</span>&nbsp;<span class="op" id="4185281">!=</span>&nbsp;<span class="num" id="4185284">1</span>&nbsp;<span class="op" id="4185286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185290">err</span>&nbsp;<span class="op" id="4185294">=</span>&nbsp;<span class="ident" id="4185296">SyntaxError</span><span class="op" id="4185307">{</span><span class="string" id="4185308">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4185325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4185329">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4185337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4185341">//&nbsp;DER&nbsp;demands&nbsp;that&nbsp;&#34;If&nbsp;the&nbsp;encoding&nbsp;represents&nbsp;the&nbsp;boolean&nbsp;value&nbsp;TRUE,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4185414">//&nbsp;its&nbsp;single&nbsp;contents&nbsp;octet&nbsp;shall&nbsp;have&nbsp;all&nbsp;eight&nbsp;bits&nbsp;set&nbsp;to&nbsp;one.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4185483">//&nbsp;Thus&nbsp;only&nbsp;0&nbsp;and&nbsp;255&nbsp;are&nbsp;valid&nbsp;encoded&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4185533">switch</span>&nbsp;<span class="ident" id="4185540">bytes</span><span class="op" id="4185545">[</span><span class="num" id="4185546">0</span><span class="op" id="4185547">]</span>&nbsp;<span class="op" id="4185549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4185552">case</span>&nbsp;<span class="num" id="4185557">0</span><span class="op" id="4185558">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185562">ret</span>&nbsp;<span class="op" id="4185566">=</span>&nbsp;<span class="builtintype" id="4185568">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4185575">case</span>&nbsp;<span class="num" id="4185580">0xff</span><span class="op" id="4185584">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185588">ret</span>&nbsp;<span class="op" id="4185592">=</span>&nbsp;<span class="builtintype" id="4185594">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4185600">default</span><span class="op" id="4185607">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185611">err</span>&nbsp;<span class="op" id="4185615">=</span>&nbsp;<span class="ident" id="4185617">SyntaxError</span><span class="op" id="4185628">{</span><span class="string" id="4185629">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4185646">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4185649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4185653">return</span><br>
<span class="lineno"></span><span class="op" id="4185660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4185663">//&nbsp;INTEGER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4185675">//&nbsp;parseInt64&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4185748">//&nbsp;returns&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4185771">func</span>&nbsp;<span class="ident" id="4185776">parseInt64</span><span class="op" id="4185786">(</span><span class="ident" id="4185787">bytes</span>&nbsp;<span class="op" id="4185793">[</span><span class="op" id="4185794">]</span><span class="builtintype" id="4185795">byte</span><span class="op" id="4185799">)</span>&nbsp;<span class="op" id="4185801">(</span><span class="ident" id="4185802">ret</span>&nbsp;<span class="ident" id="4185806">int64</span><span class="op" id="4185811">,</span>&nbsp;<span class="ident" id="4185813">err</span>&nbsp;<span class="builtintype" id="4185817">error</span><span class="op" id="4185822">)</span>&nbsp;<span class="op" id="4185824">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4185827">if</span>&nbsp;<span class="builtinfunc" id="4185830">len</span><span class="op" id="4185833">(</span><span class="ident" id="4185834">bytes</span><span class="op" id="4185839">)</span>&nbsp;<span class="op" id="4185841">&gt;</span>&nbsp;<span class="num" id="4185843">8</span>&nbsp;<span class="op" id="4185845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4185849">//&nbsp;We&#39;ll&nbsp;overflow&nbsp;an&nbsp;int64&nbsp;in&nbsp;this&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185892">err</span>&nbsp;<span class="op" id="4185896">=</span>&nbsp;<span class="ident" id="4185898">StructuralError</span><span class="op" id="4185913">{</span><span class="string" id="4185914">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4185933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4185937">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4185945">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4185948">for</span>&nbsp;<span class="ident" id="4185952">bytesRead</span>&nbsp;<span class="op" id="4185962">:=</span>&nbsp;<span class="num" id="4185965">0</span><span class="op" id="4185966">;</span>&nbsp;<span class="ident" id="4185968">bytesRead</span>&nbsp;<span class="op" id="4185978">&lt;</span>&nbsp;<span class="builtinfunc" id="4185980">len</span><span class="op" id="4185983">(</span><span class="ident" id="4185984">bytes</span><span class="op" id="4185989">)</span><span class="op" id="4185990">;</span>&nbsp;<span class="ident" id="4185992">bytesRead</span><span class="op" id="4186001">++</span>&nbsp;<span class="op" id="4186004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186008">ret</span>&nbsp;<span class="op" id="4186012">&lt;&lt;=</span>&nbsp;<span class="num" id="4186016">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186020">ret</span>&nbsp;<span class="op" id="4186024">|=</span>&nbsp;<span class="ident" id="4186027">int64</span><span class="op" id="4186032">(</span><span class="ident" id="4186033">bytes</span><span class="op" id="4186038">[</span><span class="ident" id="4186039">bytesRead</span><span class="op" id="4186048">]</span><span class="op" id="4186049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4186052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4186056">//&nbsp;Shift&nbsp;up&nbsp;and&nbsp;down&nbsp;in&nbsp;order&nbsp;to&nbsp;sign&nbsp;extend&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186114">ret</span>&nbsp;<span class="op" id="4186118">&lt;&lt;=</span>&nbsp;<span class="num" id="4186122">64</span>&nbsp;<span class="op" id="4186125">-</span>&nbsp;<span class="builtintype" id="4186127">uint8</span><span class="op" id="4186132">(</span><span class="builtinfunc" id="4186133">len</span><span class="op" id="4186136">(</span><span class="ident" id="4186137">bytes</span><span class="op" id="4186142">)</span><span class="op" id="4186143">)</span><span class="op" id="4186144">*</span><span class="num" id="4186145">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186148">ret</span>&nbsp;<span class="op" id="4186152">&gt;&gt;=</span>&nbsp;<span class="num" id="4186156">64</span>&nbsp;<span class="op" id="4186159">-</span>&nbsp;<span class="builtintype" id="4186161">uint8</span><span class="op" id="4186166">(</span><span class="builtinfunc" id="4186167">len</span><span class="op" id="4186170">(</span><span class="ident" id="4186171">bytes</span><span class="op" id="4186176">)</span><span class="op" id="4186177">)</span><span class="op" id="4186178">*</span><span class="num" id="4186179">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186182">return</span><br>
<span class="lineno"></span><span class="op" id="4186189">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4186192">//&nbsp;parseInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4186271">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4186286">func</span>&nbsp;<span class="ident" id="4186291">parseInt32</span><span class="op" id="4186301">(</span><span class="ident" id="4186302">bytes</span>&nbsp;<span class="op" id="4186308">[</span><span class="op" id="4186309">]</span><span class="builtintype" id="4186310">byte</span><span class="op" id="4186314">)</span>&nbsp;<span class="op" id="4186316">(</span><span class="builtintype" id="4186317">int32</span><span class="op" id="4186322">,</span>&nbsp;<span class="builtintype" id="4186324">error</span><span class="op" id="4186329">)</span>&nbsp;<span class="op" id="4186331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186334">ret64</span><span class="op" id="4186339">,</span>&nbsp;<span class="ident" id="4186341">err</span>&nbsp;<span class="op" id="4186345">:=</span>&nbsp;<span class="ident" id="4186348">parseInt64</span><span class="op" id="4186358">(</span><span class="ident" id="4186359">bytes</span><span class="op" id="4186364">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186367">if</span>&nbsp;<span class="ident" id="4186370">err</span>&nbsp;<span class="op" id="4186374">!=</span>&nbsp;<span class="ident" id="4186377">nil</span>&nbsp;<span class="op" id="4186381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186385">return</span>&nbsp;<span class="num" id="4186392">0</span><span class="op" id="4186393">,</span>&nbsp;<span class="ident" id="4186395">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4186400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186403">if</span>&nbsp;<span class="ident" id="4186406">ret64</span>&nbsp;<span class="op" id="4186412">!=</span>&nbsp;<span class="ident" id="4186415">int64</span><span class="op" id="4186420">(</span><span class="builtintype" id="4186421">int32</span><span class="op" id="4186426">(</span><span class="ident" id="4186427">ret64</span><span class="op" id="4186432">)</span><span class="op" id="4186433">)</span>&nbsp;<span class="op" id="4186435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186439">return</span>&nbsp;<span class="num" id="4186446">0</span><span class="op" id="4186447">,</span>&nbsp;<span class="ident" id="4186449">StructuralError</span><span class="op" id="4186464">{</span><span class="string" id="4186465">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4186484">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4186487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186490">return</span>&nbsp;<span class="builtintype" id="4186497">int32</span><span class="op" id="4186502">(</span><span class="ident" id="4186503">ret64</span><span class="op" id="4186508">)</span><span class="op" id="4186509">,</span>&nbsp;<span class="ident" id="4186511">nil</span><br>
<span class="lineno"></span><span class="op" id="4186515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4186518">var</span>&nbsp;<span class="ident" id="4186522">bigOne</span>&nbsp;<span class="op" id="4186529">=</span>&nbsp;<span class="ident" id="4186531">big</span><span class="op" id="4186534">.</span><span class="ident" id="4186535">NewInt</span><span class="op" id="4186541">(</span><span class="num" id="4186542">1</span><span class="op" id="4186543">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4186546">//&nbsp;parseBigInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4186628">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4186643">func</span>&nbsp;<span class="ident" id="4186648">parseBigInt</span><span class="op" id="4186659">(</span><span class="ident" id="4186660">bytes</span>&nbsp;<span class="op" id="4186666">[</span><span class="op" id="4186667">]</span><span class="builtintype" id="4186668">byte</span><span class="op" id="4186672">)</span>&nbsp;<span class="op" id="4186674">*</span><span class="ident" id="4186675">big</span><span class="op" id="4186678">.</span><span class="ident" id="4186679">Int</span>&nbsp;<span class="op" id="4186683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186686">ret</span>&nbsp;<span class="op" id="4186690">:=</span>&nbsp;<span class="builtinfunc" id="4186693">new</span><span class="op" id="4186696">(</span><span class="ident" id="4186697">big</span><span class="op" id="4186700">.</span><span class="ident" id="4186701">Int</span><span class="op" id="4186704">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186707">if</span>&nbsp;<span class="builtinfunc" id="4186710">len</span><span class="op" id="4186713">(</span><span class="ident" id="4186714">bytes</span><span class="op" id="4186719">)</span>&nbsp;<span class="op" id="4186721">&gt;</span>&nbsp;<span class="num" id="4186723">0</span>&nbsp;<span class="op" id="4186725">&amp;&amp;</span>&nbsp;<span class="ident" id="4186728">bytes</span><span class="op" id="4186733">[</span><span class="num" id="4186734">0</span><span class="op" id="4186735">]</span><span class="op" id="4186736">&amp;</span><span class="num" id="4186737">0x80</span>&nbsp;<span class="op" id="4186742">==</span>&nbsp;<span class="num" id="4186745">0x80</span>&nbsp;<span class="op" id="4186750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4186754">//&nbsp;This&nbsp;is&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186786">notBytes</span>&nbsp;<span class="op" id="4186795">:=</span>&nbsp;<span class="builtinfunc" id="4186798">make</span><span class="op" id="4186802">(</span><span class="op" id="4186803">[</span><span class="op" id="4186804">]</span><span class="builtintype" id="4186805">byte</span><span class="op" id="4186809">,</span>&nbsp;<span class="builtinfunc" id="4186811">len</span><span class="op" id="4186814">(</span><span class="ident" id="4186815">bytes</span><span class="op" id="4186820">)</span><span class="op" id="4186821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186825">for</span>&nbsp;<span class="ident" id="4186829">i</span>&nbsp;<span class="op" id="4186831">:=</span>&nbsp;<span class="keyword" id="4186834">range</span>&nbsp;<span class="ident" id="4186840">notBytes</span>&nbsp;<span class="op" id="4186849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186854">notBytes</span><span class="op" id="4186862">[</span><span class="ident" id="4186863">i</span><span class="op" id="4186864">]</span>&nbsp;<span class="op" id="4186866">=</span>&nbsp;<span class="op" id="4186868">^</span><span class="ident" id="4186869">bytes</span><span class="op" id="4186874">[</span><span class="ident" id="4186875">i</span><span class="op" id="4186876">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4186880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186884">ret</span><span class="op" id="4186887">.</span><span class="ident" id="4186888">SetBytes</span><span class="op" id="4186896">(</span><span class="ident" id="4186897">notBytes</span><span class="op" id="4186905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186909">ret</span><span class="op" id="4186912">.</span><span class="ident" id="4186913">Add</span><span class="op" id="4186916">(</span><span class="ident" id="4186917">ret</span><span class="op" id="4186920">,</span>&nbsp;<span class="ident" id="4186922">bigOne</span><span class="op" id="4186928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186932">ret</span><span class="op" id="4186935">.</span><span class="ident" id="4186936">Neg</span><span class="op" id="4186939">(</span><span class="ident" id="4186940">ret</span><span class="op" id="4186943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186947">return</span>&nbsp;<span class="ident" id="4186954">ret</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4186959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186962">ret</span><span class="op" id="4186965">.</span><span class="ident" id="4186966">SetBytes</span><span class="op" id="4186974">(</span><span class="ident" id="4186975">bytes</span><span class="op" id="4186980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186983">return</span>&nbsp;<span class="ident" id="4186990">ret</span><br>
<span class="lineno"></span><span class="op" id="4186994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4186997">//&nbsp;BIT&nbsp;STRING</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4187012">//&nbsp;BitString&nbsp;is&nbsp;the&nbsp;structure&nbsp;to&nbsp;use&nbsp;when&nbsp;you&nbsp;want&nbsp;an&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;type.&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="4187091">//&nbsp;bit&nbsp;string&nbsp;is&nbsp;padded&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;byte&nbsp;in&nbsp;memory&nbsp;and&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4187166">//&nbsp;valid&nbsp;bits&nbsp;is&nbsp;recorded.&nbsp;Padding&nbsp;bits&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno">130</span><span class="keyword" id="4187220">type</span>&nbsp;<span class="ident" id="4187225">BitString</span>&nbsp;<span class="keyword" id="4187235">struct</span>&nbsp;<span class="op" id="4187242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187245">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4187255">[</span><span class="op" id="4187256">]</span><span class="builtintype" id="4187257">byte</span>&nbsp;<span class="comment" id="4187262">//&nbsp;bits&nbsp;packed&nbsp;into&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187290">BitLength</span>&nbsp;<span class="builtintype" id="4187300">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4187307">//&nbsp;length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span><span class="op" id="4187326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="4187329">//&nbsp;At&nbsp;returns&nbsp;the&nbsp;bit&nbsp;at&nbsp;the&nbsp;given&nbsp;index.&nbsp;If&nbsp;the&nbsp;index&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4187403">//&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword" id="4187421">func</span>&nbsp;<span class="op" id="4187426">(</span><span class="ident" id="4187427">b</span>&nbsp;<span class="ident" id="4187429">BitString</span><span class="op" id="4187438">)</span>&nbsp;<span class="ident" id="4187440">At</span><span class="op" id="4187442">(</span><span class="ident" id="4187443">i</span>&nbsp;<span class="builtintype" id="4187445">int</span><span class="op" id="4187448">)</span>&nbsp;<span class="builtintype" id="4187450">int</span>&nbsp;<span class="op" id="4187454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4187457">if</span>&nbsp;<span class="ident" id="4187460">i</span>&nbsp;<span class="op" id="4187462">&lt;</span>&nbsp;<span class="num" id="4187464">0</span>&nbsp;<span class="op" id="4187466">||</span>&nbsp;<span class="ident" id="4187469">i</span>&nbsp;<span class="op" id="4187471">&gt;=</span>&nbsp;<span class="ident" id="4187474">b</span><span class="op" id="4187475">.</span><span class="ident" id="4187476">BitLength</span>&nbsp;<span class="op" id="4187486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4187490">return</span>&nbsp;<span class="num" id="4187497">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4187500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187503">x</span>&nbsp;<span class="op" id="4187505">:=</span>&nbsp;<span class="ident" id="4187508">i</span>&nbsp;<span class="op" id="4187510">/</span>&nbsp;<span class="num" id="4187512">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187515">y</span>&nbsp;<span class="op" id="4187517">:=</span>&nbsp;<span class="num" id="4187520">7</span>&nbsp;<span class="op" id="4187522">-</span>&nbsp;<span class="builtintype" id="4187524">uint</span><span class="op" id="4187528">(</span><span class="ident" id="4187529">i</span><span class="op" id="4187530">%</span><span class="num" id="4187531">8</span><span class="op" id="4187532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4187535">return</span>&nbsp;<span class="builtintype" id="4187542">int</span><span class="op" id="4187545">(</span><span class="ident" id="4187546">b</span><span class="op" id="4187547">.</span><span class="ident" id="4187548">Bytes</span><span class="op" id="4187553">[</span><span class="ident" id="4187554">x</span><span class="op" id="4187555">]</span><span class="op" id="4187556">&gt;&gt;</span><span class="ident" id="4187558">y</span><span class="op" id="4187559">)</span>&nbsp;<span class="op" id="4187561">&amp;</span>&nbsp;<span class="num" id="4187563">1</span><br>
<span class="lineno"></span><span class="op" id="4187565">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="4187568">//&nbsp;RightAlign&nbsp;returns&nbsp;a&nbsp;slice&nbsp;where&nbsp;the&nbsp;padding&nbsp;bits&nbsp;are&nbsp;at&nbsp;the&nbsp;beginning.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4187647">//&nbsp;slice&nbsp;may&nbsp;share&nbsp;memory&nbsp;with&nbsp;the&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="keyword" id="4187693">func</span>&nbsp;<span class="op" id="4187698">(</span><span class="ident" id="4187699">b</span>&nbsp;<span class="ident" id="4187701">BitString</span><span class="op" id="4187710">)</span>&nbsp;<span class="ident" id="4187712">RightAlign</span><span class="op" id="4187722">(</span><span class="op" id="4187723">)</span>&nbsp;<span class="op" id="4187725">[</span><span class="op" id="4187726">]</span><span class="builtintype" id="4187727">byte</span>&nbsp;<span class="op" id="4187732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187735">shift</span>&nbsp;<span class="op" id="4187741">:=</span>&nbsp;<span class="builtintype" id="4187744">uint</span><span class="op" id="4187748">(</span><span class="num" id="4187749">8</span>&nbsp;<span class="op" id="4187751">-</span>&nbsp;<span class="op" id="4187753">(</span><span class="ident" id="4187754">b</span><span class="op" id="4187755">.</span><span class="ident" id="4187756">BitLength</span>&nbsp;<span class="op" id="4187766">%</span>&nbsp;<span class="num" id="4187768">8</span><span class="op" id="4187769">)</span><span class="op" id="4187770">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4187773">if</span>&nbsp;<span class="ident" id="4187776">shift</span>&nbsp;<span class="op" id="4187782">==</span>&nbsp;<span class="num" id="4187785">8</span>&nbsp;<span class="op" id="4187787">||</span>&nbsp;<span class="builtinfunc" id="4187790">len</span><span class="op" id="4187793">(</span><span class="ident" id="4187794">b</span><span class="op" id="4187795">.</span><span class="ident" id="4187796">Bytes</span><span class="op" id="4187801">)</span>&nbsp;<span class="op" id="4187803">==</span>&nbsp;<span class="num" id="4187806">0</span>&nbsp;<span class="op" id="4187808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4187812">return</span>&nbsp;<span class="ident" id="4187819">b</span><span class="op" id="4187820">.</span><span class="ident" id="4187821">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4187828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187832">a</span>&nbsp;<span class="op" id="4187834">:=</span>&nbsp;<span class="builtinfunc" id="4187837">make</span><span class="op" id="4187841">(</span><span class="op" id="4187842">[</span><span class="op" id="4187843">]</span><span class="builtintype" id="4187844">byte</span><span class="op" id="4187848">,</span>&nbsp;<span class="builtinfunc" id="4187850">len</span><span class="op" id="4187853">(</span><span class="ident" id="4187854">b</span><span class="op" id="4187855">.</span><span class="ident" id="4187856">Bytes</span><span class="op" id="4187861">)</span><span class="op" id="4187862">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187865">a</span><span class="op" id="4187866">[</span><span class="num" id="4187867">0</span><span class="op" id="4187868">]</span>&nbsp;<span class="op" id="4187870">=</span>&nbsp;<span class="ident" id="4187872">b</span><span class="op" id="4187873">.</span><span class="ident" id="4187874">Bytes</span><span class="op" id="4187879">[</span><span class="num" id="4187880">0</span><span class="op" id="4187881">]</span>&nbsp;<span class="op" id="4187883">&gt;&gt;</span>&nbsp;<span class="ident" id="4187886">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4187893">for</span>&nbsp;<span class="ident" id="4187897">i</span>&nbsp;<span class="op" id="4187899">:=</span>&nbsp;<span class="num" id="4187902">1</span><span class="op" id="4187903">;</span>&nbsp;<span class="ident" id="4187905">i</span>&nbsp;<span class="op" id="4187907">&lt;</span>&nbsp;<span class="builtinfunc" id="4187909">len</span><span class="op" id="4187912">(</span><span class="ident" id="4187913">b</span><span class="op" id="4187914">.</span><span class="ident" id="4187915">Bytes</span><span class="op" id="4187920">)</span><span class="op" id="4187921">;</span>&nbsp;<span class="ident" id="4187923">i</span><span class="op" id="4187924">++</span>&nbsp;<span class="op" id="4187927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187931">a</span><span class="op" id="4187932">[</span><span class="ident" id="4187933">i</span><span class="op" id="4187934">]</span>&nbsp;<span class="op" id="4187936">=</span>&nbsp;<span class="ident" id="4187938">b</span><span class="op" id="4187939">.</span><span class="ident" id="4187940">Bytes</span><span class="op" id="4187945">[</span><span class="ident" id="4187946">i</span><span class="op" id="4187947">-</span><span class="num" id="4187948">1</span><span class="op" id="4187949">]</span>&nbsp;<span class="op" id="4187951">&lt;&lt;</span>&nbsp;<span class="op" id="4187954">(</span><span class="num" id="4187955">8</span>&nbsp;<span class="op" id="4187957">-</span>&nbsp;<span class="ident" id="4187959">shift</span><span class="op" id="4187964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187968">a</span><span class="op" id="4187969">[</span><span class="ident" id="4187970">i</span><span class="op" id="4187971">]</span>&nbsp;<span class="op" id="4187973">|=</span>&nbsp;<span class="ident" id="4187976">b</span><span class="op" id="4187977">.</span><span class="ident" id="4187978">Bytes</span><span class="op" id="4187983">[</span><span class="ident" id="4187984">i</span><span class="op" id="4187985">]</span>&nbsp;<span class="op" id="4187987">&gt;&gt;</span>&nbsp;<span class="ident" id="4187990">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4187997">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4188001">return</span>&nbsp;<span class="ident" id="4188008">a</span><br>
<span class="lineno"></span><span class="op" id="4188010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4188013">//&nbsp;parseBitString&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;bit&nbsp;string&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno">165</span><span class="keyword" id="4188100">func</span>&nbsp;<span class="ident" id="4188105">parseBitString</span><span class="op" id="4188119">(</span><span class="ident" id="4188120">bytes</span>&nbsp;<span class="op" id="4188126">[</span><span class="op" id="4188127">]</span><span class="builtintype" id="4188128">byte</span><span class="op" id="4188132">)</span>&nbsp;<span class="op" id="4188134">(</span><span class="ident" id="4188135">ret</span>&nbsp;<span class="ident" id="4188139">BitString</span><span class="op" id="4188148">,</span>&nbsp;<span class="ident" id="4188150">err</span>&nbsp;<span class="builtintype" id="4188154">error</span><span class="op" id="4188159">)</span>&nbsp;<span class="op" id="4188161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4188164">if</span>&nbsp;<span class="builtinfunc" id="4188167">len</span><span class="op" id="4188170">(</span><span class="ident" id="4188171">bytes</span><span class="op" id="4188176">)</span>&nbsp;<span class="op" id="4188178">==</span>&nbsp;<span class="num" id="4188181">0</span>&nbsp;<span class="op" id="4188183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4188187">err</span>&nbsp;<span class="op" id="4188191">=</span>&nbsp;<span class="ident" id="4188193">SyntaxError</span><span class="op" id="4188204">{</span><span class="string" id="4188205">&#34;zero&nbsp;length&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4188229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4188233">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4188241">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4188244">paddingBits</span>&nbsp;<span class="op" id="4188256">:=</span>&nbsp;<span class="builtintype" id="4188259">int</span><span class="op" id="4188262">(</span><span class="ident" id="4188263">bytes</span><span class="op" id="4188268">[</span><span class="num" id="4188269">0</span><span class="op" id="4188270">]</span><span class="op" id="4188271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4188274">if</span>&nbsp;<span class="ident" id="4188277">paddingBits</span>&nbsp;<span class="op" id="4188289">&gt;</span>&nbsp;<span class="num" id="4188291">7</span>&nbsp;<span class="op" id="4188293">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4188298">len</span><span class="op" id="4188301">(</span><span class="ident" id="4188302">bytes</span><span class="op" id="4188307">)</span>&nbsp;<span class="op" id="4188309">==</span>&nbsp;<span class="num" id="4188312">1</span>&nbsp;<span class="op" id="4188314">&amp;&amp;</span>&nbsp;<span class="ident" id="4188317">paddingBits</span>&nbsp;<span class="op" id="4188329">&gt;</span>&nbsp;<span class="num" id="4188331">0</span>&nbsp;<span class="op" id="4188333">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4188338">bytes</span><span class="op" id="4188343">[</span><span class="builtinfunc" id="4188344">len</span><span class="op" id="4188347">(</span><span class="ident" id="4188348">bytes</span><span class="op" id="4188353">)</span><span class="op" id="4188354">-</span><span class="num" id="4188355">1</span><span class="op" id="4188356">]</span><span class="op" id="4188357">&amp;</span><span class="op" id="4188358">(</span><span class="op" id="4188359">(</span><span class="num" id="4188360">1</span><span class="op" id="4188361">&lt;&lt;</span><span class="ident" id="4188363">bytes</span><span class="op" id="4188368">[</span><span class="num" id="4188369">0</span><span class="op" id="4188370">]</span><span class="op" id="4188371">)</span><span class="op" id="4188372">-</span><span class="num" id="4188373">1</span><span class="op" id="4188374">)</span>&nbsp;<span class="op" id="4188376">!=</span>&nbsp;<span class="num" id="4188379">0</span>&nbsp;<span class="op" id="4188381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4188385">err</span>&nbsp;<span class="op" id="4188389">=</span>&nbsp;<span class="ident" id="4188391">SyntaxError</span><span class="op" id="4188402">{</span><span class="string" id="4188403">&#34;invalid&nbsp;padding&nbsp;bits&nbsp;in&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4188439">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4188443">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4188451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4188454">ret</span><span class="op" id="4188457">.</span><span class="ident" id="4188458">BitLength</span>&nbsp;<span class="op" id="4188468">=</span>&nbsp;<span class="op" id="4188470">(</span><span class="builtinfunc" id="4188471">len</span><span class="op" id="4188474">(</span><span class="ident" id="4188475">bytes</span><span class="op" id="4188480">)</span><span class="op" id="4188481">-</span><span class="num" id="4188482">1</span><span class="op" id="4188483">)</span><span class="op" id="4188484">*</span><span class="num" id="4188485">8</span>&nbsp;<span class="op" id="4188487">-</span>&nbsp;<span class="ident" id="4188489">paddingBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4188502">ret</span><span class="op" id="4188505">.</span><span class="ident" id="4188506">Bytes</span>&nbsp;<span class="op" id="4188512">=</span>&nbsp;<span class="ident" id="4188514">bytes</span><span class="op" id="4188519">[</span><span class="num" id="4188520">1</span><span class="op" id="4188521">:</span><span class="op" id="4188522">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4188525">return</span><br>
<span class="lineno">180</span><span class="op" id="4188532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4188535">//&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4188557">//&nbsp;An&nbsp;ObjectIdentifier&nbsp;represents&nbsp;an&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER.</span><br>
<span class="lineno">185</span><span class="keyword" id="4188619">type</span>&nbsp;<span class="ident" id="4188624">ObjectIdentifier</span>&nbsp;<span class="op" id="4188641">[</span><span class="op" id="4188642">]</span><span class="builtintype" id="4188643">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4188648">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;oi&nbsp;and&nbsp;other&nbsp;represent&nbsp;the&nbsp;same&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="4188717">func</span>&nbsp;<span class="op" id="4188722">(</span><span class="ident" id="4188723">oi</span>&nbsp;<span class="ident" id="4188726">ObjectIdentifier</span><span class="op" id="4188742">)</span>&nbsp;<span class="ident" id="4188744">Equal</span><span class="op" id="4188749">(</span><span class="ident" id="4188750">other</span>&nbsp;<span class="ident" id="4188756">ObjectIdentifier</span><span class="op" id="4188772">)</span>&nbsp;<span class="builtintype" id="4188774">bool</span>&nbsp;<span class="op" id="4188779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4188782">if</span>&nbsp;<span class="builtinfunc" id="4188785">len</span><span class="op" id="4188788">(</span><span class="ident" id="4188789">oi</span><span class="op" id="4188791">)</span>&nbsp;<span class="op" id="4188793">!=</span>&nbsp;<span class="builtinfunc" id="4188796">len</span><span class="op" id="4188799">(</span><span class="ident" id="4188800">other</span><span class="op" id="4188805">)</span>&nbsp;<span class="op" id="4188807">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4188811">return</span>&nbsp;<span class="builtintype" id="4188818">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4188825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4188828">for</span>&nbsp;<span class="ident" id="4188832">i</span>&nbsp;<span class="op" id="4188834">:=</span>&nbsp;<span class="num" id="4188837">0</span><span class="op" id="4188838">;</span>&nbsp;<span class="ident" id="4188840">i</span>&nbsp;<span class="op" id="4188842">&lt;</span>&nbsp;<span class="builtinfunc" id="4188844">len</span><span class="op" id="4188847">(</span><span class="ident" id="4188848">oi</span><span class="op" id="4188850">)</span><span class="op" id="4188851">;</span>&nbsp;<span class="ident" id="4188853">i</span><span class="op" id="4188854">++</span>&nbsp;<span class="op" id="4188857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4188861">if</span>&nbsp;<span class="ident" id="4188864">oi</span><span class="op" id="4188866">[</span><span class="ident" id="4188867">i</span><span class="op" id="4188868">]</span>&nbsp;<span class="op" id="4188870">!=</span>&nbsp;<span class="ident" id="4188873">other</span><span class="op" id="4188878">[</span><span class="ident" id="4188879">i</span><span class="op" id="4188880">]</span>&nbsp;<span class="op" id="4188882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4188887">return</span>&nbsp;<span class="builtintype" id="4188894">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4188902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4188905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4188909">return</span>&nbsp;<span class="builtintype" id="4188916">true</span><br>
<span class="lineno"></span><span class="op" id="4188921">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="4188924">func</span>&nbsp;<span class="op" id="4188929">(</span><span class="ident" id="4188930">oi</span>&nbsp;<span class="ident" id="4188933">ObjectIdentifier</span><span class="op" id="4188949">)</span>&nbsp;<span class="ident" id="4188951">String</span><span class="op" id="4188957">(</span><span class="op" id="4188958">)</span>&nbsp;<span class="builtintype" id="4188960">string</span>&nbsp;<span class="op" id="4188967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4188970">var</span>&nbsp;<span class="ident" id="4188974">s</span>&nbsp;<span class="builtintype" id="4188976">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4188985">for</span>&nbsp;<span class="ident" id="4188989">i</span><span class="op" id="4188990">,</span>&nbsp;<span class="ident" id="4188992">v</span>&nbsp;<span class="op" id="4188994">:=</span>&nbsp;<span class="keyword" id="4188997">range</span>&nbsp;<span class="ident" id="4189003">oi</span>&nbsp;<span class="op" id="4189006">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4189010">if</span>&nbsp;<span class="ident" id="4189013">i</span>&nbsp;<span class="op" id="4189015">&gt;</span>&nbsp;<span class="num" id="4189017">0</span>&nbsp;<span class="op" id="4189019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4189024">s</span>&nbsp;<span class="op" id="4189026">+=</span>&nbsp;<span class="string" id="4189029">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4189035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4189039">s</span>&nbsp;<span class="op" id="4189041">+=</span>&nbsp;<span class="ident" id="4189044">strconv</span><span class="op" id="4189051">.</span><span class="ident" id="4189052">Itoa</span><span class="op" id="4189056">(</span><span class="ident" id="4189057">v</span><span class="op" id="4189058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4189061">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4189065">return</span>&nbsp;<span class="ident" id="4189072">s</span><br>
<span class="lineno"></span><span class="op" id="4189074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4189077">//&nbsp;parseObjectIdentifier&nbsp;parses&nbsp;an&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="4189155">//&nbsp;returns&nbsp;it.&nbsp;An&nbsp;object&nbsp;identifier&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;variable&nbsp;length&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="4189233">//&nbsp;that&nbsp;are&nbsp;assigned&nbsp;in&nbsp;a&nbsp;hierarchy.</span><br>
<span class="lineno"></span><span class="keyword" id="4189270">func</span>&nbsp;<span class="ident" id="4189275">parseObjectIdentifier</span><span class="op" id="4189296">(</span><span class="ident" id="4189297">bytes</span>&nbsp;<span class="op" id="4189303">[</span><span class="op" id="4189304">]</span><span class="builtintype" id="4189305">byte</span><span class="op" id="4189309">)</span>&nbsp;<span class="op" id="4189311">(</span><span class="ident" id="4189312">s</span>&nbsp;<span class="op" id="4189314">[</span><span class="op" id="4189315">]</span><span class="builtintype" id="4189316">int</span><span class="op" id="4189319">,</span>&nbsp;<span class="ident" id="4189321">err</span>&nbsp;<span class="builtintype" id="4189325">error</span><span class="op" id="4189330">)</span>&nbsp;<span class="op" id="4189332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4189335">if</span>&nbsp;<span class="builtinfunc" id="4189338">len</span><span class="op" id="4189341">(</span><span class="ident" id="4189342">bytes</span><span class="op" id="4189347">)</span>&nbsp;<span class="op" id="4189349">==</span>&nbsp;<span class="num" id="4189352">0</span>&nbsp;<span class="op" id="4189354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4189358">err</span>&nbsp;<span class="op" id="4189362">=</span>&nbsp;<span class="ident" id="4189364">SyntaxError</span><span class="op" id="4189375">{</span><span class="string" id="4189376">&#34;zero&nbsp;length&nbsp;OBJECT&nbsp;IDENTIFIER&#34;</span><span class="op" id="4189407">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4189411">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4189419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4189423">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;we&nbsp;get&nbsp;two&nbsp;elements&nbsp;from&nbsp;the&nbsp;first&nbsp;byte&nbsp;(which&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4189496">//&nbsp;encoded&nbsp;differently)&nbsp;and&nbsp;then&nbsp;every&nbsp;varint&nbsp;is&nbsp;a&nbsp;single&nbsp;byte&nbsp;long.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4189566">s</span>&nbsp;<span class="op" id="4189568">=</span>&nbsp;<span class="builtinfunc" id="4189570">make</span><span class="op" id="4189574">(</span><span class="op" id="4189575">[</span><span class="op" id="4189576">]</span><span class="builtintype" id="4189577">int</span><span class="op" id="4189580">,</span>&nbsp;<span class="builtinfunc" id="4189582">len</span><span class="op" id="4189585">(</span><span class="ident" id="4189586">bytes</span><span class="op" id="4189591">)</span><span class="op" id="4189592">+</span><span class="num" id="4189593">1</span><span class="op" id="4189594">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4189598">//&nbsp;The&nbsp;first&nbsp;varint&nbsp;is&nbsp;40*value1&nbsp;+&nbsp;value2:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4189642">//&nbsp;According&nbsp;to&nbsp;this&nbsp;packing,&nbsp;value1&nbsp;can&nbsp;take&nbsp;the&nbsp;values&nbsp;0,&nbsp;1&nbsp;and&nbsp;2&nbsp;only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4189717">//&nbsp;When&nbsp;value1&nbsp;=&nbsp;0&nbsp;or&nbsp;value1&nbsp;=&nbsp;1,&nbsp;then&nbsp;value2&nbsp;is&nbsp;&lt;=&nbsp;39.&nbsp;When&nbsp;value1&nbsp;=&nbsp;2,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4189791">//&nbsp;then&nbsp;there&nbsp;are&nbsp;no&nbsp;restrictions&nbsp;on&nbsp;value2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4189837">v</span><span class="op" id="4189838">,</span>&nbsp;<span class="ident" id="4189840">offset</span><span class="op" id="4189846">,</span>&nbsp;<span class="ident" id="4189848">err</span>&nbsp;<span class="op" id="4189852">:=</span>&nbsp;<span class="ident" id="4189855">parseBase128Int</span><span class="op" id="4189870">(</span><span class="ident" id="4189871">bytes</span><span class="op" id="4189876">,</span>&nbsp;<span class="num" id="4189878">0</span><span class="op" id="4189879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4189882">if</span>&nbsp;<span class="ident" id="4189885">err</span>&nbsp;<span class="op" id="4189889">!=</span>&nbsp;<span class="ident" id="4189892">nil</span>&nbsp;<span class="op" id="4189896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4189900">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4189908">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4189911">if</span>&nbsp;<span class="ident" id="4189914">v</span>&nbsp;<span class="op" id="4189916">&lt;</span>&nbsp;<span class="num" id="4189918">80</span>&nbsp;<span class="op" id="4189921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4189925">s</span><span class="op" id="4189926">[</span><span class="num" id="4189927">0</span><span class="op" id="4189928">]</span>&nbsp;<span class="op" id="4189930">=</span>&nbsp;<span class="ident" id="4189932">v</span>&nbsp;<span class="op" id="4189934">/</span>&nbsp;<span class="num" id="4189936">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4189941">s</span><span class="op" id="4189942">[</span><span class="num" id="4189943">1</span><span class="op" id="4189944">]</span>&nbsp;<span class="op" id="4189946">=</span>&nbsp;<span class="ident" id="4189948">v</span>&nbsp;<span class="op" id="4189950">%</span>&nbsp;<span class="num" id="4189952">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4189956">}</span>&nbsp;<span class="keyword" id="4189958">else</span>&nbsp;<span class="op" id="4189963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4189967">s</span><span class="op" id="4189968">[</span><span class="num" id="4189969">0</span><span class="op" id="4189970">]</span>&nbsp;<span class="op" id="4189972">=</span>&nbsp;<span class="num" id="4189974">2</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4189978">s</span><span class="op" id="4189979">[</span><span class="num" id="4189980">1</span><span class="op" id="4189981">]</span>&nbsp;<span class="op" id="4189983">=</span>&nbsp;<span class="ident" id="4189985">v</span>&nbsp;<span class="op" id="4189987">-</span>&nbsp;<span class="num" id="4189989">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4189993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4189997">i</span>&nbsp;<span class="op" id="4189999">:=</span>&nbsp;<span class="num" id="4190002">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4190005">for</span>&nbsp;<span class="op" id="4190009">;</span>&nbsp;<span class="ident" id="4190011">offset</span>&nbsp;<span class="op" id="4190018">&lt;</span>&nbsp;<span class="builtinfunc" id="4190020">len</span><span class="op" id="4190023">(</span><span class="ident" id="4190024">bytes</span><span class="op" id="4190029">)</span><span class="op" id="4190030">;</span>&nbsp;<span class="ident" id="4190032">i</span><span class="op" id="4190033">++</span>&nbsp;<span class="op" id="4190036">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4190040">v</span><span class="op" id="4190041">,</span>&nbsp;<span class="ident" id="4190043">offset</span><span class="op" id="4190049">,</span>&nbsp;<span class="ident" id="4190051">err</span>&nbsp;<span class="op" id="4190055">=</span>&nbsp;<span class="ident" id="4190057">parseBase128Int</span><span class="op" id="4190072">(</span><span class="ident" id="4190073">bytes</span><span class="op" id="4190078">,</span>&nbsp;<span class="ident" id="4190080">offset</span><span class="op" id="4190086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4190090">if</span>&nbsp;<span class="ident" id="4190093">err</span>&nbsp;<span class="op" id="4190097">!=</span>&nbsp;<span class="ident" id="4190100">nil</span>&nbsp;<span class="op" id="4190104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4190109">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4190118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4190122">s</span><span class="op" id="4190123">[</span><span class="ident" id="4190124">i</span><span class="op" id="4190125">]</span>&nbsp;<span class="op" id="4190127">=</span>&nbsp;<span class="ident" id="4190129">v</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4190132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4190135">s</span>&nbsp;<span class="op" id="4190137">=</span>&nbsp;<span class="ident" id="4190139">s</span><span class="op" id="4190140">[</span><span class="num" id="4190141">0</span><span class="op" id="4190142">:</span><span class="ident" id="4190143">i</span><span class="op" id="4190144">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4190147">return</span><br>
<span class="lineno"></span><span class="op" id="4190154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="4190157">//&nbsp;ENUMERATED</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4190172">//&nbsp;An&nbsp;Enumerated&nbsp;is&nbsp;represented&nbsp;as&nbsp;a&nbsp;plain&nbsp;int.</span><br>
<span class="lineno"></span><span class="keyword" id="4190220">type</span>&nbsp;<span class="ident" id="4190225">Enumerated</span>&nbsp;<span class="builtintype" id="4190236">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="4190241">//&nbsp;FLAG</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4190250">//&nbsp;A&nbsp;Flag&nbsp;accepts&nbsp;any&nbsp;data&nbsp;and&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="4190308">type</span>&nbsp;<span class="ident" id="4190313">Flag</span>&nbsp;<span class="builtintype" id="4190318">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="4190324">//&nbsp;parseBase128Int&nbsp;parses&nbsp;a&nbsp;base-128&nbsp;encoded&nbsp;int&nbsp;from&nbsp;the&nbsp;given&nbsp;offset&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4190402">//&nbsp;given&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;value&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="4190464">func</span>&nbsp;<span class="ident" id="4190469">parseBase128Int</span><span class="op" id="4190484">(</span><span class="ident" id="4190485">bytes</span>&nbsp;<span class="op" id="4190491">[</span><span class="op" id="4190492">]</span><span class="builtintype" id="4190493">byte</span><span class="op" id="4190497">,</span>&nbsp;<span class="ident" id="4190499">initOffset</span>&nbsp;<span class="builtintype" id="4190510">int</span><span class="op" id="4190513">)</span>&nbsp;<span class="op" id="4190515">(</span><span class="ident" id="4190516">ret</span><span class="op" id="4190519">,</span>&nbsp;<span class="ident" id="4190521">offset</span>&nbsp;<span class="builtintype" id="4190528">int</span><span class="op" id="4190531">,</span>&nbsp;<span class="ident" id="4190533">err</span>&nbsp;<span class="builtintype" id="4190537">error</span><span class="op" id="4190542">)</span>&nbsp;<span class="op" id="4190544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4190547">offset</span>&nbsp;<span class="op" id="4190554">=</span>&nbsp;<span class="ident" id="4190556">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4190568">for</span>&nbsp;<span class="ident" id="4190572">shifted</span>&nbsp;<span class="op" id="4190580">:=</span>&nbsp;<span class="num" id="4190583">0</span><span class="op" id="4190584">;</span>&nbsp;<span class="ident" id="4190586">offset</span>&nbsp;<span class="op" id="4190593">&lt;</span>&nbsp;<span class="builtinfunc" id="4190595">len</span><span class="op" id="4190598">(</span><span class="ident" id="4190599">bytes</span><span class="op" id="4190604">)</span><span class="op" id="4190605">;</span>&nbsp;<span class="ident" id="4190607">shifted</span><span class="op" id="4190614">++</span>&nbsp;<span class="op" id="4190617">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4190621">if</span>&nbsp;<span class="ident" id="4190624">shifted</span>&nbsp;<span class="op" id="4190632">&gt;</span>&nbsp;<span class="num" id="4190634">4</span>&nbsp;<span class="op" id="4190636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4190641">err</span>&nbsp;<span class="op" id="4190645">=</span>&nbsp;<span class="ident" id="4190647">StructuralError</span><span class="op" id="4190662">{</span><span class="string" id="4190663">&#34;base&nbsp;128&nbsp;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4190691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4190696">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4190705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4190709">ret</span>&nbsp;<span class="op" id="4190713">&lt;&lt;=</span>&nbsp;<span class="num" id="4190717">7</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4190721">b</span>&nbsp;<span class="op" id="4190723">:=</span>&nbsp;<span class="ident" id="4190726">bytes</span><span class="op" id="4190731">[</span><span class="ident" id="4190732">offset</span><span class="op" id="4190738">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4190742">ret</span>&nbsp;<span class="op" id="4190746">|=</span>&nbsp;<span class="builtintype" id="4190749">int</span><span class="op" id="4190752">(</span><span class="ident" id="4190753">b</span>&nbsp;<span class="op" id="4190755">&amp;</span>&nbsp;<span class="num" id="4190757">0x7f</span><span class="op" id="4190761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4190765">offset</span><span class="op" id="4190771">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4190776">if</span>&nbsp;<span class="ident" id="4190779">b</span><span class="op" id="4190780">&amp;</span><span class="num" id="4190781">0x80</span>&nbsp;<span class="op" id="4190786">==</span>&nbsp;<span class="num" id="4190789">0</span>&nbsp;<span class="op" id="4190791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4190796">return</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4190805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4190808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4190811">err</span>&nbsp;<span class="op" id="4190815">=</span>&nbsp;<span class="ident" id="4190817">SyntaxError</span><span class="op" id="4190828">{</span><span class="string" id="4190829">&#34;truncated&nbsp;base&nbsp;128&nbsp;integer&#34;</span><span class="op" id="4190857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4190860">return</span><br>
<span class="lineno"></span><span class="op" id="4190867">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="4190870">//&nbsp;UTCTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4190882">func</span>&nbsp;<span class="ident" id="4190887">parseUTCTime</span><span class="op" id="4190899">(</span><span class="ident" id="4190900">bytes</span>&nbsp;<span class="op" id="4190906">[</span><span class="op" id="4190907">]</span><span class="builtintype" id="4190908">byte</span><span class="op" id="4190912">)</span>&nbsp;<span class="op" id="4190914">(</span><span class="ident" id="4190915">ret</span>&nbsp;<span class="ident" id="4190919">time</span><span class="op" id="4190923">.</span><span class="ident" id="4190924">Time</span><span class="op" id="4190928">,</span>&nbsp;<span class="ident" id="4190930">err</span>&nbsp;<span class="builtintype" id="4190934">error</span><span class="op" id="4190939">)</span>&nbsp;<span class="op" id="4190941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4190944">s</span>&nbsp;<span class="op" id="4190946">:=</span>&nbsp;<span class="builtintype" id="4190949">string</span><span class="op" id="4190955">(</span><span class="ident" id="4190956">bytes</span><span class="op" id="4190961">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4190964">ret</span><span class="op" id="4190967">,</span>&nbsp;<span class="ident" id="4190969">err</span>&nbsp;<span class="op" id="4190973">=</span>&nbsp;<span class="ident" id="4190975">time</span><span class="op" id="4190979">.</span><span class="ident" id="4190980">Parse</span><span class="op" id="4190985">(</span><span class="string" id="4190986">&#34;0601021504Z0700&#34;</span><span class="op" id="4191003">,</span>&nbsp;<span class="ident" id="4191005">s</span><span class="op" id="4191006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4191009">if</span>&nbsp;<span class="ident" id="4191012">err</span>&nbsp;<span class="op" id="4191016">!=</span>&nbsp;<span class="ident" id="4191019">nil</span>&nbsp;<span class="op" id="4191023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4191027">ret</span><span class="op" id="4191030">,</span>&nbsp;<span class="ident" id="4191032">err</span>&nbsp;<span class="op" id="4191036">=</span>&nbsp;<span class="ident" id="4191038">time</span><span class="op" id="4191042">.</span><span class="ident" id="4191043">Parse</span><span class="op" id="4191048">(</span><span class="string" id="4191049">&#34;060102150405Z0700&#34;</span><span class="op" id="4191068">,</span>&nbsp;<span class="ident" id="4191070">s</span><span class="op" id="4191071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4191074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4191077">if</span>&nbsp;<span class="ident" id="4191080">err</span>&nbsp;<span class="op" id="4191084">==</span>&nbsp;<span class="ident" id="4191087">nil</span>&nbsp;<span class="op" id="4191091">&amp;&amp;</span>&nbsp;<span class="ident" id="4191094">ret</span><span class="op" id="4191097">.</span><span class="ident" id="4191098">Year</span><span class="op" id="4191102">(</span><span class="op" id="4191103">)</span>&nbsp;<span class="op" id="4191105">&gt;=</span>&nbsp;<span class="num" id="4191108">2050</span>&nbsp;<span class="op" id="4191113">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4191117">//&nbsp;UTCTime&nbsp;only&nbsp;encodes&nbsp;times&nbsp;prior&nbsp;to&nbsp;2050.&nbsp;See&nbsp;https://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4191222">ret</span>&nbsp;<span class="op" id="4191226">=</span>&nbsp;<span class="ident" id="4191228">ret</span><span class="op" id="4191231">.</span><span class="ident" id="4191232">AddDate</span><span class="op" id="4191239">(</span><span class="op" id="4191240">-</span><span class="num" id="4191241">100</span><span class="op" id="4191244">,</span>&nbsp;<span class="num" id="4191246">0</span><span class="op" id="4191247">,</span>&nbsp;<span class="num" id="4191249">0</span><span class="op" id="4191250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4191253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4191257">return</span><br>
<span class="lineno">300</span><span class="op" id="4191264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4191267">//&nbsp;parseGeneralizedTime&nbsp;parses&nbsp;the&nbsp;GeneralizedTime&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="4191344">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4191379">func</span>&nbsp;<span class="ident" id="4191384">parseGeneralizedTime</span><span class="op" id="4191404">(</span><span class="ident" id="4191405">bytes</span>&nbsp;<span class="op" id="4191411">[</span><span class="op" id="4191412">]</span><span class="builtintype" id="4191413">byte</span><span class="op" id="4191417">)</span>&nbsp;<span class="op" id="4191419">(</span><span class="ident" id="4191420">ret</span>&nbsp;<span class="ident" id="4191424">time</span><span class="op" id="4191428">.</span><span class="ident" id="4191429">Time</span><span class="op" id="4191433">,</span>&nbsp;<span class="ident" id="4191435">err</span>&nbsp;<span class="builtintype" id="4191439">error</span><span class="op" id="4191444">)</span>&nbsp;<span class="op" id="4191446">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4191449">return</span>&nbsp;<span class="ident" id="4191456">time</span><span class="op" id="4191460">.</span><span class="ident" id="4191461">Parse</span><span class="op" id="4191466">(</span><span class="string" id="4191467">&#34;20060102150405Z0700&#34;</span><span class="op" id="4191488">,</span>&nbsp;<span class="builtintype" id="4191490">string</span><span class="op" id="4191496">(</span><span class="ident" id="4191497">bytes</span><span class="op" id="4191502">)</span><span class="op" id="4191503">)</span><br>
<span class="lineno"></span><span class="op" id="4191505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4191508">//&nbsp;PrintableString</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4191528">//&nbsp;parsePrintableString&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;PrintableString&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4191603">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4191628">func</span>&nbsp;<span class="ident" id="4191633">parsePrintableString</span><span class="op" id="4191653">(</span><span class="ident" id="4191654">bytes</span>&nbsp;<span class="op" id="4191660">[</span><span class="op" id="4191661">]</span><span class="builtintype" id="4191662">byte</span><span class="op" id="4191666">)</span>&nbsp;<span class="op" id="4191668">(</span><span class="ident" id="4191669">ret</span>&nbsp;<span class="builtintype" id="4191673">string</span><span class="op" id="4191679">,</span>&nbsp;<span class="ident" id="4191681">err</span>&nbsp;<span class="builtintype" id="4191685">error</span><span class="op" id="4191690">)</span>&nbsp;<span class="op" id="4191692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4191695">for</span>&nbsp;<span class="ident" id="4191699">_</span><span class="op" id="4191700">,</span>&nbsp;<span class="ident" id="4191702">b</span>&nbsp;<span class="op" id="4191704">:=</span>&nbsp;<span class="keyword" id="4191707">range</span>&nbsp;<span class="ident" id="4191713">bytes</span>&nbsp;<span class="op" id="4191719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4191723">if</span>&nbsp;<span class="op" id="4191726">!</span><span class="ident" id="4191727">isPrintable</span><span class="op" id="4191738">(</span><span class="ident" id="4191739">b</span><span class="op" id="4191740">)</span>&nbsp;<span class="op" id="4191742">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4191747">err</span>&nbsp;<span class="op" id="4191751">=</span>&nbsp;<span class="ident" id="4191753">SyntaxError</span><span class="op" id="4191764">{</span><span class="string" id="4191765">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4191809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4191814">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4191823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4191826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4191829">ret</span>&nbsp;<span class="op" id="4191833">=</span>&nbsp;<span class="builtintype" id="4191835">string</span><span class="op" id="4191841">(</span><span class="ident" id="4191842">bytes</span><span class="op" id="4191847">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4191850">return</span><br>
<span class="lineno"></span><span class="op" id="4191857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4191860">//&nbsp;isPrintable&nbsp;returns&nbsp;true&nbsp;iff&nbsp;the&nbsp;given&nbsp;b&nbsp;is&nbsp;in&nbsp;the&nbsp;ASN.1&nbsp;PrintableString&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="4191941">func</span>&nbsp;<span class="ident" id="4191946">isPrintable</span><span class="op" id="4191957">(</span><span class="ident" id="4191958">b</span>&nbsp;<span class="builtintype" id="4191960">byte</span><span class="op" id="4191964">)</span>&nbsp;<span class="builtintype" id="4191966">bool</span>&nbsp;<span class="op" id="4191971">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4191974">return</span>&nbsp;<span class="string" id="4191981">&#39;a&#39;</span>&nbsp;<span class="op" id="4191985">&lt;=</span>&nbsp;<span class="ident" id="4191988">b</span>&nbsp;<span class="op" id="4191990">&amp;&amp;</span>&nbsp;<span class="ident" id="4191993">b</span>&nbsp;<span class="op" id="4191995">&lt;=</span>&nbsp;<span class="string" id="4191998">&#39;z&#39;</span>&nbsp;<span class="op" id="4192002">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4192007">&#39;A&#39;</span>&nbsp;<span class="op" id="4192011">&lt;=</span>&nbsp;<span class="ident" id="4192014">b</span>&nbsp;<span class="op" id="4192016">&amp;&amp;</span>&nbsp;<span class="ident" id="4192019">b</span>&nbsp;<span class="op" id="4192021">&lt;=</span>&nbsp;<span class="string" id="4192024">&#39;Z&#39;</span>&nbsp;<span class="op" id="4192028">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4192033">&#39;0&#39;</span>&nbsp;<span class="op" id="4192037">&lt;=</span>&nbsp;<span class="ident" id="4192040">b</span>&nbsp;<span class="op" id="4192042">&amp;&amp;</span>&nbsp;<span class="ident" id="4192045">b</span>&nbsp;<span class="op" id="4192047">&lt;=</span>&nbsp;<span class="string" id="4192050">&#39;9&#39;</span>&nbsp;<span class="op" id="4192054">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4192059">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="4192064">&lt;=</span>&nbsp;<span class="ident" id="4192067">b</span>&nbsp;<span class="op" id="4192069">&amp;&amp;</span>&nbsp;<span class="ident" id="4192072">b</span>&nbsp;<span class="op" id="4192074">&lt;=</span>&nbsp;<span class="string" id="4192077">&#39;)&#39;</span>&nbsp;<span class="op" id="4192081">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4192086">&#39;+&#39;</span>&nbsp;<span class="op" id="4192090">&lt;=</span>&nbsp;<span class="ident" id="4192093">b</span>&nbsp;<span class="op" id="4192095">&amp;&amp;</span>&nbsp;<span class="ident" id="4192098">b</span>&nbsp;<span class="op" id="4192100">&lt;=</span>&nbsp;<span class="string" id="4192103">&#39;/&#39;</span>&nbsp;<span class="op" id="4192107">||</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4192112">b</span>&nbsp;<span class="op" id="4192114">==</span>&nbsp;<span class="string" id="4192117">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4192121">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4192126">b</span>&nbsp;<span class="op" id="4192128">==</span>&nbsp;<span class="string" id="4192131">&#39;:&#39;</span>&nbsp;<span class="op" id="4192135">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4192140">b</span>&nbsp;<span class="op" id="4192142">==</span>&nbsp;<span class="string" id="4192145">&#39;=&#39;</span>&nbsp;<span class="op" id="4192149">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4192154">b</span>&nbsp;<span class="op" id="4192156">==</span>&nbsp;<span class="string" id="4192159">&#39;?&#39;</span>&nbsp;<span class="op" id="4192163">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4192168">//&nbsp;This&nbsp;is&nbsp;technically&nbsp;not&nbsp;allowed&nbsp;in&nbsp;a&nbsp;PrintableString.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4192227">//&nbsp;However,&nbsp;x509&nbsp;certificates&nbsp;with&nbsp;wildcard&nbsp;strings&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4192287">//&nbsp;always&nbsp;use&nbsp;the&nbsp;correct&nbsp;string&nbsp;type&nbsp;so&nbsp;we&nbsp;permit&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4192344">b</span>&nbsp;<span class="op" id="4192346">==</span>&nbsp;<span class="string" id="4192349">&#39;*&#39;</span><br>
<span class="lineno"></span><span class="op" id="4192353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="4192356">//&nbsp;IA5String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4192370">//&nbsp;parseIA5String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;IA5String&nbsp;(ASCII&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4192443">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4192473">func</span>&nbsp;<span class="ident" id="4192478">parseIA5String</span><span class="op" id="4192492">(</span><span class="ident" id="4192493">bytes</span>&nbsp;<span class="op" id="4192499">[</span><span class="op" id="4192500">]</span><span class="builtintype" id="4192501">byte</span><span class="op" id="4192505">)</span>&nbsp;<span class="op" id="4192507">(</span><span class="ident" id="4192508">ret</span>&nbsp;<span class="builtintype" id="4192512">string</span><span class="op" id="4192518">,</span>&nbsp;<span class="ident" id="4192520">err</span>&nbsp;<span class="builtintype" id="4192524">error</span><span class="op" id="4192529">)</span>&nbsp;<span class="op" id="4192531">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4192534">for</span>&nbsp;<span class="ident" id="4192538">_</span><span class="op" id="4192539">,</span>&nbsp;<span class="ident" id="4192541">b</span>&nbsp;<span class="op" id="4192543">:=</span>&nbsp;<span class="keyword" id="4192546">range</span>&nbsp;<span class="ident" id="4192552">bytes</span>&nbsp;<span class="op" id="4192558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4192562">if</span>&nbsp;<span class="ident" id="4192565">b</span>&nbsp;<span class="op" id="4192567">&gt;=</span>&nbsp;<span class="num" id="4192570">0x80</span>&nbsp;<span class="op" id="4192575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4192580">err</span>&nbsp;<span class="op" id="4192584">=</span>&nbsp;<span class="ident" id="4192586">SyntaxError</span><span class="op" id="4192597">{</span><span class="string" id="4192598">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4192636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4192641">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4192650">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4192653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4192656">ret</span>&nbsp;<span class="op" id="4192660">=</span>&nbsp;<span class="builtintype" id="4192662">string</span><span class="op" id="4192668">(</span><span class="ident" id="4192669">bytes</span><span class="op" id="4192674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4192677">return</span><br>
<span class="lineno"></span><span class="op" id="4192684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="4192687">//&nbsp;T61String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4192701">//&nbsp;parseT61String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;T61String&nbsp;(8-bit&nbsp;clean&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4192780">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4192810">func</span>&nbsp;<span class="ident" id="4192815">parseT61String</span><span class="op" id="4192829">(</span><span class="ident" id="4192830">bytes</span>&nbsp;<span class="op" id="4192836">[</span><span class="op" id="4192837">]</span><span class="builtintype" id="4192838">byte</span><span class="op" id="4192842">)</span>&nbsp;<span class="op" id="4192844">(</span><span class="ident" id="4192845">ret</span>&nbsp;<span class="builtintype" id="4192849">string</span><span class="op" id="4192855">,</span>&nbsp;<span class="ident" id="4192857">err</span>&nbsp;<span class="builtintype" id="4192861">error</span><span class="op" id="4192866">)</span>&nbsp;<span class="op" id="4192868">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4192871">return</span>&nbsp;<span class="builtintype" id="4192878">string</span><span class="op" id="4192884">(</span><span class="ident" id="4192885">bytes</span><span class="op" id="4192890">)</span><span class="op" id="4192891">,</span>&nbsp;<span class="ident" id="4192893">nil</span><br>
<span class="lineno"></span><span class="op" id="4192897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4192900">//&nbsp;UTF8String</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="4192915">//&nbsp;parseUTF8String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;UTF8String&nbsp;(raw&nbsp;UTF-8)&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4192992">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4193017">func</span>&nbsp;<span class="ident" id="4193022">parseUTF8String</span><span class="op" id="4193037">(</span><span class="ident" id="4193038">bytes</span>&nbsp;<span class="op" id="4193044">[</span><span class="op" id="4193045">]</span><span class="builtintype" id="4193046">byte</span><span class="op" id="4193050">)</span>&nbsp;<span class="op" id="4193052">(</span><span class="ident" id="4193053">ret</span>&nbsp;<span class="builtintype" id="4193057">string</span><span class="op" id="4193063">,</span>&nbsp;<span class="ident" id="4193065">err</span>&nbsp;<span class="builtintype" id="4193069">error</span><span class="op" id="4193074">)</span>&nbsp;<span class="op" id="4193076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4193079">return</span>&nbsp;<span class="builtintype" id="4193086">string</span><span class="op" id="4193092">(</span><span class="ident" id="4193093">bytes</span><span class="op" id="4193098">)</span><span class="op" id="4193099">,</span>&nbsp;<span class="ident" id="4193101">nil</span><br>
<span class="lineno"></span><span class="op" id="4193105">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="4193108">//&nbsp;A&nbsp;RawValue&nbsp;represents&nbsp;an&nbsp;undecoded&nbsp;ASN.1&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="4193160">type</span>&nbsp;<span class="ident" id="4193165">RawValue</span>&nbsp;<span class="keyword" id="4193174">struct</span>&nbsp;<span class="op" id="4193181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4193184">Class</span><span class="op" id="4193189">,</span>&nbsp;<span class="ident" id="4193191">Tag</span>&nbsp;<span class="builtintype" id="4193195">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4193200">IsCompound</span>&nbsp;<span class="builtintype" id="4193211">bool</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4193217">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4193228">[</span><span class="op" id="4193229">]</span><span class="builtintype" id="4193230">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4193236">FullBytes</span>&nbsp;&nbsp;<span class="op" id="4193247">[</span><span class="op" id="4193248">]</span><span class="builtintype" id="4193249">byte</span>&nbsp;<span class="comment" id="4193254">//&nbsp;includes&nbsp;the&nbsp;tag&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span><span class="op" id="4193285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4193288">//&nbsp;RawContent&nbsp;is&nbsp;used&nbsp;to&nbsp;signal&nbsp;that&nbsp;the&nbsp;undecoded,&nbsp;DER&nbsp;data&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno">380</span><span class="comment" id="4193361">//&nbsp;preserved&nbsp;for&nbsp;a&nbsp;struct.&nbsp;To&nbsp;use&nbsp;it,&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;the&nbsp;struct&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="4193439">//&nbsp;this&nbsp;type.&nbsp;It&#39;s&nbsp;an&nbsp;error&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;fields&nbsp;to&nbsp;have&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4193514">type</span>&nbsp;<span class="ident" id="4193519">RawContent</span>&nbsp;<span class="op" id="4193530">[</span><span class="op" id="4193531">]</span><span class="builtintype" id="4193532">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4193538">//&nbsp;Tagging</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="comment" id="4193550">//&nbsp;parseTagAndLength&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;tag&nbsp;and&nbsp;length&nbsp;pair&nbsp;from&nbsp;the&nbsp;given&nbsp;offset</span><br>
<span class="lineno"></span><span class="comment" id="4193629">//&nbsp;into&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;parsed&nbsp;data&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.&nbsp;SET&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4193706">//&nbsp;SET&nbsp;OF&nbsp;(tag&nbsp;17)&nbsp;are&nbsp;mapped&nbsp;to&nbsp;SEQUENCE&nbsp;and&nbsp;SEQUENCE&nbsp;OF&nbsp;(tag&nbsp;16)&nbsp;since&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="4193782">//&nbsp;don&#39;t&nbsp;distinguish&nbsp;between&nbsp;ordered&nbsp;and&nbsp;unordered&nbsp;objects&nbsp;in&nbsp;this&nbsp;code.</span><br>
<span class="lineno">390</span><span class="keyword" id="4193855">func</span>&nbsp;<span class="ident" id="4193860">parseTagAndLength</span><span class="op" id="4193877">(</span><span class="ident" id="4193878">bytes</span>&nbsp;<span class="op" id="4193884">[</span><span class="op" id="4193885">]</span><span class="builtintype" id="4193886">byte</span><span class="op" id="4193890">,</span>&nbsp;<span class="ident" id="4193892">initOffset</span>&nbsp;<span class="builtintype" id="4193903">int</span><span class="op" id="4193906">)</span>&nbsp;<span class="op" id="4193908">(</span><span class="ident" id="4193909">ret</span>&nbsp;<span class="ident" id="4193913">tagAndLength</span><span class="op" id="4193925">,</span>&nbsp;<span class="ident" id="4193927">offset</span>&nbsp;<span class="builtintype" id="4193934">int</span><span class="op" id="4193937">,</span>&nbsp;<span class="ident" id="4193939">err</span>&nbsp;<span class="builtintype" id="4193943">error</span><span class="op" id="4193948">)</span>&nbsp;<span class="op" id="4193950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4193953">offset</span>&nbsp;<span class="op" id="4193960">=</span>&nbsp;<span class="ident" id="4193962">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4193974">b</span>&nbsp;<span class="op" id="4193976">:=</span>&nbsp;<span class="ident" id="4193979">bytes</span><span class="op" id="4193984">[</span><span class="ident" id="4193985">offset</span><span class="op" id="4193991">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4193994">offset</span><span class="op" id="4194000">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4194004">ret</span><span class="op" id="4194007">.</span><span class="ident" id="4194008">class</span>&nbsp;<span class="op" id="4194014">=</span>&nbsp;<span class="builtintype" id="4194016">int</span><span class="op" id="4194019">(</span><span class="ident" id="4194020">b</span>&nbsp;<span class="op" id="4194022">&gt;&gt;</span>&nbsp;<span class="num" id="4194025">6</span><span class="op" id="4194026">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4194029">ret</span><span class="op" id="4194032">.</span><span class="ident" id="4194033">isCompound</span>&nbsp;<span class="op" id="4194044">=</span>&nbsp;<span class="ident" id="4194046">b</span><span class="op" id="4194047">&amp;</span><span class="num" id="4194048">0x20</span>&nbsp;<span class="op" id="4194053">==</span>&nbsp;<span class="num" id="4194056">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4194062">ret</span><span class="op" id="4194065">.</span><span class="ident" id="4194066">tag</span>&nbsp;<span class="op" id="4194070">=</span>&nbsp;<span class="builtintype" id="4194072">int</span><span class="op" id="4194075">(</span><span class="ident" id="4194076">b</span>&nbsp;<span class="op" id="4194078">&amp;</span>&nbsp;<span class="num" id="4194080">0x1f</span><span class="op" id="4194084">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4194088">//&nbsp;If&nbsp;the&nbsp;bottom&nbsp;five&nbsp;bits&nbsp;are&nbsp;set,&nbsp;then&nbsp;the&nbsp;tag&nbsp;number&nbsp;is&nbsp;actually&nbsp;base&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4194166">//&nbsp;encoded&nbsp;afterwards</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4194189">if</span>&nbsp;<span class="ident" id="4194192">ret</span><span class="op" id="4194195">.</span><span class="ident" id="4194196">tag</span>&nbsp;<span class="op" id="4194200">==</span>&nbsp;<span class="num" id="4194203">0x1f</span>&nbsp;<span class="op" id="4194208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4194212">ret</span><span class="op" id="4194215">.</span><span class="ident" id="4194216">tag</span><span class="op" id="4194219">,</span>&nbsp;<span class="ident" id="4194221">offset</span><span class="op" id="4194227">,</span>&nbsp;<span class="ident" id="4194229">err</span>&nbsp;<span class="op" id="4194233">=</span>&nbsp;<span class="ident" id="4194235">parseBase128Int</span><span class="op" id="4194250">(</span><span class="ident" id="4194251">bytes</span><span class="op" id="4194256">,</span>&nbsp;<span class="ident" id="4194258">offset</span><span class="op" id="4194264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4194268">if</span>&nbsp;<span class="ident" id="4194271">err</span>&nbsp;<span class="op" id="4194275">!=</span>&nbsp;<span class="ident" id="4194278">nil</span>&nbsp;<span class="op" id="4194282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4194287">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4194296">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4194299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4194302">if</span>&nbsp;<span class="ident" id="4194305">offset</span>&nbsp;<span class="op" id="4194312">&gt;=</span>&nbsp;<span class="builtinfunc" id="4194315">len</span><span class="op" id="4194318">(</span><span class="ident" id="4194319">bytes</span><span class="op" id="4194324">)</span>&nbsp;<span class="op" id="4194326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4194330">err</span>&nbsp;<span class="op" id="4194334">=</span>&nbsp;<span class="ident" id="4194336">SyntaxError</span><span class="op" id="4194347">{</span><span class="string" id="4194348">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4194373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4194377">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4194385">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4194388">b</span>&nbsp;<span class="op" id="4194390">=</span>&nbsp;<span class="ident" id="4194392">bytes</span><span class="op" id="4194397">[</span><span class="ident" id="4194398">offset</span><span class="op" id="4194404">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4194407">offset</span><span class="op" id="4194413">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4194417">if</span>&nbsp;<span class="ident" id="4194420">b</span><span class="op" id="4194421">&amp;</span><span class="num" id="4194422">0x80</span>&nbsp;<span class="op" id="4194427">==</span>&nbsp;<span class="num" id="4194430">0</span>&nbsp;<span class="op" id="4194432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4194436">//&nbsp;The&nbsp;length&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the&nbsp;bottom&nbsp;7&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4194485">ret</span><span class="op" id="4194488">.</span><span class="ident" id="4194489">length</span>&nbsp;<span class="op" id="4194496">=</span>&nbsp;<span class="builtintype" id="4194498">int</span><span class="op" id="4194501">(</span><span class="ident" id="4194502">b</span>&nbsp;<span class="op" id="4194504">&amp;</span>&nbsp;<span class="num" id="4194506">0x7f</span><span class="op" id="4194510">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4194513">}</span>&nbsp;<span class="keyword" id="4194515">else</span>&nbsp;<span class="op" id="4194520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4194524">//&nbsp;Bottom&nbsp;7&nbsp;bits&nbsp;give&nbsp;the&nbsp;number&nbsp;of&nbsp;length&nbsp;bytes&nbsp;to&nbsp;follow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4194586">numBytes</span>&nbsp;<span class="op" id="4194595">:=</span>&nbsp;<span class="builtintype" id="4194598">int</span><span class="op" id="4194601">(</span><span class="ident" id="4194602">b</span>&nbsp;<span class="op" id="4194604">&amp;</span>&nbsp;<span class="num" id="4194606">0x7f</span><span class="op" id="4194610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4194614">if</span>&nbsp;<span class="ident" id="4194617">numBytes</span>&nbsp;<span class="op" id="4194626">==</span>&nbsp;<span class="num" id="4194629">0</span>&nbsp;<span class="op" id="4194631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4194636">err</span>&nbsp;<span class="op" id="4194640">=</span>&nbsp;<span class="ident" id="4194642">SyntaxError</span><span class="op" id="4194653">{</span><span class="string" id="4194654">&#34;indefinite&nbsp;length&nbsp;found&nbsp;(not&nbsp;DER)&#34;</span><span class="op" id="4194689">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4194694">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4194703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4194707">ret</span><span class="op" id="4194710">.</span><span class="ident" id="4194711">length</span>&nbsp;<span class="op" id="4194718">=</span>&nbsp;<span class="num" id="4194720">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4194724">for</span>&nbsp;<span class="ident" id="4194728">i</span>&nbsp;<span class="op" id="4194730">:=</span>&nbsp;<span class="num" id="4194733">0</span><span class="op" id="4194734">;</span>&nbsp;<span class="ident" id="4194736">i</span>&nbsp;<span class="op" id="4194738">&lt;</span>&nbsp;<span class="ident" id="4194740">numBytes</span><span class="op" id="4194748">;</span>&nbsp;<span class="ident" id="4194750">i</span><span class="op" id="4194751">++</span>&nbsp;<span class="op" id="4194754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4194759">if</span>&nbsp;<span class="ident" id="4194762">offset</span>&nbsp;<span class="op" id="4194769">&gt;=</span>&nbsp;<span class="builtinfunc" id="4194772">len</span><span class="op" id="4194775">(</span><span class="ident" id="4194776">bytes</span><span class="op" id="4194781">)</span>&nbsp;<span class="op" id="4194783">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4194789">err</span>&nbsp;<span class="op" id="4194793">=</span>&nbsp;<span class="ident" id="4194795">SyntaxError</span><span class="op" id="4194806">{</span><span class="string" id="4194807">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4194832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4194838">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4194848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4194853">b</span>&nbsp;<span class="op" id="4194855">=</span>&nbsp;<span class="ident" id="4194857">bytes</span><span class="op" id="4194862">[</span><span class="ident" id="4194863">offset</span><span class="op" id="4194869">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4194874">offset</span><span class="op" id="4194880">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4194886">if</span>&nbsp;<span class="ident" id="4194889">ret</span><span class="op" id="4194892">.</span><span class="ident" id="4194893">length</span>&nbsp;<span class="op" id="4194900">&gt;=</span>&nbsp;<span class="num" id="4194903">1</span><span class="op" id="4194904">&lt;&lt;</span><span class="num" id="4194906">23</span>&nbsp;<span class="op" id="4194909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4194915">//&nbsp;We&nbsp;can&#39;t&nbsp;shift&nbsp;ret.length&nbsp;up&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4194959">//&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4194979">err</span>&nbsp;<span class="op" id="4194983">=</span>&nbsp;<span class="ident" id="4194985">StructuralError</span><span class="op" id="4195000">{</span><span class="string" id="4195001">&#34;length&nbsp;too&nbsp;large&#34;</span><span class="op" id="4195019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4195025">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4195035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4195040">ret</span><span class="op" id="4195043">.</span><span class="ident" id="4195044">length</span>&nbsp;<span class="op" id="4195051">&lt;&lt;=</span>&nbsp;<span class="num" id="4195055">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4195060">ret</span><span class="op" id="4195063">.</span><span class="ident" id="4195064">length</span>&nbsp;<span class="op" id="4195071">|=</span>&nbsp;<span class="builtintype" id="4195074">int</span><span class="op" id="4195077">(</span><span class="ident" id="4195078">b</span><span class="op" id="4195079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4195084">if</span>&nbsp;<span class="ident" id="4195087">ret</span><span class="op" id="4195090">.</span><span class="ident" id="4195091">length</span>&nbsp;<span class="op" id="4195098">==</span>&nbsp;<span class="num" id="4195101">0</span>&nbsp;<span class="op" id="4195103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4195109">//&nbsp;DER&nbsp;requires&nbsp;that&nbsp;lengths&nbsp;be&nbsp;minimal.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4195154">err</span>&nbsp;<span class="op" id="4195158">=</span>&nbsp;<span class="ident" id="4195160">StructuralError</span><span class="op" id="4195175">{</span><span class="string" id="4195176">&#34;superfluous&nbsp;leading&nbsp;zeros&nbsp;in&nbsp;length&#34;</span><span class="op" id="4195213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4195219">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4195229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4195233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4195236">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4195240">return</span><br>
<span class="lineno"></span><span class="op" id="4195247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4195250">//&nbsp;parseSequenceOf&nbsp;is&nbsp;used&nbsp;for&nbsp;SEQUENCE&nbsp;OF&nbsp;and&nbsp;SET&nbsp;OF&nbsp;values.&nbsp;It&nbsp;tries&nbsp;to&nbsp;parse</span><br>
<span class="lineno">450</span><span class="comment" id="4195330">//&nbsp;a&nbsp;number&nbsp;of&nbsp;ASN.1&nbsp;values&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4195406">//&nbsp;slice&nbsp;of&nbsp;Go&nbsp;values&nbsp;of&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4195447">func</span>&nbsp;<span class="ident" id="4195452">parseSequenceOf</span><span class="op" id="4195467">(</span><span class="ident" id="4195468">bytes</span>&nbsp;<span class="op" id="4195474">[</span><span class="op" id="4195475">]</span><span class="builtintype" id="4195476">byte</span><span class="op" id="4195480">,</span>&nbsp;<span class="ident" id="4195482">sliceType</span>&nbsp;<span class="ident" id="4195492">reflect</span><span class="op" id="4195499">.</span><span class="ident" id="4195500">Type</span><span class="op" id="4195504">,</span>&nbsp;<span class="ident" id="4195506">elemType</span>&nbsp;<span class="ident" id="4195515">reflect</span><span class="op" id="4195522">.</span><span class="ident" id="4195523">Type</span><span class="op" id="4195527">)</span>&nbsp;<span class="op" id="4195529">(</span><span class="ident" id="4195530">ret</span>&nbsp;<span class="ident" id="4195534">reflect</span><span class="op" id="4195541">.</span><span class="ident" id="4195542">Value</span><span class="op" id="4195547">,</span>&nbsp;<span class="ident" id="4195549">err</span>&nbsp;<span class="builtintype" id="4195553">error</span><span class="op" id="4195558">)</span>&nbsp;<span class="op" id="4195560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4195563">expectedTag</span><span class="op" id="4195574">,</span>&nbsp;<span class="ident" id="4195576">compoundType</span><span class="op" id="4195588">,</span>&nbsp;<span class="ident" id="4195590">ok</span>&nbsp;<span class="op" id="4195593">:=</span>&nbsp;<span class="ident" id="4195596">getUniversalType</span><span class="op" id="4195612">(</span><span class="ident" id="4195613">elemType</span><span class="op" id="4195621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4195624">if</span>&nbsp;<span class="op" id="4195627">!</span><span class="ident" id="4195628">ok</span>&nbsp;<span class="op" id="4195631">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4195635">err</span>&nbsp;<span class="op" id="4195639">=</span>&nbsp;<span class="ident" id="4195641">StructuralError</span><span class="op" id="4195656">{</span><span class="string" id="4195657">&#34;unknown&nbsp;Go&nbsp;type&nbsp;for&nbsp;slice&#34;</span><span class="op" id="4195684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4195688">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4195696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4195700">//&nbsp;First&nbsp;we&nbsp;iterate&nbsp;over&nbsp;the&nbsp;input&nbsp;and&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;elements,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4195770">//&nbsp;checking&nbsp;that&nbsp;the&nbsp;types&nbsp;are&nbsp;correct&nbsp;in&nbsp;each&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4195824">numElements</span>&nbsp;<span class="op" id="4195836">:=</span>&nbsp;<span class="num" id="4195839">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4195842">for</span>&nbsp;<span class="ident" id="4195846">offset</span>&nbsp;<span class="op" id="4195853">:=</span>&nbsp;<span class="num" id="4195856">0</span><span class="op" id="4195857">;</span>&nbsp;<span class="ident" id="4195859">offset</span>&nbsp;<span class="op" id="4195866">&lt;</span>&nbsp;<span class="builtinfunc" id="4195868">len</span><span class="op" id="4195871">(</span><span class="ident" id="4195872">bytes</span><span class="op" id="4195877">)</span><span class="op" id="4195878">;</span>&nbsp;<span class="op" id="4195880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4195884">var</span>&nbsp;<span class="ident" id="4195888">t</span>&nbsp;<span class="ident" id="4195890">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4195905">t</span><span class="op" id="4195906">,</span>&nbsp;<span class="ident" id="4195908">offset</span><span class="op" id="4195914">,</span>&nbsp;<span class="ident" id="4195916">err</span>&nbsp;<span class="op" id="4195920">=</span>&nbsp;<span class="ident" id="4195922">parseTagAndLength</span><span class="op" id="4195939">(</span><span class="ident" id="4195940">bytes</span><span class="op" id="4195945">,</span>&nbsp;<span class="ident" id="4195947">offset</span><span class="op" id="4195953">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4195957">if</span>&nbsp;<span class="ident" id="4195960">err</span>&nbsp;<span class="op" id="4195964">!=</span>&nbsp;<span class="ident" id="4195967">nil</span>&nbsp;<span class="op" id="4195971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4195976">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4195985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4195989">switch</span>&nbsp;<span class="ident" id="4195996">t</span><span class="op" id="4195997">.</span><span class="ident" id="4195998">tag</span>&nbsp;<span class="op" id="4196002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4196006">case</span>&nbsp;<span class="ident" id="4196011">tagIA5String</span><span class="op" id="4196023">,</span>&nbsp;<span class="ident" id="4196025">tagGeneralString</span><span class="op" id="4196041">,</span>&nbsp;<span class="ident" id="4196043">tagT61String</span><span class="op" id="4196055">,</span>&nbsp;<span class="ident" id="4196057">tagUTF8String</span><span class="op" id="4196070">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4196075">//&nbsp;We&nbsp;pretend&nbsp;that&nbsp;various&nbsp;other&nbsp;string&nbsp;types&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4196128">//&nbsp;PRINTABLE&nbsp;STRINGs&nbsp;so&nbsp;that&nbsp;a&nbsp;sequence&nbsp;of&nbsp;them&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4196186">//&nbsp;parsed&nbsp;into&nbsp;a&nbsp;[]string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4196216">t</span><span class="op" id="4196217">.</span><span class="ident" id="4196218">tag</span>&nbsp;<span class="op" id="4196222">=</span>&nbsp;<span class="ident" id="4196224">tagPrintableString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4196245">case</span>&nbsp;<span class="ident" id="4196250">tagGeneralizedTime</span><span class="op" id="4196268">,</span>&nbsp;<span class="ident" id="4196270">tagUTCTime</span><span class="op" id="4196280">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4196285">//&nbsp;Likewise,&nbsp;both&nbsp;time&nbsp;types&nbsp;are&nbsp;treated&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4196339">t</span><span class="op" id="4196340">.</span><span class="ident" id="4196341">tag</span>&nbsp;<span class="op" id="4196345">=</span>&nbsp;<span class="ident" id="4196347">tagUTCTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4196360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4196365">if</span>&nbsp;<span class="ident" id="4196368">t</span><span class="op" id="4196369">.</span><span class="ident" id="4196370">class</span>&nbsp;<span class="op" id="4196376">!=</span>&nbsp;<span class="ident" id="4196379">classUniversal</span>&nbsp;<span class="op" id="4196394">||</span>&nbsp;<span class="ident" id="4196397">t</span><span class="op" id="4196398">.</span><span class="ident" id="4196399">isCompound</span>&nbsp;<span class="op" id="4196410">!=</span>&nbsp;<span class="ident" id="4196413">compoundType</span>&nbsp;<span class="op" id="4196426">||</span>&nbsp;<span class="ident" id="4196429">t</span><span class="op" id="4196430">.</span><span class="ident" id="4196431">tag</span>&nbsp;<span class="op" id="4196435">!=</span>&nbsp;<span class="ident" id="4196438">expectedTag</span>&nbsp;<span class="op" id="4196450">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4196455">err</span>&nbsp;<span class="op" id="4196459">=</span>&nbsp;<span class="ident" id="4196461">StructuralError</span><span class="op" id="4196476">{</span><span class="string" id="4196477">&#34;sequence&nbsp;tag&nbsp;mismatch&#34;</span><span class="op" id="4196500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4196505">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4196514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4196518">if</span>&nbsp;<span class="ident" id="4196521">invalidLength</span><span class="op" id="4196534">(</span><span class="ident" id="4196535">offset</span><span class="op" id="4196541">,</span>&nbsp;<span class="ident" id="4196543">t</span><span class="op" id="4196544">.</span><span class="ident" id="4196545">length</span><span class="op" id="4196551">,</span>&nbsp;<span class="builtinfunc" id="4196553">len</span><span class="op" id="4196556">(</span><span class="ident" id="4196557">bytes</span><span class="op" id="4196562">)</span><span class="op" id="4196563">)</span>&nbsp;<span class="op" id="4196565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4196570">err</span>&nbsp;<span class="op" id="4196574">=</span>&nbsp;<span class="ident" id="4196576">SyntaxError</span><span class="op" id="4196587">{</span><span class="string" id="4196588">&#34;truncated&nbsp;sequence&#34;</span><span class="op" id="4196608">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4196613">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4196622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4196626">offset</span>&nbsp;<span class="op" id="4196633">+=</span>&nbsp;<span class="ident" id="4196636">t</span><span class="op" id="4196637">.</span><span class="ident" id="4196638">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4196647">numElements</span><span class="op" id="4196658">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4196662">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4196665">ret</span>&nbsp;<span class="op" id="4196669">=</span>&nbsp;<span class="ident" id="4196671">reflect</span><span class="op" id="4196678">.</span><span class="ident" id="4196679">MakeSlice</span><span class="op" id="4196688">(</span><span class="ident" id="4196689">sliceType</span><span class="op" id="4196698">,</span>&nbsp;<span class="ident" id="4196700">numElements</span><span class="op" id="4196711">,</span>&nbsp;<span class="ident" id="4196713">numElements</span><span class="op" id="4196724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4196727">params</span>&nbsp;<span class="op" id="4196734">:=</span>&nbsp;<span class="ident" id="4196737">fieldParameters</span><span class="op" id="4196752">{</span><span class="op" id="4196753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4196756">offset</span>&nbsp;<span class="op" id="4196763">:=</span>&nbsp;<span class="num" id="4196766">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4196769">for</span>&nbsp;<span class="ident" id="4196773">i</span>&nbsp;<span class="op" id="4196775">:=</span>&nbsp;<span class="num" id="4196778">0</span><span class="op" id="4196779">;</span>&nbsp;<span class="ident" id="4196781">i</span>&nbsp;<span class="op" id="4196783">&lt;</span>&nbsp;<span class="ident" id="4196785">numElements</span><span class="op" id="4196796">;</span>&nbsp;<span class="ident" id="4196798">i</span><span class="op" id="4196799">++</span>&nbsp;<span class="op" id="4196802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4196806">offset</span><span class="op" id="4196812">,</span>&nbsp;<span class="ident" id="4196814">err</span>&nbsp;<span class="op" id="4196818">=</span>&nbsp;<span class="ident" id="4196820">parseField</span><span class="op" id="4196830">(</span><span class="ident" id="4196831">ret</span><span class="op" id="4196834">.</span><span class="ident" id="4196835">Index</span><span class="op" id="4196840">(</span><span class="ident" id="4196841">i</span><span class="op" id="4196842">)</span><span class="op" id="4196843">,</span>&nbsp;<span class="ident" id="4196845">bytes</span><span class="op" id="4196850">,</span>&nbsp;<span class="ident" id="4196852">offset</span><span class="op" id="4196858">,</span>&nbsp;<span class="ident" id="4196860">params</span><span class="op" id="4196866">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4196870">if</span>&nbsp;<span class="ident" id="4196873">err</span>&nbsp;<span class="op" id="4196877">!=</span>&nbsp;<span class="ident" id="4196880">nil</span>&nbsp;<span class="op" id="4196884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4196889">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4196898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4196901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4196904">return</span><br>
<span class="lineno">500</span><span class="op" id="4196911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4196914">var</span>&nbsp;<span class="op" id="4196918">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4196921">bitStringType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4196942">=</span>&nbsp;<span class="ident" id="4196944">reflect</span><span class="op" id="4196951">.</span><span class="ident" id="4196952">TypeOf</span><span class="op" id="4196958">(</span><span class="ident" id="4196959">BitString</span><span class="op" id="4196968">{</span><span class="op" id="4196969">}</span><span class="op" id="4196970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4196973">objectIdentifierType</span>&nbsp;<span class="op" id="4196994">=</span>&nbsp;<span class="ident" id="4196996">reflect</span><span class="op" id="4197003">.</span><span class="ident" id="4197004">TypeOf</span><span class="op" id="4197010">(</span><span class="ident" id="4197011">ObjectIdentifier</span><span class="op" id="4197027">{</span><span class="op" id="4197028">}</span><span class="op" id="4197029">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4197032">enumeratedType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4197053">=</span>&nbsp;<span class="ident" id="4197055">reflect</span><span class="op" id="4197062">.</span><span class="ident" id="4197063">TypeOf</span><span class="op" id="4197069">(</span><span class="ident" id="4197070">Enumerated</span><span class="op" id="4197080">(</span><span class="num" id="4197081">0</span><span class="op" id="4197082">)</span><span class="op" id="4197083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4197086">flagType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4197107">=</span>&nbsp;<span class="ident" id="4197109">reflect</span><span class="op" id="4197116">.</span><span class="ident" id="4197117">TypeOf</span><span class="op" id="4197123">(</span><span class="ident" id="4197124">Flag</span><span class="op" id="4197128">(</span><span class="builtintype" id="4197129">false</span><span class="op" id="4197134">)</span><span class="op" id="4197135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4197138">timeType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4197159">=</span>&nbsp;<span class="ident" id="4197161">reflect</span><span class="op" id="4197168">.</span><span class="ident" id="4197169">TypeOf</span><span class="op" id="4197175">(</span><span class="ident" id="4197176">time</span><span class="op" id="4197180">.</span><span class="ident" id="4197181">Time</span><span class="op" id="4197185">{</span><span class="op" id="4197186">}</span><span class="op" id="4197187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4197190">rawValueType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4197211">=</span>&nbsp;<span class="ident" id="4197213">reflect</span><span class="op" id="4197220">.</span><span class="ident" id="4197221">TypeOf</span><span class="op" id="4197227">(</span><span class="ident" id="4197228">RawValue</span><span class="op" id="4197236">{</span><span class="op" id="4197237">}</span><span class="op" id="4197238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4197241">rawContentsType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4197262">=</span>&nbsp;<span class="ident" id="4197264">reflect</span><span class="op" id="4197271">.</span><span class="ident" id="4197272">TypeOf</span><span class="op" id="4197278">(</span><span class="ident" id="4197279">RawContent</span><span class="op" id="4197289">(</span><span class="ident" id="4197290">nil</span><span class="op" id="4197293">)</span><span class="op" id="4197294">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4197297">bigIntType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4197318">=</span>&nbsp;<span class="ident" id="4197320">reflect</span><span class="op" id="4197327">.</span><span class="ident" id="4197328">TypeOf</span><span class="op" id="4197334">(</span><span class="builtinfunc" id="4197335">new</span><span class="op" id="4197338">(</span><span class="ident" id="4197339">big</span><span class="op" id="4197342">.</span><span class="ident" id="4197343">Int</span><span class="op" id="4197346">)</span><span class="op" id="4197347">)</span><br>
<span class="lineno"></span><span class="op" id="4197349">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4197352">//&nbsp;invalidLength&nbsp;returns&nbsp;true&nbsp;iff&nbsp;offset&nbsp;+&nbsp;length&nbsp;&gt;&nbsp;sliceLength,&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4197427">//&nbsp;addition&nbsp;would&nbsp;overflow.</span><br>
<span class="lineno">515</span><span class="keyword" id="4197455">func</span>&nbsp;<span class="ident" id="4197460">invalidLength</span><span class="op" id="4197473">(</span><span class="ident" id="4197474">offset</span><span class="op" id="4197480">,</span>&nbsp;<span class="ident" id="4197482">length</span><span class="op" id="4197488">,</span>&nbsp;<span class="ident" id="4197490">sliceLength</span>&nbsp;<span class="builtintype" id="4197502">int</span><span class="op" id="4197505">)</span>&nbsp;<span class="builtintype" id="4197507">bool</span>&nbsp;<span class="op" id="4197512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4197515">return</span>&nbsp;<span class="ident" id="4197522">offset</span><span class="op" id="4197528">+</span><span class="ident" id="4197529">length</span>&nbsp;<span class="op" id="4197536">&lt;</span>&nbsp;<span class="ident" id="4197538">offset</span>&nbsp;<span class="op" id="4197545">||</span>&nbsp;<span class="ident" id="4197548">offset</span><span class="op" id="4197554">+</span><span class="ident" id="4197555">length</span>&nbsp;<span class="op" id="4197562">&gt;</span>&nbsp;<span class="ident" id="4197564">sliceLength</span><br>
<span class="lineno"></span><span class="op" id="4197576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4197579">//&nbsp;parseField&nbsp;is&nbsp;the&nbsp;main&nbsp;parsing&nbsp;function.&nbsp;Given&nbsp;a&nbsp;byte&nbsp;slice&nbsp;and&nbsp;an&nbsp;offset</span><br>
<span class="lineno">520</span><span class="comment" id="4197656">//&nbsp;into&nbsp;the&nbsp;array,&nbsp;it&nbsp;will&nbsp;try&nbsp;to&nbsp;parse&nbsp;a&nbsp;suitable&nbsp;ASN.1&nbsp;value&nbsp;out&nbsp;and&nbsp;store&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4197736">//&nbsp;in&nbsp;the&nbsp;given&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4197759">func</span>&nbsp;<span class="ident" id="4197764">parseField</span><span class="op" id="4197774">(</span><span class="ident" id="4197775">v</span>&nbsp;<span class="ident" id="4197777">reflect</span><span class="op" id="4197784">.</span><span class="ident" id="4197785">Value</span><span class="op" id="4197790">,</span>&nbsp;<span class="ident" id="4197792">bytes</span>&nbsp;<span class="op" id="4197798">[</span><span class="op" id="4197799">]</span><span class="builtintype" id="4197800">byte</span><span class="op" id="4197804">,</span>&nbsp;<span class="ident" id="4197806">initOffset</span>&nbsp;<span class="builtintype" id="4197817">int</span><span class="op" id="4197820">,</span>&nbsp;<span class="ident" id="4197822">params</span>&nbsp;<span class="ident" id="4197829">fieldParameters</span><span class="op" id="4197844">)</span>&nbsp;<span class="op" id="4197846">(</span><span class="ident" id="4197847">offset</span>&nbsp;<span class="builtintype" id="4197854">int</span><span class="op" id="4197857">,</span>&nbsp;<span class="ident" id="4197859">err</span>&nbsp;<span class="builtintype" id="4197863">error</span><span class="op" id="4197868">)</span>&nbsp;<span class="op" id="4197870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4197873">offset</span>&nbsp;<span class="op" id="4197880">=</span>&nbsp;<span class="ident" id="4197882">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4197894">fieldType</span>&nbsp;<span class="op" id="4197904">:=</span>&nbsp;<span class="ident" id="4197907">v</span><span class="op" id="4197908">.</span><span class="ident" id="4197909">Type</span><span class="op" id="4197913">(</span><span class="op" id="4197914">)</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4197918">//&nbsp;If&nbsp;we&nbsp;have&nbsp;run&nbsp;out&nbsp;of&nbsp;data,&nbsp;it&nbsp;may&nbsp;be&nbsp;that&nbsp;there&nbsp;are&nbsp;optional&nbsp;elements&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198005">if</span>&nbsp;<span class="ident" id="4198008">offset</span>&nbsp;<span class="op" id="4198015">==</span>&nbsp;<span class="builtinfunc" id="4198018">len</span><span class="op" id="4198021">(</span><span class="ident" id="4198022">bytes</span><span class="op" id="4198027">)</span>&nbsp;<span class="op" id="4198029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198033">if</span>&nbsp;<span class="op" id="4198036">!</span><span class="ident" id="4198037">setDefaultValue</span><span class="op" id="4198052">(</span><span class="ident" id="4198053">v</span><span class="op" id="4198054">,</span>&nbsp;<span class="ident" id="4198056">params</span><span class="op" id="4198062">)</span>&nbsp;<span class="op" id="4198064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4198069">err</span>&nbsp;<span class="op" id="4198073">=</span>&nbsp;<span class="ident" id="4198075">SyntaxError</span><span class="op" id="4198086">{</span><span class="string" id="4198087">&#34;sequence&nbsp;truncated&#34;</span><span class="op" id="4198107">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4198111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198115">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4198123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4198127">//&nbsp;Deal&nbsp;with&nbsp;raw&nbsp;values.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198153">if</span>&nbsp;<span class="ident" id="4198156">fieldType</span>&nbsp;<span class="op" id="4198166">==</span>&nbsp;<span class="ident" id="4198169">rawValueType</span>&nbsp;<span class="op" id="4198182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198186">var</span>&nbsp;<span class="ident" id="4198190">t</span>&nbsp;<span class="ident" id="4198192">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4198207">t</span><span class="op" id="4198208">,</span>&nbsp;<span class="ident" id="4198210">offset</span><span class="op" id="4198216">,</span>&nbsp;<span class="ident" id="4198218">err</span>&nbsp;<span class="op" id="4198222">=</span>&nbsp;<span class="ident" id="4198224">parseTagAndLength</span><span class="op" id="4198241">(</span><span class="ident" id="4198242">bytes</span><span class="op" id="4198247">,</span>&nbsp;<span class="ident" id="4198249">offset</span><span class="op" id="4198255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198259">if</span>&nbsp;<span class="ident" id="4198262">err</span>&nbsp;<span class="op" id="4198266">!=</span>&nbsp;<span class="ident" id="4198269">nil</span>&nbsp;<span class="op" id="4198273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198278">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4198287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198291">if</span>&nbsp;<span class="ident" id="4198294">invalidLength</span><span class="op" id="4198307">(</span><span class="ident" id="4198308">offset</span><span class="op" id="4198314">,</span>&nbsp;<span class="ident" id="4198316">t</span><span class="op" id="4198317">.</span><span class="ident" id="4198318">length</span><span class="op" id="4198324">,</span>&nbsp;<span class="builtinfunc" id="4198326">len</span><span class="op" id="4198329">(</span><span class="ident" id="4198330">bytes</span><span class="op" id="4198335">)</span><span class="op" id="4198336">)</span>&nbsp;<span class="op" id="4198338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4198343">err</span>&nbsp;<span class="op" id="4198347">=</span>&nbsp;<span class="ident" id="4198349">SyntaxError</span><span class="op" id="4198360">{</span><span class="string" id="4198361">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4198377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198382">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4198391">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4198395">result</span>&nbsp;<span class="op" id="4198402">:=</span>&nbsp;<span class="ident" id="4198405">RawValue</span><span class="op" id="4198413">{</span><span class="ident" id="4198414">t</span><span class="op" id="4198415">.</span><span class="ident" id="4198416">class</span><span class="op" id="4198421">,</span>&nbsp;<span class="ident" id="4198423">t</span><span class="op" id="4198424">.</span><span class="ident" id="4198425">tag</span><span class="op" id="4198428">,</span>&nbsp;<span class="ident" id="4198430">t</span><span class="op" id="4198431">.</span><span class="ident" id="4198432">isCompound</span><span class="op" id="4198442">,</span>&nbsp;<span class="ident" id="4198444">bytes</span><span class="op" id="4198449">[</span><span class="ident" id="4198450">offset</span>&nbsp;<span class="op" id="4198457">:</span>&nbsp;<span class="ident" id="4198459">offset</span><span class="op" id="4198465">+</span><span class="ident" id="4198466">t</span><span class="op" id="4198467">.</span><span class="ident" id="4198468">length</span><span class="op" id="4198474">]</span><span class="op" id="4198475">,</span>&nbsp;<span class="ident" id="4198477">bytes</span><span class="op" id="4198482">[</span><span class="ident" id="4198483">initOffset</span>&nbsp;<span class="op" id="4198494">:</span>&nbsp;<span class="ident" id="4198496">offset</span><span class="op" id="4198502">+</span><span class="ident" id="4198503">t</span><span class="op" id="4198504">.</span><span class="ident" id="4198505">length</span><span class="op" id="4198511">]</span><span class="op" id="4198512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4198516">offset</span>&nbsp;<span class="op" id="4198523">+=</span>&nbsp;<span class="ident" id="4198526">t</span><span class="op" id="4198527">.</span><span class="ident" id="4198528">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4198537">v</span><span class="op" id="4198538">.</span><span class="ident" id="4198539">Set</span><span class="op" id="4198542">(</span><span class="ident" id="4198543">reflect</span><span class="op" id="4198550">.</span><span class="ident" id="4198551">ValueOf</span><span class="op" id="4198558">(</span><span class="ident" id="4198559">result</span><span class="op" id="4198565">)</span><span class="op" id="4198566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198570">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4198578">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4198582">//&nbsp;Deal&nbsp;with&nbsp;the&nbsp;ANY&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198610">if</span>&nbsp;<span class="ident" id="4198613">ifaceType</span>&nbsp;<span class="op" id="4198623">:=</span>&nbsp;<span class="ident" id="4198626">fieldType</span><span class="op" id="4198635">;</span>&nbsp;<span class="ident" id="4198637">ifaceType</span><span class="op" id="4198646">.</span><span class="ident" id="4198647">Kind</span><span class="op" id="4198651">(</span><span class="op" id="4198652">)</span>&nbsp;<span class="op" id="4198654">==</span>&nbsp;<span class="ident" id="4198657">reflect</span><span class="op" id="4198664">.</span><span class="ident" id="4198665">Interface</span>&nbsp;<span class="op" id="4198675">&amp;&amp;</span>&nbsp;<span class="ident" id="4198678">ifaceType</span><span class="op" id="4198687">.</span><span class="ident" id="4198688">NumMethod</span><span class="op" id="4198697">(</span><span class="op" id="4198698">)</span>&nbsp;<span class="op" id="4198700">==</span>&nbsp;<span class="num" id="4198703">0</span>&nbsp;<span class="op" id="4198705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198709">var</span>&nbsp;<span class="ident" id="4198713">t</span>&nbsp;<span class="ident" id="4198715">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4198730">t</span><span class="op" id="4198731">,</span>&nbsp;<span class="ident" id="4198733">offset</span><span class="op" id="4198739">,</span>&nbsp;<span class="ident" id="4198741">err</span>&nbsp;<span class="op" id="4198745">=</span>&nbsp;<span class="ident" id="4198747">parseTagAndLength</span><span class="op" id="4198764">(</span><span class="ident" id="4198765">bytes</span><span class="op" id="4198770">,</span>&nbsp;<span class="ident" id="4198772">offset</span><span class="op" id="4198778">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198782">if</span>&nbsp;<span class="ident" id="4198785">err</span>&nbsp;<span class="op" id="4198789">!=</span>&nbsp;<span class="ident" id="4198792">nil</span>&nbsp;<span class="op" id="4198796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198801">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4198810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198814">if</span>&nbsp;<span class="ident" id="4198817">invalidLength</span><span class="op" id="4198830">(</span><span class="ident" id="4198831">offset</span><span class="op" id="4198837">,</span>&nbsp;<span class="ident" id="4198839">t</span><span class="op" id="4198840">.</span><span class="ident" id="4198841">length</span><span class="op" id="4198847">,</span>&nbsp;<span class="builtinfunc" id="4198849">len</span><span class="op" id="4198852">(</span><span class="ident" id="4198853">bytes</span><span class="op" id="4198858">)</span><span class="op" id="4198859">)</span>&nbsp;<span class="op" id="4198861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4198866">err</span>&nbsp;<span class="op" id="4198870">=</span>&nbsp;<span class="ident" id="4198872">SyntaxError</span><span class="op" id="4198883">{</span><span class="string" id="4198884">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4198900">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198905">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4198914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198918">var</span>&nbsp;<span class="ident" id="4198922">result</span>&nbsp;<span class="keyword" id="4198929">interface</span><span class="op" id="4198938">{</span><span class="op" id="4198939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4198943">if</span>&nbsp;<span class="op" id="4198946">!</span><span class="ident" id="4198947">t</span><span class="op" id="4198948">.</span><span class="ident" id="4198949">isCompound</span>&nbsp;<span class="op" id="4198960">&amp;&amp;</span>&nbsp;<span class="ident" id="4198963">t</span><span class="op" id="4198964">.</span><span class="ident" id="4198965">class</span>&nbsp;<span class="op" id="4198971">==</span>&nbsp;<span class="ident" id="4198974">classUniversal</span>&nbsp;<span class="op" id="4198989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4198994">innerBytes</span>&nbsp;<span class="op" id="4199005">:=</span>&nbsp;<span class="ident" id="4199008">bytes</span><span class="op" id="4199013">[</span><span class="ident" id="4199014">offset</span>&nbsp;<span class="op" id="4199021">:</span>&nbsp;<span class="ident" id="4199023">offset</span><span class="op" id="4199029">+</span><span class="ident" id="4199030">t</span><span class="op" id="4199031">.</span><span class="ident" id="4199032">length</span><span class="op" id="4199038">]</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4199043">switch</span>&nbsp;<span class="ident" id="4199050">t</span><span class="op" id="4199051">.</span><span class="ident" id="4199052">tag</span>&nbsp;<span class="op" id="4199056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4199061">case</span>&nbsp;<span class="ident" id="4199066">tagPrintableString</span><span class="op" id="4199084">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4199090">result</span><span class="op" id="4199096">,</span>&nbsp;<span class="ident" id="4199098">err</span>&nbsp;<span class="op" id="4199102">=</span>&nbsp;<span class="ident" id="4199104">parsePrintableString</span><span class="op" id="4199124">(</span><span class="ident" id="4199125">innerBytes</span><span class="op" id="4199135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4199140">case</span>&nbsp;<span class="ident" id="4199145">tagIA5String</span><span class="op" id="4199157">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4199163">result</span><span class="op" id="4199169">,</span>&nbsp;<span class="ident" id="4199171">err</span>&nbsp;<span class="op" id="4199175">=</span>&nbsp;<span class="ident" id="4199177">parseIA5String</span><span class="op" id="4199191">(</span><span class="ident" id="4199192">innerBytes</span><span class="op" id="4199202">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4199207">case</span>&nbsp;<span class="ident" id="4199212">tagT61String</span><span class="op" id="4199224">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4199230">result</span><span class="op" id="4199236">,</span>&nbsp;<span class="ident" id="4199238">err</span>&nbsp;<span class="op" id="4199242">=</span>&nbsp;<span class="ident" id="4199244">parseT61String</span><span class="op" id="4199258">(</span><span class="ident" id="4199259">innerBytes</span><span class="op" id="4199269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4199274">case</span>&nbsp;<span class="ident" id="4199279">tagUTF8String</span><span class="op" id="4199292">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4199298">result</span><span class="op" id="4199304">,</span>&nbsp;<span class="ident" id="4199306">err</span>&nbsp;<span class="op" id="4199310">=</span>&nbsp;<span class="ident" id="4199312">parseUTF8String</span><span class="op" id="4199327">(</span><span class="ident" id="4199328">innerBytes</span><span class="op" id="4199338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4199343">case</span>&nbsp;<span class="ident" id="4199348">tagInteger</span><span class="op" id="4199358">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4199364">result</span><span class="op" id="4199370">,</span>&nbsp;<span class="ident" id="4199372">err</span>&nbsp;<span class="op" id="4199376">=</span>&nbsp;<span class="ident" id="4199378">parseInt64</span><span class="op" id="4199388">(</span><span class="ident" id="4199389">innerBytes</span><span class="op" id="4199399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4199404">case</span>&nbsp;<span class="ident" id="4199409">tagBitString</span><span class="op" id="4199421">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4199427">result</span><span class="op" id="4199433">,</span>&nbsp;<span class="ident" id="4199435">err</span>&nbsp;<span class="op" id="4199439">=</span>&nbsp;<span class="ident" id="4199441">parseBitString</span><span class="op" id="4199455">(</span><span class="ident" id="4199456">innerBytes</span><span class="op" id="4199466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4199471">case</span>&nbsp;<span class="ident" id="4199476">tagOID</span><span class="op" id="4199482">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4199488">result</span><span class="op" id="4199494">,</span>&nbsp;<span class="ident" id="4199496">err</span>&nbsp;<span class="op" id="4199500">=</span>&nbsp;<span class="ident" id="4199502">parseObjectIdentifier</span><span class="op" id="4199523">(</span><span class="ident" id="4199524">innerBytes</span><span class="op" id="4199534">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4199539">case</span>&nbsp;<span class="ident" id="4199544">tagUTCTime</span><span class="op" id="4199554">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4199560">result</span><span class="op" id="4199566">,</span>&nbsp;<span class="ident" id="4199568">err</span>&nbsp;<span class="op" id="4199572">=</span>&nbsp;<span class="ident" id="4199574">parseUTCTime</span><span class="op" id="4199586">(</span><span class="ident" id="4199587">innerBytes</span><span class="op" id="4199597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4199602">case</span>&nbsp;<span class="ident" id="4199607">tagOctetString</span><span class="op" id="4199621">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4199627">result</span>&nbsp;<span class="op" id="4199634">=</span>&nbsp;<span class="ident" id="4199636">innerBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4199650">default</span><span class="op" id="4199657">:</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4199663">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;type,&nbsp;we&nbsp;just&nbsp;leave&nbsp;Value&nbsp;as&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4199738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4199742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4199746">offset</span>&nbsp;<span class="op" id="4199753">+=</span>&nbsp;<span class="ident" id="4199756">t</span><span class="op" id="4199757">.</span><span class="ident" id="4199758">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4199767">if</span>&nbsp;<span class="ident" id="4199770">err</span>&nbsp;<span class="op" id="4199774">!=</span>&nbsp;<span class="ident" id="4199777">nil</span>&nbsp;<span class="op" id="4199781">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4199786">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4199795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4199799">if</span>&nbsp;<span class="ident" id="4199802">result</span>&nbsp;<span class="op" id="4199809">!=</span>&nbsp;<span class="ident" id="4199812">nil</span>&nbsp;<span class="op" id="4199816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4199821">v</span><span class="op" id="4199822">.</span><span class="ident" id="4199823">Set</span><span class="op" id="4199826">(</span><span class="ident" id="4199827">reflect</span><span class="op" id="4199834">.</span><span class="ident" id="4199835">ValueOf</span><span class="op" id="4199842">(</span><span class="ident" id="4199843">result</span><span class="op" id="4199849">)</span><span class="op" id="4199850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4199854">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4199858">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4199866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4199869">universalTag</span><span class="op" id="4199881">,</span>&nbsp;<span class="ident" id="4199883">compoundType</span><span class="op" id="4199895">,</span>&nbsp;<span class="ident" id="4199897">ok1</span>&nbsp;<span class="op" id="4199901">:=</span>&nbsp;<span class="ident" id="4199904">getUniversalType</span><span class="op" id="4199920">(</span><span class="ident" id="4199921">fieldType</span><span class="op" id="4199930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4199933">if</span>&nbsp;<span class="op" id="4199936">!</span><span class="ident" id="4199937">ok1</span>&nbsp;<span class="op" id="4199941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4199945">err</span>&nbsp;<span class="op" id="4199949">=</span>&nbsp;<span class="ident" id="4199951">StructuralError</span><span class="op" id="4199966">{</span><span class="ident" id="4199967">fmt</span><span class="op" id="4199970">.</span><span class="ident" id="4199971">Sprintf</span><span class="op" id="4199978">(</span><span class="string" id="4199979">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="4200000">,</span>&nbsp;<span class="ident" id="4200002">fieldType</span><span class="op" id="4200011">)</span><span class="op" id="4200012">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4200016">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4200024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4200028">t</span><span class="op" id="4200029">,</span>&nbsp;<span class="ident" id="4200031">offset</span><span class="op" id="4200037">,</span>&nbsp;<span class="ident" id="4200039">err</span>&nbsp;<span class="op" id="4200043">:=</span>&nbsp;<span class="ident" id="4200046">parseTagAndLength</span><span class="op" id="4200063">(</span><span class="ident" id="4200064">bytes</span><span class="op" id="4200069">,</span>&nbsp;<span class="ident" id="4200071">offset</span><span class="op" id="4200077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4200080">if</span>&nbsp;<span class="ident" id="4200083">err</span>&nbsp;<span class="op" id="4200087">!=</span>&nbsp;<span class="ident" id="4200090">nil</span>&nbsp;<span class="op" id="4200094">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4200098">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4200106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4200109">if</span>&nbsp;<span class="ident" id="4200112">params</span><span class="op" id="4200118">.</span><span class="ident" id="4200119">explicit</span>&nbsp;<span class="op" id="4200128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4200132">expectedClass</span>&nbsp;<span class="op" id="4200146">:=</span>&nbsp;<span class="ident" id="4200149">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4200172">if</span>&nbsp;<span class="ident" id="4200175">params</span><span class="op" id="4200181">.</span><span class="ident" id="4200182">application</span>&nbsp;<span class="op" id="4200194">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4200199">expectedClass</span>&nbsp;<span class="op" id="4200213">=</span>&nbsp;<span class="ident" id="4200215">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4200234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4200238">if</span>&nbsp;<span class="ident" id="4200241">t</span><span class="op" id="4200242">.</span><span class="ident" id="4200243">class</span>&nbsp;<span class="op" id="4200249">==</span>&nbsp;<span class="ident" id="4200252">expectedClass</span>&nbsp;<span class="op" id="4200266">&amp;&amp;</span>&nbsp;<span class="ident" id="4200269">t</span><span class="op" id="4200270">.</span><span class="ident" id="4200271">tag</span>&nbsp;<span class="op" id="4200275">==</span>&nbsp;<span class="op" id="4200278">*</span><span class="ident" id="4200279">params</span><span class="op" id="4200285">.</span><span class="ident" id="4200286">tag</span>&nbsp;<span class="op" id="4200290">&amp;&amp;</span>&nbsp;<span class="op" id="4200293">(</span><span class="ident" id="4200294">t</span><span class="op" id="4200295">.</span><span class="ident" id="4200296">length</span>&nbsp;<span class="op" id="4200303">==</span>&nbsp;<span class="num" id="4200306">0</span>&nbsp;<span class="op" id="4200308">||</span>&nbsp;<span class="ident" id="4200311">t</span><span class="op" id="4200312">.</span><span class="ident" id="4200313">isCompound</span><span class="op" id="4200323">)</span>&nbsp;<span class="op" id="4200325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4200330">if</span>&nbsp;<span class="ident" id="4200333">t</span><span class="op" id="4200334">.</span><span class="ident" id="4200335">length</span>&nbsp;<span class="op" id="4200342">&gt;</span>&nbsp;<span class="num" id="4200344">0</span>&nbsp;<span class="op" id="4200346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4200352">t</span><span class="op" id="4200353">,</span>&nbsp;<span class="ident" id="4200355">offset</span><span class="op" id="4200361">,</span>&nbsp;<span class="ident" id="4200363">err</span>&nbsp;<span class="op" id="4200367">=</span>&nbsp;<span class="ident" id="4200369">parseTagAndLength</span><span class="op" id="4200386">(</span><span class="ident" id="4200387">bytes</span><span class="op" id="4200392">,</span>&nbsp;<span class="ident" id="4200394">offset</span><span class="op" id="4200400">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4200406">if</span>&nbsp;<span class="ident" id="4200409">err</span>&nbsp;<span class="op" id="4200413">!=</span>&nbsp;<span class="ident" id="4200416">nil</span>&nbsp;<span class="op" id="4200420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4200427">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4200438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4200443">}</span>&nbsp;<span class="keyword" id="4200445">else</span>&nbsp;<span class="op" id="4200450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4200456">if</span>&nbsp;<span class="ident" id="4200459">fieldType</span>&nbsp;<span class="op" id="4200469">!=</span>&nbsp;<span class="ident" id="4200472">flagType</span>&nbsp;<span class="op" id="4200481">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4200488">err</span>&nbsp;<span class="op" id="4200492">=</span>&nbsp;<span class="ident" id="4200494">StructuralError</span><span class="op" id="4200509">{</span><span class="string" id="4200510">&#34;zero&nbsp;length&nbsp;explicit&nbsp;tag&nbsp;was&nbsp;not&nbsp;an&nbsp;asn1.Flag&#34;</span><span class="op" id="4200557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4200564">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4200575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4200581">v</span><span class="op" id="4200582">.</span><span class="ident" id="4200583">SetBool</span><span class="op" id="4200590">(</span><span class="builtintype" id="4200591">true</span><span class="op" id="4200595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4200601">return</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4200611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4200615">}</span>&nbsp;<span class="keyword" id="4200617">else</span>&nbsp;<span class="op" id="4200622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4200627">//&nbsp;The&nbsp;tags&nbsp;didn&#39;t&nbsp;match,&nbsp;it&nbsp;might&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4200689">ok</span>&nbsp;<span class="op" id="4200692">:=</span>&nbsp;<span class="ident" id="4200695">setDefaultValue</span><span class="op" id="4200710">(</span><span class="ident" id="4200711">v</span><span class="op" id="4200712">,</span>&nbsp;<span class="ident" id="4200714">params</span><span class="op" id="4200720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4200725">if</span>&nbsp;<span class="ident" id="4200728">ok</span>&nbsp;<span class="op" id="4200731">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4200737">offset</span>&nbsp;<span class="op" id="4200744">=</span>&nbsp;<span class="ident" id="4200746">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4200760">}</span>&nbsp;<span class="keyword" id="4200762">else</span>&nbsp;<span class="op" id="4200767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4200773">err</span>&nbsp;<span class="op" id="4200777">=</span>&nbsp;<span class="ident" id="4200779">StructuralError</span><span class="op" id="4200794">{</span><span class="string" id="4200795">&#34;explicitly&nbsp;tagged&nbsp;member&nbsp;didn&#39;t&nbsp;match&#34;</span><span class="op" id="4200834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4200839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4200844">return</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4200853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4200856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4200860">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;strings:&nbsp;all&nbsp;the&nbsp;ASN.1&nbsp;string&nbsp;types&nbsp;map&nbsp;to&nbsp;the&nbsp;Go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4200931">//&nbsp;type&nbsp;string.&nbsp;getUniversalType&nbsp;returns&nbsp;the&nbsp;tag&nbsp;for&nbsp;PrintableString</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4201001">//&nbsp;when&nbsp;it&nbsp;sees&nbsp;a&nbsp;string,&nbsp;so&nbsp;if&nbsp;we&nbsp;see&nbsp;a&nbsp;different&nbsp;string&nbsp;type&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4201072">//&nbsp;wire,&nbsp;we&nbsp;change&nbsp;the&nbsp;universal&nbsp;type&nbsp;to&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4201121">if</span>&nbsp;<span class="ident" id="4201124">universalTag</span>&nbsp;<span class="op" id="4201137">==</span>&nbsp;<span class="ident" id="4201140">tagPrintableString</span>&nbsp;<span class="op" id="4201159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4201163">if</span>&nbsp;<span class="ident" id="4201166">t</span><span class="op" id="4201167">.</span><span class="ident" id="4201168">class</span>&nbsp;<span class="op" id="4201174">==</span>&nbsp;<span class="ident" id="4201177">classUniversal</span>&nbsp;<span class="op" id="4201192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4201197">switch</span>&nbsp;<span class="ident" id="4201204">t</span><span class="op" id="4201205">.</span><span class="ident" id="4201206">tag</span>&nbsp;<span class="op" id="4201210">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4201215">case</span>&nbsp;<span class="ident" id="4201220">tagIA5String</span><span class="op" id="4201232">,</span>&nbsp;<span class="ident" id="4201234">tagGeneralString</span><span class="op" id="4201250">,</span>&nbsp;<span class="ident" id="4201252">tagT61String</span><span class="op" id="4201264">,</span>&nbsp;<span class="ident" id="4201266">tagUTF8String</span><span class="op" id="4201279">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4201285">universalTag</span>&nbsp;<span class="op" id="4201298">=</span>&nbsp;<span class="ident" id="4201300">t</span><span class="op" id="4201301">.</span><span class="ident" id="4201302">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4201309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4201313">}</span>&nbsp;<span class="keyword" id="4201315">else</span>&nbsp;<span class="keyword" id="4201320">if</span>&nbsp;<span class="ident" id="4201323">params</span><span class="op" id="4201329">.</span><span class="ident" id="4201330">stringType</span>&nbsp;<span class="op" id="4201341">!=</span>&nbsp;<span class="num" id="4201344">0</span>&nbsp;<span class="op" id="4201346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4201351">universalTag</span>&nbsp;<span class="op" id="4201364">=</span>&nbsp;<span class="ident" id="4201366">params</span><span class="op" id="4201372">.</span><span class="ident" id="4201373">stringType</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4201386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4201389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4201393">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;time:&nbsp;UTCTime&nbsp;and&nbsp;GeneralizedTime&nbsp;both&nbsp;map&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4201464">//&nbsp;Go&nbsp;type&nbsp;time.Time.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4201487">if</span>&nbsp;<span class="ident" id="4201490">universalTag</span>&nbsp;<span class="op" id="4201503">==</span>&nbsp;<span class="ident" id="4201506">tagUTCTime</span>&nbsp;<span class="op" id="4201517">&amp;&amp;</span>&nbsp;<span class="ident" id="4201520">t</span><span class="op" id="4201521">.</span><span class="ident" id="4201522">tag</span>&nbsp;<span class="op" id="4201526">==</span>&nbsp;<span class="ident" id="4201529">tagGeneralizedTime</span>&nbsp;<span class="op" id="4201548">&amp;&amp;</span>&nbsp;<span class="ident" id="4201551">t</span><span class="op" id="4201552">.</span><span class="ident" id="4201553">class</span>&nbsp;<span class="op" id="4201559">==</span>&nbsp;<span class="ident" id="4201562">classUniversal</span>&nbsp;<span class="op" id="4201577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4201581">universalTag</span>&nbsp;<span class="op" id="4201594">=</span>&nbsp;<span class="ident" id="4201596">tagGeneralizedTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4201616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4201620">if</span>&nbsp;<span class="ident" id="4201623">params</span><span class="op" id="4201629">.</span><span class="ident" id="4201630">set</span>&nbsp;<span class="op" id="4201634">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4201638">universalTag</span>&nbsp;<span class="op" id="4201651">=</span>&nbsp;<span class="ident" id="4201653">tagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4201661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4201665">expectedClass</span>&nbsp;<span class="op" id="4201679">:=</span>&nbsp;<span class="ident" id="4201682">classUniversal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4201698">expectedTag</span>&nbsp;<span class="op" id="4201710">:=</span>&nbsp;<span class="ident" id="4201713">universalTag</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4201728">if</span>&nbsp;<span class="op" id="4201731">!</span><span class="ident" id="4201732">params</span><span class="op" id="4201738">.</span><span class="ident" id="4201739">explicit</span>&nbsp;<span class="op" id="4201748">&amp;&amp;</span>&nbsp;<span class="ident" id="4201751">params</span><span class="op" id="4201757">.</span><span class="ident" id="4201758">tag</span>&nbsp;<span class="op" id="4201762">!=</span>&nbsp;<span class="ident" id="4201765">nil</span>&nbsp;<span class="op" id="4201769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4201773">expectedClass</span>&nbsp;<span class="op" id="4201787">=</span>&nbsp;<span class="ident" id="4201789">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4201812">expectedTag</span>&nbsp;<span class="op" id="4201824">=</span>&nbsp;<span class="op" id="4201826">*</span><span class="ident" id="4201827">params</span><span class="op" id="4201833">.</span><span class="ident" id="4201834">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4201839">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4201843">if</span>&nbsp;<span class="op" id="4201846">!</span><span class="ident" id="4201847">params</span><span class="op" id="4201853">.</span><span class="ident" id="4201854">explicit</span>&nbsp;<span class="op" id="4201863">&amp;&amp;</span>&nbsp;<span class="ident" id="4201866">params</span><span class="op" id="4201872">.</span><span class="ident" id="4201873">application</span>&nbsp;<span class="op" id="4201885">&amp;&amp;</span>&nbsp;<span class="ident" id="4201888">params</span><span class="op" id="4201894">.</span><span class="ident" id="4201895">tag</span>&nbsp;<span class="op" id="4201899">!=</span>&nbsp;<span class="ident" id="4201902">nil</span>&nbsp;<span class="op" id="4201906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4201910">expectedClass</span>&nbsp;<span class="op" id="4201924">=</span>&nbsp;<span class="ident" id="4201926">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4201945">expectedTag</span>&nbsp;<span class="op" id="4201957">=</span>&nbsp;<span class="op" id="4201959">*</span><span class="ident" id="4201960">params</span><span class="op" id="4201966">.</span><span class="ident" id="4201967">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4201972">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4201976">//&nbsp;We&nbsp;have&nbsp;unwrapped&nbsp;any&nbsp;explicit&nbsp;tagging&nbsp;at&nbsp;this&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4202034">if</span>&nbsp;<span class="ident" id="4202037">t</span><span class="op" id="4202038">.</span><span class="ident" id="4202039">class</span>&nbsp;<span class="op" id="4202045">!=</span>&nbsp;<span class="ident" id="4202048">expectedClass</span>&nbsp;<span class="op" id="4202062">||</span>&nbsp;<span class="ident" id="4202065">t</span><span class="op" id="4202066">.</span><span class="ident" id="4202067">tag</span>&nbsp;<span class="op" id="4202071">!=</span>&nbsp;<span class="ident" id="4202074">expectedTag</span>&nbsp;<span class="op" id="4202086">||</span>&nbsp;<span class="ident" id="4202089">t</span><span class="op" id="4202090">.</span><span class="ident" id="4202091">isCompound</span>&nbsp;<span class="op" id="4202102">!=</span>&nbsp;<span class="ident" id="4202105">compoundType</span>&nbsp;<span class="op" id="4202118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4202122">//&nbsp;Tags&nbsp;don&#39;t&nbsp;match.&nbsp;Again,&nbsp;it&nbsp;could&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4202185">ok</span>&nbsp;<span class="op" id="4202188">:=</span>&nbsp;<span class="ident" id="4202191">setDefaultValue</span><span class="op" id="4202206">(</span><span class="ident" id="4202207">v</span><span class="op" id="4202208">,</span>&nbsp;<span class="ident" id="4202210">params</span><span class="op" id="4202216">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4202220">if</span>&nbsp;<span class="ident" id="4202223">ok</span>&nbsp;<span class="op" id="4202226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4202231">offset</span>&nbsp;<span class="op" id="4202238">=</span>&nbsp;<span class="ident" id="4202240">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4202253">}</span>&nbsp;<span class="keyword" id="4202255">else</span>&nbsp;<span class="op" id="4202260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4202265">err</span>&nbsp;<span class="op" id="4202269">=</span>&nbsp;<span class="ident" id="4202271">StructuralError</span><span class="op" id="4202286">{</span><span class="ident" id="4202287">fmt</span><span class="op" id="4202290">.</span><span class="ident" id="4202291">Sprintf</span><span class="op" id="4202298">(</span><span class="string" id="4202299">&#34;tags&nbsp;don&#39;t&nbsp;match&nbsp;(%d&nbsp;vs&nbsp;%+v)&nbsp;%+v&nbsp;%s&nbsp;@%d&#34;</span><span class="op" id="4202340">,</span>&nbsp;<span class="ident" id="4202342">expectedTag</span><span class="op" id="4202353">,</span>&nbsp;<span class="ident" id="4202355">t</span><span class="op" id="4202356">,</span>&nbsp;<span class="ident" id="4202358">params</span><span class="op" id="4202364">,</span>&nbsp;<span class="ident" id="4202366">fieldType</span><span class="op" id="4202375">.</span><span class="ident" id="4202376">Name</span><span class="op" id="4202380">(</span><span class="op" id="4202381">)</span><span class="op" id="4202382">,</span>&nbsp;<span class="ident" id="4202384">offset</span><span class="op" id="4202390">)</span><span class="op" id="4202391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4202395">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4202399">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4202407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4202410">if</span>&nbsp;<span class="ident" id="4202413">invalidLength</span><span class="op" id="4202426">(</span><span class="ident" id="4202427">offset</span><span class="op" id="4202433">,</span>&nbsp;<span class="ident" id="4202435">t</span><span class="op" id="4202436">.</span><span class="ident" id="4202437">length</span><span class="op" id="4202443">,</span>&nbsp;<span class="builtinfunc" id="4202445">len</span><span class="op" id="4202448">(</span><span class="ident" id="4202449">bytes</span><span class="op" id="4202454">)</span><span class="op" id="4202455">)</span>&nbsp;<span class="op" id="4202457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4202461">err</span>&nbsp;<span class="op" id="4202465">=</span>&nbsp;<span class="ident" id="4202467">SyntaxError</span><span class="op" id="4202478">{</span><span class="string" id="4202479">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4202495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4202499">return</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4202507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4202510">innerBytes</span>&nbsp;<span class="op" id="4202521">:=</span>&nbsp;<span class="ident" id="4202524">bytes</span><span class="op" id="4202529">[</span><span class="ident" id="4202530">offset</span>&nbsp;<span class="op" id="4202537">:</span>&nbsp;<span class="ident" id="4202539">offset</span><span class="op" id="4202545">+</span><span class="ident" id="4202546">t</span><span class="op" id="4202547">.</span><span class="ident" id="4202548">length</span><span class="op" id="4202554">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4202557">offset</span>&nbsp;<span class="op" id="4202564">+=</span>&nbsp;<span class="ident" id="4202567">t</span><span class="op" id="4202568">.</span><span class="ident" id="4202569">length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4202578">//&nbsp;We&nbsp;deal&nbsp;with&nbsp;the&nbsp;structures&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;first.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4202641">switch</span>&nbsp;<span class="ident" id="4202648">fieldType</span>&nbsp;<span class="op" id="4202658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4202661">case</span>&nbsp;<span class="ident" id="4202666">objectIdentifierType</span><span class="op" id="4202686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4202690">newSlice</span><span class="op" id="4202698">,</span>&nbsp;<span class="ident" id="4202700">err1</span>&nbsp;<span class="op" id="4202705">:=</span>&nbsp;<span class="ident" id="4202708">parseObjectIdentifier</span><span class="op" id="4202729">(</span><span class="ident" id="4202730">innerBytes</span><span class="op" id="4202740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4202744">v</span><span class="op" id="4202745">.</span><span class="ident" id="4202746">Set</span><span class="op" id="4202749">(</span><span class="ident" id="4202750">reflect</span><span class="op" id="4202757">.</span><span class="ident" id="4202758">MakeSlice</span><span class="op" id="4202767">(</span><span class="ident" id="4202768">v</span><span class="op" id="4202769">.</span><span class="ident" id="4202770">Type</span><span class="op" id="4202774">(</span><span class="op" id="4202775">)</span><span class="op" id="4202776">,</span>&nbsp;<span class="builtinfunc" id="4202778">len</span><span class="op" id="4202781">(</span><span class="ident" id="4202782">newSlice</span><span class="op" id="4202790">)</span><span class="op" id="4202791">,</span>&nbsp;<span class="builtinfunc" id="4202793">len</span><span class="op" id="4202796">(</span><span class="ident" id="4202797">newSlice</span><span class="op" id="4202805">)</span><span class="op" id="4202806">)</span><span class="op" id="4202807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4202811">if</span>&nbsp;<span class="ident" id="4202814">err1</span>&nbsp;<span class="op" id="4202819">==</span>&nbsp;<span class="ident" id="4202822">nil</span>&nbsp;<span class="op" id="4202826">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4202831">reflect</span><span class="op" id="4202838">.</span><span class="ident" id="4202839">Copy</span><span class="op" id="4202843">(</span><span class="ident" id="4202844">v</span><span class="op" id="4202845">,</span>&nbsp;<span class="ident" id="4202847">reflect</span><span class="op" id="4202854">.</span><span class="ident" id="4202855">ValueOf</span><span class="op" id="4202862">(</span><span class="ident" id="4202863">newSlice</span><span class="op" id="4202871">)</span><span class="op" id="4202872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4202876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4202880">err</span>&nbsp;<span class="op" id="4202884">=</span>&nbsp;<span class="ident" id="4202886">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4202893">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4202901">case</span>&nbsp;<span class="ident" id="4202906">bitStringType</span><span class="op" id="4202919">:</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4202923">bs</span><span class="op" id="4202925">,</span>&nbsp;<span class="ident" id="4202927">err1</span>&nbsp;<span class="op" id="4202932">:=</span>&nbsp;<span class="ident" id="4202935">parseBitString</span><span class="op" id="4202949">(</span><span class="ident" id="4202950">innerBytes</span><span class="op" id="4202960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4202964">if</span>&nbsp;<span class="ident" id="4202967">err1</span>&nbsp;<span class="op" id="4202972">==</span>&nbsp;<span class="ident" id="4202975">nil</span>&nbsp;<span class="op" id="4202979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4202984">v</span><span class="op" id="4202985">.</span><span class="ident" id="4202986">Set</span><span class="op" id="4202989">(</span><span class="ident" id="4202990">reflect</span><span class="op" id="4202997">.</span><span class="ident" id="4202998">ValueOf</span><span class="op" id="4203005">(</span><span class="ident" id="4203006">bs</span><span class="op" id="4203008">)</span><span class="op" id="4203009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4203013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203017">err</span>&nbsp;<span class="op" id="4203021">=</span>&nbsp;<span class="ident" id="4203023">err1</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203030">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203038">case</span>&nbsp;<span class="ident" id="4203043">timeType</span><span class="op" id="4203051">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203055">var</span>&nbsp;<span class="ident" id="4203059">time</span>&nbsp;<span class="ident" id="4203064">time</span><span class="op" id="4203068">.</span><span class="ident" id="4203069">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203076">var</span>&nbsp;<span class="ident" id="4203080">err1</span>&nbsp;<span class="builtintype" id="4203085">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203093">if</span>&nbsp;<span class="ident" id="4203096">universalTag</span>&nbsp;<span class="op" id="4203109">==</span>&nbsp;<span class="ident" id="4203112">tagUTCTime</span>&nbsp;<span class="op" id="4203123">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203128">time</span><span class="op" id="4203132">,</span>&nbsp;<span class="ident" id="4203134">err1</span>&nbsp;<span class="op" id="4203139">=</span>&nbsp;<span class="ident" id="4203141">parseUTCTime</span><span class="op" id="4203153">(</span><span class="ident" id="4203154">innerBytes</span><span class="op" id="4203164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4203168">}</span>&nbsp;<span class="keyword" id="4203170">else</span>&nbsp;<span class="op" id="4203175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203180">time</span><span class="op" id="4203184">,</span>&nbsp;<span class="ident" id="4203186">err1</span>&nbsp;<span class="op" id="4203191">=</span>&nbsp;<span class="ident" id="4203193">parseGeneralizedTime</span><span class="op" id="4203213">(</span><span class="ident" id="4203214">innerBytes</span><span class="op" id="4203224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4203228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203232">if</span>&nbsp;<span class="ident" id="4203235">err1</span>&nbsp;<span class="op" id="4203240">==</span>&nbsp;<span class="ident" id="4203243">nil</span>&nbsp;<span class="op" id="4203247">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203252">v</span><span class="op" id="4203253">.</span><span class="ident" id="4203254">Set</span><span class="op" id="4203257">(</span><span class="ident" id="4203258">reflect</span><span class="op" id="4203265">.</span><span class="ident" id="4203266">ValueOf</span><span class="op" id="4203273">(</span><span class="ident" id="4203274">time</span><span class="op" id="4203278">)</span><span class="op" id="4203279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4203283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203287">err</span>&nbsp;<span class="op" id="4203291">=</span>&nbsp;<span class="ident" id="4203293">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203300">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203308">case</span>&nbsp;<span class="ident" id="4203313">enumeratedType</span><span class="op" id="4203327">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203331">parsedInt</span><span class="op" id="4203340">,</span>&nbsp;<span class="ident" id="4203342">err1</span>&nbsp;<span class="op" id="4203347">:=</span>&nbsp;<span class="ident" id="4203350">parseInt32</span><span class="op" id="4203360">(</span><span class="ident" id="4203361">innerBytes</span><span class="op" id="4203371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203375">if</span>&nbsp;<span class="ident" id="4203378">err1</span>&nbsp;<span class="op" id="4203383">==</span>&nbsp;<span class="ident" id="4203386">nil</span>&nbsp;<span class="op" id="4203390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203395">v</span><span class="op" id="4203396">.</span><span class="ident" id="4203397">SetInt</span><span class="op" id="4203403">(</span><span class="ident" id="4203404">int64</span><span class="op" id="4203409">(</span><span class="ident" id="4203410">parsedInt</span><span class="op" id="4203419">)</span><span class="op" id="4203420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4203424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203428">err</span>&nbsp;<span class="op" id="4203432">=</span>&nbsp;<span class="ident" id="4203434">err1</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203441">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203449">case</span>&nbsp;<span class="ident" id="4203454">flagType</span><span class="op" id="4203462">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203466">v</span><span class="op" id="4203467">.</span><span class="ident" id="4203468">SetBool</span><span class="op" id="4203475">(</span><span class="builtintype" id="4203476">true</span><span class="op" id="4203480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203484">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203492">case</span>&nbsp;<span class="ident" id="4203497">bigIntType</span><span class="op" id="4203507">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203511">parsedInt</span>&nbsp;<span class="op" id="4203521">:=</span>&nbsp;<span class="ident" id="4203524">parseBigInt</span><span class="op" id="4203535">(</span><span class="ident" id="4203536">innerBytes</span><span class="op" id="4203546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203550">v</span><span class="op" id="4203551">.</span><span class="ident" id="4203552">Set</span><span class="op" id="4203555">(</span><span class="ident" id="4203556">reflect</span><span class="op" id="4203563">.</span><span class="ident" id="4203564">ValueOf</span><span class="op" id="4203571">(</span><span class="ident" id="4203572">parsedInt</span><span class="op" id="4203581">)</span><span class="op" id="4203582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203586">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4203594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203597">switch</span>&nbsp;<span class="ident" id="4203604">val</span>&nbsp;<span class="op" id="4203608">:=</span>&nbsp;<span class="ident" id="4203611">v</span><span class="op" id="4203612">;</span>&nbsp;<span class="ident" id="4203614">val</span><span class="op" id="4203617">.</span><span class="ident" id="4203618">Kind</span><span class="op" id="4203622">(</span><span class="op" id="4203623">)</span>&nbsp;<span class="op" id="4203625">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203628">case</span>&nbsp;<span class="ident" id="4203633">reflect</span><span class="op" id="4203640">.</span><span class="ident" id="4203641">Bool</span><span class="op" id="4203645">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203649">parsedBool</span><span class="op" id="4203659">,</span>&nbsp;<span class="ident" id="4203661">err1</span>&nbsp;<span class="op" id="4203666">:=</span>&nbsp;<span class="ident" id="4203669">parseBool</span><span class="op" id="4203678">(</span><span class="ident" id="4203679">innerBytes</span><span class="op" id="4203689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203693">if</span>&nbsp;<span class="ident" id="4203696">err1</span>&nbsp;<span class="op" id="4203701">==</span>&nbsp;<span class="ident" id="4203704">nil</span>&nbsp;<span class="op" id="4203708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203713">val</span><span class="op" id="4203716">.</span><span class="ident" id="4203717">SetBool</span><span class="op" id="4203724">(</span><span class="ident" id="4203725">parsedBool</span><span class="op" id="4203735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4203739">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203743">err</span>&nbsp;<span class="op" id="4203747">=</span>&nbsp;<span class="ident" id="4203749">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203756">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203764">case</span>&nbsp;<span class="ident" id="4203769">reflect</span><span class="op" id="4203776">.</span><span class="ident" id="4203777">Int</span><span class="op" id="4203780">,</span>&nbsp;<span class="ident" id="4203782">reflect</span><span class="op" id="4203789">.</span><span class="ident" id="4203790">Int32</span><span class="op" id="4203795">,</span>&nbsp;<span class="ident" id="4203797">reflect</span><span class="op" id="4203804">.</span><span class="ident" id="4203805">Int64</span><span class="op" id="4203810">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203814">if</span>&nbsp;<span class="ident" id="4203817">val</span><span class="op" id="4203820">.</span><span class="ident" id="4203821">Type</span><span class="op" id="4203825">(</span><span class="op" id="4203826">)</span><span class="op" id="4203827">.</span><span class="ident" id="4203828">Size</span><span class="op" id="4203832">(</span><span class="op" id="4203833">)</span>&nbsp;<span class="op" id="4203835">==</span>&nbsp;<span class="num" id="4203838">4</span>&nbsp;<span class="op" id="4203840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203845">parsedInt</span><span class="op" id="4203854">,</span>&nbsp;<span class="ident" id="4203856">err1</span>&nbsp;<span class="op" id="4203861">:=</span>&nbsp;<span class="ident" id="4203864">parseInt32</span><span class="op" id="4203874">(</span><span class="ident" id="4203875">innerBytes</span><span class="op" id="4203885">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4203890">if</span>&nbsp;<span class="ident" id="4203893">err1</span>&nbsp;<span class="op" id="4203898">==</span>&nbsp;<span class="ident" id="4203901">nil</span>&nbsp;<span class="op" id="4203905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203911">val</span><span class="op" id="4203914">.</span><span class="ident" id="4203915">SetInt</span><span class="op" id="4203921">(</span><span class="ident" id="4203922">int64</span><span class="op" id="4203927">(</span><span class="ident" id="4203928">parsedInt</span><span class="op" id="4203937">)</span><span class="op" id="4203938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4203943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203948">err</span>&nbsp;<span class="op" id="4203952">=</span>&nbsp;<span class="ident" id="4203954">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4203961">}</span>&nbsp;<span class="keyword" id="4203963">else</span>&nbsp;<span class="op" id="4203968">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4203973">parsedInt</span><span class="op" id="4203982">,</span>&nbsp;<span class="ident" id="4203984">err1</span>&nbsp;<span class="op" id="4203989">:=</span>&nbsp;<span class="ident" id="4203992">parseInt64</span><span class="op" id="4204002">(</span><span class="ident" id="4204003">innerBytes</span><span class="op" id="4204013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4204018">if</span>&nbsp;<span class="ident" id="4204021">err1</span>&nbsp;<span class="op" id="4204026">==</span>&nbsp;<span class="ident" id="4204029">nil</span>&nbsp;<span class="op" id="4204033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4204039">val</span><span class="op" id="4204042">.</span><span class="ident" id="4204043">SetInt</span><span class="op" id="4204049">(</span><span class="ident" id="4204050">parsedInt</span><span class="op" id="4204059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4204064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4204069">err</span>&nbsp;<span class="op" id="4204073">=</span>&nbsp;<span class="ident" id="4204075">err1</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4204082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4204086">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4204094">//&nbsp;TODO(dfc)&nbsp;Add&nbsp;support&nbsp;for&nbsp;the&nbsp;remaining&nbsp;integer&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4204152">case</span>&nbsp;<span class="ident" id="4204157">reflect</span><span class="op" id="4204164">.</span><span class="ident" id="4204165">Struct</span><span class="op" id="4204171">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4204175">structType</span>&nbsp;<span class="op" id="4204186">:=</span>&nbsp;<span class="ident" id="4204189">fieldType</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4204202">if</span>&nbsp;<span class="ident" id="4204205">structType</span><span class="op" id="4204215">.</span><span class="ident" id="4204216">NumField</span><span class="op" id="4204224">(</span><span class="op" id="4204225">)</span>&nbsp;<span class="op" id="4204227">&gt;</span>&nbsp;<span class="num" id="4204229">0</span>&nbsp;<span class="op" id="4204231">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4204237">structType</span><span class="op" id="4204247">.</span><span class="ident" id="4204248">Field</span><span class="op" id="4204253">(</span><span class="num" id="4204254">0</span><span class="op" id="4204255">)</span><span class="op" id="4204256">.</span><span class="ident" id="4204257">Type</span>&nbsp;<span class="op" id="4204262">==</span>&nbsp;<span class="ident" id="4204265">rawContentsType</span>&nbsp;<span class="op" id="4204281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4204286">bytes</span>&nbsp;<span class="op" id="4204292">:=</span>&nbsp;<span class="ident" id="4204295">bytes</span><span class="op" id="4204300">[</span><span class="ident" id="4204301">initOffset</span><span class="op" id="4204311">:</span><span class="ident" id="4204312">offset</span><span class="op" id="4204318">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4204323">val</span><span class="op" id="4204326">.</span><span class="ident" id="4204327">Field</span><span class="op" id="4204332">(</span><span class="num" id="4204333">0</span><span class="op" id="4204334">)</span><span class="op" id="4204335">.</span><span class="ident" id="4204336">Set</span><span class="op" id="4204339">(</span><span class="ident" id="4204340">reflect</span><span class="op" id="4204347">.</span><span class="ident" id="4204348">ValueOf</span><span class="op" id="4204355">(</span><span class="ident" id="4204356">RawContent</span><span class="op" id="4204366">(</span><span class="ident" id="4204367">bytes</span><span class="op" id="4204372">)</span><span class="op" id="4204373">)</span><span class="op" id="4204374">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4204378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4204383">innerOffset</span>&nbsp;<span class="op" id="4204395">:=</span>&nbsp;<span class="num" id="4204398">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4204402">for</span>&nbsp;<span class="ident" id="4204406">i</span>&nbsp;<span class="op" id="4204408">:=</span>&nbsp;<span class="num" id="4204411">0</span><span class="op" id="4204412">;</span>&nbsp;<span class="ident" id="4204414">i</span>&nbsp;<span class="op" id="4204416">&lt;</span>&nbsp;<span class="ident" id="4204418">structType</span><span class="op" id="4204428">.</span><span class="ident" id="4204429">NumField</span><span class="op" id="4204437">(</span><span class="op" id="4204438">)</span><span class="op" id="4204439">;</span>&nbsp;<span class="ident" id="4204441">i</span><span class="op" id="4204442">++</span>&nbsp;<span class="op" id="4204445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4204450">field</span>&nbsp;<span class="op" id="4204456">:=</span>&nbsp;<span class="ident" id="4204459">structType</span><span class="op" id="4204469">.</span><span class="ident" id="4204470">Field</span><span class="op" id="4204475">(</span><span class="ident" id="4204476">i</span><span class="op" id="4204477">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4204482">if</span>&nbsp;<span class="ident" id="4204485">i</span>&nbsp;<span class="op" id="4204487">==</span>&nbsp;<span class="num" id="4204490">0</span>&nbsp;<span class="op" id="4204492">&amp;&amp;</span>&nbsp;<span class="ident" id="4204495">field</span><span class="op" id="4204500">.</span><span class="ident" id="4204501">Type</span>&nbsp;<span class="op" id="4204506">==</span>&nbsp;<span class="ident" id="4204509">rawContentsType</span>&nbsp;<span class="op" id="4204525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4204531">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4204543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4204548">innerOffset</span><span class="op" id="4204559">,</span>&nbsp;<span class="ident" id="4204561">err</span>&nbsp;<span class="op" id="4204565">=</span>&nbsp;<span class="ident" id="4204567">parseField</span><span class="op" id="4204577">(</span><span class="ident" id="4204578">val</span><span class="op" id="4204581">.</span><span class="ident" id="4204582">Field</span><span class="op" id="4204587">(</span><span class="ident" id="4204588">i</span><span class="op" id="4204589">)</span><span class="op" id="4204590">,</span>&nbsp;<span class="ident" id="4204592">innerBytes</span><span class="op" id="4204602">,</span>&nbsp;<span class="ident" id="4204604">innerOffset</span><span class="op" id="4204615">,</span>&nbsp;<span class="ident" id="4204617">parseFieldParameters</span><span class="op" id="4204637">(</span><span class="ident" id="4204638">field</span><span class="op" id="4204643">.</span><span class="ident" id="4204644">Tag</span><span class="op" id="4204647">.</span><span class="ident" id="4204648">Get</span><span class="op" id="4204651">(</span><span class="string" id="4204652">&#34;asn1&#34;</span><span class="op" id="4204658">)</span><span class="op" id="4204659">)</span><span class="op" id="4204660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4204665">if</span>&nbsp;<span class="ident" id="4204668">err</span>&nbsp;<span class="op" id="4204672">!=</span>&nbsp;<span class="ident" id="4204675">nil</span>&nbsp;<span class="op" id="4204679">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4204685">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4204695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4204699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4204703">//&nbsp;We&nbsp;allow&nbsp;extra&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;SEQUENCE&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4204764">//&nbsp;adding&nbsp;elements&nbsp;to&nbsp;the&nbsp;end&nbsp;has&nbsp;been&nbsp;used&nbsp;in&nbsp;X.509&nbsp;as&nbsp;the</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4204826">//&nbsp;version&nbsp;numbers&nbsp;have&nbsp;increased.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4204863">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4204871">case</span>&nbsp;<span class="ident" id="4204876">reflect</span><span class="op" id="4204883">.</span><span class="ident" id="4204884">Slice</span><span class="op" id="4204889">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4204893">sliceType</span>&nbsp;<span class="op" id="4204903">:=</span>&nbsp;<span class="ident" id="4204906">fieldType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4204918">if</span>&nbsp;<span class="ident" id="4204921">sliceType</span><span class="op" id="4204930">.</span><span class="ident" id="4204931">Elem</span><span class="op" id="4204935">(</span><span class="op" id="4204936">)</span><span class="op" id="4204937">.</span><span class="ident" id="4204938">Kind</span><span class="op" id="4204942">(</span><span class="op" id="4204943">)</span>&nbsp;<span class="op" id="4204945">==</span>&nbsp;<span class="ident" id="4204948">reflect</span><span class="op" id="4204955">.</span><span class="ident" id="4204956">Uint8</span>&nbsp;<span class="op" id="4204962">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4204967">val</span><span class="op" id="4204970">.</span><span class="ident" id="4204971">Set</span><span class="op" id="4204974">(</span><span class="ident" id="4204975">reflect</span><span class="op" id="4204982">.</span><span class="ident" id="4204983">MakeSlice</span><span class="op" id="4204992">(</span><span class="ident" id="4204993">sliceType</span><span class="op" id="4205002">,</span>&nbsp;<span class="builtinfunc" id="4205004">len</span><span class="op" id="4205007">(</span><span class="ident" id="4205008">innerBytes</span><span class="op" id="4205018">)</span><span class="op" id="4205019">,</span>&nbsp;<span class="builtinfunc" id="4205021">len</span><span class="op" id="4205024">(</span><span class="ident" id="4205025">innerBytes</span><span class="op" id="4205035">)</span><span class="op" id="4205036">)</span><span class="op" id="4205037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4205042">reflect</span><span class="op" id="4205049">.</span><span class="ident" id="4205050">Copy</span><span class="op" id="4205054">(</span><span class="ident" id="4205055">val</span><span class="op" id="4205058">,</span>&nbsp;<span class="ident" id="4205060">reflect</span><span class="op" id="4205067">.</span><span class="ident" id="4205068">ValueOf</span><span class="op" id="4205075">(</span><span class="ident" id="4205076">innerBytes</span><span class="op" id="4205086">)</span><span class="op" id="4205087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4205092">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4205101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4205105">newSlice</span><span class="op" id="4205113">,</span>&nbsp;<span class="ident" id="4205115">err1</span>&nbsp;<span class="op" id="4205120">:=</span>&nbsp;<span class="ident" id="4205123">parseSequenceOf</span><span class="op" id="4205138">(</span><span class="ident" id="4205139">innerBytes</span><span class="op" id="4205149">,</span>&nbsp;<span class="ident" id="4205151">sliceType</span><span class="op" id="4205160">,</span>&nbsp;<span class="ident" id="4205162">sliceType</span><span class="op" id="4205171">.</span><span class="ident" id="4205172">Elem</span><span class="op" id="4205176">(</span><span class="op" id="4205177">)</span><span class="op" id="4205178">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4205182">if</span>&nbsp;<span class="ident" id="4205185">err1</span>&nbsp;<span class="op" id="4205190">==</span>&nbsp;<span class="ident" id="4205193">nil</span>&nbsp;<span class="op" id="4205197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4205202">val</span><span class="op" id="4205205">.</span><span class="ident" id="4205206">Set</span><span class="op" id="4205209">(</span><span class="ident" id="4205210">newSlice</span><span class="op" id="4205218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4205222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4205226">err</span>&nbsp;<span class="op" id="4205230">=</span>&nbsp;<span class="ident" id="4205232">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4205239">return</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4205247">case</span>&nbsp;<span class="ident" id="4205252">reflect</span><span class="op" id="4205259">.</span><span class="ident" id="4205260">String</span><span class="op" id="4205266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4205270">var</span>&nbsp;<span class="ident" id="4205274">v</span>&nbsp;<span class="builtintype" id="4205276">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4205285">switch</span>&nbsp;<span class="ident" id="4205292">universalTag</span>&nbsp;<span class="op" id="4205305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4205309">case</span>&nbsp;<span class="ident" id="4205314">tagPrintableString</span><span class="op" id="4205332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4205337">v</span><span class="op" id="4205338">,</span>&nbsp;<span class="ident" id="4205340">err</span>&nbsp;<span class="op" id="4205344">=</span>&nbsp;<span class="ident" id="4205346">parsePrintableString</span><span class="op" id="4205366">(</span><span class="ident" id="4205367">innerBytes</span><span class="op" id="4205377">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4205381">case</span>&nbsp;<span class="ident" id="4205386">tagIA5String</span><span class="op" id="4205398">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4205403">v</span><span class="op" id="4205404">,</span>&nbsp;<span class="ident" id="4205406">err</span>&nbsp;<span class="op" id="4205410">=</span>&nbsp;<span class="ident" id="4205412">parseIA5String</span><span class="op" id="4205426">(</span><span class="ident" id="4205427">innerBytes</span><span class="op" id="4205437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4205441">case</span>&nbsp;<span class="ident" id="4205446">tagT61String</span><span class="op" id="4205458">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4205463">v</span><span class="op" id="4205464">,</span>&nbsp;<span class="ident" id="4205466">err</span>&nbsp;<span class="op" id="4205470">=</span>&nbsp;<span class="ident" id="4205472">parseT61String</span><span class="op" id="4205486">(</span><span class="ident" id="4205487">innerBytes</span><span class="op" id="4205497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4205501">case</span>&nbsp;<span class="ident" id="4205506">tagUTF8String</span><span class="op" id="4205519">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4205524">v</span><span class="op" id="4205525">,</span>&nbsp;<span class="ident" id="4205527">err</span>&nbsp;<span class="op" id="4205531">=</span>&nbsp;<span class="ident" id="4205533">parseUTF8String</span><span class="op" id="4205548">(</span><span class="ident" id="4205549">innerBytes</span><span class="op" id="4205559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4205563">case</span>&nbsp;<span class="ident" id="4205568">tagGeneralString</span><span class="op" id="4205584">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4205589">//&nbsp;GeneralString&nbsp;is&nbsp;specified&nbsp;in&nbsp;ISO-2022/ECMA-35,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4205643">//&nbsp;A&nbsp;brief&nbsp;review&nbsp;suggests&nbsp;that&nbsp;it&nbsp;includes&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4205701">//&nbsp;that&nbsp;allow&nbsp;the&nbsp;encoding&nbsp;to&nbsp;change&nbsp;midstring&nbsp;and</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4205755">//&nbsp;such.&nbsp;We&nbsp;give&nbsp;up&nbsp;and&nbsp;pass&nbsp;it&nbsp;as&nbsp;an&nbsp;8-bit&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4205810">v</span><span class="op" id="4205811">,</span>&nbsp;<span class="ident" id="4205813">err</span>&nbsp;<span class="op" id="4205817">=</span>&nbsp;<span class="ident" id="4205819">parseT61String</span><span class="op" id="4205833">(</span><span class="ident" id="4205834">innerBytes</span><span class="op" id="4205844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4205848">default</span><span class="op" id="4205855">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4205860">err</span>&nbsp;<span class="op" id="4205864">=</span>&nbsp;<span class="ident" id="4205866">SyntaxError</span><span class="op" id="4205877">{</span><span class="ident" id="4205878">fmt</span><span class="op" id="4205881">.</span><span class="ident" id="4205882">Sprintf</span><span class="op" id="4205889">(</span><span class="string" id="4205890">&#34;internal&nbsp;error:&nbsp;unknown&nbsp;string&nbsp;type&nbsp;%d&#34;</span><span class="op" id="4205930">,</span>&nbsp;<span class="ident" id="4205932">universalTag</span><span class="op" id="4205944">)</span><span class="op" id="4205945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4205949">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4205953">if</span>&nbsp;<span class="ident" id="4205956">err</span>&nbsp;<span class="op" id="4205960">==</span>&nbsp;<span class="ident" id="4205963">nil</span>&nbsp;<span class="op" id="4205967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4205972">val</span><span class="op" id="4205975">.</span><span class="ident" id="4205976">SetString</span><span class="op" id="4205985">(</span><span class="ident" id="4205986">v</span><span class="op" id="4205987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4205991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4205995">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4206003">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4206006">err</span>&nbsp;<span class="op" id="4206010">=</span>&nbsp;<span class="ident" id="4206012">StructuralError</span><span class="op" id="4206027">{</span><span class="string" id="4206028">&#34;unsupported:&nbsp;&#34;</span>&nbsp;<span class="op" id="4206044">+</span>&nbsp;<span class="ident" id="4206046">v</span><span class="op" id="4206047">.</span><span class="ident" id="4206048">Type</span><span class="op" id="4206052">(</span><span class="op" id="4206053">)</span><span class="op" id="4206054">.</span><span class="ident" id="4206055">String</span><span class="op" id="4206061">(</span><span class="op" id="4206062">)</span><span class="op" id="4206063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4206066">return</span><br>
<span class="lineno"></span><span class="op" id="4206073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4206076">//&nbsp;canHaveDefaultValue&nbsp;reports&nbsp;whether&nbsp;k&nbsp;is&nbsp;a&nbsp;Kind&nbsp;that&nbsp;we&nbsp;will&nbsp;set&nbsp;a&nbsp;default</span><br>
<span class="lineno">830</span><span class="comment" id="4206154">//&nbsp;value&nbsp;for.&nbsp;(A&nbsp;signed&nbsp;integer,&nbsp;essentially.)</span><br>
<span class="lineno"></span><span class="keyword" id="4206201">func</span>&nbsp;<span class="ident" id="4206206">canHaveDefaultValue</span><span class="op" id="4206225">(</span><span class="ident" id="4206226">k</span>&nbsp;<span class="ident" id="4206228">reflect</span><span class="op" id="4206235">.</span><span class="ident" id="4206236">Kind</span><span class="op" id="4206240">)</span>&nbsp;<span class="builtintype" id="4206242">bool</span>&nbsp;<span class="op" id="4206247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4206250">switch</span>&nbsp;<span class="ident" id="4206257">k</span>&nbsp;<span class="op" id="4206259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4206262">case</span>&nbsp;<span class="ident" id="4206267">reflect</span><span class="op" id="4206274">.</span><span class="ident" id="4206275">Int</span><span class="op" id="4206278">,</span>&nbsp;<span class="ident" id="4206280">reflect</span><span class="op" id="4206287">.</span><span class="ident" id="4206288">Int8</span><span class="op" id="4206292">,</span>&nbsp;<span class="ident" id="4206294">reflect</span><span class="op" id="4206301">.</span><span class="ident" id="4206302">Int16</span><span class="op" id="4206307">,</span>&nbsp;<span class="ident" id="4206309">reflect</span><span class="op" id="4206316">.</span><span class="ident" id="4206317">Int32</span><span class="op" id="4206322">,</span>&nbsp;<span class="ident" id="4206324">reflect</span><span class="op" id="4206331">.</span><span class="ident" id="4206332">Int64</span><span class="op" id="4206337">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4206341">return</span>&nbsp;<span class="builtintype" id="4206348">true</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4206354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4206358">return</span>&nbsp;<span class="builtintype" id="4206365">false</span><br>
<span class="lineno"></span><span class="op" id="4206371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="4206374">//&nbsp;setDefaultValue&nbsp;is&nbsp;used&nbsp;to&nbsp;install&nbsp;a&nbsp;default&nbsp;value,&nbsp;from&nbsp;a&nbsp;tag&nbsp;string,&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="4206453">//&nbsp;a&nbsp;Value.&nbsp;It&nbsp;is&nbsp;successful&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;optional,&nbsp;even&nbsp;if&nbsp;a&nbsp;default&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4206533">//&nbsp;wasn&#39;t&nbsp;provided&nbsp;or&nbsp;it&nbsp;failed&nbsp;to&nbsp;install&nbsp;it&nbsp;into&nbsp;the&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4206595">func</span>&nbsp;<span class="ident" id="4206600">setDefaultValue</span><span class="op" id="4206615">(</span><span class="ident" id="4206616">v</span>&nbsp;<span class="ident" id="4206618">reflect</span><span class="op" id="4206625">.</span><span class="ident" id="4206626">Value</span><span class="op" id="4206631">,</span>&nbsp;<span class="ident" id="4206633">params</span>&nbsp;<span class="ident" id="4206640">fieldParameters</span><span class="op" id="4206655">)</span>&nbsp;<span class="op" id="4206657">(</span><span class="ident" id="4206658">ok</span>&nbsp;<span class="builtintype" id="4206661">bool</span><span class="op" id="4206665">)</span>&nbsp;<span class="op" id="4206667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4206670">if</span>&nbsp;<span class="op" id="4206673">!</span><span class="ident" id="4206674">params</span><span class="op" id="4206680">.</span><span class="ident" id="4206681">optional</span>&nbsp;<span class="op" id="4206690">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4206694">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4206702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4206705">ok</span>&nbsp;<span class="op" id="4206708">=</span>&nbsp;<span class="builtintype" id="4206710">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4206716">if</span>&nbsp;<span class="ident" id="4206719">params</span><span class="op" id="4206725">.</span><span class="ident" id="4206726">defaultValue</span>&nbsp;<span class="op" id="4206739">==</span>&nbsp;<span class="ident" id="4206742">nil</span>&nbsp;<span class="op" id="4206746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4206750">return</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4206758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4206761">if</span>&nbsp;<span class="ident" id="4206764">canHaveDefaultValue</span><span class="op" id="4206783">(</span><span class="ident" id="4206784">v</span><span class="op" id="4206785">.</span><span class="ident" id="4206786">Kind</span><span class="op" id="4206790">(</span><span class="op" id="4206791">)</span><span class="op" id="4206792">)</span>&nbsp;<span class="op" id="4206794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4206798">v</span><span class="op" id="4206799">.</span><span class="ident" id="4206800">SetInt</span><span class="op" id="4206806">(</span><span class="op" id="4206807">*</span><span class="ident" id="4206808">params</span><span class="op" id="4206814">.</span><span class="ident" id="4206815">defaultValue</span><span class="op" id="4206827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4206830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4206833">return</span><br>
<span class="lineno">855</span><span class="op" id="4206840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4206843">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structure&nbsp;b</span><br>
<span class="lineno"></span><span class="comment" id="4206902">//&nbsp;and&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package&nbsp;to&nbsp;fill&nbsp;in&nbsp;an&nbsp;arbitrary&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="4206983">//&nbsp;Because&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package,&nbsp;the&nbsp;structs</span><br>
<span class="lineno">860</span><span class="comment" id="4207042">//&nbsp;being&nbsp;written&nbsp;to&nbsp;must&nbsp;use&nbsp;upper&nbsp;case&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="4207095">//</span><br>
<span class="lineno"></span><span class="comment" id="4207098">//&nbsp;An&nbsp;ASN.1&nbsp;INTEGER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;int,&nbsp;int32,&nbsp;int64,</span><br>
<span class="lineno"></span><span class="comment" id="4207158">//&nbsp;or&nbsp;*big.Int&nbsp;(from&nbsp;the&nbsp;math/big&nbsp;package).</span><br>
<span class="lineno"></span><span class="comment" id="4207202">//&nbsp;If&nbsp;the&nbsp;encoded&nbsp;value&nbsp;does&nbsp;not&nbsp;fit&nbsp;in&nbsp;the&nbsp;Go&nbsp;type,</span><br>
<span class="lineno">865</span><span class="comment" id="4207255">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4207291">//</span><br>
<span class="lineno"></span><span class="comment" id="4207294">//&nbsp;An&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="comment" id="4207348">//</span><br>
<span class="lineno"></span><span class="comment" id="4207351">//&nbsp;An&nbsp;ASN.1&nbsp;OCTET&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;[]byte.</span><br>
<span class="lineno">870</span><span class="comment" id="4207404">//</span><br>
<span class="lineno"></span><span class="comment" id="4207407">//&nbsp;An&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4207458">//&nbsp;ObjectIdentifier.</span><br>
<span class="lineno"></span><span class="comment" id="4207479">//</span><br>
<span class="lineno"></span><span class="comment" id="4207482">//&nbsp;An&nbsp;ASN.1&nbsp;ENUMERATED&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;Enumerated.</span><br>
<span class="lineno">875</span><span class="comment" id="4207538">//</span><br>
<span class="lineno"></span><span class="comment" id="4207541">//&nbsp;An&nbsp;ASN.1&nbsp;UTCTIME&nbsp;or&nbsp;GENERALIZEDTIME&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="4207611">//</span><br>
<span class="lineno"></span><span class="comment" id="4207614">//&nbsp;An&nbsp;ASN.1&nbsp;PrintableString&nbsp;or&nbsp;IA5String&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="4207683">//</span><br>
<span class="lineno">880</span><span class="comment" id="4207686">//&nbsp;Any&nbsp;of&nbsp;the&nbsp;above&nbsp;ASN.1&nbsp;values&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="4207753">//&nbsp;The&nbsp;value&nbsp;stored&nbsp;in&nbsp;the&nbsp;interface&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4207821">//&nbsp;For&nbsp;integers,&nbsp;that&nbsp;type&nbsp;is&nbsp;int64.</span><br>
<span class="lineno"></span><span class="comment" id="4207858">//</span><br>
<span class="lineno"></span><span class="comment" id="4207861">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;OF&nbsp;x&nbsp;or&nbsp;SET&nbsp;OF&nbsp;x&nbsp;can&nbsp;be&nbsp;written</span><br>
<span class="lineno">885</span><span class="comment" id="4207914">//&nbsp;to&nbsp;a&nbsp;slice&nbsp;if&nbsp;an&nbsp;x&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;slice&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4207980">//</span><br>
<span class="lineno"></span><span class="comment" id="4207983">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;or&nbsp;SET&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="4208038">//&nbsp;if&nbsp;each&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;sequence&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4208088">//&nbsp;written&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;element&nbsp;in&nbsp;the&nbsp;struct.</span><br>
<span class="lineno">890</span><span class="comment" id="4208143">//</span><br>
<span class="lineno"></span><span class="comment" id="4208146">//&nbsp;The&nbsp;following&nbsp;tags&nbsp;on&nbsp;struct&nbsp;fields&nbsp;have&nbsp;special&nbsp;meaning&nbsp;to&nbsp;Unmarshal:</span><br>
<span class="lineno"></span><span class="comment" id="4208220">//</span><br>
<span class="lineno"></span><span class="comment" id="4208223">//&nbsp;&nbsp;&nbsp;&nbsp;application&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;that&nbsp;a&nbsp;APPLICATION&nbsp;tag&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="4208279">//&nbsp;&nbsp;&nbsp;&nbsp;default:x&nbsp;&nbsp;&nbsp;&nbsp;sets&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;optional&nbsp;integer&nbsp;fields</span><br>
<span class="lineno">895</span><span class="comment" id="4208343">//&nbsp;&nbsp;&nbsp;&nbsp;explicit&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;that&nbsp;an&nbsp;additional,&nbsp;explicit&nbsp;tag&nbsp;wraps&nbsp;the&nbsp;implicit&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4208421">//&nbsp;&nbsp;&nbsp;&nbsp;optional&nbsp;&nbsp;&nbsp;&nbsp;marks&nbsp;the&nbsp;field&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL</span><br>
<span class="lineno"></span><span class="comment" id="4208467">//&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;causes&nbsp;a&nbsp;SET,&nbsp;rather&nbsp;than&nbsp;a&nbsp;SEQUENCE&nbsp;type&nbsp;to&nbsp;be&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="4208532">//&nbsp;&nbsp;&nbsp;&nbsp;tag:x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;the&nbsp;ASN.1&nbsp;tag&nbsp;number;&nbsp;implies&nbsp;ASN.1&nbsp;CONTEXT&nbsp;SPECIFIC</span><br>
<span class="lineno"></span><span class="comment" id="4208605">//</span><br>
<span class="lineno">900</span><span class="comment" id="4208608">//&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;a&nbsp;structure&nbsp;is&nbsp;RawContent&nbsp;then&nbsp;the&nbsp;raw</span><br>
<span class="lineno"></span><span class="comment" id="4208684">//&nbsp;ASN1&nbsp;contents&nbsp;of&nbsp;the&nbsp;struct&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4208737">//</span><br>
<span class="lineno"></span><span class="comment" id="4208740">//&nbsp;If&nbsp;the&nbsp;type&nbsp;name&nbsp;of&nbsp;a&nbsp;slice&nbsp;element&nbsp;ends&nbsp;with&nbsp;&#34;SET&#34;&nbsp;then&nbsp;it&#39;s&nbsp;treated&nbsp;as&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="4208819">//&nbsp;the&nbsp;&#34;set&#34;&nbsp;tag&nbsp;was&nbsp;set&nbsp;on&nbsp;it.&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;with&nbsp;nested&nbsp;slices&nbsp;where&nbsp;a</span><br>
<span class="lineno">905</span><span class="comment" id="4208895">//&nbsp;struct&nbsp;tag&nbsp;cannot&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="comment" id="4208926">//</span><br>
<span class="lineno"></span><span class="comment" id="4208929">//&nbsp;Other&nbsp;ASN.1&nbsp;types&nbsp;are&nbsp;not&nbsp;supported;&nbsp;if&nbsp;it&nbsp;encounters&nbsp;them,</span><br>
<span class="lineno"></span><span class="comment" id="4208992">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4209028">func</span>&nbsp;<span class="ident" id="4209033">Unmarshal</span><span class="op" id="4209042">(</span><span class="ident" id="4209043">b</span>&nbsp;<span class="op" id="4209045">[</span><span class="op" id="4209046">]</span><span class="builtintype" id="4209047">byte</span><span class="op" id="4209051">,</span>&nbsp;<span class="ident" id="4209053">val</span>&nbsp;<span class="keyword" id="4209057">interface</span><span class="op" id="4209066">{</span><span class="op" id="4209067">}</span><span class="op" id="4209068">)</span>&nbsp;<span class="op" id="4209070">(</span><span class="ident" id="4209071">rest</span>&nbsp;<span class="op" id="4209076">[</span><span class="op" id="4209077">]</span><span class="builtintype" id="4209078">byte</span><span class="op" id="4209082">,</span>&nbsp;<span class="ident" id="4209084">err</span>&nbsp;<span class="builtintype" id="4209088">error</span><span class="op" id="4209093">)</span>&nbsp;<span class="op" id="4209095">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4209098">return</span>&nbsp;<span class="ident" id="4209105">UnmarshalWithParams</span><span class="op" id="4209124">(</span><span class="ident" id="4209125">b</span><span class="op" id="4209126">,</span>&nbsp;<span class="ident" id="4209128">val</span><span class="op" id="4209131">,</span>&nbsp;<span class="string" id="4209133">&#34;&#34;</span><span class="op" id="4209135">)</span><br>
<span class="lineno"></span><span class="op" id="4209137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4209140">//&nbsp;UnmarshalWithParams&nbsp;allows&nbsp;field&nbsp;parameters&nbsp;to&nbsp;be&nbsp;specified&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4209211">//&nbsp;top-level&nbsp;element.&nbsp;The&nbsp;form&nbsp;of&nbsp;the&nbsp;params&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;field&nbsp;tags.</span><br>
<span class="lineno">915</span><span class="keyword" id="4209287">func</span>&nbsp;<span class="ident" id="4209292">UnmarshalWithParams</span><span class="op" id="4209311">(</span><span class="ident" id="4209312">b</span>&nbsp;<span class="op" id="4209314">[</span><span class="op" id="4209315">]</span><span class="builtintype" id="4209316">byte</span><span class="op" id="4209320">,</span>&nbsp;<span class="ident" id="4209322">val</span>&nbsp;<span class="keyword" id="4209326">interface</span><span class="op" id="4209335">{</span><span class="op" id="4209336">}</span><span class="op" id="4209337">,</span>&nbsp;<span class="ident" id="4209339">params</span>&nbsp;<span class="builtintype" id="4209346">string</span><span class="op" id="4209352">)</span>&nbsp;<span class="op" id="4209354">(</span><span class="ident" id="4209355">rest</span>&nbsp;<span class="op" id="4209360">[</span><span class="op" id="4209361">]</span><span class="builtintype" id="4209362">byte</span><span class="op" id="4209366">,</span>&nbsp;<span class="ident" id="4209368">err</span>&nbsp;<span class="builtintype" id="4209372">error</span><span class="op" id="4209377">)</span>&nbsp;<span class="op" id="4209379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4209382">v</span>&nbsp;<span class="op" id="4209384">:=</span>&nbsp;<span class="ident" id="4209387">reflect</span><span class="op" id="4209394">.</span><span class="ident" id="4209395">ValueOf</span><span class="op" id="4209402">(</span><span class="ident" id="4209403">val</span><span class="op" id="4209406">)</span><span class="op" id="4209407">.</span><span class="ident" id="4209408">Elem</span><span class="op" id="4209412">(</span><span class="op" id="4209413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4209416">offset</span><span class="op" id="4209422">,</span>&nbsp;<span class="ident" id="4209424">err</span>&nbsp;<span class="op" id="4209428">:=</span>&nbsp;<span class="ident" id="4209431">parseField</span><span class="op" id="4209441">(</span><span class="ident" id="4209442">v</span><span class="op" id="4209443">,</span>&nbsp;<span class="ident" id="4209445">b</span><span class="op" id="4209446">,</span>&nbsp;<span class="num" id="4209448">0</span><span class="op" id="4209449">,</span>&nbsp;<span class="ident" id="4209451">parseFieldParameters</span><span class="op" id="4209471">(</span><span class="ident" id="4209472">params</span><span class="op" id="4209478">)</span><span class="op" id="4209479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4209482">if</span>&nbsp;<span class="ident" id="4209485">err</span>&nbsp;<span class="op" id="4209489">!=</span>&nbsp;<span class="ident" id="4209492">nil</span>&nbsp;<span class="op" id="4209496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4209500">return</span>&nbsp;<span class="ident" id="4209507">nil</span><span class="op" id="4209510">,</span>&nbsp;<span class="ident" id="4209512">err</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4209517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4209520">return</span>&nbsp;<span class="ident" id="4209527">b</span><span class="op" id="4209528">[</span><span class="ident" id="4209529">offset</span><span class="op" id="4209535">:</span><span class="op" id="4209536">]</span><span class="op" id="4209537">,</span>&nbsp;<span class="ident" id="4209539">nil</span><br>
<span class="lineno"></span><span class="op" id="4209543">}</span>
</div>
</body>
</html>
