<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8165203">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8165258">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8165312">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8165363">package</span>&nbsp;<span class="ident" id="8165371">httptest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8165381">import</span>&nbsp;<span class="op" id="8165388">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8165391">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8165404">&#34;net/http&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8165416">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8165426">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8165429">func</span>&nbsp;<span class="ident" id="8165434">TestServer</span><span class="op" id="8165444">(</span><span class="ident" id="8165445">t</span>&nbsp;<span class="op" id="8165447">*</span><span class="ident" id="8165448">testing</span><span class="op" id="8165455">.</span><span class="ident" id="8165456">T</span><span class="op" id="8165457">)</span>&nbsp;<span class="op" id="8165459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8165462">ts</span>&nbsp;<span class="op" id="8165465">:=</span>&nbsp;<span class="ident" id="8165468">NewServer</span><span class="op" id="8165477">(</span><span class="ident" id="8165478">http</span><span class="op" id="8165482">.</span><span class="ident" id="8165483">HandlerFunc</span><span class="op" id="8165494">(</span><span class="keyword" id="8165495">func</span><span class="op" id="8165499">(</span><span class="ident" id="8165500">w</span>&nbsp;<span class="ident" id="8165502">http</span><span class="op" id="8165506">.</span><span class="ident" id="8165507">ResponseWriter</span><span class="op" id="8165521">,</span>&nbsp;<span class="ident" id="8165523">r</span>&nbsp;<span class="op" id="8165525">*</span><span class="ident" id="8165526">http</span><span class="op" id="8165530">.</span><span class="ident" id="8165531">Request</span><span class="op" id="8165538">)</span>&nbsp;<span class="op" id="8165540">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8165544">w</span><span class="op" id="8165545">.</span><span class="ident" id="8165546">Write</span><span class="op" id="8165551">(</span><span class="op" id="8165552">[</span><span class="op" id="8165553">]</span><span class="builtintype" id="8165554">byte</span><span class="op" id="8165558">(</span><span class="string" id="8165559">&#34;hello&#34;</span><span class="op" id="8165566">)</span><span class="op" id="8165567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8165570">}</span><span class="op" id="8165571">)</span><span class="op" id="8165572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8165575">defer</span>&nbsp;<span class="ident" id="8165581">ts</span><span class="op" id="8165583">.</span><span class="ident" id="8165584">Close</span><span class="op" id="8165589">(</span><span class="op" id="8165590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8165593">res</span><span class="op" id="8165596">,</span>&nbsp;<span class="ident" id="8165598">err</span>&nbsp;<span class="op" id="8165602">:=</span>&nbsp;<span class="ident" id="8165605">http</span><span class="op" id="8165609">.</span><span class="ident" id="8165610">Get</span><span class="op" id="8165613">(</span><span class="ident" id="8165614">ts</span><span class="op" id="8165616">.</span><span class="ident" id="8165617">URL</span><span class="op" id="8165620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8165623">if</span>&nbsp;<span class="ident" id="8165626">err</span>&nbsp;<span class="op" id="8165630">!=</span>&nbsp;<span class="ident" id="8165633">nil</span>&nbsp;<span class="op" id="8165637">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8165641">t</span><span class="op" id="8165642">.</span><span class="ident" id="8165643">Fatal</span><span class="op" id="8165648">(</span><span class="ident" id="8165649">err</span><span class="op" id="8165652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8165655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8165658">got</span><span class="op" id="8165661">,</span>&nbsp;<span class="ident" id="8165663">err</span>&nbsp;<span class="op" id="8165667">:=</span>&nbsp;<span class="ident" id="8165670">ioutil</span><span class="op" id="8165676">.</span><span class="ident" id="8165677">ReadAll</span><span class="op" id="8165684">(</span><span class="ident" id="8165685">res</span><span class="op" id="8165688">.</span><span class="ident" id="8165689">Body</span><span class="op" id="8165693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8165696">if</span>&nbsp;<span class="ident" id="8165699">err</span>&nbsp;<span class="op" id="8165703">!=</span>&nbsp;<span class="ident" id="8165706">nil</span>&nbsp;<span class="op" id="8165710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8165714">t</span><span class="op" id="8165715">.</span><span class="ident" id="8165716">Fatal</span><span class="op" id="8165721">(</span><span class="ident" id="8165722">err</span><span class="op" id="8165725">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8165728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8165731">if</span>&nbsp;<span class="builtintype" id="8165734">string</span><span class="op" id="8165740">(</span><span class="ident" id="8165741">got</span><span class="op" id="8165744">)</span>&nbsp;<span class="op" id="8165746">!=</span>&nbsp;<span class="string" id="8165749">&#34;hello&#34;</span>&nbsp;<span class="op" id="8165757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8165761">t</span><span class="op" id="8165762">.</span><span class="ident" id="8165763">Errorf</span><span class="op" id="8165769">(</span><span class="string" id="8165770">&#34;got&nbsp;%q,&nbsp;want&nbsp;hello&#34;</span><span class="op" id="8165790">,</span>&nbsp;<span class="builtintype" id="8165792">string</span><span class="op" id="8165798">(</span><span class="ident" id="8165799">got</span><span class="op" id="8165802">)</span><span class="op" id="8165803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8165806">}</span><br>
<span class="lineno"></span><span class="op" id="8165808">}</span>
</div>
</body>
</html>
