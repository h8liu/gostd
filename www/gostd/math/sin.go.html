<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2377070">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2377125">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2377179">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2377230">package</span>&nbsp;<span class="ident" id="2377238">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2377244">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;sine&nbsp;and&nbsp;cosine.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2377284">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2377344">//&nbsp;below&nbsp;were&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cmath/sin.c,</span><br>
<span class="lineno"></span><span class="comment" id="2377408">//&nbsp;available&nbsp;from&nbsp;http://www.netlib.org/cephes/cmath.tgz.</span><br>
<span class="lineno"></span><span class="comment" id="2377466">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2377524">//</span><br>
<span class="lineno"></span><span class="comment" id="2377527">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin.c</span><br>
<span class="lineno"></span><span class="comment" id="2377541">//</span><br>
<span class="lineno"></span><span class="comment" id="2377544">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;sine</span><br>
<span class="lineno"></span><span class="comment" id="2377566">//</span><br>
<span class="lineno">20</span><span class="comment" id="2377569">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2377582">//</span><br>
<span class="lineno"></span><span class="comment" id="2377585">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;sin();</span><br>
<span class="lineno"></span><span class="comment" id="2377608">//&nbsp;y&nbsp;=&nbsp;sin(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2377625">//</span><br>
<span class="lineno">25</span><span class="comment" id="2377628">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2377644">//</span><br>
<span class="lineno"></span><span class="comment" id="2377647">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2377724">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="comment" id="2377794">//</span><br>
<span class="lineno">30</span><span class="comment" id="2377797">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2377853">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;sine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2377903">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2377931">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;cosine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2377985">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno">35</span><span class="comment" id="2378013">//</span><br>
<span class="lineno"></span><span class="comment" id="2378016">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2378029">//</span><br>
<span class="lineno"></span><span class="comment" id="2378032">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2378072">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2378131">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;150000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8e-18</span><br>
<span class="lineno"></span><span class="comment" id="2378192">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2378253">//</span><br>
<span class="lineno"></span><span class="comment" id="2378256">//&nbsp;Partial&nbsp;loss&nbsp;of&nbsp;accuracy&nbsp;begins&nbsp;to&nbsp;occur&nbsp;at&nbsp;x&nbsp;=&nbsp;2**30&nbsp;=&nbsp;1.074e9.&nbsp;&nbsp;The&nbsp;loss</span><br>
<span class="lineno"></span><span class="comment" id="2378334">//&nbsp;is&nbsp;not&nbsp;gradual,&nbsp;but&nbsp;jumps&nbsp;suddenly&nbsp;to&nbsp;about&nbsp;1&nbsp;part&nbsp;in&nbsp;10e7.&nbsp;&nbsp;Results&nbsp;may</span><br>
<span class="lineno">45</span><span class="comment" id="2378410">//&nbsp;be&nbsp;meaningless&nbsp;for&nbsp;x&nbsp;&gt;&nbsp;2**49&nbsp;=&nbsp;5.6e14.</span><br>
<span class="lineno"></span><span class="comment" id="2378452">//</span><br>
<span class="lineno"></span><span class="comment" id="2378455">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos.c</span><br>
<span class="lineno"></span><span class="comment" id="2378469">//</span><br>
<span class="lineno"></span><span class="comment" id="2378472">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;cosine</span><br>
<span class="lineno">50</span><span class="comment" id="2378496">//</span><br>
<span class="lineno"></span><span class="comment" id="2378499">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2378512">//</span><br>
<span class="lineno"></span><span class="comment" id="2378515">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;cos();</span><br>
<span class="lineno"></span><span class="comment" id="2378538">//&nbsp;y&nbsp;=&nbsp;cos(&nbsp;x&nbsp;);</span><br>
<span class="lineno">55</span><span class="comment" id="2378555">//</span><br>
<span class="lineno"></span><span class="comment" id="2378558">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2378574">//</span><br>
<span class="lineno"></span><span class="comment" id="2378577">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2378654">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno">60</span><span class="comment" id="2378724">//</span><br>
<span class="lineno"></span><span class="comment" id="2378727">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2378783">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;cosine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2378835">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2378863">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;sine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno">65</span><span class="comment" id="2378915">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2378943">//</span><br>
<span class="lineno"></span><span class="comment" id="2378946">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2378959">//</span><br>
<span class="lineno"></span><span class="comment" id="2378962">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno">70</span><span class="comment" id="2379002">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="2379061">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2379122">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,+1.07e9&nbsp;&nbsp;&nbsp;17000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-18</span><br>
<span class="lineno"></span><span class="comment" id="2379183">//</span><br>
<span class="lineno"></span><span class="comment" id="2379186">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno">75</span><span class="comment" id="2379234">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2379298">//</span><br>
<span class="lineno"></span><span class="comment" id="2379301">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2379362">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2379432">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno">80</span><span class="comment" id="2379507">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2379574">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2379647">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2379719">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2379733">//</span><br>
<span class="lineno">85</span><span class="comment" id="2379736">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2379802">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2379868">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2379881">//</span><br>
<span class="lineno"></span><span class="comment" id="2379884">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">90</span><span class="comment" id="2379908">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2379938">//&nbsp;sin&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2379958">var</span>&nbsp;<span class="ident" id="2379962">_sin</span>&nbsp;<span class="op" id="2379967">=</span>&nbsp;<span class="op" id="2379969">[</span><span class="op" id="2379970">...</span><span class="op" id="2379973">]</span><span class="builtintype" id="2379974">float64</span><span class="op" id="2379981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2379984">1.58962301576546568060E-10</span><span class="op" id="2380010">,</span>&nbsp;<span class="comment" id="2380012">//&nbsp;0x3de5d8fd1fd19ccd</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2380035">-</span><span class="num" id="2380036">2.50507477628578072866E-8</span><span class="op" id="2380061">,</span>&nbsp;<span class="comment" id="2380063">//&nbsp;0xbe5ae5e5a9291f5d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2380086">2.75573136213857245213E-6</span><span class="op" id="2380111">,</span>&nbsp;&nbsp;<span class="comment" id="2380114">//&nbsp;0x3ec71de3567d48a1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2380137">-</span><span class="num" id="2380138">1.98412698295895385996E-4</span><span class="op" id="2380163">,</span>&nbsp;<span class="comment" id="2380165">//&nbsp;0xbf2a01a019bfdf03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2380188">8.33333333332211858878E-3</span><span class="op" id="2380213">,</span>&nbsp;&nbsp;<span class="comment" id="2380216">//&nbsp;0x3f8111111110f7d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2380239">-</span><span class="num" id="2380240">1.66666666666666307295E-1</span><span class="op" id="2380265">,</span>&nbsp;<span class="comment" id="2380267">//&nbsp;0xbfc5555555555548</span><br>
<span class="lineno">100</span><span class="op" id="2380289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2380292">//&nbsp;cos&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2380312">var</span>&nbsp;<span class="ident" id="2380316">_cos</span>&nbsp;<span class="op" id="2380321">=</span>&nbsp;<span class="op" id="2380323">[</span><span class="op" id="2380324">...</span><span class="op" id="2380327">]</span><span class="builtintype" id="2380328">float64</span><span class="op" id="2380335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2380338">-</span><span class="num" id="2380339">1.13585365213876817300E-11</span><span class="op" id="2380365">,</span>&nbsp;<span class="comment" id="2380367">//&nbsp;0xbda8fa49a0861a9b</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2380390">2.08757008419747316778E-9</span><span class="op" id="2380415">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2380419">//&nbsp;0x3e21ee9d7b4e3f05</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2380442">-</span><span class="num" id="2380443">2.75573141792967388112E-7</span><span class="op" id="2380468">,</span>&nbsp;&nbsp;<span class="comment" id="2380471">//&nbsp;0xbe927e4f7eac4bc6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2380494">2.48015872888517045348E-5</span><span class="op" id="2380519">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2380523">//&nbsp;0x3efa01a019c844f5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2380546">-</span><span class="num" id="2380547">1.38888888888730564116E-3</span><span class="op" id="2380572">,</span>&nbsp;&nbsp;<span class="comment" id="2380575">//&nbsp;0xbf56c16c16c14f91</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2380598">4.16666666666665929218E-2</span><span class="op" id="2380623">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2380627">//&nbsp;0x3fa555555555554b</span><br>
<span class="lineno">110</span><span class="op" id="2380649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2380652">//&nbsp;Cos&nbsp;returns&nbsp;the&nbsp;cosine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2380704">//</span><br>
<span class="lineno"></span><span class="comment" id="2380707">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">115</span><span class="comment" id="2380729">//&nbsp;&nbsp;&nbsp;&nbspCos(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2380749">//&nbsp;&nbsp;&nbsp;&nbspCos(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2380767">func</span>&nbsp;<span class="ident" id="2380772">Cos</span><span class="op" id="2380775">(</span><span class="ident" id="2380776">x</span>&nbsp;<span class="builtintype" id="2380778">float64</span><span class="op" id="2380785">)</span>&nbsp;<span class="builtintype" id="2380787">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2380796">func</span>&nbsp;<span class="ident" id="2380801">cos</span><span class="op" id="2380804">(</span><span class="ident" id="2380805">x</span>&nbsp;<span class="builtintype" id="2380807">float64</span><span class="op" id="2380814">)</span>&nbsp;<span class="builtintype" id="2380816">float64</span>&nbsp;<span class="op" id="2380824">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2380827">const</span>&nbsp;<span class="op" id="2380833">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380837">PI4A</span>&nbsp;<span class="op" id="2380842">=</span>&nbsp;<span class="num" id="2380844">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2380898">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380951">PI4B</span>&nbsp;<span class="op" id="2380956">=</span>&nbsp;<span class="num" id="2380958">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2381012">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381037">PI4C</span>&nbsp;<span class="op" id="2381042">=</span>&nbsp;<span class="num" id="2381044">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2381098">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381123">M4PI</span>&nbsp;<span class="op" id="2381128">=</span>&nbsp;<span class="num" id="2381130">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2381184">//&nbsp;4/pi</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2381196">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381214">switch</span>&nbsp;<span class="op" id="2381221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381224">case</span>&nbsp;<span class="ident" id="2381229">IsNaN</span><span class="op" id="2381234">(</span><span class="ident" id="2381235">x</span><span class="op" id="2381236">)</span>&nbsp;<span class="op" id="2381238">||</span>&nbsp;<span class="ident" id="2381241">IsInf</span><span class="op" id="2381246">(</span><span class="ident" id="2381247">x</span><span class="op" id="2381248">,</span>&nbsp;<span class="num" id="2381250">0</span><span class="op" id="2381251">)</span><span class="op" id="2381252">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381256">return</span>&nbsp;<span class="ident" id="2381263">NaN</span><span class="op" id="2381266">(</span><span class="op" id="2381267">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2381274">//&nbsp;make&nbsp;argument&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381301">sign</span>&nbsp;<span class="op" id="2381306">:=</span>&nbsp;<span class="builtintype" id="2381309">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381316">if</span>&nbsp;<span class="ident" id="2381319">x</span>&nbsp;<span class="op" id="2381321">&lt;</span>&nbsp;<span class="num" id="2381323">0</span>&nbsp;<span class="op" id="2381325">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381329">x</span>&nbsp;<span class="op" id="2381331">=</span>&nbsp;<span class="op" id="2381333">-</span><span class="ident" id="2381334">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381341">j</span>&nbsp;<span class="op" id="2381343">:=</span>&nbsp;<span class="ident" id="2381346">int64</span><span class="op" id="2381351">(</span><span class="ident" id="2381352">x</span>&nbsp;<span class="op" id="2381354">*</span>&nbsp;<span class="ident" id="2381356">M4PI</span><span class="op" id="2381360">)</span>&nbsp;<span class="comment" id="2381362">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381432">y</span>&nbsp;<span class="op" id="2381434">:=</span>&nbsp;<span class="builtintype" id="2381437">float64</span><span class="op" id="2381444">(</span><span class="ident" id="2381445">j</span><span class="op" id="2381446">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2381453">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2381493">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381517">if</span>&nbsp;<span class="ident" id="2381520">j</span><span class="op" id="2381521">&amp;</span><span class="num" id="2381522">1</span>&nbsp;<span class="op" id="2381524">==</span>&nbsp;<span class="num" id="2381527">1</span>&nbsp;<span class="op" id="2381529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381533">j</span>&nbsp;<span class="op" id="2381535">+=</span>&nbsp;<span class="num" id="2381538">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381542">y</span>&nbsp;<span class="op" id="2381544">+=</span>&nbsp;<span class="num" id="2381547">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381553">j</span>&nbsp;<span class="op" id="2381555">&amp;=</span>&nbsp;<span class="num" id="2381558">7</span>&nbsp;<span class="comment" id="2381560">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381604">if</span>&nbsp;<span class="ident" id="2381607">j</span>&nbsp;<span class="op" id="2381609">&gt;</span>&nbsp;<span class="num" id="2381611">3</span>&nbsp;<span class="op" id="2381613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381617">j</span>&nbsp;<span class="op" id="2381619">-=</span>&nbsp;<span class="num" id="2381622">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381626">sign</span>&nbsp;<span class="op" id="2381631">=</span>&nbsp;<span class="op" id="2381633">!</span><span class="ident" id="2381634">sign</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381643">if</span>&nbsp;<span class="ident" id="2381646">j</span>&nbsp;<span class="op" id="2381648">&gt;</span>&nbsp;<span class="num" id="2381650">1</span>&nbsp;<span class="op" id="2381652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381656">sign</span>&nbsp;<span class="op" id="2381661">=</span>&nbsp;<span class="op" id="2381663">!</span><span class="ident" id="2381664">sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381674">z</span>&nbsp;<span class="op" id="2381676">:=</span>&nbsp;<span class="op" id="2381679">(</span><span class="op" id="2381680">(</span><span class="ident" id="2381681">x</span>&nbsp;<span class="op" id="2381683">-</span>&nbsp;<span class="ident" id="2381685">y</span><span class="op" id="2381686">*</span><span class="ident" id="2381687">PI4A</span><span class="op" id="2381691">)</span>&nbsp;<span class="op" id="2381693">-</span>&nbsp;<span class="ident" id="2381695">y</span><span class="op" id="2381696">*</span><span class="ident" id="2381697">PI4B</span><span class="op" id="2381701">)</span>&nbsp;<span class="op" id="2381703">-</span>&nbsp;<span class="ident" id="2381705">y</span><span class="op" id="2381706">*</span><span class="ident" id="2381707">PI4C</span>&nbsp;<span class="comment" id="2381712">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381754">zz</span>&nbsp;<span class="op" id="2381757">:=</span>&nbsp;<span class="ident" id="2381760">z</span>&nbsp;<span class="op" id="2381762">*</span>&nbsp;<span class="ident" id="2381764">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381767">if</span>&nbsp;<span class="ident" id="2381770">j</span>&nbsp;<span class="op" id="2381772">==</span>&nbsp;<span class="num" id="2381775">1</span>&nbsp;<span class="op" id="2381777">||</span>&nbsp;<span class="ident" id="2381780">j</span>&nbsp;<span class="op" id="2381782">==</span>&nbsp;<span class="num" id="2381785">2</span>&nbsp;<span class="op" id="2381787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381791">y</span>&nbsp;<span class="op" id="2381793">=</span>&nbsp;<span class="ident" id="2381795">z</span>&nbsp;<span class="op" id="2381797">+</span>&nbsp;<span class="ident" id="2381799">z</span><span class="op" id="2381800">*</span><span class="ident" id="2381801">zz</span><span class="op" id="2381803">*</span><span class="op" id="2381804">(</span><span class="op" id="2381805">(</span><span class="op" id="2381806">(</span><span class="op" id="2381807">(</span><span class="op" id="2381808">(</span><span class="op" id="2381809">(</span><span class="ident" id="2381810">_sin</span><span class="op" id="2381814">[</span><span class="num" id="2381815">0</span><span class="op" id="2381816">]</span><span class="op" id="2381817">*</span><span class="ident" id="2381818">zz</span><span class="op" id="2381820">)</span><span class="op" id="2381821">+</span><span class="ident" id="2381822">_sin</span><span class="op" id="2381826">[</span><span class="num" id="2381827">1</span><span class="op" id="2381828">]</span><span class="op" id="2381829">)</span><span class="op" id="2381830">*</span><span class="ident" id="2381831">zz</span><span class="op" id="2381833">+</span><span class="ident" id="2381834">_sin</span><span class="op" id="2381838">[</span><span class="num" id="2381839">2</span><span class="op" id="2381840">]</span><span class="op" id="2381841">)</span><span class="op" id="2381842">*</span><span class="ident" id="2381843">zz</span><span class="op" id="2381845">+</span><span class="ident" id="2381846">_sin</span><span class="op" id="2381850">[</span><span class="num" id="2381851">3</span><span class="op" id="2381852">]</span><span class="op" id="2381853">)</span><span class="op" id="2381854">*</span><span class="ident" id="2381855">zz</span><span class="op" id="2381857">+</span><span class="ident" id="2381858">_sin</span><span class="op" id="2381862">[</span><span class="num" id="2381863">4</span><span class="op" id="2381864">]</span><span class="op" id="2381865">)</span><span class="op" id="2381866">*</span><span class="ident" id="2381867">zz</span><span class="op" id="2381869">+</span><span class="ident" id="2381870">_sin</span><span class="op" id="2381874">[</span><span class="num" id="2381875">5</span><span class="op" id="2381876">]</span><span class="op" id="2381877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381880">}</span>&nbsp;<span class="keyword" id="2381882">else</span>&nbsp;<span class="op" id="2381887">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381891">y</span>&nbsp;<span class="op" id="2381893">=</span>&nbsp;<span class="num" id="2381895">1.0</span>&nbsp;<span class="op" id="2381899">-</span>&nbsp;<span class="num" id="2381901">0.5</span><span class="op" id="2381904">*</span><span class="ident" id="2381905">zz</span>&nbsp;<span class="op" id="2381908">+</span>&nbsp;<span class="ident" id="2381910">zz</span><span class="op" id="2381912">*</span><span class="ident" id="2381913">zz</span><span class="op" id="2381915">*</span><span class="op" id="2381916">(</span><span class="op" id="2381917">(</span><span class="op" id="2381918">(</span><span class="op" id="2381919">(</span><span class="op" id="2381920">(</span><span class="op" id="2381921">(</span><span class="ident" id="2381922">_cos</span><span class="op" id="2381926">[</span><span class="num" id="2381927">0</span><span class="op" id="2381928">]</span><span class="op" id="2381929">*</span><span class="ident" id="2381930">zz</span><span class="op" id="2381932">)</span><span class="op" id="2381933">+</span><span class="ident" id="2381934">_cos</span><span class="op" id="2381938">[</span><span class="num" id="2381939">1</span><span class="op" id="2381940">]</span><span class="op" id="2381941">)</span><span class="op" id="2381942">*</span><span class="ident" id="2381943">zz</span><span class="op" id="2381945">+</span><span class="ident" id="2381946">_cos</span><span class="op" id="2381950">[</span><span class="num" id="2381951">2</span><span class="op" id="2381952">]</span><span class="op" id="2381953">)</span><span class="op" id="2381954">*</span><span class="ident" id="2381955">zz</span><span class="op" id="2381957">+</span><span class="ident" id="2381958">_cos</span><span class="op" id="2381962">[</span><span class="num" id="2381963">3</span><span class="op" id="2381964">]</span><span class="op" id="2381965">)</span><span class="op" id="2381966">*</span><span class="ident" id="2381967">zz</span><span class="op" id="2381969">+</span><span class="ident" id="2381970">_cos</span><span class="op" id="2381974">[</span><span class="num" id="2381975">4</span><span class="op" id="2381976">]</span><span class="op" id="2381977">)</span><span class="op" id="2381978">*</span><span class="ident" id="2381979">zz</span><span class="op" id="2381981">+</span><span class="ident" id="2381982">_cos</span><span class="op" id="2381986">[</span><span class="num" id="2381987">5</span><span class="op" id="2381988">]</span><span class="op" id="2381989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381995">if</span>&nbsp;<span class="ident" id="2381998">sign</span>&nbsp;<span class="op" id="2382003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382007">y</span>&nbsp;<span class="op" id="2382009">=</span>&nbsp;<span class="op" id="2382011">-</span><span class="ident" id="2382012">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2382015">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382018">return</span>&nbsp;<span class="ident" id="2382025">y</span><br>
<span class="lineno"></span><span class="op" id="2382027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2382030">//&nbsp;Sin&nbsp;returns&nbsp;the&nbsp;sine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2382080">//</span><br>
<span class="lineno">170</span><span class="comment" id="2382083">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2382105">//&nbsp;&nbsp;&nbsp;&nbspSin(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="2382123">//&nbsp;&nbsp;&nbsp;&nbspSin(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2382143">//&nbsp;&nbsp;&nbsp;&nbspSin(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2382161">func</span>&nbsp;<span class="ident" id="2382166">Sin</span><span class="op" id="2382169">(</span><span class="ident" id="2382170">x</span>&nbsp;<span class="builtintype" id="2382172">float64</span><span class="op" id="2382179">)</span>&nbsp;<span class="builtintype" id="2382181">float64</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="2382190">func</span>&nbsp;<span class="ident" id="2382195">sin</span><span class="op" id="2382198">(</span><span class="ident" id="2382199">x</span>&nbsp;<span class="builtintype" id="2382201">float64</span><span class="op" id="2382208">)</span>&nbsp;<span class="builtintype" id="2382210">float64</span>&nbsp;<span class="op" id="2382218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382221">const</span>&nbsp;<span class="op" id="2382227">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382231">PI4A</span>&nbsp;<span class="op" id="2382236">=</span>&nbsp;<span class="num" id="2382238">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2382292">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382345">PI4B</span>&nbsp;<span class="op" id="2382350">=</span>&nbsp;<span class="num" id="2382352">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2382406">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382431">PI4C</span>&nbsp;<span class="op" id="2382436">=</span>&nbsp;<span class="num" id="2382438">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2382492">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382517">M4PI</span>&nbsp;<span class="op" id="2382522">=</span>&nbsp;<span class="num" id="2382524">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2382578">//&nbsp;4/pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2382587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2382590">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382608">switch</span>&nbsp;<span class="op" id="2382615">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382618">case</span>&nbsp;<span class="ident" id="2382623">x</span>&nbsp;<span class="op" id="2382625">==</span>&nbsp;<span class="num" id="2382628">0</span>&nbsp;<span class="op" id="2382630">||</span>&nbsp;<span class="ident" id="2382633">IsNaN</span><span class="op" id="2382638">(</span><span class="ident" id="2382639">x</span><span class="op" id="2382640">)</span><span class="op" id="2382641">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382645">return</span>&nbsp;<span class="ident" id="2382652">x</span>&nbsp;<span class="comment" id="2382654">//&nbsp;return&nbsp;±0&nbsp;||&nbsp;NaN()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382678">case</span>&nbsp;<span class="ident" id="2382683">IsInf</span><span class="op" id="2382688">(</span><span class="ident" id="2382689">x</span><span class="op" id="2382690">,</span>&nbsp;<span class="num" id="2382692">0</span><span class="op" id="2382693">)</span><span class="op" id="2382694">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382698">return</span>&nbsp;<span class="ident" id="2382705">NaN</span><span class="op" id="2382708">(</span><span class="op" id="2382709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2382712">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2382716">//&nbsp;make&nbsp;argument&nbsp;positive&nbsp;but&nbsp;save&nbsp;the&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382761">sign</span>&nbsp;<span class="op" id="2382766">:=</span>&nbsp;<span class="builtintype" id="2382769">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382776">if</span>&nbsp;<span class="ident" id="2382779">x</span>&nbsp;<span class="op" id="2382781">&lt;</span>&nbsp;<span class="num" id="2382783">0</span>&nbsp;<span class="op" id="2382785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382789">x</span>&nbsp;<span class="op" id="2382791">=</span>&nbsp;<span class="op" id="2382793">-</span><span class="ident" id="2382794">x</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382798">sign</span>&nbsp;<span class="op" id="2382803">=</span>&nbsp;<span class="builtintype" id="2382805">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2382811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382815">j</span>&nbsp;<span class="op" id="2382817">:=</span>&nbsp;<span class="ident" id="2382820">int64</span><span class="op" id="2382825">(</span><span class="ident" id="2382826">x</span>&nbsp;<span class="op" id="2382828">*</span>&nbsp;<span class="ident" id="2382830">M4PI</span><span class="op" id="2382834">)</span>&nbsp;<span class="comment" id="2382836">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382906">y</span>&nbsp;<span class="op" id="2382908">:=</span>&nbsp;<span class="builtintype" id="2382911">float64</span><span class="op" id="2382918">(</span><span class="ident" id="2382919">j</span><span class="op" id="2382920">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2382927">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2382967">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382991">if</span>&nbsp;<span class="ident" id="2382994">j</span><span class="op" id="2382995">&amp;</span><span class="num" id="2382996">1</span>&nbsp;<span class="op" id="2382998">==</span>&nbsp;<span class="num" id="2383001">1</span>&nbsp;<span class="op" id="2383003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383007">j</span>&nbsp;<span class="op" id="2383009">+=</span>&nbsp;<span class="num" id="2383012">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383016">y</span>&nbsp;<span class="op" id="2383018">+=</span>&nbsp;<span class="num" id="2383021">1</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2383024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383027">j</span>&nbsp;<span class="op" id="2383029">&amp;=</span>&nbsp;<span class="num" id="2383032">7</span>&nbsp;<span class="comment" id="2383034">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2383078">//&nbsp;reflect&nbsp;in&nbsp;x&nbsp;axis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2383100">if</span>&nbsp;<span class="ident" id="2383103">j</span>&nbsp;<span class="op" id="2383105">&gt;</span>&nbsp;<span class="num" id="2383107">3</span>&nbsp;<span class="op" id="2383109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383113">sign</span>&nbsp;<span class="op" id="2383118">=</span>&nbsp;<span class="op" id="2383120">!</span><span class="ident" id="2383121">sign</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383128">j</span>&nbsp;<span class="op" id="2383130">-=</span>&nbsp;<span class="num" id="2383133">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2383136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383140">z</span>&nbsp;<span class="op" id="2383142">:=</span>&nbsp;<span class="op" id="2383145">(</span><span class="op" id="2383146">(</span><span class="ident" id="2383147">x</span>&nbsp;<span class="op" id="2383149">-</span>&nbsp;<span class="ident" id="2383151">y</span><span class="op" id="2383152">*</span><span class="ident" id="2383153">PI4A</span><span class="op" id="2383157">)</span>&nbsp;<span class="op" id="2383159">-</span>&nbsp;<span class="ident" id="2383161">y</span><span class="op" id="2383162">*</span><span class="ident" id="2383163">PI4B</span><span class="op" id="2383167">)</span>&nbsp;<span class="op" id="2383169">-</span>&nbsp;<span class="ident" id="2383171">y</span><span class="op" id="2383172">*</span><span class="ident" id="2383173">PI4C</span>&nbsp;<span class="comment" id="2383178">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383220">zz</span>&nbsp;<span class="op" id="2383223">:=</span>&nbsp;<span class="ident" id="2383226">z</span>&nbsp;<span class="op" id="2383228">*</span>&nbsp;<span class="ident" id="2383230">z</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2383233">if</span>&nbsp;<span class="ident" id="2383236">j</span>&nbsp;<span class="op" id="2383238">==</span>&nbsp;<span class="num" id="2383241">1</span>&nbsp;<span class="op" id="2383243">||</span>&nbsp;<span class="ident" id="2383246">j</span>&nbsp;<span class="op" id="2383248">==</span>&nbsp;<span class="num" id="2383251">2</span>&nbsp;<span class="op" id="2383253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383257">y</span>&nbsp;<span class="op" id="2383259">=</span>&nbsp;<span class="num" id="2383261">1.0</span>&nbsp;<span class="op" id="2383265">-</span>&nbsp;<span class="num" id="2383267">0.5</span><span class="op" id="2383270">*</span><span class="ident" id="2383271">zz</span>&nbsp;<span class="op" id="2383274">+</span>&nbsp;<span class="ident" id="2383276">zz</span><span class="op" id="2383278">*</span><span class="ident" id="2383279">zz</span><span class="op" id="2383281">*</span><span class="op" id="2383282">(</span><span class="op" id="2383283">(</span><span class="op" id="2383284">(</span><span class="op" id="2383285">(</span><span class="op" id="2383286">(</span><span class="op" id="2383287">(</span><span class="ident" id="2383288">_cos</span><span class="op" id="2383292">[</span><span class="num" id="2383293">0</span><span class="op" id="2383294">]</span><span class="op" id="2383295">*</span><span class="ident" id="2383296">zz</span><span class="op" id="2383298">)</span><span class="op" id="2383299">+</span><span class="ident" id="2383300">_cos</span><span class="op" id="2383304">[</span><span class="num" id="2383305">1</span><span class="op" id="2383306">]</span><span class="op" id="2383307">)</span><span class="op" id="2383308">*</span><span class="ident" id="2383309">zz</span><span class="op" id="2383311">+</span><span class="ident" id="2383312">_cos</span><span class="op" id="2383316">[</span><span class="num" id="2383317">2</span><span class="op" id="2383318">]</span><span class="op" id="2383319">)</span><span class="op" id="2383320">*</span><span class="ident" id="2383321">zz</span><span class="op" id="2383323">+</span><span class="ident" id="2383324">_cos</span><span class="op" id="2383328">[</span><span class="num" id="2383329">3</span><span class="op" id="2383330">]</span><span class="op" id="2383331">)</span><span class="op" id="2383332">*</span><span class="ident" id="2383333">zz</span><span class="op" id="2383335">+</span><span class="ident" id="2383336">_cos</span><span class="op" id="2383340">[</span><span class="num" id="2383341">4</span><span class="op" id="2383342">]</span><span class="op" id="2383343">)</span><span class="op" id="2383344">*</span><span class="ident" id="2383345">zz</span><span class="op" id="2383347">+</span><span class="ident" id="2383348">_cos</span><span class="op" id="2383352">[</span><span class="num" id="2383353">5</span><span class="op" id="2383354">]</span><span class="op" id="2383355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2383358">}</span>&nbsp;<span class="keyword" id="2383360">else</span>&nbsp;<span class="op" id="2383365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383369">y</span>&nbsp;<span class="op" id="2383371">=</span>&nbsp;<span class="ident" id="2383373">z</span>&nbsp;<span class="op" id="2383375">+</span>&nbsp;<span class="ident" id="2383377">z</span><span class="op" id="2383378">*</span><span class="ident" id="2383379">zz</span><span class="op" id="2383381">*</span><span class="op" id="2383382">(</span><span class="op" id="2383383">(</span><span class="op" id="2383384">(</span><span class="op" id="2383385">(</span><span class="op" id="2383386">(</span><span class="op" id="2383387">(</span><span class="ident" id="2383388">_sin</span><span class="op" id="2383392">[</span><span class="num" id="2383393">0</span><span class="op" id="2383394">]</span><span class="op" id="2383395">*</span><span class="ident" id="2383396">zz</span><span class="op" id="2383398">)</span><span class="op" id="2383399">+</span><span class="ident" id="2383400">_sin</span><span class="op" id="2383404">[</span><span class="num" id="2383405">1</span><span class="op" id="2383406">]</span><span class="op" id="2383407">)</span><span class="op" id="2383408">*</span><span class="ident" id="2383409">zz</span><span class="op" id="2383411">+</span><span class="ident" id="2383412">_sin</span><span class="op" id="2383416">[</span><span class="num" id="2383417">2</span><span class="op" id="2383418">]</span><span class="op" id="2383419">)</span><span class="op" id="2383420">*</span><span class="ident" id="2383421">zz</span><span class="op" id="2383423">+</span><span class="ident" id="2383424">_sin</span><span class="op" id="2383428">[</span><span class="num" id="2383429">3</span><span class="op" id="2383430">]</span><span class="op" id="2383431">)</span><span class="op" id="2383432">*</span><span class="ident" id="2383433">zz</span><span class="op" id="2383435">+</span><span class="ident" id="2383436">_sin</span><span class="op" id="2383440">[</span><span class="num" id="2383441">4</span><span class="op" id="2383442">]</span><span class="op" id="2383443">)</span><span class="op" id="2383444">*</span><span class="ident" id="2383445">zz</span><span class="op" id="2383447">+</span><span class="ident" id="2383448">_sin</span><span class="op" id="2383452">[</span><span class="num" id="2383453">5</span><span class="op" id="2383454">]</span><span class="op" id="2383455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2383458">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2383461">if</span>&nbsp;<span class="ident" id="2383464">sign</span>&nbsp;<span class="op" id="2383469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383473">y</span>&nbsp;<span class="op" id="2383475">=</span>&nbsp;<span class="op" id="2383477">-</span><span class="ident" id="2383478">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2383481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2383484">return</span>&nbsp;<span class="ident" id="2383491">y</span><br>
<span class="lineno"></span><span class="op" id="2383493">}</span>
</div>
</body>
</html>
