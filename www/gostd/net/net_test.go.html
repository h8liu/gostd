<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html" class="current">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6511898">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6511953">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6512007">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6512058">package</span>&nbsp;<span class="ident" id="6512066">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6512071">import</span>&nbsp;<span class="op" id="6512078">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6512081">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6512087">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6512100">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6512106">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6512117">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6512128">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6512135">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6512138">func</span>&nbsp;<span class="ident" id="6512143">TestShutdown</span><span class="op" id="6512155">(</span><span class="ident" id="6512156">t</span>&nbsp;<span class="op" id="6512158">*</span><span class="ident" id="6512159">testing</span><span class="op" id="6512166">.</span><span class="ident" id="6512167">T</span><span class="op" id="6512168">)</span>&nbsp;<span class="op" id="6512170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512173">if</span>&nbsp;<span class="ident" id="6512176">runtime</span><span class="op" id="6512183">.</span><span class="ident" id="6512184">GOOS</span>&nbsp;<span class="op" id="6512189">==</span>&nbsp;<span class="string" id="6512192">&#34;plan9&#34;</span>&nbsp;<span class="op" id="6512200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512204">t</span><span class="op" id="6512205">.</span><span class="ident" id="6512206">Skipf</span><span class="op" id="6512211">(</span><span class="string" id="6512212">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6512233">,</span>&nbsp;<span class="ident" id="6512235">runtime</span><span class="op" id="6512242">.</span><span class="ident" id="6512243">GOOS</span><span class="op" id="6512247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512250">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512253">ln</span><span class="op" id="6512255">,</span>&nbsp;<span class="ident" id="6512257">err</span>&nbsp;<span class="op" id="6512261">:=</span>&nbsp;<span class="ident" id="6512264">Listen</span><span class="op" id="6512270">(</span><span class="string" id="6512271">&#34;tcp&#34;</span><span class="op" id="6512276">,</span>&nbsp;<span class="string" id="6512278">&#34;127.0.0.1:0&#34;</span><span class="op" id="6512291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512294">if</span>&nbsp;<span class="ident" id="6512297">err</span>&nbsp;<span class="op" id="6512301">!=</span>&nbsp;<span class="builtintype" id="6512304">nil</span>&nbsp;<span class="op" id="6512308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512312">if</span>&nbsp;<span class="ident" id="6512315">ln</span><span class="op" id="6512317">,</span>&nbsp;<span class="ident" id="6512319">err</span>&nbsp;<span class="op" id="6512323">=</span>&nbsp;<span class="ident" id="6512325">Listen</span><span class="op" id="6512331">(</span><span class="string" id="6512332">&#34;tcp6&#34;</span><span class="op" id="6512338">,</span>&nbsp;<span class="string" id="6512340">&#34;[::1]:0&#34;</span><span class="op" id="6512349">)</span><span class="op" id="6512350">;</span>&nbsp;<span class="ident" id="6512352">err</span>&nbsp;<span class="op" id="6512356">!=</span>&nbsp;<span class="builtintype" id="6512359">nil</span>&nbsp;<span class="op" id="6512363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512368">t</span><span class="op" id="6512369">.</span><span class="ident" id="6512370">Fatalf</span><span class="op" id="6512376">(</span><span class="string" id="6512377">&#34;ListenTCP&nbsp;on&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="6512398">,</span>&nbsp;<span class="ident" id="6512400">err</span><span class="op" id="6512403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512407">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512414">go</span>&nbsp;<span class="keyword" id="6512417">func</span><span class="op" id="6512421">(</span><span class="op" id="6512422">)</span>&nbsp;<span class="op" id="6512424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512428">defer</span>&nbsp;<span class="ident" id="6512434">ln</span><span class="op" id="6512436">.</span><span class="ident" id="6512437">Close</span><span class="op" id="6512442">(</span><span class="op" id="6512443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512447">c</span><span class="op" id="6512448">,</span>&nbsp;<span class="ident" id="6512450">err</span>&nbsp;<span class="op" id="6512454">:=</span>&nbsp;<span class="ident" id="6512457">ln</span><span class="op" id="6512459">.</span><span class="ident" id="6512460">Accept</span><span class="op" id="6512466">(</span><span class="op" id="6512467">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512471">if</span>&nbsp;<span class="ident" id="6512474">err</span>&nbsp;<span class="op" id="6512478">!=</span>&nbsp;<span class="builtintype" id="6512481">nil</span>&nbsp;<span class="op" id="6512485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512490">t</span><span class="op" id="6512491">.</span><span class="ident" id="6512492">Errorf</span><span class="op" id="6512498">(</span><span class="string" id="6512499">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="6512511">,</span>&nbsp;<span class="ident" id="6512513">err</span><span class="op" id="6512516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512521">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512534">var</span>&nbsp;<span class="ident" id="6512538">buf</span>&nbsp;<span class="op" id="6512542">[</span><span class="num" id="6512543">10</span><span class="op" id="6512545">]</span><span class="builtintype" id="6512546">byte</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512553">n</span><span class="op" id="6512554">,</span>&nbsp;<span class="ident" id="6512556">err</span>&nbsp;<span class="op" id="6512560">:=</span>&nbsp;<span class="ident" id="6512563">c</span><span class="op" id="6512564">.</span><span class="ident" id="6512565">Read</span><span class="op" id="6512569">(</span><span class="ident" id="6512570">buf</span><span class="op" id="6512573">[</span><span class="op" id="6512574">:</span><span class="op" id="6512575">]</span><span class="op" id="6512576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512580">if</span>&nbsp;<span class="ident" id="6512583">n</span>&nbsp;<span class="op" id="6512585">!=</span>&nbsp;<span class="num" id="6512588">0</span>&nbsp;<span class="op" id="6512590">||</span>&nbsp;<span class="ident" id="6512593">err</span>&nbsp;<span class="op" id="6512597">!=</span>&nbsp;<span class="ident" id="6512600">io</span><span class="op" id="6512602">.</span><span class="ident" id="6512603">EOF</span>&nbsp;<span class="op" id="6512607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512612">t</span><span class="op" id="6512613">.</span><span class="ident" id="6512614">Errorf</span><span class="op" id="6512620">(</span><span class="string" id="6512621">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="6512659">,</span>&nbsp;<span class="ident" id="6512661">n</span><span class="op" id="6512662">,</span>&nbsp;<span class="ident" id="6512664">err</span><span class="op" id="6512667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512672">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512681">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512685">c</span><span class="op" id="6512686">.</span><span class="ident" id="6512687">Write</span><span class="op" id="6512692">(</span><span class="op" id="6512693">[</span><span class="op" id="6512694">]</span><span class="builtintype" id="6512695">byte</span><span class="op" id="6512699">(</span><span class="string" id="6512700">&#34;response&#34;</span><span class="op" id="6512710">)</span><span class="op" id="6512711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512715">c</span><span class="op" id="6512716">.</span><span class="ident" id="6512717">Close</span><span class="op" id="6512722">(</span><span class="op" id="6512723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512726">}</span><span class="op" id="6512727">(</span><span class="op" id="6512728">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512732">c</span><span class="op" id="6512733">,</span>&nbsp;<span class="ident" id="6512735">err</span>&nbsp;<span class="op" id="6512739">:=</span>&nbsp;<span class="ident" id="6512742">Dial</span><span class="op" id="6512746">(</span><span class="string" id="6512747">&#34;tcp&#34;</span><span class="op" id="6512752">,</span>&nbsp;<span class="ident" id="6512754">ln</span><span class="op" id="6512756">.</span><span class="ident" id="6512757">Addr</span><span class="op" id="6512761">(</span><span class="op" id="6512762">)</span><span class="op" id="6512763">.</span><span class="ident" id="6512764">String</span><span class="op" id="6512770">(</span><span class="op" id="6512771">)</span><span class="op" id="6512772">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512775">if</span>&nbsp;<span class="ident" id="6512778">err</span>&nbsp;<span class="op" id="6512782">!=</span>&nbsp;<span class="builtintype" id="6512785">nil</span>&nbsp;<span class="op" id="6512789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512793">t</span><span class="op" id="6512794">.</span><span class="ident" id="6512795">Fatalf</span><span class="op" id="6512801">(</span><span class="string" id="6512802">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6512812">,</span>&nbsp;<span class="ident" id="6512814">err</span><span class="op" id="6512817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512823">defer</span>&nbsp;<span class="ident" id="6512829">c</span><span class="op" id="6512830">.</span><span class="ident" id="6512831">Close</span><span class="op" id="6512836">(</span><span class="op" id="6512837">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512841">err</span>&nbsp;<span class="op" id="6512845">=</span>&nbsp;<span class="ident" id="6512847">c</span><span class="op" id="6512848">.</span><span class="op" id="6512849">(</span><span class="op" id="6512850">*</span><span class="ident" id="6512851">TCPConn</span><span class="op" id="6512858">)</span><span class="op" id="6512859">.</span><span class="ident" id="6512860">CloseWrite</span><span class="op" id="6512870">(</span><span class="op" id="6512871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512874">if</span>&nbsp;<span class="ident" id="6512877">err</span>&nbsp;<span class="op" id="6512881">!=</span>&nbsp;<span class="builtintype" id="6512884">nil</span>&nbsp;<span class="op" id="6512888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512892">t</span><span class="op" id="6512893">.</span><span class="ident" id="6512894">Fatalf</span><span class="op" id="6512900">(</span><span class="string" id="6512901">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="6512917">,</span>&nbsp;<span class="ident" id="6512919">err</span><span class="op" id="6512922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512928">var</span>&nbsp;<span class="ident" id="6512932">buf</span>&nbsp;<span class="op" id="6512936">[</span><span class="num" id="6512937">10</span><span class="op" id="6512939">]</span><span class="builtintype" id="6512940">byte</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512946">n</span><span class="op" id="6512947">,</span>&nbsp;<span class="ident" id="6512949">err</span>&nbsp;<span class="op" id="6512953">:=</span>&nbsp;<span class="ident" id="6512956">c</span><span class="op" id="6512957">.</span><span class="ident" id="6512958">Read</span><span class="op" id="6512962">(</span><span class="ident" id="6512963">buf</span><span class="op" id="6512966">[</span><span class="op" id="6512967">:</span><span class="op" id="6512968">]</span><span class="op" id="6512969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512972">if</span>&nbsp;<span class="ident" id="6512975">err</span>&nbsp;<span class="op" id="6512979">!=</span>&nbsp;<span class="builtintype" id="6512982">nil</span>&nbsp;<span class="op" id="6512986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512990">t</span><span class="op" id="6512991">.</span><span class="ident" id="6512992">Fatalf</span><span class="op" id="6512998">(</span><span class="string" id="6512999">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6513020">,</span>&nbsp;<span class="ident" id="6513022">n</span><span class="op" id="6513023">,</span>&nbsp;<span class="ident" id="6513025">err</span><span class="op" id="6513028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513034">got</span>&nbsp;<span class="op" id="6513038">:=</span>&nbsp;<span class="builtintype" id="6513041">string</span><span class="op" id="6513047">(</span><span class="ident" id="6513048">buf</span><span class="op" id="6513051">[</span><span class="op" id="6513052">:</span><span class="ident" id="6513053">n</span><span class="op" id="6513054">]</span><span class="op" id="6513055">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513058">if</span>&nbsp;<span class="ident" id="6513061">got</span>&nbsp;<span class="op" id="6513065">!=</span>&nbsp;<span class="string" id="6513068">&#34;response&#34;</span>&nbsp;<span class="op" id="6513079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513083">t</span><span class="op" id="6513084">.</span><span class="ident" id="6513085">Errorf</span><span class="op" id="6513091">(</span><span class="string" id="6513092">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="6513122">,</span>&nbsp;<span class="ident" id="6513124">got</span><span class="op" id="6513127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513130">}</span><br>
<span class="lineno"></span><span class="op" id="6513132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6513135">func</span>&nbsp;<span class="ident" id="6513140">TestShutdownUnix</span><span class="op" id="6513156">(</span><span class="ident" id="6513157">t</span>&nbsp;<span class="op" id="6513159">*</span><span class="ident" id="6513160">testing</span><span class="op" id="6513167">.</span><span class="ident" id="6513168">T</span><span class="op" id="6513169">)</span>&nbsp;<span class="op" id="6513171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513174">switch</span>&nbsp;<span class="ident" id="6513181">runtime</span><span class="op" id="6513188">.</span><span class="ident" id="6513189">GOOS</span>&nbsp;<span class="op" id="6513194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513197">case</span>&nbsp;<span class="string" id="6513202">&#34;nacl&#34;</span><span class="op" id="6513208">,</span>&nbsp;<span class="string" id="6513210">&#34;plan9&#34;</span><span class="op" id="6513217">,</span>&nbsp;<span class="string" id="6513219">&#34;windows&#34;</span><span class="op" id="6513228">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513232">t</span><span class="op" id="6513233">.</span><span class="ident" id="6513234">Skipf</span><span class="op" id="6513239">(</span><span class="string" id="6513240">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6513261">,</span>&nbsp;<span class="ident" id="6513263">runtime</span><span class="op" id="6513270">.</span><span class="ident" id="6513271">GOOS</span><span class="op" id="6513275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513278">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513281">f</span><span class="op" id="6513282">,</span>&nbsp;<span class="ident" id="6513284">err</span>&nbsp;<span class="op" id="6513288">:=</span>&nbsp;<span class="ident" id="6513291">ioutil</span><span class="op" id="6513297">.</span><span class="ident" id="6513298">TempFile</span><span class="op" id="6513306">(</span><span class="string" id="6513307">&#34;&#34;</span><span class="op" id="6513309">,</span>&nbsp;<span class="string" id="6513311">&#34;go_net_unixtest&#34;</span><span class="op" id="6513328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513331">if</span>&nbsp;<span class="ident" id="6513334">err</span>&nbsp;<span class="op" id="6513338">!=</span>&nbsp;<span class="builtintype" id="6513341">nil</span>&nbsp;<span class="op" id="6513345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513349">t</span><span class="op" id="6513350">.</span><span class="ident" id="6513351">Fatalf</span><span class="op" id="6513357">(</span><span class="string" id="6513358">&#34;TempFile:&nbsp;%s&#34;</span><span class="op" id="6513372">,</span>&nbsp;<span class="ident" id="6513374">err</span><span class="op" id="6513377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513383">f</span><span class="op" id="6513384">.</span><span class="ident" id="6513385">Close</span><span class="op" id="6513390">(</span><span class="op" id="6513391">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513394">tmpname</span>&nbsp;<span class="op" id="6513402">:=</span>&nbsp;<span class="ident" id="6513405">f</span><span class="op" id="6513406">.</span><span class="ident" id="6513407">Name</span><span class="op" id="6513411">(</span><span class="op" id="6513412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513415">os</span><span class="op" id="6513417">.</span><span class="ident" id="6513418">Remove</span><span class="op" id="6513424">(</span><span class="ident" id="6513425">tmpname</span><span class="op" id="6513432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513435">ln</span><span class="op" id="6513437">,</span>&nbsp;<span class="ident" id="6513439">err</span>&nbsp;<span class="op" id="6513443">:=</span>&nbsp;<span class="ident" id="6513446">Listen</span><span class="op" id="6513452">(</span><span class="string" id="6513453">&#34;unix&#34;</span><span class="op" id="6513459">,</span>&nbsp;<span class="ident" id="6513461">tmpname</span><span class="op" id="6513468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513471">if</span>&nbsp;<span class="ident" id="6513474">err</span>&nbsp;<span class="op" id="6513478">!=</span>&nbsp;<span class="builtintype" id="6513481">nil</span>&nbsp;<span class="op" id="6513485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513489">t</span><span class="op" id="6513490">.</span><span class="ident" id="6513491">Fatalf</span><span class="op" id="6513497">(</span><span class="string" id="6513498">&#34;ListenUnix&nbsp;on&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="6513520">,</span>&nbsp;<span class="ident" id="6513522">tmpname</span><span class="op" id="6513529">,</span>&nbsp;<span class="ident" id="6513531">err</span><span class="op" id="6513534">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513540">defer</span>&nbsp;<span class="keyword" id="6513546">func</span><span class="op" id="6513550">(</span><span class="op" id="6513551">)</span>&nbsp;<span class="op" id="6513553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513557">ln</span><span class="op" id="6513559">.</span><span class="ident" id="6513560">Close</span><span class="op" id="6513565">(</span><span class="op" id="6513566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513570">os</span><span class="op" id="6513572">.</span><span class="ident" id="6513573">Remove</span><span class="op" id="6513579">(</span><span class="ident" id="6513580">tmpname</span><span class="op" id="6513587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513590">}</span><span class="op" id="6513591">(</span><span class="op" id="6513592">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513596">go</span>&nbsp;<span class="keyword" id="6513599">func</span><span class="op" id="6513603">(</span><span class="op" id="6513604">)</span>&nbsp;<span class="op" id="6513606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513610">c</span><span class="op" id="6513611">,</span>&nbsp;<span class="ident" id="6513613">err</span>&nbsp;<span class="op" id="6513617">:=</span>&nbsp;<span class="ident" id="6513620">ln</span><span class="op" id="6513622">.</span><span class="ident" id="6513623">Accept</span><span class="op" id="6513629">(</span><span class="op" id="6513630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513634">if</span>&nbsp;<span class="ident" id="6513637">err</span>&nbsp;<span class="op" id="6513641">!=</span>&nbsp;<span class="builtintype" id="6513644">nil</span>&nbsp;<span class="op" id="6513648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513653">t</span><span class="op" id="6513654">.</span><span class="ident" id="6513655">Errorf</span><span class="op" id="6513661">(</span><span class="string" id="6513662">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="6513674">,</span>&nbsp;<span class="ident" id="6513676">err</span><span class="op" id="6513679">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513684">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513697">var</span>&nbsp;<span class="ident" id="6513701">buf</span>&nbsp;<span class="op" id="6513705">[</span><span class="num" id="6513706">10</span><span class="op" id="6513708">]</span><span class="builtintype" id="6513709">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513716">n</span><span class="op" id="6513717">,</span>&nbsp;<span class="ident" id="6513719">err</span>&nbsp;<span class="op" id="6513723">:=</span>&nbsp;<span class="ident" id="6513726">c</span><span class="op" id="6513727">.</span><span class="ident" id="6513728">Read</span><span class="op" id="6513732">(</span><span class="ident" id="6513733">buf</span><span class="op" id="6513736">[</span><span class="op" id="6513737">:</span><span class="op" id="6513738">]</span><span class="op" id="6513739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513743">if</span>&nbsp;<span class="ident" id="6513746">n</span>&nbsp;<span class="op" id="6513748">!=</span>&nbsp;<span class="num" id="6513751">0</span>&nbsp;<span class="op" id="6513753">||</span>&nbsp;<span class="ident" id="6513756">err</span>&nbsp;<span class="op" id="6513760">!=</span>&nbsp;<span class="ident" id="6513763">io</span><span class="op" id="6513765">.</span><span class="ident" id="6513766">EOF</span>&nbsp;<span class="op" id="6513770">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513775">t</span><span class="op" id="6513776">.</span><span class="ident" id="6513777">Errorf</span><span class="op" id="6513783">(</span><span class="string" id="6513784">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="6513822">,</span>&nbsp;<span class="ident" id="6513824">n</span><span class="op" id="6513825">,</span>&nbsp;<span class="ident" id="6513827">err</span><span class="op" id="6513830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513835">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513848">c</span><span class="op" id="6513849">.</span><span class="ident" id="6513850">Write</span><span class="op" id="6513855">(</span><span class="op" id="6513856">[</span><span class="op" id="6513857">]</span><span class="builtintype" id="6513858">byte</span><span class="op" id="6513862">(</span><span class="string" id="6513863">&#34;response&#34;</span><span class="op" id="6513873">)</span><span class="op" id="6513874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513878">c</span><span class="op" id="6513879">.</span><span class="ident" id="6513880">Close</span><span class="op" id="6513885">(</span><span class="op" id="6513886">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513889">}</span><span class="op" id="6513890">(</span><span class="op" id="6513891">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513895">c</span><span class="op" id="6513896">,</span>&nbsp;<span class="ident" id="6513898">err</span>&nbsp;<span class="op" id="6513902">:=</span>&nbsp;<span class="ident" id="6513905">Dial</span><span class="op" id="6513909">(</span><span class="string" id="6513910">&#34;unix&#34;</span><span class="op" id="6513916">,</span>&nbsp;<span class="ident" id="6513918">tmpname</span><span class="op" id="6513925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513928">if</span>&nbsp;<span class="ident" id="6513931">err</span>&nbsp;<span class="op" id="6513935">!=</span>&nbsp;<span class="builtintype" id="6513938">nil</span>&nbsp;<span class="op" id="6513942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513946">t</span><span class="op" id="6513947">.</span><span class="ident" id="6513948">Fatalf</span><span class="op" id="6513954">(</span><span class="string" id="6513955">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6513965">,</span>&nbsp;<span class="ident" id="6513967">err</span><span class="op" id="6513970">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513976">defer</span>&nbsp;<span class="ident" id="6513982">c</span><span class="op" id="6513983">.</span><span class="ident" id="6513984">Close</span><span class="op" id="6513989">(</span><span class="op" id="6513990">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513994">err</span>&nbsp;<span class="op" id="6513998">=</span>&nbsp;<span class="ident" id="6514000">c</span><span class="op" id="6514001">.</span><span class="op" id="6514002">(</span><span class="op" id="6514003">*</span><span class="ident" id="6514004">UnixConn</span><span class="op" id="6514012">)</span><span class="op" id="6514013">.</span><span class="ident" id="6514014">CloseWrite</span><span class="op" id="6514024">(</span><span class="op" id="6514025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514028">if</span>&nbsp;<span class="ident" id="6514031">err</span>&nbsp;<span class="op" id="6514035">!=</span>&nbsp;<span class="builtintype" id="6514038">nil</span>&nbsp;<span class="op" id="6514042">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514046">t</span><span class="op" id="6514047">.</span><span class="ident" id="6514048">Fatalf</span><span class="op" id="6514054">(</span><span class="string" id="6514055">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="6514071">,</span>&nbsp;<span class="ident" id="6514073">err</span><span class="op" id="6514076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514082">var</span>&nbsp;<span class="ident" id="6514086">buf</span>&nbsp;<span class="op" id="6514090">[</span><span class="num" id="6514091">10</span><span class="op" id="6514093">]</span><span class="builtintype" id="6514094">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514100">n</span><span class="op" id="6514101">,</span>&nbsp;<span class="ident" id="6514103">err</span>&nbsp;<span class="op" id="6514107">:=</span>&nbsp;<span class="ident" id="6514110">c</span><span class="op" id="6514111">.</span><span class="ident" id="6514112">Read</span><span class="op" id="6514116">(</span><span class="ident" id="6514117">buf</span><span class="op" id="6514120">[</span><span class="op" id="6514121">:</span><span class="op" id="6514122">]</span><span class="op" id="6514123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514126">if</span>&nbsp;<span class="ident" id="6514129">err</span>&nbsp;<span class="op" id="6514133">!=</span>&nbsp;<span class="builtintype" id="6514136">nil</span>&nbsp;<span class="op" id="6514140">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514144">t</span><span class="op" id="6514145">.</span><span class="ident" id="6514146">Fatalf</span><span class="op" id="6514152">(</span><span class="string" id="6514153">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6514174">,</span>&nbsp;<span class="ident" id="6514176">n</span><span class="op" id="6514177">,</span>&nbsp;<span class="ident" id="6514179">err</span><span class="op" id="6514182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514188">got</span>&nbsp;<span class="op" id="6514192">:=</span>&nbsp;<span class="builtintype" id="6514195">string</span><span class="op" id="6514201">(</span><span class="ident" id="6514202">buf</span><span class="op" id="6514205">[</span><span class="op" id="6514206">:</span><span class="ident" id="6514207">n</span><span class="op" id="6514208">]</span><span class="op" id="6514209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514212">if</span>&nbsp;<span class="ident" id="6514215">got</span>&nbsp;<span class="op" id="6514219">!=</span>&nbsp;<span class="string" id="6514222">&#34;response&#34;</span>&nbsp;<span class="op" id="6514233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514237">t</span><span class="op" id="6514238">.</span><span class="ident" id="6514239">Errorf</span><span class="op" id="6514245">(</span><span class="string" id="6514246">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="6514276">,</span>&nbsp;<span class="ident" id="6514278">got</span><span class="op" id="6514281">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514284">}</span><br>
<span class="lineno"></span><span class="op" id="6514286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6514289">func</span>&nbsp;<span class="ident" id="6514294">TestTCPListenClose</span><span class="op" id="6514312">(</span><span class="ident" id="6514313">t</span>&nbsp;<span class="op" id="6514315">*</span><span class="ident" id="6514316">testing</span><span class="op" id="6514323">.</span><span class="ident" id="6514324">T</span><span class="op" id="6514325">)</span>&nbsp;<span class="op" id="6514327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514330">ln</span><span class="op" id="6514332">,</span>&nbsp;<span class="ident" id="6514334">err</span>&nbsp;<span class="op" id="6514338">:=</span>&nbsp;<span class="ident" id="6514341">Listen</span><span class="op" id="6514347">(</span><span class="string" id="6514348">&#34;tcp&#34;</span><span class="op" id="6514353">,</span>&nbsp;<span class="string" id="6514355">&#34;127.0.0.1:0&#34;</span><span class="op" id="6514368">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514371">if</span>&nbsp;<span class="ident" id="6514374">err</span>&nbsp;<span class="op" id="6514378">!=</span>&nbsp;<span class="builtintype" id="6514381">nil</span>&nbsp;<span class="op" id="6514385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514389">t</span><span class="op" id="6514390">.</span><span class="ident" id="6514391">Fatalf</span><span class="op" id="6514397">(</span><span class="string" id="6514398">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6514417">,</span>&nbsp;<span class="ident" id="6514419">err</span><span class="op" id="6514422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514429">done</span>&nbsp;<span class="op" id="6514434">:=</span>&nbsp;<span class="builtinfunc" id="6514437">make</span><span class="op" id="6514441">(</span><span class="keyword" id="6514442">chan</span>&nbsp;<span class="builtintype" id="6514447">bool</span><span class="op" id="6514451">,</span>&nbsp;<span class="num" id="6514453">1</span><span class="op" id="6514454">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514457">go</span>&nbsp;<span class="keyword" id="6514460">func</span><span class="op" id="6514464">(</span><span class="op" id="6514465">)</span>&nbsp;<span class="op" id="6514467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514471">time</span><span class="op" id="6514475">.</span><span class="ident" id="6514476">Sleep</span><span class="op" id="6514481">(</span><span class="num" id="6514482">100</span>&nbsp;<span class="op" id="6514486">*</span>&nbsp;<span class="ident" id="6514488">time</span><span class="op" id="6514492">.</span><span class="ident" id="6514493">Millisecond</span><span class="op" id="6514504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514508">ln</span><span class="op" id="6514510">.</span><span class="ident" id="6514511">Close</span><span class="op" id="6514516">(</span><span class="op" id="6514517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514520">}</span><span class="op" id="6514521">(</span><span class="op" id="6514522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514525">go</span>&nbsp;<span class="keyword" id="6514528">func</span><span class="op" id="6514532">(</span><span class="op" id="6514533">)</span>&nbsp;<span class="op" id="6514535">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514539">c</span><span class="op" id="6514540">,</span>&nbsp;<span class="ident" id="6514542">err</span>&nbsp;<span class="op" id="6514546">:=</span>&nbsp;<span class="ident" id="6514549">ln</span><span class="op" id="6514551">.</span><span class="ident" id="6514552">Accept</span><span class="op" id="6514558">(</span><span class="op" id="6514559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514563">if</span>&nbsp;<span class="ident" id="6514566">err</span>&nbsp;<span class="op" id="6514570">==</span>&nbsp;<span class="builtintype" id="6514573">nil</span>&nbsp;<span class="op" id="6514577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514582">c</span><span class="op" id="6514583">.</span><span class="ident" id="6514584">Close</span><span class="op" id="6514589">(</span><span class="op" id="6514590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514595">t</span><span class="op" id="6514596">.</span><span class="ident" id="6514597">Error</span><span class="op" id="6514602">(</span><span class="string" id="6514603">&#34;Accept&nbsp;succeeded&#34;</span><span class="op" id="6514621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514625">}</span>&nbsp;<span class="keyword" id="6514627">else</span>&nbsp;<span class="op" id="6514632">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514637">t</span><span class="op" id="6514638">.</span><span class="ident" id="6514639">Logf</span><span class="op" id="6514643">(</span><span class="string" id="6514644">&#34;Accept&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="6514690">,</span>&nbsp;<span class="ident" id="6514692">err</span><span class="op" id="6514695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514703">done</span>&nbsp;<span class="op" id="6514708">&lt;-</span>&nbsp;<span class="builtintype" id="6514711">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514717">}</span><span class="op" id="6514718">(</span><span class="op" id="6514719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514722">select</span>&nbsp;<span class="op" id="6514729">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514732">case</span>&nbsp;<span class="op" id="6514737">&lt;-</span><span class="ident" id="6514739">done</span><span class="op" id="6514743">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514746">case</span>&nbsp;<span class="op" id="6514751">&lt;-</span><span class="ident" id="6514753">time</span><span class="op" id="6514757">.</span><span class="ident" id="6514758">After</span><span class="op" id="6514763">(</span><span class="num" id="6514764">2</span>&nbsp;<span class="op" id="6514766">*</span>&nbsp;<span class="ident" id="6514768">time</span><span class="op" id="6514772">.</span><span class="ident" id="6514773">Second</span><span class="op" id="6514779">)</span><span class="op" id="6514780">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514784">t</span><span class="op" id="6514785">.</span><span class="ident" id="6514786">Fatal</span><span class="op" id="6514791">(</span><span class="string" id="6514792">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;TCP&nbsp;close&#34;</span><span class="op" id="6514823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514826">}</span><br>
<span class="lineno"></span><span class="op" id="6514828">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="6514831">func</span>&nbsp;<span class="ident" id="6514836">TestUDPListenClose</span><span class="op" id="6514854">(</span><span class="ident" id="6514855">t</span>&nbsp;<span class="op" id="6514857">*</span><span class="ident" id="6514858">testing</span><span class="op" id="6514865">.</span><span class="ident" id="6514866">T</span><span class="op" id="6514867">)</span>&nbsp;<span class="op" id="6514869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514872">switch</span>&nbsp;<span class="ident" id="6514879">runtime</span><span class="op" id="6514886">.</span><span class="ident" id="6514887">GOOS</span>&nbsp;<span class="op" id="6514892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514895">case</span>&nbsp;<span class="string" id="6514900">&#34;plan9&#34;</span><span class="op" id="6514907">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514911">t</span><span class="op" id="6514912">.</span><span class="ident" id="6514913">Skipf</span><span class="op" id="6514918">(</span><span class="string" id="6514919">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6514940">,</span>&nbsp;<span class="ident" id="6514942">runtime</span><span class="op" id="6514949">.</span><span class="ident" id="6514950">GOOS</span><span class="op" id="6514954">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514960">ln</span><span class="op" id="6514962">,</span>&nbsp;<span class="ident" id="6514964">err</span>&nbsp;<span class="op" id="6514968">:=</span>&nbsp;<span class="ident" id="6514971">ListenPacket</span><span class="op" id="6514983">(</span><span class="string" id="6514984">&#34;udp&#34;</span><span class="op" id="6514989">,</span>&nbsp;<span class="string" id="6514991">&#34;127.0.0.1:0&#34;</span><span class="op" id="6515004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515007">if</span>&nbsp;<span class="ident" id="6515010">err</span>&nbsp;<span class="op" id="6515014">!=</span>&nbsp;<span class="builtintype" id="6515017">nil</span>&nbsp;<span class="op" id="6515021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515025">t</span><span class="op" id="6515026">.</span><span class="ident" id="6515027">Fatalf</span><span class="op" id="6515033">(</span><span class="string" id="6515034">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6515053">,</span>&nbsp;<span class="ident" id="6515055">err</span><span class="op" id="6515058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515061">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515065">buf</span>&nbsp;<span class="op" id="6515069">:=</span>&nbsp;<span class="builtinfunc" id="6515072">make</span><span class="op" id="6515076">(</span><span class="op" id="6515077">[</span><span class="op" id="6515078">]</span><span class="builtintype" id="6515079">byte</span><span class="op" id="6515083">,</span>&nbsp;<span class="num" id="6515085">1000</span><span class="op" id="6515089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515092">done</span>&nbsp;<span class="op" id="6515097">:=</span>&nbsp;<span class="builtinfunc" id="6515100">make</span><span class="op" id="6515104">(</span><span class="keyword" id="6515105">chan</span>&nbsp;<span class="builtintype" id="6515110">bool</span><span class="op" id="6515114">,</span>&nbsp;<span class="num" id="6515116">1</span><span class="op" id="6515117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515120">go</span>&nbsp;<span class="keyword" id="6515123">func</span><span class="op" id="6515127">(</span><span class="op" id="6515128">)</span>&nbsp;<span class="op" id="6515130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515134">time</span><span class="op" id="6515138">.</span><span class="ident" id="6515139">Sleep</span><span class="op" id="6515144">(</span><span class="num" id="6515145">100</span>&nbsp;<span class="op" id="6515149">*</span>&nbsp;<span class="ident" id="6515151">time</span><span class="op" id="6515155">.</span><span class="ident" id="6515156">Millisecond</span><span class="op" id="6515167">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515171">ln</span><span class="op" id="6515173">.</span><span class="ident" id="6515174">Close</span><span class="op" id="6515179">(</span><span class="op" id="6515180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515183">}</span><span class="op" id="6515184">(</span><span class="op" id="6515185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515188">go</span>&nbsp;<span class="keyword" id="6515191">func</span><span class="op" id="6515195">(</span><span class="op" id="6515196">)</span>&nbsp;<span class="op" id="6515198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515202">_</span><span class="op" id="6515203">,</span>&nbsp;<span class="ident" id="6515205">_</span><span class="op" id="6515206">,</span>&nbsp;<span class="ident" id="6515208">err</span>&nbsp;<span class="op" id="6515212">=</span>&nbsp;<span class="ident" id="6515214">ln</span><span class="op" id="6515216">.</span><span class="ident" id="6515217">ReadFrom</span><span class="op" id="6515225">(</span><span class="ident" id="6515226">buf</span><span class="op" id="6515229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515233">if</span>&nbsp;<span class="ident" id="6515236">err</span>&nbsp;<span class="op" id="6515240">==</span>&nbsp;<span class="builtintype" id="6515243">nil</span>&nbsp;<span class="op" id="6515247">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515252">t</span><span class="op" id="6515253">.</span><span class="ident" id="6515254">Error</span><span class="op" id="6515259">(</span><span class="string" id="6515260">&#34;ReadFrom&nbsp;succeeded&#34;</span><span class="op" id="6515280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515284">}</span>&nbsp;<span class="keyword" id="6515286">else</span>&nbsp;<span class="op" id="6515291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515296">t</span><span class="op" id="6515297">.</span><span class="ident" id="6515298">Logf</span><span class="op" id="6515302">(</span><span class="string" id="6515303">&#34;ReadFrom&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="6515351">,</span>&nbsp;<span class="ident" id="6515353">err</span><span class="op" id="6515356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515364">done</span>&nbsp;<span class="op" id="6515369">&lt;-</span>&nbsp;<span class="builtintype" id="6515372">true</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515378">}</span><span class="op" id="6515379">(</span><span class="op" id="6515380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515383">select</span>&nbsp;<span class="op" id="6515390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515393">case</span>&nbsp;<span class="op" id="6515398">&lt;-</span><span class="ident" id="6515400">done</span><span class="op" id="6515404">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515407">case</span>&nbsp;<span class="op" id="6515412">&lt;-</span><span class="ident" id="6515414">time</span><span class="op" id="6515418">.</span><span class="ident" id="6515419">After</span><span class="op" id="6515424">(</span><span class="num" id="6515425">2</span>&nbsp;<span class="op" id="6515427">*</span>&nbsp;<span class="ident" id="6515429">time</span><span class="op" id="6515433">.</span><span class="ident" id="6515434">Second</span><span class="op" id="6515440">)</span><span class="op" id="6515441">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515445">t</span><span class="op" id="6515446">.</span><span class="ident" id="6515447">Fatal</span><span class="op" id="6515452">(</span><span class="string" id="6515453">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;UDP&nbsp;close&#34;</span><span class="op" id="6515484">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515487">}</span><br>
<span class="lineno"></span><span class="op" id="6515489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6515492">func</span>&nbsp;<span class="ident" id="6515497">TestTCPClose</span><span class="op" id="6515509">(</span><span class="ident" id="6515510">t</span>&nbsp;<span class="op" id="6515512">*</span><span class="ident" id="6515513">testing</span><span class="op" id="6515520">.</span><span class="ident" id="6515521">T</span><span class="op" id="6515522">)</span>&nbsp;<span class="op" id="6515524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515527">switch</span>&nbsp;<span class="ident" id="6515534">runtime</span><span class="op" id="6515541">.</span><span class="ident" id="6515542">GOOS</span>&nbsp;<span class="op" id="6515547">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515550">case</span>&nbsp;<span class="string" id="6515555">&#34;plan9&#34;</span><span class="op" id="6515562">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515566">t</span><span class="op" id="6515567">.</span><span class="ident" id="6515568">Skipf</span><span class="op" id="6515573">(</span><span class="string" id="6515574">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6515595">,</span>&nbsp;<span class="ident" id="6515597">runtime</span><span class="op" id="6515604">.</span><span class="ident" id="6515605">GOOS</span><span class="op" id="6515609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515615">l</span><span class="op" id="6515616">,</span>&nbsp;<span class="ident" id="6515618">err</span>&nbsp;<span class="op" id="6515622">:=</span>&nbsp;<span class="ident" id="6515625">Listen</span><span class="op" id="6515631">(</span><span class="string" id="6515632">&#34;tcp&#34;</span><span class="op" id="6515637">,</span>&nbsp;<span class="string" id="6515639">&#34;127.0.0.1:0&#34;</span><span class="op" id="6515652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515655">if</span>&nbsp;<span class="ident" id="6515658">err</span>&nbsp;<span class="op" id="6515662">!=</span>&nbsp;<span class="builtintype" id="6515665">nil</span>&nbsp;<span class="op" id="6515669">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515673">t</span><span class="op" id="6515674">.</span><span class="ident" id="6515675">Fatal</span><span class="op" id="6515680">(</span><span class="ident" id="6515681">err</span><span class="op" id="6515684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515690">defer</span>&nbsp;<span class="ident" id="6515696">l</span><span class="op" id="6515697">.</span><span class="ident" id="6515698">Close</span><span class="op" id="6515703">(</span><span class="op" id="6515704">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515708">read</span>&nbsp;<span class="op" id="6515713">:=</span>&nbsp;<span class="keyword" id="6515716">func</span><span class="op" id="6515720">(</span><span class="ident" id="6515721">r</span>&nbsp;<span class="ident" id="6515723">io</span><span class="op" id="6515725">.</span><span class="ident" id="6515726">Reader</span><span class="op" id="6515732">)</span>&nbsp;<span class="builtintype" id="6515734">error</span>&nbsp;<span class="op" id="6515740">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515744">var</span>&nbsp;<span class="ident" id="6515748">m</span>&nbsp;<span class="op" id="6515750">[</span><span class="num" id="6515751">1</span><span class="op" id="6515752">]</span><span class="builtintype" id="6515753">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515760">_</span><span class="op" id="6515761">,</span>&nbsp;<span class="ident" id="6515763">err</span>&nbsp;<span class="op" id="6515767">:=</span>&nbsp;<span class="ident" id="6515770">r</span><span class="op" id="6515771">.</span><span class="ident" id="6515772">Read</span><span class="op" id="6515776">(</span><span class="ident" id="6515777">m</span><span class="op" id="6515778">[</span><span class="op" id="6515779">:</span><span class="op" id="6515780">]</span><span class="op" id="6515781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515785">return</span>&nbsp;<span class="ident" id="6515792">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515801">go</span>&nbsp;<span class="keyword" id="6515804">func</span><span class="op" id="6515808">(</span><span class="op" id="6515809">)</span>&nbsp;<span class="op" id="6515811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515815">c</span><span class="op" id="6515816">,</span>&nbsp;<span class="ident" id="6515818">err</span>&nbsp;<span class="op" id="6515822">:=</span>&nbsp;<span class="ident" id="6515825">Dial</span><span class="op" id="6515829">(</span><span class="string" id="6515830">&#34;tcp&#34;</span><span class="op" id="6515835">,</span>&nbsp;<span class="ident" id="6515837">l</span><span class="op" id="6515838">.</span><span class="ident" id="6515839">Addr</span><span class="op" id="6515843">(</span><span class="op" id="6515844">)</span><span class="op" id="6515845">.</span><span class="ident" id="6515846">String</span><span class="op" id="6515852">(</span><span class="op" id="6515853">)</span><span class="op" id="6515854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515858">if</span>&nbsp;<span class="ident" id="6515861">err</span>&nbsp;<span class="op" id="6515865">!=</span>&nbsp;<span class="builtintype" id="6515868">nil</span>&nbsp;<span class="op" id="6515872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515877">t</span><span class="op" id="6515878">.</span><span class="ident" id="6515879">Errorf</span><span class="op" id="6515885">(</span><span class="string" id="6515886">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6515896">,</span>&nbsp;<span class="ident" id="6515898">err</span><span class="op" id="6515901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515906">return</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515920">go</span>&nbsp;<span class="ident" id="6515923">read</span><span class="op" id="6515927">(</span><span class="ident" id="6515928">c</span><span class="op" id="6515929">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515934">time</span><span class="op" id="6515938">.</span><span class="ident" id="6515939">Sleep</span><span class="op" id="6515944">(</span><span class="num" id="6515945">10</span>&nbsp;<span class="op" id="6515948">*</span>&nbsp;<span class="ident" id="6515950">time</span><span class="op" id="6515954">.</span><span class="ident" id="6515955">Millisecond</span><span class="op" id="6515966">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515970">c</span><span class="op" id="6515971">.</span><span class="ident" id="6515972">Close</span><span class="op" id="6515977">(</span><span class="op" id="6515978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515981">}</span><span class="op" id="6515982">(</span><span class="op" id="6515983">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515987">c</span><span class="op" id="6515988">,</span>&nbsp;<span class="ident" id="6515990">err</span>&nbsp;<span class="op" id="6515994">:=</span>&nbsp;<span class="ident" id="6515997">l</span><span class="op" id="6515998">.</span><span class="ident" id="6515999">Accept</span><span class="op" id="6516005">(</span><span class="op" id="6516006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516009">if</span>&nbsp;<span class="ident" id="6516012">err</span>&nbsp;<span class="op" id="6516016">!=</span>&nbsp;<span class="builtintype" id="6516019">nil</span>&nbsp;<span class="op" id="6516023">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516027">t</span><span class="op" id="6516028">.</span><span class="ident" id="6516029">Fatal</span><span class="op" id="6516034">(</span><span class="ident" id="6516035">err</span><span class="op" id="6516038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6516041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516044">defer</span>&nbsp;<span class="ident" id="6516050">c</span><span class="op" id="6516051">.</span><span class="ident" id="6516052">Close</span><span class="op" id="6516057">(</span><span class="op" id="6516058">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516062">for</span>&nbsp;<span class="ident" id="6516066">err</span>&nbsp;<span class="op" id="6516070">==</span>&nbsp;<span class="builtintype" id="6516073">nil</span>&nbsp;<span class="op" id="6516077">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516081">err</span>&nbsp;<span class="op" id="6516085">=</span>&nbsp;<span class="ident" id="6516087">read</span><span class="op" id="6516091">(</span><span class="ident" id="6516092">c</span><span class="op" id="6516093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6516096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516099">if</span>&nbsp;<span class="ident" id="6516102">err</span>&nbsp;<span class="op" id="6516106">!=</span>&nbsp;<span class="builtintype" id="6516109">nil</span>&nbsp;<span class="op" id="6516113">&amp;&amp;</span>&nbsp;<span class="ident" id="6516116">err</span>&nbsp;<span class="op" id="6516120">!=</span>&nbsp;<span class="ident" id="6516123">io</span><span class="op" id="6516125">.</span><span class="ident" id="6516126">EOF</span>&nbsp;<span class="op" id="6516130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516134">t</span><span class="op" id="6516135">.</span><span class="ident" id="6516136">Fatal</span><span class="op" id="6516141">(</span><span class="ident" id="6516142">err</span><span class="op" id="6516145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6516148">}</span><br>
<span class="lineno">225</span><span class="op" id="6516150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6516153">func</span>&nbsp;<span class="ident" id="6516158">TestErrorNil</span><span class="op" id="6516170">(</span><span class="ident" id="6516171">t</span>&nbsp;<span class="op" id="6516173">*</span><span class="ident" id="6516174">testing</span><span class="op" id="6516181">.</span><span class="ident" id="6516182">T</span><span class="op" id="6516183">)</span>&nbsp;<span class="op" id="6516185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516188">c</span><span class="op" id="6516189">,</span>&nbsp;<span class="ident" id="6516191">err</span>&nbsp;<span class="op" id="6516195">:=</span>&nbsp;<span class="ident" id="6516198">Dial</span><span class="op" id="6516202">(</span><span class="string" id="6516203">&#34;tcp&#34;</span><span class="op" id="6516208">,</span>&nbsp;<span class="string" id="6516210">&#34;127.0.0.1:65535&#34;</span><span class="op" id="6516227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516230">if</span>&nbsp;<span class="ident" id="6516233">err</span>&nbsp;<span class="op" id="6516237">==</span>&nbsp;<span class="builtintype" id="6516240">nil</span>&nbsp;<span class="op" id="6516244">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516248">t</span><span class="op" id="6516249">.</span><span class="ident" id="6516250">Fatal</span><span class="op" id="6516255">(</span><span class="string" id="6516256">&#34;Dial&nbsp;127.0.0.1:65535&nbsp;succeeded&#34;</span><span class="op" id="6516288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6516291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516294">if</span>&nbsp;<span class="ident" id="6516297">c</span>&nbsp;<span class="op" id="6516299">!=</span>&nbsp;<span class="builtintype" id="6516302">nil</span>&nbsp;<span class="op" id="6516306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516310">t</span><span class="op" id="6516311">.</span><span class="ident" id="6516312">Fatalf</span><span class="op" id="6516318">(</span><span class="string" id="6516319">&#34;Dial&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6516375">,</span>&nbsp;<span class="ident" id="6516377">c</span><span class="op" id="6516378">,</span>&nbsp;<span class="ident" id="6516380">c</span><span class="op" id="6516381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6516384">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6516388">//&nbsp;Make&nbsp;Listen&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516445">l</span><span class="op" id="6516446">,</span>&nbsp;<span class="ident" id="6516448">err</span>&nbsp;<span class="op" id="6516452">:=</span>&nbsp;<span class="ident" id="6516455">Listen</span><span class="op" id="6516461">(</span><span class="string" id="6516462">&#34;tcp&#34;</span><span class="op" id="6516467">,</span>&nbsp;<span class="string" id="6516469">&#34;127.0.0.1:0&#34;</span><span class="op" id="6516482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516485">if</span>&nbsp;<span class="ident" id="6516488">err</span>&nbsp;<span class="op" id="6516492">!=</span>&nbsp;<span class="builtintype" id="6516495">nil</span>&nbsp;<span class="op" id="6516499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516503">t</span><span class="op" id="6516504">.</span><span class="ident" id="6516505">Fatalf</span><span class="op" id="6516511">(</span><span class="string" id="6516512">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="6516536">,</span>&nbsp;<span class="ident" id="6516538">err</span><span class="op" id="6516541">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6516544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516547">defer</span>&nbsp;<span class="ident" id="6516553">l</span><span class="op" id="6516554">.</span><span class="ident" id="6516555">Close</span><span class="op" id="6516560">(</span><span class="op" id="6516561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516564">l1</span><span class="op" id="6516566">,</span>&nbsp;<span class="ident" id="6516568">err</span>&nbsp;<span class="op" id="6516572">:=</span>&nbsp;<span class="ident" id="6516575">Listen</span><span class="op" id="6516581">(</span><span class="string" id="6516582">&#34;tcp&#34;</span><span class="op" id="6516587">,</span>&nbsp;<span class="ident" id="6516589">l</span><span class="op" id="6516590">.</span><span class="ident" id="6516591">Addr</span><span class="op" id="6516595">(</span><span class="op" id="6516596">)</span><span class="op" id="6516597">.</span><span class="ident" id="6516598">String</span><span class="op" id="6516604">(</span><span class="op" id="6516605">)</span><span class="op" id="6516606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516609">if</span>&nbsp;<span class="ident" id="6516612">err</span>&nbsp;<span class="op" id="6516616">==</span>&nbsp;<span class="builtintype" id="6516619">nil</span>&nbsp;<span class="op" id="6516623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516627">t</span><span class="op" id="6516628">.</span><span class="ident" id="6516629">Fatalf</span><span class="op" id="6516635">(</span><span class="string" id="6516636">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="6516658">,</span>&nbsp;<span class="ident" id="6516660">l</span><span class="op" id="6516661">.</span><span class="ident" id="6516662">Addr</span><span class="op" id="6516666">(</span><span class="op" id="6516667">)</span><span class="op" id="6516668">,</span>&nbsp;<span class="ident" id="6516670">err</span><span class="op" id="6516673">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6516676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516679">if</span>&nbsp;<span class="ident" id="6516682">l1</span>&nbsp;<span class="op" id="6516685">!=</span>&nbsp;<span class="builtintype" id="6516688">nil</span>&nbsp;<span class="op" id="6516692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516696">t</span><span class="op" id="6516697">.</span><span class="ident" id="6516698">Fatalf</span><span class="op" id="6516704">(</span><span class="string" id="6516705">&#34;Listen&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6516763">,</span>&nbsp;<span class="ident" id="6516765">l1</span><span class="op" id="6516767">,</span>&nbsp;<span class="ident" id="6516769">l1</span><span class="op" id="6516771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6516774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6516778">//&nbsp;Make&nbsp;ListenPacket&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516841">lp</span><span class="op" id="6516843">,</span>&nbsp;<span class="ident" id="6516845">err</span>&nbsp;<span class="op" id="6516849">:=</span>&nbsp;<span class="ident" id="6516852">ListenPacket</span><span class="op" id="6516864">(</span><span class="string" id="6516865">&#34;udp&#34;</span><span class="op" id="6516870">,</span>&nbsp;<span class="string" id="6516872">&#34;127.0.0.1:0&#34;</span><span class="op" id="6516885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516888">if</span>&nbsp;<span class="ident" id="6516891">err</span>&nbsp;<span class="op" id="6516895">!=</span>&nbsp;<span class="builtintype" id="6516898">nil</span>&nbsp;<span class="op" id="6516902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516906">t</span><span class="op" id="6516907">.</span><span class="ident" id="6516908">Fatalf</span><span class="op" id="6516914">(</span><span class="string" id="6516915">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="6516939">,</span>&nbsp;<span class="ident" id="6516941">err</span><span class="op" id="6516944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6516947">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516950">defer</span>&nbsp;<span class="ident" id="6516956">lp</span><span class="op" id="6516958">.</span><span class="ident" id="6516959">Close</span><span class="op" id="6516964">(</span><span class="op" id="6516965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516968">lp1</span><span class="op" id="6516971">,</span>&nbsp;<span class="ident" id="6516973">err</span>&nbsp;<span class="op" id="6516977">:=</span>&nbsp;<span class="ident" id="6516980">ListenPacket</span><span class="op" id="6516992">(</span><span class="string" id="6516993">&#34;udp&#34;</span><span class="op" id="6516998">,</span>&nbsp;<span class="ident" id="6517000">lp</span><span class="op" id="6517002">.</span><span class="ident" id="6517003">LocalAddr</span><span class="op" id="6517012">(</span><span class="op" id="6517013">)</span><span class="op" id="6517014">.</span><span class="ident" id="6517015">String</span><span class="op" id="6517021">(</span><span class="op" id="6517022">)</span><span class="op" id="6517023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6517026">if</span>&nbsp;<span class="ident" id="6517029">err</span>&nbsp;<span class="op" id="6517033">==</span>&nbsp;<span class="builtintype" id="6517036">nil</span>&nbsp;<span class="op" id="6517040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6517044">t</span><span class="op" id="6517045">.</span><span class="ident" id="6517046">Fatalf</span><span class="op" id="6517052">(</span><span class="string" id="6517053">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="6517075">,</span>&nbsp;<span class="ident" id="6517077">lp</span><span class="op" id="6517079">.</span><span class="ident" id="6517080">LocalAddr</span><span class="op" id="6517089">(</span><span class="op" id="6517090">)</span><span class="op" id="6517091">,</span>&nbsp;<span class="ident" id="6517093">err</span><span class="op" id="6517096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6517099">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6517102">if</span>&nbsp;<span class="ident" id="6517105">lp1</span>&nbsp;<span class="op" id="6517109">!=</span>&nbsp;<span class="builtintype" id="6517112">nil</span>&nbsp;<span class="op" id="6517116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6517120">t</span><span class="op" id="6517121">.</span><span class="ident" id="6517122">Fatalf</span><span class="op" id="6517128">(</span><span class="string" id="6517129">&#34;ListenPacket&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6517193">,</span>&nbsp;<span class="ident" id="6517195">lp1</span><span class="op" id="6517198">,</span>&nbsp;<span class="ident" id="6517200">lp1</span><span class="op" id="6517203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6517206">}</span><br>
<span class="lineno"></span><span class="op" id="6517208">}</span>
</div>
</body>
</html>
