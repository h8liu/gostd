<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html" class="current">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4016958">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4017013">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4017067">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4017118">package</span>&nbsp;<span class="ident" id="4017126">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4017131">import</span>&nbsp;<span class="op" id="4017138">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4017141">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4017158">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4017168">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4017171">//&nbsp;The&nbsp;DES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4017203">const</span>&nbsp;<span class="ident" id="4017209">BlockSize</span>&nbsp;<span class="op" id="4017219">=</span>&nbsp;<span class="num" id="4017221">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4017224">type</span>&nbsp;<span class="ident" id="4017229">KeySizeError</span>&nbsp;<span class="builtintype" id="4017242">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4017247">func</span>&nbsp;<span class="op" id="4017252">(</span><span class="ident" id="4017253">k</span>&nbsp;<span class="ident" id="4017255">KeySizeError</span><span class="op" id="4017267">)</span>&nbsp;<span class="ident" id="4017269">Error</span><span class="op" id="4017274">(</span><span class="op" id="4017275">)</span>&nbsp;<span class="builtintype" id="4017277">string</span>&nbsp;<span class="op" id="4017284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4017287">return</span>&nbsp;<span class="string" id="4017294">&#34;crypto/des:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="4017326">+</span>&nbsp;<span class="ident" id="4017328">strconv</span><span class="op" id="4017335">.</span><span class="ident" id="4017336">Itoa</span><span class="op" id="4017340">(</span><span class="builtintype" id="4017341">int</span><span class="op" id="4017344">(</span><span class="ident" id="4017345">k</span><span class="op" id="4017346">)</span><span class="op" id="4017347">)</span><br>
<span class="lineno"></span><span class="op" id="4017349">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="4017352">//&nbsp;desCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;DES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="4017399">type</span>&nbsp;<span class="ident" id="4017404">desCipher</span>&nbsp;<span class="keyword" id="4017414">struct</span>&nbsp;<span class="op" id="4017421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017424">subkeys</span>&nbsp;<span class="op" id="4017432">[</span><span class="num" id="4017433">16</span><span class="op" id="4017435">]</span><span class="ident" id="4017436">uint64</span><br>
<span class="lineno"></span><span class="op" id="4017443">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4017446">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="4017499">func</span>&nbsp;<span class="ident" id="4017504">NewCipher</span><span class="op" id="4017513">(</span><span class="ident" id="4017514">key</span>&nbsp;<span class="op" id="4017518">[</span><span class="op" id="4017519">]</span><span class="builtintype" id="4017520">byte</span><span class="op" id="4017524">)</span>&nbsp;<span class="op" id="4017526">(</span><span class="ident" id="4017527">cipher</span><span class="op" id="4017533">.</span><span class="ident" id="4017534">Block</span><span class="op" id="4017539">,</span>&nbsp;<span class="builtintype" id="4017541">error</span><span class="op" id="4017546">)</span>&nbsp;<span class="op" id="4017548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4017551">if</span>&nbsp;<span class="builtinfunc" id="4017554">len</span><span class="op" id="4017557">(</span><span class="ident" id="4017558">key</span><span class="op" id="4017561">)</span>&nbsp;<span class="op" id="4017563">!=</span>&nbsp;<span class="num" id="4017566">8</span>&nbsp;<span class="op" id="4017568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4017572">return</span>&nbsp;<span class="ident" id="4017579">nil</span><span class="op" id="4017582">,</span>&nbsp;<span class="ident" id="4017584">KeySizeError</span><span class="op" id="4017596">(</span><span class="builtinfunc" id="4017597">len</span><span class="op" id="4017600">(</span><span class="ident" id="4017601">key</span><span class="op" id="4017604">)</span><span class="op" id="4017605">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4017608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017612">c</span>&nbsp;<span class="op" id="4017614">:=</span>&nbsp;<span class="builtinfunc" id="4017617">new</span><span class="op" id="4017620">(</span><span class="ident" id="4017621">desCipher</span><span class="op" id="4017630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017633">c</span><span class="op" id="4017634">.</span><span class="ident" id="4017635">generateSubkeys</span><span class="op" id="4017650">(</span><span class="ident" id="4017651">key</span><span class="op" id="4017654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4017657">return</span>&nbsp;<span class="ident" id="4017664">c</span><span class="op" id="4017665">,</span>&nbsp;<span class="ident" id="4017667">nil</span><br>
<span class="lineno">35</span><span class="op" id="4017671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4017674">func</span>&nbsp;<span class="op" id="4017679">(</span><span class="ident" id="4017680">c</span>&nbsp;<span class="op" id="4017682">*</span><span class="ident" id="4017683">desCipher</span><span class="op" id="4017692">)</span>&nbsp;<span class="ident" id="4017694">BlockSize</span><span class="op" id="4017703">(</span><span class="op" id="4017704">)</span>&nbsp;<span class="builtintype" id="4017706">int</span>&nbsp;<span class="op" id="4017710">{</span>&nbsp;<span class="keyword" id="4017712">return</span>&nbsp;<span class="ident" id="4017719">BlockSize</span>&nbsp;<span class="op" id="4017729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4017732">func</span>&nbsp;<span class="op" id="4017737">(</span><span class="ident" id="4017738">c</span>&nbsp;<span class="op" id="4017740">*</span><span class="ident" id="4017741">desCipher</span><span class="op" id="4017750">)</span>&nbsp;<span class="ident" id="4017752">Encrypt</span><span class="op" id="4017759">(</span><span class="ident" id="4017760">dst</span><span class="op" id="4017763">,</span>&nbsp;<span class="ident" id="4017765">src</span>&nbsp;<span class="op" id="4017769">[</span><span class="op" id="4017770">]</span><span class="builtintype" id="4017771">byte</span><span class="op" id="4017775">)</span>&nbsp;<span class="op" id="4017777">{</span>&nbsp;<span class="ident" id="4017779">encryptBlock</span><span class="op" id="4017791">(</span><span class="ident" id="4017792">c</span><span class="op" id="4017793">.</span><span class="ident" id="4017794">subkeys</span><span class="op" id="4017801">[</span><span class="op" id="4017802">:</span><span class="op" id="4017803">]</span><span class="op" id="4017804">,</span>&nbsp;<span class="ident" id="4017806">dst</span><span class="op" id="4017809">,</span>&nbsp;<span class="ident" id="4017811">src</span><span class="op" id="4017814">)</span>&nbsp;<span class="op" id="4017816">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4017819">func</span>&nbsp;<span class="op" id="4017824">(</span><span class="ident" id="4017825">c</span>&nbsp;<span class="op" id="4017827">*</span><span class="ident" id="4017828">desCipher</span><span class="op" id="4017837">)</span>&nbsp;<span class="ident" id="4017839">Decrypt</span><span class="op" id="4017846">(</span><span class="ident" id="4017847">dst</span><span class="op" id="4017850">,</span>&nbsp;<span class="ident" id="4017852">src</span>&nbsp;<span class="op" id="4017856">[</span><span class="op" id="4017857">]</span><span class="builtintype" id="4017858">byte</span><span class="op" id="4017862">)</span>&nbsp;<span class="op" id="4017864">{</span>&nbsp;<span class="ident" id="4017866">decryptBlock</span><span class="op" id="4017878">(</span><span class="ident" id="4017879">c</span><span class="op" id="4017880">.</span><span class="ident" id="4017881">subkeys</span><span class="op" id="4017888">[</span><span class="op" id="4017889">:</span><span class="op" id="4017890">]</span><span class="op" id="4017891">,</span>&nbsp;<span class="ident" id="4017893">dst</span><span class="op" id="4017896">,</span>&nbsp;<span class="ident" id="4017898">src</span><span class="op" id="4017901">)</span>&nbsp;<span class="op" id="4017903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4017906">//&nbsp;A&nbsp;tripleDESCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;TripleDES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="4017967">type</span>&nbsp;<span class="ident" id="4017972">tripleDESCipher</span>&nbsp;<span class="keyword" id="4017988">struct</span>&nbsp;<span class="op" id="4017995">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017998">cipher1</span><span class="op" id="4018005">,</span>&nbsp;<span class="ident" id="4018007">cipher2</span><span class="op" id="4018014">,</span>&nbsp;<span class="ident" id="4018016">cipher3</span>&nbsp;<span class="ident" id="4018024">desCipher</span><br>
<span class="lineno"></span><span class="op" id="4018034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4018037">//&nbsp;NewTripleDESCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="4018099">func</span>&nbsp;<span class="ident" id="4018104">NewTripleDESCipher</span><span class="op" id="4018122">(</span><span class="ident" id="4018123">key</span>&nbsp;<span class="op" id="4018127">[</span><span class="op" id="4018128">]</span><span class="builtintype" id="4018129">byte</span><span class="op" id="4018133">)</span>&nbsp;<span class="op" id="4018135">(</span><span class="ident" id="4018136">cipher</span><span class="op" id="4018142">.</span><span class="ident" id="4018143">Block</span><span class="op" id="4018148">,</span>&nbsp;<span class="builtintype" id="4018150">error</span><span class="op" id="4018155">)</span>&nbsp;<span class="op" id="4018157">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4018160">if</span>&nbsp;<span class="builtinfunc" id="4018163">len</span><span class="op" id="4018166">(</span><span class="ident" id="4018167">key</span><span class="op" id="4018170">)</span>&nbsp;<span class="op" id="4018172">!=</span>&nbsp;<span class="num" id="4018175">24</span>&nbsp;<span class="op" id="4018178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4018182">return</span>&nbsp;<span class="ident" id="4018189">nil</span><span class="op" id="4018192">,</span>&nbsp;<span class="ident" id="4018194">KeySizeError</span><span class="op" id="4018206">(</span><span class="builtinfunc" id="4018207">len</span><span class="op" id="4018210">(</span><span class="ident" id="4018211">key</span><span class="op" id="4018214">)</span><span class="op" id="4018215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4018218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018222">c</span>&nbsp;<span class="op" id="4018224">:=</span>&nbsp;<span class="builtinfunc" id="4018227">new</span><span class="op" id="4018230">(</span><span class="ident" id="4018231">tripleDESCipher</span><span class="op" id="4018246">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018249">c</span><span class="op" id="4018250">.</span><span class="ident" id="4018251">cipher1</span><span class="op" id="4018258">.</span><span class="ident" id="4018259">generateSubkeys</span><span class="op" id="4018274">(</span><span class="ident" id="4018275">key</span><span class="op" id="4018278">[</span><span class="op" id="4018279">:</span><span class="num" id="4018280">8</span><span class="op" id="4018281">]</span><span class="op" id="4018282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018285">c</span><span class="op" id="4018286">.</span><span class="ident" id="4018287">cipher2</span><span class="op" id="4018294">.</span><span class="ident" id="4018295">generateSubkeys</span><span class="op" id="4018310">(</span><span class="ident" id="4018311">key</span><span class="op" id="4018314">[</span><span class="num" id="4018315">8</span><span class="op" id="4018316">:</span><span class="num" id="4018317">16</span><span class="op" id="4018319">]</span><span class="op" id="4018320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018323">c</span><span class="op" id="4018324">.</span><span class="ident" id="4018325">cipher3</span><span class="op" id="4018332">.</span><span class="ident" id="4018333">generateSubkeys</span><span class="op" id="4018348">(</span><span class="ident" id="4018349">key</span><span class="op" id="4018352">[</span><span class="num" id="4018353">16</span><span class="op" id="4018355">:</span><span class="op" id="4018356">]</span><span class="op" id="4018357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4018360">return</span>&nbsp;<span class="ident" id="4018367">c</span><span class="op" id="4018368">,</span>&nbsp;<span class="ident" id="4018370">nil</span><br>
<span class="lineno"></span><span class="op" id="4018374">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="4018377">func</span>&nbsp;<span class="op" id="4018382">(</span><span class="ident" id="4018383">c</span>&nbsp;<span class="op" id="4018385">*</span><span class="ident" id="4018386">tripleDESCipher</span><span class="op" id="4018401">)</span>&nbsp;<span class="ident" id="4018403">BlockSize</span><span class="op" id="4018412">(</span><span class="op" id="4018413">)</span>&nbsp;<span class="builtintype" id="4018415">int</span>&nbsp;<span class="op" id="4018419">{</span>&nbsp;<span class="keyword" id="4018421">return</span>&nbsp;<span class="ident" id="4018428">BlockSize</span>&nbsp;<span class="op" id="4018438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4018441">func</span>&nbsp;<span class="op" id="4018446">(</span><span class="ident" id="4018447">c</span>&nbsp;<span class="op" id="4018449">*</span><span class="ident" id="4018450">tripleDESCipher</span><span class="op" id="4018465">)</span>&nbsp;<span class="ident" id="4018467">Encrypt</span><span class="op" id="4018474">(</span><span class="ident" id="4018475">dst</span><span class="op" id="4018478">,</span>&nbsp;<span class="ident" id="4018480">src</span>&nbsp;<span class="op" id="4018484">[</span><span class="op" id="4018485">]</span><span class="builtintype" id="4018486">byte</span><span class="op" id="4018490">)</span>&nbsp;<span class="op" id="4018492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018495">c</span><span class="op" id="4018496">.</span><span class="ident" id="4018497">cipher1</span><span class="op" id="4018504">.</span><span class="ident" id="4018505">Encrypt</span><span class="op" id="4018512">(</span><span class="ident" id="4018513">dst</span><span class="op" id="4018516">,</span>&nbsp;<span class="ident" id="4018518">src</span><span class="op" id="4018521">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018524">c</span><span class="op" id="4018525">.</span><span class="ident" id="4018526">cipher2</span><span class="op" id="4018533">.</span><span class="ident" id="4018534">Decrypt</span><span class="op" id="4018541">(</span><span class="ident" id="4018542">dst</span><span class="op" id="4018545">,</span>&nbsp;<span class="ident" id="4018547">dst</span><span class="op" id="4018550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018553">c</span><span class="op" id="4018554">.</span><span class="ident" id="4018555">cipher3</span><span class="op" id="4018562">.</span><span class="ident" id="4018563">Encrypt</span><span class="op" id="4018570">(</span><span class="ident" id="4018571">dst</span><span class="op" id="4018574">,</span>&nbsp;<span class="ident" id="4018576">dst</span><span class="op" id="4018579">)</span><br>
<span class="lineno"></span><span class="op" id="4018581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4018584">func</span>&nbsp;<span class="op" id="4018589">(</span><span class="ident" id="4018590">c</span>&nbsp;<span class="op" id="4018592">*</span><span class="ident" id="4018593">tripleDESCipher</span><span class="op" id="4018608">)</span>&nbsp;<span class="ident" id="4018610">Decrypt</span><span class="op" id="4018617">(</span><span class="ident" id="4018618">dst</span><span class="op" id="4018621">,</span>&nbsp;<span class="ident" id="4018623">src</span>&nbsp;<span class="op" id="4018627">[</span><span class="op" id="4018628">]</span><span class="builtintype" id="4018629">byte</span><span class="op" id="4018633">)</span>&nbsp;<span class="op" id="4018635">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018638">c</span><span class="op" id="4018639">.</span><span class="ident" id="4018640">cipher3</span><span class="op" id="4018647">.</span><span class="ident" id="4018648">Decrypt</span><span class="op" id="4018655">(</span><span class="ident" id="4018656">dst</span><span class="op" id="4018659">,</span>&nbsp;<span class="ident" id="4018661">src</span><span class="op" id="4018664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018667">c</span><span class="op" id="4018668">.</span><span class="ident" id="4018669">cipher2</span><span class="op" id="4018676">.</span><span class="ident" id="4018677">Encrypt</span><span class="op" id="4018684">(</span><span class="ident" id="4018685">dst</span><span class="op" id="4018688">,</span>&nbsp;<span class="ident" id="4018690">dst</span><span class="op" id="4018693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018696">c</span><span class="op" id="4018697">.</span><span class="ident" id="4018698">cipher1</span><span class="op" id="4018705">.</span><span class="ident" id="4018706">Decrypt</span><span class="op" id="4018713">(</span><span class="ident" id="4018714">dst</span><span class="op" id="4018717">,</span>&nbsp;<span class="ident" id="4018719">dst</span><span class="op" id="4018722">)</span><br>
<span class="lineno"></span><span class="op" id="4018724">}</span>
</div>
</body>
</html>
