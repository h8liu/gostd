<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html" class="current">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2255096">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2255151">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2255205">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2255256">package</span>&nbsp;<span class="ident" id="2255264">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2255273">//&nbsp;An&nbsp;extFloat&nbsp;represents&nbsp;an&nbsp;extended&nbsp;floating-point&nbsp;number,&nbsp;with&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="2255344">//&nbsp;precision&nbsp;than&nbsp;a&nbsp;float64.&nbsp;It&nbsp;does&nbsp;not&nbsp;try&nbsp;to&nbsp;save&nbsp;bits:&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2255407">//&nbsp;number&nbsp;represented&nbsp;by&nbsp;the&nbsp;structure&nbsp;is&nbsp;mant*(2^exp),&nbsp;with&nbsp;a&nbsp;negative</span><br>
<span class="lineno">10</span><span class="comment" id="2255479">//&nbsp;sign&nbsp;if&nbsp;neg&nbsp;is&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="2255503">type</span>&nbsp;<span class="ident" id="2255508">extFloat</span>&nbsp;<span class="keyword" id="2255517">struct</span>&nbsp;<span class="op" id="2255524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255527">mant</span>&nbsp;<span class="ident" id="2255532">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255540">exp</span>&nbsp;&nbsp;<span class="builtintype" id="2255545">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255550">neg</span>&nbsp;&nbsp;<span class="builtintype" id="2255555">bool</span><br>
<span class="lineno">15</span><span class="op" id="2255560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2255563">//&nbsp;Powers&nbsp;of&nbsp;ten&nbsp;taken&nbsp;from&nbsp;double-conversion&nbsp;library.</span><br>
<span class="lineno"></span><span class="comment" id="2255618">//&nbsp;http://code.google.com/p/double-conversion/</span><br>
<span class="lineno"></span><span class="keyword" id="2255665">const</span>&nbsp;<span class="op" id="2255671">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255674">firstPowerOfTen</span>&nbsp;<span class="op" id="2255690">=</span>&nbsp;<span class="op" id="2255692">-</span><span class="num" id="2255693">348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255698">stepPowerOfTen</span>&nbsp;&nbsp;<span class="op" id="2255714">=</span>&nbsp;<span class="num" id="2255716">8</span><br>
<span class="lineno"></span><span class="op" id="2255718">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2255721">var</span>&nbsp;<span class="ident" id="2255725">smallPowersOfTen</span>&nbsp;<span class="op" id="2255742">=</span>&nbsp;<span class="op" id="2255744">[</span><span class="op" id="2255745">...</span><span class="op" id="2255748">]</span><span class="ident" id="2255749">extFloat</span><span class="op" id="2255757">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255760">{</span><span class="num" id="2255761">1</span>&nbsp;<span class="op" id="2255763">&lt;&lt;</span>&nbsp;<span class="num" id="2255766">63</span><span class="op" id="2255768">,</span>&nbsp;<span class="op" id="2255770">-</span><span class="num" id="2255771">63</span><span class="op" id="2255773">,</span>&nbsp;<span class="builtintype" id="2255775">false</span><span class="op" id="2255780">}</span><span class="op" id="2255781">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2255790">//&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255796">{</span><span class="num" id="2255797">0xa</span>&nbsp;<span class="op" id="2255801">&lt;&lt;</span>&nbsp;<span class="num" id="2255804">60</span><span class="op" id="2255806">,</span>&nbsp;<span class="op" id="2255808">-</span><span class="num" id="2255809">60</span><span class="op" id="2255811">,</span>&nbsp;<span class="builtintype" id="2255813">false</span><span class="op" id="2255818">}</span><span class="op" id="2255819">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2255826">//&nbsp;1e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255834">{</span><span class="num" id="2255835">0x64</span>&nbsp;<span class="op" id="2255840">&lt;&lt;</span>&nbsp;<span class="num" id="2255843">57</span><span class="op" id="2255845">,</span>&nbsp;<span class="op" id="2255847">-</span><span class="num" id="2255848">57</span><span class="op" id="2255850">,</span>&nbsp;<span class="builtintype" id="2255852">false</span><span class="op" id="2255857">}</span><span class="op" id="2255858">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2255864">//&nbsp;1e2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255872">{</span><span class="num" id="2255873">0x3e8</span>&nbsp;<span class="op" id="2255879">&lt;&lt;</span>&nbsp;<span class="num" id="2255882">54</span><span class="op" id="2255884">,</span>&nbsp;<span class="op" id="2255886">-</span><span class="num" id="2255887">54</span><span class="op" id="2255889">,</span>&nbsp;<span class="builtintype" id="2255891">false</span><span class="op" id="2255896">}</span><span class="op" id="2255897">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2255902">//&nbsp;1e3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255910">{</span><span class="num" id="2255911">0x2710</span>&nbsp;<span class="op" id="2255918">&lt;&lt;</span>&nbsp;<span class="num" id="2255921">50</span><span class="op" id="2255923">,</span>&nbsp;<span class="op" id="2255925">-</span><span class="num" id="2255926">50</span><span class="op" id="2255928">,</span>&nbsp;<span class="builtintype" id="2255930">false</span><span class="op" id="2255935">}</span><span class="op" id="2255936">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2255940">//&nbsp;1e4</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255948">{</span><span class="num" id="2255949">0x186a0</span>&nbsp;<span class="op" id="2255957">&lt;&lt;</span>&nbsp;<span class="num" id="2255960">47</span><span class="op" id="2255962">,</span>&nbsp;<span class="op" id="2255964">-</span><span class="num" id="2255965">47</span><span class="op" id="2255967">,</span>&nbsp;<span class="builtintype" id="2255969">false</span><span class="op" id="2255974">}</span><span class="op" id="2255975">,</span>&nbsp;&nbsp;<span class="comment" id="2255978">//&nbsp;1e5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255986">{</span><span class="num" id="2255987">0xf4240</span>&nbsp;<span class="op" id="2255995">&lt;&lt;</span>&nbsp;<span class="num" id="2255998">44</span><span class="op" id="2256000">,</span>&nbsp;<span class="op" id="2256002">-</span><span class="num" id="2256003">44</span><span class="op" id="2256005">,</span>&nbsp;<span class="builtintype" id="2256007">false</span><span class="op" id="2256012">}</span><span class="op" id="2256013">,</span>&nbsp;&nbsp;<span class="comment" id="2256016">//&nbsp;1e6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256024">{</span><span class="num" id="2256025">0x989680</span>&nbsp;<span class="op" id="2256034">&lt;&lt;</span>&nbsp;<span class="num" id="2256037">40</span><span class="op" id="2256039">,</span>&nbsp;<span class="op" id="2256041">-</span><span class="num" id="2256042">40</span><span class="op" id="2256044">,</span>&nbsp;<span class="builtintype" id="2256046">false</span><span class="op" id="2256051">}</span><span class="op" id="2256052">,</span>&nbsp;<span class="comment" id="2256054">//&nbsp;1e7</span><br>
<span class="lineno"></span><span class="op" id="2256061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="2256064">var</span>&nbsp;<span class="ident" id="2256068">powersOfTen</span>&nbsp;<span class="op" id="2256080">=</span>&nbsp;<span class="op" id="2256082">[</span><span class="op" id="2256083">...</span><span class="op" id="2256086">]</span><span class="ident" id="2256087">extFloat</span><span class="op" id="2256095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256098">{</span><span class="num" id="2256099">0xfa8fd5a0081c0288</span><span class="op" id="2256117">,</span>&nbsp;<span class="op" id="2256119">-</span><span class="num" id="2256120">1220</span><span class="op" id="2256124">,</span>&nbsp;<span class="builtintype" id="2256126">false</span><span class="op" id="2256131">}</span><span class="op" id="2256132">,</span>&nbsp;<span class="comment" id="2256134">//&nbsp;10^-348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256146">{</span><span class="num" id="2256147">0xbaaee17fa23ebf76</span><span class="op" id="2256165">,</span>&nbsp;<span class="op" id="2256167">-</span><span class="num" id="2256168">1193</span><span class="op" id="2256172">,</span>&nbsp;<span class="builtintype" id="2256174">false</span><span class="op" id="2256179">}</span><span class="op" id="2256180">,</span>&nbsp;<span class="comment" id="2256182">//&nbsp;10^-340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256194">{</span><span class="num" id="2256195">0x8b16fb203055ac76</span><span class="op" id="2256213">,</span>&nbsp;<span class="op" id="2256215">-</span><span class="num" id="2256216">1166</span><span class="op" id="2256220">,</span>&nbsp;<span class="builtintype" id="2256222">false</span><span class="op" id="2256227">}</span><span class="op" id="2256228">,</span>&nbsp;<span class="comment" id="2256230">//&nbsp;10^-332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256242">{</span><span class="num" id="2256243">0xcf42894a5dce35ea</span><span class="op" id="2256261">,</span>&nbsp;<span class="op" id="2256263">-</span><span class="num" id="2256264">1140</span><span class="op" id="2256268">,</span>&nbsp;<span class="builtintype" id="2256270">false</span><span class="op" id="2256275">}</span><span class="op" id="2256276">,</span>&nbsp;<span class="comment" id="2256278">//&nbsp;10^-324</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256290">{</span><span class="num" id="2256291">0x9a6bb0aa55653b2d</span><span class="op" id="2256309">,</span>&nbsp;<span class="op" id="2256311">-</span><span class="num" id="2256312">1113</span><span class="op" id="2256316">,</span>&nbsp;<span class="builtintype" id="2256318">false</span><span class="op" id="2256323">}</span><span class="op" id="2256324">,</span>&nbsp;<span class="comment" id="2256326">//&nbsp;10^-316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256338">{</span><span class="num" id="2256339">0xe61acf033d1a45df</span><span class="op" id="2256357">,</span>&nbsp;<span class="op" id="2256359">-</span><span class="num" id="2256360">1087</span><span class="op" id="2256364">,</span>&nbsp;<span class="builtintype" id="2256366">false</span><span class="op" id="2256371">}</span><span class="op" id="2256372">,</span>&nbsp;<span class="comment" id="2256374">//&nbsp;10^-308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256386">{</span><span class="num" id="2256387">0xab70fe17c79ac6ca</span><span class="op" id="2256405">,</span>&nbsp;<span class="op" id="2256407">-</span><span class="num" id="2256408">1060</span><span class="op" id="2256412">,</span>&nbsp;<span class="builtintype" id="2256414">false</span><span class="op" id="2256419">}</span><span class="op" id="2256420">,</span>&nbsp;<span class="comment" id="2256422">//&nbsp;10^-300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256434">{</span><span class="num" id="2256435">0xff77b1fcbebcdc4f</span><span class="op" id="2256453">,</span>&nbsp;<span class="op" id="2256455">-</span><span class="num" id="2256456">1034</span><span class="op" id="2256460">,</span>&nbsp;<span class="builtintype" id="2256462">false</span><span class="op" id="2256467">}</span><span class="op" id="2256468">,</span>&nbsp;<span class="comment" id="2256470">//&nbsp;10^-292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256482">{</span><span class="num" id="2256483">0xbe5691ef416bd60c</span><span class="op" id="2256501">,</span>&nbsp;<span class="op" id="2256503">-</span><span class="num" id="2256504">1007</span><span class="op" id="2256508">,</span>&nbsp;<span class="builtintype" id="2256510">false</span><span class="op" id="2256515">}</span><span class="op" id="2256516">,</span>&nbsp;<span class="comment" id="2256518">//&nbsp;10^-284</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256530">{</span><span class="num" id="2256531">0x8dd01fad907ffc3c</span><span class="op" id="2256549">,</span>&nbsp;<span class="op" id="2256551">-</span><span class="num" id="2256552">980</span><span class="op" id="2256555">,</span>&nbsp;<span class="builtintype" id="2256557">false</span><span class="op" id="2256562">}</span><span class="op" id="2256563">,</span>&nbsp;&nbsp;<span class="comment" id="2256566">//&nbsp;10^-276</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256578">{</span><span class="num" id="2256579">0xd3515c2831559a83</span><span class="op" id="2256597">,</span>&nbsp;<span class="op" id="2256599">-</span><span class="num" id="2256600">954</span><span class="op" id="2256603">,</span>&nbsp;<span class="builtintype" id="2256605">false</span><span class="op" id="2256610">}</span><span class="op" id="2256611">,</span>&nbsp;&nbsp;<span class="comment" id="2256614">//&nbsp;10^-268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256626">{</span><span class="num" id="2256627">0x9d71ac8fada6c9b5</span><span class="op" id="2256645">,</span>&nbsp;<span class="op" id="2256647">-</span><span class="num" id="2256648">927</span><span class="op" id="2256651">,</span>&nbsp;<span class="builtintype" id="2256653">false</span><span class="op" id="2256658">}</span><span class="op" id="2256659">,</span>&nbsp;&nbsp;<span class="comment" id="2256662">//&nbsp;10^-260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256674">{</span><span class="num" id="2256675">0xea9c227723ee8bcb</span><span class="op" id="2256693">,</span>&nbsp;<span class="op" id="2256695">-</span><span class="num" id="2256696">901</span><span class="op" id="2256699">,</span>&nbsp;<span class="builtintype" id="2256701">false</span><span class="op" id="2256706">}</span><span class="op" id="2256707">,</span>&nbsp;&nbsp;<span class="comment" id="2256710">//&nbsp;10^-252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256722">{</span><span class="num" id="2256723">0xaecc49914078536d</span><span class="op" id="2256741">,</span>&nbsp;<span class="op" id="2256743">-</span><span class="num" id="2256744">874</span><span class="op" id="2256747">,</span>&nbsp;<span class="builtintype" id="2256749">false</span><span class="op" id="2256754">}</span><span class="op" id="2256755">,</span>&nbsp;&nbsp;<span class="comment" id="2256758">//&nbsp;10^-244</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256770">{</span><span class="num" id="2256771">0x823c12795db6ce57</span><span class="op" id="2256789">,</span>&nbsp;<span class="op" id="2256791">-</span><span class="num" id="2256792">847</span><span class="op" id="2256795">,</span>&nbsp;<span class="builtintype" id="2256797">false</span><span class="op" id="2256802">}</span><span class="op" id="2256803">,</span>&nbsp;&nbsp;<span class="comment" id="2256806">//&nbsp;10^-236</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256818">{</span><span class="num" id="2256819">0xc21094364dfb5637</span><span class="op" id="2256837">,</span>&nbsp;<span class="op" id="2256839">-</span><span class="num" id="2256840">821</span><span class="op" id="2256843">,</span>&nbsp;<span class="builtintype" id="2256845">false</span><span class="op" id="2256850">}</span><span class="op" id="2256851">,</span>&nbsp;&nbsp;<span class="comment" id="2256854">//&nbsp;10^-228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256866">{</span><span class="num" id="2256867">0x9096ea6f3848984f</span><span class="op" id="2256885">,</span>&nbsp;<span class="op" id="2256887">-</span><span class="num" id="2256888">794</span><span class="op" id="2256891">,</span>&nbsp;<span class="builtintype" id="2256893">false</span><span class="op" id="2256898">}</span><span class="op" id="2256899">,</span>&nbsp;&nbsp;<span class="comment" id="2256902">//&nbsp;10^-220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256914">{</span><span class="num" id="2256915">0xd77485cb25823ac7</span><span class="op" id="2256933">,</span>&nbsp;<span class="op" id="2256935">-</span><span class="num" id="2256936">768</span><span class="op" id="2256939">,</span>&nbsp;<span class="builtintype" id="2256941">false</span><span class="op" id="2256946">}</span><span class="op" id="2256947">,</span>&nbsp;&nbsp;<span class="comment" id="2256950">//&nbsp;10^-212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256962">{</span><span class="num" id="2256963">0xa086cfcd97bf97f4</span><span class="op" id="2256981">,</span>&nbsp;<span class="op" id="2256983">-</span><span class="num" id="2256984">741</span><span class="op" id="2256987">,</span>&nbsp;<span class="builtintype" id="2256989">false</span><span class="op" id="2256994">}</span><span class="op" id="2256995">,</span>&nbsp;&nbsp;<span class="comment" id="2256998">//&nbsp;10^-204</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257010">{</span><span class="num" id="2257011">0xef340a98172aace5</span><span class="op" id="2257029">,</span>&nbsp;<span class="op" id="2257031">-</span><span class="num" id="2257032">715</span><span class="op" id="2257035">,</span>&nbsp;<span class="builtintype" id="2257037">false</span><span class="op" id="2257042">}</span><span class="op" id="2257043">,</span>&nbsp;&nbsp;<span class="comment" id="2257046">//&nbsp;10^-196</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257058">{</span><span class="num" id="2257059">0xb23867fb2a35b28e</span><span class="op" id="2257077">,</span>&nbsp;<span class="op" id="2257079">-</span><span class="num" id="2257080">688</span><span class="op" id="2257083">,</span>&nbsp;<span class="builtintype" id="2257085">false</span><span class="op" id="2257090">}</span><span class="op" id="2257091">,</span>&nbsp;&nbsp;<span class="comment" id="2257094">//&nbsp;10^-188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257106">{</span><span class="num" id="2257107">0x84c8d4dfd2c63f3b</span><span class="op" id="2257125">,</span>&nbsp;<span class="op" id="2257127">-</span><span class="num" id="2257128">661</span><span class="op" id="2257131">,</span>&nbsp;<span class="builtintype" id="2257133">false</span><span class="op" id="2257138">}</span><span class="op" id="2257139">,</span>&nbsp;&nbsp;<span class="comment" id="2257142">//&nbsp;10^-180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257154">{</span><span class="num" id="2257155">0xc5dd44271ad3cdba</span><span class="op" id="2257173">,</span>&nbsp;<span class="op" id="2257175">-</span><span class="num" id="2257176">635</span><span class="op" id="2257179">,</span>&nbsp;<span class="builtintype" id="2257181">false</span><span class="op" id="2257186">}</span><span class="op" id="2257187">,</span>&nbsp;&nbsp;<span class="comment" id="2257190">//&nbsp;10^-172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257202">{</span><span class="num" id="2257203">0x936b9fcebb25c996</span><span class="op" id="2257221">,</span>&nbsp;<span class="op" id="2257223">-</span><span class="num" id="2257224">608</span><span class="op" id="2257227">,</span>&nbsp;<span class="builtintype" id="2257229">false</span><span class="op" id="2257234">}</span><span class="op" id="2257235">,</span>&nbsp;&nbsp;<span class="comment" id="2257238">//&nbsp;10^-164</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257250">{</span><span class="num" id="2257251">0xdbac6c247d62a584</span><span class="op" id="2257269">,</span>&nbsp;<span class="op" id="2257271">-</span><span class="num" id="2257272">582</span><span class="op" id="2257275">,</span>&nbsp;<span class="builtintype" id="2257277">false</span><span class="op" id="2257282">}</span><span class="op" id="2257283">,</span>&nbsp;&nbsp;<span class="comment" id="2257286">//&nbsp;10^-156</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257298">{</span><span class="num" id="2257299">0xa3ab66580d5fdaf6</span><span class="op" id="2257317">,</span>&nbsp;<span class="op" id="2257319">-</span><span class="num" id="2257320">555</span><span class="op" id="2257323">,</span>&nbsp;<span class="builtintype" id="2257325">false</span><span class="op" id="2257330">}</span><span class="op" id="2257331">,</span>&nbsp;&nbsp;<span class="comment" id="2257334">//&nbsp;10^-148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257346">{</span><span class="num" id="2257347">0xf3e2f893dec3f126</span><span class="op" id="2257365">,</span>&nbsp;<span class="op" id="2257367">-</span><span class="num" id="2257368">529</span><span class="op" id="2257371">,</span>&nbsp;<span class="builtintype" id="2257373">false</span><span class="op" id="2257378">}</span><span class="op" id="2257379">,</span>&nbsp;&nbsp;<span class="comment" id="2257382">//&nbsp;10^-140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257394">{</span><span class="num" id="2257395">0xb5b5ada8aaff80b8</span><span class="op" id="2257413">,</span>&nbsp;<span class="op" id="2257415">-</span><span class="num" id="2257416">502</span><span class="op" id="2257419">,</span>&nbsp;<span class="builtintype" id="2257421">false</span><span class="op" id="2257426">}</span><span class="op" id="2257427">,</span>&nbsp;&nbsp;<span class="comment" id="2257430">//&nbsp;10^-132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257442">{</span><span class="num" id="2257443">0x87625f056c7c4a8b</span><span class="op" id="2257461">,</span>&nbsp;<span class="op" id="2257463">-</span><span class="num" id="2257464">475</span><span class="op" id="2257467">,</span>&nbsp;<span class="builtintype" id="2257469">false</span><span class="op" id="2257474">}</span><span class="op" id="2257475">,</span>&nbsp;&nbsp;<span class="comment" id="2257478">//&nbsp;10^-124</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257490">{</span><span class="num" id="2257491">0xc9bcff6034c13053</span><span class="op" id="2257509">,</span>&nbsp;<span class="op" id="2257511">-</span><span class="num" id="2257512">449</span><span class="op" id="2257515">,</span>&nbsp;<span class="builtintype" id="2257517">false</span><span class="op" id="2257522">}</span><span class="op" id="2257523">,</span>&nbsp;&nbsp;<span class="comment" id="2257526">//&nbsp;10^-116</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257538">{</span><span class="num" id="2257539">0x964e858c91ba2655</span><span class="op" id="2257557">,</span>&nbsp;<span class="op" id="2257559">-</span><span class="num" id="2257560">422</span><span class="op" id="2257563">,</span>&nbsp;<span class="builtintype" id="2257565">false</span><span class="op" id="2257570">}</span><span class="op" id="2257571">,</span>&nbsp;&nbsp;<span class="comment" id="2257574">//&nbsp;10^-108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257586">{</span><span class="num" id="2257587">0xdff9772470297ebd</span><span class="op" id="2257605">,</span>&nbsp;<span class="op" id="2257607">-</span><span class="num" id="2257608">396</span><span class="op" id="2257611">,</span>&nbsp;<span class="builtintype" id="2257613">false</span><span class="op" id="2257618">}</span><span class="op" id="2257619">,</span>&nbsp;&nbsp;<span class="comment" id="2257622">//&nbsp;10^-100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257634">{</span><span class="num" id="2257635">0xa6dfbd9fb8e5b88f</span><span class="op" id="2257653">,</span>&nbsp;<span class="op" id="2257655">-</span><span class="num" id="2257656">369</span><span class="op" id="2257659">,</span>&nbsp;<span class="builtintype" id="2257661">false</span><span class="op" id="2257666">}</span><span class="op" id="2257667">,</span>&nbsp;&nbsp;<span class="comment" id="2257670">//&nbsp;10^-92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257681">{</span><span class="num" id="2257682">0xf8a95fcf88747d94</span><span class="op" id="2257700">,</span>&nbsp;<span class="op" id="2257702">-</span><span class="num" id="2257703">343</span><span class="op" id="2257706">,</span>&nbsp;<span class="builtintype" id="2257708">false</span><span class="op" id="2257713">}</span><span class="op" id="2257714">,</span>&nbsp;&nbsp;<span class="comment" id="2257717">//&nbsp;10^-84</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257728">{</span><span class="num" id="2257729">0xb94470938fa89bcf</span><span class="op" id="2257747">,</span>&nbsp;<span class="op" id="2257749">-</span><span class="num" id="2257750">316</span><span class="op" id="2257753">,</span>&nbsp;<span class="builtintype" id="2257755">false</span><span class="op" id="2257760">}</span><span class="op" id="2257761">,</span>&nbsp;&nbsp;<span class="comment" id="2257764">//&nbsp;10^-76</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257775">{</span><span class="num" id="2257776">0x8a08f0f8bf0f156b</span><span class="op" id="2257794">,</span>&nbsp;<span class="op" id="2257796">-</span><span class="num" id="2257797">289</span><span class="op" id="2257800">,</span>&nbsp;<span class="builtintype" id="2257802">false</span><span class="op" id="2257807">}</span><span class="op" id="2257808">,</span>&nbsp;&nbsp;<span class="comment" id="2257811">//&nbsp;10^-68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257822">{</span><span class="num" id="2257823">0xcdb02555653131b6</span><span class="op" id="2257841">,</span>&nbsp;<span class="op" id="2257843">-</span><span class="num" id="2257844">263</span><span class="op" id="2257847">,</span>&nbsp;<span class="builtintype" id="2257849">false</span><span class="op" id="2257854">}</span><span class="op" id="2257855">,</span>&nbsp;&nbsp;<span class="comment" id="2257858">//&nbsp;10^-60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257869">{</span><span class="num" id="2257870">0x993fe2c6d07b7fac</span><span class="op" id="2257888">,</span>&nbsp;<span class="op" id="2257890">-</span><span class="num" id="2257891">236</span><span class="op" id="2257894">,</span>&nbsp;<span class="builtintype" id="2257896">false</span><span class="op" id="2257901">}</span><span class="op" id="2257902">,</span>&nbsp;&nbsp;<span class="comment" id="2257905">//&nbsp;10^-52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257916">{</span><span class="num" id="2257917">0xe45c10c42a2b3b06</span><span class="op" id="2257935">,</span>&nbsp;<span class="op" id="2257937">-</span><span class="num" id="2257938">210</span><span class="op" id="2257941">,</span>&nbsp;<span class="builtintype" id="2257943">false</span><span class="op" id="2257948">}</span><span class="op" id="2257949">,</span>&nbsp;&nbsp;<span class="comment" id="2257952">//&nbsp;10^-44</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257963">{</span><span class="num" id="2257964">0xaa242499697392d3</span><span class="op" id="2257982">,</span>&nbsp;<span class="op" id="2257984">-</span><span class="num" id="2257985">183</span><span class="op" id="2257988">,</span>&nbsp;<span class="builtintype" id="2257990">false</span><span class="op" id="2257995">}</span><span class="op" id="2257996">,</span>&nbsp;&nbsp;<span class="comment" id="2257999">//&nbsp;10^-36</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258010">{</span><span class="num" id="2258011">0xfd87b5f28300ca0e</span><span class="op" id="2258029">,</span>&nbsp;<span class="op" id="2258031">-</span><span class="num" id="2258032">157</span><span class="op" id="2258035">,</span>&nbsp;<span class="builtintype" id="2258037">false</span><span class="op" id="2258042">}</span><span class="op" id="2258043">,</span>&nbsp;&nbsp;<span class="comment" id="2258046">//&nbsp;10^-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258057">{</span><span class="num" id="2258058">0xbce5086492111aeb</span><span class="op" id="2258076">,</span>&nbsp;<span class="op" id="2258078">-</span><span class="num" id="2258079">130</span><span class="op" id="2258082">,</span>&nbsp;<span class="builtintype" id="2258084">false</span><span class="op" id="2258089">}</span><span class="op" id="2258090">,</span>&nbsp;&nbsp;<span class="comment" id="2258093">//&nbsp;10^-20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258104">{</span><span class="num" id="2258105">0x8cbccc096f5088cc</span><span class="op" id="2258123">,</span>&nbsp;<span class="op" id="2258125">-</span><span class="num" id="2258126">103</span><span class="op" id="2258129">,</span>&nbsp;<span class="builtintype" id="2258131">false</span><span class="op" id="2258136">}</span><span class="op" id="2258137">,</span>&nbsp;&nbsp;<span class="comment" id="2258140">//&nbsp;10^-12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258151">{</span><span class="num" id="2258152">0xd1b71758e219652c</span><span class="op" id="2258170">,</span>&nbsp;<span class="op" id="2258172">-</span><span class="num" id="2258173">77</span><span class="op" id="2258175">,</span>&nbsp;<span class="builtintype" id="2258177">false</span><span class="op" id="2258182">}</span><span class="op" id="2258183">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2258187">//&nbsp;10^-4</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258197">{</span><span class="num" id="2258198">0x9c40000000000000</span><span class="op" id="2258216">,</span>&nbsp;<span class="op" id="2258218">-</span><span class="num" id="2258219">50</span><span class="op" id="2258221">,</span>&nbsp;<span class="builtintype" id="2258223">false</span><span class="op" id="2258228">}</span><span class="op" id="2258229">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2258233">//&nbsp;10^4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258242">{</span><span class="num" id="2258243">0xe8d4a51000000000</span><span class="op" id="2258261">,</span>&nbsp;<span class="op" id="2258263">-</span><span class="num" id="2258264">24</span><span class="op" id="2258266">,</span>&nbsp;<span class="builtintype" id="2258268">false</span><span class="op" id="2258273">}</span><span class="op" id="2258274">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2258278">//&nbsp;10^12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258288">{</span><span class="num" id="2258289">0xad78ebc5ac620000</span><span class="op" id="2258307">,</span>&nbsp;<span class="num" id="2258309">3</span><span class="op" id="2258310">,</span>&nbsp;<span class="builtintype" id="2258312">false</span><span class="op" id="2258317">}</span><span class="op" id="2258318">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2258324">//&nbsp;10^20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258334">{</span><span class="num" id="2258335">0x813f3978f8940984</span><span class="op" id="2258353">,</span>&nbsp;<span class="num" id="2258355">30</span><span class="op" id="2258357">,</span>&nbsp;<span class="builtintype" id="2258359">false</span><span class="op" id="2258364">}</span><span class="op" id="2258365">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2258370">//&nbsp;10^28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258380">{</span><span class="num" id="2258381">0xc097ce7bc90715b3</span><span class="op" id="2258399">,</span>&nbsp;<span class="num" id="2258401">56</span><span class="op" id="2258403">,</span>&nbsp;<span class="builtintype" id="2258405">false</span><span class="op" id="2258410">}</span><span class="op" id="2258411">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2258416">//&nbsp;10^36</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258426">{</span><span class="num" id="2258427">0x8f7e32ce7bea5c70</span><span class="op" id="2258445">,</span>&nbsp;<span class="num" id="2258447">83</span><span class="op" id="2258449">,</span>&nbsp;<span class="builtintype" id="2258451">false</span><span class="op" id="2258456">}</span><span class="op" id="2258457">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2258462">//&nbsp;10^44</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258472">{</span><span class="num" id="2258473">0xd5d238a4abe98068</span><span class="op" id="2258491">,</span>&nbsp;<span class="num" id="2258493">109</span><span class="op" id="2258496">,</span>&nbsp;<span class="builtintype" id="2258498">false</span><span class="op" id="2258503">}</span><span class="op" id="2258504">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2258508">//&nbsp;10^52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258518">{</span><span class="num" id="2258519">0x9f4f2726179a2245</span><span class="op" id="2258537">,</span>&nbsp;<span class="num" id="2258539">136</span><span class="op" id="2258542">,</span>&nbsp;<span class="builtintype" id="2258544">false</span><span class="op" id="2258549">}</span><span class="op" id="2258550">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2258554">//&nbsp;10^60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258564">{</span><span class="num" id="2258565">0xed63a231d4c4fb27</span><span class="op" id="2258583">,</span>&nbsp;<span class="num" id="2258585">162</span><span class="op" id="2258588">,</span>&nbsp;<span class="builtintype" id="2258590">false</span><span class="op" id="2258595">}</span><span class="op" id="2258596">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2258600">//&nbsp;10^68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258610">{</span><span class="num" id="2258611">0xb0de65388cc8ada8</span><span class="op" id="2258629">,</span>&nbsp;<span class="num" id="2258631">189</span><span class="op" id="2258634">,</span>&nbsp;<span class="builtintype" id="2258636">false</span><span class="op" id="2258641">}</span><span class="op" id="2258642">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2258646">//&nbsp;10^76</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258656">{</span><span class="num" id="2258657">0x83c7088e1aab65db</span><span class="op" id="2258675">,</span>&nbsp;<span class="num" id="2258677">216</span><span class="op" id="2258680">,</span>&nbsp;<span class="builtintype" id="2258682">false</span><span class="op" id="2258687">}</span><span class="op" id="2258688">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2258692">//&nbsp;10^84</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258702">{</span><span class="num" id="2258703">0xc45d1df942711d9a</span><span class="op" id="2258721">,</span>&nbsp;<span class="num" id="2258723">242</span><span class="op" id="2258726">,</span>&nbsp;<span class="builtintype" id="2258728">false</span><span class="op" id="2258733">}</span><span class="op" id="2258734">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2258738">//&nbsp;10^92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258748">{</span><span class="num" id="2258749">0x924d692ca61be758</span><span class="op" id="2258767">,</span>&nbsp;<span class="num" id="2258769">269</span><span class="op" id="2258772">,</span>&nbsp;<span class="builtintype" id="2258774">false</span><span class="op" id="2258779">}</span><span class="op" id="2258780">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2258784">//&nbsp;10^100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258795">{</span><span class="num" id="2258796">0xda01ee641a708dea</span><span class="op" id="2258814">,</span>&nbsp;<span class="num" id="2258816">295</span><span class="op" id="2258819">,</span>&nbsp;<span class="builtintype" id="2258821">false</span><span class="op" id="2258826">}</span><span class="op" id="2258827">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2258831">//&nbsp;10^108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258842">{</span><span class="num" id="2258843">0xa26da3999aef774a</span><span class="op" id="2258861">,</span>&nbsp;<span class="num" id="2258863">322</span><span class="op" id="2258866">,</span>&nbsp;<span class="builtintype" id="2258868">false</span><span class="op" id="2258873">}</span><span class="op" id="2258874">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2258878">//&nbsp;10^116</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258889">{</span><span class="num" id="2258890">0xf209787bb47d6b85</span><span class="op" id="2258908">,</span>&nbsp;<span class="num" id="2258910">348</span><span class="op" id="2258913">,</span>&nbsp;<span class="builtintype" id="2258915">false</span><span class="op" id="2258920">}</span><span class="op" id="2258921">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2258925">//&nbsp;10^124</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258936">{</span><span class="num" id="2258937">0xb454e4a179dd1877</span><span class="op" id="2258955">,</span>&nbsp;<span class="num" id="2258957">375</span><span class="op" id="2258960">,</span>&nbsp;<span class="builtintype" id="2258962">false</span><span class="op" id="2258967">}</span><span class="op" id="2258968">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2258972">//&nbsp;10^132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258983">{</span><span class="num" id="2258984">0x865b86925b9bc5c2</span><span class="op" id="2259002">,</span>&nbsp;<span class="num" id="2259004">402</span><span class="op" id="2259007">,</span>&nbsp;<span class="builtintype" id="2259009">false</span><span class="op" id="2259014">}</span><span class="op" id="2259015">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259019">//&nbsp;10^140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259030">{</span><span class="num" id="2259031">0xc83553c5c8965d3d</span><span class="op" id="2259049">,</span>&nbsp;<span class="num" id="2259051">428</span><span class="op" id="2259054">,</span>&nbsp;<span class="builtintype" id="2259056">false</span><span class="op" id="2259061">}</span><span class="op" id="2259062">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259066">//&nbsp;10^148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259077">{</span><span class="num" id="2259078">0x952ab45cfa97a0b3</span><span class="op" id="2259096">,</span>&nbsp;<span class="num" id="2259098">455</span><span class="op" id="2259101">,</span>&nbsp;<span class="builtintype" id="2259103">false</span><span class="op" id="2259108">}</span><span class="op" id="2259109">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259113">//&nbsp;10^156</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259124">{</span><span class="num" id="2259125">0xde469fbd99a05fe3</span><span class="op" id="2259143">,</span>&nbsp;<span class="num" id="2259145">481</span><span class="op" id="2259148">,</span>&nbsp;<span class="builtintype" id="2259150">false</span><span class="op" id="2259155">}</span><span class="op" id="2259156">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259160">//&nbsp;10^164</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259171">{</span><span class="num" id="2259172">0xa59bc234db398c25</span><span class="op" id="2259190">,</span>&nbsp;<span class="num" id="2259192">508</span><span class="op" id="2259195">,</span>&nbsp;<span class="builtintype" id="2259197">false</span><span class="op" id="2259202">}</span><span class="op" id="2259203">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259207">//&nbsp;10^172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259218">{</span><span class="num" id="2259219">0xf6c69a72a3989f5c</span><span class="op" id="2259237">,</span>&nbsp;<span class="num" id="2259239">534</span><span class="op" id="2259242">,</span>&nbsp;<span class="builtintype" id="2259244">false</span><span class="op" id="2259249">}</span><span class="op" id="2259250">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259254">//&nbsp;10^180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259265">{</span><span class="num" id="2259266">0xb7dcbf5354e9bece</span><span class="op" id="2259284">,</span>&nbsp;<span class="num" id="2259286">561</span><span class="op" id="2259289">,</span>&nbsp;<span class="builtintype" id="2259291">false</span><span class="op" id="2259296">}</span><span class="op" id="2259297">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259301">//&nbsp;10^188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259312">{</span><span class="num" id="2259313">0x88fcf317f22241e2</span><span class="op" id="2259331">,</span>&nbsp;<span class="num" id="2259333">588</span><span class="op" id="2259336">,</span>&nbsp;<span class="builtintype" id="2259338">false</span><span class="op" id="2259343">}</span><span class="op" id="2259344">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259348">//&nbsp;10^196</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259359">{</span><span class="num" id="2259360">0xcc20ce9bd35c78a5</span><span class="op" id="2259378">,</span>&nbsp;<span class="num" id="2259380">614</span><span class="op" id="2259383">,</span>&nbsp;<span class="builtintype" id="2259385">false</span><span class="op" id="2259390">}</span><span class="op" id="2259391">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259395">//&nbsp;10^204</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259406">{</span><span class="num" id="2259407">0x98165af37b2153df</span><span class="op" id="2259425">,</span>&nbsp;<span class="num" id="2259427">641</span><span class="op" id="2259430">,</span>&nbsp;<span class="builtintype" id="2259432">false</span><span class="op" id="2259437">}</span><span class="op" id="2259438">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259442">//&nbsp;10^212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259453">{</span><span class="num" id="2259454">0xe2a0b5dc971f303a</span><span class="op" id="2259472">,</span>&nbsp;<span class="num" id="2259474">667</span><span class="op" id="2259477">,</span>&nbsp;<span class="builtintype" id="2259479">false</span><span class="op" id="2259484">}</span><span class="op" id="2259485">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259489">//&nbsp;10^220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259500">{</span><span class="num" id="2259501">0xa8d9d1535ce3b396</span><span class="op" id="2259519">,</span>&nbsp;<span class="num" id="2259521">694</span><span class="op" id="2259524">,</span>&nbsp;<span class="builtintype" id="2259526">false</span><span class="op" id="2259531">}</span><span class="op" id="2259532">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259536">//&nbsp;10^228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259547">{</span><span class="num" id="2259548">0xfb9b7cd9a4a7443c</span><span class="op" id="2259566">,</span>&nbsp;<span class="num" id="2259568">720</span><span class="op" id="2259571">,</span>&nbsp;<span class="builtintype" id="2259573">false</span><span class="op" id="2259578">}</span><span class="op" id="2259579">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259583">//&nbsp;10^236</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259594">{</span><span class="num" id="2259595">0xbb764c4ca7a44410</span><span class="op" id="2259613">,</span>&nbsp;<span class="num" id="2259615">747</span><span class="op" id="2259618">,</span>&nbsp;<span class="builtintype" id="2259620">false</span><span class="op" id="2259625">}</span><span class="op" id="2259626">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259630">//&nbsp;10^244</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259641">{</span><span class="num" id="2259642">0x8bab8eefb6409c1a</span><span class="op" id="2259660">,</span>&nbsp;<span class="num" id="2259662">774</span><span class="op" id="2259665">,</span>&nbsp;<span class="builtintype" id="2259667">false</span><span class="op" id="2259672">}</span><span class="op" id="2259673">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259677">//&nbsp;10^252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259688">{</span><span class="num" id="2259689">0xd01fef10a657842c</span><span class="op" id="2259707">,</span>&nbsp;<span class="num" id="2259709">800</span><span class="op" id="2259712">,</span>&nbsp;<span class="builtintype" id="2259714">false</span><span class="op" id="2259719">}</span><span class="op" id="2259720">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259724">//&nbsp;10^260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259735">{</span><span class="num" id="2259736">0x9b10a4e5e9913129</span><span class="op" id="2259754">,</span>&nbsp;<span class="num" id="2259756">827</span><span class="op" id="2259759">,</span>&nbsp;<span class="builtintype" id="2259761">false</span><span class="op" id="2259766">}</span><span class="op" id="2259767">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259771">//&nbsp;10^268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259782">{</span><span class="num" id="2259783">0xe7109bfba19c0c9d</span><span class="op" id="2259801">,</span>&nbsp;<span class="num" id="2259803">853</span><span class="op" id="2259806">,</span>&nbsp;<span class="builtintype" id="2259808">false</span><span class="op" id="2259813">}</span><span class="op" id="2259814">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259818">//&nbsp;10^276</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259829">{</span><span class="num" id="2259830">0xac2820d9623bf429</span><span class="op" id="2259848">,</span>&nbsp;<span class="num" id="2259850">880</span><span class="op" id="2259853">,</span>&nbsp;<span class="builtintype" id="2259855">false</span><span class="op" id="2259860">}</span><span class="op" id="2259861">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259865">//&nbsp;10^284</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259876">{</span><span class="num" id="2259877">0x80444b5e7aa7cf85</span><span class="op" id="2259895">,</span>&nbsp;<span class="num" id="2259897">907</span><span class="op" id="2259900">,</span>&nbsp;<span class="builtintype" id="2259902">false</span><span class="op" id="2259907">}</span><span class="op" id="2259908">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259912">//&nbsp;10^292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259923">{</span><span class="num" id="2259924">0xbf21e44003acdd2d</span><span class="op" id="2259942">,</span>&nbsp;<span class="num" id="2259944">933</span><span class="op" id="2259947">,</span>&nbsp;<span class="builtintype" id="2259949">false</span><span class="op" id="2259954">}</span><span class="op" id="2259955">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2259959">//&nbsp;10^300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259970">{</span><span class="num" id="2259971">0x8e679c2f5e44ff8f</span><span class="op" id="2259989">,</span>&nbsp;<span class="num" id="2259991">960</span><span class="op" id="2259994">,</span>&nbsp;<span class="builtintype" id="2259996">false</span><span class="op" id="2260001">}</span><span class="op" id="2260002">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2260006">//&nbsp;10^308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2260017">{</span><span class="num" id="2260018">0xd433179d9c8cb841</span><span class="op" id="2260036">,</span>&nbsp;<span class="num" id="2260038">986</span><span class="op" id="2260041">,</span>&nbsp;<span class="builtintype" id="2260043">false</span><span class="op" id="2260048">}</span><span class="op" id="2260049">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2260053">//&nbsp;10^316</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2260064">{</span><span class="num" id="2260065">0x9e19db92b4e31ba9</span><span class="op" id="2260083">,</span>&nbsp;<span class="num" id="2260085">1013</span><span class="op" id="2260089">,</span>&nbsp;<span class="builtintype" id="2260091">false</span><span class="op" id="2260096">}</span><span class="op" id="2260097">,</span>&nbsp;&nbsp;<span class="comment" id="2260100">//&nbsp;10^324</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2260111">{</span><span class="num" id="2260112">0xeb96bf6ebadf77d9</span><span class="op" id="2260130">,</span>&nbsp;<span class="num" id="2260132">1039</span><span class="op" id="2260136">,</span>&nbsp;<span class="builtintype" id="2260138">false</span><span class="op" id="2260143">}</span><span class="op" id="2260144">,</span>&nbsp;&nbsp;<span class="comment" id="2260147">//&nbsp;10^332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2260158">{</span><span class="num" id="2260159">0xaf87023b9bf0ee6b</span><span class="op" id="2260177">,</span>&nbsp;<span class="num" id="2260179">1066</span><span class="op" id="2260183">,</span>&nbsp;<span class="builtintype" id="2260185">false</span><span class="op" id="2260190">}</span><span class="op" id="2260191">,</span>&nbsp;&nbsp;<span class="comment" id="2260194">//&nbsp;10^340</span><br>
<span class="lineno"></span><span class="op" id="2260204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="2260207">//&nbsp;floatBits&nbsp;returns&nbsp;the&nbsp;bits&nbsp;of&nbsp;the&nbsp;float64&nbsp;that&nbsp;best&nbsp;approximates</span><br>
<span class="lineno"></span><span class="comment" id="2260275">//&nbsp;the&nbsp;extFloat&nbsp;passed&nbsp;as&nbsp;receiver.&nbsp;Overflow&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2260338">//&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;is&nbsp;±Inf.</span><br>
<span class="lineno"></span><span class="keyword" id="2260373">func</span>&nbsp;<span class="op" id="2260378">(</span><span class="ident" id="2260379">f</span>&nbsp;<span class="op" id="2260381">*</span><span class="ident" id="2260382">extFloat</span><span class="op" id="2260390">)</span>&nbsp;<span class="ident" id="2260392">floatBits</span><span class="op" id="2260401">(</span><span class="ident" id="2260402">flt</span>&nbsp;<span class="op" id="2260406">*</span><span class="ident" id="2260407">floatInfo</span><span class="op" id="2260416">)</span>&nbsp;<span class="op" id="2260418">(</span><span class="ident" id="2260419">bits</span>&nbsp;<span class="ident" id="2260424">uint64</span><span class="op" id="2260430">,</span>&nbsp;<span class="ident" id="2260432">overflow</span>&nbsp;<span class="builtintype" id="2260441">bool</span><span class="op" id="2260445">)</span>&nbsp;<span class="op" id="2260447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260450">f</span><span class="op" id="2260451">.</span><span class="ident" id="2260452">Normalize</span><span class="op" id="2260461">(</span><span class="op" id="2260462">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260466">exp</span>&nbsp;<span class="op" id="2260470">:=</span>&nbsp;<span class="ident" id="2260473">f</span><span class="op" id="2260474">.</span><span class="ident" id="2260475">exp</span>&nbsp;<span class="op" id="2260479">+</span>&nbsp;<span class="num" id="2260481">63</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2260486">//&nbsp;Exponent&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2260510">if</span>&nbsp;<span class="ident" id="2260513">exp</span>&nbsp;<span class="op" id="2260517">&lt;</span>&nbsp;<span class="ident" id="2260519">flt</span><span class="op" id="2260522">.</span><span class="ident" id="2260523">bias</span><span class="op" id="2260527">+</span><span class="num" id="2260528">1</span>&nbsp;<span class="op" id="2260530">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260534">n</span>&nbsp;<span class="op" id="2260536">:=</span>&nbsp;<span class="ident" id="2260539">flt</span><span class="op" id="2260542">.</span><span class="ident" id="2260543">bias</span>&nbsp;<span class="op" id="2260548">+</span>&nbsp;<span class="num" id="2260550">1</span>&nbsp;<span class="op" id="2260552">-</span>&nbsp;<span class="ident" id="2260554">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260560">f</span><span class="op" id="2260561">.</span><span class="ident" id="2260562">mant</span>&nbsp;<span class="op" id="2260567">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="2260571">uint</span><span class="op" id="2260575">(</span><span class="ident" id="2260576">n</span><span class="op" id="2260577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260581">exp</span>&nbsp;<span class="op" id="2260585">+=</span>&nbsp;<span class="ident" id="2260588">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2260591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2260595">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits&nbsp;from&nbsp;the&nbsp;64-bit&nbsp;mantissa.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260653">mant</span>&nbsp;<span class="op" id="2260658">:=</span>&nbsp;<span class="ident" id="2260661">f</span><span class="op" id="2260662">.</span><span class="ident" id="2260663">mant</span>&nbsp;<span class="op" id="2260668">&gt;&gt;</span>&nbsp;<span class="op" id="2260671">(</span><span class="num" id="2260672">63</span>&nbsp;<span class="op" id="2260675">-</span>&nbsp;<span class="ident" id="2260677">flt</span><span class="op" id="2260680">.</span><span class="ident" id="2260681">mantbits</span><span class="op" id="2260689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2260692">if</span>&nbsp;<span class="ident" id="2260695">f</span><span class="op" id="2260696">.</span><span class="ident" id="2260697">mant</span><span class="op" id="2260701">&amp;</span><span class="op" id="2260702">(</span><span class="num" id="2260703">1</span><span class="op" id="2260704">&lt;&lt;</span><span class="op" id="2260706">(</span><span class="num" id="2260707">62</span><span class="op" id="2260709">-</span><span class="ident" id="2260710">flt</span><span class="op" id="2260713">.</span><span class="ident" id="2260714">mantbits</span><span class="op" id="2260722">)</span><span class="op" id="2260723">)</span>&nbsp;<span class="op" id="2260725">!=</span>&nbsp;<span class="num" id="2260728">0</span>&nbsp;<span class="op" id="2260730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2260734">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260749">mant</span>&nbsp;<span class="op" id="2260754">+=</span>&nbsp;<span class="num" id="2260757">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2260760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2260764">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2260813">if</span>&nbsp;<span class="ident" id="2260816">mant</span>&nbsp;<span class="op" id="2260821">==</span>&nbsp;<span class="num" id="2260824">2</span><span class="op" id="2260825">&lt;&lt;</span><span class="ident" id="2260827">flt</span><span class="op" id="2260830">.</span><span class="ident" id="2260831">mantbits</span>&nbsp;<span class="op" id="2260840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260844">mant</span>&nbsp;<span class="op" id="2260849">&gt;&gt;=</span>&nbsp;<span class="num" id="2260853">1</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260857">exp</span><span class="op" id="2260860">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2260864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2260868">//&nbsp;Infinities.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2260884">if</span>&nbsp;<span class="ident" id="2260887">exp</span><span class="op" id="2260890">-</span><span class="ident" id="2260891">flt</span><span class="op" id="2260894">.</span><span class="ident" id="2260895">bias</span>&nbsp;<span class="op" id="2260900">&gt;=</span>&nbsp;<span class="num" id="2260903">1</span><span class="op" id="2260904">&lt;&lt;</span><span class="ident" id="2260906">flt</span><span class="op" id="2260909">.</span><span class="ident" id="2260910">expbits</span><span class="op" id="2260917">-</span><span class="num" id="2260918">1</span>&nbsp;<span class="op" id="2260920">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2260924">//&nbsp;±Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260935">mant</span>&nbsp;<span class="op" id="2260940">=</span>&nbsp;<span class="num" id="2260942">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260946">exp</span>&nbsp;<span class="op" id="2260950">=</span>&nbsp;<span class="num" id="2260952">1</span><span class="op" id="2260953">&lt;&lt;</span><span class="ident" id="2260955">flt</span><span class="op" id="2260958">.</span><span class="ident" id="2260959">expbits</span>&nbsp;<span class="op" id="2260967">-</span>&nbsp;<span class="num" id="2260969">1</span>&nbsp;<span class="op" id="2260971">+</span>&nbsp;<span class="ident" id="2260973">flt</span><span class="op" id="2260976">.</span><span class="ident" id="2260977">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260984">overflow</span>&nbsp;<span class="op" id="2260993">=</span>&nbsp;<span class="builtintype" id="2260995">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2261001">}</span>&nbsp;<span class="keyword" id="2261003">else</span>&nbsp;<span class="keyword" id="2261008">if</span>&nbsp;<span class="ident" id="2261011">mant</span><span class="op" id="2261015">&amp;</span><span class="op" id="2261016">(</span><span class="num" id="2261017">1</span><span class="op" id="2261018">&lt;&lt;</span><span class="ident" id="2261020">flt</span><span class="op" id="2261023">.</span><span class="ident" id="2261024">mantbits</span><span class="op" id="2261032">)</span>&nbsp;<span class="op" id="2261034">==</span>&nbsp;<span class="num" id="2261037">0</span>&nbsp;<span class="op" id="2261039">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2261043">//&nbsp;Denormalized?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261062">exp</span>&nbsp;<span class="op" id="2261066">=</span>&nbsp;<span class="ident" id="2261068">flt</span><span class="op" id="2261071">.</span><span class="ident" id="2261072">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2261078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2261081">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261100">bits</span>&nbsp;<span class="op" id="2261105">=</span>&nbsp;<span class="ident" id="2261107">mant</span>&nbsp;<span class="op" id="2261112">&amp;</span>&nbsp;<span class="op" id="2261114">(</span><span class="ident" id="2261115">uint64</span><span class="op" id="2261121">(</span><span class="num" id="2261122">1</span><span class="op" id="2261123">)</span><span class="op" id="2261124">&lt;&lt;</span><span class="ident" id="2261126">flt</span><span class="op" id="2261129">.</span><span class="ident" id="2261130">mantbits</span>&nbsp;<span class="op" id="2261139">-</span>&nbsp;<span class="num" id="2261141">1</span><span class="op" id="2261142">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261145">bits</span>&nbsp;<span class="op" id="2261150">|=</span>&nbsp;<span class="ident" id="2261153">uint64</span><span class="op" id="2261159">(</span><span class="op" id="2261160">(</span><span class="ident" id="2261161">exp</span><span class="op" id="2261164">-</span><span class="ident" id="2261165">flt</span><span class="op" id="2261168">.</span><span class="ident" id="2261169">bias</span><span class="op" id="2261173">)</span><span class="op" id="2261174">&amp;</span><span class="op" id="2261175">(</span><span class="num" id="2261176">1</span><span class="op" id="2261177">&lt;&lt;</span><span class="ident" id="2261179">flt</span><span class="op" id="2261182">.</span><span class="ident" id="2261183">expbits</span><span class="op" id="2261190">-</span><span class="num" id="2261191">1</span><span class="op" id="2261192">)</span><span class="op" id="2261193">)</span>&nbsp;<span class="op" id="2261195">&lt;&lt;</span>&nbsp;<span class="ident" id="2261198">flt</span><span class="op" id="2261201">.</span><span class="ident" id="2261202">mantbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2261212">if</span>&nbsp;<span class="ident" id="2261215">f</span><span class="op" id="2261216">.</span><span class="ident" id="2261217">neg</span>&nbsp;<span class="op" id="2261221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261225">bits</span>&nbsp;<span class="op" id="2261230">|=</span>&nbsp;<span class="num" id="2261233">1</span>&nbsp;<span class="op" id="2261235">&lt;&lt;</span>&nbsp;<span class="op" id="2261238">(</span><span class="ident" id="2261239">flt</span><span class="op" id="2261242">.</span><span class="ident" id="2261243">mantbits</span>&nbsp;<span class="op" id="2261252">+</span>&nbsp;<span class="ident" id="2261254">flt</span><span class="op" id="2261257">.</span><span class="ident" id="2261258">expbits</span><span class="op" id="2261265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2261268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2261271">return</span><br>
<span class="lineno">170</span><span class="op" id="2261278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2261281">//&nbsp;AssignComputeBounds&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;floating&nbsp;point&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2261339">//&nbsp;defined&nbsp;by&nbsp;mant,&nbsp;exp&nbsp;and&nbsp;precision&nbsp;given&nbsp;by&nbsp;flt.&nbsp;It&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="2261402">//&nbsp;lower,&nbsp;upper&nbsp;such&nbsp;that&nbsp;any&nbsp;number&nbsp;in&nbsp;the&nbsp;closed&nbsp;interval</span><br>
<span class="lineno">175</span><span class="comment" id="2261462">//&nbsp;[lower,&nbsp;upper]&nbsp;is&nbsp;converted&nbsp;back&nbsp;to&nbsp;the&nbsp;same&nbsp;floating&nbsp;point&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="2261533">func</span>&nbsp;<span class="op" id="2261538">(</span><span class="ident" id="2261539">f</span>&nbsp;<span class="op" id="2261541">*</span><span class="ident" id="2261542">extFloat</span><span class="op" id="2261550">)</span>&nbsp;<span class="ident" id="2261552">AssignComputeBounds</span><span class="op" id="2261571">(</span><span class="ident" id="2261572">mant</span>&nbsp;<span class="ident" id="2261577">uint64</span><span class="op" id="2261583">,</span>&nbsp;<span class="ident" id="2261585">exp</span>&nbsp;<span class="builtintype" id="2261589">int</span><span class="op" id="2261592">,</span>&nbsp;<span class="ident" id="2261594">neg</span>&nbsp;<span class="builtintype" id="2261598">bool</span><span class="op" id="2261602">,</span>&nbsp;<span class="ident" id="2261604">flt</span>&nbsp;<span class="op" id="2261608">*</span><span class="ident" id="2261609">floatInfo</span><span class="op" id="2261618">)</span>&nbsp;<span class="op" id="2261620">(</span><span class="ident" id="2261621">lower</span><span class="op" id="2261626">,</span>&nbsp;<span class="ident" id="2261628">upper</span>&nbsp;<span class="ident" id="2261634">extFloat</span><span class="op" id="2261642">)</span>&nbsp;<span class="op" id="2261644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261647">f</span><span class="op" id="2261648">.</span><span class="ident" id="2261649">mant</span>&nbsp;<span class="op" id="2261654">=</span>&nbsp;<span class="ident" id="2261656">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261662">f</span><span class="op" id="2261663">.</span><span class="ident" id="2261664">exp</span>&nbsp;<span class="op" id="2261668">=</span>&nbsp;<span class="ident" id="2261670">exp</span>&nbsp;<span class="op" id="2261674">-</span>&nbsp;<span class="builtintype" id="2261676">int</span><span class="op" id="2261679">(</span><span class="ident" id="2261680">flt</span><span class="op" id="2261683">.</span><span class="ident" id="2261684">mantbits</span><span class="op" id="2261692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261695">f</span><span class="op" id="2261696">.</span><span class="ident" id="2261697">neg</span>&nbsp;<span class="op" id="2261701">=</span>&nbsp;<span class="ident" id="2261703">neg</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2261708">if</span>&nbsp;<span class="ident" id="2261711">f</span><span class="op" id="2261712">.</span><span class="ident" id="2261713">exp</span>&nbsp;<span class="op" id="2261717">&lt;=</span>&nbsp;<span class="num" id="2261720">0</span>&nbsp;<span class="op" id="2261722">&amp;&amp;</span>&nbsp;<span class="ident" id="2261725">mant</span>&nbsp;<span class="op" id="2261730">==</span>&nbsp;<span class="op" id="2261733">(</span><span class="ident" id="2261734">mant</span><span class="op" id="2261738">&gt;&gt;</span><span class="builtintype" id="2261740">uint</span><span class="op" id="2261744">(</span><span class="op" id="2261745">-</span><span class="ident" id="2261746">f</span><span class="op" id="2261747">.</span><span class="ident" id="2261748">exp</span><span class="op" id="2261751">)</span><span class="op" id="2261752">)</span><span class="op" id="2261753">&lt;&lt;</span><span class="builtintype" id="2261755">uint</span><span class="op" id="2261759">(</span><span class="op" id="2261760">-</span><span class="ident" id="2261761">f</span><span class="op" id="2261762">.</span><span class="ident" id="2261763">exp</span><span class="op" id="2261766">)</span>&nbsp;<span class="op" id="2261768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2261772">//&nbsp;An&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261794">f</span><span class="op" id="2261795">.</span><span class="ident" id="2261796">mant</span>&nbsp;<span class="op" id="2261801">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="2261805">uint</span><span class="op" id="2261809">(</span><span class="op" id="2261810">-</span><span class="ident" id="2261811">f</span><span class="op" id="2261812">.</span><span class="ident" id="2261813">exp</span><span class="op" id="2261816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261820">f</span><span class="op" id="2261821">.</span><span class="ident" id="2261822">exp</span>&nbsp;<span class="op" id="2261826">=</span>&nbsp;<span class="num" id="2261828">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2261832">return</span>&nbsp;<span class="op" id="2261839">*</span><span class="ident" id="2261840">f</span><span class="op" id="2261841">,</span>&nbsp;<span class="op" id="2261843">*</span><span class="ident" id="2261844">f</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2261847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261850">expBiased</span>&nbsp;<span class="op" id="2261860">:=</span>&nbsp;<span class="ident" id="2261863">exp</span>&nbsp;<span class="op" id="2261867">-</span>&nbsp;<span class="ident" id="2261869">flt</span><span class="op" id="2261872">.</span><span class="ident" id="2261873">bias</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261880">upper</span>&nbsp;<span class="op" id="2261886">=</span>&nbsp;<span class="ident" id="2261888">extFloat</span><span class="op" id="2261896">{</span><span class="ident" id="2261897">mant</span><span class="op" id="2261901">:</span>&nbsp;<span class="num" id="2261903">2</span><span class="op" id="2261904">*</span><span class="ident" id="2261905">f</span><span class="op" id="2261906">.</span><span class="ident" id="2261907">mant</span>&nbsp;<span class="op" id="2261912">+</span>&nbsp;<span class="num" id="2261914">1</span><span class="op" id="2261915">,</span>&nbsp;<span class="ident" id="2261917">exp</span><span class="op" id="2261920">:</span>&nbsp;<span class="ident" id="2261922">f</span><span class="op" id="2261923">.</span><span class="ident" id="2261924">exp</span>&nbsp;<span class="op" id="2261928">-</span>&nbsp;<span class="num" id="2261930">1</span><span class="op" id="2261931">,</span>&nbsp;<span class="ident" id="2261933">neg</span><span class="op" id="2261936">:</span>&nbsp;<span class="ident" id="2261938">f</span><span class="op" id="2261939">.</span><span class="ident" id="2261940">neg</span><span class="op" id="2261943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2261946">if</span>&nbsp;<span class="ident" id="2261949">mant</span>&nbsp;<span class="op" id="2261954">!=</span>&nbsp;<span class="num" id="2261957">1</span><span class="op" id="2261958">&lt;&lt;</span><span class="ident" id="2261960">flt</span><span class="op" id="2261963">.</span><span class="ident" id="2261964">mantbits</span>&nbsp;<span class="op" id="2261973">||</span>&nbsp;<span class="ident" id="2261976">expBiased</span>&nbsp;<span class="op" id="2261986">==</span>&nbsp;<span class="num" id="2261989">1</span>&nbsp;<span class="op" id="2261991">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261995">lower</span>&nbsp;<span class="op" id="2262001">=</span>&nbsp;<span class="ident" id="2262003">extFloat</span><span class="op" id="2262011">{</span><span class="ident" id="2262012">mant</span><span class="op" id="2262016">:</span>&nbsp;<span class="num" id="2262018">2</span><span class="op" id="2262019">*</span><span class="ident" id="2262020">f</span><span class="op" id="2262021">.</span><span class="ident" id="2262022">mant</span>&nbsp;<span class="op" id="2262027">-</span>&nbsp;<span class="num" id="2262029">1</span><span class="op" id="2262030">,</span>&nbsp;<span class="ident" id="2262032">exp</span><span class="op" id="2262035">:</span>&nbsp;<span class="ident" id="2262037">f</span><span class="op" id="2262038">.</span><span class="ident" id="2262039">exp</span>&nbsp;<span class="op" id="2262043">-</span>&nbsp;<span class="num" id="2262045">1</span><span class="op" id="2262046">,</span>&nbsp;<span class="ident" id="2262048">neg</span><span class="op" id="2262051">:</span>&nbsp;<span class="ident" id="2262053">f</span><span class="op" id="2262054">.</span><span class="ident" id="2262055">neg</span><span class="op" id="2262058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2262061">}</span>&nbsp;<span class="keyword" id="2262063">else</span>&nbsp;<span class="op" id="2262068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262072">lower</span>&nbsp;<span class="op" id="2262078">=</span>&nbsp;<span class="ident" id="2262080">extFloat</span><span class="op" id="2262088">{</span><span class="ident" id="2262089">mant</span><span class="op" id="2262093">:</span>&nbsp;<span class="num" id="2262095">4</span><span class="op" id="2262096">*</span><span class="ident" id="2262097">f</span><span class="op" id="2262098">.</span><span class="ident" id="2262099">mant</span>&nbsp;<span class="op" id="2262104">-</span>&nbsp;<span class="num" id="2262106">1</span><span class="op" id="2262107">,</span>&nbsp;<span class="ident" id="2262109">exp</span><span class="op" id="2262112">:</span>&nbsp;<span class="ident" id="2262114">f</span><span class="op" id="2262115">.</span><span class="ident" id="2262116">exp</span>&nbsp;<span class="op" id="2262120">-</span>&nbsp;<span class="num" id="2262122">2</span><span class="op" id="2262123">,</span>&nbsp;<span class="ident" id="2262125">neg</span><span class="op" id="2262128">:</span>&nbsp;<span class="ident" id="2262130">f</span><span class="op" id="2262131">.</span><span class="ident" id="2262132">neg</span><span class="op" id="2262135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2262138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2262141">return</span><br>
<span class="lineno">195</span><span class="op" id="2262148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2262151">//&nbsp;Normalize&nbsp;normalizes&nbsp;f&nbsp;so&nbsp;that&nbsp;the&nbsp;highest&nbsp;bit&nbsp;of&nbsp;the&nbsp;mantissa&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2262220">//&nbsp;set,&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;by&nbsp;which&nbsp;the&nbsp;mantissa&nbsp;was&nbsp;left-shifted.</span><br>
<span class="lineno"></span><span class="keyword" id="2262291">func</span>&nbsp;<span class="op" id="2262296">(</span><span class="ident" id="2262297">f</span>&nbsp;<span class="op" id="2262299">*</span><span class="ident" id="2262300">extFloat</span><span class="op" id="2262308">)</span>&nbsp;<span class="ident" id="2262310">Normalize</span><span class="op" id="2262319">(</span><span class="op" id="2262320">)</span>&nbsp;<span class="op" id="2262322">(</span><span class="ident" id="2262323">shift</span>&nbsp;<span class="builtintype" id="2262329">uint</span><span class="op" id="2262333">)</span>&nbsp;<span class="op" id="2262335">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262338">mant</span><span class="op" id="2262342">,</span>&nbsp;<span class="ident" id="2262344">exp</span>&nbsp;<span class="op" id="2262348">:=</span>&nbsp;<span class="ident" id="2262351">f</span><span class="op" id="2262352">.</span><span class="ident" id="2262353">mant</span><span class="op" id="2262357">,</span>&nbsp;<span class="ident" id="2262359">f</span><span class="op" id="2262360">.</span><span class="ident" id="2262361">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2262366">if</span>&nbsp;<span class="ident" id="2262369">mant</span>&nbsp;<span class="op" id="2262374">==</span>&nbsp;<span class="num" id="2262377">0</span>&nbsp;<span class="op" id="2262379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2262383">return</span>&nbsp;<span class="num" id="2262390">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2262393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2262396">if</span>&nbsp;<span class="ident" id="2262399">mant</span><span class="op" id="2262403">&gt;&gt;</span><span class="op" id="2262405">(</span><span class="num" id="2262406">64</span><span class="op" id="2262408">-</span><span class="num" id="2262409">32</span><span class="op" id="2262411">)</span>&nbsp;<span class="op" id="2262413">==</span>&nbsp;<span class="num" id="2262416">0</span>&nbsp;<span class="op" id="2262418">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262422">mant</span>&nbsp;<span class="op" id="2262427">&lt;&lt;=</span>&nbsp;<span class="num" id="2262431">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262436">exp</span>&nbsp;<span class="op" id="2262440">-=</span>&nbsp;<span class="num" id="2262443">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2262447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2262450">if</span>&nbsp;<span class="ident" id="2262453">mant</span><span class="op" id="2262457">&gt;&gt;</span><span class="op" id="2262459">(</span><span class="num" id="2262460">64</span><span class="op" id="2262462">-</span><span class="num" id="2262463">16</span><span class="op" id="2262465">)</span>&nbsp;<span class="op" id="2262467">==</span>&nbsp;<span class="num" id="2262470">0</span>&nbsp;<span class="op" id="2262472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262476">mant</span>&nbsp;<span class="op" id="2262481">&lt;&lt;=</span>&nbsp;<span class="num" id="2262485">16</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262490">exp</span>&nbsp;<span class="op" id="2262494">-=</span>&nbsp;<span class="num" id="2262497">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2262501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2262504">if</span>&nbsp;<span class="ident" id="2262507">mant</span><span class="op" id="2262511">&gt;&gt;</span><span class="op" id="2262513">(</span><span class="num" id="2262514">64</span><span class="op" id="2262516">-</span><span class="num" id="2262517">8</span><span class="op" id="2262518">)</span>&nbsp;<span class="op" id="2262520">==</span>&nbsp;<span class="num" id="2262523">0</span>&nbsp;<span class="op" id="2262525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262529">mant</span>&nbsp;<span class="op" id="2262534">&lt;&lt;=</span>&nbsp;<span class="num" id="2262538">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262542">exp</span>&nbsp;<span class="op" id="2262546">-=</span>&nbsp;<span class="num" id="2262549">8</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2262552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2262555">if</span>&nbsp;<span class="ident" id="2262558">mant</span><span class="op" id="2262562">&gt;&gt;</span><span class="op" id="2262564">(</span><span class="num" id="2262565">64</span><span class="op" id="2262567">-</span><span class="num" id="2262568">4</span><span class="op" id="2262569">)</span>&nbsp;<span class="op" id="2262571">==</span>&nbsp;<span class="num" id="2262574">0</span>&nbsp;<span class="op" id="2262576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262580">mant</span>&nbsp;<span class="op" id="2262585">&lt;&lt;=</span>&nbsp;<span class="num" id="2262589">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262593">exp</span>&nbsp;<span class="op" id="2262597">-=</span>&nbsp;<span class="num" id="2262600">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2262603">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2262606">if</span>&nbsp;<span class="ident" id="2262609">mant</span><span class="op" id="2262613">&gt;&gt;</span><span class="op" id="2262615">(</span><span class="num" id="2262616">64</span><span class="op" id="2262618">-</span><span class="num" id="2262619">2</span><span class="op" id="2262620">)</span>&nbsp;<span class="op" id="2262622">==</span>&nbsp;<span class="num" id="2262625">0</span>&nbsp;<span class="op" id="2262627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262631">mant</span>&nbsp;<span class="op" id="2262636">&lt;&lt;=</span>&nbsp;<span class="num" id="2262640">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262644">exp</span>&nbsp;<span class="op" id="2262648">-=</span>&nbsp;<span class="num" id="2262651">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2262654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2262657">if</span>&nbsp;<span class="ident" id="2262660">mant</span><span class="op" id="2262664">&gt;&gt;</span><span class="op" id="2262666">(</span><span class="num" id="2262667">64</span><span class="op" id="2262669">-</span><span class="num" id="2262670">1</span><span class="op" id="2262671">)</span>&nbsp;<span class="op" id="2262673">==</span>&nbsp;<span class="num" id="2262676">0</span>&nbsp;<span class="op" id="2262678">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262682">mant</span>&nbsp;<span class="op" id="2262687">&lt;&lt;=</span>&nbsp;<span class="num" id="2262691">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262695">exp</span>&nbsp;<span class="op" id="2262699">-=</span>&nbsp;<span class="num" id="2262702">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2262705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262708">shift</span>&nbsp;<span class="op" id="2262714">=</span>&nbsp;<span class="builtintype" id="2262716">uint</span><span class="op" id="2262720">(</span><span class="ident" id="2262721">f</span><span class="op" id="2262722">.</span><span class="ident" id="2262723">exp</span>&nbsp;<span class="op" id="2262727">-</span>&nbsp;<span class="ident" id="2262729">exp</span><span class="op" id="2262732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262735">f</span><span class="op" id="2262736">.</span><span class="ident" id="2262737">mant</span><span class="op" id="2262741">,</span>&nbsp;<span class="ident" id="2262743">f</span><span class="op" id="2262744">.</span><span class="ident" id="2262745">exp</span>&nbsp;<span class="op" id="2262749">=</span>&nbsp;<span class="ident" id="2262751">mant</span><span class="op" id="2262755">,</span>&nbsp;<span class="ident" id="2262757">exp</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2262762">return</span><br>
<span class="lineno"></span><span class="op" id="2262769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2262772">//&nbsp;Multiply&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;product&nbsp;f*g:&nbsp;the&nbsp;result&nbsp;is&nbsp;correctly&nbsp;rounded,</span><br>
<span class="lineno"></span><span class="comment" id="2262844">//&nbsp;but&nbsp;not&nbsp;normalized.</span><br>
<span class="lineno">235</span><span class="keyword" id="2262867">func</span>&nbsp;<span class="op" id="2262872">(</span><span class="ident" id="2262873">f</span>&nbsp;<span class="op" id="2262875">*</span><span class="ident" id="2262876">extFloat</span><span class="op" id="2262884">)</span>&nbsp;<span class="ident" id="2262886">Multiply</span><span class="op" id="2262894">(</span><span class="ident" id="2262895">g</span>&nbsp;<span class="ident" id="2262897">extFloat</span><span class="op" id="2262905">)</span>&nbsp;<span class="op" id="2262907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262910">fhi</span><span class="op" id="2262913">,</span>&nbsp;<span class="ident" id="2262915">flo</span>&nbsp;<span class="op" id="2262919">:=</span>&nbsp;<span class="ident" id="2262922">f</span><span class="op" id="2262923">.</span><span class="ident" id="2262924">mant</span><span class="op" id="2262928">&gt;&gt;</span><span class="num" id="2262930">32</span><span class="op" id="2262932">,</span>&nbsp;<span class="ident" id="2262934">uint64</span><span class="op" id="2262940">(</span><span class="builtintype" id="2262941">uint32</span><span class="op" id="2262947">(</span><span class="ident" id="2262948">f</span><span class="op" id="2262949">.</span><span class="ident" id="2262950">mant</span><span class="op" id="2262954">)</span><span class="op" id="2262955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262958">ghi</span><span class="op" id="2262961">,</span>&nbsp;<span class="ident" id="2262963">glo</span>&nbsp;<span class="op" id="2262967">:=</span>&nbsp;<span class="ident" id="2262970">g</span><span class="op" id="2262971">.</span><span class="ident" id="2262972">mant</span><span class="op" id="2262976">&gt;&gt;</span><span class="num" id="2262978">32</span><span class="op" id="2262980">,</span>&nbsp;<span class="ident" id="2262982">uint64</span><span class="op" id="2262988">(</span><span class="builtintype" id="2262989">uint32</span><span class="op" id="2262995">(</span><span class="ident" id="2262996">g</span><span class="op" id="2262997">.</span><span class="ident" id="2262998">mant</span><span class="op" id="2263002">)</span><span class="op" id="2263003">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2263007">//&nbsp;Cross&nbsp;products.</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263027">cross1</span>&nbsp;<span class="op" id="2263034">:=</span>&nbsp;<span class="ident" id="2263037">fhi</span>&nbsp;<span class="op" id="2263041">*</span>&nbsp;<span class="ident" id="2263043">glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263048">cross2</span>&nbsp;<span class="op" id="2263055">:=</span>&nbsp;<span class="ident" id="2263058">flo</span>&nbsp;<span class="op" id="2263062">*</span>&nbsp;<span class="ident" id="2263064">ghi</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2263070">//&nbsp;f.mant*g.mant&nbsp;is&nbsp;fhi*ghi&nbsp;&lt;&lt;&nbsp;64&nbsp;+&nbsp;(cross1+cross2)&nbsp;&lt;&lt;&nbsp;32&nbsp;+&nbsp;flo*glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263139">f</span><span class="op" id="2263140">.</span><span class="ident" id="2263141">mant</span>&nbsp;<span class="op" id="2263146">=</span>&nbsp;<span class="ident" id="2263148">fhi</span><span class="op" id="2263151">*</span><span class="ident" id="2263152">ghi</span>&nbsp;<span class="op" id="2263156">+</span>&nbsp;<span class="op" id="2263158">(</span><span class="ident" id="2263159">cross1</span>&nbsp;<span class="op" id="2263166">&gt;&gt;</span>&nbsp;<span class="num" id="2263169">32</span><span class="op" id="2263171">)</span>&nbsp;<span class="op" id="2263173">+</span>&nbsp;<span class="op" id="2263175">(</span><span class="ident" id="2263176">cross2</span>&nbsp;<span class="op" id="2263183">&gt;&gt;</span>&nbsp;<span class="num" id="2263186">32</span><span class="op" id="2263188">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263191">rem</span>&nbsp;<span class="op" id="2263195">:=</span>&nbsp;<span class="ident" id="2263198">uint64</span><span class="op" id="2263204">(</span><span class="builtintype" id="2263205">uint32</span><span class="op" id="2263211">(</span><span class="ident" id="2263212">cross1</span><span class="op" id="2263218">)</span><span class="op" id="2263219">)</span>&nbsp;<span class="op" id="2263221">+</span>&nbsp;<span class="ident" id="2263223">uint64</span><span class="op" id="2263229">(</span><span class="builtintype" id="2263230">uint32</span><span class="op" id="2263236">(</span><span class="ident" id="2263237">cross2</span><span class="op" id="2263243">)</span><span class="op" id="2263244">)</span>&nbsp;<span class="op" id="2263246">+</span>&nbsp;<span class="op" id="2263248">(</span><span class="op" id="2263249">(</span><span class="ident" id="2263250">flo</span>&nbsp;<span class="op" id="2263254">*</span>&nbsp;<span class="ident" id="2263256">glo</span><span class="op" id="2263259">)</span>&nbsp;<span class="op" id="2263261">&gt;&gt;</span>&nbsp;<span class="num" id="2263264">32</span><span class="op" id="2263266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2263269">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263283">rem</span>&nbsp;<span class="op" id="2263287">+=</span>&nbsp;<span class="op" id="2263290">(</span><span class="num" id="2263291">1</span>&nbsp;<span class="op" id="2263293">&lt;&lt;</span>&nbsp;<span class="num" id="2263296">31</span><span class="op" id="2263298">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263302">f</span><span class="op" id="2263303">.</span><span class="ident" id="2263304">mant</span>&nbsp;<span class="op" id="2263309">+=</span>&nbsp;<span class="op" id="2263312">(</span><span class="ident" id="2263313">rem</span>&nbsp;<span class="op" id="2263317">&gt;&gt;</span>&nbsp;<span class="num" id="2263320">32</span><span class="op" id="2263322">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263325">f</span><span class="op" id="2263326">.</span><span class="ident" id="2263327">exp</span>&nbsp;<span class="op" id="2263331">=</span>&nbsp;<span class="ident" id="2263333">f</span><span class="op" id="2263334">.</span><span class="ident" id="2263335">exp</span>&nbsp;<span class="op" id="2263339">+</span>&nbsp;<span class="ident" id="2263341">g</span><span class="op" id="2263342">.</span><span class="ident" id="2263343">exp</span>&nbsp;<span class="op" id="2263347">+</span>&nbsp;<span class="num" id="2263349">64</span><br>
<span class="lineno"></span><span class="op" id="2263352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2263355">var</span>&nbsp;<span class="ident" id="2263359">uint64pow10</span>&nbsp;<span class="op" id="2263371">=</span>&nbsp;<span class="op" id="2263373">[</span><span class="op" id="2263374">...</span><span class="op" id="2263377">]</span><span class="ident" id="2263378">uint64</span><span class="op" id="2263384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2263387">1</span><span class="op" id="2263388">,</span>&nbsp;<span class="num" id="2263390">1e1</span><span class="op" id="2263393">,</span>&nbsp;<span class="num" id="2263395">1e2</span><span class="op" id="2263398">,</span>&nbsp;<span class="num" id="2263400">1e3</span><span class="op" id="2263403">,</span>&nbsp;<span class="num" id="2263405">1e4</span><span class="op" id="2263408">,</span>&nbsp;<span class="num" id="2263410">1e5</span><span class="op" id="2263413">,</span>&nbsp;<span class="num" id="2263415">1e6</span><span class="op" id="2263418">,</span>&nbsp;<span class="num" id="2263420">1e7</span><span class="op" id="2263423">,</span>&nbsp;<span class="num" id="2263425">1e8</span><span class="op" id="2263428">,</span>&nbsp;<span class="num" id="2263430">1e9</span><span class="op" id="2263433">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2263436">1e10</span><span class="op" id="2263440">,</span>&nbsp;<span class="num" id="2263442">1e11</span><span class="op" id="2263446">,</span>&nbsp;<span class="num" id="2263448">1e12</span><span class="op" id="2263452">,</span>&nbsp;<span class="num" id="2263454">1e13</span><span class="op" id="2263458">,</span>&nbsp;<span class="num" id="2263460">1e14</span><span class="op" id="2263464">,</span>&nbsp;<span class="num" id="2263466">1e15</span><span class="op" id="2263470">,</span>&nbsp;<span class="num" id="2263472">1e16</span><span class="op" id="2263476">,</span>&nbsp;<span class="num" id="2263478">1e17</span><span class="op" id="2263482">,</span>&nbsp;<span class="num" id="2263484">1e18</span><span class="op" id="2263488">,</span>&nbsp;<span class="num" id="2263490">1e19</span><span class="op" id="2263494">,</span><br>
<span class="lineno"></span><span class="op" id="2263496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2263499">//&nbsp;AssignDecimal&nbsp;sets&nbsp;f&nbsp;to&nbsp;an&nbsp;approximate&nbsp;value&nbsp;mantissa*10^exp.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2263567">//&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;value&nbsp;represented&nbsp;by&nbsp;f&nbsp;is&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="2263637">//&nbsp;best&nbsp;approximation&nbsp;of&nbsp;d&nbsp;after&nbsp;being&nbsp;rounded&nbsp;to&nbsp;a&nbsp;float64&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2263700">//&nbsp;float32&nbsp;depending&nbsp;on&nbsp;flt.</span><br>
<span class="lineno"></span><span class="keyword" id="2263729">func</span>&nbsp;<span class="op" id="2263734">(</span><span class="ident" id="2263735">f</span>&nbsp;<span class="op" id="2263737">*</span><span class="ident" id="2263738">extFloat</span><span class="op" id="2263746">)</span>&nbsp;<span class="ident" id="2263748">AssignDecimal</span><span class="op" id="2263761">(</span><span class="ident" id="2263762">mantissa</span>&nbsp;<span class="ident" id="2263771">uint64</span><span class="op" id="2263777">,</span>&nbsp;<span class="ident" id="2263779">exp10</span>&nbsp;<span class="builtintype" id="2263785">int</span><span class="op" id="2263788">,</span>&nbsp;<span class="ident" id="2263790">neg</span>&nbsp;<span class="builtintype" id="2263794">bool</span><span class="op" id="2263798">,</span>&nbsp;<span class="ident" id="2263800">trunc</span>&nbsp;<span class="builtintype" id="2263806">bool</span><span class="op" id="2263810">,</span>&nbsp;<span class="ident" id="2263812">flt</span>&nbsp;<span class="op" id="2263816">*</span><span class="ident" id="2263817">floatInfo</span><span class="op" id="2263826">)</span>&nbsp;<span class="op" id="2263828">(</span><span class="ident" id="2263829">ok</span>&nbsp;<span class="builtintype" id="2263832">bool</span><span class="op" id="2263836">)</span>&nbsp;<span class="op" id="2263838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2263841">const</span>&nbsp;<span class="ident" id="2263847">uint64digits</span>&nbsp;<span class="op" id="2263860">=</span>&nbsp;<span class="num" id="2263862">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2263866">const</span>&nbsp;<span class="ident" id="2263872">errorscale</span>&nbsp;<span class="op" id="2263883">=</span>&nbsp;<span class="num" id="2263885">8</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263888">errors</span>&nbsp;<span class="op" id="2263895">:=</span>&nbsp;<span class="num" id="2263898">0</span>&nbsp;<span class="comment" id="2263900">//&nbsp;An&nbsp;upper&nbsp;bound&nbsp;for&nbsp;error,&nbsp;computed&nbsp;in&nbsp;errorscale*ulp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2263958">if</span>&nbsp;<span class="ident" id="2263961">trunc</span>&nbsp;<span class="op" id="2263967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2263971">//&nbsp;the&nbsp;decimal&nbsp;number&nbsp;was&nbsp;truncated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264010">errors</span>&nbsp;<span class="op" id="2264017">+=</span>&nbsp;<span class="ident" id="2264020">errorscale</span>&nbsp;<span class="op" id="2264031">/</span>&nbsp;<span class="num" id="2264033">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2264036">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264040">f</span><span class="op" id="2264041">.</span><span class="ident" id="2264042">mant</span>&nbsp;<span class="op" id="2264047">=</span>&nbsp;<span class="ident" id="2264049">mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264059">f</span><span class="op" id="2264060">.</span><span class="ident" id="2264061">exp</span>&nbsp;<span class="op" id="2264065">=</span>&nbsp;<span class="num" id="2264067">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264070">f</span><span class="op" id="2264071">.</span><span class="ident" id="2264072">neg</span>&nbsp;<span class="op" id="2264076">=</span>&nbsp;<span class="ident" id="2264078">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2264084">//&nbsp;Multiply&nbsp;by&nbsp;powers&nbsp;of&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264115">i</span>&nbsp;<span class="op" id="2264117">:=</span>&nbsp;<span class="op" id="2264120">(</span><span class="ident" id="2264121">exp10</span>&nbsp;<span class="op" id="2264127">-</span>&nbsp;<span class="ident" id="2264129">firstPowerOfTen</span><span class="op" id="2264144">)</span>&nbsp;<span class="op" id="2264146">/</span>&nbsp;<span class="ident" id="2264148">stepPowerOfTen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264164">if</span>&nbsp;<span class="ident" id="2264167">exp10</span>&nbsp;<span class="op" id="2264173">&lt;</span>&nbsp;<span class="ident" id="2264175">firstPowerOfTen</span>&nbsp;<span class="op" id="2264191">||</span>&nbsp;<span class="ident" id="2264194">i</span>&nbsp;<span class="op" id="2264196">&gt;=</span>&nbsp;<span class="builtinfunc" id="2264199">len</span><span class="op" id="2264202">(</span><span class="ident" id="2264203">powersOfTen</span><span class="op" id="2264214">)</span>&nbsp;<span class="op" id="2264216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264220">return</span>&nbsp;<span class="builtintype" id="2264227">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2264234">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264237">adjExp</span>&nbsp;<span class="op" id="2264244">:=</span>&nbsp;<span class="op" id="2264247">(</span><span class="ident" id="2264248">exp10</span>&nbsp;<span class="op" id="2264254">-</span>&nbsp;<span class="ident" id="2264256">firstPowerOfTen</span><span class="op" id="2264271">)</span>&nbsp;<span class="op" id="2264273">%</span>&nbsp;<span class="ident" id="2264275">stepPowerOfTen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2264292">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;exp%step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264320">if</span>&nbsp;<span class="ident" id="2264323">adjExp</span>&nbsp;<span class="op" id="2264330">&lt;</span>&nbsp;<span class="ident" id="2264332">uint64digits</span>&nbsp;<span class="op" id="2264345">&amp;&amp;</span>&nbsp;<span class="ident" id="2264348">mantissa</span>&nbsp;<span class="op" id="2264357">&lt;</span>&nbsp;<span class="ident" id="2264359">uint64pow10</span><span class="op" id="2264370">[</span><span class="ident" id="2264371">uint64digits</span><span class="op" id="2264383">-</span><span class="ident" id="2264384">adjExp</span><span class="op" id="2264390">]</span>&nbsp;<span class="op" id="2264392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2264396">//&nbsp;We&nbsp;can&nbsp;multiply&nbsp;the&nbsp;mantissa&nbsp;exactly.</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264439">f</span><span class="op" id="2264440">.</span><span class="ident" id="2264441">mant</span>&nbsp;<span class="op" id="2264446">*=</span>&nbsp;<span class="ident" id="2264449">uint64pow10</span><span class="op" id="2264460">[</span><span class="ident" id="2264461">adjExp</span><span class="op" id="2264467">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264471">f</span><span class="op" id="2264472">.</span><span class="ident" id="2264473">Normalize</span><span class="op" id="2264482">(</span><span class="op" id="2264483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2264486">}</span>&nbsp;<span class="keyword" id="2264488">else</span>&nbsp;<span class="op" id="2264493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264497">f</span><span class="op" id="2264498">.</span><span class="ident" id="2264499">Normalize</span><span class="op" id="2264508">(</span><span class="op" id="2264509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264513">f</span><span class="op" id="2264514">.</span><span class="ident" id="2264515">Multiply</span><span class="op" id="2264523">(</span><span class="ident" id="2264524">smallPowersOfTen</span><span class="op" id="2264540">[</span><span class="ident" id="2264541">adjExp</span><span class="op" id="2264547">]</span><span class="op" id="2264548">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264552">errors</span>&nbsp;<span class="op" id="2264559">+=</span>&nbsp;<span class="ident" id="2264562">errorscale</span>&nbsp;<span class="op" id="2264573">/</span>&nbsp;<span class="num" id="2264575">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2264578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2264582">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;10&nbsp;to&nbsp;the&nbsp;exp&nbsp;-&nbsp;exp%step.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264627">f</span><span class="op" id="2264628">.</span><span class="ident" id="2264629">Multiply</span><span class="op" id="2264637">(</span><span class="ident" id="2264638">powersOfTen</span><span class="op" id="2264649">[</span><span class="ident" id="2264650">i</span><span class="op" id="2264651">]</span><span class="op" id="2264652">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264655">if</span>&nbsp;<span class="ident" id="2264658">errors</span>&nbsp;<span class="op" id="2264665">&gt;</span>&nbsp;<span class="num" id="2264667">0</span>&nbsp;<span class="op" id="2264669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264673">errors</span>&nbsp;<span class="op" id="2264680">+=</span>&nbsp;<span class="num" id="2264683">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2264686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264689">errors</span>&nbsp;<span class="op" id="2264696">+=</span>&nbsp;<span class="ident" id="2264699">errorscale</span>&nbsp;<span class="op" id="2264710">/</span>&nbsp;<span class="num" id="2264712">2</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2264716">//&nbsp;Normalize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264730">shift</span>&nbsp;<span class="op" id="2264736">:=</span>&nbsp;<span class="ident" id="2264739">f</span><span class="op" id="2264740">.</span><span class="ident" id="2264741">Normalize</span><span class="op" id="2264750">(</span><span class="op" id="2264751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264754">errors</span>&nbsp;<span class="op" id="2264761">&lt;&lt;=</span>&nbsp;<span class="ident" id="2264765">shift</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2264773">//&nbsp;Now&nbsp;f&nbsp;is&nbsp;a&nbsp;good&nbsp;approximation&nbsp;of&nbsp;the&nbsp;decimal.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2264823">//&nbsp;Check&nbsp;whether&nbsp;the&nbsp;error&nbsp;is&nbsp;too&nbsp;large:&nbsp;that&nbsp;is,&nbsp;if&nbsp;the&nbsp;mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2264890">//&nbsp;is&nbsp;perturbated&nbsp;by&nbsp;the&nbsp;error,&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;will&nbsp;change.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2264958">//&nbsp;The&nbsp;64&nbsp;bits&nbsp;mantissa&nbsp;is&nbsp;1&nbsp;+&nbsp;52&nbsp;bits&nbsp;for&nbsp;float64&nbsp;+&nbsp;11&nbsp;extra&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2265027">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2265031">//&nbsp;In&nbsp;many&nbsp;cases&nbsp;the&nbsp;approximation&nbsp;will&nbsp;be&nbsp;good&nbsp;enough.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265088">denormalExp</span>&nbsp;<span class="op" id="2265100">:=</span>&nbsp;<span class="ident" id="2265103">flt</span><span class="op" id="2265106">.</span><span class="ident" id="2265107">bias</span>&nbsp;<span class="op" id="2265112">-</span>&nbsp;<span class="num" id="2265114">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2265118">var</span>&nbsp;<span class="ident" id="2265122">extrabits</span>&nbsp;<span class="builtintype" id="2265132">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2265138">if</span>&nbsp;<span class="ident" id="2265141">f</span><span class="op" id="2265142">.</span><span class="ident" id="2265143">exp</span>&nbsp;<span class="op" id="2265147">&lt;=</span>&nbsp;<span class="ident" id="2265150">denormalExp</span>&nbsp;<span class="op" id="2265162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2265166">//&nbsp;f.mant&nbsp;*&nbsp;2^f.exp&nbsp;is&nbsp;smaller&nbsp;than&nbsp;2^(flt.bias+1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265220">extrabits</span>&nbsp;<span class="op" id="2265230">=</span>&nbsp;<span class="builtintype" id="2265232">uint</span><span class="op" id="2265236">(</span><span class="num" id="2265237">63</span>&nbsp;<span class="op" id="2265240">-</span>&nbsp;<span class="ident" id="2265242">flt</span><span class="op" id="2265245">.</span><span class="ident" id="2265246">mantbits</span>&nbsp;<span class="op" id="2265255">+</span>&nbsp;<span class="num" id="2265257">1</span>&nbsp;<span class="op" id="2265259">+</span>&nbsp;<span class="builtintype" id="2265261">uint</span><span class="op" id="2265265">(</span><span class="ident" id="2265266">denormalExp</span><span class="op" id="2265277">-</span><span class="ident" id="2265278">f</span><span class="op" id="2265279">.</span><span class="ident" id="2265280">exp</span><span class="op" id="2265283">)</span><span class="op" id="2265284">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2265287">}</span>&nbsp;<span class="keyword" id="2265289">else</span>&nbsp;<span class="op" id="2265294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265298">extrabits</span>&nbsp;<span class="op" id="2265308">=</span>&nbsp;<span class="builtintype" id="2265310">uint</span><span class="op" id="2265314">(</span><span class="num" id="2265315">63</span>&nbsp;<span class="op" id="2265318">-</span>&nbsp;<span class="ident" id="2265320">flt</span><span class="op" id="2265323">.</span><span class="ident" id="2265324">mantbits</span><span class="op" id="2265332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2265335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265339">halfway</span>&nbsp;<span class="op" id="2265347">:=</span>&nbsp;<span class="ident" id="2265350">uint64</span><span class="op" id="2265356">(</span><span class="num" id="2265357">1</span><span class="op" id="2265358">)</span>&nbsp;<span class="op" id="2265360">&lt;&lt;</span>&nbsp;<span class="op" id="2265363">(</span><span class="ident" id="2265364">extrabits</span>&nbsp;<span class="op" id="2265374">-</span>&nbsp;<span class="num" id="2265376">1</span><span class="op" id="2265377">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265380">mant_extra</span>&nbsp;<span class="op" id="2265391">:=</span>&nbsp;<span class="ident" id="2265394">f</span><span class="op" id="2265395">.</span><span class="ident" id="2265396">mant</span>&nbsp;<span class="op" id="2265401">&amp;</span>&nbsp;<span class="op" id="2265403">(</span><span class="num" id="2265404">1</span><span class="op" id="2265405">&lt;&lt;</span><span class="ident" id="2265407">extrabits</span>&nbsp;<span class="op" id="2265417">-</span>&nbsp;<span class="num" id="2265419">1</span><span class="op" id="2265420">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2265424">//&nbsp;Do&nbsp;a&nbsp;signed&nbsp;comparison&nbsp;here!&nbsp;If&nbsp;the&nbsp;error&nbsp;estimate&nbsp;could&nbsp;make</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2265490">//&nbsp;the&nbsp;mantissa&nbsp;round&nbsp;differently&nbsp;for&nbsp;the&nbsp;conversion&nbsp;to&nbsp;double,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2265555">//&nbsp;then&nbsp;we&nbsp;can&#39;t&nbsp;give&nbsp;a&nbsp;definite&nbsp;answer.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2265597">if</span>&nbsp;<span class="ident" id="2265600">int64</span><span class="op" id="2265605">(</span><span class="ident" id="2265606">halfway</span><span class="op" id="2265613">)</span><span class="op" id="2265614">-</span><span class="ident" id="2265615">int64</span><span class="op" id="2265620">(</span><span class="ident" id="2265621">errors</span><span class="op" id="2265627">)</span>&nbsp;<span class="op" id="2265629">&lt;</span>&nbsp;<span class="ident" id="2265631">int64</span><span class="op" id="2265636">(</span><span class="ident" id="2265637">mant_extra</span><span class="op" id="2265647">)</span>&nbsp;<span class="op" id="2265649">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265654">int64</span><span class="op" id="2265659">(</span><span class="ident" id="2265660">mant_extra</span><span class="op" id="2265670">)</span>&nbsp;<span class="op" id="2265672">&lt;</span>&nbsp;<span class="ident" id="2265674">int64</span><span class="op" id="2265679">(</span><span class="ident" id="2265680">halfway</span><span class="op" id="2265687">)</span><span class="op" id="2265688">+</span><span class="ident" id="2265689">int64</span><span class="op" id="2265694">(</span><span class="ident" id="2265695">errors</span><span class="op" id="2265701">)</span>&nbsp;<span class="op" id="2265703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2265707">return</span>&nbsp;<span class="builtintype" id="2265714">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2265721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2265724">return</span>&nbsp;<span class="builtintype" id="2265731">true</span><br>
<span class="lineno">330</span><span class="op" id="2265736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2265739">//&nbsp;Frexp10&nbsp;is&nbsp;an&nbsp;analogue&nbsp;of&nbsp;math.Frexp&nbsp;for&nbsp;decimal&nbsp;powers.&nbsp;It&nbsp;scales</span><br>
<span class="lineno"></span><span class="comment" id="2265809">//&nbsp;f&nbsp;by&nbsp;an&nbsp;approximate&nbsp;power&nbsp;of&nbsp;ten&nbsp;10^-exp,&nbsp;and&nbsp;returns&nbsp;exp10,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="2265876">//&nbsp;that&nbsp;f*10^exp10&nbsp;has&nbsp;the&nbsp;same&nbsp;value&nbsp;as&nbsp;the&nbsp;old&nbsp;f,&nbsp;up&nbsp;to&nbsp;an&nbsp;ulp,</span><br>
<span class="lineno">335</span><span class="comment" id="2265942">//&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;index&nbsp;of&nbsp;10^-exp&nbsp;in&nbsp;the&nbsp;powersOfTen&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="2266003">func</span>&nbsp;<span class="op" id="2266008">(</span><span class="ident" id="2266009">f</span>&nbsp;<span class="op" id="2266011">*</span><span class="ident" id="2266012">extFloat</span><span class="op" id="2266020">)</span>&nbsp;<span class="ident" id="2266022">frexp10</span><span class="op" id="2266029">(</span><span class="op" id="2266030">)</span>&nbsp;<span class="op" id="2266032">(</span><span class="ident" id="2266033">exp10</span><span class="op" id="2266038">,</span>&nbsp;<span class="ident" id="2266040">index</span>&nbsp;<span class="builtintype" id="2266046">int</span><span class="op" id="2266049">)</span>&nbsp;<span class="op" id="2266051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2266054">//&nbsp;The&nbsp;constants&nbsp;expMin&nbsp;and&nbsp;expMax&nbsp;constrain&nbsp;the&nbsp;final&nbsp;value&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2266123">//&nbsp;binary&nbsp;exponent&nbsp;of&nbsp;f.&nbsp;We&nbsp;want&nbsp;a&nbsp;small&nbsp;integral&nbsp;part&nbsp;in&nbsp;the&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2266193">//&nbsp;because&nbsp;finding&nbsp;digits&nbsp;of&nbsp;an&nbsp;integer&nbsp;requires&nbsp;divisions,&nbsp;whereas</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2266262">//&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part&nbsp;can&nbsp;be&nbsp;found&nbsp;by&nbsp;repeatedly&nbsp;multiplying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2266335">//&nbsp;by&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266346">const</span>&nbsp;<span class="ident" id="2266352">expMin</span>&nbsp;<span class="op" id="2266359">=</span>&nbsp;<span class="op" id="2266361">-</span><span class="num" id="2266362">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266366">const</span>&nbsp;<span class="ident" id="2266372">expMax</span>&nbsp;<span class="op" id="2266379">=</span>&nbsp;<span class="op" id="2266381">-</span><span class="num" id="2266382">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2266386">//&nbsp;Find&nbsp;power&nbsp;of&nbsp;ten&nbsp;such&nbsp;that&nbsp;x&nbsp;*&nbsp;10^n&nbsp;has&nbsp;a&nbsp;binary&nbsp;exponent</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2266449">//&nbsp;between&nbsp;expMin&nbsp;and&nbsp;expMax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266480">approxExp10</span>&nbsp;<span class="op" id="2266492">:=</span>&nbsp;<span class="op" id="2266495">(</span><span class="op" id="2266496">(</span><span class="ident" id="2266497">expMin</span><span class="op" id="2266503">+</span><span class="ident" id="2266504">expMax</span><span class="op" id="2266510">)</span><span class="op" id="2266511">/</span><span class="num" id="2266512">2</span>&nbsp;<span class="op" id="2266514">-</span>&nbsp;<span class="ident" id="2266516">f</span><span class="op" id="2266517">.</span><span class="ident" id="2266518">exp</span><span class="op" id="2266521">)</span>&nbsp;<span class="op" id="2266523">*</span>&nbsp;<span class="num" id="2266525">28</span>&nbsp;<span class="op" id="2266528">/</span>&nbsp;<span class="num" id="2266530">93</span>&nbsp;<span class="comment" id="2266533">//&nbsp;log(10)/log(2)&nbsp;is&nbsp;close&nbsp;to&nbsp;93/28.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266571">i</span>&nbsp;<span class="op" id="2266573">:=</span>&nbsp;<span class="op" id="2266576">(</span><span class="ident" id="2266577">approxExp10</span>&nbsp;<span class="op" id="2266589">-</span>&nbsp;<span class="ident" id="2266591">firstPowerOfTen</span><span class="op" id="2266606">)</span>&nbsp;<span class="op" id="2266608">/</span>&nbsp;<span class="ident" id="2266610">stepPowerOfTen</span><br>
<span class="lineno"></span><span class="ident" id="2266625">Loop</span><span class="op" id="2266629">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266632">for</span>&nbsp;<span class="op" id="2266636">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266640">exp</span>&nbsp;<span class="op" id="2266644">:=</span>&nbsp;<span class="ident" id="2266647">f</span><span class="op" id="2266648">.</span><span class="ident" id="2266649">exp</span>&nbsp;<span class="op" id="2266653">+</span>&nbsp;<span class="ident" id="2266655">powersOfTen</span><span class="op" id="2266666">[</span><span class="ident" id="2266667">i</span><span class="op" id="2266668">]</span><span class="op" id="2266669">.</span><span class="ident" id="2266670">exp</span>&nbsp;<span class="op" id="2266674">+</span>&nbsp;<span class="num" id="2266676">64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266681">switch</span>&nbsp;<span class="op" id="2266688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266692">case</span>&nbsp;<span class="ident" id="2266697">exp</span>&nbsp;<span class="op" id="2266701">&lt;</span>&nbsp;<span class="ident" id="2266703">expMin</span><span class="op" id="2266709">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266714">i</span><span class="op" id="2266715">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266720">case</span>&nbsp;<span class="ident" id="2266725">exp</span>&nbsp;<span class="op" id="2266729">&gt;</span>&nbsp;<span class="ident" id="2266731">expMax</span><span class="op" id="2266737">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266742">i</span><span class="op" id="2266743">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266748">default</span><span class="op" id="2266755">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266760">break</span>&nbsp;<span class="ident" id="2266766">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2266773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2266776">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2266779">//&nbsp;Apply&nbsp;the&nbsp;desired&nbsp;decimal&nbsp;shift&nbsp;on&nbsp;f.&nbsp;It&nbsp;will&nbsp;have&nbsp;exponent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2266843">//&nbsp;in&nbsp;the&nbsp;desired&nbsp;range.&nbsp;This&nbsp;is&nbsp;multiplication&nbsp;by&nbsp;10^-exp10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266906">f</span><span class="op" id="2266907">.</span><span class="ident" id="2266908">Multiply</span><span class="op" id="2266916">(</span><span class="ident" id="2266917">powersOfTen</span><span class="op" id="2266928">[</span><span class="ident" id="2266929">i</span><span class="op" id="2266930">]</span><span class="op" id="2266931">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266935">return</span>&nbsp;<span class="op" id="2266942">-</span><span class="op" id="2266943">(</span><span class="ident" id="2266944">firstPowerOfTen</span>&nbsp;<span class="op" id="2266960">+</span>&nbsp;<span class="ident" id="2266962">i</span><span class="op" id="2266963">*</span><span class="ident" id="2266964">stepPowerOfTen</span><span class="op" id="2266978">)</span><span class="op" id="2266979">,</span>&nbsp;<span class="ident" id="2266981">i</span><br>
<span class="lineno">365</span><span class="op" id="2266983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2266986">//&nbsp;frexp10Many&nbsp;applies&nbsp;a&nbsp;common&nbsp;shift&nbsp;by&nbsp;a&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;a,&nbsp;b,&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="2267054">func</span>&nbsp;<span class="ident" id="2267059">frexp10Many</span><span class="op" id="2267070">(</span><span class="ident" id="2267071">a</span><span class="op" id="2267072">,</span>&nbsp;<span class="ident" id="2267074">b</span><span class="op" id="2267075">,</span>&nbsp;<span class="ident" id="2267077">c</span>&nbsp;<span class="op" id="2267079">*</span><span class="ident" id="2267080">extFloat</span><span class="op" id="2267088">)</span>&nbsp;<span class="op" id="2267090">(</span><span class="ident" id="2267091">exp10</span>&nbsp;<span class="builtintype" id="2267097">int</span><span class="op" id="2267100">)</span>&nbsp;<span class="op" id="2267102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267105">exp10</span><span class="op" id="2267110">,</span>&nbsp;<span class="ident" id="2267112">i</span>&nbsp;<span class="op" id="2267114">:=</span>&nbsp;<span class="ident" id="2267117">c</span><span class="op" id="2267118">.</span><span class="ident" id="2267119">frexp10</span><span class="op" id="2267126">(</span><span class="op" id="2267127">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267130">a</span><span class="op" id="2267131">.</span><span class="ident" id="2267132">Multiply</span><span class="op" id="2267140">(</span><span class="ident" id="2267141">powersOfTen</span><span class="op" id="2267152">[</span><span class="ident" id="2267153">i</span><span class="op" id="2267154">]</span><span class="op" id="2267155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267158">b</span><span class="op" id="2267159">.</span><span class="ident" id="2267160">Multiply</span><span class="op" id="2267168">(</span><span class="ident" id="2267169">powersOfTen</span><span class="op" id="2267180">[</span><span class="ident" id="2267181">i</span><span class="op" id="2267182">]</span><span class="op" id="2267183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267186">return</span><br>
<span class="lineno"></span><span class="op" id="2267193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="2267196">//&nbsp;FixedDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;first&nbsp;n&nbsp;significant&nbsp;digits</span><br>
<span class="lineno"></span><span class="comment" id="2267255">//&nbsp;of&nbsp;the&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f.&nbsp;It&nbsp;returns&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="2267311">//&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;sure&nbsp;of&nbsp;the&nbsp;answer.</span><br>
<span class="lineno"></span><span class="keyword" id="2267350">func</span>&nbsp;<span class="op" id="2267355">(</span><span class="ident" id="2267356">f</span>&nbsp;<span class="op" id="2267358">*</span><span class="ident" id="2267359">extFloat</span><span class="op" id="2267367">)</span>&nbsp;<span class="ident" id="2267369">FixedDecimal</span><span class="op" id="2267381">(</span><span class="ident" id="2267382">d</span>&nbsp;<span class="op" id="2267384">*</span><span class="ident" id="2267385">decimalSlice</span><span class="op" id="2267397">,</span>&nbsp;<span class="ident" id="2267399">n</span>&nbsp;<span class="builtintype" id="2267401">int</span><span class="op" id="2267404">)</span>&nbsp;<span class="builtintype" id="2267406">bool</span>&nbsp;<span class="op" id="2267411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267414">if</span>&nbsp;<span class="ident" id="2267417">f</span><span class="op" id="2267418">.</span><span class="ident" id="2267419">mant</span>&nbsp;<span class="op" id="2267424">==</span>&nbsp;<span class="num" id="2267427">0</span>&nbsp;<span class="op" id="2267429">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267433">d</span><span class="op" id="2267434">.</span><span class="ident" id="2267435">nd</span>&nbsp;<span class="op" id="2267438">=</span>&nbsp;<span class="num" id="2267440">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267444">d</span><span class="op" id="2267445">.</span><span class="ident" id="2267446">dp</span>&nbsp;<span class="op" id="2267449">=</span>&nbsp;<span class="num" id="2267451">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267455">d</span><span class="op" id="2267456">.</span><span class="ident" id="2267457">neg</span>&nbsp;<span class="op" id="2267461">=</span>&nbsp;<span class="ident" id="2267463">f</span><span class="op" id="2267464">.</span><span class="ident" id="2267465">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267471">return</span>&nbsp;<span class="builtintype" id="2267478">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267484">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267487">if</span>&nbsp;<span class="ident" id="2267490">n</span>&nbsp;<span class="op" id="2267492">==</span>&nbsp;<span class="num" id="2267495">0</span>&nbsp;<span class="op" id="2267497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2267501">panic</span><span class="op" id="2267506">(</span><span class="string" id="2267507">&#34;strconv:&nbsp;internal&nbsp;error:&nbsp;extFloat.FixedDecimal&nbsp;called&nbsp;with&nbsp;n&nbsp;==&nbsp;0&#34;</span><span class="op" id="2267574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2267580">//&nbsp;Multiply&nbsp;by&nbsp;an&nbsp;appropriate&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;have&nbsp;a&nbsp;reasonable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2267645">//&nbsp;number&nbsp;to&nbsp;process.</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267668">f</span><span class="op" id="2267669">.</span><span class="ident" id="2267670">Normalize</span><span class="op" id="2267679">(</span><span class="op" id="2267680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267683">exp10</span><span class="op" id="2267688">,</span>&nbsp;<span class="ident" id="2267690">_</span>&nbsp;<span class="op" id="2267692">:=</span>&nbsp;<span class="ident" id="2267695">f</span><span class="op" id="2267696">.</span><span class="ident" id="2267697">frexp10</span><span class="op" id="2267704">(</span><span class="op" id="2267705">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267709">shift</span>&nbsp;<span class="op" id="2267715">:=</span>&nbsp;<span class="builtintype" id="2267718">uint</span><span class="op" id="2267722">(</span><span class="op" id="2267723">-</span><span class="ident" id="2267724">f</span><span class="op" id="2267725">.</span><span class="ident" id="2267726">exp</span><span class="op" id="2267729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267732">integer</span>&nbsp;<span class="op" id="2267740">:=</span>&nbsp;<span class="builtintype" id="2267743">uint32</span><span class="op" id="2267749">(</span><span class="ident" id="2267750">f</span><span class="op" id="2267751">.</span><span class="ident" id="2267752">mant</span>&nbsp;<span class="op" id="2267757">&gt;&gt;</span>&nbsp;<span class="ident" id="2267760">shift</span><span class="op" id="2267765">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267768">fraction</span>&nbsp;<span class="op" id="2267777">:=</span>&nbsp;<span class="ident" id="2267780">f</span><span class="op" id="2267781">.</span><span class="ident" id="2267782">mant</span>&nbsp;<span class="op" id="2267787">-</span>&nbsp;<span class="op" id="2267789">(</span><span class="ident" id="2267790">uint64</span><span class="op" id="2267796">(</span><span class="ident" id="2267797">integer</span><span class="op" id="2267804">)</span>&nbsp;<span class="op" id="2267806">&lt;&lt;</span>&nbsp;<span class="ident" id="2267809">shift</span><span class="op" id="2267814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267817">ε</span>&nbsp;<span class="op" id="2267820">:=</span>&nbsp;<span class="ident" id="2267823">uint64</span><span class="op" id="2267829">(</span><span class="num" id="2267830">1</span><span class="op" id="2267831">)</span>&nbsp;<span class="comment" id="2267833">//&nbsp;ε&nbsp;is&nbsp;the&nbsp;uncertainty&nbsp;we&nbsp;have&nbsp;on&nbsp;the&nbsp;mantissa&nbsp;of&nbsp;f.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2267890">//&nbsp;Write&nbsp;exactly&nbsp;n&nbsp;digits&nbsp;to&nbsp;d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267923">needed</span>&nbsp;<span class="op" id="2267930">:=</span>&nbsp;<span class="ident" id="2267933">n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2267942">//&nbsp;how&nbsp;many&nbsp;digits&nbsp;are&nbsp;left&nbsp;to&nbsp;write.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267981">integerDigits</span>&nbsp;<span class="op" id="2267995">:=</span>&nbsp;<span class="num" id="2267998">0</span>&nbsp;<span class="comment" id="2268000">//&nbsp;the&nbsp;number&nbsp;of&nbsp;decimal&nbsp;digits&nbsp;of&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268045">pow10</span>&nbsp;<span class="op" id="2268051">:=</span>&nbsp;<span class="ident" id="2268054">uint64</span><span class="op" id="2268060">(</span><span class="num" id="2268061">1</span><span class="op" id="2268062">)</span>&nbsp;<span class="comment" id="2268064">//&nbsp;the&nbsp;power&nbsp;of&nbsp;ten&nbsp;by&nbsp;which&nbsp;f&nbsp;was&nbsp;scaled.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268108">for</span>&nbsp;<span class="ident" id="2268112">i</span><span class="op" id="2268113">,</span>&nbsp;<span class="ident" id="2268115">pow</span>&nbsp;<span class="op" id="2268119">:=</span>&nbsp;<span class="num" id="2268122">0</span><span class="op" id="2268123">,</span>&nbsp;<span class="ident" id="2268125">uint64</span><span class="op" id="2268131">(</span><span class="num" id="2268132">1</span><span class="op" id="2268133">)</span><span class="op" id="2268134">;</span>&nbsp;<span class="ident" id="2268136">i</span>&nbsp;<span class="op" id="2268138">&lt;</span>&nbsp;<span class="num" id="2268140">20</span><span class="op" id="2268142">;</span>&nbsp;<span class="ident" id="2268144">i</span><span class="op" id="2268145">++</span>&nbsp;<span class="op" id="2268148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268152">if</span>&nbsp;<span class="ident" id="2268155">pow</span>&nbsp;<span class="op" id="2268159">&gt;</span>&nbsp;<span class="ident" id="2268161">uint64</span><span class="op" id="2268167">(</span><span class="ident" id="2268168">integer</span><span class="op" id="2268175">)</span>&nbsp;<span class="op" id="2268177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268182">integerDigits</span>&nbsp;<span class="op" id="2268196">=</span>&nbsp;<span class="ident" id="2268198">i</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268203">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268215">pow</span>&nbsp;<span class="op" id="2268219">*=</span>&nbsp;<span class="num" id="2268222">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268229">rest</span>&nbsp;<span class="op" id="2268234">:=</span>&nbsp;<span class="ident" id="2268237">integer</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268246">if</span>&nbsp;<span class="ident" id="2268249">integerDigits</span>&nbsp;<span class="op" id="2268263">&gt;</span>&nbsp;<span class="ident" id="2268265">needed</span>&nbsp;<span class="op" id="2268272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2268276">//&nbsp;the&nbsp;integral&nbsp;part&nbsp;is&nbsp;already&nbsp;large,&nbsp;trim&nbsp;the&nbsp;last&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268339">pow10</span>&nbsp;<span class="op" id="2268345">=</span>&nbsp;<span class="ident" id="2268347">uint64pow10</span><span class="op" id="2268358">[</span><span class="ident" id="2268359">integerDigits</span><span class="op" id="2268372">-</span><span class="ident" id="2268373">needed</span><span class="op" id="2268379">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268383">integer</span>&nbsp;<span class="op" id="2268391">/=</span>&nbsp;<span class="builtintype" id="2268394">uint32</span><span class="op" id="2268400">(</span><span class="ident" id="2268401">pow10</span><span class="op" id="2268406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268410">rest</span>&nbsp;<span class="op" id="2268415">-=</span>&nbsp;<span class="ident" id="2268418">integer</span>&nbsp;<span class="op" id="2268426">*</span>&nbsp;<span class="builtintype" id="2268428">uint32</span><span class="op" id="2268434">(</span><span class="ident" id="2268435">pow10</span><span class="op" id="2268440">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268443">}</span>&nbsp;<span class="keyword" id="2268445">else</span>&nbsp;<span class="op" id="2268450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268454">rest</span>&nbsp;<span class="op" id="2268459">=</span>&nbsp;<span class="num" id="2268461">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2268468">//&nbsp;Write&nbsp;the&nbsp;digits&nbsp;of&nbsp;integer:&nbsp;the&nbsp;digits&nbsp;of&nbsp;rest&nbsp;are&nbsp;omitted.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268533">var</span>&nbsp;<span class="ident" id="2268537">buf</span>&nbsp;<span class="op" id="2268541">[</span><span class="num" id="2268542">32</span><span class="op" id="2268544">]</span><span class="builtintype" id="2268545">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268551">pos</span>&nbsp;<span class="op" id="2268555">:=</span>&nbsp;<span class="builtinfunc" id="2268558">len</span><span class="op" id="2268561">(</span><span class="ident" id="2268562">buf</span><span class="op" id="2268565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268568">for</span>&nbsp;<span class="ident" id="2268572">v</span>&nbsp;<span class="op" id="2268574">:=</span>&nbsp;<span class="ident" id="2268577">integer</span><span class="op" id="2268584">;</span>&nbsp;<span class="ident" id="2268586">v</span>&nbsp;<span class="op" id="2268588">&gt;</span>&nbsp;<span class="num" id="2268590">0</span><span class="op" id="2268591">;</span>&nbsp;<span class="op" id="2268593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268597">v1</span>&nbsp;<span class="op" id="2268600">:=</span>&nbsp;<span class="ident" id="2268603">v</span>&nbsp;<span class="op" id="2268605">/</span>&nbsp;<span class="num" id="2268607">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268612">v</span>&nbsp;<span class="op" id="2268614">-=</span>&nbsp;<span class="num" id="2268617">10</span>&nbsp;<span class="op" id="2268620">*</span>&nbsp;<span class="ident" id="2268622">v1</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268627">pos</span><span class="op" id="2268630">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268635">buf</span><span class="op" id="2268638">[</span><span class="ident" id="2268639">pos</span><span class="op" id="2268642">]</span>&nbsp;<span class="op" id="2268644">=</span>&nbsp;<span class="builtintype" id="2268646">byte</span><span class="op" id="2268650">(</span><span class="ident" id="2268651">v</span>&nbsp;<span class="op" id="2268653">+</span>&nbsp;<span class="string" id="2268655">&#39;0&#39;</span><span class="op" id="2268658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268662">v</span>&nbsp;<span class="op" id="2268664">=</span>&nbsp;<span class="ident" id="2268666">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268673">for</span>&nbsp;<span class="ident" id="2268677">i</span>&nbsp;<span class="op" id="2268679">:=</span>&nbsp;<span class="ident" id="2268682">pos</span><span class="op" id="2268685">;</span>&nbsp;<span class="ident" id="2268687">i</span>&nbsp;<span class="op" id="2268689">&lt;</span>&nbsp;<span class="builtinfunc" id="2268691">len</span><span class="op" id="2268694">(</span><span class="ident" id="2268695">buf</span><span class="op" id="2268698">)</span><span class="op" id="2268699">;</span>&nbsp;<span class="ident" id="2268701">i</span><span class="op" id="2268702">++</span>&nbsp;<span class="op" id="2268705">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268709">d</span><span class="op" id="2268710">.</span><span class="ident" id="2268711">d</span><span class="op" id="2268712">[</span><span class="ident" id="2268713">i</span><span class="op" id="2268714">-</span><span class="ident" id="2268715">pos</span><span class="op" id="2268718">]</span>&nbsp;<span class="op" id="2268720">=</span>&nbsp;<span class="ident" id="2268722">buf</span><span class="op" id="2268725">[</span><span class="ident" id="2268726">i</span><span class="op" id="2268727">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268733">nd</span>&nbsp;<span class="op" id="2268736">:=</span>&nbsp;<span class="builtinfunc" id="2268739">len</span><span class="op" id="2268742">(</span><span class="ident" id="2268743">buf</span><span class="op" id="2268746">)</span>&nbsp;<span class="op" id="2268748">-</span>&nbsp;<span class="ident" id="2268750">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268755">d</span><span class="op" id="2268756">.</span><span class="ident" id="2268757">nd</span>&nbsp;<span class="op" id="2268760">=</span>&nbsp;<span class="ident" id="2268762">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268766">d</span><span class="op" id="2268767">.</span><span class="ident" id="2268768">dp</span>&nbsp;<span class="op" id="2268771">=</span>&nbsp;<span class="ident" id="2268773">integerDigits</span>&nbsp;<span class="op" id="2268787">+</span>&nbsp;<span class="ident" id="2268789">exp10</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268796">needed</span>&nbsp;<span class="op" id="2268803">-=</span>&nbsp;<span class="ident" id="2268806">nd</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268811">if</span>&nbsp;<span class="ident" id="2268814">needed</span>&nbsp;<span class="op" id="2268821">&gt;</span>&nbsp;<span class="num" id="2268823">0</span>&nbsp;<span class="op" id="2268825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268829">if</span>&nbsp;<span class="ident" id="2268832">rest</span>&nbsp;<span class="op" id="2268837">!=</span>&nbsp;<span class="num" id="2268840">0</span>&nbsp;<span class="op" id="2268842">||</span>&nbsp;<span class="ident" id="2268845">pow10</span>&nbsp;<span class="op" id="2268851">!=</span>&nbsp;<span class="num" id="2268854">1</span>&nbsp;<span class="op" id="2268856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2268861">panic</span><span class="op" id="2268866">(</span><span class="string" id="2268867">&#34;strconv:&nbsp;internal&nbsp;error,&nbsp;rest&nbsp;!=&nbsp;0&nbsp;but&nbsp;needed&nbsp;&gt;&nbsp;0&#34;</span><span class="op" id="2268918">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2268926">//&nbsp;Emit&nbsp;digits&nbsp;for&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;Each&nbsp;time,&nbsp;10*fraction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2268991">//&nbsp;fits&nbsp;in&nbsp;a&nbsp;uint64&nbsp;without&nbsp;overflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269031">for</span>&nbsp;<span class="ident" id="2269035">needed</span>&nbsp;<span class="op" id="2269042">&gt;</span>&nbsp;<span class="num" id="2269044">0</span>&nbsp;<span class="op" id="2269046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269051">fraction</span>&nbsp;<span class="op" id="2269060">*=</span>&nbsp;<span class="num" id="2269063">10</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269069">ε</span>&nbsp;<span class="op" id="2269072">*=</span>&nbsp;<span class="num" id="2269075">10</span>&nbsp;<span class="comment" id="2269078">//&nbsp;the&nbsp;uncertainty&nbsp;scales&nbsp;as&nbsp;we&nbsp;multiply&nbsp;by&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269130">if</span>&nbsp;<span class="num" id="2269133">2</span><span class="op" id="2269134">*</span><span class="ident" id="2269135">ε</span>&nbsp;<span class="op" id="2269138">&gt;</span>&nbsp;<span class="num" id="2269140">1</span><span class="op" id="2269141">&lt;&lt;</span><span class="ident" id="2269143">shift</span>&nbsp;<span class="op" id="2269149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2269155">//&nbsp;the&nbsp;error&nbsp;is&nbsp;so&nbsp;large&nbsp;it&nbsp;could&nbsp;modify&nbsp;which&nbsp;digit&nbsp;to&nbsp;write,&nbsp;abort.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269229">return</span>&nbsp;<span class="builtintype" id="2269236">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2269245">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269250">digit</span>&nbsp;<span class="op" id="2269256">:=</span>&nbsp;<span class="ident" id="2269259">fraction</span>&nbsp;<span class="op" id="2269268">&gt;&gt;</span>&nbsp;<span class="ident" id="2269271">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269280">d</span><span class="op" id="2269281">.</span><span class="ident" id="2269282">d</span><span class="op" id="2269283">[</span><span class="ident" id="2269284">nd</span><span class="op" id="2269286">]</span>&nbsp;<span class="op" id="2269288">=</span>&nbsp;<span class="builtintype" id="2269290">byte</span><span class="op" id="2269294">(</span><span class="ident" id="2269295">digit</span>&nbsp;<span class="op" id="2269301">+</span>&nbsp;<span class="string" id="2269303">&#39;0&#39;</span><span class="op" id="2269306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269311">fraction</span>&nbsp;<span class="op" id="2269320">-=</span>&nbsp;<span class="ident" id="2269323">digit</span>&nbsp;<span class="op" id="2269329">&lt;&lt;</span>&nbsp;<span class="ident" id="2269332">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269341">nd</span><span class="op" id="2269343">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269349">needed</span><span class="op" id="2269355">--</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2269360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269364">d</span><span class="op" id="2269365">.</span><span class="ident" id="2269366">nd</span>&nbsp;<span class="op" id="2269369">=</span>&nbsp;<span class="ident" id="2269371">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2269375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2269379">//&nbsp;We&nbsp;have&nbsp;written&nbsp;a&nbsp;truncation&nbsp;of&nbsp;f&nbsp;(a&nbsp;numerator&nbsp;/&nbsp;10^d.dp).&nbsp;The&nbsp;remaining&nbsp;part</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2269461">//&nbsp;can&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;small&nbsp;number&nbsp;(&lt;&nbsp;1)&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;last&nbsp;digit&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2269545">//&nbsp;numerator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2269560">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2269564">//&nbsp;If&nbsp;rest&nbsp;&gt;&nbsp;0,&nbsp;the&nbsp;amount&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2269596">//&nbsp;&nbsp;&nbsp;&nbsp;(rest&lt;&lt;shift&nbsp;|&nbsp;fraction)&nbsp;/&nbsp;(pow10&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2269647">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;±ε&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2269700">//&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;fact&nbsp;that&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;guarantees&nbsp;that&nbsp;pow10&nbsp;&lt;&lt;&nbsp;shift&nbsp;does&nbsp;not&nbsp;overflow&nbsp;a&nbsp;uint64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2269786">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2269790">//&nbsp;If&nbsp;rest&nbsp;=&nbsp;0,&nbsp;pow10&nbsp;==&nbsp;1&nbsp;and&nbsp;the&nbsp;amount&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2269836">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;/&nbsp;(1&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2269867">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;±ε&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2269920">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2269924">//&nbsp;We&nbsp;pass&nbsp;this&nbsp;information&nbsp;to&nbsp;the&nbsp;rounding&nbsp;routine&nbsp;for&nbsp;adjustment.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269994">ok</span>&nbsp;<span class="op" id="2269997">:=</span>&nbsp;<span class="ident" id="2270000">adjustLastDigitFixed</span><span class="op" id="2270020">(</span><span class="ident" id="2270021">d</span><span class="op" id="2270022">,</span>&nbsp;<span class="ident" id="2270024">uint64</span><span class="op" id="2270030">(</span><span class="ident" id="2270031">rest</span><span class="op" id="2270035">)</span><span class="op" id="2270036">&lt;&lt;</span><span class="ident" id="2270038">shift</span><span class="op" id="2270043">|</span><span class="ident" id="2270044">fraction</span><span class="op" id="2270052">,</span>&nbsp;<span class="ident" id="2270054">pow10</span><span class="op" id="2270059">,</span>&nbsp;<span class="ident" id="2270061">shift</span><span class="op" id="2270066">,</span>&nbsp;<span class="ident" id="2270068">ε</span><span class="op" id="2270070">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270073">if</span>&nbsp;<span class="op" id="2270076">!</span><span class="ident" id="2270077">ok</span>&nbsp;<span class="op" id="2270080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270084">return</span>&nbsp;<span class="builtintype" id="2270091">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2270098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2270101">//&nbsp;Trim&nbsp;trailing&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270126">for</span>&nbsp;<span class="ident" id="2270130">i</span>&nbsp;<span class="op" id="2270132">:=</span>&nbsp;<span class="ident" id="2270135">d</span><span class="op" id="2270136">.</span><span class="ident" id="2270137">nd</span>&nbsp;<span class="op" id="2270140">-</span>&nbsp;<span class="num" id="2270142">1</span><span class="op" id="2270143">;</span>&nbsp;<span class="ident" id="2270145">i</span>&nbsp;<span class="op" id="2270147">&gt;=</span>&nbsp;<span class="num" id="2270150">0</span><span class="op" id="2270151">;</span>&nbsp;<span class="ident" id="2270153">i</span><span class="op" id="2270154">--</span>&nbsp;<span class="op" id="2270157">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270161">if</span>&nbsp;<span class="ident" id="2270164">d</span><span class="op" id="2270165">.</span><span class="ident" id="2270166">d</span><span class="op" id="2270167">[</span><span class="ident" id="2270168">i</span><span class="op" id="2270169">]</span>&nbsp;<span class="op" id="2270171">!=</span>&nbsp;<span class="string" id="2270174">&#39;0&#39;</span>&nbsp;<span class="op" id="2270178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2270183">d</span><span class="op" id="2270184">.</span><span class="ident" id="2270185">nd</span>&nbsp;<span class="op" id="2270188">=</span>&nbsp;<span class="ident" id="2270190">i</span>&nbsp;<span class="op" id="2270192">+</span>&nbsp;<span class="num" id="2270194">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270199">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2270207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2270210">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270213">return</span>&nbsp;<span class="builtintype" id="2270220">true</span><br>
<span class="lineno"></span><span class="op" id="2270225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2270228">//&nbsp;adjustLastDigitFixed&nbsp;assumes&nbsp;d&nbsp;contains&nbsp;the&nbsp;representation&nbsp;of&nbsp;the&nbsp;integral&nbsp;part</span><br>
<span class="lineno"></span><span class="comment" id="2270311">//&nbsp;of&nbsp;some&nbsp;number,&nbsp;whose&nbsp;fractional&nbsp;part&nbsp;is&nbsp;num&nbsp;/&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift).&nbsp;The&nbsp;numerator</span><br>
<span class="lineno">490</span><span class="comment" id="2270391">//&nbsp;num&nbsp;is&nbsp;only&nbsp;known&nbsp;up&nbsp;to&nbsp;an&nbsp;uncertainty&nbsp;of&nbsp;size&nbsp;ε,&nbsp;assumed&nbsp;to&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2270469">//&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift)/2.</span><br>
<span class="lineno"></span><span class="comment" id="2270490">//</span><br>
<span class="lineno"></span><span class="comment" id="2270493">//&nbsp;It&nbsp;will&nbsp;increase&nbsp;the&nbsp;last&nbsp;digit&nbsp;by&nbsp;one&nbsp;to&nbsp;account&nbsp;for&nbsp;correct&nbsp;rounding,&nbsp;typically</span><br>
<span class="lineno"></span><span class="comment" id="2270578">//&nbsp;when&nbsp;the&nbsp;fractional&nbsp;part&nbsp;is&nbsp;greater&nbsp;than&nbsp;1/2,&nbsp;and&nbsp;will&nbsp;return&nbsp;false&nbsp;if&nbsp;ε&nbsp;is&nbsp;such</span><br>
<span class="lineno">495</span><span class="comment" id="2270663">//&nbsp;that&nbsp;no&nbsp;correct&nbsp;answer&nbsp;can&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="keyword" id="2270703">func</span>&nbsp;<span class="ident" id="2270708">adjustLastDigitFixed</span><span class="op" id="2270728">(</span><span class="ident" id="2270729">d</span>&nbsp;<span class="op" id="2270731">*</span><span class="ident" id="2270732">decimalSlice</span><span class="op" id="2270744">,</span>&nbsp;<span class="ident" id="2270746">num</span><span class="op" id="2270749">,</span>&nbsp;<span class="ident" id="2270751">den</span>&nbsp;<span class="ident" id="2270755">uint64</span><span class="op" id="2270761">,</span>&nbsp;<span class="ident" id="2270763">shift</span>&nbsp;<span class="builtintype" id="2270769">uint</span><span class="op" id="2270773">,</span>&nbsp;<span class="ident" id="2270775">ε</span>&nbsp;<span class="ident" id="2270778">uint64</span><span class="op" id="2270784">)</span>&nbsp;<span class="builtintype" id="2270786">bool</span>&nbsp;<span class="op" id="2270791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270794">if</span>&nbsp;<span class="ident" id="2270797">num</span>&nbsp;<span class="op" id="2270801">&gt;</span>&nbsp;<span class="ident" id="2270803">den</span><span class="op" id="2270806">&lt;&lt;</span><span class="ident" id="2270808">shift</span>&nbsp;<span class="op" id="2270814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2270818">panic</span><span class="op" id="2270823">(</span><span class="string" id="2270824">&#34;strconv:&nbsp;num&nbsp;&gt;&nbsp;den&lt;&lt;shift&nbsp;in&nbsp;adjustLastDigitFixed&#34;</span><span class="op" id="2270875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2270878">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270881">if</span>&nbsp;<span class="num" id="2270884">2</span><span class="op" id="2270885">*</span><span class="ident" id="2270886">ε</span>&nbsp;<span class="op" id="2270889">&gt;</span>&nbsp;<span class="ident" id="2270891">den</span><span class="op" id="2270894">&lt;&lt;</span><span class="ident" id="2270896">shift</span>&nbsp;<span class="op" id="2270902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2270906">panic</span><span class="op" id="2270911">(</span><span class="string" id="2270912">&#34;strconv:&nbsp;ε&nbsp;&gt;&nbsp;(den&lt;&lt;shift)/2&#34;</span><span class="op" id="2270942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2270945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270948">if</span>&nbsp;<span class="num" id="2270951">2</span><span class="op" id="2270952">*</span><span class="op" id="2270953">(</span><span class="ident" id="2270954">num</span><span class="op" id="2270957">+</span><span class="ident" id="2270958">ε</span><span class="op" id="2270960">)</span>&nbsp;<span class="op" id="2270962">&lt;</span>&nbsp;<span class="ident" id="2270964">den</span><span class="op" id="2270967">&lt;&lt;</span><span class="ident" id="2270969">shift</span>&nbsp;<span class="op" id="2270975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270979">return</span>&nbsp;<span class="builtintype" id="2270986">true</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2270992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270995">if</span>&nbsp;<span class="num" id="2270998">2</span><span class="op" id="2270999">*</span><span class="op" id="2271000">(</span><span class="ident" id="2271001">num</span><span class="op" id="2271004">-</span><span class="ident" id="2271005">ε</span><span class="op" id="2271007">)</span>&nbsp;<span class="op" id="2271009">&gt;</span>&nbsp;<span class="ident" id="2271011">den</span><span class="op" id="2271014">&lt;&lt;</span><span class="ident" id="2271016">shift</span>&nbsp;<span class="op" id="2271022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2271026">//&nbsp;increment&nbsp;d&nbsp;by&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271049">i</span>&nbsp;<span class="op" id="2271051">:=</span>&nbsp;<span class="ident" id="2271054">d</span><span class="op" id="2271055">.</span><span class="ident" id="2271056">nd</span>&nbsp;<span class="op" id="2271059">-</span>&nbsp;<span class="num" id="2271061">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2271065">for</span>&nbsp;<span class="op" id="2271069">;</span>&nbsp;<span class="ident" id="2271071">i</span>&nbsp;<span class="op" id="2271073">&gt;=</span>&nbsp;<span class="num" id="2271076">0</span><span class="op" id="2271077">;</span>&nbsp;<span class="ident" id="2271079">i</span><span class="op" id="2271080">--</span>&nbsp;<span class="op" id="2271083">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2271088">if</span>&nbsp;<span class="ident" id="2271091">d</span><span class="op" id="2271092">.</span><span class="ident" id="2271093">d</span><span class="op" id="2271094">[</span><span class="ident" id="2271095">i</span><span class="op" id="2271096">]</span>&nbsp;<span class="op" id="2271098">==</span>&nbsp;<span class="string" id="2271101">&#39;9&#39;</span>&nbsp;<span class="op" id="2271105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271111">d</span><span class="op" id="2271112">.</span><span class="ident" id="2271113">nd</span><span class="op" id="2271115">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2271121">}</span>&nbsp;<span class="keyword" id="2271123">else</span>&nbsp;<span class="op" id="2271128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2271134">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2271143">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2271147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2271151">if</span>&nbsp;<span class="ident" id="2271154">i</span>&nbsp;<span class="op" id="2271156">&lt;</span>&nbsp;<span class="num" id="2271158">0</span>&nbsp;<span class="op" id="2271160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271165">d</span><span class="op" id="2271166">.</span><span class="ident" id="2271167">d</span><span class="op" id="2271168">[</span><span class="num" id="2271169">0</span><span class="op" id="2271170">]</span>&nbsp;<span class="op" id="2271172">=</span>&nbsp;<span class="string" id="2271174">&#39;1&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271181">d</span><span class="op" id="2271182">.</span><span class="ident" id="2271183">nd</span>&nbsp;<span class="op" id="2271186">=</span>&nbsp;<span class="num" id="2271188">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271193">d</span><span class="op" id="2271194">.</span><span class="ident" id="2271195">dp</span><span class="op" id="2271197">++</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2271202">}</span>&nbsp;<span class="keyword" id="2271204">else</span>&nbsp;<span class="op" id="2271209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271214">d</span><span class="op" id="2271215">.</span><span class="ident" id="2271216">d</span><span class="op" id="2271217">[</span><span class="ident" id="2271218">i</span><span class="op" id="2271219">]</span><span class="op" id="2271220">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2271225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2271229">return</span>&nbsp;<span class="builtintype" id="2271236">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2271242">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2271245">return</span>&nbsp;<span class="builtintype" id="2271252">false</span><br>
<span class="lineno"></span><span class="op" id="2271258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2271261">//&nbsp;ShortestDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;shortest&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="2271333">//&nbsp;which&nbsp;belongs&nbsp;to&nbsp;the&nbsp;open&nbsp;interval&nbsp;(lower,&nbsp;upper),&nbsp;where&nbsp;f&nbsp;is&nbsp;supposed</span><br>
<span class="lineno">530</span><span class="comment" id="2271407">//&nbsp;to&nbsp;lie.&nbsp;It&nbsp;returns&nbsp;false&nbsp;whenever&nbsp;the&nbsp;result&nbsp;is&nbsp;unsure.&nbsp;The&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="2271485">//&nbsp;uses&nbsp;the&nbsp;Grisu3&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="2271515">func</span>&nbsp;<span class="op" id="2271520">(</span><span class="ident" id="2271521">f</span>&nbsp;<span class="op" id="2271523">*</span><span class="ident" id="2271524">extFloat</span><span class="op" id="2271532">)</span>&nbsp;<span class="ident" id="2271534">ShortestDecimal</span><span class="op" id="2271549">(</span><span class="ident" id="2271550">d</span>&nbsp;<span class="op" id="2271552">*</span><span class="ident" id="2271553">decimalSlice</span><span class="op" id="2271565">,</span>&nbsp;<span class="ident" id="2271567">lower</span><span class="op" id="2271572">,</span>&nbsp;<span class="ident" id="2271574">upper</span>&nbsp;<span class="op" id="2271580">*</span><span class="ident" id="2271581">extFloat</span><span class="op" id="2271589">)</span>&nbsp;<span class="builtintype" id="2271591">bool</span>&nbsp;<span class="op" id="2271596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2271599">if</span>&nbsp;<span class="ident" id="2271602">f</span><span class="op" id="2271603">.</span><span class="ident" id="2271604">mant</span>&nbsp;<span class="op" id="2271609">==</span>&nbsp;<span class="num" id="2271612">0</span>&nbsp;<span class="op" id="2271614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271618">d</span><span class="op" id="2271619">.</span><span class="ident" id="2271620">nd</span>&nbsp;<span class="op" id="2271623">=</span>&nbsp;<span class="num" id="2271625">0</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271629">d</span><span class="op" id="2271630">.</span><span class="ident" id="2271631">dp</span>&nbsp;<span class="op" id="2271634">=</span>&nbsp;<span class="num" id="2271636">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271640">d</span><span class="op" id="2271641">.</span><span class="ident" id="2271642">neg</span>&nbsp;<span class="op" id="2271646">=</span>&nbsp;<span class="ident" id="2271648">f</span><span class="op" id="2271649">.</span><span class="ident" id="2271650">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2271656">return</span>&nbsp;<span class="builtintype" id="2271663">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2271669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2271672">if</span>&nbsp;<span class="ident" id="2271675">f</span><span class="op" id="2271676">.</span><span class="ident" id="2271677">exp</span>&nbsp;<span class="op" id="2271681">==</span>&nbsp;<span class="num" id="2271684">0</span>&nbsp;<span class="op" id="2271686">&amp;&amp;</span>&nbsp;<span class="op" id="2271689">*</span><span class="ident" id="2271690">lower</span>&nbsp;<span class="op" id="2271696">==</span>&nbsp;<span class="op" id="2271699">*</span><span class="ident" id="2271700">f</span>&nbsp;<span class="op" id="2271702">&amp;&amp;</span>&nbsp;<span class="op" id="2271705">*</span><span class="ident" id="2271706">lower</span>&nbsp;<span class="op" id="2271712">==</span>&nbsp;<span class="op" id="2271715">*</span><span class="ident" id="2271716">upper</span>&nbsp;<span class="op" id="2271722">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2271726">//&nbsp;an&nbsp;exact&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2271749">var</span>&nbsp;<span class="ident" id="2271753">buf</span>&nbsp;<span class="op" id="2271757">[</span><span class="num" id="2271758">24</span><span class="op" id="2271760">]</span><span class="builtintype" id="2271761">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271768">n</span>&nbsp;<span class="op" id="2271770">:=</span>&nbsp;<span class="builtinfunc" id="2271773">len</span><span class="op" id="2271776">(</span><span class="ident" id="2271777">buf</span><span class="op" id="2271780">)</span>&nbsp;<span class="op" id="2271782">-</span>&nbsp;<span class="num" id="2271784">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2271788">for</span>&nbsp;<span class="ident" id="2271792">v</span>&nbsp;<span class="op" id="2271794">:=</span>&nbsp;<span class="ident" id="2271797">f</span><span class="op" id="2271798">.</span><span class="ident" id="2271799">mant</span><span class="op" id="2271803">;</span>&nbsp;<span class="ident" id="2271805">v</span>&nbsp;<span class="op" id="2271807">&gt;</span>&nbsp;<span class="num" id="2271809">0</span><span class="op" id="2271810">;</span>&nbsp;<span class="op" id="2271812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271817">v1</span>&nbsp;<span class="op" id="2271820">:=</span>&nbsp;<span class="ident" id="2271823">v</span>&nbsp;<span class="op" id="2271825">/</span>&nbsp;<span class="num" id="2271827">10</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271833">v</span>&nbsp;<span class="op" id="2271835">-=</span>&nbsp;<span class="num" id="2271838">10</span>&nbsp;<span class="op" id="2271841">*</span>&nbsp;<span class="ident" id="2271843">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271849">buf</span><span class="op" id="2271852">[</span><span class="ident" id="2271853">n</span><span class="op" id="2271854">]</span>&nbsp;<span class="op" id="2271856">=</span>&nbsp;<span class="builtintype" id="2271858">byte</span><span class="op" id="2271862">(</span><span class="ident" id="2271863">v</span>&nbsp;<span class="op" id="2271865">+</span>&nbsp;<span class="string" id="2271867">&#39;0&#39;</span><span class="op" id="2271870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271875">n</span><span class="op" id="2271876">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271882">v</span>&nbsp;<span class="op" id="2271884">=</span>&nbsp;<span class="ident" id="2271886">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2271891">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271895">nd</span>&nbsp;<span class="op" id="2271898">:=</span>&nbsp;<span class="builtinfunc" id="2271901">len</span><span class="op" id="2271904">(</span><span class="ident" id="2271905">buf</span><span class="op" id="2271908">)</span>&nbsp;<span class="op" id="2271910">-</span>&nbsp;<span class="ident" id="2271912">n</span>&nbsp;<span class="op" id="2271914">-</span>&nbsp;<span class="num" id="2271916">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2271920">for</span>&nbsp;<span class="ident" id="2271924">i</span>&nbsp;<span class="op" id="2271926">:=</span>&nbsp;<span class="num" id="2271929">0</span><span class="op" id="2271930">;</span>&nbsp;<span class="ident" id="2271932">i</span>&nbsp;<span class="op" id="2271934">&lt;</span>&nbsp;<span class="ident" id="2271936">nd</span><span class="op" id="2271938">;</span>&nbsp;<span class="ident" id="2271940">i</span><span class="op" id="2271941">++</span>&nbsp;<span class="op" id="2271944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271949">d</span><span class="op" id="2271950">.</span><span class="ident" id="2271951">d</span><span class="op" id="2271952">[</span><span class="ident" id="2271953">i</span><span class="op" id="2271954">]</span>&nbsp;<span class="op" id="2271956">=</span>&nbsp;<span class="ident" id="2271958">buf</span><span class="op" id="2271961">[</span><span class="ident" id="2271962">n</span><span class="op" id="2271963">+</span><span class="num" id="2271964">1</span><span class="op" id="2271965">+</span><span class="ident" id="2271966">i</span><span class="op" id="2271967">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2271971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2271975">d</span><span class="op" id="2271976">.</span><span class="ident" id="2271977">nd</span><span class="op" id="2271979">,</span>&nbsp;<span class="ident" id="2271981">d</span><span class="op" id="2271982">.</span><span class="ident" id="2271983">dp</span>&nbsp;<span class="op" id="2271986">=</span>&nbsp;<span class="ident" id="2271988">nd</span><span class="op" id="2271990">,</span>&nbsp;<span class="ident" id="2271992">nd</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2271997">for</span>&nbsp;<span class="ident" id="2272001">d</span><span class="op" id="2272002">.</span><span class="ident" id="2272003">nd</span>&nbsp;<span class="op" id="2272006">&gt;</span>&nbsp;<span class="num" id="2272008">0</span>&nbsp;<span class="op" id="2272010">&amp;&amp;</span>&nbsp;<span class="ident" id="2272013">d</span><span class="op" id="2272014">.</span><span class="ident" id="2272015">d</span><span class="op" id="2272016">[</span><span class="ident" id="2272017">d</span><span class="op" id="2272018">.</span><span class="ident" id="2272019">nd</span><span class="op" id="2272021">-</span><span class="num" id="2272022">1</span><span class="op" id="2272023">]</span>&nbsp;<span class="op" id="2272025">==</span>&nbsp;<span class="string" id="2272028">&#39;0&#39;</span>&nbsp;<span class="op" id="2272032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2272037">d</span><span class="op" id="2272038">.</span><span class="ident" id="2272039">nd</span><span class="op" id="2272041">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2272046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2272050">if</span>&nbsp;<span class="ident" id="2272053">d</span><span class="op" id="2272054">.</span><span class="ident" id="2272055">nd</span>&nbsp;<span class="op" id="2272058">==</span>&nbsp;<span class="num" id="2272061">0</span>&nbsp;<span class="op" id="2272063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2272068">d</span><span class="op" id="2272069">.</span><span class="ident" id="2272070">dp</span>&nbsp;<span class="op" id="2272073">=</span>&nbsp;<span class="num" id="2272075">0</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2272079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2272083">d</span><span class="op" id="2272084">.</span><span class="ident" id="2272085">neg</span>&nbsp;<span class="op" id="2272089">=</span>&nbsp;<span class="ident" id="2272091">f</span><span class="op" id="2272092">.</span><span class="ident" id="2272093">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2272099">return</span>&nbsp;<span class="builtintype" id="2272106">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2272112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2272115">upper</span><span class="op" id="2272120">.</span><span class="ident" id="2272121">Normalize</span><span class="op" id="2272130">(</span><span class="op" id="2272131">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2272134">//&nbsp;Uniformize&nbsp;exponents.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2272160">if</span>&nbsp;<span class="ident" id="2272163">f</span><span class="op" id="2272164">.</span><span class="ident" id="2272165">exp</span>&nbsp;<span class="op" id="2272169">&gt;</span>&nbsp;<span class="ident" id="2272171">upper</span><span class="op" id="2272176">.</span><span class="ident" id="2272177">exp</span>&nbsp;<span class="op" id="2272181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2272185">f</span><span class="op" id="2272186">.</span><span class="ident" id="2272187">mant</span>&nbsp;<span class="op" id="2272192">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="2272196">uint</span><span class="op" id="2272200">(</span><span class="ident" id="2272201">f</span><span class="op" id="2272202">.</span><span class="ident" id="2272203">exp</span>&nbsp;<span class="op" id="2272207">-</span>&nbsp;<span class="ident" id="2272209">upper</span><span class="op" id="2272214">.</span><span class="ident" id="2272215">exp</span><span class="op" id="2272218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2272222">f</span><span class="op" id="2272223">.</span><span class="ident" id="2272224">exp</span>&nbsp;<span class="op" id="2272228">=</span>&nbsp;<span class="ident" id="2272230">upper</span><span class="op" id="2272235">.</span><span class="ident" id="2272236">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2272241">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2272244">if</span>&nbsp;<span class="ident" id="2272247">lower</span><span class="op" id="2272252">.</span><span class="ident" id="2272253">exp</span>&nbsp;<span class="op" id="2272257">&gt;</span>&nbsp;<span class="ident" id="2272259">upper</span><span class="op" id="2272264">.</span><span class="ident" id="2272265">exp</span>&nbsp;<span class="op" id="2272269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2272273">lower</span><span class="op" id="2272278">.</span><span class="ident" id="2272279">mant</span>&nbsp;<span class="op" id="2272284">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="2272288">uint</span><span class="op" id="2272292">(</span><span class="ident" id="2272293">lower</span><span class="op" id="2272298">.</span><span class="ident" id="2272299">exp</span>&nbsp;<span class="op" id="2272303">-</span>&nbsp;<span class="ident" id="2272305">upper</span><span class="op" id="2272310">.</span><span class="ident" id="2272311">exp</span><span class="op" id="2272314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2272318">lower</span><span class="op" id="2272323">.</span><span class="ident" id="2272324">exp</span>&nbsp;<span class="op" id="2272328">=</span>&nbsp;<span class="ident" id="2272330">upper</span><span class="op" id="2272335">.</span><span class="ident" id="2272336">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2272341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2272345">exp10</span>&nbsp;<span class="op" id="2272351">:=</span>&nbsp;<span class="ident" id="2272354">frexp10Many</span><span class="op" id="2272365">(</span><span class="ident" id="2272366">lower</span><span class="op" id="2272371">,</span>&nbsp;<span class="ident" id="2272373">f</span><span class="op" id="2272374">,</span>&nbsp;<span class="ident" id="2272376">upper</span><span class="op" id="2272381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2272384">//&nbsp;Take&nbsp;a&nbsp;safety&nbsp;margin&nbsp;due&nbsp;to&nbsp;rounding&nbsp;in&nbsp;frexp10Many,&nbsp;but&nbsp;we&nbsp;lose&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2272464">upper</span><span class="op" id="2272469">.</span><span class="ident" id="2272470">mant</span><span class="op" id="2272474">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2272478">lower</span><span class="op" id="2272483">.</span><span class="ident" id="2272484">mant</span><span class="op" id="2272488">--</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2272493">//&nbsp;The&nbsp;shortest&nbsp;representation&nbsp;of&nbsp;f&nbsp;is&nbsp;either&nbsp;rounded&nbsp;up&nbsp;or&nbsp;down,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2272564">//&nbsp;in&nbsp;any&nbsp;case,&nbsp;it&nbsp;is&nbsp;a&nbsp;truncation&nbsp;of&nbsp;upper.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2272610">shift</span>&nbsp;<span class="op" id="2272616">:=</span>&nbsp;<span class="builtintype" id="2272619">uint</span><span class="op" id="2272623">(</span><span class="op" id="2272624">-</span><span class="ident" id="2272625">upper</span><span class="op" id="2272630">.</span><span class="ident" id="2272631">exp</span><span class="op" id="2272634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2272637">integer</span>&nbsp;<span class="op" id="2272645">:=</span>&nbsp;<span class="builtintype" id="2272648">uint32</span><span class="op" id="2272654">(</span><span class="ident" id="2272655">upper</span><span class="op" id="2272660">.</span><span class="ident" id="2272661">mant</span>&nbsp;<span class="op" id="2272666">&gt;&gt;</span>&nbsp;<span class="ident" id="2272669">shift</span><span class="op" id="2272674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2272677">fraction</span>&nbsp;<span class="op" id="2272686">:=</span>&nbsp;<span class="ident" id="2272689">upper</span><span class="op" id="2272694">.</span><span class="ident" id="2272695">mant</span>&nbsp;<span class="op" id="2272700">-</span>&nbsp;<span class="op" id="2272702">(</span><span class="ident" id="2272703">uint64</span><span class="op" id="2272709">(</span><span class="ident" id="2272710">integer</span><span class="op" id="2272717">)</span>&nbsp;<span class="op" id="2272719">&lt;&lt;</span>&nbsp;<span class="ident" id="2272722">shift</span><span class="op" id="2272727">)</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2272731">//&nbsp;How&nbsp;far&nbsp;we&nbsp;can&nbsp;go&nbsp;down&nbsp;from&nbsp;upper&nbsp;until&nbsp;the&nbsp;result&nbsp;is&nbsp;wrong.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2272796">allowance</span>&nbsp;<span class="op" id="2272806">:=</span>&nbsp;<span class="ident" id="2272809">upper</span><span class="op" id="2272814">.</span><span class="ident" id="2272815">mant</span>&nbsp;<span class="op" id="2272820">-</span>&nbsp;<span class="ident" id="2272822">lower</span><span class="op" id="2272827">.</span><span class="ident" id="2272828">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2272834">//&nbsp;How&nbsp;far&nbsp;we&nbsp;should&nbsp;go&nbsp;to&nbsp;get&nbsp;a&nbsp;very&nbsp;precise&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2272889">targetDiff</span>&nbsp;<span class="op" id="2272900">:=</span>&nbsp;<span class="ident" id="2272903">upper</span><span class="op" id="2272908">.</span><span class="ident" id="2272909">mant</span>&nbsp;<span class="op" id="2272914">-</span>&nbsp;<span class="ident" id="2272916">f</span><span class="op" id="2272917">.</span><span class="ident" id="2272918">mant</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2272925">//&nbsp;Count&nbsp;integral&nbsp;digits:&nbsp;there&nbsp;are&nbsp;at&nbsp;most&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2272974">var</span>&nbsp;<span class="ident" id="2272978">integerDigits</span>&nbsp;<span class="builtintype" id="2272992">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2272997">for</span>&nbsp;<span class="ident" id="2273001">i</span><span class="op" id="2273002">,</span>&nbsp;<span class="ident" id="2273004">pow</span>&nbsp;<span class="op" id="2273008">:=</span>&nbsp;<span class="num" id="2273011">0</span><span class="op" id="2273012">,</span>&nbsp;<span class="ident" id="2273014">uint64</span><span class="op" id="2273020">(</span><span class="num" id="2273021">1</span><span class="op" id="2273022">)</span><span class="op" id="2273023">;</span>&nbsp;<span class="ident" id="2273025">i</span>&nbsp;<span class="op" id="2273027">&lt;</span>&nbsp;<span class="num" id="2273029">20</span><span class="op" id="2273031">;</span>&nbsp;<span class="ident" id="2273033">i</span><span class="op" id="2273034">++</span>&nbsp;<span class="op" id="2273037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273041">if</span>&nbsp;<span class="ident" id="2273044">pow</span>&nbsp;<span class="op" id="2273048">&gt;</span>&nbsp;<span class="ident" id="2273050">uint64</span><span class="op" id="2273056">(</span><span class="ident" id="2273057">integer</span><span class="op" id="2273064">)</span>&nbsp;<span class="op" id="2273066">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273071">integerDigits</span>&nbsp;<span class="op" id="2273085">=</span>&nbsp;<span class="ident" id="2273087">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273092">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2273100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273104">pow</span>&nbsp;<span class="op" id="2273108">*=</span>&nbsp;<span class="num" id="2273111">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2273115">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273118">for</span>&nbsp;<span class="ident" id="2273122">i</span>&nbsp;<span class="op" id="2273124">:=</span>&nbsp;<span class="num" id="2273127">0</span><span class="op" id="2273128">;</span>&nbsp;<span class="ident" id="2273130">i</span>&nbsp;<span class="op" id="2273132">&lt;</span>&nbsp;<span class="ident" id="2273134">integerDigits</span><span class="op" id="2273147">;</span>&nbsp;<span class="ident" id="2273149">i</span><span class="op" id="2273150">++</span>&nbsp;<span class="op" id="2273153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273157">pow</span>&nbsp;<span class="op" id="2273161">:=</span>&nbsp;<span class="ident" id="2273164">uint64pow10</span><span class="op" id="2273175">[</span><span class="ident" id="2273176">integerDigits</span><span class="op" id="2273189">-</span><span class="ident" id="2273190">i</span><span class="op" id="2273191">-</span><span class="num" id="2273192">1</span><span class="op" id="2273193">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273197">digit</span>&nbsp;<span class="op" id="2273203">:=</span>&nbsp;<span class="ident" id="2273206">integer</span>&nbsp;<span class="op" id="2273214">/</span>&nbsp;<span class="builtintype" id="2273216">uint32</span><span class="op" id="2273222">(</span><span class="ident" id="2273223">pow</span><span class="op" id="2273226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273230">d</span><span class="op" id="2273231">.</span><span class="ident" id="2273232">d</span><span class="op" id="2273233">[</span><span class="ident" id="2273234">i</span><span class="op" id="2273235">]</span>&nbsp;<span class="op" id="2273237">=</span>&nbsp;<span class="builtintype" id="2273239">byte</span><span class="op" id="2273243">(</span><span class="ident" id="2273244">digit</span>&nbsp;<span class="op" id="2273250">+</span>&nbsp;<span class="string" id="2273252">&#39;0&#39;</span><span class="op" id="2273255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273259">integer</span>&nbsp;<span class="op" id="2273267">-=</span>&nbsp;<span class="ident" id="2273270">digit</span>&nbsp;<span class="op" id="2273276">*</span>&nbsp;<span class="builtintype" id="2273278">uint32</span><span class="op" id="2273284">(</span><span class="ident" id="2273285">pow</span><span class="op" id="2273288">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2273292">//&nbsp;evaluate&nbsp;whether&nbsp;we&nbsp;should&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273330">if</span>&nbsp;<span class="ident" id="2273333">currentDiff</span>&nbsp;<span class="op" id="2273345">:=</span>&nbsp;<span class="ident" id="2273348">uint64</span><span class="op" id="2273354">(</span><span class="ident" id="2273355">integer</span><span class="op" id="2273362">)</span><span class="op" id="2273363">&lt;&lt;</span><span class="ident" id="2273365">shift</span>&nbsp;<span class="op" id="2273371">+</span>&nbsp;<span class="ident" id="2273373">fraction</span><span class="op" id="2273381">;</span>&nbsp;<span class="ident" id="2273383">currentDiff</span>&nbsp;<span class="op" id="2273395">&lt;</span>&nbsp;<span class="ident" id="2273397">allowance</span>&nbsp;<span class="op" id="2273407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273412">d</span><span class="op" id="2273413">.</span><span class="ident" id="2273414">nd</span>&nbsp;<span class="op" id="2273417">=</span>&nbsp;<span class="ident" id="2273419">i</span>&nbsp;<span class="op" id="2273421">+</span>&nbsp;<span class="num" id="2273423">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273428">d</span><span class="op" id="2273429">.</span><span class="ident" id="2273430">dp</span>&nbsp;<span class="op" id="2273433">=</span>&nbsp;<span class="ident" id="2273435">integerDigits</span>&nbsp;<span class="op" id="2273449">+</span>&nbsp;<span class="ident" id="2273451">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273460">d</span><span class="op" id="2273461">.</span><span class="ident" id="2273462">neg</span>&nbsp;<span class="op" id="2273466">=</span>&nbsp;<span class="ident" id="2273468">f</span><span class="op" id="2273469">.</span><span class="ident" id="2273470">neg</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2273477">//&nbsp;Sometimes&nbsp;allowance&nbsp;is&nbsp;so&nbsp;large&nbsp;the&nbsp;last&nbsp;digit&nbsp;might&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2273547">//&nbsp;decremented&nbsp;to&nbsp;get&nbsp;closer&nbsp;to&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273585">return</span>&nbsp;<span class="ident" id="2273592">adjustLastDigit</span><span class="op" id="2273607">(</span><span class="ident" id="2273608">d</span><span class="op" id="2273609">,</span>&nbsp;<span class="ident" id="2273611">currentDiff</span><span class="op" id="2273622">,</span>&nbsp;<span class="ident" id="2273624">targetDiff</span><span class="op" id="2273634">,</span>&nbsp;<span class="ident" id="2273636">allowance</span><span class="op" id="2273645">,</span>&nbsp;<span class="ident" id="2273647">pow</span><span class="op" id="2273650">&lt;&lt;</span><span class="ident" id="2273652">shift</span><span class="op" id="2273657">,</span>&nbsp;<span class="num" id="2273659">2</span><span class="op" id="2273660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2273664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2273667">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273670">d</span><span class="op" id="2273671">.</span><span class="ident" id="2273672">nd</span>&nbsp;<span class="op" id="2273675">=</span>&nbsp;<span class="ident" id="2273677">integerDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273692">d</span><span class="op" id="2273693">.</span><span class="ident" id="2273694">dp</span>&nbsp;<span class="op" id="2273697">=</span>&nbsp;<span class="ident" id="2273699">d</span><span class="op" id="2273700">.</span><span class="ident" id="2273701">nd</span>&nbsp;<span class="op" id="2273704">+</span>&nbsp;<span class="ident" id="2273706">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273713">d</span><span class="op" id="2273714">.</span><span class="ident" id="2273715">neg</span>&nbsp;<span class="op" id="2273719">=</span>&nbsp;<span class="ident" id="2273721">f</span><span class="op" id="2273722">.</span><span class="ident" id="2273723">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2273729">//&nbsp;Compute&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;At&nbsp;each&nbsp;step&nbsp;fraction&nbsp;does&nbsp;not</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2273803">//&nbsp;overflow.&nbsp;The&nbsp;choice&nbsp;of&nbsp;minExp&nbsp;implies&nbsp;that&nbsp;fraction&nbsp;is&nbsp;less&nbsp;than&nbsp;2^60.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273879">var</span>&nbsp;<span class="ident" id="2273883">digit</span>&nbsp;<span class="builtintype" id="2273889">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273894">multiplier</span>&nbsp;<span class="op" id="2273905">:=</span>&nbsp;<span class="ident" id="2273908">uint64</span><span class="op" id="2273914">(</span><span class="num" id="2273915">1</span><span class="op" id="2273916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273919">for</span>&nbsp;<span class="op" id="2273923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273927">fraction</span>&nbsp;<span class="op" id="2273936">*=</span>&nbsp;<span class="num" id="2273939">10</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273944">multiplier</span>&nbsp;<span class="op" id="2273955">*=</span>&nbsp;<span class="num" id="2273958">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273963">digit</span>&nbsp;<span class="op" id="2273969">=</span>&nbsp;<span class="builtintype" id="2273971">int</span><span class="op" id="2273974">(</span><span class="ident" id="2273975">fraction</span>&nbsp;<span class="op" id="2273984">&gt;&gt;</span>&nbsp;<span class="ident" id="2273987">shift</span><span class="op" id="2273992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273996">d</span><span class="op" id="2273997">.</span><span class="ident" id="2273998">d</span><span class="op" id="2273999">[</span><span class="ident" id="2274000">d</span><span class="op" id="2274001">.</span><span class="ident" id="2274002">nd</span><span class="op" id="2274004">]</span>&nbsp;<span class="op" id="2274006">=</span>&nbsp;<span class="builtintype" id="2274008">byte</span><span class="op" id="2274012">(</span><span class="ident" id="2274013">digit</span>&nbsp;<span class="op" id="2274019">+</span>&nbsp;<span class="string" id="2274021">&#39;0&#39;</span><span class="op" id="2274024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274028">d</span><span class="op" id="2274029">.</span><span class="ident" id="2274030">nd</span><span class="op" id="2274032">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274037">fraction</span>&nbsp;<span class="op" id="2274046">-=</span>&nbsp;<span class="ident" id="2274049">uint64</span><span class="op" id="2274055">(</span><span class="ident" id="2274056">digit</span><span class="op" id="2274061">)</span>&nbsp;<span class="op" id="2274063">&lt;&lt;</span>&nbsp;<span class="ident" id="2274066">shift</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274074">if</span>&nbsp;<span class="ident" id="2274077">fraction</span>&nbsp;<span class="op" id="2274086">&lt;</span>&nbsp;<span class="ident" id="2274088">allowance</span><span class="op" id="2274097">*</span><span class="ident" id="2274098">multiplier</span>&nbsp;<span class="op" id="2274109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2274114">//&nbsp;We&nbsp;are&nbsp;in&nbsp;the&nbsp;admissible&nbsp;range.&nbsp;Note&nbsp;that&nbsp;if&nbsp;allowance&nbsp;is&nbsp;about&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2274187">//&nbsp;overflow,&nbsp;that&nbsp;is,&nbsp;allowance&nbsp;&gt;&nbsp;2^64/10,&nbsp;the&nbsp;condition&nbsp;is&nbsp;automatically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2274264">//&nbsp;true&nbsp;due&nbsp;to&nbsp;the&nbsp;limited&nbsp;range&nbsp;of&nbsp;fraction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274313">return</span>&nbsp;<span class="ident" id="2274320">adjustLastDigit</span><span class="op" id="2274335">(</span><span class="ident" id="2274336">d</span><span class="op" id="2274337">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274343">fraction</span><span class="op" id="2274351">,</span>&nbsp;<span class="ident" id="2274353">targetDiff</span><span class="op" id="2274363">*</span><span class="ident" id="2274364">multiplier</span><span class="op" id="2274374">,</span>&nbsp;<span class="ident" id="2274376">allowance</span><span class="op" id="2274385">*</span><span class="ident" id="2274386">multiplier</span><span class="op" id="2274396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2274402">1</span><span class="op" id="2274403">&lt;&lt;</span><span class="ident" id="2274405">shift</span><span class="op" id="2274410">,</span>&nbsp;<span class="ident" id="2274412">multiplier</span><span class="op" id="2274422">*</span><span class="num" id="2274423">2</span><span class="op" id="2274424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2274428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2274431">}</span><br>
<span class="lineno"></span><span class="op" id="2274433">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="2274436">//&nbsp;adjustLastDigit&nbsp;modifies&nbsp;d&nbsp;=&nbsp;x-currentDiff*ε,&nbsp;to&nbsp;get&nbsp;closest&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2274504">//&nbsp;d&nbsp;=&nbsp;x-targetDiff*ε,&nbsp;without&nbsp;becoming&nbsp;smaller&nbsp;than&nbsp;x-maxDiff*ε.</span><br>
<span class="lineno"></span><span class="comment" id="2274572">//&nbsp;It&nbsp;assumes&nbsp;that&nbsp;a&nbsp;decimal&nbsp;digit&nbsp;is&nbsp;worth&nbsp;ulpDecimal*ε,&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2274640">//&nbsp;all&nbsp;data&nbsp;is&nbsp;known&nbsp;with&nbsp;a&nbsp;error&nbsp;estimate&nbsp;of&nbsp;ulpBinary*ε.</span><br>
<span class="lineno">645</span><span class="keyword" id="2274700">func</span>&nbsp;<span class="ident" id="2274705">adjustLastDigit</span><span class="op" id="2274720">(</span><span class="ident" id="2274721">d</span>&nbsp;<span class="op" id="2274723">*</span><span class="ident" id="2274724">decimalSlice</span><span class="op" id="2274736">,</span>&nbsp;<span class="ident" id="2274738">currentDiff</span><span class="op" id="2274749">,</span>&nbsp;<span class="ident" id="2274751">targetDiff</span><span class="op" id="2274761">,</span>&nbsp;<span class="ident" id="2274763">maxDiff</span><span class="op" id="2274770">,</span>&nbsp;<span class="ident" id="2274772">ulpDecimal</span><span class="op" id="2274782">,</span>&nbsp;<span class="ident" id="2274784">ulpBinary</span>&nbsp;<span class="ident" id="2274794">uint64</span><span class="op" id="2274800">)</span>&nbsp;<span class="builtintype" id="2274802">bool</span>&nbsp;<span class="op" id="2274807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274810">if</span>&nbsp;<span class="ident" id="2274813">ulpDecimal</span>&nbsp;<span class="op" id="2274824">&lt;</span>&nbsp;<span class="num" id="2274826">2</span><span class="op" id="2274827">*</span><span class="ident" id="2274828">ulpBinary</span>&nbsp;<span class="op" id="2274838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2274842">//&nbsp;Approximation&nbsp;is&nbsp;too&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274874">return</span>&nbsp;<span class="builtintype" id="2274881">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2274888">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274891">for</span>&nbsp;<span class="ident" id="2274895">currentDiff</span><span class="op" id="2274906">+</span><span class="ident" id="2274907">ulpDecimal</span><span class="op" id="2274917">/</span><span class="num" id="2274918">2</span><span class="op" id="2274919">+</span><span class="ident" id="2274920">ulpBinary</span>&nbsp;<span class="op" id="2274930">&lt;</span>&nbsp;<span class="ident" id="2274932">targetDiff</span>&nbsp;<span class="op" id="2274943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274947">d</span><span class="op" id="2274948">.</span><span class="ident" id="2274949">d</span><span class="op" id="2274950">[</span><span class="ident" id="2274951">d</span><span class="op" id="2274952">.</span><span class="ident" id="2274953">nd</span><span class="op" id="2274955">-</span><span class="num" id="2274956">1</span><span class="op" id="2274957">]</span><span class="op" id="2274958">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274963">currentDiff</span>&nbsp;<span class="op" id="2274975">+=</span>&nbsp;<span class="ident" id="2274978">ulpDecimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2274990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274993">if</span>&nbsp;<span class="ident" id="2274996">currentDiff</span><span class="op" id="2275007">+</span><span class="ident" id="2275008">ulpDecimal</span>&nbsp;<span class="op" id="2275019">&lt;=</span>&nbsp;<span class="ident" id="2275022">targetDiff</span><span class="op" id="2275032">+</span><span class="ident" id="2275033">ulpDecimal</span><span class="op" id="2275043">/</span><span class="num" id="2275044">2</span><span class="op" id="2275045">+</span><span class="ident" id="2275046">ulpBinary</span>&nbsp;<span class="op" id="2275056">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2275060">//&nbsp;we&nbsp;have&nbsp;two&nbsp;choices,&nbsp;and&nbsp;don&#39;t&nbsp;know&nbsp;what&nbsp;to&nbsp;do.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2275113">return</span>&nbsp;<span class="builtintype" id="2275120">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2275127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2275130">if</span>&nbsp;<span class="ident" id="2275133">currentDiff</span>&nbsp;<span class="op" id="2275145">&lt;</span>&nbsp;<span class="ident" id="2275147">ulpBinary</span>&nbsp;<span class="op" id="2275157">||</span>&nbsp;<span class="ident" id="2275160">currentDiff</span>&nbsp;<span class="op" id="2275172">&gt;</span>&nbsp;<span class="ident" id="2275174">maxDiff</span><span class="op" id="2275181">-</span><span class="ident" id="2275182">ulpBinary</span>&nbsp;<span class="op" id="2275192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2275196">//&nbsp;we&nbsp;went&nbsp;too&nbsp;far</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2275217">return</span>&nbsp;<span class="builtintype" id="2275224">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2275231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2275234">if</span>&nbsp;<span class="ident" id="2275237">d</span><span class="op" id="2275238">.</span><span class="ident" id="2275239">nd</span>&nbsp;<span class="op" id="2275242">==</span>&nbsp;<span class="num" id="2275245">1</span>&nbsp;<span class="op" id="2275247">&amp;&amp;</span>&nbsp;<span class="ident" id="2275250">d</span><span class="op" id="2275251">.</span><span class="ident" id="2275252">d</span><span class="op" id="2275253">[</span><span class="num" id="2275254">0</span><span class="op" id="2275255">]</span>&nbsp;<span class="op" id="2275257">==</span>&nbsp;<span class="string" id="2275260">&#39;0&#39;</span>&nbsp;<span class="op" id="2275264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2275268">//&nbsp;the&nbsp;number&nbsp;has&nbsp;actually&nbsp;reached&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2275311">d</span><span class="op" id="2275312">.</span><span class="ident" id="2275313">nd</span>&nbsp;<span class="op" id="2275316">=</span>&nbsp;<span class="num" id="2275318">0</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2275322">d</span><span class="op" id="2275323">.</span><span class="ident" id="2275324">dp</span>&nbsp;<span class="op" id="2275327">=</span>&nbsp;<span class="num" id="2275329">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2275332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2275335">return</span>&nbsp;<span class="builtintype" id="2275342">true</span><br>
<span class="lineno"></span><span class="op" id="2275347">}</span>
</div>
</body>
</html>
