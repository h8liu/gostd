<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4317055">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4317110">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4317164">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4317215">package</span>&nbsp;<span class="ident" id="4317223">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4317229">import</span>&nbsp;<span class="op" id="4317236">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4317239">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4317255">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4317274">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4317291">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4317301">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4317308">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4317319">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4317322">const</span>&nbsp;<span class="ident" id="4317328">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4317345">=</span>&nbsp;<span class="num" id="4317347">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4317350">//&nbsp;ecPrivateKey&nbsp;reflects&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4317422">//&nbsp;References:</span><br>
<span class="lineno">20</span><span class="comment" id="4317437">//&nbsp;&nbsp;&nbsp;RFC5915</span><br>
<span class="lineno"></span><span class="comment" id="4317450">//&nbsp;&nbsp;&nbsp;SEC1&nbsp;-&nbsp;http://www.secg.org/download/aid-780/sec1-v2.pdf</span><br>
<span class="lineno"></span><span class="comment" id="4317511">//&nbsp;Per&nbsp;RFC5915&nbsp;the&nbsp;NamedCurveOID&nbsp;is&nbsp;marked&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL,&nbsp;however&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4317584">//&nbsp;most&nbsp;cases&nbsp;it&nbsp;is&nbsp;not.</span><br>
<span class="lineno"></span><span class="keyword" id="4317609">type</span>&nbsp;<span class="ident" id="4317614">ecPrivateKey</span>&nbsp;<span class="keyword" id="4317627">struct</span>&nbsp;<span class="op" id="4317634">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317637">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4317651">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317656">PrivateKey</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317670">[</span><span class="op" id="4317671">]</span><span class="builtintype" id="4317672">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317678">NamedCurveOID</span>&nbsp;<span class="ident" id="4317692">asn1</span><span class="op" id="4317696">.</span><span class="ident" id="4317697">ObjectIdentifier</span>&nbsp;<span class="string" id="4317714">`asn1:&#34;optional,explicit,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317748">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317762">asn1</span><span class="op" id="4317766">.</span><span class="ident" id="4317767">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4317784">`asn1:&#34;optional,explicit,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4317817">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4317820">//&nbsp;ParseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4317895">func</span>&nbsp;<span class="ident" id="4317900">ParseECPrivateKey</span><span class="op" id="4317917">(</span><span class="ident" id="4317918">der</span>&nbsp;<span class="op" id="4317922">[</span><span class="op" id="4317923">]</span><span class="builtintype" id="4317924">byte</span><span class="op" id="4317928">)</span>&nbsp;<span class="op" id="4317930">(</span><span class="ident" id="4317931">key</span>&nbsp;<span class="op" id="4317935">*</span><span class="ident" id="4317936">ecdsa</span><span class="op" id="4317941">.</span><span class="ident" id="4317942">PrivateKey</span><span class="op" id="4317952">,</span>&nbsp;<span class="ident" id="4317954">err</span>&nbsp;<span class="builtintype" id="4317958">error</span><span class="op" id="4317963">)</span>&nbsp;<span class="op" id="4317965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317968">return</span>&nbsp;<span class="ident" id="4317975">parseECPrivateKey</span><span class="op" id="4317992">(</span><span class="ident" id="4317993">nil</span><span class="op" id="4317996">,</span>&nbsp;<span class="ident" id="4317998">der</span><span class="op" id="4318001">)</span><br>
<span class="lineno"></span><span class="op" id="4318003">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4318006">//&nbsp;MarshalECPrivateKey&nbsp;marshals&nbsp;an&nbsp;EC&nbsp;private&nbsp;key&nbsp;into&nbsp;ASN.1,&nbsp;DER&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="4318080">func</span>&nbsp;<span class="ident" id="4318085">MarshalECPrivateKey</span><span class="op" id="4318104">(</span><span class="ident" id="4318105">key</span>&nbsp;<span class="op" id="4318109">*</span><span class="ident" id="4318110">ecdsa</span><span class="op" id="4318115">.</span><span class="ident" id="4318116">PrivateKey</span><span class="op" id="4318126">)</span>&nbsp;<span class="op" id="4318128">(</span><span class="op" id="4318129">[</span><span class="op" id="4318130">]</span><span class="builtintype" id="4318131">byte</span><span class="op" id="4318135">,</span>&nbsp;<span class="builtintype" id="4318137">error</span><span class="op" id="4318142">)</span>&nbsp;<span class="op" id="4318144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318147">oid</span><span class="op" id="4318150">,</span>&nbsp;<span class="ident" id="4318152">ok</span>&nbsp;<span class="op" id="4318155">:=</span>&nbsp;<span class="ident" id="4318158">oidFromNamedCurve</span><span class="op" id="4318175">(</span><span class="ident" id="4318176">key</span><span class="op" id="4318179">.</span><span class="ident" id="4318180">Curve</span><span class="op" id="4318185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318188">if</span>&nbsp;<span class="op" id="4318191">!</span><span class="ident" id="4318192">ok</span>&nbsp;<span class="op" id="4318195">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318199">return</span>&nbsp;<span class="ident" id="4318206">nil</span><span class="op" id="4318209">,</span>&nbsp;<span class="ident" id="4318211">errors</span><span class="op" id="4318217">.</span><span class="ident" id="4318218">New</span><span class="op" id="4318221">(</span><span class="string" id="4318222">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4318252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4318255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318258">return</span>&nbsp;<span class="ident" id="4318265">asn1</span><span class="op" id="4318269">.</span><span class="ident" id="4318270">Marshal</span><span class="op" id="4318277">(</span><span class="ident" id="4318278">ecPrivateKey</span><span class="op" id="4318290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318294">Version</span><span class="op" id="4318301">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4318309">1</span><span class="op" id="4318310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318314">PrivateKey</span><span class="op" id="4318324">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318329">key</span><span class="op" id="4318332">.</span><span class="ident" id="4318333">D</span><span class="op" id="4318334">.</span><span class="ident" id="4318335">Bytes</span><span class="op" id="4318340">(</span><span class="op" id="4318341">)</span><span class="op" id="4318342">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318346">NamedCurveOID</span><span class="op" id="4318359">:</span>&nbsp;<span class="ident" id="4318361">oid</span><span class="op" id="4318364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318368">PublicKey</span><span class="op" id="4318377">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318383">asn1</span><span class="op" id="4318387">.</span><span class="ident" id="4318388">BitString</span><span class="op" id="4318397">{</span><span class="ident" id="4318398">Bytes</span><span class="op" id="4318403">:</span>&nbsp;<span class="ident" id="4318405">elliptic</span><span class="op" id="4318413">.</span><span class="ident" id="4318414">Marshal</span><span class="op" id="4318421">(</span><span class="ident" id="4318422">key</span><span class="op" id="4318425">.</span><span class="ident" id="4318426">Curve</span><span class="op" id="4318431">,</span>&nbsp;<span class="ident" id="4318433">key</span><span class="op" id="4318436">.</span><span class="ident" id="4318437">X</span><span class="op" id="4318438">,</span>&nbsp;<span class="ident" id="4318440">key</span><span class="op" id="4318443">.</span><span class="ident" id="4318444">Y</span><span class="op" id="4318445">)</span><span class="op" id="4318446">}</span><span class="op" id="4318447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4318450">}</span><span class="op" id="4318451">)</span><br>
<span class="lineno"></span><span class="op" id="4318453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4318456">//&nbsp;parseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4318531">//&nbsp;The&nbsp;OID&nbsp;for&nbsp;the&nbsp;named&nbsp;curve&nbsp;may&nbsp;be&nbsp;provided&nbsp;from&nbsp;another&nbsp;source&nbsp;(such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4318607">//&nbsp;the&nbsp;PKCS8&nbsp;container)&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;provided&nbsp;then&nbsp;use&nbsp;this&nbsp;instead&nbsp;of&nbsp;the&nbsp;OID</span><br>
<span class="lineno"></span><span class="comment" id="4318684">//&nbsp;that&nbsp;may&nbsp;exist&nbsp;in&nbsp;the&nbsp;EC&nbsp;private&nbsp;key&nbsp;structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4318735">func</span>&nbsp;<span class="ident" id="4318740">parseECPrivateKey</span><span class="op" id="4318757">(</span><span class="ident" id="4318758">namedCurveOID</span>&nbsp;<span class="op" id="4318772">*</span><span class="ident" id="4318773">asn1</span><span class="op" id="4318777">.</span><span class="ident" id="4318778">ObjectIdentifier</span><span class="op" id="4318794">,</span>&nbsp;<span class="ident" id="4318796">der</span>&nbsp;<span class="op" id="4318800">[</span><span class="op" id="4318801">]</span><span class="builtintype" id="4318802">byte</span><span class="op" id="4318806">)</span>&nbsp;<span class="op" id="4318808">(</span><span class="ident" id="4318809">key</span>&nbsp;<span class="op" id="4318813">*</span><span class="ident" id="4318814">ecdsa</span><span class="op" id="4318819">.</span><span class="ident" id="4318820">PrivateKey</span><span class="op" id="4318830">,</span>&nbsp;<span class="ident" id="4318832">err</span>&nbsp;<span class="builtintype" id="4318836">error</span><span class="op" id="4318841">)</span>&nbsp;<span class="op" id="4318843">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318846">var</span>&nbsp;<span class="ident" id="4318850">privKey</span>&nbsp;<span class="ident" id="4318858">ecPrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318872">if</span>&nbsp;<span class="ident" id="4318875">_</span><span class="op" id="4318876">,</span>&nbsp;<span class="ident" id="4318878">err</span>&nbsp;<span class="op" id="4318882">:=</span>&nbsp;<span class="ident" id="4318885">asn1</span><span class="op" id="4318889">.</span><span class="ident" id="4318890">Unmarshal</span><span class="op" id="4318899">(</span><span class="ident" id="4318900">der</span><span class="op" id="4318903">,</span>&nbsp;<span class="op" id="4318905">&amp;</span><span class="ident" id="4318906">privKey</span><span class="op" id="4318913">)</span><span class="op" id="4318914">;</span>&nbsp;<span class="ident" id="4318916">err</span>&nbsp;<span class="op" id="4318920">!=</span>&nbsp;<span class="ident" id="4318923">nil</span>&nbsp;<span class="op" id="4318927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318931">return</span>&nbsp;<span class="ident" id="4318938">nil</span><span class="op" id="4318941">,</span>&nbsp;<span class="ident" id="4318943">errors</span><span class="op" id="4318949">.</span><span class="ident" id="4318950">New</span><span class="op" id="4318953">(</span><span class="string" id="4318954">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key:&nbsp;&#34;</span>&nbsp;<span class="op" id="4318995">+</span>&nbsp;<span class="ident" id="4318997">err</span><span class="op" id="4319000">.</span><span class="ident" id="4319001">Error</span><span class="op" id="4319006">(</span><span class="op" id="4319007">)</span><span class="op" id="4319008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4319011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319014">if</span>&nbsp;<span class="ident" id="4319017">privKey</span><span class="op" id="4319024">.</span><span class="ident" id="4319025">Version</span>&nbsp;<span class="op" id="4319033">!=</span>&nbsp;<span class="ident" id="4319036">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4319053">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319057">return</span>&nbsp;<span class="ident" id="4319064">nil</span><span class="op" id="4319067">,</span>&nbsp;<span class="ident" id="4319069">fmt</span><span class="op" id="4319072">.</span><span class="ident" id="4319073">Errorf</span><span class="op" id="4319079">(</span><span class="string" id="4319080">&#34;x509:&nbsp;unknown&nbsp;EC&nbsp;private&nbsp;key&nbsp;version&nbsp;%d&#34;</span><span class="op" id="4319121">,</span>&nbsp;<span class="ident" id="4319123">privKey</span><span class="op" id="4319130">.</span><span class="ident" id="4319131">Version</span><span class="op" id="4319138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4319141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319145">var</span>&nbsp;<span class="ident" id="4319149">curve</span>&nbsp;<span class="ident" id="4319155">elliptic</span><span class="op" id="4319163">.</span><span class="ident" id="4319164">Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319171">if</span>&nbsp;<span class="ident" id="4319174">namedCurveOID</span>&nbsp;<span class="op" id="4319188">!=</span>&nbsp;<span class="ident" id="4319191">nil</span>&nbsp;<span class="op" id="4319195">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319199">curve</span>&nbsp;<span class="op" id="4319205">=</span>&nbsp;<span class="ident" id="4319207">namedCurveFromOID</span><span class="op" id="4319224">(</span><span class="op" id="4319225">*</span><span class="ident" id="4319226">namedCurveOID</span><span class="op" id="4319239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4319242">}</span>&nbsp;<span class="keyword" id="4319244">else</span>&nbsp;<span class="op" id="4319249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319253">curve</span>&nbsp;<span class="op" id="4319259">=</span>&nbsp;<span class="ident" id="4319261">namedCurveFromOID</span><span class="op" id="4319278">(</span><span class="ident" id="4319279">privKey</span><span class="op" id="4319286">.</span><span class="ident" id="4319287">NamedCurveOID</span><span class="op" id="4319300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4319303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319306">if</span>&nbsp;<span class="ident" id="4319309">curve</span>&nbsp;<span class="op" id="4319315">==</span>&nbsp;<span class="ident" id="4319318">nil</span>&nbsp;<span class="op" id="4319322">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319326">return</span>&nbsp;<span class="ident" id="4319333">nil</span><span class="op" id="4319336">,</span>&nbsp;<span class="ident" id="4319338">errors</span><span class="op" id="4319344">.</span><span class="ident" id="4319345">New</span><span class="op" id="4319348">(</span><span class="string" id="4319349">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4319379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4319382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319386">k</span>&nbsp;<span class="op" id="4319388">:=</span>&nbsp;<span class="builtinfunc" id="4319391">new</span><span class="op" id="4319394">(</span><span class="ident" id="4319395">big</span><span class="op" id="4319398">.</span><span class="ident" id="4319399">Int</span><span class="op" id="4319402">)</span><span class="op" id="4319403">.</span><span class="ident" id="4319404">SetBytes</span><span class="op" id="4319412">(</span><span class="ident" id="4319413">privKey</span><span class="op" id="4319420">.</span><span class="ident" id="4319421">PrivateKey</span><span class="op" id="4319431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319434">if</span>&nbsp;<span class="ident" id="4319437">k</span><span class="op" id="4319438">.</span><span class="ident" id="4319439">Cmp</span><span class="op" id="4319442">(</span><span class="ident" id="4319443">curve</span><span class="op" id="4319448">.</span><span class="ident" id="4319449">Params</span><span class="op" id="4319455">(</span><span class="op" id="4319456">)</span><span class="op" id="4319457">.</span><span class="ident" id="4319458">N</span><span class="op" id="4319459">)</span>&nbsp;<span class="op" id="4319461">&gt;=</span>&nbsp;<span class="num" id="4319464">0</span>&nbsp;<span class="op" id="4319466">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319470">return</span>&nbsp;<span class="ident" id="4319477">nil</span><span class="op" id="4319480">,</span>&nbsp;<span class="ident" id="4319482">errors</span><span class="op" id="4319488">.</span><span class="ident" id="4319489">New</span><span class="op" id="4319492">(</span><span class="string" id="4319493">&#34;x509:&nbsp;invalid&nbsp;elliptic&nbsp;curve&nbsp;private&nbsp;key&nbsp;value&#34;</span><span class="op" id="4319541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4319544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319547">priv</span>&nbsp;<span class="op" id="4319552">:=</span>&nbsp;<span class="builtinfunc" id="4319555">new</span><span class="op" id="4319558">(</span><span class="ident" id="4319559">ecdsa</span><span class="op" id="4319564">.</span><span class="ident" id="4319565">PrivateKey</span><span class="op" id="4319575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319578">priv</span><span class="op" id="4319582">.</span><span class="ident" id="4319583">Curve</span>&nbsp;<span class="op" id="4319589">=</span>&nbsp;<span class="ident" id="4319591">curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319598">priv</span><span class="op" id="4319602">.</span><span class="ident" id="4319603">D</span>&nbsp;<span class="op" id="4319605">=</span>&nbsp;<span class="ident" id="4319607">k</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319610">priv</span><span class="op" id="4319614">.</span><span class="ident" id="4319615">X</span><span class="op" id="4319616">,</span>&nbsp;<span class="ident" id="4319618">priv</span><span class="op" id="4319622">.</span><span class="ident" id="4319623">Y</span>&nbsp;<span class="op" id="4319625">=</span>&nbsp;<span class="ident" id="4319627">curve</span><span class="op" id="4319632">.</span><span class="ident" id="4319633">ScalarBaseMult</span><span class="op" id="4319647">(</span><span class="ident" id="4319648">privKey</span><span class="op" id="4319655">.</span><span class="ident" id="4319656">PrivateKey</span><span class="op" id="4319666">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319670">return</span>&nbsp;<span class="ident" id="4319677">priv</span><span class="op" id="4319681">,</span>&nbsp;<span class="ident" id="4319683">nil</span><br>
<span class="lineno"></span><span class="op" id="4319687">}</span>
</div>
</body>
</html>
