<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html" class="current">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7838493">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7838549">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7838603">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7838654">package</span>&nbsp;<span class="ident" id="7838662">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7838668">import</span>&nbsp;<span class="op" id="7838675">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7838678">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7838687">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7838704">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7838711">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7838718">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7838724">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7838735">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7838746">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7838757">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7838764">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7838767">var</span>&nbsp;<span class="ident" id="7838771">writeSetCookiesTests</span>&nbsp;<span class="op" id="7838792">=</span>&nbsp;<span class="op" id="7838794">[</span><span class="op" id="7838795">]</span><span class="keyword" id="7838796">struct</span>&nbsp;<span class="op" id="7838803">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7838806">Cookie</span>&nbsp;<span class="op" id="7838813">*</span><span class="ident" id="7838814">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7838822">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7838829">string</span><br>
<span class="lineno"></span><span class="op" id="7838836">}</span><span class="op" id="7838837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7838840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7838844">&amp;</span><span class="ident" id="7838845">Cookie</span><span class="op" id="7838851">{</span><span class="ident" id="7838852">Name</span><span class="op" id="7838856">:</span>&nbsp;<span class="string" id="7838858">&#34;cookie-1&#34;</span><span class="op" id="7838868">,</span>&nbsp;<span class="ident" id="7838870">Value</span><span class="op" id="7838875">:</span>&nbsp;<span class="string" id="7838877">&#34;v$1&#34;</span><span class="op" id="7838882">}</span><span class="op" id="7838883">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7838887">&#34;cookie-1=v$1&#34;</span><span class="op" id="7838901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7838904">}</span><span class="op" id="7838905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7838908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7838912">&amp;</span><span class="ident" id="7838913">Cookie</span><span class="op" id="7838919">{</span><span class="ident" id="7838920">Name</span><span class="op" id="7838924">:</span>&nbsp;<span class="string" id="7838926">&#34;cookie-2&#34;</span><span class="op" id="7838936">,</span>&nbsp;<span class="ident" id="7838938">Value</span><span class="op" id="7838943">:</span>&nbsp;<span class="string" id="7838945">&#34;two&#34;</span><span class="op" id="7838950">,</span>&nbsp;<span class="ident" id="7838952">MaxAge</span><span class="op" id="7838958">:</span>&nbsp;<span class="num" id="7838960">3600</span><span class="op" id="7838964">}</span><span class="op" id="7838965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7838969">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="7838997">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839000">}</span><span class="op" id="7839001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839008">&amp;</span><span class="ident" id="7839009">Cookie</span><span class="op" id="7839015">{</span><span class="ident" id="7839016">Name</span><span class="op" id="7839020">:</span>&nbsp;<span class="string" id="7839022">&#34;cookie-3&#34;</span><span class="op" id="7839032">,</span>&nbsp;<span class="ident" id="7839034">Value</span><span class="op" id="7839039">:</span>&nbsp;<span class="string" id="7839041">&#34;three&#34;</span><span class="op" id="7839048">,</span>&nbsp;<span class="ident" id="7839050">Domain</span><span class="op" id="7839056">:</span>&nbsp;<span class="string" id="7839058">&#34;.example.com&#34;</span><span class="op" id="7839072">}</span><span class="op" id="7839073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7839077">&#34;cookie-3=three;&nbsp;Domain=example.com&#34;</span><span class="op" id="7839113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839116">}</span><span class="op" id="7839117">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839124">&amp;</span><span class="ident" id="7839125">Cookie</span><span class="op" id="7839131">{</span><span class="ident" id="7839132">Name</span><span class="op" id="7839136">:</span>&nbsp;<span class="string" id="7839138">&#34;cookie-4&#34;</span><span class="op" id="7839148">,</span>&nbsp;<span class="ident" id="7839150">Value</span><span class="op" id="7839155">:</span>&nbsp;<span class="string" id="7839157">&#34;four&#34;</span><span class="op" id="7839163">,</span>&nbsp;<span class="ident" id="7839165">Path</span><span class="op" id="7839169">:</span>&nbsp;<span class="string" id="7839171">&#34;/restricted/&#34;</span><span class="op" id="7839185">}</span><span class="op" id="7839186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7839190">&#34;cookie-4=four;&nbsp;Path=/restricted/&#34;</span><span class="op" id="7839224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839227">}</span><span class="op" id="7839228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839231">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839235">&amp;</span><span class="ident" id="7839236">Cookie</span><span class="op" id="7839242">{</span><span class="ident" id="7839243">Name</span><span class="op" id="7839247">:</span>&nbsp;<span class="string" id="7839249">&#34;cookie-5&#34;</span><span class="op" id="7839259">,</span>&nbsp;<span class="ident" id="7839261">Value</span><span class="op" id="7839266">:</span>&nbsp;<span class="string" id="7839268">&#34;five&#34;</span><span class="op" id="7839274">,</span>&nbsp;<span class="ident" id="7839276">Domain</span><span class="op" id="7839282">:</span>&nbsp;<span class="string" id="7839284">&#34;wrong;bad.abc&#34;</span><span class="op" id="7839299">}</span><span class="op" id="7839300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7839304">&#34;cookie-5=five&#34;</span><span class="op" id="7839319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839322">}</span><span class="op" id="7839323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839330">&amp;</span><span class="ident" id="7839331">Cookie</span><span class="op" id="7839337">{</span><span class="ident" id="7839338">Name</span><span class="op" id="7839342">:</span>&nbsp;<span class="string" id="7839344">&#34;cookie-6&#34;</span><span class="op" id="7839354">,</span>&nbsp;<span class="ident" id="7839356">Value</span><span class="op" id="7839361">:</span>&nbsp;<span class="string" id="7839363">&#34;six&#34;</span><span class="op" id="7839368">,</span>&nbsp;<span class="ident" id="7839370">Domain</span><span class="op" id="7839376">:</span>&nbsp;<span class="string" id="7839378">&#34;bad-.abc&#34;</span><span class="op" id="7839388">}</span><span class="op" id="7839389">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7839393">&#34;cookie-6=six&#34;</span><span class="op" id="7839407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839410">}</span><span class="op" id="7839411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839418">&amp;</span><span class="ident" id="7839419">Cookie</span><span class="op" id="7839425">{</span><span class="ident" id="7839426">Name</span><span class="op" id="7839430">:</span>&nbsp;<span class="string" id="7839432">&#34;cookie-7&#34;</span><span class="op" id="7839442">,</span>&nbsp;<span class="ident" id="7839444">Value</span><span class="op" id="7839449">:</span>&nbsp;<span class="string" id="7839451">&#34;seven&#34;</span><span class="op" id="7839458">,</span>&nbsp;<span class="ident" id="7839460">Domain</span><span class="op" id="7839466">:</span>&nbsp;<span class="string" id="7839468">&#34;127.0.0.1&#34;</span><span class="op" id="7839479">}</span><span class="op" id="7839480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7839484">&#34;cookie-7=seven;&nbsp;Domain=127.0.0.1&#34;</span><span class="op" id="7839518">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839521">}</span><span class="op" id="7839522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839529">&amp;</span><span class="ident" id="7839530">Cookie</span><span class="op" id="7839536">{</span><span class="ident" id="7839537">Name</span><span class="op" id="7839541">:</span>&nbsp;<span class="string" id="7839543">&#34;cookie-8&#34;</span><span class="op" id="7839553">,</span>&nbsp;<span class="ident" id="7839555">Value</span><span class="op" id="7839560">:</span>&nbsp;<span class="string" id="7839562">&#34;eight&#34;</span><span class="op" id="7839569">,</span>&nbsp;<span class="ident" id="7839571">Domain</span><span class="op" id="7839577">:</span>&nbsp;<span class="string" id="7839579">&#34;::1&#34;</span><span class="op" id="7839584">}</span><span class="op" id="7839585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7839589">&#34;cookie-8=eight&#34;</span><span class="op" id="7839605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839608">}</span><span class="op" id="7839609">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7839612">//&nbsp;The&nbsp;&#34;special&#34;&nbsp;cookies&nbsp;have&nbsp;values&nbsp;containing&nbsp;commas&nbsp;or&nbsp;spaces&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7839684">//&nbsp;are&nbsp;disallowed&nbsp;by&nbsp;RFC&nbsp;6265&nbsp;but&nbsp;are&nbsp;common&nbsp;in&nbsp;the&nbsp;wild.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839747">&amp;</span><span class="ident" id="7839748">Cookie</span><span class="op" id="7839754">{</span><span class="ident" id="7839755">Name</span><span class="op" id="7839759">:</span>&nbsp;<span class="string" id="7839761">&#34;special-1&#34;</span><span class="op" id="7839772">,</span>&nbsp;<span class="ident" id="7839774">Value</span><span class="op" id="7839779">:</span>&nbsp;<span class="string" id="7839781">&#34;a&nbsp;z&#34;</span><span class="op" id="7839786">}</span><span class="op" id="7839787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7839791">`special-1=a&nbsp;z`</span><span class="op" id="7839806">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839809">}</span><span class="op" id="7839810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839817">&amp;</span><span class="ident" id="7839818">Cookie</span><span class="op" id="7839824">{</span><span class="ident" id="7839825">Name</span><span class="op" id="7839829">:</span>&nbsp;<span class="string" id="7839831">&#34;special-2&#34;</span><span class="op" id="7839842">,</span>&nbsp;<span class="ident" id="7839844">Value</span><span class="op" id="7839849">:</span>&nbsp;<span class="string" id="7839851">&#34;&nbsp;z&#34;</span><span class="op" id="7839855">}</span><span class="op" id="7839856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7839860">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7839876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839879">}</span><span class="op" id="7839880">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839887">&amp;</span><span class="ident" id="7839888">Cookie</span><span class="op" id="7839894">{</span><span class="ident" id="7839895">Name</span><span class="op" id="7839899">:</span>&nbsp;<span class="string" id="7839901">&#34;special-3&#34;</span><span class="op" id="7839912">,</span>&nbsp;<span class="ident" id="7839914">Value</span><span class="op" id="7839919">:</span>&nbsp;<span class="string" id="7839921">&#34;a&nbsp;&#34;</span><span class="op" id="7839925">}</span><span class="op" id="7839926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7839930">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7839946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839949">}</span><span class="op" id="7839950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839953">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839957">&amp;</span><span class="ident" id="7839958">Cookie</span><span class="op" id="7839964">{</span><span class="ident" id="7839965">Name</span><span class="op" id="7839969">:</span>&nbsp;<span class="string" id="7839971">&#34;special-4&#34;</span><span class="op" id="7839982">,</span>&nbsp;<span class="ident" id="7839984">Value</span><span class="op" id="7839989">:</span>&nbsp;<span class="string" id="7839991">&#34;&nbsp;&#34;</span><span class="op" id="7839994">}</span><span class="op" id="7839995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7839999">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7840014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840017">}</span><span class="op" id="7840018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840025">&amp;</span><span class="ident" id="7840026">Cookie</span><span class="op" id="7840032">{</span><span class="ident" id="7840033">Name</span><span class="op" id="7840037">:</span>&nbsp;<span class="string" id="7840039">&#34;special-5&#34;</span><span class="op" id="7840050">,</span>&nbsp;<span class="ident" id="7840052">Value</span><span class="op" id="7840057">:</span>&nbsp;<span class="string" id="7840059">&#34;a,z&#34;</span><span class="op" id="7840064">}</span><span class="op" id="7840065">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7840069">`special-5=a,z`</span><span class="op" id="7840084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840087">}</span><span class="op" id="7840088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840095">&amp;</span><span class="ident" id="7840096">Cookie</span><span class="op" id="7840102">{</span><span class="ident" id="7840103">Name</span><span class="op" id="7840107">:</span>&nbsp;<span class="string" id="7840109">&#34;special-6&#34;</span><span class="op" id="7840120">,</span>&nbsp;<span class="ident" id="7840122">Value</span><span class="op" id="7840127">:</span>&nbsp;<span class="string" id="7840129">&#34;,z&#34;</span><span class="op" id="7840133">}</span><span class="op" id="7840134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7840138">`special-6=&#34;,z&#34;`</span><span class="op" id="7840154">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840157">}</span><span class="op" id="7840158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840165">&amp;</span><span class="ident" id="7840166">Cookie</span><span class="op" id="7840172">{</span><span class="ident" id="7840173">Name</span><span class="op" id="7840177">:</span>&nbsp;<span class="string" id="7840179">&#34;special-7&#34;</span><span class="op" id="7840190">,</span>&nbsp;<span class="ident" id="7840192">Value</span><span class="op" id="7840197">:</span>&nbsp;<span class="string" id="7840199">&#34;a,&#34;</span><span class="op" id="7840203">}</span><span class="op" id="7840204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7840208">`special-7=&#34;a,&#34;`</span><span class="op" id="7840224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840227">}</span><span class="op" id="7840228">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840235">&amp;</span><span class="ident" id="7840236">Cookie</span><span class="op" id="7840242">{</span><span class="ident" id="7840243">Name</span><span class="op" id="7840247">:</span>&nbsp;<span class="string" id="7840249">&#34;special-8&#34;</span><span class="op" id="7840260">,</span>&nbsp;<span class="ident" id="7840262">Value</span><span class="op" id="7840267">:</span>&nbsp;<span class="string" id="7840269">&#34;,&#34;</span><span class="op" id="7840272">}</span><span class="op" id="7840273">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7840277">`special-8=&#34;,&#34;`</span><span class="op" id="7840292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840295">}</span><span class="op" id="7840296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840299">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840303">&amp;</span><span class="ident" id="7840304">Cookie</span><span class="op" id="7840310">{</span><span class="ident" id="7840311">Name</span><span class="op" id="7840315">:</span>&nbsp;<span class="string" id="7840317">&#34;empty-value&#34;</span><span class="op" id="7840330">,</span>&nbsp;<span class="ident" id="7840332">Value</span><span class="op" id="7840337">:</span>&nbsp;<span class="string" id="7840339">&#34;&#34;</span><span class="op" id="7840341">}</span><span class="op" id="7840342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7840346">`empty-value=`</span><span class="op" id="7840360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840363">}</span><span class="op" id="7840364">,</span><br>
<span class="lineno"></span><span class="op" id="7840366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="7840369">func</span>&nbsp;<span class="ident" id="7840374">TestWriteSetCookies</span><span class="op" id="7840393">(</span><span class="ident" id="7840394">t</span>&nbsp;<span class="op" id="7840396">*</span><span class="ident" id="7840397">testing</span><span class="op" id="7840404">.</span><span class="ident" id="7840405">T</span><span class="op" id="7840406">)</span>&nbsp;<span class="op" id="7840408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7840411">defer</span>&nbsp;<span class="ident" id="7840417">log</span><span class="op" id="7840420">.</span><span class="ident" id="7840421">SetOutput</span><span class="op" id="7840430">(</span><span class="ident" id="7840431">os</span><span class="op" id="7840433">.</span><span class="ident" id="7840434">Stderr</span><span class="op" id="7840440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7840443">var</span>&nbsp;<span class="ident" id="7840447">logbuf</span>&nbsp;<span class="ident" id="7840454">bytes</span><span class="op" id="7840459">.</span><span class="ident" id="7840460">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7840468">log</span><span class="op" id="7840471">.</span><span class="ident" id="7840472">SetOutput</span><span class="op" id="7840481">(</span><span class="op" id="7840482">&amp;</span><span class="ident" id="7840483">logbuf</span><span class="op" id="7840489">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7840493">for</span>&nbsp;<span class="ident" id="7840497">i</span><span class="op" id="7840498">,</span>&nbsp;<span class="ident" id="7840500">tt</span>&nbsp;<span class="op" id="7840503">:=</span>&nbsp;<span class="keyword" id="7840506">range</span>&nbsp;<span class="ident" id="7840512">writeSetCookiesTests</span>&nbsp;<span class="op" id="7840533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7840537">if</span>&nbsp;<span class="ident" id="7840540">g</span><span class="op" id="7840541">,</span>&nbsp;<span class="ident" id="7840543">e</span>&nbsp;<span class="op" id="7840545">:=</span>&nbsp;<span class="ident" id="7840548">tt</span><span class="op" id="7840550">.</span><span class="ident" id="7840551">Cookie</span><span class="op" id="7840557">.</span><span class="ident" id="7840558">String</span><span class="op" id="7840564">(</span><span class="op" id="7840565">)</span><span class="op" id="7840566">,</span>&nbsp;<span class="ident" id="7840568">tt</span><span class="op" id="7840570">.</span><span class="ident" id="7840571">Raw</span><span class="op" id="7840574">;</span>&nbsp;<span class="ident" id="7840576">g</span>&nbsp;<span class="op" id="7840578">!=</span>&nbsp;<span class="ident" id="7840581">e</span>&nbsp;<span class="op" id="7840583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7840588">t</span><span class="op" id="7840589">.</span><span class="ident" id="7840590">Errorf</span><span class="op" id="7840596">(</span><span class="string" id="7840597">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7840634">,</span>&nbsp;<span class="ident" id="7840636">i</span><span class="op" id="7840637">,</span>&nbsp;<span class="ident" id="7840639">e</span><span class="op" id="7840640">,</span>&nbsp;<span class="ident" id="7840642">g</span><span class="op" id="7840643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7840648">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840659">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7840666">if</span>&nbsp;<span class="ident" id="7840669">got</span><span class="op" id="7840672">,</span>&nbsp;<span class="ident" id="7840674">sub</span>&nbsp;<span class="op" id="7840678">:=</span>&nbsp;<span class="ident" id="7840681">logbuf</span><span class="op" id="7840687">.</span><span class="ident" id="7840688">String</span><span class="op" id="7840694">(</span><span class="op" id="7840695">)</span><span class="op" id="7840696">,</span>&nbsp;<span class="string" id="7840698">&#34;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="7840725">;</span>&nbsp;<span class="op" id="7840727">!</span><span class="ident" id="7840728">strings</span><span class="op" id="7840735">.</span><span class="ident" id="7840736">Contains</span><span class="op" id="7840744">(</span><span class="ident" id="7840745">got</span><span class="op" id="7840748">,</span>&nbsp;<span class="ident" id="7840750">sub</span><span class="op" id="7840753">)</span>&nbsp;<span class="op" id="7840755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7840759">t</span><span class="op" id="7840760">.</span><span class="ident" id="7840761">Errorf</span><span class="op" id="7840767">(</span><span class="string" id="7840768">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7840815">,</span>&nbsp;<span class="ident" id="7840817">sub</span><span class="op" id="7840820">,</span>&nbsp;<span class="ident" id="7840822">got</span><span class="op" id="7840825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7840828">}</span><br>
<span class="lineno">110</span><span class="op" id="7840830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7840833">type</span>&nbsp;<span class="ident" id="7840838">headerOnlyResponseWriter</span>&nbsp;<span class="ident" id="7840863">Header</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7840871">func</span>&nbsp;<span class="op" id="7840876">(</span><span class="ident" id="7840877">ho</span>&nbsp;<span class="ident" id="7840880">headerOnlyResponseWriter</span><span class="op" id="7840904">)</span>&nbsp;<span class="ident" id="7840906">Header</span><span class="op" id="7840912">(</span><span class="op" id="7840913">)</span>&nbsp;<span class="ident" id="7840915">Header</span>&nbsp;<span class="op" id="7840922">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7840925">return</span>&nbsp;<span class="ident" id="7840932">Header</span><span class="op" id="7840938">(</span><span class="ident" id="7840939">ho</span><span class="op" id="7840941">)</span><br>
<span class="lineno"></span><span class="op" id="7840943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7840946">func</span>&nbsp;<span class="op" id="7840951">(</span><span class="ident" id="7840952">ho</span>&nbsp;<span class="ident" id="7840955">headerOnlyResponseWriter</span><span class="op" id="7840979">)</span>&nbsp;<span class="ident" id="7840981">Write</span><span class="op" id="7840986">(</span><span class="op" id="7840987">[</span><span class="op" id="7840988">]</span><span class="builtintype" id="7840989">byte</span><span class="op" id="7840993">)</span>&nbsp;<span class="op" id="7840995">(</span><span class="builtintype" id="7840996">int</span><span class="op" id="7840999">,</span>&nbsp;<span class="builtintype" id="7841001">error</span><span class="op" id="7841006">)</span>&nbsp;<span class="op" id="7841008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7841011">panic</span><span class="op" id="7841016">(</span><span class="string" id="7841017">&#34;NOIMPL&#34;</span><span class="op" id="7841025">)</span><br>
<span class="lineno">120</span><span class="op" id="7841027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7841030">func</span>&nbsp;<span class="op" id="7841035">(</span><span class="ident" id="7841036">ho</span>&nbsp;<span class="ident" id="7841039">headerOnlyResponseWriter</span><span class="op" id="7841063">)</span>&nbsp;<span class="ident" id="7841065">WriteHeader</span><span class="op" id="7841076">(</span><span class="builtintype" id="7841077">int</span><span class="op" id="7841080">)</span>&nbsp;<span class="op" id="7841082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7841085">panic</span><span class="op" id="7841090">(</span><span class="string" id="7841091">&#34;NOIMPL&#34;</span><span class="op" id="7841099">)</span><br>
<span class="lineno"></span><span class="op" id="7841101">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="7841104">func</span>&nbsp;<span class="ident" id="7841109">TestSetCookie</span><span class="op" id="7841122">(</span><span class="ident" id="7841123">t</span>&nbsp;<span class="op" id="7841125">*</span><span class="ident" id="7841126">testing</span><span class="op" id="7841133">.</span><span class="ident" id="7841134">T</span><span class="op" id="7841135">)</span>&nbsp;<span class="op" id="7841137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7841140">m</span>&nbsp;<span class="op" id="7841142">:=</span>&nbsp;<span class="builtinfunc" id="7841145">make</span><span class="op" id="7841149">(</span><span class="ident" id="7841150">Header</span><span class="op" id="7841156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7841159">SetCookie</span><span class="op" id="7841168">(</span><span class="ident" id="7841169">headerOnlyResponseWriter</span><span class="op" id="7841193">(</span><span class="ident" id="7841194">m</span><span class="op" id="7841195">)</span><span class="op" id="7841196">,</span>&nbsp;<span class="op" id="7841198">&amp;</span><span class="ident" id="7841199">Cookie</span><span class="op" id="7841205">{</span><span class="ident" id="7841206">Name</span><span class="op" id="7841210">:</span>&nbsp;<span class="string" id="7841212">&#34;cookie-1&#34;</span><span class="op" id="7841222">,</span>&nbsp;<span class="ident" id="7841224">Value</span><span class="op" id="7841229">:</span>&nbsp;<span class="string" id="7841231">&#34;one&#34;</span><span class="op" id="7841236">,</span>&nbsp;<span class="ident" id="7841238">Path</span><span class="op" id="7841242">:</span>&nbsp;<span class="string" id="7841244">&#34;/restricted/&#34;</span><span class="op" id="7841258">}</span><span class="op" id="7841259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7841262">SetCookie</span><span class="op" id="7841271">(</span><span class="ident" id="7841272">headerOnlyResponseWriter</span><span class="op" id="7841296">(</span><span class="ident" id="7841297">m</span><span class="op" id="7841298">)</span><span class="op" id="7841299">,</span>&nbsp;<span class="op" id="7841301">&amp;</span><span class="ident" id="7841302">Cookie</span><span class="op" id="7841308">{</span><span class="ident" id="7841309">Name</span><span class="op" id="7841313">:</span>&nbsp;<span class="string" id="7841315">&#34;cookie-2&#34;</span><span class="op" id="7841325">,</span>&nbsp;<span class="ident" id="7841327">Value</span><span class="op" id="7841332">:</span>&nbsp;<span class="string" id="7841334">&#34;two&#34;</span><span class="op" id="7841339">,</span>&nbsp;<span class="ident" id="7841341">MaxAge</span><span class="op" id="7841347">:</span>&nbsp;<span class="num" id="7841349">3600</span><span class="op" id="7841353">}</span><span class="op" id="7841354">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7841357">if</span>&nbsp;<span class="ident" id="7841360">l</span>&nbsp;<span class="op" id="7841362">:=</span>&nbsp;<span class="builtinfunc" id="7841365">len</span><span class="op" id="7841368">(</span><span class="ident" id="7841369">m</span><span class="op" id="7841370">[</span><span class="string" id="7841371">&#34;Set-Cookie&#34;</span><span class="op" id="7841383">]</span><span class="op" id="7841384">)</span><span class="op" id="7841385">;</span>&nbsp;<span class="ident" id="7841387">l</span>&nbsp;<span class="op" id="7841389">!=</span>&nbsp;<span class="num" id="7841392">2</span>&nbsp;<span class="op" id="7841394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7841398">t</span><span class="op" id="7841399">.</span><span class="ident" id="7841400">Fatalf</span><span class="op" id="7841406">(</span><span class="string" id="7841407">&#34;expected&nbsp;%d&nbsp;cookies,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7841436">,</span>&nbsp;<span class="num" id="7841438">2</span><span class="op" id="7841439">,</span>&nbsp;<span class="ident" id="7841441">l</span><span class="op" id="7841442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7841445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7841448">if</span>&nbsp;<span class="ident" id="7841451">g</span><span class="op" id="7841452">,</span>&nbsp;<span class="ident" id="7841454">e</span>&nbsp;<span class="op" id="7841456">:=</span>&nbsp;<span class="ident" id="7841459">m</span><span class="op" id="7841460">[</span><span class="string" id="7841461">&#34;Set-Cookie&#34;</span><span class="op" id="7841473">]</span><span class="op" id="7841474">[</span><span class="num" id="7841475">0</span><span class="op" id="7841476">]</span><span class="op" id="7841477">,</span>&nbsp;<span class="string" id="7841479">&#34;cookie-1=one;&nbsp;Path=/restricted/&#34;</span><span class="op" id="7841512">;</span>&nbsp;<span class="ident" id="7841514">g</span>&nbsp;<span class="op" id="7841516">!=</span>&nbsp;<span class="ident" id="7841519">e</span>&nbsp;<span class="op" id="7841521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7841525">t</span><span class="op" id="7841526">.</span><span class="ident" id="7841527">Errorf</span><span class="op" id="7841533">(</span><span class="string" id="7841534">&#34;cookie&nbsp;#1:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7841562">,</span>&nbsp;<span class="ident" id="7841564">e</span><span class="op" id="7841565">,</span>&nbsp;<span class="ident" id="7841567">g</span><span class="op" id="7841568">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7841571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7841574">if</span>&nbsp;<span class="ident" id="7841577">g</span><span class="op" id="7841578">,</span>&nbsp;<span class="ident" id="7841580">e</span>&nbsp;<span class="op" id="7841582">:=</span>&nbsp;<span class="ident" id="7841585">m</span><span class="op" id="7841586">[</span><span class="string" id="7841587">&#34;Set-Cookie&#34;</span><span class="op" id="7841599">]</span><span class="op" id="7841600">[</span><span class="num" id="7841601">1</span><span class="op" id="7841602">]</span><span class="op" id="7841603">,</span>&nbsp;<span class="string" id="7841605">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="7841633">;</span>&nbsp;<span class="ident" id="7841635">g</span>&nbsp;<span class="op" id="7841637">!=</span>&nbsp;<span class="ident" id="7841640">e</span>&nbsp;<span class="op" id="7841642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7841646">t</span><span class="op" id="7841647">.</span><span class="ident" id="7841648">Errorf</span><span class="op" id="7841654">(</span><span class="string" id="7841655">&#34;cookie&nbsp;#2:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7841683">,</span>&nbsp;<span class="ident" id="7841685">e</span><span class="op" id="7841686">,</span>&nbsp;<span class="ident" id="7841688">g</span><span class="op" id="7841689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7841692">}</span><br>
<span class="lineno"></span><span class="op" id="7841694">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7841697">var</span>&nbsp;<span class="ident" id="7841701">addCookieTests</span>&nbsp;<span class="op" id="7841716">=</span>&nbsp;<span class="op" id="7841718">[</span><span class="op" id="7841719">]</span><span class="keyword" id="7841720">struct</span>&nbsp;<span class="op" id="7841727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7841730">Cookies</span>&nbsp;<span class="op" id="7841738">[</span><span class="op" id="7841739">]</span><span class="op" id="7841740">*</span><span class="ident" id="7841741">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7841749">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7841757">string</span><br>
<span class="lineno"></span><span class="op" id="7841764">}</span><span class="op" id="7841765">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7841768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7841772">[</span><span class="op" id="7841773">]</span><span class="op" id="7841774">*</span><span class="ident" id="7841775">Cookie</span><span class="op" id="7841781">{</span><span class="op" id="7841782">}</span><span class="op" id="7841783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7841787">&#34;&#34;</span><span class="op" id="7841789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7841792">}</span><span class="op" id="7841793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7841796">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7841800">[</span><span class="op" id="7841801">]</span><span class="op" id="7841802">*</span><span class="ident" id="7841803">Cookie</span><span class="op" id="7841809">{</span><span class="op" id="7841810">{</span><span class="ident" id="7841811">Name</span><span class="op" id="7841815">:</span>&nbsp;<span class="string" id="7841817">&#34;cookie-1&#34;</span><span class="op" id="7841827">,</span>&nbsp;<span class="ident" id="7841829">Value</span><span class="op" id="7841834">:</span>&nbsp;<span class="string" id="7841836">&#34;v$1&#34;</span><span class="op" id="7841841">}</span><span class="op" id="7841842">}</span><span class="op" id="7841843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7841847">&#34;cookie-1=v$1&#34;</span><span class="op" id="7841861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7841864">}</span><span class="op" id="7841865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7841868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7841872">[</span><span class="op" id="7841873">]</span><span class="op" id="7841874">*</span><span class="ident" id="7841875">Cookie</span><span class="op" id="7841881">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7841886">{</span><span class="ident" id="7841887">Name</span><span class="op" id="7841891">:</span>&nbsp;<span class="string" id="7841893">&#34;cookie-1&#34;</span><span class="op" id="7841903">,</span>&nbsp;<span class="ident" id="7841905">Value</span><span class="op" id="7841910">:</span>&nbsp;<span class="string" id="7841912">&#34;v$1&#34;</span><span class="op" id="7841917">}</span><span class="op" id="7841918">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7841923">{</span><span class="ident" id="7841924">Name</span><span class="op" id="7841928">:</span>&nbsp;<span class="string" id="7841930">&#34;cookie-2&#34;</span><span class="op" id="7841940">,</span>&nbsp;<span class="ident" id="7841942">Value</span><span class="op" id="7841947">:</span>&nbsp;<span class="string" id="7841949">&#34;v$2&#34;</span><span class="op" id="7841954">}</span><span class="op" id="7841955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7841960">{</span><span class="ident" id="7841961">Name</span><span class="op" id="7841965">:</span>&nbsp;<span class="string" id="7841967">&#34;cookie-3&#34;</span><span class="op" id="7841977">,</span>&nbsp;<span class="ident" id="7841979">Value</span><span class="op" id="7841984">:</span>&nbsp;<span class="string" id="7841986">&#34;v$3&#34;</span><span class="op" id="7841991">}</span><span class="op" id="7841992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7841996">}</span><span class="op" id="7841997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7842001">&#34;cookie-1=v$1;&nbsp;cookie-2=v$2;&nbsp;cookie-3=v$3&#34;</span><span class="op" id="7842043">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7842046">}</span><span class="op" id="7842047">,</span><br>
<span class="lineno"></span><span class="op" id="7842049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7842052">func</span>&nbsp;<span class="ident" id="7842057">TestAddCookie</span><span class="op" id="7842070">(</span><span class="ident" id="7842071">t</span>&nbsp;<span class="op" id="7842073">*</span><span class="ident" id="7842074">testing</span><span class="op" id="7842081">.</span><span class="ident" id="7842082">T</span><span class="op" id="7842083">)</span>&nbsp;<span class="op" id="7842085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7842088">for</span>&nbsp;<span class="ident" id="7842092">i</span><span class="op" id="7842093">,</span>&nbsp;<span class="ident" id="7842095">tt</span>&nbsp;<span class="op" id="7842098">:=</span>&nbsp;<span class="keyword" id="7842101">range</span>&nbsp;<span class="ident" id="7842107">addCookieTests</span>&nbsp;<span class="op" id="7842122">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7842126">req</span><span class="op" id="7842129">,</span>&nbsp;<span class="ident" id="7842131">_</span>&nbsp;<span class="op" id="7842133">:=</span>&nbsp;<span class="ident" id="7842136">NewRequest</span><span class="op" id="7842146">(</span><span class="string" id="7842147">&#34;GET&#34;</span><span class="op" id="7842152">,</span>&nbsp;<span class="string" id="7842154">&#34;http://example.com/&#34;</span><span class="op" id="7842175">,</span>&nbsp;<span class="builtintype" id="7842177">nil</span><span class="op" id="7842180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7842184">for</span>&nbsp;<span class="ident" id="7842188">_</span><span class="op" id="7842189">,</span>&nbsp;<span class="ident" id="7842191">c</span>&nbsp;<span class="op" id="7842193">:=</span>&nbsp;<span class="keyword" id="7842196">range</span>&nbsp;<span class="ident" id="7842202">tt</span><span class="op" id="7842204">.</span><span class="ident" id="7842205">Cookies</span>&nbsp;<span class="op" id="7842213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7842218">req</span><span class="op" id="7842221">.</span><span class="ident" id="7842222">AddCookie</span><span class="op" id="7842231">(</span><span class="ident" id="7842232">c</span><span class="op" id="7842233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7842237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7842241">if</span>&nbsp;<span class="ident" id="7842244">g</span>&nbsp;<span class="op" id="7842246">:=</span>&nbsp;<span class="ident" id="7842249">req</span><span class="op" id="7842252">.</span><span class="ident" id="7842253">Header</span><span class="op" id="7842259">.</span><span class="ident" id="7842260">Get</span><span class="op" id="7842263">(</span><span class="string" id="7842264">&#34;Cookie&#34;</span><span class="op" id="7842272">)</span><span class="op" id="7842273">;</span>&nbsp;<span class="ident" id="7842275">g</span>&nbsp;<span class="op" id="7842277">!=</span>&nbsp;<span class="ident" id="7842280">tt</span><span class="op" id="7842282">.</span><span class="ident" id="7842283">Raw</span>&nbsp;<span class="op" id="7842287">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7842292">t</span><span class="op" id="7842293">.</span><span class="ident" id="7842294">Errorf</span><span class="op" id="7842300">(</span><span class="string" id="7842301">&#34;Test&nbsp;%d:\nwant:&nbsp;%s\n&nbsp;got:&nbsp;%s\n&#34;</span><span class="op" id="7842333">,</span>&nbsp;<span class="ident" id="7842335">i</span><span class="op" id="7842336">,</span>&nbsp;<span class="ident" id="7842338">tt</span><span class="op" id="7842340">.</span><span class="ident" id="7842341">Raw</span><span class="op" id="7842344">,</span>&nbsp;<span class="ident" id="7842346">g</span><span class="op" id="7842347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7842352">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7842363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7842366">}</span><br>
<span class="lineno"></span><span class="op" id="7842368">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="7842371">var</span>&nbsp;<span class="ident" id="7842375">readSetCookiesTests</span>&nbsp;<span class="op" id="7842395">=</span>&nbsp;<span class="op" id="7842397">[</span><span class="op" id="7842398">]</span><span class="keyword" id="7842399">struct</span>&nbsp;<span class="op" id="7842406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7842409">Header</span>&nbsp;&nbsp;<span class="ident" id="7842417">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7842425">Cookies</span>&nbsp;<span class="op" id="7842433">[</span><span class="op" id="7842434">]</span><span class="op" id="7842435">*</span><span class="ident" id="7842436">Cookie</span><br>
<span class="lineno"></span><span class="op" id="7842443">}</span><span class="op" id="7842444">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7842447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7842451">Header</span><span class="op" id="7842457">{</span><span class="string" id="7842458">&#34;Set-Cookie&#34;</span><span class="op" id="7842470">:</span>&nbsp;<span class="op" id="7842472">{</span><span class="string" id="7842473">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7842487">}</span><span class="op" id="7842488">}</span><span class="op" id="7842489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7842493">[</span><span class="op" id="7842494">]</span><span class="op" id="7842495">*</span><span class="ident" id="7842496">Cookie</span><span class="op" id="7842502">{</span><span class="op" id="7842503">{</span><span class="ident" id="7842504">Name</span><span class="op" id="7842508">:</span>&nbsp;<span class="string" id="7842510">&#34;Cookie-1&#34;</span><span class="op" id="7842520">,</span>&nbsp;<span class="ident" id="7842522">Value</span><span class="op" id="7842527">:</span>&nbsp;<span class="string" id="7842529">&#34;v$1&#34;</span><span class="op" id="7842534">,</span>&nbsp;<span class="ident" id="7842536">Raw</span><span class="op" id="7842539">:</span>&nbsp;<span class="string" id="7842541">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7842555">}</span><span class="op" id="7842556">}</span><span class="op" id="7842557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7842560">}</span><span class="op" id="7842561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7842564">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7842568">Header</span><span class="op" id="7842574">{</span><span class="string" id="7842575">&#34;Set-Cookie&#34;</span><span class="op" id="7842587">:</span>&nbsp;<span class="op" id="7842589">{</span><span class="string" id="7842590">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="7842689">}</span><span class="op" id="7842690">}</span><span class="op" id="7842691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7842695">[</span><span class="op" id="7842696">]</span><span class="op" id="7842697">*</span><span class="ident" id="7842698">Cookie</span><span class="op" id="7842704">{</span><span class="op" id="7842705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7842710">Name</span><span class="op" id="7842714">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7842722">&#34;NID&#34;</span><span class="op" id="7842727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7842732">Value</span><span class="op" id="7842737">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7842744">&#34;99=YsDT5i3E-CXax-&#34;</span><span class="op" id="7842763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7842768">Path</span><span class="op" id="7842772">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7842780">&#34;/&#34;</span><span class="op" id="7842783">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7842788">Domain</span><span class="op" id="7842794">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7842800">&#34;.google.ch&#34;</span><span class="op" id="7842812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7842817">HttpOnly</span><span class="op" id="7842825">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7842829">true</span><span class="op" id="7842833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7842838">Expires</span><span class="op" id="7842845">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7842850">time</span><span class="op" id="7842854">.</span><span class="ident" id="7842855">Date</span><span class="op" id="7842859">(</span><span class="num" id="7842860">2011</span><span class="op" id="7842864">,</span>&nbsp;<span class="num" id="7842866">11</span><span class="op" id="7842868">,</span>&nbsp;<span class="num" id="7842870">23</span><span class="op" id="7842872">,</span>&nbsp;<span class="num" id="7842874">1</span><span class="op" id="7842875">,</span>&nbsp;<span class="num" id="7842877">5</span><span class="op" id="7842878">,</span>&nbsp;<span class="num" id="7842880">3</span><span class="op" id="7842881">,</span>&nbsp;<span class="num" id="7842883">0</span><span class="op" id="7842884">,</span>&nbsp;<span class="ident" id="7842886">time</span><span class="op" id="7842890">.</span><span class="ident" id="7842891">UTC</span><span class="op" id="7842894">)</span><span class="op" id="7842895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7842900">RawExpires</span><span class="op" id="7842910">:</span>&nbsp;<span class="string" id="7842912">&#34;Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT&#34;</span><span class="op" id="7842943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7842948">Raw</span><span class="op" id="7842951">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7842960">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="7843059">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7843063">}</span><span class="op" id="7843064">}</span><span class="op" id="7843065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7843068">}</span><span class="op" id="7843069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7843072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843076">Header</span><span class="op" id="7843082">{</span><span class="string" id="7843083">&#34;Set-Cookie&#34;</span><span class="op" id="7843095">:</span>&nbsp;<span class="op" id="7843097">{</span><span class="string" id="7843098">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7843172">}</span><span class="op" id="7843173">}</span><span class="op" id="7843174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7843178">[</span><span class="op" id="7843179">]</span><span class="op" id="7843180">*</span><span class="ident" id="7843181">Cookie</span><span class="op" id="7843187">{</span><span class="op" id="7843188">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843193">Name</span><span class="op" id="7843197">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7843205">&#34;.ASPXAUTH&#34;</span><span class="op" id="7843216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843221">Value</span><span class="op" id="7843226">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7843233">&#34;7E3AA&#34;</span><span class="op" id="7843240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843245">Path</span><span class="op" id="7843249">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7843257">&#34;/&#34;</span><span class="op" id="7843260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843265">Expires</span><span class="op" id="7843272">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843277">time</span><span class="op" id="7843281">.</span><span class="ident" id="7843282">Date</span><span class="op" id="7843286">(</span><span class="num" id="7843287">2012</span><span class="op" id="7843291">,</span>&nbsp;<span class="num" id="7843293">3</span><span class="op" id="7843294">,</span>&nbsp;<span class="num" id="7843296">7</span><span class="op" id="7843297">,</span>&nbsp;<span class="num" id="7843299">14</span><span class="op" id="7843301">,</span>&nbsp;<span class="num" id="7843303">25</span><span class="op" id="7843305">,</span>&nbsp;<span class="num" id="7843307">6</span><span class="op" id="7843308">,</span>&nbsp;<span class="num" id="7843310">0</span><span class="op" id="7843311">,</span>&nbsp;<span class="ident" id="7843313">time</span><span class="op" id="7843317">.</span><span class="ident" id="7843318">UTC</span><span class="op" id="7843321">)</span><span class="op" id="7843322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843327">RawExpires</span><span class="op" id="7843337">:</span>&nbsp;<span class="string" id="7843339">&#34;Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT&#34;</span><span class="op" id="7843370">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843375">HttpOnly</span><span class="op" id="7843383">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7843387">true</span><span class="op" id="7843391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843396">Raw</span><span class="op" id="7843399">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7843408">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7843482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7843486">}</span><span class="op" id="7843487">}</span><span class="op" id="7843488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7843491">}</span><span class="op" id="7843492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7843495">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843499">Header</span><span class="op" id="7843505">{</span><span class="string" id="7843506">&#34;Set-Cookie&#34;</span><span class="op" id="7843518">:</span>&nbsp;<span class="op" id="7843520">{</span><span class="string" id="7843521">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7843562">}</span><span class="op" id="7843563">}</span><span class="op" id="7843564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7843568">[</span><span class="op" id="7843569">]</span><span class="op" id="7843570">*</span><span class="ident" id="7843571">Cookie</span><span class="op" id="7843577">{</span><span class="op" id="7843578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843583">Name</span><span class="op" id="7843587">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7843593">&#34;ASP.NET_SessionId&#34;</span><span class="op" id="7843612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843617">Value</span><span class="op" id="7843622">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7843627">&#34;foo&#34;</span><span class="op" id="7843632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843637">Path</span><span class="op" id="7843641">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7843647">&#34;/&#34;</span><span class="op" id="7843650">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843655">HttpOnly</span><span class="op" id="7843663">:</span>&nbsp;<span class="builtintype" id="7843665">true</span><span class="op" id="7843669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843674">Raw</span><span class="op" id="7843677">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7843684">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7843725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7843729">}</span><span class="op" id="7843730">}</span><span class="op" id="7843731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7843734">}</span><span class="op" id="7843735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7843738">//&nbsp;Make&nbsp;sure&nbsp;we&nbsp;can&nbsp;properly&nbsp;read&nbsp;back&nbsp;the&nbsp;Set-Cookie&nbsp;headers&nbsp;we&nbsp;create</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7843811">//&nbsp;for&nbsp;values&nbsp;containing&nbsp;spaces&nbsp;or&nbsp;commas:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7843855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843859">Header</span><span class="op" id="7843865">{</span><span class="string" id="7843866">&#34;Set-Cookie&#34;</span><span class="op" id="7843878">:</span>&nbsp;<span class="op" id="7843880">{</span><span class="string" id="7843881">`special-1=a&nbsp;z`</span><span class="op" id="7843896">}</span><span class="op" id="7843897">}</span><span class="op" id="7843898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7843902">[</span><span class="op" id="7843903">]</span><span class="op" id="7843904">*</span><span class="ident" id="7843905">Cookie</span><span class="op" id="7843911">{</span><span class="op" id="7843912">{</span><span class="ident" id="7843913">Name</span><span class="op" id="7843917">:</span>&nbsp;<span class="string" id="7843919">&#34;special-1&#34;</span><span class="op" id="7843930">,</span>&nbsp;<span class="ident" id="7843932">Value</span><span class="op" id="7843937">:</span>&nbsp;<span class="string" id="7843939">&#34;a&nbsp;z&#34;</span><span class="op" id="7843944">,</span>&nbsp;<span class="ident" id="7843946">Raw</span><span class="op" id="7843949">:</span>&nbsp;<span class="string" id="7843951">`special-1=a&nbsp;z`</span><span class="op" id="7843966">}</span><span class="op" id="7843967">}</span><span class="op" id="7843968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7843971">}</span><span class="op" id="7843972">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7843975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7843979">Header</span><span class="op" id="7843985">{</span><span class="string" id="7843986">&#34;Set-Cookie&#34;</span><span class="op" id="7843998">:</span>&nbsp;<span class="op" id="7844000">{</span><span class="string" id="7844001">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7844017">}</span><span class="op" id="7844018">}</span><span class="op" id="7844019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844023">[</span><span class="op" id="7844024">]</span><span class="op" id="7844025">*</span><span class="ident" id="7844026">Cookie</span><span class="op" id="7844032">{</span><span class="op" id="7844033">{</span><span class="ident" id="7844034">Name</span><span class="op" id="7844038">:</span>&nbsp;<span class="string" id="7844040">&#34;special-2&#34;</span><span class="op" id="7844051">,</span>&nbsp;<span class="ident" id="7844053">Value</span><span class="op" id="7844058">:</span>&nbsp;<span class="string" id="7844060">&#34;&nbsp;z&#34;</span><span class="op" id="7844064">,</span>&nbsp;<span class="ident" id="7844066">Raw</span><span class="op" id="7844069">:</span>&nbsp;<span class="string" id="7844071">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7844087">}</span><span class="op" id="7844088">}</span><span class="op" id="7844089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844092">}</span><span class="op" id="7844093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844096">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7844100">Header</span><span class="op" id="7844106">{</span><span class="string" id="7844107">&#34;Set-Cookie&#34;</span><span class="op" id="7844119">:</span>&nbsp;<span class="op" id="7844121">{</span><span class="string" id="7844122">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7844138">}</span><span class="op" id="7844139">}</span><span class="op" id="7844140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844144">[</span><span class="op" id="7844145">]</span><span class="op" id="7844146">*</span><span class="ident" id="7844147">Cookie</span><span class="op" id="7844153">{</span><span class="op" id="7844154">{</span><span class="ident" id="7844155">Name</span><span class="op" id="7844159">:</span>&nbsp;<span class="string" id="7844161">&#34;special-3&#34;</span><span class="op" id="7844172">,</span>&nbsp;<span class="ident" id="7844174">Value</span><span class="op" id="7844179">:</span>&nbsp;<span class="string" id="7844181">&#34;a&nbsp;&#34;</span><span class="op" id="7844185">,</span>&nbsp;<span class="ident" id="7844187">Raw</span><span class="op" id="7844190">:</span>&nbsp;<span class="string" id="7844192">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7844208">}</span><span class="op" id="7844209">}</span><span class="op" id="7844210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844213">}</span><span class="op" id="7844214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7844221">Header</span><span class="op" id="7844227">{</span><span class="string" id="7844228">&#34;Set-Cookie&#34;</span><span class="op" id="7844240">:</span>&nbsp;<span class="op" id="7844242">{</span><span class="string" id="7844243">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7844258">}</span><span class="op" id="7844259">}</span><span class="op" id="7844260">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844264">[</span><span class="op" id="7844265">]</span><span class="op" id="7844266">*</span><span class="ident" id="7844267">Cookie</span><span class="op" id="7844273">{</span><span class="op" id="7844274">{</span><span class="ident" id="7844275">Name</span><span class="op" id="7844279">:</span>&nbsp;<span class="string" id="7844281">&#34;special-4&#34;</span><span class="op" id="7844292">,</span>&nbsp;<span class="ident" id="7844294">Value</span><span class="op" id="7844299">:</span>&nbsp;<span class="string" id="7844301">&#34;&nbsp;&#34;</span><span class="op" id="7844304">,</span>&nbsp;<span class="ident" id="7844306">Raw</span><span class="op" id="7844309">:</span>&nbsp;<span class="string" id="7844311">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7844326">}</span><span class="op" id="7844327">}</span><span class="op" id="7844328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844331">}</span><span class="op" id="7844332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7844339">Header</span><span class="op" id="7844345">{</span><span class="string" id="7844346">&#34;Set-Cookie&#34;</span><span class="op" id="7844358">:</span>&nbsp;<span class="op" id="7844360">{</span><span class="string" id="7844361">`special-5=a,z`</span><span class="op" id="7844376">}</span><span class="op" id="7844377">}</span><span class="op" id="7844378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844382">[</span><span class="op" id="7844383">]</span><span class="op" id="7844384">*</span><span class="ident" id="7844385">Cookie</span><span class="op" id="7844391">{</span><span class="op" id="7844392">{</span><span class="ident" id="7844393">Name</span><span class="op" id="7844397">:</span>&nbsp;<span class="string" id="7844399">&#34;special-5&#34;</span><span class="op" id="7844410">,</span>&nbsp;<span class="ident" id="7844412">Value</span><span class="op" id="7844417">:</span>&nbsp;<span class="string" id="7844419">&#34;a,z&#34;</span><span class="op" id="7844424">,</span>&nbsp;<span class="ident" id="7844426">Raw</span><span class="op" id="7844429">:</span>&nbsp;<span class="string" id="7844431">`special-5=a,z`</span><span class="op" id="7844446">}</span><span class="op" id="7844447">}</span><span class="op" id="7844448">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844451">}</span><span class="op" id="7844452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7844459">Header</span><span class="op" id="7844465">{</span><span class="string" id="7844466">&#34;Set-Cookie&#34;</span><span class="op" id="7844478">:</span>&nbsp;<span class="op" id="7844480">{</span><span class="string" id="7844481">`special-6=&#34;,z&#34;`</span><span class="op" id="7844497">}</span><span class="op" id="7844498">}</span><span class="op" id="7844499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844503">[</span><span class="op" id="7844504">]</span><span class="op" id="7844505">*</span><span class="ident" id="7844506">Cookie</span><span class="op" id="7844512">{</span><span class="op" id="7844513">{</span><span class="ident" id="7844514">Name</span><span class="op" id="7844518">:</span>&nbsp;<span class="string" id="7844520">&#34;special-6&#34;</span><span class="op" id="7844531">,</span>&nbsp;<span class="ident" id="7844533">Value</span><span class="op" id="7844538">:</span>&nbsp;<span class="string" id="7844540">&#34;,z&#34;</span><span class="op" id="7844544">,</span>&nbsp;<span class="ident" id="7844546">Raw</span><span class="op" id="7844549">:</span>&nbsp;<span class="string" id="7844551">`special-6=&#34;,z&#34;`</span><span class="op" id="7844567">}</span><span class="op" id="7844568">}</span><span class="op" id="7844569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844572">}</span><span class="op" id="7844573">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7844580">Header</span><span class="op" id="7844586">{</span><span class="string" id="7844587">&#34;Set-Cookie&#34;</span><span class="op" id="7844599">:</span>&nbsp;<span class="op" id="7844601">{</span><span class="string" id="7844602">`special-7=a,`</span><span class="op" id="7844616">}</span><span class="op" id="7844617">}</span><span class="op" id="7844618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844622">[</span><span class="op" id="7844623">]</span><span class="op" id="7844624">*</span><span class="ident" id="7844625">Cookie</span><span class="op" id="7844631">{</span><span class="op" id="7844632">{</span><span class="ident" id="7844633">Name</span><span class="op" id="7844637">:</span>&nbsp;<span class="string" id="7844639">&#34;special-7&#34;</span><span class="op" id="7844650">,</span>&nbsp;<span class="ident" id="7844652">Value</span><span class="op" id="7844657">:</span>&nbsp;<span class="string" id="7844659">&#34;a,&#34;</span><span class="op" id="7844663">,</span>&nbsp;<span class="ident" id="7844665">Raw</span><span class="op" id="7844668">:</span>&nbsp;<span class="string" id="7844670">`special-7=a,`</span><span class="op" id="7844684">}</span><span class="op" id="7844685">}</span><span class="op" id="7844686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844689">}</span><span class="op" id="7844690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844693">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7844697">Header</span><span class="op" id="7844703">{</span><span class="string" id="7844704">&#34;Set-Cookie&#34;</span><span class="op" id="7844716">:</span>&nbsp;<span class="op" id="7844718">{</span><span class="string" id="7844719">`special-8=&#34;,&#34;`</span><span class="op" id="7844734">}</span><span class="op" id="7844735">}</span><span class="op" id="7844736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844740">[</span><span class="op" id="7844741">]</span><span class="op" id="7844742">*</span><span class="ident" id="7844743">Cookie</span><span class="op" id="7844749">{</span><span class="op" id="7844750">{</span><span class="ident" id="7844751">Name</span><span class="op" id="7844755">:</span>&nbsp;<span class="string" id="7844757">&#34;special-8&#34;</span><span class="op" id="7844768">,</span>&nbsp;<span class="ident" id="7844770">Value</span><span class="op" id="7844775">:</span>&nbsp;<span class="string" id="7844777">&#34;,&#34;</span><span class="op" id="7844780">,</span>&nbsp;<span class="ident" id="7844782">Raw</span><span class="op" id="7844785">:</span>&nbsp;<span class="string" id="7844787">`special-8=&#34;,&#34;`</span><span class="op" id="7844802">}</span><span class="op" id="7844803">}</span><span class="op" id="7844804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7844807">}</span><span class="op" id="7844808">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7844812">//&nbsp;TODO(bradfitz):&nbsp;users&nbsp;have&nbsp;reported&nbsp;seeing&nbsp;this&nbsp;in&nbsp;the</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7844871">//&nbsp;wild,&nbsp;but&nbsp;do&nbsp;browsers&nbsp;handle&nbsp;it?&nbsp;RFC&nbsp;6265&nbsp;just&nbsp;says&nbsp;&#34;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7844934">//&nbsp;do&nbsp;that&#34;&nbsp;(section&nbsp;3)&nbsp;and&nbsp;then&nbsp;never&nbsp;mentions&nbsp;header&nbsp;folding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7844998">//&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7845009">//&nbsp;Header{&#34;Set-Cookie&#34;:&nbsp;{&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly,&nbsp;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;}},</span><br>
<span class="lineno"></span><span class="op" id="7845153">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="7845156">func</span>&nbsp;<span class="ident" id="7845161">toJSON</span><span class="op" id="7845167">(</span><span class="ident" id="7845168">v</span>&nbsp;<span class="keyword" id="7845170">interface</span><span class="op" id="7845179">{</span><span class="op" id="7845180">}</span><span class="op" id="7845181">)</span>&nbsp;<span class="builtintype" id="7845183">string</span>&nbsp;<span class="op" id="7845190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845193">b</span><span class="op" id="7845194">,</span>&nbsp;<span class="ident" id="7845196">err</span>&nbsp;<span class="op" id="7845200">:=</span>&nbsp;<span class="ident" id="7845203">json</span><span class="op" id="7845207">.</span><span class="ident" id="7845208">Marshal</span><span class="op" id="7845215">(</span><span class="ident" id="7845216">v</span><span class="op" id="7845217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7845220">if</span>&nbsp;<span class="ident" id="7845223">err</span>&nbsp;<span class="op" id="7845227">!=</span>&nbsp;<span class="builtintype" id="7845230">nil</span>&nbsp;<span class="op" id="7845234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7845238">return</span>&nbsp;<span class="ident" id="7845245">fmt</span><span class="op" id="7845248">.</span><span class="ident" id="7845249">Sprintf</span><span class="op" id="7845256">(</span><span class="string" id="7845257">&#34;%#v&#34;</span><span class="op" id="7845262">,</span>&nbsp;<span class="ident" id="7845264">v</span><span class="op" id="7845265">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7845271">return</span>&nbsp;<span class="builtintype" id="7845278">string</span><span class="op" id="7845284">(</span><span class="ident" id="7845285">b</span><span class="op" id="7845286">)</span><br>
<span class="lineno"></span><span class="op" id="7845288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7845291">func</span>&nbsp;<span class="ident" id="7845296">TestReadSetCookies</span><span class="op" id="7845314">(</span><span class="ident" id="7845315">t</span>&nbsp;<span class="op" id="7845317">*</span><span class="ident" id="7845318">testing</span><span class="op" id="7845325">.</span><span class="ident" id="7845326">T</span><span class="op" id="7845327">)</span>&nbsp;<span class="op" id="7845329">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7845332">for</span>&nbsp;<span class="ident" id="7845336">i</span><span class="op" id="7845337">,</span>&nbsp;<span class="ident" id="7845339">tt</span>&nbsp;<span class="op" id="7845342">:=</span>&nbsp;<span class="keyword" id="7845345">range</span>&nbsp;<span class="ident" id="7845351">readSetCookiesTests</span>&nbsp;<span class="op" id="7845371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7845375">for</span>&nbsp;<span class="ident" id="7845379">n</span>&nbsp;<span class="op" id="7845381">:=</span>&nbsp;<span class="num" id="7845384">0</span><span class="op" id="7845385">;</span>&nbsp;<span class="ident" id="7845387">n</span>&nbsp;<span class="op" id="7845389">&lt;</span>&nbsp;<span class="num" id="7845391">2</span><span class="op" id="7845392">;</span>&nbsp;<span class="ident" id="7845394">n</span><span class="op" id="7845395">++</span>&nbsp;<span class="op" id="7845398">{</span>&nbsp;<span class="comment" id="7845400">//&nbsp;to&nbsp;verify&nbsp;readSetCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845456">c</span>&nbsp;<span class="op" id="7845458">:=</span>&nbsp;<span class="ident" id="7845461">readSetCookies</span><span class="op" id="7845475">(</span><span class="ident" id="7845476">tt</span><span class="op" id="7845478">.</span><span class="ident" id="7845479">Header</span><span class="op" id="7845485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7845490">if</span>&nbsp;<span class="op" id="7845493">!</span><span class="ident" id="7845494">reflect</span><span class="op" id="7845501">.</span><span class="ident" id="7845502">DeepEqual</span><span class="op" id="7845511">(</span><span class="ident" id="7845512">c</span><span class="op" id="7845513">,</span>&nbsp;<span class="ident" id="7845515">tt</span><span class="op" id="7845517">.</span><span class="ident" id="7845518">Cookies</span><span class="op" id="7845525">)</span>&nbsp;<span class="op" id="7845527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845533">t</span><span class="op" id="7845534">.</span><span class="ident" id="7845535">Errorf</span><span class="op" id="7845541">(</span><span class="string" id="7845542">&#34;#%d&nbsp;readSetCookies:&nbsp;have\n%s\nwant\n%s\n&#34;</span><span class="op" id="7845584">,</span>&nbsp;<span class="ident" id="7845586">i</span><span class="op" id="7845587">,</span>&nbsp;<span class="ident" id="7845589">toJSON</span><span class="op" id="7845595">(</span><span class="ident" id="7845596">c</span><span class="op" id="7845597">)</span><span class="op" id="7845598">,</span>&nbsp;<span class="ident" id="7845600">toJSON</span><span class="op" id="7845606">(</span><span class="ident" id="7845607">tt</span><span class="op" id="7845609">.</span><span class="ident" id="7845610">Cookies</span><span class="op" id="7845617">)</span><span class="op" id="7845618">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7845624">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845643">}</span><br>
<span class="lineno"></span><span class="op" id="7845645">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="7845648">var</span>&nbsp;<span class="ident" id="7845652">readCookiesTests</span>&nbsp;<span class="op" id="7845669">=</span>&nbsp;<span class="op" id="7845671">[</span><span class="op" id="7845672">]</span><span class="keyword" id="7845673">struct</span>&nbsp;<span class="op" id="7845680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845683">Header</span>&nbsp;&nbsp;<span class="ident" id="7845691">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845699">Filter</span>&nbsp;&nbsp;<span class="builtintype" id="7845707">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845715">Cookies</span>&nbsp;<span class="op" id="7845723">[</span><span class="op" id="7845724">]</span><span class="op" id="7845725">*</span><span class="ident" id="7845726">Cookie</span><br>
<span class="lineno">285</span><span class="op" id="7845733">}</span><span class="op" id="7845734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845741">Header</span><span class="op" id="7845747">{</span><span class="string" id="7845748">&#34;Cookie&#34;</span><span class="op" id="7845756">:</span>&nbsp;<span class="op" id="7845758">{</span><span class="string" id="7845759">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7845773">,</span>&nbsp;<span class="string" id="7845775">&#34;c2=v2&#34;</span><span class="op" id="7845782">}</span><span class="op" id="7845783">}</span><span class="op" id="7845784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7845788">&#34;&#34;</span><span class="op" id="7845790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845794">[</span><span class="op" id="7845795">]</span><span class="op" id="7845796">*</span><span class="ident" id="7845797">Cookie</span><span class="op" id="7845803">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845808">{</span><span class="ident" id="7845809">Name</span><span class="op" id="7845813">:</span>&nbsp;<span class="string" id="7845815">&#34;Cookie-1&#34;</span><span class="op" id="7845825">,</span>&nbsp;<span class="ident" id="7845827">Value</span><span class="op" id="7845832">:</span>&nbsp;<span class="string" id="7845834">&#34;v$1&#34;</span><span class="op" id="7845839">}</span><span class="op" id="7845840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845845">{</span><span class="ident" id="7845846">Name</span><span class="op" id="7845850">:</span>&nbsp;<span class="string" id="7845852">&#34;c2&#34;</span><span class="op" id="7845856">,</span>&nbsp;<span class="ident" id="7845858">Value</span><span class="op" id="7845863">:</span>&nbsp;<span class="string" id="7845865">&#34;v2&#34;</span><span class="op" id="7845869">}</span><span class="op" id="7845870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845874">}</span><span class="op" id="7845875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845878">}</span><span class="op" id="7845879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845882">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845886">Header</span><span class="op" id="7845892">{</span><span class="string" id="7845893">&#34;Cookie&#34;</span><span class="op" id="7845901">:</span>&nbsp;<span class="op" id="7845903">{</span><span class="string" id="7845904">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7845918">,</span>&nbsp;<span class="string" id="7845920">&#34;c2=v2&#34;</span><span class="op" id="7845927">}</span><span class="op" id="7845928">}</span><span class="op" id="7845929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7845933">&#34;c2&#34;</span><span class="op" id="7845937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845941">[</span><span class="op" id="7845942">]</span><span class="op" id="7845943">*</span><span class="ident" id="7845944">Cookie</span><span class="op" id="7845950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845955">{</span><span class="ident" id="7845956">Name</span><span class="op" id="7845960">:</span>&nbsp;<span class="string" id="7845962">&#34;c2&#34;</span><span class="op" id="7845966">,</span>&nbsp;<span class="ident" id="7845968">Value</span><span class="op" id="7845973">:</span>&nbsp;<span class="string" id="7845975">&#34;v2&#34;</span><span class="op" id="7845979">}</span><span class="op" id="7845980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845984">}</span><span class="op" id="7845985">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845988">}</span><span class="op" id="7845989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7845992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7845996">Header</span><span class="op" id="7846002">{</span><span class="string" id="7846003">&#34;Cookie&#34;</span><span class="op" id="7846011">:</span>&nbsp;<span class="op" id="7846013">{</span><span class="string" id="7846014">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="7846035">}</span><span class="op" id="7846036">}</span><span class="op" id="7846037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7846041">&#34;&#34;</span><span class="op" id="7846043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846047">[</span><span class="op" id="7846048">]</span><span class="op" id="7846049">*</span><span class="ident" id="7846050">Cookie</span><span class="op" id="7846056">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846061">{</span><span class="ident" id="7846062">Name</span><span class="op" id="7846066">:</span>&nbsp;<span class="string" id="7846068">&#34;Cookie-1&#34;</span><span class="op" id="7846078">,</span>&nbsp;<span class="ident" id="7846080">Value</span><span class="op" id="7846085">:</span>&nbsp;<span class="string" id="7846087">&#34;v$1&#34;</span><span class="op" id="7846092">}</span><span class="op" id="7846093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846098">{</span><span class="ident" id="7846099">Name</span><span class="op" id="7846103">:</span>&nbsp;<span class="string" id="7846105">&#34;c2&#34;</span><span class="op" id="7846109">,</span>&nbsp;<span class="ident" id="7846111">Value</span><span class="op" id="7846116">:</span>&nbsp;<span class="string" id="7846118">&#34;v2&#34;</span><span class="op" id="7846122">}</span><span class="op" id="7846123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846127">}</span><span class="op" id="7846128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846131">}</span><span class="op" id="7846132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846135">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846139">Header</span><span class="op" id="7846145">{</span><span class="string" id="7846146">&#34;Cookie&#34;</span><span class="op" id="7846154">:</span>&nbsp;<span class="op" id="7846156">{</span><span class="string" id="7846157">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="7846178">}</span><span class="op" id="7846179">}</span><span class="op" id="7846180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7846184">&#34;c2&#34;</span><span class="op" id="7846188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846192">[</span><span class="op" id="7846193">]</span><span class="op" id="7846194">*</span><span class="ident" id="7846195">Cookie</span><span class="op" id="7846201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846206">{</span><span class="ident" id="7846207">Name</span><span class="op" id="7846211">:</span>&nbsp;<span class="string" id="7846213">&#34;c2&#34;</span><span class="op" id="7846217">,</span>&nbsp;<span class="ident" id="7846219">Value</span><span class="op" id="7846224">:</span>&nbsp;<span class="string" id="7846226">&#34;v2&#34;</span><span class="op" id="7846230">}</span><span class="op" id="7846231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846235">}</span><span class="op" id="7846236">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846239">}</span><span class="op" id="7846240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846247">Header</span><span class="op" id="7846253">{</span><span class="string" id="7846254">&#34;Cookie&#34;</span><span class="op" id="7846262">:</span>&nbsp;<span class="op" id="7846264">{</span><span class="string" id="7846265">`Cookie-1=&#34;v$1&#34;;&nbsp;c2=&#34;v2&#34;`</span><span class="op" id="7846290">}</span><span class="op" id="7846291">}</span><span class="op" id="7846292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7846296">&#34;&#34;</span><span class="op" id="7846298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846302">[</span><span class="op" id="7846303">]</span><span class="op" id="7846304">*</span><span class="ident" id="7846305">Cookie</span><span class="op" id="7846311">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846316">{</span><span class="ident" id="7846317">Name</span><span class="op" id="7846321">:</span>&nbsp;<span class="string" id="7846323">&#34;Cookie-1&#34;</span><span class="op" id="7846333">,</span>&nbsp;<span class="ident" id="7846335">Value</span><span class="op" id="7846340">:</span>&nbsp;<span class="string" id="7846342">&#34;v$1&#34;</span><span class="op" id="7846347">}</span><span class="op" id="7846348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846353">{</span><span class="ident" id="7846354">Name</span><span class="op" id="7846358">:</span>&nbsp;<span class="string" id="7846360">&#34;c2&#34;</span><span class="op" id="7846364">,</span>&nbsp;<span class="ident" id="7846366">Value</span><span class="op" id="7846371">:</span>&nbsp;<span class="string" id="7846373">&#34;v2&#34;</span><span class="op" id="7846377">}</span><span class="op" id="7846378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846382">}</span><span class="op" id="7846383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846386">}</span><span class="op" id="7846387">,</span><br>
<span class="lineno"></span><span class="op" id="7846389">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="7846392">func</span>&nbsp;<span class="ident" id="7846397">TestReadCookies</span><span class="op" id="7846412">(</span><span class="ident" id="7846413">t</span>&nbsp;<span class="op" id="7846415">*</span><span class="ident" id="7846416">testing</span><span class="op" id="7846423">.</span><span class="ident" id="7846424">T</span><span class="op" id="7846425">)</span>&nbsp;<span class="op" id="7846427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846430">for</span>&nbsp;<span class="ident" id="7846434">i</span><span class="op" id="7846435">,</span>&nbsp;<span class="ident" id="7846437">tt</span>&nbsp;<span class="op" id="7846440">:=</span>&nbsp;<span class="keyword" id="7846443">range</span>&nbsp;<span class="ident" id="7846449">readCookiesTests</span>&nbsp;<span class="op" id="7846466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846470">for</span>&nbsp;<span class="ident" id="7846474">n</span>&nbsp;<span class="op" id="7846476">:=</span>&nbsp;<span class="num" id="7846479">0</span><span class="op" id="7846480">;</span>&nbsp;<span class="ident" id="7846482">n</span>&nbsp;<span class="op" id="7846484">&lt;</span>&nbsp;<span class="num" id="7846486">2</span><span class="op" id="7846487">;</span>&nbsp;<span class="ident" id="7846489">n</span><span class="op" id="7846490">++</span>&nbsp;<span class="op" id="7846493">{</span>&nbsp;<span class="comment" id="7846495">//&nbsp;to&nbsp;verify&nbsp;readCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846548">c</span>&nbsp;<span class="op" id="7846550">:=</span>&nbsp;<span class="ident" id="7846553">readCookies</span><span class="op" id="7846564">(</span><span class="ident" id="7846565">tt</span><span class="op" id="7846567">.</span><span class="ident" id="7846568">Header</span><span class="op" id="7846574">,</span>&nbsp;<span class="ident" id="7846576">tt</span><span class="op" id="7846578">.</span><span class="ident" id="7846579">Filter</span><span class="op" id="7846585">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846590">if</span>&nbsp;<span class="op" id="7846593">!</span><span class="ident" id="7846594">reflect</span><span class="op" id="7846601">.</span><span class="ident" id="7846602">DeepEqual</span><span class="op" id="7846611">(</span><span class="ident" id="7846612">c</span><span class="op" id="7846613">,</span>&nbsp;<span class="ident" id="7846615">tt</span><span class="op" id="7846617">.</span><span class="ident" id="7846618">Cookies</span><span class="op" id="7846625">)</span>&nbsp;<span class="op" id="7846627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846633">t</span><span class="op" id="7846634">.</span><span class="ident" id="7846635">Errorf</span><span class="op" id="7846641">(</span><span class="string" id="7846642">&#34;#%d&nbsp;readCookies:\nhave:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="7846682">,</span>&nbsp;<span class="ident" id="7846684">i</span><span class="op" id="7846685">,</span>&nbsp;<span class="ident" id="7846687">toJSON</span><span class="op" id="7846693">(</span><span class="ident" id="7846694">c</span><span class="op" id="7846695">)</span><span class="op" id="7846696">,</span>&nbsp;<span class="ident" id="7846698">toJSON</span><span class="op" id="7846704">(</span><span class="ident" id="7846705">tt</span><span class="op" id="7846707">.</span><span class="ident" id="7846708">Cookies</span><span class="op" id="7846715">)</span><span class="op" id="7846716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7846722">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846738">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7846741">}</span><br>
<span class="lineno"></span><span class="op" id="7846743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7846746">func</span>&nbsp;<span class="ident" id="7846751">TestSetCookieDoubleQuotes</span><span class="op" id="7846776">(</span><span class="ident" id="7846777">t</span>&nbsp;<span class="op" id="7846779">*</span><span class="ident" id="7846780">testing</span><span class="op" id="7846787">.</span><span class="ident" id="7846788">T</span><span class="op" id="7846789">)</span>&nbsp;<span class="op" id="7846791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846794">res</span>&nbsp;<span class="op" id="7846798">:=</span>&nbsp;<span class="op" id="7846801">&amp;</span><span class="ident" id="7846802">Response</span><span class="op" id="7846810">{</span><span class="ident" id="7846811">Header</span><span class="op" id="7846817">:</span>&nbsp;<span class="ident" id="7846819">Header</span><span class="op" id="7846825">{</span><span class="op" id="7846826">}</span><span class="op" id="7846827">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846830">res</span><span class="op" id="7846833">.</span><span class="ident" id="7846834">Header</span><span class="op" id="7846840">.</span><span class="ident" id="7846841">Add</span><span class="op" id="7846844">(</span><span class="string" id="7846845">&#34;Set-Cookie&#34;</span><span class="op" id="7846857">,</span>&nbsp;<span class="string" id="7846859">`quoted0=none;&nbsp;max-age=30`</span><span class="op" id="7846885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846888">res</span><span class="op" id="7846891">.</span><span class="ident" id="7846892">Header</span><span class="op" id="7846898">.</span><span class="ident" id="7846899">Add</span><span class="op" id="7846902">(</span><span class="string" id="7846903">&#34;Set-Cookie&#34;</span><span class="op" id="7846915">,</span>&nbsp;<span class="string" id="7846917">`quoted1=&#34;cookieValue&#34;;&nbsp;max-age=31`</span><span class="op" id="7846952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7846955">res</span><span class="op" id="7846958">.</span><span class="ident" id="7846959">Header</span><span class="op" id="7846965">.</span><span class="ident" id="7846966">Add</span><span class="op" id="7846969">(</span><span class="string" id="7846970">&#34;Set-Cookie&#34;</span><span class="op" id="7846982">,</span>&nbsp;<span class="string" id="7846984">`quoted2=cookieAV;&nbsp;max-age=&#34;32&#34;`</span><span class="op" id="7847016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847019">res</span><span class="op" id="7847022">.</span><span class="ident" id="7847023">Header</span><span class="op" id="7847029">.</span><span class="ident" id="7847030">Add</span><span class="op" id="7847033">(</span><span class="string" id="7847034">&#34;Set-Cookie&#34;</span><span class="op" id="7847046">,</span>&nbsp;<span class="string" id="7847048">`quoted3=&#34;both&#34;;&nbsp;max-age=&#34;33&#34;`</span><span class="op" id="7847078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847081">got</span>&nbsp;<span class="op" id="7847085">:=</span>&nbsp;<span class="ident" id="7847088">res</span><span class="op" id="7847091">.</span><span class="ident" id="7847092">Cookies</span><span class="op" id="7847099">(</span><span class="op" id="7847100">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847103">want</span>&nbsp;<span class="op" id="7847108">:=</span>&nbsp;<span class="op" id="7847111">[</span><span class="op" id="7847112">]</span><span class="op" id="7847113">*</span><span class="ident" id="7847114">Cookie</span><span class="op" id="7847120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847124">{</span><span class="ident" id="7847125">Name</span><span class="op" id="7847129">:</span>&nbsp;<span class="string" id="7847131">&#34;quoted0&#34;</span><span class="op" id="7847140">,</span>&nbsp;<span class="ident" id="7847142">Value</span><span class="op" id="7847147">:</span>&nbsp;<span class="string" id="7847149">&#34;none&#34;</span><span class="op" id="7847155">,</span>&nbsp;<span class="ident" id="7847157">MaxAge</span><span class="op" id="7847163">:</span>&nbsp;<span class="num" id="7847165">30</span><span class="op" id="7847167">}</span><span class="op" id="7847168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847172">{</span><span class="ident" id="7847173">Name</span><span class="op" id="7847177">:</span>&nbsp;<span class="string" id="7847179">&#34;quoted1&#34;</span><span class="op" id="7847188">,</span>&nbsp;<span class="ident" id="7847190">Value</span><span class="op" id="7847195">:</span>&nbsp;<span class="string" id="7847197">&#34;cookieValue&#34;</span><span class="op" id="7847210">,</span>&nbsp;<span class="ident" id="7847212">MaxAge</span><span class="op" id="7847218">:</span>&nbsp;<span class="num" id="7847220">31</span><span class="op" id="7847222">}</span><span class="op" id="7847223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847227">{</span><span class="ident" id="7847228">Name</span><span class="op" id="7847232">:</span>&nbsp;<span class="string" id="7847234">&#34;quoted2&#34;</span><span class="op" id="7847243">,</span>&nbsp;<span class="ident" id="7847245">Value</span><span class="op" id="7847250">:</span>&nbsp;<span class="string" id="7847252">&#34;cookieAV&#34;</span><span class="op" id="7847262">}</span><span class="op" id="7847263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847267">{</span><span class="ident" id="7847268">Name</span><span class="op" id="7847272">:</span>&nbsp;<span class="string" id="7847274">&#34;quoted3&#34;</span><span class="op" id="7847283">,</span>&nbsp;<span class="ident" id="7847285">Value</span><span class="op" id="7847290">:</span>&nbsp;<span class="string" id="7847292">&#34;both&#34;</span><span class="op" id="7847298">}</span><span class="op" id="7847299">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847305">if</span>&nbsp;<span class="builtinfunc" id="7847308">len</span><span class="op" id="7847311">(</span><span class="ident" id="7847312">got</span><span class="op" id="7847315">)</span>&nbsp;<span class="op" id="7847317">!=</span>&nbsp;<span class="builtinfunc" id="7847320">len</span><span class="op" id="7847323">(</span><span class="ident" id="7847324">want</span><span class="op" id="7847328">)</span>&nbsp;<span class="op" id="7847330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847334">t</span><span class="op" id="7847335">.</span><span class="ident" id="7847336">Fatal</span><span class="op" id="7847341">(</span><span class="string" id="7847342">&#34;got&nbsp;%d&nbsp;cookies,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7847367">,</span>&nbsp;<span class="builtinfunc" id="7847369">len</span><span class="op" id="7847372">(</span><span class="ident" id="7847373">got</span><span class="op" id="7847376">)</span><span class="op" id="7847377">,</span>&nbsp;<span class="builtinfunc" id="7847379">len</span><span class="op" id="7847382">(</span><span class="ident" id="7847383">want</span><span class="op" id="7847387">)</span><span class="op" id="7847388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847394">for</span>&nbsp;<span class="ident" id="7847398">i</span><span class="op" id="7847399">,</span>&nbsp;<span class="ident" id="7847401">w</span>&nbsp;<span class="op" id="7847403">:=</span>&nbsp;<span class="keyword" id="7847406">range</span>&nbsp;<span class="ident" id="7847412">want</span>&nbsp;<span class="op" id="7847417">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847421">g</span>&nbsp;<span class="op" id="7847423">:=</span>&nbsp;<span class="ident" id="7847426">got</span><span class="op" id="7847429">[</span><span class="ident" id="7847430">i</span><span class="op" id="7847431">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847435">if</span>&nbsp;<span class="ident" id="7847438">g</span><span class="op" id="7847439">.</span><span class="ident" id="7847440">Name</span>&nbsp;<span class="op" id="7847445">!=</span>&nbsp;<span class="ident" id="7847448">w</span><span class="op" id="7847449">.</span><span class="ident" id="7847450">Name</span>&nbsp;<span class="op" id="7847455">||</span>&nbsp;<span class="ident" id="7847458">g</span><span class="op" id="7847459">.</span><span class="ident" id="7847460">Value</span>&nbsp;<span class="op" id="7847466">!=</span>&nbsp;<span class="ident" id="7847469">w</span><span class="op" id="7847470">.</span><span class="ident" id="7847471">Value</span>&nbsp;<span class="op" id="7847477">||</span>&nbsp;<span class="ident" id="7847480">g</span><span class="op" id="7847481">.</span><span class="ident" id="7847482">MaxAge</span>&nbsp;<span class="op" id="7847489">!=</span>&nbsp;<span class="ident" id="7847492">w</span><span class="op" id="7847493">.</span><span class="ident" id="7847494">MaxAge</span>&nbsp;<span class="op" id="7847501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847506">t</span><span class="op" id="7847507">.</span><span class="ident" id="7847508">Errorf</span><span class="op" id="7847514">(</span><span class="string" id="7847515">&#34;cookie&nbsp;#%d:\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="7847546">,</span>&nbsp;<span class="ident" id="7847548">i</span><span class="op" id="7847549">,</span>&nbsp;<span class="ident" id="7847551">g</span><span class="op" id="7847552">,</span>&nbsp;<span class="ident" id="7847554">w</span><span class="op" id="7847555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847562">}</span><br>
<span class="lineno">360</span><span class="op" id="7847564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7847567">func</span>&nbsp;<span class="ident" id="7847572">TestCookieSanitizeValue</span><span class="op" id="7847595">(</span><span class="ident" id="7847596">t</span>&nbsp;<span class="op" id="7847598">*</span><span class="ident" id="7847599">testing</span><span class="op" id="7847606">.</span><span class="ident" id="7847607">T</span><span class="op" id="7847608">)</span>&nbsp;<span class="op" id="7847610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847613">defer</span>&nbsp;<span class="ident" id="7847619">log</span><span class="op" id="7847622">.</span><span class="ident" id="7847623">SetOutput</span><span class="op" id="7847632">(</span><span class="ident" id="7847633">os</span><span class="op" id="7847635">.</span><span class="ident" id="7847636">Stderr</span><span class="op" id="7847642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847645">var</span>&nbsp;<span class="ident" id="7847649">logbuf</span>&nbsp;<span class="ident" id="7847656">bytes</span><span class="op" id="7847661">.</span><span class="ident" id="7847662">Buffer</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847670">log</span><span class="op" id="7847673">.</span><span class="ident" id="7847674">SetOutput</span><span class="op" id="7847683">(</span><span class="op" id="7847684">&amp;</span><span class="ident" id="7847685">logbuf</span><span class="op" id="7847691">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847695">tests</span>&nbsp;<span class="op" id="7847701">:=</span>&nbsp;<span class="op" id="7847704">[</span><span class="op" id="7847705">]</span><span class="keyword" id="7847706">struct</span>&nbsp;<span class="op" id="7847713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7847717">in</span><span class="op" id="7847719">,</span>&nbsp;<span class="ident" id="7847721">want</span>&nbsp;<span class="builtintype" id="7847726">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847734">}</span><span class="op" id="7847735">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847739">{</span><span class="string" id="7847740">&#34;foo&#34;</span><span class="op" id="7847745">,</span>&nbsp;<span class="string" id="7847747">&#34;foo&#34;</span><span class="op" id="7847752">}</span><span class="op" id="7847753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847757">{</span><span class="string" id="7847758">&#34;foo;bar&#34;</span><span class="op" id="7847767">,</span>&nbsp;<span class="string" id="7847769">&#34;foobar&#34;</span><span class="op" id="7847777">}</span><span class="op" id="7847778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847782">{</span><span class="string" id="7847783">&#34;foo\\bar&#34;</span><span class="op" id="7847793">,</span>&nbsp;<span class="string" id="7847795">&#34;foobar&#34;</span><span class="op" id="7847803">}</span><span class="op" id="7847804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847808">{</span><span class="string" id="7847809">&#34;foo\&#34;bar&#34;</span><span class="op" id="7847819">,</span>&nbsp;<span class="string" id="7847821">&#34;foobar&#34;</span><span class="op" id="7847829">}</span><span class="op" id="7847830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847834">{</span><span class="string" id="7847835">&#34;\x00\x7e\x7f\x80&#34;</span><span class="op" id="7847853">,</span>&nbsp;<span class="string" id="7847855">&#34;\x7e&#34;</span><span class="op" id="7847861">}</span><span class="op" id="7847862">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847866">{</span><span class="string" id="7847867">`&#34;withquotes&#34;`</span><span class="op" id="7847881">,</span>&nbsp;<span class="string" id="7847883">&#34;withquotes&#34;</span><span class="op" id="7847895">}</span><span class="op" id="7847896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847900">{</span><span class="string" id="7847901">&#34;a&nbsp;z&#34;</span><span class="op" id="7847906">,</span>&nbsp;<span class="string" id="7847908">&#34;a&nbsp;z&#34;</span><span class="op" id="7847913">}</span><span class="op" id="7847914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847918">{</span><span class="string" id="7847919">&#34;&nbsp;z&#34;</span><span class="op" id="7847923">,</span>&nbsp;<span class="string" id="7847925">`&#34;&nbsp;z&#34;`</span><span class="op" id="7847931">}</span><span class="op" id="7847932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847936">{</span><span class="string" id="7847937">&#34;a&nbsp;&#34;</span><span class="op" id="7847941">,</span>&nbsp;<span class="string" id="7847943">`&#34;a&nbsp;&#34;`</span><span class="op" id="7847949">}</span><span class="op" id="7847950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7847953">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847956">for</span>&nbsp;<span class="ident" id="7847960">_</span><span class="op" id="7847961">,</span>&nbsp;<span class="ident" id="7847963">tt</span>&nbsp;<span class="op" id="7847966">:=</span>&nbsp;<span class="keyword" id="7847969">range</span>&nbsp;<span class="ident" id="7847975">tests</span>&nbsp;<span class="op" id="7847981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7847985">if</span>&nbsp;<span class="ident" id="7847988">got</span>&nbsp;<span class="op" id="7847992">:=</span>&nbsp;<span class="ident" id="7847995">sanitizeCookieValue</span><span class="op" id="7848014">(</span><span class="ident" id="7848015">tt</span><span class="op" id="7848017">.</span><span class="ident" id="7848018">in</span><span class="op" id="7848020">)</span><span class="op" id="7848021">;</span>&nbsp;<span class="ident" id="7848023">got</span>&nbsp;<span class="op" id="7848027">!=</span>&nbsp;<span class="ident" id="7848030">tt</span><span class="op" id="7848032">.</span><span class="ident" id="7848033">want</span>&nbsp;<span class="op" id="7848038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848043">t</span><span class="op" id="7848044">.</span><span class="ident" id="7848045">Errorf</span><span class="op" id="7848051">(</span><span class="string" id="7848052">&#34;sanitizeCookieValue(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7848091">,</span>&nbsp;<span class="ident" id="7848093">tt</span><span class="op" id="7848095">.</span><span class="ident" id="7848096">in</span><span class="op" id="7848098">,</span>&nbsp;<span class="ident" id="7848100">got</span><span class="op" id="7848103">,</span>&nbsp;<span class="ident" id="7848105">tt</span><span class="op" id="7848107">.</span><span class="ident" id="7848108">want</span><span class="op" id="7848112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7848116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7848119">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7848123">if</span>&nbsp;<span class="ident" id="7848126">got</span><span class="op" id="7848129">,</span>&nbsp;<span class="ident" id="7848131">sub</span>&nbsp;<span class="op" id="7848135">:=</span>&nbsp;<span class="ident" id="7848138">logbuf</span><span class="op" id="7848144">.</span><span class="ident" id="7848145">String</span><span class="op" id="7848151">(</span><span class="op" id="7848152">)</span><span class="op" id="7848153">,</span>&nbsp;<span class="string" id="7848155">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="7848179">;</span>&nbsp;<span class="op" id="7848181">!</span><span class="ident" id="7848182">strings</span><span class="op" id="7848189">.</span><span class="ident" id="7848190">Contains</span><span class="op" id="7848198">(</span><span class="ident" id="7848199">got</span><span class="op" id="7848202">,</span>&nbsp;<span class="ident" id="7848204">sub</span><span class="op" id="7848207">)</span>&nbsp;<span class="op" id="7848209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848213">t</span><span class="op" id="7848214">.</span><span class="ident" id="7848215">Errorf</span><span class="op" id="7848221">(</span><span class="string" id="7848222">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7848269">,</span>&nbsp;<span class="ident" id="7848271">sub</span><span class="op" id="7848274">,</span>&nbsp;<span class="ident" id="7848276">got</span><span class="op" id="7848279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7848282">}</span><br>
<span class="lineno"></span><span class="op" id="7848284">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="keyword" id="7848287">func</span>&nbsp;<span class="ident" id="7848292">TestCookieSanitizePath</span><span class="op" id="7848314">(</span><span class="ident" id="7848315">t</span>&nbsp;<span class="op" id="7848317">*</span><span class="ident" id="7848318">testing</span><span class="op" id="7848325">.</span><span class="ident" id="7848326">T</span><span class="op" id="7848327">)</span>&nbsp;<span class="op" id="7848329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7848332">defer</span>&nbsp;<span class="ident" id="7848338">log</span><span class="op" id="7848341">.</span><span class="ident" id="7848342">SetOutput</span><span class="op" id="7848351">(</span><span class="ident" id="7848352">os</span><span class="op" id="7848354">.</span><span class="ident" id="7848355">Stderr</span><span class="op" id="7848361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7848364">var</span>&nbsp;<span class="ident" id="7848368">logbuf</span>&nbsp;<span class="ident" id="7848375">bytes</span><span class="op" id="7848380">.</span><span class="ident" id="7848381">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848389">log</span><span class="op" id="7848392">.</span><span class="ident" id="7848393">SetOutput</span><span class="op" id="7848402">(</span><span class="op" id="7848403">&amp;</span><span class="ident" id="7848404">logbuf</span><span class="op" id="7848410">)</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848414">tests</span>&nbsp;<span class="op" id="7848420">:=</span>&nbsp;<span class="op" id="7848423">[</span><span class="op" id="7848424">]</span><span class="keyword" id="7848425">struct</span>&nbsp;<span class="op" id="7848432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848436">in</span><span class="op" id="7848438">,</span>&nbsp;<span class="ident" id="7848440">want</span>&nbsp;<span class="builtintype" id="7848445">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7848453">}</span><span class="op" id="7848454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7848458">{</span><span class="string" id="7848459">&#34;/path&#34;</span><span class="op" id="7848466">,</span>&nbsp;<span class="string" id="7848468">&#34;/path&#34;</span><span class="op" id="7848475">}</span><span class="op" id="7848476">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7848480">{</span><span class="string" id="7848481">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="7848500">,</span>&nbsp;<span class="string" id="7848502">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="7848521">}</span><span class="op" id="7848522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7848526">{</span><span class="string" id="7848527">&#34;/just;no;semicolon\x00orstuff/&#34;</span><span class="op" id="7848559">,</span>&nbsp;<span class="string" id="7848561">&#34;/justnosemicolonorstuff/&#34;</span><span class="op" id="7848587">}</span><span class="op" id="7848588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7848591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7848594">for</span>&nbsp;<span class="ident" id="7848598">_</span><span class="op" id="7848599">,</span>&nbsp;<span class="ident" id="7848601">tt</span>&nbsp;<span class="op" id="7848604">:=</span>&nbsp;<span class="keyword" id="7848607">range</span>&nbsp;<span class="ident" id="7848613">tests</span>&nbsp;<span class="op" id="7848619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7848623">if</span>&nbsp;<span class="ident" id="7848626">got</span>&nbsp;<span class="op" id="7848630">:=</span>&nbsp;<span class="ident" id="7848633">sanitizeCookiePath</span><span class="op" id="7848651">(</span><span class="ident" id="7848652">tt</span><span class="op" id="7848654">.</span><span class="ident" id="7848655">in</span><span class="op" id="7848657">)</span><span class="op" id="7848658">;</span>&nbsp;<span class="ident" id="7848660">got</span>&nbsp;<span class="op" id="7848664">!=</span>&nbsp;<span class="ident" id="7848667">tt</span><span class="op" id="7848669">.</span><span class="ident" id="7848670">want</span>&nbsp;<span class="op" id="7848675">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848680">t</span><span class="op" id="7848681">.</span><span class="ident" id="7848682">Errorf</span><span class="op" id="7848688">(</span><span class="string" id="7848689">&#34;sanitizeCookiePath(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7848727">,</span>&nbsp;<span class="ident" id="7848729">tt</span><span class="op" id="7848731">.</span><span class="ident" id="7848732">in</span><span class="op" id="7848734">,</span>&nbsp;<span class="ident" id="7848736">got</span><span class="op" id="7848739">,</span>&nbsp;<span class="ident" id="7848741">tt</span><span class="op" id="7848743">.</span><span class="ident" id="7848744">want</span><span class="op" id="7848748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7848752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7848755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7848759">if</span>&nbsp;<span class="ident" id="7848762">got</span><span class="op" id="7848765">,</span>&nbsp;<span class="ident" id="7848767">sub</span>&nbsp;<span class="op" id="7848771">:=</span>&nbsp;<span class="ident" id="7848774">logbuf</span><span class="op" id="7848780">.</span><span class="ident" id="7848781">String</span><span class="op" id="7848787">(</span><span class="op" id="7848788">)</span><span class="op" id="7848789">,</span>&nbsp;<span class="string" id="7848791">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="7848815">;</span>&nbsp;<span class="op" id="7848817">!</span><span class="ident" id="7848818">strings</span><span class="op" id="7848825">.</span><span class="ident" id="7848826">Contains</span><span class="op" id="7848834">(</span><span class="ident" id="7848835">got</span><span class="op" id="7848838">,</span>&nbsp;<span class="ident" id="7848840">sub</span><span class="op" id="7848843">)</span>&nbsp;<span class="op" id="7848845">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7848849">t</span><span class="op" id="7848850">.</span><span class="ident" id="7848851">Errorf</span><span class="op" id="7848857">(</span><span class="string" id="7848858">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7848905">,</span>&nbsp;<span class="ident" id="7848907">sub</span><span class="op" id="7848910">,</span>&nbsp;<span class="ident" id="7848912">got</span><span class="op" id="7848915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7848918">}</span><br>
<span class="lineno"></span><span class="op" id="7848920">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
